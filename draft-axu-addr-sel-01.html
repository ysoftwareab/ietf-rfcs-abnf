<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Address Selection Using Source Address Specific Routing Tables</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Address Selection Using Source Address Specific Routing Tables">
<meta name="keywords" content="address selection, autoconfiguration, automatic, configuration">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">6man</td><td class="header">A. Suhonen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Tampere University of Technology,</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc3484'>3484</a> (if&nbsp;approved)</td><td class="header">Finland</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">July 12, 2010</td></tr>
<tr><td class="header">Expires: January 13, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Address Selection Using Source Address Specific Routing Tables<br />draft-axu-addr-sel-01</h1>

<h3>Abstract</h3>

<p>RFC 3484 defines two algorithms for default
	source and destination address selection, but it
	has several shortcomings.
	This document specifies an alternate address selection
	algorithm that uses routing tables as policy input.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 13, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
<a href="#filter">2.</a>&nbsp;
Filter Algorithm<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Scope Recognition<br />
<a href="#anchor4">3.</a>&nbsp;
Precedences and Labels<br />
<a href="#anchor5">4.</a>&nbsp;
Routing Table and Address Properties<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
Local Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.</a>&nbsp;
Link Local Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.3.</a>&nbsp;
Autoconfiguration for Global Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.4.</a>&nbsp;
Limited Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.5.</a>&nbsp;
Transition Technique Routing Tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.6.</a>&nbsp;
IPv4 Compatible Routing Tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.7.</a>&nbsp;
Mobility<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.8.</a>&nbsp;
Reachability Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#additional filter constraints">4.9.</a>&nbsp;
Additional Filter Constraints<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.10.</a>&nbsp;
Forwarding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.11.</a>&nbsp;
Dynamic Routing Protocols<br />
<a href="#anchor16">5.</a>&nbsp;
RFC3484 Rule Comparison<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.1.</a>&nbsp;
Source Address Selection Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.1.1.</a>&nbsp;
Prefer Same Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.1.2.</a>&nbsp;
Prefer Appropriate Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.1.3.</a>&nbsp;
Avoid Deprecated Addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.1.4.</a>&nbsp;
Prefer Home Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">5.1.5.</a>&nbsp;
Prefer Outgoing Interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">5.1.6.</a>&nbsp;
Prefer Matching Label<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">5.1.7.</a>&nbsp;
Prefer Public Addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.1.8.</a>&nbsp;
Use Longest Matching Prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.2.</a>&nbsp;
Destination Address Selection Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">5.2.1.</a>&nbsp;
Avoid Unusable Destinations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">5.2.2.</a>&nbsp;
Prefer Matching Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">5.2.3.</a>&nbsp;
Avoid Deprecated Addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">5.2.4.</a>&nbsp;
Prefer Home Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">5.2.5.</a>&nbsp;
Prefer Matching Label<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">5.2.6.</a>&nbsp;
Prefer Higher Precedence<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">5.2.7.</a>&nbsp;
Prefer Native Transport<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">5.2.8.</a>&nbsp;
Prefer Smaller Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">5.2.9.</a>&nbsp;
Use Longest Matching Prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">5.2.10.</a>&nbsp;
Leave Order Unchanged<br />
<a href="#effectiveness">6.</a>&nbsp;
RFC5220 Concerns<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">6.1.</a>&nbsp;
Multiple Routers on a Single Interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">6.2.</a>&nbsp;
Ingress Filtering Problem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">6.3.</a>&nbsp;
Half-Closed Network Problem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ula">6.4.</a>&nbsp;
Combined Use of Global and ULA<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">6.5.</a>&nbsp;
Site Renumbering<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">6.6.</a>&nbsp;
Multicast Source Address Selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#temp-sel">6.7.</a>&nbsp;
Temporary Address Selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">6.8.</a>&nbsp;
IPv4 or IPv6 Prioritization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">6.9.</a>&nbsp;
ULA and IPv4 Dual-Stack Environment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">6.10.</a>&nbsp;
ULA or Global Prioritization<br />
<a href="#anchor45">7.</a>&nbsp;
RFC5221 Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">7.1.</a>&nbsp;
Effectiveness<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">7.2.</a>&nbsp;
Timing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">7.3.</a>&nbsp;
Dynamic Behavior Update<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor49">7.4.</a>&nbsp;
Node-Specific Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor50">7.5.</a>&nbsp;
Application-Specific Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor51">7.6.</a>&nbsp;
Multiple Interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor52">7.7.</a>&nbsp;
Central Control<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor53">7.8.</a>&nbsp;
Next-Hop Selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor54">7.9.</a>&nbsp;
Compatibility with RFC 3493<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">7.10.</a>&nbsp;
Compatibility and Interoperability with RFC 3484<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor56">7.11.</a>&nbsp;
Security<br />
<a href="#anchor57">8.</a>&nbsp;
Implementation Issues and Other Concerns<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor58">8.1.</a>&nbsp;
Low Memory and Power Concerns<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor59">8.2.</a>&nbsp;
Differing Larger Scopes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#connection pooling">8.3.</a>&nbsp;
Connection Pooling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor60">8.4.</a>&nbsp;
Using Just One Table with Tags<br />
<a href="#Acknowledgements">9.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">10.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">11.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc5220-sec">11.1.</a>&nbsp;
RFC5220 Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc5221-sec">11.2.</a>&nbsp;
RFC5221 Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor61">11.2.1.</a>&nbsp;
List of threats introduced by new address-selection mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor62">11.2.2.</a>&nbsp;
List of recommendations in which security mechanism should be applied<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rt-example">Appendix&nbsp;A.</a>&nbsp;
Routing Table Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rt-example-before">A.1.</a>&nbsp;
Before<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rt-example-after">A.2.</a>&nbsp;
After Conversion<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p><a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a>
	defines default address selection rules for IPv6
	and for IPv4 in relation to IPv6.
	Several shortcomings in the original address selection
	rules have been identified in <a class='info' href='#RFC5220'>[RFC5220]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Problem Statement for Default Address Selection in Multi-Prefix Environments: Operational Issues of RFC 3484 Default Rules,&rdquo; July&nbsp;2008.</span><span>)</span></a>
	and its sister document <a class='info' href='#RFC5221'>[RFC5221]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Requirements for Address Selection Mechanisms,&rdquo; July&nbsp;2008.</span><span>)</span></a>
	specifies some requirements for any attempts to update the
	original address selection algorithm.
	
</p>
<p>A further concern comes from multipath protocols.
	When <a class='info' href='#RFC4960'>SCTP<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4960], for example, finds that its
	active source destination address pair is no longer
	functional, it will need to start searching for a new one.
	If the multipath protocol doesn't respect address selection
	policy, it may cause similar security incidents as the old
	address selection algorithm. A multipath protocol should also
	consult the algorithm during the session and not only on
	connection setup.
	<a class='info' href='#RFC5533'>SHIM6<span> (</span><span class='info'>Nordmark, E. and M. Bagnulo, &ldquo;Shim6: Level 3 Multihoming Shim Protocol for IPv6,&rdquo; June&nbsp;2009.</span><span>)</span></a> [RFC5533] has similar concerns.
	
</p>
<p>The communicating hosts may both have a dozen addresses so it
	might take unacceptably long to iterate through all combinations
	before finding a functional pair. On the other hand, many
	of the invalid combinations could be filtered out using this
	algorithm, making the process noticeably faster.
	
</p>
<p>This algorithm always performs address selection on
	source-destination address pairs with additional information
	such as next hop attached. Preferences are also associated
	with address pairs instead of single addresses.
	
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
	"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
	document are to be interpreted as described in
	<a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>An autoconfiguration method is any process or protocol
	that acquires or creates an IP address for a link.
	Examples of autoconfiguration methods include
	<a class='info' href='#RFC0903'>RARP<span> (</span><span class='info'>Finlayson, R., Mann, T., Mogul, J., and M. Theimer, &ldquo;Reverse Address Resolution Protocol,&rdquo; June&nbsp;1984.</span><span>)</span></a> [RFC0903],
	<a class='info' href='#RFC2131'>DHCPv4<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2131],
	<a class='info' href='#RFC4862'>ICMPv6 RA<span> (</span><span class='info'>Thomson, S., Narten, T., and T. Jinmei, &ldquo;IPv6 Stateless Address Autoconfiguration,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4862],
	<a class='info' href='#RFC3315'>DHCPv6<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a> [RFC3315],
	<a class='info' href='#RFC4380'>Teredo<span> (</span><span class='info'>Huitema, C., &ldquo;Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs),&rdquo; February&nbsp;2006.</span><span>)</span></a> [RFC4380],
	<a class='info' href='#RFC3056'>6to4<span> (</span><span class='info'>Carpenter, B. and K. Moore, &ldquo;Connection of IPv6 Domains via IPv4 Clouds,&rdquo; February&nbsp;2001.</span><span>)</span></a> [RFC3056],
	<a class='info' href='#RFC5214'>ISATAP<span> (</span><span class='info'>Templin, F., Gleeson, T., and D. Thaler, &ldquo;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP),&rdquo; March&nbsp;2008.</span><span>)</span></a> [RFC5214],
	<a class='info' href='#RFC3927'>IPv4 Link Local<span> (</span><span class='info'>Cheshire, S., Aboba, B., and E. Guttman, &ldquo;Dynamic Configuration of IPv4 Link-Local Addresses,&rdquo; May&nbsp;2005.</span><span>)</span></a> [RFC3927],
	<a class='info' href='#RFC1661'>PPP<span> (</span><span class='info'>Simpson, W., &ldquo;The Point-to-Point Protocol (PPP),&rdquo; July&nbsp;1994.</span><span>)</span></a> [RFC1661] and
	mDNS.
	
</p>
<p>An autoconfiguration agent is a process or daemon
	that executes an autoconfiguration method on the host.
</p>
<p>Autoconfiguration methods may also produce other
	information such as default routes and DNS resolvers.
	The complete collection of information produced by an
	autoconfiguration method is called an autoconfiguration
	blob in this document.
</p>
<a name="filter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Filter Algorithm</h3>

<p>
	When a host has several addresses, they SHOULD each
	be associated with their own routing tables.
	The first stage in selecting source and destination addresses
	SHOULD be to filter out combinations where the routing
	table attached with
	the source (local) address
	does not have a valid route for
	the destination (remote) address.
	If more than one route matches, the most specific route
	SHOULD be checked for validity.
	
</p>
<p>
	If a destination address can't be found
	from the routing table for a given source address
	the system MUST discard that destination address for that
	source address.
	
</p>
<p>If none of the possible destination addresses can be
	found in the routing table for a source address, then
	that source address MUST be discarded for those
	destination addresses.
	
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Scope Recognition</h3>

<p>One side effect of this filter algorithm is that it doesn't
	need to know anything about scopes. The routing tables
	associated with source address candidates will determine
	what destination addresses they are usable with. This
	effect is demonstrated below and later in this document.
	
</p>
<p>Whenever scopes are mentioned in this draft, they are
	always mentioned in the context of generating policy input for
	the algorithm.
	
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Precedences and Labels</h3>

<p>Each routing table has a default precedence,
	meaning all routes added to that table will have
	that precedence in the absence of a specific precedence.
	
</p>
<p>This precedence MUST be used to sort the source
	and destination address pairs after the filtering
	stage according to preference.
	Higher precedence values have higher preference.
	In effect, the precedence is for the address pair,
	not for a single address.
	
</p>
<p>When two or more address pairs have the same precedence, their
	destination prefix lengths MUST be compared and the longer prefixes
	MUST be considered more preferable.
	
</p>
<p>When two or more address pairs are still equal,
	their destination metrics in the routing table
	MUST be compared and address pairs with better metrics
	MUST be considered more preferable.
	
</p>
<p>If there are still ties, they MAY be broken by
	some Equal Cost Multi-Path load sharing techniques.
	Otherwise the algorithm SHOULD output the equal address pairs
	in the same order as they appeared in its input.
	
</p>
<p>The label abstraction used by the
	<a class='info' href='#RFC3484'>original RFC<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> [RFC3484]
	loosely corresponds
	to the routing table abstraction in this algorithm.
	If a database table join is performed on the
	source address policy table and the destination
	address policy table as defined by <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a>
	on the label field and the precedences are added
	together, the result resembles the policy tables
	used by this algorithm.
	
</p>
<p>This algorithm normally performs both source and
	destination address selection simultaneously and
	efficiently.
	
</p>
<p>In order to perform source address selection,
	only one destination address SHOULD be presented to
	the algorithm, which will then look for the address
	in all tables and sort the source addresses where it
	was found according to the precedences.
	
</p>
<p>In order to perform destination address selection,
	only one source address SHOULD be presented to
	the algorithm along with the set of destination addresses.
	The algorithm will then look for all the given
	destination addresses in the table associated with the
	source address and sort the results according to the precedences.
	
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Routing Table and Address Properties</h3>

<p>FIXME: come up with a better section title
</p>
<p>This section details how source address specific
	routing tables should be populated to be usable
	as input data for this algorithm.
	
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Local Scope</h3>

<p>The routing tables associated with
	localhost addresses (127.0.0.1 and ::1)
	SHOULD only have routes to localhost address space.
	(127.0.0.0/8 and ::1/128)
	In addition, if the host supports node local multicast,
	a route for the node local scope multicast space MAY also
	appear in this table. (e.g. ff01::/16, ff11::/16)
	
</p>
<p>The routing tables associated with
	any other addresses assigned to the host
	SHOULD have a host route for the address itself
	pointing to the loopback interface.
	
</p>
<p>The default precedence for all local
	scope route entries SHOULD be 500.
	
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Link Local Scope</h3>

<p>The routing table associated with a link local address
	(e.g. 169.254.123.45%le0)
	SHOULD only have one external unicast route, the link local
	network for that link
	(e.g. 169.254.0.0%le0/16).
	In addition, if the host supports multicast on this link,
	a route for the link local scope multicast space MAY also
	appear in this table. (e.g. ff02::/16, ff12::/16)
	
</p>
<p>This means that the link local source address is
	usable only with other link local destination addresses
	on the same link.
	
</p>
<p>The default precedence for all link local
	scope route entries SHOULD be 500.
	
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Autoconfiguration for Global Scope</h3>

<p>When global scope addresses are assigned to
	interfaces dynamically
	through stateless or stateful autoconfiguration
	the process MUST yield a default route.
	That default route SHOULD be placed only into
	the routing table associated with that address.
	In addition, if the host and network support multicast,
	a route for the global scope multicast space SHOULD also
	appear in this table. (e.g. ff0e::/16, ff1e::/16)
	
</p>
<p>This usually means that the next hop of that
	default route will only be useable with the source
	address learned from that default router.
	
</p>
<p>Some autoconfiguration methods
	(see <a class='info' href='#RFC3442'>[RFC3442]<span> (</span><span class='info'>Lemon, T., Cheshire, S., and B. Volz, &ldquo;The Classless Static Route Option for Dynamic Host Configuration Protocol (DHCP) version 4,&rdquo; December&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC4191'>[RFC4191]<span> (</span><span class='info'>Draves, R. and D. Thaler, &ldquo;Default Router Preferences and More-Specific Routes,&rdquo; November&nbsp;2005.</span><span>)</span></a>)
	can be used to communicate
	other routes in addition to the default route.
	Those routes SHOULD likewise be added only into the
	routing table associated with the address configured
	using that same interchange.
	
</p>
<p>The default precedence for all global
	   scope route entries SHOULD be 400.
	   
</p>
<p>The system MAY automatically add depreference
	   routes to global scope routing tables. These
	   routes will cover address space reserved for
	   transition techniques, such as 2002::/16 (FIXME: add xrefs)
	   and 2001::/32. They SHOULD have the same next-hop
	   information as the default route in the same table,
	   but their precedence SHOULD be 150.
	   
</p>
<p>The system MAY automatically add blackhole
	   routes to global scope routing tables for illegal
	   address combinations. An example of such an
	   illegal combination is IPv6 prefix 2002:a00::/24,
	   which corresponds to 6to4 addresses generated
	   from IPv4 addresses inside 10.0.0.0/8 which can't
	   be used on the Internet.
	   
</p>
<p>Another example of automatically generated
	   extra routes is fc00::/7 for ULA addresses as defined by
	   <a class='info' href='#RFC4193'>[RFC4193]<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a>.
	   However, the routing table for a ULA should only
	   have a route for the address space it's usable in,
	   and that route should be more specific than the default
	   routes for globally usable source addresses, it should 
	   win according to the longest matching prefix rule.
	   
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Limited Scope</h3>

<p>The routing tables for site local addresses
	SHOULD have routes for site local address space.
	They SHOULD NOT have the default route, so that they
	would be automatically eliminated when selecting
	address pairs for site external communication.
	
</p>
<p>However, if the site edge automatically translates
	limited scope addresses to global addresses, the routing
	tables associated with limited scope addresses MAY
	have the default route.
	
</p>
<p>This algorithm effectively treats all addresses that aren't
	associated with a default route as limited scope.
	The system MAY automatically recognize addresses within
	the ULA prefix fc00::/7 <a class='info' href='#RFC4193'>[RFC4193]<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a> and
	treat them as limited scope.
	
</p>
<p>
	The default precedence for limited scope addresses SHOULD
	be the same as global scope addresses (400), but it SHOULD
	be simple for the system or network administration to
	change this setting.
	
</p>
<p>In addition, if the host and network support multicast,
	a route for the site local scope multicast space MAY also
	appear in this table. (e.g. ff05::/16, ff15::/16)
	
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Transition Technique Routing Tables</h3>

<p>The default precedence for all route entries for
	source addresses generated through transition techniques
	SHOULD be 300.
	
</p>
<p>The transition table SHOULD NOT of course have a
	depreference route for its own address space.
	Instead, the precedence of the route for its own
	address space SHOULD be 350. This is to make using
	the same transition technique source address more
	preferable than some different transition technique.
	
</p>
<p>Individual transition techniques or the system
	administrator MAY specify different default precedences
	to establish relative preferences between transition
	techniques or the proxies/servers associated with them.
	
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
IPv4 Compatible Routing Tables</h3>

<p>The precedence for all IPv4 compatible global scope
	route entries SHOULD be easily configurable.
	The default precedence should be 400.
	If administration wishes to promote the use of IPv6,
	then the IPv4 entries should have a precedence of 200.
	
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Mobility</h3>

<p>The precedence of route entries in the tables for
	home addresses and care-of addresses
	SHOULD be easily configurable.
	The default precedence for home addresses should be 425
	and for care-of addresses it should be 400. If an address
	is simultaneously a home address and a care-of address,
	then the precedence should be 450.
When the
host is ''at one home'', that address will be used, and
when the host is visiting ''at the other home'',
the home address of that other home will be preferred.

	
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
Reachability Information</h3>

<p>If the next-hop information associated with a
	route in any table has been found unreachable or
	the link is down the precedence of the affected routes
	MAY be temporarily dropped to zero until they work again.
	
</p>
<a name="additional filter constraints"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.9"></a><h3>4.9.&nbsp;
Additional Filter Constraints</h3>

<p>The address selection algorithm MAY also be given
	  additional filter constraints,
	  such as "use only link#3" or "do not use next-hop 10.0.0.1".
	  <a class='info' href='#RFC5014'>[RFC5014]<span> (</span><span class='info'>Nordmark, E., Chakrabarti, S., and J. Laganier, &ldquo;IPv6 Socket API for Source Address Selection,&rdquo; September&nbsp;2007.</span><span>)</span></a> specifies an interface that
	  does something very similar.
	  
</p>
<p>Work is going on in the
	  <a class='info' href='#I-D.blanchet-mif-problem-statement'>MIF-wg<span> (</span><span class='info'>Blanchet, M. and P. Seite, &ldquo;Multiple Interfaces Problem Statement,&rdquo; June&nbsp;2009.</span><span>)</span></a> [I&#8209;D.blanchet&#8209;mif&#8209;problem&#8209;statement]
	  to tie address selection and next-hop selection with
	  DNS resolver selection and other similar resources.
	  That is, when using the DNS resolvers received from
	  one autoconfiguration agent, the host SHOULD also always use
	  the default route received from the same autoconfiguration agent.
	  
</p>
<p>This algorithm supports those efforts by making
	  it possible to restrict a process to one routing
	  table for both address resolution and selection.
	  
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.10"></a><h3>4.10.&nbsp;
Forwarding</h3>

<p>If a host is configured to forward packets between networks,
	it SHOULD combine the routing tables for the networks
	in question into one. Link local scope tables MUST NOT
	be combined.
	
</p>
<p>If the host has multiple addresses from different
	global scope prefixes then system administration MAY
	specify which addresses are combined to form
	routing tables.
	The resulting functionality resembles the VRF functionality
	found in some modern routers.
	
</p>
<p>One purpose behind this algorithm is to move
	source routing burden from the network to the host.
	So if a router wants to advertise two (or more) prefixes
	on the subnet, but to keep their routing separate, it
	should use different link local and link layer addresses
	when advertising them.
	It can then choose the correct VRF to forward a packet
	depending on which link layer address it received it on.
	
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.11"></a><h3>4.11.&nbsp;
Dynamic Routing Protocols</h3>

<p>Hosts don't usually run dynamic routing protocols,
	  but since they sometimes do, this subsection is
	  included for completeness. Dynamic routing protocols
	  can be used to convey address selection configuration
	  information for this algorithm.
	  
</p>
<p>Dynamic routing protocol instances are usually
	  bound to links or interfaces. With this algorithm
	  network administrators MAY bind routing protocol
	  instances to specific addresses or prefixes on
	  a link and the routing tables associated with them.
	  The routing protocol instance MUST update
	  only the routing table it is associated with.
	  
</p>
<p>A reasonable default setting is that all addresses
	  that are not link local are associated with the routing
	  protocol instance. Thus, they will share a routing table.
	  
</p>
<p>If the network administration wants to separate
	  traffic belonging to different upstream operator prefixes,
	  it may wish to run separate routing protocol instances
	  throughout the network for different upstream prefixes.
	  
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
RFC3484 Rule Comparison</h3>

<p>The algorithm defined by <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> uses a
	set of rules to perform its function. Those rules are
	compared to this algorithm in this section.
	
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Source Address Selection Rules</h3>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Prefer Same Address</h3>

<p>
	    The interface address is added with a higher metric to
	    its address specific routing table than any other routes.
	    This ensures that this algorithm conforms to this rule.
	    
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Prefer Appropriate Scope</h3>

<p>
	    The routes of different scopes are assigned different
	    precedences. They correspond to the scope values
	    of the original algorithm.
	    
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Avoid Deprecated Addresses</h3>

<p>
	    If precedences for deprecated addresses are zeroed,
	    they should automatically be depreferred against
	    any other addresses.
	    
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
Prefer Home Address</h3>

<p>
The higher precedences assigned to home addresses make them always
preferable when compared to almost everything else, apart from
link local addresses. If a host has two home addresses in
different networks, the rules presented 

will make it prefer the correct address depending on the current
location of the mobile node.
	    
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.5"></a><h3>5.1.5.&nbsp;
Prefer Outgoing Interface</h3>

<p>
	    The metric for the route on the table for the address on
	    the outgoing interface
	    should be better than on other interfaces, so all else
	    being equal, it should break the tie to ensure that
	    this rule is met.
	    
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.6"></a><h3>5.1.6.&nbsp;
Prefer Matching Label</h3>

<p>
	    This algorithm doesn't have labels at all. However,
	    automatically added depreference routes will take care
	    of this rule.
	    
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.7"></a><h3>5.1.7.&nbsp;
Prefer Public Addresses</h3>

<p>
	    The <a class='info' href='#temp-sel'>section on temporary address selection<span> (</span><span class='info'>Temporary Address Selection</span><span>)</span></a>
	    already deals with this rule.
	    
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.8"></a><h3>5.1.8.&nbsp;
Use Longest Matching Prefix</h3>

<p>
	    This is a debated rule so reproducing it is also questionable.
	    
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Destination Address Selection Rules</h3>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Avoid Unusable Destinations</h3>

<p>
	    This algorithm conforms to this rule by design.
	    
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Prefer Matching Scope</h3>

<p>
	    The routes of different scopes are assigned different
	    precedences. The routes of matching scopes are assigned
	    higher precedences than routes of differing scopes.
	    
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
Avoid Deprecated Addresses</h3>

<p>
	    If precedences for deprecated addresses are zeroed,
	    they should automatically be depreferred against
	    any other addresses.
	    
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.4"></a><h3>5.2.4.&nbsp;
Prefer Home Address</h3>

<p>
The higher precedences assigned to home addresses make them always
preferable when compared to almost everything else, apart from
link local addresses. If a host has two home addresses in
different networks, the rules presented 

will make it prefer the correct address depending on the current
	    
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.5"></a><h3>5.2.5.&nbsp;
Prefer Matching Label</h3>

<p>
	    This algorithm doesn't have labels at all. However,
	    automatically added depreference routes will take care
	    of this rule.
	    
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.6"></a><h3>5.2.6.&nbsp;
Prefer Higher Precedence</h3>

<p>
	    This algorithm primarily compares precedence values only.
	    All the rules above are encoded as precedence values into
	    the routing tables.
	    
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.7"></a><h3>5.2.7.&nbsp;
Prefer Native Transport</h3>

<p>
	    This rule essentially is a special case of the matching
	    scope and matching label rules. The special routing
	    table generation rules for transition mechanisms make sure
	    that this algorithm behaves the same way as the original algorithm.
	    
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.8"></a><h3>5.2.8.&nbsp;
Prefer Smaller Scope</h3>

<p>
	    The routes of different scopes are assigned different
	    precedences. They correspond to the scope values
	    of the original algorithm.
	    
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.9"></a><h3>5.2.9.&nbsp;
Use Longest Matching Prefix</h3>

<p>
	    This is a debated rule so reproducing it is also questionable.
	    
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.10"></a><h3>5.2.10.&nbsp;
Leave Order Unchanged</h3>

<p>
	    This new algorithm conforms to this rule.
	    
</p>
<a name="effectiveness"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
RFC5220 Concerns</h3>

<p><a class='info' href='#RFC5220'>[RFC5220]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Problem Statement for Default Address Selection in Multi-Prefix Environments: Operational Issues of RFC 3484 Default Rules,&rdquo; July&nbsp;2008.</span><span>)</span></a> presents several problems and
    issues with the original default address selection algorithm.
    The following subsections address these issues.
    
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Multiple Routers on a Single Interface</h3>

<p>This problem was one of the starting points for
	the development of this algorithm. This algorithm
	solves the problem by having separate routing tables
	for addresses learned from different routers.
	
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Ingress Filtering Problem</h3>

<p>This algorithm will always choose
	the correct link and next-hop address for each source address.
	However, if several
	source addresses share the same next-hop on the same link, then
	there's nothing the algorithm can do.
	The problem has to be fixed inside the router announcing the
	prefixes.
	
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Half-Closed Network Problem</h3>

<p>This problem was one of the starting points for
	the development of this algorithm. This algorithm
	solves the problem by having separate routing tables
	for different addresses.
	
</p>
<p>The default assumption is that the auto-configuration method
	supplies a default route for all globally usable addresses.
	The routing tables of source addresses usable only within
	a closed network SHOULD NOT have a default route.
	They SHOULD only have
	routes to the networks they are usable within.
	
</p>
<p>System or network administration MUST specify
	allowed or disallowed connections by modifying
	the auto-configuration input or the routing tables.
	
</p>
<a name="ula"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Combined Use of Global and ULA</h3>

<p>This algorithm
	solves the problem by having separate routing tables
	for different addresses.
	Scope of address usage is controlled by the routing tables.
	
</p>
<p>Implementations MAY recognize ULA addresses
	and other limited scope addresses
	as scopes of their own, and treat them properly
	when autogenerating the routing tables.
	
</p>
<p>System or network administration MUST specify
	allowed or disallowed address pair selection by modifying
	the auto-configuration input or the routing tables.
	
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Site Renumbering</h3>

<p>When the autoconfiguration client discovers that a
	prefix or address has been deprecated, it SHOULD drop
	the route precedences for all the routes associated
	with the deprecated resource to zero.
	
</p>
<p>When such deprecated routing information finally
	times out and is no longer in use, the routing table
	associated with it MAY be removed entirely.
	
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Multicast Source Address Selection</h3>

<p>Multicast address selection works the same way as
	unicast address selection. The source address candidate
	routing tables SHOULD have only the appropriate multicast
	scope routes.
	
</p>
<a name="temp-sel"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
Temporary Address Selection</h3>

<p>A temporary addresses MAY be associated
	with routing tables of its own, instead of sharing
	a routing table with the address used to generate
	the temporary address.
</p>
<p>The precedences for the table for a temporary address
	would be lower than that of a similar but permanent
	address. Clients wishing to make use of the temporary
	address would add appropriate constraints to their address
	selection.
	
</p>
<p>Alternatively, if the system or network administration
	wishes that the host use a temporary address with some
	certain destination network, a route to that network could
	be added to the routing table for the temporary address with
	a higher than normal precedence.
	
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
IPv4 or IPv6 Prioritization</h3>

<p>This is a configuration issue with the routing tables.
	The algorithm itself doesn't dictate policy for sites.
	
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
ULA and IPv4 Dual-Stack Environment</h3>

<p>This special case is easily handled by omitting the
	default route from the routing table for ULA addresses.
	This would result in site-external destination IPv6 addresses 
	not having any usable source addresses and thus they would
	never be considered by this algorithm.
	
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.10"></a><h3>6.10.&nbsp;
ULA or Global Prioritization</h3>

<p>Already covered in <a class='info' href='#ula'>Section&nbsp;6.4<span> (</span><span class='info'>Combined Use of Global and ULA</span><span>)</span></a>.
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
RFC5221 Requirements</h3>

<p><a class='info' href='#RFC5221'>[RFC5221]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Requirements for Address Selection Mechanisms,&rdquo; July&nbsp;2008.</span><span>)</span></a> defines a set of requirements
      for the address selection algorithm. The subsection headings
      used in that document
      have been copied here and an explanation of how this
      algorithm deals with each issue is given.
      
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Effectiveness</h3>

<p>The effectiveness of the proposed solution to solve
	problems presented in <a class='info' href='#RFC5220'>[RFC5220]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Problem Statement for Default Address Selection in Multi-Prefix Environments: Operational Issues of RFC 3484 Default Rules,&rdquo; July&nbsp;2008.</span><span>)</span></a>
	is covered by <a class='info' href='#effectiveness'>Section&nbsp;6<span> (</span><span class='info'>RFC5220 Concerns</span><span>)</span></a>.
	
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Timing</h3>

<p>This algorithm relies on other methods and protocols
	to submit address selection configuration and information
	and to place it in the routing table.
	These other methods include auto-configuration and 
	routing protocols.
	
</p>
<p>Once the routing table is updated, the address selection
	algorithm will start making decisions based on the new
	information.
	
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Dynamic Behavior Update</h3>

<p>From the point of view of this algorithm,
	this problem is a feature of auto-configuration methods.
	If the autoconfiguration methods rewrite routing tables,
	the address selection algorithm will always use the updated
	information when it's invoked.
	
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Node-Specific Behavior</h3>

<p>From the point of view of this algorithm,
	this problem is a feature of autoconfiguration methods.
	This algorithm will happily make address selection
	decisions according to any input it is given.
	
</p>
<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Application-Specific Behavior</h3>

<p>Additional filter constraints from
	<a class='info' href='#additional filter constraints'>Section&nbsp;4.9<span> (</span><span class='info'>Additional Filter Constraints</span><span>)</span></a>
	can be used to influence address selection
	per application.
	
</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Multiple Interface</h3>

<p>This algorithm doesn't differenciate between cases
	where a host has multiple interfaces and where it has
	multiple prefixes on a single interface.
	If it solves a problem satisfactorily for one case,
	it solves it identically for the other case as well.
	
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Central Control</h3>

<p>This algorithm doesn't specify new methods for
	central control. It does, however, work well with other
	protocols that provide methods of central control,
	such as routing protocols.
	
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.8"></a><h3>7.8.&nbsp;
Next-Hop Selection</h3>

<p>The next-hop and interface used is a side product of
	the source address specific routing table lookup, which
	is performed in the filtering stage.
	
</p>
<p>A very pleasing feature of this algorithm is that
	there can be multiple routers advertising different
	prefixes on the same subnet, and this algorithm will still
	select proper address pairs and next-hops to satisfy
	any SAVI requirements.
	
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.9"></a><h3>7.9.&nbsp;
Compatibility with RFC 3493</h3>

<p>FIXME TBD
	
</p>
<p>On first impression, this algorithm shouldn't have any
	impact on the Socket API. Then again, routing table index
	could be referenced as part of some process.
	
</p>
<p>Solaris, for example, creates new alias-interfaces
	for each new address assigned to a physical interface.
	So if_index could also be used to uniquely identify a
	source address specific routing table on that platform.
	Other operating systems do not work the same way.
	
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.10"></a><h3>7.10.&nbsp;
Compatibility and Interoperability with RFC 3484</h3>

<p>When a host implementing this address selection algorithm
	and a host implementing the <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> algorithm
	interact, this algorithm will become constrained by the choices
	made by the peer.
	
</p>
<p>One key difference between this algorithm and the
	<a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> algorithm is that this algorithm
	considers all valid source address candidates, where as the
	original algorithm chooses only one source address per every
	destination address. This difference can be easily overcome by an
	extra filter rule, that accepts only the highest precedence
	source-destination address pair for every given destination
	address.
	
</p>
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.11"></a><h3>7.11.&nbsp;
Security</h3>

<p>Security issues raised in <a class='info' href='#RFC5221'>[RFC5221]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Requirements for Address Selection Mechanisms,&rdquo; July&nbsp;2008.</span><span>)</span></a>
	are covered by <a class='info' href='#rfc5221-sec'>Section&nbsp;11.2<span> (</span><span class='info'>RFC5221 Requirements</span><span>)</span></a>.
	
</p>
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Implementation Issues and Other Concerns</h3>

<p>Some popular operating systems already implement all
      the features required to implement this algorithm. In
      such cases all that is required is to integrate the
      features together.
</p>
<p>The trickiest feature required by this algorithm is
      probably support for multiple routing tables.
      This may also create backward compatibility issues in
      some implementations. More discussion may be required here.
      
</p>
<a name="anchor58"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Low Memory and Power Concerns</h3>

<p>The biggest worry is that creating lots of routing
	  tables will waste memory and power.
	  However, when compared to the old way
	  (see <a class='info' href='#rt-example'>Appendix&nbsp;A<span> (</span><span class='info'>Routing Table Example</span><span>)</span></a>),
	  memory consumption doesn't explode. Every route that
	  was present in the monolithic routing table will usually
	  be present in only one source address specific routing table.
	  
</p>
<p>CGAs (ADD XREF) MAY reuse the same routing table.
	  
</p>
<a name="anchor59"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Differing Larger Scopes</h3>

<p>The default route for global scope addresses is
	  0::0/0, but this route will also cover addresses
	  of potentially incompatible scopes.
	  For example, the basic algorithm would accept
	  a link local destination address with a global
	  scope source address.
	  
</p>
<p>One way to prevent this would be to add blackhole
	  routes into the routing tables of global scope addresses
	  for address space belonging to incompatible scopes.
	  The filter algorithm SHOULD treat a blackhole route
	  as an indication that no valid route was found for
	  addresses matching the blackhole in that table.
	  
</p>
<a name="connection pooling"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Connection Pooling</h3>

<p>When trying to establish a new connection,
	  the stack MAY send open packets to all
	  source/destination/nexthop combinations
	  that pass the filter stage
	  at a pace of three per second until it
	  receives a response.
	  
</p>
<p>When the connection is established the addresses are
	  fixed (for non-multipathing protocols, such as TCP).
	  
</p>
<p>If the peer also responds to the other connection attempts
	  after the first connection is established,
	  those connections MAY either be reset immediately, or the
	  stack MAY pool them for a short while in an incomplete
	  handshake state, in case some application tries to open
	  an identical socket.
	  
</p>
<p>This would benefit applications such as web browsers,
	  mail transfer agents and database clients, which routinely
	  create more than one connection between the same two hosts
	  and the same destination port.
	  
</p>
<p>It would also benefit dual stacked or multi-homed hosts
	  where some of the addresses or networks are misconfigured
	  and don't work.
	  
</p>
<a name="anchor60"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Using Just One Table with Tags</h3>

<p>It is possible to implement this algorithm with just
	  one routing table, if tags or bitfields are used to identify
	  which routing table each route really belongs to.
	  
</p>
<p>However, since a less specific route in one table can
	  have higher precedence than a more specific route in another
	  table, care must be taken in the implementation.
	  
</p>
<p>It is also possible to implement this algorithm without
	  interfering with the actual routing table at all, by just
	  mirroring all the routing table information and changes
	  in a policy table used by this algorithm only.
	  
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>This document was written using the template derived from
      an initial version written by Pekka Savola and contributed by
      him to the xml2rfc project.
</p>
<p>Thanks to the following people for giving feedback during
      the writing of this document:
	Jari Arkko,
	Jan Melen,
	Arifumi Matsumoto,
	James Morse,
	Tim Chown,
	Brian E Carpenter,
      .
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>This document has no IANA Actions.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<a name="rfc5220-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
RFC5220 Considerations</h3>

<p>
	Section 4 of <a class='info' href='#RFC5220'>[RFC5220]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Problem Statement for Default Address Selection in Multi-Prefix Environments: Operational Issues of RFC 3484 Default Rules,&rdquo; July&nbsp;2008.</span><span>)</span></a>

	raises a concern that a malicious
	attacker can gather information about addresses connected to
	the target host by triggering the address selection algorithm
	on the target host by various methods and listening to what
	candidates it produces.
	
</p>
<p>This algorithm doesn't completely remove that possibility,
	but due to the filtering stage, the attacker can only gain
	information on addresses routable to the address used by
	the attacker.
	
</p>
<a name="rfc5221-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2"></a><h3>11.2.&nbsp;
RFC5221 Requirements</h3>

<p>
	Section 3 of <a class='info' href='#RFC5221'>[RFC5221]<span> (</span><span class='info'>Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;Requirements for Address Selection Mechanisms,&rdquo; July&nbsp;2008.</span><span>)</span></a>
	lists two security concerns
	which are dealt with in subsections below.
	
</p>
<a name="anchor61"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2.1"></a><h3>11.2.1.&nbsp;
List of threats introduced by new address-selection mechanism</h3>

<p>This specification relies on existing
		autoconfiguration methods and routing protocols
		to distribute address selection hints.
		Each of those SHOULD have their own methods to
		combat leakage, hijacking and denial of service.
		
</p>
<a name="anchor62"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2.2"></a><h3>11.2.2.&nbsp;
List of recommendations in which security mechanism should be applied</h3>

<p>This specification relies on existing
		autoconfiguration methods and routing protocols
		to distribute address selection hints.
		Each of those SHOULD have their own methods to
		ensure integrity, authentication and authorization.
		
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3442">[RFC3442]</a></td>
<td class="author-text">Lemon, T., Cheshire, S., and B. Volz, &ldquo;<a href="http://tools.ietf.org/html/rfc3442">The Classless Static Route Option for Dynamic Host Configuration Protocol (DHCP) version 4</a>,&rdquo; RFC&nbsp;3442, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3442.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3484">[RFC3484]</a></td>
<td class="author-text">Draves, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3484">Default Address Selection for Internet Protocol version 6 (IPv6)</a>,&rdquo; RFC&nbsp;3484, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3484.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4191">[RFC4191]</a></td>
<td class="author-text">Draves, R. and D. Thaler, &ldquo;<a href="http://tools.ietf.org/html/rfc4191">Default Router Preferences and More-Specific Routes</a>,&rdquo; RFC&nbsp;4191, November&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4191.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4960">[RFC4960]</a></td>
<td class="author-text">Stewart, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4960">Stream Control Transmission Protocol</a>,&rdquo; RFC&nbsp;4960, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4960.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5220">[RFC5220]</a></td>
<td class="author-text">Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;<a href="http://tools.ietf.org/html/rfc5220">Problem Statement for Default Address Selection in Multi-Prefix Environments: Operational Issues of RFC 3484 Default Rules</a>,&rdquo; RFC&nbsp;5220, July&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5220.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5221">[RFC5221]</a></td>
<td class="author-text">Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama, &ldquo;<a href="http://tools.ietf.org/html/rfc5221">Requirements for Address Selection Mechanisms</a>,&rdquo; RFC&nbsp;5221, July&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5221.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.blanchet-mif-problem-statement">[I-D.blanchet-mif-problem-statement]</a></td>
<td class="author-text">Blanchet, M. and P. Seite, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-blanchet-mif-problem-statement-01.txt">Multiple Interfaces Problem Statement</a>,&rdquo; draft-blanchet-mif-problem-statement-01 (work in progress), June&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-blanchet-mif-problem-statement-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0903">[RFC0903]</a></td>
<td class="author-text">Finlayson, R., Mann, T., Mogul, J., and M. Theimer, &ldquo;<a href="http://tools.ietf.org/html/rfc903">Reverse Address Resolution Protocol</a>,&rdquo; STD&nbsp;38, RFC&nbsp;903, June&nbsp;1984 (<a href="http://www.rfc-editor.org/rfc/rfc903.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1661">[RFC1661]</a></td>
<td class="author-text"><a href="mailto:Bill.Simpson@um.cc.umich.edu">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>,&rdquo; STD&nbsp;51, RFC&nbsp;1661, July&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text"><a href="mailto:droms@bucknell.edu">Droms, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>,&rdquo; RFC&nbsp;2131, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2131.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2131.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2131.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3056">[RFC3056]</a></td>
<td class="author-text">Carpenter, B. and K. Moore, &ldquo;<a href="http://tools.ietf.org/html/rfc3056">Connection of IPv6 Domains via IPv4 Clouds</a>,&rdquo; RFC&nbsp;3056, February&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3927">[RFC3927]</a></td>
<td class="author-text">Cheshire, S., Aboba, B., and E. Guttman, &ldquo;<a href="http://tools.ietf.org/html/rfc3927">Dynamic Configuration of IPv4 Link-Local Addresses</a>,&rdquo; RFC&nbsp;3927, May&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3927.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4193">[RFC4193]</a></td>
<td class="author-text">Hinden, R. and B. Haberman, &ldquo;<a href="http://tools.ietf.org/html/rfc4193">Unique Local IPv6 Unicast Addresses</a>,&rdquo; RFC&nbsp;4193, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4193.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4380">[RFC4380]</a></td>
<td class="author-text">Huitema, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4380">Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)</a>,&rdquo; RFC&nbsp;4380, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4380.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4862">[RFC4862]</a></td>
<td class="author-text">Thomson, S., Narten, T., and T. Jinmei, &ldquo;<a href="http://tools.ietf.org/html/rfc4862">IPv6 Stateless Address Autoconfiguration</a>,&rdquo; RFC&nbsp;4862, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4862.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5014">[RFC5014]</a></td>
<td class="author-text">Nordmark, E., Chakrabarti, S., and J. Laganier, &ldquo;<a href="http://tools.ietf.org/html/rfc5014">IPv6 Socket API for Source Address Selection</a>,&rdquo; RFC&nbsp;5014, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5014.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5214">[RFC5214]</a></td>
<td class="author-text">Templin, F., Gleeson, T., and D. Thaler, &ldquo;<a href="http://tools.ietf.org/html/rfc5214">Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)</a>,&rdquo; RFC&nbsp;5214, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5214.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5533">[RFC5533]</a></td>
<td class="author-text">Nordmark, E. and M. Bagnulo, &ldquo;<a href="http://tools.ietf.org/html/rfc5533">Shim6: Level 3 Multihoming Shim Protocol for IPv6</a>,&rdquo; RFC&nbsp;5533, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5533.txt">TXT</a>).</td></tr>
</table>

<a name="rt-example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Routing Table Example</h3>

<p>This section demonstrates how this algorithm affects the routing
      table of a multi-homed host.
      <a class='info' href='#rt-example-before'>Appendix&nbsp;A.1<span> (</span><span class='info'>Before</span><span>)</span></a> shows the routing table
      using only methods without this algorithm.
      <a class='info' href='#rt-example-after'>Appendix&nbsp;A.2<span> (</span><span class='info'>After Conversion</span><span>)</span></a> shows the routing tables
      produced on the same host if this algorithm is applied.
      
</p>
<a name="rt-example-before"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Before</h3>

<p>This routing table was initially copied from a system
      running Linux 2.6.25. The addresses were then greatly
      simplified to make the table fit better on the page.
      
</p><br /><hr class="insert" />
<a name="before-table"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Metric</th></tr>
<tr>
<td align="left">2001::/32</td>
<td align="left">::</td>
<td align="left">teredo</td>
<td align="left">256</td>
</tr>
<tr>
<td align="left">2001:db8:1::/64</td>
<td align="left">::</td>
<td align="left">eth0</td>
<td align="left">256</td>
</tr>
<tr>
<td align="left">2001:db8:2::/64</td>
<td align="left">::</td>
<td align="left">eth1</td>
<td align="left">256</td>
</tr>
<tr>
<td align="left">fe80::/64</td>
<td align="left">::</td>
<td align="left">teredo</td>
<td align="left">256</td>
</tr>
<tr>
<td align="left">fe80::/64</td>
<td align="left">::</td>
<td align="left">eth0</td>
<td align="left">256</td>
</tr>
<tr>
<td align="left">fe80::/64</td>
<td align="left">::</td>
<td align="left">eth1</td>
<td align="left">256</td>
</tr>
<tr>
<td align="left">::/0</td>
<td align="left">::</td>
<td align="left">teredo</td>
<td align="left">1029</td>
</tr>
<tr>
<td align="left">::/0</td>
<td align="left">fe80::13</td>
<td align="left">eth0</td>
<td align="left">1024</td>
</tr>
<tr>
<td align="left">::/0</td>
<td align="left">fe80::ce</td>
<td align="left">eth1</td>
<td align="left">1024</td>
</tr>
<tr>
<td align="left">::/0</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">-1 !U</td>
</tr>
<tr>
<td align="left">::1/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">2001:db8:1:0:a00:ff:fedc:a/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">2001:db8:2:0:200:ff:fec4:b/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">2001:0:c200:201::3/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">fe80::a00:ff:fedc:a/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">fe80::200:ff:fec4:b/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">fe80::ffff:ffff:ffff/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">0</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Routing Table w/o Modifications&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>"!U" after metric denotes unreachable or blackhole routes.
</p>
<a name="rt-example-after"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
After Conversion</h3>

<p>These tables contain and implement just the basic idea.
      Thus the combined size of these tables is equal to
      <a class='info' href='#before-table'>Table&nbsp;1<span> (</span><span class='info'>Routing Table w/o Modifications</span><span>)</span></a>.
      Optional improvements are presented in the next subsection.
      
</p><br /><hr class="insert" />
<a name="after-table-loopback"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Prec</th></tr>
<tr>
<td align="left">::/0</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">-1 !U</td>
</tr>
<tr>
<td align="left">::1/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">500</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Routing Table for ::1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="after-table-teredo"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Prec</th></tr>
<tr>
<td align="left">2001::/32</td>
<td align="left">::</td>
<td align="left">teredo</td>
<td align="left">350</td>
</tr>
<tr>
<td align="left">::/0</td>
<td align="left">::</td>
<td align="left">teredo</td>
<td align="left">300</td>
</tr>
<tr>
<td align="left">2001:0:c200:201::3/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">500</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Routing Table for 2001:0:c200:201::3%teredo&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="after-table-teredoLL"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Prec</th></tr>
<tr>
<td align="left">fe80::/64</td>
<td align="left">::</td>
<td align="left">teredo</td>
<td align="left">500</td>
</tr>
<tr>
<td align="left">fe80::ffff:ffff:ffff/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">500</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Routing Table for fe80::ffff:ffff:ffff%teredo&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="after-table-eth0"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Prec</th></tr>
<tr>
<td align="left">2001:db8:1::/64</td>
<td align="left">::</td>
<td align="left">eth0</td>
<td align="left">400</td>
</tr>
<tr>
<td align="left">::/0</td>
<td align="left">fe80::13</td>
<td align="left">eth0</td>
<td align="left">400</td>
</tr>
<tr>
<td align="left">2001:db8:1:0:a00:ff:fedc:a/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">500</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 5: Routing Table for 2001:db8:1:0:a00:ff:fedc:a%eth0&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="after-table-eth0LL"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Prec</th></tr>
<tr>
<td align="left">fe80::/64</td>
<td align="left">::</td>
<td align="left">eth0</td>
<td align="left">500</td>
</tr>
<tr>
<td align="left">fe80::a00:ff:fedc:a/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">500</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 6: Routing Table for fe80::a00:ff:fedc:a%eth0&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="after-table-eth1"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Prec</th></tr>
<tr>
<td align="left">2001:db8:2::/64</td>
<td align="left">::</td>
<td align="left">eth1</td>
<td align="left">400</td>
</tr>
<tr>
<td align="left">2001:db8:2:0:200:ff:fec4:b/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">500</td>
</tr>
<tr>
<td align="left">::/0</td>
<td align="left">fe80::ce</td>
<td align="left">eth1</td>
<td align="left">400</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 7: Routing Table for 2001:db8:2:0:200:ff:fec4:b%eth1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="after-table-eth1LL"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Network</th><th align="left">Next-Hop</th><th align="left">Link</th><th align="left">Prec</th></tr>
<tr>
<td align="left">fe80::/64</td>
<td align="left">::</td>
<td align="left">eth1</td>
<td align="left">500</td>
</tr>
<tr>
<td align="left">fe80::200:ff:fec4:b/128</td>
<td align="left">::</td>
<td align="left">lo</td>
<td align="left">500</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 8: Routing Table for fe80::200:ff:fec4:b%eth1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Aleksi Suhonen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tampere University of Technology, Finland</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korkeakoulunkatu 1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tampere  33720</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">FI</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 45 670 2048</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:i-d-2010@ssd.axu.tm">i-d-2010@ssd.axu.tm</a></td></tr>
</table>
</body></html>
