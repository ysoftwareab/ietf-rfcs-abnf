XML-param = ""
XML-value = text

text-list = \text+
uri = element uri { xsd:anyURI }
date = element date {
     xsd:string { pattern = "\d{8}|\d{4}-\d\d|--\d\d(\d\d)?|---\d\d" }
   }
time = element time {
     xsd:string { pattern = "(\d\d(\d\d(\d\d)?)?|-\d\d(\d\d?)|--\d\d)"
                          ~ "(Z|[+\-]\d\d(\d\d)?)?" }
   }
date-time = element date-time {
     xsd:string { pattern = "(\d{8}|--\d{4}|---\d\d)T\d\d(\d\d(\d\d)?)?"
                          ~ "(Z|[+\-]\d\d(\d\d)?)?" }
   }
date-and-or-time = date | date-time | time
timestamp = element timestamp {
     xsd:string { pattern = "\d{8}T\d{6}(Z|[+\-]\d\d(\d\d)?)?" }
   }
boolean = element boolean { xsd:boolean }
integer = element integer { xsd:integer }
float = element float { xsd:float }
binary = element binary { xsd:base64Binary }
language-tag = element language-tag {
     xsd:string { pattern = "([a-z]{2,3}((-[a-z]{3}){0,3})?|[a-z]{4,8})"
                          ~ "(-[a-z]{4})?(-([a-z]{2}|\d{3}))?"
                          ~ "(-([0-9a-z]{5,8}|\d[0-9a-z]{3}))*"
                          ~ "(-[0-9a-wyz](-[0-9a-z]{2,8})+)*"
                          ~ "(-x(-[0-9a-z]{1,8})+)?|x(-[0-9a-z]{1,8})+|"
                          ~ "[a-z]{1,3}(-[0-9a-z]{2,8}){1,2}" }
   }

language = element language { language-tag }?
pref = element pref {
     xsd:integer { minInclusive = "1" maxInclusive = "100" }
   }?
pid = element pid {
     xsd:string { pattern = "\d+(\.\d+)?" }
   }?
type = element type {
     element work { empty }?,
     element home { empty }?
   }?

source = element source {
     element parameters { pid, pref },
     uri
   }
name = element name { \text }
kind = element kind {
     element individual { empty }
     | element group { empty }
     | element org { empty }
     | element location { empty }
   }
fn = element fn {
     element parameters { language, pid, pref, type }?,
     \text
   }
n = element n {
     element parameters { language }?,
     element surname { text-list },
     element given { text-list },
     element prefix { text-list },
     element suffix { text-list }
   }
nickname = element nickname {
     element parameters { language, pid, pref, type }?,
     text-list
   }
photo = element photo {
     element parameters {
       pid,
       pref,
       element type {
         element work { empty }?,
         element home { empty }?,
         element media { \text }?
       }
     }?,
     (binary | uri)
   }
bday = element bday { date-and-or-time | \text }
dday = element dday { date-and-or-time | \text }
birth = element birth {
     element parameters { language }?,
     \text
   }
death = element death {
     element parameters { language }?,
     \text
   }
anniversary = element anniversary { date-and-or-time | \text }
sex = element sex { "0" | "1" | "2" | "9" }
adr = element adr {
     element parameters {
       language,
       pid,
       pref,
       type,
       element geo { uri }?,
       element tz { \text | uri }?
     }?,
     element pobox { text-list },
     element ext { text-list },
     element street { text-list },
     element locality { text-list },
     element region { text-list },
     element code { text-list },
     element country { text-list }
   }
label = element label {
     element parameters { language, pid, pref, type }?,
     \text
   }
tel = element tel {
     element parameters {
       pid,
       pref,
       element type {
         element work { empty }?,
         element home { empty }?,
         element text { empty }?,
         element voice { empty }?,
         element fax { empty }?,
         element cell { empty }?,
         element video { empty }?,
         element pager { empty }?
       }?
     },
     uri
   }
email = element email {
     element parameters { pid, pref, type }?,
     \text
   }
impp = element impp {
     element parameters { pid, pref, type }?,
     uri
   }
lang = element lang {
     element parameters { pid, pref, type }?,
     language-tag
   }
tz = element tz {
     element parameters { pid, pref, type }?,
     (\text | uri)
   }
geo = element geo {
     element parameters { pid, pref, type }?,
     uri
   }
title = element title {
     element parameters { language, pid, pref, type }?,
     \text
   }
role = element role {
     element parameters { language, pid, pref, type }?,
     \text
   }
logo = element logo {
     element parameters {
       language,
       pid,
       pref,
       element type {
         element work { empty }?,
         element home { empty }?,
         element media { \text }?
       }
     }?,
     (binary | uri)
   }
org = element org {
     element parameters { language, pid, pref, type }?,
     text-list
   }
member = element member { pid, pref, uri }
related = element related {
     element parameters {
       pid,
       pref,
       element type {
         element work { empty }?,
         element home { empty }?,
         (  element parent { empty }
          | element child { empty }
          | element sibling { empty }
          | element spouse { empty }
          | element family { empty }
          | element friend { empty }
          | element supervisor { empty }
          | element supervisee { empty }
          | element assistant { empty }
          | element colleague { empty }
          | element agent { empty }
          | element emergency { empty })
       }?
     }?,
     (uri | \text)
   }
categories = element categories {
     element parameters { pid, pref, type }?,
     \text
   }
note = element note {
     element parameters { language, pid, pref, type }?,
     \text
   }
prodid = element prodid { \text }
rev = element rev { timestamp }
sort-string = element sort-string { \text }
sound = element sound {
     element parameters {
       language,
       pid,
       pref,
       element type {
         element work { empty }?,
         element home { empty }?,
         element media { \text }?
       }
     }?,
     (binary | uri)
   }
uid = element uid { uri }
clientpidmap = element clientpidmap {
     element sourceid { xsd:positiveInteger },
     uri
   }
url = element url {
     element parameters { pid, pref, type }?,
     uri
   }
class = element class { "PUBLIC" | "PRIVATE" | "CONFIDENTIAL" }
key = element key {
     element parameters {
       pid,
       pref,
       element type {
         element work { empty }?,
         element home { empty }?,
         element media { \text }?
       }
     }?,
     (binary | uri)
   }
fburl = element fburl {
     element parameters { pid, pref, type }?,
     uri
   }
caladruri = element caladruri {
     element parameters { pid, pref, type }?,
     uri
   }
caluri = element caluri {
     element parameters { pid, pref, type }?,
     uri
   }

property = adr | anniversary | bday | birth | caladruri | caluri
          | categories | class | clientpidmap | dday | death | email
          | fburl | fn | geo | impp | key | kind | label | lang | logo
          | member | n | name | nickname | note | org | photo | prodid
          | related | rev | role | sex | sort-string | sound | source
          | tel | title | tz | uid | url
start = element vcards {
     element vcard {
       (property
        | element group {
            attribute name { text },
            property*
          })+
     }+
   }


