

   NEMO Working Group                                    V. Pangboonyanon 
   INTERNET DRAFT                                              A. Udugama 
   Expires: September 28, 2007                                   C. Goerg 
                                       ComNets-ikom, University of Bremen 
                                                              F. Pittmann 
                                                         Siemens Networks 
                                                               E. Plasser 
                                   Siemens IT Solutions and Services GmbH 
                                                           March 29, 2007 
                                      
                                      
                 Optimized Routing in Nested NEMO Networks  
             draft-varaporn-nemo-optimized-nested-nemo-01.txt 
    
    
   Status of this Memo 
    
   By submitting this Internet-Draft, each author represents that any 
   applicable patent or other IPR claims of which he or she is aware 
   have been or will be disclosed, and any of which he or she becomes 
   aware will be disclosed, in accordance with Section 6 of BCP 79. 
    
   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that 
   other groups may also distribute working documents as Internet- 
   Drafts. 
    
   Internet-Drafts are draft documents valid for a maximum of six 
   months and may be updated, replaced, or obsoleted by other documents 
   at any time. It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 
    
   The list of current Internet-Drafts can be accessed at 
   http://www.ietf.org/ietf/1id-abstracts.txt. 
    
   The list of Internet-Draft Shadow Directories can be accessed at 
   http://www.ietf.org/shadow.html. 
    
   This Internet-Draft will expire on September 28, 2007. 
    
   Copyright Notice 
    
   Copyright (C) The IETF Trust (2007).
    
    
    
   Abstract 
    
   In nested mobile networks (NEMO), packets that are routed from/to any 
   nodes inside the nested NEMO have additional overheads (i.e., bi-
   directional tunnels) and delays. These additional overheads and 
   delays increase respectively to the depth of the current location of 
   the node in nested NEMO since the packets have to go through all the 
 
Varaporn, et al.      Expires September 28, 2007               [Page 1] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
   HAs of the MRs along the path to an endpoint. This draft provides a 
   solution to this problem, providing optimizations to the nested NEMO 
   concept thereby making it worthwhile to implement the nested NEMO 
   concept.  
    
   Table of Contents 
    
   1.Introduction.....................................................2 
   2 Terminology......................................................3 
   3. Protocol Overview...............................................4 
   4 Protocol Operations..............................................6 
   4.1 Care-of-Address (CoA) assignment for VMNs in nested NEMO.......6 
   4.2 Use of Routing Header..........................................6 
   4.3 Extended Binding Update........................................7 
   4.4 Data Transmission..............................................8 
   4.4.1 For incoming packets.........................................8 
   4.4.2 For outgoing packets.........................................9 
   References........................................................10 
   Authors' Addresses................................................10 
    
    
1.Introduction 
    
   According to the current IETF NEMO standardization [1], NEMO 
   introduces the Mobile Router (MR) concept where an MR provides 
   mobility for connected Mobile Network Nodes (MNNs) or other Mobile 
   Routers (MRs), which can lead to the creation of nested structures 
   within the overall moving network. All incoming and outgoing traffic 
   of MNNs, joining a nested moving network by connecting to the nested 
   MRs must go through bi-directional tunnels established between the 
   corresponding MRs and their HAs.  
    
   Figure 1 shows how the traffic of a MNN connected to a MR (MR3) is 
   routed via all HAs of the MRs of the nested moving network, 
   traversing through different networks.  
    
                         +--+          +------+   
                         |CN|          |MR3_HA|   
                         +--+          +------+   
                          |                |       
             +------+   +-------------------+  +------+ 
             |MR1_HA|--|     Internet      |--|MR2_HA| 
             +------+  +-------------------+  +------+ 
                          | 
                        +---+ 
                        |MR1|                                                
                        +---+     
                          | 
                         -------- 
    
Varaporn, et al.      Expires September 28, 2007               [Page 2] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
                         |      | 
                       +---+  +---+ 
                       |MNN|  |MR2| 
                       +---+  +---+ 
                                 | 
                              -------- 
                              |      | 
                            +---+  +---+ 
                            |MNN|  |MR3| 
                            +---+  +---+ 
                                      | 
                                  --------- 
                                  |       | 
                                +---+   +----+ 
                                |MNN|   |MNN1| 
                                +---+   +----+ 
 
                Figure 1: An example of nested Mobile Network 
 
   Using the basic NEMO concept, the traffic flow in Figure 1 between 
   an MMN and CN will be required to go through all the HAs of the MRs 
   along the path. The path will therefore be as shown in Figure 2.  
    
         1       2       3       4          3          2          1 
   MNN1 --- MR3 --- MR2 --- MR1 --- MR1_HA --- MR2_HA --- MR3_HA --- CN 
 
           Note: The digits represent the number of IPv6 headers. 
 
            Figure 2: The Traffic Flow Path between MNN1 and CN 
 
   Although such an arrangement allows MNNs to reach and be reached 
   always by any node on the Internet, ultimately, a host of problems 
   arise for the nested moving networks and their connected MNNs, as 
   discussed in [3,4]. 
    
   This draft describes a new mechanism to change the way in which 
   nested moving networks operate thereby optimizing the performance of 
   nested moving networks, while considering the afore mentioned 
   problems and additionally making it worthwhile to implement such a 
   structure. This solution leads to the reduced use of tunnels, 
   reduced communication delays, eliminating the visiting nodes’ 
   traffic to other MRs’ home networks and limiting the number of 
   traversed networks. 
    
2 Terminology 
    
   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
   document are to be interpreted as described in RFC-2119. 
    
Varaporn, et al.      Expires September 28, 2007               [Page 3] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
    
   This document uses the following terms: 
    
   Home Agent (HA) 
            As defined in [2]. 
    
   Correspondent Node (CN) 
             As defined in [2]. 
    
   Mobile Router (MR) 
            As defined in [2]. 
    
   Mobile Network Node (MNN) 
            As defined in [2]. 
    
   Visiting Mobile Node (VMN) 
            As defined in [2]. 
    
   Top Level Mobile Router (TLMR) 
           A Mobile Router that has a point of attachment directly to 
           the Internet or an operator network, and provides the 
           connectivity to other Visiting Mobile Nodes. 
    
   Home Address (HoA) 
            As defined in [5]. 
    
   Care-Of Address (CoA) 
            As defined in [5]. 
    
   Binding Update (BU) 
           Mobile IP signaling with the purpose of establishing or 
           updating a mobility binding. 
    
   Routing Header (RH) 
           A routing header may be present as an IPv6 header extension, 
           and indicates that the payload has to be delivered to a 
           destination IPv6 address in some way that is different from 
           what would be carried out by standard Internet routing.  In 
           this document, use of the term "routing header" typically 
           refers to use of a type 0 and 5 routing header. 
    
    
3. Protocol Overview 
    
The basic idea is to reduce the overheads of the tunneling and the 
delay of traffic toward all Home Agents (HAs) in nested NEMO. An 
additional constraint that is considered is the restriction  that all 
traffic  related  to  different  networks  travel  through  their  home 
networks,  without  utilizing  standard  Mobile  IP  route  optimization 
mechanisms. This restriction is highly relevant for MNO environments 
where the MNOs would require that all traffic traverse through the 
    
Varaporn, et al.      Expires September 28, 2007               [Page 4] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
respective  MNOs  network.  Therefore,  this  means  that  within  this 
mechanism it is assumed that the traffic of each MR shall go through 
its home network.  
 
This solution extends the functionality of a MR when it acts as a Top 
Level  Mobile  Router  (TLMR)  where  it  switches  between  the  source 
address/destination address and routing headers for outgoing/incoming 
packets respectively. Any packet destined to any node has the same 
header length regardless of the location of the node in the hierarchy. 
The outgoing packets from a node located in any level inside the mobile 
network will go only through the node’s home agent (HA). Another 
assumption of this solution is that the routing protocol inside nested 
NEMO is an ad hoc networking (MANET) protocol. Figure 3 illustrates 
this solution. 
 
 
                           
                         +--+          +------+   
                  oooooo>|CN|<xxxxxxxxx|MR3_HA|   
                  o      +--+          +x-----+   
                  o       |xxxxxxxxxxxxxx |       
             +----o-+   +--x----------------+  
             |MR2_HA|--|  x  Internet      | 
             +----oo+oo+o-x----------------+ 
                         o|x 
                 -------o-x-       
                  |      o|x 
              +------+   +--+ 
              |MR1_HA|   |AP| 
              +------+   +--+ 
                         o|x 
                      ---o-x---- 
                         o|x 
                       +-----+ 
                       | MR1/| <--Switch between the destAddr/srcAddr 
                       |TLMR |    and RH0/RH5 for outgoing/incoming 
                       +-----+    respectively 
                         o|xxxxxxx 
                  -------ooooooo-x 
                  |      |     V|x 
                +---+  +---+  +---+ 
                |MNN|  |MNN|  |MR2| 
                +---+  +---+  +--x+ 
                                 |xxxxxx 
                              --------x 
                              |      |V 
    
Varaporn, et al.      Expires September 28, 2007               [Page 5] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
                            +---+  +---+ 
                            |MNN|  |MR3| 
                            +---+  +---+ 
                                      | 
                                  --------- 
                                  |       | 
                                +---+   +---+ 
                                |MNN|   |MNN| 
                                +---+   +---+ 
 
 Figure 3: The Traffic Flow in Nested NEMO with the proposed solution 
 
This  solution  as  described  in  the  following  section  extends  the 
functionality of the TLMR and of the HA which include the address 
configuration of TLMR and nested MRs, as well as the definition and use 
of a new Routing Header called RH5. Finally, the specification of 
additional functionalities of the elements HA, TLMR and nested MRs are 
explained towards the end of this section. 
    
    
4 Protocol Operations 
    
4.1 Care-of-Address (CoA) assignment for VMNs in nested NEMO 
 
A MR, which directly connects to an Access Router (AR) which maybe a 
Foreign Router (FR) or aHome Router (HR), as depicted in Figure 3 (i.e. 
MR1 as a TLMR), configures a Care-of Address (CoA) from the Router 
Advertisements  (RA)  using  the  Stateless  Address  Auto-configuration 
Procedure. For nested MRs, i.e. MR2 and MR3, the TLMR broadcasts MIPv6 
RA messages, with the ‘R’ flag set as defined in [5], section 7.2, to 
indicate that it advertises the TLMR’s address rather than a prefix. 
Additionally, the solution proposes a ‘T’ flag to the RA message that 
informs the RA recipients that the TLMR address can be used as a CoA. 
Nested MRs always use the current egress IP address of the TLMR as 
their CoAs. Therefore, if the TLMR is connected to its home network, a 
nested MR uses the home address (HoA) of the TLMR as its CoA, and if 
the TLMR is connected to a foreign network, the nested MRs will use the 
TLMRs  CoA. When the TLMR gets a new CoA, all nested MRs have to change 
their CoAs accordingly. 
 
4.2 Use of Routing Header 
 
There are two types of Routing Headers used in this solution. One is 
Type 0 Routing Header (RH0) as defined in [6] for incoming packets. For 
outgoing packets, the mechanism proposes a new Routing Header called 
Type 5 (RH5) that modifies Type 4 Routing Header (RH4) as defined in 
[7]. The modification is as follows: 
    
Varaporn, et al.      Expires September 28, 2007               [Page 6] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
 
  . A MNN generates a packet to a Correspondent Node (CN) 
  . The MR encapsulates the packet by adding its HoA to the source and 
     its HA’s address to the destination. 
  . The MR adds the current TLMR egress address to the Routing Header 
     5 and sends it 
  . The packet first reaches the TLMR 
  . When the TLMR receives the packet, it verifies whether the address 
     in Routing Header 5 is its egress address or not. If it is the 
     egress address, it adds it to the source address and puts the 
     current source address to the Routing Header 
 
Figure 4 illustrates the use of RH5, when TLMR is at home network and 
in foreign networks. 
 
        TLMR is in its home network 
              ____________________ 
             |                    | 
             V                    V 
            Src       Dest       RH5 
         ------------------------------------------------- 
        | HoA_VMN |    CN    | HoA_TLMR |       Data      | 
         ------------------------------------------------- 
                      
        TLMR is in a foreign network 
              ____________________ 
             |                    | 
             V                    V 
            Src       Dest       RH5 
         ------------------------------------------------- 
        | HoA_VMN |    CN    | CoA_TLMR |       Data      | 
         ------------------------------------------------- 
 
                Figure 4: Type 5 Routing Header 
 
4.3 Extended Binding Update  
 
Since the nested MR can identify whether it is a nested mobile network 
from the modified RA (with ‘T’ flag), it reflects this in the Binding 
Update (BU) it sends, by adding an additional flag called ‘N’ informing 
that it is a nested moving network. Therefore, this solution also 
proposes the creation of an ‘N’ flag in the BU message for the binding 
update mechanism at the HA. When the HA receives a BU, it should store 
the  current  value  of  this  flag  in  its  binding  cache.  The  HA, 
subsequently uses this flag to determine whether it should add a RH0 to 
an incoming packet or not. 
    
Varaporn, et al.      Expires September 28, 2007               [Page 7] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
 
4.4 Data Transmission 
 
To explain the  additional operations that must be undertaken by the 
functional elements HA, TLMR and nested MRs, this section describes the 
issue  of  address  configuration.  This  solution  proposes  that  the 
address, which is used for routing packets inside the nested NEMO by 
the TLMR, MUST be the HoA of MR (i.e. MR2 and MR3). For packets that 
are routed to the outside, it MUST use the CoA as explained above. 
Therefore, the TLMR, the nested MRs and the HA of each moving network 
inside the nested NEMO, perform additional tasks to support these 
additional functions, separately for incoming and outgoing packets:  
 
4.4.1 For incoming packets 
  At HA:  
  . The HA identifies whether the incoming packets are to the nested 
     moving network or to a MR directly connected to an AR by checking 
     the ‘N’ flag in the binding cache.  
  . If it is for the nested NEMO, it adds the RH0 with the MR’s HoA 
     for incoming packets (refer to Figure 5).  
 
  At TLMR:  
  . The TLMR can know whether the incoming packets are destined to the 
     nested mobile network by checking whether the IP header contains 
     Routing Headers (i.e. RH0).  
  . For  the  incoming  packets  the  TLMR  must  switch  between  the 
     destination address and the RH0 (refer to Figure 5).  
 
  At VMN in nested NEMO: 
  . For the incoming packets, it will remove the tunnel as explained 
     in standard NEMO [1]. 
   
  Figure 5 illustrates the processing of incoming packets with the 
  proposed solution. 
   
    TLMR is in its home network 
                    __________ 
                   |          | 
                   V          V 
        Src       Dest       RH0  |  Src     Dest        
     --------------------------------------------------------------- 
    |  HA_MR  | HoA_TLMR | HoA_MR |  CN   | HoA_MNN |     Data      | 
     --------------------------------------------------------------- 
             Outer Header         |   Inner Header 
     
    TLMR is in a foreign network 
    
Varaporn, et al.      Expires September 28, 2007               [Page 8] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
                    __________ 
                   |          | 
                   V          V  
        Src       Dest       RH0  |  Src     Dest        
     --------------------------------------------------------------- 
    |  HA_MR  | CoA_TLMR | HoA_MR |  CN   | HoA_MNN |     Data      | 
     --------------------------------------------------------------- 
             Outer Header         |   Inner Header 
 
           Figure 5: Incoming Packet for the Proposed Mechanism  
   
4.4.2 For outgoing packets 
  At HA: 
  . For the outgoing packets processing is handled as explained in 
     standard NEMO [1]. 
   
  At TLMR: 
  . For the outgoing packets the TLMR switches the source address 
     between the IP header and the newly proposed RH5 (refer to Figure 
     6). 
   
  At VMN in nested NEMO: 
  . For the outgoing packets, it adds the tunnel as explained in 
     standard NEMO [1] and additionally, the proposed RH5 (refer to 
     Figure 6). 
 
  Figure 6 illustrates the processing of outgoing packets with the 
  proposed solution. 
   
    TLMR is in its home network 
          ____________________ 
         |                    | 
         V                    V 
        Src       Dest       RH5  |   Src     Dest       
     --------------------------------------------------------------- 
    |  HoA_MR  | HA_MR | HoA_TLMR | HoA_MNN |  CN  |     Data       | 
     --------------------------------------------------------------- 
             Outer Header         |   Inner Header 
 
    TLMR is in a foreign network 
          ____________________ 
         |                    | 
         V                    V 
        Src       Dest       RH5  |    Src     Dest      
     --------------------------------------------------------------- 
    |  HoA_MR  | HA_MR | CoA_TLMR | HoA_MNN |  CN  |     Data       | 
    
Varaporn, et al.      Expires September 28, 2007               [Page 9] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
     --------------------------------------------------------------- 
             Outer Header         |   Inner Header 
 
           Figure 6: Outgoing Packet for the Proposed Mechanism  
 
    
References 
    
   [1]  V. Devarapalli, R. Wakikawa, A. Petrescu, and P. Thubert, 
        "Network Mobility (NEMO) Basic Support Protocol," RFC 3963, 
        IETF January 2005. 
   [2]  T. Ernst and H.-Y. Lach, "Network Mobility Support 
        Terminology," draft-ietf-nemo-terminology-04, 2005 
   [3]  C. Ng, P. Thubert, M. Watari, and F. Zhao, "Network Mobility 
        Route Optimization Problem Statement," draft-ietf-nemo-ro-
        problem-statement-02, December 28, 2005. 
   [4]  C. Ng, F. Zhao, M. Watari, and P. Thubert, "Network Mobility 
        Route Optimization Solution Space Analysis," draft-ietf-nemo-
        ro-space-analysis-02, February 10, 2006. 
   [5]  D. Johnson and C. Perkins, "Mobility Support in IPv6," RFC 
        3775, IETF June 2004.    
   [6]  S. Deering and R. Hinden, "Internet Protocol, Version 6 (IPv6) 
        Specification," RFC 2460, December, 1998. 
   [7]  P. Thubert and M. Molteni, "IPv6 Reverse Routing Header and its 
        application to Mobile Networks," draft-thubert-nemo-reverse-
        routing-header-05, June, 2004. 
    
Authors' Addresses 
 
Varaporn Pangboonyanon    
Department of Communication Networks (ComNets)   
Center for Information and Communication Technology (ikom)   
University of Bremen   
28219 Bremen, Germany   
Phone:  +49-421-218-8264  
Email:  fon@comnets.uni-bremen.de  
URI:    www.comnets.uni-bremen.de/~fon  
               
Asanga Udugama   
Department of Communication Networks (ComNets)   
Center for Information and Communication Technology (ikom)   
University of Bremen   
28219 Bremen, Germany  
Phone:  +49-421-218-8665  
Email:  adu@comnets.uni-bremen.de  
URI:    www.comnets.uni-bremen.de/~adu  
               
Carmelita Goerg   
Department of Communication Networks (ComNets)   
    
Varaporn, et al.      Expires September 28, 2007              [Page 10] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
Center for Information and Communication Technology (ikom)   
University of Bremen   
28219, Bremen, Germany   
Phone:  +49-421-218-2277  
Email:  cg@comnets.uni-bremen.de  
URI:    www.comnets.uni-bremen.de/~cg  
               
Frank Pittmann   
Communications Mobile Networks Research   
Siemens Networks GmbH & Co. KG   
13627 Berlin, Germany   
Phone:  +49-30-386-29387  
Email:  frank.pittmann@siemens.com  
URI:    www.siemens.com  
               
Erich Plasser  
Siemens IT Solutions and Services GmbH  
PSE, Program and System Development  
Autokaderstraße 29, A-1210 Vienna   
Phone:  +43-51707-21475  
Email:  erich.plasser@siemens.com  
URI:    www.siemens.com 
    
Intellectual Property Statement 
 
The IETF takes no position regarding the validity or scope of any 
Intellectual Property Rights or other rights that might be claimed to 
pertain to the implementation or use of the technology described in 
this document or the extent to which any license under such rights 
might or might not be available; nor does it represent that it has made 
any independent effort to identify any such rights.  Information on the 
procedures with respect to rights in RFC documents can be found in BCP 
78 and BCP 79. 
 
Copies of IPR disclosures made to the IETF Secretariat and any 
assurances of licenses to be made available, or the result of an 
attempt made to obtain a general license or permission for the use of 
such proprietary rights by implementers or users of this 
specification can be obtained from the IETF on-line IPR repository at 
http://www.ietf.org/ipr. 
 
The IETF invites any interested party to bring to its attention any 
copyrights, patents or patent applications, or other proprietary 
rights that may cover technology that may be required to implement 
this standard.  Please address the information to the IETF at 
ietf-ipr@ietf.org. 
 
 
Disclaimer of Validity 
 
    
Varaporn, et al.      Expires September 28, 2007              [Page 11] 
Internet Draft       Optimized Routing in Nested NEMO        March 2007 
 
 
This document and the information contained herein are provided on an 
"AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND 
THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR 
IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE 
INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 
 
 
Copyright Statement 
 
Copyright (C) The Internet Society (2006).  This document is subject 
to the rights, licenses and restrictions contained in BCP 78, and 
except as set forth therein, the authors retain all their rights. 
 
 
Acknowledgment 
 
Funding for the RFC Editor function is currently provided by the 
Internet Society. 
    
    
Varaporn, et al.      Expires September 28, 2007              [Page 12] 