<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The GNU Name System</title>
<meta content="Martin Schanzenbach" name="author">
<meta content="Christian Grothoff" name="author">
<meta content="Bernd Fix" name="author">
<meta content="
       
      This document contains the GNU Name System (GNS) technical
      specification.
      GNS is a decentralized and censorship-resistant name
      system that provides a privacy-enhancing alternative to the Domain
      Name System (DNS).
       
       
       
      This document defines the normative wire format of resource records,
      resolution processes, cryptographic routines and security
      considerations for use by implementers.
      It is published here to inform readers about the function
      of GNS, guide future GNS implementations, and ensure
      interoperability among implementations including with the
      pre-existing GNUnet implementation.
       
       
      This specification was developed outside the IETF and does not have
      IETF consensus.  It is published here to guide implementation of GNS
      and to ensure interoperability among implementations.
       
    " name="description">
<meta content="xml2rfc 3.12.1" name="generator">
<meta content="name systems" name="keyword">
<meta content="draft-schanzen-gns-08" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-schanzen-gns-08-w12r2le2.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The GNU Name System</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Schanzenbach, et al.</td>
<td class="center">Expires 19 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Independent Stream</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-schanzen-gns-08</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-15" class="published">15 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-19">19 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Schanzenbach</div>
<div class="org">GNUnet e.V.</div>
</div>
<div class="author">
      <div class="author-name">C. Grothoff</div>
<div class="org">Berner Fachhochschule</div>
</div>
<div class="author">
      <div class="author-name">B. Fix</div>
<div class="org">GNUnet e.V.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The GNU Name System</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
      This document contains the GNU Name System (GNS) technical
      specification.
      GNS is a decentralized and censorship-resistant name
      system that provides a privacy-enhancing alternative to the Domain
      Name System (DNS).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
      This document defines the normative wire format of resource records,
      resolution processes, cryptographic routines and security
      considerations for use by implementers.
      It is published here to inform readers about the function
      of GNS, guide future GNS implementations, and ensure
      interoperability among implementations including with the
      pre-existing GNUnet implementation.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
      This specification was developed outside the IETF and does not have
      IETF consensus.  It is published here to guide implementation of GNS
      and to ensure interoperability among implementations.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-notation" class="xref">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-overview" class="xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-zones" class="xref">Zones</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-zone-top-level-domain" class="xref">Zone Top-Level Domain</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-zone-revocation" class="xref">Zone Revocation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-resource-records" class="xref">Resource Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-zone-delegation-records" class="xref">Zone Delegation Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-pkey" class="xref">PKEY</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-edkey" class="xref">EDKEY</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-redirection-records" class="xref">Redirection Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-redirect" class="xref">REDIRECT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-gns2dns" class="xref">GNS2DNS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-auxiliary-records" class="xref">Auxiliary Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-leho" class="xref">LEHO</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-nick" class="xref">NICK</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="xref">5.3.3</a>.  <a href="#name-box" class="xref">BOX</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-record-storage" class="xref">Record Storage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-the-storage-key" class="xref">The Storage Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-the-records-block" class="xref">The Records Block</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-name-resolution" class="xref">Name Resolution</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-start-zones" class="xref">Start Zones</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-recursion" class="xref">Recursion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-record-processing" class="xref">Record Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="xref">7.3.1</a>.  <a href="#name-redirect-2" class="xref">REDIRECT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="xref">7.3.2</a>.  <a href="#name-gns2dns-2" class="xref">GNS2DNS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="xref">7.3.3</a>.  <a href="#name-box-2" class="xref">BOX</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-7.3.4" class="xref">7.3.4</a>.  <a href="#name-zone-delegation-records-2" class="xref">Zone Delegation Records</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a href="#section-7.3.5" class="xref">7.3.5</a>.  <a href="#name-nick-2" class="xref">NICK</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-internationalization-and-ch" class="xref">Internationalization and Character Encoding</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-and-privacy-consid" class="xref">Security and Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-availability" class="xref">Availability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-agility" class="xref">Agility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-cryptography" class="xref">Cryptography</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-abuse-mitigation" class="xref">Abuse Mitigation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-zone-management" class="xref">Zone Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="xref">9.6</a>.  <a href="#name-impact-of-dhts-as-underlyin" class="xref">Impact of DHTs as Underlying Storage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="xref">9.7</a>.  <a href="#name-revocations" class="xref">Revocations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="xref">9.8</a>.  <a href="#name-label-guessing" class="xref">Label Guessing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-gana-considerations" class="xref">GANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-implementation-and-deployme" class="xref">Implementation and Deployment Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-base32gns" class="xref">Base32GNS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
       The Domain Name System (DNS) <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> is a unique
       distributed database and a vital service for most Internet applications.
       While DNS is distributed, in practice it
       relies on centralized, trusted registrars to provide globally unique
       names. As the awareness of the central role DNS plays on the Internet
       rises, various institutions are using their power (including legal means)
       to engage in attacks on the DNS, thus threatening the global availability
       and integrity of information on the Internet.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
       DNS was not designed with security in mind. This makes it very
       vulnerable, especially to attackers that have the technical capabilities
       of an entire nation state at their disposal.
       While a wider discussion of this issue is out of scope for this document,
       analyses and investigations can be found in recent academic research
       works including <span>[<a href="#SecureNS" class="xref">SecureNS</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
       This specification describes a censorship-resistant, privacy-preserving
       and decentralized name system: The GNU Name System (GNS) <span>[<a href="#GNS" class="xref">GNS</a>]</span>.
       It is designed to provide a secure, privacy-enhancing alternative to
       DNS, especially when censorship or manipulation is encountered.
       In particular, it directly addresses concerns in DNS with respect to "Query
       Privacy", the "Single Hierarchy with a Centrally Controlled Root" and
       "Distribution and Management of Root Servers" as raised in
       <span>[<a href="#RFC8324" class="xref">RFC8324</a>]</span>.
       GNS can bind names to any kind of
       cryptographically secured token, enabling it to double in some respects as
       even as an alternative to some of today's Public Key Infrastructures, in
       particular X.509 for the Web.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
       The design of GNS incorporates the capability to integrate and
       coexist with DNS.
       GNS is based on the principle of a petname
       system and builds on ideas from the Simple Distributed Security
       Infrastructure <span>[<a href="#SDSI" class="xref">SDSI</a>]</span>, addressing a central issue with the decentralized
       mapping of secure identifiers to memorable names: namely the impossibility
       of providing a global, secure and memorable mapping without a trusted
       authority. GNS uses the transitivity in the SDSI design to replace the
       trusted root with secure delegation of authority thus making petnames
       useful to other users while operating under a very strong adversary model.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
       This is an important distinguishing factor from the Domain Name System
       where root zone governance is centralized at the Internet Corporation
       for Assigned Names and Numbers (ICANN).
       In DNS terminology, GNS roughly follows the idea of a hyperlocal root
       zone deployment, with the difference that it is not
       expected that all deployments use the same local root zone,
       and that users can easily delegate control of arbitrary domain names to
       arbitrary zones.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
       This document defines the normative wire format of resource records, resolution processes,
       cryptographic routines and security considerations for use by implementers.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">
       This specification was developed outside the IETF and does not have
       IETF consensus.  It is published here to guide implementation of GNS
       and to ensure interoperability among implementations.<a href="#section-1-7" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">
         The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
         "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
         "OPTIONAL" in this document are to be interpreted as described in
         BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only
         when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">Label</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.2">
         A GNS label is a label as defined in <span>[<a href="#RFC8499" class="xref">RFC8499</a>]</span>.
         Within this document, labels are always assumed to be strings of
         UTF-8 characters <span>[<a href="#RFC8499" class="xref">RFC8499</a>]</span> with a maximum length of
         63 bytes for compatibility with applications enforcing DNS legacy
         limitations.
         Labels MUST follow the format as defined in the
         "Nameprep" profile in <span>[<a href="#RFC3491" class="xref">RFC3491</a>]</span>.
         Notably, this means that labels are assumed to be case-folded and
         special characters including spaces are forbidden.<a href="#section-2-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">Apex Label</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.4">
         The apex label is represented using the character "@" (without
         quotes).
         The apex label is used to publish resource
         records in a zone that can be resolved without providing a specific
         label. It is the GNS method to provide what is the "zone apex" in DNS
         <span>[<a href="#RFC4033" class="xref">RFC4033</a>]</span>.<a href="#section-2-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">Name</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.6">
         A name in GNS is a domain name as defined in  <span>[<a href="#RFC8499" class="xref">RFC8499</a>]</span>
         as an ordered list of labels.
         Names, like labels, are encoded in UTF-8.
         The labels in a name are separated using the unicode dot character
         U+002E.<a href="#section-2-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">Top-Level Domain</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.8">
  The rightmost part of a GNS name is a GNS Top-Level Domain (TLD).
         A GNS TLD may consist of one or more labels.
  Unlike DNS Top-Level Domains (defined in <span>[<a href="#RFC8499" class="xref">RFC8499</a>]</span>),
  GNS does not expect all users to use the same global root zone. Instead,
         with the exception of Zone Top-Level Domains (see below),
         GNS TLDs are typically part of the configuration of the local resolver
         (see <a href="#governance" class="xref">Section 7.1</a>), and may thus not be globally unique.<a href="#section-2-1.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.9">Zone</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.10">
         A GNS zone contains authoritative information (resource records).
         A zone is uniquely identified by its zone key.  Unlike DNS zones,
         a GNS zone does not need to have a SOA record under the apex label.<a href="#section-2-1.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.11">Zone Type</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.12">
         The type of a GNS zone determines the cipher system and binary encoding
  format of the zone key, blinded zone keys, and signatures.<a href="#section-2-1.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.13">Zone Key</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.14">
         The zone key uniquely identifies a zone.
         The zone key is usually a public key of an asymmetric key pair.<a href="#section-2-1.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.15">Blinded Zone Key</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.16">
         A blinded zone key is derived from the zone key and a label.
         The zone key and the blinded zone key are unlinkable without knowledge of the label.<a href="#section-2-1.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.17">Zone Key Derivation Function</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.18">
         The zone key derivation function (ZKDF) blinds a key using a label.
         There are different functions for public and private keys, respectively.<a href="#section-2-1.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.19">Zone Owner</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.20">
         The owner of a GNS zone is the holder of the secret (typically a private key)
  that (together with a label and a value to sign) allows the creation of zone
  signatures that can be validated against the respective blinded zone key.<a href="#section-2-1.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.21">Zone Top-Level Domain</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.22">
         A GNS Zone Top-Level Domain (zTLD) is a sequence of GNS labels at
         the end of a GNS name which encodes a zone type and
         zone key of a zone.
         Due to the statistical uniqueness of zone keys, zTLDs are also globally unique.
  A zTLD label sequence can only be distinguished from ordinary TLD label sequences
  by attempting to decode the labels into a zone type and zone key.<a href="#section-2-1.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.23">Resource Record</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.24">
         A GNS resource record is the information associated with a label in a
         GNS zone.
         A GNS resource record contains information as defined by its
         resource record type.<a href="#section-2-1.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.25">Application</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.26">
         An application refers to a component which uses a GNS implementation
         to resolve names into records and processes its contents.<a href="#section-2-1.26" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">
       In GNS, any user may create and manage one or more cryptographically
       secured zones (<a href="#zones" class="xref">Section 4</a>).
       Zones are uniquely identified by a zone key.
       Zone contents are signed using blinded private keys and
       encrypted using derived secret keys.
       The zone type determines the respective set of cryptographic operations
       and the wire formats for encrypted data, public keys and signatures.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
       A zone can be populated with mappings from labels to resource records by
       its owner (<a href="#rrecords" class="xref">Section 5</a>).
       A label can be mapped to a delegation record which results in the
       corresponding subdomain being delegated to another zone. Circular
       delegations are explicitly allowed, including delegating a subdomain
       to its immediate parent zone.  In
       order to support (legacy) applications as well as to facilitate the use
       of petnames, GNS defines auxiliary record types in addition to
       supporting traditional DNS records.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
       Zone contents are encrypted and signed
       before being published in a distributed key-value storage
       (<a href="#publish" class="xref">Section 6</a>).
       In this process, unique zone identification is hidden from the network
       through the use of key blinding.
       Key blinding allows the creation of signatures for zone contents
       using a blinded public/private key pair.
       This blinding is realized using a deterministic key
       derivation from
       the original zone key and corresponding private key using record label values
       as blinding factors.
       Specifically, the zone owner can derive blinded private keys for each record
       set published under a label, and a
       resolver can derive the corresponding blinded public keys.
       It is expected that GNS implementations use distributed or decentralized
       storages such as distributed hash tables (DHT) in order to facilitate
       availability within a network without the need for dedicated infrastructure.
       Specification of such a distributed or decentralized storage is out of
       scope of this document, but possible existing implementations include those
       based on <span>[<a href="#RFC7363" class="xref">RFC7363</a>]</span>, <span>[<a href="#Kademlia" class="xref">Kademlia</a>]</span> or
       <span>[<a href="#R5N" class="xref">R5N</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
       Names in GNS are domain names as defined in <span>[<a href="#RFC8499" class="xref">RFC8499</a>]</span>.
       Starting from a configurable start zone, names are resolved by following zone
       delegations. For each label in a name, the recursive GNS resolver
       fetches the respective record from the storage layer (<a href="#resolution" class="xref">Section 7</a>).
       Without knowledge of the label values and the zone keys, the
       different derived keys are unlinkable both to the original zone key and to each
       other.
       This prevents zone enumeration (except via impractical online brute
       force attacks) and requires knowledge
       of both the zone key and the label to confirm affiliation of a
       query or the corresponding encrypted record set with a
       specific zone. At the same time, the blinded zone key provides
       resolvers
       with the ability to verify the integrity of the published information
       without disclosing the originating zone.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
       In the remainder of this document, the "implementer" refers to the developer building
       a GNS implementation including, for example, zone management tools and
       name resolution components.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="zones">
<section id="section-4">
      <h2 id="name-zones">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-zones" class="section-name selfRef">Zones</a>
      </h2>
<p id="section-4-1">
       A zone in GNS is uniquely identified by its zone type and zone key.
       Each zone can be represented by a Zone Top-Level Domain (zTLD) string.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
       A implementation SHOULD enable the user to create and manage zones.
       If this functionality is not implemented, names can still be resolved
       if zone keys for the initial step in the name resolution are available
       (see <a href="#resolution" class="xref">Section 7</a>).<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
       Each zone type (ztype) is assigned a unique 32-bit number when it is registered
       in the GNUnet Assigned Numbers Authority <span>[<a href="#GANA" class="xref">GANA</a>]</span>.
       The ztype determines which cryptosystem is used for the
       asymmetric and symmetric key operations of the zone.
       The ztype number always corresponds to a resource record type
       number identifying a delegation into a zone of this type. To
       ensure that there are no conflicts with DNS record types, ztypes
       are always assigned numeric values above 65535.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
       For any zone, let d be the private key and zk the public zone key.
       The specific wire format used depends on the ztype.
       The creation of zone keys for the default ztypes are specified in
       <a href="#gnsrecords_delegation" class="xref">Section 5.1</a>.
       New ztypes may be specified in the future, for example if the
       cryptographic mechanisms used in this document are broken.
       Any ztype MUST define the following set of cryptographic functions:<a href="#section-4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-5">
        <dt id="section-4-5.1">KeyGen() -&gt; d, zk</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.2">
         is a function to generate a new private key d and
  the corresponding public zone key zk.<a href="#section-4-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.3">ZKDF-Private(d,label) -&gt; d'</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.4">
         is a zone key derivation function which blinds a private key d
         using label, resulting in another private key which
         can be used to create cryptographic signatures.  We note that
         GNS only requires a signature to be created directly with
         d to sign a revocation message for the zone key zk.<a href="#section-4-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.5">ZKDF-Public(zk,label) -&gt; zk'</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.6">
         is a zone key derivation function which blinds a zone key zk
         using a label. zk and zk' must be unlinkable. Furthermore,
         blinding zk with different values for the label must result
         in different, unlinkable zk' values.<a href="#section-4-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.7">S-Encrypt(zk,label,expiration,message) -&gt; ciphertext</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.8">
         is a symmetric encryption function which encrypts the record
         data based on key material derived from the zone key,
         a label, and an expiration timestamp.
         In order to leverage performance-enhancing caching features of certain
         underlying storages, in particular DHTs, a deterministic encryption
         scheme is recommended.<a href="#section-4-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.9">S-Decrypt(zk,label,expiration,ciphertext) -&gt; message</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.10">
         is a symmetric decryption function which decrypts the encrypted record
         data based on key material derived from the zone key,
         a label, and an expiration timestamp.<a href="#section-4-5.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.11">Sign(d,message) -&gt; signature, SignDerived(d,label,message) -&gt; signature</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.12">
         is a function to sign a message (typically encrypted record data) using the (blinded) private
         key d (d'), yielding an unforgeable cryptographic signature.
         In order to leverage performance-enhancing caching features of certain
         underlying storages, in particular DHTs, a deterministic signature
         scheme is recommended.<a href="#section-4-5.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.13">Verify(zk,message,signature) -&gt; boolean, VerifyDerived(zk,label,message,signature) -&gt; boolean</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.14">
         is a function to verify the signature was created by
         the private key d (or derived key d') corresponding to
         the zone key zk (or derived zone key zk')
         where d,zk := Keygen(). If derivations were used, they
         must have used the same label.
         The function returns a boolean value of "TRUE" if the signature is valid,
         and otherwise "FALSE".<a href="#section-4-5.14" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div id="zTLD">
<section id="section-4.1">
        <h3 id="name-zone-top-level-domain">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-zone-top-level-domain" class="section-name selfRef">Zone Top-Level Domain</a>
        </h3>
<div id="figure_zid">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.1-1.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |      ZONE KEY         /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
</div>
<p id="section-4.1-2">The decoded binary representation of the zTLD<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
         The zTLD is the Zone Top-Level Domain.
         It is a string which encodes the zone type and zone key into a domain name.
         The zTLD is used as a globally unique reference to a specific
         namespace in the process of name resolution.
         To encode the zone key, a zone key label zkl is derived from a
         concatenation of the zone type and zone key (see <a href="#figure_zid" class="xref">Figure 1</a>).
         The result is encoded using a variation of the Crockford Base32 encoding <span>[<a href="#CrockfordB32" class="xref">CrockfordB32</a>]</span>
         called Base32GNS.
         The encoding and decoding symbols for Base32GNS including this modification are defined in
         <a href="#CrockfordB32Encode" class="xref">Figure 23</a>.
         The functions for encoding and decoding based on this table are called
         Base32GNS-Encode and Base32GNS-Decode, respectively.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
         For the string representation of a zTLD we define:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-5">
<pre>
zkl := Base32GNS-Encode(ztype||zkey)
ztype||zkey := Base32GNS-Decode(zkl)
</pre><a href="#section-4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-6">
         If zkl is less than 63 characters, it can directly be
         used as a zTLD.
         If zkl is longer than 63 characters, the
         zTLD is constructed by dividing zkl into smaller labels separated by the
         label separator ".".
         Here, the most significant bytes of the "ztype||zkey" concatenation must be contained
         in the rightmost label of the resulting string and the least significant
         bytes in the leftmost label of the resulting string. This allows the
         resolver to determine the ztype and zkl length from the rightmost label and
         to subsequently determine how many labels the zTLD should span.
         For example, assuming a zkl of 130 characters, the encoding would be:<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-7">
<pre>
zTLD := zkl[126..129].zkl[63..125].zkl[0..62]
</pre><a href="#section-4.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="revocation">
<section id="section-4.2">
        <h3 id="name-zone-revocation">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-zone-revocation" class="section-name selfRef">Zone Revocation</a>
        </h3>
<p id="section-4.2-1">
         Whenever a resolver encounters a new GNS zone, it MUST
         check against the local revocation list whether the respective
         zone key has been revoked.  If the zone key was revoked, the
         resolution MUST fail with an empty result set.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
         In order to revoke a zone key, a signed revocation message MUST be
         published.
         This message MUST be signed using the private key.
         The revocation message is broadcast to the network.
         The specification of the broadcast mechanism is out of scope for this
         document.
         A possible broadcast mechanism for efficient flooding in a distributed
         network is implemented in <span>[<a href="#GNUnet" class="xref">GNUnet</a>]</span>.
         Alternatively, revocation messages could also be distributed via a
         distributed ledger or a trusted central server.
         To prevent
         flooding attacks, the revocation message MUST contain a proof of work
         (PoW).
         The revocation message including the PoW MAY be calculated
         ahead of time to support timely revocation.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">
         For all occurrences below, "Argon2id" is the Password-based Key
         Derivation Function as defined in <span>[<a href="#RFC9106" class="xref">RFC9106</a>]</span>. For the
         PoW calculations the algorithm is instantiated with the
         following parameters:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-4">
          <dt id="section-4.2-4.1">S</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.2">The salt. Fixed 16-byte string: "GnsRevocationPow".<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.3">t</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.4">Number of iterations: 3<a href="#section-4.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.5">m</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.6">Memory size in KiB: 1024<a href="#section-4.2-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.7">T</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.8">Output length of hash in bytes: 64<a href="#section-4.2-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.9">p</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.10">Parallelization parameter: 1<a href="#section-4.2-4.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.11">v</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.12">Algorithm version: 0x13<a href="#section-4.2-4.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.13">y</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.14">Algorithm type (Argon2id): 2<a href="#section-4.2-4.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.15">X</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.16">Unused<a href="#section-4.2-4.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.17">K</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.18">Unused<a href="#section-4.2-4.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-5">
         <a href="#figure_revocation" class="xref">Figure 2</a> illustrates the format
         of the data "P" on which the PoW is calculated.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div id="figure_revocation">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.2-6.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      POW                      |
+-----------------------------------------------+
|                   TIMESTAMP                   |
+-----------------------------------------------+
|       ZONE TYPE       |    ZONE KEY           |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
</div>
<p id="section-4.2-7">The Format of the PoW Data.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-8">
          <dt id="section-4.2-8.1">POW</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-8.2">
           A 64-bit value that is a solution to the PoW. In network byte order.<a href="#section-4.2-8.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-8.3">TIMESTAMP</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-8.4">
           denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 UTC in network
           byte order.<a href="#section-4.2-8.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-8.5">ZONE TYPE</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-8.6">
           is the 32-bit zone type.<a href="#section-4.2-8.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-8.7">ZONE KEY</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-8.8">
           is the 256-bit public key zk of the zone which is being revoked.
           The wire format of this value is defined by the ZONE TYPE.<a href="#section-4.2-8.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-9">
         Traditionally, PoW schemes require to find a POW value such that
         at least D leading zeroes are found in the hash result.
         D is then referred to as the difficulty of the PoW.
         In order to reduce the variance in time it takes to calculate the
         PoW, we require that a number Z different PoWs must be
         found that on average have D leading zeroes.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<p id="section-4.2-10">
         The resulting proofs may then published and disseminated. The concrete
         dissemination and publication methods are out of scope of this
         document. Given an average difficulty of D, the proofs have an
         expiration time of EPOCH. With each additional bit difficulty, the
         lifetime of the proof is prolonged for another EPOCH.
         Consequently, by calculating a more difficult PoW, the lifetime of the
         proof can be increased on demand by the zone owner.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
<p id="section-4.2-11">
         The parameters are defined as follows:<a href="#section-4.2-11" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-12">
          <dt id="section-4.2-12.1">Z</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-12.2">The number of PoWs required is fixed at 32.<a href="#section-4.2-12.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-12.3">D</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-12.4">The minimum average difficulty is fixed at 22.<a href="#section-4.2-12.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-12.5">EPOCH</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-12.6">A single epoch is fixed at 365 days.<a href="#section-4.2-12.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-13">
         The revocation message wire format is illustrated in
         <a href="#figure_revocationdata" class="xref">Figure 3</a>.<a href="#section-4.2-13" class="pilcrow">¶</a></p>
<div id="figure_revocationdata">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.2-14.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      TTL                      |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     POW_0                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                       ...                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     POW_Z-1                   |
+-----------------------------------------------+
|       ZONE TYPE       |    ZONE KEY           |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   SIGNATURE                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a></figcaption></figure>
</div>
<p id="section-4.2-15">The Revocation Message Wire Format.<a href="#section-4.2-15" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-16">
          <dt id="section-4.2-16.1">TIMESTAMP</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-16.2">
           denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 UTC in network
           byte order. This is the same value as the time stamp used in the
           individual PoW calculations.<a href="#section-4.2-16.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.3">TTL</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-16.4">
           denotes the relative 64-bit time to live of the record in
           microseconds also in network byte order. This field is informational
           for a verifier. A verifier MAY discard a revocation without
           checking the POW values or the signature if the TTL (in combination with TIMESTAMP)
           indicates that the revocation has already expired. However, the actual TTL of the
           revocation must be determined by examining the leading zeroes in the
           proof of work calculation.<a href="#section-4.2-16.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.5">POW_i</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-16.6">
           The values calculated as part of the PoW, in network byte order.
           Each POW_i MUST be unique in the set of POW values.
           To facilitate fast verification
           of uniqueness, the POW values must be given in strictly
           monotonically increasing order in the message.<a href="#section-4.2-16.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.7">ZONE TYPE</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-16.8">
           The 32-bit zone type corresponding to the zone key.<a href="#section-4.2-16.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.9">ZONE KEY</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-16.10">
           is the public key zk of the zone which is being revoked and
           the key to be used to verify SIGNATURE.<a href="#section-4.2-16.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.11">SIGNATURE</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-16.12">
           A signature over a time stamp and the zone zk of the zone
           which is revoked and corresponds to the key used in the PoW.
           The signature is created using the Sign() function of
           the cryptosystem of the zone and the private key
           (see <a href="#zones" class="xref">Section 4</a>).<a href="#section-4.2-16.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-17">
        The signature over the public key covers a 32-bit header
        prefixed to the time stamp and public key fields.
        The header includes the key length and signature purpose.
        The wire format is illustrated
        in <a href="#figure_revsigwithpseudo" class="xref">Figure 4</a>.<a href="#section-4.2-17" class="pilcrow">¶</a></p>
<div id="figure_revsigwithpseudo">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.2-18.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE          |       PURPOSE (0x03)  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |     ZONE KEY          |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a></figcaption></figure>
</div>
<p id="section-4.2-19">The Wire Format of the Revocation Data for Signing.<a href="#section-4.2-19" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-20">
          <dt id="section-4.2-20.1">SIZE</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-20.2">
           A 32-bit value containing the length of the signed data in bytes
           in network byte order.<a href="#section-4.2-20.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-20.3">PURPOSE</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-20.4">
           A 32-bit signature purpose flag.
           The value of this field MUST be 3.
           The value is encoded in network byte order.
           It defines the context in which
           the signature is created so that it cannot be reused in other parts
           of the protocol including possible future extensions.
           The value of this field corresponds to an entry in the
           GANA "GNUnet Signature Purpose" registry <a href="#gana" class="xref">Section 10</a>.<a href="#section-4.2-20.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-20.5">TIMESTAMP</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-20.6">
           Field as defined in the revocation message above.<a href="#section-4.2-20.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-20.7">ZONE TYPE</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-20.8">
           Field as defined in the revocation message above.<a href="#section-4.2-20.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-20.9">ZONE KEY</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-20.10">Field as defined in the revocation message above.<a href="#section-4.2-20.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-21">
         In order to verify a revocation the following steps MUST be taken:<a href="#section-4.2-21" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-22">
         <li id="section-4.2-22.1">The signature MUST be verified against the zone key.<a href="#section-4.2-22.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-22.2">The set of POW values MUST NOT contain duplicates which MUST be checked by verifying that the values are strictly monotonically increasing.<a href="#section-4.2-22.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-22.3">The average number of leading zeroes D' resulting from the provided
         POW values MUST be greater than and not equal to D.  Implementers
         MUST NOT use an integer data type to calculate or represent D'.<a href="#section-4.2-22.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-22.4">The validation period (TTL) of the revocation is calculated as
           (D'-D) * EPOCH * 1.1. The EPOCH is extended by
           10% in order to deal with unsynchronized clocks.
           The TTL added on top of the TIMESTAMP yields the
         expiration date.
           Should the verifier calculate the TTL and find that it differs from
           the field value, the verifier MUST continue and
           use the calculated value when forwarding the revocation.<a href="#section-4.2-22.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-22.5">The current time SHOULD be between TIMESTAMP and
           TIMESTAMP+TTL. Implementations MAY process the revocation without validating this.<a href="#section-4.2-22.5" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="rrecords">
<section id="section-5">
      <h2 id="name-resource-records">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-resource-records" class="section-name selfRef">Resource Records</a>
      </h2>
<p id="section-5-1">
       A GNS implementer SHOULD provide a mechanism to create and manage resource
       records for local zones.  A new local zone is established by selecting a
       zone type and creating a zone key pair.
       As records may be added to each zone by its owner, a (local) persistence
       mechanism such as a database for resource records and zones SHOULD be provided.
       This local zone database is used by the name resolution logic and serves
       as a basis for publishing zones into the GNS storage (see <a href="#publish" class="xref">Section 6</a>).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
       A GNS resource record holds the data of a specific record in a zone.
       The resource record format is defined in
       <a href="#figure_gnsrecord" class="xref">Figure 5</a>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="figure_gnsrecord">
<figure id="figure-5">
        <div class="alignLeft art-text artwork" id="section-5-3.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|    SIZE   |   FLAGS   |          TYPE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      DATA                     /
/                                               /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a></figcaption></figure>
</div>
<p id="section-5-4">The Resource Record Wire Format.<a href="#section-5-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-5">
        <dt id="section-5-5.1">EXPIRATION</dt>
        <dd style="margin-left: 1.5em" id="section-5-5.2">
         denotes the absolute 64-bit expiration date of the record.
         In microseconds since midnight (0 hour), January 1, 1970 UTC in network
         byte order.<a href="#section-5-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-5.3">SIZE</dt>
        <dd style="margin-left: 1.5em" id="section-5-5.4">
         denotes the 16-bit size of the DATA field in bytes and in network byte
         order.<a href="#section-5-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-5.5">FLAGS</dt>
        <dd style="margin-left: 1.5em" id="section-5-5.6">
         is a 16-bit resource record flags field (see below).<a href="#section-5-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-5.7">TYPE</dt>
        <dd style="margin-left: 1.5em" id="section-5-5.8">
         is the 32-bit resource record type. This type can be one of the GNS resource
         records as defined in <a href="#rrecords" class="xref">Section 5</a> or a DNS record
         type as defined in <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> or any of the
         complementary standardized DNS resource record types. This value must be
         stored in network byte order. Note that values
         below 2^16 are reserved for allocation via IANA <span>[<a href="#RFC6895" class="xref">RFC6895</a>]</span>,
         while values above 2^16 are allocated by the
         GNUnet Assigned Numbers Authority <span>[<a href="#GANA" class="xref">GANA</a>]</span>.<a href="#section-5-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-5.9">DATA</dt>
        <dd style="margin-left: 1.5em" id="section-5-5.10">
         the variable-length resource record data payload. The content is defined
         by the
         respective type of the resource record.<a href="#section-5-5.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-6">
       Flags indicate metadata surrounding the resource record.
       Applications creating resource records MUST set all bits which are
       not defined as a flag to 0. Additional flags may be defined in
       future protocol versions.
       If an application or implementation encounters a flag which it does not
       recognize, it MUST be ignored.
       <a href="#figure_flag" class="xref">Figure 6</a>
       illustrates the flag distribution in the 16-bit flag field of a
       resource record:<a href="#section-5-6" class="pilcrow">¶</a></p>
<div id="figure_flag">
<figure id="figure-6">
        <div class="alignLeft art-text artwork" id="section-5-7.1">
<pre>
0           13            14      15        16
+--------...+-------------+-------+---------+
| Reserved  |SUPPLEMENTAL |SHADOW |CRITICAL |
+--------...+-------------+-------+---------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a></figcaption></figure>
</div>
<p id="section-5-8">The Resource Record Flag Wire Format.<a href="#section-5-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-9">
        <dt id="section-5-9.1">CRITICAL</dt>
        <dd style="margin-left: 1.5em" id="section-5-9.2">
         If this flag is set, it indicates that processing is critical.
         Implementations that do not support the record type or are otherwise
         unable to process the record must abort resolution upon encountering
         the record in the resolution process.<a href="#section-5-9.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-9.3">SHADOW</dt>
        <dd style="margin-left: 1.5em" id="section-5-9.4">
         If this flag is set, this record should be ignored by resolvers unless all (other)
         records of the same record type have expired.  Used to allow zone publishers to
         facilitate good performance when records change by allowing them to put future
         values of records into the storage.
         This way, future values can propagate and may be
         cached before the transition becomes active.<a href="#section-5-9.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-9.5">SUPPLEMENTAL</dt>
        <dd style="margin-left: 1.5em" id="section-5-9.6">
         This is a supplemental record. It is provided in addition to the
         other records. This flag indicates that this record is not explicitly
         managed alongside the other records under the respective name but
         may be useful for the application. This flag should only be encountered
         by a resolver for records obtained from the storage.<a href="#section-5-9.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div id="gnsrecords_delegation">
<section id="section-5.1">
        <h3 id="name-zone-delegation-records">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-zone-delegation-records" class="section-name selfRef">Zone Delegation Records</a>
        </h3>
<p id="section-5.1-1">
       This section defines the initial set of zone delegation record types.
       Any implementation SHOULD support all zone types defined here and
       MAY support any number of additional delegation records defined in
       the GNU Name System Record Types registry (see <a href="#gana" class="xref">Section 10</a>).
       Zone delegation records MUST have the CRTITICAL flag set.
       Not supporting some zone types MAY result in resolution failures. This
       MAY BE a valid choice if some zone delegation record types have been
       determined to be cryptographically insecure.
       Zone delegation records MUST NOT be stored and published
       under the apex label.
       A zone delegation record type value is the same as the respective ztype
       value.
       The ztype defines the cryptographic primitives for the zone that is
       being delegated to.
       A zone delegation resource record payload contains the public key of
       the zone to delegate to.
       A zone delegation record MUST be the only record under a label.
       No other records are allowed.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="gnsrecords_pkey">
<section id="section-5.1.1">
          <h4 id="name-pkey">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-pkey" class="section-name selfRef">PKEY</a>
          </h4>
<p id="section-5.1.1-1">
         In GNS, a delegation of a label to a zone of type "PKEY" is
         represented through a PKEY record.  The PKEY DATA entry wire format can be found in <a href="#figure_pkeyrecord" class="xref">Figure 7</a>.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<div id="figure_pkeyrecord">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-5.1.1-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a></figcaption></figure>
</div>
<p id="section-5.1.1-3">The PKEY Wire Format.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.1-4">
            <dt id="section-5.1.1-4.1">PUBLIC KEY</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-4.2">
           A 256-bit Ed25519 public key.<a href="#section-5.1.1-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.1-5">
         For PKEY zones the zone key material is derived using the
         curve parameters of the twisted Edwards representation
         of Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> (a.k.a. Ed25519)
         with the ECDSA scheme <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span>.
         Consequently, we use the following naming convention for our
         cryptographic primitives for PKEY zones:<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.1-6">
            <dt id="section-5.1.1-6.1">d</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-6.2">
           is a 256-bit Ed25519 private key (private scalar).<a href="#section-5.1.1-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-6.3">zk</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-6.4">
           is the Ed25519 public zone key corresponding to d.<a href="#section-5.1.1-6.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-6.5">p</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-6.6">
           is the prime of edwards25519 as defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, i.e.
           2^255 - 19.<a href="#section-5.1.1-6.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-6.7">G</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-6.8">
           is the group generator (X(P),Y(P)) of edwards25519 as defined in
           <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-5.1.1-6.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-6.9">L</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-6.10">
           is the order of the prime-order subgroup of edwards25519 in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-5.1.1-6.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-6.11">KeyGen()</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-6.12">The generation of the private
           scalar d and the curve point zk := d*G (where G is the group generator
           of the elliptic curve) as defined in Section 2.2. of
           <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> represents the KeyGen() function.<a href="#section-5.1.1-6.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.1-7">
         The zone type and zone key of a PKEY are 4 + 32 bytes in length. This means that
         a zTLD will always fit into a single label and does
         not need any further conversion.<a href="#section-5.1.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1.1-8">
         Given a label, the output d' of the ZKDF-Private(d,label) function for zone
         key blinding is calculated as follows for PKEY zones:<a href="#section-5.1.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-9">
<pre>
ZKDF-Private(d,label):
  zk := d * G
  PRK_h := HKDF-Extract ("key-derivation", zk)
  h := HKDF-Expand (PRK_h, label || "gns", 512 / 8)
  d' := (h * d) mod L
  return d'
</pre><a href="#section-5.1.1-9" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-10">
         Equally, given a label, the output zk' of the ZKDF-Public(zk,label) function is
         calculated as follows for PKEY zones:<a href="#section-5.1.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-11">
<pre>
ZKDF-Public(zk,label)
  PRK_h := HKDF-Extract ("key-derivation", zk)
  h := HKDF-Expand (PRK_h, label || "gns", 512 / 8)
  zk' := (h mod L) * zk
  return zk'
</pre><a href="#section-5.1.1-11" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-12">
         The PKEY cryptosystem uses a hash-based key derivation function (HKDF) as defined in
         <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>, using SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for the extraction
         phase and SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for the expansion phase.
         PRK_h is key material retrieved using an HKDF using the string
         "key-derivation" as salt and the zone key as initial
         keying material.
         h is the 512-bit HKDF expansion result and must be interpreted in
         network byte order. The expansion information input is
         a concatenation of the label and the string "gns".
         The label is a UTF-8 string under which the resource records are
         published.
         The multiplication of zk with h is a point multiplication,
         while the multiplication of d with h is a scalar multiplication.<a href="#section-5.1.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1.1-13">
         The Sign() and Verify() functions
         for PKEY zones are implemented using 512-bit ECDSA deterministic
         signatures as specified in <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span>.
         The same functions can be used for derived keys:<a href="#section-5.1.1-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-14">
<pre>
SignDerived(d,label,message):
  d' := ZKDF-Private(d,label)
  return Sign(d',message)
</pre><a href="#section-5.1.1-14" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-15">
           A signature (R,S) is valid if the following holds:<a href="#section-5.1.1-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-16">
<pre>
VerifyDerived(zk,label,message,signature):
  zk' := ZKDF-Public(zk,label)
  return Verify(zk',message,signature)
</pre><a href="#section-5.1.1-16" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-17">
         The S-Encrypt() and S-Decrypt() functions use AES in counter mode
         as defined in <span>[<a href="#MODES" class="xref">MODES</a>]</span> (CTR-AES-256):<a href="#section-5.1.1-17" class="pilcrow">¶</a></p>
<div id="figure_senc_pkey">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-5.1.1-18.1">
<pre>
S-Encrypt(zk,label,expiration,plaintext):
  PRK_k := HKDF-Extract ("gns-aes-ctx-key", zk)
  PRK_n := HKDF-Extract ("gns-aes-ctx-iv", zk)
  K := HKDF-Expand (PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand (PRK_n, label, 32 / 8)
  IV := NONCE || expiration || 0x0000000000000001
  return CTR-AES256(K, IV, plaintext)
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a></figcaption></figure>
</div>
<p id="section-5.1.1-19">The PKEY S-Encrypt Procedure.<a href="#section-5.1.1-19" class="pilcrow">¶</a></p>
<div id="figure_sdec_pkey">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-5.1.1-20.1">
<pre>
S-Decrypt(zk,label,expiration,ciphertext):
  PRK_k := HKDF-Extract ("gns-aes-ctx-key", zk)
  PRK_n := HKDF-Extract ("gns-aes-ctx-iv", zk)
  K := HKDF-Expand (PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand (PRK_n, label, 32 / 8)
  IV := NONCE || expiration || 0x0000000000000001
  return CTR-AES256(K, IV, ciphertext)
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a></figcaption></figure>
</div>
<p id="section-5.1.1-21">The PKEY S-Decrypt Procedure.<a href="#section-5.1.1-21" class="pilcrow">¶</a></p>
<p id="section-5.1.1-22">
         The key K and counter IV are derived from
         the record label and the zone key zk using a hash-based key
         derivation function (HDKF) as defined in <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>.
         SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is used for the
         extraction phase and SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for the expansion phase.
         The output keying material is 32 bytes (256 bits) for the symmetric
         key and 4 bytes (32 bits) for the nonce.
         The symmetric key K is a 256-bit AES <span>[<a href="#RFC3826" class="xref">RFC3826</a>]</span> key.<a href="#section-5.1.1-22" class="pilcrow">¶</a></p>
<p id="section-5.1.1-23">
         The nonce is combined with a 64-bit initialization vector and a
         32-bit block counter as defined in <span>[<a href="#RFC3686" class="xref">RFC3686</a>]</span>.
         The block counter begins with the value of 1, and it is incremented
         to generate subsequent portions of the key stream.
         The block counter is a 32-bit integer value in network byte order.
         The initialization vector is the expiration time of the
         resource record block in network byte order.
         The resulting counter (IV) wire format can be found in
         <a href="#figure_hkdf_ivs_pkey" class="xref">Figure 10</a>.<a href="#section-5.1.1-23" class="pilcrow">¶</a></p>
<div id="figure_hkdf_ivs_pkey">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-5.1.1-24.1">
<pre>
0     8     16    24    32
+-----+-----+-----+-----+
|         NONCE         |
+-----+-----+-----+-----+
|       EXPIRATION      |
|                       |
+-----+-----+-----+-----+
|      BLOCK COUNTER    |
+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a></figcaption></figure>
</div>
<p id="section-5.1.1-25">The Block Counter Wire Format.<a href="#section-5.1.1-25" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gnsrecords_edkey">
<section id="section-5.1.2">
          <h4 id="name-edkey">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-edkey" class="section-name selfRef">EDKEY</a>
          </h4>
<p id="section-5.1.2-1">
         In GNS, a delegation of a label to a zone of type "EDKEY" is
         represented through a EDKEY record.
         The EDKEY DATA entry wire format
         is illustrated in <a href="#figure_edkeyrecord" class="xref">Figure 11</a>.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<div id="figure_edkeyrecord">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-5.1.2-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a></figcaption></figure>
</div>
<p id="section-5.1.2-3">The EDKEY DATA Wire Format.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2-4">
            <dt id="section-5.1.2-4.1">PUBLIC KEY</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-4.2">
           A 256-bit EdDSA zone key.<a href="#section-5.1.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.2-5">
           For EDKEY zones the zone key material is derived using the
           curve parameters of the twisted edwards representation
           of Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> (a.k.a. Ed25519)
           with the Ed25519 scheme <span>[<a href="#ed25519" class="xref">ed25519</a>]</span> as specified in
           <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
           Consequently, we use the following naming convention for our
           cryptographic primitives for EDKEY zones:<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2-6">
            <dt id="section-5.1.2-6.1">d</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-6.2">
             is a 256-bit EdDSA private key.<a href="#section-5.1.2-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-6.3">a</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-6.4">
             is is an integer derived from d using the SHA-512 hash function
             as defined in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-5.1.2-6.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-6.5">zk</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-6.6">
             is the EdDSA public key corresponding to d. It is defined
             as the curve point a*G where G is the
             group generator of the elliptic curve
             as defined in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-5.1.2-6.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-6.7">p</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-6.8">
             is the prime of edwards25519 as defined in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, i.e.
             2^255 - 19.<a href="#section-5.1.2-6.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-6.9">G</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-6.10">
             is the group generator (X(P),Y(P)) of edwards25519 as defined in
              <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-5.1.2-6.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-6.11">L</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-6.12">
             is the order of the prime-order subgroup of edwards25519 in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-5.1.2-6.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-6.13">KeyGen()</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.2-6.14">
             The generation of the private key d and the associated public
             key zk := a*G where G is the
             group generator of the elliptic curve and a is an integer
             derived from d using the SHA-512 hash function
             as defined
             in Section 5.1.5 of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> represents the KeyGen()
             function.<a href="#section-5.1.2-6.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.2-7">
           The zone type and zone key of an EDKEY are 4 + 32 bytes in length. This means that
           a zTLD will always fit into a single label and does
           not need any further conversion.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.2-8">
           The "EDKEY" ZKDF instantiation is based on <span>[<a href="#Tor224" class="xref">Tor224</a>]</span>.
           The calculation of a is defined in Section 5.1.5 of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
           Given a label, the output of the ZKDF-Private function for zone
           key blinding is calculated as follows for EDKEY zones:<a href="#section-5.1.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-9">
<pre>
ZKDF-Private(d,label):
  /* EdDSA clamping */
  a := SHA-512 (d)
  a[0] &amp;= 248
  a[31] &amp;= 127
  a[31] |= 64
  /* Calculate zk from d */
  zk := a * G

  /* Calculate the blinding factor */
  PRK_h := HKDF-Extract ("key-derivation", zk)
  h := HKDF-Expand (PRK_h, label || "gns", 512 / 8)
  /* Ensure that h == h mod L */
  h[31] &amp;= 7

  a1 := a &gt;&gt; 3
  a2 := (h * a1) mod L
  d' := a2 &lt;&lt; 3
  return d'
</pre><a href="#section-5.1.2-9" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-10">
           Equally, given a label, the output of the ZKDF-Public function is
           calculated as follows for PKEY zones:<a href="#section-5.1.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-11">
<pre>
ZKDF-Public(zk,label):
  /* Calculate the blinding factor */
  PRK_h := HKDF-Extract ("key-derivation", zk)
  h := HKDF-Expand (PRK_h, label || "gns", 512 / 8)
  /* Ensure that h == h mod L */
  h[31] &amp;= 7

  zk' := h * zk
  return zk'
</pre><a href="#section-5.1.2-11" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-12">
           We note that implementers SHOULD employ a constant time scalar
           multiplication for the constructions above to protect against
           timing attacks. Otherwise, timing attacks may leak private key
           material if an attacker can predict when a system starts the
           publication process.<a href="#section-5.1.2-12" class="pilcrow">¶</a></p>
<p id="section-5.1.2-13">
           The EDKEY cryptosystem uses a
           hash-based key derivation function (HKDF) as defined in
           <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>, using SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for the extraction
           phase and HMAC-SHA256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for the expansion phase.
           PRK_h is key material retrieved using an HKDF using the string
           "key-derivation" as salt and the zone key as initial
           keying material.
           The blinding factor h is the 512-bit HKDF expansion result.
           The expansion information input is
           a concatenation of the label and the string "gns".
           The result of the HKDF must be clamped and interpreted in network
           byte order.
           a is the 256-bit integer corresponding to the 256-bit private
           key d.
           The label is a UTF-8 string under which the resource records are
           published.
           The multiplication of zk with h is a point multiplication,
           while the division and multiplication of a and a1 with the
           co-factor are integer operations.<a href="#section-5.1.2-13" class="pilcrow">¶</a></p>
<p id="section-5.1.2-14">
           The Sign(d,message) and Verify(zk,message,signature) procedures MUST
           be implemented as defined in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-5.1.2-14" class="pilcrow">¶</a></p>
<p id="section-5.1.2-15">
           Signatures for EDKEY zones using the derived private scalar d'
           are not compliant with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
           As the corresponding private key to the derived private scalar d'
           is not known, it is not possible to deterministically derive the
           signature part R according to <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
           Instead, signatures MUST be generated as follows for any given
           message and private zone key:
           A nonce is calculated from the highest 32 bytes of the
           expansion of the private key d and the blinding factor h.
           The nonce is then hashed with the message to r.
           This way, we include the full derivation path in the calculation
           of the R value of the signature, ensuring that it is never reused
           for two different derivation paths or messages.<a href="#section-5.1.2-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-16">
<pre>
SignDerived(d,label,message):
  /* EdDSA clamping */
  a := SHA-512 (d)
  a[0] &amp;= 248
  a[31] &amp;= 127
  a[31] |= 64
  /* Calculate zk from d */
  zk := a * G

  /* Calculate blinding factor */
  PRK_h := HKDF-Extract ("key-derivation", zk)
  h := HKDF-Expand (PRK_h, label || "gns", 512 / 8)

  d' := ZKDF-Private(d,label)
  dh := SHA-512 (d)
  nonce := SHA-256 (dh[32..63] || h)
  r := SHA-512 (nonce || message)
  R := r * G
  S := r + SHA-512(R || zk' || message) * d' mod L
  return (R,S)
</pre><a href="#section-5.1.2-16" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-17">
           A signature (R,S) is valid if the following holds:<a href="#section-5.1.2-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-18">
<pre>
VerifyDerived(zk,label,message,signature):
  zk' := ZKDF-Public(zk,label)
  (R,S) := signature
  return S * G == R + SHA-512(R, zk', message) * zk'
</pre><a href="#section-5.1.2-18" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-19">
           The S-Encrypt() and S-Decrypt() functions use XSalsa20
           as defined in <span>[<a href="#XSalsa20" class="xref">XSalsa20</a>]</span>
           (XSalsa20-Poly1305):<a href="#section-5.1.2-19" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-20">
<pre>
S-Encrypt(zk,label,expiration,message):
  PRK_k := HKDF-Extract ("gns-xsalsa-ctx-key", zk)
  PRK_n := HKDF-Extract ("gns-xsalsa-ctx-iv", zk)
  K := HKDF-Expand (PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand (PRK_n, label, 128 / 8)
  IV := NONCE || expiration
  return XSalsa20-Poly1305(K, IV, message)

S-Decrypt(zk,label,expiration,ciphertext):
  PRK_k := HKDF-Extract ("gns-xsalsa-ctx-key", zk)
  PRK_n := HKDF-Extract ("gns-xsalsa-ctx-iv", zk)
  K := HKDF-Expand (PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand (PRK_n, label, 128 / 8)
  IV := NONCE || expiration
  return XSalsa20-Poly1305(K, IV, ciphertext)
</pre><a href="#section-5.1.2-20" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-21">
           The result of the XSalsa20-Poly1305 encryption function is the encrypted
           ciphertext followed by the 128-bit authentication
           tag.
           Accordingly, the length of encrypted data equals the length of the
           data plus the 16 bytes of the authentication tag.<a href="#section-5.1.2-21" class="pilcrow">¶</a></p>
<p id="section-5.1.2-22">
           The key K and counter IV are derived from
           the record label and the zone key zk using a hash-based key
           derivation function (HKDF) as defined in
           <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>.
           SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is used for the
           extraction phase and SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for the expansion phase.
           The output keying material is 32 bytes (256 bits) for the symmetric
           key and 16 bytes (128 bits) for the NONCE.
           The symmetric key K is a 256-bit XSalsa20
           <span>[<a href="#XSalsa20" class="xref">XSalsa20</a>]</span> key.
           No additional authenticated data (AAD) is used.<a href="#section-5.1.2-22" class="pilcrow">¶</a></p>
<p id="section-5.1.2-23">
           The nonce is combined with an 8 byte initialization vector.
           The initialization vector is the expiration time of the
           resource record block in network byte order.
           The resulting counter (IV) wire format is illustrated in
           <a href="#figure_hkdf_ivs_edkey" class="xref">Figure 12</a>.<a href="#section-5.1.2-23" class="pilcrow">¶</a></p>
<div id="figure_hkdf_ivs_edkey">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-5.1.2-24.1">
<pre>
0     8     16    24    32
+-----+-----+-----+-----+
|         NONCE         |
|                       |
|                       |
|                       |
+-----+-----+-----+-----+
|       EXPIRATION      |
|                       |
+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a></figcaption></figure>
</div>
<p id="section-5.1.2-25">The Counter Block Initialization Vector<a href="#section-5.1.2-25" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gnsrecords_redirect">
<section id="section-5.2">
        <h3 id="name-redirection-records">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-redirection-records" class="section-name selfRef">Redirection Records</a>
        </h3>
<p id="section-5.2-1">
       Redirect records may be used to redirect resolution.
       Any implementation SHOULD support all redirection record types defined here
       and MAY support any number of additional redirection records defined in
       the GNU Name System Record Types registry (see Section <a href="#gana" class="xref">Section 10</a>).
       Redirection records MUST have the CRTITICAL flag set.
       Not supporting some record types MAY result in resolution failures.
       This MAY BE a valid choice if some redirection record types have been
       determined to be insecure, or if an application has reasons to not
       support redirection to DNS for reasons such as complexity or security.
       Redirection records MUST NOT be stored and published under the apex label.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="gnsrecords_rdr">
<section id="section-5.2.1">
          <h4 id="name-redirect">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-redirect" class="section-name selfRef">REDIRECT</a>
          </h4>
<p id="section-5.2.1-1">
         A REDIRECT record is the GNS equivalent of a CNAME record in DNS.
         A REDIRECT record MUST be the only record under a label.
         No other records are allowed.
         Details on processing of this record is defined in <a href="#redirect_processing" class="xref">Section 7.3.1</a>.

         A REDIRECT DATA entry is illustrated in <a href="#figure_redirectrecord" class="xref">Figure 13</a>.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<div id="figure_redirectrecord">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-5.2.1-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   REDIRECT NAME               |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a></figcaption></figure>
</div>
<p id="section-5.2.1-3"> The REDIRECT DATA Wire Format<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.1-4">
            <dt id="section-5.2.1-4.1">REDIRECT NAME</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-4.2">
           The name to continue with.
           The value of a redirect record may be a regular name, or a relative
           name.
           Relative GNS names are indicated using the suffix ".+".
           The string is UTF-8 encoded and 0-terminated.<a href="#section-5.2.1-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_gns2dns">
<section id="section-5.2.2">
          <h4 id="name-gns2dns">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-gns2dns" class="section-name selfRef">GNS2DNS</a>
          </h4>
<p id="section-5.2.2-1">
         It is possible to delegate a label back into DNS through a GNS2DNS record.
         The resource record contains a DNS name for the resolver to continue with
         in DNS followed by a DNS server. Both names are in the format defined in
         <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span> for DNS names.
         There MAY be multiple GNS2DNS records under a label.
         There MAY also be DNSSEC DS records or any other records used to
         secure the connection with the DNS servers under the same label.
         No other record types are allowed in the same record set.
         A GNS2DNS DATA entry is illustrated in <a href="#figure_gns2dnsrecord" class="xref">Figure 14</a>.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<div id="figure_gns2dnsrecord">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-5.2.2-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    DNS NAME                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 DNS SERVER NAME               |
/                                               /
/                                               /
|                                               |
+-----------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a></figcaption></figure>
</div>
<p id="section-5.2.2-3"> The GNS2DNS DATA Wire Format<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.2-4">
            <dt id="section-5.2.2-4.1">DNS NAME</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-4.2">
           The name to continue with in DNS. The value is UTF-8 encoded and
           0-terminated.<a href="#section-5.2.2-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.3">DNS SERVER NAME</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-4.4">
           The DNS server to use. May be an IPv4 address in dotted-decimal
           form or an IPv6 address in colon-hexadecimal form or a DNS name.
           It may also be a relative GNS name ending with a
           "+" as the rightmost label.
           The implementation MUST check the string syntactically for
           an IP address in the respective notation before checking for a
           relative GNS name.
           If all three checks fail, the name MUST be treated as a DNS name.
           The value is UTF-8 encoded and 0-terminated.<a href="#section-5.2.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.2-5">
         NOTE: If an application uses DNS names obtained from GNS2DNS records
         in a DNS request they must first be converted to an IDNA punycode
         representation <span>[<a href="#RFC5891" class="xref">RFC5891</a>]</span>.<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gnsrecords_other">
<section id="section-5.3">
        <h3 id="name-auxiliary-records">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-auxiliary-records" class="section-name selfRef">Auxiliary Records</a>
        </h3>
<p id="section-5.3-1">
         This section defines the initial set of auxiliary GNS record types. Any
         implementation SHOULD be able to process the specified record types
         according to <a href="#record_processing" class="xref">Section 7.3</a>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="gnsrecords_leho">
<section id="section-5.3.1">
          <h4 id="name-leho">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-leho" class="section-name selfRef">LEHO</a>
          </h4>
<p id="section-5.3.1-1">
         Applications can use the GNS to lookup IPv4 or IPv6 addresses of
         internet services.
         However, sometimes connecting to such services does not only require
         the knowledge of an address and port, but also requires the canonical
         DNS name of the service to be transmitted over the transport protocol.
         In GNS, legacy host name records provide applications the DNS name that
         is required to establish a connection to such a service.
         The most common use case is HTTP virtual hosting, where a DNS name must
         be supplied in the HTTP "Host"-header.
         Using a GNS name for the "Host"-header may not work as
         it may not be globally unique. Furthermore, even if uniqueness is
         not an issue, the legacy service might not even be aware of GNS.

         A LEHO resource record is expected to be found together in a single
         resource record with an IPv4 or IPv6 address.
         A LEHO DATA entry is illustrated in <a href="#figure_lehorecord" class="xref">Figure 15</a>.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<div id="figure_lehorecord">
<figure id="figure-15">
            <div class="alignLeft art-text artwork" id="section-5.3.1-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 LEGACY HOSTNAME               |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a></figcaption></figure>
</div>
<p id="section-5.3.1-3"> The LEHO DATA Wire Format.<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.1-4">
            <dt id="section-5.3.1-4.1">LEGACY HOSTNAME</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-4.2">
           A UTF-8 string (which is not 0-terminated) representing the legacy hostname.<a href="#section-5.3.1-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.1-5">
         NOTE: If an application uses a LEHO value in an HTTP request header
         (e.g. "Host:" header) it must be converted to an IDNA punycode representation
         <span>[<a href="#RFC5891" class="xref">RFC5891</a>]</span>.<a href="#section-5.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gnsrecords_nick">
<section id="section-5.3.2">
          <h4 id="name-nick">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-nick" class="section-name selfRef">NICK</a>
          </h4>
<p id="section-5.3.2-1">
         Nickname records can be used by zone administrators to publish an
         the label that a zone prefers to have used when it is referred to.
         This is a suggestion to other zones what label to use when creating a
         delegation record (<a href="#gnsrecords_delegation" class="xref">Section 5.1</a>) containing
         this zone key.
         This record SHOULD only be stored under the apex label "@" but MAY be
         returned with record sets under any label as a supplemental record.
         <a href="#nick_processing" class="xref">Section 7.3.5</a> details how a resolver must process
         supplemental and non-supplemental NICK records.
         A NICK DATA entry is illustrated in <a href="#figure_nickrecord" class="xref">Figure 16</a>.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<div id="figure_nickrecord">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="section-5.3.2-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                  NICKNAME                     |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a></figcaption></figure>
</div>
<p id="section-5.3.2-3">The NICK DATA Wire Format.<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.2-4">
            <dt id="section-5.3.2-4.1">NICKNAME</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.2-4.2">
           A UTF-8 string (which is not 0-terminated) representing the preferred
           label of the zone. This string MUST NOT include a "." character.<a href="#section-5.3.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_box">
<section id="section-5.3.3">
          <h4 id="name-box">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-box" class="section-name selfRef">BOX</a>
          </h4>
<p id="section-5.3.3-1">
         In GNS, with the notable exception of zTLDs, every "." in a name
         delegates to another zone. Furthermore,
         GNS lookups are expected to return all of the required useful
         information in one record set. This avoids unnecessary additional
         lookups and cryptographically ties together information that belongs
         together, making it impossible for an adversarial storage to provide
         partial answers that might omit information critical for security.<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3-2">
         However, this general strategy is incompatible with the
         special labels used by DNS for SRV and TLSA records.  Thus, GNS
         defines the BOX record format to box up SRV and TLSA records and
         include them in the record set of the label they are associated
         with.  For example, a
         TLSA record for "_https._tcp.example.org" will be stored in the record set of
         "example.org" as a BOX record with service (SVC) 443 (https) and protocol (PROTO) 6
         (tcp) and record TYPE "TLSA".
         For reference, see also <span>[<a href="#RFC2782" class="xref">RFC2782</a>]</span>.
           A BOX DATA entry is illustrated in <a href="#figure_boxrecord" class="xref">Figure 17</a>.<a href="#section-5.3.3-2" class="pilcrow">¶</a></p>
<div id="figure_boxrecord">
<figure id="figure-17">
            <div class="alignLeft art-text artwork" id="section-5.3.3-3.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|   PROTO   |    SVC    |       TYPE            |
+-----------+-----------------------------------+
|                 RECORD DATA                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a></figcaption></figure>
</div>
<p id="section-5.3.3-4">The BOX DATA Wire Format.<a href="#section-5.3.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.3-5">
            <dt id="section-5.3.3-5.1">PROTO</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.3-5.2">
              
           the 16-bit protocol number, e.g. 6 for tcp.
           Note that values
           below 2^8 are reserved for allocation via IANA <span>[<a href="#RFC5237" class="xref">RFC5237</a>]</span>,
           while values above 2^8 are allocated by the
           GNUnet Assigned Numbers Authority <span>[<a href="#GANA" class="xref">GANA</a>]</span>.
           In network byte order.<a href="#section-5.3.3-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-5.3">SVC</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.3-5.4">
           the 16-bit service value of the boxed record. In case of
           TCP and UDP it is the port number.
           In network byte order.<a href="#section-5.3.3-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-5.5">TYPE</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.3-5.6">
           is the 32-bit record type of the boxed record. In network byte order.<a href="#section-5.3.3-5.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-5.7">RECORD DATA</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.3-5.8">
           is a variable length field containing the "DATA" format of TYPE as
           defined for the respective TYPE in DNS.<a href="#section-5.3.3-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="publish">
<section id="section-6">
      <h2 id="name-record-storage">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-record-storage" class="section-name selfRef">Record Storage</a>
      </h2>
<p id="section-6-1">
       Any API which allows storing a value under a 512-bit key and retrieving
       one or more values from the key can be used by an implementation for record storage.
       To be useful, the API MUST permit storing at least 176 byte values
       to be able to support the defined zone delegation record encodings,
       and SHOULD allow at least 1024 byte values.
       We assume that an implementation realizes two procedures on top of a
       storage:<a href="#section-6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-2">
<pre>
PUT(key,value)
GET(key) -&gt; value
</pre><a href="#section-6-2" class="pilcrow">¶</a>
</div>
<p id="section-6-3">
       There is no explicit delete function as the deletion of a non-expired
       record would require a revocation of the record.
       In GNS, zones can only be revoked as a whole. Records automatically
       expire and it is under the discretion of the storage as to when to delete
       the record. The GNS implementation MUST NOT publish expired resource
       records. Any GNS resolver MUST discard expired records returned from
       the storage.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
       Resource records are grouped by their respective labels,
       encrypted and published together in a single resource records block
       (RRBLOCK) in the storage under a key q: PUT(q, RRBLOCK).
       The key q is derived from the zone key and the respective
       label of the contained records.
       The required knowledge of both zone key and label in combination
       with the similarly derived symmetric secret keys and blinded zone keys
       ensure query privacy (see <span>[<a href="#RFC8324" class="xref">RFC8324</a>]</span>, Section 3.5).
       The storage key derivation and records
       block creation is specified in the following sections.
       The implementation MUST use the PUT storage procedure in order to update
       the zone contents accordingly.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="blinding">
<section id="section-6.1">
        <h3 id="name-the-storage-key">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-the-storage-key" class="section-name selfRef">The Storage Key</a>
        </h3>
<p id="section-6.1-1">
         Given a label, the storage key q is derived as follows:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
q := SHA-512 (ZKDF-Public(zk, label))
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1-3">
          <dt id="section-6.1-3.1">label</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.2">is a UTF-8 string under which the resource records are published.<a href="#section-6.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.3">zk</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.4">
           is the zone key.<a href="#section-6.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.5">q</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.6">
           Is the 512-bit storage key under which the resource records block is
           published.
           It is the SHA-512 hash <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> over the derived zone key.<a href="#section-6.1-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="records_block">
<section id="section-6.2">
        <h3 id="name-the-records-block">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-the-records-block" class="section-name selfRef">The Records Block</a>
        </h3>
<p id="section-6.2-1">
         GNS records are grouped by their labels and published as a single
         block in the storage. The grouped record sets MAY be paired with any
         number of supplemental records. Supplemental records MUST have the
         supplemental flag set (See <a href="#rrecords" class="xref">Section 5</a>).
         The contained resource records are encrypted using a symmetric
         encryption scheme.
         A GNS implementation publish RRBLOCKs
         in accordance to the properties and recommendations of the underlying
         storage. This may include a periodic refresh operation to ensure the
         availability of the published RRBLOCKs.
         The GNS RRBLOCK wire format is illustrated in
         <a href="#figure_record_block" class="xref">Figure 18</a>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="figure_record_block">
<figure id="figure-18">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|          SIZE         |    ZONE TYPE          |
+-----+-----+-----+-----+-----+-----+-----+-----+
/                  ZONE KEY                     /
/                  (BLINDED)                    /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   SIGNATURE                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    BDATA                      /
/                                               /
/                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a></figcaption></figure>
</div>
<p id="section-6.2-3">The RRBLOCK Wire Format.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-4">
          <dt id="section-6.2-4.1">SIZE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.2">
           A 32-bit value containing the length of the block.
           While a 32-bit value is used,
           implementations MAY refuse to publish blocks beyond a certain
           size significantly below 4 GB.<a href="#section-6.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.3">ZONE TYPE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.4">
           is the 32-bit ztype.<a href="#section-6.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.5">ZONE KEY</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.6">
           is the blinded zone key "ZKDF-Public(zk, label)"
           to be used to verify SIGNATURE.
           The length and format of the public key depends on the ztype.<a href="#section-6.2-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.7">SIGNATURE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.8">
           The signature is computed over the EXPIRATION and BDATA fields
           as detailed in <a href="#figure_rrsigwithpseudo" class="xref">Figure 19</a>.
           The length and format of the signature depends on the ztype.
           The signature is created using the Sign() function of
           the cryptosystem of the zone and the derived private key
           "ZKDF-Private(d, label)" (see <a href="#zones" class="xref">Section 4</a>).<a href="#section-6.2-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.9">EXPIRATION</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.10">
           Specifies when the RRBLOCK expires and the encrypted block
           SHOULD be removed from the storage and caches as it is likely stale.
           However, applications MAY continue to use non-expired individual
           records until they expire.  The value MUST be set to the
           expiration time of the resource record contained within this block with the
           smallest expiration time.
           If a records block includes shadow records, then the maximum
           expiration time of all shadow records with matching type and the
           expiration times of the non-shadow records is considered.
           This is a 64-bit absolute date in microseconds since midnight
           (0 hour), January 1, 1970 UTC in network byte order.<a href="#section-6.2-4.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.11">BDATA</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.12">
           The encrypted RDATA. Its size is determined by the S-Encrypt()
           function of the ztype.<a href="#section-6.2-4.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-5">
         The signature over the public key covers a 32-bit pseudo header
         conceptually prefixed to the EXPIRATION and the BDATA fields.
         The wire format is illustrated
         in <a href="#figure_rrsigwithpseudo" class="xref">Figure 19</a>.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<div id="figure_rrsigwithpseudo">
<figure id="figure-19">
          <div class="alignLeft art-text artwork" id="section-6.2-6.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE          |       PURPOSE (0x0F)  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    BDATA                      |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a></figcaption></figure>
</div>
<p id="section-6.2-7">The Wire Format used for creating the signature of the RRBLOCK.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-8">
          <dt id="section-6.2-8.1">SIZE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-8.2">
           A 32-bit value containing the length of the signed data in bytes
           in network byte order.<a href="#section-6.2-8.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-8.3">PURPOSE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-8.4">
           A 32-bit signature purpose flag. The value of this
           field MUST be 15.
           The value is encoded in network byte order.
           It defines the context in which
           the signature is created so that it cannot be reused in other parts
           of the protocol including possible future extensions.
           The value of this field corresponds to an entry in the
           GANA "GNUnet Signature Purpose" registry <a href="#gana" class="xref">Section 10</a>.<a href="#section-6.2-8.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-8.5">EXPIRATION</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-8.6">
           Field as defined in the RRBLOCK message above.<a href="#section-6.2-8.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-8.7">BDATA</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-8.8">Field as defined in the RRBLOCK message above.<a href="#section-6.2-8.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-9">
         A symmetric encryption scheme is used to encrypt the resource records
         set RDATA into the BDATA field of a GNS RRBLOCK.
         The wire format of the RDATA is illustrated in
         <a href="#figure_rdata" class="xref">Figure 20</a>.<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<div id="figure_rdata">
<figure id="figure-20">
          <div class="alignLeft art-text artwork" id="section-6.2-10.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 EXPIRATION                    |
+-----+-----+-----+-----+-----+-----+-----+-----+
|    SIZE   |    FLAGS  |        TYPE           |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      DATA                     /
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|    SIZE   |    FLAGS  |        TYPE           |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     DATA                      /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
/                     PADDING                   /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a></figcaption></figure>
</div>
<p id="section-6.2-11">The RDATA Wire Format.<a href="#section-6.2-11" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-12">
          <dt id="section-6.2-12.1">EXPIRATION, SIZE, TYPE, FLAGS and DATA</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-12.2">
           These fields were defined
           in the resource record format in <a href="#rrecords" class="xref">Section 5</a>.<a href="#section-6.2-12.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-12.3">PADDING</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-12.4">
           When publishing an RDATA block, the implementation MUST ensure that
           the size of the RDATA is a power of two
           using the padding field. The field MUST be set to zero and MUST be
           ignored on receipt.
           As a special exception, record sets with (only) a zone delegation
           record type are never padded.
           Note that a record set with a delegation record MUST NOT
           contain other records. If other records are encountered, the whole
           record block MUST be discarded.<a href="#section-6.2-12.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="resolution">
<section id="section-7">
      <h2 id="name-name-resolution">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-name-resolution" class="section-name selfRef">Name Resolution</a>
      </h2>
<p id="section-7-1">
       Names in GNS are resolved by recursively querying the record storage.
       Recursive in this context means that a resolver does not provide
       intermediate results for a query.
       Instead, it MUST respond to a resolution request with either the
       requested resource record or an error message in case the resolution
       fails.
       In the following, we define how resolution is initiated and each
       iteration in the resolution is processed.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
       GNS resolution of a name must start in a given starting zone indicated using
       a zone key.
       Details on how the starting zone may be determined are discussed in
       <a href="#governance" class="xref">Section 7.1</a>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
       The application MAY provide a desired record type to the resolver.
       The desired record type is used to guide processing.
       For example, if a zone delegation record type is requested, the
       resolution of the apex label in that zone must be skipped, as
       the desired record is already found.
       The resolver implementation MUST NOT filter results according to the desired
       record type.
       Filtering of record sets is typically done by the application.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="governance">
<section id="section-7.1">
        <h3 id="name-start-zones">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-start-zones" class="section-name selfRef">Start Zones</a>
        </h3>
<p id="section-7.1-1">
         
         The resolution of a GNS name starts in an initial start zone.
         The resolver may have one or more local start zones configured
         which point to local or remote zone keys.
         A resolver may also determine the start zone from the
         suffix of the name given for resolution, or using information
         retrieved out of band.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">
         The governance model of any zone is at the sole discretion
         of the zone owner.
         However, the choice of start zone(s) is at the sole
         discretion of the local system administrator or user.
         This property addresses the issue of a single hierarchy with a
         centrally controlled root and the related issue of distribution and
         management of root servers in DNS (see <span>[<a href="#RFC8324" class="xref">RFC8324</a>]</span>, Section 3.10 and 3.12).<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">
         In the following, we give examples how a resolver SHOULD
         discover the start zone.  The process given is not exhaustive and
         resolvers MAY supplement it with other mechanisms or ignore it if the
         particular application requires a different process.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">
         GNS implementations MUST first try to interpret the top-level domain of
         a GNS name as a zone key representation (i.e. a zTLD).
         If the top-level domain can be converted to a valid ztype and zone
         key value, the resulting zone key is used as the start zone:<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-5">
<pre>
Example name: www.example.&lt;zTLD&gt;
=&gt; Start zone: zk of type ztype
=&gt; Name to resolve from start zone: www.example
</pre><a href="#section-7.1-5" class="pilcrow">¶</a>
</div>
<p id="section-7.1-6">
         In GNS, users MAY own and manage their own zones.
         Each local zone SHOULD be associated with a single GNS label,
         but users MAY choose to use longer names consisting of
         multiple labels.
         If the name of a locally managed zone matches the suffix
         of the name to be resolved, resolution MUST start from the
         respective local zone with the longest matching suffix:<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-7">
<pre>
Example name: www.example.org
Local zones:
fr = (d0,zk0)
org = (d1,zk1)
com = (d2,zk2)
...
=&gt; Start zone: zk1
=&gt; Name to resolve from start zone: www.example
</pre><a href="#section-7.1-7" class="pilcrow">¶</a>
</div>
<p id="section-7.1-8">
         Finally, additional "suffix-to-zone" mappings MAY be configured.
         Suffix to zone key mappings MUST be configurable through a local
         configuration file or database by the user or system administrator.
         The suffix MAY consist of multiple GNS labels concatenated with a
         ".". If multiple suffixes match the name to resolve, the longest
         matching suffix MUST be used. The suffix length of two results
         MUST NOT be equal. This indicates a misconfiguration and the
         implementation MUST return an error.
         If both a locally managed zone and a configuration entry exist
         for the same suffix, the locally managed zone MUST have priority.<a href="#section-7.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-9">
<pre>
Example name: www.example.org
Local suffix mappings:
org = zk0
example.org = zk1
example.com = zk2
...
=&gt; Start zone: zk1
=&gt; Name to resolve from start zone: www
</pre><a href="#section-7.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="recursion">
<section id="section-7.2">
        <h3 id="name-recursion">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-recursion" class="section-name selfRef">Recursion</a>
        </h3>
<p id="section-7.2-1">
           In each step of the recursive name resolution, there is an
           authoritative zone zk and a name to resolve. The name may be empty.
           Initially, the authoritative zone is the start zone. If the name
           is empty, it is interpreted as the apex label "@".<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">
           From here, the following steps are recursively executed, in order:<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-3">
           <li id="section-7.2-3.1">Extract the right-most label from the name to look up.<a href="#section-7.2-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-3.2">Calculate q using the label and zk as defined in
           <a href="#blinding" class="xref">Section 6.1</a>.<a href="#section-7.2-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-3.3">Perform a storage query GET(q) to retrieve the RRBLOCK.<a href="#section-7.2-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-3.4">Verify and process the RRBLOCK and decrypt the BDATA contained
             in it as defined by its zone type (see also <a href="#records_block" class="xref">Section 6.2</a>).<a href="#section-7.2-3.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-7.2-4">
           Upon receiving the RRBLOCK from the storage, as part of verifying the
           provided signature, the resolver MUST check that the SHA-512 hash of the
           derived authoritative zone key zk' from the RRBLOCK matches the query q
           and that the overall block is not yet expired.
           If the signature does not match or the block is expired, the RRBLOCK MUST
           be ignored and, if applicable, the storage lookup GET(q) MUST continue to
           look for other RRBLOCKs.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="record_processing">
<section id="section-7.3">
        <h3 id="name-record-processing">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-record-processing" class="section-name selfRef">Record Processing</a>
        </h3>
<p id="section-7.3-1">
           Record processing occurs once a well-formed block was decrypted.
           In record processing, only the valid records obtained are considered.
           To filter records by validity, the resolver
           MUST at least check the expiration time and the FLAGS of the
           respective record.  In particular, FLAGS may exclude shadow and
           supplemental records from being considered.
           If the resolver encounters a record with the CRITICAL flag set and
           does not support the record type the resolution MUST be aborted
           and an error MUST be returned. The information that the critical
           record could not be processed SHOULD be returned in the error
           description. The implementation MAY choose not to return the reason for the failure,
           merely complicating troubleshooting for the user.
           The next steps depend
           on the context of the name we are trying to resolve:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
           Case 1:
           If the filtered record set consists of a single REDIRECT record,
           the remainder of the name is prepended to the REDIRECT data and the
           recursion is started again from the resulting name.
           Details are described in <a href="#redirect_processing" class="xref">Section 7.3.1</a>.<a href="#section-7.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.2">
           Case 2:
           If the filtered record set consists exclusively of one or more GNS2DNS records
           resolution continues with DNS.
           Details are described in <a href="#gns2dns_processing" class="xref">Section 7.3.2</a>.<a href="#section-7.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.3">
           Case 3:
           If the remainder of the name to be resolved is of the format
           "_SERVICE._PROTO" and the record set contains one or more matching BOX
           records, the records in the BOX records are the final result and the recursion
           is concluded as described in <a href="#box_processing" class="xref">Section 7.3.3</a>.<a href="#section-7.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.4">
           Case 4:
           If the current record set
           consist of a single delegation record,
           resolution of the remainder of the name is delegated to
           the target zone as described in <a href="#delegation_processing" class="xref">Section 7.3.4</a>.<a href="#section-7.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.5">
           Case 5:
           If the remainder of the name to resolve is empty
           the record set (including supplemental records)
           is the final result and the recursion is concluded.<a href="#section-7.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.6">
           Otherwise, resolution fails and the resolver MUST return an empty record set.<a href="#section-7.3-2.6" class="pilcrow">¶</a>
</li>
        </ul>
<div id="redirect_processing">
<section id="section-7.3.1">
          <h4 id="name-redirect-2">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-redirect-2" class="section-name selfRef">REDIRECT</a>
          </h4>
<p id="section-7.3.1-1">
             If the remaining name is empty and the desired record type is
             REDIRECT, in which case the resolution concludes with the REDIRECT record.
             If the redirect name ends in ".+",
             resolution continues in GNS with the new name in the
             current zone.
             Otherwise, the resulting name is resolved via the
             default operating system name resolution process.
             This may in turn trigger a GNS name resolution process depending
             on the system configuration.
             In case resolution continues in DNS, the name MUST first be
             converted to an IDNA punycode representation <span>[<a href="#RFC5891" class="xref">RFC5891</a>]</span>.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">
             In order to prevent infinite loops, the resolver MUST
             implement loop detections or limit the number of recursive
             resolution steps.
             The loop detection MUST be effective even
             if a REDIRECT found in GNS triggers subsequent GNS lookups via
             the default operating system name resolution process.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gns2dns_processing">
<section id="section-7.3.2">
          <h4 id="name-gns2dns-2">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-gns2dns-2" class="section-name selfRef">GNS2DNS</a>
          </h4>
<p id="section-7.3.2-1">
             When a resolver encounters one or more GNS2DNS records and the remaining name
             is empty and the desired record type is GNS2DNS, the GNS2DNS
             records are returned.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">
             Otherwise, it is expected that the resolver first resolves the
             IP addresses of the specified DNS name servers.
             The DNS name may have to be converted to an IDNA punycode
             representation <span>[<a href="#RFC5891" class="xref">RFC5891</a>]</span> for resolution in DNS.
             GNS2DNS records MAY
             contain numeric IPv4 or IPv6 addresses, allowing the resolver to
             skip this step.
             The DNS server names may themselves be names in GNS or DNS.
             If the DNS server name ends in ".+", the rest of the name is to be
             interpreted relative to the zone of the GNS2DNS record.
             If the DNS server name ends in a label representation of a
             zone key, the DNS server name is to be resolved against
             the GNS zone zk.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">
             Multiple GNS2DNS records may be stored under the same label,
             in which case the resolver MUST try all of them.
             The resolver MAY try them in any order or even in parallel.
             If multiple GNS2DNS records are present, the DNS name MUST be
             identical for all of them, if not the resolution fails and an
             appropriate error is SHOULD be returned to the application.<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<p id="section-7.3.2-4">
             If there are DNSSEC DS records or any other records used to
             secure the connection with the DNS servers stored under the label,
             the DNS resolver SHOULD use them to secure the connection with
             the DNS server.<a href="#section-7.3.2-4" class="pilcrow">¶</a></p>
<p id="section-7.3.2-5">
             Once the IP addresses of the DNS servers have been determined,
             the DNS name from the GNS2DNS record is appended
             to the remainder of the name to be resolved, and
             resolved by querying the DNS name server(s).  As the DNS servers
             specified are possibly authoritative DNS servers, the GNS resolver MUST
             support recursive DNS resolution and MUST NOT delegate this to the
             authoritative DNS servers.
             The first successful recursive name resolution result
             is returned to the application.
             In addition, the resolver SHOULD return the queried DNS name as a
             supplemental LEHO record (see <a href="#gnsrecords_leho" class="xref">Section 5.3.1</a>) with a
             relative expiration time of one hour.<a href="#section-7.3.2-5" class="pilcrow">¶</a></p>
<p id="section-7.3.2-6">
             Once the transition from GNS into DNS is made through a
             GNS2DNS record, there is no "going back".
             The (possibly recursive) resolution of the DNS name MUST NOT
             delegate back into GNS and should only follow the DNS specifications.
             For example, names contained in DNS CNAME records MUST NOT be
             interpreted as GNS names.<a href="#section-7.3.2-6" class="pilcrow">¶</a></p>
<p id="section-7.3.2-7">
             GNS resolvers SHOULD offer a configuration
             option to disable DNS processing to avoid information leakage
             and provide a consistent security profile for all name resolutions.
             Such resolvers would return an empty record set upon encountering
             a GNS2DNS record during the recursion. However, if GNS2DNS records
             are encountered in the record set for the apex label and a GNS2DNS record
             is explicitly requested by the application, such records MUST
             still be returned, even if DNS support is disabled by the
             GNS resolver configuration.<a href="#section-7.3.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="box_processing">
<section id="section-7.3.3">
          <h4 id="name-box-2">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-box-2" class="section-name selfRef">BOX</a>
          </h4>
<p id="section-7.3.3-1">
             When a BOX record is received, a GNS resolver must unbox it if the
             name to be resolved continues with "_SERVICE._PROTO".
             Otherwise, the BOX record is to be left untouched. This way, TLSA
             (and SRV) records do not require a separate network request, and
             TLSA records become inseparable from the corresponding address
             records.<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delegation_processing">
<section id="section-7.3.4">
          <h4 id="name-zone-delegation-records-2">
<a href="#section-7.3.4" class="section-number selfRef">7.3.4. </a><a href="#name-zone-delegation-records-2" class="section-name selfRef">Zone Delegation Records</a>
          </h4>
<p id="section-7.3.4-1">
             When the resolver encounters a record of a supported
             zone delegation record type (such as PKEY or EDKEY)
             and the remainder of the name is not empty, resolution continues
             recursively with the remainder of the name in the
             GNS zone specified in the delegation record.
             Implementations MUST NOT allow multiple different zone
             delegations under a single label.
             Implementations MAY support any subset of ztypes.
             Handling of
             Implementations MUST NOT process zone delegation for the apex
             label "@". Upon encountering a zone delegation record under
             this label, resolution fails and an error MUST be returned. The
             implementation MAY choose not to return the reason for the failure,
             merely impacting troubleshooting information for the user.<a href="#section-7.3.4-1" class="pilcrow">¶</a></p>
<p id="section-7.3.4-2">
             If the remainder of the name to resolve is empty and we have
             received a record set containing only a single delegation record, the
             recursion is continued with the record value as authoritative zone
             and the apex label "@" as remaining name.
             Except in the case where the desired record type as specified by
             the application is equal to the ztype, in which case the delegation
             record is returned.<a href="#section-7.3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nick_processing">
<section id="section-7.3.5">
          <h4 id="name-nick-2">
<a href="#section-7.3.5" class="section-number selfRef">7.3.5. </a><a href="#name-nick-2" class="section-name selfRef">NICK</a>
          </h4>
<p id="section-7.3.5-1">
             NICK records are only relevant to the recursive resolver
             if the record set in question is the final result which is to
             be returned to the application. The encountered NICK records may either
             be supplemental (see <a href="#rrecords" class="xref">Section 5</a>) or
             non-supplemental.
             If the NICK record is supplemental, the resolver only returns the
             record set if one of the non-supplemental records matches the
             queried record type.
             It is possible that one record set contains both supplemental
             and non-supplemental NICK records.<a href="#section-7.3.5-1" class="pilcrow">¶</a></p>
<p id="section-7.3.5-2">
             The differentiation between a supplemental and non-supplemental
             NICK record allows the application to match the record to the
             authoritative zone. Consider the following example:<a href="#section-7.3.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5-3">
<pre>
Query: alice.example (type=A)
Result:
A: 192.0.2.1
NICK: eve (non-Supplemental)
</pre><a href="#section-7.3.5-3" class="pilcrow">¶</a>
</div>
<p id="section-7.3.5-4">
          In this example, the returned NICK record is non-supplemental.
          For the application, this means that the NICK belongs to the zone
          "alice.example" and is published under the apex label along with an A
          record. The NICK record should be interpreted as: The zone defined by
          "alice.example" wants to be referred to as "eve".
          In contrast, consider the following:<a href="#section-7.3.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5-5">
<pre>
Query: alice.example (type=AAAA)
Result:
AAAA: 2001:DB8::1
NICK: john (Supplemental)
</pre><a href="#section-7.3.5-5" class="pilcrow">¶</a>
</div>
<p id="section-7.3.5-6">
       In this case, the NICK record is marked as supplemental. This means that
       the NICK record belongs to the zone "example" and is published under the
       label "alice" along with an A record. The NICK record should be
       interpreted as: The zone defined by "example" wants to be referred to as
       "john". This distinction is likely useful for other records published as
       supplemental.<a href="#section-7.3.5-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="encoding">
<section id="section-8">
      <h2 id="name-internationalization-and-ch">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-internationalization-and-ch" class="section-name selfRef">Internationalization and Character Encoding</a>
      </h2>
<p id="section-8-1">
         All labels in GNS are encoded in UTF-8 <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span>.
         Labels MUST be canonicalized using
         Normalization Form KC (NFKC) <span>[<a href="#Unicode-UAX15" class="xref">Unicode-UAX15</a>]</span>.
         This does not include any DNS names found in DNS records, such as CNAME
         records, which are internationalized through the IDNA specifications
         <span>[<a href="#RFC5890" class="xref">RFC5890</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-9">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and Privacy Considerations</a>
      </h2>
<div id="security_availability">
<section id="section-9.1">
        <h3 id="name-availability">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-availability" class="section-name selfRef">Availability</a>
        </h3>
<p id="section-9.1-1">
           In order to ensure availability of records beyond their
           absolute expiration times, implementations MAY allow to locally
           define relative expiration time values of records.
           Records can then be published recurringly with updated
           absolute expiration times by the implementation.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">
           Implementations MAY allow users to manage private records in
           their zones that are not published in the storage.
           Private records are considered just like
           regular records when resolving labels in local zones,
           but their data is completely unavailable to non-local users.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_agility">
<section id="section-9.2">
        <h3 id="name-agility">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-agility" class="section-name selfRef">Agility</a>
        </h3>
<p id="section-9.2-1">
           The security of cryptographic systems depends on both the strength of
           the cryptographic algorithms chosen and the strength of the keys used
           with those algorithms.  The security also depends on the engineering
           of the protocol used by the system to ensure that there are no
           non-cryptographic ways to bypass the security of the overall system.
           This is why developers of applications managing GNS zones SHOULD
           select a default ztype considered secure at the time of
           releasing the software.
           For applications targeting end users that are not expected to
           understand cryptography, the application developer MUST NOT leave
           the ztype selection of new zones to end users.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">
           This document concerns itself with the selection of cryptographic
           algorithms used in GNS.
           The algorithms identified in this document are not known to be
           broken (in the cryptographic sense) at the current time, and
           cryptographic research so far leads us to believe that they are
           likely to remain secure into the foreseeable future.  However, this
           is not necessarily forever, and it is expected that new revisions of
           this document will be issued from time to time to reflect the current
           best practices in this area.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">
           In terms of crypto-agility, whenever the need for an updated cryptographic
           scheme arises to, for example, replace ECDSA over Ed25519 for
           PKEY records it may simply be introduced
           through a new record type. Such a new record type may then replace
           the delegation record type for future records.
           The old record type remains
           and zones can iteratively migrate to the updated zone keys.
           To ensure that implementations correctly generate an error message
           when encountering a ztype that they do not support,
           current and future delegation records must always have the
           CRITICAL flag set.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_cryptography">
<section id="section-9.3">
        <h3 id="name-cryptography">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-cryptography" class="section-name selfRef">Cryptography</a>
        </h3>
<p id="section-9.3-1">
           GNS PKEY zone keys use ECDSA over Ed25519.
           This is an unconventional choice,
           as ECDSA is usually used with other curves.  However, traditional
           ECDSA curves are problematic for a range of reasons described in
           the Curve25519 and EdDSA papers.  Using EdDSA directly is also
           not possible, as a hash function is used on the private key which
           destroys the linearity that the GNU Name System depends upon.
           We are not aware of anyone suggesting that using Ed25519 instead
           of another common curve of similar size would lower the security of
           ECDSA.  GNS uses 256-bit curves because that way the encoded (public)
           keys fit into a single DNS label, which is good for usability.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">
           In order to ensure ciphertext indistinguishability, care must be
           taken with respect to the initialization vector in the counter
           block. In our design, the IV always includes the expiration time of the
           record block.
           When applications store records with relative expiration times,
           monotonicity is implicitly
           ensured because each time a block is published into the storage, its IV is
           unique as the expiration time is calculated dynamically and increases
           monotonically with the system time. Still,
           an implementation MUST ensure that when relative expiration times
           are decreased, the expiration time of the next record block MUST
           be after the last published block.
           For records where an absolute expiration time is used, the implementation
           MUST ensure that the expiration time is always increased when the record
           data changes. For example, the expiration time on the wire may be increased
           by a single microsecond even if the user did not request a change.
           In case of deletion of all resource records under a label, the
           implementation MUST keep track of the last absolute expiration time
           of the last published resource block.  Implementations MAY use a PADDING
           record as a tombstone that preserves the last absolute expiration time,
           but then MUST take care to not publish a block with just a PADDING record.
           When new records are added under this label later, the implementation
           MUST ensure that the expiration times are after the last published
           block.
           Finally, in order to ensure monotonically increasing expiration times
           the implementation MUST keep a local record of the last time obtained
           from the system clock, so as to construct a monotonic clock in case
           the system clock jumps backwards.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_abuse">
<section id="section-9.4">
        <h3 id="name-abuse-mitigation">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-abuse-mitigation" class="section-name selfRef">Abuse Mitigation</a>
        </h3>
<p id="section-9.4-1">
           GNS names are UTF-8 strings. Consequently, GNS faces similar issues
           with respect to name spoofing as DNS does for internationalized
           domain names.
           In DNS, attackers may register similar sounding or looking
           names (see above) in order to execute phishing attacks.
           GNS zone administrators must take into account this attack vector and
           incorporate rules in order to mitigate it.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">
           Further, DNS can be used to combat illegal content on the internet
           by having the respective domains seized by authorities.
           However, the same mechanisms can also be abused in order to impose
           state censorship, which is one of the motivations behind GNS.
           Hence, such a seizure is, by design, difficult to impossible in GNS.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_keymanagement">
<section id="section-9.5">
        <h3 id="name-zone-management">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-zone-management" class="section-name selfRef">Zone Management</a>
        </h3>
<p id="section-9.5-1">
           In GNS, zone administrators need to manage and protect their zone
           keys. Once a zone key is lost, it cannot be recovered or revoked.
           Revocation messages may be pre-calculated if revocation is
           required in case a zone key is lost.
           Zone administrators, and for GNS this includes end-users, are
           required to responsibly and diligently protect their cryptographic
           keys.
           GNS supports offline signing of records.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<p id="section-9.5-2">
           Similarly, users are required to manage their local start zone configuration.
           In order to ensure integrity and availability or names, users must
           ensure that their local start zone information is not compromised or
           outdated.
           It can be expected that the processing of zone revocations and an
           initial start zone is provided with a GNS implementation
           ("drop shipping").  Shipping an initial start zone with an entry for
           the root (".") effectively establishes a root zone.
           Extension and customization of the zone is at the full discretion of
           the user.<a href="#section-9.5-2" class="pilcrow">¶</a></p>
<p id="section-9.5-3">
           While implementations following this specification will be
           interoperable, if two implementations connect to different storages
           they are mutually unreachable.
           This may lead to a state where a record may exist in the global
           namespace for a particular name, but the implementation is not
           communicating with the storage and is hence unable to resolve it.
           This situation is similar to a split-horizon DNS configuration.
           Which storages are implemented usually depends on the application
           it is built for.
           The storage used will most likely depend on the specific application
           context using GNS resolution.
           For example, one application may be the resolution of hidden services
           within the Tor network, which may suggest using Tor routers for storage.
           
           Implementations of "aggregated" storages are conceivable, but
           are expected to be the exception.<a href="#section-9.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_dht">
<section id="section-9.6">
        <h3 id="name-impact-of-dhts-as-underlyin">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-impact-of-dhts-as-underlyin" class="section-name selfRef">Impact of DHTs as Underlying Storage</a>
        </h3>
<p id="section-9.6-1">
           This document does not specify the properties of the underlying
           storage which is required by any GNS implementation.
           It is important to note that the properties of the underlying
           storage are directly inherited by the
           GNS implementation. This includes both security as well as
           other non-functional properties such as scalability and performance.
           Implementers should take great care when selecting or implementing
           a DHT for use as storage in a GNS implementation.
           DHTs with reasonable security and performance properties exist
           <span>[<a href="#R5N" class="xref">R5N</a>]</span>.
           It should also be taken into consideration that GNS implementations
           which build upon different DHT overlays are unlikely to be
           interoperable with each other.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_rev">
<section id="section-9.7">
        <h3 id="name-revocations">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-revocations" class="section-name selfRef">Revocations</a>
        </h3>
<p id="section-9.7-1">
           Zone administrators are advised to pre-generate zone revocations
           and to securely store the revocation information in case the zone
           key is lost, compromised or replaced in the future.
           Pre-calculated revocations may become invalid due to expirations
           or protocol changes such as epoch adjustments.
           Consequently, implementers and users must take precautions in order
           to manage revocations accordingly.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2">
           Revocation payloads do NOT include a 'new' key for key replacement.
           Inclusion of such a key would have two major disadvantages:<a href="#section-9.7-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.7-3">
           <li id="section-9.7-3.1">
           If a revocation is published after a private key was compromised,
           allowing key replacement would be dangerous: if an
           adversary took over the private key, the adversary could then
           broadcast a revocation with a key replacement. For the replacement,
           the compromised owner would have no chance to issue even a
           revocation. Thus, allowing a revocation message to replace a private
           key makes dealing with key compromise situations worse.<a href="#section-9.7-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-9.7-3.2">
           Sometimes, key revocations are used with the objective of changing
           cryptosystems. Migration to another cryptosystem by replacing keys
           via a revocation message would only be secure as long as both
           cryptosystems are still secure against forgery. Such a planned,
           non-emergency migration to another cryptosystem should be done by
           running zones for both cipher systems in parallel for a while. The
           migration would conclude by revoking the legacy zone key only once
           it is deemed no longer secure, and hopefully after most users have
           migrated to the replacement.<a href="#section-9.7-3.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="privacy_labels">
<section id="section-9.8">
        <h3 id="name-label-guessing">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-label-guessing" class="section-name selfRef">Label Guessing</a>
        </h3>
<p id="section-9.8-1">
           Record blocks are published in encrypted form using keys derived from the
           zone key and record label. Zone administrators should
           carefully consider if the label and zone key may be public or if
           those should be used and considered as a shared secret.
           Unlike zone keys, labels can also be guessed by
           an attacker in the network observing queries and responses. Given
           a known and targeted zone key, the use of well known or easily guessable
           labels effectively result in general disclosure of the records to
           the public.
           If the labels and hence the records should be kept secret except to
           those knowing a secret label and the zone in which to look, the
           label must be chosen accordingly. It is recommended to then use a
           label with sufficient entropy as to prevent guessing attacks.<a href="#section-9.8-1" class="pilcrow">¶</a></p>
<p id="section-9.8-2">
           It should be noted that this attack on labels only applies if the
           zone key is somehow disclosed to the adversary. GNS itself
           does not disclose it during a lookup or when resource records are
           published as the zone keys are blinded beforehand.  However,
           zone keys do become public during revocation.<a href="#section-9.8-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gana">
<section id="section-10">
      <h2 id="name-gana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-gana-considerations" class="section-name selfRef">GANA Considerations</a>
      </h2>
<p id="section-10-1">
         GANA <span>[<a href="#GANA" class="xref">GANA</a>]</span>
         manages the "GNU Name System Record Types" registry.
         Each entry has the following format:<a href="#section-10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-2.1">Name: The name of the record type (case-insensitive ASCII
           string, restricted to alphanumeric characters. For zone delegation
       records, the assigned number represents the ztype value of the zone.<a href="#section-10-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-2.2">Number: 32-bit, above 65535<a href="#section-10-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-2.3">Comment: Optionally, a brief English text describing the purpose of
           the record type (in UTF-8)<a href="#section-10-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-2.4">Contact: Optionally, the contact information of a person to contact for
           further information.<a href="#section-10-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-2.5">References: Optionally, references describing the record type
           (such as an RFC)<a href="#section-10-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-10-3">
         The registration policy for this registry is "First Come First
         Served". This policy is modeled on that described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>,
         and describes the actions taken by GANA:<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">
         
         Adding new records is possible after expert review, using a
         first-come-first-served policy for unique name allocation.
         Experts are responsible to ensure that the chosen "Name" is
         appropriate for the record type.
         The registry will assign a unique number for the entry.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">
         The current contact(s) for expert review are reachable at
         gns-registry@gnunet.org.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">
         Any request MUST contain a unique name and a point of contact.
         The contact information MAY be added to the registry given the consent
         of the requester.
         The request MAY optionally also contain relevant references as well
         as a descriptive comment as defined above.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">
         GANA is requested to populate this registry as listed in
         <a href="#figure_rrtypenums" class="xref">Figure 21</a>.<a href="#section-10-7" class="pilcrow">¶</a></p>
<div id="figure_rrtypenums">
<figure id="figure-21">
        <div class="alignLeft art-text artwork" id="section-10-8.1">
<pre>
Number | Name    | Contact | References | Comment
-------+---------+---------+------------+-------------------------
65536  | PKEY    | N/A     | [This.I-D] | GNS zone delegation (PKEY)
65537  | NICK    | N/A     | [This.I-D] | GNS zone nickname
65538  | LEHO    | N/A     | [This.I-D] | GNS legacy hostname
65540  | GNS2DNS | N/A     | [This.I-D] | Delegation to DNS
65541  | BOX     | N/A     | [This.I-D] | Boxed records
65551  | REDIRECT| N/A     | [This.I-D] | Redirection record.
65556  | EDKEY   | N/A     | [This.I-D] | GNS zone delegation (EDKEY)
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a></figcaption></figure>
</div>
<p id="section-10-9">The GANA Resource Record Registry.<a href="#section-10-9" class="pilcrow">¶</a></p>
<p id="section-10-10">
         GANA is requested to amend the "GNUnet Signature Purpose" registry
           as illustrated in <a href="#figure_purposenums" class="xref">Figure 22</a>.<a href="#section-10-10" class="pilcrow">¶</a></p>
<div id="figure_purposenums">
<figure id="figure-22">
        <div class="alignLeft art-text artwork" id="section-10-11.1">
<pre>
Purpose | Name            | References | Comment
--------+-----------------+------------+--------------------------
  3     | GNS_REVOCATION  | [This.I-D] | GNS zone key revocation
 15     | GNS_RECORD_SIGN | [This.I-D] | GNS record set signature
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a></figcaption></figure>
</div>
<p id="section-10-12">Requested Changes in the GANA GNUnet Signature Purpose Registry.<a href="#section-10-12" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">
         This document makes no requests for IANA action.
         This section may be removed on publication as an RFC.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-implementation-and-deployme">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-implementation-and-deployme" class="section-name selfRef">Implementation and Deployment Status</a>
      </h2>
<p id="section-12-1">
         There are two implementations conforming to this specification written
         in C and Go, respectively. The C implementation as part of GNUnet
         <span>[<a href="#GNUnetGNS" class="xref">GNUnetGNS</a>]</span> represents the original
         and reference implementation. The Go implementation
         <span>[<a href="#GoGNS" class="xref">GoGNS</a>]</span> demonstrates how two implementations of GNS are
         interoperable given that they are built on top of the same underlying
         DHT storage.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">
         Currently, the GNUnet peer-to-peer network <span>[<a href="#GNUnet" class="xref">GNUnet</a>]</span>
         is an active deployment of GNS on top of its <span>[<a href="#R5N" class="xref">R5N</a>]</span>
         DHT. The <span>[<a href="#GoGNS" class="xref">GoGNS</a>]</span> implementation uses this deployment
         by building on top of the GNUnet DHT services available on any
         GNUnet peer. It shows how GNS implementations
         can attach to this existing deployment and participate in name
         resolution as well as zone publication.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">
         The self-sovereign identity system re:claimID <span>[<a href="#reclaim" class="xref">reclaim</a>]</span>
         is using GNS in order to selectively share identity attributes and
         attestations with third parties.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">
         The Ascension tool <span>[<a href="#Ascension" class="xref">Ascension</a>]</span> facilitates the migration of DNS zones to
         GNS zones by translating information retrieved from a DNS zone
         transfer into a GNS zone.<a href="#section-12-4" class="pilcrow">¶</a></p>
</section>
<section id="section-13">
      <h2 id="name-acknowledgements">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-13-1">
          The authors thank D. J. Bernstein, A. Farrel and S. Bortzmeyer for their
          insightful reviews. We thank NLnet and NGI DISCOVERY for funding
          work on the GNU Name System.<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
      <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3491">[RFC3491]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">M. Blanchet</span>, <span class="refTitle">"Nameprep: A Stringprep Profile for Internationalized Domain Names (IDN)"</span>, <span class="seriesInfo">RFC 3491</span>, <span class="seriesInfo">DOI 10.17487/RFC3491</span>, <time datetime="2003-03" class="refDate">March 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3491">https://www.rfc-editor.org/info/rfc3491</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
      <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3686">[RFC3686]</dt>
      <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 3686</span>, <span class="seriesInfo">DOI 10.17487/RFC3686</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3686">https://www.rfc-editor.org/info/rfc3686</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3826">[RFC3826]</dt>
      <dd>
<span class="refAuthor">Blumenthal, U.</span>, <span class="refAuthor">Maino, F.</span>, and <span class="refAuthor">K. McCloghrie</span>, <span class="refTitle">"The Advanced Encryption Standard (AES) Cipher Algorithm in the SNMP User-based Security Model"</span>, <span class="seriesInfo">RFC 3826</span>, <span class="seriesInfo">DOI 10.17487/RFC3826</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3826">https://www.rfc-editor.org/info/rfc3826</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5237">[RFC5237]</dt>
      <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">S. Bradner</span>, <span class="refTitle">"IANA Allocation Guidelines for the Protocol Field"</span>, <span class="seriesInfo">BCP 37</span>, <span class="seriesInfo">RFC 5237</span>, <span class="seriesInfo">DOI 10.17487/RFC5237</span>, <time datetime="2008-02" class="refDate">February 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5237">https://www.rfc-editor.org/info/rfc5237</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
      <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[RFC5890]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5891">[RFC5891]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names in Applications (IDNA): Protocol"</span>, <span class="seriesInfo">RFC 5891</span>, <span class="seriesInfo">DOI 10.17487/RFC5891</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5891">https://www.rfc-editor.org/info/rfc5891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6895">[RFC6895]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) IANA Considerations"</span>, <span class="seriesInfo">BCP 42</span>, <span class="seriesInfo">RFC 6895</span>, <span class="seriesInfo">DOI 10.17487/RFC6895</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6895">https://www.rfc-editor.org/info/rfc6895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
      <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
      <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
      <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Sullivan, A.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9106">[RFC9106]</dt>
      <dd>
<span class="refAuthor">Biryukov, A.</span>, <span class="refAuthor">Dinu, D.</span>, <span class="refAuthor">Khovratovich, D.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications"</span>, <span class="seriesInfo">RFC 9106</span>, <span class="seriesInfo">DOI 10.17487/RFC9106</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9106">https://www.rfc-editor.org/info/rfc9106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GANA">[GANA]</dt>
      <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"GNUnet Assigned Numbers Authority (GANA)"</span>, <time datetime="2020-04" class="refDate">April 2020</time>, <span>&lt;<a href="https://gana.gnunet.org/">https://gana.gnunet.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MODES">[MODES]</dt>
      <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Methods and Techniques"</span>, <time datetime="2001-12" class="refDate">December 2001</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-38A">https://doi.org/10.6028/NIST.SP.800-38A</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="CrockfordB32">[CrockfordB32]</dt>
      <dd>
<span class="refAuthor">Douglas, D.</span>, <span class="refTitle">"Base32"</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.crockford.com/base32.html">https://www.crockford.com/base32.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XSalsa20">[XSalsa20]</dt>
      <dd>
<span class="refAuthor">Bernstein, D.</span>, <span class="refTitle">"Extending the Salsa20 nonce"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="https://cr.yp.to/snuffle/xsalsa-20110204.pdf">https://cr.yp.to/snuffle/xsalsa-20110204.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Unicode-UAX15">[Unicode-UAX15]</dt>
      <dd>
<span class="refAuthor">Consortium, T. U.</span>, <span class="refTitle">"Unicode Standard Annex #15: Unicode Normalization Forms, Revision 31"</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="http://www.unicode.org/reports/tr15/tr15-31.html">http://www.unicode.org/reports/tr15/tr15-31.html</a>&gt;</span>. </dd>
<dd class="break"></dd></dl>
</section>
<section id="section-15">
      <h2 id="name-informative-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC4033">[RFC4033]</dt>
      <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC7363">[RFC7363]</dt>
      <dd>
<span class="refAuthor">Maenpaa, J.</span> and <span class="refAuthor">G. Camarillo</span>, <span class="refTitle">"Self-Tuning Distributed Hash Table (DHT) for REsource LOcation And Discovery (RELOAD)"</span>, <span class="seriesInfo">RFC 7363</span>, <span class="seriesInfo">DOI 10.17487/RFC7363</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7363">https://www.rfc-editor.org/info/rfc7363</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8324">[RFC8324]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?"</span>, <span class="seriesInfo">RFC 8324</span>, <span class="seriesInfo">DOI 10.17487/RFC8324</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8324">https://www.rfc-editor.org/info/rfc8324</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="Tor224">[Tor224]</dt>
      <dd>
<span class="refAuthor">Goulet, D.</span>, <span class="refAuthor">Kadianakis, G.</span>, and <span class="refAuthor">N. Mathewson</span>, <span class="refTitle">"Next-Generation Hidden Services in Tor"</span>, <time datetime="2013-11" class="refDate">November 2013</time>, <span>&lt;<a href="https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135">https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SDSI">[SDSI]</dt>
      <dd>
<span class="refAuthor">Rivest, R.</span> and <span class="refAuthor">B. Lampson</span>, <span class="refTitle">"SDSI - A Simple Distributed Security Infrastructure"</span>, <time datetime="1996-04" class="refDate">April 1996</time>, <span>&lt;<a href="http://people.csail.mit.edu/rivest/Sdsi10.ps">http://people.csail.mit.edu/rivest/Sdsi10.ps</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Kademlia">[Kademlia]</dt>
      <dd>
<span class="refAuthor">Maymounkov, P.</span> and <span class="refAuthor">D. Mazieres</span>, <span class="refTitle">"Kademlia: A peer-to-peer information system based on the xor metric."</span>, <time datetime="2002" class="refDate">2002</time>, <span>&lt;<a href="http://css.csail.mit.edu/6.824/2014/papers/kademlia.pdf">http://css.csail.mit.edu/6.824/2014/papers/kademlia.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="ed25519">[ed25519]</dt>
      <dd>
<span class="refAuthor">Bernstein, D.</span>, <span class="refAuthor">Duif, N.</span>, <span class="refAuthor">Lange, T.</span>, <span class="refAuthor">Schwabe, P.</span>, and <span class="refAuthor">B. Yang</span>, <span class="refTitle">"High-Speed High-Security Signatures"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="http://link.springer.com/chapter/10.1007/978-3-642-23951-9_9">http://link.springer.com/chapter/10.1007/978-3-642-23951-9_9</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNS">[GNS]</dt>
      <dd>
<span class="refAuthor">Wachs, M.</span>, <span class="refAuthor">Schanzenbach, M.</span>, and <span class="refAuthor">C. Grothoff</span>, <span class="refTitle">"A Censorship-Resistant, Privacy-Enhancing and Fully Decentralized Name System"</span>, <time datetime="2014" class="refDate">2014</time>, <span>&lt;<a href="https://sci-hub.st/10.1007/978-3-319-12280-9_9">https://sci-hub.st/10.1007/978-3-319-12280-9_9</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="R5N">[R5N]</dt>
      <dd>
<span class="refAuthor">Evans, N. S.</span> and <span class="refAuthor">C. Grothoff</span>, <span class="refTitle">"R5N: Randomized recursive routing for restricted-route networks"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="https://sci-hub.st/10.1109/ICNSS.2011.6060022">https://sci-hub.st/10.1109/ICNSS.2011.6060022</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SecureNS">[SecureNS]</dt>
      <dd>
<span class="refAuthor">Grothoff, C.</span>, <span class="refAuthor">Wachs, M.</span>, <span class="refAuthor">Ermert, M.</span>, and <span class="refAuthor">J. Appelbaum</span>, <span class="refTitle">"Towards secure name resolution on the Internet"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://sci-hub.st/https://doi.org/10.1016/j.cose.2018.01.018">https://sci-hub.st/https://doi.org/10.1016/j.cose.2018.01.018</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNUnetGNS">[GNUnetGNS]</dt>
      <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"The GNUnet GNS Implementation"</span>, <span>&lt;<a href="https://git.gnunet.org/gnunet.git/tree/src/gns">https://git.gnunet.org/gnunet.git/tree/src/gns</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Ascension">[Ascension]</dt>
      <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"The Ascension Implementation"</span>, <span>&lt;<a href="https://git.gnunet.org/ascension.git">https://git.gnunet.org/ascension.git</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNUnet">[GNUnet]</dt>
      <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"The GNUnet Project"</span>, <span>&lt;<a href="https://gnunet.org">https://gnunet.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="reclaim">[reclaim]</dt>
      <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"The GNUnet Project"</span>, <span>&lt;<a href="https://reclaim.gnunet.org">https://reclaim.gnunet.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GoGNS">[GoGNS]</dt>
    <dd>
<span class="refAuthor">Fix, B.</span>, <span class="refTitle">"The Go GNS Implementation"</span>, <span>&lt;<a href="https://github.com/bfix/gnunet-go/tree/master/src/gnunet/service/gns">https://github.com/bfix/gnunet-go/tree/master/src/gnunet/service/gns</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="appendix-A">
      <h2 id="name-base32gns">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-base32gns" class="section-name selfRef">Base32GNS</a>
      </h2>
<p id="appendix-A-1">
         This table defines the encode symbol and decode symbol for a given
         symbol value.
         It can be used to implement the encoding by reading it as:
         A character "A" or "a" is decoded to a 5 bit value 10 when decoding.
         A 5 bit block with a value of 18 is encoded to the character "J" when encoding.
         If the bit length of the byte string to encode is not a multiple of 5
         it is padded to the next multiple with zeroes.
         In order to further increase tolerance for failures in character
         recognition, the letter "U" MUST be decoded to the same value as the
         letter "V" in Base32GNS.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="CrockfordB32Encode">
<figure id="figure-23">
        <div class="alignLeft art-text artwork" id="appendix-A-2.1">
<pre>
Symbol      Decode            Encode
Value       Symbol            Symbol
0           0 O o             0
1           1 I i L l         1
2           2                 2
3           3                 3
4           4                 4
5           5                 5
6           6                 6
7           7                 7
8           8                 8
9           9                 9
10          A a               A
11          B b               B
12          C c               C
13          D d               D
14          E e               E
15          F f               F
16          G g               G
17          H h               H
18          J j               J
19          K k               K
20          M m               M
21          N n               N
22          P p               P
23          Q q               Q
24          R r               R
25          S s               S
26          T t               T
27          V v U u           V
28          W w               W
29          X x               X
30          Y y               Y
31          Z z               Z
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a></figcaption></figure>
</div>
<p id="appendix-A-3">
         The Base32GNS Alphabet Including the Additional U Encode Symbol.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B">
      <h2 id="name-test-vectors">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-B-1">
         The following are test vectors for the Base32GNS encoding used for zTLDs.
         The strings are encoded without the zero terminator.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>

Base32GNS-Encode:
  Input string: "Hello World"
  Output string: "91JPRV3F41BPYWKCCG"

  Input bytes: 474e55204e616d652053797374656d
  Output string: "8X75A82EC5PPA82KF5SQ8SBD"

Base32GNS-Decode:
  Input string: "91JPRV3F41BPYWKCCG"
  Output string: "Hello World"

  Input string: "91JPRU3F41BPYWKCCG"
  Output string: "Hello World"

</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B-3">
         The following represents test vectors for record sets with a variety
         of record types and flags for both PKEY and EDKEY zones.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-4">
<pre>

Zone private key (d, big-endian):
50d7b652a4efeadf
f37396909785e595
2171a02178c8e7d4
50fa907925fafd98

Zone identifier (ztype|zkey):
00010000677c477d
2d93097c85b195c6
f96d84ff61f5982c
2c4fe02d5a11fedf
b0c2901f

Encoded zone identifier (zkl = zTLD):
000G0037FH3QTBCK15Y8BCCNRVWPV17ZC7TSGB1C9ZG2TPGHZVFV1GMG3W

Label: testdelegation
RRCOUNT: 1

Record #0
EXPIRATION: 2463385894000000
DATA_SIZE: 36
TYPE: 65536
FLAGS: 0001

DATA:
0001000021e3b30f
f93bc6d35ac8c6e0
e13afdff794cb7b4
4bbbc748d259d0a0
284dbe84

RDATA:
0008c06fb9281580
0024000100010000
0001000021e3b30f
f93bc6d35ac8c6e0
e13afdff794cb7b4
4bbbc748d259d0a0
284dbe84

Encryption NONCE|EXPIRATION|BLOCK COUNTER:
e90a00610008c06f
b928158000000001

Encryption key (K):
864e7138eae7fd91
a30136899c132b23
acebd2cef43cb19
f6bf55b67db9b3b3

Storage key (q):
4adc67c5ecee9f76
986abd71c2224a3d
ce2e917026c9a09d
fd44cef3d20f55a2
7332725a6c8afbbb
b0f7ec9af1cc4264
1299406b04fd9b5b
5791f86c4b08d5f4

BDATA:
41dc7b5f2176ba59
199cafb9e3c82579
71b21ccb6de51d38
bd2a21e9322c6af8
4243e8de876b5b76
37462e79b2c162db
4014d5c9

RRBLOCK:
000000a400010000
182bb636eda79f79
5711bc2708adbb24
2a60446ad3c30803
121d03d348b7ceb6
01a968a5eac3cb95
ed58c1c5386f4ab6
539edd8099b4893a
be83f242115e3e35
03965dc924a6001a
e94ecab9b2f25c4c
6fdc7ffbe9f3b2a2
854b321b1d7ea9ab
0008c06fb9281580
41dc7b5f2176ba59
199cafb9e3c82579
71b21ccb6de51d38
bd2a21e9322c6af8
4243e8de876b5b76
37462e79b2c162db
4014d5c9

Zone private key (d, big-endian):
50d7b652a4efeadf
f37396909785e595
2171a02178c8e7d4
50fa907925fafd98

Zone identifier (ztype|zkey):
00010000677c477d
2d93097c85b195c6
f96d84ff61f5982c
2c4fe02d5a11fedf
b0c2901f

Encoded zone identifier (zkl = zTLD):
000G0037FH3QTBCK15Y8BCCNRVWPV17ZC7TSGB1C9ZG2TPGHZVFV1GMG3W

Label: namesystem
RRCOUNT: 3

Record #0
EXPIRATION: 2463385894000000
DATA_SIZE: 16
TYPE: 28
FLAGS: 0000

DATA:
0000000000000000
00000000deadbeef

Record #1
EXPIRATION: 49556645701000000
DATA_SIZE: 6
TYPE: 65537
FLAGS: 8000

DATA:
e6849be7a7b0

Record #2
EXPIRATION: 6089306424
DATA_SIZE: 11
TYPE: 16
FLAGS: 4004

DATA:
48656c6c6f20576f
726c64

RDATA:
0008c06fb9281580
001000000000001c
0000000000000000
00000000deadbeef
00b00f81b7449b40
0006800000010001
e6849be7a7b00000
00016af37138000b
4004000000104865
6c6c6f20576f726c
6400000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000

Encryption NONCE|EXPIRATION|BLOCK COUNTER:
a5df4a330005d816
0d595e8900000001

Encryption key (K):
39a8824c4da40242
d9e05eb46cdf280f
29a116f8acfd94c8
6df48b2b7aac82ff

Storage key (q):
07f6e965f75c815d
35fea2212692c8fc
f9b575cb42f0fd84
5d4d7327199cf3dd
dcbc5565ca2b81fe
b08088ae2bb2afd0
d85f2fed85e170be
ee86bf67ce2b9ece

BDATA:
83df3617de6bbd8a
887e6ddca9755edd
fd56b4a39d07b9a8
1f285d004ba567b2
40c9766411e40fc7
8627f6b372486f99
215875f5b8745879
394f61a10f770922
3c94b04d93d16cdc
0a072402e926512f
08cc632ed7310018
69550cacac78d9d2
0d6dff70d329c84f
a6fc8e78f64188da
4a217ebfae374937
c62121526e85d97c

RRBLOCK:
000000f000010000
ddef91ac40ad25e3
6b65242789ee9662
e195ced12e76245e
10ebc70bbe089906
01f1f20d0dd97f38
7d726e47046f5bdc
1158724a2f1ccf39
ecfd0e918351e2ea
0696cc286dfb1722
ed0f4ea9da83bbcf
5dd4a2842fe5bb64
17ae3602a06527c4
0005d8160d595e89
83df3617de6bbd8a
887e6ddca9755edd
fd56b4a39d07b9a8
1f285d004ba567b2
40c9766411e40fc7
8627f6b372486f99
215875f5b8745879
394f61a10f770922
3c94b04d93d16cdc
0a072402e926512f
08cc632ed7310018
69550cacac78d9d2
0d6dff70d329c84f
a6fc8e78f64188da
4a217ebfae374937
c62121526e85d97c

Zone private key (d):
5af7020ee1916032
8832352bbc6a68a8
d71a7cbe1b929969
a7c66d415a0d8f65

Zone identifier (ztype|zkey):
000100143cf4b924
032022f0dc505814
53b85d93b047b63d
446c5845cb48445d
db96688f

Encoded zone identifier (zkl = zTLD):
000G051WYJWJ80S04BRDRM2R2H9VGQCKP13VCFA4DHC4BJT88HEXQ5K8HW

Label: testdelegation
RRCOUNT: 1

Record #0
EXPIRATION: 2463385894000000
DATA_SIZE: 36
TYPE: 65536
FLAGS: 0001

DATA:
0001000021e3b30f
f93bc6d35ac8c6e0
e13afdff794cb7b4
4bbbc748d259d0a0
284dbe84

RDATA:
0008c06fb9281580
0024000100010000
0001000021e3b30f
f93bc6d35ac8c6e0
e13afdff794cb7b4
4bbbc748d259d0a0
284dbe84

Encryption NONCE|EXPIRATION:
98132ea86859d35c
88bfd317fa991bcb
0008c06fb9281580

Encryption key (K):
85c429a9567aa633
411a9691e9094c45
281672be586034aa
e4a2a2cc716159e2

Storage key (q):
abaabac0e1249459
75988395aac0241e
5559c41c4074e255
7b9fe6d154b614fb
cdd47fc7f51d786d
c2e0b1ece76037c0
a1578c384ec61d44
5636a94e880329e9

BDATA:
7d9ecea3c19ef07b
0db1fab44c5e4477
6ea8d8894e904a0c
35ed1c5c2ff2ed93
bd204b3fcae98192
fad94afbc5bba3a6
de538c01c7e1f65e
2a883cc068c02109
7afd7330

RRBLOCK:
000000b400010014
9bf233198c6d53bb
dbac495cabd91049
a684af3f4051baca
b0dcf21c8cf27a1a
69ac3485946796d1
e31837f569d71e06
e79c4777ab9c41fa
29cdd198464aac3d
aaeea2c192eb6e71
1d0dc7bb76994eca
ab837e402ba2c994
4df155b6e96fdf0a
0008c06fb9281580
7d9ecea3c19ef07b
0db1fab44c5e4477
6ea8d8894e904a0c
35ed1c5c2ff2ed93
bd204b3fcae98192
fad94afbc5bba3a6
de538c01c7e1f65e
2a883cc068c02109
7afd7330

Zone private key (d):
5af7020ee1916032
8832352bbc6a68a8
d71a7cbe1b929969
a7c66d415a0d8f65

Zone identifier (ztype|zkey):
000100143cf4b924
032022f0dc505814
53b85d93b047b63d
446c5845cb48445d
db96688f

Encoded zone identifier (zkl = zTLD):
000G051WYJWJ80S04BRDRM2R2H9VGQCKP13VCFA4DHC4BJT88HEXQ5K8HW

Label: namesystem
RRCOUNT: 3

Record #0
EXPIRATION: 2463385894000000
DATA_SIZE: 16
TYPE: 28
FLAGS: 0000

DATA:
0000000000000000
00000000deadbeef

Record #1
EXPIRATION: 49556645701000000
DATA_SIZE: 6
TYPE: 65537
FLAGS: 8000

DATA:
e6849be7a7b0

Record #2
EXPIRATION: 6089306424
DATA_SIZE: 11
TYPE: 16
FLAGS: 4004

DATA:
48656c6c6f20576f
726c64

RDATA:
0008c06fb9281580
001000000000001c
0000000000000000
00000000deadbeef
00b00f81b7449b40
0006800000010001
e6849be7a7b00000
00016af37138000b
4004000000104865
6c6c6f20576f726c
6400000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000

Encryption NONCE|EXPIRATION:
d9402801e26324b6
0c227f25203e9f26
0005d8160d59693e

Encryption key (K):
20007fe09b16dc86
e0fd0d74fb3d5d0b
7962d7fe5301a7b4
ec9f8bfd935cc9d2

Storage key (q):
82584d4d2c314be7
5b304222a63fa6e4
e52ea63d7dbd153c
6e3ba1ae749c5772
e1c6b245633c5563
37c7fc60b0115888
ad5ade579522e9d7
10fa23cd93e56e8c

BDATA:
92b722bc0289cccc
c073b2c741abe8fb
ee9b961bae66312a
7be8cb9db2a34508
55a8709eba0288d8
4e3b0302c24e8f0b
079f2aa90dcb884e
d4ec3157b0652ee3
126ec890c6352ef5
0a7b207e55a5e99b
4f78d900e7ce10b5
295a7af328cd249e
61adc50fd185af21
b00789dc7213590c
2e2eca61119434c5
ee859f0f228ccdb9
e9b0ad33a5aaa9b5
8d96b7f901c7b895

RRBLOCK:
0000010000010014
1e7f6acfa589c933
6eae0bd307c893c4
85a873cf0cbbfd9d
54d04c13e3b7d284
aadc29066b2db0e3
690484e4396113fe
d1c27d636b49863b
85a0551d633b4213
c1a0d47f5be7b6d1
7632368b1ba4d57f
8b2b5866bb8abe33
61472e36e98d510e
0005d8160d59693e
92b722bc0289cccc
c073b2c741abe8fb
ee9b961bae66312a
7be8cb9db2a34508
55a8709eba0288d8
4e3b0302c24e8f0b
079f2aa90dcb884e
d4ec3157b0652ee3
126ec890c6352ef5
0a7b207e55a5e99b
4f78d900e7ce10b5
295a7af328cd249e
61adc50fd185af21
b00789dc7213590c
2e2eca61119434c5
ee859f0f228ccdb9
e9b0ad33a5aaa9b5
8d96b7f901c7b895

</pre><a href="#appendix-B-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B-5">
         The following is an example revocation for a zone:<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-6">
<pre>

Zone private key (d, big-endian scalar):
6fea32c05af58bfa
979553d188605fd5
7d8bf9cc263b78d5
f7478c07b998ed70

Zone identifier (ztype|zkey):
000100002ca223e8
79ecc4bbdeb5da17
319281d63b2e3b69
55f1c3775c804a98
d5f8ddaa

Encoded zone identifier (zkl = zTLD):
000G001CM8HYGYFCRJXXXDET2WRS50EP7CQ3PTANY71QEQ409ACDBY6XN8

Difficulty (5 base difficulty + 2 epochs): 7

Signed message:
0000003400000003
0005d66da3598127
000100002ca223e8
79ecc4bbdeb5da17
319281d63b2e3b69
55f1c3775c804a98
d5f8ddaa

Proof:
0005d66da3598127
0000395d1827c000
3ab877d07570f2b8
3ab877d07570f332
3ab877d07570f4f5
3ab877d07570f50f
3ab877d07570f537
3ab877d07570f599
3ab877d07570f5cd
3ab877d07570f5d9
3ab877d07570f66a
3ab877d07570f69b
3ab877d07570f72f
3ab877d07570f7c3
3ab877d07570f843
3ab877d07570f8d8
3ab877d07570f91b
3ab877d07570f93a
3ab877d07570f944
3ab877d07570f98a
3ab877d07570f9a7
3ab877d07570f9b0
3ab877d07570f9df
3ab877d07570fa05
3ab877d07570fa3e
3ab877d07570fa63
3ab877d07570fa84
3ab877d07570fa8f
3ab877d07570fa91
3ab877d07570fad6
3ab877d07570fb0a
3ab877d07570fc0f
3ab877d07570fc43
3ab877d07570fca5
000100002ca223e8
79ecc4bbdeb5da17
319281d63b2e3b69
55f1c3775c804a98
d5f8ddaa053b0259
700039187d1da461
3531502bc4a4eecc
c69900d24f8aac54
30f28fc509270133
1f178e290fe06e82
ce2498ce7b23a340
58e3d6a2f247e92b
c9d7b9ab

</pre><a href="#appendix-B-6" class="pilcrow">¶</a>
</div>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Schanzenbach</span></div>
<div dir="auto" class="left"><span class="org">GNUnet e.V.</span></div>
<div dir="auto" class="left"><span class="street-address">Boltzmannstrasse 3</span></div>
<div dir="auto" class="left">
<span class="postal-code">85748</span> <span class="locality">Garching</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:schanzen@gnunet.org" class="email">schanzen@gnunet.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christian Grothoff</span></div>
<div dir="auto" class="left"><span class="org">Berner Fachhochschule</span></div>
<div dir="auto" class="left"><span class="street-address">Hoeheweg 80</span></div>
<div dir="auto" class="left">CH-<span class="postal-code">2501</span> <span class="locality">Biel/Bienne</span>
</div>
<div dir="auto" class="left"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:grothoff@gnunet.org" class="email">grothoff@gnunet.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bernd Fix</span></div>
<div dir="auto" class="left"><span class="org">GNUnet e.V.</span></div>
<div dir="auto" class="left"><span class="street-address">Boltzmannstrasse 3</span></div>
<div dir="auto" class="left">
<span class="postal-code">85748</span> <span class="locality">Garching</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fix@gnunet.org" class="email">fix@gnunet.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
