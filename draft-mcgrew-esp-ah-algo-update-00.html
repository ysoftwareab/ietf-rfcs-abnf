<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Updating ESP and AH Algorithm Requirements for Efficiency and Security</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Updating ESP and AH Algorithm Requirements for Efficiency and Security">
<meta name="keywords" content="Cryptography">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">K. Grewal</td></tr>
<tr><td class="header">Expires: August 12, 2010</td><td class="header">Intel Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 08, 2010</td></tr>
</table></td></tr></table>
<h1><br />Updating ESP and AH Algorithm Requirements for Efficiency and Security<br />draft-mcgrew-esp-ah-algo-update-00.txt</h1>

<h3>Abstract</h3>

<p>
This note defines an update to the ESP and AH algorithm requirements that
promotes efficiency, security, and interoperability, by recommending
the use of the Advanced Encryption Standard (AES) block cipher in the
Galois/Counter Mode (GCM) of operation.  It is an individual
submission, intended as input to future standards track work on
IPsec policy.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 12, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions Used In This Document<br />
<a href="#anchor3">2.</a>&nbsp;
New Algorithm Guidance<br />
<a href="#anchor4">3.</a>&nbsp;
Rationale<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.</a>&nbsp;
Efficiency<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.2.</a>&nbsp;
HMAC-SHA-2<br />
<a href="#anchor7">4.</a>&nbsp;
Other Algorithms<br />
<a href="#anchor8">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor9">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
This note describes and motivates a change to the "Cryptographic
Algorithm Implementation Requirements for Encapsulating Security
Payload (ESP) and Authentication Header (AH)",
<a class='info' href='#RFC4835'>[RFC4835]<span> (</span><span class='info'>Manral, V., &ldquo;Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; April&nbsp;2007.</span><span>)</span></a>.  This note does not change the required algorithms;
rather, it replaces one SHOULD implement algorithm with another algorithm and
clarifies that a third algorithm (not mentioned in that RFC) is NOT RECOMMENDED.  

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions Used In This Document</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
New Algorithm Guidance</h3>

<p>
This memo proposes the following guidance:
</p>
<blockquote class="text">
<p>
An ESP implementation SHOULD include AES-128-GCM.  The use of
HMAC-SHA-256, HMAC-SHA-384, or HMAC-SHA-512 is NOT RECOMMENDED.  An AH
implementation SHOULD include AES-182-GMAC, and the use of
HMAC-SHA-256, HMAC-SHA-384, or HMAC-SHA-512 is NOT RECOMMENDED.  This
guidance does not apply to uses of HMAC or SHA-2 outside of ESP or AH.

</p>
</blockquote><p>

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Rationale</h3>

<p>
AES in Galois/Counter Mode of operation (AES-GCM)
<a class='info' href='#RFC4106'>[RFC4106]<span> (</span><span class='info'>Viega, J. and D. McGrew, &ldquo;The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP),&rdquo; June&nbsp;2005.</span><span>)</span></a> <a class='info' href='#RFC4543'>[RFC4543]<span> (</span><span class='info'>McGrew, D. and J. Viega, &ldquo;The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH,&rdquo; May&nbsp;2006.</span><span>)</span></a>
<a class='info' href='#RFC5282'>[RFC5282]<span> (</span><span class='info'>Black, D. and D. McGrew, &ldquo;Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol,&rdquo; August&nbsp;2008.</span><span>)</span></a> should be recommended for use in ESP and AH,
because it provides higher efficiency than currently recommended
algorithms with equivalent security, and is required by newer IPsec
profiles <a class='info' href='#RFC4869'>[RFC4869]<span> (</span><span class='info'>Law, L. and J. Solinas, &ldquo;Suite B Cryptographic Suites for IPsec,&rdquo; May&nbsp;2007.</span><span>)</span></a>.

</p>
<p>
In order for ESP and AH implementations to realize the efficiency
benefits that GCM offers, it is important for IPsec to recognize the
sufficiency of that algorithm.  A major benefit of GCM is smaller
circuit size at high data rates.  However, this compactness will be
squandered if implementations have to additionally include the
circuits for less efficient algorithms.

</p>
<p>
Currently, AES in Counter Mode (AES-CTR) <a class='info' href='#RFC3686'>[RFC3686]<span> (</span><span class='info'>Housley, R., &ldquo;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP),&rdquo; January&nbsp;2004.</span><span>)</span></a> is
recommended as a SHOULD in  <a class='info' href='#RFC4835'>[RFC4835]<span> (</span><span class='info'>Manral, V., &ldquo;Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; April&nbsp;2007.</span><span>)</span></a>.  AES-CTR is a
useful algorithm because it admits efficient high speed
implementations.  However, it provides no authentication.  From
RFC3686: 
</p>
<blockquote class="text">
<p>
  "With AES-CTR, it is trivial to use a valid ciphertext to
  forge other (valid to the decryptor) ciphertexts. Thus, it is equally
  catastrophic to use AES-CTR without a companion authentication
  function. Implementations MUST use AES-CTR in conjunction with an
  authentication function, such as HMAC-SHA-1-96 [HMAC-SHA]."

</p>
</blockquote><p>
Unfortunately, none of the authentication algorithms currently defined
for IPsec (HMAC, XCBC-MAC) admit efficient high speed implementations.
Thus the need for authentication undermines the efficiency of AES-CTR.
An unintended side effect is that users may be tempted to run AES-CTR
without authentication for performance reasons, even though the
standard says not to do so.

</p>
<p>
AES-GCM was designed specifically to overcome these problems.  It is a
"combined mode" in the ESP sense <a class='info' href='#RFC4303'>[RFC4303]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>, that
provides both encryption and authentication.  Internally, it combines
AES-CTR with an authentication mechanism that can be efficiently
implemented at high data rates.

</p>
<p>
At the time that RFC 4835 was published (April 2007), there was not
yet a stable normative reference for AES-GCM.  This may have motivated
the IPsec community to not put too much reliance on that algorithm in
its guidelines.  But November 2007 saw the publication of
"Recommendation for Block Cipher Modes of Operation: Galois/ Counter
Mode (GCM) and GMAC" <a class='info' href='#800-38D'>[800&#8209;38D]<span> (</span><span class='info'>Dworkin, M., &ldquo;Special Publication 800-38D: Recommendation for                  Block Cipher Modes of Operation: Galois/Counter Mode                  (GCM) and GMAC.,&rdquo; .</span><span>)</span></a>, which removes any such
concern.  An additional change in favor of AES-GCM is its wide
adoption by cryptographic hardware and software suppliers.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Efficiency</h3>

<p>
GCM can be efficiently implemented in hardware, because it can be
parallelized or fully pipelined with low latency, and it uses
relatively efficient GF(2^128) operations.   For more information
about performance in hardware, see the analysis of packet-processing
and hardware in Section 3 of <a class='info' href='#MV04'>[MV04]<span> (</span><span class='info'>McGrew, D. and J. Viega, &ldquo;The Security and Performance of the Galois/Counter           Mode (GCM),&rdquo; December&nbsp;2004.</span><span>)</span></a>. 

</p>
<p>
Efficient software implementations are also possible.  With a modest
use of memory and a precomputed table, GCM can easily match the
performance of other encryption-and-authentication methods.  The
benchmarks of the popular Crypto++ library show that GCM with a 2Kb
table significantly outperforms the combination of HMAC-SHA-1 with any
AES encryption mode <a class='info' href='#DAI'>[DAI]<span> (</span><span class='info'>Dai, W., &ldquo;Crypto++ 5.6.0 Benchmarks,&rdquo; 2009.</span><span>)</span></a>.  (For the purposes of
comparison, one can consider GCM's authentication component, which is
called GMAC when used separately.  GMAC can be compared to HMAC-SHA-1,
SHA-256 and SHA-512.)

</p>
<p>
When specialized hardware or implementation techniques are available,
GCM is typically the most efficient alternative.  Kasper and Schwabe
recently published implementation strategies for modern CPUs that
include the most efficient software implementations of any
authentication encryption algorithm to date <a class='info' href='#KS09'>[KS09]<span> (</span><span class='info'>Kasper, E. and P. Schwabe, &ldquo;Faster and Timing-Attack Resistant AES-GCM,&rdquo; 2009.</span><span>)</span></a>.  A
recent report shows that AES-GCM can outperform the combination of
AES-CBC and HMAC-SHA-1 by over 40%, on platforms with cryptographic
instructions <a class='info' href='#AES-NI'>[AES&#8209;NI]<span> (</span><span class='info'>Kounavis, M., &ldquo;AES-NI: New Technology for Improving Encryption           Efficiency and Enhancing Data Security in the Enterprise Cloud,&rdquo; 2009.</span><span>)</span></a>.  The performance margin over
HMAC-SHA-256 or HMAC-SHA-512 would be even greater.
 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
HMAC-SHA-2</h3>

<p>
The Secure Hash Standard, version 2 <a class='info' href='#FIPS-180-2'>[FIPS&#8209;180&#8209;2]<span> (</span><span class='info'>, &ldquo;Announcing the SECURE HASH STANDARD,&rdquo; August&nbsp;2002.</span><span>)</span></a>
defines the hash algorithms SHA-256, SHA-384, and SHA-512.  These
functions are similar to the SHA-1 hash function, but have higher
security goals.  These functions are unkeyed, but they can be used in
the HMAC algorithm <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a> as a keyed message
authentication code.  The use of the hash function HASH in this manner
is denoted HMAC-HASH.

</p>
<p>
This memo suggests that IPsec explicitly put HMAC-SHA-256,
HMAC-SHA-384, and HMAC-SHA-512 in the "NOT RECOMMENDED for ESP or AH"
category, because those MACs neither necessary nor sufficient for
achieving the goals of efficiency, interoperability, and security.
There may be particular circumstances when these algorithms are
acceptable or even useful, but the full implications should be
understood and the case carefully weighed before implementing them.
Implications may include, e.g., higher power usage, higher circuit
cost, lower performance in software, and incompatibility with
implementations that do not, or can not, perform the additional
authentication due to their preference for more efficient algorithms.
This guidance applies only to the use of these algorithms in ESP and
AH; it does not apply to other uses described in
<a class='info' href='#RFC4868'>[RFC4868]<span> (</span><span class='info'>Kelly, S. and S. Frankel, &ldquo;Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec,&rdquo; May&nbsp;2007.</span><span>)</span></a>.

</p>
<p>
AES-GCM is preferred over the use of AES-CTR with HMAC-SHA-256 for use
in ESP and AH, because the latter combination of algorithms is
considerably less efficient, and the former algorithm meets the
security requirements.  HMAC-SHA-1 is believed to be secure (recall
the "No Need for SHA-2" Open Letter <a class='info' href='#OL'>[OL]<span> (</span><span class='info'>R. Dietz, Editor, &ldquo;No Need for SHA-2,&rdquo; 2002.</span><span>)</span></a>), but as the
industry moves away from SHA1, HMAC-SHA-256 may be the first algorithm
that comes to mind for some users of IPsec.  A transition away from
SHA-1 for digital signatures is already underway; many users plan to
have that transition completed by the end of 2010 (see "Recommendation
for Applications Using Approved Hash Algorithms"
<a class='info' href='#800-107'>[800&#8209;107]<span> (</span><span class='info'>, &ldquo;Special Publication 800-107: Recommendation for 	     Applications Using Approved Hash Algorithms,&rdquo; 2009.</span><span>)</span></a>, for example).

</p>
<p>
AES-CBC and HMAC-SHA1 are valuable because those algorithms are widely
implemented.  This suggests that it makes sense to rely on those
algorithms as mandatory-to-implement until the time comes when it
becomes necessary or desirable to stop using HMAC-SHA1.  AES-GCM could
be considered for use as a replacement to this combination of
algorithms, when that time comes.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Other Algorithms</h3>

<p>
It may be desirable to revisit the advisability of other algorithms in
RFC 4835 such as HMAC-MD5-96.  However, these considerations are out
of scope of this note.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 are believed 
to be secure.  The only reason that they are not recommended
is because they are less efficient.   No discredit to the
security of these functions should be inferred from
this guidance.

</p>
<p>
Internally, AES-GCM consists of AES-CTR encryption with an
authentication component that uses "universal hashing".  This
authentication method relies solely on well understood mathematical
properties of the hash function, rather than any unproven assumptions
about cryptographic properties.  In particular, AES-GCM makes no
cryptographic assumptions other than the suitability of AES as a
pseudorandom permutation, an assumption that is also shared by
AES-CTR.  Authentication using universal hashing is uncomplicated and
has been well understood in cryptographic theory for decades.  These
reasons have given confidence to the use of GCM in several standards,
including IEEE 802.1AE Ethernet MAC security, IEEE 1619 Security in
Storage, IPsec (ESP, AH, and IKE), and TLS.

</p>
<p>
GCM was in the vanguard of cryptographic standards that use universal
hashing for authentication.  While there was never any question about
the efficacy of universal hash based authentication, some commentators
pointed out system security aspects of GCM that are different than
those of other algorithms.  In particular, special care must be taken
to ensure the distinctness all of the nonce values used with a
particular GCM or GMAC key.  The standards describing the use of GCM
in ESP and AH already take these system security properties into
consideration; nonetheless, the interested reader can find more
background discussion in <a class='info' href='#MODES'>[MODES]<span> (</span><span class='info'>, &ldquo;Public Comments on the Draft GCM Specification, and 	     Comments on The Choice Between CWC or GCM,&rdquo; 2009.</span><span>)</span></a>.

</p>
<p>
An analysis of the security of GCM has been published
<a class='info' href='#MV04'>[MV04]<span> (</span><span class='info'>McGrew, D. and J. Viega, &ldquo;The Security and Performance of the Galois/Counter           Mode (GCM),&rdquo; December&nbsp;2004.</span><span>)</span></a>; the reader interested in the precise security
claims is referred to that document.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
This note has no actions for IANA.  This section should be removed by
the RFC editor before publication as an RFC.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="800-38D">[800-38D]</a></td>
<td class="author-text">Dworkin, M., &ldquo;<a href="http://csrc.nist.gov/publications/nistpubs/800-38D/SP800-38D.pdf">Special Publication 800-38D: Recommendation for
                 Block Cipher Modes of Operation: Galois/Counter Mode
                 (GCM) and GMAC.</a>,&rdquo; U.S. National Institute of Standards and
              Technology (NIST) Special Publication (SP)&nbsp;800-38D.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4106">[RFC4106]</a></td>
<td class="author-text">Viega, J. and D. McGrew, &ldquo;<a href="http://tools.ietf.org/html/rfc4106">The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4106, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4106.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4543">[RFC4543]</a></td>
<td class="author-text">McGrew, D. and J. Viega, &ldquo;<a href="http://tools.ietf.org/html/rfc4543">The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH</a>,&rdquo; RFC&nbsp;4543, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4543.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="800-107">[800-107]</a></td>
<td class="author-text">&ldquo;Special Publication 800-107: Recommendation for
	     Applications Using Approved Hash Algorithms,&rdquo; U.S. National Institute of
         Standards and Technology (NIST) Special Publication (SP)&nbsp;800-107, 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="AES-NI">[AES-NI]</a></td>
<td class="author-text">Kounavis, M., &ldquo;AES-NI: New Technology for Improving Encryption
          Efficiency and Enhancing Data Security in the Enterprise Cloud,&rdquo; Intel Developer Forum&nbsp;https://intel.wingateweb.com/us09/scheduler/sessions.do?searchGroup=9&searchGroupID=10133&profileItem_id=10004, 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="DAI">[DAI]</a></td>
<td class="author-text">Dai, W., &ldquo;<a href="http://www.cryptopp.com/benchmarks.html">Crypto++ 5.6.0 Benchmarks</a>,&rdquo; Web Page&nbsp;Speed Comparison of Popular Crypto Algorithms, 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS-180-2">[FIPS-180-2]</a></td>
<td class="author-text">&ldquo;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">Announcing the SECURE HASH STANDARD</a>,&rdquo; Federal Information Processing Standards (FIPS)&nbsp;180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="KS09">[KS09]</a></td>
<td class="author-text">Kasper, E. and P. Schwabe, &ldquo;<a href="http://www.cryptojedi.org/papers/aesbs-20090616.pdf">Faster and Timing-Attack Resistant AES-GCM</a>,&rdquo; Cryptographic Hardware and Embedded Systems -- CHES 2009&nbsp;Spinger-Verlag Lecture Notes in Computer Science 5745, 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="MODES">[MODES]</a></td>
<td class="author-text">&ldquo;<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/comments.html">Public Comments on the Draft GCM Specification, and
	     Comments on The Choice Between CWC or GCM</a>,&rdquo; NIST Computer Security Division&nbsp;Modes of Operation Comments, 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="MV04">[MV04]</a></td>
<td class="author-text">McGrew, D. and J. Viega, &ldquo;<a href="http://eprint.iacr.org/2004/193">The Security and Performance of the Galois/Counter
          Mode (GCM)</a>,&rdquo; Proceedings of INDOCRYPT '04,&nbsp;, December&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="OL">[OL]</a></td>
<td class="author-text">R. Dietz, Editor, &ldquo;<a href="http://www.vpnc.org/ietf-ipsec/02.ipsec/msg01840.html">No Need for SHA-2</a>,&rdquo; Open Letter to IPsec WG and Area Directors&nbsp;(email), 2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3686">[RFC3686]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3686">Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;3686, January&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4303">[RFC4303]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4835">[RFC4835]</a></td>
<td class="author-text">Manral, V., &ldquo;<a href="http://tools.ietf.org/html/rfc4835">Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)</a>,&rdquo; RFC&nbsp;4835, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4835.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4868">[RFC4868]</a></td>
<td class="author-text">Kelly, S. and S. Frankel, &ldquo;<a href="http://tools.ietf.org/html/rfc4868">Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec</a>,&rdquo; RFC&nbsp;4868, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4868.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4869">[RFC4869]</a></td>
<td class="author-text">Law, L. and J. Solinas, &ldquo;<a href="http://tools.ietf.org/html/rfc4869">Suite B Cryptographic Suites for IPsec</a>,&rdquo; RFC&nbsp;4869, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4869.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5282">[RFC5282]</a></td>
<td class="author-text">Black, D. and D. McGrew, &ldquo;<a href="http://tools.ietf.org/html/rfc5282">Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;5282, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5282.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David A. McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">510 McCarthy Blvd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milpitas, CA  95035</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(408) 525 8651</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.mindspring.com/~dmcgrew/dam.htm">http://www.mindspring.com/~dmcgrew/dam.htm</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ken Grewal</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Intel Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2111 NE 25th Avenue, JF3-232</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hillsboro, OR  97124</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ken.grewal@intel.com">ken.grewal@intel.com</a></td></tr>
</table>
</body></html>
