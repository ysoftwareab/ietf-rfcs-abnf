<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>An LDAP Schema for Kerberos KDC Information</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="An LDAP Schema for Kerberos KDC Information">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">H. Chu</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Symas Corp.</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">October 16, 2009</td></tr>
<tr><td class="header">Expires: April 19, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />An LDAP Schema for Kerberos KDC Information<br />draft-chu-ldap-kdc-schema-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 19, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document describes an <a class='info' href='#RFC4511'>LDAP<span> (</span><span class='info'>Sermersheim, J., &ldquo;Lightweight Directory Access Protocol (LDAP): The Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a> [RFC4511] schema for implementing the
	<a class='info' href='#RFC4120'>Kerberos 5<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> [RFC4120]
	<a class='info' href='#I-D.ietf-krb-wg-kdc-model'>KDC Information Model<span> (</span><span class='info'>Johansson, L., &ldquo;An information model for Kerberos version 5,&rdquo; July&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;krb&#8209;wg&#8209;kdc&#8209;model].
	It also defines additional elements which are not covered by the Information Model,
	but are already in common use.

</p>
<a name="background"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Background and Motivation</h3>

<p>Both Kerberos and LDAP are frequently used separately for
	distributed authentication. They can also be used in combination,
	but typically their user databases remained separate. This distinction
	in databases causes unnecessary duplication of data and administration
	overhead. As such it is desirable for both systems to share a single
	database. Since the LDAP data model is more general it is most
	appropriate to store the Kerberos data in LDAP.
</p>
<p>A number of Kerberos implementations already have support for
	using LDAP as their KDC backing store. However, each implementation
	uses its own schema, and the multiple schemas are mutually
	incompatible. For the sake of interoperability and administrative
	ease, it is important to define a single standard schema that can
	be used uniformly by all Kerberos KDC implementations and interoperates
	with existing LDAP specifications.
</p>
<a name="general"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
General Issues</h3>

<a name="genera.terms"></a><br /><hr />
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Terminology</h3>

<p>The key words "MUST", "SHOULD", and "MAY" used in this document
        are to be interpreted as described in
        <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>The OIDs defined below are derived from

	TBD.OID:<br />

	KRBSYN = TBD.OID.0<br />

	KRBATTR = TBD.OID.1<br />

	KRBOC = TBD.OID.2<br />

	
</p>
<a name="anchor1"></a><br /><hr />
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Schema</h3>

<p>The attributes and classes defined in this document are summarized
        below.
</p>
<a name="general.attrs"></a><br /><hr />
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Attributes</h3>

<p>The following attributes are defined in this document:
          </p>
<blockquote class="text">
<p>
		krbPrincipalName<br />

		krbPrincipalAliases<br />

		krbTicketMaxLife<br />

		krbTicketMaxRenewal<br />

		krbEncSaltTypes<br />

		krbRealmName<br />

		krbPrincipalRealm<br />

		krbKeySet<br />

		krbKeyVersion<br />

		krbTicketPolicy<br />

		krbExtraData<br />

		krbPrincNamingAttr<br />

		krbPrincContainer<br />

		krbPwdPolicy<br />

		krbLDAPURI<br />

            
</p>
</blockquote><p>
          Additionally, some of the attributes defined in 
          <a class='info' href='#I-D.behera-ldap-password-policy'>LDAP Password Policy<span> (</span><span class='info'>Sermersheim, J., Poitou, L., and H. Chu, &ldquo;Password Policy for LDAP Directories,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.behera&#8209;ldap&#8209;password&#8209;policy] are required.
        
</p>
<p>Note: The MIT/Novell schema includes a number of elements for storing the KDC configuration
	in LDAP. The Information Model doesn't cover these aspects, so I've omitted them for now.
	Do we need to add them?
</p>
<a name="general.classes"></a><br /><hr />
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Object Classes</h3>

<p>The following object classes are defined in this document:
          </p>
<blockquote class="text">
<p>
		krbKDCInfo<br />

		krbPrincipal<br />

		krbRealm<br />

            
</p>
</blockquote><p>
        
</p>
<a name="attrdefs"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Attribute Definitions</h3>

<p>This section contains attribute definitions to be implemented 
      by KDCs supporting this schema:
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.1
                NAME 'krbPrincipalName'
		DESC 'Canonical principal name'
                EQUALITY caseExactIA5Match
                SUBSTR caseExactSubstringsMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.26
		SINGLE-VALUE )
</pre></div><p>

      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.2
                NAME 'krbPrincipalAliases'
		SUP krbPrincipalName )
</pre></div><p>

	These attributes implement section 6.1.1.1 of the Information Model. The
	krbPrincipalName attribute contains the canonical name of the principal.
	Any aliases are stored in the krbPrincipalAliases attribute. Since the
	krbPrincipalAliases attribute is a subtype of the krbPrincipalName
	attribute, a search on krbPrincipalName will also search the aliases.
	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.3
                NAME 'krbTicketMaxLife'
                EQUALITY integerMatch
		ORDERING integerOrderingMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
		SINGLE-VALUE )
</pre></div><p>

	This attribute implements section 6.1.1.11 of the Information Model.
	It holds the maximum ticket lifetime in seconds for a principal.
	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.4
                NAME 'krbTicketMaxRenewal'
                EQUALITY integerMatch
		ORDERING integerOrderingMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
		SINGLE-VALUE )
</pre></div><p>

	This attribute implements section 6.1.1.12 of the Information Model.
	It holds the maximum time in seconds a ticket may be renewed for.
	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.5
                NAME 'krbEncSaltTypes'
                EQUALITY caseIgnoreMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )
</pre></div><p>

	This attribute implements section 6.1.1.13 of the Information Model.
	Holds the allowed encryption/salt type combinations for this principal.
	If empty or absent any combination supported by the implementation is allowed.
	<br />

	Note that sections 6.1.1.2 thru 6.1.1.10 are implemented using the
	LDAP Password Policy schema.
	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.6
                NAME 'krbRealmName'
                EQUALITY octetStringMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.40 )
</pre></div><p>

      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.7
                NAME 'krbPrincipalRealm'
		DESC 'DN of krbRealm entry'
		SUP distinguishedName )
</pre></div><p>

	These attributes provide information about the current realm. They provide
	the minimal set of information required to implement section 6.1.3 of the
	Information Model.
	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.8
                NAME 'krbKeyVersion'
                EQUALITY integerMatch
		ORDERING integerOrderingMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
		SINGLE-VALUE )
</pre></div><p>

	This attribute implements section 6.2.1.1 of the Information Model.
	It stores the version number of the current key.
	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.9
                NAME 'krbKeySet'
                EQUALITY octetStringMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.40 )
</pre></div><p>

	This attribute implements sections 6.3.1.1 thru 6.3.1.4 of the Information Model.
	Sections 6.3.1.5 thru 6.3.1.7 are implemented using the LDAP Password Policy schema.
	This attribute holds the principal's keys optionally encrypted with the
	Master Key. The attribute is encoded using <a class='info' href='#X.680'>ASN.1<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Abstract Syntax Notation One (ASN.1): Specification of basic notation,&rdquo; July&nbsp;2002.</span><span>)</span></a> [X.680]
	<a class='info' href='#X.690'>DER<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - ASN.1 encoding rules: Specification of Basic               Encoding Rules (BER),  Canonical Encoding Rules (CER) and               Distinguished Encoding Rules (DER),&rdquo; July&nbsp;2002.</span><span>)</span></a> [X.690].
	</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
##### The format of the value for this attribute is explained below,
##### KrbKeySet ::= SEQUENCE {
##### kvno                      [0] UInt32,
##### mkvno                     [1] UInt32 OPTIONAL,
##### keys                      [2] SEQUENCE OF KrbKey,
##### ...
##### }
#####
##### KrbKey ::= SEQUENCE {
##### salt      [0] KrbSalt OPTIONAL,
##### key       [1] EncryptionKey,
##### s2kparams [2] OCTET STRING OPTIONAL,
##### ...
##### }
#####
##### KrbSalt ::= SEQUENCE {
##### type      [0] Int32,
##### salt      [1] OCTET STRING OPTIONAL
##### }
#####
##### EncryptionKey ::= SEQUENCE {
##### keytype   [0] Int32,
##### keyvalue  [1] OCTET STRING
##### }
</pre></div><p>

</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.10
                NAME 'krbTicketPolicy'
                EQUALITY integerMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
		SINGLE-VALUE )
</pre></div><p>

	This attribute is related to section 6.4 of the Information Model. It
	defines the flags that a user is allowed or required to use in a ticket
	request.
	</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
#krb5KDCFlagsSyntax SYNTAX ::= {
#   WITH SYNTAX            INTEGER
#--        initial(0),             -- require as-req
#--        forwardable(1),         -- may issue forwardable
#--        proxiable(2),           -- may issue proxiable
#--        renewable(3),           -- may issue renewable
#--        postdate(4),            -- may issue postdatable
#--        server(5),              -- may be server
#--        client(6),              -- may be client
#--        invalid(7),             -- entry is invalid
#--        require-preauth(8),     -- must use preauth
#--        change-pw(9),           -- change password service
#--        require-hwauth(10),     -- must use hwauth
#--        ok-as-delegate(11),     -- as in TicketFlags
#--        user-to-user(12),       -- may use user-to-user auth
#--        immutable(13)           -- may not be deleted
#   ID                     { 1.3.6.1.4.1.5322.10.0.1 }
#}
</pre></div><p>

	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.11
                NAME 'krbExtraData'
                EQUALITY octetStringMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.40 )
</pre></div><p>

	This attribute holds arbitrary data that may be needed by a particular
	implementation. The values are encoded in ASN.1 DER.
	</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
##### The format of the values for this attribute is explained below,
##### ExtraData ::= SEQUENCE {
##### tag       [0] OCTET STRING,
##### data      [1] OCTET STRING
##### }
</pre></div><p>

	
</p>
<p>
	The following four attributes are outside the scope of the Information Model
	but may be useful in some deployments.
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.12
                NAME 'krbPrincNamingAttr'
                EQUALITY objectIdentifierMatch
                SYNTAX 1.3.6.1.4.1.1466.115.121.1.38
		SINGLE-VALUE )
</pre></div><p>

	This attribute records what attribute will be used to name
	newly created principal entries.
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.13
                NAME 'krbPrincContainer'
		DESC 'DN of container entry for principals'
		SUP distinguishedName
		SINGLE-VALUE )
</pre></div><p>

	This attribute points to the container entry under which
	new principal entries will be created.
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.14
                NAME 'krbPwdPolicy'
		DESC 'DN of password policy subentry'
		SUP distinguishedName
		SINGLE-VALUE )
</pre></div><p>

	This attribute points to the LDAP password policy subentry
	containing the policy that should be applied to Kerberos principals.

	Note that in LDAP servers with full subentry support, the subentry's
	subtree search specification defines what entries the subentry applies
	to, so this attribute is unnecessary; it is provided merely for
	informational purposes.
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBATTR.15
                NAME 'krbLDAPURI'
		DESC 'LDAP search parameters for locating principals'
		SUP labeledURI )
</pre></div><p>

	This attribute contains LDAP URIs that the KDC will search when
	locating principals. The URI values must conform to the syntax
	defined in <a class='info' href='#RFC4516'>[RFC4516]<span> (</span><span class='info'>Smith, M. and T. Howes, &ldquo;Lightweight Directory Access Protocol (LDAP): Uniform Resource Locator,&rdquo; June&nbsp;2006.</span><span>)</span></a>. As a special case, the URI
	prefix "ldap:///" is taken to mean the current LDAP server.
	
</p>
<a name="classdefs"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Class Definitions</h3>

<p>This section contains class definitions to be implemented by KDCs
      supporting the schema.
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBOC.1 NAME 'krbKDCInfo' SUP top AUXILIARY
      MAY ( krbTicketMaxLife $ krbTicketMaxRenewal $
	krbEncSaltTypes $ krbTicketPolicy $
	krbKeySet $ krbKeyVersion ) )
</pre></div><p>

      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBOC.2 NAME 'krbPrincipal' SUP krbKDCInfo AUXILIARY
      MUST ( krbPrincipalName )
      MAY ( krbPrincipalAliases $ krbPrincipalRealm $
	krbExtraData ) )
</pre></div><p>

	
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ( KRBOC.3 NAME 'krbRealm' SUP krbKDCInfo AUXILIARY
      MUST ( krbRealmName )
      MAY ( krbPrincNamingAttr $ krbPrincContainer $
	krbPwdPolicy $ krbLDAPURI ) )
</pre></div><p>

	Note that in a krbRealm object the krbKeySet and krbKeyVersion
	attributes actually reflect the Master key for the realm. In this
	case the krbKeySet's mkvno field and all other optional fields
	are omitted.
      
</p>
<a name="impl"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
Implementation Details</h3>

<p>Since the LDAP Password Policy is intimately involved in the
	security mechanisms of this proposal, the directory should be treated
	as more than just a passive data store. (The KDC can certainly read
	the policy attributes and evaluate them itself, but that would mean
	needlessly duplicating all of the functionality that is already
	implemented in the directory server.) This means that for every
	Kerberos authentication being serviced, a corresponding LDAP
	operation must also be performed, in order to allow the password
	policy mechanisms to operate.
</p>
<p>The mechanism outlined here assumes that the plain LDAP credentials
	and the Kerberos credentials are unified (or at least synchronized). In
	that case, for every incoming Kerberos authentication request, the KDC
	can issue an LDAP Compare request using the known credentials of
	the user and the LDAP Password Policy control. The result of the request
	will carry any relevant error codes if the account is disabled, the
	password is expired, or various other failures. If preauthentication is
	in use and the request is invalid, a Compare with known invalid
	credentials may be used to update the password policy state.
</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Model Details</h3>

<p>A number of data elements described in the Information Model are
	delegated to the LDAP DSA for management. Details of their
	usage are described here.
</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
principalNotUsedBefore</h3>

<p>Section 6.1.1.2 of the Information Model. This corresponds to the
	pwdStartTime attribute. If the KDC is using LDAP requests to operate the
	Password Policy mechanism then it does not need to reference or manipulate
	this attribute directly.
</p>
<a name="anchor4"></a><br /><hr />
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
principalNotUsedAfter</h3>

<p>Section 6.1.1.3 of the Information Model. This corresponds to the
	pwdEndTime attribute. If the KDC is using LDAP requests to operate the
	Password Policy mechanism then it does not need to reference or manipulate
	this attribute directly.
</p>
<a name="anchor5"></a><br /><hr />
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
principalIsDisabled</h3>

<p>Section 6.1.1.4 of the Information Model.
	If the KDC is using LDAP requests to operate the
	Password Policy mechanism then it does not need to reference or manipulate
	this attribute directly. Otherwise, this effect is controlled by setting
	the pwdStartTime attribute to a value greater than or equal to the
	pwdEndTime attribute.
</p>
<a name="anchor6"></a><br /><hr />
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
principalNumberOfFailedAuthenticationAttempts</h3>

<p>Section 6.1.1.5 of the Information Model.
	If the KDC is using LDAP requests to operate the
	Password Policy mechanism then it does not need to reference or manipulate
	this attribute directly. Otherwise, this value is obtained by counting the
	number of values stored in the pwdFailureTime attribute.
</p>
<a name="anchor7"></a><br /><hr />
<a name="rfc.section.5.1.5"></a><h3>5.1.5.&nbsp;
principalLastFailedAuthentication</h3>

<p>Section 6.1.1.6 of the Information Model.
	If the KDC is using LDAP requests to operate the
	Password Policy mechanism then it does not need to reference or manipulate
	this attribute directly. Otherwise, this value is obtained by retrieving the
	values stored in the pwdFailureTime attribute and selecting the most recent value.
</p>
<a name="anchor8"></a><br /><hr />
<a name="rfc.section.5.1.6"></a><h3>5.1.6.&nbsp;
principalLastSuccessfulAuthentication</h3>

<p>Section 6.1.1.7 of the Information Model. This corresponds to the
	pwdLastSuccess attribute.
	If the KDC is using LDAP requests to operate the
	Password Policy mechanism then it does not need to reference or manipulate
	this attribute directly.
</p>
<a name="anchor9"></a><br /><hr />
<a name="rfc.section.5.1.7"></a><h3>5.1.7.&nbsp;
principalLastCredentialChangeTime</h3>

<p>Section 6.1.1.8 of the Information Model. This corresponds to the
	pwdChangedTime attribute.
	If the KDC uses the LDAP <a class='info' href='#RFC3062'>Password Modify<span> (</span><span class='info'>Zeilenga, K., &ldquo;LDAP Password Modify Extended Operation,&rdquo; February&nbsp;2001.</span><span>)</span></a> [RFC3062] request
	then it does not need to reference or manipulate
	this attribute directly.
</p>
<a name="anchor10"></a><br /><hr />
<a name="rfc.section.5.1.8"></a><h3>5.1.8.&nbsp;
principalCreateTime</h3>

<p>Section 6.1.1.9 of the Information Model. This corresponds to the
	createTimestamp attribute.
	The KDC does not need to reference or manipulate this attribute directly.
</p>
<a name="anchor11"></a><br /><hr />
<a name="rfc.section.5.1.9"></a><h3>5.1.9.&nbsp;
principalModifyTime</h3>

<p>Section 6.1.1.10 of the Information Model. This corresponds to the
	modifyTimestamp attribute.
	The KDC does not need to reference or manipulate this attribute directly.
</p>
<a name="anchor12"></a><br /><hr />
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
KeySet details</h3>

<p>The krbKeySet attribute is multi-valued but it is expected that
	it will usually only contain one value. During a password change operation
	the KDC may choose to keep one previous value present to allow currently
	active clients to continue to operate using the previous key. How long to
	retain this old password is unspecified here. Note also that the LDAP
	Password Policy mechanism already has provisions for password history
	management, so the krbKeySet attribute should not be used for
	long-term password history tracking.
</p>
<a name="security"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>This entire document is concerned with an implementation of a secure
	distributed authentication mechanism. It should be understood that
	the various keys used here are all sensitive pieces of data and must
	be adequately protected using access controls and other mechanisms.
	Likewise all communications between the KDC and DSA must be protected
	whenever sensitive data is being referenced.
</p>
<p>In common practice the KDC and DSA have been colocated on a
	single host and communicated over a local
	 <a class='info' href='#I-D.chu-ldap-ldapi'>LDAP IPC<span> (</span><span class='info'>Chu, H., &ldquo;Using LDAP Over IPC Mechanisms,&rdquo; March&nbsp;2007.</span><span>)</span></a> [I&#8209;D.chu&#8209;ldap&#8209;ldapi] session. As such it was
	implied that the host security was equivalent for both. If a KDC is
	configured to use a remote DSA, the remote host should be
	configured with at least the same level of security as the KDC host,
	and a secure channel MUST be used for the LDAP session.
</p>
<p>Storing the Master Key in the DSA makes it even more
	crucial that the LDAP host, service, and data files be adequately
	protected. Backups of the LDAP database should also be encrypted to
	protect the integrity of any keys contained therein.
</p>
<a name="anchor13"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>In accordance with <a class='info' href='#RFC4520'>[RFC4520]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Internet Assigned Numbers Authority (IANA) Considerations for the Lightweight Directory Access Protocol (LDAP),&rdquo; June&nbsp;2006.</span><span>)</span></a> the following registrations
	are requested.
</p>
<a name="anchor14"></a><br /><hr />
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Object Identifiers</h3>

<p>[[List of OIDs, registration template goes here...]]
</p>
<a name="anchor15"></a><br /><hr />
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
LDAP Descriptors</h3>

<p>[[List of Attribute and ObjectClass descriptors, template goes here...]]
</p>
<a name="acks"></a><br /><hr />
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>Thanks to Simo Sorce from Red Hat Inc. and Love H&ouml;rnquist &Aring;strand
	from Apple Corp. for their feedback on this document.
</p>
<a name="rfc.references"></a><br /><hr />
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3062">[RFC3062]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc3062">LDAP Password Modify Extended Operation</a>,&rdquo; RFC&nbsp;3062, February&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3062.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4511">[RFC4511]</a></td>
<td class="author-text">Sermersheim, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4511">Lightweight Directory Access Protocol (LDAP): The Protocol</a>,&rdquo; RFC&nbsp;4511, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4511.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4516">[RFC4516]</a></td>
<td class="author-text">Smith, M. and T. Howes, &ldquo;<a href="http://tools.ietf.org/html/rfc4516">Lightweight Directory Access Protocol (LDAP): Uniform Resource Locator</a>,&rdquo; RFC&nbsp;4516, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4516.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4520">[RFC4520]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4520">Internet Assigned Numbers Authority (IANA) Considerations for the Lightweight Directory Access Protocol (LDAP)</a>,&rdquo; BCP&nbsp;64, RFC&nbsp;4520, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4520.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.behera-ldap-password-policy">[I-D.behera-ldap-password-policy]</a></td>
<td class="author-text">Sermersheim, J., Poitou, L., and H. Chu, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-behera-ldap-password-policy-10.txt">Password Policy for LDAP Directories</a>,&rdquo; draft-behera-ldap-password-policy-10 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-behera-ldap-password-policy-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-krb-wg-kdc-model">[I-D.ietf-krb-wg-kdc-model]</a></td>
<td class="author-text">Johansson, L., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-krb-wg-kdc-model-05.txt">An information model for Kerberos version 5</a>,&rdquo; draft-ietf-krb-wg-kdc-model-05 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-krb-wg-kdc-model-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.680">[X.680]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;Abstract Syntax Notation One (ASN.1): Specification of basic notation,&rdquo; ITU-T Recommendation&nbsp;X.680, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.690">[X.690]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;Information Technology - ASN.1 encoding rules: Specification of Basic
              Encoding Rules (BER),  Canonical Encoding Rules (CER) and
              Distinguished Encoding Rules (DER),&rdquo; ITU-T Recommendation&nbsp;X.690, July&nbsp;2002.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.chu-ldap-ldapi">[I-D.chu-ldap-ldapi]</a></td>
<td class="author-text">Chu, H., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-chu-ldap-ldapi-00.txt">Using LDAP Over IPC Mechanisms</a>,&rdquo; draft-chu-ldap-ldapi-00 (work in progress), March&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-chu-ldap-ldapi-00.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Howard Chu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Symas Corp.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">18740 Oxnard Street, Suite 313A</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tarzana, California  91356</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 818 757-7087</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hyc@symas.com">hyc@symas.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.symas.com">http://www.symas.com</a></td></tr>
</table>
</body></html>
