



SPRING Working Group                                             F. Yang
Internet-Draft                                                   T. Zhou
Intended status: Standards Track                                 Y. Wang
Expires: January 13, 2022                            Huawei Technologies
                                                           July 12, 2021


                    ACH6 for OAM in Segment Routing
                    draft-yang-spring-ach6-oam-sr-00

Abstract

   This document defines an OAM toolset encapsulated in ACH6 to provide
   the functions of performance measurement, continuity check and
   verification to an SRv6 path.

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 13, 2022.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents



Yang, et al.            Expires January 13, 2022                [Page 1]

Internet-Draft             ACH6 for OAM in SR                  July 2021


   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  ACH6 OAM for SRv6 . . . . . . . . . . . . . . . . . . . . . .   3
     3.1.  ACH6 OAM Message  . . . . . . . . . . . . . . . . . . . .   3
     3.2.  ACH6 On-Demand Echo Request/Reply . . . . . . . . . . . .   3
     3.3.  ACH6 Proactive Continuity Check . . . . . . . . . . . . .   5
     3.4.  ACH6 Performance Measurement  . . . . . . . . . . . . . .   7
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   9
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   9
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   9
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   9
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   ACH6 [I-D.yang-spring-ach6-sr] provides a method of supporting an OAM
   toolset with a unified TLV format in Segment Routing over IPv6
   network.  There are several advantages:

   o  An Associated Channel ID in ACH6 provides a unified identifier to
      OAM sessions for a specific SRv6 path.

   o  In Segment Routing networks, ACH6 TLV is proposed to be
      encapsulated in IPv6 Destination Options Header.  Together with
      IPv6 Segment Routing Header, OAM functions like continuity check
      and performance management can be monitored either hop-by-hop on
      every SR endpoint or end-to-end from the first endpoint to the
      last.

   o  By leveraging native semantics of IPv6 extension headers, ACH6 OAM
      messages target to be processed in fast path to improve OAM
      accuracy and efficiency.

   o  By leveraging native semantics of IPv6 extension headers, ACH6 OAM
      can help network nodes reduce OAM configurations and session
      management.



Yang, et al.            Expires January 13, 2022                [Page 2]

Internet-Draft             ACH6 for OAM in SR                  July 2021


   In this method, ACH6 OAM categorizes OAM functionalities into three
   types of messages, including On-demand Echo Request/Reply, Proactive
   Continuity Check and Performance Measurement.

2.  Terminology

   This document uses the following terms:

   OAM: Operations, Administration, and Maintenance

   ACH6: Associated CHannel over IPv6

3.  ACH6 OAM for SRv6

3.1.  ACH6 OAM Message

   Figure 1 defines the format of ACH6 OAM message.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |       Channel Type = TBA      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                      Associated Channel ID                    ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               ~
     ~                   OAM Message Body (Variable)                 ~
     ~                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     Figure 1 ACH6 OAM Message Format

   ACH6 Channel Type indicates which type of OAM message is encapsulated
   in the following OAM message body, and OAM message body contains the
   OAM messages.  Three types of OAM messages are defined:

   o  TBA 1 = On-demand Echo Request/Reply

   o  TBA 2 = Proactive Continuity Check

   o  TBA 3 = Performance Measurement

3.2.  ACH6 On-Demand Echo Request/Reply

   On-demand Echo Request/Reply provides a method of on-demand
   continuity check and connectivity verification.  Figure 2 defines
   ACH6 OAM format of On-demand Echo Request/Reply message.




Yang, et al.            Expires January 13, 2022                [Page 3]

Internet-Draft             ACH6 for OAM in SR                  July 2021


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |      Channel Type = TBA1      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                     Associated Channel ID                     ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Echo Req/Rep  |   Reply Mode  |  Return Code  |   Reserved    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                       Sequence Number                         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                      sub-TLVs (optional)                      ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

          Figure 2 ACH6 OAM On Demand Echo Request/Reply Message

   Associated Channel ID: indicates the identifier of OAM session.

   Message Type:

   o  1 = Echo Request

   o  2 = Echo Reply

   Reply Mode:

   o  1 = Do not reply

   o  2 = Reply via an IPv6 UDP packet

   o  3 = Reply via an IPv6 packet without payload

   o  4 = Reply via application-level control channel

   Return code:

   o  0 = No return code

   o  1 = Malformed echo request received

   o  2 = One or more of the TLVs was not understood

   o  3 = Packet-rorward-success

   o  4 = No route to destination

   o  5 = Communication with destination administratively prohibited




Yang, et al.            Expires January 13, 2022                [Page 4]

Internet-Draft             ACH6 for OAM in SR                  July 2021


   o  6 = Beyond scope of source address

   o  7 = Address unreachable

   o  8 = Port unreachable

   o  9 = Source address failed ingress/egress policy

   o  10 = Reject route to destination

   o  11 = Exceeding the minimum IPv6 MTU

   o  12 = Hop limit exceeded in transit

   o  13 = Fragment reassembly time exceeded

   o  14 = Erroneous header field encountered

   o  15 = Unrecognized Next Header type encountered

   o  16 = Unrecognized IPv6 option encountered

   Sequence number: is allocated by the sender of echo request to detect
   whether the reply packet is lost.

3.3.  ACH6 Proactive Continuity Check

   Proactive Continuity Check provides a method of proactive continuity
   check to continuously detect the path status and fault.  Figure 3
   defines ACH6 OAM format of Proactive Continuity Check message.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |       Channel Type = TBA2     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                  Associated Channel ID                        ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Diag  |Sta|  Flag |      Reserved           |  Detect Multi |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                   Desired Min TX Interval                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Required Min TX Interval                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Required Min Echo RX Interval                  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                      Figure 3 ACH6 OAM ProCC Message



Yang, et al.            Expires January 13, 2022                [Page 5]

Internet-Draft             ACH6 for OAM in SR                  July 2021


   Associated Channel ID: indicates the identifier of OAM session.

   Diag:

   o  0 = no diagnostic

   o  1 = control detection time expired

   o  2 = echo function failed

   o  3 = neighbor signaled session down

   o  4 = forwarding plane reset

   o  5 = path down

   o  6 = concatenated path down

   o  7 = administratively down

   o  8 = reverse concatenated path down

   o  9-31 = reserved for future use

   State:

   o  0 = adminDown

   o  1 = down

   o  2 = Init

   o  3 = up

   Flag:

   o  P flag: if set, the transmitting node is requesting verification
      of connectivity, or of a parameter change, and is expecting a
      packet with the F bit in reply.  If clear, the transmitting node
      is not requesting verification.

   o  F flag: if set, the transmitting node is responding to a received
      Proactive Continuity Check packet that had the P bit set.  If
      clear, the transmitting node is not responding to a requesting
      packet that had the P bit set.

   o  D flag: if set, Demand mode is active in the transmitting node.
      The node wishes to operate in Demand mode and direct the remote



Yang, et al.            Expires January 13, 2022                [Page 6]

Internet-Draft             ACH6 for OAM in SR                  July 2021


      node to cease the periodic transmission of Proactive Continuity
      Check packets.  If clear, Demand mode is not active in the
      transmitting node.

   o  M flag: this bit is reserved for future point-to-multipoint
      extensions to ACH6 Proactive Continuity Check.  It MUST be zero on
      both transmit and receipt.

   Detect Mult: detection time multiplier.

   Desired Min TX Interval: this is the minimum interval, in
   microseconds, that the local system would like to use when
   transmitting ACH6 Proactive Continuity Check packets.

   Required Min RX Interval: this is the minimum interval, in
   microseconds, between received ACH6 Proactive Continuity Check
   packets that this system is capable of supporting, less any jitter
   applied by the sender.

   Required Min Echo RX Interval: this is the minimum interval, in
   microseconds, between received Echo packets that this system is
   capable of supporting, less any jitter applied by the sender.

3.4.  ACH6 Performance Measurement

   Performance Measurement provides a method of measuring packet loss
   and delay.  Figure 4 defines ACH6 OAM format of Performance
   Measurement message.























Yang, et al.            Expires January 13, 2022                [Page 7]

Internet-Draft             ACH6 for OAM in SR                  July 2021


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |       Channel Type = TBA3     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                   Associated Channel ID                       ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Sender Sequence Number                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Reflector Sequence Number                    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                         TimeStamp1                            ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                         TimeStamp2                            ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                         TimeStamp3                            ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                         TimeStamp4                            ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                    Padding (MBZ, variable)                    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

             Figure 4 ACH6 OAM Performance Measurement Message

   Associated Channel ID: indicates the identifier of OAM session.

   Sender Sequence Number: the counter of performance measurement test
   packets sent from sender

   Reflector Sequence Number: the counter of performace measurement test
   packets set by reflector

   Timestamp 1-4: When a query is sent from A, timestamp 1 is set to T1,
   timestamp 2-4 fields are set to 0.  When the query is received at B,
   timestamp 2 is set to T2.  In this case, B copies timestamp 1 to
   timestamp 3, copies timestamp 2 to timestamp 4, and initializes
   timestamp 1 and timestamp 2 to 0.  When B sends a response, timestamp
   1 is set to T3.  When a response is received at A, timestamp 2 is set
   to T4.

4.  IANA Considerations

   o  This document requests IANA to assign a codepoint of On-demand
      Echo Request/Reply of ACH6 Channel Types.

   o  This document requests IANA to assign a codepoint of Proactive
      Continuity Check of ACH6 Channel Types.




Yang, et al.            Expires January 13, 2022                [Page 8]

Internet-Draft             ACH6 for OAM in SR                  July 2021


   o  This document requests IANA to assign a codepoint of Performance
      Measurement of ACH6 Channel Types.

5.  Security Considerations

   TBD

6.  Acknowledgements

   TBD

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

7.2.  Informative References

   [I-D.yang-spring-ach6-sr]
              Yang, F. and T. Zhou, "ACH6 in Segment Routing", draft-
              yang-spring-ach6-sr-00 (work in progress), July 2021.

Authors' Addresses

   Fan Yang
   Huawei Technologies
   Beijing
   China

   Email: shirley.yangfan@huawei.com


   Tianran Zhou
   Huawei Technologies
   Beijing
   China

   Email: zhoutianran@huawei.com





Yang, et al.            Expires January 13, 2022                [Page 9]

Internet-Draft             ACH6 for OAM in SR                  July 2021


   Yali Wang
   Huawei Technologies
   Beijing
   China

   Email: wangyali11@huawei.com













































Yang, et al.            Expires January 13, 2022               [Page 10]
