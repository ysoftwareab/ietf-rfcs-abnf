<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>LoST: A Location-to-Service Translation Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="LoST: A Location-to-Service Translation Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">ECRIT</td><td class="header">T. Hardie</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfcRFC 5222'>RFC 5222</a>, <a href='http://tools.ietf.org/html/rfcRFC 5012'>RFC 5012</a></td><td class="header">A. Newton</td></tr>
<tr><td class="header">(if&nbsp;approved)</td><td class="header">American Registry for Internet</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Numbers</td></tr>
<tr><td class="header">Expires: April 22, 2010</td><td class="header">H. Schulzrinne</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Columbia University</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 19, 2009</td></tr>
</table></td></tr></table>
<h1><br />LoST: A Location-to-Service Translation Protocol<br />draft-tschofenig-ecrit-rfc5222bis-00</h1>

<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 22, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document describes an XML-based protocol for mapping service identifiers and geodetic
        or civic location information to service contact URIs. In particular, it can be used to
        determine the location-appropriate Public Safety Answering Point (PSAP) for emergency
        services.
</p>
<p>This document is a revision of the original LoST specification, descrbed in RFC 5222.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology and Requirements Notation<br />
<a href="#usage">3.</a>&nbsp;
Overview of Protocol Usage<br />
<a href="#lost">4.</a>&nbsp;
LoST Servers and Their Resolution<br />
<a href="#mapping">5.</a>&nbsp;
The &lt;mapping> Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#source">5.1.</a>&nbsp;
The Mapping Data Source: 'source',
'sourceId', and 'lastUpdated' Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#expires">5.2.</a>&nbsp;
Mapping Validity:  The 'expires'
Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#displayName-element">5.3.</a>&nbsp;
Describing the Service with
the &lt;displayName> Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#service-response">5.4.</a>&nbsp;
The Mapped Service: The
&lt;service> Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#serviceBoundary">5.5.</a>&nbsp;
Defining the Service Region
with the &lt;serviceBoundary> Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#serviceBoundaryReference">5.6.</a>&nbsp;
Service Boundaries by
Reference: The &lt;serviceBoundaryReference> Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#serviceNumber">5.7.</a>&nbsp;
The Service Number: The
&lt;serviceNumber> Element <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uri-element">5.8.</a>&nbsp;
Service URLs: The &lt;uri> Element<br />
<a href="#path">6.</a>&nbsp;
Path of a Request: The &lt;path> Element<br />
<a href="#locationUsed">7.</a>&nbsp;
Identifying the Location Element
Used for Mapping: &lt;locationUsed><br />
<a href="#findService">8.</a>&nbsp;
Mapping a
Location and Service to URLs: &lt;findService><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">8.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">8.2.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#findService-geo-example">8.2.1.</a>&nbsp;
Example Using Geodetic
Coordinates<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#findService-civic-example">8.2.2.</a>&nbsp;
Civic Address Mapping
Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#findServiceQuery">8.3.</a>&nbsp;
Components of
the &lt;findService&gt; Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#location-element">8.3.1.</a>&nbsp;
The &lt;location> Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#service-element">8.3.2.</a>&nbsp;
Identifying the Service:  The
&lt;service> Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#recursive">8.3.3.</a>&nbsp;
Recursion and Iteration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#boundary">8.3.4.</a>&nbsp;
Service Boundary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#validateLocation">8.3.5.</a>&nbsp;
Requesting Civic Location Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#findServiceResponse">8.4.</a>&nbsp;
Components of the Mapping
Response &lt;findServiceResponse&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">8.4.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#validation">8.4.2.</a>&nbsp;
Civic Address Validation: The
&lt;locationValidation> Element<br />
<a href="#getServiceBoundary">9.</a>&nbsp;
Retrieving the Service
Boundary via &lt;getServiceBoundary><br />
<a href="#listServices">10.</a>&nbsp;
List Services: &lt;listServices><br />
<a href="#listServicesByLocation">11.</a>&nbsp;
List Services By Location: &lt;listServicesByLocation><br />
<a href="#location-profiles">12.</a>&nbsp;
Location Profiles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#location-profile-usage">12.1.</a>&nbsp;
Location Profile Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#geodetic-2d-profile">12.2.</a>&nbsp;
Two-Dimensional Geodetic Profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#basic-civic-profile">12.3.</a>&nbsp;
Basic Civic Profile<br />
<a href="#error-codes">13.</a>&nbsp;
Errors, Warnings, and Redirects<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#errors">13.1.</a>&nbsp;
Errors<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#warnings">13.2.</a>&nbsp;
Warnings<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#redirects">13.3.</a>&nbsp;
Redirects<br />
<a href="#transport">14.</a>&nbsp;
LoST Transport: HTTP<br />
<a href="#schema">15.</a>&nbsp;
Relax NG Schema<br />
<a href="#anchor6">16.</a>&nbsp;
Internationalization Considerations<br />
<a href="#iana">17.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#u-naptr">17.1.</a>&nbsp;
U-NAPTR Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">17.2.</a>&nbsp;
Content-Type Registration for 'application/lost+xml'<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">17.3.</a>&nbsp;
LoST Relax NG Schema Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">17.4.</a>&nbsp;
LoST Namespace Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#profile-registry">17.5.</a>&nbsp;
LoST Location Profile Registry<br />
<a href="#security">18.</a>&nbsp;
Security Considerations<br />
<a href="#anchor10">19.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">20.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">20.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">20.2.</a>&nbsp;
Informative References<br />
<a href="#anchor13">Appendix&nbsp;A.</a>&nbsp;
Changes from RFC 5222<br />
<a href="#schema-verbose">Appendix&nbsp;B.</a>&nbsp;
Non-Normative RELAX NG Schema in
XML Syntax<br />
<a href="#online-examples">Appendix&nbsp;C.</a>&nbsp;
Examples Online<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Protocols such as Naming Authority Pointer (NAPTR) records and the Service Location
        Protocol (SLP) can be used to discover servers offering a particular service. However, for
        an important class of services the appropriate specific service instance depends both on the
        identity of the service and the geographic location of the entity that needs to reach it.
        Emergency telecommunications services are an important example; here, the service instance
        is a Public Safety Answering Point (PSAP) that has jurisdiction over the location of the
        user making the call. The desired PSAP isn't necessarily the one that is topologically or
        even line-of-sight closest to the caller; rather, it is the one that serves the caller's
        location based on jurisdictional boundaries.
</p>
<p>This document describes a protocol for mapping a service identifier and location
        information compatible with the Presence Information Data Format Location Object <a class='info' href='#RFC4119'>(PIDF-LO)<span> (</span><span class='info'>Peterson, J., &ldquo;A Presence-based GEOPRIV Location Object Format,&rdquo; December&nbsp;2005.</span><span>)</span></a> [7] to one or more service URIs. Service identifiers take
        the form of the service URNs described in <a class='info' href='#RFC5031'>[10]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;A Uniform Resource Name (URN) for Emergency and Other Well-Known Services,&rdquo; January&nbsp;2008.</span><span>)</span></a>. Location information
        here includes revised civic location information <a class='info' href='#RFC5139'>[11]<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object             (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a> and a subset of
        the PIDF-LO profile <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[14]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; February&nbsp;2008.</span><span>)</span></a>, which consequently
        includes the Geo-Shapes <a class='info' href='#geo-shapes'>[13]<span> (</span><span class='info'>Reed, C. and M. Thomson, &ldquo;GML 3.1.1 PIDF-LO Shape Application Schema for use by the Internet Engineering Task             Force (IETF),&rdquo; December&nbsp;2006.</span><span>)</span></a> defined for GML <a class='info' href='#GML'>[12]<span> (</span><span class='info'>Cox, S., Daisey, P., Lake, R., Portele, C., and A. Whiteside, &ldquo;Geographic information - Geography Markup Language (GML),&rdquo; April&nbsp;2004.</span><span>)</span></a>.
        Example service URI schemes include sip <a class='info' href='#RFC3261'>[15]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>, xmpp <a class='info' href='#RFC3921'>[16]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence,&rdquo; October&nbsp;2004.</span><span>)</span></a>, and tel <a class='info' href='#RFC3966'>[17]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;The tel URI for Telephone Numbers,&rdquo; December&nbsp;2004.</span><span>)</span></a>. While the initial focus is on
        providing mapping functions for emergency services, it is likely that the protocol is
        applicable to other service URNs. For example, in the United States, the "2-1-1" and "3-1-1"
        service numbers follow a similar location-to-service behavior as emergency services.
</p>
<p>This document names this protocol "LoST", for Location-to-Service Translation. LoST
        satisfies the requirements <a class='info' href='#RFC5012'>[19]<span> (</span><span class='info'>Schulzrinne, H. and R. Marshall, &ldquo;Requirements for Emergency Context Resolution with Internet Technologies,&rdquo; January&nbsp;2008.</span><span>)</span></a> for mapping protocols. LoST provides a
        number of operations, centered around mapping locations and service URNs to service URLs and
        associated information. LoST mapping queries can contain either civic or geodetic location
        information. For civic addresses, LoST can indicate which parts of the civic address are
        known to be valid or invalid, thus providing address validation, as described in Section 3.5
        of <a class='info' href='#RFC5012'>[19]<span> (</span><span class='info'>Schulzrinne, H. and R. Marshall, &ldquo;Requirements for Emergency Context Resolution with Internet Technologies,&rdquo; January&nbsp;2008.</span><span>)</span></a>. LoST indicates errors in the location data to facilitate
        debugging and proper user feedback, but also provides best-effort answers.
</p>
<p>LoST queries can be resolved recursively or iteratively. To minimize round trips and to
        provide robustness against network failures, LoST supports caching of individual mappings
        and indicates the region for which the same answer would be returned ("service region").
</p>
<p>As defined in this document, LoST messages are carried in HTTP and HTTPS protocol
        exchanges, facilitating use of TLS for protecting the integrity and confidentiality of
        requests and responses.
</p>
<p>This document focuses on the description of the protocol between the mapping client and the
        mapping server. Other functions, such as discovery of mapping servers, data replication and
        the overall mapping server architecture are described in a separate document <a class='info' href='#I-D.ietf-ecrit-mapping-arch'>[20]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;Location-to-URL Mapping Architecture and Framework,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
</p>
<p>The query message carries location information and a service identifier encoded as a
        Uniform Resource Name (URN) (see <a class='info' href='#RFC5031'>[10]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;A Uniform Resource Name (URN) for Emergency and Other Well-Known Services,&rdquo; January&nbsp;2008.</span><span>)</span></a>) from the LoST client to the LoST
        server. The LoST server uses its database to map the input values to one or more Uniform
        Resource Identifiers (URIs) and returns those URIs along with optional information, such as
        a service boundary, in a response message to the LoST client. If the server cannot resolve
        the query itself, it may in turn query another server or return the address of another LoST
        server, identified by a LoST server name. In addition to the mapping function described in
          <a class='info' href='#findService'>Section&nbsp;8<span> (</span><span class='info'>Mapping a Location and Service to URLs: &lt;findService></span><span>)</span></a>, the protocol also allows to retrieve the service boundary
        (see <a class='info' href='#getServiceBoundary'>Section&nbsp;9<span> (</span><span class='info'>Retrieving the Service Boundary via &lt;getServiceBoundary></span><span>)</span></a>) and to list the services available for a
        particular location (see <a class='info' href='#listServicesByLocation'>Section&nbsp;11<span> (</span><span class='info'>List Services By Location: &lt;listServicesByLocation></span><span>)</span></a>) or supported by a
        particular server (see <a class='info' href='#listServices'>Section&nbsp;10<span> (</span><span class='info'>List Services: &lt;listServices></span><span>)</span></a>).
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology and Requirements Notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[1]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>This document uses the following terms: </p>
<blockquote class="text"><dl>
<dt>Mapping:</dt>
<dd> Mapping is a process that takes a location
            and a service identifier as inputs and returns one or more URIs. Those URIs can point
            either to a host providing that service or to a host that in turn routes the request to
            the final destination. This definition is a generalization of the term "mapping" as used
            in <a class='info' href='#RFC5012'>[19]<span> (</span><span class='info'>Schulzrinne, H. and R. Marshall, &ldquo;Requirements for Emergency Context Resolution with Internet Technologies,&rdquo; January&nbsp;2008.</span><span>)</span></a>, because LoST can be used for non-emergency services.
</dd>
<dt>Mapping Data:</dt>
<dd> Mapping data refers to a data
            structure that is defined in <a class='info' href='#mapping'>Section&nbsp;5<span> (</span><span class='info'>The &lt;mapping> Element</span><span>)</span></a>. 
</dd>
<dt>Service boundary:</dt>
<dd> A service boundary circumscribes
            the region within which all locations map to the same service URI or set of URIs for a
            given service. A service boundary may consist of several non-contiguous geometric
            shapes. Note that service boundary is an artifical construct when used in LoST as the
            described region may not necessarily need to reflect the real world boundary. This
            simplification is made to allow a person operating a LoST server to balance the tradeoff
            between the size of a precise service boundary description and the protocol performance
            gained by returning any form of service boundary.
</dd>
<dt>LoST client:</dt>
<dd> A host acts as a LoST client if it
            sends LoST query messages and receives LoST response messages.
</dd>
<dt>LoST server:</dt>
<dd> A host acts as a LoST server if it
            receives LoST query messages and sends LoST response messages. In recursive operation,
            the same entity may be both a client and a server.
</dd>
<dt>Authoritative LoST server:</dt>
<dd> An authoritative server
            acts only as a server and successfully resolves the input location and service
            identifier to a URI or set of URIs.
</dd>
<dt>Validation:</dt>
<dd> The term "validation" can be separated
            into two categories, namely 
<blockquote class="text"><dl>
<dt>Routing Valid:</dt>
<dd> Location information is
                considered valid if the civic or geographic location can be mapped to one or more
                PSAPs. 
</dd>
<dt>Dispatch Valid:</dt>
<dd> Location information is
                considered dispatch valid if a provided civic address exists in a given reference
                database. Note that the criteria for matching a given address with the reference
                database may not require the comparison of every civic address token in the provided
                address. 
</dd>
</dl></blockquote>
          
</dd>
</dl></blockquote><p>
      
</p>
<p>Additional emergency service terminology can be found in <a class='info' href='#RFC5012'>[19]<span> (</span><span class='info'>Schulzrinne, H. and R. Marshall, &ldquo;Requirements for Emergency Context Resolution with Internet Technologies,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Overview of Protocol Usage</h3>

<p>The LoST protocol supports the following types of queries and responses:
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>&lt;findService&gt; and
&lt;findServiceResponse&gt;</dt>
<dd>
             A LoST client retrieves contact URIs based on location
            information and a service identifier with this request and response. The same query type
            may also ask for location validation. The details can be found in <a class='info' href='#findService'>Section&nbsp;8<span> (</span><span class='info'>Mapping a Location and Service to URLs: &lt;findService></span><span>)</span></a>.
</dd>
<dt>&lt;getServiceBoundary&gt; and
&lt;getServiceBoundaryResponse&gt;</dt>
<dd>
             A LoST client obtains a service boundary with this request and
            response, as described in <a class='info' href='#getServiceBoundary'>Section&nbsp;9<span> (</span><span class='info'>Retrieving the Service Boundary via &lt;getServiceBoundary></span><span>)</span></a>. 
</dd>
<dt>&lt;listServices&gt; and
&lt;listServicesResponse&gt;</dt>
<dd>
             With this request and response, a LoST client can find out
            which services a LoST server supports, as described in <a class='info' href='#listServices'>Section&nbsp;10<span> (</span><span class='info'>List Services: &lt;listServices></span><span>)</span></a>. 
</dd>
<dt>&lt;listServicesByLocation&gt; and
&lt;listServicesByLocationResponse&gt;</dt>
<dd>
             A LoST client can determine with this request and response
            which services are available for a specific location region. <a class='info' href='#listServicesByLocation'>Section&nbsp;11<span> (</span><span class='info'>List Services By Location: &lt;listServicesByLocation></span><span>)</span></a> describes the details.
</dd>
</dl></blockquote><p>
      
</p>
<p>LoST clients may initiate any of the above queries at any time. Among the common triggers
        are: </p>
<ol class="text">
<li>when the client initially starts up or attaches to a network;
</li>
<li>when the client detects that its location has changed sufficiently that it is outside
            the bounds of the service region;
</li>
<li>when a SIP message arrives at a SIP proxy performing location-based call routing;
</li>
<li>when cached mapping information has expired; and
</li>
<li>when invoking a particular service. At that time, a client may omit requests for
            service boundaries or other auxiliary information.
</li>
</ol><p>
      
</p>
<p>A service-specific Best Current Practice (BCP) document, such as <a class='info' href='#I-D.ietf-ecrit-phonebcp'>[22]<span> (</span><span class='info'>Rosen, B. and J. Polk, &ldquo;Best Current Practice for Communications Services in support of Emergency Calling,&rdquo; February&nbsp;2008.</span><span>)</span></a>, governs whether a client is expected to invoke the
        mapping service just before needing the service or whether to rely on cached answers. Cache
        entries expire at their expiration time (see <a class='info' href='#expires'>Section&nbsp;5.2<span> (</span><span class='info'>Mapping Validity:  The 'expires' Attribute</span><span>)</span></a>), or they become
        invalid if the caller's device moves beyond the boundaries of the service region.
        Service-specific Best Current Practice documents may also provide guidance on the contact
        URI schemes most appropriate to the service. As a general set of guidelines, URI schemes
        that do not provide mechanisms for actually initiating a contact method should be avoided
        (examples include data, info, cid, and tag) as transforming those references into contact
        mechanisms requires a layer of indirection that makes the overall mechanism more fragile.
        Provisionally registered URI schemes should also be carefully considered before use, because
        they are subject to change in core semantics.
</p>
<a name="lost"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
LoST Servers and Their Resolution</h3>

<p>LoST servers are identified by U-NAPTR/DDDS (URI-Enabled NAPTR/Dynamic Delegation Discovery
        Service) <a class='info' href='#RFC4848'>[9]<span> (</span><span class='info'>Daigle, L., &ldquo;Domain-Based Application Service Location Using URIs and the Dynamic Delegation Discovery Service (DDDS),&rdquo; April&nbsp;2007.</span><span>)</span></a> application unique strings, in the form of a DNS name. An
        example is 'lostserver.example.com'.
</p>
<p>Clients need to use the U-NAPTR <a class='info' href='#RFC4848'>[9]<span> (</span><span class='info'>Daigle, L., &ldquo;Domain-Based Application Service Location Using URIs and the Dynamic Delegation Discovery Service (DDDS),&rdquo; April&nbsp;2007.</span><span>)</span></a> specification described below to
        obtain a URI (indicating host and protocol) for the applicable LoST service. In this
        document, only the HTTP and HTTPS URL schemes are defined. Note that the HTTP URL can be any
        valid HTTP URL, including those containing path elements.
</p>
<p>The following two DNS entries show the U-NAPTR resolution for "example.com" to the HTTPS
        URL https://lostserv.example.com/secure or the HTTP URL http://lostserver.example.com, with
        the former being preferred.
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    example.com.

    IN NAPTR 100  10   "u"    "LoST:https"
         "!.*!https://lostserver.example.com/secure!"  ""

    IN NAPTR 200  10   "u"    "LoST:http"
         "!.*!http://lostserver.example.com!"  ""
</pre></div><p>

      
</p>
<p>Clients learn the LoST server's host name by means beyond the scope of this specification,
        such as SIP configuration and DHCP <a class='info' href='#RFC5223'>[26]<span> (</span><span class='info'>Schulzrinne, H., Polk, J., and H. Tschofenig, &ldquo;Discovering Location-to-Service Translation (LoST) Servers Using the Dynamic Host             Configuration Protocol (DHCP),&rdquo; August&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="mapping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
The &lt;mapping> Element</h3>

<p>The &lt;mapping> element is the core data element in LoST, describing a service region
        and the associated service URLs. Its attributes and elements are described in subsections
        below. 
</p>
<a name="source"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
The Mapping Data Source: 'source',
'sourceId', and 'lastUpdated' Attributes</h3>

<p>The 'source', 'sourceId', and 'lastUpdated' attributes uniquely identify a particular
          mapping record. They are created by the authoritative source for a mapping and are never
          modified when a mapping is served from a cache. All three attributes are REQUIRED for all
          &lt;mapping> elements. A receiver can replace a mapping in it's cache with another one
          having the same 'source' and 'sourceId' and a more recent time in 'lastUpdated'.
</p>
<p>The 'source' attribute contains a LoST application unique string identifying the
          authoritative generator of the mapping (see <a class='info' href='#lost'>Section&nbsp;4<span> (</span><span class='info'>LoST Servers and Their Resolution</span><span>)</span></a>).
</p>
<p>The 'sourceId' attribute identifies a particular mapping and contains an opaque token
          that MUST be unique among all different mappings maintained by the authoritative source
          for that particular service. For example, a Universally Unique Identifier (UUID) is a
          suitable format.
</p>
<p>The 'lastUpdated' attribute describes when a specific instance of mapping, identified by
          the combination of 'source' and 'sourceId', was last changed. When any of the elements of
          the &lt;mapping> element is modified, for example by changing the &lt;uri> element
          or the service boundary, then this mapping has to be treated as a new instance and the
          value in the 'lastUpdated' attribute has to be re-computed. Another way to judge the need
          for a re-created mapping is when a digital signature covering that mapping would break
          because of a modification. The contents of the 'lastUpdated' attribute has the XML data
          type dateTime in its timezoned form, using the canonical UTC representation with the
          letter 'Z' as the timezone indicator.
</p>
<a name="expires"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Mapping Validity:  The 'expires'
Attribute</h3>

<p>The 'expires' attribute contains the absolute time at which the mapping becomes invalid.
          The contents of this attribute is a timezoned XML type dateTime, in canonical
          representation. The &lt;mapping> element MUST include the 'expires' attribute.
</p>
<p>Optionally, this attribute may contain the values of 'NO-CACHE' and 'NO-EXPIRATION'
          instead of a dateTime value. The value 'NO-CACHE' is an indication that the mapping should
          not be cached. The value of 'NO-EXPIRATION' is an indication that the mapping does not
          expire. Please note that the value of 'NO-EXPIRATION' has to be used with care and will
          typically only be used in a controlled environment where additional mechanisms can be used
          to update mappings that were initially thought to never change.
</p>
<p>On occasion, a server may be forced to return an expired mapping if it cannot reach the
          authoritative server or the server fails to return a usable answer. Clients and servers
          MAY cache the mapping so that they have at least some information available. Caching
          servers that have such stale information SHOULD re-attempt the query each time a client
          requests a mapping. Since the expired mapping will be returned to the client as a
          non-error/non-warning response, the client MUST check the 'expires' attribute; if the
          mapping has expired, local policy at the client determines whether it discards the answer
          and tries again later or uses the possibly stale response. 
</p>
<a name="displayName-element"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Describing the Service with
the &lt;displayName> Element</h3>

<p>Zero or more &lt;displayName&gt; elements describe the service with a string that
          is suitable for display to human users, each annotated with the 'xml:lang' attribute that
          contains a language tag to aid in the rendering of text.
</p>
<a name="service-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
The Mapped Service: The
&lt;service> Element</h3>

<p>The mandatory &lt;service&gt; element identifies the service for which this
          mapping applies. Two cases need to be distinguished when the LoST server sets the
          &lt;service&gt; element in the response message: </p>
<ol class="text">
<li>If the requested service, identified by the <a class='info' href='#RFC5031'>service URN<span> (</span><span class='info'>Schulzrinne, H., &ldquo;A Uniform Resource Name (URN) for Emergency and Other Well-Known Services,&rdquo; January&nbsp;2008.</span><span>)</span></a> [10]
              in the &lt;service> element of the request, exists for the location indicated,
              then the LoST server copies the service URN from the request into the
              &lt;service&gt; element.
</li>
<li>If, however, the requested service, identified by the <a class='info' href='#RFC5031'>service
                URN<span> (</span><span class='info'>Schulzrinne, H., &ldquo;A Uniform Resource Name (URN) for Emergency and Other Well-Known Services,&rdquo; January&nbsp;2008.</span><span>)</span></a> [10] in the &lt;service> element in the request, does not exist for the
              location indicated, the server either can return a <a class='info' href='#errors'>&lt;serviceNotImplemented&gt;<span> (</span><span class='info'>Errors</span><span>)</span></a> error or can provide an alternate
              service that approximates the desired service for that location. In the latter case,
              the server MUST include a &lt;service&gt; element with the alternative service
              URN. The choice of service URN is left to local policy, but the alternate service
              should be able to satisfy the original service request.
</li>
</ol>

<a name="serviceBoundary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Defining the Service Region
with the &lt;serviceBoundary> Element</h3>

<p> A response MAY indicate the region for which the service URL returned would be the same
          as in the actual query, the so-called service region. The service region can be indicated
          by value or by reference (see <a class='info' href='#serviceBoundaryReference'>Section&nbsp;5.6<span> (</span><span class='info'>Service Boundaries by Reference: The &lt;serviceBoundaryReference> Element</span><span>)</span></a>). If a client
          moves outside the service area and wishes to obtain current service data, it sends a new
          query with its current location. The service region is described by value in one or more
          &lt;serviceBoundary&gt; elements, each formatted according to a specific location
          profile, identified by the 'profile' attribute (see <a class='info' href='#location-profiles'>Section&nbsp;12<span> (</span><span class='info'>Location Profiles</span><span>)</span></a>).
          &lt;serviceBoundary&gt; elements formatted according to different location
          profiles are alternative representations of the same area, not additive to one another;
          this allows a client understanding only one of the profile types to be sure it has a
          complete view of the serviceBoundary. Within a serviceBoundary element there may, however,
          be multiple locations which are additive; this is necessary because some
          &lt;serviceBoundary&gt; areas could not be easily expressed with a single shape or
          civic location.  If included in a response, the
          &lt;serviceBoundary&gt; element MUST contain at least one service boundary that
          uses the same profile as the request. 
</p>
<p>A service boundary is requested by the client, using the 'serviceBoundary' attribute in
          the request with the value set to "value".
</p>
<a name="serviceBoundaryReference"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Service Boundaries by
Reference: The &lt;serviceBoundaryReference> Element</h3>

<p>Since geodetic service boundaries may contain thousands of points and can thus be quite
          large, clients may wish to conserve bandwidth by requesting a reference to the service
          boundary instead of the value described in <a class='info' href='#serviceBoundary'>Section&nbsp;5.5<span> (</span><span class='info'>Defining the Service Region with the &lt;serviceBoundary> Element</span><span>)</span></a>. The
          identifier of the service boundary is returned as an attribute of the
          &lt;serviceBoundaryReference> element, along with a LoST application unique string
          (see <a class='info' href='#lost'>Section&nbsp;4<span> (</span><span class='info'>LoST Servers and Their Resolution</span><span>)</span></a>) identifying the server from where it can be retrieved. The
          actual value of the service boundary is then retrieved with the <a class='info' href='#getServiceBoundary'>getServiceBoundary<span> (</span><span class='info'>Retrieving the Service Boundary via &lt;getServiceBoundary></span><span>)</span></a> request.
</p>
<p>A reference to a service boundary is requested by the client using the 'serviceBoundary'
          attribute in the request with the value set to "reference". A LoST server may decide,
          based on local policy, to return the service boundary by value or to omit the
          &lt;serviceBoundaryReference> element in the response.
</p>
<p>The identifier is a random token with at least 128 bits of entropy and can be assumed to
          be globally unique. It uniquely references a particular boundary. If the boundary changes,
          a new identifier MUST be chosen. Because of these properties, a client receiving a mapping
          response can simply check if it already has a copy of the boundary with that identifier.
          If so, it can skip checking with the server whether the boundary has been updated. Since
          service boundaries are likely to remain unchanged for extended periods of time, possibly
          exceeding the normal lifetime of the service URL, this approach avoids unnecessarily
          refreshing the boundary information just because the remainder of the mapping has become
          invalid.
</p>
<a name="serviceNumber"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
The Service Number: The
&lt;serviceNumber> Element </h3>

<p>The service number is returned in the optional &lt;serviceNumber> element. It
          contains a string of digits, * and # that a user on a device with a 12-key dial pad could
          use to reach that particular service.
</p>
<a name="uri-element"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.8"></a><h3>5.8.&nbsp;
Service URLs: The &lt;uri> Element</h3>

<p>The response returns the service URLs in one or more &lt;uri&gt; elements. The
          URLs MUST be absolute URLs. The ordering of the URLs has no particular significance. Each
          URL scheme MUST only appear at most once, but it is permissible to include both secured
          and regular versions of a protocol, such as both 'http' and 'https' or 'sip' and 'sips'.
</p>
<a name="path"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Path of a Request: The &lt;path> Element</h3>

<p>To prevent loops and to allow tracing of request and response paths, all requests that
        allow recursion include a &lt;path> element that contains one or more &lt;via>
        elements, each possessing an attribute containing a LoST application unique string (see
          <a class='info' href='#lost'>Section&nbsp;4<span> (</span><span class='info'>LoST Servers and Their Resolution</span><span>)</span></a>). The order of &lt;via> elements corresponds to the order of
        LoST servers, i.e., the first &lt;via> element identifies the server that initially
        received the request from the client issuing the request. Every server in a recursive query
        operation is included in the &lt;path> element, including the first server to receive
        it. 
</p>
<p>The server that answers the request instead of forwarding it, such as the authoritative
        server, copies the &lt;path> element verbatim into the response. The &lt;path>
        element is not modified in responses as the responses traverses the server chain back to the
        querying client.
</p>
<p>If a query is answered iteratively, the querier includes all servers that it has already
        contacted.
</p>
<p>When a cached mapping is returned, then the &lt;path> element cached together with the
        mapping is returned.
</p>
<p>The example in <a class='info' href='#findServiceResponse-civic.xml'>Figure&nbsp;4<span> (</span><span class='info'>A &lt;findServiceResponse&gt; civic address answer</span><span>)</span></a> indicates that the answer was
        given to the client by the LoST server at esgw.ueber-110.de.example, which got the answer
        from the (authoritative) LoST server at polizei.muenchen.de.example.
</p>
<a name="locationUsed"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Identifying the Location Element
Used for Mapping: &lt;locationUsed></h3>

<p>Several of the requests can provide one or more &lt;location> elements, among which the
        server gets to choose. It is useful for the client to be able to determine which one was
        actually used in producing the result. For that purpose, the &lt;location> tag MUST
        contain an 'id' attribute that uniquely identifies the &lt;location> element. The format
        of the identifier is left to the client; it could, for example, use a hash of the location
        information. The server returns the identifier for the &lt;location> element it used in
        the &lt;locationUsed> tag.
</p>
<a name="findService"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Mapping a
Location and Service to URLs: &lt;findService></h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Overview</h3>

<p>The &lt;findService> query constitutes the core of the LoST functionality, mapping
          civic or geodetic locations to URLs and associated data. After giving an example, we
          enumerate the elements of the query and response.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Examples</h3>

<a name="findService-geo-example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2.1"></a><h3>8.2.1.&nbsp;
Example Using Geodetic
Coordinates</h3>

<p>The following is an example of mapping a service to a location using geodetic
            coordinates, for the service associated with the police (urn:service:sos.police).
</p><br /><hr class="insert" />
<a name="findService-geo.xml"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findService
  xmlns="urn:ietf:params:xml:ns:lost1"
  xmlns:p2="http://www.opengis.net/gml"
  serviceBoundary="value"
  recursive="true"&gt;

  &lt;location id="6020688f1ce1896d" profile="geodetic-2d"&gt;
    &lt;p2:Point id="point1" srsName="urn:ogc:def:crs:EPSG::4326"&gt;
       &lt;p2:pos&gt;37.775 -122.422&lt;/p2:pos&gt;
    &lt;/p2:Point&gt;
  &lt;/location&gt;
  &lt;service&gt;urn:service:sos.police&lt;/service&gt;

&lt;/findService&gt;
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: A &lt;findService&gt; geodetic query&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Given the query above, a server would respond with a service, and information related
            to that service. In the example below, the server has mapped the location given by the
            client for a police service to the New York City Police Department, instructing the
            client that it may contact them via the URIs <tt>sip:nypd@example.com</tt> and <tt>xmpp:nypd@example.com</tt>. The
            server has also given the client a geodetic, two-dimensional boundary for this service.
            The mapping was last updated on November 1, 2006 and expires on January 1, 2007. If the
            client's location changes beyond the given service boundary or the expiration time has
            been reached, it may want to requery for this information, depending on the usage
            environment of LoST.
</p><br /><hr class="insert" />
<a name="findServiceResponse-geo.xml"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findServiceResponse xmlns="urn:ietf:params:xml:ns:lost1"
  xmlns:p2="http://www.opengis.net/gml"&gt;
  &lt;mapping
    expires="2007-01-01T01:44:33Z"
    lastUpdated="2006-11-01T01:00:00Z"
    source="authoritative.example"
    sourceId="7e3f40b098c711dbb6060800200c9a66"&gt;
    &lt;displayName xml:lang="en"&gt;
      New York City Police Department
    &lt;/displayName&gt;
    &lt;service&gt;urn:service:sos.police&lt;/service&gt;
    &lt;serviceBoundary profile="geodetic-2d"&gt;
      &lt;p2:Polygon srsName="urn:ogc:def::crs:EPSG::4326"&gt;
        &lt;p2:exterior&gt;
          &lt;p2:LinearRing&gt;
            &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.555 -122.4194&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.555 -122.4264&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.775 -122.4264&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
          &lt;/p2:LinearRing&gt;
        &lt;/p2:exterior&gt;
      &lt;/p2:Polygon&gt;
    &lt;/serviceBoundary&gt;
    &lt;uri&gt;sip:nypd@example.com&lt;/uri&gt;
    &lt;uri&gt;xmpp:nypd@example.com&lt;/uri&gt;
    &lt;serviceNumber&gt;911&lt;/serviceNumber&gt;
  &lt;/mapping&gt;
  &lt;path&gt;
    &lt;via source="resolver.example"/&gt;
    &lt;via source="authoritative.example"/&gt;
  &lt;/path&gt;
  &lt;locationUsed id="6020688f1ce1896d"/&gt;
&lt;/findServiceResponse&gt;
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: A &lt;findServiceResponse&gt; geodetic answer&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="findService-civic-example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2.2"></a><h3>8.2.2.&nbsp;
Civic Address Mapping
Example</h3>

<p>The example below shows how to map a service to a location much like the example in
              <a class='info' href='#findService-geo-example'>Section&nbsp;8.2.1<span> (</span><span class='info'>Example Using Geodetic Coordinates</span><span>)</span></a>, but using civic address location
            information. In this example, the client requests the service associated with police
            (urn:service:sos.police) along with a specific civic address (house number 6 on a street
            named Otto-Hahn-Ring in Munich, Germany).
</p><br /><hr class="insert" />
<a name="findService-civic.xml"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findService xmlns="urn:ietf:params:xml:ns:lost1"
  recursive="true" serviceBoundary="value"&gt;
  &lt;location id="627b8bf819d0bad4d" profile="civic"&gt;
    &lt;civicAddress
      xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
      &lt;country&gt;DE&lt;/country&gt;
      &lt;A1&gt;Bavaria&lt;/A1&gt;
      &lt;A3&gt;Munich&lt;/A3&gt;
      &lt;A6&gt;Otto-Hahn-Ring&lt;/A6&gt;
      &lt;HNO&gt;6&lt;/HNO&gt;
      &lt;PC&gt;81675&lt;/PC&gt;
    &lt;/civicAddress&gt;
  &lt;/location&gt;
  &lt;service&gt;urn:service:sos.police&lt;/service&gt;
&lt;/findService&gt;
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: A &lt;findService&gt; civic address query&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Given the query above, a server would respond with a service, and information related
            to that service. In the example below, the server has mapped the location given by the
            client for a police service to the Muenchen Polizei-Abteilung, instructing the client
            that it may contact them via the URIs sip:munich-police@example.com and
            xmpp:munich-police@example.com. The server has also given the client a civic address
            boundary (the city of Munich) for this service. The mapping was last updated on November
            1, 2006 by the authoritative source <tt>polizei.muenchen.de.example</tt> and expires on January 1, 2007. This instructs the
            client to requery for the information if its location changes beyond the given service
            boundary (i.e., beyond the indicated district of Munich) or after January 1, 2007.
</p><br /><hr class="insert" />
<a name="findServiceResponse-civic.xml"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 &lt;?xml version="1.0" encoding="UTF-8"?&gt;
 &lt;findServiceResponse xmlns="urn:ietf:params:xml:ns:lost1"&gt;
   &lt;mapping
     expires="2007-01-01T01:44:33Z"
     lastUpdated="2006-11-01T01:00:00Z"
     source="esgw.ueber-110.de.example"
     sourceId="e8b05a41d8d1415b80f2cdbb96ccf109"&gt;
     &lt;displayName xml:lang="de"&gt;
       Muenchen Polizei-Abteilung
     &lt;/displayName&gt;
     &lt;service&gt;urn:service:sos.police&lt;/service&gt;
     &lt;serviceBoundary
       profile="civic"&gt;
       &lt;civicAddress
         xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
         &lt;country&gt;DE&lt;/country&gt;
         &lt;A1&gt;Bavaria&lt;/A1&gt;
         &lt;A3&gt;Munich&lt;/A3&gt;
         &lt;PC&gt;81675&lt;/PC&gt;
       &lt;/civicAddress&gt;
     &lt;/serviceBoundary&gt;
     &lt;uri&gt;sip:munich-police@example.com&lt;/uri&gt;
     &lt;uri&gt;xmpp:munich-police@example.com&lt;/uri&gt;
     &lt;serviceNumber&gt;110&lt;/serviceNumber&gt;
   &lt;/mapping&gt;
   &lt;path&gt;
     &lt;via source="esgw.ueber-110.de.example"/&gt;
     &lt;via source="polizei.muenchen.de.example"/&gt;
   &lt;/path&gt;
   &lt;locationUsed id="627b8bf819d0bad4d"/&gt;
 &lt;/findServiceResponse&gt;
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: A &lt;findServiceResponse&gt; civic address answer&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="findServiceQuery"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Components of
the &lt;findService&gt; Request</h3>

<p>The &lt;findService> request includes attributes and elements that govern whether the
          request is handled iteratively or recursively, whether location validation is performed,
          and which elements may be contained in the response.
</p>
<a name="location-element"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3.1"></a><h3>8.3.1.&nbsp;
The &lt;location> Element</h3>

<p>The &lt;findService&gt; query communicates location information using one or
            more &lt;location&gt; elements, which MUST conform to a location profile (see
              <a class='info' href='#location-profiles'>Section&nbsp;12<span> (</span><span class='info'>Location Profiles</span><span>)</span></a>). There MUST NOT be more than one location element
            for each distinct location profile. The order of location elements is significant; the
            server uses the first location element where it understands the location profile.
</p>
<a name="service-element"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3.2"></a><h3>8.3.2.&nbsp;
Identifying the Service:  The
&lt;service> Element</h3>

<p>The type of service desired is specified by the &lt;service&gt; element. It
            contains service URNs from the registry established in <a class='info' href='#RFC5031'>[10]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;A Uniform Resource Name (URN) for Emergency and Other Well-Known Services,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="recursive"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3.3"></a><h3>8.3.3.&nbsp;
Recursion and Iteration</h3>

<p>LoST can operate in either recursive or iterative mode, on a request-by-request basis.
            In recursive mode, the LoST server initiates queries on behalf of the requester and
            returns the result to the requester.
</p>
<p>In iterative mode, the server contacted returns a redirection response indicating the
            next server to be queried if the server contacted cannot provide an answer itself.
</p>
<p>For the queries defined in this document, only the LoST &lt;findService> and
            &lt;listServicesByLocation> queries can be recursive, as indicated by the
            'recursive' attribute. A value of "true" indicates a recursive query, with the default
            being "false" when the attribute is omitted. Regardless of the attribute, a server MAY
            always answer a query by providing a LoST application unique string (see <a class='info' href='#lost'>Section&nbsp;4<span> (</span><span class='info'>LoST Servers and Their Resolution</span><span>)</span></a>), i.e., indirection; however, it MUST NOT recurse if the attribute is
            "false".
</p>
<a name="boundary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3.4"></a><h3>8.3.4.&nbsp;
Service Boundary</h3>

<p>LoST &lt;mapping> elements can describe the service boundary either by value or by
            reference. Returning a service boundary reference is generally more space-efficient for
            geospatial (polygon) boundaries and if the boundaries change rarely, but does incur an
            additional &lt;getServiceBoundary> request. The querier can express a preference for
            one or the other modality with the 'serviceBoundary' attribute in the
            &lt;findService> request, but the server makes the final decision as to whether to
            return a reference or a value.
            
          
</p>
<a name="validateLocation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3.5"></a><h3>8.3.5.&nbsp;
Requesting Civic Location Validation</h3>

<p>Civic address validation is requested by setting the optional attribute
            'validateLocation' to true. If the attribute is omitted, it is assumed to be false. The
            response is described in <a class='info' href='#validation'>Section&nbsp;8.4.2<span> (</span><span class='info'>Civic Address Validation: The &lt;locationValidation> Element</span><span>)</span></a>. The example in <a class='info' href='#findService-civic-validation.xml'>Figure&nbsp;5<span> (</span><span class='info'>A &lt;findService> query with address validation request</span><span>)</span></a> demonstrates address validation. If the
            server chooses a geodetic location among the locations provided in a request, the
            attribute is ignored.
</p>
<p>
            <br /><hr class="insert" />
<a name="findService-civic-validation.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findService
  xmlns="urn:ietf:params:xml:ns:lost1"
  recursive="true"
  validateLocation="true"
  serviceBoundary="value"&gt;
  &lt;location id="627b8bf819d0bad4d" profile="civic"&gt;
    &lt;civicAddress
      xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
      &lt;country&gt;DE&lt;/country&gt;
      &lt;A1&gt;Bavaria&lt;/A1&gt;
      &lt;A3&gt;Munich&lt;/A3&gt;
      &lt;A6&gt;Otto-Hahn-Ring&lt;/A6&gt;
      &lt;HNO&gt;6&lt;/HNO&gt;
      &lt;PC&gt;81675&lt;/PC&gt;
    &lt;/civicAddress&gt;
  &lt;/location&gt;
  &lt;service&gt;urn:service:sos.police&lt;/service&gt;
&lt;/findService&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: A &lt;findService> query with address validation request&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

          
</p>
<p>
            <br /><hr class="insert" />
<a name="findServiceResponse-civic-validation.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findServiceResponse xmlns="urn:ietf:params:xml:ns:lost1"&gt;
  &lt;mapping
    expires="2007-01-01T01:44:33Z"
    lastUpdated="2006-11-01T01:00:00Z"
    source="authoritative.example"
    sourceId="4db898df52b84edfa9b6445ea8a0328e"&gt;
    &lt;displayName xml:lang="de"&gt;
      Muenchen Polizei-Abteilung
    &lt;/displayName&gt;
    &lt;service&gt;urn:service:sos.police&lt;/service&gt;
    &lt;serviceBoundary profile="civic"&gt;
      &lt;civicAddress
        xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
        &lt;country&gt;DE&lt;/country&gt;
        &lt;A1&gt;Bavaria&lt;/A1&gt;
        &lt;A3&gt;Munich&lt;/A3&gt;
        &lt;PC&gt;81675&lt;/PC&gt;
      &lt;/civicAddress&gt;
    &lt;/serviceBoundary&gt;
    &lt;uri&gt;sip:munich-police@example.com&lt;/uri&gt;
    &lt;uri&gt;xmpp:munich-police@example.com&lt;/uri&gt;
    &lt;serviceNumber&gt;110&lt;/serviceNumber&gt;
  &lt;/mapping&gt;
  &lt;locationValidation&gt;
    &lt;valid&gt;country A1 A3 A6&lt;/valid&gt;
    &lt;invalid&gt;PC&lt;/invalid&gt;
    &lt;unchecked&gt;HNO&lt;/unchecked&gt;
  &lt;/locationValidation&gt;
  &lt;path&gt;
    &lt;via source="resolver.example"/&gt;
    &lt;via source="authoritative.example"/&gt;
  &lt;/path&gt;
  &lt;locationUsed id="627b8bf819d0bad4d"/&gt;
&lt;/findServiceResponse&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: A &lt;findServiceResponse> message with address validation information&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

          
</p>
<a name="findServiceResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Components of the Mapping
Response &lt;findServiceResponse&gt;</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.1"></a><h3>8.4.1.&nbsp;
Overview</h3>

<p>Mapping responses consist of the &lt;mapping> element (<a class='info' href='#mapping'>Section&nbsp;5<span> (</span><span class='info'>The &lt;mapping> Element</span><span>)</span></a>)
            describing the mapping itself, possibly followed by <a class='info' href='#warnings'>warnings<span> (</span><span class='info'>Warnings</span><span>)</span></a>, <a class='info' href='#validation'>location validation information<span> (</span><span class='info'>Civic Address Validation: The &lt;locationValidation> Element</span><span>)</span></a>, and
            an indication of the <a class='info' href='#path'>path<span> (</span><span class='info'>Path of a Request: The &lt;path> Element</span><span>)</span></a> the response has taken.
</p>
<a name="validation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.2"></a><h3>8.4.2.&nbsp;
Civic Address Validation: The
&lt;locationValidation> Element</h3>

<p>A server can indicate in its response which civic address elements it has recognized as
            valid, which ones it has ignored, and which ones it has checked and found to be invalid.
            The server SHOULD include this information if the 'validateLocation' attribute in the
            request was true, but local policy at the server may allow this information to be
            omitted. Each element contains a list of tokens separated by whitespace, enumerating the
            civic location labels used in child elements of the &lt;civicAddress> element. The
            &lt;valid> element enumerates those civic address elements that have been recognized
            as valid by the LoST server and that have been used to determine the mapping. The
            &lt;unchecked> elements enumerates the civic address elements that the server did
            not check and that were not used in determining the response. The &lt;invalid>
            element enumerate civic address elements that the server attempted to check, but that
            did not match the other civic address elements found in the &lt;valid> list. Civic
            location tokens that are not listed in either the &lt;valid>, &lt;invalid>, or
            &lt;unchecked> element belong to the class of unchecked tokens.
</p>
<p>Note that the same address can yield different responses if parts of the civic address
            contradict each other. For example, if the postal code does not match the city, local
            server policy determines whether the postal code or the city is considered valid. The
            mapping naturally corresponds to the valid elements.
</p>
<p>The example shown in <a class='info' href='#findService-civic-validation.xml'>Figure&nbsp;5<span> (</span><span class='info'>A &lt;findService> query with address validation request</span><span>)</span></a> and in <a class='info' href='#findServiceResponse-civic-validation.xml'>Figure&nbsp;6<span> (</span><span class='info'>A &lt;findServiceResponse> message with address validation information</span><span>)</span></a> indicates that the tokens
            'country', 'A1', 'A3', and 'A6' have been validated by the LoST server. The server
            considered the postal code 81675 in the &lt;PC> element as not valid for this
            location. The 'HNO' token belongs to the class of unchecked location tokens.
</p>
<a name="getServiceBoundary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Retrieving the Service
Boundary via &lt;getServiceBoundary></h3>

<p>As discussed in <a class='info' href='#serviceBoundary'>Section&nbsp;5.5<span> (</span><span class='info'>Defining the Service Region with the &lt;serviceBoundary> Element</span><span>)</span></a>,
         the
        &lt;findServiceResponse&gt; can return a globally unique identifier in the
        'serviceBoundary' attribute that can be used to retrieve the service boundary, rather than
        returning the boundary by value. This is shown in the example in <a class='info' href='#findService-geo-serviceBoundaryReference'>Figure&nbsp;7<span> (</span><span class='info'>&lt;findService> request and response with service boundary reference</span><span>)</span></a> and <a class='info' href='#findServiceResponse-geo-reference'>Figure&nbsp;8<span> (</span><span class='info'>&lt;findServiceResponse> message with service boundary reference</span><span>)</span></a>. The client can then retrieve the boundary
        using the &lt;getServiceBoundary> request and obtains the boundary in the
        &lt;getServiceBoundaryResponse>, illustrated in the example in <a class='info' href='#getServiceBoundary.xml'>Figure&nbsp;9<span> (</span><span class='info'>Requesting a service boundary with &lt;getServiceBoundary></span><span>)</span></a> and <a class='info' href='#getServiceBoundaryResponse-civic.xml'>Figure&nbsp;10<span> (</span><span class='info'>Geodetic service boundary response</span><span>)</span></a>. The client issues the request to the server identified in the 'server' attribute of the
        &lt;serviceBoundaryReference> element. These requests are always directed to the
        authoritative server and do not recurse.
</p>
<p>
        <br /><hr class="insert" />
<a name="findService-geo-serviceBoundaryReference"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findService
  xmlns="urn:ietf:params:xml:ns:lost1"
  xmlns:p2="http://www.opengis.net/gml"
  recursive="true"
  serviceBoundary="reference"&gt;
  &lt;location id="6020688f1ce1896d" profile="geodetic-2d"&gt;
    &lt;p2:Point id="point1" srsName="urn:ogc:def:crs:EPSG::4326"&gt;
       &lt;p2:pos&gt;37.775 -122.422&lt;/p2:pos&gt;
    &lt;/p2:Point&gt;
  &lt;/location&gt;
  &lt;service&gt;urn:service:sos.police&lt;/service&gt;
&lt;/findService&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: &lt;findService> request and response with service boundary reference&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>
        <br /><hr class="insert" />
<a name="findServiceResponse-geo-reference"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findServiceResponse xmlns="urn:ietf:params:xml:ns:lost1"
  xmlns:p2="http://www.opengis.net/gml"&gt;
  &lt;mapping
    expires="2007-01-01T01:44:33Z"
    lastUpdated="2006-11-01T01:00:00Z"
    source="authoritative.example"
    sourceId="7e3f40b098c711dbb6060800200c9a66"&gt;
    &lt;displayName xml:lang="en"&gt;
      New York City Police Department
    &lt;/displayName&gt;
    &lt;service&gt;urn:service:sos.police&lt;/service&gt;
    &lt;serviceBoundaryReference
      source="authoritative.example"
      key="7214148E0433AFE2FA2D48003D31172E"/&gt;
    &lt;uri&gt;sip:nypd@example.com&lt;/uri&gt;
    &lt;uri&gt;xmpp:nypd@example.com&lt;/uri&gt;
    &lt;serviceNumber&gt;911&lt;/serviceNumber&gt;
  &lt;/mapping&gt;
  &lt;path&gt;
    &lt;via source="resolver.example"/&gt;
    &lt;via source="authoritative.example"/&gt;
  &lt;/path&gt;
  &lt;locationUsed id="6020688f1ce1896d"/&gt;
&lt;/findServiceResponse&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: &lt;findServiceResponse> message with service boundary reference&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>
        <br /><hr class="insert" />
<a name="getServiceBoundary.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;getServiceBoundary xmlns="urn:ietf:params:xml:ns:lost1"
    key="7214148E0433AFE2FA2D48003D31172E"/&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: Requesting a service boundary with &lt;getServiceBoundary>&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p><br /><hr class="insert" />
<a name="getServiceBoundaryResponse-civic.xml"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 &lt;?xml version="1.0" encoding="UTF-8"?&gt;
 &lt;getServiceBoundaryResponse
   xmlns="urn:ietf:params:xml:ns:lost1"&gt;
     &lt;serviceBoundary profile="geodetic-2d"&gt;
       &lt;p2:Polygon srsName="urn:ogc:def::crs:EPSG::4326"&gt;
         &lt;p2:exterior&gt;
           &lt;p2:LinearRing&gt;
             &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.555 -122.4194&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.555 -122.4264&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.775 -122.4264&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
           &lt;/p2:LinearRing&gt;
         &lt;/p2:exterior&gt;
       &lt;/p2:Polygon&gt;
     &lt;/serviceBoundary&gt;
   &lt;path&gt;
     &lt;via source="resolver.example"/&gt;
     &lt;via source="authoritative.example"/&gt;
   &lt;/path&gt;
 &lt;/getServiceBoundaryResponse&gt;
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: Geodetic service boundary response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="listServices"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
List Services: &lt;listServices></h3>

<p>A LoST client can ask a LoST server for the list of services that it understands, primarily
        for diagnostic purposes. The query does not contain location information, as it simply
        provides an indication of which services the server can look up, not whether a particular
        service is offered for a particular area. Typically, only top-level services are included in
        the answer, implying support for all sub-services. Since the query is answered by the
        queried server, there is no notion of recursion or indirection. The <a class='info' href='#listServicesByLocation'>&lt;listServicesByLocation><span> (</span><span class='info'>List Services By Location: &lt;listServicesByLocation></span><span>)</span></a> query below can be
        used to find out whether a particular service is offered for a specific location. An example
        request and response are shown in <a class='info' href='#listServices.xml'>Figure&nbsp;11<span> (</span><span class='info'>Example of &lt;ListServices> query</span><span>)</span></a>.
</p>
<p>
        <br /><hr class="insert" />
<a name="listServices.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;listServices
  xmlns="urn:ietf:params:xml:ns:lost1"&gt;
  &lt;service&gt;urn:service:sos&lt;/service&gt;
&lt;/listServices&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;11: Example of &lt;ListServices> query&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>
        <br /><hr class="insert" />
<a name="listServicesResponse.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;listServicesResponse
 xmlns="urn:ietf:params:xml:ns:lost1"&gt;
 &lt;serviceList&gt;
  urn:service:sos.ambulance
  urn:service:sos.animal-control
  urn:service:sos.fire
  urn:service:sos.gas
  urn:service:sos.mountain
  urn:service:sos.marine
  urn:service:sos.physician
  urn:service:sos.poison
  urn:service:sos.police
 &lt;/serviceList&gt;
 &lt;path&gt;
  &lt;via source="authoritative.example"/&gt;
 &lt;/path&gt;
&lt;/listServicesResponse&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;12: Example of &lt;ListServicesResponse>&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<a name="listServicesByLocation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
List Services By Location: &lt;listServicesByLocation></h3>

<p>A LoST client can ask a LoST server for the list of services it knows about for a
        particular area. The &lt;listServicesByLocation> query contains one or more
        &lt;location&gt; elements, each from a different <a class='info' href='#location-profiles'>location profile<span> (</span><span class='info'>Location Profiles</span><span>)</span></a>, and may contain the &lt;service&gt; element. As for
        &lt;findService>, the server selects the first location element that has a profile the
        server understands and it can operate either recursively or iteratively; &lt;via>
        elements track the progress of the request. The query indicates the services that the server
        can enumerate from within the forest structure of which it is a part. Because LoST does not
        presume a single, overarching organization of all potential service types, there may be
        services available within a geographic area that could be described by other LoST servers
        connected to other forest structures. As an example, the emergency services forest for a
        region may be distinct from the forests that locate commercial services within the same
        region.
</p>
<p>If the query contains the &lt;service&gt; element, the LoST server returns only
        immediate child services of the queried service that are available for the provided
        location. If the &lt;service&gt; element is absent, the LoST service returns all
        top-level services available for the provided location that it knows about.
</p>
<p>A server responds to this query with a &lt;listServicesByLocationResponse&gt;
        response. This response contains &lt;via&gt; elements (see <a class='info' href='#path'>Section&nbsp;6<span> (</span><span class='info'>Path of a Request: The &lt;path> Element</span><span>)</span></a>)
        and MUST contain a &lt;serviceList&gt; element, consisting of a whitespace-separated
        list of service URNs. The query and response are illustrated in <a class='info' href='#listServicesByLocation-geo.xml'>Figure&nbsp;13<span> (</span><span class='info'>Example of &lt;ListServicesbyLocation> query</span><span>)</span></a> and in <a class='info' href='#listServicesByLocationResponse.xml'>Figure&nbsp;14<span> (</span><span class='info'>Example of &lt;ListServicesByLocationResponse> response</span><span>)</span></a>, respectively.
</p>
<p>
        <br /><hr class="insert" />
<a name="listServicesByLocation-geo.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;listServicesByLocation
  xmlns="urn:ietf:params:xml:ns:lost1"
  xmlns:p2="http://www.opengis.net/gml"
  recursive="true"&gt;
  &lt;location id="3e19dfb3b9828c3" profile="geodetic-2d"&gt;
    &lt;p2:Point srsName="urn:ogc:def:crs:EPSG::4326"&gt;
      &lt;p2:pos&gt;-34.407 150.883&lt;/p2:pos&gt;
    &lt;/p2:Point&gt;
  &lt;/location&gt;
  &lt;service&gt;urn:service:sos&lt;/service&gt;
&lt;/listServicesByLocation&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;13: Example of &lt;ListServicesbyLocation> query&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>
        <br /><hr class="insert" />
<a name="listServicesByLocationResponse.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;listServicesByLocationResponse
 xmlns="urn:ietf:params:xml:ns:lost1"&gt;
 &lt;serviceList&gt;
  urn:service:sos.ambulance
  urn:service:sos.animal-control
  urn:service:sos.fire
  urn:service:sos.gas
  urn:service:sos.mountain
  urn:service:sos.marine
  urn:service:sos.physician
  urn:service:sos.poison
  urn:service:sos.police
 &lt;/serviceList&gt;
 &lt;path&gt;
  &lt;via source="resolver.example"/&gt;
  &lt;via source="authoritative.example"/&gt;
 &lt;/path&gt;
 &lt;locationUsed id="3e19dfb3b9828c3"/&gt;
&lt;/listServicesByLocationResponse&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;14: Example of &lt;ListServicesByLocationResponse> response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<a name="location-profiles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Location Profiles</h3>

<p>LoST uses location information in &lt;location> elements in requests and
        &lt;serviceBoundary> elements in responses. Such location information may be expressed
        in a variety of ways. This variety can cause interoperability problems where a request or
        response contains location information in a format not understood by the server or the
        client, respectively. To achieve interoperability, this document defines two
        mandatory-to-implement baseline location profiles to define the manner in which location
        information is transmitted. It is possible to standardize other profiles in the future. The
        baseline profiles are: </p>
<blockquote class="text"><dl>
<dt>geodetic-2d:</dt>
<dd> a profile for two-dimensional geodetic
            location information, as described in <a class='info' href='#geodetic-2d-profile'>Section&nbsp;12.2<span> (</span><span class='info'>Two-Dimensional Geodetic Profile</span><span>)</span></a>;.
</dd>
<dt>civic:</dt>
<dd> a profile consisting of civic address
            location information, as described in <a class='info' href='#basic-civic-profile'>Section&nbsp;12.3<span> (</span><span class='info'>Basic Civic Profile</span><span>)</span></a>.
</dd>
</dl></blockquote>

<p>Requests and responses containing &lt;location> or &lt;serviceBoundary> elements
        MUST contain location information in exactly one of the two baseline profiles, in addition
        to zero or more additional profiles. The ordering of location information indicates a
        preference on the part of the sender.
</p>
<p>Standards action is required for defining new profiles. A location profile MUST define:
          </p>
<ol class="text">
<li>The token identifying it in the LoST location profile registry.
</li>
<li>The formal definition of the XML to be used in requests, i.e., an enumeration and
            definition of the XML child elements of the &lt;location&gt; element.
</li>
<li>The formal definition of the XML to be used in responses, i.e., an enumeration and
            definition of the XML child elements of the &lt;serviceBoundary&gt; element.
</li>
<li>The declaration of whether geodetic-2d or civic is to be used as the baseline profile.
            It is necessary to explicitly declare the baseline profile as future profiles may be
            combinations of geodetic and civic location information.
</li>
</ol>

<a name="location-profile-usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
Location Profile Usage</h3>

<p>A location profile is identified by a token in an <a class='info' href='#profile-registry'>IANA-maintained registry<span> (</span><span class='info'>LoST Location Profile Registry</span><span>)</span></a>. Clients send location information compliant with a
          location profile, and servers respond with location information compliant with that same
          location profile.
</p>
<p>When a LoST client sends a &lt;findService&gt; request that provides location
          information, it includes one or more &lt;location> elements. A &lt;location>
          element carries an optional 'profile' attribute that indicates the location format of the
          child elements. A client may obtain location information that does not conform to a
          profile it recognizes, or it may not have the capability to map XML to profiles. In that
          case, a client MAY omit the profile attribute and the server should interpret the XML
          location data to the best of its ability, returning a <tt>locationProfileUnrecognized</tt> error if it is unable to do so.
</p>
<p>The concept of location profiles is described in <a class='info' href='#location-profiles'>Section&nbsp;12<span> (</span><span class='info'>Location Profiles</span><span>)</span></a>. With
          the ability to specify more than one &lt;location> element, the client is able to
          convey location information for multiple location profiles in the same request.
</p>
<p>When a LoST server sends a response that contains location information, it uses the
          &lt;serviceBoundary&gt; elements much like the client uses the
          &lt;location&gt; elements. Each &lt;serviceBoundary&gt; element contains
          location information conforming to the location profile specified in the 'profile'
          attribute. A response MAY contain multiple mappings or boundaries for the different
          &lt;location> elements, subject to the restrictions below.
</p>
<p>Using the location profiles defined in this document, the following rules ensure
          interoperability between clients and servers: </p>
<ol class="text">
<li>A client MUST be capable of understanding the response for the baseline profiles it
              used in the request.
</li>
<li>If a client sends location information conformant to any location profile other than
              the ones described in this document, it MUST also send, in the same request, location
              information conformant to one of the baseline profiles. Otherwise, the server might
              not be able to understand the request.
</li>
<li>A client MUST NOT send multiple &lt;location&gt; objects that are derived
              from different baseline profiles. In other words, a client MUST only send location
              objects according to the same baseline profile in a query, but it MAY contain a
              location element following a baseline profile in addition to some other profile.
</li>
<li>If a client has both location information primarily of geodetic nature and location
              information primarily of a civic nature, it MUST send separate requests containing
              each type of location information.
</li>
<li>There can only be one instance of each location profile in a query.
</li>
<li>Servers MUST implement all profiles described in this document.
</li>
<li>A server uses the first-listed location profile that it understands and ignores the
              others.
</li>
<li>If a server receives a request that only contains location information using profiles
              it does not understand, the server responds with a <a class='info' href='#errors'>&lt;locationProfileError&gt;<span> (</span><span class='info'>Errors</span><span>)</span></a>.
</li>
<li>The &lt;serviceBoundary> element MUST use the same location profile that was used
              to retrieve the answer and indicates which profile has been used with the 'profile'
              attribute.
</li>
</ol><p> These rules enable the use of location profiles not yet specified, while ensuring
          baseline interoperability. Take, for example, this scenario illustrated in Figure 15 and
          16. Client X has had its firmware upgraded to support the
          'not-yet-standardized-prism-profile' location profile. Client X sends location information
          to Server Y, which does not understand the 'not-yet-standardized-prism-profile' location
          profile. If Client X also sends location information using the geodetic-2D baseline
          profile, then Server Y will still be able to understand the request and provide an
          understandable response, though with location information that might not be as precise or
          expressive as desired. This is possible because both Client X and Server Y understand the
          baseline profile.
</p>
<p>
          <br /><hr class="insert" />
<a name="findService-geo-uber3d.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findService
  xmlns="urn:ietf:params:xml:ns:lost1"
  xmlns:gml="http://www.opengis.net/gml"
  xmlns:gs="http://www.opengis.net/pidflo/1.0"
  recursive="true"
  serviceBoundary="value"&gt;
  &lt;location id="ABC 123"
      profile="not-yet-standardized-prism-profile"&gt;
    &lt;gs:Prism srsName="urn:ogc:def:crs:EPSG::4979"&gt;
      &lt;gs:base&gt;
        &lt;gml:Polygon&gt;
          &lt;gml:exterior&gt;
            &lt;gml:LinearRing&gt;
              &lt;gml:posList&gt;
                42.556844 -73.248157 36.6
                42.656844 -73.248157 36.6
                42.656844 -73.348157 36.6
                42.556844 -73.348157 36.6
                42.556844 -73.248157 36.6
              &lt;/gml:posList&gt;
            &lt;/gml:LinearRing&gt;
          &lt;/gml:exterior&gt;
        &lt;/gml:Polygon&gt;
      &lt;/gs:base&gt;
      &lt;gs:height uom="urn:ogc:def:uom:EPSG::9001"&gt;
        2.4
      &lt;/gs:height&gt;
    &lt;/gs:Prism&gt;
  &lt;/location&gt;
  &lt;location id="DEF 345" profile="geodetic-2d"&gt;
    &lt;gml:Point id="point1" srsName="urn:ogc:def:crs:EPSG:4326"&gt;
      &lt;gml:pos&gt;42.656844 -73.348157&lt;/gml:pos&gt;
    &lt;/gml:Point&gt;
  &lt;/location&gt;
  &lt;service&gt;urn:service:sos.police&lt;/service&gt;
&lt;/findService&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;15: Example of a &lt;findServices> query with baseline
profile interoperability&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>
          <br /><hr class="insert" />
<a name="findServiceResponse-geo-uber3d.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;findServiceResponse
  xmlns="urn:ietf:params:xml:ns:lost1"
  xmlns:p2="http://www.opengis.net/"&gt;
  &lt;mapping
    expires="2007-01-01T01:44:33Z"
    lastUpdated="2006-11-01T01:00:00Z"
    source="authoritative.example"
    sourceId="cf19bbb038fb4ade95852795f045387d"&gt;
    &lt;displayName xml:lang="en"&gt;
      New York City Police Department
    &lt;/displayName&gt;
    &lt;service&gt;urn:service:sos.police&lt;/service&gt;
    &lt;serviceBoundary profile="geodetic-2d"&gt;
      &lt;p2:Polygon srsName="urn:ogc:def::crs:EPSG::4326"&gt;
        &lt;p2:exterior&gt;
          &lt;p2:LinearRing&gt;
            &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.555 -122.4194&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.555 -122.4264&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.775 -122.4264&lt;/p2:pos&gt;
            &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
          &lt;/p2:LinearRing&gt;
        &lt;/p2:exterior&gt;
      &lt;/p2:Polygon&gt;
    &lt;/serviceBoundary&gt;
    &lt;uri&gt;sip:nypd@example.com&lt;/uri&gt;
    &lt;serviceNumber&gt;911&lt;/serviceNumber&gt;
  &lt;/mapping&gt;
  &lt;path&gt;
    &lt;via source="resolver.example"/&gt;
    &lt;via source="authoritative.example"/&gt;
  &lt;/path&gt;
  &lt;locationUsed id="DEF 345"/&gt;
&lt;/findServiceResponse&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;16: Example of a &lt;findServiceResponse> message with baseline
profile interoperability&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="geodetic-2d-profile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
Two-Dimensional Geodetic Profile</h3>

<p>The <tt>geodetic-2d</tt> location profile is identified by the token
            <tt>geodetic-2d</tt>. Clients and servers use this profile by placing
          the following location shapes into the &lt;serviceBoundary> or into the
          &lt;location> element (unless indicated otherwise): </p>
<blockquote class="text"><dl>
<dt>Point:</dt>
<dd> The &lt;Point&gt; element is
              described in Section 5.2.1 of <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[14]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; February&nbsp;2008.</span><span>)</span></a>.
              Section 5.2.1 of <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[14]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; February&nbsp;2008.</span><span>)</span></a> shows also the
              specification of a &lt;Point&gt; with either a two-dimensional position
              (latitude and longitude) or three-dimensional position (latitude, longitude, and
              altitude). A client MAY use the three-dimensional position, and servers MAY interpret
              a three-dimensional position as a two-dimensional position by ignoring the altitude
              value. A &lt;Point&gt; element is not placed into a &lt;serviceBoundary>
              element. 
</dd>
<dt>Polygon:</dt>
<dd> The &lt;Polygon&gt; element is
              described in Section 5.2.2 of <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[14]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; February&nbsp;2008.</span><span>)</span></a>. The
              restriction to 16 points for a polygon contained in Section 7.2.2 of <a class='info' href='#geo-shapes'>[13]<span> (</span><span class='info'>Reed, C. and M. Thomson, &ldquo;GML 3.1.1 PIDF-LO Shape Application Schema for use by the Internet Engineering Task             Force (IETF),&rdquo; December&nbsp;2006.</span><span>)</span></a> is not applicable to this document. 
</dd>
<dt>Circle:</dt>
<dd> The &lt;Circle&gt; element is
              described in Section 5.2.3 of <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[14]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; February&nbsp;2008.</span><span>)</span></a>. 
</dd>
<dt>Ellipse:</dt>
<dd> The &lt;Ellipse&gt; element is
              described in Section 5.2.4 of <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[14]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; February&nbsp;2008.</span><span>)</span></a>.
</dd>
<dt>ArcBand:</dt>
<dd> The &lt;ArcBand&gt; element is
              described in Section 5.2.5 of <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[14]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; February&nbsp;2008.</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
        
</p>
<p>When a client uses a &lt;Polygon&gt;, &lt;Circle&gt;,
          &lt;Ellipse&gt;, or &lt;ArcBand&gt; element within the
          &lt;location&gt; element, it is indicating that it will be satisfied by query
          results appropriate to any portion of the shape. It is left to the server to select an
          appropriate matching algorithm. A server MAY return multiple &lt;mapping&gt;
          elements if the shape extends across multiple service areas. Servers are not required to
          return all possible &lt;mapping&gt; elements to avoid denial-of-service attacks in
          which clients present queries that span a very large number of service boundaries (e.g.,
          presenting a shape covering all of the United States). 
</p>
<p> In the case where the server does not return multiple &lt;mapping&gt; elements,
          but the shape extends across a service boundary, it is possible that the matching
          algorithm selected by the LoST server will return results that match a portion of the
          shape but do not match those specific to a particular point. A client may always select a
          point from within the shape to avoid this condition. The cases where it does not are
          generally those where it knows its own position only within the shape given. In emergency
          service use cases, that may result in the PSAP contacted at the URI provided by LoST being
          required to forward a call to one of its neighbors; this is an expected part of the
          overall emergency response system. In non-emergency service use cases, the service
          deployment model should take into account this issue as part of the provisioning model, as
          the combination of the data in the LoST server and the algorithm used for mapping
          determine which contact URIs are returned when shapes are used that overlap multiple
          service areas.
</p>
<p> As a general guideline, any deployed matching algorithm should ensure that the algorithm
          used does not needlessly return no results if there are valid results for any portion of
          the shape. If an authoritative server receives a query for which the area in the query
          overlaps the area for which the server has mapping information, then it MUST return either
          a mapping whose coverage area intersects the query area or a redirect to another server
          whose coverage area is a subset of the server's coverage area. 
</p>
<p>When geodetic location information of this location profile is placed in the
          &lt;serviceBoundary&gt; element, then the elements with geospatial coordinates are
          alternative descriptions of the same service region, not additive geometries.
</p>
<a name="basic-civic-profile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
Basic Civic Profile</h3>

<p>The basic civic location profile is identified by the token 'civic'. Clients use this
          profile by placing a &lt;civicAddress&gt; element, defined in <a class='info' href='#RFC5139'>[11]<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object             (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a>, within the &lt;location&gt; element.
</p>
<p>Servers use this profile by placing a &lt;civicAddress&gt; element, defined in
            <a class='info' href='#RFC5139'>[11]<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object             (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a>, within the &lt;serviceBoundary&gt; element.
</p>
<p>A response MAY contain more than one &lt;serviceBoundary> element with profile
          'civic'. The purpose of allowing multiple &lt;serviceBoundary> elements is to be able
          to express more complex location shapes. Each &lt;serviceBoundary> element describes a
          set of civic addresses that fall within the service boundary, namely, all addresses that
          textually match the civic address elements provided, regardless of the value of other
          address elements. A location falls within the mapping's service boundary if it matches any
          of the &lt;serviceBoundary> elements. Hence, a response may contain multiple
          &lt;serviceBoundary> elements with civic and/or geodetic location profiles.
</p>
<a name="error-codes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Errors, Warnings, and Redirects</h3>

<p>When a LoST server cannot fulfill a request completely, it can return either an error or a
        warning, depending on the severity of the problem. It returns an &lt;errors> element if
        no useful response can be returned for the query. It returns a &lt;warnings> element as
        part of another response element if it was able to respond in part, but the response may not
        be quite what the client had desired. For both elements, the 'source' attribute names the
        server that originally generated the error or warning, such as the authoritative server.
        Unless otherwise noted, all elements below can be either an error or a warning, depending on
        whether a default response, such as a mapping, is included.
</p>
<a name="errors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
Errors</h3>

<p>LoST defines a pattern for errors, defined as &lt;errors&gt; elements in the
          Relax NG schema. This pattern defines a 'message' attribute containing human-readable text
          and an 'xml:lang' attribute denoting the language of the human-readable text. One or more
          such error elements are contained in the &lt;errors> element.
</p>
<p>The following errors follow this basic pattern: </p>
<blockquote class="text"><dl>
<dt>badRequest</dt>
<dd>The server could not parse or otherwise
              understand a request, e.g., because the XML was malformed.
</dd>
<dt>forbidden</dt>
<dd>The server refused to send an answer.
              This generally only occurs for recursive queries, namely, if the client tried to
              contact the authoritative server and was refused.
</dd>
<dt>internalError</dt>
<dd>The server could not satisfy a
              request due to misconfiguration or other operational and non-protocol-related reasons.
</dd>
<dt>locationProfileUnrecognized</dt>
<dd>None of the profiles
              in the request were recognized by the server (see <a class='info' href='#location-profiles'>Section&nbsp;12<span> (</span><span class='info'>Location Profiles</span><span>)</span></a>).
</dd>
<dt>locationInvalid</dt>
<dd>The geodetic or civic location in
              the request was invalid. For example, the longitude or latitude values fall outside
              the acceptable ranges. 
</dd>
<dt>SRSInvalid</dt>
<dd>The spatial reference system (SRS)
              contained in the location element was not recognized or does not match the location
              profile.
</dd>
<dt>loop</dt>
<dd>During a recursive query, the server was
              about to visit a server that was already in the server list in the &lt;path>
              element, indicating a request loop.
</dd>
<dt>notFound</dt>
<dd>The server could not find an answer to
              the query.
</dd>
<dt>serverError</dt>
<dd>An answer was received from another
              LoST server, but it could not be parsed or otherwise understood. This error occurs
              only for recursive queries.
</dd>
<dt>serverTimeout</dt>
<dd>A time out occurred before an answer
              was received.
</dd>
<dt>serviceNotImplemented</dt>
<dd>The requested service URN is
              not implemented and no substitution was available.
</dd>
</dl></blockquote><p>
        
</p>
<p>An example is below: <br /><hr class="insert" />
<a name="errors-InternalError.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;errors xmlns="urn:ietf:params:xml:ns:lost1"
  source="resolver.example"&gt;
   &lt;internalError message="Software bug." xml:lang="en"/&gt;
&lt;/errors&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;17: Example of an error response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<a name="warnings"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
Warnings</h3>

<p>A response MAY contain zero or more warnings. This pattern defines a 'message' attribute
          containing human-readable text and an 'xml:lang' attribute denoting the language of the
          human-readable text. One or more such warning elements are contained in the
          &lt;warnings> element. To provide human-readable text in an appropriate language, the
          HTTP content negotiation capabilities (see <a class='info' href='#transport'>Section&nbsp;14<span> (</span><span class='info'>LoST Transport: HTTP</span><span>)</span></a>) MAY be utilized by
          a server.
</p>
<p>This version of the specification defines the following warnings: </p>
<blockquote class="text"><dl>
<dt>locationValidationUnavailable</dt>
<dd> The
              &lt;locationValidationUnavailable> element MAY be returned when a server wishes to
              notify a client that it cannot fulfill a location validation request. This warning
              allows a server to return mapping information while signaling this exception state.
</dd>
<dt>serviceSubstitution</dt>
<dd> The
              &lt;serviceSubstitution> element MAY be returned when a server was not able to
              fulfill a &lt;findService&gt; request for a given service URN. For example, a
              &lt;findService&gt; request with the 'urn:service:sos.police' service URN for
              a location in Uruguay may cause the LoST service to return a mapping for the
              'urn:service:sos' service URN since Uruguay does not make use of the sub-services
              police, fire, and ambulance. If this warning is returned, then the
              &lt;service&gt; element in the response provides information about the service
              URN that refers to the mapping. 
</dd>
<dt>defaultMappingReturned</dt>
<dd> The
              &lt;defaultMappingReturned> element MAY be returned when a server was not able to
              fulfill a &lt;findService&gt; request for a given location but is able to
              respond with a default URI. For example, a nearby PSAP may be returned. 
</dd>
</dl></blockquote><p>
        
</p>
<p>An example of a warning is shown below: <br /><hr class="insert" />
<a name="findServiceResponse-geo-failure.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 &lt;?xml version="1.0" encoding="UTF-8"?&gt;
 &lt;findServiceResponse xmlns="urn:ietf:params:xml:ns:lost1"
   xmlns:p2="http://www.opengis.net/"&gt;
   &lt;mapping
     expires="2007-01-01T01:44:33Z"
     lastUpdated="2006-11-01T01:00:00Z"
     source="authoritative.example"
     sourceId="fb8ed888433343b7b27865aeb38f3a99"&gt;
     &lt;displayName xml:lang="en"&gt;
       New York City Police Department
     &lt;/displayName&gt;
     &lt;service&gt;urn:service:sos.police&lt;/service&gt;
     &lt;serviceBoundary profile="geodetic-2d"&gt;
       &lt;p2:Polygon srsName="urn:ogc:def::crs:EPSG::4326"&gt;
         &lt;p2:exterior&gt;
           &lt;p2:LinearRing&gt;
             &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.555 -122.4194&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.555 -122.4264&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.775 -122.4264&lt;/p2:pos&gt;
             &lt;p2:pos&gt;37.775 -122.4194&lt;/p2:pos&gt;
           &lt;/p2:LinearRing&gt;
         &lt;/p2:exterior&gt;
       &lt;/p2:Polygon&gt;
     &lt;/serviceBoundary&gt;
     &lt;uri&gt;sip:nypd@example.com&lt;/uri&gt;
     &lt;serviceNumber&gt;911&lt;/serviceNumber&gt;
   &lt;/mapping&gt;
   &lt;warnings source="authoritative.example"&gt;
     &lt;defaultMappingReturned
         message="Unable to determine PSAP for the given location;
             using default PSAP"
         xml:lang="en"/&gt;
   &lt;/warnings&gt;
   &lt;path&gt;
     &lt;via source="resolver.example"/&gt;
     &lt;via source="authoritative.example"/&gt;
   &lt;/path&gt;
 &lt;/findServiceResponse&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;18: Example of a warning response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<a name="redirects"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.3"></a><h3>13.3.&nbsp;
Redirects</h3>

<p>A LoST server can respond indicating that the querier should redirect the query to
          another server, using the &lt;redirect> element. The element includes a 'target'
          attribute indicating the LoST application unique string (see <a class='info' href='#lost'>Section&nbsp;4<span> (</span><span class='info'>LoST Servers and Their Resolution</span><span>)</span></a>) that
          the client SHOULD be contacting next, as well as the 'source' attribute indicating the
          server that generated the redirect response and a 'message' attribute explaining the
          reason for the redirect response. During a recursive query, a server receiving a
          &lt;redirect> response can decide whether it wants to follow the redirection or simply
          return the response to its upstream querier. The "expires" value in the response returned
          by the server handling the redirected query indicates the earliest time at which a new
          query might be needed (see Section 5.2). The query for the same tuple of location and
          service SHOULD NOT be directed to the server that gave redirect prior to that time.
</p>
<p>An example is below: <br /><hr class="insert" />
<a name="redirect.xml"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;redirect xmlns="urn:ietf:params:xml:ns:lost1"
  target="eastpsap.example"
  source="westpsap.example"
  message="We have temporarily failed over." xml:lang="en"/&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;19: Example of a redirect response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<a name="transport"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
LoST Transport: HTTP</h3>

<p>LoST needs an underlying protocol transport mechanism to carry requests and responses. This
        document defines the use of LoST over HTTP and LoST over HTTP-over-TLS. Client and server
        developers are reminded that full support of RFC 2616 HTTP facilities is expected. If LoST
        clients or servers re-implement HTTP, rather than using available servers or client code as
        a base, careful attention must be paid to full interoperability. Other transport mechanisms
        are left to future documents. The available transport mechanisms are determined through the
        use of the LoST U-NAPTR application. In protocols that support content type indication, LoST
        uses the media type application/lost+xml.
</p>
<p>When using HTTP <a class='info' href='#RFC2616'>[4]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> and HTTP-over-TLS <a class='info' href='#RFC2818'>[5]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, LoST
        requests use the HTTP POST method. The HTTP request MUST use the Cache-Control response
        directive "no-cache" to disable HTTP-level caching even by caches that have been configured
        to return stale responses to client requests.
</p>
<p>All LoST responses, including those indicating a LoST warning or error, are carried in 2xx
        responses, typically 200 (OK). Other 2xx responses, in particular 203 (Non-authoritative
        information), may be returned by HTTP caches that disregard the caching instructions. 3xx,
        4xx, and 5xx HTTP response codes indicate that the HTTP request itself failed or was
        redirected; these responses do not contain any LoST XML elements. The 3xx responses are
        distinct from the redirects that are described in Section 13.3; the redirect operation in
          <a class='info' href='#redirects'>Section&nbsp;13.3<span> (</span><span class='info'>Redirects</span><span>)</span></a> occur after a LoST server processes the request. Where an
        HTTP-layer redirect will be general, a LoST server redirect as described in Section 13.3
        might be specific to a specific service or be the result of other processing by the LoST
        server. 
</p>
<p>The HTTP URL is derived from the LoST server name via U-NAPTR application, as discussed
        above.
</p>
<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
Relax NG Schema</h3>

<p>This section provides the Relax NG schema used by the LoST protocol in the compact form.
        The verbose form is included in <a class='info' href='#schema-verbose'>Appendix&nbsp;B<span> (</span><span class='info'>Non-Normative RELAX NG Schema in XML Syntax</span><span>)</span></a>.
</p>
<p>
        <br /><hr class="insert" />
<a name="lost.rnc"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

namespace a = "http://relaxng.org/ns/compatibility/annotations/1.0"
default namespace ns1 = "urn:ietf:params:xml:ns:lost1"

##
##       Location-to-Service Translation (LoST) Protocol

##
##       A LoST XML instance has three request types, each with
##       a corresponding response type: find service, list services,
##       and get service boundary.
##
start =
  findService
  | listServices
  | listServicesByLocation
  | getServiceBoundary
  | findServiceResponse
  | listServicesResponse
  | listServicesByLocationResponse
  | getServiceBoundaryResponse
  | errors
  | redirect

##
##       The queries.
##
div {
  findService =
    element findService {
      requestLocation,
      commonRequestPattern,
      attribute validateLocation {
        xsd:boolean &gt;&gt; a:defaultValue [ "false" ]
      }?,
      attribute serviceBoundary {
        ("reference" | "value") &gt;&gt; a:defaultValue [ "reference" ]
      }?,
      attribute recursive { xsd:boolean &gt;&gt; a:defaultValue [ "false" ] }?
    }
  listServices = element listServices { commonRequestPattern }
  listServicesByLocation =
    element listServicesByLocation {
      requestLocation,
      commonRequestPattern,
      attribute recursive { xsd:boolean &gt;&gt; a:defaultValue [ "true" ] }?
    }
  getServiceBoundary =
    element getServiceBoundary { serviceBoundaryKey, extensionPoint }
}

##
##       The responses.
##
div {
  findServiceResponse =
    element findServiceResponse {
      mapping+, locationValidation?, commonResponsePattern, locationUsed
    }
  listServicesResponse =
    element listServicesResponse { serviceList, commonResponsePattern }
  listServicesByLocationResponse =
    element listServicesByLocationResponse {
      serviceList, commonResponsePattern, locationUsed
    }
  getServiceBoundaryResponse =
    element getServiceBoundaryResponse {
      serviceBoundary, commonResponsePattern
    }
}

##
##       A pattern common to some of the queries.
##
div {
  commonRequestPattern = service, path?, extensionPoint
}

##
##       A pattern common to responses.
##
div {
  commonResponsePattern = warnings*, path, extensionPoint
}

##
##       Location in Requests
##
div {
  requestLocation =
    element location {
      attribute id { xsd:token },
      locationInformation
    }+
}

##
##       Location Information
##
div {
  locationInformation =
    extensionPoint+,
    attribute profile { xsd:NMTOKEN }?
}

##
##       Service Boundary
##
div {
  serviceBoundary = element serviceBoundary { locationInformation }+
}

##
##       Service Boundary Reference
##
div {
  serviceBoundaryReference =
    element serviceBoundaryReference {
      source, serviceBoundaryKey, extensionPoint
    }
  serviceBoundaryKey = attribute key { xsd:token }
}

##
##       Path -
##       Contains a list of via elements -
##       places through which information flowed
##
div {
  path =
    element path {
      element via { source, extensionPoint }+
    }
}

##
##       Location Used
##
div {
  locationUsed =
    element locationUsed {
      attribute id { xsd:token }
    }?
}

##
##       Expires pattern
##
div {
  expires =
    attribute expires { xsd:dateTime | "NO-CACHE" | "NO-EXPIRATION" }
}

##
##       A QName list
##
div {
  qnameList = list { xsd:QName* }
}

##
##       A location-to-service mapping.
##
div {
  mapping =
    element mapping {
      element displayName {
        xsd:string,
        attribute xml:lang { xsd:language }
      }*,
      service,
      (serviceBoundary | serviceBoundaryReference)?,
      element uri { xsd:anyURI }*,
      element serviceNumber {
        xsd:token { pattern = "[0-9*#]+" }
      }?,
      extensionPoint,
      expires,
      attribute lastUpdated { xsd:dateTime },
      source,
      attribute sourceId { xsd:token },
      message
    }
}

##
##       Location validation
##
div {
  locationValidation =
    element locationValidation {
      element valid { qnameList }?,
      element invalid { qnameList }?,
      element unchecked { qnameList }?,
      extensionPoint
    }
}

##
##       Errors and Warnings Container.
##
div {
  exceptionContainer =
    (badRequest?
     &amp; internalError?
     &amp; serviceSubstitution?
     &amp; defaultMappingReturned?
     &amp; forbidden?
     &amp; notFound?
     &amp; loop?
     &amp; serviceNotImplemented?
     &amp; serverTimeout?
     &amp; serverError?
     &amp; locationInvalid?
     &amp; locationProfileUnrecognized?),
    extensionPoint,
    source
  errors = element errors { exceptionContainer }
  warnings = element warnings { exceptionContainer }
}

##
##       Basic Exceptions
##
div {

  ##
  ##         Exception pattern.
  ##
  basicException = message, extensionPoint
  badRequest = element badRequest { basicException }
  internalError = element internalError { basicException }
  serviceSubstitution = element serviceSubstitution { basicException }
  defaultMappingReturned =
    element defaultMappingReturned { basicException }
  forbidden = element forbidden { basicException }
  notFound = element notFound { basicException }
  loop = element loop { basicException }
  serviceNotImplemented =
    element serviceNotImplemented { basicException }
  serverTimeout = element serverTimeout { basicException }
  serverError = element serverError { basicException }
  locationInvalid = element locationInvalid { basicException }
  locationValidationUnavailable =
    element locationValidationUnavailable { basicException }
  locationProfileUnrecognized =
    element locationProfileUnrecognized {
      attribute unsupportedProfiles { xsd:NMTOKENS },
      basicException
    }
}

##
##       Redirect.
##
div {

  ##
  ##         Redirect pattern
  ##
  redirect =
    element redirect {
      attribute target { appUniqueString },
      source,
      message,
      extensionPoint
    }
}

##
##       Some common patterns.
##
div {
  message =
    (attribute message { xsd:token },
     attribute xml:lang { xsd:language })?
  service = element service { xsd:anyURI }?
  appUniqueString =
    xsd:token { pattern = "([a-zA-Z0-9\-]+\.)+[a-zA-Z0-9]+" }
  source = attribute source { appUniqueString }
  serviceList =
    element serviceList {
      list { xsd:anyURI* }
    }
}

##
##       Patterns for inclusion of elements from schemas in
##       other namespaces.
##
div {

  ##
  ##         Any element not in the LoST namespace.
  ##
  notLost = element * - (ns1:* | ns1:*) { anyElement }

  ##
  ##         A wildcard pattern for including any element
  ##         from any other namespace.
  ##
  anyElement =
    (element * { anyElement }
     | attribute * { text }
     | text)*

  ##
  ##         A point where future extensions
  ##         (elements from other namespaces)
  ##         can be added.
  ##
  extensionPoint = notLost*
}
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;20: RelaxNG schema&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
Internationalization Considerations</h3>

<p>The LoST protocol is mostly meant for machine-to-machine communications; as such, most of
        its elements are tokens not meant for direct human consumption. If these tokens are
        presented to the end user, some localization may need to occur. The content of the
        &lt;displayName&gt; element and the 'message' attributes may be displayed to the end
        user, and they are thus complex types designed for this purpose.
</p>
<p>LoST exchanges information using XML. All XML processors are required to understand UTF-8
        and UTF-16 encodings, and therefore all LoST clients and servers MUST understand UTF-8 and
        UTF-16 encoded XML. Additionally, LoST servers and clients MUST NOT encode XML with
        encodings other than UTF-8 or UTF-16.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17"></a><h3>17.&nbsp;
IANA Considerations</h3>

<a name="u-naptr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.1"></a><h3>17.1.&nbsp;
U-NAPTR Registrations</h3>

<p>This document registers the following U-NAPTR application service tag: </p>
<blockquote class="text">
<blockquote class="text"><dl>
<dt>Application Service Tag:</dt>
<dd>LoST
</dd>
<dt>Defining Publication:</dt>
<dd>The specification contained within this
              document.
</dd>
</dl></blockquote>
</blockquote><p>
        
</p>
<p>This document registers the following U-NAPTR application protocol tags: </p>
<ul class="text">
<li>Application Protocol Tag: http <br />
<br />
 Defining Publication: <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [4]
            
</li>
<li>Application Protocol Tag: https <br />
<br />
 Defining Publication: <a class='info' href='#RFC2818'>RFC 2818<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> [5]
            
</li>
</ul><p>
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.2"></a><h3>17.2.&nbsp;
Content-Type Registration for 'application/lost+xml'</h3>

<p>This specification requests the registration of a new MIME type according to the
          procedures of RFC 4288 <a class='info' href='#RFC4288'>[8]<span> (</span><span class='info'>Freed, N. and J. Klensin, &ldquo;Media Type Specifications and Registration Procedures,&rdquo; December&nbsp;2005.</span><span>)</span></a> and guidelines in RFC 3023 <a class='info' href='#RFC3023'>[6]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>.
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>MIME media type name:</dt>
<dd>application 
</dd>
<dt>MIME subtype name:</dt>
<dd>lost+xml 
</dd>
<dt>Mandatory parameters:</dt>
<dd>none 
</dd>
<dt>Optional parameters:</dt>
<dd>charset Indicates the
              character encoding of enclosed XML. 
</dd>
<dt>Encoding considerations:</dt>
<dd> Uses XML, which can employ 8-bit characters,
              depending on the character encoding used. See RFC 3023 <a class='info' href='#RFC3023'>[6]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>,
              Section 3.2.
</dd>
<dt>Security considerations:</dt>
<dd> This content type is designed to carry LoST
              protocol payloads.
</dd>
<dt>Interoperability considerations:</dt>
<dd>None
</dd>
<dt>Published specification:</dt>
<dd>RFC 5222 
</dd>
<dt>Applications that use this media type:</dt>
<dd> Emergency and location-based
              systems 
</dd>
<dt>Additional information:</dt>
<dd>
              
<blockquote class="text"><dl>
<dt>Magic Number:</dt>
<dd>None 
</dd>
<dt>File Extension:</dt>
<dd>.lostxml 
</dd>
<dt>Macintosh file type code:</dt>
<dd>'TEXT' 
</dd>
</dl></blockquote>
            
</dd>
<dt>Personal and email address for further
			 information:</dt>
<dd>
               Hannes Tschofenig, Hannes.Tschofenig@nsn.com 
</dd>
<dt>Intended usage:</dt>
<dd>LIMITED USE 
</dd>
<dt>Author:</dt>
<dd>
               This specification is a work item of the IETF ECRIT working
              group, with mailing list address &lt;ecrit@ietf.org&gt;. 
</dd>
<dt>Change controller:</dt>
<dd>
              The IESG &lt;iesg@ietf.org&gt; 
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.3"></a><h3>17.3.&nbsp;
LoST Relax NG Schema Registration</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:schema:lost1
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF ECRIT Working Group, Hannes Tschofenig
              (Hannes.Tschofenig@nsn.com).
</dd>
<dt>Relax NG Schema:</dt>
<dd>The Relax NG schema to be registered is contained in
                <a class='info' href='#schema'>Section&nbsp;15<span> (</span><span class='info'>Relax NG Schema</span><span>)</span></a>. Its first line is <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
default namespace = "urn:ietf:params:xml:ns:lost1"
</pre></div> and its last line is<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
}
</pre></div>
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.4"></a><h3>17.4.&nbsp;
LoST Namespace Registration</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:lost1
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF ECRIT Working Group, Hannes Tschofenig
              (Hannes.Tschofenig@nsn.com).
</dd>
<dt>XML:</dt>
<dd>
              <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
BEGIN
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
  "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
  &lt;meta http-equiv="content-type"
        content="text/html;charset=iso-8859-1"/&gt;
  &lt;title&gt;LoST Namespace&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Namespace for LoST&lt;/h1&gt;
  &lt;h2&gt;urn:ietf:params:xml:ns:lost1&lt;/h2&gt;
&lt;p&gt;See &lt;a href="http://www.rfc-editor.org/rfc/rfc5222.txt"&gt;RFC5222&lt;/a&gt;.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
END
</pre></div>
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="profile-registry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17.5"></a><h3>17.5.&nbsp;
LoST Location Profile Registry</h3>

<p>This document creates a registry of location profile names for the LoST protocol. Profile
          names are XML tokens. This registry will operate in accordance with <a class='info' href='#RFC5226'>RFC 5226<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [3], Standards Action.
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>geodetic-2d:</dt>
<dd> Defined in <a class='info' href='#geodetic-2d-profile'>Section&nbsp;12.2<span> (</span><span class='info'>Two-Dimensional Geodetic Profile</span><span>)</span></a>.
</dd>
<dt>civic:</dt>
<dd> Defined in <a class='info' href='#basic-civic-profile'>Section&nbsp;12.3<span> (</span><span class='info'>Basic Civic Profile</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
        
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18"></a><h3>18.&nbsp;
Security Considerations</h3>

<p>There are several threats to the overall system of which service mapping forms a part. An
        attacker that can obtain service contact URIs can use those URIs to attempt to disrupt those
        services. An attacker that can prevent the lookup of contact URIs can impair the
        reachability of such services. An attacker that can eavesdrop on the communication
        requesting this lookup can surmise the existence of an emergency and possibly its nature,
        and may be able to use this to launch a physical attack on the caller.
</p>
<p>To avoid an attacker modifying the query or its result, Transport Layer Security (TLS) MUST
        be implemented and SHOULD be used. Use is RECOMMENDED both for clients' queries to servers
        and for queries among servers; this latter recommendation is to help avoid LoST cache
        poisoning attacks by replacing answers given to caching LoST servers.
</p>
<p> The use of server identity checks with TLS, as described in Section 3.1 of <a class='info' href='#RFC2818'>[5]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, is also RECOMMENDED. Omitting the server identity check allows an
        attacker to masquerade as a LoST server, so this approach should be used only when getting
        any answer, even from a potentially malicious LoST server, is preferred over closing the
        connection (and thus not getting any answer at all). The host name compared against the
        server certificate is the host name in the URI, not the DNS name used as input to NAPTR
        resolution. 
</p>
<p>Note that the security considerations in <a class='info' href='#RFC3958'>[23]<span> (</span><span class='info'>Daigle, L. and A. Newton, &ldquo;Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS),&rdquo; January&nbsp;2005.</span><span>)</span></a> recommend comparing the
        input of NAPTR resolution to the certificate, not the output (host name in the URI). This
        approach was not chosen because in emergency service use cases, it is likely that
        deployments will see a large number of inputs to the U-NAPTR algorithm resolving to a single
        server, typically run by a local emergency services authority. In this case, checking the
        input to the NAPTR resolution against the certificates provided by the LoST server would be
        impractical, as the list of organizations using it would be large, subject to rapid change,
        and unknown to the LoST server operator. 
</p>
<p> The use of server identity does leave open the possibility of DNS-based attacks, as the
        NAPTR records may be altered by an attacker. The attacks include, for example, interception
        of DNS packets between the client and the recursive name server, DNS cache poisoning, and
        intentional modifications by the recursive name server; see <a class='info' href='#RFC3833'>[24]<span> (</span><span class='info'>Atkins, D. and R. Austein, &ldquo;Threat Analysis of the Domain Name System (DNS),&rdquo; August&nbsp;2004.</span><span>)</span></a> for
        more comprehensive discussion. 
</p>
<p> DNS Security (DNSSEC) <a class='info' href='#RFC4033'>[21]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> can be used to protect against these
        threats. While DNSSEC is incompletely deployed, users should be aware of the risk,
        particularly when they are requesting NAPTR records in environments where the local
        recursive name server, or the network between the client and the local recursive name
        server, is not considered trustworthy.
</p>
<p>LoST deployments that are unable to use DNSSEC and unwilling to trust DNS resolution
        without DNSSEC cannot use the NATPR-based discovery of LoST servers as is. When suitable
        configuration mechanisms are available, one possibility is to configure the LoST server URIs
        (instead of the domain name to be used for NAPTR resolution) directly. Future specifications
        for applying LoST in non-emergency services may also specify additional discovery mechanisms
        and name matching semantics.
</p>
<p>Generally, LoST servers will not need to authenticate or authorize clients presenting
        mapping queries. If they do, an authentication of the underlying transport mechanism, such
        as HTTP basic and digest authentication, MAY be used. Basic authentication SHOULD only be
        used in combination with TLS. 
</p>
<p>A more detailed description of threats and security requirements is provided in <a class='info' href='#RFC5069'>[18]<span> (</span><span class='info'>Taylor, T., Tschofenig, H., Schulzrinne, H., and M. Shanmugam, &ldquo;Security Threats and Requirements for Emergency Call Marking and Mapping,&rdquo; January&nbsp;2008.</span><span>)</span></a>. The threats and security requirements in non-emergency service uses of
        LoST may be considerably different from those described here. For example, an attacker might
        seek monetary benefit by returning service mapping information that directed users to
        specific service providers. Before deploying LoST in new contexts, a thorough analysis of
        the threats and requirements specific to that context should be undertaken and decisions
        made on the appropriate mitigations. 
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.19"></a><h3>19.&nbsp;
Acknowledgments</h3>

<p>For the acknowledgments to the initial LoST version please refer to RFC 5222 <a class='info' href='#RFC5222'>[2]<span> (</span><span class='info'>Hardie, T., Newton, A., Schulzrinne, H., and H. Tschofenig, &ldquo;LoST: A Location-to-Service Translation Protocol,&rdquo; August&nbsp;2008.</span><span>)</span></a>. 
</p>
<p>We would like to thank the following persons for their review comments to this revised
        version of LoST: Avery Penniston.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.20"></a><h3>20.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>20.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[1]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5222">[2]</a></td>
<td class="author-text">Hardie, T., Newton, A., Schulzrinne, H., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5222">LoST: A Location-to-Service Translation Protocol</a>,&rdquo; RFC&nbsp;5222, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5222.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[3]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[4]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[5]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3023">[6]</a></td>
<td class="author-text">Murata, M., St. Laurent, S., and D. Kohn, &ldquo;<a href="http://tools.ietf.org/html/rfc3023">XML Media Types</a>,&rdquo; RFC&nbsp;3023, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3023.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4119">[7]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4119">A Presence-based GEOPRIV Location Object Format</a>,&rdquo; RFC&nbsp;4119, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4288">[8]</a></td>
<td class="author-text">Freed, N. and J. Klensin, &ldquo;<a href="http://tools.ietf.org/html/rfc4288">Media Type Specifications and Registration Procedures</a>,&rdquo; BCP&nbsp;13, RFC&nbsp;4288, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4288.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4848">[9]</a></td>
<td class="author-text">Daigle, L., &ldquo;<a href="http://tools.ietf.org/html/rfc4848">Domain-Based Application Service Location Using URIs and the Dynamic Delegation Discovery Service (DDDS)</a>,&rdquo; RFC&nbsp;4848, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4848.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5031">[10]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc5031">A Uniform Resource Name (URN) for Emergency and Other Well-Known Services</a>,&rdquo; RFC&nbsp;5031, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5031.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5139">[11]</a></td>
<td class="author-text">Thomson, M. and J. Winterbottom, &ldquo;<a href="http://tools.ietf.org/html/rfc5139">Revised Civic Location Format for Presence Information Data Format Location Object
            (PIDF-LO)</a>,&rdquo; RFC&nbsp;5139, February&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5139.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="GML">[12]</a></td>
<td class="author-text"><a href="mailto:">Cox, S.</a>, <a href="mailto:">Daisey, P.</a>, <a href="mailto:">Lake, R.</a>, <a href="mailto:">Portele, C.</a>, and <a href="mailto:">A. Whiteside</a>, &ldquo;<a href="http://portal.opengeospatial.org/files/?artifact_id=4700">Geographic information - Geography Markup Language (GML)</a>,&rdquo; OGC Standard&nbsp;OpenGIS 03-105r1, April&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="geo-shapes">[13]</a></td>
<td class="author-text"><a href="mailto:">Reed, C.</a> and <a href="mailto:">M. Thomson</a>, &ldquo;<a href="http://portal.opengeospatial.org/files/?artifact_id=17591">GML 3.1.1 PIDF-LO Shape Application Schema for use by the Internet Engineering Task
            Force (IETF)</a>,&rdquo; Candidate OpenGIS Implementation Specification&nbsp;, December&nbsp;2006.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>20.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-pdif-lo-profile">[14]</a></td>
<td class="author-text">Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-pdif-lo-profile-11.txt">GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations</a>,&rdquo; Work in&nbsp;Progress, February&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[15]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3921">[16]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3921">Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence</a>,&rdquo; RFC&nbsp;3921, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3921.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3921.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3921.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3966">[17]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc3966">The tel URI for Telephone Numbers</a>,&rdquo; RFC&nbsp;3966, December&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3966.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5069">[18]</a></td>
<td class="author-text">Taylor, T., Tschofenig, H., Schulzrinne, H., and M. Shanmugam, &ldquo;<a href="http://tools.ietf.org/html/rfc5069">Security Threats and Requirements for Emergency Call Marking and Mapping</a>,&rdquo; RFC&nbsp;5069, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5069.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5012">[19]</a></td>
<td class="author-text">Schulzrinne, H. and R. Marshall, &ldquo;<a href="http://tools.ietf.org/html/rfc5012">Requirements for Emergency Context Resolution with Internet Technologies</a>,&rdquo; RFC&nbsp;5012, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5012.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-mapping-arch">[20]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-mapping-arch-03.txt">Location-to-URL Mapping Architecture and Framework</a>,&rdquo; Work in&nbsp;Progress, September&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[21]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-phonebcp">[22]</a></td>
<td class="author-text">Rosen, B. and J. Polk, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-phonebcp-04.txt">Best Current Practice for Communications Services in support of Emergency Calling</a>,&rdquo; Work in&nbsp;Progress, February&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3958">[23]</a></td>
<td class="author-text">Daigle, L. and A. Newton, &ldquo;<a href="http://tools.ietf.org/html/rfc3958">Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS)</a>,&rdquo; RFC&nbsp;3958, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3958.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3833">[24]</a></td>
<td class="author-text">Atkins, D. and R. Austein, &ldquo;<a href="http://tools.ietf.org/html/rfc3833">Threat Analysis of the Domain Name System (DNS)</a>,&rdquo; RFC&nbsp;3833, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3833.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="URL_for_examples">[25]</a></td>
<td class="author-text">&ldquo;<a href="http://www.tschofenig.priv.at/svn/draft-ietf-ecrit-lost/RelaxNG"></a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5223">[26]</a></td>
<td class="author-text">Schulzrinne, H., Polk, J., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5223">Discovering Location-to-Service Translation (LoST) Servers Using the Dynamic Host
            Configuration Protocol (DHCP)</a>,&rdquo; RFC&nbsp;5223, August&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-dhc-lost-discovery-03.txt">TXT</a>).</td></tr>
</table>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Changes from RFC 5222</h3>

<p>
        </p>
<blockquote class="text">
<p>-00: Based on RFC 5222 the following changes were made: </p>
<ul class="text">
<li>New terminology introduced for "location validation". Still necessary to
                double-check it with the latest terms used in NENA.
</li>
<li>Editorial changes in Section 1 regarding service boundary hints. 
</li>
<li>Clarified in Section 3 that service numbers are provided in the a
                &lt;findServiceResponse> message rather than in a separate message.
</li>
<li>Provided additional description in Section 5.1 regarding the 'lastUpdated'
                attribute and when a new mapping is created. 
</li>
<li>Added a note about the usage of the NO-EXPIRATION value in Section 5.2.
</li>
<li>Fixed a wrong statement in Section 11 saying that the &lt;via&gt; elements
                are optional in the &lt;listServicesByLocationResponse&gt; message. They are
                mandatory.
</li>
<li>Included a clarification in Section 12.3 about why a response may contain more than
                one &lt;serviceBoundary> element.
</li>
</ul>

<p>The following changes are pending and require discussion on the list: </p>
<ul class="text">
<li>Removal of the &lt;serviceSubstitution&gt; warning element since the
                functionality is already accomplished by including the &lt;service&gt;
                element with the substituted service URN. 
</li>
<li>Allowing the &lt;serviceBoundary&gt; element to contain location of
                profiles that were not included in the request. Example: Request with civic location
                information and response with geodetic service boundary.
</li>
<li>Description of how load balancing / alternate routing is accomplished.
</li>
<li>Inclusion of a contact info for error reporting in case there are failures.
</li>
<li>Provide additional description regarding the service boundary matching when the
                civic location profile is used.
</li>
</ul>

</blockquote><p>
      
</p>
<a name="schema-verbose"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Non-Normative RELAX NG Schema in
XML Syntax</h3>

<p>
        <br /><hr class="insert" />
<a name="lost.rng"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;grammar ns="urn:ietf:params:xml:ns:lost1"
	xmlns="http://relaxng.org/ns/structure/1.0"
	xmlns:a="http://relaxng.org/ns/compatibility/annotations/1.0"
	datatypeLibrary="http://www.w3.org/2001/XMLSchema-datatypes"&gt;

	&lt;start&gt;
    &lt;a:documentation&gt;
      Location-to-Service Translation (LoST) Protocol

      A LoST XML instance has three request types, each with
      a corresponding response type: find service, list services,
      and get service boundary.
    &lt;/a:documentation&gt;
    &lt;choice&gt;
      &lt;ref name="findService"/&gt;
      &lt;ref name="listServices"/&gt;
      &lt;ref name="listServicesByLocation"/&gt;
      &lt;ref name="getServiceBoundary"/&gt;
      &lt;ref name="findServiceResponse"/&gt;
      &lt;ref name="listServicesResponse"/&gt;
      &lt;ref name="listServicesByLocationResponse"/&gt;
      &lt;ref name="getServiceBoundaryResponse"/&gt;
      &lt;ref name="errors"/&gt;
      &lt;ref name="redirect"/&gt;
    &lt;/choice&gt;
	&lt;/start&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      The queries.
    &lt;/a:documentation&gt;

    &lt;define name="findService"&gt;
      &lt;element name="findService"&gt;
        &lt;ref name="requestLocation"/&gt;
        &lt;ref name="commonRequestPattern"/&gt;
        &lt;optional&gt;
          &lt;attribute name="validateLocation"&gt;
            &lt;data type="boolean"/&gt;
            &lt;a:defaultValue&gt;false&lt;/a:defaultValue&gt;
          &lt;/attribute&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;attribute name="serviceBoundary"&gt;
            &lt;choice&gt;
              &lt;value&gt;reference&lt;/value&gt;
              &lt;value&gt;value&lt;/value&gt;
            &lt;/choice&gt;
            &lt;a:defaultValue&gt;reference&lt;/a:defaultValue&gt;
          &lt;/attribute&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;attribute name="recursive"&gt;
            &lt;data type="boolean"/&gt;
              &lt;a:defaultValue&gt;false&lt;/a:defaultValue&gt;
          &lt;/attribute&gt;
        &lt;/optional&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="listServices"&gt;
      &lt;element name="listServices"&gt;
        &lt;ref name="commonRequestPattern"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="listServicesByLocation"&gt;
      &lt;element name="listServicesByLocation"&gt;
        &lt;ref name="requestLocation"/&gt;
        &lt;ref name="commonRequestPattern"/&gt;
        &lt;optional&gt;
          &lt;attribute name="recursive"&gt;
            &lt;data type="boolean"/&gt;
            &lt;a:defaultValue&gt;true&lt;/a:defaultValue&gt;
          &lt;/attribute&gt;
        &lt;/optional&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="getServiceBoundary"&gt;
      &lt;element name="getServiceBoundary"&gt;
        &lt;ref name="serviceBoundaryKey"/&gt;
        &lt;ref name="extensionPoint"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      The responses.
    &lt;/a:documentation&gt;


    &lt;define name="findServiceResponse"&gt;
      &lt;element name="findServiceResponse"&gt;
        &lt;oneOrMore&gt;
          &lt;ref name="mapping"/&gt;
        &lt;/oneOrMore&gt;
        &lt;optional&gt;
          &lt;ref name="locationValidation"/&gt;
        &lt;/optional&gt;
        &lt;ref name="commonResponsePattern"/&gt;
        &lt;ref name="locationUsed"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;


    &lt;define name="listServicesResponse"&gt;
      &lt;element name="listServicesResponse"&gt;
        &lt;ref name="serviceList"/&gt;
        &lt;ref name="commonResponsePattern"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;


    &lt;define name="listServicesByLocationResponse"&gt;
      &lt;element name="listServicesByLocationResponse"&gt;
        &lt;ref name="serviceList"/&gt;
        &lt;ref name="commonResponsePattern"/&gt;
        &lt;ref name="locationUsed"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="getServiceBoundaryResponse"&gt;
      &lt;element name="getServiceBoundaryResponse"&gt;
        &lt;ref name="serviceBoundary"/&gt;
        &lt;ref name="commonResponsePattern"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      A pattern common to some of the queries.
    &lt;/a:documentation&gt;

    &lt;define name="commonRequestPattern"&gt;
      &lt;ref name="service"/&gt;
      &lt;optional&gt;
        &lt;ref name="path"/&gt;
      &lt;/optional&gt;
      &lt;ref name="extensionPoint"/&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      A pattern common to responses.
    &lt;/a:documentation&gt;

    &lt;define name="commonResponsePattern"&gt;
      &lt;zeroOrMore&gt;
        &lt;ref name="warnings"/&gt;
      &lt;/zeroOrMore&gt;
      &lt;ref name="path"/&gt;
      &lt;ref name="extensionPoint"/&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Location in Requests
    &lt;/a:documentation&gt;

    &lt;define name="requestLocation"&gt;
      &lt;oneOrMore&gt;
        &lt;element name="location"&gt;
          &lt;attribute name="id"&gt;
            &lt;data type="token"/&gt;
          &lt;/attribute&gt;
          &lt;ref name="locationInformation"/&gt;
        &lt;/element&gt;
      &lt;/oneOrMore&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Location Information
    &lt;/a:documentation&gt;

    &lt;define name="locationInformation"&gt;
      &lt;oneOrMore&gt;
        &lt;ref name="extensionPoint"/&gt;
      &lt;/oneOrMore&gt;
      &lt;optional&gt;
        &lt;attribute name="profile"&gt;
          &lt;data type="NMTOKEN"/&gt;
        &lt;/attribute&gt;
      &lt;/optional&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Service Boundary
    &lt;/a:documentation&gt;

    &lt;define name="serviceBoundary"&gt;
      &lt;oneOrMore&gt;
        &lt;element name="serviceBoundary"&gt;
          &lt;ref name="locationInformation"/&gt;
        &lt;/element&gt;
      &lt;/oneOrMore&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Service Boundary Reference
    &lt;/a:documentation&gt;

    &lt;define name="serviceBoundaryReference"&gt;

      &lt;element name="serviceBoundaryReference"&gt;
        &lt;ref name="source"/&gt;
        &lt;ref name="serviceBoundaryKey"/&gt;
        &lt;ref name="extensionPoint"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="serviceBoundaryKey"&gt;
      &lt;attribute name="key"&gt;
        &lt;data type="token"/&gt;
      &lt;/attribute&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Path -
      Contains a list of via elements -
      places through which information flowed
    &lt;/a:documentation&gt;

    &lt;define name="path"&gt;
      &lt;element name="path"&gt;
        &lt;oneOrMore&gt;
          &lt;element name="via"&gt;
            &lt;ref name="source"/&gt;
            &lt;ref name="extensionPoint"/&gt;
          &lt;/element&gt;
        &lt;/oneOrMore&gt;
      &lt;/element&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Location Used
    &lt;/a:documentation&gt;

    &lt;define name="locationUsed"&gt;
      &lt;optional&gt;
        &lt;element name="locationUsed"&gt;
          &lt;attribute name="id"&gt;
            &lt;data type="token"/&gt;
          &lt;/attribute&gt;
        &lt;/element&gt;
      &lt;/optional&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Expires pattern
    &lt;/a:documentation&gt;

    &lt;define name="expires"&gt;
      &lt;attribute name="expires"&gt;
        &lt;choice&gt;
          &lt;data type="dateTime"/&gt;
          &lt;value&gt;NO-CACHE&lt;/value&gt;
          &lt;value&gt;NO-EXPIRATION&lt;/value&gt;
        &lt;/choice&gt;
      &lt;/attribute&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      A QName list
    &lt;/a:documentation&gt;

    &lt;define name="qnameList"&gt;
      &lt;list&gt;
        &lt;zeroOrMore&gt;
          &lt;data type="QName"/&gt;
        &lt;/zeroOrMore&gt;
      &lt;/list&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      A location-to-service mapping.
    &lt;/a:documentation&gt;

    &lt;define name="mapping"&gt;
      &lt;element name="mapping"&gt;
        &lt;zeroOrMore&gt;
          &lt;element name="displayName"&gt;
            &lt;data type="string"/&gt;
            &lt;attribute name="xml:lang"&gt;
              &lt;data type="language"/&gt;
            &lt;/attribute&gt;
          &lt;/element&gt;
        &lt;/zeroOrMore&gt;
        &lt;ref name="service"/&gt;
        &lt;optional&gt;
          &lt;choice&gt;
            &lt;ref name="serviceBoundary"/&gt;
            &lt;ref name="serviceBoundaryReference"/&gt;
          &lt;/choice&gt;
        &lt;/optional&gt;
        &lt;zeroOrMore&gt;
          &lt;element name="uri"&gt;
            &lt;data type="anyURI"/&gt;
          &lt;/element&gt;
        &lt;/zeroOrMore&gt;
        &lt;optional&gt;
          &lt;element name="serviceNumber"&gt;
            &lt;data type="token"&gt;
              &lt;param name="pattern"&gt;[0-9*#]+&lt;/param&gt;
            &lt;/data&gt;
          &lt;/element&gt;
        &lt;/optional&gt;
        &lt;ref name="extensionPoint"/&gt;
        &lt;ref name="expires"/&gt;
        &lt;attribute name="lastUpdated"&gt;
          &lt;data type="dateTime"/&gt;
        &lt;/attribute&gt;
        &lt;ref name="source"/&gt;
        &lt;attribute name="sourceId"&gt;
          &lt;data type="token"/&gt;
        &lt;/attribute&gt;
        &lt;ref name="message"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Location validation
    &lt;/a:documentation&gt;

    &lt;define name="locationValidation"&gt;
      &lt;element name="locationValidation"&gt;
        &lt;optional&gt;
          &lt;element name="valid"&gt;
            &lt;ref name="qnameList"/&gt;
          &lt;/element&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;element name="invalid"&gt;
            &lt;ref name="qnameList"/&gt;
          &lt;/element&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;element name="unchecked"&gt;
            &lt;ref name="qnameList"/&gt;
          &lt;/element&gt;
        &lt;/optional&gt;
        &lt;ref name="extensionPoint"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;
  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Errors and Warnings Container.
    &lt;/a:documentation&gt;

    &lt;define name="exceptionContainer"&gt;
      &lt;interleave&gt;
        &lt;optional&gt;
          &lt;ref name="badRequest"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="internalError"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="serviceSubstitution"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="defaultMappingReturned"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="forbidden"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="notFound"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="loop"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="serviceNotImplemented"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="serverTimeout"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="serverError"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="locationInvalid"/&gt;
        &lt;/optional&gt;
        &lt;optional&gt;
          &lt;ref name="locationProfileUnrecognized"/&gt;
        &lt;/optional&gt;
      &lt;/interleave&gt;
      &lt;ref name="extensionPoint"/&gt;
      &lt;ref name="source"/&gt;
    &lt;/define&gt;

    &lt;define name="errors"&gt;
      &lt;element name="errors"&gt;
        &lt;ref name="exceptionContainer"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="warnings"&gt;
      &lt;element name="warnings"&gt;
        &lt;ref name="exceptionContainer"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Basic Exceptions
    &lt;/a:documentation&gt;

    &lt;define name="basicException"&gt;
      &lt;a:documentation&gt;
        Exception pattern.
      &lt;/a:documentation&gt;
      &lt;ref name="message"/&gt;
      &lt;ref name="extensionPoint"/&gt;
    &lt;/define&gt;

    &lt;define name="badRequest"&gt;
      &lt;element name="badRequest"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="internalError"&gt;
      &lt;element name="internalError"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="serviceSubstitution"&gt;
      &lt;element name="serviceSubstitution"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="defaultMappingReturned"&gt;
      &lt;element name="defaultMappingReturned"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="forbidden"&gt;
      &lt;element name="forbidden"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="notFound"&gt;
      &lt;element name="notFound"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="loop"&gt;
      &lt;element name="loop"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="serviceNotImplemented"&gt;
      &lt;element name="serviceNotImplemented"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="serverTimeout"&gt;
      &lt;element name="serverTimeout"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="serverError"&gt;
      &lt;element name="serverError"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="locationInvalid"&gt;
      &lt;element name="locationInvalid"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="locationValidationUnavailable"&gt;
      &lt;element name="locationValidationUnavailable"&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

    &lt;define name="locationProfileUnrecognized"&gt;
      &lt;element name="locationProfileUnrecognized"&gt;
        &lt;attribute name="unsupportedProfiles"&gt;
          &lt;data type="NMTOKENS"/&gt;
        &lt;/attribute&gt;
        &lt;ref name="basicException"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Redirect.
    &lt;/a:documentation&gt;

    &lt;define name="redirect"&gt;
      &lt;a:documentation&gt;
        Redirect pattern
      &lt;/a:documentation&gt;
      &lt;element name="redirect"&gt;
        &lt;attribute name="target"&gt;
          &lt;ref name="appUniqueString"/&gt;
        &lt;/attribute&gt;
        &lt;ref name="source"/&gt;
        &lt;ref name="message"/&gt;
        &lt;ref name="extensionPoint"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Some common patterns.
    &lt;/a:documentation&gt;

    &lt;define name="message"&gt;
      &lt;optional&gt;
        &lt;group&gt;
          &lt;attribute name="message"&gt;
            &lt;data type="token"/&gt;
          &lt;/attribute&gt;
          &lt;attribute name="xml:lang"&gt;
            &lt;data type="language"/&gt;
          &lt;/attribute&gt;
        &lt;/group&gt;
      &lt;/optional&gt;
    &lt;/define&gt;

    &lt;define name="service"&gt;
      &lt;optional&gt;
        &lt;element name="service"&gt;
          &lt;data type="anyURI"/&gt;
        &lt;/element&gt;
      &lt;/optional&gt;
    &lt;/define&gt;

    &lt;define name="appUniqueString"&gt;
      &lt;data type="token"&gt;
        &lt;param name="pattern"&gt;([a-zA-Z0-9\-]+\.)+[a-zA-Z0-9]+&lt;/param&gt;
      &lt;/data&gt;
    &lt;/define&gt;

    &lt;define name="source"&gt;
      &lt;attribute name="source"&gt;
        &lt;ref name="appUniqueString"/&gt;
      &lt;/attribute&gt;
    &lt;/define&gt;

    &lt;define name="serviceList"&gt;
      &lt;element name="serviceList"&gt;
        &lt;list&gt;
          &lt;zeroOrMore&gt;
            &lt;data type="anyURI"/&gt;
          &lt;/zeroOrMore&gt;
        &lt;/list&gt;
      &lt;/element&gt;
    &lt;/define&gt;

  &lt;/div&gt;

  &lt;div&gt;
    &lt;a:documentation&gt;
      Patterns for inclusion of elements from schemas in
      other namespaces.
    &lt;/a:documentation&gt;

    &lt;define name="notLost"&gt;
      &lt;a:documentation&gt;
        Any element not in the LoST namespace.
      &lt;/a:documentation&gt;
      &lt;element&gt;
        &lt;anyName&gt;
          &lt;except&gt;
            &lt;nsName ns="urn:ietf:params:xml:ns:lost1"/&gt;
            &lt;nsName/&gt;
          &lt;/except&gt;
        &lt;/anyName&gt;
        &lt;ref name="anyElement"/&gt;
      &lt;/element&gt;
    &lt;/define&gt;


    &lt;define name="anyElement"&gt;
      &lt;a:documentation&gt;
        A wildcard pattern for including any element
        from any other namespace.
      &lt;/a:documentation&gt;
      &lt;zeroOrMore&gt;
        &lt;choice&gt;
          &lt;element&gt;
            &lt;anyName/&gt;
            &lt;ref name="anyElement"/&gt;
          &lt;/element&gt;
          &lt;attribute&gt;
            &lt;anyName/&gt;
          &lt;/attribute&gt;
          &lt;text/&gt;
        &lt;/choice&gt;
      &lt;/zeroOrMore&gt;
    &lt;/define&gt;

    &lt;define name="extensionPoint"&gt;
      &lt;a:documentation&gt;
        A point where future extensions
        (elements from other namespaces)
        can be added.
      &lt;/a:documentation&gt;
      &lt;zeroOrMore&gt;
        &lt;ref name="notLost"/&gt;
      &lt;/zeroOrMore&gt;
    &lt;/define&gt;

  &lt;/div&gt;

&lt;/grammar&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;21&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<a name="online-examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Examples Online</h3>

<p> The XML examples and Relax NG schemas may be found <a class='info' href='#URL_for_examples'>online<span> (</span><span class='info'>, &ldquo;,&rdquo; .</span><span>)</span></a> [25]. 
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ted Hardie</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:ted.ietf@gmail.com">ted.ietf@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew Newton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">American Registry for Internet Numbers</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3635 Concorde Parkway, Suite 200</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chantilly, VA  20151</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 703 227 9894</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:andy@hxr.us">andy@hxr.us</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henning Schulzrinne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">450 Computer Science Building</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">New York, NY  10027</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 212 939 7004</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:hgs+ecrit@cs.columbia.edu">hgs+ecrit@cs.columbia.edu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cs.columbia.edu">http://www.cs.columbia.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
</table>
</body></html>
