



Network Working Group                                       M. Sivakumar
Internet-Draft                                          Juniper Networks
Updates: 3376, 3810 (if approved)                              S. Venaas
Intended status: Standards Track                     Cisco Systems, Inc.
Expires: May 6, 2021                                            Z. Zhang
                                                         ZTE Corporation
                                                               H. Asaeda
                                                                    NICT
                                                        November 2, 2020


                     IGMPv3/MLDv2 Message Extension
                  draft-ietf-pim-igmp-mld-extension-02

Abstract

   IGMP and MLD protocols are extensible, but no extensions have been
   defined so far.  This document provides a well-defined way of
   extending IGMP and MLD, using a list of TLVs (Type, Length and
   Value).

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 6, 2021.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Sivakumar, et al.          Expires May 6, 2021                  [Page 1]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions used in this document . . . . . . . . . . . . . .   2
   3.  Extension Format  . . . . . . . . . . . . . . . . . . . . . .   3
     3.1.  Multicast Listener Query Extension  . . . . . . . . . . .   4
     3.2.  Version 2 Multicast Listener Report Extension . . . . . .   5
     3.3.  IGMP Membership Query Extension . . . . . . . . . . . . .   6
     3.4.  IGMP Version 3 Membership Report Extension  . . . . . . .   7
   4.  Applicability and backwards compatibility . . . . . . . . . .   8
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   9
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   9
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  10
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .  10
     7.2.  Informative References  . . . . . . . . . . . . . . . . .  10
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  11

1.  Introduction

   In this document, we describe a generic method to extend IGMPv3
   [RFC3376] and MLDv2 [RFC3810] messages to accommodate information
   other than what is contained in the current message formats.  This is
   done by allowing a list of TLVs (Type, Length and Value) to be used
   in the Additional Data part of IGMPv3 and MLDv2 messages.  This
   document defines a registry for such TLVs, while other documents will
   define the specific types and their values, and their semantics.  The
   extension would only be used when at least one TLV is to be added to
   the message.  This extension also applies to the lightweight versions
   of IGMPv3 and MLDv2 as defined in [RFC5790].

   The extension will be part of additional data as mentioned in
   [RFC3810] Section 5.1.12 (resp.  [RFC3376] Section 4.1.10) for query
   messages and [RFC3810] Section 5.2.12 (resp.  [RFC3376]
   Section 4.2.11) for report messages.

   One such TLV is being defined in [I-D.ietf-bier-mld]

2.  Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP




Sivakumar, et al.          Expires May 6, 2021                  [Page 2]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Extension Format

   A previously reserved bit in the IGMPv2 and MLDv2 headers is used to
   indicate whether this extension is used.  It is set to 1 if it is
   used, otherwise 0.  When this extension is used, the Additional Data
   of IGMPv3 and MLDv2 messages would be formatted as follows.  Note
   that this format contains a variable number of TLVs.  It MUST contain
   at least one TLV.


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |            Reserved           |    Total Extension Length     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Extension Type 1       |       Extension Length 1      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Extension Value 1                       |
       .                               .                               .
       .                               .                               .
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Extension Type 2       |       Extension Length 2      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Extension Value 2                       |
       .                               .                               .
       .                               .                               .
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Extension Type n       |       Extension Length n      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Extension Value n                       |
       .                               .                               .
       .                               .                               .
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                        Figure 1: Extension Format

      Reserved: 2 octets.  Reserved.  MUST be set to 0.  MUST be ignored
      when received.

      Total Extension Length: 2 octets.  The remaining length of the
      extension.  This value MUST be equal to ((2 + 2) * n) + Extension
      Length 1 + Extension Length 2 + ... Extension Length n.  That is,
      it is the sum of the lenghts of all the TLVs, including the type
      field (2 octets), and the length field (2 octets) of each TLV.
      The total number of octets used by the extension is the value of



Sivakumar, et al.          Expires May 6, 2021                  [Page 3]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


      this field plus 4 (including the 2 octets Reserved field and the 2
      octets of this field).

      Extension Type: 2 octets.  This identifies a particular Extension
      Type as defined in the IGMP/MLD Extension Type Registry.

      Extension Length: 2 octets.  This specifies the length in octets
      of the following Extension Value field.

      Extension Value: This field contains the value.  The length and
      the contents of this field is according to the specification of
      the Extension Type as defined in the IGMP/MLD Extension Type
      Registry.  The length MUST be as specified in the Extension Length
      field.

   Note that there may be additional data following this extension.  The
   Total Extension Length field would indicate where this extension
   ends, and the additional data starts.  Also, there is a possibility
   that an implementation uses the Additional Data part of IGMP/MLD
   messages, but not according to this extension scheme.  When a message
   is received, it MUST be verified that the Total Extension Length is
   equal to ((2 + 2) * n) + Extension Length 1 + Extension Length 2 +
   ... Extension Length n, where n is the number of TLVs.  Note that the
   value of n is not known ahead of time.  An implementation would walk
   through the TLVs and add the 4 octet overhead and the length of each
   TLV, until the sum is larger or equal to the Total Extension Length,
   or until the end of the IGMP/MLD message, whichever happens first.
   Any additional data after this MUST be ignored, except the data MUST
   be included in checksum computations.  If the sum is not equal to the
   Total Extension Length, then it is assumed that this extension is not
   being used, and this specification does not apply.

3.1.  Multicast Listener Query Extension

   The MLD query format with extension is shown below.  The E-bit is set
   to 1 to indicate that the extension is present.


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 130   |      Code     |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    Maximum Response Code      |           Reserved            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       *                                                               *
       |                                                               |



Sivakumar, et al.          Expires May 6, 2021                  [Page 4]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


       *                       Multicast Address                       *
       |                                                               |
       *                                                               *
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E| Resv|S| QRV |     QQIC      |     Number of Sources (N)     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       *                                                               *
       |                                                               |
       *                       Source Address [1]                      *
       |                                                               |
       *                                                               *
       |                                                               |
       +-                                                             -+
       |                                                               |
       *                                                               *
       |                                                               |
       *                       Source Address [2]                      *
       |                                                               |
       *                                                               *
       |                                                               |
       +-                              .                              -+
       .                               .                               .
       .                               .                               .
       +-                                                             -+
       |                                                               |
       *                                                               *
       |                                                               |
       *                       Source Address [N]                      *
       |                                                               |
       *                                                               *
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       Figure 2: MLD Query Extension

3.2.  Version 2 Multicast Listener Report Extension

   The MLD report format with extension is shown below.  The E-bit is
   set to 1 to indicate that the extension is present.







Sivakumar, et al.          Expires May 6, 2021                  [Page 5]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 143   |    Reserved   |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E|         Reserved            |Nr of Mcast Address Records (M)|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                  Multicast Address Record [1]                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                  Multicast Address Record [2]                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                               .                               |
       .                               .                               .
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                  Multicast Address Record [M]                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                      Figure 3: MLD Report Extension

3.3.  IGMP Membership Query Extension

   The IGMP query format with the extension is shown below.  The E-bit
   is set to 1 to indicate that the extension is present.











Sivakumar, et al.          Expires May 6, 2021                  [Page 6]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 0x11  | Max Resp Code |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                         Group Address                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E| Resv|S| QRV |     QQIC      |     Number of Sources (N)     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Source Address [1]                      |
       +-                                                             -+
       |                       Source Address [2]                      |
       +-                              .                              -+
       .                               .                               .
       .                               .                               .
       +-                                                             -+
       |                       Source Address [N]                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                      Figure 4: IGMP Query Extension

3.4.  IGMP Version 3 Membership Report Extension

   The IGMP report format with the extension is shown below.  The E-bit
   is set to 1 to indicate that the extension is present.






















Sivakumar, et al.          Expires May 6, 2021                  [Page 7]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 0x22  |    Reserved   |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E|         Reserved            |  Number of Group Records (M)  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Group Record [1]                       .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Group Record [2]                       .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                               .                               |
       .                               .                               .
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Group Record [M]                       .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                      Figure 5: IGMP Report Extension

4.  Applicability and backwards compatibility

   IGMP and MLD implementations, host implementations in particular,
   rarely change, and it expected to take a long time for them to
   support this extension mechanism.  Also as new extensions are
   defined, it may take a long time before they are supported.
   Implementations that do not support this extension mechanism will
   simply ignore the extension, provided they are compliant with IGMPv3
   and MLDv2 RFCs, and behave as if the extension is not present.
   Implementations that support this extension MUST behave as if it is
   not present if they support non of the extension types in an IGMP/MLD
   message.  If they support at least one of the types, they will



Sivakumar, et al.          Expires May 6, 2021                  [Page 8]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


   process the supported types according to the respective type
   specifications, and ignore any unsupported types.

   It is possible that a new extension type only applies to queries, or
   only reports, or there may be other specific conditions for when it
   is to be used.  A document defining a new type MUST specify clearly
   under what conditions the new type should be used, including for
   which message types.  It MUST also be considered what the behavior
   should be if a message is not used in the defined manner, e.g., if it
   is present in a query message, when it was only expected to be used
   in reports.

   When defining new types, care must be taken to ensure that nodes that
   support the type can co-exist with nodes that don't, on the same
   subnet.  There could be multiple routers where only some support the
   extension, or multiple hosts where only some support the extension.
   Or a router may support it and none of the hosts, or all hosts may
   support it, but none of the routers.  With multiple types being used,
   it must also be considered that some hosts or routers may only
   support some of the types, and potentially one node might support
   only one type, and another node only another type.

   Documents defining new types MUST have security considerations
   relevant to the new types.  They MUST also in addition to defining
   the behavior of host and routers supporting the new types, consider
   compatibility with hosts and routers on the same subnet that do not
   support the new types.  Further, they MUST consider whether there are
   any dependencies or restrictions on combinations between the new
   types and any pre-existing types.

   The extension mechanism do not support IGMPv1, IGMPv2 and MLDv1.  As
   nodes may send older version message, they would also not be able to
   send messages using this extension.

5.  Security Considerations

   This document extends MLD (resp.  IGMP) message formats.  As such,
   there is no impact on security or changes to the considerations in
   [RFC3810] and [RFC3376].  The respective types defined using this
   extension may impact security and MUST be considered as part of the
   respective specifications.

6.  IANA Considerations

   A new registry called "IGMP/MLD Extension Types" should be created
   with registration procedure "IETF Review" as defined in [RFC8126]
   with this document as a reference.  The registry should be common for
   IGMP and MLD and can perhaps be added to the "Internet Group



Sivakumar, et al.          Expires May 6, 2021                  [Page 9]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


   Management Protocol (IGMP) Type Numbers" section.  The initial
   content of the registry should be as below.

    Type  Length   Name                        Reference
   --------------------------------------------------------------

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3376]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
              Thyagarajan, "Internet Group Management Protocol, Version
              3", RFC 3376, DOI 10.17487/RFC3376, October 2002,
              <https://www.rfc-editor.org/info/rfc3376>.

   [RFC3810]  Vida, R., Ed. and L. Costa, Ed., "Multicast Listener
              Discovery Version 2 (MLDv2) for IPv6", RFC 3810,
              DOI 10.17487/RFC3810, June 2004,
              <https://www.rfc-editor.org/info/rfc3810>.

   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", BCP 26,
              RFC 8126, DOI 10.17487/RFC8126, June 2017,
              <https://www.rfc-editor.org/info/rfc8126>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

7.2.  Informative References

   [I-D.ietf-bier-mld]
              Pfister, P., Wijnands, I., Venaas, S., Wang, C., Zhang,
              Z., and M. Stenberg, "BIER Ingress Multicast Flow Overlay
              using Multicast Listener Discovery Protocols", draft-ietf-
              bier-mld-04 (work in progress), March 2020.

   [RFC5790]  Liu, H., Cao, W., and H. Asaeda, "Lightweight Internet
              Group Management Protocol Version 3 (IGMPv3) and Multicast
              Listener Discovery Version 2 (MLDv2) Protocols", RFC 5790,
              DOI 10.17487/RFC5790, February 2010,
              <https://www.rfc-editor.org/info/rfc5790>.




Sivakumar, et al.          Expires May 6, 2021                 [Page 10]

Internet-Draft       IGMPv3/MLDv2 message extension        November 2020


Authors' Addresses

   Mahesh Sivakumar
   Juniper Networks
   64 Butler St
   Milpitas  CA 95035
   USA

   Email: sivakumar.mahesh@gmail.com


   Stig Venaas
   Cisco Systems, Inc.
   Tasman Drive
   San Jose  CA 95134
   USA

   Email: stig@cisco.com


   Zheng(Sandy) Zhang
   ZTE Corporation
   No. 50 Software Ave, Yuhuatai District
   Nanjing  210000
   China

   Email: zhang.zheng@zte.com.cn


   Hitoshi Asaeda
   National Institute of Information and
       Communications Technology
   4-2-1 Nukui-Kitamachi
   Koganei, Tokyo  184-8795
   Japan

   Email: asaeda@nict.go.jp














Sivakumar, et al.          Expires May 6, 2021                 [Page 11]
