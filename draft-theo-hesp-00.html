<!DOCTYPE html>
<html lang="en" class="Informational">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>HESP - High Efficiency Streaming Protocol</title>
<meta content="Pieter-Jan Speelmans" name="author">
<meta content="
       This document describes a protocol for delivering multimedia data, enabling ultra-low latency and fast channel change over HTTP networks. It specifies the data format of the files and the actions to be taken by the server (sender) and the clients (receivers) of the streams. It describes version 1 of this protocol. 
    " name="description">
<meta content="xml2rfc 3.8.0" name="generator">
<meta content="template" name="keyword">
<meta content="draft-theo-hesp-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.8.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 56.2.0
    six 1.16.0
-->
<link href="/tmp/draft-theo-hesp-00-uwmjrqoy.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">HESP</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Speelmans</td>
<td class="center">Expires 22 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Individual</dd>
<dt class="label-informational">Informational:</dt>
<dd class="informational">draft-theo-hesp-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-21" class="published">21 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-22">22 November 2021</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Speelmans, <span class="editor">Ed.</span>
</div>
<div class="org">THEO Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">HESP - High Efficiency Streaming Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a protocol for delivering multimedia data, enabling ultra-low latency and fast channel change over HTTP networks. It specifies the data format of the files and the actions to be taken by the server (sender) and the clients (receivers) of the streams. It describes version 1 of this protocol.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 22 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may not be modified, and derivative works of it may
            not be created, except to format it for publication as an RFC or
            to translate it into languages other than English.<a href="#section-boilerplate.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview" class="xref">Overview</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-hesp-components" class="xref">HESP components</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-two-complementary-streams" class="xref">Two complementary streams</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-hesp-object-model" class="xref">HESP object model</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-reference-flow" class="xref">Reference flow</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-hesp-manifest" class="xref">HESP Manifest</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-timestamps" class="xref">Timestamps</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-manifest-timestamp-and-medi" class="xref">Manifest Timestamp and Media Timestamp</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-sequence-numbers" class="xref">Sequence Numbers</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-calculating-the-sequence-nu" class="xref">Calculating the Sequence Number of an Initialization Packet</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-manifest-data-types" class="xref">Manifest data types</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-additional-json-data-types" class="xref">Additional JSON data types</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-manifesttype" class="xref">ManifestType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-timesource" class="xref">TimeSource</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="xref">3.2.4</a>.  <a href="#name-scaledvalue" class="xref">ScaledValue</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="xref">3.2.5</a>.  <a href="#name-presentationtype" class="xref">PresentationType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#section-3.2.6" class="xref">3.2.6</a>.  <a href="#name-timebounds" class="xref">TimeBounds</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a href="#section-3.2.7" class="xref">3.2.7</a>.  <a href="#name-audioswitchingsettype" class="xref">AudioSwitchingSetType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.8">
                    <p id="section-toc.1-1.3.2.2.2.8.1"><a href="#section-3.2.8" class="xref">3.2.8</a>.  <a href="#name-switchingsetprotection" class="xref">SwitchingSetProtection</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.9">
                    <p id="section-toc.1-1.3.2.2.2.9.1"><a href="#section-3.2.9" class="xref">3.2.9</a>.  <a href="#name-switchingsetprotectionsyste" class="xref">SwitchingSetProtectionSystem</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.10">
                    <p id="section-toc.1-1.3.2.2.2.10.1"><a href="#section-3.2.10" class="xref">3.2.10</a>. <a href="#name-videoswitchingsettype" class="xref">VideoSwitchingSetType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.11">
                    <p id="section-toc.1-1.3.2.2.2.11.1"><a href="#section-3.2.11" class="xref">3.2.11</a>. <a href="#name-metadataswitchingsettype" class="xref">MetadataSwitchingSetType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.12">
                    <p id="section-toc.1-1.3.2.2.2.12.1"><a href="#section-3.2.12" class="xref">3.2.12</a>. <a href="#name-audiotracktype" class="xref">AudioTrackType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.13">
                    <p id="section-toc.1-1.3.2.2.2.13.1"><a href="#section-3.2.13" class="xref">3.2.13</a>. <a href="#name-videotracktype" class="xref">VideoTrackType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.14">
                    <p id="section-toc.1-1.3.2.2.2.14.1"><a href="#section-3.2.14" class="xref">3.2.14</a>. <a href="#name-resolution" class="xref">Resolution</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.15">
                    <p id="section-toc.1-1.3.2.2.2.15.1"><a href="#section-3.2.15" class="xref">3.2.15</a>. <a href="#name-metadatatracktype" class="xref">MetadataTrackType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.16">
                    <p id="section-toc.1-1.3.2.2.2.16.1"><a href="#section-3.2.16" class="xref">3.2.16</a>. <a href="#name-segmenttype" class="xref">SegmentType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.17">
                    <p id="section-toc.1-1.3.2.2.2.17.1"><a href="#section-3.2.17" class="xref">3.2.17</a>. <a href="#name-presentationeventtype" class="xref">PresentationEventType</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.18">
                    <p id="section-toc.1-1.3.2.2.2.18.1"><a href="#section-3.2.18" class="xref">3.2.18</a>. <a href="#name-presentationeventtimebounds" class="xref">PresentationEventTimeBounds</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-manifest-requests" class="xref">Manifest requests</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-manifest-responses" class="xref">Manifest responses</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-addressing-of-content-reque" class="xref">Addressing of content requests</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-content-request-url-resolut" class="xref">Content request URL resolution</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-requesting-using-an-identif" class="xref">Requesting using an identifier and the content request URL</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-manifest-example" class="xref">Manifest example</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-initialization-stream" class="xref">Initialization Stream</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-initialization-stream-purpo" class="xref">Initialization Stream purpose</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-initialization-packet-forma" class="xref">Initialization Packet format</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-video-initialization-packet" class="xref">Video Initialization Packet</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-audio-initialization-packet" class="xref">Audio Initialization Packet</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-cmaf-header" class="xref">CMAF header</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="xref">4.2.4</a>.  <a href="#name-event-message-information" class="xref">Event message information</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-initialization-stream-addre" class="xref">Initialization Stream addressing</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-initialization-stream-reque" class="xref">Initialization Stream requests</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-initialization-stream-respo" class="xref">Initialization Stream responses</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-continuation-stream" class="xref">Continuation Stream</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-continuation-stream-format" class="xref">Continuation Stream format</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-media-content" class="xref">Media content</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-continuation-segment-availa" class="xref">Continuation Segment availability</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-continuation-stream-address" class="xref">Continuation Stream addressing</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-continuation-stream-urls" class="xref">Continuation Stream URLs</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-continuation-stream-request" class="xref">Continuation Stream requests</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="xref">5.3.3</a>.  <a href="#name-continuation-stream-respons" class="xref">Continuation Stream responses</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-timed-metadata" class="xref">Timed metadata</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-metadata-tracks" class="xref">Metadata Tracks</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-metadata-events" class="xref">Metadata events</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-in-band-events" class="xref">In-band events</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-out-of-band-events" class="xref">Out-of-band events</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-content-protection" class="xref">Content protection</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-common-encryption-support" class="xref">Common encryption support</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-hesp-manifest-2" class="xref">HESP Manifest</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-cmaf-box-structure" class="xref">CMAF box structure</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="xref">7.3.1</a>.  <a href="#name-initialization-stream-2" class="xref">Initialization Stream</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="xref">7.3.2</a>.  <a href="#name-continuation-stream-2" class="xref">Continuation Stream</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-example-usage" class="xref">Example usage</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-manifest" class="xref">Manifest</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#section-a.1.1" class="xref">A.1.1</a>.  <a href="#name-retrieving-the-manifest" class="xref">Retrieving the Manifest</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.2">
                    <p id="section-toc.1-1.13.2.1.2.2.1"><a href="#section-a.1.2" class="xref">A.1.2</a>.  <a href="#name-timing-information" class="xref">Timing information</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.3">
                    <p id="section-toc.1-1.13.2.1.2.3.1"><a href="#section-a.1.3" class="xref">A.1.3</a>.  <a href="#name-content-addressing" class="xref">Content addressing</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-initialization-stream-3" class="xref">Initialization Stream</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#section-a.2.1" class="xref">A.2.1</a>.  <a href="#name-retrieving-initialization-p" class="xref">Retrieving Initialization Packets</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2.2.2">
                    <p id="section-toc.1-1.13.2.2.2.2.1"><a href="#section-a.2.2" class="xref">A.2.2</a>.  <a href="#name-parsing-offset-information" class="xref">Parsing offset information</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-continuation-stream-3" class="xref">Continuation Stream</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.3.2.1">
                    <p id="section-toc.1-1.13.2.3.2.1.1"><a href="#section-a.3.1" class="xref">A.3.1</a>.  <a href="#name-retrieving-continuation-seg" class="xref">Retrieving Continuation Segments</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-cdns" class="xref">CDNs</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-hesp-profiles-using-h264-as" class="xref">HESP Profiles (using H.264 as video codec)</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-c.1" class="xref">C.1</a>.  <a href="#name-maximal-gain-profile" class="xref">Maximal Gain Profile</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-c.2" class="xref">C.2</a>.  <a href="#name-compatibility-profile" class="xref">Compatibility Profile</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.15.2.2.2.1">
                    <p id="section-toc.1-1.15.2.2.2.1.1"><a href="#section-c.2.1" class="xref">C.2.1</a>.  <a href="#name-example" class="xref">Example</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Viewers are more demanding than ever, calling for a streaming
protocol that combines ultra-low latency, fast zapping and cost-
effective scalability.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">HESP is an HTTP based streaming approach that works with standard
contribution feeds from (live) productions, standard encoders, albeit
specifically configured, a HESP compliant packager, regular CDNs and
an HESP compliant player.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">HESP offers sub second latency, near real-time interactivity, fast
startup and channel change times and cost-effective scalability up to
millions of viewers.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The purpose of this document is to facilitate interoperability
between HESP implementations by describing the media transmission
protocol.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document describes version 1 of the protocol.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">This section contains an overview of the HESP protocol and its
building blocks.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="hesp-components">
<section id="section-2.1">
        <h3 id="name-hesp-components">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-hesp-components" class="section-name selfRef">HESP components</a>
        </h3>
<p id="section-2.1-1">HESP follows a regular approach for online video streaming. The
content is ingested and transcoded in the different qualities. Each
quality requires two streams. The encoded streams are packaged by an
HESP packager and made available via an origin server. An HESP
player requests the stream using HTTP requests. A CDN can be used.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-hesp-chain-from-source-to-p"></span><div id="hesp-chain">
<figure id="figure-1">
          <div class="artwork art-text alignCenter" id="section-2.1-2.1">
<pre> _________   ________   __________   ________   _____   ________
|         | |        | |          | |        | |     | |        |
|  Input  |\| xcoder |\| packager |\| origin |\| CDN |\|  HESP  |
| Streams |/|        |/|          |/|        |/|     |/| player |
|_________| |________| |__________| |________| |_____| |________|
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-hesp-chain-from-source-to-p" class="selfRef">HESP chain from source to playback</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="two-complementary-streams">
<section id="section-2.2">
        <h3 id="name-two-complementary-streams">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-two-complementary-streams" class="section-name selfRef">Two complementary streams</a>
        </h3>
<p id="section-2.2-1">HESP is based on using two streams for each track, the Initialization Stream and the Continuation Stream. The encoder MUST ensure that the corresponding media data of both streams are issued with synchronized presentation timestamps. The packager MUST ensure this data remains in sync.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The Initialization Stream consists of Initialization Packets. Initialization Packets MUST be individually addressable. An Initialization Packet MUST contain an independent media sample and the reference to the segment and the position in the segment where the Continuation Stream can start. Since the contained samples are independent, playback can start with any Initialization Packet.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The Continuation Stream can start playback immediately after an Initialization Packet, allowing for very fast channel start and switch times. This puts referencing limitations to the Continuation Stream. When a reference is made from the Initialization Stream to a Continuation Stream, all data needed to render the sample with the subsequent presentation timestamp MUST be available as of the reference offset. The samples in the Initialization Stream and the samples in the Continuation Stream MUST be aligned, that is, the corresponding media samples of both streams MUST have the same PTS and MUST be made available at the same time. The Continuation Stream is addressed using byte range requests. The Continuation Stream SHOULD be published in chunks in order to reduce end-to-end latency.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The player receives the Initialization Packet, initializes the decoder, puts the media data in the decoder buffer, and requests the subsequent media data from the Continuation Stream (using HTTP Range requests, starting by the range offset given by the Initialization Packet.)<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<span id="name-start-of-an-hesp-stream"></span><figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-2.2-5.1">
<pre>time sequence              T1   T2   T3   T4   T5   T6   T7   T8
                         +----+----+----+----+----+----+----+----+
initialization stream    | I1 | I2 | I3 | I4 | I5 | I6 | I7 | I8 |
                         +----+----+----+----+----+----+----+----+
                         +----+----+----+----+----+----+----+----+
continuation stream      | C1 | C2 | C3 | C4 | C5 | C6 | C7 | C8 |
                         +----+----+----+----+----+----+----+----+
                                   +----+----+----+----+----+----+
playback buffer                    | I3 | C4 | C5 | C6 | C7 | C8 |
                                   +----+----+----+----+----+----+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-start-of-an-hesp-stream" class="selfRef">Start of an HESP stream</a>
          </figcaption></figure>
</section>
</div>
<div id="hesp-object-model">
<section id="section-2.3">
        <h3 id="name-hesp-object-model">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-hesp-object-model" class="section-name selfRef">HESP object model</a>
        </h3>
<p id="section-2.3-1">The object model follows the CMAF media object model <span>[<a href="#CMAF" class="xref">CMAF</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">A Track is used to contain media samples (audio or video) or metadata. It consists of a Continuation Stream and (except for metadata Tracks) an Initialization Stream.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">The Initialization Stream consists of Initialization Packets, where each such packet MUST contain a CMAF Header and possibly a CMAF Fragment. Each Initialization Packet MUST be individually addressable through Sequence Numbers. It is further explained in <a href="#cha-initialization" class="xref">Section 4</a>.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">The Continuation Stream consists of Continuation Segments. These Segments MUST consist of CMAF Chunks that can be sent individually to clients. It is further explained in <a href="#cha-continuation" class="xref">Section 5</a>.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">A Switching Set groups together Tracks that contain the same content, but with different encoding parameters (e.g. different resolution, bitrate,...) A client is able to seamlessly switch between Tracks of a Switching Set as a result. If multiple Switching Sets contain differing content but are aligned in their timings (e.g. multiple view perspectives on the same performance or different languages of the same audio), we can consider them Aligned Switching Sets.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6">A Selection Set groups together multiple Switching Sets of the same media type. HESP currently allows 3 Selection Sets: audio, video and metadata Selection Sets.<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<p id="section-2.3-7">A Presentation contains the Selection Sets for a given period of time. Multiple Presentations together form a continuous timeline of media content, even though each Presentation might have different content, encodings, timestamps,... It can be an advertisement, or a part of a show, or the first half of a game,... The Presentation is the lowest granularity inside a Manifest. All Tracks of a Presentation MUST have media data for the full duration of the Presentation.<a href="#section-2.3-7" class="pilcrow">¶</a></p>
<p id="section-2.3-8">The Manifest informs clients of the aforementioned data structure and must be retrieved before any media data. The format of the Manifest is detailed in <a href="#cha-manifest" class="xref">Section 3</a>.<a href="#section-2.3-8" class="pilcrow">¶</a></p>
<p id="section-2.3-9">A new Manifest is not needed to request a new Segment. Segment addressing can happen automatically within a Presentation for an efficient and continuous delivery of the Continuation Stream. A Manifest is only obligated to be updated before the start of a new Presentation. This gives the opportunity for low frequency Manifest updates, though this update rate can be freely configured.<a href="#section-2.3-9" class="pilcrow">¶</a></p>
<p id="section-2.3-10">Since Presentations can be of unknown duration, a different mechanism is used to signal a new Presentation to a client. To that extent, in-band metadata events are introduced in the Continuation Stream. Such an event can signal the client to retrieve a new Manifest, when information about an upcoming Presentation becomes available.<a href="#section-2.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reference-flow">
<section id="section-2.4">
        <h3 id="name-reference-flow">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-reference-flow" class="section-name selfRef">Reference flow</a>
        </h3>
<span id="name-hesp-reference-flow"></span><div id="fig-reference-flow">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-2.4-1.1">
<pre>         +---------+                                   +---------+
         | Player  |                                   | Origin  |
         +---------+                                   +---------+
              |                                             |
 _____________|_____________________________________________|_____
! LOOP   / all presentations                                |     !
!_______/     |                                             |     !
!             |                                             |     !
!             | request Manifest file                       |     !
!             |--------------------------------------------&gt;|     !
!             |                                             |     !
!             |                             Return Manifest |     !
!             |&lt;--------------------------------------------|     !
!             |                                             |     !
!             | parse Manifest                              |     !
!             |---------------                              |     !
!             |              |                              |     !
!             |&lt;--------------                              |     !
!             |                                             |     !
!             |                                             |     !
!             | Request Initialization Packet               |     !
!             |--------------------------------------------&gt;|     !
!             |                                             |     !
!             |               Return Initialization Packet  |     !
!             |&lt;--------------------------------------------|     !
!             |                                             |     !
!             | Initialize decode pipeline                  |     !
!             |---------------------------                  |     !
!             |                          |                  |     !
!             |&lt;--------------------------                  |     !
!             |                                             |     !
!             | Parse position information                  |     !
!             | of the corresponding data                   |     !
!             | in the Continuation Stream                  |     !
!             |--------------------------                   |     !
!             |                          |                  |     !
!             |&lt;-------------------------                   |     !
!             |                                             |     !
!             |                                             |     !
!             | Request Continuation Stream:                |     !
!             | (Segment n) byte range [now, -)             |     !
!             |--------------------------------------------&gt;|     !
!             |                                             |     !
!             |             Return CMAF Fragments until the |     !
!             |                          end of the Segment |     !
!             |&lt;--------------------------------------------|     !
!   __________|_____________________________________________|__   !
!  ! LOOP   / all Segments of the Presentation              |  !  !
!  !_______/  |                                             |  !  !
!  !          |                                             |  !  !
!  !          | Request Continuation Stream:                |  !  !
!  !          | (Segment n+i) without byte range            |  !  !
!  !          |--------------------------------------------&gt;|  !  !
!  !          |                                             |  !  !
!  !          |             Return CMAF Fragments until the |  !  !
!  !          |                          end of the Segment |  !  !
!  !          |&lt;--------------------------------------------|  !  !
!  !          |                                             |  !  !
!  !__________|_____________________________________________|__!  !
!             |                                             |     !
!_____________|_____________________________________________|_____!
              |                                             !
              |                                             !
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-hesp-reference-flow" class="selfRef">HESP reference flow</a>
          </figcaption></figure>
</div>
<p id="section-2.4-2">Though the manifest file is shared, video, audio and metadata (subtitles) media data MUST be distributed separately. They each require separate requests from the client.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cha-manifest">
<section id="section-3">
      <h2 id="name-hesp-manifest">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-hesp-manifest" class="section-name selfRef">HESP Manifest</a>
      </h2>
<p id="section-3-1">The first step for playback of an HESP stream is to fetch a Manifest. It contains information on the available Tracks and how to request content from every Track's Initialization and Continuation Streams.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="timestamps">
<section id="section-3.1">
        <h3 id="name-timestamps">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-timestamps" class="section-name selfRef">Timestamps</a>
        </h3>
<div id="manifest-timestamp-and-media-timestamp">
<section id="section-3.1.1">
          <h4 id="name-manifest-timestamp-and-medi">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-manifest-timestamp-and-medi" class="section-name selfRef">Manifest Timestamp and Media Timestamp</a>
          </h4>
<p id="section-3.1.1-1">A distinction is made between Manifest Timestamps and Media Timestamps in the definitions below. Media Timestamps MUST represent Presentation timestamps as they are given by the media data itself. Manifest Timestamps MUST define those same Media Timestamps, but with an additional offset such that the timestamps of all Tracks of a Presentation are aligned. This offset MUST be given by the Manifest, for each Track or Switching Set.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">For example, consider the first Segment of a Track with Media Timestamps starting at 0 seconds. This Track is part of the second Presentation of an HESP stream. The first Presentation has run for a significant amount of time and the second Presentation follows immediately after the first Presentation ends. In this case, the Manifest Timestamps of the second Presentation must succeed the Manifest Timestamps of the first Presentation. As a result, the Media Timestamps and Manifest Timestamps of the second Presentation now differ. An offset must be given by the Manifest in order to inform clients about this difference between timestamp types for each Track of the second Presentation.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">An example of this distinction is given in <a href="#use-case-timing-information" class="xref">Appendix A.1.2</a>.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manifest-sequence-numbers">
<section id="section-3.1.2">
          <h4 id="name-sequence-numbers">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-sequence-numbers" class="section-name selfRef">Sequence Numbers</a>
          </h4>
<p id="section-3.1.2-1">Each Initialization Packet belonging to a Track is given a Sequence Number. This is a simple identifier used to retrieve specific Initialization Packets by the client. The Sequence Number is a positive integer that MUST be increased by 1 for each subsequent Initialization Packet of the same Track.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="calculating-the-sequence-number-of-an-initialization-packet">
<section id="section-3.1.3">
          <h4 id="name-calculating-the-sequence-nu">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-calculating-the-sequence-nu" class="section-name selfRef">Calculating the Sequence Number of an Initialization Packet</a>
          </h4>
<p id="section-3.1.3-1">To calculate the Sequence Number of a chosen Initialization Packet, the Manifest provides the client multiple values. Each active Presentation MUST contain both its current Manifest Timestamp and for each Track, the Sequence Number of the latest Initialization Packet and the (constant) frame rate.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">It is given that:<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3-3.1">the frame rate MUST be constant for each Track.<a href="#section-3.1.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-3.2">Initialization Packets MUST become available in real time.<a href="#section-3.1.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-3.3">Sequence Numbers MUST be increased by 1 per Initialization Packet.<a href="#section-3.1.3-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-3.4">the Sequence Number and Manifest Timestamp of the latest Initialization Packet for a Track are given by the Manifest.<a href="#section-3.1.3-3.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.1.3-4">As a result, it is possible to derive Sequence Numbers for arbitrary Initialization Packets. By taking the latest Sequence Number of a Track, its associated Manifest Timestamp and the frame rate, it is possible to calculate the number of frames between the given Initialization Packet and the required Initialization Packet in the past or future. This amount can then be subtracted for that latest Sequence Number in order to derive the Sequence Number of the desired Initialization Packet.<a href="#section-3.1.3-4" class="pilcrow">¶</a></p>
<p id="section-3.1.3-5">For example, suppose the latest Sequence Number would be 103 at Manifest Timestamp 00:00:04.120, for a Track with a frame rate of 25 fps. To find the Sequence Number at Manifest Timestamp 00:00:01.360, the difference between both frames should be calculated. This is 2.760 seconds, or 2.760 * 25 = 69 frames. This means that the Sequence Number for the provided Manifest Timestamp is 103 - 69 = 34.<a href="#section-3.1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="manifest-data-types">
<section id="section-3.2">
        <h3 id="name-manifest-data-types">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-manifest-data-types" class="section-name selfRef">Manifest data types</a>
        </h3>
<p id="section-3.2-1">The Manifest MUST be formatted as a JSON file. All data types used in the information below MUST satisfy the constraints made by the JavaScript Object Notation specification <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span>. Some additional data types are introduced on top of the specification.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="additional-json-data-types">
<section id="section-3.2.1">
          <h4 id="name-additional-json-data-types">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-additional-json-data-types" class="section-name selfRef">Additional JSON data types</a>
          </h4>
<div id="integer">
<section id="section-3.2.1.1">
            <h5 id="name-integer">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-integer" class="section-name selfRef">Integer</a>
            </h5>
<p id="section-3.2.1.1-1">An <code>integer</code> is a subset of the <code>number</code> type defined in the JSON specification, limited to integer numbers. Floating point numbers do belong to the <code>number</code> type in JSON, but are not accepted for the <code>integer</code> type. For example, even though the floating point number <code>1.0</code> equals the integer number <code>1</code>, it SHALL NOT be accepted.<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="enumeration">
<section id="section-3.2.1.2">
            <h5 id="name-enumeration">
<a href="#section-3.2.1.2" class="section-number selfRef">3.2.1.2. </a><a href="#name-enumeration" class="section-name selfRef">Enumeration</a>
            </h5>
<p id="section-3.2.1.2-1">An enumeration defines a list of constant strings, where a valid value of this type MUST equal one of these strings. The type is written as <code>Enum(x, y, z)</code>, where x, y and z are the constant strings that are allowed to be used.<a href="#section-3.2.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="datetime">
<section id="section-3.2.1.3">
            <h5 id="name-datetime">
<a href="#section-3.2.1.3" class="section-number selfRef">3.2.1.3. </a><a href="#name-datetime" class="section-name selfRef">DateTime</a>
            </h5>
<p id="section-3.2.1.3-1">A DateTime MUST be formatted as a string in the format defined by ISO 8601 <span>[<a href="#ISO8601" class="xref">ISO8601</a>]</span>:<a href="#section-3.2.1.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2.1.3-2">
<pre>YYYY-MM-DDThh:mm:ss.mmmTZD

where YYYY = four-digit year
      MM = two-digit month
      DD = two-digit day of the month
      hh = two digits of the hour (00 through 23)
      mm = two digits of a minute (00 through 59)
      ss = two digits of a second (00 through 59)
      mmm = three digits of a millisecond (000 through 999)
      TZD = time zone designator (Z or +hh:mm or -hh:mm)
</pre><a href="#section-3.2.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="manifesttype">
<section id="section-3.2.2">
          <h4 id="name-manifesttype">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-manifesttype" class="section-name selfRef">ManifestType</a>
          </h4>
<p id="section-3.2.2-1">This data type represents the root of the Manifest. The structure consists of general playback information and a collection of Presentations.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The table below gives the possible fields. The "Required?" column indicates if a field REQUIRED or OPTIONAL.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
            <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">availabilityDuration</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ScaledValue</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">This value is used to define an interval [live - n, live], where live is the current live point and n is the availability duration. This is the interval that is guaranteed to be available for players during the live stream. For VOD streams, this value MUST be ignored.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>creationDate</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>DateTime</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The timestamp of the moment that this specific Manifest was created by the packager (in local packager time.)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>fallbackPollRate</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>number</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">This value defines the amount of seconds a player SHOULD wait to poll a new Manifest, if it hasn't requested any since retrieving the current Manifest.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>manifestVersion</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Enum("1.0.0")</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The version number of the Manifest.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>presentations</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">PresentationType[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">Contains a list of all Presentations that are currently known.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>streamType</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Enum("live", "vod")</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">This indicates whether the stream is a live stream (<code>live</code>) which does not have a known ending, or a video on demand stream (<code>vod</code>) with a known ending and duration.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>activePresentation</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>string</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier of the currently active Presentation. This value MUST be available if <code>streamType</code> equals <code>live</code>, but MUST be ignored if <code>streamType</code> equals <code>vod</code>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>contentBaseUrl</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>string</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">This value contains the base URL for all content requests relating to this Manifest. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>timeSource</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>TimeSource</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">Optional value, containing the time source of the Manifest. If set, the value contains a reference to a time server with which the packager is synced. This value MUST be ignored if <code>streamType</code> equals <code>vod</code>.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="timesource">
<section id="section-3.2.3">
          <h4 id="name-timesource">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-timesource" class="section-name selfRef">TimeSource</a>
          </h4>
<p id="section-3.2.3-1">A TimeSource is used to sync the packager and player internal clocks, in order to only make requests for data once it is available.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Required</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">scheme</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">A UUID that defines the format of the time server response.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">url</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The URL to be queried for a time server response.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="scaledvalue">
<section id="section-3.2.4">
          <h4 id="name-scaledvalue">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-scaledvalue" class="section-name selfRef">ScaledValue</a>
          </h4>
<p id="section-3.2.4-1">In order to avoid rounding issues introduced through floating point numbers, this structure defines two integers. The total value is calculated by dividing <code>value</code> over <code>scale</code>.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
            <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Required</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">value</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The defined integer value.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">scale</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">If not defined, the scale SHALL equal 1.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="presentationtype">
<section id="section-3.2.5">
          <h4 id="name-presentationtype">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-presentationtype" class="section-name selfRef">PresentationType</a>
          </h4>
<p id="section-3.2.5-1">This is the type definition of a Presentation.<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
            <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Presentation. It MUST be unique over all Presentations of this Manifest. It MUST NOT change over Manifest updates.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">timeBounds</td>
                <td class="text-left" rowspan="1" colspan="1">TimeBounds</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The time boundaries of this Presentation, in manifest time. The start time MUST be announced at least 2 seconds before the Presentation is active. It is possible that the end time is not yet available while the Presentation is active, but it MUST be available at least 2 seconds before the actual end of the Presentation.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">audio</td>
                <td class="text-left" rowspan="1" colspan="1">AudioSwitchingSetType[]</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The audio Selection Set. It contains all audio Switching Sets of this Presentation. If not defined, this value SHALL equal an empty list.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">baseUrl</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The base URL of this Presentation. It is part of the content base URLs for all Switching Sets belonging to this Presentation. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">currentTime</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The most recent composition timestamp of any Track contained by this Presentation at the time this Manifest is created. It should be specified in manifest time, not in media time (as that could have different offsets from Track to Track.) If the Presentation is active, the current time MUST be defined. If the Presentation is not active, this value MUST be ignored.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">events</td>
                <td class="text-left" rowspan="1" colspan="1">PresentationEventType[]</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">List of all currently available Presentation Events related to this Presentation. If not defined, this value SHALL equal an empty list.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">metadata</td>
                <td class="text-left" rowspan="1" colspan="1">MetadataSwitchingSetType[]</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The metadata Selection Set. It contains all metadata Switching Sets of this Presentation. If not defined, this value SHALL equal an empty list.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">video</td>
                <td class="text-left" rowspan="1" colspan="1">VideoSwitchingSetType[]</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The video Selection Set. It contains all video Switching Sets of this Presentation. If not defined, this value SHALL equal an empty list.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="timebounds">
<section id="section-3.2.6">
          <h4 id="name-timebounds">
<a href="#section-3.2.6" class="section-number selfRef">3.2.6. </a><a href="#name-timebounds" class="section-name selfRef">TimeBounds</a>
          </h4>
<p id="section-3.2.6-1">A TimeBounds structure denotes a time interval with a start and end time. It is possible that a start or end time are unknown. The behavior in this case depends on the specific usage of the structure.<a href="#section-3.2.6-1" class="pilcrow">¶</a></p>
<p id="section-3.2.6-2">These boundaries are inclusive at the start time and exclusive at the end time. I.e. if two TimeBound need to be continuous, then the end time of the first one must equal the start time of the second.<a href="#section-3.2.6-2" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
            <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Required</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">startTime</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">This value, when divided by the timescale, denotes the start time in seconds.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">endTime</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">This value, when divided by the timescale, denotes the end time in seconds.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">scale</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">If the timescale is not defined, it SHALL equal 1.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="audioswitchingsettype">
<section id="section-3.2.7">
          <h4 id="name-audioswitchingsettype">
<a href="#section-3.2.7" class="section-number selfRef">3.2.7. </a><a href="#name-audioswitchingsettype" class="section-name selfRef">AudioSwitchingSetType</a>
          </h4>
<p id="section-3.2.7-1">This is the type definition of an audio Switching Set.<a href="#section-3.2.7-1" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
            <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Switching Set. It MUST be unique within the Presentation.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">language</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The language of all audio Tracks of this Switching Set. It MUST be specified here by its ISO 639-2 <span>[<a href="#ISO6392" class="xref">ISO6392</a>]</span> code.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">tracks</td>
                <td class="text-left" rowspan="1" colspan="1">AudioTrackType[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The collection of all Tracks belonging to this audio Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">alignId</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A unique identifier that is set by all Switching Sets that are Aligned Switching Sets with each other.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">baseUrl</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The base URL of this Switching Set. It is part of the content base URLs for all Tracks belonging to this Presentation. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">channels</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The audio channel configuration of all audio Tracks belonging to this Switching Set. It is defined as the total number of audio channels, equal for each Track. This is used for ABR selection by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">codecs</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The definition of the sample type used for all Tracks belonging to this Switching Set. It MUST follow the ISO File Format Name Space as defined by <span>[<a href="#RFC6381" class="xref">RFC6381</a>]</span>. If it is not defined by this Switching Set, then it must be defined on all its Tracks separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">continuationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Continuation Segments belonging to this Track. The pattern MUST include the <code>{segmentId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If this is not defined, then it MUST be defined on all Tracks of this Switching Set separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">frameRate</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The frame rate of all audio Tracks. It defines the amount of audio samples in one frame. If neither the Track nor the Switching Set has this value set, it SHALL equal 1024.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">initializationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Initialization Packets belonging to this Track. The pattern MUST include the <code>{initId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If this is not defined, then it MUST be defined on all Tracks of this Switching Set separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">label</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A human readable name for this Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mediaTimeOffset</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The offset to be added to Manifest Timestamps in order to calculate Media Timestamps contained by Segments of this Switching Set. If neither the Track or the Switching Set has this value set, it SHALL equal 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mimeType</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The MIME type of all content belonging to this Switching Set. If not set, the MIME type SHALL equal <code>audio/mp4</code>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">protection</td>
                <td class="text-left" rowspan="1" colspan="1">SwitchingSet<br>
Protection</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The information related to content protection for all audio Tracks belonging to this Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">sampleRate</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The sample rate (in Hz) of all audio Tracks belonging to this Switching Set. If this is not defined, then every Track MUST set its sample rate separately.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="switchingsetprotection">
<section id="section-3.2.8">
          <h4 id="name-switchingsetprotection">
<a href="#section-3.2.8" class="section-number selfRef">3.2.8. </a><a href="#name-switchingsetprotection" class="section-name selfRef">SwitchingSetProtection</a>
          </h4>
<p id="section-3.2.8-1">The following fields are defined on the SwitchingSetProtection structure:<a href="#section-3.2.8-1" class="pilcrow">¶</a></p>
<table class="center" id="table-7">
            <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Enum("cenc", "cbcs")</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The protection scheme used to encrypt this Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>systems</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">SwitchingSetProtectionSystem[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">Metadata about the DRM systems that can be used to play back this Switching Set. This list MUST contain at least one entry.</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.8-3">More information on content protection can be found in <a href="#cha-content-protection" class="xref">Section 7</a>.<a href="#section-3.2.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="switchingsetprotectionsystem">
<section id="section-3.2.9">
          <h4 id="name-switchingsetprotectionsyste">
<a href="#section-3.2.9" class="section-number selfRef">3.2.9. </a><a href="#name-switchingsetprotectionsyste" class="section-name selfRef">SwitchingSetProtectionSystem</a>
          </h4>
<p id="section-3.2.9-1">The following fields are defined on the SwitchingSetProtectionSystem structure:<a href="#section-3.2.9-1" class="pilcrow">¶</a></p>
<table class="center" id="table-8">
            <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Required</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>pssh</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A Base 64 encoded <code>ProtectionSystemSpecificHeaderBox</code>. If it is not defined in the Manifest, then such a box MUST be available in the Initialization Stream of each Track belonging to this Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>schemeId</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">A UUID code that identifies the protection system used to protect this Switching Set.</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.9-3">Additional attributes MAY be defined by specific protection systems such as license acquisition URLs, authorization related URLs, specific initialization data (a default key ID),... These attributes SHOULD be defined on this SwitchingSetProtectionSystem structure, however they will not be defined here. Depending on the schemeId that is given here, a client SHOULD verify that these additional attributes exist.<a href="#section-3.2.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="videoswitchingsettype">
<section id="section-3.2.10">
          <h4 id="name-videoswitchingsettype">
<a href="#section-3.2.10" class="section-number selfRef">3.2.10. </a><a href="#name-videoswitchingsettype" class="section-name selfRef">VideoSwitchingSetType</a>
          </h4>
<p id="section-3.2.10-1">This is the type definition of a video Switching Set.<a href="#section-3.2.10-1" class="pilcrow">¶</a></p>
<table class="center" id="table-9">
            <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Switching Set. It MUST be unique within the Presentation.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">tracks</td>
                <td class="text-left" rowspan="1" colspan="1">VideoTrackType[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The collection of all Tracks belonging to this video Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">alignId</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A unique identifier that is set by all Switching Sets that are Aligned Switching Sets with each other.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">baseUrl</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The base URL of this Switching Set. It is part of the content base URLs for all Tracks belonging to this Presentation. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">codecs</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The definition of the sample type used for all Tracks belonging to this Switching Set. It needs to follow the ISO File Format Name Space as defined by <span>[<a href="#RFC6381" class="xref">RFC6381</a>]</span>. If it is not defined by this Switching Set, then it must be defined on all its Tracks separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">continuationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Continuation Segments belonging to this Track. The pattern MUST include the <code>{segmentId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If this is not defined, then it MUST be defined on all Tracks of this Switching Set separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">frameRate</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The frame rate of all video Tracks. If this is not defined, then every Track MUST set its frame rate separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">initializationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Initialization Packets belonging to this Track. The pattern MUST include the <code>{initId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If this is not defined, then it MUST be defined on all Tracks of this Switching Set separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">label</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">An optional human readable name for this Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mediaTimeOffset</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The offset to be added to Manifest Timestamps in order to calculate Media Timestamps contained by Segments of this Switching Set. If neither the Track or the Switching Set has this value set, it SHALL equal 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mimeType</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The MIME type of all content belonging to this Switching Set. If not set, the MIME type SHALL equal <code>video/mp4</code>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">protection</td>
                <td class="text-left" rowspan="1" colspan="1">SwitchingSet<br>
Protection</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The information related to content protection for all Tracks belonging to this Switching Set.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="metadataswitchingsettype">
<section id="section-3.2.11">
          <h4 id="name-metadataswitchingsettype">
<a href="#section-3.2.11" class="section-number selfRef">3.2.11. </a><a href="#name-metadataswitchingsettype" class="section-name selfRef">MetadataSwitchingSetType</a>
          </h4>
<p id="section-3.2.11-1">This is the type definition of a metadata Switching Set.<a href="#section-3.2.11-1" class="pilcrow">¶</a></p>
<table class="center" id="table-10">
            <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Switching Set. It MUST be unique within the Presentation.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mimeType</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The MIME type of all content belonging to this Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">tracks</td>
                <td class="text-left" rowspan="1" colspan="1">MetadataTrackType[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The collection of all Tracks belonging to this metadata Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">schemeId</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">An identifier that denotes the type of metadata contained by this metadata Switching Set. Client behavior may differ depending on the vendor specific identifier set here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">alignId</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A unique identifier that is set by all Switching Sets that are Aligned Switching Sets with each other.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">baseUrl</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The base URL of this Switching Set. It is part of the content base URLs for all Tracks belonging to this Presentation. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">continuationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request continuation segments belonging to this media Track. The pattern needs to include the <code>{segmentId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If it is not defined by this Switching Set, then it must be defined on all its Tracks separately.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">label</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">An optional human readable name for this Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">language</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The language of all Tracks of the metadata Switching Set. It MUST be specified here by its ISO 639-2 <span>[<a href="#ISO6392" class="xref">ISO6392</a>]</span> code.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mediaTimeOffset</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The offset to be added to Manifest Timestamps in order to calculate Media Timestamps contained by Segments of this Switching Set. If neither the Track or the Switching Set has this value set, it SHALL equal 0.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="audiotracktype">
<section id="section-3.2.12">
          <h4 id="name-audiotracktype">
<a href="#section-3.2.12" class="section-number selfRef">3.2.12. </a><a href="#name-audiotracktype" class="section-name selfRef">AudioTrackType</a>
          </h4>
<p id="section-3.2.12-1">This is the type definition of an audio Track.<a href="#section-3.2.12-1" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
            <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">bandwidth</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The peak bitrate of this Track. It is denoted in bits per second. The measured bitrates of all Segments of the Track MUST NOT exceed this value. This value is used to aid in ABR decisions by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Track. It MUST be unique within its Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">segments</td>
                <td class="text-left" rowspan="1" colspan="1">SegmentType[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The metadata of the Segments that are contained by this Track at the moment of Manifest creation.<br>
If a segment duration is set in the Track of this segment, then only the active segment MUST be shown here. If a segment duration is not set, then each segment MUST be announced by the Manifest before it is active. More information about Segment availability is given in <a href="#cont-segment-availability" class="xref">Section 5.2</a>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">activeSegment</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier of the segment that is currently active.<br>
If this Track's Presentation was previously active or is currently active, then the most recent Continuation Segment's identifier MUST be shown here. If the Track's Presentation has not yet been active (i.e. no Continuation Segments are yet available), then this value MUST be ignored by the client.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">activeSequenceNumber</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The active Sequence Number of this Track. It MUST denote the Sequence Number of the Initialization Packet of this Track that was most recently published, at the time of creation of this Manifest.<br>
If this Track's Presentation was previously active or is currently active, then the most recent Initialization Packet's Sequence Number MUST be shown here. If the Track's Presentation has not yet been active (i.e. no Initialization Packets are yet available), then this value MUST be ignored by the client.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">averageBandwidth</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The average bitrate of this Track. It is denoted in bits per second.<br>
If given, it is expected that over a duration of 10 minutes, the average bitrate of this Track SHALL be within 5% of the given value. This value is used to aid in ABR decisions by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">baseUrl</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The base URL of this Track. It is part of the content base URLs used to request this Track's Initialization Packets and Continuation Segments. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">channels</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The audio channel configuration of this audio Track, defined as the total number of audio channels in the media data. This is used for ABR selection by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">codecs</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The definition of the sample type used for this Track. It MUST follow the ISO File Format Name Space as defined by <span>[<a href="#RFC6381" class="xref">RFC6381</a>]</span>. If it is not defined by the Switching Set, then it MUST be defined here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">continuationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Continuation Segments belonging to this Track. The pattern needs to include the <code>{segmentId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If the value is not set for the Track's Switching Set, then it MUST be set here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">frameRate</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The frame rate of the audio Track. It defines the amount of audio samples in one frame. If neither the Track nor the Switching Set has this value set, it SHALL equal 1024.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">label</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A human readable name for this Track.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">initializationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Initialization Packets belonging to this media Track. The pattern needs to include the <code>{initId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If the value was not set for the Track's Switching Set, then it MUST be set here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mediaTimeOffset</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The offset to be added to Manifest Timestamps in order to calculate Media Timestamps contained by segments of this Track. If neither the Track or the Switching Set has this value set, it SHALL equal 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">sampleRate</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The sample rate (in Hz) of this audio Track. If it is not defined by the Switching Set, then it MUST be defined here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">segmentDuration</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The duration of all Segments contained by this Track. If this value is set, then every n seconds a new Segment SHOULD be available. More information about the availability is given in <a href="#cont-segment-availability" class="xref">Section 5.2</a>. If not set, then each segment MUST be individually defined by the <code>segments</code> field.</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.12-3">For any attributes that also exist on AudioSwitchingSetType, if both AudioSwitchingSetType and AudioTrackType have a value for this attribute, then only the value set by AudioTrackType must be considered (except for the identifier and label.)<a href="#section-3.2.12-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="videotracktype">
<section id="section-3.2.13">
          <h4 id="name-videotracktype">
<a href="#section-3.2.13" class="section-number selfRef">3.2.13. </a><a href="#name-videotracktype" class="section-name selfRef">VideoTrackType</a>
          </h4>
<p id="section-3.2.13-1">This is the type definition of a video Track.<a href="#section-3.2.13-1" class="pilcrow">¶</a></p>
<table class="center" id="table-12">
            <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">bandwidth</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The peak bitrate of this Track. It is denoted in bits per second. The measured bitrates of all Segments of the Track MUST NOT exceed this value. This value is used to aid in ABR decisions by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Track. It MUST be unique within its Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">resolution</td>
                <td class="text-left" rowspan="1" colspan="1">Resolution</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The resolution of this video Track.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">segments</td>
                <td class="text-left" rowspan="1" colspan="1">SegmentType[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The metadata of the Segments that are contained by this Track at the moment of Manifest creation.<br>
If a segment duration is set in the Track of this segment, then only the active segment MUST be shown here. If a segment duration is not set, then each segment MUST be announced by the Manifest before it is active. More information about Segment availability is given in <a href="#cont-segment-availability" class="xref">Section 5.2</a>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">activeSegment</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier of the segment that is currently active.<br>
If this Track's Presentation was previously active or is currently active, then the most recent Continuation Segment's identifier MUST be shown here. If the Track's Presentation has not yet been active (i.e. no Continuation Segments are yet available), then this value MUST be ignored by the client.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">activeSequenceNumber</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The active Sequence Number of this Track. It MUST denote the Sequence Number of the Initialization Packet of this Track that was most recently published, at the time of creation of this Manifest.<br>
If this Track's Presentation was previously active or is currently active, then the most recent Initialization Packet's Sequence Number MUST be shown here. If the Track's Presentation has not yet been active (i.e. no Initialization Packets are yet available), then this value MUST be ignored by the client.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">averageBandwidth</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The average bitrate of this Track. It is denoted in bits per second.<br>
If given, it is expected that over a duration of 10 minutes, the average bitrate of this Track SHALL be within 5% of the given value. This value is used to aid in ABR decisions by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">baseUrl</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The base URL of this Track. It is part of the content base URLs used to request this Track's Initialization Packets and Continuation Segments. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">codecs</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The definition of the sample type used for this Track. It MUST follow the ISO File Format Name Space as defined by <span>[<a href="#RFC6381" class="xref">RFC6381</a>]</span>. If it is not defined by the Switching Set, then it MUST be defined here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">continuationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Continuation Segments belonging to this Track. The pattern needs to include the <code>{segmentId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If the value is not set for the Track's Switching Set, then it MUST be set here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">frameRate</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The frame rate of this video Track. If it is not defined by the Switching Set, then it must be defined here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">label</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A human readable name for this Track.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">initializationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Initialization Packets belonging to this media Track. The pattern needs to include the <code>{initId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If the value was not set for the Track's Switching Set, then it MUST be set here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mediaTimeOffset</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The offset to be added to Manifest Timestamps in order to calculate Media Timestamps contained by segments of this Track. If neither the Track or the Switching Set has this value set, it SHALL equal 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">segmentDuration</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The duration of all Segments contained by this Track. If this value is set, then every n seconds a new Segment SHOULD be available. More information about the availability is given in <a href="#cont-segment-availability" class="xref">Section 5.2</a>. If not set, then each segment MUST be individually defined by the <code>segments</code> field.</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.13-3">For any attributes that also exist on VideoSwitchingSetType, if both VideoSwitchingSetType and VideoTrackType have a value for this attribute, then only the value set by VideoTrackType must be considered (except for the identifier and label.)<a href="#section-3.2.13-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resolution">
<section id="section-3.2.14">
          <h4 id="name-resolution">
<a href="#section-3.2.14" class="section-number selfRef">3.2.14. </a><a href="#name-resolution" class="section-name selfRef">Resolution</a>
          </h4>
<p id="section-3.2.14-1">A Resolution contains the following elements:<a href="#section-3.2.14-1" class="pilcrow">¶</a></p>
<table class="center" id="table-13">
            <caption><a href="#table-13" class="selfRef">Table 13</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Required</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">width</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The width of the picture.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">height</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The height of the picture.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">sarWidth</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The width of the sample aspect ratio of the resolution. If it is not set, it SHALL equal 1.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">sarHeight</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The height of the sample aspect ratio of the resolution. If it is not set, it SHALL equal 1.</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.14-3">The display aspect ratio belonging to this Resolution can be calculated by using this sample aspect ratio width and height, and the picture width and height as follows:<a href="#section-3.2.14-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2.14-4">
<pre>dar = (darWidth, darHeight)
darWidth = sarWidth * width
darHeight = sarHeight * height
</pre><a href="#section-3.2.14-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="manifest-metadata-track">
<section id="section-3.2.15">
          <h4 id="name-metadatatracktype">
<a href="#section-3.2.15" class="section-number selfRef">3.2.15. </a><a href="#name-metadatatracktype" class="section-name selfRef">MetadataTrackType</a>
          </h4>
<p id="section-3.2.15-1">This is the type definition of a metadata Track.<a href="#section-3.2.15-1" class="pilcrow">¶</a></p>
<table class="center" id="table-14">
            <caption><a href="#table-14" class="selfRef">Table 14</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Track. It MUST be unique within its Switching Set.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">segments</td>
                <td class="text-left" rowspan="1" colspan="1">SegmentType[]</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The metadata of the Segments that are contained by this Track at the moment of Manifest creation.<br>
If a segment duration is set in the Track of this segment, then only the active segment MUST be shown here. If a segment duration is not set, then each segment MUST be announced by the Manifest before it is active. More information about Segment availability is given in <a href="#cont-segment-availability" class="xref">Section 5.2</a>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">activeSegment</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier of the segment that is currently active.<br>
If this Track's Presentation was previously active or is currently active, then the most recent Continuation Segment's identifier MUST be shown here. If the Track's Presentation has not yet been active (i.e. no Continuation Segments are yet available), then this value MUST be ignored by the client.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">averageBandwidth</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The average bitrate of this Track. It is denoted in bits per second.<br>
If given, it is expected that over a duration of 10 minutes, the average bitrate of this Track SHALL be within 5% of the given value. This value is used to aid in ABR decisions by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">bandwidth</td>
                <td class="text-left" rowspan="1" colspan="1">number</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The peak bitrate of this Track. It is denoted in bits per second. The measured bitrates of all Segments of the Track MUST NOT exceed this value. This value is used to aid in ABR decisions by the player.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">baseUrl</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The base URL of this Track. It is part of the content base URLs used to request this Track's Continuation Segments. See <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">codecs</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The definition of the sample type used for this Track. It MUST follow the ISO File Format Name Space as defined by <span>[<a href="#RFC6381" class="xref">RFC6381</a>]</span>. If it is not defined by the Switching Set, then it MUST be defined here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">continuationPattern</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The URL pattern used to request Continuation Segments belonging to this Track. The pattern needs to include the <code>{segmentId}</code> string, see <a href="#manifest-addressing-content" class="xref">Section 3.4</a> for more information. If the value is not set for the Track's Switching Set, then it MUST be set here.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">label</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">A human readable name for this Track.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">mediaTimeOffset</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The offset to be added to Manifest Timestamps in order to calculate Media Timestamps contained by segments of this Track. If neither the Track or the Switching Set has this value set, it SHALL equal 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">segmentDuration</td>
                <td class="text-left" rowspan="1" colspan="1">ScaledValue</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The duration of all Segments contained by this Track. If this value is set, then every n seconds a new Segment SHOULD be available. More information about the availability is given in <a href="#cont-segment-availability" class="xref">Section 5.2</a>. If not set, then each segment MUST be individually defined by the <code>segments</code> field.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="segmenttype">
<section id="section-3.2.16">
          <h4 id="name-segmenttype">
<a href="#section-3.2.16" class="section-number selfRef">3.2.16. </a><a href="#name-segmenttype" class="section-name selfRef">SegmentType</a>
          </h4>
<p id="section-3.2.16-1">This is the type definition of a Segment.<a href="#section-3.2.16-1" class="pilcrow">¶</a></p>
<table class="center" id="table-15">
            <caption><a href="#table-15" class="selfRef">Table 15</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Required</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The unique identifier for this Segment within the Track. This identifier MUST be incremented by 1 for every new Segment of the same Track.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">timeBounds</td>
                <td class="text-left" rowspan="1" colspan="1">TimeBounds</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The time boundaries of this Segment. If this Segment's Track's does not have a constant segment duration, then this value MUST be set and the segment's duration MUST be available at least 2 seconds before the actual end of the segment.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="manifest-presentation-event">
<section id="section-3.2.17">
          <h4 id="name-presentationeventtype">
<a href="#section-3.2.17" class="section-number selfRef">3.2.17. </a><a href="#name-presentationeventtype" class="section-name selfRef">PresentationEventType</a>
          </h4>
<p id="section-3.2.17-1">Timed metadata events can be embedded in the Manifest by using Presentation Events. Each PresentationEventType contains the following elements:<a href="#section-3.2.17-1" class="pilcrow">¶</a></p>
<table class="center" id="table-16">
            <caption><a href="#table-16" class="selfRef">Table 16</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Req?</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">data</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The event payload.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">An unique identifier for this event. It MUST be unique within this Presentation's events.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">timeBounds</td>
                <td class="text-left" rowspan="1" colspan="1">PresentationEventTimeBounds</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">The time boundaries for the event, during which the event SHALL be active.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">encoding</td>
                <td class="text-left" rowspan="1" colspan="1">Enum("identity", "base64", "json")</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The content encoding of the event data. <code>identity</code> signifies that the encoding is plaintext. <code>base64</code> signifies Base64 encoding. <code>json</code> signifies that the payload given by <code>data</code> is a valid JSON document. If this JSON document is not valid, this event MUST be ignored. If not set, the encoding SHALL default to <code>identity</code>.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="presentationeventtimebounds">
<section id="section-3.2.18">
          <h4 id="name-presentationeventtimebounds">
<a href="#section-3.2.18" class="section-number selfRef">3.2.18. </a><a href="#name-presentationeventtimebounds" class="section-name selfRef">PresentationEventTimeBounds</a>
          </h4>
<p id="section-3.2.18-1">The time boundaries of a PresentationEventType are defined as follows:<a href="#section-3.2.18-1" class="pilcrow">¶</a></p>
<table class="center" id="table-17">
            <caption><a href="#table-17" class="selfRef">Table 17</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Required</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">startTimeOffset</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The scaled start time offset of the event, defined in seconds divided by the timescale. The actual start time of the event can be calculated by dividing this value by the scale and adding the resulting value to the start time of the Presentation. It is defined as seconds divided by the timescale. If it is not set, it SHALL equal 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">duration</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The scaled duration of the event, defined in seconds divided by the timescale. If it is not set, it SHALL equal 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">scale</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">The timescale used for these time bounds. If it is not set, it SHALL be equal to 1.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="manifest-requests">
<section id="section-3.3">
        <h3 id="name-manifest-requests">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-manifest-requests" class="section-name selfRef">Manifest requests</a>
        </h3>
<p id="section-3.3-1">The Manifest SHOULD be available through an HTTP GET request. The URL of this Manifest can be personalized by the user.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-manifest-requests-2"></span><table class="center" id="table-18">
          <caption>
<a href="#table-18" class="selfRef">Table 18</a>:
<a href="#name-manifest-requests-2" class="selfRef">Manifest Requests</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Request path</th>
              <th class="text-left" rowspan="1" colspan="1">Method</th>
              <th class="text-left" rowspan="1" colspan="1">Summary</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">(chosen by the stream publisher)</td>
              <td class="text-left" rowspan="1" colspan="1">GET</td>
              <td class="text-left" rowspan="1" colspan="1">Retrieve the stream Manifest.</td>
            </tr>
          </tbody>
        </table>
<div id="manifest-responses">
<section id="section-3.3.1">
          <h4 id="name-manifest-responses">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-manifest-responses" class="section-name selfRef">Manifest responses</a>
          </h4>
<span id="name-manifest-responses-success"></span><table class="center" id="table-19">
            <caption>
<a href="#table-19" class="selfRef">Table 19</a>:
<a href="#name-manifest-responses-success" class="selfRef">Manifest Responses: Success</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Success</th>
                <th class="text-left" rowspan="1" colspan="1"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Status code</td>
                <td class="text-left" rowspan="1" colspan="1">200</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Content Type</td>
                <td class="text-left" rowspan="1" colspan="1">JSON (MIME type MUST equal <code>application/vnd.theo.hesp+json</code>)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Content</td>
                <td class="text-left" rowspan="1" colspan="1">Manifest data</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Description</td>
                <td class="text-left" rowspan="1" colspan="1">When the given Manifest exists on the server, the Manifest data is returned.</td>
              </tr>
            </tbody>
          </table>
<span id="name-manifest-responses-error"></span><table class="center" id="table-20">
            <caption>
<a href="#table-20" class="selfRef">Table 20</a>:
<a href="#name-manifest-responses-error" class="selfRef">Manifest Responses: Error</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Status code</th>
                <th class="text-left" rowspan="1" colspan="1">Content</th>
                <th class="text-left" rowspan="1" colspan="1">Content type</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">404</td>
                <td class="text-left" rowspan="1" colspan="1">-</td>
                <td class="text-left" rowspan="1" colspan="1">-</td>
                <td class="text-left" rowspan="1" colspan="1">The Manifest is not available for the given URL.</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.3.1-3">If an error occurs, the player SHOULD attempt to retry the request. In case of consecutive unsuccessful requests, the media player SHOULD assume the content is unavailable and cease playback.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="manifest-addressing-content">
<section id="section-3.4">
        <h3 id="name-addressing-of-content-reque">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-addressing-of-content-reque" class="section-name selfRef">Addressing of content requests</a>
        </h3>
<p id="section-3.4-1">Several elements of the Manifest contain a <code>baseUrl</code> attribute. These attributes are used to construct the URLs of media content (and metadata.)<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div id="content-request-url-resolution">
<section id="section-3.4.1">
          <h4 id="name-content-request-url-resolut">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-content-request-url-resolut" class="section-name selfRef">Content request URL resolution</a>
          </h4>
<p id="section-3.4.1-1">A content request URL for a certain Track SHALL be constructed by applying relative resolution (as explained in Section 5.2 of RFC 3986 <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>) to each defined <code>baseUrl</code> or <code>contentBaseUrl</code> attribute relating to that Track, starting from the root of the Manifest. The URL of the Manifest SHALL be as a base for the first resolution, after which the target URL of the previous resolution SHALL be used as the base URL of the next resolution.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">This means that the content request URL for a Track's Initialization Stream is constructed as follows (in pseudocode):<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.1-3">
<pre>T = manifestUrl
if isDefined(Manifest.contentBaseUrl):
      T = resolve(Manifest.contentBaseUrl, T)
if isDefined(Presentation.baseUrl):
      T = resolve(Presentation.baseUrl, T)
if isDefined(SwitchingSet.baseUrl):
      T = resolve(SwitchingSet.baseUrl, T)
if isDefined(Track.baseUrl):
      T = resolve(Track.baseUrl, T)
contentRequestURL = resolve(initializationPattern, T)
</pre><a href="#section-3.4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1-4">where <code>initializationPattern</code> is the attribute given by either SwitchingSet or Track (with Track taking precedence if given by both) and <code>resolve(R, B)</code> is relative resolution, where R is a URI reference and B is a base URI.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<p id="section-3.4.1-5">The content request URL for the Track's Continuation Stream can be constructed in the same manner, if the <code>initializationPattern</code> is replaced with the <code>continuationPattern</code>. Both URLs MUST be unique for each unique Track.<a href="#section-3.4.1-5" class="pilcrow">¶</a></p>
<p id="section-3.4.1-6">An example of content addressing is given in <a href="#use-case-content-addressing" class="xref">Appendix A.1.3</a>.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requesting-using-an-identifier-and-the-content-request-url">
<section id="section-3.4.2">
          <h4 id="name-requesting-using-an-identif">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-requesting-using-an-identif" class="section-name selfRef">Requesting using an identifier and the content request URL</a>
          </h4>
<p id="section-3.4.2-1">The content request URL MUST include the <code>{initId}</code> pattern for Initialization Stream URLs and the <code>{segmentId}</code> pattern for Continuation Stream URLs. These patterns are replaced in the actual content requests: <code>{initId}</code> is replaced with the requested Sequence Number of the Initialization Stream and <code>{segmentId}</code> is replaced with the requested segment identifier of the Continuation Stream.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">In order to add leading zeros to the identifier, the following can be added to the patterns <code>initId</code> and <code>segmentId</code>: <code>:0(n)d</code> where <code>(n)</code> is the minimal amount of characters the resulting identifier has (if the identifier is already longer, it will not be altered.)<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
<p id="section-3.4.2-3">For example, for a continuation segment with identifier 100, a following content request URL <code>https://www.example.com/s-1/content-{segmentId:06d}.mp4</code> will resolve to <code>https://www.example.com/s-1/content-000100.mp4</code>. While the content request URL <code>https://www.example.com/s-1/content-{segmentId:02d}.mp4</code> resolves to <code>https://www.example.com/s-1/content-100.mp4</code><a href="#section-3.4.2-3" class="pilcrow">¶</a></p>
<p id="section-3.4.2-4">Further details about these requests are given in <a href="#cha-initialization" class="xref">Section 4</a> and <a href="#cha-continuation" class="xref">Section 5</a>.<a href="#section-3.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="manifest-example">
<section id="section-3.5">
        <h3 id="name-manifest-example">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-manifest-example" class="section-name selfRef">Manifest example</a>
        </h3>
<p id="section-3.5-1">A full Manifest example, together with information on content addressing and timing information is given by <a href="#use-case-manifest" class="xref">Appendix A.1</a>.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cha-initialization">
<section id="section-4">
      <h2 id="name-initialization-stream">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-initialization-stream" class="section-name selfRef">Initialization Stream</a>
      </h2>
<p id="section-4-1">The player uses the information in the HESP Manifest to fetch an Initialization Packet.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="initialization-stream-purpose">
<section id="section-4.1">
        <h3 id="name-initialization-stream-purpo">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-initialization-stream-purpo" class="section-name selfRef">Initialization Stream purpose</a>
        </h3>
<p id="section-4.1-1">The Initialization Stream is a stream containing only independent samples. This stream is not regularly used by a single client, nor completely streamed. The purpose of the Initialization Stream is to make available, upon request of the client, the most recent independent frame, packaged in an Initialization Packet, so that decoding can start at a certain position, for example to start playback at the live edge, seek to a specific point in time, or switch to an alternative Track.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Additionally, the Initialization Packet contains information on the position of the following frame in the Continuation Stream, in order to achieve regular media playback.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initialization-packet-format">
<section id="section-4.2">
        <h3 id="name-initialization-packet-forma">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-initialization-packet-forma" class="section-name selfRef">Initialization Packet format</a>
        </h3>
<div id="video-initialization-packet">
<section id="section-4.2.1">
          <h4 id="name-video-initialization-packet">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-video-initialization-packet" class="section-name selfRef">Video Initialization Packet</a>
          </h4>
<p id="section-4.2.1-1">A video Initialization Packet MUST contain:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">A CMAF header, i.e. all information required to initialize the media decoder, stored in ISO Base Media File Format <span>[<a href="#ISOBMFF" class="xref">ISOBMFF</a>]</span> boxes as specified by CMAF <span>[<a href="#CMAF" class="xref">CMAF</a>]</span>. The minimal required contents are defined in <a href="#initialization-cmaf-header" class="xref">Section 4.2.3</a><a href="#section-4.2.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1.2.1">An additional in-band metadata event containing extra HESP information, included in the aforementioned CMAF segment. The definition of such an event is denoted in <a href="#initialization-event-information" class="xref">Section 4.2.4</a>.<a href="#section-4.2.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">A CMAF segment, i.e. an independent media sample and timing information related to this sample, stored in ISOBMFF <span>[<a href="#ISOBMFF" class="xref">ISOBMFF</a>]</span> boxes as specified by CMAF <span>[<a href="#CMAF" class="xref">CMAF</a>]</span>.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="audio-initialization-packet">
<section id="section-4.2.2">
          <h4 id="name-audio-initialization-packet">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-audio-initialization-packet" class="section-name selfRef">Audio Initialization Packet</a>
          </h4>
<p id="section-4.2.2-1">An audio Initialization Packet MUST contain:<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-2.1">
              <p id="section-4.2.2-2.1.1">A CMAF header, i.e. all information required to initialize the media decoder, stored in ISO Base Media File Format <span>[<a href="#ISOBMFF" class="xref">ISOBMFF</a>]</span> boxes as specified by CMAF <span>[<a href="#CMAF" class="xref">CMAF</a>]</span>. The minimal required contents are defined below.<a href="#section-4.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.2-2.2">
              <p id="section-4.2.2-2.2.1">An additional in-band metadata event containing extra HESP information, included in the aforementioned CMAF segment. The definition of such an event is denoted below.<a href="#section-4.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.2-3">It MAY also contain an independent (audio) media sample, as is defined by the video Initialization Packet. However, it is heavily discouraged as it leads to more storage costs for the provider without any significant advantage.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initialization-cmaf-header">
<section id="section-4.2.3">
          <h4 id="name-cmaf-header">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-cmaf-header" class="section-name selfRef">CMAF header</a>
          </h4>
<p id="section-4.2.3-1">A CMAF header is defined in ISO/IEC 23000-19:2020 <span>[<a href="#CMAF" class="xref">CMAF</a>]</span> as: "a sequence of CMAF constrained ISOBMFF boxes that do not reference any media samples (3.3.15), but are associated with a CMAF track (3.2.1) and necessary for the decoding of its CMAF fragments (3.1.1)." As such, the header MUST NOT contain any samples.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">This means that for the ISO Base Media File Format, at least the following boxes MUST be given:<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-3.1">
              <p id="section-4.2.3-3.1.1">An <code>ftyp</code> box.<a href="#section-4.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.3-3.2">
              <p id="section-4.2.3-3.2.1">A <code>moov</code> box.<a href="#section-4.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.3-3.3">
              <p id="section-4.2.3-3.3.1">One or more tracks and accompanying boxes, though <code>stbl</code> and other related boxes cannot give information about any actual sample entries.<a href="#section-4.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="initialization-event-information">
<section id="section-4.2.4">
          <h4 id="name-event-message-information">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-event-message-information" class="section-name selfRef">Event message information</a>
          </h4>
<p id="section-4.2.4-1">In order to pass information about the Continuation Stream, an in-band event in the form of an <code>emsg</code> box must be added to the Initialization Packet. The format of this box is defined at <a href="#metadata-event-init-data" class="xref">Section 6.2.1.1</a>. The <code>message_data</code> field MUST contain the following two values (see <a href="#init-data-json-structure" class="xref">Table 31</a>):<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.4-2.1">
              <p id="section-4.2.4-2.1.1">the Continuation Segment index (<code>index</code>), which defines the index of the Continuation Segment which contains the next media sample.<a href="#section-4.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.4-2.2">
              <p id="section-4.2.4-2.2.1">the Continuation Segment byte offset (<code>offset</code>), which defines the position of the next media sample in the Continuation Segment. It MAY be unset if the next media sample is located at the start of the segment, in which case a byte range request is not needed.<a href="#section-4.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.4-3">The <code>message_data</code> field of the <code>emsg</code> box could for example look like this:<a href="#section-4.2.4-3" class="pilcrow">¶</a></p>
<p id="section-4.2.4-4"><code>{"index":1,"offset":1234}</code><a href="#section-4.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="initialization-stream-addressing">
<section id="section-4.3">
        <h3 id="name-initialization-stream-addre">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-initialization-stream-addre" class="section-name selfRef">Initialization Stream addressing</a>
        </h3>
<p id="section-4.3-1"><a href="#manifest-addressing-content" class="xref">Section 3.4</a> defines how to create the correct URLs and how to request Initialization Packets. The request content URL is used together with a desired Sequence Number in order to retrieve an Initialization Packet.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Additionally, <code>{initId}</code> can also be replaced with the string <code>now</code>. If this URL is requested, the most recently available Initialization Packet MUST be returned.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div id="initialization-stream-requests">
<section id="section-4.3.1">
          <h4 id="name-initialization-stream-reque">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-initialization-stream-reque" class="section-name selfRef">Initialization Stream requests</a>
          </h4>
<p id="section-4.3.1-1">Initialization Packets MUST be available through a basic GET request. They MUST be able to be retrieved through two methods:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<span id="name-initialization-stream-reques"></span><table class="center" id="table-21">
            <caption>
<a href="#table-21" class="selfRef">Table 21</a>:
<a href="#name-initialization-stream-reques" class="selfRef">Initialization Stream requests</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Request path</th>
                <th class="text-left" rowspan="1" colspan="1">Method</th>
                <th class="text-left" rowspan="1" colspan="1">Summary</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Initialization content request URL <br>
                  <code>{initId}</code> is replaced with the string <code>now</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">GET</td>
                <td class="text-left" rowspan="1" colspan="1">Retrieve the most recent Initialization Packet from the given track.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Initialization content request URL <br>
                  <code>{initId}</code> is replaced with a Sequence Number</td>
                <td class="text-left" rowspan="1" colspan="1">GET</td>
                <td class="text-left" rowspan="1" colspan="1">Retrieve the Initialization Packet with the given Sequence Number from the given track.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="initialization-stream-responses">
<section id="section-4.3.2">
          <h4 id="name-initialization-stream-respo">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-initialization-stream-respo" class="section-name selfRef">Initialization Stream responses</a>
          </h4>
<span id="name-initialization-stream-respon"></span><table class="center" id="table-22">
            <caption>
<a href="#table-22" class="selfRef">Table 22</a>:
<a href="#name-initialization-stream-respon" class="selfRef">Initialization Stream responses: success</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Success</th>
                <th class="text-left" rowspan="1" colspan="1"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Status Code</td>
                <td class="text-left" rowspan="1" colspan="1">200</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Content type</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>video/mp4</code> (video) or <code>audio/mp4</code> (audio)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Description</td>
                <td class="text-left" rowspan="1" colspan="1">When the requested Initialization Packet exists on the media server.</td>
              </tr>
            </tbody>
          </table>
<span id="name-initialization-stream-respons"></span><table class="center" id="table-23">
            <caption>
<a href="#table-23" class="selfRef">Table 23</a>:
<a href="#name-initialization-stream-respons" class="selfRef">Initialization Stream responses: error</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Status code</th>
                <th class="text-left" rowspan="1" colspan="1">Content</th>
                <th class="text-left" rowspan="1" colspan="1">Content type</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">404</td>
                <td class="text-left" rowspan="1" colspan="1">-</td>
                <td class="text-left" rowspan="1" colspan="1">-</td>
                <td class="text-left" rowspan="1" colspan="1">The Track does not exist on the media server or the requested Initialization Packet does not exist on the media server.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cha-continuation">
<section id="section-5">
      <h2 id="name-continuation-stream">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-continuation-stream" class="section-name selfRef">Continuation Stream</a>
      </h2>
<p id="section-5-1">The client uses the information given by the Manifest and the Initialization Packet to request the Continuation Stream. This low latency stream is used for the bulk of media playback of HESP. The Continuation Stream is an independently playable CMAF stream.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="continuation-stream-format">
<section id="section-5.1">
        <h3 id="name-continuation-stream-format">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-continuation-stream-format" class="section-name selfRef">Continuation Stream format</a>
        </h3>
<div id="media-content">
<section id="section-5.1.1">
          <h4 id="name-media-content">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-media-content" class="section-name selfRef">Media content</a>
          </h4>
<p id="section-5.1.1-1">The Continuation Stream is packaged as a regular CMAF stream, albeit with some encoding constraints, depending on the chosen profile (see <a href="#app-profiles" class="xref">Appendix C</a>.)<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">Maximum Gain Profile<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-3.1">Samples MUST only contain references to the one sample preceding it.<a href="#section-5.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-3.2">Each CMAF chunk MUST contain at most one sample (for lowest possible latency.)<a href="#section-5.1.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-3.3">Long CMAF Segments (values of multiple minutes are possible.)<a href="#section-5.1.1-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.1-4">Compatibility Profile<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-5.1">Regular sized CMAF Segments (recommendation: between 1 and 30 seconds)<a href="#section-5.1.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-5.2">Chunk sizes range between one sample and one sub GOP<a href="#section-5.1.1-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-5.3">The following GOP structure MUST be followed: I B ... B P B ... B P B ... B P<a href="#section-5.1.1-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-5.4">The number of B frames MAY vary from 0 (same behavior as Maximum Gain Profile) to 4 (recommended maximum)<a href="#section-5.1.1-5.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-5.5">Each sub GOP (B ... B P) MUST only reference one previous frame (allowing injection of keyframes)<a href="#section-5.1.1-5.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="cont-segment-availability">
<section id="section-5.2">
        <h3 id="name-continuation-segment-availa">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-continuation-segment-availa" class="section-name selfRef">Continuation Segment availability</a>
        </h3>
<p id="section-5.2-1">Continuation Segments must together create a continuous stream of media data. There MUST NOT exist gaps in the time boundaries of subsequent Continuation Segments.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">There exist two ways to signal Segment availability. Either the Track has a <code>segmentDuration</code> set in the Manifest, which represents the constant duration of each Segment. In this case, a client can derive on its own when to start requesting a new Segment. A new Segment SHOULD be published every n seconds, where n equals <code>segmentDuration</code>. This new Segment MUST become available within 100 milliseconds from that point. It is not allowed to drift, i.e. if a Segment is only published at n+100ms, then the next segment MUST be available at 2n+100ms at the latest.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The duration of the last Segment of a Track MAY be shorter than this constant <code>segmentDuration</code>. As a new Manifest must be retrieved near the end of a Presentation, a client should be able to start requesting content of the new Presentation in a timely manner, regardless of the length of this last Segment.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The other option is for the Track to specify all its Segments outright in the <code>segments</code> field of the Manifest. As the Manifest does not get regularly retrieved, it is REQUIRED to signal a Manifest update (see <a href="#metadata-event-manifest-update" class="xref">Section 6.2.1.2</a>) at the end of each Segment. It is recommended to only use this option in the "Maximum Gain Profile", as it can otherwise significantly increase the amount of Manifest requests necessary.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="continuation-stream-addressing">
<section id="section-5.3">
        <h3 id="name-continuation-stream-address">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-continuation-stream-address" class="section-name selfRef">Continuation Stream addressing</a>
        </h3>
<p id="section-5.3-1">To start playback of a certain Track, a client MUST request the Continuation Segments of the chosen Track(s) using the information given by (already obtained) the Manifest and Initialization Packet.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">Requests for Content Segments are to be made using HTTP GET requests. The first request, following an Initialization Packet, fetches the Segment indicated by the Initialization Packet. A byte range header should be used to specify the range of data that needs to be requested. This information is also given by the Initialization Packet.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">A client then automatically calculates the URL of the next Segment as indicated in the Manifest and requests the next segment using a regular HTTP GET request.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div id="continuation-stream-urls">
<section id="section-5.3.1">
          <h4 id="name-continuation-stream-urls">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-continuation-stream-urls" class="section-name selfRef">Continuation Stream URLs</a>
          </h4>
<p id="section-5.3.1-1"><a href="#manifest-addressing-content" class="xref">Section 3.4</a> defines how to create the correct URLs and how to request a continuation segment. The request content URL is used together with a desired segment identifier in order to retrieve the segment.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="continuation-stream-requests">
<section id="section-5.3.2">
          <h4 id="name-continuation-stream-request">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-continuation-stream-request" class="section-name selfRef">Continuation Stream requests</a>
          </h4>
<p id="section-5.3.2-1">If retrieved through the metadata given by the Initialization Packet, Continuation Segments must be fetched using a range request. The requested end of the range should be a very large value to ensure the entire Segment is retrieved. If this offset equals 0, the client SHOULD use a non-range request.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<span id="name-continuation-stream-requests"></span><table class="center" id="table-24">
            <caption>
<a href="#table-24" class="selfRef">Table 24</a>:
<a href="#name-continuation-stream-requests" class="selfRef">Continuation Stream requests</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Request path</th>
                <th class="text-left" rowspan="1" colspan="1">Method</th>
                <th class="text-left" rowspan="1" colspan="1">Summary</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Continuation content request URL <br>
                  <code>{segmentId}</code> is replaced with a segment identifier</td>
                <td class="text-left" rowspan="1" colspan="1">GET</td>
                <td class="text-left" rowspan="1" colspan="1">Retrieve the Continuation Segment with the requested identifier from the given track.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="continuation-stream-responses">
<section id="section-5.3.3">
          <h4 id="name-continuation-stream-respons">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-continuation-stream-respons" class="section-name selfRef">Continuation Stream responses</a>
          </h4>
<p id="section-5.3.3-1">A distinction is made between how responses should be returned, depending on the version of the HTTP protocol used.<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<div id="http-1-1-successful-response">
<section id="section-5.3.3.1">
            <h5 id="name-http-11-successful-response">
<a href="#section-5.3.3.1" class="section-number selfRef">5.3.3.1. </a><a href="#name-http-11-successful-response" class="section-name selfRef">HTTP/1.1 successful response</a>
            </h5>
<p id="section-5.3.3.1-1">If a HTTP Range request is sent, then a 206 Partial Content response MUST be returned upon a successful response. The response MUST use Chunked Transfer Coding <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span> to ensure timely delivery of media data.<a href="#section-5.3.3.1-1" class="pilcrow">¶</a></p>
<span id="name-continuation-stream-response"></span><table class="center" id="table-25">
              <caption>
<a href="#table-25" class="selfRef">Table 25</a>:
<a href="#name-continuation-stream-response" class="selfRef">Continuation Stream responses: success (Range header is given)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Success</th>
                  <th class="text-left" rowspan="1" colspan="1"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Status code</td>
                  <td class="text-left" rowspan="1" colspan="1">206</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Content Type</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>video/mp4</code> (video) or <code>audio/mp4</code> (audio) or any type (metadata)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Transfer Encoding</td>
                  <td class="text-left" rowspan="1" colspan="1">chunked</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Description</td>
                  <td class="text-left" rowspan="1" colspan="1">The requested range of Segment data is returned from the server. Depending on the byte range requested, the connection is kept open to retrieve live data.</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.3.3.1-3">For requests without a Range header, a 200 OK response MUST be returned upon success.<a href="#section-5.3.3.1-3" class="pilcrow">¶</a></p>
<span id="name-continuation-stream-responses"></span><table class="center" id="table-26">
              <caption>
<a href="#table-26" class="selfRef">Table 26</a>:
<a href="#name-continuation-stream-responses" class="selfRef">Continuation Stream responses: success (Range header is not given)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Success</th>
                  <th class="text-left" rowspan="1" colspan="1"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Status code</td>
                  <td class="text-left" rowspan="1" colspan="1">200</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Content Type</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>video/mp4</code> (video) or <code>audio/mp4</code> (audio) or any type (metadata)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Transfer Encoding</td>
                  <td class="text-left" rowspan="1" colspan="1">chunked</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Description</td>
                  <td class="text-left" rowspan="1" colspan="1">The Segment data is returned from the server. Depending on the availability of the Segment, the connection is kept open to retrieve live data.</td>
                </tr>
              </tbody>
            </table>
</section>
</div>
<div id="http-2-successful-response">
<section id="section-5.3.3.2">
            <h5 id="name-http-2-successful-response">
<a href="#section-5.3.3.2" class="section-number selfRef">5.3.3.2. </a><a href="#name-http-2-successful-response" class="section-name selfRef">HTTP/2 successful response</a>
            </h5>
<p id="section-5.3.3.2-1">HTTP/2 uses frame based transmission and cannot not use Chunked Transfer Coding. As such, this header is not given here.<a href="#section-5.3.3.2-1" class="pilcrow">¶</a></p>
<span id="name-continuation-stream-responses-"></span><table class="center" id="table-27">
              <caption>
<a href="#table-27" class="selfRef">Table 27</a>:
<a href="#name-continuation-stream-responses-" class="selfRef">Continuation Stream responses: success (Range header is given)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Success</th>
                  <th class="text-left" rowspan="1" colspan="1"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Status code</td>
                  <td class="text-left" rowspan="1" colspan="1">206</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Content Type</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>video/mp4</code> (video) or <code>audio/mp4</code> (audio) or any type (metadata)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Description</td>
                  <td class="text-left" rowspan="1" colspan="1">The requested range of Segment data is returned from the server. Depending on the byte range requested, the connection is kept open to retrieve live data.</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.3.3.2-3">For requests without a Range header, a 200 OK response MUST be returned upon success.<a href="#section-5.3.3.2-3" class="pilcrow">¶</a></p>
<span id="name-continuation-stream-responses-s"></span><table class="center" id="table-28">
              <caption>
<a href="#table-28" class="selfRef">Table 28</a>:
<a href="#name-continuation-stream-responses-s" class="selfRef">Continuation Stream responses: success (Range header is not given)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Success</th>
                  <th class="text-left" rowspan="1" colspan="1"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Status code</td>
                  <td class="text-left" rowspan="1" colspan="1">200</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Content Type</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>video/mp4</code> (video) or <code>audio/mp4</code> (audio) or any type (metadata)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Description</td>
                  <td class="text-left" rowspan="1" colspan="1">The Segment data is returned from the server. Depending on the availability of the Segment, the connection is kept open to retrieve live data.</td>
                </tr>
              </tbody>
            </table>
</section>
</div>
<div id="response-errors">
<section id="section-5.3.3.3">
            <h5 id="name-response-errors">
<a href="#section-5.3.3.3" class="section-number selfRef">5.3.3.3. </a><a href="#name-response-errors" class="section-name selfRef">Response errors</a>
            </h5>
<span id="name-continuation-stream-responses-e"></span><table class="center" id="table-29">
              <caption>
<a href="#table-29" class="selfRef">Table 29</a>:
<a href="#name-continuation-stream-responses-e" class="selfRef">Continuation Stream responses: error</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Status code</th>
                  <th class="text-left" rowspan="1" colspan="1">Content</th>
                  <th class="text-left" rowspan="1" colspan="1">Content type</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">404</td>
                  <td class="text-left" rowspan="1" colspan="1">-</td>
                  <td class="text-left" rowspan="1" colspan="1">-</td>
                  <td class="text-left" rowspan="1" colspan="1">The Track does not exist on the media server or the requested Segment does not exist on the media server.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">416</td>
                  <td class="text-left" rowspan="1" colspan="1">-</td>
                  <td class="text-left" rowspan="1" colspan="1">-</td>
                  <td class="text-left" rowspan="1" colspan="1">The requested byte range could not be fulfilled.</td>
                </tr>
              </tbody>
            </table>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="timed-metadata">
<section id="section-6">
      <h2 id="name-timed-metadata">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-timed-metadata" class="section-name selfRef">Timed metadata</a>
      </h2>
<p id="section-6-1">HESP has support for timed metadata through two methods: metadata Tracks for continuous, often segmented metadata and metadata events for sporadic metadata updates.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="metadata-tracks">
<section id="section-6.1">
        <h3 id="name-metadata-tracks">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-metadata-tracks" class="section-name selfRef">Metadata Tracks</a>
        </h3>
<p id="section-6.1-1">Metadata Tracks function similarly to media Tracks, however without the need for an Initialization Stream. The attributes for metadata Tracks in the Manifest can be found at <a href="#manifest-metadata-track" class="xref">Section 3.2.15</a>. The addressing happens similarly to the addressing of Continuation segments:
a <code>continuationPattern</code> is given for each metadata Track, either directly set on the Track or on the Switching Set of the Track. Each metadata Segment contains a numerical identifier that increments by one for each new Segment of the Track. This identifier together with the addressing pattern creates the URL used to retrieve the contents of the Segment.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The Manifest contains the duration of each metadata Segment, either stated individually per Segment, or through the <code>segmentDuration</code> attribute set on the metadata Track. It is possible that chunked encoding is used here to ensure that the contents are delivered as soon as possible, but this is not a requirement. This can be useful for e.g. subtitles alongside live content.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata-events">
<section id="section-6.2">
        <h3 id="name-metadata-events">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-metadata-events" class="section-name selfRef">Metadata events</a>
        </h3>
<p id="section-6.2-1">Metadata events can be used to signal information that does not become available in regular intervals. These events can either be transmitted in-band, where it MUST be added to the video or audio Continuation Streams, or out-of-band, in which case details about the metadata event MUST be available in the Manifest.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="in-band-events">
<section id="section-6.2.1">
          <h4 id="name-in-band-events">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-in-band-events" class="section-name selfRef">In-band events</a>
          </h4>
<p id="section-6.2.1-1">In order to deliver events in-band, root level Event Message (<code>emsg</code>) boxes MUST be added to ongoing media Continuation Streams. The definition of an <code>emsg</code> box can be found in the CMAF <span>[<a href="#CMAF" class="xref">CMAF</a>]</span> specification.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">These boxes should be appended to each Track of a Presentation in order to ensure all viewers can receive such an event. It is recommended to use out-of-band events if the included data is significantly large.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">The HESP specification defines a few in-band events that it leverages for client initialization and for Manifest updates. The structure of these events is given below.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<div id="metadata-event-init-data">
<section id="section-6.2.1.1">
            <h5 id="name-initialization-data">
<a href="#section-6.2.1.1" class="section-number selfRef">6.2.1.1. </a><a href="#name-initialization-data" class="section-name selfRef">Initialization data</a>
            </h5>
<p id="section-6.2.1.1-1">This event is appended to each Initialization Packet in order for the client to request the correct Continuation Segments. It is an 'emsg' box with the following REQUIRED values:<a href="#section-6.2.1.1-1" class="pilcrow">¶</a></p>
<span id="name-emsg-box-containing-an-init"></span><table class="center" id="table-30">
              <caption>
<a href="#table-30" class="selfRef">Table 30</a>:
<a href="#name-emsg-box-containing-an-init" class="selfRef"><code>emsg</code> box containing an initialization data event</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>version</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>scheme_id_uri</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">"urn:theo:hesp:2020"</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>value</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">"initdata"</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>timescale</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">MUST match the timescale of the Initialization Packet in case of video or MUST equal 1 otherwise.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>presentation_time_delta</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>event_duration</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">MUST match the duration of the Initialization Packet in case of video or MUST equal 0 otherwise.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>id</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">can be freely set (and MUST be ignored by the player)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>message_data</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">MUST contain the data defined by <a href="#init-data-json-structure" class="xref">Table 31</a>, formatted as JSON</td>
                </tr>
              </tbody>
            </table>
<span id="name-message_data-contents-of-an"></span><div id="init-data-json-structure">
<table class="center" id="table-31">
              <caption>
<a href="#table-31" class="selfRef">Table 31</a>:
<a href="#name-message_data-contents-of-an" class="selfRef"><code>message_data</code> contents of an initialization data event</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                  <th class="text-left" rowspan="1" colspan="1">Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Required</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">index</td>
                  <td class="text-left" rowspan="1" colspan="1">integer</td>
                  <td class="text-left" rowspan="1" colspan="1">Y</td>
                  <td class="text-left" rowspan="1" colspan="1">The Continuation Segment index (see <a href="#initialization-event-information" class="xref">Section 4.2.4</a>.)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">offset</td>
                  <td class="text-left" rowspan="1" colspan="1">integer</td>
                  <td class="text-left" rowspan="1" colspan="1">N</td>
                  <td class="text-left" rowspan="1" colspan="1">The Continuation Segment byte offset (see <a href="#initialization-event-information" class="xref">Section 4.2.4</a>), it SHALL be 0 if not given here.</td>
                </tr>
              </tbody>
            </table>
</div>
</section>
</div>
<div id="metadata-event-manifest-update">
<section id="section-6.2.1.2">
            <h5 id="name-manifest-update">
<a href="#section-6.2.1.2" class="section-number selfRef">6.2.1.2. </a><a href="#name-manifest-update" class="section-name selfRef">Manifest update</a>
            </h5>
<p id="section-6.2.1.2-1">This event is used to signal the client that a new Manifest must be retrieved. This can occur for a multitude of reasons, such as before a Presentation change, availability of new out-of-band metadata,... It is an <code>emsg</code> box with the following REQUIRED values:<a href="#section-6.2.1.2-1" class="pilcrow">¶</a></p>
<span id="name-emsg-box-containing-a-manif"></span><table class="center" id="table-32">
              <caption>
<a href="#table-32" class="selfRef">Table 32</a>:
<a href="#name-emsg-box-containing-a-manif" class="selfRef"><code>emsg</code> box containing a Manifest update event</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>version</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>scheme_id_uri</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">"urn:theo:hesp:2020"</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>value</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">"manifestupdate"</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>timescale</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>presentation_time_delta</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>event_duration</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>id</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">MAY be freely set (and MUST be ignored by the player)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>message_data</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">MUST contain the data defined by <a href="#manifest-update-json-structure" class="xref">Table 33</a>, formatted as JSON</td>
                </tr>
              </tbody>
            </table>
<span id="name-message_data-contents-of-a-"></span><div id="manifest-update-json-structure">
<table class="center" id="table-33">
              <caption>
<a href="#table-33" class="selfRef">Table 33</a>:
<a href="#name-message_data-contents-of-a-" class="selfRef"><code>message_data</code> contents of a Manifest data event</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                  <th class="text-left" rowspan="1" colspan="1">Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Required</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">url</td>
                  <td class="text-left" rowspan="1" colspan="1">string</td>
                  <td class="text-left" rowspan="1" colspan="1">N</td>
                  <td class="text-left" rowspan="1" colspan="1">the URL of an alternative location of the Manifest</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-6.2.1.2-4">If the event contains a URL, then this Manifest request MUST be made to this address. Further Manifest requests do not have this requirement.<a href="#section-6.2.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="out-of-band-events">
<section id="section-6.2.2">
          <h4 id="name-out-of-band-events">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-out-of-band-events" class="section-name selfRef">Out-of-band events</a>
          </h4>
<p id="section-6.2.2-1">Out-of-band events can be added to the Manifest through Presentation Events. The definition of a Presentation Event is given in <a href="#manifest-presentation-event" class="xref">Section 3.2.17</a>. The contents of the event data are not predefined. It is possible to include arbitrary data as Base64 encoded data and plaintext data can be included as is. If needed, the data can simply be an URL that needs to be resolved separately, but this is up to the publisher of this data.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cha-content-protection">
<section id="section-7">
      <h2 id="name-content-protection">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-content-protection" class="section-name selfRef">Content protection</a>
      </h2>
<p id="section-7-1">HESP has support for content protection. It allows DRM systems to be implemented through the common encryption standard.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="common-encryption-support">
<section id="section-7.1">
        <h3 id="name-common-encryption-support">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-common-encryption-support" class="section-name selfRef">Common encryption support</a>
        </h3>
<p id="section-7.1-1">As HESP has the requirement for media to be structured as ISOBMFF <span>[<a href="#ISOBMFF" class="xref">ISOBMFF</a>]</span>, common encryption <span>[<a href="#CENC" class="xref">CENC</a>]</span> is to be used to encrypt that media content.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Common encryption specifies 4 protection schemes that may be used: <code>cenc</code>, <code>cbc1</code>, <code>cens</code> and <code>cbcs</code>. For HESP, either the AES-CBC subsample pattern encryption scheme (<code>cbcs</code>) or the AES-CTR full sample pattern encryption scheme (<code>cenc</code>) MUST be used.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hesp-manifest">
<section id="section-7.2">
        <h3 id="name-hesp-manifest-2">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-hesp-manifest-2" class="section-name selfRef">HESP Manifest</a>
        </h3>
<p id="section-7.2-1">The HESP Manifest has a <code>SwitchingSetProtection</code> structure to set up common encryption for audio and video Switching Sets. The definition of this structure can be found in Chapter 3. As a result of this being set on a Switching Set level:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">all Tracks belonging to such a Switching Set MUST be encrypted with the same content key. Aligned Switching Sets can be used to ensure that a client can still switch through Tracks of different Switching Sets.<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-2.2">audio and video data SHOULD be encrypted with different content keys. This is a recommendation as both often have different encryption strength requirements.<a href="#section-7.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-3">The <code>SwitchingSetProtection</code> structure MAY contain a <code>ProtectionSystemSpecificHeaderBox</code> (<code>pssh</code>), which can also be contained by the Initialization Stream. Note that this box MUST be given by at least one of both options in order for a license request to be made. If both exist for a certain Switching Set, the <code>pssh</code> box from the Initialization Stream MUST be disregarded. This allows for easier altering of license information after a stream has been created or published.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cmaf-box-structure">
<section id="section-7.3">
        <h3 id="name-cmaf-box-structure">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-cmaf-box-structure" class="section-name selfRef">CMAF box structure</a>
        </h3>
<p id="section-7.3-1">The media of a protected stream needs to contain certain ISOBMFF boxes in order to be compliant with CENC (and CMAF). HESP requires the same boxes to be present in media streams. A brief overview of these boxes is given below. More information on this requirement can be found in the CENC <span>[<a href="#CENC" class="xref">CENC</a>]</span> and CMAF <span>[<a href="#CMAF" class="xref">CMAF</a>]</span> specifications.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div id="initialization-stream">
<section id="section-7.3.1">
          <h4 id="name-initialization-stream-2">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-initialization-stream-2" class="section-name selfRef">Initialization Stream</a>
          </h4>
<p id="section-7.3.1-1">Initialization Packets MUST contain the following boxes:<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-2.1">
              <code>TrackEncryptionBox</code> (<code>tenc</code>): This box contains default parameters regarding sample encryption.<a href="#section-7.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.1-2.2">
              <code>SchemeTypeBox</code> (<code>schm</code>): This box identifies the protection scheme. <code>scheme_type</code> MUST be set to <code>cbcs</code> or <code>cenc</code>.<a href="#section-7.3.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.1-2.3">
              <code>ProtectionSystemSpecificHeaderBox</code> (<code>pssh</code>): If the Manifest does not contain a <code>pssh</code> box that applies to this Track, then this box must be included in each Initialization Packet of each Track of the protected Switching Set. If the Manifest does contain a <code>pssh</code> box that applies to this Track, then this box MUST be disregarded.<a href="#section-7.3.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.3.1-3">In order to signal that the Track is encrypted, the stream type MUST equal <code>encv</code> for video Tracks and <code>enca</code> for audio Tracks.<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
<p id="section-7.3.1-4">Additionally, video Initialization Packets contain a sample. If that sample is encrypted, then the same requirements for CMAF fragments of a Continuation Segment also apply here: a <code>senc</code> box MUST be included, <code>pssh</code>, <code>saiz</code> and <code>saio</code> boxes MAY be included. The next section contains more information about these requirements.<a href="#section-7.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="continuation-stream">
<section id="section-7.3.2">
          <h4 id="name-continuation-stream-2">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-continuation-stream-2" class="section-name selfRef">Continuation Stream</a>
          </h4>
<p id="section-7.3.2-1">CMAF fragments of a Continuation Segment MUST contain the following box:<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.2-2.1">
              <code>SampleEncryptionBox</code> (<code>senc</code>): This box is used to store initialization vector data and information on subsample encryption. As each chunk in HESP must currently contain at most one sample, <code>sample_count</code> SHALL always 1.<a href="#section-7.3.2-2.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.3.2-3">The following boxes MAY be included:<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.2-4.1">
              <code>ProtectionSystemSpecificHeaderBox</code> (<code>pssh</code>): If any updates need to be made to the underlying licensing system, a <code>pssh</code> box MAY be included.<a href="#section-7.3.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.2-4.2">
              <code>SampleAuxiliaryInformationSizesBox</code> (<code>saiz</code>): This box is used to store the size of per-sample auxiliary information. It is only REQUIRED if such per-sample information exists.<a href="#section-7.3.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.2-4.3">
              <code>SampleAuxiliaryInformationOffsetsBox</code> (<code>saio</code>): This box is used to store the offsets of per-sample auxiliary information. It is only REQUIRED if such per-sample information exists.<a href="#section-7.3.2-4.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-8">
      <h2 id="name-contributors">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-8-1">Significant contributions to the design of this protocol were made by Egon Okerman, Samie Beheydt and Johan Vounckx.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This memo requests that the following MIME type <span>[<a href="#RFC2046" class="xref">RFC2046</a>]</span> be registered with the IANA:<a href="#section-9-1" class="pilcrow">¶</a></p>
<blockquote id="section-9-2">
        <p id="section-9-2.1">Type name: <code>application</code><a href="#section-9-2.1" class="pilcrow">¶</a></p>
<p id="section-9-2.2">Subtype name: <code>vnd.theo.hesp+json</code><a href="#section-9-2.2" class="pilcrow">¶</a></p>
<p id="section-9-2.3">Required parameters: (none)<a href="#section-9-2.3" class="pilcrow">¶</a></p>
<p id="section-9-2.4">Optional parameters: (none)<a href="#section-9-2.4" class="pilcrow">¶</a></p>
<p id="section-9-2.5">Encoding considerations: encoded as text.<a href="#section-9-2.5" class="pilcrow">¶</a></p>
<p id="section-9-2.6">Security considerations: See <a href="#cha-security-considerations" class="xref">Section 10</a>.<a href="#section-9-2.6" class="pilcrow">¶</a></p>
<p id="section-9-2.7">Compression: this media type does not employ compression.<a href="#section-9-2.7" class="pilcrow">¶</a></p>
<p id="section-9-2.8">Interoperability considerations: There are no byte-ordering issues, since files are 7- or 8-bit text. Applications could encounter unrecognized tags, which SHOULD be ignored.<a href="#section-9-2.8" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="cha-security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">Since the protocol uses HTTP to transmit data, the regular HTTP security considerations apply.  See section 15 of RFC 7230 <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Clients SHOULD take care when parsing files received from a server so that non-compliant files are rejected. Clients SHOULD range-check responses to prevent buffer overflows.  See also the Security Considerations section of RFC 3986 <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>. Clients SHOULD load resources identified by URI lazily to avoid contributing to denial-of-service attacks.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">HTTP requests often include session state ("cookies"), which may contain private user data. Implementations MUST follow cookie restriction and expiry rules specified by RFC 6265 <span>[<a href="#RFC6265" class="xref">RFC6265</a>]</span>. See also the Security Considerations section of RFC 6265, and RFC 2964 <span>[<a href="#RFC2964" class="xref">RFC2964</a>]</span>.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">Encryption keys are specified by URI. The delivery of these keys SHOULD be secured by a mechanism such as HTTP over TLS <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> (formerly SSL) in conjunction with a secure realm or a session cookie.<a href="#section-10-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="CENC">[CENC]</dt>
      <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"Information technology - MPEG systems technologies - Part 7: Common encryption in ISO base media file format files"</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.iso.org/standard/68042.html">https://www.iso.org/standard/68042.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CMAF">[CMAF]</dt>
      <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"Information technology - Multimedia application format (MPEG-A) - Part 19: Common media application format (CMAF) for segmented media"</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.iso.org/standard/79106.html">https://www.iso.org/standard/79106.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO6392">[ISO6392]</dt>
      <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"Codes for the representation of names of languages - Part 2: Alpha-3 code"</span>, <time datetime="1998-11" class="refDate">November 1998</time>, <span>&lt;<a href="https://www.iso.org/standard/4767.html">https://www.iso.org/standard/4767.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO8601">[ISO8601]</dt>
      <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"Date and time - Representations for information interchange"</span>, <time datetime="2019-02" class="refDate">February 2019</time>, <span>&lt;<a href="https://www.iso.org/standard/70907.html">https://www.iso.org/standard/70907.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISOBMFF">[ISOBMFF]</dt>
      <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"Information technology - Coding of audio-visual objects - Part 12: ISO base media file format"</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.iso.org/standard/74428.html">https://www.iso.org/standard/74428.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2964">[RFC2964]</dt>
      <dd>
<span class="refAuthor">Moore, K.</span> and <span class="refAuthor">N. Freed</span>, <span class="refTitle">"Use of HTTP State Management"</span>, <span class="seriesInfo">BCP 44</span>, <span class="seriesInfo">RFC 2964</span>, <span class="seriesInfo">DOI 10.17487/RFC2964</span>, <time datetime="2000-10" class="refDate">October 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2964">https://www.rfc-editor.org/info/rfc2964</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[RFC6265]</dt>
      <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6381">[RFC6381]</dt>
      <dd>
<span class="refAuthor">Gellens, R.</span>, <span class="refAuthor">Singer, D.</span>, and <span class="refAuthor">P. Frojdh</span>, <span class="refTitle">"The 'Codecs' and 'Profiles' Parameters for "Bucket" Media Types"</span>, <span class="seriesInfo">RFC 6381</span>, <span class="seriesInfo">DOI 10.17487/RFC6381</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6381">https://www.rfc-editor.org/info/rfc6381</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
      <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
    <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC2046">[RFC2046]</dt>
    <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="example-usage">
<section id="section-appendix.a">
      <h2 id="name-example-usage">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-example-usage" class="section-name selfRef">Example usage</a>
      </h2>
<div id="use-case-manifest">
<section id="section-a.1">
        <h2 id="name-manifest">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-manifest" class="section-name selfRef">Manifest</a>
        </h2>
<p id="section-a.1-1">For the initial step, the client retrieves a Manifest.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<div id="retrieving-the-manifest">
<section id="section-a.1.1">
          <h3 id="name-retrieving-the-manifest">
<a href="#section-a.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-retrieving-the-manifest" class="section-name selfRef">Retrieving the Manifest</a>
          </h3>
<p id="section-a.1.1-1">The URL of the Manifest is given out of band to the client. The client sends out a GET request. In this case, let's suppose the Manifest is available at <code>https://example.com/stream1/manifest.json</code>. The client then makes such a request:<a href="#section-a.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.1-2">
<pre>GET /stream1/manifest.json HTTP/1.1
Host: example.com
Accept: application/vnd.theo.hesp+json
</pre><a href="#section-a.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-a.1.1-3">The server responds with the following headers:<a href="#section-a.1.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.1-4">
<pre>HTTP/1.1 200 OK
Content-Type: application/vnd.theo.hesp+json; charset=utf-8
Content-Length: 6867
Date: Wed, 31 Mar 2021 08:00:00 GMT
</pre><a href="#section-a.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-a.1.1-5">and the following body:<a href="#section-a.1.1-5" class="pilcrow">¶</a></p>
<div id="section-a.1.1-6">
<pre class="sourcecode lang-json">{
   "activePresentation":"1",
   "availabilityDuration":{
      "value":1500
   },
   "creationDate":"2021-03-31T08:00:00.000Z",
   "fallbackPollRate":300,
   "manifestVersion":"1.0.0",
   "streamType":"live",
   "presentations":[
      {
         "id":"0",
         "timeBounds":{
            "startTime":0,
            "endTime":972000000,
            "scale":90000
         },
         "audio":[
            {
               "id":"main-audio",
               "language":"eng",
               "baseUrl":"audio/",
               "channels":2,
               "codecs":"mp4a.40.2",
               "continuationPattern":"content-{segmentId}.mp4",
               "initializationPattern":"init-{initId}.mp4",
               "sampleRate":48000,
               "tracks":[
                  {
                     "id":"96kbps",
                     "activeSegment":1799,
                     "activeSequenceNumber":506249,
                     "averageBandwidth":96000,
                     "bandwidth":96000,
                     "baseUrl":"96k/",
                     "segmentDuration":{
                        "value":540000,
                        "scale":90000
                     },
                     "segments":[
                        {
                           "id":1799,
                           "timeBounds":{
                              "startTime":971460000,
                              "scale":90000
                           }
                        }
                     ]
                  }
               ]
            }
         ],
         "video":[
            {
               "id":"main-video",
               "baseUrl":"video/",
               "frameRate":{
                  "value":25
               },
               "continuationPattern":"content-{segmentId}.mp4",
               "initializationPattern":"init-{initId}.mp4",
               "tracks":[
                  {
                     "id":"720p",
                     "activeSegment":1799,
                     "activeSequenceNumber":269999,
                     "bandwidth":3000000,
                     "baseUrl":"720p/",
                     "codecs":"avc1.4d001f",
                     "resolution":{
                        "width":1280,
                        "height":720
                     },
                     "segmentDuration":{
                        "value":540000,
                        "scale":90000
                     },
                     "segments":[
                        {
                           "id":1799,
                           "timeBounds":{
                              "startTime":971460000,
                              "scale":90000
                           }
                        }
                     ]
                  }
               ]
            }
         ]
      },
      {
         "id":"1",
         "timeBounds":{
            "startTime":972000000,
            "scale":90000
         },
         "currentTime":{
            "value":1080000000,
            "scale":90000
         },
         "baseUrl":"https://otherexample.com/s2/",
         "audio":[
            {
               "id":"main-audio",
               "language":"eng",
               "baseUrl":"audio/",
               "channels":2,
               "codecs":"mp4a.40.2",
               "sampleRate":48000,
               "mediaTimeOffset":{
                  "value":-972000000,
                  "scale":90000
               },
               "tracks":[
                  {
                     "id":"128kbps",
                     "activeSegment":200,
                     "activeSequenceNumber":56250,
                     "averageBandwidth":128000,
                     "bandwidth":128000,
                     "continuationPattern":
                        "128k-content-{segmentId}.mp4",
                     "initializationPattern":
                        "128k-init-{initId}.mp4",
                     "segmentDuration":{
                        "value":540000,
                        "scale":90000
                     },
                     "segments":[
                        {
                           "id":200,
                           "timeBounds":{
                              "startTime":1080000000,
                              "scale":90000
                           }
                        }
                     ]
                  }
               ]
            }
         ],
         "video":[
            {
               "id":"main-video",
               "baseUrl":"video/",
               "frameRate":{
                  "value":25
               },
               "tracks":[
                  {
                     "id":"720p",
                     "activeSegment":200,
                     "activeSequenceNumber":29999,
                     "bandwidth":3000000,
                     "codecs":"avc1.4d001f",
                     "continuationPattern":
                        "720p-content-{segmentId}.mp4",
                     "initializationPattern":
                        "720p-init-{initId}.mp4",
                     "resolution":{
                        "width":1280,
                        "height":720
                     },
                     "segmentDuration":{
                        "value":540000,
                        "scale":90000
                     },
                     "segments":[
                        {
                           "id":200,
                           "timeBounds":{
                              "startTime":1080000000,
                              "scale":90000
                           }
                        }
                     ]
                  },
                  {
                     "id":"1080p",
                     "activeSegment":200,
                     "activeSequenceNumber":29999,
                     "bandwidth":5000000,
                     "codecs":"avc1.4d001f",
                     "continuationPattern":
                        "1080p-content-{segmentId}.mp4",
                     "initializationPattern":
                        "1080p-init-{initId}.mp4",
                     "resolution":{
                        "width":1920,
                        "height":1080
                     },
                     "segmentDuration":{
                        "value":540000,
                        "scale":90000
                     },
                     "segments":[
                        {
                           "id":200,
                           "timeBounds":{
                              "startTime":1080000000,
                              "scale":90000
                           }
                        }
                     ]
                  }
               ]
            }
         ]
      }
   ]
}
</pre><a href="#section-a.1.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="use-case-timing-information">
<section id="section-a.1.2">
          <h3 id="name-timing-information">
<a href="#section-a.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-timing-information" class="section-name selfRef">Timing information</a>
          </h3>
<p id="section-a.1.2-1">In the above Manifest, we have two Presentations:<a href="#section-a.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.1.2-2.1">The first Presentation with ID "0" is not active at the current time, though it was active previously. It contains one audio Track and one video Track.
It is 3 hours long in total and starts at 00:00:00.000 (Manifest Timestamp.) No Track has a mediaTimeOffset defined, so the Manifest Timestamps match the Media Timestamps.<a href="#section-a.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-a.1.2-2.2">The second Presentation with ID "1" is active at the current time. It contains one audio Track and two video Tracks. Its total duration is yet to be defined.
Its start time is 03:00:00.000 in Manifest Time and its current time (at the moment the manifest was retrieved) is 03:20:00.000. All Tracks have the same mediaTimeOffset defined. The Media Timestamps for this Presentation start at 00:00:00.000. That also means that for all the currently active Segments, the media data will contain a starting timestamp of 00:20:00.000.<a href="#section-a.1.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-a.1.2-3">The availabilityDuration of the Manifest is 25 minutes. As only 20 minutes of the second Presentation have elapsed, some Segments of the first Presentation are still available. Therefore, the first Presentation must still be included in the Manifest. Once 5 minutes have passed, the first Presentation can be left out of the Manifest.<a href="#section-a.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-case-content-addressing">
<section id="section-a.1.3">
          <h3 id="name-content-addressing">
<a href="#section-a.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-content-addressing" class="section-name selfRef">Content addressing</a>
          </h3>
<p id="section-a.1.3-1">The client uses the Manifest to derive the content request URLs of each Track.<a href="#section-a.1.3-1" class="pilcrow">¶</a></p>
<p id="section-a.1.3-2">For the audio Track of the first Presentation, the following parts are found:<a href="#section-a.1.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.3-3">
<pre>AudioSwitchingSet.baseUrl = "audio/"
AudioTrack.baseUrl = "96k/"
AudioSwitchingSet.initializationPattern = "init-{initId}.mp4"
AudioSwitchingSet.continuationPattern = "content-{segmentId}.mp4"
</pre><a href="#section-a.1.3-3" class="pilcrow">¶</a>
</div>
<p id="section-a.1.3-4">The Manifest URL (<code>https://example.com/stream1/manifest.json</code>) is used as the base for resolution, then relative resolution is applied to each of the parts above.<a href="#section-a.1.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.3-5">
<pre>T = resolve(AudioSwitchingSet.baseUrl, manifestUrl)
  = "https://example.com/stream1/audio/"
T = resolve(AudioTrack.baseUrl, T)
  = "https://example.com/stream1/audio/96k/"
initBaseUrl = resolve(AudioSwitchingSet.initializationPattern, T)
  = "https://example.com/stream1/audio/96k/init-{initId}.mp4"
contBaseUrl = resolve(AudioSwitchingSet.continuationPattern, T)
  = "https://example.com/stream1/audio/96k/content-{segmentId}.mp4"
</pre><a href="#section-a.1.3-5" class="pilcrow">¶</a>
</div>
<p id="section-a.1.3-6">The final content request URLs are <code>https://example.com/stream1/audio/96k/init-{initId}.mp4</code> and <code>https://example.com/stream1/audio/96k/content-{segmentId}.mp4</code> for the Initialization Stream and Continuation Stream respectively.<a href="#section-a.1.3-6" class="pilcrow">¶</a></p>
<p id="section-a.1.3-7">For the audio Track of the second Presentation, the following parts are found:<a href="#section-a.1.3-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.3-8">
<pre>Presentation.baseUrl = "https://otherexample.com/s2/"
AudioSwitchingSet.baseUrl = "audio/"
AudioTrack.initializationPattern = "128k-init-{initId}.mp4"
AudioTrack.continuationPattern = "128k-content-{segmentId}.mp4"
</pre><a href="#section-a.1.3-8" class="pilcrow">¶</a>
</div>
<p id="section-a.1.3-9">The Manifest URL (<code>https://example.com/stream1/manifest.json</code>) is used as the base for resolution, then relative resolution is applied to each of the parts above.<a href="#section-a.1.3-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.3-10">
<pre>T = resolve(Presentation.baseUrl, manifestUrl)
  = "https://otherexample.com/s2/"
T = resolve(AudioSwitchingSet.baseUrl, T)
  = "https://otherexample.com/s2/audio/"
initBaseUrl = resolve(AudioTrack.initializationPattern, T)
  = "https://otherexample.com/s2/audio/128k-init-{initId}.mp4"
contBaseUrl = resolve(AudioTrack.continuationPattern, T)
  = "https://otherexample.com/s2/audio/128k-content-{segmentId}.mp4"
</pre><a href="#section-a.1.3-10" class="pilcrow">¶</a>
</div>
<p id="section-a.1.3-11">The final content request URLs are <code>https://otherexample.com/s2/audio/128k-init-{initId}.mp4</code> and <code>https://otherexample.com/s2/audio/128k-content-{segmentId}.mp4</code> for the Initialization Stream and Continuation Stream respectively.<a href="#section-a.1.3-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="initialization-stream-1">
<section id="section-a.2">
        <h2 id="name-initialization-stream-3">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-initialization-stream-3" class="section-name selfRef">Initialization Stream</a>
        </h2>
<p id="section-a.2-1">In the second step, the client uses the Manifest to retrieve and then parse an Initialization Packet.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<div id="retrieving-initialization-packets">
<section id="section-a.2.1">
          <h3 id="name-retrieving-initialization-p">
<a href="#section-a.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-retrieving-initialization-p" class="section-name selfRef">Retrieving Initialization Packets</a>
          </h3>
<p id="section-a.2.1-1">The client decides to retrieve the only audio Track of the active Presentation. The URL pattern for the Initialization Stream of this Track is <code>https://otherexample.com/s2/audio/128k-init-{initId}.mp4</code>.<a href="#section-a.2.1-1" class="pilcrow">¶</a></p>
<p id="section-a.2.1-2">The client opts to retrieve the most recent Initialization Packet and sends out a request:<a href="#section-a.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.1-3">
<pre>GET /s2/128k-init-now.mp4 HTTP/1.1
Host: otherexample.com
Accept: */*
</pre><a href="#section-a.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-a.2.1-4">The server responds with the following headers<a href="#section-a.2.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.1-5">
<pre>HTTP/1.1 200 OK
Content-Type: audio/mp4
Content-Length: 742
Date: Wed, 31 Mar 2021 08:00:02 GMT
</pre><a href="#section-a.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-a.2.1-6">and a binary body containing the ISOBMFF media data of the audio Initialization Packet.<a href="#section-a.2.1-6" class="pilcrow">¶</a></p>
<p id="section-a.2.1-7">The client repeats this to retrieve one of the video Tracks.<a href="#section-a.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parsing-offset-information">
<section id="section-a.2.2">
          <h3 id="name-parsing-offset-information">
<a href="#section-a.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-parsing-offset-information" class="section-name selfRef">Parsing offset information</a>
          </h3>
<p id="section-a.2.2-1">The client parses the ISOBMFF boxes in the audio Initialization Packet. Once the <code>emsg</code> box with schemeId <code>urn:theo:hesp:2020</code> and value <code>initdata</code> is found, its <code>message_data</code> field is parsed.<a href="#section-a.2.2-1" class="pilcrow">¶</a></p>
<p id="section-a.2.2-2">In this case, <code>message_data</code> equals <code>{"index":200,"offset":63275}</code>. The following media data for the chosen audio Track is available in the Continuation Segment with ID 200 and at a byte offset of 63275.<a href="#section-a.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="continuation-stream-1">
<section id="section-a.3">
        <h2 id="name-continuation-stream-3">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-continuation-stream-3" class="section-name selfRef">Continuation Stream</a>
        </h2>
<p id="section-a.3-1">In the final step, the client uses the already retrieved information to retrieve Continuation Segments and reaches playback.<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<div id="retrieving-continuation-segments">
<section id="section-a.3.1">
          <h3 id="name-retrieving-continuation-seg">
<a href="#section-a.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-retrieving-continuation-seg" class="section-name selfRef">Retrieving Continuation Segments</a>
          </h3>
<p id="section-a.3.1-1">The client retrieves the Continuation Segment of the chosen audio Track. The URL pattern for the Continuation Stream of this Track is <code>https://otherexample.com/s2/audio/128k-content-{segmentId}.mp4</code>.<a href="#section-a.3.1-1" class="pilcrow">¶</a></p>
<p id="section-a.3.1-2">The client sends out a request for the segment with ID 200, starting at offset 63275:<a href="#section-a.3.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1-3">
<pre>GET /s2/128k-content-200.mp4 HTTP/1.1
Host: otherexample.com
Accept: */*
Range: bytes=63275-9007199254740991
</pre><a href="#section-a.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-a.3.1-4">As discussed in <a href="#continuation-stream-requests" class="xref">Section 5.3.2</a>, a sufficiently large end byte value is chosen to ensure the full range is retrieved.<a href="#section-a.3.1-4" class="pilcrow">¶</a></p>
<p id="section-a.3.1-5">The server responds with the following headers<a href="#section-a.3.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1-6">
<pre>HTTP/1.1 200 OK
Content-Type: audio/mp4
Content-Range: bytes 63275-9007199254740991/9007199254677716
Transfer-Encoding: chunked
Date: Wed, 31 Mar 2021 08:00:03 GMT
</pre><a href="#section-a.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-a.3.1-7">and a (chunked) binary body containing the ISOBMFF media data of the Continuation Segment.<a href="#section-a.3.1-7" class="pilcrow">¶</a></p>
<p id="section-a.3.1-8">The client repeats this for the chosen video Track and uses the retrieved media data to reach playback. The Manifest that was retrieved previously contains sufficient information to retrieve new Continuation Segments from this point on.<a href="#section-a.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cdns">
<section id="section-appendix.b">
      <h2 id="name-cdns">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-cdns" class="section-name selfRef">CDNs</a>
      </h2>
<p id="section-appendix.b-1">A Content Delivery Network (CDN) MAY be used to increase the scalability and cacheability for delivering HESP.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">While the HESP protocol makes use of HTTP/1.1 and delivery should be possible over most HTTP CDNs, care must be taken to ensure that the CDN has all the required features.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<p id="section-appendix.b-3">To correctly handle HESP, the CDN MUST either support HTTP/1.1 with chunked transfer encoding or support HTTP/2. It MUST also support Range Requests as well as the caching of the partial object responses. This ensures that HESP requests and responses pass correctly through the CDN and that responses can be cached for future use.<a href="#section-appendix.b-3" class="pilcrow">¶</a></p>
<p id="section-appendix.b-4">The CDN SHOULD support collapsing multiple HTTP/1.1 Range Requests when they have overlapping byte-ranges into a single request. This ensures that two requests with byte ranges which are partially overlapping only require a single request to the media server for the overlapping part. This reduces the number of concurrent requests arriving on the media server.<a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app-profiles">
<section id="section-appendix.c">
      <h2 id="name-hesp-profiles-using-h264-as">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-hesp-profiles-using-h264-as" class="section-name selfRef">HESP Profiles (using H.264 as video codec)</a>
      </h2>
<p id="section-appendix.c-1">In this annex, we describe two possible profiles for video Tracks of HESP streams. Both profiles place certain requirements on the underlying H.264 encoding of the HESP stream.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<div id="maximal-gain-profile">
<section id="section-c.1">
        <h2 id="name-maximal-gain-profile">
<a href="#section-c.1" class="section-number selfRef">C.1. </a><a href="#name-maximal-gain-profile" class="section-name selfRef">Maximal Gain Profile</a>
        </h2>
<p id="section-c.1-1">The goal of this profile is to allow the stream to reach the lowest latency and zapping times possible using the HESP protocol. In this profile, it should be ensured that an Initialization Packet exists for each frame of the Continuation Stream. As a result, a client can start playback, seek, switch between Tracks,... at any time position of the stream.<a href="#section-c.1-1" class="pilcrow">¶</a></p>
<p id="section-c.1-2">The Initialization Stream for Tracks of the Maximal Gain Profile must satisfy the following requirements:<a href="#section-c.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-c.1-3.1">The frame rate of the Initialization Stream MUST match the Continuation Stream.<a href="#section-c.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-c.1-3.2">Each media sample of the Initialization Stream MUST be independent (i.e. an I frame in H.264) and individually addressable (the latter is currently always true for HESP.)<a href="#section-c.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-c.1-4">The Continuation Stream for Tracks of the Maximal Gain Profile must satisfy the following requirements:<a href="#section-c.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-c.1-5.1">Each media sample of the Continuation Stream MUST be either independent (i.e. an I frame in H.264) or dependent on the media sample directly preceding it in decode order (i.e. a P frame referencing only the previous frame.)<a href="#section-c.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-c.1-5.2">Each CMAF Fragment of the Continuation Segment MUST only contain one media sample.<a href="#section-c.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-c.1-5.3">Each Continuation Segment SHOULD be significantly long (values of multiple minutes are possible and encouraged.)<a href="#section-c.1-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-maximum-gain-profile"></span><figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-c.1-6.1">
<pre>               +----+----+----+----+----+----+----+----+----+----+
time positions | 00 | 01 | 02 | 03 | 04 | 05 | 06 | 07 | 08 | 09 |
               +----+----+----+----+----+----+----+----+----+----+

               +----+----+----+----+----+----+----+----+----+----+
initialization | IDR| IDR| IDR| IDR| IDR| IDR| IDR| IDR| IDR| IDR|
stream         | 00 | 01 | 02 | 03 | 04 | 05 | 06 | 07 | 08 | 09 |
               +----+----+----+----+----+----+----+----+----+----+
               | REF| REF| REF| REF| REF| REF| REF| REF| REF| REF|
               |  a |  b |  c |  d |  e |  f |  g |  h |  i |  j |
               +----+----+----+----+----+----+----+----+----+----+

               +----+----+----+----+----+----+----+----+----+----+
continuation   | I,P| I,P| I,P| I,P| I,P| I,P| I,P| I,P| I,P| I,P|
stream         | 00 | 01 | 02 | 03 | 04 | 05 | 06 | 07 | 08 | 09 |
               +----+----+----+----+----+----+----+----+----+----+
                    |    |    |
                    |    |     \___ position c
                    |    |
                    |     \___ position b
                    |
                     \___ position a
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-maximum-gain-profile" class="selfRef">Maximum Gain Profile</a>
          </figcaption></figure>
</section>
</div>
<div id="compatibility-profile">
<section id="section-c.2">
        <h2 id="name-compatibility-profile">
<a href="#section-c.2" class="section-number selfRef">C.2. </a><a href="#name-compatibility-profile" class="section-name selfRef">Compatibility Profile</a>
        </h2>
<p id="section-c.2-1">The goal of this profile is to allow media data from other HTTP-based adaptive bitrate protocols to be reused. This comes at the cost of some optimizations made by the previous profile. In this profile, it is not possible to start playback at any time position of the stream, as it is not possible for Initialization Packets to refer to every sample of a Continuation Segment.<a href="#section-c.2-1" class="pilcrow">¶</a></p>
<p id="section-c.2-2">The Initialization Stream for Tracks of the Compatibility Profile must satisfy the following requirements:<a href="#section-c.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-c.2-3.1">Each media sample of the Initialization Stream MUST be independent (i.e. an I frame in H.264) and individually addressable (the latter is currently always true for HESP.)<a href="#section-c.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-c.2-3.2">Initialization Packets MUST contain a reference to the subsequent sample in the Continuation Segment, where this subsequent sample MUST be either independent (i.e. an I frame in H.264) or dependent on the media sample directly preceding it in decode order (i.e. a P frame referencing only the previous frame.)
If the subsequent sample does not meet this constraint, then this Initialization Packet MUST NOT be published. Instead, the last valid Initialization Packet MUST be returned if this Sequence Number is queried.<a href="#section-c.2-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-c.2-4">The Continuation Stream for Tracks of the Compatibility Profile must satisfy the following requirements:<a href="#section-c.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-c.2-5.1">Continuation Segments SHOULD NOT exceed a duration of 30 seconds.<a href="#section-c.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-c.2-5.2">Each CMAF Fragment of the Continuation Segment MUST contain at most the amount of media samples of a sub GOP (defined below.)<a href="#section-c.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-c.2-5.3">The following GOP structure must be followed in the underlying H.264 stream: I, B (repeated n times), P, B (repeated n times), P, where n lies between 0 and 4.<a href="#section-c.2-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-c.2-5.4">Each sub GOP (B ... B P) MUST depend on at most one previous frame (allowing for keyframe insertion.)<a href="#section-c.2-5.4" class="pilcrow">¶</a>
</li>
        </ul>
<div id="example">
<section id="section-c.2.1">
          <h3 id="name-example">
<a href="#section-c.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-example" class="section-name selfRef">Example</a>
          </h3>
<p id="section-c.2.1-1"><a href="#fig-sub-gop-ex" class="xref">Figure 5</a> depicts a part of H.264 output of 7 frames, sorted in decode order. The dependencies of each frame are shown with arrows.<a href="#section-c.2.1-1" class="pilcrow">¶</a></p>
<span id="name-continuation-stream-with-su"></span><div id="fig-sub-gop-ex">
<figure id="figure-5">
            <div class="artwork art-text alignCenter" id="section-c.2.1-2.1">
<pre>            ______________________________________
            |                     |       |       |
            V                     |       |       |
+----+  +----+  +----+  +----+  +----+  +----+  +----+
|####|  |%%%%|  |%%%%|  |%%%%|  |@@@@|  |@@@@|  |@@@@|
| I1 |  | P4 |  | B2 |  | B3 |  | P7 |  | B5 |  | B6 |
+----+  +----+  +----+  +----+  +----+  +----+  +----+
    ^     |  ^     |       |        ^      |       |
    |_____|  |     |       |        |______|       |
    |        |     |       |        |              |
    |________|_____|       |        |______________|
    |                      |
    |______________________|
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-continuation-stream-with-su" class="selfRef">Continuation stream with sub GOPs</a>
            </figcaption></figure>
</div>
<div id="sub-gops">
<section id="section-c.2.1.1">
            <h4 id="name-sub-gops">
<a href="#section-c.2.1.1" class="section-number selfRef">C.2.1.1. </a><a href="#name-sub-gops" class="section-name selfRef">Sub GOPs</a>
            </h4>
<p id="section-c.2.1.1-1">A "sub GOP" defines a set of B and P frames that only depend on one
previous frame.<a href="#section-c.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-c.2.1.1-2">In <a href="#fig-sub-gop-ex" class="xref">Figure 5</a>, there are 3 sub GOPs:<a href="#section-c.2.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-c.2.1.1-3.1">sub GOP 1 (<code>####</code>) contains only a single I frame.<a href="#section-c.2.1.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-c.2.1.1-3.2">sub GOP 2 (<code>%%%%</code>) contains a P frame (P4) that only depends on I1, all B frames depend on I1 and P4.<a href="#section-c.2.1.1-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-c.2.1.1-3.3">sub GOP 3 (<code>@@@@</code>) contains a P frame (P7) that only depends on P4, all B frames depend on P7 and P4.<a href="#section-c.2.1.1-3.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="initialization-packets">
<section id="section-c.2.1.2">
            <h4 id="name-initialization-packets">
<a href="#section-c.2.1.2" class="section-number selfRef">C.2.1.2. </a><a href="#name-initialization-packets" class="section-name selfRef">Initialization Packets</a>
            </h4>
<p id="section-c.2.1.2-1">An Initialization Packet can be published if the subsequent media sample of the Continuation Stream depends on at most one previous frame.<a href="#section-c.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-c.2.1.2-2">For <a href="#fig-sub-gop-ex" class="xref">Figure 5</a>, this is the case at the following positions:<a href="#section-c.2.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-c.2.1.2-3.1">position 1: an Initialization Packet can be published. It will contain IDR1 (a keyframe matching the timestamp of I1) and will reference P4, the subsequent media sample of the Continuation Stream that only depends on I1. On the client side, the media data will be decoded with IDR1 inserted at the location of I1.<a href="#section-c.2.1.2-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-c.2.1.2-3.2">position 4: an Initialization Packet can be published. It will contain IDR4 (a keyframe matching the timestamp of P4) and will reference P7, the subsequent media sample of the Continuation Stream that only depends on P4. On the client side, the media data will be decoded with IDR4 inserted at the location of P4.<a href="#section-c.2.1.2-3.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-c.2.1.2-4">A client requesting an Initialization Packet at other time positions must receive the most recent valid Initialization Packet. That means that a request for an Initialization Packet at position 2 in <a href="#fig-sub-gop-ex" class="xref">Figure 5</a> must return the Initialization Packet at position 1.<a href="#section-c.2.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pieter-Jan Speelmans (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">THEO Technologies</span></div>
<div dir="auto" class="left"><span class="locality">Leuven</span></div>
<div dir="auto" class="left"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pieter-jan.speelmans@theoplayer.com" class="email">pieter-jan.speelmans@theoplayer.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
