type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
version = "3"

query_elt = publish_query | withdraw_query | list_query
reply_elt = publish_reply | withdraw_reply | list_reply | error_reply

tag = attribute tag { xsd:token { maxLength="1024" } }

base64 = xsd:base64Binary

uri = attribute uri { xsd:anyURI { maxLength="4096" } }

hash = attribute hash { xsd:string { pattern = "[0-9a-fA-F]+" } }

publish_query = element publish { tag?, uri, hash?, base64 }
publish_reply = element publish { tag?, uri }

withdraw_query = element withdraw { tag?, uri, hash }
withdraw_reply = element withdraw { tag?, uri }

list_query = element list { tag? }
list_reply = element list { tag?, uri, hash }

error_reply = element report_error {
     tag?,
     attribute error_code { error },
     element   error_text { xsd:string { maxLength="512000" }}?,
     element   failed_pdu { query_elt }?
type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
uri="rsync://wombat.example/Alice/60d730635fce156f.cer">
type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
hash="60d730635fce156f"
uri="rsync://wombat.example/Alice/60d730635fce156f.cer">
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
uri="rsync://wombat.example/Alice/60d730635fce156f.cer"/>
type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
hash="60d730635fce156f"
uri="rsync://wombat.example/Alice/60d730635fce156f.cer"/>
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
uri="rsync://wombat.example/Alice/60d730635fce156f.cer"/>
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
error_code="no_object_matching_hash">
hash="60d730635fce156f"
uri="rsync://wombat.example/Alice/60d730635fce156f.cer">
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
error_code="object_already_present"/>
type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
tag="Alice"
uri="rsync://wombat.example/Alice/3bc51062973c458d.cer">
QWxpY2U=
hash="cd9fb1e148ccd844"
tag="Bob"
uri="rsync://wombat.example/Bob/cd9fb1e148ccd844.cer"/>
tag="Carol"
uri="rsync://wombat.example/Carol/b2dd7d8a70567a0e.cer">
Q2Fyb2w=
hash="809a721743350c0c"
tag="Dave"
uri="rsync://wombat.example/Dave/809a721743350c0c.cer"/>
tag="Eve"
uri="rsync://wombat.example/Eve/b9bae658d9657985.cer">
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
tag="Alice"
uri="rsync://wombat.example/Alice/3bc51062973c458d.cer"/>
tag="Bob"
uri="rsync://wombat.example/Bob/cd9fb1e148ccd844.cer"/>
tag="Carol"
uri="rsync://wombat.example/Carol/b2dd7d8a70567a0e.cer"/>
hash="f842c3e1858df8c8"
uri="rsync://wombat.example/Fee/f842c3e1858df8c8.cer"/>
hash="b139ca23414476bb"
uri="rsync://wombat.example/Fie/b139ca23414476bb.cer"/>
hash="1995e9544ba80191"
uri="rsync://wombat.example/Foe/1995e9544ba80191.cer"/>
hash="9c00b310c10a022c"
uri="rsync://wombat.example/Fum/9c00b310c10a022c.cer"/>
tag="Dave"
uri="rsync://wombat.example/Dave/809a721743350c0c.cer"/>
tag="Eve"
uri="rsync://wombat.example/Eve/b9bae658d9657985.cer"/>
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
tag="Alice"
uri="rsync://wombat.example/Alice/3bc51062973c458d.cer"/>
tag="Bob"
uri="rsync://wombat.example/Bob/cd9fb1e148ccd844.cer"/>
tag="Carol"
uri="rsync://wombat.example/Carol/b2dd7d8a70567a0e.cer"/>
hash="f842c3e1858df8c8"
uri="rsync://wombat.example/Fee/f842c3e1858df8c8.cer"/>
hash="b139ca23414476bb"
uri="rsync://wombat.example/Fie/b139ca23414476bb.cer"/>
hash="1995e9544ba80191"
uri="rsync://wombat.example/Foe/1995e9544ba80191.cer"/>
hash="9c00b310c10a022c"
uri="rsync://wombat.example/Fum/9c00b310c10a022c.cer"/>
error_code="no_object_matching_hash"
tag="Dave">
hash="809a721743350c0c"
tag="Dave"
uri="rsync://wombat.example/Dave/809a721743350c0c.cer"/>
