<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Interworking LISP with IPv4 and IPv6</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 LISP Interworking Models">
<link href="#rfc.section.3" rel="Chapter" title="3 Definition of Terms">
<link href="#rfc.section.4" rel="Chapter" title="4 Routable EIDs">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Impact on Routing Table">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Requirement for using BGP">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Limiting the Impact of Routable EIDs">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Use of Routable EIDs for sites transitioning to LISP">
<link href="#rfc.section.5" rel="Chapter" title="5 Proxy Ingress Tunnel Routers">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 PITR EID announcements">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Packet Flow with PITRs">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Scaling PITRs">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Impact of the PITRs placement in the network">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Benefit to Networks Deploying PITRs">
<link href="#rfc.section.6" rel="Chapter" title="6 LISP-NAT">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Using LISP-NAT with LISP-NR EIDs">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 LISP Sites with Hosts using RFC 1918                       Addresses Sending to non-LISP Sites">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 LISP Sites with Hosts using RFC 1918 Addresses                         Sending Packets to Other LISP Sites">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 LISP-NAT and multiple EIDs">
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 When LISP-NAT and PITRs used by the same LISP Site">
<link href="#rfc.section.7" rel="Chapter" title="7 Proxy Egress Tunnel Routers">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Packet Flow with Proxy Egress Tunnel Routers">
<link href="#rfc.section.8" rel="Chapter" title="8 Discussion of Proxy ITRs (PITRs), LISP-NAT, and Proxy-ETRs (PETRs)">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 How Proxy-ITRs and Proxy-ETRs Interact">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgments">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes techniques for allowing sites running the Locator/ID Separation Protocol (LISP) to interoperate with Internet sites (which may be using either IPv4, IPv6, or both) but which are not running LISP.  A fundamental property of LISP speaking sites is that they use Endpoint Identifiers (EIDs), rather than traditional IP addresses, in the source and destination fields of all traffic they emit or receive.  While EIDs are syntactically identical to IPv4 or IPv6 addresses, normally routes to them are not carried in the global routing system so an interoperability mechanism is needed for non-LISP-speaking sites to exchange traffic with LISP-speaking sites.  This document introduces three such mechanisms.  The first uses a new network element, the LISP Proxy Ingress Tunnel Routers (PITR) (Section 5) to act as a intermediate LISP Ingress Tunnel Router (ITR) for non-LISP-speaking hosts. Second the document adds Network Address Translation (NAT) functionality to LISP Ingress and LISP Egress Tunnel Routers (xTRs) to substitute routable IP addresses for non-routable EIDs.  Finally, this document introduces a Proxy Egress Tunnel Router (PETR) to handle cases where a LISP ITR cannot send packets to non-LISP sites without encapsulation.  " />
  <meta name="description" content="This document describes techniques for allowing sites running the Locator/ID Separation Protocol (LISP) to interoperate with Internet sites (which may be using either IPv4, IPv6, or both) but which are not running LISP.  A fundamental property of LISP speaking sites is that they use Endpoint Identifiers (EIDs), rather than traditional IP addresses, in the source and destination fields of all traffic they emit or receive.  While EIDs are syntactically identical to IPv4 or IPv6 addresses, normally routes to them are not carried in the global routing system so an interoperability mechanism is needed for non-LISP-speaking sites to exchange traffic with LISP-speaking sites.  This document introduces three such mechanisms.  The first uses a new network element, the LISP Proxy Ingress Tunnel Routers (PITR) (Section 5) to act as a intermediate LISP Ingress Tunnel Router (ITR) for non-LISP-speaking hosts. Second the document adds Network Address Translation (NAT) functionality to LISP Ingress and LISP Egress Tunnel Routers (xTRs) to substitute routable IP addresses for non-routable EIDs.  Finally, this document introduces a Proxy Egress Tunnel Router (PETR) to handle cases where a LISP ITR cannot send packets to non-LISP sites without encapsulation.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">D. Lewis</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">D. Meyer</td>
</tr>
<tr>
<td class="left">Intended status: Experimental Protocol</td>
<td class="right">D. Farinacci</td>
</tr>
<tr>
<td class="left">Expires: January 02, 2012</td>
<td class="right">V. Fuller</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco Systems, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 01, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Interworking LISP with IPv4 and IPv6<br />
  <span class="filename">draft-ietf-lisp-interworking-02.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes techniques for allowing sites running the Locator/ID Separation Protocol (LISP) to interoperate with Internet sites (which may be using either IPv4, IPv6, or both) but which are not running LISP.  A fundamental property of LISP speaking sites is that they use Endpoint Identifiers (EIDs), rather than traditional IP addresses, in the source and destination fields of all traffic they emit or receive.  While EIDs are syntactically identical to IPv4 or IPv6 addresses, normally routes to them are not carried in the global routing system so an interoperability mechanism is needed for non-LISP-speaking sites to exchange traffic with LISP-speaking sites.  This document introduces three such mechanisms.  The first uses a new network element, the LISP Proxy Ingress Tunnel Routers (PITR) (Section 5) to act as a intermediate LISP Ingress Tunnel Router (ITR) for non-LISP-speaking hosts. Second the document adds Network Address Translation (NAT) functionality to LISP Ingress and LISP Egress Tunnel Routers (xTRs) to substitute routable IP addresses for non-routable EIDs.  Finally, this document introduces a Proxy Egress Tunnel Router (PETR) to handle cases where a LISP ITR cannot send packets to non-LISP sites without encapsulation.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 02, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">LISP Interworking Models</a>
</li>
<li>3.   <a href="#rfc.section.3">Definition of Terms</a>
</li>
<li>4.   <a href="#rfc.section.4">Routable EIDs</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Impact on Routing Table</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Requirement for using BGP</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Limiting the Impact of Routable EIDs</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Use of Routable EIDs for sites transitioning to LISP</a>
</li>
<li>5.   <a href="#rfc.section.5">Proxy Ingress Tunnel Routers</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">PITR EID announcements</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Packet Flow with PITRs</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Scaling PITRs</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Impact of the PITRs placement in the network</a>
</li>
<li>5.5.   <a href="#rfc.section.5.5">Benefit to Networks Deploying PITRs</a>
</li>
<li>6.   <a href="#rfc.section.6">LISP-NAT</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Using LISP-NAT with LISP-NR EIDs</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">LISP Sites with Hosts using RFC 1918                       Addresses Sending to non-LISP Sites</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">LISP Sites with Hosts using RFC 1918 Addresses                         Sending Packets to Other LISP Sites</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">LISP-NAT and multiple EIDs</a>
</li>
<li>6.5.   <a href="#rfc.section.6.5">When LISP-NAT and PITRs used by the same LISP Site</a>
</li>
<li>7.   <a href="#rfc.section.7">Proxy Egress Tunnel Routers</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Packet Flow with Proxy Egress Tunnel Routers</a>
</li>
<li>8.   <a href="#rfc.section.8">Discussion of Proxy ITRs (PITRs), LISP-NAT, and Proxy-ETRs (PETRs)</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">How Proxy-ITRs and Proxy-ETRs Interact</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgments</a>
</li>
<li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<li>12.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document describes interoperation between LISP <a href="#LISP">[LISP]</a> sites which use non-globally-routed EIDs, and non-LISP sites. The first is the use of Proxy Ingress Tunnel router (PITRs), which originate highly-aggregated routes to EID prefixes for non-LISP sites to use. It also describes the use of NAT by LISP ITRs when sending packets to non-LISP hosts.  Finally, it describes Proxy Egress Tunnel routers (PETRs) LISP for sites relying on PITRs, and which are faced with certain restrictions.  </p>
<p id="rfc.section.1.p.2">A key behavior of the separation of Locators and End-Point-IDs is that EID prefixes are normally not advertised into the Internet's Default Free Zone (DFZ).  Specifically, only RLOCs are carried in the Internet's DFZ.  Existing Internet sites (and their hosts) which do not run in the LISP protocol must still be able to reach sites numbered from LISP EID space.  This draft describes three mechanisms that can be used to provide reachability between sites that are LISP-capable and those that are not.  </p>
<p id="rfc.section.1.p.3">The first mechanism uses a new network element, the LISP Proxy Ingress Tunnel Router (PITR) to act as a intermediate LISP Ingress Tunnel Router (ITR) for non-LISP-speaking hosts. The second mechanism adds a form of Network Address Translation (NAT) functionality to Tunnel Routers (xTRs), to substitute routable IP addresses for non-routable EIDs.  The final network element is the LISP Proxy Egress Tunnel Routers (PETR), which act as an intermediate Egress Tunnel Router (ETR) for LISP sites which need to encapsulate packets LISP packets destined to non-LISP sites.  </p>
<p id="rfc.section.1.p.4">More detailed descriptions of these mechanisms and the network elements involved may be found in the following sections: </p>
<p id="rfc.section.1.p.5">- Section 2 describes the different cases where interworking mechanisms are needed </p>
<p id="rfc.section.1.p.6">- Section 3 defines terms used throughout the document </p>
<p id="rfc.section.1.p.7">- Section 4 describes the relationship between the new EID prefix space and the IP address space used by the current Internet </p>
<p id="rfc.section.1.p.8">- Section 5 introduces and describes the operation of Proxy-ITRs </p>
<p id="rfc.section.1.p.9">- Section 6 defines how NAT is used by ETRs to translate non-routable EIDs into routable IP addresses.  </p>
<p id="rfc.section.1.p.10">- Section 7 introduces and describes the operations of Proxy-ETRs </p>
<p id="rfc.section.1.p.11">- Section 8 describes the relationship between asymmetric and Symmetric interworking mechanisms (Proxy-ITRs and Proxy-ETRs vs LISP-NAT) </p>
<p id="rfc.section.1.p.12">Note that any successful interworking model should be independent of any particular EID-to-RLOC mapping algorithm.  This document does not comment on the value of any of the particular LISP mapping systems.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#models" id="models">LISP Interworking Models</a>
</h1>
<p id="rfc.section.2.p.1">There are 4 unicast connectivity cases which describe how sites can send packets to each other: </p>
<p></p>

<ol>
<li>Non-LISP site to Non-LISP site</li>
<li>LISP site to LISP site</li>
<li>LISP site to Non-LISP site</li>
<li>Non-LISP site to LISP site</li>
</ol>
<p id="rfc.section.2.p.3">Note that while Cases 3 and 4 seem similar, there are subtle differences due to the way packets are originated.  </p>
<p id="rfc.section.2.p.4">The first case is the Internet as we know it today and as such will not be discussed further here.  The second case is documented in [LISP] and there are no new interworking requirements because there are no new protocol requirements placed on intermediate non- LISP routers.  </p>
<p id="rfc.section.2.p.5">In case 3, LISP site to Non-LISP site, a LISP site can (in most cases) send packets to a non-LISP site because the non-LISP site prefixes are routable.  The non-LISP site need not do anything new to receive packets.  The only action the LISP site needs (with two possible caveats introduced below) to take is to know when not to LISP-encapsulate packets. This can be achieved by using one of two mechanisms: </p>
<p></p>

<ol>
<li>At the ITR in the source site, if the destination of an IP packet is found to match a prefix from the BGP routing table, then the site is directly reachable by the BGP core that exists and operates today.  </li>
<li>Second, if (from the perspective of the ITR at the source site) the packet's destination IP address is not found in the EID-to-RLOC mapping database, then the ITR could infer that it is not a LISP-capable site.  An ITR can also know explicitly that the destination is non-LISP if the destination IP address matches a Negative Map Reply found in its Map Cache.  </li>
<li>In either of the  two exceptions mentioned above there could be some situations where (unencapsulated) packets originated by a LISP site may not be forwarded to a non-LISP site.  These cases are reviewed in section 7, (Proxy-Egress Tunnel Routers).  </li>
</ol>
<p id="rfc.section.2.p.7">Case 4, typically the most challenging, occurs when a host at a non-LISP site wishes to send traffic to a host at a LISP site.  If the source host uses a (non-globally-routable) EID as the destination IP address, the packet is forwarded inside the source site until it reaches a router which cannot forward it (due to lack of a default route), at which point the traffic is dropped.  For traffic not to be dropped, either some mechanism to make this destination EID routable must be in place. Section 5 (PITRs) and Section 6 (LISP-NAT) describe two such mechanisms.  </p>
<p id="rfc.section.2.p.8">Case 4 also applies to packets returning to the LISP site, in Case 3.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#terms" id="terms">Definition of Terms</a>
</h1>
<p></p>

<dl>
<dt>LISP Routable (LISP-R) Site:</dt>
<dd style="margin-left: 8">A LISP site whose addresses are used as both globally routable IP addresses and LISP EIDs.  </dd>
<dt>LISP Non-Routable (LISP-NR) Site:</dt>
<dd style="margin-left: 8">A LISP site whose addresses are EIDs only, these EIDs are not found in the legacy Internet routing table.  </dd>
<dt>LISP Proxy Ingress Tunnel Router (PITR):</dt>
<dd style="margin-left: 8">PITRs are used to provide interconnectivity between sites which use LISP EIDs and those which do not. They act as gateways between those parts of the Internet which are not using LISP (the legacy Internet)  A given PITR advertises one or more highly aggregated EID prefixes into the public Internet and acts as the ITR for traffic received from the public Internet. LISP Proxy Ingress Tunnel Routers are described in <a href="#PITR">Section 5</a>.  </dd>
<dt>LISP Network Address Translation (LISP-NAT):</dt>
<dd style="margin-left: 8">Network Address Translation between EID space assigned to a site and RLOC space also assigned to that site. LISP Network Address Translation is described in <a href="#lispnat">Section 6</a>.  </dd>
<dt>LISP Proxy Egress Tunnel Router (PETR):</dt>
<dd style="margin-left: 8">PETRs provide a LISP (Routable or Non-Routable EID) site's ITRs the ability to send packets to non-LISP sites in cases where unencapsualted packets (the default mechanism) would fail to be delivered. PETRs are function by having an ITR encapsulate all non-LISP destined traffic to a pre-configured PETR. LISP Proxy Egress Tunnel Routers are described in <a href="#PETR">Section 7</a>.  </dd>
<dt> EID Sub Namespace:</dt>
<dd style="margin-left: 8">A power-of-two block of aggregatable locators set aside for LISP interworking.  </dd>
</dl>
<p id="rfc.section.3.p.2">For definitions of other terms, notably Map-Request, Map-Reply, Ingress Tunnel Router (ITR), and Egress Tunnel Router (ETR), please consult the LISP specification <a href="#LISP">[LISP]</a>.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#rEIDs" id="rEIDs">Routable EIDs</a>
</h1>
<p id="rfc.section.4.p.1">An obvious way to achieve interworking between LISP and non-LISP hosts is for a LISP site to simply announce EID prefixes into the DFZ, much like the current routing system, effectively treating them as "Provider Independent (PI)" prefixes. Having a site do this is undesirable as it defeats one of the primary goals of LISP - to reduce global routing system state.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#routing-table" id="routing-table">Impact on Routing Table</a>
</h1>
<p id="rfc.section.4.1.p.1">If EID prefixes are announced into the DFZ, the impact is similar to the case in which LISP has not been deployed, because these EID prefixes will be no more aggregatable than existing PI addressing.  Such a mechanism is not viewed as a viable long term solution, but may be a viable short term way for a site to transition a portion of its address space to EID space without changing its existing routing policy.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Requirement for using BGP</h1>
<p id="rfc.section.4.2.p.1">Non-LISP sites today use BGP to, among other things, enable ingress traffic engineering.  Relaxing this requirement is another primary design goal of LISP.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Limiting the Impact of Routable EIDs</h1>
<p id="rfc.section.4.3.p.1">Two schemes are proposed to limit the impact of having EIDs announced in the current global Internet routing table: </p>
<p></p>

<ol>
<li>
<a href="#PITR">Section 5</a> discusses the LISP Proxy Tunnel Router, an approach that provides ITR functionality to bridge LISP-capable and non-LISP-capable sites. </li>
<li>
<a href="#lispnat">Section 6</a> discusses another approach, LISP-NAT, in which NAT <a href="#RFC2993">[RFC2993]</a> is combined with ITR functionality to limit the impact of routable EIDs on the Internet routing infrastructure.</li>
</ol>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Use of Routable EIDs for sites transitioning to LISP</h1>
<p id="rfc.section.4.4.p.1">A primary design goal for LISP (and other Locator/ID separation proposals) is to facilitate topological aggregation of namespace used by the path computation, and, thus, decrease global routing system overhead.  Another goal is to achieve the benefits of improved aggregation as soon as possible.  Individual sites advertising their own routes for LISP EID prefixes into the global routing system is therefore not recommended.  </p>
<p id="rfc.section.4.4.p.2">That being said, single homed sites (or multi-homed sites that are not leaking more specific exceptions) and that are already using provider-aggregated prefixes can use these prefixes as LISP EIDs without adding state to the routing system.  In other words, such sites do not cause additional prefixes to be advertised.  For such sites, connectivity to a non-LISP sites does not require interworking machinery because the "PA" EIDs are already routable (they are effectively LISP-R type sites).  Their EIDs are found in the LISP mapping system, and their (aggregate) PA prefix(es) are found in the DFZ Internet.  </p>
<p id="rfc.section.4.4.p.3">The continued announcements of an existing site's Provider Independent (or "PI") prefix(es) is of course under control of that site.  Some period of transition, where a site is found both in the LISP mapping system, and as a discrete prefix in the Internet routing system, may be a viable transition strategy.  Care should be taken not to advertise additional more specific LISP EID prefixes into the DFZ.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#PITR" id="PITR">Proxy Ingress Tunnel Routers</a>
</h1>
<p id="rfc.section.5.p.1">Proxy Ingress Tunnel Routers (PITRs) allow for non-LISP sites to send packets to LISP-NR sites.  A PITR is a new network element that shares many characteristics with the LISP ITR.  PITRs allow non-LISP sites to send packets to LISP-NR sites without any changes to protocols or equipment at the non-LISP site.  PITRs have two primary functions: </p>
<p></p>

<dl>
<dt>Originating EID Advertisements:</dt>
<dd style="margin-left: 8">PITRs advertise highly aggregated EID-prefix space on behalf of LISP sites to so that non-LISP sites can reach them.  </dd>
<dt>Encapsulating Legacy Internet Traffic:</dt>
<dd style="margin-left: 8">PITRs also encapsulate non-LISP Internet traffic into LISP packets and route them towards their destination RLOCs.  </dd>
</dl>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> PITR EID announcements</h1>
<p id="rfc.section.5.1.p.1">A key part of PITR functionality is to advertise routes for highly- aggregated EID prefixes into part of the global routing system.  Aggressive aggregation is performed to minimize the number of new announced routes. In addition, careful placement of PITRs can greatly reduce the advertised scope of these new routes. To this end, PITRs should be deployed close to non-LISP-speaking rather than close to LISP sites.  Such deployment not only limits the scope of EID-prefix route advertisements, it also allows traffic forwarding load to be spread among many PITRs.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Packet Flow with PITRs</h1>
<p id="rfc.section.5.2.p.1">What follows is an example of the path a packet would take when using a PITR.  In this example, the LISP-NR site is given the EID prefix 240.0.0.0/24.  For the purposes of this example, this prefix and no covering aggregate is present in the global routing system.  In other words, without the Proxy-ITR announcing 240.0.0.0/24, a packet with this destination were to reach a router in the "Default Free Zone", it would be dropped.  </p>
<p id="rfc.section.5.2.p.2">A full protocol exchange example follows: </p>
<p></p>

<ol>
<li>The source host makes a DNS lookup EID for destination, and gets 240.1.1.1 in return.</li>
<li>The source host has a default route to customer Edge (CE) router and forwards the packet to the CE.</li>
<li>The CE has a default route to its Provider Edge (PE) router, and forwards the packet to the PE.</li>
<li>The PE has route to 240.0.0.0/24 and the next hop is the PITR.</li>
<li>The PITR has or acquires a mapping for 240.1.1.1 and LISP encapsulates the packet.  The outer IP header now has a destination address of one of the destination EID's RLOCs.  The outer source address of this encapsulated packet is the PITR's RLOC.</li>
<li>The PITR looks up the RLOC, and forwards LISP packet to the next hop, after which, it is forwarded by other routers to the ETR's RLOC.</li>
<li>The ETR decapsulates the packet and delivers the packet to the 240.1.1.1 host in the destination LISP site.</li>
<li>Packets from host 240.1.1.1 will flow back through the LISP site's ITR. Such packets are not encapsulated because the ITR knows that the destination (the original source) is a non-LISP site.  The ITR knows this because it can check the LISP mapping database for the destination EID, and on a failure determine that the destination site is not LISP enabled.</li>
<li>Packets are then routed natively and directly to the destination (original source) site.</li>
</ol>
<p id="rfc.section.5.2.p.4">Note that in this example the return path is asymmetric, so return traffic will not go back through the PITR.  This is because the LISP-NR site's ITR will discover that the originating site is not a LISP site, and not encapsulate the returning packet (see <a href="#LISP">[LISP]</a> for details of ITR behavior).  </p>
<p id="rfc.section.5.2.p.5">The asymmetric nature of traffic flows allows the PITR to be relatively simple - it will only have to encapsulate LISP packets.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Scaling PITRs</h1>
<p id="rfc.section.5.3.p.1">PITRs attract traffic by announcing the LISP EID namespace into parts of the non-LISP-speaking global routing system.  There are several ways that a network could control how traffic reaches a particular PITR to prevent it from receiving more traffic than it can handle: </p>
<p></p>

<ol>
<li>The PITR's aggregate routes might be selectively announced, giving a coarse way to control the quantity of traffic attracted by that PITR.  For example, some of the routes being announced might be tagged with a BGP community and their scope of announcement limited by the routing policy of the provider.  </li>
<li>The same address might be announced by multiple PITRs in order to share the traffic using IP Anycast.  The asymmetric nature of traffic flows through the Proxy ITR means that operationally, deploying a set PITRs would be very similar to existing Anycasted services like DNS caches.  Multiple Proxy ITRs could advertise the same BGP Next Hop IP address as their RLOC, and traffic would be attracted to the nearest Next Hop according to the network's IGP.  </li>
</ol>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Impact of the PITRs placement in the network</h1>
<p id="rfc.section.5.4.p.1">There are several approaches that a network could take in placing PITRs.  Placing the PITR near the source of traffic allows for the communication between the non-LISP site and the LISP site to have the least "stretch" (i.e. the least number of forwarding hops when compared to an optimal path between the sites).  </p>
<p id="rfc.section.5.4.p.2">Some proposals, for example CRIO <a href="#CRIO">[CRIO]</a>, have suggested grouping PITRs near an arbitrary subset of ETRs and announcing a 'local' subset of EID space.  This model cannot guarantee minimum stretch if the EID prefix route advertisement points are changed (such a change might occur if a site adds, removes, or replaces one or more of its ISP connections).  </p>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> Benefit to Networks Deploying PITRs</h1>
<p id="rfc.section.5.5.p.1">When packets destined for LISP-NR sites arrive and are encapsulated at a Proxy-ITR, a new LISP packet header is pre-pended. This causes the packet's destination to be set to the destination ETRs RLOC.  Because packets are thus routed towards RLOCs, it can potentially better follow the Proxy-ITR network's traffic engineering policies (such as closest exit routing).  This also means that providers which are not default-free and do not deploy Proxy-ITRs end up sending more traffic to expensive transit links (assuming their upstreams have deployed Proxy-ITRs) rather than to the ETR's RLOC addresses, to which they may well have cheaper and closer connectivity to (via, for example, settlement-free peering).  A corollary to this would be that large transit providers, deploying PITRs may attract more traffic, and therefore more revenue, from their customers.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#lispnat" id="lispnat">LISP-NAT</a>
</h1>
<p id="rfc.section.6.p.1">LISP Network Address Translation (LISP-NAT) is a limited form of NAT <a href="#RFC2993">[RFC2993]</a>. LISP-NAT is designed to enable the interworking of non-LISP sites and LISP-NR sites by ensuring that the LISP-NR's site addresses are always routable.  LISP-NAT accomplishes this by translating a host's source address from an 'inner' (LISP-NR EID) value to an 'outer' (LISP-R) value and keeping this translation in a table that it can reference for subsequent packets.  </p>
<p id="rfc.section.6.p.2">In addition, existing RFC 1918 <a href="#RFC1918">[RFC1918]</a> sites can use LISP-NAT to talk to both LISP or non-LISP sites.  </p>
<p id="rfc.section.6.p.3">The basic concept of LISP-NAT is that when transmitting a packet, the ITR replaces a non-routable EID source address with a routable source address, which enables packets to return to the site.  </p>
<p id="rfc.section.6.p.4">There are two main cases that involve LISP-NAT: </p>
<p></p>

<ol>
<li>Hosts at LISP sites that use non-routable global EIDs speaking to non-LISP sites using global addresses.  </li>
<li>Hosts at LISP sites that use RFC 1918 private EIDs speaking to other sites, who may be either LISP or non-LISP.  </li>
</ol>
<p id="rfc.section.6.p.6">Note that LISP-NAT is not needed in the case of LISP-R (routable global EIDs) sources. This case occurs when a site is announcing its prefix into both the LISP mapping system as well as the Internet DFZ.  This is because the LISP-R source's address is routable, and return packets will be able to natively reach the site.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#lispeid" id="lispeid">Using LISP-NAT with LISP-NR EIDs</a>
</h1>
<p id="rfc.section.6.1.p.1">LISP-NAT allows a host with a LISP-NR EID to send packets to non-LISP hosts by translating the LISP-NR EID to a globally unique address (a LISP-R EID). This globally unique address may be a either a PI or PA address.  </p>
<p id="rfc.section.6.1.p.2">An example of this translation follows.  For this example, a site has been assigned a LISP-NR EID of 220.1.1.0/24.  In order to utilize LISP-NAT, the site has also been provided the PA EID of 128.200.1.0/24, and uses the first address (128.200.1.1) as the site's RLOC.  The rest of this PA space (128.200.1.2 to 128.200.1.254) is used as a translation pool for this site's hosts who need to send packets to non-LISP hosts.  </p>
<p id="rfc.section.6.1.p.3">The translation table might look like the following: </p>
<div id="#rfc.figure.1"></div>
<div id="#translation-table"></div>
<pre>
        Site NR-EID    Site R-EID      Site's RLOC    Translation Pool
        ==============================================================
        220.1.1.0/24   128.200.1.0/24  128.200.1.1    128.200.1.2-254
       </pre>
<p id="rfc.section.6.1.p.4">The Host 220.1.1.2 sends a packet (which, for the purposes of this example is destined for a non-LISP site) to its default route (the ITR).  The ITR receives the packet, and determines that the destination is not a LISP site.  How the ITR makes this determination is up to the ITRs implementation of the EID-to-RLOC mapping system used (see, for example <a href="#LISP-ALT">[LISP-ALT]</a>).  </p>
<p id="rfc.section.6.1.p.5">The ITR then rewrites the source address of the packet from 220.1.1.2 to 128.200.1.2, which is the first available address in the LISP-R EID space available to it.  The ITR keeps this translation in a table in order to reverse this process when receiving packets destined to 128.200.1.2.  </p>
<p id="rfc.section.6.1.p.6">Finally, when the ITR forwards this packet without encapsulating it, it uses the entry in its LISP-NAT table to translate the returning packets' destination IPs to the proper host.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> LISP Sites with Hosts using RFC 1918                       Addresses Sending to non-LISP Sites</h1>
<p id="rfc.section.6.2.p.1">In the case where hosts using RFC 1918 addresses desire to send packets to non-LISP hosts, the LISP-NAT implementation acts much like an existing IPv4 NAT device.  The ITR providing the NAT service must use LISP-R EIDs for its global address pool as well as providing all the standard NAT functions required today.  </p>
<p id="rfc.section.6.2.p.2">The source of the packet must be translated to a LISP-R EID in a manner similar to <a href="#lispnat">Section 6</a>, and this packet must be forwarded to the ITR's next hop for the destination, without LISP encapsulation.  </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> LISP Sites with Hosts using RFC 1918 Addresses                         Sending Packets to Other LISP Sites</h1>
<p id="rfc.section.6.3.p.1">LISP-NAT allows a host with an RFC 1918 address to send packets to LISP hosts by translating the RFC 1918 address to a LISP EID.  After translation, the communication between source and destination ITR and ETRs continues as described in <a href="#LISP">[LISP]</a>.  </p>
<p id="rfc.section.6.3.p.2">An example of this translation and encapsulation follows.  For this example, a host has been assigned a RFC 1918 address of 192.168.1.2.  In order to utilize LISP-NAT, the site also has been provided the LISP-R EID prefix of 192.0.2.0/24, and uses the first address (192.0.2.1) as the site's RLOC.  The rest of this PA space (192.0.2.2 to 192.0.2.254) is used as a translation pool for this site's hosts who need to send packets to both non-LISP and LISP hosts.  </p>
<p id="rfc.section.6.3.p.3">The Host 192.168.1.2 sends a packet destined for a non-LISP site to its default route (the ITR).  The ITR receives the packet and determines that the destination is a LISP site.  How the ITR makes this determination is up to the ITRs implementation of the EID/RLOC mapping system.  </p>
<p id="rfc.section.6.3.p.4">The ITR then rewrites the source address of the packet from 192.168.1.2 to 192.0.2.2, which is the first available address in the LISP EID space available to it.  The ITR keeps this translation in a table in order to reverse this process when receiving packets destined to 192.0.2.2.  </p>
<p id="rfc.section.6.3.p.5">The ITR then LISP encapsulates this packet (see [LISP] for details).  The ITR uses the site's RLOC as the LISP outer header's source and the translation address as the LISP inner header's source.  Once it decapsulates returning traffic, it uses the entry in its LISP-NAT table to translate the returning packet's destination IP address and then forward to the proper host.  </p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> LISP-NAT and multiple EIDs</h1>
<p id="rfc.section.6.4.p.1">When a site has two addresses that a host might use for global reachability, care must be chosen on which EID is found in DNS.  For example, whether applications such as DNS use the LISP-R EID or the LISP-NR EID.  This problem exists for NAT in general, but the specific issue described above is unique to LISP. Using PITRs can mitigate this problem, since the LISP-NR EID can be reached in all cases.  </p>
<h1 id="rfc.section.6.5">
<a href="#rfc.section.6.5">6.5.</a> When LISP-NAT and PITRs used by the same LISP Site</h1>
<p id="rfc.section.6.5.p.1">With LISP-NAT, there are two EIDs possible for a given host, the LISP-R EID and the LISP-NR EID.  When a site has two addresses that a host might use for global reachability, name-to-address directories may need to be modified.  </p>
<p id="rfc.section.6.5.p.2">This problem, global vs. local addressability, exists for NAT in general, but the specific issue described above is unique to location/identity separation schemes.  Some of these have suggested running a separate DNS instance for new types of EIDs.  This solves the problem but introduces complexity for the site.  Alternatively, using PITRs can mitigate this problem, because the LISP-NR EID can be reached in all cases.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#PETR" id="PETR">Proxy Egress Tunnel Routers</a>
</h1>
<p id="rfc.section.7.p.1">Proxy Egress Tunnel Routers (PETRs) allow for LISP sites to send packets to non-LISP sites in the case where the access network does not allow for the LISP site send packets with the source address of the site's EID(s).  A PETR is a new network element that, conceptually, acts as an ETR for traffic destined to non-LISP sites. This also has the effect of allowing an ITR avoid having to decide whether to encapsulate packets or not - it can always encapsulate packets.  An ITR would encapsulate packets destined for LISP sites (no change here) and these would be routed directly to the corespondent site's ETR.  All other packets (those destined to non-LISP sites) will be sent to the originating site's PETR.  </p>
<p id="rfc.section.7.p.2">There are two primary reasons why sites would want to utilize a PETR: </p>
<p></p>

<dl>
<dt>Avoiding strict uRPF failures:</dt>
<dd style="margin-left: 8">Some provider's access networks require the source of the packets emitted to be within the addressing scope of the access networks.  (see section 9) </dd>
<dt>Traversing a different IP Protocol:</dt>
<dd style="margin-left: 8">A LISP site may want to transmit packets to a non-LISP site where some of the intermediate network does not support the particular IP protocol desired (v4 or v6).  PETRs can allow this LISP site's data to 'hop over' this by utilizing LISP's support for mixed protocol encapsulation.  </dd>
</dl>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> Packet Flow with Proxy Egress Tunnel Routers</h1>
<p id="rfc.section.7.1.p.1">Packets from a LISP site can reach a non-LISP site with the aid of a Proxy-ETR (or PETR).  An ITR is simply configured to send all non-LISP traffic, which it normally would have forwarded natively (non-encapsulated), to a PETR.  In the case where the ITR uses a Map- Resolver(s), the ITR will encapsulate packets that match the received Negative Map-Cache to the configured Proxy-ETR(s).  In the case where the ITR is connected  to the mapping system directly it would encapsulate all packets to the configured Proxy-ETR that are cache misses.  Note that this outer encapsulation to the Proxy-ETR may be in an IP protocol other than the (inner) encapsulated data.  Routers then use the LISP (outer) header's destination address to route the packets toward the configured Proxy-ETR.  </p>
<p id="rfc.section.7.1.p.2">A PETR should verify the (inner) source EID of the packet at time of decapsulation in order to verify that this is from a configured LISP site.  This is to prevent spoofed inner sources from being encapsulated through the Proxy-ETR.  </p>
<p id="rfc.section.7.1.p.3">What follows is an example of the path a packet would take when using a PETR.  In this example, the LISP-NR (or LISP-R) site is given the EID prefix 240.2.0.0/24, and it is trying to reach host at a non-LISP site with the IP prefix of 192.0.2.0/24.  For the purposes of this example, the destination is a non-LISP site and 192.0.2.0/24 is found in the Internet's routing system.  </p>
<p id="rfc.section.7.1.p.4">A full protocol exchange example follows: </p>
<p></p>

<ol>
<li>The source host makes a DNS lookup for the destination, and gets 192.0.2.100 (a host in a non-LISP site) in return. </li>
<li>The source host has a default route to customer Edge (CE) router and forwards the packet towards the CE.</li>
<li>The CE is a LISP ITR, and is configured to encapsulate traffic destined for non-LISP sites to a Proxy-ETR.</li>
<li>The Proxy ETR decapsulates the LISP packet and forwards the original packet to its next hop.</li>
<li>The packet is then routed natively and directly to the destination (non-LISP) site 192.0.2.0/24.</li>
</ol>
<p id="rfc.section.7.1.p.6">Note that in this example the return path is asymmetric, so return traffic will not go back through the Proxy-ETR.  This means that in order to reach LISP-NR sites, non-LISP sites must still use Proxy ITRs.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Discussion of Proxy ITRs (PITRs), LISP-NAT, and Proxy-ETRs (PETRs)</h1>
<p id="rfc.section.8.p.1">In summary, there are three mechanisms for interworking LISP with non-LISP Sites (for both IPv4 and IPv6).  In the LISP-NAT option the LISP site can manage and control the interworking on its own.  In the PITR case, the site is not required to manage the advertisement of it's EID prefix into the DFZ,  with the cost of potentially adding stretch to the connections of non-LISP sites sending packets to the LISP site.  The third option is Proxy-ETRs, which are optionally used by sites relying on PITRs case to mitigate two caveats for LISP sites sending packets to non-LISP sites.  This means Proxy-ETRs are not usually expected to be deployed by themselves, rather they will be used to assist LISP-NR sites which are already using PITRs.  </p>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> How Proxy-ITRs and Proxy-ETRs Interact</h1>
<p id="rfc.section.8.1.p.1">There is a subtle difference between Symmetrical (LISP-NAT) vs Asymmetrical (Proxy-ITR and Proxy-ETR) Interworking techniques.  Operationally, Proxy-ITRs (PITRs) and Proxy-ETRs (PETRs) can (and likely should) be decoupled since Proxy-ITRs are best deployed closest to non-LISP sites, and Proxy-ETRs are best located close to the LISP sites they are decapsulating for.  This asymmetric placement of the two network elements minimizes the stretch imposed on each direction of the packet flow, while still allowing for coarsely aggregated announcements of EIDs into the Internet's routing table.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<p id="rfc.section.9.p.1">Like any router or LISP ITR, PITRs will have the opportunity to inspect traffic at the time that they encapsulate.  The location of these devices in the network can have implications for discarding malicious traffic on behalf of ETRs which request this behavior (via the drop action bit in Map-Reply packets for an EID or EID prefix).  </p>
<p id="rfc.section.9.p.2">As with traditional NAT, LISP-NAT will obscure the actual host LISP-NR EID behind the LISP-R addresses used as the NAT pool.  </p>
<p id="rfc.section.9.p.3">When LISP sites send packets to non-LISP sites (these non-LISP sites rely on PITRs to enable Interworking), packets will have the Site's EID as its source IP address.  These EIDs may not be recognized by their Internet Service Provider's Unicast Reverse Path Forwarding (uRPF) rules enabled on the Provider Edge Router.  Several options are available to the service provider.  For example they could enable a less strict version of uRPF, where they only look for the existence of the EID prefix in the routing table.  Another, more secure, option is to add a static route for the customer on the PE router, but not redistribute this route into the provider's routing table.  Finally, Proxy-ETRs can enable LISP sites to bypass this uRPF check by encapsulating all of their egressing traffic destined to non-LISP sites to the Proxy-ETR (thus ensuring the outer IP source address is the site's RLOC).  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgments</h1>
<p id="rfc.section.10.p.1">Thanks goes to Christian Vogt, Lixia Zhang, Robin Whittle, Michael Menth, and Xuewei Wang, and Noel Chiappa who have made insightful comments with respect to LISP Interworking and transition mechanisms.  </p>
<p id="rfc.section.10.p.2">A special thanks goes to Scott Brim for his initial brainstorming of these ideas and also for his careful review.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> IANA Considerations</h1>
<p id="rfc.section.11.p.1">This document creates no new requirements on IANA namespaces <a href="#RFC2434">[RFC2434]</a>.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1918">[RFC1918]</b></td>
<td class="top">
<a href="mailto:yakov@cisco.com" title="Cisco systems">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com" title="Chrysler Corporation">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net" title="RIPE Network Coordination Centre">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net" title="RIPE Network Coordination Centre">Groot, G.</a> and <a href="mailto:lear@sgi.com" title="Silicon Graphics, Inc.">E. Lear</a>, "<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>", BCP 5, RFC 1918, February 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4632">[RFC4632]</b></td>
<td class="top">
<a>Fuller, V.</a> and <a>T. Li</a>, "<a href="http://tools.ietf.org/html/rfc4632">Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan</a>", BCP 122, RFC 4632, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="LISP">[LISP]</b></td>
<td class="top">
<a>Farinacci, D.</a>, <a>Fuller, V.</a>, <a>Meyer, D.</a> and <a>D. Lewis</a>, "<a href="http://tools.ietf.org/html/draft-ietf-lisp-14">Locator/ID Separation Protocol (LISP)</a>", Internet-Draft draft-ietf-lisp-14, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="LISP-ALT">[LISP-ALT]</b></td>
<td class="top">
<a>Farinacci, D.</a>, <a>Fuller, V.</a>, <a>Meyer, D.</a> and <a>D. Lewis</a>, "<a href="http://tools.ietf.org/html/draft-ietf-lisp-alt-07.txt">LISP Alternative Topology (LISP+ALT)</a>", Internet-Draft draft-ietf-lisp-alt-07.txt, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="LISP-MS">[LISP-MS]</b></td>
<td class="top">
<a>Farinacci, D</a> and <a>V Fuller</a>, "<a href="http://tools.ietf.org/html/draft-ietf-lisp-ms-09.txt">LISP Map Server</a>", Internet-Draft draft-ietf-lisp-ms-09.txt, June 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2434">[RFC2434]</b></td>
<td class="top">
<a href="mailto:narten@raleigh.ibm.com" title="IBM Corporation">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no" title="Maxware">H.T. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 2434, October 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2993">[RFC2993]</b></td>
<td class="top">
<a>Hain, T.</a>, "<a href="http://tools.ietf.org/html/rfc2993">Architectural Implications of NAT</a>", RFC 2993, November 2000.</td>
</tr>
<tr>
<td class="reference"><b id="CRIO">[CRIO]</b></td>
<td class="top">
<a>Zhang, X</a>, <a>Francis, P</a>, <a>Wang, J</a> and <a>K Yoshida</a>, "<a>CRIO:Scaling IP Routing with the Core Router-Integrated Overlay</a>", January 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Darrel Lewis</span> 
	  <span class="n hidden">
		<span class="family-name">Lewis</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:darlewis@cisco.com">darlewis@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">David Meyer</span> 
	  <span class="n hidden">
		<span class="family-name">Meyer</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dmm@cisco.com">dmm@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dino Farinacci</span> 
	  <span class="n hidden">
		<span class="family-name">Farinacci</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dino@cisco.com">dino@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Vince Fuller</span> 
	  <span class="n hidden">
		<span class="family-name">Fuller</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:vaf@cisco.com">vaf@cisco.com</a></span>

  </address>
</div>

</body>
</html>