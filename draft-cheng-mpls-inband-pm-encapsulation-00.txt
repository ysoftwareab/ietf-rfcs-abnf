



MPLS Working Group                                              W. Cheng
Internet-Draft                                              China Mobile
Intended status: Standards Track                                  X. Min
Expires: September 11, 2019                                          ZTE
                                                                 T. Zhou
                                                                  Huawei
                                                                 X. Dong
                                                               FiberHome
                                                          March 10, 2019


         Encapsulation For MPLS Inband Performance Measurement
              draft-cheng-mpls-inband-pm-encapsulation-00

Abstract

   This document defines the encapsulation for MPLS inband performance
   measurement, which performs flow-based packet loss, delay, and jitter
   measurements on live traffic, by using the alternate-marking method.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 11, 2019.

Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must



Cheng, et al.          Expires September 11, 2019               [Page 1]

Internet-Draft          Encap For MPLS Inband PM              March 2019


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Conventions Used in This Document . . . . . . . . . . . .   2
       1.1.1.  Terminology . . . . . . . . . . . . . . . . . . . . .   3
       1.1.2.  Requirements Language . . . . . . . . . . . . . . . .   3
   2.  Flow-based Inband PM Encapsulation in MPLS  . . . . . . . . .   3
     2.1.  Examples for Applying Flow-ID and Nested Flow-ID  . . . .   4
   3.  Procedures of Encapsulation, Look-up and Decapsulation  . . .   7
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   8
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   8
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   [RFC8321] describes an alternate-marking (coloring) technique, and
   generally by which how to achieve hop-by-hop packet loss, delay, and
   jitter measurements, specifically, section 5 of [RFC8321] mentions
   the alternate-marking method application of MPLS performance
   measurement, but it fails to define the encapsulation for MPLS inband
   performance measurement using alternate-marking method.

   As mentioned in section 5 of [RFC8321], [RFC8372] discusses the
   desired capabilities for MPLS flow identification in order to perform
   a better MPLS inband performance measurement, and Synonymous Flow
   Label (SFL) introduced in [I-D.ietf-mpls-sfl-framework] is identified
   as a method of accomplishing MPLS flow identification.  This document
   employs a method other than SFL to accomplish MPLS flow
   identification.

   This document defines the encapsulation for MPLS inband performance
   measurement, which performs flow-based packet loss, delay, and jitter
   measurements on live traffic, by using the alternate-marking method.

1.1.  Conventions Used in This Document








Cheng, et al.          Expires September 11, 2019               [Page 2]

Internet-Draft          Encap For MPLS Inband PM              March 2019


1.1.1.  Terminology

   LSP: Label Switched Path

   MPLS: Multi-Protocol Label Switching

   NMS: Network Management System

   PM: Performance Measurement

   PW: PseudoWire

   SFL: Synonymous Flow Label

   TC: Traffic Class

   TTL: Time to Live

   VC: Virtual Channel

   VPN: Virtual Private Network

1.1.2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.  Flow-based Inband PM Encapsulation in MPLS

   Flow-based MPLS inband performance measurement encapsulation has the
   following format:

















Cheng, et al.          Expires September 11, 2019               [Page 3]

Internet-Draft          Encap For MPLS Inband PM              March 2019


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Inband PM Indicator Label (TBA1)    |  TC |S|      TTL      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Flow-ID               |L|D|R|S|    Reserved   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                            Payload                            ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


           Figure 1: Flow-based Inband PM Encapsulation in MPLS

   Where Inband PM Indicator Label is defined in this document as value
   TBA1, and the other fields related to the encapsulation of Inband PM
   are defined as follows:

   o  Flow-ID - an MPLS label value used as MPLS flow identification
      [RFC8372], it should be unique within the administrative domain.
      Flow-ID values can be allocated by an external NMS or a controller
      based on service object such as LSP and PW, and the specific
      method on how to allocate the Flow-ID values is outside the scope
      of this draft.  Note that Flow-ID can be placed either at the
      bottom of the MPLS label stack or not, and the Flow-ID can be
      nested, which means more than one Flow-ID can be present within an
      MPLS label stack.  Section 2.1 of this document provides several
      examples to illustrate how to apply Flow-ID and nested Flow-ID.

   o  L and D - L(oss) bit and D(elay) bit are used for coloring the
      packets (called double-marking methodology), which is required by
      alternate-marking method defined in [RFC8321].

   o  R - R bit is reserved for future use and MUST be set to zero.

   o  Reserved - one octet long field reserved for future use and MUST
      be set to zero.

2.1.  Examples for Applying Flow-ID and Nested Flow-ID

   Several examples of different Flow-ID label (4 octets) layout are
   illustrated as follows:

   (1) Flow-ID label layout when applied to MPLS LSP.






Cheng, et al.          Expires September 11, 2019               [Page 4]

Internet-Draft          Encap For MPLS Inband PM              March 2019


                +----------------------+
                |                      |
                |          LSP         |
                |         Label        |
                +----------------------+
                |                      |
                | Inband PM Indicator  |
                |         Label        |
                +----------------------+
                |                      |
                |        Flow-ID       |
                |         Label        |
                +----------------------+
                |                      |
                |          VPN         |
                |         Label        |
                +----------------------+ <= Bottom of stack
                |                      |
                |        Payload       |
                |                      |
                +----------------------+


                  Figure 2: Applying Flow-ID to MPLS LSP

   (2) Flow-ID label layout when applied to MPLS VPN traffic.

























Cheng, et al.          Expires September 11, 2019               [Page 5]

Internet-Draft          Encap For MPLS Inband PM              March 2019


                +----------------------+
                |                      |
                |          LSP         |
                |         Label        |
                +----------------------+
                |                      |
                |          VPN         |
                |         Label        |
                +----------------------+
                |                      |
                | Inband PM Indicator  |
                |         Label        |
                +----------------------+
                |                      |
                |        Flow-ID       |
                |         Label        |
                +----------------------+ <= Bottom of stack
                |                      |
                |        Payload       |
                |                      |
                +----------------------+


                  Figure 3: Applying Flow-ID to MPLS VPN

   (3) Flow-ID label layout when applied to both MPLS LSP and MPLS VPN
   traffic.
























Cheng, et al.          Expires September 11, 2019               [Page 6]

Internet-Draft          Encap For MPLS Inband PM              March 2019


                +----------------------+
                |                      |
                |          LSP         |
                |         Label        |
                +----------------------+
                |                      |
                | Inband PM Indicator  |
                |         Label        |
                +----------------------+
                |                      |
                |        Flow-ID       |
                |         Label        |
                +----------------------+
                |                      |
                |          VPN         |
                |         Label        |
                +----------------------+
                |                      |
                | Inband PM Indicator  |
                |         Label        |
                +----------------------+
                |                      |
                |        Flow-ID       |
                |         Label        |
                +----------------------+ <= Bottom of stack
                |                      |
                |        Payload       |
                |                      |
                +----------------------+


         Figure 4: Applying Flow-ID to both MPLS LSP and MPLS VPN

   Note that here VPN label can be MPLS PW label or MPLS IP VPN label,
   and it's also called VC label as defined in [RFC4026].

3.  Procedures of Encapsulation, Look-up and Decapsulation

   The procedures for Flow-ID label encapsulation, look-up and
   decapsulation are summarized as follows:

   o  The ingress node inserts the Inband PM Indicator Label alongside
      with the Flow-ID label in the MPLS label stack.  At the same time,
      the ingress node sets the L bit and D bit as needed by alternate-
      marking technique, and sets the Flow-ID value as defined in this
      document.





Cheng, et al.          Expires September 11, 2019               [Page 7]

Internet-Draft          Encap For MPLS Inband PM              March 2019


   o  The transit nodes look up the Flow-ID label with the help of the
      Inband PM Indicator Label, and transmit the collected information
      to an external NMS or a controller, which includes the values of
      the block counters and the timestamps of the marked packets along
      with the value of the Flow-ID, referring to the procedures defined
      in [RFC8321].

   o  The egress node pops the Inband PM Indicator Label alongside with
      the Flow-ID label from the MPLS label stack.  This document
      doesn't introduce any new procedure regarding to the process of
      the decapsulated packet.

4.  Security Considerations

   This document does not introduce additional security requirements and
   mechanisms.

5.  IANA Considerations

   In the Special-Purpose MPLS Label Values registry defined in
   [SP-MPLS-Label], a new Special-Purpose MPLS Label Value for Inband PM
   Indicator is requested from IANA as follows:

   +---------------------+-----------------+---------------+-----------+
   | Special-Purpose     | Description     | Semantics     | Reference |
   | MPLS Label Value    |                 | Definition    |           |
   +---------------------+-----------------+---------------+-----------+
   | TBA1                | Inband PM       | Section 2     | This      |
   |                     | Indicator Label |               | Document  |
   +---------------------+-----------------+---------------+-----------+

   Table 1: New Special-Purpose MPLS Label Value for Inband PM Indicator

6.  Acknowledgements

   To be added.

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.






Cheng, et al.          Expires September 11, 2019               [Page 8]

Internet-Draft          Encap For MPLS Inband PM              March 2019


   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8321]  Fioccola, G., Ed., Capello, A., Cociglio, M., Castaldelli,
              L., Chen, M., Zheng, L., Mirsky, G., and T. Mizrahi,
              "Alternate-Marking Method for Passive and Hybrid
              Performance Monitoring", RFC 8321, DOI 10.17487/RFC8321,
              January 2018, <https://www.rfc-editor.org/info/rfc8321>.

   [SP-MPLS-Label]
              "Special-Purpose MPLS Label Values", 2014,
              <https://www.iana.org/assignments/mpls-label-values/
              mpls-label-values.xml>.

7.2.  Informative References

   [I-D.ietf-mpls-sfl-framework]
              Bryant, S., Chen, M., Li, Z., Swallow, G., Sivabalan, S.,
              and G. Mirsky, "Synonymous Flow Label Framework", draft-
              ietf-mpls-sfl-framework-04 (work in progress), December
              2018.

   [RFC4026]  Andersson, L. and T. Madsen, "Provider Provisioned Virtual
              Private Network (VPN) Terminology", RFC 4026,
              DOI 10.17487/RFC4026, March 2005,
              <https://www.rfc-editor.org/info/rfc4026>.

   [RFC8372]  Bryant, S., Pignataro, C., Chen, M., Li, Z., and G.
              Mirsky, "MPLS Flow Identification Considerations",
              RFC 8372, DOI 10.17487/RFC8372, May 2018,
              <https://www.rfc-editor.org/info/rfc8372>.

Authors' Addresses

   Weiqiang Cheng
   China Mobile
   Beijing
   China

   Email: chengweiqiang@chinamobile.com










Cheng, et al.          Expires September 11, 2019               [Page 9]

Internet-Draft          Encap For MPLS Inband PM              March 2019


   Xiao Min
   ZTE
   Nanjing
   China

   Email: xiao.min2@zte.com.cn


   Tianran Zhou
   Huawei
   Beijing
   China

   Email: zhoutianran@huawei.com


   Ximing Dong
   FiberHome
   China

   Email: dxm@fiberhome.com






























Cheng, et al.          Expires September 11, 2019              [Page 10]
