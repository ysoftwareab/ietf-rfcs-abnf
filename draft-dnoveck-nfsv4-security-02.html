<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Security for the NFSv4 Protocols</title>
<meta content="David Noveck" name="author">
<meta content="
       
 This document describes the core security features of the NFSv4
 family of protocols, applying to all minor versions. The discussion
 includes the use of security features provided by the RPC transport.
       
       
 This preliminary version of the document, is intended, in
 large part, to result in working group discussion
 regarding existing NFSv4 security issues and to provide
 a framework for addressing these issues and obtaining
 working group consensus regarding necessary changes.
       
       
        When a successor document is eventually published as an RFC,
 it will supersede the
 description of
 security appearing in existing minor version specification
 documents such as RFC 7530 and RFC 8881.
       
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="example" name="keyword">
<meta content="draft-dnoveck-nfsv4-security-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-dnoveck-nfsv4-security-02-qxxe48ye.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Nfsv4 Security</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Noveck</td>
<td class="center">Expires 16 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">NFSv4</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8881" class="eref">8881</a>, <a href="https://www.rfc-editor.org/rfc/rfc7530" class="eref">7530</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-13" class="published">13 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-16">16 April 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Noveck, <span class="editor">Ed.</span>
</div>
<div class="org">NetApp</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Security for the NFSv4 Protocols</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 This document describes the core security features of the NFSv4
 family of protocols, applying to all minor versions. The discussion
 includes the use of security features provided by the RPC transport.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
 This preliminary version of the document, is intended, in
 large part, to result in working group discussion
 regarding existing NFSv4 security issues and to provide
 a framework for addressing these issues and obtaining
 working group consensus regarding necessary changes.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
        When a successor document is eventually published as an RFC,
 it will supersede the
 description of
 security appearing in existing minor version specification
 documents such as RFC 7530 and RFC 8881.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 16 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a href="#section-boilerplate.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-document-motivation" class="xref">Document Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-document-annotation" class="xref">Document Annotation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-keyword-definitions" class="xref">Keyword Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-special-considerations" class="xref">Special Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-introduction-to-this-update" class="xref">Introduction to this Update</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-transport-based-security-fe" class="xref">Transport-based Security Features</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-handling-of-multiple-minor-" class="xref">Handling of Multiple Minor Versions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-handling-of-minor-version-s" class="xref">Handling of Minor-version-specific features</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-features-needing-extensive-" class="xref">Features Needing Extensive Clarification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-process-going-forward" class="xref">Process Going Forward</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-introduction-to-nfsv4-secur" class="xref">Introduction to NFSv4 Security</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-structure-of-access-control" class="xref">Structure of Access Control Lists</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-access-control-entries" class="xref">Access Control Entries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ace-type" class="xref">ACE Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-ace-access-mask" class="xref">ACE Access Mask</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-uses-of-mask-bits" class="xref">Uses of Mask Bits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-requirements-and-recommenda" class="xref">Requirements and Recommendations Regarding Mask Granularity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-handling-of-deletion" class="xref">Handling of Deletion</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a href="#section-5.6.1" class="xref">5.6.1</a>.  <a href="#name-previous-handling-of-deleti" class="xref">Previous Handling of Deletion</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-ace-flag-bits" class="xref">ACE flag bits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-details-regarding-ace-flag-" class="xref">Details Regarding ACE Flag Bits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-ace-who" class="xref">ACE Who</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="xref">5.10</a>. <a href="#name-automatic-inheritance-featu" class="xref">Automatic Inheritance Features</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a href="#section-5.11" class="xref">5.11</a>. <a href="#name-attribute-13-aclsupport" class="xref">Attribute 13: aclsupport</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.12">
                <p id="section-toc.1-1.5.2.12.1"><a href="#section-5.12" class="xref">5.12</a>. <a href="#name-attribute-12-acl" class="xref">Attribute 12: acl</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-authorization-in-general" class="xref">Authorization in General</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-user-based-file-access-auth" class="xref">User-based File Access Authorization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-attributes-for-user-based-f" class="xref">Attributes for User-based File Access Authorization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-handling-of-multiple-parall" class="xref">Handling of Multiple Parallel File Access Authorization Models</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-posix-authorization-model" class="xref">Posix Authorization Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="xref">7.3.1</a>.  <a href="#name-attribute-33-mode" class="xref">Attribute 33: mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="xref">7.3.2</a>.  <a href="#name-nfsv41-attribute-74-mode_se" class="xref">NFSv4.1 Attribute 74: mode_set_masked</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-acl-based-authorization-mod" class="xref">ACL-based Authorization Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="xref">7.4.1</a>.  <a href="#name-processing-access-control-e" class="xref">Processing Access Control Entries</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="xref">7.4.2</a>.  <a href="#name-v41-attribute-58-dacl" class="xref">V4.1 Attribute 58: dacl</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-common-considerations-for-b" class="xref">Common Considerations for Both File access Models</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-server-considerations" class="xref">Server Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-client-considerations" class="xref">Client Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-combining-authorization-mod" class="xref">Combining Authorization Models</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-background-for-combined-aut" class="xref">Background for Combined Authorization Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-needed-attribute-coordinati" class="xref">Needed Attribute Coordination</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-computing-a-mode-attribute-" class="xref">Computing a Mode Attribute from an ACL</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-alternatives-in-computing-m" class="xref">Alternatives in Computing Mode Bits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-setting-multiple-acl-attrib" class="xref">Setting Multiple ACL Attributes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="xref">9.6</a>.  <a href="#name-setting-mode-and-not-acl-ov" class="xref">Setting Mode and not ACL (overall)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6.2.1">
                    <p id="section-toc.1-1.9.2.6.2.1.1"><a href="#section-9.6.1" class="xref">9.6.1</a>.  <a href="#name-setting-mode-and-not-acl-ve" class="xref">Setting Mode and not ACL (vestigial)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6.2.2">
                    <p id="section-toc.1-1.9.2.6.2.2.1"><a href="#section-9.6.2" class="xref">9.6.2</a>.  <a href="#name-setting-mode-and-not-acl-di" class="xref">Setting Mode and not ACL (Discussion)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6.2.3">
                    <p id="section-toc.1-1.9.2.6.2.3.1"><a href="#section-9.6.3" class="xref">9.6.3</a>.  <a href="#name-setting-mode-and-not-acl-pr" class="xref">Setting Mode and not ACL (Proposed)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="xref">9.7</a>.  <a href="#name-setting-acl-and-not-mode" class="xref">Setting ACL and Not Mode</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="xref">9.8</a>.  <a href="#name-setting-both-acl-and-mode" class="xref">Setting Both ACL and Mode</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a href="#section-9.9" class="xref">9.9</a>.  <a href="#name-retrieving-the-mode-and-or-" class="xref">Retrieving the Mode and/or ACL Attributes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10">
                <p id="section-toc.1-1.9.2.10.1"><a href="#section-9.10" class="xref">9.10</a>. <a href="#name-creating-new-objects" class="xref">Creating New Objects</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11">
                <p id="section-toc.1-1.9.2.11.1"><a href="#section-9.11" class="xref">9.11</a>. <a href="#name-use-of-inherited-acl-when-c" class="xref">Use of Inherited ACL When Creating Objects</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.12">
                <p id="section-toc.1-1.9.2.12.1"><a href="#section-9.12" class="xref">9.12</a>. <a href="#name-combined-authorization-mode" class="xref">Combined Authorization Models for NFSv4.2</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-labelled-nfs-authorization-" class="xref">Labelled NFS Authorization Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-state-modification-authoriz" class="xref">State Modification Authorization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-other-uses-of-access-contro" class="xref">Other Uses of Access Control Lists</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-v41-attribute-59-sacl" class="xref">V4.1 Attribute 59: sacl</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-identification-and-authenti" class="xref">Identification and Authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-identification-vs-authentic" class="xref">Identification vs. Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-items-to-be-identified" class="xref">Items to be Identified</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="xref">13.3</a>.  <a href="#name-authentication-provided-by-" class="xref">Authentication Provided by specific RPC Flavors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="xref">13.4</a>.  <a href="#name-authentication-provided-by-t" class="xref">Authentication Provided by the RPC Transport</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-security-of-data-in-flight" class="xref">Security of Data in Flight</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-data-security-provided-by-t" class="xref">Data Security Provided by the Flavor-associated Services</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-data-security-provided-by-th" class="xref">Data Security Provided by the RPC Transport</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-security-negotiation" class="xref">Security Negotiation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-flavors-and-pseudo-flavors" class="xref">Flavors and Pseudo-flavors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-negotiation-of-security-fla" class="xref">Negotiation of Security Flavors and Mechanisms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="xref">15.3</a>.  <a href="#name-negotiation-of-rpc-transpor" class="xref">Negotiation of RPC Transports and Characteristics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#section-15.4" class="xref">15.4</a>.  <a href="#name-overall-interpretation-of-s" class="xref">Overall Interpretation of SECINFO Response Arrays</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.1">
                    <p id="section-toc.1-1.15.2.4.2.1.1"><a href="#section-15.4.1" class="xref">15.4.1</a>.  <a href="#name-interpretation-of-secinfo-r" class="xref">Interpretation of SECINFO Response Arrays (Core)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.2">
                    <p id="section-toc.1-1.15.2.4.2.2.1"><a href="#section-15.4.2" class="xref">15.4.2</a>.  <a href="#name-connection-type-transcripti" class="xref">Connection Type Transcription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.3">
                    <p id="section-toc.1-1.15.2.4.2.3.1"><a href="#section-15.4.3" class="xref">15.4.3</a>.  <a href="#name-flavor-transcription" class="xref">Flavor Transcription</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#section-15.5" class="xref">15.5</a>.  <a href="#name-secinfo" class="xref">SECINFO</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.1">
                    <p id="section-toc.1-1.15.2.5.2.1.1"><a href="#section-15.5.4" class="xref">15.5.4</a>.  <a href="#name-secinfo-implementation-gene" class="xref">SECINFO IMPLEMENTATION (general)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.2">
                    <p id="section-toc.1-1.15.2.5.2.2.1"><a href="#section-15.5.5" class="xref">15.5.5</a>.  <a href="#name-secinfo-implementation-for-" class="xref">SECINFO IMPLEMENTATION (for NFSv4.0)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.3">
                    <p id="section-toc.1-1.15.2.5.2.3.1"><a href="#section-15.5.6" class="xref">15.5.6</a>.  <a href="#name-secinfo-implementation-for-n" class="xref">SECINFO IMPLEMENTATION (for NFSv4.1 and v4.2)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-future-security-needs" class="xref">Future Security Needs</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="xref">17.1</a>.  <a href="#name-changes-in-security-conside" class="xref">Changes in Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.1">
                    <p id="section-toc.1-1.17.2.1.2.1.1"><a href="#section-17.1.1" class="xref">17.1.1</a>.  <a href="#name-wider-view-of-threats" class="xref">Wider View of Threats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.2">
                    <p id="section-toc.1-1.17.2.1.2.2.1"><a href="#section-17.1.2" class="xref">17.1.2</a>.  <a href="#name-transport-layer-security-fa" class="xref">Transport-layer Security Facilities</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.3">
                    <p id="section-toc.1-1.17.2.1.2.3.1"><a href="#section-17.1.3" class="xref">17.1.3</a>.  <a href="#name-approach-to-implementation-" class="xref">Approach to Implementation Semantic Divergences</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.4">
                    <p id="section-toc.1-1.17.2.1.2.4.1"><a href="#section-17.1.4" class="xref">17.1.4</a>.  <a href="#name-compatibility-and-maturity-" class="xref">Compatibility and Maturity Issues</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.5">
                    <p id="section-toc.1-1.17.2.1.2.5.1"><a href="#section-17.1.5" class="xref">17.1.5</a>.  <a href="#name-discussion-of-auth_sys" class="xref">Discussion of AUTH_SYS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="xref">17.2</a>.  <a href="#name-security-considerations-sco" class="xref">Security Considerations Scope</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.1">
                    <p id="section-toc.1-1.17.2.2.2.1.1"><a href="#section-17.2.1" class="xref">17.2.1</a>.  <a href="#name-discussion-of-potential-cla" class="xref">Discussion of Potential Classification of Environments</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.2">
                    <p id="section-toc.1-1.17.2.2.2.2.1"><a href="#section-17.2.2" class="xref">17.2.2</a>.  <a href="#name-discussion-of-environments" class="xref">Discussion of Environments</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#section-17.3" class="xref">17.3</a>.  <a href="#name-major-new-recommendations" class="xref">Major New Recommendations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.1">
                    <p id="section-toc.1-1.17.2.3.2.1.1"><a href="#section-17.3.1" class="xref">17.3.1</a>.  <a href="#name-recommendations-regarding-s" class="xref">Recommendations Regarding Security of Data in Flight</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.2">
                    <p id="section-toc.1-1.17.2.3.2.2.1"><a href="#section-17.3.2" class="xref">17.3.2</a>.  <a href="#name-recommendations-regarding-c" class="xref">Recommendations Regarding Client Peer Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.3">
                    <p id="section-toc.1-1.17.2.3.2.3.1"><a href="#section-17.3.3" class="xref">17.3.3</a>.  <a href="#name-issues-regarding-valid-reas" class="xref">Issues Regarding Valid Reasons to Bypass Recommendations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a href="#section-17.4" class="xref">17.4</a>.  <a href="#name-data-security-threats" class="xref">Data Security Threats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5">
                <p id="section-toc.1-1.17.2.5.1"><a href="#section-17.5" class="xref">17.5</a>.  <a href="#name-authentication-based-threat" class="xref">Authentication-based threats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5.2.1">
                    <p id="section-toc.1-1.17.2.5.2.1.1"><a href="#section-17.5.1" class="xref">17.5.1</a>.  <a href="#name-attacks-based-on-the-use-of" class="xref">Attacks based on the use of AUTH_SYS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5.2.2">
                    <p id="section-toc.1-1.17.2.5.2.2.1"><a href="#section-17.5.2" class="xref">17.5.2</a>.  <a href="#name-attacks-on-name-userid-mapp" class="xref">Attacks on Name/Userid Mapping Facilities</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.6">
                <p id="section-toc.1-1.17.2.6.1"><a href="#section-17.6" class="xref">17.6</a>.  <a href="#name-disruption-and-denial-of-se" class="xref">Disruption and Denial-of-Service Attacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.6.2.1">
                    <p id="section-toc.1-1.17.2.6.2.1.1"><a href="#section-17.6.1" class="xref">17.6.1</a>.  <a href="#name-attacks-based-on-the-disrup" class="xref">Attacks Based on the Disruption of Client-Server Shared State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.6.2.2">
                    <p id="section-toc.1-1.17.2.6.2.2.1"><a href="#section-17.6.2" class="xref">17.6.2</a>.  <a href="#name-attacks-based-on-forcing-th" class="xref">Attacks Based on Forcing the Misuse of Server Resources</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#section-18.1" class="xref">18.1</a>.  <a href="#name-new-authstat-values" class="xref">New Authstat Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#section-18.2" class="xref">18.2</a>.  <a href="#name-new-authentication-pseudo-f" class="xref">New Authentication Pseudo-Flavors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="xref">19</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#section-19.1" class="xref">19.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#section-19.2" class="xref">19.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-changes-made" class="xref">Changes Made</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-motivating-changes" class="xref">Motivating Changes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-other-major-changes" class="xref">Other Major Changes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-issues-for-which-consensus-" class="xref">Issues for which Consensus Needs to be Ascertained</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-C" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="OVIEW">
<section id="section-1">
      <h2 id="name-overview">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-1-1">
 This document is intended to form the basis for a new
 description of NFSv4 security applying to all
 NFSv4 minor versions. The motivation for this new document and
 the need for major improvements in NFSv4 security are explained
 in <a href="#OVIEW-motive" class="xref">Section 1.1</a>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
 Because this document anticipates making major changes in material
 covered in previous standards-track RFCs, extensive working group
 discussion will be necessary to make sure that there is a working
 group consensus to make the changes being  proposed.  These
 changes include the major improvements mentioned above and
 changes necessary to suitably describe features currently in an
 unsatisfactory state as described in <a href="#UINTRO-needwork" class="xref">Section 3.4</a><a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="OVIEW-motive">
<section id="section-1.1">
        <h3 id="name-document-motivation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-document-motivation" class="section-name selfRef">Document Motivation</a>
        </h3>
<p id="section-1.1-1">
          A new treatment of security is necessary because:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">
     Previous treatments paid insufficient attention to security
     issues regarding data in flight.<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">
     The presentation of AUTH_SYS as an "'<span class="bcp14">OPTIONAL</span>'
     means of authentication" obscured the significant security
     problems that come with its use.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">
     The security considerations sections of existing minor
     version specifications contain no threat analyses and
     focus on particular security issues in a way that obscures,
     rather than clarifying, the security issues that need to
     be addressed.<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">
     The availability of RPC-with-TLS (described in
     <span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">12</a>]</span>) provides
     facilities that NFSv4 clients and servers will need to
     use to provide security for data in flight and mitigate
     the lack of authentication when AUTH_SYS is used.<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="OVIEW-notation">
<section id="section-1.2">
        <h3 id="name-document-annotation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-document-annotation" class="section-name selfRef">Document Annotation</a>
        </h3>
<p id="section-1.2-1">
   The first version of this preliminary document contained many
   notes with headers in brackets,
   requesting comments regarding confusing or otherwise dubious
   passages in existing documents and noting other choices that
   need
   to made.  Comments about and working group
   discussion of these issues will be important in
   arriving  at an adequate RFC candidate.  In this version, those
   specific items have been removed and are replaced by the sorts
   of items described below which show the troublesome existing text,
   explain the issues with it, and and provide a proposed replacement.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">
   In order to make further progress on these difficult issues,
   including many whose resolution will probably involve compatibility
   issues with existing implementations, the author has
   tried his best to resolve these issues, even though there is no
   assurance that the resolution adopted by consensus will match the
   author's current best efforts.  To provide a possible resolution
   that might be the basis of discussion while not foreclosing other
   possibilities, proposed changes are organized into a series of
   consensus items, which are listed in <a href="#ISSUES" class="xref">Appendix B</a>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">
   For such pending issues, the
   following annotations will be used:<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-4.1">
            <p id="section-1.2-4.1.1">
     A paragraph headed "[Author Aside]:", provides the author's
     comments about possible changes and will probably not appear
     in an eventual RFC.<a href="#section-1.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-1.2-4.1.2">
     This paragraph can specify that certain changes within
     the current section are to be implicitly considered as
     part of a specific consensus item.<a href="#section-1.2-4.1.2" class="pilcrow">¶</a></p>
<p id="section-1.2-4.1.3">
     The paragraph can indicate that all unannotated material in
     the current section is to be considered either the previous
     treatment or the proposed replacement text for a specific
     consensus item.<a href="#section-1.2-4.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-4.2">
            <p id="section-1.2-4.2.1">
     A paragraph headed "[Consensus Needed (Item #NNx)]:",
     provides the author's
     preferred treatment of the matter and should only appear in the
     eventual RFC if working group consensus on the matter is
     obtained allowing the necessary changes to be made permanent,
     without being conditional on a future consensus.<a href="#section-1.2-4.2.1" class="pilcrow">¶</a></p>
<p id="section-1.2-4.2.2">
     The item id, represented above by "NNx" consists of a number
     identifying  the specific consensus item and letter which is
     unique to appearance of that consensus item in a particular
     section. In cases in which a pending item is cited with no
     part of the discussion appearing in the current section,
     an item id of the form "#NN" is used.<a href="#section-1.2-4.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-4.3">
            <p id="section-1.2-4.3.1">
     A paragraph headed "[Previous Treatment]:", indicates text that
     is provided for context but which the author believes, should
     not appear in the eventual RFC, because it is expected to
     be superseded by a corresponding consensus item<a href="#section-1.2-4.3.1" class="pilcrow">¶</a></p>
<p id="section-1.2-4.3.2">
     The corresponding consensus item is often easily inferred, but
     can be specified explicitly, as it is for items associated
     with the
     consensus item itself.<a href="#section-1.2-4.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-5">
   Each of the annotations above can be modified by addition of the
   phrase, "Including List" to indicate that it applies to a following
   bulleted list as well as the current paragraph.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="REQL">
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<div id="REQL-def">
<section id="section-2.1">
        <h3 id="name-keyword-definitions">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-keyword-definitions" class="section-name selfRef">Keyword Definitions</a>
        </h3>
<p id="section-2.1-1">
   The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
   "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
   "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
   "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>",
   "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>"
   in this document are to be
   interpreted as specified in BCP 14 <span>[<a href="#RFC2119" class="xref">1</a>]</span>
          <span>[<a href="#RFC8174" class="xref">5</a>]</span> when, and only when,
   they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="REQL-special">
<section id="section-2.2">
        <h3 id="name-special-considerations">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-special-considerations" class="section-name selfRef">Special Considerations</a>
        </h3>
<p id="section-2.2-1">
          Because this document needs to revise previous treatments of
   its subject, it will need to cite previous treatments of issues
   that now need to be dealt with in a different way.  This will
   take the form of quotations from documents whose treatment
   of the subject is being obsoleted, most often direct but
   sometimes indirect as well.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">
   Paragraphs headed "[Previous
   Treatment] or otherwise annotated as having that status,
   as described in <a href="#OVIEW" class="xref">Section 1</a>, can be considered
   quotations in this context.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">
          Such treatments in quotations will involve use of these
   BCP14-defined terms in two noteworthy ways:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-4.1">
            <p id="section-2.2-4.1.1">
     The term may have been used inappropriately (i.e not in accord
     with <span>[<a href="#RFC2119" class="xref">1</a>]</span>), as has been the case
     for the "<span class="bcp14">RECOMMENDED</span>" attributes, which are in
     fact <span class="bcp14">OPTIONAL</span>.<a href="#section-2.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-2.2-4.1.2">
     In such cases, the surrounding text will make clear that the
     quoted text does not have a normative effect.<a href="#section-2.2-4.1.2" class="pilcrow">¶</a></p>
<p id="section-2.2-4.1.3">
     Some specific issues relating to this case are
     described below <a href="#AUTHFA-attr" class="xref">Section 7.1</a>.<a href="#section-2.2-4.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-4.2">
            <p id="section-2.2-4.2.1">
     The term may been used in accord with <span>[<a href="#RFC2119" class="xref">1</a>]</span>,
     although the resulting normative statement is now felt to be
     inappropriate.<a href="#section-2.2-4.2.1" class="pilcrow">¶</a></p>
<p id="section-2.2-4.2.2">
     In such cases, the surrounding text will need to make clear
     that the text quoted is no longer to be considered normative,
     often by providing new text that conflicts with the quoted,
     previously normative, text.<a href="#section-2.2-4.2.2" class="pilcrow">¶</a></p>
<p id="section-2.2-4.2.3">
            An important instance of this situation is the description of
     AUTH_SYS as an "<span class="bcp14">OPTIONAL</span>" means of authentication.
     For detailed discussion of this case, see Sections
     <a href="#IDENT" class="xref">13</a> and
     <a href="#SECCON-changes-authsys" class="xref">17.1.5</a><a href="#section-2.2-4.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="UINTRO">
<section id="section-3">
      <h2 id="name-introduction-to-this-update">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-introduction-to-this-update" class="section-name selfRef">Introduction to this Update</a>
      </h2>
<p id="section-3-1">
      There are a number of noteworthy aspects to the updated approach
      to NFSv4
      security presented in this document:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">
 There is a major rework of the security framework to take advantage
 of work done in RPC-with-TLS, as described in
 <a href="#OVIEW-motive" class="xref">Section 1.1</a>.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3-2.1.2">
 NFSv4 security is still built on RPC, as had been done previously.
 However, it is now able to take advantage of security-related
 transport
 properties.  For more information about this transformation, see
 <a href="#UINTRO-xport" class="xref">Section 3.1</a>.<a href="#section-3-2.1.2" class="pilcrow">¶</a></p>
<p id="section-3-2.1.3">
        For an overview of changes made so far as part of this rework,
        see <a href="#CHG-motive" class="xref">Appendix A.1</a>.<a href="#section-3-2.1.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">
 This document deals with all minor versions together, although there
 is a need for exceptions to deal with, for example, pNFS security.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3-2.2.2">
        For more detail about how minor version differences will be
        addressed, see
        Sections <a href="#UINTRO-mult" class="xref">3.2</a> and
 <a href="#UINTRO-feat" class="xref">3.3</a>.<a href="#section-3-2.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1">
 There is a new Security Considerations section including a
 threat analysis.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.4">
          <p id="section-3-2.4.1">
 There has been extensive work to clarify the multiple types of
 authorization within NFSv4 and deal more completely with the
 co-ordination of ACL-based and mode-based file access authorization.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="UINTRO-xport">
<section id="section-3.1">
        <h3 id="name-transport-based-security-fe">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-transport-based-security-fe" class="section-name selfRef">Transport-based Security Features</a>
        </h3>
<p id="section-3.1-1">
   There are a number of security-related facilities that can be
   provided at the transport layer eliminating the need to
   provide such support to as part of RPC proper.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
   These will initially be provided by RPC-with-TLS but similar
   facilities might be provided by new versions of existing
   transports or new RPC transports.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">
            <p id="section-3.1-3.1.1">
     The transport might provide encryption of requests and replies,
     eliminating the need for privacy and integrity services to be
     negotiated later and applied
     on a per-request basis.<a href="#section-3.1-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-3.1.2">
     While clients might choose to establish connections with such
     encryption, servers can establish policies allowing access to
     certain pieces of the namespace using such transports, or
     limiting access to those providing privacy, allowing the use
     of either transport-based encryption or privacy services
     provided by RPCSEC_GSS.<a href="#section-3.1-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">
     The transport might provide mutual authentication of the client
     and server peers as part of the establishment of the connection
     This authentication is distinct from the the mutual
     authentication
     of the client user and server peer, implemented within the
     GSSSEC_RPC framework.<a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.1-3.2.2">
     This form of authentication is of particular importance when 
     when the server allows the use of the flavors AUTH_SYS and
     AUTH_NONE, which have no provision for the authentication of the
     user requesting the operation.<a href="#section-3.1-3.2.2" class="pilcrow">¶</a></p>
<p id="section-3.1-3.2.3">
     While clients might choose, on their own,to establish
     connections with such
     peer authentication, servers can establish policies a limiting
     access to certain pieces of the namespace without such peer
     authentication or only allowing it when using RPCSEC_GSS.<a href="#section-3.1-3.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-4">
   To enable server policies to be effectively communicated to
   clients, the security negotiation framework now allows
   connection characteristics to be specified using pseudo-flavors
   returned as part of the response to SECINFO and SECINFO_NONAME.
   See <a href="#NEGO" class="xref">Section 15</a> for details.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="UINTRO-mult">
<section id="section-3.2">
        <h3 id="name-handling-of-multiple-minor-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-handling-of-multiple-minor-" class="section-name selfRef">Handling of Multiple Minor Versions</a>
        </h3>
<p id="section-3.2-1">
   In some cases, there are differences between minor versions in
   that there are security-related features, not present in all
   minor versions.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
   To deal with this issue, this document will focus on a few
   major areas listed below which are common to all minor versions.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">
     File access authorization (discussed in <a href="#AUTHFA" class="xref">Section 7</a>)
     is the same in all minor versions together with the
     identification/
     authentication infrastructure supporting it (discussed in
     <a href="#IDENT" class="xref">Section 13</a>) provided by RPC and applying to all
     of NFS.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.1.2">
     An exception is made regarding labelled NFS, an optional
     feature within NFSv4.2, described in <span>[<a href="#RFC7862" class="xref">10</a>]</span>.
     This is discussed as a version-specific feature in this
     document in <a href="#AUTHL" class="xref">Section 10</a><a href="#section-3.2-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">
     Features to secure data in-flight, all provided by RPC,
     together with the negotiation infrastructure to support
     them are common to all NFSv4 minor versions, are discussed in
     <a href="#NEGO" class="xref">Section 15</a><a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.2.2">
     However, the use of SECINFO_NONAME, together with changes
     needed for transport level encryption, paralleling those
     proposed here for SECINFO, is treated as a version-specific
     feature and, while mentioned here, will be fully documented
     in new NFSv4.1 specification documents.<a href="#section-3.2-3.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">
     The protection of state data from unauthorized modification
     is discussed in <a href="#AUTHST" class="xref">Section 11</a>)
     is the same in all minor versions together with the
     identification/
     authentication infrastructure supporting it (discussed in
     <a href="#IDENT" class="xref">Section 13</a>) provided by secure transports such
     as RPC-over-TLS.<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.3.2">
     It should be noted that state protection based on RPCSEC_GSS
     is treated as a version-specific feature and will continue to be
     described by <span>[<a href="#RFC8881" class="xref">8</a>]</span> or its successors. Also,
     it needs to be noted that the use of state protection was not
     discussed in <span>[<a href="#RFC7530" class="xref">6</a>]</span>.<a href="#section-3.2-3.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="UINTRO-feat">
<section id="section-3.3">
        <h3 id="name-handling-of-minor-version-s">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-handling-of-minor-version-s" class="section-name selfRef">Handling of Minor-version-specific features</a>
        </h3>
<p id="section-3.3-1">
   There are a number of areas in which security features differ among
   minor versions, as discussed below.  In some cases, a new
   feature requires specific security support while in others
   one version will have a new feature related to enhancing the
   security infrastructure.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
   How such features are dealt with in this document depends on
   the specific feature.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-3.1">
            <p id="section-3.3-3.1.1">
            In addition to SECINFO, whose enhanced description appears in
     this document, NFSv4.1 added a new SECINFO_NONAME operation,
     useful for pNFS file as well as having some non-pNFS uses.<a href="#section-3.3-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.1.2">
            While the enhanced description of SECINFO mentions SECINFO_NONAME,
     this is handled as one of a number of cases in which the
     description has to indicate that different actions need to be
     taken for different minor versions.<a href="#section-3.3-3.1.2" class="pilcrow">¶</a></p>
<p id="section-3.3-3.1.3">
            The definitive description of SECINFO_NONAME, now appearing in
     RFC8881 needs to be modified to match the description of SECINFO
     appearing in this document.  It is expected that this will be
     done as part of the rfc5661bis process.<a href="#section-3.3-3.1.3" class="pilcrow">¶</a></p>
<p id="section-3.3-3.1.4">
     The security implications of the security negotiation
     facilities as a whole will be addressed in the security
     considerations section of this document.<a href="#section-3.3-3.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.2">
            <p id="section-3.3-3.2.1">
            The pNFS optional  feature added in NFSv4.1 has its own
     security needs which parallel closely those of non-pNFS
     access but are distinct, especially when the storage access
     protocol used are not RPC protocols. As a result,
     these needs and the means to satisfy
     them are not discussed in this document.<a href="#section-3.3-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.2.2">
            The definitive description of pNFS security will remain in RFC8881
     and its successors (i.e. the rfc5661bis document suite).  However,
     because pNFS security relies heavily on the infrastructure
     discussed here, it is anticipated that the new treatment of
     pNFS security will deal with many matters by referencing
     the overall NFS security
     document.<a href="#section-3.3-3.2.2" class="pilcrow">¶</a></p>
<p id="section-3.3-3.2.3">
            The security considerations section of rfc5661bis will deal with
     pNFS security issues.<a href="#section-3.3-3.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.3">
            <p id="section-3.3-3.3.1">
            In addition to the state protection facilities described
     in this document, NFS has another set of such facilities that
     are only implemented in NFSv4.1.<a href="#section-3.3-3.3.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.3.2">
     While this document will discuss the security implications of
     protection against state modification, it will not discuss the
     details of the NFSv4.1-specific features to accomplish it.<a href="#section-3.3-3.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.4">
            <p id="section-3.3-3.4.1">
     The additional NFSv4.1 acl attributes, sacl and dacl, are discussed
     in this document, together with the ACL inheritance features
     they enable.<a href="#section-3.3-3.4.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.4.2">
     As a result, the responsibility for the definitive description
     of these attributes will move to overall NFS security document,
     with the fact that they are not available in NFSv4.0 duly noted.
     While these attributes will continue to be mentioned in
     NFSv4.1 specification documents, the detailed description
     appearing in RFC8881 will be removed in successor documents.<a href="#section-3.3-3.4.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.5">
            <p id="section-3.3-3.5.1">
     Both NFSv4.0 and NFSv4.1 specifications discussed the
     coordination of the values the mode and ACL-related attributes.
     While the treatment in RFC8881 is more detailed, the differences
     in the approaches are quite minor.<a href="#section-3.3-3.5.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.5.2">
     [Consensus Item #25a]:
     This document will provide a unified treatment of these issues,
     which will note any differences of treatment that
     apply to NFSv4.0.  Changes applying to NFSv4.2 will also be noted.<a href="#section-3.3-3.5.2" class="pilcrow">¶</a></p>
<p id="section-3.3-3.5.3">
     As a result, this document will override the treatment within
     RFC7530 and RFC8881. This material will be removed in the
     rfc5661bis
     document suite and replaced by a reference to the treatment in
     the NFSv4 security RFC.<a href="#section-3.3-3.5.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.6">
            <p id="section-3.3-3.6.1">
     The protocol extension defined in <span>[<a href="#RFC8257" class="xref">13</a>]</span>,
     now part of NFSv4.2, is also related to the issue of
     co-ordination of acl and mode attributes and will be discussed
     in that context.<a href="#section-3.3-3.6.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.6.2">
     Nevertheless, the description in <span>[<a href="#RFC8257" class="xref">13</a>]</span>
     will remain definitive.<a href="#section-3.3-3.6.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.7">
            <p id="section-3.3-3.7.1">
     The NFSv4.1 attribute set-mode-masked attribute is mentioned
     together with the
     other attributes implementing the POSIX authorization model.<a href="#section-3.3-3.7.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.7.2">
     Because this attribute. while related to security, does not
     substantively modify the security properties of the protocol,
     the full description of this attribute, will continue to be
     the province of the NFSv4.1 specification proper.<a href="#section-3.3-3.7.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.8">
            <p id="section-3.3-3.8.1">
     There is a brief description of the v4.2 Labelled NFS feature
     in <a href="#AUTHL" class="xref">Section 10</a>.   Part of that description
     discusses the limitations in the description of that feature
     within <span>[<a href="#RFC7862" class="xref">10</a>]</span>.<a href="#section-3.3-3.8.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.8.2">
     Because of some limitations in the description, it is not
     possible to provide an appropriate security considerations
     section for that feature in this document.<a href="#section-3.3-3.8.2" class="pilcrow">¶</a></p>
<p id="section-3.3-3.8.3">
     As a result, the responsibility for providing an appropriate
     Security Considerations section remains, unrealized for now,
     with the NFSv4.2 specification document and its possible
     successors.<a href="#section-3.3-3.8.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="UINTRO-needwork">
<section id="section-3.4">
        <h3 id="name-features-needing-extensive-">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-features-needing-extensive-" class="section-name selfRef">Features Needing Extensive Clarification</a>
        </h3>
<p id="section-3.4-1">
   For a number of authorization-related features, the existing
   descriptions
   are inadequate for various reasons:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">
     In the description of the the use of the mode attribute
     in implementing the POSIX-based authorization model,
     critical pieces of the semantics are not mentioned, while,
     ironically, the corresponding semantics for ACL-based
     authorization are discussed.<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.1.2">
     This includes the authorization of file deletion and of
     modification of the mode, owner and owner-group attributes.
     For ACL-based authorization, there is a an attempt to
     provide the description.<a href="#section-3.4-2.1.2" class="pilcrow">¶</a></p>
<p id="section-3.4-2.1.3">
     The situation for authorization of RENAME is similar, although,
     in this case, the corresponding semantics for the ACL case are
     also absent.<a href="#section-3.4-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">
     The description of authorization for ACLs is more complete
     but it needs further work, because the previous specifications
     make extensive efforts, in my view misguided, to allow an
     enormous range of server behaviors, making it hard for a
     client to know what the effect of many actions, and the
     corresponding security-related consequences, might be.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.2">
     Troublesome in this connection are the discussion of ACE mask bits
     which essentially treats every mask bit, as its own OPTIONAL
     feature, the use of "<span class="bcp14">SHOULD</span>" and
     "<span class="bcp14">SHOULD NOT</span>" in situations which it is
     unclear what valid reasons to ignore the recommendation might be,
     and cases in which it is is simply stated that some servers do some
     particular thing, leaving the unfortunate implication that clients
     need to be prepared for a vast range of server behaviors.<a href="#section-3.4-2.2.2" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.3">
     This approach essentially treated ACLs in a manner appropriate
     to an experimental feature.<a href="#section-3.4-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.3">
            <p id="section-3.4-2.3.1">
     Similar issues apply to descriptions related to the need
     to co-ordinate the values
     of the mode attribute and the ACL-related attributes.<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.3.2">
     Although the need for such coordination is recognized.  There
     are multiple modes of mapping an ACL  to a
     corresponding mode together with multiple sources of
     uncertainty about the reverse mapping.<a href="#section-3.4-2.3.2" class="pilcrow">¶</a></p>
<p id="section-3.4-2.3.3">
     In addition, certain of the mapping algorithms have flaws in that
     their behavior under unusual circumstances give results
     that appear erroneous.<a href="#section-3.4-2.3.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-3">
   Dealing with these issues is not straightforward, because
   the appropriate resolution will depend on:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-4.1">
            <p id="section-3.4-4.1.1">
     The actual existence of server implementations with non-preferred
     semantics.<a href="#section-3.4-4.1.1" class="pilcrow">¶</a></p>
<p id="section-3.4-4.1.2">
     In some cases in which "<span class="bcp14">SHOULD</span>" was used, there may
     not have been any actual severs choosing to ignore the
     recommendation, eliminating the possibility of compatibility
     issues when changing the "<span class="bcp14">SHOULD</span>" to a formulation
     that restricts the server's choices.<a href="#section-3.4-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.2">
            <p id="section-3.4-4.2.1">
     The difficulty of modifying server implementations to eliminate
     or narrow the effect of non-standard semantics.<a href="#section-3.4-4.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-4.2.2">
     One aspect of that difficulty might be client or application
     expectations based on existing server implementations, even if
     the existing specifications give the client no assurance that
     that server's behavior is mandated by the standard.<a href="#section-3.4-4.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.3">
            <p id="section-3.4-4.3.1">
     Whether the existing flaw in some existing recommended actions to
     be performed by the server is sufficiently troublesome to justify
     changing the specification at this point.<a href="#section-3.4-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-5">
   This sort of information will be used in deciding whether to:<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">
            <p id="section-3.4-6.1.1">
            Narrow the scope of allowable server behavior to those actually
     used by existing severs.<a href="#section-3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.2">
            <p id="section-3.4-6.2.1">
            Limiting the  negative effects of unmotivated
     <span class="bcp14">SHOULD</span>s
     by limiting valid reasons to ignore the recommendation to
     the difficulty of changing existing implementations.<a href="#section-3.4-6.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-6.2.2">
     This would give significant guidance to future implementations,
     while forcing clients to live with the uncertainty about existing
     servers<a href="#section-3.4-6.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.3">
            <p id="section-3.4-6.3.1">
     Tie a more restricted set of semantics to nominally unrelated
     OPTIONAL features such as implementation of dacl and sacl.<a href="#section-3.4-6.3.1" class="pilcrow">¶</a></p>
<p id="section-3.4-6.3.2">
     This would provide a way to allow the development of newer servers
     to proceed in a way that<a href="#section-3.4-6.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.4">
            <p id="section-3.4-6.4.1">
     Provide means that clients to use to determine, experimentally,
     what semantics
     are provided by the server.<a href="#section-3.4-6.4.1" class="pilcrow">¶</a></p>
<p id="section-3.4-6.4.2">
     Would need to be supported by a requirement/assurance that
     a server behave uniformly, at least within the scope of a
     single filesystem.<a href="#section-3.4-6.4.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.5">
            <p id="section-3.4-6.5.1">
     Allow the provision of other ways for the client to know the
     semantics choices made by the server.<a href="#section-3.4-6.5.1" class="pilcrow">¶</a></p>
<p id="section-3.4-6.5.2"></p>
</li>
        </ul>
<p id="section-3.4-7">
   Despite the difficulty of addressing these issues, if the
   protocol is to be secure and ACLs are to be widely available,
   these problems must be addressed.   While there has not been
   significant effort to provide client-side ACL APIs and there
   might not be for a while, we cannot have a situation if which the
   security specification makes that development essentially impossible.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="UINTRO-wip">
<section id="section-3.5">
        <h3 id="name-process-going-forward">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-process-going-forward" class="section-name selfRef">Process Going Forward</a>
        </h3>
<p id="section-3.5-1">
   Because of the scope of this document, and the fact that it
   is necessary to modify previous treatments of the subject
   previously published as Proposed Standards, it is necessary
   that the process of
   determining whether there is Working Group Consensus to submit
   it for publication be more structured than that used for
   the antecedent documents.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">
   In order to facilitate this process, the necessary changes which
   need to be made, beyond those clearly editorial in nature, are listed
   in <a href="#ISSUES" class="xref">Appendix B</a>.  As working group review and discussion
   of this document and its successors proceeds, there will be occasion
   to
   discuss each of these changes, identified by the annotations
   described in <a href="#OVIEW-notation" class="xref">Section 1.2</a>.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">
   Based on working group discussions, successive document versions
   will do one of the following for some set of consensus items:<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-4.1">
            <p id="section-3.5-4.1.1">
     Deciding that the replacement text is now part of a new
     working group consensus.<a href="#section-3.5-4.1.1" class="pilcrow">¶</a></p>
<p id="section-3.5-4.1.2">
     When this happens, future drafts of the document will be
     modified to remove the previous treatment, treat the proposed
     text as adopted, and remove Author Asides or replace them
     by new text explaining why a new treatment of the matter has been
     adopted or pointing the reader to an explanation in
     <a href="#CHG" class="xref">Appendix A</a>.<a href="#section-3.5-4.1.2" class="pilcrow">¶</a></p>
<p id="section-3.5-4.1.3">
     At this point, the consensus item will be removed from
     <a href="#ISSUES" class="xref">Appendix B</a> and an explanation for the change
     will be added to <a href="#CHG" class="xref">Appendix A</a>.<a href="#section-3.5-4.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-4.2">
            <p id="section-3.5-4.2.1">
     Deciding that the general approach to the issue, if not
     necessarily the specific current text has reached the point
     of "general acceptance" as defined in <a href="#ISSUES" class="xref">Appendix B</a><a href="#section-3.5-4.2.1" class="pilcrow">¶</a></p>
<p id="section-3.5-4.2.2">
     In this case, to facilitate discussion of remaining issues, the
     text of the document proper will remain as it is.<a href="#section-3.5-4.2.2" class="pilcrow">¶</a></p>
<p id="section-3.5-4.2.3">
     At this point, the consensus item will be marked within the 
     table in <a href="#ISSUES" class="xref">Appendix B</a> as having reached general
     acceptance, indicating the need to prioritize discussion in
     the next document cycle, aimed at arriving at final text to
     address the issue.<a href="#section-3.5-4.2.3" class="pilcrow">¶</a></p>
<p id="section-3.5-4.2.4">
     In addition,  an explanation for the change
     will be added to <a href="#CHG" class="xref">Appendix A</a>.<a href="#section-3.5-4.2.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-4.3">
            <p id="section-3.5-4.3.1">
     Deciding that modification of the existing text is necessary to
     facilitate eventual consensus, based on the working group's
     input.<a href="#section-3.5-4.3.1" class="pilcrow">¶</a></p>
<p id="section-3.5-4.3.2">
     In this case, there will be changes to the document proper in
     the next draft revision.  In some cases, because of the need for
     a coherent description, text outside the consensus item may be
     affected.<a href="#section-3.5-4.3.2" class="pilcrow">¶</a></p>
<p id="section-3.5-4.3.3">
     The table in <a href="#ISSUES" class="xref">Appendix B</a> will be updated to
     reflect the new item status while <a href="#CHG" class="xref">Appendix A</a> is
     not expected to change.<a href="#section-3.5-4.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-4.4">
            <p id="section-3.5-4.4.1">
     Deciding that the item is best dropped in the next draft.<a href="#section-3.5-4.4.1" class="pilcrow">¶</a></p>
<p id="section-3.5-4.4.2">
     In this case, the changes to the document proper will be the
     inverse of those when a change is accepted by consensus.  The
     previous treatment will be restored as the current text while
     the proposed new text will vanish from the document at the next
     draft revision.  The Author Aside will be the basis for an
     explanation of the
     consequences of not dealing with the issue.<a href="#section-3.5-4.4.2" class="pilcrow">¶</a></p>
<p id="section-3.5-4.4.3">
     At this point, the consensus item will be removed from
     <a href="#ISSUES" class="xref">Appendix B</a>.<a href="#section-3.5-4.4.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.5-5">
   The changes that the working group will need to reach consensus
   on, either to accept (as-is or with significant modifications) or
   reject can be divided into three groups.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-6.1">
            <p id="section-3.5-6.1.1">
     A large set of changes, all addressing issues mentioned in
     <a href="#OVIEW-motive" class="xref">Section 1.1</a>, were already present in the initial
     I-D so that there has been the opportunity for working group
     discussion of them, although that discussion has been quite
     limited so far.<a href="#section-3.5-6.1.1" class="pilcrow">¶</a></p>
<p id="section-3.5-6.1.2">
     As a result, a small set of these changes is marked, in
     <a href="#ISSUES" class="xref">Appendix B</a>, as having reached general acceptance.<a href="#section-3.5-6.1.2" class="pilcrow">¶</a></p>
<p id="section-3.5-6.1.3">
     That subset of these changes changes, together with the
     organizational changes to
     support them are described in <a href="#CHG-motive" class="xref">Appendix A.1</a>.<a href="#section-3.5-6.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-6.2">
            <p id="section-3.5-6.2.1">
     Another large set of changes were made in draft -02.
     These mostly concern the issues mentioned in
     <a href="#UINTRO-needwork" class="xref">Section 3.4</a> None of these changes is
     yet considered to have reached general acceptance.<a href="#section-3.5-6.2.1" class="pilcrow">¶</a></p>
<p id="section-3.5-6.2.2">
     The organizational changes to support these changes are
     described in <a href="#CHG-other" class="xref">Appendix A.2</a>.<a href="#section-3.5-6.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-6.3">
            <p id="section-3.5-6.3.1">
     There remain a set of potential changes for which a need
     is expected but for which no text is yet available.<a href="#section-3.5-6.3.1" class="pilcrow">¶</a></p>
<p id="section-3.5-6.3.2">
     Such changes have associated Author Asides and are listed in
     <a href="#ISSUES" class="xref">Appendix B</a>.<a href="#section-3.5-6.3.2" class="pilcrow">¶</a></p>
<p id="section-3.5-6.3.3">
     The text for these changes is expected to be made available
     in future document revisions and they will be processed then,
     in the same way as other changes will be processed now.<a href="#section-3.5-6.3.3" class="pilcrow">¶</a></p>
<p id="section-3.5-6.3.4">
     If and when such changes reach general acceptance, they will
     be explained in the appropriate subsection of <a href="#CHG" class="xref">Appendix A</a>.<a href="#section-3.5-6.3.4" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="INTRO">
<section id="section-4">
      <h2 id="name-introduction-to-nfsv4-secur">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-introduction-to-nfsv4-secur" class="section-name selfRef">Introduction to NFSv4 Security</a>
      </h2>
<p id="section-4-1">
      Because the basic approach to security issues is so similar for all
      minor versions, this document applies to all NFSv4 minor versions. The
      details of the transition to an NFSv4-wide document
      are discussed in Sections <a href="#UINTRO-mult" class="xref">3.2</a>
      and <a href="#UINTRO-feat" class="xref">3.3</a>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
      NFSv4 security is built on facilities provided by the RPC layer,
      including various authentication flavors and underlying transports.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
      [Consensus Needed, Including List (Item #1a)}:
      Support for multiple authentication flavors can be provided.
      Not all of these actually
      provide authentication, as discussed in <a href="#IDENT" class="xref">Section 13</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">
          <p id="section-4-4.1.1">
 Support for RPCSEC_GSS is <span class="bcp14">REQUIRED</span>, although
 use of other flavors is provided for.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
<p id="section-4-4.1.2">
        This flavor provides for mutual authentication of the principal
        making the request and the server performing it.<a href="#section-4-4.1.2" class="pilcrow">¶</a></p>
<p id="section-4-4.1.3">
 This flavor allows the client to request the provision of
 encryption-based services to provide privacy or integrity
 for specific requests.  Although such services are often provided
 by the underlying RPC transport, this support is useful, when
 the transport services are not supported or are otherwise
 unavailable.<a href="#section-4-4.1.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.2">
          <p id="section-4-4.2.1">
 AUTH_SYS, provides identification of the principal making the
 request but <span class="bcp14">SHOULD NOT</span> be used unless the
 client peer sending the request can be authenticated and there
 is protection against the modification of the request in flight.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
<p id="section-4-4.2.2">
        Both of the above require transport-level support.<a href="#section-4-4.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.3">
          <p id="section-4-4.3.1">
 AUTH_NONE does not provide identification of the principal making
 the request so only should be used for requests for which there
 is no such principal or for which it would irrelevant.<a href="#section-4-4.3.1" class="pilcrow">¶</a></p>
<p id="section-4-4.3.2">
        The restrictions mentioned above for AUTH_SYS apply to AUTH_NONE
        as well.<a href="#section-4-4.3.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-5">
      [Consensus Needed, Including List (Item #1a)}:
      There are important services that can be provided by the RPC transport
      when RPC-with-TLS is available, or when other transports provide
      similar services<a href="#section-4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-6.1">
          <p id="section-4-6.1.1">
 The transport can provide data security to all requests on the.
 This is to be preferred to data security provided by the authentication
 flavor because it provides protection to the request headers, because
 it applies to requests using all authentication flavors, and because
 it is more likely to be offloadable.<a href="#section-4-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-6.2">
          <p id="section-4-6.2.1">
 The transport can authenticate the server to the client peer.  This
 is desirable since that authentication applies even when AUTH_SYS or
 AUTH_NONE is used.<a href="#section-4-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-6.3">
          <p id="section-4-6.3.1">
 The transport can authenticate the client-peer to the server at the
 time the connection is set up.  This is essential to allow
 AUTH_SYS to be used with a modicum of security, based on the
 server's level of trust with regard to the client peer.<a href="#section-4-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-7">
      [Consensus Needed (Item #2a)}:
      Because important security-related services depend on the transport
      used, rather the authentication, the process of security negotiation,
      described in <a href="#NEGO" class="xref">Section 15</a> provides for the negotiation of
      an appropriate transport at connection time if the server's policy
      limits the range of transports being used and also when use of
      a particular transport/flavor combination causes
      NFS4ERR_WRONGSEC to be returned,<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">
      [Consensus Needed (Item #1a)}:
      The authentication provided by RPC, is used to provide the basis
      of authorization, which is discussed
      in general in <a href="#AUTHG" class="xref">Section 6</a>. This includes file access
      authorization, discussed in Sections
      <a href="#AUTHFA" class="xref">7</a> through
      <a href="#AUTHCOMB" class="xref">9</a> and state modification
      authorization, discussed in <a href="#AUTHST" class="xref">Section 11</a><a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">
      File access is controlled by the server support for and client use of
      certain recommended attributes, as described in
      <a href="#AUTHFA-attr" class="xref">Section 7.1</a>.  Multiple file access model are
      provided for and the considerations discussed in
      <a href="#AUTHCOMM" class="xref">Section 8</a> apply to all of them.<a href="#section-4-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-10.1">
          <p id="section-4-10.1.1">
 The mode attribute provides a POSIX-based authorization model, as
 described in <a href="#AUTHFA-posix" class="xref">Section 7.3</a><a href="#section-4-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-10.2">
          <p id="section-4-10.2.1">
 The ACL-related attributes acl, sacl, and dacl (the last two
 introduced in NFSv4.1) support a finer grained authorization model
 and provide
 additional securiy-related services.  The structure of ACLs is
 described in <a href="#ACL" class="xref">Section 5</a>.<a href="#section-4-10.2.1" class="pilcrow">¶</a></p>
<p id="section-4-10.2.2">
        The ACL-based authorization model is described in
        <a href="#AUTHFA-acl" class="xref">Section 7.4</a><a href="#section-4-10.2.2" class="pilcrow">¶</a></p>
<p id="section-4-10.2.3">
        The additional security-related services are described in
        <a href="#OTHACL" class="xref">Section 12</a>.  These also rely on the authentication
 provided by RPC.<a href="#section-4-10.2.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-10.3">
          <p id="section-4-10.3.1">
 Because there are two different approaches  to file-access
 authorization, servers might implement both, in which case
 the associated attributes need to be coordinated as described
 in <a href="#AUTHCOMB" class="xref">Section 9</a>.<a href="#section-4-10.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-10.4">
          <p id="section-4-10.4.1">
 NFSv4.2 provides an file access authorization model oriented toward
 Mandatory Access Control.  It is described in <a href="#AUTHL" class="xref">Section 10</a>.
 For reasons described there, its security properties are hard to
 analyze in detail and this document will not consider it as part
 of the NFSv4 threat analysis.<a href="#section-4-10.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-11">
      Authorization of locking state modification is discussed in
      <a href="#AUTHST" class="xref">Section 11</a>.  This form of authorization relies
      on the authentication of the client peer as opposed to file
      access authorization, which relies on authentication of the
      client principal.<a href="#section-4-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ACL">
<section id="section-5">
      <h2 id="name-structure-of-access-control">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-structure-of-access-control" class="section-name selfRef">Structure of Access Control Lists</a>
      </h2>
<p id="section-5-1">
      Access Control Lists consisting of multiple Access Control Elements,
      while originally designed to support a more
      flexible authorization model, have multiple uses within NFSv4,  with
      the use of each element depending on its type, as defined in
      <a href="#ACL-acetype" class="xref">Section 5.2</a><a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">
 They may be used to provide a more flexible authorization model
 as described in <a href="#AUTHFA-acl" class="xref">Section 7.4</a>.   This involves
 use of Access Control Entries of the ALLOW and DENY types.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">
 They may be used to provide the security-related services
 described in <a href="#OTHACL" class="xref">Section 12</a>. This involves
 use of Access Control Entries of the AUDIT and ALARM types.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">
      Subsections of this section define the structure of ACLs and
      discuss ACL-related matters that apply to multiple types of
      ACL use, including the definitions of the acl and aclsupport
      attributes.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">
      Matters that relate to only a single one of these use classes,
      including the definition of the NFSv4.1-specific attributes
      dacl and sacl,
      are discussed in subsections of Sections
      <a href="#AUTHFA-acl" class="xref">7.4</a> or
      <a href="#OTHACL" class="xref">12</a>.<a href="#section-5-4" class="pilcrow">¶</a></p>
<div id="ACL-ace">
<section id="section-5.1">
        <h3 id="name-access-control-entries">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-access-control-entries" class="section-name selfRef">Access Control Entries</a>
        </h3>
<p id="section-5.1-1">
            The attributes acl, sacl (v4.1 only) and dacl (v4.1 only)
     each contain an array of Access
            Control Entries (ACEs) that are associated with the file
            system object.  The client can set and
            get these attributes attribute, the server is responsible
     for using the ACL-related attributes to perform access control.
     The client can use the
            OPEN or ACCESS operations to check access without modifying
            or explicitly reading data or metadata.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
          The NFS ACE structure is defined as follows:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="section-5.1-3">
<pre class="lang-xdr sourcecode">
typedef uint32_t        acetype4;

typedef uint32_t aceflag4;

typedef uint32_t        acemask4;

struct nfsace4 {
        acetype4        type;
        aceflag4        flag;
        acemask4        access_mask;
        utf8str_mixed   who;
};
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ACL-acetype">
<section id="section-5.2">
        <h3 id="name-ace-type">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ace-type" class="section-name selfRef">ACE Type</a>
        </h3>
<p id="section-5.2-1">
            The constants used for the type field (acetype4) are as
            follows:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="section-5.2-2">
<pre class="lang-xdr sourcecode">
const ACE4_ACCESS_ALLOWED_ACE_TYPE      = 0x00000000;
const ACE4_ACCESS_DENIED_ACE_TYPE       = 0x00000001;
const ACE4_SYSTEM_AUDIT_ACE_TYPE        = 0x00000002;
const ACE4_SYSTEM_ALARM_ACE_TYPE        = 0x00000003;
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">
            All four are permitted in the
            acl attribute.  For NFSv4.1 and beyond, only the ALLOWED and DENIED
     types may be used in the dacl attribute, and only the AUDIT
     and ALARM types.x
            used in the sacl attribute.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Abbreviation</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_ACCESS_ALLOWED_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">ALLOW</td>
              <td class="text-left" rowspan="1" colspan="1">
     Explicitly grants the ability to perform the action
     specified in acemask4 to
     the file or directory.
   </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_ACCESS_DENIED_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">DENY</td>
              <td class="text-left" rowspan="1" colspan="1">
     Explicitly denies the ability to perform the action
     specified in acemask4 to
     the file or directory.
   </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_SYSTEM_AUDIT_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">AUDIT</td>
              <td class="text-left" rowspan="1" colspan="1">
     Log (in a system-dependent way) any attempt to
     perform, for the file or directory, any of the
                    actions specified in acemask4.
   </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_SYSTEM_ALARM_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">ALARM</td>
              <td class="text-left" rowspan="1" colspan="1">
     Generate an alarm (in a system-dependent way) any attempt
     to perform, for the file or directory, any of the
                    actions specified in acemask4.
   </td>
            </tr>
          </tbody>
        </table>
<p id="section-5.2-5">
              The "Abbreviation" column denotes how the
              types will be referred to throughout the rest of this
              document.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ACL-mask">
<section id="section-5.3">
        <h3 id="name-ace-access-mask">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-ace-access-mask" class="section-name selfRef">ACE Access Mask</a>
        </h3>
<p id="section-5.3-1">
            The bitmask constants used for the access mask field  of the ACE
            are as follows:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="section-5.3-2">
<pre class="lang-xdr sourcecode">
const ACE4_READ_DATA            = 0x00000001;
const ACE4_LIST_DIRECTORY       = 0x00000001;
const ACE4_WRITE_DATA           = 0x00000002;
const ACE4_ADD_FILE             = 0x00000002;
const ACE4_APPEND_DATA          = 0x00000004;
const ACE4_ADD_SUBDIRECTORY     = 0x00000004;
const ACE4_READ_NAMED_ATTRS     = 0x00000008;
const ACE4_WRITE_NAMED_ATTRS    = 0x00000010;
const ACE4_EXECUTE              = 0x00000020;
const ACE4_DELETE_CHILD         = 0x00000040;
const ACE4_READ_ATTRIBUTES      = 0x00000080;
const ACE4_WRITE_ATTRIBUTES     = 0x00000100;
const ACE4_WRITE_RETENTION      = 0x00000200;
const ACE4_WRITE_RETENTION_HOLD = 0x00000400;

const ACE4_DELETE               = 0x00010000;
const ACE4_READ_ACL             = 0x00020000;
const ACE4_WRITE_ACL            = 0x00040000;
const ACE4_WRITE_OWNER          = 0x00080000;
const ACE4_SYNCHRONIZE          = 0x00100000;
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">

    Note that some masks have coincident values, for
    example, ACE4_READ_DATA and ACE4_LIST_DIRECTORY.
    The mask entries ACE4_LIST_DIRECTORY,
    ACE4_ADD_FILE, and ACE4_ADD_SUBDIRECTORY are
    intended to be used with directory objects,
    while ACE4_READ_DATA, ACE4_WRITE_DATA, and
    ACE4_APPEND_DATA are intended to be used with
    non-directory objects.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ACL-maskd">
<section id="section-5.4">
        <h3 id="name-uses-of-mask-bits">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-uses-of-mask-bits" class="section-name selfRef">Uses of Mask Bits</a>
        </h3>
<p id="section-5.4-1">
        [Author Aside]: Because this section has been moved to be part
        of a general description of ACEs, not limited to authorization,
        the descriptions no longer refer to permissions but rather to
        actions.  This is best considered a purely editorial change,
        but, to allow for possible disagreement on the matter, it
        will be considered, here and in <a href="#ISSUES" class="xref">Appendix B</a>,
        as consensus item #3a.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">
        [Author Aside]: In a large number of places,
        <span class="bcp14">SHOULD</span> is used inappropriately, since there
        appear to be no valid reasons to allow a server to ignore what
        might well be a requirement.  Such changes are not noted
        individually below.  However, they will be considered,
        here and in <a href="#ISSUES" class="xref">Appendix B</a>, as consensus item #4a.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">
        [Author Aside}: In a significant number of cases the ACCESS
        operation is not listed as a operation affected by the mask
        bit.  These additions are not noted individually below.
        However, they will be considered,
        here and in <a href="#ISSUES" class="xref">Appendix B</a>, as consensus item #5a.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">
        [Author Aside, Including List]: In a number of cases, there are
        additional changes which go beyond editorial or arguably do so.
        These will be marked as their own consensus items usually with
        an accompanying author aside but without necessarily
        citing the previous treatment. These include:<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-5.1">
            <p id="section-5.4-5.1.1">
  Revisions were necessary to clarify the relationship between
  READ_DATA and EXECUTE.  These are part of consensus item #7a.<a href="#section-5.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-5.2">
            <p id="section-5.4-5.2.1">
  Revisions were necessary to clarify the relationship between
  WRITE_DATA and APPEND_DATA. These are part of consensus
  item #8a.<a href="#section-5.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-5.3">
            <p id="section-5.4-5.3.1">
  Clarification of the handling of RENAME by ADD_SUBDIRECTORY.
    This is part of consensus item #9a.<a href="#section-5.4-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-5.4">
            <p id="section-5.4-5.4.1">
  Revisions in handling of the masks WRITE_RETENTION and
  WRITE_RETENTION_HOLD.
                 These are parts of consensus items #10a.<a href="#section-5.4-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.4-6">
        [Author Aside]: Because of the need to address sticky-bit
        issues as part of of the ACE mask descriptions, it is
        appropriate to introduce the subject here.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<p id="section-5.4-7">
        [Consensus Item (Item #6a)]: Despite the fact
        that ACLs and mode bits are separate means of authentication,
        it has been necessary, even if only for the purpose of
        providing compatibility with earlier implementations, to
        introduce the issue here, since reference to this mode bit
        are necessary to resolve issues regard directory entry
        deletion, as is done in <a href="#ACL-deletes" class="xref">Section 5.6</a>.<a href="#section-5.4-7" class="pilcrow">¶</a></p>
<p id="section-5.4-8">
        [Consensus Item, Including List (Item #6a): The full
        description of the role of the sticky-bit appears in
        <a href="#AUTHFA-posix-mode" class="xref">Section 7.3.1</a>.  In evaluating and
        understanding the relationship between the handling
        of this bit when ACLs are used and when they are not, the
        following points need to be kept in mind:<a href="#section-5.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-9.1">
            <p id="section-5.4-9.1.1">
  This is troublesome in that it combines data normally
  assigned to two different authorization models and
  breaks the overall architectural arrangement in which
  the mask bits represent the mode bits but provide
  a finer granularity of control.<a href="#section-5.4-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-9.2">
            <p id="section-5.4-9.2.1">
  It might have been possible to conform to the existing
  architectural model if a new mask bit were created to
  represent to directory sticky bit.   It is probably too late
  to so now, even though it would be allowed as an NFSv4.2
  extension.<a href="#section-5.4-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-9.3">
            <p id="section-5.4-9.3.1">
  The new treatment in <a href="#ACL-deletes" class="xref">Section 5.6</a> is more
  restrictive than the previous one appearing in
  <a href="#ACL-deletes-old" class="xref">Section 5.6.1</a>.  This raises potential
  compatibility issues since the new treatment, while
  designed to address the same issues was designed to match
  existing Unix handling of this bit.<a href="#section-5.4-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-9.4">
            <p id="section-5.4-9.4.1">
  This handling initially addresses REMOVE and does not address
  directory sticky bit semantics with regard to RENAME.
  Whether it should do so is still uncertain.<a href="#section-5.4-9.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-9.5">
            <p id="section-5.4-9.5.1">
  The handling of this mode bit was not documented in previous
  specifications.   However, there is a preliminary attempt
  to do so in <a href="#AUTHFA-posix-mode" class="xref">Section 7.3.1</a>.  The reason for
  doing so, is that given the Unix orientation of the mode
  attribute, it is likely that servers currently implement
  this, even though there is no NFSv4 documentation of this
  semantics<a href="#section-5.4-9.5.1" class="pilcrow">¶</a></p>
<p id="section-5.4-9.5.2">
          This treatment needs to be checked for compatibility issues
  and also to establish a model that we might adapt to the
  ACL case.<a href="#section-5.4-9.5.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-9.6">
            <p id="section-5.4-9.6.1">
  In the long term, it would make more sense to allow
  the client rather than the server to have the primary role
  in determining the semantics for things like this.  That does
  not seem possible right now but it is worth considering.<a href="#section-5.4-9.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.4-10">ACE4_READ_DATA<a href="#section-5.4-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-11.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-11.1.1">
              <dt id="section-5.4-11.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-11.1.1.2">
                <p id="section-5.4-11.1.1.2.1">READ<a href="#section-5.4-11.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-11.1.1.2.2">OPEN<a href="#section-5.4-11.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-5.4-11.1.1.2.3">ACCESS<a href="#section-5.4-11.1.1.2.3" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-11.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-11.1.1.4">
                <p id="section-5.4-11.1.1.4.1">
         The action of reading the data to the data of the file.<a href="#section-5.4-11.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-11.1.1.4.2">
         [Previous Treatment (Item #7a)]: Servers
 <span class="bcp14">SHOULD</span>
 allow a user the ability to read the data
         of the file when only the ACE4_EXECUTE access mask bit
 is allowed.<a href="#section-5.4-11.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-5.4-11.1.1.4.3">
 [Author Aside]: The treatment needs
 to be clarified to make it appropriate to all ACE types.<a href="#section-5.4-11.1.1.4.3" class="pilcrow">¶</a></p>
<p id="section-5.4-11.1.1.4.4">
 [Consensus Needed (Item #7a)]:
 When used to handle READ or OPEN operations, the
 handling <span class="bcp14">MUST</span> be identical whether this
 bit, ACE4_EXECUTE, or both are present, as the server
 has no way of determining whether a file is being read
 for execution are not.   The only occasion for
 different handling is in construction of a corresponding
 mode or in responding to the ACCESS operation.<a href="#section-5.4-11.1.1.4.4" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-12">ACE4_LIST_DIRECTORY<a href="#section-5.4-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-13.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-13.1.1">
              <dt id="section-5.4-13.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-13.1.1.2">READDIR<a href="#section-5.4-13.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-13.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-13.1.1.4">
       The action of listing the contents of a directory.<a href="#section-5.4-13.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-14">ACE4_WRITE_DATA<a href="#section-5.4-14" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-15.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-15.1.1">
              <dt id="section-5.4-15.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-15.1.1.2">
                <p id="section-5.4-15.1.1.2.1">WRITE<a href="#section-5.4-15.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-15.1.1.2.2">OPEN<a href="#section-5.4-15.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-5.4-15.1.1.2.3">ACCESS<a href="#section-5.4-15.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-5.4-15.1.1.2.4">SETATTR of size<a href="#section-5.4-15.1.1.2.4" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-15.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-15.1.1.4">
                <p id="section-5.4-15.1.1.4.1">
 [Author Aside]: Needs to be revised to deal with
 issues related to the interaction of WRITE_DATA and
 APPEND_DATA.<a href="#section-5.4-15.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-15.1.1.4.2">
         [Consensus Needed (Item #8a)]: The action of modifying
 existing data bytes within a file's current data.<a href="#section-5.4-15.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-5.4-15.1.1.4.3">
 [Consensus Needed (Item #8a)]: As there is no way for
 the server to decide, in processing an OPEN or
 ACCESS request,
 whether subsequent WRITEs will extend the file or
 not, the server will, in processing an OPEN treat
 masks containing only
 WRITE_DATA, only APPEND_DATA, or both identically.<a href="#section-5.4-15.1.1.4.3" class="pilcrow">¶</a></p>
<p id="section-5.4-15.1.1.4.4">
 [Consensus Needed (Item #8a)]: In processing a
 WRITE request, the server is presumed to have the
 to determine whether the current request extends
 the file and whether it modifies bytes already
 in the file.<a href="#section-5.4-15.1.1.4.4" class="pilcrow">¶</a></p>
<p id="section-5.4-15.1.1.4.5">
 [Consensus Needed (Item #8a)]: ACE4_WRITE_DATA is
 required to process a WRITE which spans pre-existing
 byte in the file, whether the file is extended or not.<a href="#section-5.4-15.1.1.4.5" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-16">ACE4_ADD_FILE<a href="#section-5.4-16" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-17.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-17.1.1">
              <dt id="section-5.4-17.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-17.1.1.2">
                <p id="section-5.4-17.1.1.2.1">CREATE<a href="#section-5.4-17.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-17.1.1.2.2">LINK<a href="#section-5.4-17.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-5.4-17.1.1.2.3">OPEN<a href="#section-5.4-17.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-5.4-17.1.1.2.4">RENAME<a href="#section-5.4-17.1.1.2.4" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-17.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-17.1.1.4">
       The action of adding a new file in a directory.
       The CREATE operation is affected when nfs_ftype4
       is NF4LNK, NF4BLK, NF4CHR, NF4SOCK, or
       NF4FIFO. (NF4DIR is not included because it is
       covered by ACE4_ADD_SUBDIRECTORY.) OPEN is
       affected when used to create a regular file.
       LINK and RENAME are always affected.<a href="#section-5.4-17.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-18">ACE4_APPEND_DATA<a href="#section-5.4-18" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-19.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-19.1.1">
              <dt id="section-5.4-19.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-19.1.1.2">
                <p id="section-5.4-19.1.1.2.1">WRITE<a href="#section-5.4-19.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-19.1.1.2.2">ACCESS<a href="#section-5.4-19.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-5.4-19.1.1.2.3">OPEN<a href="#section-5.4-19.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-5.4-19.1.1.2.4">SETATTR of size<a href="#section-5.4-19.1.1.2.4" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-19.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-19.1.1.4">
                <p id="section-5.4-19.1.1.4.1">
 [Author Aside]: Also needs to be revised to deal with
 issues related to the interaction of WRITE_DATA and
 APPEND_DATA.<a href="#section-5.4-19.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-19.1.1.4.2">
         The action of modifying a file's data, but only
 starting at EOF.  This allows for the specification of
 append-only files, by allowing ACE4_APPEND_DATA
 and denying ACE4_WRITE_DATA to the same user or
 group.<a href="#section-5.4-19.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-5.4-19.1.1.4.3">
 [Consensus Needed (Item #8a)]: As there is no way for
 the server to decide, in processing an OPEN or ACCESS
 request,
 whether subsequent WRITEs will extend the file or
 not, the server will treat masks containing only
 WRITE_DATA, only APPEND_DATA or both, identically.<a href="#section-5.4-19.1.1.4.3" class="pilcrow">¶</a></p>
<p id="section-5.4-19.1.1.4.4">
 [Consensus Needed (Item #8a)]: If the server is
 processing a WRITE request and the area to be
 written extends beyond the existing EOF of the file
 then the state of APPEND_DATA mask bit is consulted
 to determine whether the operation is permitted or
 whether alarm or audit activities are to be performed.
 If a file has an ACL allowing only APPEND_DATA
 (and not
 WRITE_DATA) and a WRITE request is made at an
 offset below EOF, the server <span class="bcp14">MUST</span>
 return NFS4ERR_ACCESS.<a href="#section-5.4-19.1.1.4.4" class="pilcrow">¶</a></p>
<p id="section-5.4-19.1.1.4.5">
 [Consensus Needed (Item #8a)]: If the server is
 processing a WRITE request and the area to be
 written does not extend beyond the existing EOF
 of the file
 then the state of APPEND_DATA mask bit does not
 need to be consulted
 to determine whether the operation is permitted or
 whether alarm or audit activities are to be performed.
 In this case, only the WRITE_DATA mask bit
 needs to be checked to determine whether the WRITE is
 authorized.<a href="#section-5.4-19.1.1.4.5" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-20">ACE4_ADD_SUBDIRECTORY<a href="#section-5.4-20" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-21.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-21.1.1">
              <dt id="section-5.4-21.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-21.1.1.2">
                <p id="section-5.4-21.1.1.2.1">CREATE<a href="#section-5.4-21.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-21.1.1.2.2">RENAME<a href="#section-5.4-21.1.1.2.2" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-21.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-21.1.1.4">
                <p id="section-5.4-21.1.1.4.1">
 [Author Aside]: The RENAME cases need to be limited
 to the renaming of directories, rather than saying,
 "The RENAME operating is always affected."<a href="#section-5.4-21.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-21.1.1.4.2">
 [Consensus Needed (Item #9a)]:
 The action of creating a subdirectory in a
         directory.  The CREATE operation is affected
         when nfs_ftype4 is NF4DIR.  The RENAME operation
         is always affected when directories are renamed
 and the target directory ACL contains the mask
 ACE4_ADD_SUBDIRECTORY.<a href="#section-5.4-21.1.1.4.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-22">ACE4_READ_NAMED_ATTRS<a href="#section-5.4-22" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-23.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-23.1.1">
              <dt id="section-5.4-23.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-23.1.1.2">
                <p id="section-5.4-23.1.1.2.1">OPENATTR<a href="#section-5.4-23.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-23.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-23.1.1.4">
       The action of reading the named attributes of a
       file or of looking up the named attribute
       directory.  OPENATTR is affected when it is not
       used to create a named attribute directory.
       This is when 1) createdir is TRUE, but a named
       attribute directory already exists, or 2)
       createdir is FALSE.<a href="#section-5.4-23.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-24">ACE4_WRITE_NAMED_ATTRS<a href="#section-5.4-24" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-25.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-25.1.1">
              <dt id="section-5.4-25.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-25.1.1.2">
                <p id="section-5.4-25.1.1.2.1">OPENATTR<a href="#section-5.4-25.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-25.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-25.1.1.4">
       The action of writing the named attributes of a
       file or creating a named attribute directory.
       OPENATTR is affected when it is used to create a
       named attribute directory.  This is when
       createdir is TRUE and no named attribute
       directory exists.  The ability to check whether
       or not a named attribute directory exists
       depends on the ability to look it up; therefore,
       users also need the ACE4_READ_NAMED_ATTRS
       permission in order to create a named attribute
       directory.<a href="#section-5.4-25.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-26">ACE4_EXECUTE<a href="#section-5.4-26" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-27.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-27.1.1">
              <dt id="section-5.4-27.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-27.1.1.2">
                <p id="section-5.4-27.1.1.2.1">READ<a href="#section-5.4-27.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.2.2">OPEN<a href="#section-5.4-27.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.2.3">ACCESS<a href="#section-5.4-27.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.2.4">REMOVE<a href="#section-5.4-27.1.1.2.4" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.2.5">RENAME<a href="#section-5.4-27.1.1.2.5" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.2.6">LINK<a href="#section-5.4-27.1.1.2.6" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.2.7">CREATE<a href="#section-5.4-27.1.1.2.7" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-27.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-27.1.1.4">
                <p id="section-5.4-27.1.1.4.1">
         The action of reading a file in order to execute it.<a href="#section-5.4-27.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.4.2">
         Servers <span class="bcp14">MUST</span> allow a
         user the ability to read the data of the file
         when only the ACE4_EXECUTE access mask bit is
         allowed.  This is because there is no way to
         execute a file without reading the contents.
         Though a server may treat ACE4_EXECUTE and
         ACE4_READ_DATA bits identically when deciding to
         permit a READ or OPEN operation, it
 <span class="bcp14">MUST</span> still allow
         the two bits to be set independently in ACLs,
         and distinguish between them when replying
         to ACCESS operations.  In particular, servers
 <span class="bcp14">MUST NOT</span> silently turn on one
 of the two bits
 when the other is set, as that would make it
 impossible for the client to correctly enforce
 the distinction between read and execute
 permissions.<a href="#section-5.4-27.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-5.4-27.1.1.4.3">
 As an example, following a SETATTR of the
         following ACL:<a href="#section-5.4-27.1.1.4.3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-27.1.1.4.4.1">nfsuser:ACE4_EXECUTE:ALLOW<a href="#section-5.4-27.1.1.4.4.1" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-5.4-27.1.1.4.5">
         A subsequent GETATTR of ACL for that file
 will return:<a href="#section-5.4-27.1.1.4.5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-27.1.1.4.6.1">nfsuser:ACE4_EXECUTE:ALLOW<a href="#section-5.4-27.1.1.4.6.1" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-5.4-27.1.1.4.7">
         and <span class="bcp14">MUST NOT</span> return:<a href="#section-5.4-27.1.1.4.7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-27.1.1.4.8.1">
                      nfsuser:ACE4_EXECUTE/ACE4_READ_DATA:ALLOW<a href="#section-5.4-27.1.1.4.8.1" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-28">ACE4_EXECUTE<a href="#section-5.4-28" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-29.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-29.1.1">
              <dt id="section-5.4-29.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-29.1.1.2">LOOKUP<a href="#section-5.4-29.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-29.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-29.1.1.4">
       The action of traversing/searching a directory.<a href="#section-5.4-29.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-30">ACE4_DELETE_CHILD<a href="#section-5.4-30" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-31.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-31.1.1">
              <dt id="section-5.4-31.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-31.1.1.2">
                <p id="section-5.4-31.1.1.2.1">REMOVE<a href="#section-5.4-31.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-31.1.1.2.2">RENAME<a href="#section-5.4-31.1.1.2.2" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-31.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-31.1.1.4">
       The action of deleting a file or directory within
       a directory. 

       See <a href="#ACL-deletes" class="xref">Section 5.6</a>
       for information on now ACE4_DELETE and
       ACE4_DELETE_CHILD are to interact.<a href="#section-5.4-31.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-32">ACE4_READ_ATTRIBUTES<a href="#section-5.4-32" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-33.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-33.1.1">
              <dt id="section-5.4-33.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-33.1.1.2">
                <p id="section-5.4-33.1.1.2.1">GETATTR of file system object attributes<a href="#section-5.4-33.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-33.1.1.2.2">VERIFY<a href="#section-5.4-33.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-5.4-33.1.1.2.3">NVERIFY<a href="#section-5.4-33.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-5.4-33.1.1.2.4">READDIR<a href="#section-5.4-33.1.1.2.4" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-33.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-33.1.1.4">
       The action of reading basic attributes (non-ACLs)
       of a file.  On a UNIX system, such basic attributes
       can be thought of as the stat-level attributes.
       Allowing this access mask bit would mean that the
       entity can execute "ls -l" and stat.  If a
       READDIR operation requests attributes, this mask
       must be allowed for the READDIR to succeed.<a href="#section-5.4-33.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-34">ACE4_WRITE_ATTRIBUTES<a href="#section-5.4-34" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-35.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-35.1.1">
              <dt id="section-5.4-35.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-35.1.1.2">
                <p id="section-5.4-35.1.1.2.1">
         SETATTR of time_access_set, time_backup,
                        time_create, time_modify_set, mimetype, hidden,
         system.<a href="#section-5.4-35.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-35.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-35.1.1.4">
       The action of changing the times associated with a
       file or directory to an arbitrary value.  Also
       permission to change the mimetype, hidden, and
       system attributes.  A user having
       ACE4_WRITE_DATA or ACE4_WRITE_ATTRIBUTES will be
       allowed to set the times associated with a file
       to the current server time.<a href="#section-5.4-35.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-36">ACE4_WRITE_RETENTION<a href="#section-5.4-36" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-37.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-37.1.1">
              <dt id="section-5.4-37.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-37.1.1.2">SETATTR of retention_set, retentevt_set.<a href="#section-5.4-37.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-37.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-37.1.1.4">
                <p id="section-5.4-37.1.1.4.1">
 The action of modifying the durations for event and
 non-event-based retention. Also includes 
         enabling event and non-event-based retention.<a href="#section-5.4-37.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-37.1.1.4.2">
 [Author Aside]: The use of "<span class="bcp14">MAY</span>" here
 ignores the potential for harm which unexpected
 modification of the associated attributes might cause for
 security/compliance.<a href="#section-5.4-37.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-5.4-37.1.1.4.3">
 [Previous Treatment]: A server
 <span class="bcp14">MAY</span> behave such that setting
 ACE4_WRITE_ATTRIBUTES allows
 ACE4_WRITE_RETENTION.<a href="#section-5.4-37.1.1.4.3" class="pilcrow">¶</a></p>
<p id="section-5.4-37.1.1.4.4">
 [Consensus Needed (Items #10a, #11a)]: Options for
 coarser-grained
 treatment involving this mask bit are discussed in
 <a href="#ACL-maskr" class="xref">Section 5.5</a><a href="#section-5.4-37.1.1.4.4" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-38">ACE4_WRITE_RETENTION_HOLD<a href="#section-5.4-38" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-39.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-39.1.1">
              <dt id="section-5.4-39.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-39.1.1.2">SETATTR of retention_hold.<a href="#section-5.4-39.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-39.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-39.1.1.4">
                <p id="section-5.4-39.1.1.4.1">
 The action of modifying the administration
 retention holds.<a href="#section-5.4-39.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-39.1.1.4.2">
 [Previous Treatment]: A server
 <span class="bcp14">MAY</span> map ACE4_WRITE_ATTRIBUTES to
 ACE_WRITE_RETENTION_HOLD.<a href="#section-5.4-39.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-5.4-39.1.1.4.3">
 [Author Aside]: The use of "<span class="bcp14">MAY</span>" here
 ignores the potential for harm which unexpected
 modification of the associated attributes might cause 
 for security/compliance.<a href="#section-5.4-39.1.1.4.3" class="pilcrow">¶</a></p>
<p id="section-5.4-39.1.1.4.4">
 [Consensus Needed (Items #10a, #11a)]: Options for
 coarser-grained treatment of this mask bit
 are discussed in <a href="#ACL-maskr" class="xref">Section 5.5</a><a href="#section-5.4-39.1.1.4.4" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-40">ACE4_DELETE<a href="#section-5.4-40" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-41.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-41.1.1">
              <dt id="section-5.4-41.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-41.1.1.2">REMOVE<a href="#section-5.4-41.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-41.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-41.1.1.4">
       The action of deleting the associated
       file or directory. 

       See <a href="#ACL-deletes" class="xref">Section 5.6</a>
       for information on how ACE4_DELETE and
       ACE4_DELETE_CHILD are to interact.<a href="#section-5.4-41.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-42">ACE4_READ_ACL<a href="#section-5.4-42" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-43.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-43.1.1">
              <dt id="section-5.4-43.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-43.1.1.2">
                <p id="section-5.4-43.1.1.2.1">GETATTR of acl, dacl, or sacl<a href="#section-5.4-43.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4-43.1.1.2.2">NVERIFY<a href="#section-5.4-43.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-5.4-43.1.1.2.3">VERIFY<a href="#section-5.4-43.1.1.2.3" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-43.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-43.1.1.4">
       The action of reading the ACL.<a href="#section-5.4-43.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-44">ACE4_WRITE_ACL<a href="#section-5.4-44" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-45.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-45.1.1">
              <dt id="section-5.4-45.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-45.1.1.2">SETATTR of acl and mode<a href="#section-5.4-45.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-45.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-45.1.1.4">The action of modifying the acl or mode attributes.<a href="#section-5.4-45.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-46">ACE4_WRITE_OWNER<a href="#section-5.4-46" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-47.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-47.1.1">
              <dt id="section-5.4-47.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-47.1.1.2">SETATTR of owner and owner_group<a href="#section-5.4-47.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-47.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-47.1.1.4">
       The action of modifying the owner or owner_group
       attributes.  On UNIX systems, this done by
       executing chown() and chgrp().<a href="#section-5.4-47.1.1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
<p id="section-5.4-48">ACE4_SYNCHRONIZE<a href="#section-5.4-48" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-49.1">
            <span class="break"></span><dl class="dlNewline" id="section-5.4-49.1.1">
              <dt id="section-5.4-49.1.1.1">Operation(s) affected:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-49.1.1.2">NONE<a href="#section-5.4-49.1.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.4-49.1.1.3">Discussion:</dt>
              <dd style="margin-left: 1.5em" id="section-5.4-49.1.1.4">
                <p id="section-5.4-49.1.1.4.1">
       Permission to use the file object as a
       synchronization primitive for interprocess
       communication. This permission is not enforced
       or interpreted by the NFSv4.1 server on behalf of
       the client.<a href="#section-5.4-49.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-49.1.1.4.2">
                      Typically, the ACE4_SYNCHRONIZE permission is
                      only meaningful on local file systems, i.e.,
                      file systems not accessed via NFSv4.1. The reason
                      that the permission bit exists is that some operating
                      environments, such as Windows, use ACE4_SYNCHRONIZE.<a href="#section-5.4-49.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-5.4-49.1.1.4.3">
                      For example, if a client copies a file that has
                      ACE4_SYNCHRONIZE set from a local file system to
                      an NFSv4.1 server, and then later copies the file
                      from the NFSv4.1 server to a local file system,
                      it is likely that if ACE4_SYNCHRONIZE was set
                      in the original file, the client will want it
                      set in the second copy.  The first copy will not
                      have the permission set unless the NFSv4.1 server
                      has the means to set the ACE4_SYNCHRONIZE bit. The
                      second copy will not have the permission set unless
                      the NFSv4.1 server has the means to retrieve the
                      ACE4_SYNCHRONIZE bit.<a href="#section-5.4-49.1.1.4.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</li>
        </ul>
</section>
</div>
<div id="ACL-maskr">
<section id="section-5.5">
        <h3 id="name-requirements-and-recommenda">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-requirements-and-recommenda" class="section-name selfRef">Requirements and Recommendations Regarding Mask Granularity</a>
        </h3>
<p id="section-5.5-1">
 This is new section which replaces material formerly in
 the previous section, cited here as "Previous Treatment.
 The new material, constituting the remainder of the section
 is proposed to replace it.  All such unannotated material
 is to be considered, as part of consensus item #11b.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">
                [Previous Treatment (Item #11b)]:
 Server implementations need not provide the granularity
 of control that is implied by this list of masks. For
 example, POSIX-based systems might not distinguish
 ACE4_APPEND_DATA (the ability to append to a file) from
 ACE4_WRITE_DATA (the ability to modify existing
 contents); both masks would be tied to a single "write"
 permission bit. When such a server returns attributes to the
 client that contain such masks, it would show
 ACE4_APPEND_DATA and ACE4_WRITE_DATA if and only if the
 the write permission bit is enabled.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">
                [Previous Treatment (Item #11b)]:
 If a server receives a SETATTR request that it cannot
 accurately implement, it should err in the direction of
 more restricted access, except in the previously
 discussed cases of execute and read. For example,
 suppose a server cannot distinguish overwriting data
 from appending new data, as described in the previous
 paragraph.  If a client submits an ALLOW ACE where
 ACE4_APPEND_DATA is set but ACE4_WRITE_DATA is not (or
 vice versa), the server should either turn off
 ACE4_APPEND_DATA or reject the request with
 NFS4ERR_ATTRNOTSUPP.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">
 [Author Aside]:  Giving servers a general freedom to
 to not support the masks defined in this section, creates
 an unacceptable level of potential interoperability
 problems.  With regard to the specific example given,
 it is hard to imagine a server incapable of distinguishing
 a write to an offset within existing file and one
 beyond it.  This applies whether the server in question
 is implemented within a POSIX-based system or not.  It is
 true that a server that used the unmodified POSIX interface to
 interact with the file system, rather than a purpose-built
 VFS, would face this difficulty, but it not clear that
 that fact justifies the client compatibility issues that
 accommodating this behavior in the protocol would generate.
 A further
 difficulty with the previous treatment is that it at
 variance with the approach to other cases in which ACEs are
 stored with the understanding that implementations of
 other protocols might be responsible for enforcement.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
<p id="section-5.5-5">
 [Author Aside]: A replacement should clearly be based on
 the idea that these mask bits were included in NFSv4
 for a reason, and that exceptions need to be justified,
 and take interoperability issues into account. The treatment
 below attempts to do that.<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<p id="section-5.5-6">
 All implementations of the acl,
 dacl, and sacl attributes
 <span class="bcp14">SHOULD</span> follow the definitions provided
 above in <a href="#ACL-maskd" class="xref">Section 5.4</a>, which allow
 finer-grained control of the actions allowed to specific
 users than is provided by the mode attribute. Valid
 reasons to bypass this guidance include the need for
 compatibility with clients expecting a coarser-grained
 implementation.<a href="#section-5.5-6" class="pilcrow">¶</a></p>
<p id="section-5.5-7">
 The specific cases in which servers may validly provide
 coarser-grained implementations are discussed below.<a href="#section-5.5-7" class="pilcrow">¶</a></p>
<p id="section-5.5-8">
 Servers not providing the mask granularity described in
 <a href="#ACL-maskd" class="xref">Section 5.4</a> <span class="bcp14">MUST NOT</span>
 treat masks other than described in that section
 except as listed below.<a href="#section-5.5-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-9.1">
            <p id="section-5.5-9.1.1">
   Servers that do not distinguish between WRITE_DATA
   and APPEND_DATA need to make it clear to clients that
   support for append-only files is not present.  To do
   that, requests to set ACLs where the handling for these
   two masks are different for any specified user or group
   are to be rejected with NFS4ERR_ATTRNOTSUPP.<a href="#section-5.5-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-9.2">
            <p id="section-5.5-9.2.1">
   [Consensus Needed (Items #10b, #11b)]: Servers that combine
   either of the masks WRITE_RETENTION or WRITE_RETENTION_HOLD
   with WRITE_ATTRIBUTES need to make it clear to clients
   that the finer-grained treatment normally expected is not
   available.  To do that, requests to set ACLs in which the
   two combined masks are explicitly assigned different
   permission states (i.e. one is ALLOWED while the other is
   DENIED) for any specific user or group are to be rejected
   with NFS4ERR_ATTRNOTSUPP.<a href="#section-5.5-9.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.5-10">
 The above are in line with the requirement that attempts
 to set ACLs that the server cannot enforce, it needs to
 be clear that there are cases in which such ACLs need to be
 set with the expectation that enforcement will be done by
 the local file system or by another file access protocol.
 In particular,<a href="#section-5.5-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-11.1">
            <p id="section-5.5-11.1.1">       
   In handling the mask bit SYNCHRONIZE, the server is
   not responsible for enforcement and so can accept ACLs
   it has no way of enforcing.<a href="#section-5.5-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-11.2">
            <p id="section-5.5-11.2.1">
   When mask bits refers to an OPTIONAL feature that the
    server does not support such as named attributes or
   retention attributes, the server is allowed to accept
   ACLs containing mask bits associated with the
   unimplemented feature, even though there is no way these
   cold be enforced.  The expectation is that the files
   might be accessed by other protocols having such support or
   might be copied, together with associated ACLs to severs
   capable of enforcing them.<a href="#section-5.5-11.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ACL-deletes">
<section id="section-5.6">
        <h3 id="name-handling-of-deletion">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-handling-of-deletion" class="section-name selfRef">Handling of Deletion</a>
        </h3>
<p id="section-5.6-1">
 [Author Aside]:  This section, exclusive of subsections
 contains a proposal for
 the revision of the ACL-based handling of requests to delete
 directory entries.  All unannotated material within it is to 
 be considered part of consensus item #12a.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">
 [Author Aside]:  The associated previous treatment is to be
 found in <a href="#ACL-deletes-old" class="xref">Section 5.6.1</a><a href="#section-5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.6-3">
         This section describes the handling requests of that involve
         deletion of a directory entry.  It needs to be noted that:<a href="#section-5.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-4.1">
            <p id="section-5.6-4.1.1">
   Modification or transfer of a directory, as happens in
   RENAME is not covered.<a href="#section-5.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-4.2">
            <p id="section-5.6-4.2.1">
   The deletion of the file's data is dealt with separately
   as this, like a truncation to length zero, requires
   ACE4_WRITE_DATA.<a href="#section-5.6-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.6-5">
 In general, the recognition of such an operation for
 authorization/auditing/alarm depends on either of two
 bits mask bits being set: ACE4_MASK_DELETE on the file
 being deleted and ACE4_MASK_DELETE_CHILD on the directory
 from which the entry is being deleted.<a href="#section-5.6-5" class="pilcrow">¶</a></p>
<p id="section-5.6-6">
 In the case of authorization, the above applies even when
 one of the bits is allowed and the other is explicitly denied.<a href="#section-5.6-6" class="pilcrow">¶</a></p>
<p id="section-5.6-7">
 [Consensus Items, Including List (#6b, #12a):
 When neither of the mask bits is set, the result is
 normally negative.  That is, permission is denied and
 no audit or alarm event is recognized.  However, in the
 case of authorization, the server <span class="bcp14">MAY</span>
 make permission dependent on the setting of MODE4_SVTX
 if the mode attribute is supported, as follows:<a href="#section-5.6-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-8.1">
            <p id="section-5.6-8.1.1">
   If that bit not set, allow the removal if and only if
   ACE4_ADD_FILE is permitted.<a href="#section-5.6-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-8.2">
            <p id="section-5.6-8.2.1">
   If that bit is set, allow the removal if and only if
   ACE4_ADD_FILE is permitted and the requester is the owner
   of the target.<a href="#section-5.6-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="ACL-deletes-old">
<section id="section-5.6.1">
          <h4 id="name-previous-handling-of-deleti">
<a href="#section-5.6.1" class="section-number selfRef">5.6.1. </a><a href="#name-previous-handling-of-deleti" class="section-name selfRef">Previous Handling of Deletion</a>
          </h4>
<p id="section-5.6.1-1">
   [Author Aside]: This section contains the
   former content of <a href="#ACL-deletes" class="xref">Section 5.6</a>.  All unannotated
   paragraphs within it are to be considered the Previous Treatment
   associated with consensus item #12b.<a href="#section-5.6.1-1" class="pilcrow">¶</a></p>
<p id="section-5.6.1-2">
                  [Author Aside, Including List]: Listed below are some of  the
   reasons that I have tried to replace the existing treatment
   rather than address the specific issues mentioned here and
   in later
   asides.<a href="#section-5.6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.1-3.1">
              <p id="section-5.6.1-3.1.1">
     The fact that there is no clear message about what servers
     are to do and about whether behavior clients might rely rely on.
     This derives in turn from the use of SHOULD in contexts in
     which it is clearly not appropriate, combined with
     non-normative reports of what some systems do, and the
     statement that the approach suggested is a way of providing
     "something like traditional UNIX-like semantics".<a href="#section-5.6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-3.2">
              <p id="section-5.6.1-3.2.1">
     The complexity of the approach without any indication that
     there is a need for such complexity makes me doubtful that
     anything was actually implemented, especially since the text
     is so wishy-washy about the need for server implementation.
     The probability that it would be implemented so widely that
     clients might depend on it is even more remote.<a href="#section-5.6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-3.3">
              <p id="section-5.6.1-3.3.1">
     The fact that how audit and alarm issues are to be dealt with
     is not addressed at all.<a href="#section-5.6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-3.4">
              <p id="section-5.6.1-3.4.1">
     The fact that this treatment combines ACL data with mode bit
     information in a confused way without any consideration of
     the fact that the mode attribute is OPTIONAL.<a href="#section-5.6.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.6.1-4">
                  Two access mask bits govern the ability to delete a
                  directory entry: ACE4_DELETE on the object
                  itself (the "target") and ACE4_DELETE_CHILD on
                  the containing directory (the "parent").<a href="#section-5.6.1-4" class="pilcrow">¶</a></p>
<p id="section-5.6.1-5">
   Many systems also take the "sticky bit" (MODE4_SVTX)
   on a directory to allow unlink only to a user that
   owns either the target or the parent; on some
   such systems the decision also depends on
   whether the target is writable.<a href="#section-5.6.1-5" class="pilcrow">¶</a></p>
<p id="section-5.6.1-6">
   Servers <span class="bcp14">SHOULD</span> allow unlink if
   either ACE4_DELETE
   is permitted on the target, or ACE4_DELETE_CHILD is
   permitted on the parent.  (Note that this is
   true even if the parent or target explicitly
   denies one of these permissions.)<a href="#section-5.6.1-6" class="pilcrow">¶</a></p>
<p id="section-5.6.1-7">
   If the ACLs in question neither explicitly ALLOW
   nor DENY either of the above, and if MODE4_SVTX is
   not set on the parent, then the server <span class="bcp14">SHOULD</span> allow
   the removal if and only if ACE4_ADD_FILE is permitted.
   In the case where MODE4_SVTX is set, the server
   may also require the remover to own either the parent
   or the target, or may require the target to be
   writable.<a href="#section-5.6.1-7" class="pilcrow">¶</a></p>
<p id="section-5.6.1-8">
   This allows servers to support something close to
   traditional UNIX-like semantics, with ACE4_ADD_FILE
   taking the place of the write bit.<a href="#section-5.6.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ACL-flags">
<section id="section-5.7">
        <h3 id="name-ace-flag-bits">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-ace-flag-bits" class="section-name selfRef">ACE flag bits</a>
        </h3>
<p id="section-5.7-1">
            The bitmask constants used for the flag field are as
            follows:<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<div id="section-5.7-2">
<pre class="lang-xdr sourcecode">
const ACE4_FILE_INHERIT_ACE             = 0x00000001;
const ACE4_DIRECTORY_INHERIT_ACE        = 0x00000002;
const ACE4_NO_PROPAGATE_INHERIT_ACE     = 0x00000004;
const ACE4_INHERIT_ONLY_ACE             = 0x00000008;
const ACE4_SUCCESSFUL_ACCESS_ACE_FLAG   = 0x00000010;
const ACE4_FAILED_ACCESS_ACE_FLAG       = 0x00000020;
const ACE4_IDENTIFIER_GROUP             = 0x00000040;
const ACE4_INHERITED_ACE                = 0x00000080;
</pre><a href="#section-5.7-2" class="pilcrow">¶</a>
</div>
<p id="section-5.7-3">
              [Author Aside]:  Although there are multiple distinct issues
       that might need to be changed, in the interest of simplifying
       the review, all such issues within this section will be
       considered part of Consensus Item #13a with a single revised
       treatment addressing all the issues noted.<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<p id="section-5.7-4">
              [Previous Treatment]: A server need not support any of these
       flags.<a href="#section-5.7-4" class="pilcrow">¶</a></p>
<p id="section-5.7-5">
       [Author Aside]:  It is hard to understand why such broad
       license is granted to the server, leaving the client to deal,
       without an explicit non-support indication, with 256 possible
       combinations of supported and unsupported flags.  If there were
       specific issues with some flags that makes it reasonable for
       a server not to support them, then these need to be specifically
       noted.   Also problematic is the use of the term "need not",
       suggesting that the server does not need any justification for
       choosing these flags, defined by the protocol.  At least it
       needs to be said that the server <span class="bcp14">SHOULD</span> support
       the defined ACE flags.  After all they were included in the
       protocol for a reason.<a href="#section-5.7-5" class="pilcrow">¶</a></p>
<p id="section-5.7-6">
       [Previous Treatment]: If the
            server supports flags that are similar to, but not
            exactly the same as, these flags, the implementation
            may define a mapping between the protocol-defined
            flags and the implementation-defined flags.<a href="#section-5.7-6" class="pilcrow">¶</a></p>
<p id="section-5.7-7">
       [Author Aside]: The above dealing how an implementation might
       store the bits it support, while valid, is out-of-scope and
       should be deleted.<a href="#section-5.7-7" class="pilcrow">¶</a></p>
<p id="section-5.7-8">
              [Previous Treatment]:
       For example, suppose a client tries to set an ACE with
            ACE4_FILE_INHERIT_ACE set but not
            ACE4_DIRECTORY_INHERIT_ACE. If the server does not
            support any form of ACL inheritance, the server should
            reject the request with NFS4ERR_ATTRNOTSUPP. If the
            server supports a single "inherit ACE" flag that
            applies to both files and directories, the server may
            reject the request (i.e., requiring the client to set
            both the file and directory inheritance flags). The
            server may also accept the request and silently turn
            on the ACE4_DIRECTORY_INHERIT_ACE flag.<a href="#section-5.7-8" class="pilcrow">¶</a></p>
<p id="section-5.7-9">
       ]Author Aside]: What is the possible for justification
       for accepting
       a request asking you do something and then, without notice
       to the client do, something else.  I believe there is none.<a href="#section-5.7-9" class="pilcrow">¶</a></p>
<p id="section-5.7-10">
       Consensus Needed (Item #13a)]: Servers <span class="bcp14">SHOULD</span>
       support the flag bits defined above as described in
       <a href="#ACL-flagsd" class="xref">Section 5.8</a>.  When a server which does
       not support all the flags bits receives a request to
       set an ACL containing an ACE with an unsupported flag bit
       set the server <span class="bcp14">MUST</span>
       reject the request with NFS4ERR_ATTRNOTSUPP.<a href="#section-5.7-10" class="pilcrow">¶</a></p>
<p id="section-5.7-11">
       Consensus Needed (Item #13a)]:  The case of servers which
       do not provide support for particular flag combinations is
       to be treated similarly. If a server 
              supports a single "inherit ACE" flag that
              applies to both files and directories, receives a request
       set an ACL with ACE ACE4_FILE_INHERIT_ACE set but 
              ACE4_DIRECTORY_INHERIT_ACE not set, it  <span class="bcp14">MUST</span>
       reject the request with NFS4ERR_ATTRNOTSUPP.<a href="#section-5.7-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ACL-flagsd">
<section id="section-5.8">
        <h3 id="name-details-regarding-ace-flag-">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-details-regarding-ace-flag-" class="section-name selfRef">Details Regarding ACE Flag Bits</a>
        </h3>
<span class="break"></span><dl class="dlNewline" id="section-5.8-1">
          <dt id="section-5.8-1.1">ACE4_FILE_INHERIT_ACE</dt>
          <dd style="margin-left: 1.5em" id="section-5.8-1.2">
                  Any non-directory file in any
                  sub-directory will get this ACE
                  inherited.<a href="#section-5.8-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.8-1.3">ACE4_DIRECTORY_INHERIT_ACE</dt>
          <dd style="margin-left: 1.5em" id="section-5.8-1.4">
            <p id="section-5.8-1.4.1">
                  Can be placed on a directory and indicates
                  that this ACE should be added to each new
                  directory created.<a href="#section-5.8-1.4.1" class="pilcrow">¶</a></p>
<p id="section-5.8-1.4.2">
                  If this flag is set in an ACE in an ACL
                  attribute to be set on a non-directory
                  file system object, the operation
                  attempting to set the ACL <span class="bcp14">SHOULD</span> fail
                  with NFS4ERR_ATTRNOTSUPP.<a href="#section-5.8-1.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.8-1.5">ACE4_NO_PROPAGATE_INHERIT_ACE</dt>
          <dd style="margin-left: 1.5em" id="section-5.8-1.6">
                  Can be placed on a directory.  This flag
                  tells the server that inheritance of this
                  ACE should stop at newly created child
                  directories.<a href="#section-5.8-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.8-1.7">ACE4_INHERIT_ONLY_ACE</dt>
          <dd style="margin-left: 1.5em" id="section-5.8-1.8">
            <p id="section-5.8-1.8.1">
                  Can be placed on a directory but does not
                  apply to the directory; ALLOW and DENY ACEs
                  with this bit set do not affect access to
                  the directory, and AUDIT and ALARM ACEs
                  with this bit set do not trigger log or
                  alarm events.  Such ACEs only take effect
                  once they are applied (with this bit
                  cleared) to newly created files and
                  directories as specified by the
                  ACE4_FILE_INHERIT_ACE and ACE4_DIRECTORY_INHERIT_ACE
                  flags.<a href="#section-5.8-1.8.1" class="pilcrow">¶</a></p>
<p id="section-5.8-1.8.2">
                  If this flag is present on an ACE, but
                  neither ACE4_DIRECTORY_INHERIT_ACE nor
                  ACE4_FILE_INHERIT_ACE is present, then
                  an operation attempting to set such an
                  attribute <span class="bcp14">SHOULD</span> fail with
                  NFS4ERR_ATTRNOTSUPP.<a href="#section-5.8-1.8.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.8-1.9">ACE4_SUCCESSFUL_ACCESS_ACE_FLAG and 
                ACE4_FAILED_ACCESS_ACE_FLAG</dt>
          <dd style="margin-left: 1.5em" id="section-5.8-1.10">
            <p id="section-5.8-1.10.1">
                  The ACE4_SUCCESSFUL_ACCESS_ACE_FLAG
                  (SUCCESS) and ACE4_FAILED_ACCESS_ACE_FLAG
                  (FAILED) flag bits may be set only on
                  ACE4_SYSTEM_AUDIT_ACE_TYPE (AUDIT) and
                  ACE4_SYSTEM_ALARM_ACE_TYPE (ALARM) ACE
                  types. If during the processing of the
                  file's ACL, the server encounters an AUDIT
                  or ALARM ACE that matches the principal
                  attempting the OPEN, the server notes that
                  fact, and the presence, if any, of the
                  SUCCESS and FAILED flags encountered in
                  the AUDIT or ALARM ACE. Once the server
                  completes the ACL processing, it then
                  notes if the operation succeeded or
                  failed. If the operation succeeded, and if
                  the SUCCESS flag was set for a matching
                  AUDIT or ALARM ACE, then the appropriate
                  AUDIT or ALARM event occurs. If the
                  operation failed, and if the FAILED flag
                  was set for the matching AUDIT or ALARM 
                  ACE, then the appropriate AUDIT or ALARM
                  event occurs.  Either or both of the
                  SUCCESS or FAILED can be set, but if
                  neither is set, the AUDIT or ALARM ACE is
                  not useful.<a href="#section-5.8-1.10.1" class="pilcrow">¶</a></p>
<p id="section-5.8-1.10.2">
                  The previously described processing
                  applies to ACCESS operations even when
                  they return NFS4_OK.  For the purposes of
                  AUDIT and ALARM, we consider an ACCESS
                  operation to be a "failure" if it fails
                  to return a bit that was requested and
   supported.<a href="#section-5.8-1.10.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.8-1.11">ACE4_IDENTIFIER_GROUP</dt>
          <dd style="margin-left: 1.5em" id="section-5.8-1.12">
                  Indicates that the "who" refers to a GROUP
                  as defined under UNIX or a GROUP ACCOUNT
                  as defined under Windows. Clients and
                  servers <span class="bcp14">MUST</span> ignore the
                  ACE4_IDENTIFIER_GROUP flag on ACEs with a
                  who value equal to one of the special
                  identifiers outlined in
                  <a href="#ACL-who" class="xref">Section 5.9</a>.<a href="#section-5.8-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.8-1.13">ACE4_INHERITED_ACE</dt>
          <dd style="margin-left: 1.5em" id="section-5.8-1.14">
                  Indicates that this ACE is inherited from
                  a parent directory.  A server that supports
                  automatic inheritance will place
                  this flag on any ACEs inherited from the
                  parent directory when creating a new
                  object.  Client applications will use this
                  to perform automatic inheritance.
                  Clients and servers <span class="bcp14">MUST</span> clear this
                  bit in the acl attribute; it may only
                  be used in the dacl and sacl attributes.<a href="#section-5.8-1.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ACL-who">
<section id="section-5.9">
        <h3 id="name-ace-who">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-ace-who" class="section-name selfRef">ACE Who</a>
        </h3>
<p id="section-5.9-1">
            The "who" field of an ACE is an identifier that
            specifies the principal or principals to whom the ACE
            applies. It may refer to a user or a group, with the flag
            bit ACE4_IDENTIFIER_GROUP specifying which.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<p id="section-5.9-2">
            There are several special identifiers that need to be
            understood universally, rather than in the context of a
            particular DNS domain. Some of these identifiers cannot be
            understood when an NFS client accesses the server, but
            have meaning when a local process accesses the file. The
            ability to display and modify these permissions is
            permitted over NFS, even if none of the access methods on
            the server understands the identifiers.<a href="#section-5.9-2" class="pilcrow">¶</a></p>
<div id="specialwho">
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Who</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">OWNER</td>
              <td class="text-left" rowspan="1" colspan="1">
              The owner of the file.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">GROUP</td>
              <td class="text-left" rowspan="1" colspan="1">
              The group associated with the file.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EVERYONE</td>
              <td class="text-left" rowspan="1" colspan="1">
              The world, including the owner and owning group.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">INTERACTIVE</td>
              <td class="text-left" rowspan="1" colspan="1">
              Accessed from an interactive terminal.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NETWORK</td>
              <td class="text-left" rowspan="1" colspan="1">
              Accessed via the network.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">DIALUP</td>
              <td class="text-left" rowspan="1" colspan="1">
              Accessed as a dialup user to the server.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BATCH</td>
              <td class="text-left" rowspan="1" colspan="1">
              Accessed from a batch job.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ANONYMOUS</td>
              <td class="text-left" rowspan="1" colspan="1">
              Accessed without any authentication.
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AUTHENTICATED</td>
              <td class="text-left" rowspan="1" colspan="1">
              Any authenticated user (opposite of
              ANONYMOUS).
            </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SERVICE</td>
              <td class="text-left" rowspan="1" colspan="1">
              Access from a system service.
            </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.9-4">
            To avoid conflict, these special identifiers are
            distinguished by an appended "@" and should appear in the
            form "xxxx@" (with no domain name after the "@"), for
            example, ANONYMOUS@.<a href="#section-5.9-4" class="pilcrow">¶</a></p>
<p id="section-5.9-5">
            The ACE4_IDENTIFIER_GROUP flag <span class="bcp14">MUST</span> be ignored on
            entries with these special identifiers.  When encoding
            entries with these special identifiers, the
            ACE4_IDENTIFIER_GROUP flag <span class="bcp14">SHOULD</span> be set to zero.<a href="#section-5.9-5" class="pilcrow">¶</a></p>
<p id="section-5.9-6">
       [working group input needed]:  I don't understand what might be
       valid reasons to ignore this.  Would "<span class="bcp14">MUST</span>" be
       appropriate here?<a href="#section-5.9-6" class="pilcrow">¶</a></p>
<p id="section-5.9-7">
              It is important to note that "EVERYONE@" is not
              equivalent to the UNIX "other" entity. This is
              because, by definition, UNIX "other" does not include
              the owner or owning group of a file. "EVERYONE@" means
              literally everyone, including the owner or owning
              group.<a href="#section-5.9-7" class="pilcrow">¶</a></p>
<p id="section-5.9-8"> 
 [working group input needed]:  Some of these require that
 changes be made as discussed below:<a href="#section-5.9-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.9-9.1">
     For "INTERACTIVE", "NETWORK", "DIALUP", "BATCH",
             and "SERVICE" it needs to be specified that server's
     ability to make these distinctions is limited, making
     their use where security is an issue quite problematic.<a href="#section-5.9-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.9-9.2">
            <p id="section-5.9-9.2.1">
     For "ANONYMOUS", clearly requests using AUTH_NONE fit
     but what else?<a href="#section-5.9-9.2.1" class="pilcrow">¶</a></p>
<p id="section-5.9-9.2.2">
     Request by nobody and by users root-squashed to nobody
     are probably OK, although you could argue about the case
     of a user "nobody" authenticated by RPCSEC_GSS.<a href="#section-5.9-9.2.2" class="pilcrow">¶</a></p>
<p id="section-5.9-9.2.3">
   ON a more contentious note, I would argue that users
   "authenticated" using AUTH_SYS, in the clear, without
   client-peer authentication fit here, but we need to get
   to consensus on this point.<a href="#section-5.9-9.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.9-9.3">
     Issues regarding "AUTHENTICATED" will be the mirror
     image of those for "ANONYMOUS".<a href="#section-5.9-9.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="auto_inherit">
<section id="section-5.10">
        <h3 id="name-automatic-inheritance-featu">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-automatic-inheritance-featu" class="section-name selfRef">Automatic Inheritance Features</a>
        </h3>
<p id="section-5.10-1">
            The acl attribute consists only of an array of ACEs, but
            the <span><a href="#attrdef_sacl" class="xref">sacl</a> (<a href="#attrdef_sacl" class="xref">Section 12.1</a>)</span>
            and <span><a href="#attrdef_dacl" class="xref">dacl</a> (<a href="#attrdef_dacl" class="xref">Section 7.4.2</a>)</span> attributes
            also include an additional flag field.<a href="#section-5.10-1" class="pilcrow">¶</a></p>
<div id="section-5.10-2">
<pre class="lang-xdr sourcecode">
struct nfsacl41 {
        aclflag4        na41_flag;
        nfsace4         na41_aces&lt;&gt;;
};
</pre><a href="#section-5.10-2" class="pilcrow">¶</a>
</div>
<p id="section-5.10-3">

            The flag field
            applies to the entire sacl or dacl; three flag values are
            defined:<a href="#section-5.10-3" class="pilcrow">¶</a></p>
<div id="section-5.10-4">
<pre class="lang-xdr sourcecode">
const ACL4_AUTO_INHERIT         = 0x00000001;
const ACL4_PROTECTED            = 0x00000002;
const ACL4_DEFAULTED            = 0x00000004;
</pre><a href="#section-5.10-4" class="pilcrow">¶</a>
</div>
<p id="section-5.10-5">

            and all other bits must be cleared.  The
            ACE4_INHERITED_ACE flag may be set in the ACEs of the sacl
            or dacl (whereas it must always be cleared in the acl).<a href="#section-5.10-5" class="pilcrow">¶</a></p>
<p id="section-5.10-6">
            Together these features allow a server to support automatic
            inheritance, which we now explain in more detail.<a href="#section-5.10-6" class="pilcrow">¶</a></p>
<p id="section-5.10-7">
            Inheritable ACEs are normally inherited by child objects only
            at the time that the child objects are created; later
            modifications to inheritable ACEs do not result in
            modifications to inherited ACEs on descendants.<a href="#section-5.10-7" class="pilcrow">¶</a></p>
<p id="section-5.10-8">
            However, the dacl and sacl provide an <span class="bcp14">OPTIONAL</span> mechanism
            that allows a client application to propagate changes to
            inheritable ACEs to an entire directory hierarchy.<a href="#section-5.10-8" class="pilcrow">¶</a></p>
<p id="section-5.10-9">
            A server that supports this feature performs inheritance at object
            creation time in the normal way, and <span class="bcp14">SHOULD</span>  set the
            ACE4_INHERITED_ACE flag on any inherited ACEs as they are
            added to the new object.<a href="#section-5.10-9" class="pilcrow">¶</a></p>
<p id="section-5.10-10">
            A client application such as an ACL editor may then propagate
            changes to inheritable ACEs on a directory by recursively
            traversing that directory's descendants and modifying each ACL
            encountered to remove any ACEs with the ACE4_INHERITED_ACE flag
            and to replace them by the new inheritable ACEs (also with the
            ACE4_INHERITED_ACE flag set).  It uses the existing ACE
            inheritance flags in the obvious way to decide which ACEs to
            propagate.  (Note that it may encounter further inheritable
            ACEs when descending the directory hierarchy and that those
            will also need to be taken into account when propagating
            inheritable ACEs to further descendants.)<a href="#section-5.10-10" class="pilcrow">¶</a></p>
<p id="section-5.10-11">
            The reach of this propagation may be limited in two ways:
            first, automatic inheritance is not performed from any
            directory ACL that has the ACL4_AUTO_INHERIT flag
            cleared; and second, automatic inheritance stops wherever
            an ACL with the ACL4_PROTECTED flag is set, preventing
            modification of that ACL and also (if the ACL is set on
            a directory) of the ACL on any of the object's descendants.<a href="#section-5.10-11" class="pilcrow">¶</a></p>
<p id="section-5.10-12">
            This propagation is performed independently for the sacl
            and the dacl attributes; thus, the ACL4_AUTO_INHERIT and
            ACL4_PROTECTED flags may be independently set for the sacl
            and the dacl, and propagation of one type of acl may continue
            down a hierarchy even where propagation of the other acl has
            stopped.<a href="#section-5.10-12" class="pilcrow">¶</a></p>
<p id="section-5.10-13">
            New objects should be created with a dacl and a sacl that
            both have the ACL4_PROTECTED flag cleared and the
            ACL4_AUTO_INHERIT flag set to the same value as that on,
            respectively, the sacl or dacl of the parent object.<a href="#section-5.10-13" class="pilcrow">¶</a></p>
<p id="section-5.10-14">
            Both the dacl and sacl attributes are Recommended, and a server
            may support one without supporting the other.<a href="#section-5.10-14" class="pilcrow">¶</a></p>
<p id="section-5.10-15">
            A server that supports both the old acl attribute and
            one or both of the new dacl or sacl attributes must do so
            in such a way as to keep all three attributes consistent
            with each other.  Thus, the ACEs reported in the acl attribute
            should be the union of the ACEs reported in the dacl and
            sacl attributes, except that the ACE4_INHERITED_ACE flag must
            be cleared from the ACEs in the acl.  And of course a
            client that queries only the acl will be unable to determine
            the values of the sacl or dacl flag fields.<a href="#section-5.10-15" class="pilcrow">¶</a></p>
<p id="section-5.10-16">
            When a client performs a SETATTR for the acl attribute,
            the server <span class="bcp14">SHOULD</span> set the ACL4_PROTECTED flag to true on
            both the sacl and the dacl.  By using the acl attribute,
            as opposed to the dacl or sacl attributes, the client signals
            that it may not understand automatic inheritance, and thus
            cannot be trusted to set an ACL for which automatic
            inheritance would make sense.<a href="#section-5.10-16" class="pilcrow">¶</a></p>
<p id="section-5.10-17">
            When a client application queries an ACL, modifies it, and sets
            it again, it should leave any ACEs marked with
            ACE4_INHERITED_ACE unchanged, in their original order, at the
            end of the ACL.  If the application is unable to do this, it
            should set the ACL4_PROTECTED flag.  This behavior
            is not enforced by servers, but violations of this rule may
            lead to unexpected results when applications perform automatic
            inheritance.<a href="#section-5.10-17" class="pilcrow">¶</a></p>
<p id="section-5.10-18">
            If a server also supports the mode attribute, it <span class="bcp14">SHOULD</span> set the
            mode in such a way that leaves inherited ACEs unchanged, in
            their original order, at the end of the ACL.  If it is unable
            to do so, it <span class="bcp14">SHOULD</span> set the ACL4_PROTECTED flag on the file's
            dacl.<a href="#section-5.10-18" class="pilcrow">¶</a></p>
<p id="section-5.10-19">Finally, in the case where the request that creates a new file
            or directory does not also set permissions for that file or
            directory, and there are also no ACEs to inherit from the
            parent's directory, then the server's choice of ACL for the new
            object is implementation-dependent.  In this case, the server
            <span class="bcp14">SHOULD</span> set the ACL4_DEFAULTED flag on the ACL it chooses for
            the new object.  An application performing automatic
            inheritance takes the ACL4_DEFAULTED flag as a sign that the
            ACL should be completely replaced by one generated using the
            automatic inheritance rules.<a href="#section-5.10-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ACL-aclsupport">
<section id="section-5.11">
        <h3 id="name-attribute-13-aclsupport">
<a href="#section-5.11" class="section-number selfRef">5.11. </a><a href="#name-attribute-13-aclsupport" class="section-name selfRef">Attribute 13: aclsupport</a>
        </h3>
<p id="section-5.11-1">
            A server need not support all of the above ACE types.
     This attribute indicates which ACE types are supported for
     the current file system.  The bit mask constants used to
     represent the above definitions within the aclsupport
     attribute are as follows:<a href="#section-5.11-1" class="pilcrow">¶</a></p>
<div id="section-5.11-2">
<pre class="lang-xdr sourcecode">
const ACL4_SUPPORT_ALLOW_ACL    = 0x00000001;
const ACL4_SUPPORT_DENY_ACL     = 0x00000002;
const ACL4_SUPPORT_AUDIT_ACL    = 0x00000004;
const ACL4_SUPPORT_ALARM_ACL    = 0x00000008;
</pre><a href="#section-5.11-2" class="pilcrow">¶</a>
</div>
<p id="section-5.11-3">
       [Author Aside]: Even though support aclsupport is OPTIONAL,
       there has been no mention of the possibility of it not being
       supported.<a href="#section-5.11-3" class="pilcrow">¶</a></p>
<p id="section-5.11-4">
       [Consensus Needed (Item #14a)]: If this attribute is not supported
       for a server, the client is entitled
       to assume that if the acl attribute is supported, support for
       ALLOW and DENY ACEs is present.  Thus, if such a server supports the
       the sacl attribute, clients are not likely to use it if
       aclsupport is not supported by the server.<a href="#section-5.11-4" class="pilcrow">¶</a></p>
<p id="section-5.11-5">
              [Previous Treatment]: Servers that support either the ALLOW
       or DENY ACE type <span class="bcp14">SHOULD</span> support both
       ALLOW and DENY ACE types.<a href="#section-5.11-5" class="pilcrow">¶</a></p>
<p id="section-5.11-6">
       [Author Aside]:  It needs to be made clearer what the harm is
       that is to be prevented by this.  Further if such harm exists,
       it is not clear what are the valid reasons not do this?<a href="#section-5.11-6" class="pilcrow">¶</a></p>
<p id="section-5.11-7">
       [Consensus Needed (Item #15a)]: There is little point in
       implementing a server which supports either ALLOW or
       DENY ACE types without supporting both.  For reasons
       explained in <a href="#AUTHFA-attr" class="xref">Section 7.1</a> the ACL_based
       authorization cannot be used if only a single ACE type is
       available.<a href="#section-5.11-7" class="pilcrow">¶</a></p>
<p id="section-5.11-8">
              Clients should not attempt to set an ACE unless the server
              claims support for that ACE type. If the server receives a
              request to set an ACE that it cannot store, it <span class="bcp14">MUST</span>
       reject the request with NFS4ERR_ATTRNOTSUPP.<a href="#section-5.11-8" class="pilcrow">¶</a></p>
<p id="section-5.11-9">
       [Previous Treatment (Item #12c)]: If the server
              receives a request to set an ACE that it can store but
              cannot enforce, the server <span class="bcp14">SHOULD</span> reject the request
       with NFS4ERR_ATTRNOTSUPP.<a href="#section-5.11-9" class="pilcrow">¶</a></p>
<p id="section-5.11-10">
       [Author Aside]: Beyond the issues with the use of
       <span class="bcp14">SHOULD</span>, it is better to centralize this material
       and be clearer about the whole issue of ACL enforcement.<a href="#section-5.11-10" class="pilcrow">¶</a></p>
<p id="section-5.11-11">
       [Consensus Needed (Item #12c)]: The case of ACEs that cannot be
       enforced is similar, with the details of enforcement discussed in
       <a href="#ACL-maskr" class="xref">Section 5.5</a>.<a href="#section-5.11-11" class="pilcrow">¶</a></p>
<p id="section-5.11-12">
            Support for any of the ACL attributes is
            OPTIONAL, although Recommended.
            However, a server (NFSv4.1 and above) that supports either of the new ACL
            attributes (dacl or sacl) <span class="bcp14">MUST</span> allow use of the new ACL
            attributes to access all of the ACE types that it
            supports.  In other words, if a server which supports sacl or dacl
     supports ALLOW
            or DENY ACEs, then it <span class="bcp14">MUST</span> support the dacl attribute, and
            if it supports AUDIT or ALARM ACEs, then it <span class="bcp14">MUST</span> support
            the sacl attribute.<a href="#section-5.11-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ACL-acl">
<section id="section-5.12">
        <h3 id="name-attribute-12-acl">
<a href="#section-5.12" class="section-number selfRef">5.12. </a><a href="#name-attribute-12-acl" class="section-name selfRef">Attribute 12: acl</a>
        </h3>
<p id="section-5.12-1">
       The acl attribute, as opposed to the sacl and dacl attributes,
       consists only of an ACE array and does not support automatic
       inheritance.<a href="#section-5.12-1" class="pilcrow">¶</a></p>
<p id="section-5.12-2">
       The acl attribute is recommended and there is no requirement
       that a server support it.  However, when the dacl attribute is
       supported, it is a good idea to provide support for the acl
       attribute as well, in order to accommodate clients  that have
       not been upgraded to use the dacl attribute.<a href="#section-5.12-2" class="pilcrow">¶</a></p>
<p id="section-5.12-3">
       [Author Aside]: Although it has generally been assumed that
       changes to sacl and dacl attributes are to be visible in the acl
       and vice versa, NFSv4.1 specification do not appear to document
       this fact.<a href="#section-5.12-3" class="pilcrow">¶</a></p>
<p id="section-5.12-4">
       [Consensus Item, Including List (Item #16a)]: For NFSv4.1
       servers that support
       Both the acl attribute and one or more of the sacl and dacl
       attributes, changes to the ACE's need to be immediately
       reflected in the other supported attributes:<a href="#section-5.12-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.12-5.1">
            <p id="section-5.12-5.1.1">
 The result of reading the dacl attribute <span class="bcp14">MUST</span>
 consist of a set of ACEs that are exactly the same as the ACEs
 ALLOW and DENY ACEs within the the acl attribute, in the
 same order.<a href="#section-5.12-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.12-5.2">
            <p id="section-5.12-5.2.1">
 The result of reading the sacl attribute <span class="bcp14">MUST</span>
 consist of a set of ACEs that are exactly the same as the ACEs
 AUDIT and ALARM ACEs within the the acl attribute, in the
 same order.<a href="#section-5.12-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.12-5.3">
            <p id="section-5.12-5.3.1">
 The result of reading the acl attribute <span class="bcp14">MUST</span>
 consist of a set of ACEs that are exactly the same as the
 union of ACEs within the sacl and dacl attributes.  Two
 ACEs that both appear in one of the sacl or dacl attributes
 must appear in the same order in the acl attribute.<a href="#section-5.12-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="AUTHG">
<section id="section-6">
      <h2 id="name-authorization-in-general">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-authorization-in-general" class="section-name selfRef">Authorization in General</a>
      </h2>
<p id="section-6-1">
      There are three distinct methods of checking whether NFSv4 requests
      are authorized:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">
          <p id="section-6-2.1.1">
 The most important method of authorization is used to effect
 user-based file access control, as described in
 <a href="#AUTHFA" class="xref">Section 7</a>.<a href="#section-6-2.1.1" class="pilcrow">¶</a></p>
<p id="section-6-2.1.2">
        This requires the identification of the user making the request.
        Because of the central role of such access control in providing
 NFSv4 security, server implementations <span class="bcp14">SHOULD NOT</span>
 use such identifications when they are not authenticated. In this
 context, valid reasons to do otherwise are limited to the
 compatibility and maturity issues discussed in
 <a href="#SECCON-changes-compat" class="xref">Section 17.1.4</a><a href="#section-6-2.1.2" class="pilcrow">¶</a></p>
<p id="section-6-2.1.3"></p>
</li>
        <li class="normal" id="section-6-2.2">
          <p id="section-6-2.2.1">
 NFSv4.2, via the labelled NFS feature, provides an additional
 potential requirement for request authorization.<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6-2.2.2">
        For reasons made clear in <a href="#AUTHL" class="xref">Section 10</a>, there
        is no realistic possibility of the server using the data defined
 by existing specifications of this feature to effect request
 authorization.  While it is possible for clients to provide
 this authorization, the lack of detailed specifications makes it
 impossible to determine the nature of the identification used and
 whether it can appropriately be described as "authentication".<a href="#section-6-2.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-2.3">
          <p id="section-6-2.3.1">
 Since undesired changes to server-maintained locking state (and, for
 NFSv4.1, session state) can result in denial of service attacks
 (see <a href="#SECCON-denial" class="xref">Section 17.6</a>), server implementations
 <span class="bcp14">SHOULD</span> take steps to prevent unauthorized state
 changes. This can be done by implementing the state authorization
 restrictions discussed in <a href="#AUTHST" class="xref">Section 11</a><a href="#section-6-2.3.1" class="pilcrow">¶</a></p>
<p id="section-6-2.3.2"></p>
</li>
      </ul>
</section>
</div>
<div id="AUTHFA">
<section id="section-7">
      <h2 id="name-user-based-file-access-auth">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-user-based-file-access-auth" class="section-name selfRef">User-based File Access Authorization</a>
      </h2>
<div id="AUTHFA-attr">
<section id="section-7.1">
        <h3 id="name-attributes-for-user-based-f">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-attributes-for-user-based-f" class="section-name selfRef">Attributes for User-based File Access Authorization</a>
        </h3>
<p id="section-7.1-1">
     NFSv4.1 provides for multiple authentication models,
     controlled by the support for particular recommended attributes
     implemented by the server, as discussed below:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">
            <p id="section-7.1-2.1.1">
       Consensus Needed (Item #18a)]: The attributes owner,
       owning_group, and mode enable use of a POSIX-based
       authorization model, as described in
       <a href="#AUTHFA-posix" class="xref">Section 7.3</a>.
       When all of these attributes are supported, this authorization
       model can be implemented.<a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-7.1-2.1.2">
       Consensus Needed (Item #18a)]:When none of these attributes or only
       a proper subset of them are supported, this authorization model
       is unavailable.<a href="#section-7.1-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.2">
            <p id="section-7.1-2.2.1">
       [Consensus Needed (Item #17a)]: The acl attribute (or the
       attribute dacl in NFSv4.1) can
       provide an ACL-based authorization model as described in
       <a href="#AUTHFA-acl" class="xref">Section 7.4</a> as long as support for ALLOW and
       DENY ACEs is provided.<a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-7.1-2.2.2">
       [Consensus Needed (Items #17a, #18a)]: When some of
       these ACE types are
       not supported or the owner or
       owning_group attribute is not supported, this authorization model
       is unavailable, since there are some modes that cannot be
       represented as corresponding ACL, when using only a single ACE
       type.  See <a href="#AUTHCOMB-attr" class="xref">Section 9.2</a> for details.<a href="#section-7.1-2.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="AUTHFA-two">
<section id="section-7.2">
        <h3 id="name-handling-of-multiple-parall">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-handling-of-multiple-parall" class="section-name selfRef">Handling of Multiple Parallel File Access Authorization Models</a>
        </h3>
<p id="section-7.2-1">
            ACLs and modes represent two well-established models for
            specifying user-based file access permissions.  NFSv4 provides
     support for either or both depending on the attributes
     supported by the server and, in cases in which both
     ACLs and the mode attribute
     are supported, the actual attributes set for a particular object.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">
       [Consensus Needed (item #18b)]:
       When the attributes mode, owner, owner group are all supported,
       the posix-based
       authorization model, described in <a href="#AUTHFA-posix" class="xref">Section 7.3</a>
       can be used.<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">
       [Consensus Needed (Items #17b, #18b)]:
       When the acl (or dacl) attribute is supported together with
       both of the ACE types ALLOW and DENY, the acl based
       authorization model, described  in <a href="#AUTHFA-acl" class="xref">Section 7.4</a>
       can be used as long as the attributes owner and owner_group are
       also supported.<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-3">
     [Consensus Needed (item #18b)]:
     While formally recommended (essentially <span class="bcp14">OPTIONAL</span>)
     attributes, it appears that the owner and owner_group
     attributes need to be available to support any file access
     authorization model.  As a result, this document will not
     discuss the possibility of servers that do not support
     both of these attributes and clients have no need to
     support such servers.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">
     When both authorization models can be used, there are
     difficulties that can arise because the ACL-based model
     provides finer-grained access control than the POSIX model.
     The ways of dealing with these difficulties appear
     later in this section while more detail on the appropriate
     handling of this situation, which might depend on the minor
     version used, appears in <a href="#AUTHCOMB" class="xref">Section 9</a>.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">
     The following describe NFSv4's handling in supporting multiple
     authorization models for file access.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-6.1">
            <p id="section-7.2-6.1.1">
              If a server supports the mode attribute, it should provide
              the appropriate POSIX semantics if no ACL-based attributes
       have ever been assigned to object.  These semantics include
       the restriction of the ability to modify the mode, owner and
       owner-group to the current owner of the file.<a href="#section-7.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-6.2">
            <p id="section-7.2-6.2.1">
              If a server supports ACL attributes, it should provide
              ACL semantics as described in this document for all
       objects for which the ACL attributes have actually been
       set.  This includes the ACL-based restrictions on the
       authorization to modify the mode, owner and owner_group
       attributes.<a href="#section-7.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-6.3">
            <p id="section-7.2-6.3.1">
              On servers that support the mode attribute, if ACL
              attributes have never been set on an object, via
              inheritance or explicitly, the behavior should be
              the behavior mandated by POSIX, including the those
       that restrict the setting of authorization-related attributes.<a href="#section-7.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-6.4">
            <p id="section-7.2-6.4.1">
              On servers that support the mode attribute, if the ACL
              attributes have been previously set on an object, either
              explicitly or via inheritance:<a href="#section-7.2-6.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-6.4.2.1">
                <p id="section-7.2-6.4.2.1.1">
                [Previous Treatment]:
 Setting only the mode attribute should effectively
                control the traditional UNIX-like permissions of read,
                write, and execute on owner, owner_group, and other.<a href="#section-7.2-6.4.2.1.1" class="pilcrow">¶</a></p>
<p id="section-7.2-6.4.2.1.2">
         [Author Aside]: It isn't really clear
         what the above paragraph means, especially as it governs
 the handling of aces designating specific users and groups
 which are not the owner and have no overlap with the owning
 group<a href="#section-7.2-6.4.2.1.2" class="pilcrow">¶</a></p>
<p id="section-7.2-6.4.2.1.3">
         {Consensus Needed (Item #19a)]:
         Setting only the mode attribute, should result in the
 access of the file being controlled just it would be if
 the existing acl did not exist, with file access decisions
 as to read made in accordance with the mode set.   The
 ALLOW and DENY aces
 in the ACL should reflect the modified security although there
 is no need to modify AUDIT and ALARM aces or mask bits not 
 affected by the mode bits, such as SYNCHRONIZE.<a href="#section-7.2-6.4.2.1.3" class="pilcrow">¶</a></p>
<p id="section-7.2-6.4.2.1.4">
         [Author Aside]: the above may need to modified to reflect the
         resolution of Consensus Item #??.<a href="#section-7.2-6.4.2.1.4" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2-6.4.2.2">
                <p id="section-7.2-6.4.2.2.1">
                [Previous Treatment]:
 Setting only the mode attribute should provide
                reasonable security. For example, setting a mode of
                000 should be enough to ensure that future OPEN operations for
                OPEN4_SHARE_ACCESS_READ or OPEN4_SHARE_ACCESS_WRITE by any
 principal fail, regardless of a
                previously existing or inherited ACL.<a href="#section-7.2-6.4.2.2.1" class="pilcrow">¶</a></p>
<p id="section-7.2-6.4.2.2.2">
         [Author Aside]:  We need to get rid of or provide some some replacement
         for the subjective first sentence.  While the specific
 example give is unexceptionable, it raises questions in
 other cases as to what would constitutes "reasonable
 semantics". While the resolution of such questions would be
 subject to dispute, the author believes
 that consensus item #19a deals with the matter adequately.
 As a result he proposes, that the that this bullet be removed
 and the second-level list collapsed to single paragraph.<a href="#section-7.2-6.4.2.2.2" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.2-6.5">
            Although RFCs 7530 and 8881 present different descriptions
     of the specific semantic requirements
            relating to the interaction of mode and ACL attributes,
     the difference are quite small, with the most
     important ones deriving from the absence of the set_mode_masked
     attribute.   The unified treatment in <a href="#AUTHCOMB" class="xref">Section 9</a>
     will indicate where version-specific differences exist.<a href="#section-7.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="AUTHFA-posix">
<section id="section-7.3">
        <h3 id="name-posix-authorization-model">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-posix-authorization-model" class="section-name selfRef">Posix Authorization Model</a>
        </h3>
<div id="AUTHFA-posix-mode">
<section id="section-7.3.1">
          <h4 id="name-attribute-33-mode">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-attribute-33-mode" class="section-name selfRef">Attribute 33: mode</a>
          </h4>
<p id="section-7.3.1-1">
          The NFSv4.1 mode attribute is based on the UNIX mode
          bits. The following bits are defined:<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<div id="section-7.3.1-2">
<pre class="lang-xdr sourcecode">
const MODE4_SUID = 0x800;  /* set user id on execution */
const MODE4_SGID = 0x400;  /* set group id on execution */
const MODE4_SVTX = 0x200;  /* save text even after use */
const MODE4_RUSR = 0x100;  /* read permission: owner */
const MODE4_WUSR = 0x080;  /* write permission: owner */
const MODE4_XUSR = 0x040;  /* execute permission: owner */
const MODE4_RGRP = 0x020;  /* read permission: group */
const MODE4_WGRP = 0x010;  /* write permission: group */
const MODE4_XGRP = 0x008;  /* execute permission: group */
const MODE4_ROTH = 0x004;  /* read permission: other */
const MODE4_WOTH = 0x002;  /* write permission: other */
const MODE4_XOTH = 0x001;  /* execute permission: other */
</pre><a href="#section-7.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.1-3">
          Bits MODE4_RUSR, MODE4_WUSR, and MODE4_XUSR apply to the
          principal identified by the owner attribute. Bits MODE4_RGRP,
          MODE4_WGRP, and MODE4_XGRP apply to principals belonging to
   the group identified in
          the owner_group attribute but who are not identified by the
          owner attribute. Bits MODE4_ROTH, MODE4_WOTH, and MODE4_XOTH apply
          to any principal that does not match that in the owner
          attribute and does not belong to a group matching that of the
          owner_group attribute.  These nine bits are used in providing
   authorization information.<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
<p id="section-7.3.1-4">
     [Previous Treatment]: The bits MODE4_SUID, MODE4_SGID, and
     MODE4_SVTX do not
     provide authorization information and do not affect server
     behavior.  Instead, they are acted on by the client just as
     they would be for corresponding mode bits obtained from
     local file systems.<a href="#section-7.3.1-4" class="pilcrow">¶</a></p>
<p id="section-7.3.1-5">
     [Consensus needed (Item #6c)]: For objects which are not
     directories, the bits MODE4_SUID,
     MODE4_SGID,
     and MODE4_SVTX do not
     provide authorization information and do not affect server
     behavior.  Instead, they are acted on by the client just as
     they would be for corresponding mode bits obtained from
     local file systems.<a href="#section-7.3.1-5" class="pilcrow">¶</a></p>
<p id="section-7.3.1-6">
     [Consensus needed (Item #6c)]: For directories, the bits
     MODE4_SUID and MODE4_SGID,
     do not
     provide authorization information and do not affect server
     behavior.  Instead, they are acted on by the client just as
     they would be for corresponding mode bits obtained from
     local file systems.  The mode bit MODE_SVTX does have an
     authorization-related role as described later in this section<a href="#section-7.3.1-6" class="pilcrow">¶</a></p>
<p id="section-7.3.1-7">
     [Consensus Needed, Including List (Item #6c]): When handling
     RENAME and REMOVE operations the check for authorization depends
     on the setting of MODE_SVTX for the directory.<a href="#section-7.3.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-8.1">
       When MODE_SVTX is not set on the directory, authorization
       requires
       write permission on both the file being renamed and the source
       directory.<a href="#section-7.3.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.1-8.2">
       When MODE_SVTX is not on the directory, authorization requires,
       in addition that the requesting principal be the owner of the
       file to be named or removed.<a href="#section-7.3.1-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.3.1-9">
     [Consensus needed (Item #6c)]: It should be noted that
     this approach is similar to ACL-based
     approach documented in <a href="#ACL-deletes" class="xref">Section 5.6</a>.  However
     there are  some semantics differences whose motivation remains
     unclear and the specification does not mention RENAME,
     as it should.<a href="#section-7.3.1-9" class="pilcrow">¶</a></p>
<p id="section-7.3.1-10">
     [Author Aside]: Bringing the above into more alignment with
     the ACL-based semantics is certainly desirable but the
     necessary work has not been done yet.  For tracking purposes,
     that realignment will be considered Consensus Item #20.<a href="#section-7.3.1-10" class="pilcrow">¶</a></p>
<p id="section-7.3.1-11">
          Bits within a mode other than those specified above
          are not defined by this protocol. A server
          <span class="bcp14">MUST NOT</span> return bits other than those defined above 
          in a GETATTR or READDIR operation, and it <span class="bcp14">MUST</span>
   return NFS4ERR_INVAL
          if bits other than those defined above are set in a SETATTR,
          CREATE, OPEN, VERIFY, or NVERIFY operation.<a href="#section-7.3.1-11" class="pilcrow">¶</a></p>
<p id="section-7.3.1-12">
     [Consensus Needed (Item #21a)]: In the typical case,
     the nine low-order bits
     are set such that each successive set of three bits is a
     subset, not necessarily
     proper, of the previous three bits.
     Such modes are described as forward-slope
     nodes because the privilege level goes downward as you
     proceed forward.  There
     are, however, cases in which there is an increase
     of privilege going from owner
     to group or from group to owner.
     Such modes are considered reverse-slope modes.
     As will be seen in Sections
     <a href="#AUTHCOMB-computemode" class="xref">9.3</a>
     and <a href="#AUTHCOMB-setmode" class="xref">9.6</a>,
     many straightforward ways
     of dealing with mode that work well with forward-slope
     modes need adjustment to
     properly deal with reverse-slope modes.<a href="#section-7.3.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHFA-posix-smm">
<section id="section-7.3.2">
          <h4 id="name-nfsv41-attribute-74-mode_se">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-nfsv41-attribute-74-mode_se" class="section-name selfRef">NFSv4.1 Attribute 74: mode_set_masked</a>
          </h4>
<p id="section-7.3.2-1">
            The mode_set_masked attribute is a write-only attribute 
            that allows individual bits in the mode attribute to be
            set or reset, without changing others.  It allows, for
            example, the bits MODE4_SUID, MODE4_SGID, and MODE4_SVTX
            to be modified while leaving unmodified any of the 
            nine low-order mode bits devoted to permissions.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">
            When minor versions other than NFSv4.0 are used, instances of
     use of the set_mode_masked attribute such that none of
     the nine low-order bits are subject
            to modification, then neither the acl nor the dacl attribute
            should be automatically modified as discussed in 
     Sections <a href="#AUTHCOMB-setmode" class="xref">9.6</a> and
     <a href="#AUTHCOMB-setboth" class="xref">9.8</a>.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">
          The mode_set_masked attribute consists of two words,
          each in the form of a mode4.  The first consists of the
          value to be applied to the current mode value and the
          second is a mask.  Only bits set to one in the mask word
          are changed (set or reset) in the file's mode.  All 
          other bits in the mode remain unchanged.  Bits in the
          first word that correspond to bits that are zero in
          the mask are ignored, except that undefined bits are
          checked for validity and can result in NFS4ERR_INVAL as
          described below.<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<p id="section-7.3.2-4">
          The mode_set_masked attribute is only valid in a SETATTR
          operation.  If it is used in a CREATE or OPEN operation, the
          server <span class="bcp14">MUST</span> return NFS4ERR_INVAL.<a href="#section-7.3.2-4" class="pilcrow">¶</a></p>
<p id="section-7.3.2-5">
          Bits not defined as valid in the mode attribute are not
          valid in either word of the mode_set_masked attribute.
          The server <span class="bcp14">MUST</span> return NFS4ERR_INVAL
          if any such bits are set to one in a SETATTR.  
   If the mode and
          mode_set_masked attributes are both specified in the
          same SETATTR, the server <span class="bcp14">MUST</span> also return
   NFS4ERR_INVAL.<a href="#section-7.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHFA-acl">
<section id="section-7.4">
        <h3 id="name-acl-based-authorization-mod">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-acl-based-authorization-mod" class="section-name selfRef">ACL-based Authorization Model</a>
        </h3>
<div id="AUTHFA-proc-ace">
<section id="section-7.4.1">
          <h4 id="name-processing-access-control-e">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-processing-access-control-e" class="section-name selfRef">Processing Access Control Entries</a>
          </h4>
<p id="section-7.4.1-1">
           To determine if a request succeeds, the server processes
           each nfsace4 entry of type ALLOW or DENY
    in turn as ordered in the array.  Only ACEs
   that have a "who"
          that matches the requester are considered. An ACE is considered to
   match a given requester if at least one of the following is true:<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4.1-2.1">
       The "who' designates a specific user which is the 
       user making the request.<a href="#section-7.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.1-2.2">
       The "who" specifies "OWNER@" and the user making the request
       is the
       owner of the file.<a href="#section-7.4.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.1-2.3">
       The "who" designates a specific group and the
       user making the request is a member of that group.<a href="#section-7.4.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.1-2.4">
       The "who" specifies "GROUP@" and the user making the request
       is a
       member of the group owning the file.<a href="#section-7.4.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.1-2.5">
       The "who" specifies "EVERYONE@".<a href="#section-7.4.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.1-2.6">
       The "who" specifies "INTERACTIVE@", "NETWORK@", "DIALUP@", "BATCH@",
       or "SERVICE@" and the requester, in the judgment of the server,
       feels that designation appropriately describes the requester.<a href="#section-7.4.1-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.1-2.7">
       The "who" specifies "ANONYMOUS@" or "AUTHENTICATED@" and the
       requestor's authentication status matches the who, using the
       definitions in <a href="#ACL-who" class="xref">Section 5.9</a><a href="#section-7.4.1-2.7" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.4.1-3">
     Each ACE is
          processed until all of the bits of the requester's access
          have been ALLOWED.  Once a bit (see below) has been ALLOWED
          by an ACCESS_ALLOWED_ACE, it is no longer considered in the
          processing of later ACEs.  If an ACCESS_DENIED_ACE is
          encountered where the requester's access still has unALLOWED
          bits in common with the "access_mask" of the ACE, the
          request is denied.  When the ACL is fully processed, if
          there are bits in the requester's mask that have not been
          ALLOWED or DENIED, access is denied.<a href="#section-7.4.1-3" class="pilcrow">¶</a></p>
<p id="section-7.4.1-4">
          Unlike the ALLOW and DENY ACE types, the ALARM and AUDIT ACE
          types do not affect a requester's access, and instead are
          for triggering events as a result of a requester's access
          attempt.  AUDIT and ALARM ACEs are processed only
          after processing ALLOW and DENY ACEs if any exist.  This
   is necessary since the handling of AUDIT and ALARM ACEs are
   affected by whether the access attempt is successful.<a href="#section-7.4.1-4" class="pilcrow">¶</a></p>
<p id="section-7.4.1-5">
            [Previous Treatment]: The NFSv4.1 ACL model is quite rich.
     Some server
          platforms may provide access-control functionality that goes
          beyond the UNIX-style mode attribute, but that is not as
          rich as the NFS ACL model.  So that users can take advantage
          of this more limited functionality, the server may support
          the acl attributes by mapping between its ACL model and the
          NFSv4.1 ACL model.  Servers must ensure that the ACL
          they actually store or enforce is at least as strict as the
          NFSv4 ACL that was set.  It is tempting to accomplish this
          by rejecting any ACL that falls outside the small set that
          can be represented accurately.  However, such an approach
          can render ACLs unusable without special client-side
          knowledge of the server's mapping, which defeats the purpose
          of having a common NFSv4 ACL protocol.  Therefore, servers
          should accept every ACL that they can without compromising
          security.  To help accomplish this, servers may make a
          special exception, in the case of unsupported permission
          bits, to the rule that bits not ALLOWED or DENIED by an ACL
          must be denied.  For example, a UNIX-style server might
          choose to silently allow read attribute permissions even
          though an ACL does not explicitly allow those permissions.
          (An ACL that explicitly denies permission to read attributes
          should still be rejected.)<a href="#section-7.4.1-5" class="pilcrow">¶</a></p>
<p id="section-7.4.1-6">
     [Author Aside]:  While the NFSv4.1 provides that many might
     not need or use, it is the one that the working group
     adopted by the working group, and I have to assume that
     alternatives, such as the withdrawn POSIX ACL proposal
     were considered but not adopted.   The phrase "unsupported
     permission bits" with no definition of the bit whose support
     might be dispensed with, implies that the server is free to support
     whatever subset of these bits it chooses.   As a result, clients
     would not be able to rely on a functioning server implementation
     of this OPTIONAL attribute.   If there are specific compatibility
     issues
     that make it necessary to allow non-support of specific mask bits,
     then these need to be limited and the client needs guidance
     about determining the set of unsupported mask bits.<a href="#section-7.4.1-6" class="pilcrow">¶</a></p>
<p id="section-7.4.1-7">
            [Previous Treatment]: The situation is complicated by the fact
     that a server may
          have multiple modules that enforce ACLs. For example, the
          enforcement for NFSv4.1 access may be different from,
          but not weaker than, the enforcement for local access, and
          both may be different from the enforcement for access
          through other protocols such as SMB (Server Message Block). So it may be useful for
          a server to accept an ACL even if not all of its modules are
          able to support it.<a href="#section-7.4.1-7" class="pilcrow">¶</a></p>
<p id="section-7.4.1-8">
     [Author Aside]:  The following paragraph does not provide 
     helpful guidance and takes no account of the need of the
     the client to be able to rely on the server implementing
     protocol-specifying semantics and giving notice in those
     cases in which it is unable to so<a href="#section-7.4.1-8" class="pilcrow">¶</a></p>
<p id="section-7.4.1-9">
            [Previous Treatment]: The guiding principle with regard
     to NFSv4 access is
            that the server must not accept ACLs that appear to
            make access to the file more restrictive than it really is.<a href="#section-7.4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attrdef_dacl">
<section id="section-7.4.2">
          <h4 id="name-v41-attribute-58-dacl">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-v41-attribute-58-dacl" class="section-name selfRef">V4.1 Attribute 58: dacl</a>
          </h4>
<p id="section-7.4.2-1">
          The dacl attribute is like the acl attribute,
          but dacl allows 
          only ALLOW and DENY ACEs.  The dacl
          attribute supports automatic inheritance (see
          <a href="#auto_inherit" class="xref">Section 5.10</a>).<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="AUTHCOMM">
<section id="section-8">
      <h2 id="name-common-considerations-for-b">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-common-considerations-for-b" class="section-name selfRef">Common Considerations for Both File access Models</a>
      </h2>
<p id="section-8-1">
     [Author Aside, Including List]: This subsections within this section are
     derived from Section 6.3 of 8881, entitled "Common Methods.
     However, its content is
     different because it has been rewritten to deal with issues
     common to both file access models, which now appears to have
     not been the original intention.  Nevertheless, the following
     changes have been made:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">
       The section "Server Considerations" has been revised  to
       deal with both the mode and acl attributes, since the points
       being made apply, in almost all cases, to both attributes.<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">
       The section "Client Considerations" has been heavily revised,
       since what had been there did not make any sense to me.<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.3">
          <p id="section-8-2.3.1">
       The section "Computing a Mode Attribute from an ACL" has been
       moved to <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a> since it deals
       with the
       co-ordination of  the posix and acl authorization models.<a href="#section-8-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="AUTHCOMM-server">
<section id="section-8.1">
        <h3 id="name-server-considerations">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-server-considerations" class="section-name selfRef">Server Considerations</a>
        </h3>
<p id="section-8.1-1"> 
       The server uses the  mode attribute or the acl attribute applying
       the algorithm described in
       <a href="#AUTHFA-proc-ace" class="xref">Section 7.4.1</a> to determine whether an ACL
       allows access to an object.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">
       [Author Aside, Including List]: The list previously in this
       section (now described as "Previous Treatment"
       combines two related issues in a way which obscures the
       very different security-related consequences of two distinct 
       issues:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.1">
            <p id="section-8.1-3.1.1">
         In some cases an operation will be authorized but is not
 allowed for reasons unrelated to authorization.<a href="#section-8.1-3.1.1" class="pilcrow">¶</a></p>
<p id="section-8.1-3.1.2">
         This has no negative effect on security.<a href="#section-8.1-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.2">
            <p id="section-8.1-3.2.1">
 The converse case does have troubling effects on
 security which are mentioned in this section and discussed in
 more detail in <a href="#SECCON" class="xref">Section 17</a><a href="#section-8.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-4">
       [Author Aside, Including List]: The items in that list
       have been dealt with as follows:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-5.1">
            <p id="section-8.1-5.1.1">
                The first and sixth items fit under the first (i.e. less
 troublesome) of these
 issues.  They have have been transferred into an
 appropriate 
 replacement list.<a href="#section-8.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-5.2">
 The third item is to be deleted since it does not
 manifest either of these issues.  In fact, it refers to
 the semantics already described in <a href="#ACL-maskd" class="xref">Section 5.4</a>. 
 is already described in ...<a href="#section-8.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-5.3">
            <p id="section-8.1-5.3.1">
 The second, fourth and fifth items need to be addressed
 in a new list dealing with the potentially troublesome
 issues arising from occasions in which the access semantics
 previously described are relaxed, for various reasons.<a href="#section-8.1-5.3.1" class="pilcrow">¶</a></p>
<p id="section-8.1-5.3.2">
         Included are cases in which previous specifications
         explicitly allowed this by using the term
 "<span class="bcp14">MAY</span>" and others in which the existence
 of servers manifesting such behavior was reported, with
 the implication that clients need to prepared for
 such behavior.<a href="#section-8.1-5.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-6"> 
       [Previous Treatment, Including List (Item #22a)]: However,
       these attributes might not be
       the sole determiner of access.  For example:<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-7.1">
                In the case of a file system exported as read-only,
                the server will deny write access even though
                an object's file access attributes would  grant it.<a href="#section-8.1-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-7.2">
                Server implementations <span class="bcp14">MAY</span> grant ACE4_WRITE_ACL
                and ACE4_READ_ACL permissions to prevent
                a situation from arising in which there is no valid
                way to ever modify the ACL.<a href="#section-8.1-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-7.3">
                All servers will allow a user the ability to read
                the data of the file when only the execute
                permission is granted (e.g., if the ACL denies the
                user the ACE4_READ_DATA access and allows the user
                ACE4_EXECUTE, the server will allow the user to
                read the data of the file).<a href="#section-8.1-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-7.4">
                Many servers implement owner-override semantics in
                which the owner of the object is allowed to
                override accesses that are denied by the ACL.
                This may be helpful, for example, to allow users
                continued access to open files on which the
                permissions have changed.<a href="#section-8.1-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-7.5">
                Many servers provide for the existence of a
                "superuser" that has privileges beyond
                an ordinary user.  The superuser may be able
                to read or write data or metadata in ways that would
                not be permitted by the ACL or mode attributes.<a href="#section-8.1-7.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-7.6">
                A retention attribute might also block access otherwise
                allowed by ACLs (see Section 5.13 of
 <span>[<a href="#RFC8881" class="xref">8</a>]</span>).<a href="#section-8.1-7.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-8"> 
       [Consensus Needed, Including List (Item #22a)]: It should be
       noted that, even when an operation is authorized, it may be
       denied for reasons unrelated to authorization.
       For example:<a href="#section-8.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-9.1">
                In the case of a file system exported as read-only,
                the server will deny write access even though
                an object's file access attributes would authorize it.<a href="#section-8.1-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-9.2">
                A retention attribute might also block access otherwise
                allowed by ACLs (see Section 5.13 of
 <span>[<a href="#RFC8881" class="xref">8</a>]</span>).<a href="#section-8.1-9.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-10"> 
       [Consensus Needed, (Item #22a)]: There are
       also cases in which the converse issue arises, so that
       an operation which is not authorized as specified by the
       mode and ACL attributes is, nevertheless, executed as if
       it were authorized. Because previous NFSv4 
       specifications have cited the cases listed below
       without reference to the security problems that they
       create, it is necessary to discuss them here to
       provide clarification of the security implications
       of following this guidance, which is now superseded.
       These cases are
       listed below and discussed in more detail in
       <a href="#SECCON-changes-diverge" class="xref">Section 17.1.3</a>.<a href="#section-8.1-10" class="pilcrow">¶</a></p>
<p id="section-8.1-11">
       [Consensus Needed, Including List (Item #22a)]: 
       In the following list, the treatment used in RFC8881 is
       quoted, while the corresponding text in RFC7530 is
       essentially identical.<a href="#section-8.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-12.1">
            <p id="section-8.1-12.1.1">
 RFC8881 contains the following, which is now superseded:<a href="#section-8.1-12.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-12.1.2.1">
                  Server implementations <span class="bcp14">MAY</span> grant ACE4_WRITE_ACL
                  and ACE4_READ_ACL permissions to prevent
                  a situation from arising in which there is no valid
                  way to ever modify the ACL.<a href="#section-8.1-12.1.2.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-8.1-12.1.3">
 While, as a practical matter, there do need to be provisions
 to deal with this issue, the "<span class="bcp14">MAY</span>" above is too
 broad,in that it describes the motivation without any limits
 providing appropriate restriction on the step that might be
 taken to deal with the issue. See
 <a href="#SECCON-changes-diverge" class="xref">Section 17.1.3</a> for the updated
 treatment of this issue.<a href="#section-8.1-12.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-12.2">
            <p id="section-8.1-12.2.1">
 RFC8881 contains the following, which is now superseded:<a href="#section-8.1-12.2.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-12.2.2.1">
                  Many servers implement owner-override semantics in
                  which the owner of the object is allowed to
                  override accesses that are denied by the ACL.
                  This may be helpful, for example, to allow users
                  continued access to open files on which the
                  permissions have changed.<a href="#section-8.1-12.2.2.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-8.1-12.2.3">
 Regardless of the truth of the first sentence above,
 either when it was written or today, it needs to be
 stressed that the fact that a server manifests a
 particular behavior does not imply that it is valid according
 to the protocol specification.  In this case, the
 supposed "owner-override semantics" clearly are not
 valid, since they contradict the specification of both
 the mode-based and ACL-based approaches to file access
 authorization.<a href="#section-8.1-12.2.3" class="pilcrow">¶</a></p>
<p id="section-8.1-12.2.4">
         With regard to the second sentence of the quotation
         above, it is not clear whether it is helpful or hurtful
 to allow continued access to open files which have become
 inaccessible due to changes in security
 and  it is not clear that the working group will make a
 decision on the matter in this document, despite the
 obvious security implications.  In any case, the resolution
 is unlikely to depend on whether the owner is involved.<a href="#section-8.1-12.2.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-12.3">
            <p id="section-8.1-12.3.1">
 RFC8881 contains the following, which is now superseded:<a href="#section-8.1-12.3.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-12.3.2.1">
                  Many servers have the notion of a
                  "superuser" that has privileges beyond
                  an ordinary user.  The superuser may be able
                  to read or write data or metadata in ways that would
                  not be permitted by the ACL or mode attributes.<a href="#section-8.1-12.3.2.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-8.1-12.3.3">
 While many (or almost all) systems in which NFSv4 servers
 are embedded, have provisions  for
 such privileged access to be provided, it does not follow that
 NFSv4 servers, as such, need to have provision for
 such access.<a href="#section-8.1-12.3.3" class="pilcrow">¶</a></p>
<p id="section-8.1-12.3.4">
         Providing such access as part of the NFSv4 protocols, would
         necessitate a major revision of the semantics of ACL including
 such troublesome matters as the proper handling of AUDIT and
 ALARM ACEs in the face of such privileged access.<a href="#section-8.1-12.3.4" class="pilcrow">¶</a></p>
<p id="section-8.1-12.3.5">
         Because of the effect such unrestricted access might have in
         facilitating and perpetuating attacks,
 <a href="#SECCON-changes-diverge" class="xref">Section 17.1.3</a> will explain that
 the treat analysis in <a href="#SECCON" class="xref">Section 17</a>, will not cover
 servers which choose to allow such access.<a href="#section-8.1-12.3.5" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="AUTHCOMM-client">
<section id="section-8.2">
        <h3 id="name-client-considerations">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-client-considerations" class="section-name selfRef">Client Considerations</a>
        </h3>
<p id="section-8.2-1">
              [Previous Treatment]: Clients <span class="bcp14">SHOULD NOT</span>
       do their own access checks based on
            their interpretation of the ACL, but rather use the OPEN and
            ACCESS operations to do access checks. This allows the
            client to act on the results of having the server
            determine whether or not access should be granted based on
            its interpretation of the ACL.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">
       [Author Aside]:  With regard to the use of
       "<span class="bcp14">SHOULD NOT</span>" in the paragraph above, it is not
       clear what might be valid reasons to bypass this recommendation.
       Perhaps "<span class="bcp14">MUST NOT</span>" or "should not" would be
       more appropriate.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">
              [Consensus Needed (Item #23a)]: Clients are expected to
       do their own access checks based on
            their interpretation of the ACL, but instead use the OPEN and
            ACCESS operations to do access checks. This allows the
            client to act on the results of having the server
            determine whether or not access should be granted based on
            its interpretation of the ACL.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">
              [Previous Treatment]: Clients must be aware of situations
       in which an object's
            ACL will define a certain access even though the server
            will not enforce it. In general, but especially in these
            situations, the client needs to do its part in the
            enforcement of access as defined by the ACL.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">
       [Author Aside]:  Despite what is said later,
       the only such case I know of is the use of READ and EXECUTE
       where the client, but not the server, has any means of
       distinguishing these.   I don't know of any others.
       If there were,
       how could ACCESS or OPEN be used to verify access?<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">
       [Consensus Needed (Item #23a)];
            Clients need to be aware of situations in which an object's
            ACL will define a certain access even though the server
            is not in position to enforce it because the server does
     not have the relevant information, such as knowing whether a
     READ is for the purpose of executing a file.
     Because of such situations,
            the client needs to do be prepared to do its part in the
            enforcement of access as defined by the ACL.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<p id="section-8.2-7">
       To do this,
            the client will send the appropriate ACCESS operation
            prior to servicing the request of the user or application
            in order to determine whether the user or application
            should be granted the access requested.<a href="#section-8.2-7" class="pilcrow">¶</a></p>
<p id="section-8.2-8">
     [Previous Treatment (Item #24a)]: For examples in
            which the ACL may define accesses that the server doesn't
            enforce, see <a href="#AUTHCOMM-server" class="xref">Section 8.1</a>.<a href="#section-8.2-8" class="pilcrow">¶</a></p>
<p id="section-8.2-9">
       [Author Aside]:  The sentence above is
       clearly wrong since that section is about enforcement the
       server does do.  The expectation is that it will be deleted
       as part of Consensus Item #24a.<a href="#section-8.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHCOMB">
<section id="section-9">
      <h2 id="name-combining-authorization-mod">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-combining-authorization-mod" class="section-name selfRef">Combining Authorization Models</a>
      </h2>
<div id="AUTHCOMB-bg">
<section id="section-9.1">
        <h3 id="name-background-for-combined-aut">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-background-for-combined-aut" class="section-name selfRef">Background for Combined Authorization Model</a>
        </h3>
<p id="section-9.1-1">
        Both RFCs 7530 and 5661 contain material relating to the
        need, when both mode and ACL attributes are supported,
        to make sure that the values are appropriately
        co-ordinated. Despite the fact that these discussions are
        different, they are compatible, and differ in only a
        small number of areas.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">
        [Author Aside]:  From this point on, all unannotated
        paragraphs in this section are to be assumed part of
        Consensus Item #25b<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">
        As a result, in this document, we will have a single
        treatment of this issue, in Sections
        <a href="#AUTHCOMB-attr" class="xref">9.2</a> through
        <a href="#AUTHCOMB-inheritreq" class="xref">9.11</a>.
        In addition, an NFSv4.2-based extension related to attribute
        co-ordination will be described in
        <a href="#AUTHCOMB-v42" class="xref">Section 9.12</a>.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">
        The current NFSv4.0 and NFSv4.1 descriptions of this
        share one unfortunate characteristic in that they both
        are written to give server implementations a broad
        latitude in implementation choices while neglecting
        entirely the need for the clients and users to have a
        reliable description of what servers are to do in this
        area.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">
        As a result, one of the goals of this new combined
        treatment will be to limit this excessive freedom, while
        taking proper account of the possibility of compatibility
        issues that a more tightly drawn specification might give
        rise to.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">
        [Author Aside, Including List]: The various ways in
        which these kinds of issues have been dealt with are listed
        below:<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-7.1">
            <p id="section-9.1-7.1.1">
  In some cases, the term "<span class="bcp14">MAY</span>" is used in
  contexts where it is inappropriate, since the allowed
  variation has the potential to cause  harm in that it
  leaves the client unsure exactly what security-related
  action will be performed by the server.<a href="#section-9.1-7.1.1" class="pilcrow">¶</a></p>
<p id="section-9.1-7.1.2"></p>
</li>
          <li class="normal" id="section-9.1-7.2">
            <p id="section-9.1-7.2.1">
  There are also cases in which no RFC2119-defined
  keywords are used but it is stated that certain server
  implementations do a particular, leaving the
  impression that that action is to be allowed, just as
  if "<span class="bcp14">MAY</span>" had been used.<a href="#section-9.1-7.2.1" class="pilcrow">¶</a></p>
<p id="section-9.1-7.2.2"></p>
</li>
          <li class="normal" id="section-9.1-7.3">
            <p id="section-9.1-7.3.1">
  There is a case in which the term "<span class="bcp14">SHOULD</span>"
  is clearly used intentionally, without it being
  clear what the valid reasons to ignore the guidance
  might be.<a href="#section-9.1-7.3.1" class="pilcrow">¶</a></p>
<p id="section-9.1-7.3.2"></p>
</li>
          <li class="normal" id="section-9.1-7.4">
            <p id="section-9.1-7.4.1">
  There are many case in which the term "<span class="bcp14">SHOULD</span>"
  is used without any clear indication why it was used.
  In this situation it is possible that the
  "<span class="bcp14">SHOULD</span>" was essentially treated
  as a "<span class="bcp14">MAY</span>" but also possible that servers
  chose to follow the recommendation.<a href="#section-9.1-7.4.1" class="pilcrow">¶</a></p>
<p id="section-9.1-7.4.2"></p>
</li>
        </ul>
<p id="section-9.1-8">
        In order to deal with the many uses of the terms
        "<span class="bcp14">SHOULD</span>" and "<span class="bcp14">SHOULD NOT</span>"
        in <a href="#AUTHCOMB" class="xref">Section 9</a> and included subsections,
        which have no clear motivation, it is to be assumed
        that the valid reasons to act contrary to the recommendation
        given are the difficulty of changing implementations
        based on previous analogous guidance, which may have
        given the impression that  the server was free to ignore
        the guidance for any reason the implementer chose.
        This allows the possibility of more individualized
        treatment of these instances once compatibility
        issues have been adequately discussed.<a href="#section-9.1-8" class="pilcrow">¶</a></p>
<p id="section-9.1-9">
        [Author Aside]: In each subsection in which the the
        interpretation of these term in the previous paragraph applies
        there will be an explicit reference to Consensus Item
        #25, to draw attention to this change, even in the absence of
        modified text.<a href="#section-9.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-attr">
<section id="section-9.2">
        <h3 id="name-needed-attribute-coordinati">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-needed-attribute-coordinati" class="section-name selfRef">Needed Attribute Coordination</a>
        </h3>
<p id="section-9.2-1">
            On servers that support both the mode and the acl or
            dacl attributes, the server must keep the two consistent
            with each other.  The value of the mode attribute (with
            the exception of the high-order bits reserved for client use as
     described in
            <a href="#AUTHFA-posix-mode" class="xref">Section 7.3.1</a>) must be determined entirely
            by the value of the ACL, so that use of the mode is
            never required for anything other than setting the
            three high-order bits.  See Sections
     <a href="#AUTHCOMB-setmode" class="xref">9.6</a> through
     <a href="#AUTHCOMB-setboth" class="xref">9.8</a> 
            for detailed discussion.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">
            [Previous Treatment (Item #25c)]:
     When a mode attribute is set on an object, the ACL
            attributes may need to be modified in order to not conflict
            with the new mode. In such cases, it is desirable that the
            ACL keep as much information as possible. This includes
            information about inheritance, AUDIT and ALARM ACEs, and
            permissions granted and denied that do not conflict with
            the new mode.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">
     [Author Aside]: the things that this formulation leaves
     uncertain, is whether, if the ACL specifies permission for
     a named user group or group, it "conflicts" with the node.
     Ordinarily, one might think it does not, unless the specified
     user is the owner of the file or a member of the owning group,
     or the specified group is the owning group.  However, while
     some parts of the existing treatment seem to agree with
     this, other parts, while unclear, seem to suggest
     otherwise, while the treatment in <a href="#AUTHCOMB-setmode" class="xref">Section 9.6</a>
     is directly in conflict.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">
          [Previous Treatment (Item #26a)]:
   The server that supports both mode and ACL must take care to
          synchronize the MODE4_*USR, MODE4_*GRP, and MODE4_*OTH bits with
          the ACEs that have respective who fields of "OWNER@", "GROUP@",
          and "EVERYONE@".<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">
   [Author Aside]: This sentence ignores named owners and group, giving
   the impressions that there is no need to change them.<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<p id="section-9.2-6">
   [Previous Treatment (Item #26a)]:
   This way, the client can see if semantically equivalent
          access permissions exist whether the client asks for the owner,
          owner_group, and mode attributes or for just the ACL.<a href="#section-9.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2-7">
   [Author Aside, Including List:] The above sentence, while hard to
   interpret for a number a reasons, is worth looking at in detail
   because it might suggest an approach different from the in the
   previous sentence from the initial paragraph for The Previous
   Treatment of Item #26a.<a href="#section-9.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-8.1">
            <p id="section-9.2-8.1.1">
     The introductory phrase "this way" adds confusion because it
     suggests that there are other valid ways of doing this, while
     not giving any hint about what these might be.<a href="#section-9.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-8.2">
            <p id="section-9.2-8.2.1">
     It is hard to understand the intention of "client can see if
     semantically equivalent access permissions" especially as the
     client is told elsewhere that he is not to interpret the
     ACL himself.<a href="#section-9.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-8.3">
            <p id="section-9.2-8.3.1">
     If this sentence is to have any effect at all it, it would be
     to suggest that the result be the same "whether the client
     asks for the owner, owner_group, and mode attributes or for
     just the ACL."<a href="#section-9.2-8.3.1" class="pilcrow">¶</a></p>
<p id="section-9.2-8.3.2">
            If these are to be semantically equivalent it would be necessary
     to delete ACEs for named users, which requires a different
     approach form the first sentence of the original paragraph.<a href="#section-9.2-8.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.2-9">
   {Consensus Needed (Items #26a, #28a)]:  
   A server that supports both mode and ACL need to take care to
          synchronize the MODE4_*USR, MODE4_*GRP, and MODE4_*OTH bits with
          the ACEs that have respective who fields of "OWNER@", "GROUP@",
          and "EVERYONE@".  This is relatively straightforward in the
   case of forward-slope modes, but the case of reverse-slope modes
   need to be addressed as described in Sections
   <a href="#AUTHCOMB-computemode" class="xref">9.3</a> and
   <a href="#AUTHCOMB-setmode" class="xref">9.6</a>.<a href="#section-9.2-9" class="pilcrow">¶</a></p>
<p id="section-9.2-10">
   {Consensus Needed (Item #26a)]:  How other ACEs are dealt with
   when setting mode is described in
   <a href="#AUTHCOMB-setmode" class="xref">Section 9.6</a>.  This includes ACEs with other
   who value, all AUDIT and ALARM ACEs, and all ACES that affect ACL
   inheritance.<a href="#section-9.2-10" class="pilcrow">¶</a></p>
<p id="section-9.2-11">
   [Author Aside, Including List]: The author  believes that the
   material now associated with Item #27, including the following
   paragraph and <a href="#AUTHCOMB-computealt" class="xref">Section 9.4</a> are best
   deleted.  This is because of reasons specified in that section
   and the following reasons listed below:<a href="#section-9.2-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-12.1">
            <p id="section-9.2-12.1.1">
     Having multiple methods to map from ACL to mode undercuts
     the whole purpose of <a href="#AUTHCOMB" class="xref">Section 9</a>, which
     is to co-ordinate these attributes so that clients who
     use each of the attributes can use that without interfering
     with those that reference others.  That cannot be accomplished
     if there were multiple valid ways that servers might choose,
     without providing any means by which the client might
     determine which mapping was being used.<a href="#section-9.2-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-12.2">
            <p id="section-9.2-12.2.1">
     The withdrawn POSIX draft ACLs would almost certainly have been
     considered in connection with an NFSv4.   In any case, they
     were not adopted and the current ACL model adopted.  Given that
     fact there is no sense in burdening the new feature with the
     substantial burden of supporting the one that was rejected by the
     working group<a href="#section-9.2-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-12.3">
            <p id="section-9.2-12.3.1">
     It is very unlikely that such implementations still exist,
     given that that it is over twenty years since the decision was
     made to adopt the more extensive NFSv4 ACL model
     and over ten years since RFC5661 was published.
     Even assuming this was justified as a transition measure, the time
     for any such transition mechanisms is long past.<a href="#section-9.2-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-12.4">
            <p id="section-9.2-12.4.1">
     Despite the statement in the next section that this alternate
     model is "discouraged", its continued appearance as an alternate
     way of computing mode, on the same level as the one appropriate
     to the NFSv4 acl model encourages this use compared to a situation
     in which no alternate method of computing mode was mentioned.<a href="#section-9.2-12.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.2-13">
   [Previous Treatment (Item #27a)]: 
          In this section, much depends on the method in
   specified <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a>.
   Many requirements refer to this section.
          It should be noted that the methods have behaviors specified with
          "<span class="bcp14">SHOULD</span>" and that alternate approaches are discussed
   in <a href="#AUTHCOMB-computealt" class="xref">Section 9.4</a>.  This is intentional,
   to avoid invalidating
        existing implementations that compute the mode according to the
        withdrawn POSIX ACL draft (1003.1e draft 17), rather than by
        actual permissions on owner, group, and other.<a href="#section-9.2-13" class="pilcrow">¶</a></p>
<p id="section-9.2-14">
   [Author Aside]:  Given the mixture of RFC2219
   terms, I think all of them in <a href="#AUTHCOMB" class="xref">Section 9</a> need
   review.  Further, given the effort that has
   gone into <a href="#AUTHCOMB" class="xref">Section 9</a>, to accommodate these
   implementations of a draft that was withdrawn decades ago.
   The idea of trying to make mode and acl match is undercut
   when there are different valid ways of computing the mode.  There
   shouldn't be.   To specify one way to do this is necessary to
   accomplish the goal here and to do so would not "invalidate"
   anything.  Rather, it would establish, correctly, that such
   implementations are not implementations of the NFSv4 ACL model,
   but of the withdrawn POSIX ACL draft.<a href="#section-9.2-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-computemode">
<section id="section-9.3">
        <h3 id="name-computing-a-mode-attribute-">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-computing-a-mode-attribute-" class="section-name selfRef">Computing a Mode Attribute from an ACL</a>
        </h3>
<p id="section-9.3-1">
     [Previous Treatment (Item #27b)]:
          The following method can be used to calculate the MODE4_R*,
          MODE4_W*, and MODE4_X* bits of a mode attribute, based upon
          an ACL.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">
     [Author Aside]:  "can be used" says
     essentially "do whatever you choose" and would make
     <a href="#AUTHCOMB" class="xref">Section 9</a> essentially pointless.  Would
     prefer "is to be used" or "<span class="bcp14">MUST</span>", with
     "<span class="bcp14">SHOULD</span>" available if valid reasons to do otherwise
     can be found.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">
     [Consensus Needed (Items #27b, #28b)}:
            The following method (or another one providing exactly the same
     results) <span class="bcp14">SHOULD</span> be used to calculate the MODE4_R*,
          MODE4_W*, and MODE4_X* bits of a mode attribute, based upon
          an ACL.  In this case valid reasons to bypass the recommendation
   are limited to implementor reliance on previous specifications
   which ignored the cases of the owner having less access than the
   owning group or the owning group having less access than others.
   Further, in implementing or the maintaining an implementation
   previously believed to be valid, the implementor needs to be aware
   that this will result invalid values in some uncommon cases.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3-4">
     [Author Aside, Including List]:  The algorithm specified below, now
     considered the Previous Treatment associated with Item #24a,
     has an important flaw in does not deal with the (admittedly
     uncommon) case in which the owner_group has less access than
     the owner or others have less access than the owner-group.
     In essence, this algorithm ignores the following facts:<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-5.1">
            <p id="section-9.3-5.1.1">
       That GROUP@ includes the owning user while group bits in
       the mode do not affect the owning user.<a href="#section-9.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-5.2">
            <p id="section-9.3-5.2.1">
       That EVERYONE includes the owning group while other bits in
       the mode do not affect users within the owning group.<a href="#section-9.3-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.3-6">
     [Previous Treatment (Item #28a)]:
          First, for each of the special identifiers OWNER@, GROUP@, and
          EVERYONE@, evaluate the ACL in order, considering only ALLOW
          and DENY ACEs for the identifier EVERYONE@ and for the
          identifier under consideration.  The result of the evaluation
          will be an NFSv4 ACL mask showing exactly which bits are
          permitted to that identifier.<a href="#section-9.3-6" class="pilcrow">¶</a></p>
<p id="section-9.3-7">
     [Previous Treatment (Item #28a)]:
          Then translate the calculated mask for OWNER@, GROUP@, and
          EVERYONE@ into mode bits for, respectively, the user, group,
          and other, as follows:<a href="#section-9.3-7" class="pilcrow">¶</a></p>
<p id="section-9.3-8">
     [Consensus Needed, including List(Item #28a)]:
          First, for each of the sets of mode bits (i.e., user, group
          other, evaluate the ACL in order, with a specific
   evaluation procedure depending on the specific set of
   mode bits being determined.  For each set there will be
   one or more special identifiers considered in a positive
   sense so that ALLOW and DENY ACE's are considered in
   arriving at the mode bit.  In addition, for some sets
   of bits, there will be one or more special identifiers
   to be considered only in a negative sense, so that only
   DENY ACE's are considered in arriving at the mode
   it.   The users to be considered are as follows:<a href="#section-9.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-9.1">
            <p id="section-9.3-9.1.1">
       For the owner bits, "OWNER@" and "EVERYONE@" are to be
       considered, both in a positive sense.<a href="#section-9.3-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-9.2">
            <p id="section-9.3-9.2.1">
       For the group bits, "GROUP@" and "EVERYONE@" are to be
       considered, both in a positive sense, while "OWNER@" is to
       be considered in a negative sense.<a href="#section-9.3-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-9.3">
            <p id="section-9.3-9.3.1">
       For the other bit, "EVERYONE@" is to be
       considered in a positive sense, while "OWNER@" and "GROUP@"
       are to
       be considered in a negative sense.<a href="#section-9.3-9.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.3-10">
     [Consensus Needed (Item #28a)]:
            Then translate the calculated mask for for each set of bit into
     the corresponding mode bits for, user, group,
          and other, as follows:<a href="#section-9.3-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.3-11">
            <li id="section-9.3-11.1">
              Set the read bit (MODE4_RUSR, MODE4_RGRP, or
              MODE4_ROTH) if and only if ACE4_READ_DATA is set in
              the corresponding mask.<a href="#section-9.3-11.1" class="pilcrow">¶</a>
</li>
          <li id="section-9.3-11.2">
              Set the write bit (MODE4_WUSR, MODE4_WGRP, or
              MODE4_WOTH) if and only if ACE4_WRITE_DATA and
              ACE4_APPEND_DATA are both set in the corresponding
              mask.<a href="#section-9.3-11.2" class="pilcrow">¶</a>
</li>
          <li id="section-9.3-11.3">
              Set the execute bit (MODE4_XUSR, MODE4_XGRP, or
              MODE4_XOTH), if and only if ACE4_EXECUTE is set in the
              corresponding mask.<a href="#section-9.3-11.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="AUTHCOMB-computealt">
<section id="section-9.4">
        <h3 id="name-alternatives-in-computing-m">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-alternatives-in-computing-m" class="section-name selfRef">Alternatives in Computing Mode Bits</a>
        </h3>
<p id="section-9.4-1">
       [Author Aside]: For reasons explained below, the author
       believes this section needs to deleted, as part of
       Consensus Item #27c.  In order to enable this deletion
       or its replacement by an alternate formulation if the
       working group so decides, all unannotated paragraphs
       within this section are to be considered the Previous
       Treatment corresponding to Consensus Item #27c.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">
            Some server implementations also add bits permitted to
            named users and groups to the group bits (MODE4_RGRP,
            MODE4_WGRP, and MODE4_XGRP).<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">
            Implementations are discouraged from doing this, because
            it has been found to cause confusion for users who see
            members of a file's group denied access that the mode
            bits appear to allow.  (The presence of DENY ACEs may also
            lead to such behavior, but DENY ACEs are expected to be
            more rarely used.)<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<p id="section-9.4-4">
       [Author Aside]: The text does not seem
       to really discourage this practice and makes no reference
       to the need to standardize behavior so the clients know what
       to expect or any other reason for providing standardization
       of server behavior.<a href="#section-9.4-4" class="pilcrow">¶</a></p>
<p id="section-9.4-5">
            The same user confusion seen when fetching the mode also
            results if setting the mode does not effectively control
            permissions for the owner, group, and other users; this
            motivates some of the requirements that follow.<a href="#section-9.4-5" class="pilcrow">¶</a></p>
<p id="section-9.4-6">
       [Author Aside]:  The part before the semicolon appears to
       be relevant to Consensus Item #23 but does not point us
       to a clear conclusion.   The statement certainly suggests
       that the 512-ACL approach is more desirable but the absence
       of a more direct statement to that effect suggest that this
       is a server implementer choice.<a href="#section-9.4-6" class="pilcrow">¶</a></p>
<p id="section-9.4-7">
       [Author Aside]: The part after the semicolon is hard to interpret
       in that it is not clear what "this" refers to or which
       which requirements are referred to by "some of the requirements
       that follow".  The author would appreciate hearing from
       anyone who has insight about what might have been intended here.<a href="#section-9.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-setmultacl">
<section id="section-9.5">
        <h3 id="name-setting-multiple-acl-attrib">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-setting-multiple-acl-attrib" class="section-name selfRef">Setting Multiple ACL Attributes</a>
        </h3>
<p id="section-9.5-1">
          In the case where a server supports the sacl or
          dacl attribute, in addition to the acl attribute,
          the server <span class="bcp14">MUST</span> fail a request to set the acl
          attribute simultaneously with a dacl or sacl
          attribute.  The error to be given is NFS4ERR_ATTRNOTSUPP.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-setmode">
<section id="section-9.6">
        <h3 id="name-setting-mode-and-not-acl-ov">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-setting-mode-and-not-acl-ov" class="section-name selfRef">Setting Mode and not ACL (overall)</a>
        </h3>
<div id="AUTHCOMB-setmode-v">
<section id="section-9.6.1">
          <h4 id="name-setting-mode-and-not-acl-ve">
<a href="#section-9.6.1" class="section-number selfRef">9.6.1. </a><a href="#name-setting-mode-and-not-acl-ve" class="section-name selfRef">Setting Mode and not ACL (vestigial)</a>
          </h4>
<p id="section-9.6.1-1">
       [Author Aside]: All unannotated paragraphs as considered
       the Previous treatment of Consensus Item #30a.<a href="#section-9.6.1-1" class="pilcrow">¶</a></p>
<p id="section-9.6.1-2">
       [Previous Treatment (Item #?a)]:
            When any of the nine low-order mode bits
            are subject to change, either because the mode
            attribute was set or because the mode_set_masked
            attribute was set and the mask included one or more
            bits from the nine low-order mode bits,
            and no ACL attribute is explicitly
            set, the acl and dacl attributes must be modified
            in accordance with the updated value of those bits.
            This must happen
            even if the value of the low-order bits
            is the same after the mode is set as before.<a href="#section-9.6.1-2" class="pilcrow">¶</a></p>
<p id="section-9.6.1-3">
            Note that any AUDIT or ALARM ACEs (hence any ACEs in the
            sacl attribute) are unaffected by changes to the mode.<a href="#section-9.6.1-3" class="pilcrow">¶</a></p>
<p id="section-9.6.1-4">
            In cases in which the permissions bits are subject to
            change, the acl and dacl attributes
            <span class="bcp14">MUST</span> be modified such that the mode computed via the
            method in
            <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a>
            yields the low-order nine bits (MODE4_R*, MODE4_W*,
            MODE4_X*) of the mode attribute as modified by the
            attribute change.  The ACL attributes
            <span class="bcp14">SHOULD</span> also be modified such that:<a href="#section-9.6.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.6.1-5">
              <li id="section-9.6.1-5.1">
                If MODE4_RGRP is not set, entities explicitly
                listed in the ACL other than OWNER@ and EVERYONE@
                <span class="bcp14">SHOULD NOT</span> be granted ACE4_READ_DATA.<a href="#section-9.6.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-9.6.1-5.2">
                If MODE4_WGRP is not set, entities explicitly
                listed in the ACL other than OWNER@ and
                EVERYONE@ <span class="bcp14">SHOULD NOT</span> be granted
                ACE4_WRITE_DATA or ACE4_APPEND_DATA.<a href="#section-9.6.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-9.6.1-5.3">
                If MODE4_XGRP is not set, entities explicitly
                listed in the ACL other than OWNER@ and EVERYONE@
                <span class="bcp14">SHOULD NOT</span> be granted ACE4_EXECUTE.<a href="#section-9.6.1-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-9.6.1-6">
            Access mask bits other than those listed above, appearing
            in ALLOW ACEs, <span class="bcp14">MAY</span> also be disabled.<a href="#section-9.6.1-6" class="pilcrow">¶</a></p>
<p id="section-9.6.1-7">
            Note that ACEs with the flag ACE4_INHERIT_ONLY_ACE set do
            not affect the permissions of the ACL itself, nor do ACEs
            of the type AUDIT and ALARM. As such, it is desirable to
            leave these ACEs unmodified when modifying the ACL
            attributes.<a href="#section-9.6.1-7" class="pilcrow">¶</a></p>
<p id="section-9.6.1-8">
            Also note that the requirement may be met by
            discarding the acl and dacl, in favor of an ACL
            that represents the mode and only the mode. This is
            permitted, but it is preferable for a server to
            preserve as much of the ACL as possible without
            violating the above requirements. Discarding the
            ACL makes it effectively impossible for a file
            created with a mode attribute to inherit an ACL
            (see <a href="#AUTHCOMB-aclcreate" class="xref">Section 9.10</a>).<a href="#section-9.6.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-setmode-d">
<section id="section-9.6.2">
          <h4 id="name-setting-mode-and-not-acl-di">
<a href="#section-9.6.2" class="section-number selfRef">9.6.2. </a><a href="#name-setting-mode-and-not-acl-di" class="section-name selfRef">Setting Mode and not ACL (Discussion)</a>
          </h4>
<p id="section-9.6.2-1">
       [Author Aside]: All unannotated paragraphs as considered
       Author Asides relating to Consensus Item #30b.<a href="#section-9.6.2-1" class="pilcrow">¶</a></p>
<p id="section-9.6.2-2">
       Existing documents are unclear about the changes to be
       made to an existing ACL when the nine low-order bits of the
       mode attribute are subject to modification using
       SETATTR.<a href="#section-9.6.2-2" class="pilcrow">¶</a></p>
<p id="section-9.6.2-3">
              A new treatment needs to apply to all minor versions.  It will
       be necessary to specify that, for all minor versions, setting
       of the mode attribute, subjects the low-order nine bits to
       modification.<a href="#section-9.6.2-3" class="pilcrow">¶</a></p>
<p id="section-9.6.2-4">
              One important source of this lack of clarity is the
       following paragraph from <a href="#AUTHCOMB-setmode-v" class="xref">Section 9.6.1</a>,
       which we refer to later as the
       trivial-implementation-remark".<a href="#section-9.6.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.6.2-5.1">
 Also note that the requirement may be met by
 discarding the acl and dacl, in favor of an ACL
 that represents the mode and only the mode. This is
 permitted, but it is preferable for a server to
 preserve as much of the ACL as possible without
 violating the above requirements. Discarding the
 ACL makes it effectively impossible for a file
 created with a mode attribute to inherit an ACL
 (see <a href="#AUTHCOMB-aclcreate" class="xref">Section 9.10</a>).<a href="#section-9.6.2-5.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-9.6.2-6">
       The only "requirement" which might be met
       by the procedure mentioned above is the text quoted
       below.<a href="#section-9.6.2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.6.2-7.1">
 In cases in which the permissions bits are subject to
 change, the acl and dacl attributes
 <span class="bcp14">MUST</span> be modified such that the mode computed
 via the method in <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a>
 yields the low-order nine bits (MODE4_R*, MODE4_W*,
 MODE4_X*) of the mode attribute as modified by the
 attribute change.<a href="#section-9.6.2-7.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-9.6.2-8">
       While it is true that this requirement could be met by
       the specified treatment, this fact does not, in itself,
       affect the numerous recommendations that appear between
       the above requirement and the trivial-implementation-remark.<a href="#section-9.6.2-8" class="pilcrow">¶</a></p>
<p id="section-9.6.2-9">
       It may well be that there are are implementations that
       have treated the trivial-implementation-remark as essentially
       allowing them to essentially ignore all of those
       recommendations, resulting in a situation in which were treated 
       as if it were a trivial-implementation-ok indication.
       How that issue will be dealt with
       in a replacement for <a href="#AUTHCOMB-setmode-v" class="xref">Section 9.6.1</a>
       will be affected by the working group's examination
       of compatibility issues.<a href="#section-9.6.2-9" class="pilcrow">¶</a></p>
<p id="section-9.6.2-10"> 
              The following specific issues need to be addressed:<a href="#section-9.6.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.2-11.1">
              <p id="section-9.6.2-11.1.1">
 Handling of inheritance.<a href="#section-9.6.2-11.1.1" class="pilcrow">¶</a></p>
<p id="section-9.6.2-11.1.2">
         Beyond the possible issues that arise from the
         trivial-implementation-ok interpretation, the
 treatment in <a href="#AUTHCOMB-setmode-v" class="xref">Section 9.6.1</a>, by
 pointing specifically to existing INHERIT_ONLY ACEs obscures
 the corresponding need to convert ACE's that specify both
 inheritance and access permissions to be converted to
 INHERIT_ONLY ACEs.<a href="#section-9.6.2-11.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.2-11.2">
              <p id="section-9.6.2-11.2.1">
 Reverse-slope modes<a href="#section-9.6.2-11.2.1" class="pilcrow">¶</a></p>
<p id="section-9.6.2-11.2.2"></p>
</li>
            <li class="normal" id="section-9.6.2-11.3">
              <p id="section-9.6.2-11.3.1">
 Named users and groups.<a href="#section-9.6.2-11.3.1" class="pilcrow">¶</a></p>
<p id="section-9.6.2-11.3.2"></p>
<p id="section-9.6.2-11.3.3"></p>
</li>
            <li class="normal" id="section-9.6.2-11.4">
              <p id="section-9.6.2-11.4.1">
 The exact bounds of what within the ACL is covered by
 the low-order bits of the mode.<a href="#section-9.6.2-11.4.1" class="pilcrow">¶</a></p>
<p id="section-9.6.2-11.4.2"></p>
<p id="section-9.6.2-11.4.3"></p>
</li>
          </ul>
<p id="section-9.6.2-12">
       It appears that for many of the issues, there are many possible
       readings of the existing specs, leading to the possibility of
       multiple inconsistent server behaviors.  Furthermore, there
       are cases in which none of the possible behaviors described in
       existing specifications meets the needs.<a href="#section-9.6.2-12" class="pilcrow">¶</a></p>
<p id="section-9.6.2-13">
       As a result of these issues, the existing specifications
       do not provide a reliable basis for client-side implementations
       of the ACL feature which a Proposed Standard is normally
       expected to provide.<a href="#section-9.6.2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-setmode-p">
<section id="section-9.6.3">
          <h4 id="name-setting-mode-and-not-acl-pr">
<a href="#section-9.6.3" class="section-number selfRef">9.6.3. </a><a href="#name-setting-mode-and-not-acl-pr" class="section-name selfRef">Setting Mode and not ACL (Proposed)</a>
          </h4>
<p id="section-9.6.3-1">
       [Author Aside]: This proposed section is part of Consensus
       Item #30c and all unannotated paragraphs within it are to be
       considered part of that Item. Since the proposed text
       includes support for reverse-slope modes, treats all minor
       versions together and assumes decisions about handling of
       ACEs for named users and groups, the relevance of consensus items
       #26, #28, and #29 should be noted.<a href="#section-9.6.3-1" class="pilcrow">¶</a></p>
<p id="section-9.6.3-2">
       [Author Aside]: As with all such Consensus Items, it is
       expected that the eventual text in a published RFC might be
       substantially different based on working group discussion of
       client and server needs and possible compatibility issues.  In
       this particular case, that divergence can be expected to be
       larger, because the author was forced to guess about
       compatibility issues and because earlier material, on which
       it is based left such a wide range of matters to the
       discretion of server implementers. It is the author's hope
       that, as the working group discusses matters, sufficient
       attention is placed on the need for client-side implementations
       to have reliable information about expected
       server-side actions.<a href="#section-9.6.3-2" class="pilcrow">¶</a></p>
<p id="section-9.6.3-3">
       This section describes how ACLs are to be updated in response
       to actual or potential changes in
       the mode attribute, when the attributes needed by both of the
       file access
       authorization models are supported. It supersedes the
       discussions of the subject in RFCs 7530 and 8881, each of which
       appeared in Section 6.4.1.1 of  the corresponding document.<a href="#section-9.6.3-3" class="pilcrow">¶</a></p>
<p id="section-9.6.3-4">
       It is necessary to approach the matter differently than in
       the past because:<a href="#section-9.6.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-5.1">
              <p id="section-9.6.3-5.1.1">
 Organizational changes are necessary to address all minor
 versions together.<a href="#section-9.6.3-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-5.2">
              <p id="section-9.6.3-5.2.1">
 Those previous discussions are often internally inconsistent
 leaving it unclear
 what specification-mandated actions were being specified..<a href="#section-9.6.3-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-5.3">
              <p id="section-9.6.3-5.3.1">
 In many cases, servers were granted an extraordinary degree
 of freedom to choose the action to take, either explicitly
 or via an apparently unmotivated use of SHOULD, leaving it
 unclear what might be considered "valid" reasons
 to ignore the recommendation.<a href="#section-9.6.3-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-5.4">
              <p id="section-9.6.3-5.4.1">
 There appears to have been no concern for the problems that
 clients and applications might encounter dealing ACLs
 in such an uncertain environment.<a href="#section-9.6.3-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-5.5">
              <p id="section-9.6.3-5.5.1">
 Cases involving reverse-slope modes were not adequately
 addressed.<a href="#section-9.6.3-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-5.6">
              <p id="section-9.6.3-5.6.1">
 The security-related effects of SVTX were not addressed.<a href="#section-9.6.3-5.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-6">
       While that sort of approach might have been workable at one
       time, it made it difficult to devise client-side ACL
       implementations, even if there had been any
       interest in doing so.  In order to enable this situation to
       eventually be rectified, we will define the preferred
       implementation here, but in order to provide temporary
       compatibility with existing implementations based on
       reasonable interpretations of RFCs 7530 and 8881.  To
       enable such compatibility the term "<span class="bcp14">SHOULD</span>"
       will be used, with the understanding that valid reasons to
       bypass the recommendation, are limited to implementers'
       previous reliance on these earlier specifications and the
       difficulty of changing them now.<a href="#section-9.6.3-6" class="pilcrow">¶</a></p>
<p id="section-9.6.3-7">
       When the recommendation is bypassed in this way, it is
       necessary to understand, that, until the divergence is
       rectified, or the client is given a way to determine the
       detail of the server's non-standard behavior, client-side
       implementations may find it difficult to implement a
       client-side implementation that correctly interoperates
       with the existing server.<a href="#section-9.6.3-7" class="pilcrow">¶</a></p>
<p id="section-9.6.3-8">
       When mode bits involved in determining file access
       authorization are subject to modification, the
       server <span class="bcp14">MUST</span>,
       when ACL-related attributes have been set, modify the
       associated ACEs so as not to conflict with the new
       value of the mode attribute.<a href="#section-9.6.3-8" class="pilcrow">¶</a></p>
<p id="section-9.6.3-9">
       The occasions to which this requirement applies, vary
       with the attribute being set and the
       type of object being dealt with:<a href="#section-9.6.3-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-10.1">
              <p id="section-9.6.3-10.1.1">
 For all minor versions, any change to the mode attribute,
 triggers this requirement<a href="#section-9.6.3-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-10.2">
              <p id="section-9.6.3-10.2.1">
 When the set_mode_masked attribute is being set on an
 object which is not a directory, whether this
 requirement is triggered depends on whether any of
 the nine low-order bits of the mode is included in the
 mask.<a href="#section-9.6.3-10.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-10.3">
              <p id="section-9.6.3-10.3.1">
 When the set_mode_masked attribute is being set on a
 directory, whether this
 requirement is triggered depends on whether any of
 the nine low-order bits of the mode or the SVTX bit
 is included in the mask of bit whose values are to be set.<a href="#section-9.6.3-10.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-11">
       When the requirement is triggered, ACEs need to be
       updated to be consistent with the new mode attribute.
       In the case of AUDIT and ALARM ACEs, which are outside
       of file access authorization, no change is to be made.<a href="#section-9.6.3-11" class="pilcrow">¶</a></p>
<p id="section-9.6.3-12">
       For ALLOW and DENY ACEs, changes are necessary to avoid
       conflicts with the mode in a number of areas:<a href="#section-9.6.3-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-13.1">
              <p id="section-9.6.3-13.1.1">
 The handling of ACEs that have consequences relating to
 ACL inheritance.<a href="#section-9.6.3-13.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-13.2">
              <p id="section-9.6.3-13.2.1">
 The handling of ACEs with a who-value of OWNER@, GROUP@,
 or EVERYONE@ need to be adapted to the new mode.<a href="#section-9.6.3-13.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-13.3">
              <p id="section-9.6.3-13.3.1">
 ACEs whose who-value is a named user or group, are to be
 retained or not based on the mode being set as described below.<a href="#section-9.6.3-13.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-13.4">
              <p id="section-9.6.3-13.4.1">
 ACEs whose who-value is one of the other special values
 defined in <a href="#ACL-who" class="xref">Section 5.9</a> are to be left
 unmodified.<a href="#section-9.6.3-13.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-14">
       In order to deal with inheritance issues, the following
       <span class="bcp14">SHOULD</span> be done:<a href="#section-9.6.3-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-15.1">
              <p id="section-9.6.3-15.1.1">
 ACEs that specify inheritance-only need to be retained,
 regardless of the value of who specified, since inheritance
 issues are outside of the semantic range of the mode attribute.<a href="#section-9.6.3-15.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-15.2">
              <p id="section-9.6.3-15.2.1">
 ACEs that specify inheritance, in addition to allowing or
 denying authorization for the current object need to be
 converted into inheritance-only ACEs.  This needs to occur
 irrespective of the value of who appearing in the ACE.<a href="#section-9.6.3-15.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-16">
       For NFSv4 servers that support the dacl attribute, at least
       the first of the above <span class="bcp14">MUST</span> be done.<a href="#section-9.6.3-16" class="pilcrow">¶</a></p>
<p id="section-9.6.3-17">
       Other ACEs are to be treated are classified based on the
       ACE's who-value:<a href="#section-9.6.3-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-18.1">
              <p id="section-9.6.3-18.1.1">
 ACEs whose who-value is OWNER@, GROUP@, or EVERYONE@ are
 referred to as mode-directed ACEs and are subject to
 extensive modification.<a href="#section-9.6.3-18.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-18.2">
              <p id="section-9.6.3-18.2.1">
 ACEs whose who-value is a named user or group are either
 left alone or subject to extensive modification, as
 described below.<a href="#section-9.6.3-18.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-18.3">
              <p id="section-9.6.3-18.3.1">
 ACEs whose who-value is one of the other special values
 defined in <a href="#ACL-who" class="xref">Section 5.9</a> are left as they are.<a href="#section-9.6.3-18.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-19">
       Mode-directed ACEs need to be modified so that they reflect
       the mode being set.<a href="#section-9.6.3-19" class="pilcrow">¶</a></p>
<p id="section-9.6.3-20">
       In effecting this modification, the server will need to
       distinguish mask bits deriving from mode attributes from those
       that have no such connection.  The former can be categorized
       as follows:<a href="#section-9.6.3-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-21.1">
              <p id="section-9.6.3-21.1.1">
 For non-directory objects, the mask bits ACE4_READ_DATA (from
 the read bit in the mode), ACE4_EXECUTE (from the execute
 bit in the
 mode), and ACE4_WRITE_DATA together with ACE4_APPEND_DATA
 (from the write
 bit in the mode) are all derived from
 the set of three mode bits appropriate to the current who-value.<a href="#section-9.6.3-21.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-21.2">
              <p id="section-9.6.3-21.2.1">
 For directories, analogous mask bits are included:
 ACE4_LIST_DIRECTORY (from the read
 in the mode), ACE4_EXECUTE (from the execute bit in the
 mode), and ACE4_ADD_FILE together with ACE4_ADD_SUBDIRECTORY and
 ACE4_DELETE_CHILD&gt;
 (from the write
 bit in the mode) are all included based on
 the set of three mode bits appropriate to the current who-value.<a href="#section-9.6.3-21.2.1" class="pilcrow">¶</a></p>
<p id="section-9.6.3-21.2.2">
         When the SVTX bit is set, ACE4_DELETE_CHILD is set,
          regardless of the values of the low-order nine bit of the mode.<a href="#section-9.6.3-21.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-21.3">
              <p id="section-9.6.3-21.3.1">
 When named attributes are supported for the object whose
 mode is subject to change, ACE4_READ_NAMED_ATTRIBUTES is
 set based on the read bit and ACE4_WRITE_NAMED_ATTRIBUTES
 is set based on the write bit based on
 the set of three mode bits appropriate to the current who-value.<a href="#section-9.6.3-21.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-21.4">
              <p id="section-9.6.3-21.4.1">
 In the case of OWNER@, ACE4_WRITE_ACL, ACE4_WRITE_ATTRIBUTES
 ACE4_WRITE_ACL, ACE4_WRITE_OWNER are all set.<a href="#section-9.6.3-21.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-22">
       The union of these groups of mode bit are referred to as
       the mode-relevant mask bits.<a href="#section-9.6.3-22" class="pilcrow">¶</a></p>
<p id="section-9.6.3-23">
       [Author Aside]:  Except for the case of ACE4_SYNCHRONIZE, the
       handling of mask bits which are not mode-relevant is yet to
       be clarified.  For tracking purposes,
       the handling of mask bits ACE4_READ_ATTRIBUTES,
       ACE4_WRITE_RETENTION, ACE4_WRITE_RETENTION_HOLD,
       ACE4_READ_ACL will be dealt with as Consensus Item #31.<a href="#section-9.6.3-23" class="pilcrow">¶</a></p>
<p id="section-9.6.3-24">
       If the mode is of forward-slope, then each set of three bits
       is translated into a corresponding set of mode bits.  Then,
       for  each  ALLOW ACE with one of these who values, all mask
       bits in this class are deleted and the computed mode bits
       for that who-value substituted. For DENY ACEs,
       all mask bits in this class are reset, and, if none remain,
       the ACE <span class="bcp14">MAY</span> be deleted.<a href="#section-9.6.3-24" class="pilcrow">¶</a></p>
<p id="section-9.6.3-25">
       In the case of reverse-slope modes, the following
       <span class="bcp14">SHOULD</span> be done:<a href="#section-9.6.3-25" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-26.1">
              <p id="section-9.6.3-26.1.1">
 For mode-directed ACEs all mode-relevant mask bits are reset,
 and, if none remain, the ACE <span class="bcp14">MAY</span> be deleted.<a href="#section-9.6.3-26.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-26.2">
              <p id="section-9.6.3-26.2.1">
 Then, proceeding from owner to others, ALLOW ACEs are generated
 based on the computed mode-relevant mask bits.<a href="#section-9.6.3-26.2.1" class="pilcrow">¶</a></p>
<p id="section-9.6.3-26.2.2">
         At each stage, if the mode-relevant mask bits for the current
         stage includes mask bits not set for the previous stage, then
 a DENY ACE needs to be added before the new ALLOW ACE.  That
 ACE will have a who-value based on the previous stage and
 a mask consisting of the bit included in the current stage
 that were not included in the previous stage.<a href="#section-9.6.3-26.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-27">
       In cases in which the above recommendation is not followed,
       the server <span class="bcp14">MUST</span> follow a procedure which
       arrives at an  ACL which behaves identically for all cases
       involving forward-slope mode values.<a href="#section-9.6.3-27" class="pilcrow">¶</a></p>
<p id="section-9.6.3-28">
       When dealing with ACEs whose who-value is a named user or
       group, they <span class="bcp14">SHOULD</span> be processed as follows:<a href="#section-9.6.3-28" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6.3-29.1">
              <p id="section-9.6.3-29.1.1">
 DENY ACEs are left as they are.<a href="#section-9.6.3-29.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.6.3-29.2">
              <p id="section-9.6.3-29.2.1">
 ALLOW ACES are subject to filtering to effect mode
 changes that deny access to any principal other than the
 owner.<a href="#section-9.6.3-29.2.1" class="pilcrow">¶</a></p>
<p id="section-9.6.3-29.2.2">
         To determine the set of mode bits to which this filtering
         applies, the mode bits for group are combined with those for
 others, to get a set of three mode bits to determine which
 of the mode privileges (read, write, execute) are denied to
 all principals  other than the owner, i.e. the set of bits not
 present in either the bits for group or the bits for others.<a href="#section-9.6.3-29.2.2" class="pilcrow">¶</a></p>
<p id="section-9.6.3-29.2.3">
 Those three bits are converted to the corresponding set of
 mask bits, according to the rules above.<a href="#section-9.6.3-29.2.3" class="pilcrow">¶</a></p>
<p id="section-9.6.3-29.2.4">
         All such mask bits are reset in the ACE, and, if none remain,
         the ACE <span class="bcp14">MAY</span> be deleted.<a href="#section-9.6.3-29.2.4" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.6.3-30">
       In cases in which the above recommendation is not followed,
       the server <span class="bcp14">MUST</span> follow a procedure which
       arrives at an  ACL which behaves identically for all cases
       involving forward-slope mode values.   This would be
       accomplished if the mask bits were reset based on the group bits
       alone, as had been recommended in earlier  specifications.<a href="#section-9.6.3-30" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHCOMB-settingacl">
<section id="section-9.7">
        <h3 id="name-setting-acl-and-not-mode">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-setting-acl-and-not-mode" class="section-name selfRef">Setting ACL and Not Mode</a>
        </h3>
<p id="section-9.7-1">
       [Author Aside]: The handling of <span class="bcp14">SHOULD</span> in this
       section is considered as part of Consensus Item #25d.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2">
            When setting the acl or dacl and not setting the
            mode or mode_set_masked attributes, the permission
            bits of the mode need to be derived from the ACL.
            In this case, the ACL attribute <span class="bcp14">SHOULD</span> be set as
            given. The nine low-order bits of the mode
            attribute (MODE4_R*, MODE4_W*, MODE4_X*) <span class="bcp14">MUST</span> be
            modified to match the result of the method in
     <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a>. The three high-order bits
            of the mode (MODE4_SUID, MODE4_SGID, MODE4_SVTX)
            <span class="bcp14">SHOULD</span> remain unchanged.<a href="#section-9.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-setboth">
<section id="section-9.8">
        <h3 id="name-setting-both-acl-and-mode">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-setting-both-acl-and-mode" class="section-name selfRef">Setting Both ACL and Mode</a>
        </h3>
<p id="section-9.8-1">
            When setting both the mode (includes use of either the
            mode attribute or the mode_set_masked attribute) 
            and the acl or dacl attributes in the
            same operation, the attributes <span class="bcp14">MUST</span> be applied in
     the following order
            order: mode (or mode_set_masked), then ACL.  The 
            mode-related attribute is set as given,
            then the ACL attribute is set as given, possibly changing
            the final mode, as described above in
            <a href="#AUTHCOMB-settingacl" class="xref">Section 9.7</a>.<a href="#section-9.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-fetchattr">
<section id="section-9.9">
        <h3 id="name-retrieving-the-mode-and-or-">
<a href="#section-9.9" class="section-number selfRef">9.9. </a><a href="#name-retrieving-the-mode-and-or-" class="section-name selfRef">Retrieving the Mode and/or ACL Attributes</a>
        </h3>
<p id="section-9.9-1">
     [Author Aside]: The handling of <span class="bcp14">SHOULD</span> in this
     section is considered as part of Consensus Item #25e.<a href="#section-9.9-1" class="pilcrow">¶</a></p>
<p id="section-9.9-2">
          Some server implementations may provide for the existence of
          "objects without ACLs", meaning that all permissions
          are granted and denied according to the mode attribute and
          that no ACL attribute is stored for that object. If an ACL
          attribute is requested of such a server, the server <span class="bcp14">SHOULD</span>
          return an ACL that does not conflict with the mode; that is to
          say, the ACL returned <span class="bcp14">SHOULD</span> represent the nine low-order bits
          of the mode attribute (MODE4_R*, MODE4_W*, MODE4_X*) as
          described in <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a>.<a href="#section-9.9-2" class="pilcrow">¶</a></p>
<p id="section-9.9-3">
          For other server implementations, the ACL attribute is always
          present for every object. Such servers <span class="bcp14">SHOULD</span> store at least
          the three high-order bits of the mode attribute (MODE4_SUID,
          MODE4_SGID, MODE4_SVTX). The server <span class="bcp14">SHOULD</span> return a mode
          attribute if one is requested, and the low-order nine bits of
          the mode (MODE4_R*, MODE4_W*, MODE4_X*) <span class="bcp14">MUST</span> match the result
          of applying the method in
          <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a> to the ACL attribute.<a href="#section-9.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-aclcreate">
<section id="section-9.10">
        <h3 id="name-creating-new-objects">
<a href="#section-9.10" class="section-number selfRef">9.10. </a><a href="#name-creating-new-objects" class="section-name selfRef">Creating New Objects</a>
        </h3>
<p id="section-9.10-1">
     [Author Aside]: The handling of <span class="bcp14">SHOULD</span> in this
     section is considered as part of Consensus Item #25f.<a href="#section-9.10-1" class="pilcrow">¶</a></p>
<p id="section-9.10-2">
          If a server supports any ACL attributes, it may use the ACL
          attributes on the parent directory to compute an initial ACL
          attribute for a newly created object. This will be referred to
          as the inherited ACL within this section. The act of adding
          one or more ACEs to the inherited ACL that are based upon ACEs
          in the parent directory's ACL will be referred to as
          inheriting an ACE within this section.<a href="#section-9.10-2" class="pilcrow">¶</a></p>
<p id="section-9.10-3">
          Implementors should base the behavior of CREATE
          and OPEN depending on the presence or absence of the
          mode and ACL attributes by following the directions below:<a href="#section-9.10-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.10-4">
            <li id="section-9.10-4.1">
            <p id="section-9.10-4.1.1">If just the mode is given in the call:<a href="#section-9.10-4.1.1" class="pilcrow">¶</a></p>
<p id="section-9.10-4.1.2"> In this case, inheritance
              <span class="bcp14">SHOULD</span> take place, but the mode
       <span class="bcp14">MUST</span> be applied to the
              inherited ACL as described in <a href="#AUTHCOMB-setmode" class="xref">Section 9.6</a>,
       thereby modifying the ACL.<a href="#section-9.10-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.10-4.2">
            <p id="section-9.10-4.2.1">If just the ACL is given in the call:<a href="#section-9.10-4.2.1" class="pilcrow">¶</a></p>
<p id="section-9.10-4.2.2">
              In this case, inheritance <span class="bcp14">SHOULD NOT</span> take place, and
              the ACL as defined in the CREATE or OPEN will be set
              without modification, and the mode modified as in
              <a href="#AUTHCOMB-settingacl" class="xref">Section 9.7</a>.<a href="#section-9.10-4.2.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.10-4.3">
            <p id="section-9.10-4.3.1">If both mode and ACL are given in the call:<a href="#section-9.10-4.3.1" class="pilcrow">¶</a></p>
<p id="section-9.10-4.3.2"> In this case, inheritance
              <span class="bcp14">SHOULD NOT</span> take place, and both attributes will be set
              as described in <a href="#AUTHCOMB-setboth" class="xref">Section 9.8</a>.<a href="#section-9.10-4.3.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.10-4.4">
            <p id="section-9.10-4.4.1">
              If neither mode nor ACL is given in the call:<a href="#section-9.10-4.4.1" class="pilcrow">¶</a></p>
<p id="section-9.10-4.4.2">
              In the case where an object is being created without
              any initial attributes at all, e.g., an OPEN operation
              with an opentype4 of OPEN4_CREATE and a createmode4 of
              EXCLUSIVE4, inheritance <span class="bcp14">SHOULD NOT</span> take place (note that
              EXCLUSIVE4_1 is a better choice of createmode4, since it
              does permit initial attributes).
              Instead, the server <span class="bcp14">SHOULD</span> set permissions to deny all
              access to the newly created object. It is expected
              that the appropriate client will set the desired
              attributes in a subsequent SETATTR operation, and the
              server <span class="bcp14">SHOULD</span> allow that operation to succeed,
              regardless of what permissions the object is created
              with. For example, an empty ACL denies all
              permissions, but the server should allow the owner's
              SETATTR to succeed even though WRITE_ACL is implicitly
              denied.<a href="#section-9.10-4.4.2" class="pilcrow">¶</a></p>
<p id="section-9.10-4.4.3">
              In other cases, inheritance <span class="bcp14">SHOULD</span> take place, and no
              modifications to the ACL will happen. The mode
              attribute, if supported, <span class="bcp14">MUST</span> be as computed in 
       <a href="#AUTHCOMB-computemode" class="xref">Section 9.3</a>, with the MODE4_SUID,
              MODE4_SGID, and MODE4_SVTX bits clear.
              If no inheritable ACEs exist on the parent directory,
              the rules for creating acl, dacl, or sacl attributes
              are implementation defined.
              If either the dacl or sacl attribute is supported,
              then the ACL4_DEFAULTED flag <span class="bcp14">SHOULD</span> be set on the
              newly created attributes.<a href="#section-9.10-4.4.3" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="AUTHCOMB-inheritreq">
<section id="section-9.11">
        <h3 id="name-use-of-inherited-acl-when-c">
<a href="#section-9.11" class="section-number selfRef">9.11. </a><a href="#name-use-of-inherited-acl-when-c" class="section-name selfRef">Use of Inherited ACL When Creating Objects</a>
        </h3>
<p id="section-9.11-1">
     [Author Aside]: The handling of <span class="bcp14">SHOULD</span> in this
     section is considered as part of Consensus Item #25g.<a href="#section-9.11-1" class="pilcrow">¶</a></p>
<p id="section-9.11-2">
            If the object being created is not a directory, the
            inherited ACL <span class="bcp14">SHOULD NOT</span> inherit ACEs from the parent
            directory ACL unless the ACE4_FILE_INHERIT_ACE flag is set.<a href="#section-9.11-2" class="pilcrow">¶</a></p>
<p id="section-9.11-3">
            If the object being created is a directory, the inherited
            ACL should inherit all inheritable ACEs from the parent
            directory, that is, those that have the ACE4_FILE_INHERIT_ACE or
            ACE4_DIRECTORY_INHERIT_ACE flag set.  
If the inheritable
            ACE has ACE4_FILE_INHERIT_ACE set but
            ACE4_DIRECTORY_INHERIT_ACE is clear, the inherited ACE on
            the newly created directory <span class="bcp14">MUST</span> have the
            ACE4_INHERIT_ONLY_ACE flag set to prevent the directory
            from being affected by ACEs meant for non-directories.<a href="#section-9.11-3" class="pilcrow">¶</a></p>
<p id="section-9.11-4">
            When a new directory is created, the server <span class="bcp14">MAY</span> split
            any inherited ACE that is both inheritable and effective
            (in other words, that has neither ACE4_INHERIT_ONLY_ACE
            nor ACE4_NO_PROPAGATE_INHERIT_ACE set), into two ACEs,
            one with no inheritance flags and one with
            ACE4_INHERIT_ONLY_ACE set.  (In the case of a dacl or
            sacl attribute, both of those ACEs <span class="bcp14">SHOULD</span> also have the
            ACE4_INHERITED_ACE flag set.)  This makes it simpler to
            modify the effective permissions on the directory
            without modifying the ACE that is to be inherited to the
            new directory's children.<a href="#section-9.11-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHCOMB-v42">
<section id="section-9.12">
        <h3 id="name-combined-authorization-mode">
<a href="#section-9.12" class="section-number selfRef">9.12. </a><a href="#name-combined-authorization-mode" class="section-name selfRef">Combined Authorization Models for NFSv4.2</a>
        </h3>
<p id="section-9.12-1">
       The NFSv4 server implementation requirements described 
       in the subsections above apply to NFSv4.2 as well and
       NFSv4.2 clients can assume that the server follows them.<a href="#section-9.12-1" class="pilcrow">¶</a></p>
<p id="section-9.12-2">
       NFSv4.2 contains an <span class="bcp14">OPTIONAL</span> extension, defined
       in <span>[<a href="#RFC8257" class="xref">13</a>]</span>, which is intended to reduce
       the interference of modes, restricted by the umask mechanism,
       with the acl inheritance mechanism.   The extension allows
       the client to specify the umask separately from the mask
       attribute.<a href="#section-9.12-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHL">
<section id="section-10">
      <h2 id="name-labelled-nfs-authorization-">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-labelled-nfs-authorization-" class="section-name selfRef">Labelled NFS Authorization Model</a>
      </h2>
<p id="section-10-1">
   The labelled NFS feature of NFSv4.2 is designed to support
   Mandatory Access control.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
   The attribute sec_label enables an authorization model focused
   on Mandatory Access Control and is described in
   <a href="#AUTHL" class="xref">Section 10</a>.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">
   Not much can be said about this feature because the specification,
   in the interest of flexibility, has left important features
   undefined in order to allow future extension.   As a result, we have
   something that is a framework to allow Mandatory Access Control
   rather than one to provide it.  In particular,<a href="#section-10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-4.1">
          <p id="section-10-4.1.1">
     The sec_label attribute, which provides the objects label has
     no existing specification.<a href="#section-10-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.2">
          <p id="section-10-4.2.1">
     There is no specification of the of the format of the subject
     label or way to authenticate them.<a href="#section-10-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.3">
          <p id="section-10-4.3.1">
     As a result, all authorization takes place on the client,
     and the server simply accepts the client's determination.<a href="#section-10-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-5">
   This arrangements shares important similarities with AUTH_SYS.
   As such it makes sense:<a href="#section-10-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-6.1">
          <p id="section-10-6.1.1">
     To require/recommend that an encrypted connection be used.<a href="#section-10-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-6.2">
          <p id="section-10-6.2.1">
     To require/recommend that client and server peers mutually
     authenticate as part of connection establishment.<a href="#section-10-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-6.3">
          <p id="section-10-6.3.1">
     That work be devoted to providing a replacement without the
     above issues.<a href="#section-10-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="AUTHST">
<section id="section-11">
      <h2 id="name-state-modification-authoriz">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-state-modification-authoriz" class="section-name selfRef">State Modification Authorization</a>
      </h2>
<p id="section-11-1">
   Modification of locking and session state data should not be done by
   a client other than the one that created the lock.  For this
   form of authorization, the server needs to identify and
   authenticate client peers rather than client users.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">
   Such authentication is not directly provided by any RPC
   authentication flavor.  However, RPC-based transports, when
   suitably configured, can provide this authentication.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">
   NFSv4.1 defines a number of ways to provide appropriate
   authorization facilities.   These will not be discussed in
   detail here but the following points should be noted:<a href="#section-11-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-4.1">
          <p id="section-11-4.1.1">
     NFSv4.1 defines the MACHCRED mechanism which uses the RPCSEC_GSS
     infrastructure to provide authentication of the clients peer.
     However, this is of no value when AUTH_SYS is being used.<a href="#section-11-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.2">
          <p id="section-11-4.2.1">
     NFSv4.1 also defines the SSV mechanism which uses the RPCSEC_GSS
     infrastructure to enable it to be reliably determined whether
     two different client connections are connected to the same client.
     It is unclear whether the word "authentication" is appropriate in
     this case.  As with MACHCRED, this is of no value when
     AUTH_SYS is being used.<a href="#section-11-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.3">
          <p id="section-11-4.3.1">
     Because of the lack of support for AUTH_SYS and for NFSv4.0,
     it is quite desirable for clients to use and for servers to
     require the use of client-peer authentication as part of
     connection establishment.<a href="#section-11-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-5">
   When unauthenticated clients are allowed, their  state is exposed to
   unwanted modification as part of disruption or denial-of-service
   attacks.  As a result, the potential burdens of such  attacks are felt
   principally by clients who choose not to provide such authentication.<a href="#section-11-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="OTHACL">
<section id="section-12">
      <h2 id="name-other-uses-of-access-contro">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-other-uses-of-access-contro" class="section-name selfRef">Other Uses of Access Control Lists</a>
      </h2>
<p id="section-12-1">
   Whether the acl or sacl attributes are used, AUDIT and ALARM
   ACEs provide security-related facilities separate from the
   the file access authorization provide by ALLOw and DENY
   ACEs<a href="#section-12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-2.1">
          <p id="section-12-2.1.1">
     AUDIT ACEs provide a means to audit attempts to acess specified
     file by specified sets of principals.<a href="#section-12-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.2">
          <p id="section-12-2.2.1">
     ALARM ACEs provide a means to draw special attention to attempts
     to acess specified
     files by specified sets of principals.<a href="#section-12-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="attrdef_sacl">
<section id="section-12.1">
        <h3 id="name-v41-attribute-59-sacl">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-v41-attribute-59-sacl" class="section-name selfRef">V4.1 Attribute 59: sacl</a>
        </h3>
<p id="section-12.1-1">
          The sacl attribute is like the acl attribute,
          but sacl allows
          only AUDIT and ALARM ACEs. The sacl
          attribute supports automatic inheritance (see
          <a href="#auto_inherit" class="xref">Section 5.10</a>).<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IDENT">
<section id="section-13">
      <h2 id="name-identification-and-authenti">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-identification-and-authenti" class="section-name selfRef">Identification and Authentication</a>
      </h2>
<p id="section-13-1">
      Various objects and subjects need to be identified for a protocol to
      function.   For it to be secure, many of these need to be authenticated
      so that incorrect identification is not the basis for attacks.<a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="IDENT-auth">
<section id="section-13.1">
        <h3 id="name-identification-vs-authentic">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-identification-vs-authentic" class="section-name selfRef">Identification vs. Authentication</a>
        </h3>
<p id="section-13.1-1">
 It is necessary to be clear about this distinction which has been
 obscured in the past, by the use of the term "RPC Authentication
 Flavor" in connection with situation in which identification
 without authentication occurred or in which there was neither
 identification nor authentication involved.   As a result, we will
 use the term "RPC Flavors" instead<a href="#section-13.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IDENT-items">
<section id="section-13.2">
        <h3 id="name-items-to-be-identified">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-items-to-be-identified" class="section-name selfRef">Items to be Identified</a>
        </h3>
<p id="section-13.2-1">
 Some identifier are not security-relevant and can used be used
 without authentication, given that, in the authorization
 decision, the object acted upon needs only to be properly
 identified<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-2.1">
            <p id="section-13.2-2.1.1">
   File names are of this type.<a href="#section-13.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-13.2-2.1.2">
   Unlike the case for some other protocols, confusion of names that
   result from internationalization issues, while an annoyance, are
   not relevant to security. If the confusion between LATIN CAPITAL
   LETTER O and CYRILLIC CAPITAL LETTER O, results in the wrong file
          being accessed, the mechanisms described in <a href="#AUTHFA" class="xref">Section 7</a>
   prevent in appropriate access being granted.<a href="#section-13.2-2.1.2" class="pilcrow">¶</a></p>
<p id="section-13.2-2.1.3">
   Despite the above, it is desirable if file names together with
   similar are not transferred in the clear as the information
   exposed may give attackers useful information helpful in
   planning and executing attacks.<a href="#section-13.2-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-2.2">
            <p id="section-13.2-2.2.1">
   The case of file handles is similar.<a href="#section-13.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-13.2-3">
 Identifiers that refer to state shared between client and server
 can be the basis of disruption attacks since clients and server
 necessarily assume that neither side will change the state corpus
 without appropriate notice.<a href="#section-13.2-3" class="pilcrow">¶</a></p>
<p id="section-13.2-4">
 While these identifiers do not need to be authenticated, they are
 associated with higher-level entities for which change of the state
 represented by those entities is subject to peer authentication.<a href="#section-13.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-5.1">
            <p id="section-13.2-5.1.1">
   Unexpected closure of stateids or changes in state sequence values
   can disrupt client access as no clients have provision to deal
   with this source of interference.<a href="#section-13.2-5.1.1" class="pilcrow">¶</a></p>
<p id="section-13.2-5.1.2">
   While encryption may make it more difficult to execute such attacks
   attackers can often guess stateid's since server generally not
   randomize them.<a href="#section-13.2-5.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-5.2">
            <p id="section-13.2-5.2.1">
   Similarly, modification to NFSv4.1 session state information can result
   in confusion if an attacker changes the slot sequence by assuring
   spurious requests.   Even if the request is rejected, the slot
   sequence is changed and clients may
   a difficult time getting back in sync with the server.<a href="#section-13.2-5.2.1" class="pilcrow">¶</a></p>
<p id="section-13.2-5.2.2">
   While encryption may make it more difficult to execute such attacks
   attackers can often guess slot id's and obtain sessinid's since
   server generally do not randomize them.<a href="#section-13.2-5.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-5.3">
            <p id="section-13.2-5.3.1"></p><a href="#section-13.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-13.2-6">
 it is necessary that modification of the higher-levell entities
 be restricted to the client that created them.<a href="#section-13.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-7.1">
            <p id="section-13.2-7.1.1">
    For NFSv4.0, the relevant entity is the clientid.<a href="#section-13.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-7.2">
            <p id="section-13.2-7.2.1">
    for NFSv4.1, the relevant entity is the sessionid.<a href="#section-13.2-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-13.2-8">
 Identifiers describing the issuer of the request, whether in numeric
 or string form always require authentication.<a href="#section-13.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IDENT-flavor">
<section id="section-13.3">
        <h3 id="name-authentication-provided-by-">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-authentication-provided-by-" class="section-name selfRef">Authentication Provided by specific RPC Flavors</a>
        </h3>
<p id="section-13.3-1">
 Different flavors differ quite considerably, as discussed below;<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3-2.1">
            <p id="section-13.3-2.1.1">
   When AUTH_NONE is used, the user making the request is neither
   authenticated nor identified to the server.<a href="#section-13.3-2.1.1" class="pilcrow">¶</a></p>
<p id="section-13.3-2.1.2">
   Also, the server is not authenticated to the client and has no
   way to determine whether the server it is communicating with is
   an imposter.<a href="#section-13.3-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.3-2.2">
            <p id="section-13.3-2.2.1">
   When AUTH_SYS is used, the user making is the request identified
   but there
   no authentication of that identification.<a href="#section-13.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-13.3-2.2.2">
   As in the previous case, the server is not authenticated to
   the client and has no
   way to determine whether the server it is communicating with is
   an imposter.<a href="#section-13.3-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.3-2.3">
            <p id="section-13.3-2.3.1">
   When RPCSEC_GSS is used, the user making the request is authenticated
   as is the server peer responding.<a href="#section-13.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="IDENT-xport">
<section id="section-13.4">
        <h3 id="name-authentication-provided-by-t">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-authentication-provided-by-t" class="section-name selfRef">Authentication Provided by the RPC Transport</a>
        </h3>
<p id="section-13.4-1">
 Different transports differ quite considerably, as discussed below.
 In contrast to the case of RPC flavors, any authentication happens
 once, at connection establishment, rather than on each RPC request.
 As a result, it is the client and server peers, rather than individual
 users that is authenticated.<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.1">
            <p id="section-13.4-2.1.1">
   For most transports, such as TCP and RPC-over-RDMA version 1, there
   is no provision for peer authentication.<a href="#section-13.4-2.1.1" class="pilcrow">¶</a></p>
<p id="section-13.4-2.1.2">
   As a result use of AUTH_SYS together with such transports is
   inherently problematic.<a href="#section-13.4-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.4-2.2">
            <p id="section-13.4-2.2.1">
   Some transports provide for the possibility of mutual peer
   authentication.<a href="#section-13.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="DATA">
<section id="section-14">
      <h2 id="name-security-of-data-in-flight">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-security-of-data-in-flight" class="section-name selfRef">Security of Data in Flight</a>
      </h2>
<div id="DATA-flavor">
<section id="section-14.1">
        <h3 id="name-data-security-provided-by-t">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-data-security-provided-by-t" class="section-name selfRef">Data Security Provided by the Flavor-associated Services</a>
        </h3>
<p id="section-14.1-1">
 The only flavor providing these facilities is RPCSEC_GSS.  When this
 flavor is used, data security can be negotiated between client and
 server as described in <a href="#NEGO-flavor" class="xref">Section 15.2</a>.  However, when
 data security is provided at the transport level, as described in
 <a href="#DATA-xport" class="xref">Section 14.2</a>, the negotiation of privacy and integrity
 support is unnecessary,<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">
 Other flavors, such as AUTH_SYS and AUTH_NONE have no such data
 security facilities.   When these flavor are used, the only data
 security is provided by the transport.<a href="#section-14.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="DATA-xport">
<section id="section-14.2">
        <h3 id="name-data-security-provided-by-th">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-data-security-provided-by-th" class="section-name selfRef">Data Security Provided by the RPC Transport</a>
        </h3>
<p id="section-14.2-1">
 Some transports provide data security for all transactions performed
 on them, eliminating the need for that security to be provided or
 negotiated by the selection of particular flavors, mechanism, or
 services.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="NEGO">
<section id="section-15">
      <h2 id="name-security-negotiation">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-negotiation" class="section-name selfRef">Security Negotiation</a>
      </h2>
<p id="section-15-1">
      [Author Aside]: All unannotated paragraphs in this section are
      considered to b part of Consensus Item #32a<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">
      As previously in NFSv4, we use the term "negotiation" to characterize
      the process of the server providing a set of options and the client
      selecting one.<a href="#section-15-2" class="pilcrow">¶</a></p>
<p id="section-15-3">
      The use of SECINFO, possibly with SECINFO_NONAME, remains the
      primary means by which the security parameters are determined.  The
      addition of transports to flavors in providing security has resulted
      in the following changes:<a href="#section-15-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.1">
          <p id="section-15-4.1.1">
        Transport-related security choices are typically decided at
 connection-establishment so there needs to be provision for
 negotiation at this point.<a href="#section-15-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-15-4.2">
          <p id="section-15-4.2.1">
        Despite the above, because the choices of flavor and transport
 affect one another, SECINFO has been extended by the addition
 of pseudo-flavors, while retaining the existing XDR, to allow
 negotiation of transport choices and accompanying connection
 establishment options, in addition to selection of flavors and
 accompanying services.   This allows server policies for such
 matters to be different for different portions of the namespace.<a href="#section-15-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="NEGO-flandpfl">
<section id="section-15.1">
        <h3 id="name-flavors-and-pseudo-flavors">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-flavors-and-pseudo-flavors" class="section-name selfRef">Flavors and Pseudo-flavors</a>
        </h3>
<p id="section-15.1-1">
        [Author Aside]: All unannotated paragraphs in this section are
        considered to be part of Consensus Item #32b<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1-2">
 The flavor field of the secinfo4 items returned by SECINFO and
 SECINO_NONAME have always allowed pseudo flavors to be included.
 However, previous treatments of these operations have not provided
 information
 about how responses containing such pseudo-flavors are to be
 interpreted.<a href="#section-15.1-2" class="pilcrow">¶</a></p>
<p id="section-15.1-3">
 Those pseudo-flavors now provide a means of extending the
 negotiation process so it is capable of providing
 for the negotiation of the use particular RPC transports and
 security-related options for the connections established using
 those transports.<a href="#section-15.1-3" class="pilcrow">¶</a></p>
<p id="section-15.1-4">
 The flavors AUTH_NONE, AUTH_SYS and RPCSEC_GSS continue to indicate the
 acceptability of the corresponding method of user authentication,
 user identification, or user non-identification, when used with
 a particular RPC transport.<a href="#section-15.1-4" class="pilcrow">¶</a></p>
<p id="section-15.1-5">
 The flavor AUTH_TLS, which is not used as part of issuing
 requests is not included in this list and is treated as a
 connection-type-specifying pseudo-flavor.<a href="#section-15.1-5" class="pilcrow">¶</a></p>
<p id="section-15.1-6">
 secinfo4s for the flavor RPCSEC_GSS contains additional
 information describing the specific security algorithm to be used
 and the ancillary services to be provided (e.g. integrity, privacy)
 when these services are not provided by the transport.<a href="#section-15.1-6" class="pilcrow">¶</a></p>
<p id="section-15.1-7">
 Such flavors are referred to as "identification-specifying flavors"<a href="#section-15.1-7" class="pilcrow">¶</a></p>
<p id="section-15.1-8">
 The classification below organizes the flavors and pseudo-flavors
 used in security negotiation while <a href="#NEGO-algo" class="xref">Section 15.4</a>
 describes how the set of secinfos in a response can be used by
 the client to select acceptable combinations of security flavor,
 security mechanism, security services, security-related transports,
 and security-related connection characteristics.<a href="#section-15.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1-9.1">
            <p id="section-15.1-9.1.1">
   The pseudo-flavors designating a particular transport
   type such as XPT_TCP or XPT_RDMA.<a href="#section-15.1-9.1.1" class="pilcrow">¶</a></p>
<p id="section-15.1-9.1.2">
   These pseudo-flavors are referred to as "transport-
   specifying flavors".<a href="#section-15.1-9.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-9.2">
            <p id="section-15.1-9.2.1">
   The pseudo-flavors designating restrictions on acceptable
   connection
   characteristics include XPCH_ENCRYPT, 
   XPCH_PEERAUTH, and XPCH_SECURE.<a href="#section-15.1-9.2.1" class="pilcrow">¶</a></p>
<p id="section-15.1-9.2.2">
   Such pseudo-flavors are referred to as "transport-restriction
   pseudo-flavors".<a href="#section-15.1-9.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-9.3">
            <p id="section-15.1-9.3.1">
   The pseudo-flavors denoting sets of allowable connection
   types.  While many
   connection types are designated by a combination of a flavor
   designating a transport with on designating a set of connection
   characteristics, there are pseudo-flavors,
   called "conection-type pseido-flavror that designate a
   a set of connection types directly.<a href="#section-15.1-9.3.1" class="pilcrow">¶</a></p>
<p id="section-15.1-9.3.2">
   These include the flavor AUTH_TLS which is equivalent to XP_TCP
   combined with XPCH_ENCRYPT, and the pseudo-flavor
   XP_TCP_SECURE equivalent to XP_TCP combined with
   XPCH_SECURE.<a href="#section-15.1-9.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-9.4">
            <p id="section-15.1-9.4.1">
   The special pseudo-flavors, XPBREAK, XPCLEAR and XPCURRENT<a href="#section-15.1-9.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="NEGO-flavor">
<section id="section-15.2">
        <h3 id="name-negotiation-of-security-fla">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-negotiation-of-security-fla" class="section-name selfRef">Negotiation of Security Flavors and Mechanisms</a>
        </h3>
<p id="section-15.2-1">
        [Author Aside]: All unannotated paragraphs in this section are
        considered to be part of Consensus Item #32c<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<p id="section-15.2-2">
 For the current connection, this proceeds as it has previously, when
 security-relevant transports were not available.  Flavor entries,
 including those including mechanism information are listed in order
 of server preference and apply, by default, to the current connection,
 which is normally is favored by the server.<a href="#section-15.2-2" class="pilcrow">¶</a></p>
<p id="section-15.2-3">
 When other transport-identifying pseudo-flavors appear before the
 flavor entries, then the server is indicating that these transport
 types are also acceptable, with the server preference following
 the ordering of the
 entries.  In this case, any flavor entries that follow a transport
 entry specify that those flavor are usable with the
 transport types or connection types denoted
 by that transport entry.<a href="#section-15.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-xports">
<section id="section-15.3">
        <h3 id="name-negotiation-of-rpc-transpor">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-negotiation-of-rpc-transpor" class="section-name selfRef">Negotiation of RPC Transports and Characteristics</a>
        </h3>
<p id="section-15.3-1">
        [Author Aside]: All unannotated paragraphs in this section are
        considered to be part of Consensus Item #32d<a href="#section-15.3-1" class="pilcrow">¶</a></p>
<p id="section-15.3-2">
 First we define some necessary terminology.<a href="#section-15.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.3-3.1">
            <p id="section-15.3-3.1.1">
   A transport-specifying pseudo-flavor specifies one of a small
   set of RPC transport types such as TCP or RDMA. 
   There are also pseudo-flavors that
   specify a set of transport types such as XPT_ALL.<a href="#section-15.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.3-3.2">
            <p id="section-15.3-3.2.1">
   Connection characteristics are designations of security-relevant
   characteristics or sets of characteristics  that connections might
   have.<a href="#section-15.3-3.2.1" class="pilcrow">¶</a></p>
<p id="section-15.3-3.2.2">
   There are pseudo-flavors associated with connection characteristics
   such as XPCH_CLPEERAUTH, denoting client-peer authentication and
   XPCH_ENCRYPT, denoting the presence of an encrypted channel.
   The pseudo-flavor XPCH_SECURE denotes the presence of peer mutual
   authentication together with the use of an encrypted channel.<a href="#section-15.3-3.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.3-3.3">
            <p id="section-15.3-3.3.1">
   The combination of a transport type with a set of connection
   characteristics is considered a connection type.  While many
   connection types are designated by a combination of a flavor
   designating a transport with on designating a set of connection
   characteristics, there are pseudo-flavors that designate a
   set of connection types directly.<a href="#section-15.3-3.3.1" class="pilcrow">¶</a></p>
<p id="section-15.3-3.3.2">
 For example, the flavor AUTH_TLS is equivalent to XP_TCP
 combined with XPCH_ENCRYPT and XPCH_CLPEERAUTH
 while the pseudo-flavor
 XP_TCP_SECURE equivalent to XP_TCP combined with
 CONCH_SECURE.<a href="#section-15.3-3.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.3-3.4">
            <p id="section-15.3-3.4.1">
   A flavor specification designates a specific flavor, or, in
   the case of RPCSEC_GSS, a flavor combined with additional
   mechanism and service information.<a href="#section-15.3-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.3-3.5">
            <p id="section-15.3-3.5.1">
   A flavor assignment denotes the association of a specific
   flavor specification with a connection type.<a href="#section-15.3-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-15.3-4">
 A secinfo response will designate a set of valid flavor assignments
 with an implied server ordering derived from the order that
 the entries appear in.<a href="#section-15.3-4" class="pilcrow">¶</a></p>
<p id="section-15.3-5">
 In interpreting the response array the client is to maintain sets
 of designated transport types, connection characteristics  and
 connection types specified individually (i.e. without separately
 specifying transport types and connection characteristics).
 When a flavor specification is encountered, that flavor is considered
 valid when used with all currently active connection types,
 defined by the union of the individually specified connection types
 and the Cartesian product of the current transport types and
 current connection types.<a href="#section-15.3-5" class="pilcrow">¶</a></p>
<p id="section-15.3-6">
 The presumed ordering of these assignments is as follows:<a href="#section-15.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.3-7.1">
   When one of the connection types was specified directly by
   a connection type, the position of that specification is compared
   to that of either the other individually-specified connection
   type or the earlier of the transport-type specification and the
   connection characteristics specification.<a href="#section-15.3-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.3-7.2">
   In other cases, the position of the transport type specifications
   are considered first withe the position of the connection
   characteristics considered if necessary.<a href="#section-15.3-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.3-7.3">
   If neither of the above resolve issue, the position of the
   flavor specification is considered.<a href="#section-15.3-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.3-7.4">
   The type of the current connection is considered to be
   specified first, implicitly.<a href="#section-15.3-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.3-7.5">
   There are provisions, described in <a href="#NEGO-algo" class="xref">Section 15.4</a>
   to modify this ordering, as may be necessary, for example,
   when the current connection, while acceptable is, of lower
   server preference.<a href="#section-15.3-7.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="NEGO-algo">
<section id="section-15.4">
        <h3 id="name-overall-interpretation-of-s">
<a href="#section-15.4" class="section-number selfRef">15.4. </a><a href="#name-overall-interpretation-of-s" class="section-name selfRef">Overall Interpretation of SECINFO Response Arrays</a>
        </h3>
<p id="section-15.4-1">
        [Author Aside]: All unannotated paragraphs in this section are
        considered to be part of Consensus Item #32e.<a href="#section-15.4-1" class="pilcrow">¶</a></p>
<p id="section-15.4-2">
        This section summarizes the processing necessary on the client
 to interpret the response to a SECINFO or SECINFO_NONAME request
 and determine, at the specified  part of the server's namespace:<a href="#section-15.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.4-3.1">
            <p id="section-15.4-3.1.1">
   The set of transport types acceptable to the server.<a href="#section-15.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-3.2">
            <p id="section-15.4-3.2.1">
   The set of connection types acceptable to the server.<a href="#section-15.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-3.3">
            <p id="section-15.4-3.3.1">
   For each acceptable connection type, the set of flavors
   acceptable to the server.<a href="#section-15.4-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-3.4">
            <p id="section-15.4-3.4.1">
   For each acceptable connection type for which encryption
   is not provided and for which the flavor
   RPCSEC_GSS is accepted, a set of services to be required when
   using the flavor on connections of that type.<a href="#section-15.4-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-15.4-4">
 For each of the items for which the set of acceptable elments
 has more
 than one element,  the server's preference order can be
 communicated to the client.<a href="#section-15.4-4" class="pilcrow">¶</a></p>
<p id="section-15.4-5">
 This section provides the same information as Sections
 <a href="#NEGO" class="xref">15</a> through
 <a href="#NEGO-xports" class="xref">15.3</a> but the
 presentation is in the form of an algorithm.<a href="#section-15.4-5" class="pilcrow">¶</a></p>
<p id="section-15.4-6">
 The algorithm needs to maintain the following information as
 part of the context shared with the operations defined
 in Sections
 <a href="#NEGO-algo-ctx" class="xref">15.4.2</a> and
 <a href="#NEGO-algo-flx" class="xref">15.4.3</a><a href="#section-15.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.4-7.1">
            <p id="section-15.4-7.1.1">
  The ordered set of currently specified transport types.<a href="#section-15.4-7.1.1" class="pilcrow">¶</a></p>
<p id="section-15.4-7.1.2">
         Because of the need to retain ordering information, a mask cannot
         be used to represent this.<a href="#section-15.4-7.1.2" class="pilcrow">¶</a></p>
<p id="section-15.4-7.1.3">
         Because duplicates are not allowed, the size of this data can be
         limited, based on the number of valid transport types.<a href="#section-15.4-7.1.3" class="pilcrow">¶</a></p>
<p id="section-15.4-7.1.4">
         The initial value is the empty list.<a href="#section-15.4-7.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-7.2">
            <p id="section-15.4-7.2.1">
  An array of sets of current transport restrictions.<a href="#section-15.4-7.2.1" class="pilcrow">¶</a></p>
<p id="section-15.4-7.2.2">
         Since there are three possible transport characteristics:
  encryption, client-peer authentication, and server-peer
  authentication, a given connection may have eight possible states
  and a set of allowed characteristics represented by an eight-bit
  mask of allowed combinations of chaacteristics.<a href="#section-15.4-7.2.2" class="pilcrow">¶</a></p>
<p id="section-15.4-7.2.3">
         The initial value is a single entry with all bits set,
         indicating no current restrictions.<a href="#section-15.4-7.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-7.3">
            <p id="section-15.4-7.3.1">
  The ordered set of additional connection types, beyond the
  Cartesian product of the current sets of transport types and
  of connection restrictions.<a href="#section-15.4-7.3.1" class="pilcrow">¶</a></p>
<p id="section-15.4-7.3.2">
         Each entry consists of a transport type together with a
         connection characteristics mask.<a href="#section-15.4-7.3.2" class="pilcrow">¶</a></p>
<p id="section-15.4-7.3.3">
         The initial value is a single-entry list whose only entry
         consists of the transport type of the current connection
  combined with a set of transport
         characteristics in effect for the current connection and no
  other possibilities.<a href="#section-15.4-7.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-7.4">
            <p id="section-15.4-7.4.1">
  The pseudo-flavor most previously processed.<a href="#section-15.4-7.4.1" class="pilcrow">¶</a></p>
<p id="section-15.4-7.4.2">
         When this is not one of the special pseudo-flavors, the
         pseudo-flavor type is sufficient.<a href="#section-15.4-7.4.2" class="pilcrow">¶</a></p>
<p id="section-15.4-7.4.3">
         The initial value is transport-restriction pseudo-flavor type
         reflecting the fact that the state of the current connection
  is the initial basis for flavor specification.<a href="#section-15.4-7.4.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-7.5">
            <p id="section-15.4-7.5.1">
  The output list showing, in order, the combinations of
  connection types combined with flavors, or, in the case
  of RPCSEC_GSS, of flavor triples.<a href="#section-15.4-7.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="NEGO-algo-main">
<section id="section-15.4.1">
          <h4 id="name-interpretation-of-secinfo-r">
<a href="#section-15.4.1" class="section-number selfRef">15.4.1. </a><a href="#name-interpretation-of-secinfo-r" class="section-name selfRef">Interpretation of SECINFO Response Arrays (Core)</a>
          </h4>
<p id="section-15.4.1-1">
        [Author Aside]: This preliminary section, which is currently
 incomplete, is considered Consensus Item #49a.<a href="#section-15.4.1-1" class="pilcrow">¶</a></p>
<p id="section-15.4.1-2">
 [Author Aside]: There are problems with the indenting in this
 section.  This may be due to to an xml2rfc bug or I may be
 using ul incorrectly, or both.  Will try to fix this for
 the next draft.<a href="#section-15.4.1-2" class="pilcrow">¶</a></p>
<p id="section-15.4.1-3">
 Processing of the response proceeds through each secinfo4 in the
 response.  For each such entry, the flavor value, which may be
 a pseudo-flavor, controls what is to be done.<a href="#section-15.4.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.1">
              <p id="section-15.4.1-4.1.1">
   The current entry is fetched.<a href="#section-15.4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-15.4.1-4.2">
              <p id="section-15.4.1-4.2.1">
   The pseudo-flavor for that entry controls what is done next.<a href="#section-15.4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-15.4.1-4.3">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.1">
                  <p id="section-15.4.1-4.3.1.1.1">
     If the pseudo-flavor specifies a transport type or a set of
     transport types, the following is done:<a href="#section-15.4.1-4.3.1.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.2">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.2.1.1">
                      <p id="section-15.4.1-4.3.1.2.1.1.1">
 If the previous pseudo-flavor was not a
 transport-specifying flavor,<a href="#section-15.4.1-4.3.1.2.1.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.2.1.2">
                      <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.2.1.2.1.1">
                          <p id="section-15.4.1-4.3.1.2.1.2.1.1.1">
     Connection type expansion, as described in
     <a href="#NEGO-algo-ctx" class="xref">Section 15.4.2</a> is performed.<a href="#section-15.4.1-4.3.1.2.1.2.1.1.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.2.1.3">
                      <p id="section-15.4.1-4.3.1.2.1.3.1">
 If the flavor designates a single transport type,<a href="#section-15.4.1-4.3.1.2.1.3.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.2.1.4">
                      <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.2.1.4.1.1">
                          <p id="section-15.4.1-4.3.1.2.1.4.1.1.1">
     The connection type is added to the current list, if
     it is not already present in the list.<a href="#section-15.4.1-4.3.1.2.1.4.1.1.1" class="pilcrow">¶</a></p>
</li>
                        <li class="normal ulEmpty" id="section-15.4.1-4.3.1.2.1.4.1.2">
                          <p id="section-15.4.1-4.3.1.2.1.4.1.2.1">
     Otherwise, each  included transport type is added to
     the list in turn.<a href="#section-15.4.1-4.3.1.2.1.4.1.2.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                  </ul>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.3">
                  <p id="section-15.4.1-4.3.1.3.1">
     If the pseudo-flavor specifies a connection
     restriction, the following is done:<a href="#section-15.4.1-4.3.1.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.4">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.4.1.1">
                      <p id="section-15.4.1-4.3.1.4.1.1.1">
 If the previous pseudo-flavor was not a
 transport-specifying flavor, is not a
 restriction-specifying flavor and is not XPBREAK,<a href="#section-15.4.1-4.3.1.4.1.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.4.1.2">
                      <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.4.1.2.1.1">
                          <p id="section-15.4.1-4.3.1.4.1.2.1.1.1">
     Connection type expansion, as described in
     <a href="#NEGO-algo-ctx" class="xref">Section 15.4.2</a> is performed.<a href="#section-15.4.1-4.3.1.4.1.2.1.1.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.4.1.3">
                      <p id="section-15.4.1-4.3.1.4.1.3.1">
                If the previous pseudo-favor was XPBREAK,<a href="#section-15.4.1-4.3.1.4.1.3.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.4.1.4">
                      <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.4.1.4.1.1">
                          <p id="section-15.4.1-4.3.1.4.1.4.1.1.1">
                    A new restriction entry, initialized with all bits
     one, is added to the list.<a href="#section-15.4.1-4.3.1.4.1.4.1.1.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.4.1.5">
                      <p id="section-15.4.1-4.3.1.4.1.5.1">
 In any case, the newly-specified restrictions are anded
 with the last entry in the list.<a href="#section-15.4.1-4.3.1.4.1.5.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.5">
                  <p id="section-15.4.1-4.3.1.5.1">
     If the pseudo-flavor specifies a set of connection
     types or is XPCURRENT, the following is done:<a href="#section-15.4.1-4.3.1.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.6">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.6.1.1">
                      <p id="section-15.4.1-4.3.1.6.1.1.1">
 Inoformation specified by the current flavor is added
 to the list of additional connection types, if that same
 set of connection type is not already present.<a href="#section-15.4.1-4.3.1.6.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.7">
                  <p id="section-15.4.1-4.3.1.7.1">
     If the pseudo-flavor is XPBREAK,<a href="#section-15.4.1-4.3.1.7.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.8">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.8.1.1">
                      <p id="section-15.4.1-4.3.1.8.1.1.1">
 Nothing specific is done at this point.<a href="#section-15.4.1-4.3.1.8.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.9">
                  <p id="section-15.4.1-4.3.1.9.1">
     If the pseudo-flavor is XPCLEAR,<a href="#section-15.4.1-4.3.1.9.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.10">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.10.1.1">
                      <p id="section-15.4.1-4.3.1.10.1.1.1">
 The set of data maintained by algorithm, including the
 flavor output is reset to its initial state.<a href="#section-15.4.1-4.3.1.10.1.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal ulEmpty" id="section-15.4.1-4.3.1.10.1.2">
                      <p id="section-15.4.1-4.3.1.10.1.2.1">
 In addition the set of additional connection types is cleared
 to empty state, i.e. information about the current connection
 is removed.<a href="#section-15.4.1-4.3.1.10.1.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.11">
                  <p id="section-15.4.1-4.3.1.11.1">
     If the pseudo-flavor is an authentication flavor,<a href="#section-15.4.1-4.3.1.11.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal ulEmpty" id="section-15.4.1-4.3.1.12">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.4.1-4.3.1.12.1.1">
                      <p id="section-15.4.1-4.3.1.12.1.1.1">
 Flavor expansion, as described in
 <a href="#NEGO-algo-flx" class="xref">Section 15.4.3</a> is performed to
 combine the current flavor or flavor triple with each of the
 currently specified connection types.<a href="#section-15.4.1-4.3.1.12.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li class="normal ulEmpty" id="section-15.4.1-4.4">
              <p id="section-15.4.1-4.4.1">
   Then the current pseudo-flavor is saved as the previous
   pseudo-flavor.<a href="#section-15.4.1-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-15.4.1-4.5">
              <p id="section-15.4.1-4.5.1">
   We then move on to the next entry.<a href="#section-15.4.1-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-15.4.1-4.6">
              <p id="section-15.4.1-4.6.1"></p><a href="#section-15.4.1-4.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="NEGO-algo-ctx">
<section id="section-15.4.2">
          <h4 id="name-connection-type-transcripti">
<a href="#section-15.4.2" class="section-number selfRef">15.4.2. </a><a href="#name-connection-type-transcripti" class="section-name selfRef">Connection Type Transcription</a>
          </h4>
<p id="section-15.4.2-1">
 [Author Aside]: This section will be provided in a later draft
 as part of Consensus Item #48a.<a href="#section-15.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-algo-flx">
<section id="section-15.4.3">
          <h4 id="name-flavor-transcription">
<a href="#section-15.4.3" class="section-number selfRef">15.4.3. </a><a href="#name-flavor-transcription" class="section-name selfRef">Flavor Transcription</a>
          </h4>
<p id="section-15.4.3-1">
 [Author Aside]: This section will be provided in a later draft
 as part of Consensus Item #48b.<a href="#section-15.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="NEGO-secinfo">
<section id="section-15.5">
        <h3 id="name-secinfo">
<a href="#section-15.5" class="section-number selfRef">15.5. </a><a href="#name-secinfo" class="section-name selfRef">SECINFO</a>
        </h3>
<p id="section-15.5-1">
        [Author Aside]: All unannotated paragraphs in this section are
        considered to be part of Consensus Item #33a.<a href="#section-15.5-1" class="pilcrow">¶</a></p>
<p id="section-15.5-2">
 The description in the sub-sections below, while it adheres
 to the XDR appearing <span>[<a href="#RFC7530" class="xref">6</a>]</span>,
 <span>[<a href="#RFC7531" class="xref">7</a>]</span>, <span>[<a href="#RFC8881" class="xref">8</a>]</span>, 
 <span>[<a href="#RFC5662" class="xref">9</a>]</span> and <span>[<a href="#RFC7863" class="xref">11</a>]</span>.
 will supersede the descriptions in
 <span>[<a href="#RFC7531" class="xref">7</a>]</span> and <span>[<a href="#RFC8881" class="xref">8</a>]</span>.<a href="#section-15.5-2" class="pilcrow">¶</a></p>
<p id="section-15.5-3">
 This is necessary to adapt the security negotiation process
 to the presence of transport-level security services such as
 encryption and peer authentication.<a href="#section-15.5-3" class="pilcrow">¶</a></p>
<p id="section-15.5-4">
 Similar changes are necessary in the parallel SECINFO_NONAME
 operation introduced in NFSv4.1.   These are expected to be done as
 part of the rfc5661bis effort.<a href="#section-15.5-4" class="pilcrow">¶</a></p>
<div id="NEGO-secinfo-args">
<section id="section-15.5.1">
          <h4 id="name-secinfo-arguments">
<a href="#section-15.5.1" class="section-number selfRef">15.5.1. </a><a href="#name-secinfo-arguments" class="section-name selfRef">SECINFO ARGUMENTS</a>
          </h4>
<p id="section-15.5.1-1">
          [Author Aside]: All unannotated paragraphs in this section are
          considered to be part of Consensus Item #33b.<a href="#section-15.5.1-1" class="pilcrow">¶</a></p>
<figure id="figure-1">
            <div class="alignLeft art-text artwork" id="section-15.5.1-2.1">
<pre>
struct SECINFO4args {
        /* CURRENT_FH: directory */
        component4      name;
};

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
</section>
</div>
<div id="NEGO-secinfo-resulta">
<section id="section-15.5.2">
          <h4 id="name-secinfo-results">
<a href="#section-15.5.2" class="section-number selfRef">15.5.2. </a><a href="#name-secinfo-results" class="section-name selfRef">SECINFO RESULTS</a>
          </h4>
<p id="section-15.5.2-1">
          [Author Aside]: All unannotated paragraphs in this section are
          considered to be part of Consensus Item #33c.<a href="#section-15.5.2-1" class="pilcrow">¶</a></p>
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-15.5.2-2.1">
<pre>
/*
 * From RFC 2203
 */
enum rpc_gss_svc_t {
        RPC_GSS_SVC_NONE        = 1,
        RPC_GSS_SVC_INTEGRITY   = 2,
        RPC_GSS_SVC_PRIVACY     = 3
};

struct rpcsec_gss_info {
        sec_oid4        oid;
        qop4            qop;
        rpc_gss_svc_t   service;
};

/* RPCSEC_GSS has a value of '6' - See RFC 2203 */
union secinfo4 switch (uint32_t flavor) {
 case RPCSEC_GSS:
         rpcsec_gss_info        flavor_info;
 default:
         void;
};

typedef secinfo4 SECINFO4resok&lt;&gt;;

union SECINFO4res switch (nfsstat4 status) {
 case NFS4_OK:
        /* CURRENTFH: consumed */
         SECINFO4resok resok4;
 default:
         void;
};

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
</section>
</div>
<div id="NEGO-secinfo-descr">
<section id="section-15.5.3">
          <h4 id="name-secinfo-description">
<a href="#section-15.5.3" class="section-number selfRef">15.5.3. </a><a href="#name-secinfo-description" class="section-name selfRef">SECINFO DESCRIPTION</a>
          </h4>
<p id="section-15.5.3-1">
          [Author Aside]: All unannotated paragraphs in this section are
          considered to be part of Consensus Item #33d.<a href="#section-15.5.3-1" class="pilcrow">¶</a></p>
<p id="section-15.5.3-2">
   The SECINFO operation is used by the client determine the
   appropriate RPC authentication flavors, security mechanisms and
   encrypting transports to access a specific directory
   filehandle, file name pair.  SECINFO should apply the same
   access approach used for LOOKUP when evaluating the name.
   In consequence, if the requester does not have the appropriate
          access to LOOKUP the name, then SECINFO will behave the same way and
          return NFS4ERR_ACCESS.<a href="#section-15.5.3-2" class="pilcrow">¶</a></p>
<p id="section-15.5.3-3">
          The result will contain an array that represents the security
      flavor, security mechanisms and transports available, with an
      order corresponding to the
      server's preferences, the most preferred being first in the
      array. The client is free to pick whatever security flavors, mechanisms
      and transports it both desires and supports, or to pick in the server's
      preference
      order the first one it supports.  The array entries are
      represented by the secinfo4 structure.  The field 'flavor' will
      contain one of the following sorts of values:<a href="#section-15.5.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.3-4.1">
              <p id="section-15.5.3-4.1.1">
        a value of AUTH_NONE, AUTH_SYS (as defined in
 <span><a href="#RFC5531" class="xref">RFC 5531</a> [<a href="#RFC5531" class="xref">4</a>]</span>).<a href="#section-15.5.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.3-4.2">
              <p id="section-15.5.3-4.2.1">
 AUTH_TLS  as described in ...<a href="#section-15.5.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.3-4.3">
              <p id="section-15.5.3-4.3.1">
        A pseudo-flavor defined in <a href="#IANA-flavors" class="xref">Section 18.2</a><a href="#section-15.5.3-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.3-4.4">
              <p id="section-15.5.3-4.4.1">
 RPCSEC_GSS (as defined in <span><a href="#RFC2203" class="xref">RFC 2203</a> [<a href="#RFC2203" class="xref">2</a>]</span>).<a href="#section-15.5.3-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.3-4.5">
              <p id="section-15.5.3-4.5.1">
 Any other security flavor or pseudo-flavor registered with IANA.<a href="#section-15.5.3-4.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-15.5.3-5">
      For the flavors other than RPCSEC_GSS, no additional security
      information is returned.  For a return value of
      RPCSEC_GSS, a security triple is returned that contains the
      mechanism object identifier (OID, as defined in <span><a href="#RFC2743" class="xref">RFC 2743</a> [<a href="#RFC2743" class="xref">3</a>]</span>), the quality of protection (as
      defined in <span><a href="#RFC2743" class="xref">RFC 2743</a> [<a href="#RFC2743" class="xref">3</a>]</span>), and the
      service type (as defined in <span><a href="#RFC2203" class="xref">RFC 2203</a> [<a href="#RFC2203" class="xref">2</a>]</span>).  It is possible for SECINFO to
      return multiple entries with flavor equal to RPCSEC_GSS with
      different security triple values.<a href="#section-15.5.3-5" class="pilcrow">¶</a></p>
<p id="section-15.5.3-6">
      On success, the current filehandle is consumed, so that, if the
      operation following SECINFO tries to use the current filehandle,
      that operation will fail with the status NFS4ERR_NOFILEHANDLE.<a href="#section-15.5.3-6" class="pilcrow">¶</a></p>
<p id="section-15.5.3-7">
      If the name has a length of zero, or if the name does not obey
      the UTF-8 definition in circumstances in which UTF-8 names are
      required, the error NFS4ERR_INVAL will be returned.<a href="#section-15.5.3-7" class="pilcrow">¶</a></p>
<p id="section-15.5.3-8">
      See Sections <a href="#NEGO-flavor" class="xref">15.2</a> through 
      <a href="#NEGO-algo" class="xref">15.4</a> for additional
      information on the use of SECINFO.<a href="#section-15.5.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-secinfo-impl">
<section id="section-15.5.4">
          <h4 id="name-secinfo-implementation-gene">
<a href="#section-15.5.4" class="section-number selfRef">15.5.4. </a><a href="#name-secinfo-implementation-gene" class="section-name selfRef">SECINFO IMPLEMENTATION (general)</a>
          </h4>
<p id="section-15.5.4-1">
          [Author Aside]: All unannotated paragraphs in this section are
          considered to be part of Consensus Item #33e.<a href="#section-15.5.4-1" class="pilcrow">¶</a></p>
<p id="section-15.5.4-2">
          The SECINFO operation is expected to be used by the NFS client
          when the error value of NFS4ERR_WRONGSEC is returned from
          another NFS operation.  This signifies to the client that the
          server's security policy is different from what the client is
          currently using.  At this point, the client is expected to
          obtain a list of possible security flavors and choose what best
          suits its policies.<a href="#section-15.5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-secinfo-impl0">
<section id="section-15.5.5">
          <h4 id="name-secinfo-implementation-for-">
<a href="#section-15.5.5" class="section-number selfRef">15.5.5. </a><a href="#name-secinfo-implementation-for-" class="section-name selfRef">SECINFO IMPLEMENTATION (for NFSv4.0)</a>
          </h4>
<p id="section-15.5.5-1">
          [Author Aside]: All unannotated paragraphs in this section are
          considered to be part of Consensus Item #34a.<a href="#section-15.5.5-1" class="pilcrow">¶</a></p>
<p id="section-15.5.5-2">
        The server's security policies will
        determine when a client request receives NFS4ERR_WRONGSEC.
        The operations that may receive this error are LINK,
        LOOKUP, LOOKUPP, OPEN, PUTFH, PUTPUBFH, PUTROOTFH, RENAME,
        RESTOREFH, and, indirectly, READDIR.  LINK and RENAME will only
        receive this error if the security used for the operation
        is inappropriate for the saved filehandle.  With the exception
        of READDIR, these operations represent the point at which
        the client can instantiate a filehandle into the
        current filehandle at the server.  The filehandle is either provided
        by the client (PUTFH, PUTPUBFH, PUTROOTFH) or generated as a
        result of a name-to-filehandle translation (LOOKUP and OPEN).
        RESTOREFH is treated differently because the filehandle is a result of a
        previous SAVEFH.  Even though the filehandle, for RESTOREFH,
        might have previously passed the server's inspection for a
        security match, the server will check it again on RESTOREFH
        to ensure that the security policy has not changed.<a href="#section-15.5.5-2" class="pilcrow">¶</a></p>
<p id="section-15.5.5-3">
        If the client is to resolve an error return of
        NFS4ERR_WRONGSEC, the following will occur:<a href="#section-15.5.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.5-4.1">
              <p id="section-15.5.5-4.1.1">
            For LOOKUP and OPEN, the client will use SECINFO with the
            same current filehandle and name as provided in the original
            LOOKUP or OPEN to determine the acceptable combinations of
     transport types, transport restrictions,  and flavor-based 
     triple use to make requests directed at the specified portion
     of the server namespace.<a href="#section-15.5.5-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.5-4.2">
              <p id="section-15.5.5-4.2.1">
            For LINK, PUTFH, RENAME, and RESTOREFH, the client will
            use SECINFO and provide the parent directory filehandle and
            the object name that corresponds to the filehandle originally
            provided by the PUTFH or RESTOREFH, or, for LINK and RENAME,
            the SAVEFH.<a href="#section-15.5.5-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.5-4.3">
              <p id="section-15.5.5-4.3.1">
            For LOOKUPP, PUTROOTFH, and PUTPUBFH, the client will be unable
            to use the SECINFO operation since SECINFO requires a
            current filehandle and none exist for these three operations.
            Therefore, the client must iterate through the security
            triples expected to be available at the client for use by the
     current connection (i.e, because they are
     <span class="bcp14">REQUIRED</span> and attempt the
            PUTROOTFH or PUTPUBFH operation repeatedly, once for each possible
     triple.  In the unfortunate event
            that none of the MANDATORY security triples are supported by
            the client and server, the client should try using others that
     are believed to be available.  It is desirable to do so
     in a manner which provides encryption or at least integrity
            support integrity.   Often his will be possible if the
     connection is encrypted.  In other cases. the client can try using
            AUTH_NONE, but because such forms lack integrity checks,
            there is an element of risk in doing so.  However the risk can be
     made small if the server returns NFS4ERR_WRONGSEC when entering any
     subdirectory of the root or public filehandle.<a href="#section-15.5.5-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-15.5.5-5">
        The READDIR operation will not directly return the
        NFS4ERR_WRONGSEC error.  However, if the READDIR request
        included a request for attributes, it is possible that the
        READDIR request's security triple does not match that of
        a directory entry.  If this is the case and the client has
        requested the rdattr_error attribute, the server will return
        the NFS4ERR_WRONGSEC error in rdattr_error for the entry.
 This will allow SECINFO to be issued for that entry with
 the same current file handle as used for the READDIR and a name
 derived from the entry for which the error was noted.<a href="#section-15.5.5-5" class="pilcrow">¶</a></p>
<p id="section-15.5.5-6">
 [Author Aside]: The following paragraph seems dubious since
 it would best if the server tells the client to use, rather
 than leaving him to guess, and the server will know what he
 supports.  Would like to delete this as part of Consensus
 Item #47a, unless compatibility
 issues make that impossible.<a href="#section-15.5.5-6" class="pilcrow">¶</a></p>
<p id="section-15.5.5-7">
 [Previous Treatment (Item #47a)]:
        Note that a server MAY use the AUTH_NONE flavor to signify that
        the client is allowed to attempt to use authentication flavors
        that are not explicitly listed in the SECINFO results.
        Instead of using a listed flavor, the client might then,
        for instance, opt to use an otherwise unlisted RPCSEC_GSS
        mechanism instead of AUTH_NONE. It may wish to do so in order
        to meet an application requirement for data integrity or privacy.
        In choosing to use an unlisted flavor, the client SHOULD always
        be prepared to handle a failure by falling back to using AUTH_NONE
        or another listed flavor. It cannot assume that identity mapping
        is supported and should be prepared for the fact that its identity
        is squashed.<a href="#section-15.5.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-secinfo-impl1">
<section id="section-15.5.6">
          <h4 id="name-secinfo-implementation-for-n">
<a href="#section-15.5.6" class="section-number selfRef">15.5.6. </a><a href="#name-secinfo-implementation-for-n" class="section-name selfRef">SECINFO IMPLEMENTATION (for NFSv4.1 and v4.2)</a>
          </h4>
<p id="section-15.5.6-1">
          [Author Aside]: All unannotated paragraphs in this section are
          considered to be part of Consensus Item #33f.<a href="#section-15.5.6-1" class="pilcrow">¶</a></p>
<p id="section-15.5.6-2">
          As mentioned, the server's security
          policies will determine when a client
          request receives NFS4ERR_WRONGSEC.<a href="#section-15.5.6-2" class="pilcrow">¶</a></p>
<p id="section-15.5.6-3">
   See
          Table 14 of <span>[<a href="#RFC8881" class="xref">8</a>]</span> for a list of operations
          that can return NFS4ERR_WRONGSEC. in the case of v4.2, there
   might be extensions allowed to return NFS4ERR_WRONGSEC.  In addition,
          when READDIR returns attributes, the rdattr_error
          (Section 5.8.1.12 of <span>[<a href="#RFC8881" class="xref">8</a>]</span>)
          can contain NFS4ERR_WRONGSEC.<a href="#section-15.5.6-3" class="pilcrow">¶</a></p>
<p id="section-15.5.6-4">
   Note that CREATE and
          REMOVE MUST NOT return NFS4ERR_WRONGSEC. The
          rationale for CREATE is that unless the
          target name exists, it cannot have a separate
          security policy from the parent directory,
          and the security policy of the parent was
          checked when its filehandle was injected into
          the COMPOUND request's operations stream (for
          similar reasons, an OPEN operation that creates
          the target MUST NOT return NFS4ERR_WRONGSEC). If
          the target name exists, while it might have a
          separate security policy, that is irrelevant
          because CREATE MUST return NFS4ERR_EXIST.
          The rationale for REMOVE is that while that
          target might have a separate security policy, the
          target is going to be removed, and so the
          security policy of the parent trumps that of the
          object being removed. RENAME and LINK MAY return
          NFS4ERR_WRONGSEC, but the NFS4ERR_WRONGSEC error
          applies only to the saved filehandle (see
   Section 2.6.3.1.2 of <span>[<a href="#RFC8881" class="xref">8</a>]</span>). Any NFS4ERR_WRONGSEC
          error on the current filehandle used by LINK and
          RENAME MUST be returned by the PUTFH, PUTPUBFH,
          PUTROOTFH, or RESTOREFH operation that injected
          the current filehandle.<a href="#section-15.5.6-4" class="pilcrow">¶</a></p>
<p id="section-15.5.6-5">
          With the exception of LINK and RENAME,
          the set of operations that can return NFS4ERR_WRONGSEC
          represents the point at which the client can inject a
          filehandle into the "current filehandle" at the server.  The
          filehandle is either provided by the client (PUTFH, PUTPUBFH,
          PUTROOTFH), generated as a result of a name-to-filehandle
          translation (LOOKUP and OPEN), or generated from the saved filehandle
          via RESTOREFH. As Section 2.6.3.1.1.1 of <span>[<a href="#RFC8881" class="xref">8</a>]</span>
   states,
          a put filehandle operation followed by SAVEFH MUST NOT
          return NFS4ERR_WRONGSEC. Thus, the RESTOREFH operation, under
          certain conditions (see Section 2.6.3.1.1 of
   <span>[<a href="#RFC8881" class="xref">8</a>]</span>), is
          permitted to return NFS4ERR_WRONGSEC so that security policies
          can be honored.<a href="#section-15.5.6-5" class="pilcrow">¶</a></p>
<p id="section-15.5.6-6">
          The READDIR operation will not directly return the
          NFS4ERR_WRONGSEC error.  However, if the READDIR request
          included a request for attributes, it is possible that the
          READDIR request's security triple did not match that of a
          directory entry.  If this is the case and the client has
          requested the rdattr_error attribute, the server will return the
          NFS4ERR_WRONGSEC error in rdattr_error for the entry.<a href="#section-15.5.6-6" class="pilcrow">¶</a></p>
<p id="section-15.5.6-7">
          To resolve an error return of
          NFS4ERR_WRONGSEC, the client does the following:<a href="#section-15.5.6-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.6-8.1">
              <p id="section-15.5.6-8.1.1">
              For LOOKUP and OPEN, the client will use SECINFO with the
              same current filehandle and name as provided in the
              original LOOKUP or OPEN to enumerate the available security
              triples.<a href="#section-15.5.6-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.6-8.2">
              <p id="section-15.5.6-8.2.1">
              For the rdattr_error, the client will use
              SECINFO with the same current filehandle
              as provided in the original READDIR. The
              name passed to SECINFO will be that of the
              directory entry (as returned from READDIR)
              that had the NFS4ERR_WRONGSEC error in the
              rdattr_error attribute.<a href="#section-15.5.6-8.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.6-8.3">
              <p id="section-15.5.6-8.3.1">
              For PUTFH, PUTROOTFH, PUTPUBFH,
              RESTOREFH, LINK, and RENAME, the client will
              use SECINFO_NO_NAME { style =
              SECINFO_STYLE4_CURRENT_FH }. The client
              will prefix the SECINFO_NO_NAME operation
              with the appropriate PUTFH, PUTPUBFH,
              or PUTROOTFH operation that provides the
              filehandle originally provided by the PUTFH,
              PUTPUBFH, PUTROOTFH, or RESTOREFH operation.<a href="#section-15.5.6-8.3.1" class="pilcrow">¶</a></p>
<p id="section-15.5.6-8.3.2">
              NOTE: In NFSv4.0, the client was required
              to use SECINFO, and had to reconstruct the
              parent of the original filehandle and the
              component name of the original filehandle. The
              introduction in NFSv4.1 of SECINFO_NO_NAME
              obviates the need for reconstruction.<a href="#section-15.5.6-8.3.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.6-8.4">
              <p id="section-15.5.6-8.4.1">
              For LOOKUPP, the client will
              use SECINFO_NO_NAME { style =
              SECINFO_STYLE4_PARENT } and provide the
              filehandle that equals the filehandle
              originally provided to LOOKUPP.<a href="#section-15.5.6-8.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="FUTURE">
<section id="section-16">
      <h2 id="name-future-security-needs">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-future-security-needs" class="section-name selfRef">Future Security Needs</a>
      </h2>
<p id="section-16-1">
      [Author Aside]:  All unannotated paragraphs in this section are
      considered part of Consensus Item #35a.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">
      [Author Aside]:  This section is basically an outline
      for now, to be filled out later based on Working Group input,
      particularly from Chuck Lever who suggested this section and has ideas
      about many of the items in it.<a href="#section-16-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16-3.1">
          <p id="section-16-3.1.1">
 Security for data-at-rest, most probably based on facilities defined
 within SAN.<a href="#section-16-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-16-3.2">
          <p id="section-16-3.2.1">
 Support for content signing.<a href="#section-16-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-16-3.3">
          <p id="section-16-3.3.1">
 Revision/extension of labelled NFS to provide true interoperability
 and server-based authorization.<a href="#section-16-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-16-3.4">
          <p id="section-16-3.4.1">
 Work to provide more security for RDMA-based transports.  This would
 include the peer authentication infrastructure now being developed
 as part of RPC-over-RDMA version 2.   In addition, there is a need
 for an RPC-based transport that provides for encryption, which might
 be provided in  number of ways.<a href="#section-16-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-16-3.5">
          <p id="section-16-3.5.1">
 Work, via extensions, to provide attributes describing server
 behavior to the client.   This is likely to have an important
 role in resolving security issues connected with ACLs where
 there is both a new preferred approach together with legacy
 implementations built when the specifications wither offered no
 preferred approach or treated that preference as easily
 dispensed with.<a href="#section-16-3.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="SECCON">
<section id="section-17">
      <h2 id="name-security-considerations">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="SECCON-changes">
<section id="section-17.1">
        <h3 id="name-changes-in-security-conside">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-changes-in-security-conside" class="section-name selfRef">Changes in Security Considerations</a>
        </h3>
<p id="section-17.1-1">
 Beyond the needed inclusion of a threat analysis and the fact that
 all minor versions are dealt with together, there are a number of
 substantive changes in the approach to NFSv4 security presented
 in RFCs 7530 and 8881 and that appearing in this document.<a href="#section-17.1-1" class="pilcrow">¶</a></p>
<p id="section-17.1-2">
        This document will not seek to speculate how the previous treatment,
 now viewed as incorrect, came to be written, approved, and published.
 However, it will, for the benefit of those familiar with the
 previous treatment of these matters, draw attention to the
 important changes listed here.<a href="#section-17.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.1-3.1">
            <p id="section-17.1-3.1.1">
   There is a vastly expanded range of threats being considered
   as described in <a href="#SECCON-changes-wider" class="xref">Section 17.1.1</a><a href="#section-17.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-17.1-3.2">
            <p id="section-17.1-3.2.1">
   New facilities available at the RPC transport level can be used
   to deal with security issues, as described in 
   <a href="#SECCON-changes-xport" class="xref">Section 17.1.2</a><a href="#section-17.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="SECCON-changes-wider">
<section id="section-17.1.1">
          <h4 id="name-wider-view-of-threats">
<a href="#section-17.1.1" class="section-number selfRef">17.1.1. </a><a href="#name-wider-view-of-threats" class="section-name selfRef">Wider View of Threats</a>
          </h4>
<p id="section-17.1.1-1">    
   Although the absence of a threat analysis in previous treatments
   makes comparison most difficult, the security-related features
   described in previous specifications and the associated discussion
   in their security considerations sections makes it clear that
   earlier specifications took a quite narrow view of threats to
   be protected against.<a href="#section-17.1.1-1" class="pilcrow">¶</a></p>
<p id="section-17.1.1-2">
   One aspect of that narrow view that merits special attention is
   the handling of AUTH_SYS, at that time in the clear, with no client
   peer authentication.<a href="#section-17.1.1-2" class="pilcrow">¶</a></p>
<p id="section-17.1.1-3">    
   With regard to specific threats, there is no mention in existing
   security consideration sections of:<a href="#section-17.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.1.1-4.1">
              <p id="section-17.1.1-4.1.1">
       Denial-of-service attacks.<a href="#section-17.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.1-4.2">
              <p id="section-17.1.1-4.2.1">
     Client-impersonation attacks.<a href="#section-17.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.1-4.3">
              <p id="section-17.1.1-4.3.1">
     Server-impersonation attacks.<a href="#section-17.1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-17.1.1-5">
   The handling of data security in-flight is even more troubling.<a href="#section-17.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.1.1-6.1">
              <p id="section-17.1.1-6.1.1">
     Although there was considerable work in the protocol to allow
     use of encryption to be negotiated when using RPCSEC_GSS. The
     existing security considerations do not mention the potential
     need for encryption at all.<a href="#section-17.1.1-6.1.1" class="pilcrow">¶</a></p>
<p id="section-17.1.1-6.1.2">
     It is not clear why this was omitted but it is a pattern that
     cannot repeated in this document.<a href="#section-17.1.1-6.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.1-6.2">
              <p id="section-17.1.1-6.2.1">
     The case of negotiation of integrity services is similar and uses
     the same negotiation infrastructure.<a href="#section-17.1.1-6.2.1" class="pilcrow">¶</a></p>
<p id="section-17.1.1-6.2.2">
     In this case, use of integrity is recommended but not to prevent
     the corruption of user data being read or written.<a href="#section-17.1.1-6.2.2" class="pilcrow">¶</a></p>
<p id="section-17.1.1-6.2.3">
     The use of integrity services is recommended in connection with
     issuing SECINFO (and for NFSv4.1, SECINFO_NONAME).  The presence
     of this recommendation in the associated security considerations
     sections has the unfortunate effect of suggesting that the
     protection of user data is of relatively low importance.<a href="#section-17.1.1-6.2.3" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="SECCON-changes-xport">
<section id="section-17.1.2">
          <h4 id="name-transport-layer-security-fa">
<a href="#section-17.1.2" class="section-number selfRef">17.1.2. </a><a href="#name-transport-layer-security-fa" class="section-name selfRef">Transport-layer Security Facilities</a>
          </h4>
<p id="section-17.1.2-1">
   Such transport-level RPC facilities as RPC-over-TLS provide
   important ways of proving better security for all the NFSv4
   minor versions.<a href="#section-17.1.2-1" class="pilcrow">¶</a></p>
<p id="section-17.1.2-2">
   In particular:<a href="#section-17.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.1.2-3.1">
              <p id="section-17.1.2-3.1.1">
     The presence of encryption by default will deal with security
     issue regarding data-in-flight, for both RPCSEC_GSS and AUTH_SYS.<a href="#section-17.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.2-3.2">
              <p id="section-17.1.2-3.2.1">
     Peer authentication provided by the server eliminates the
     possibility of a server-impersonation attack, even when using
     AUTH_SYS.<a href="#section-17.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.2-3.3">
              <p id="section-17.1.2-3.3.1">
     When mutual authentication is part of connection establishment,
     there is a possibility, where an appropriate trust relationship
     exists, of treating the userid's presented in AUTH_SYS, as
     effectively authenticated, based on the authentication of the
     client peer.<a href="#section-17.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="SECCON-changes-diverge">
<section id="section-17.1.3">
          <h4 id="name-approach-to-implementation-">
<a href="#section-17.1.3" class="section-number selfRef">17.1.3. </a><a href="#name-approach-to-implementation-" class="section-name selfRef">Approach to Implementation Semantic Divergences</a>
          </h4>
<p id="section-17.1.3-1">
   [Consensus Needed (Items #36a, #37a)]: For a variety of reasons,
   there are many cases in which one approach to security is
   preferred where others are allowed, if only to give time
   for implementers to adapt to the preferred approach. In
   such cases the word "<span class="bcp14">SHOULD</span> is used to
   introduce the preferred while others are allowed to allow
   compatibility by limiting the valid reasons to bypass the
   recommendation.  Such instances fall into two classes:<a href="#section-17.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.1.3-2.1">
              <p id="section-17.1.3-2.1.1">
     [Consensus Needed (Item #36a)]: In adapting to the
     availability of security services provided by the
     RPC transport, allowance has been made for implementations
     for which these new transport are not available and for
     which, based on previous standards-track guidance,
     AUTH_SYS us used, in the clear, without client-peer
     authentication.<a href="#section-17.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.3-2.2">
              <p id="section-17.1.3-2.2.1">
     [Consensus Needed (Item #37a)]: In dealing  with
     server implementations that support both ACLs and the
     mode attribute, previous specifications have allowed
     a wide range of
     possible server behavior in coordinating these attributes.
     While now clearly defining the recommended behavior in
     dealing with these issues, allowance has been made to
     give times for implementations to conform to the new
     recommendations.<a href="#section-17.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-17.1.3-3">
   [Consensus Needed (Items #36a, #37a)]:  The threat analysis
   within this Security Considerations section will not deal
   with older servers for which allowance has been made but
   will explore the consequences of the recommendations made
   in this document.<a href="#section-17.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-changes-compat">
<section id="section-17.1.4">
          <h4 id="name-compatibility-and-maturity-">
<a href="#section-17.1.4" class="section-number selfRef">17.1.4. </a><a href="#name-compatibility-and-maturity-" class="section-name selfRef">Compatibility and Maturity Issues</a>
          </h4>
<p id="section-17.1.4-1">
   [Author Aside]: All unannotated paragraphs within this section
   are considered part of Consensus Item #38a.<a href="#section-17.1.4-1" class="pilcrow">¶</a></p>
<p id="section-17.1.4-2">
          Given the need to drastically change the NFSv4 security approach
   from that specified previously, it is necessary for us to be
   mindful of:<a href="#section-17.1.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.1.4-3.1">
              <p id="section-17.1.4-3.1.1">
     The difficulty that might be faced in adapting to the newer
     guidance because the delays involved in designing, developing,
     and testing new transport- level security facilities such as
     RPC-over-TLS.<a href="#section-17.1.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.4-3.2">
              <p id="section-17.1.4-3.2.1">
     The difficulty in discarding or substantially modifying
     previous existing deployments and practices, developed on the
     basis of previous normative guidance.<a href="#section-17.1.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-17.1.4-4">    
          For these reasons, we will not use the term "<span class="bcp14">MUST NOT</span>"
   in some situations in which the use of that term might have been
   justified earlier.  In such cases, previous guidance together with
   the passage of time may have created a situation in which the
   considerations mentioned above in this section may be valid reasons
   to defer, for
   a limited time,
   correction of the current situation making the term
   "<span class="bcp14">SHOULD NOT</span>" appropriate, since the difficulties
   cited would constitute a valid reason to not allow what had been
   recommended against.<a href="#section-17.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-changes-authsys">
<section id="section-17.1.5">
          <h4 id="name-discussion-of-auth_sys">
<a href="#section-17.1.5" class="section-number selfRef">17.1.5. </a><a href="#name-discussion-of-auth_sys" class="section-name selfRef">Discussion of AUTH_SYS</a>
          </h4>
<p id="section-17.1.5-1">
   [Author Aside]: All unannotated paragraphs within this section
   are considered part of Consensus Item #39a.<a href="#section-17.1.5-1" class="pilcrow">¶</a></p>
<p id="section-17.1.5-2">
   An important change concerns the treatment of AUTH_SYS which is now
   divided into two distinct cases given the possible availability of
   support from the transport layer.<a href="#section-17.1.5-2" class="pilcrow">¶</a></p>
<p id="section-17.1.5-3">
   When such support is not available, AUTH_SYS
   <span class="bcp14">SHOULD NOT</span> be used, since it makes the following
   attacks quite easy to execute:<a href="#section-17.1.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.1.5-4.1">
              <p id="section-17.1.5-4.1.1">
     The absence of authentication of the server to the client
     allow server impersonation in which an imposter server can
     obtain data to be written by the user and supply corrupted data
     to read requests.<a href="#section-17.1.5-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.5-4.2">
              <p id="section-17.1.5-4.2.1">
     The absence of authentication of the client user to the server
     allow server impersonation in which an imposter client can
     issue requests and have them executed as a user designated by
     imposter client, vitiating the server's authorization policy.<a href="#section-17.1.5-4.2.1" class="pilcrow">¶</a></p>
<p id="section-17.1.5-4.2.2">
     With no authentication of the client peer, common approaches,
     such as using the source IP address can be easily defeated,
     allowing unauthenticated execution of requests made by the
     pseudo clients<a href="#section-17.1.5-4.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-17.1.5-4.3">
              <p id="section-17.1.5-4.3.1">
     The absence of any support to protect data-in-flight when AUTH_SYS
     is used result in further serious security weaknesses.<a href="#section-17.1.5-4.3.1" class="pilcrow">¶</a></p>
<p id="section-17.1.5-4.3.2"></p>
<p id="section-17.1.5-4.3.3"></p>
</li>
          </ul>
<p id="section-17.1.5-5">
   In connection with the use of the term "<span class="bcp14">SHOULD NOT</span>"
   above, it is understood that the "valid reasons" to use this form
   of access reflect the Compatibility and Maturity Issue discussed
   above in <a href="#SECCON-changes-compat" class="xref">Section 17.1.4</a> and that it is
   expected that, over time, these will become less applicable.<a href="#section-17.1.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SECCON-scope">
<section id="section-17.2">
        <h3 id="name-security-considerations-sco">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-security-considerations-sco" class="section-name selfRef">Security Considerations Scope</a>
        </h3>
<div id="SECCON-scope-levels">
<section id="section-17.2.1">
          <h4 id="name-discussion-of-potential-cla">
<a href="#section-17.2.1" class="section-number selfRef">17.2.1. </a><a href="#name-discussion-of-potential-cla" class="section-name selfRef">Discussion of Potential Classification of Environments</a>
          </h4>
<p id="section-17.2.1-1">
   [Author Aside]: All unannotated paragraphs within this section
   are considered part of Consensus Item #40a.<a href="#section-17.2.1-1" class="pilcrow">¶</a></p>
<p id="section-17.2.1-2">
   This document will not consider
   different security policies for different sorts of environments.
   This is because,<a href="#section-17.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-17.2.1-3.1">
     Doing so would add considerable complexity to this document.<a href="#section-17.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-17.2.1-3.2">
     The additional complexity would undercut our main goal here, which
     is to discuss secure use on the internet, which remain an
     important NFSv4 goal.<a href="#section-17.2.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-17.2.1-3.3">
     The ubiquity of internet access makes it hard to treat corporate
     network separately from the internet per se.<a href="#section-17.2.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-17.2.1-3.4">
     While small networks might be sufficiently isolated to make
     it reasonable use NFSv4 without serious attention to
     security issues, the complexity of characterizing the necessary
     isolation makes it impractical to deal with such cases in this
     document.<a href="#section-17.2.1-3.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="SECCON-scope-env">
<section id="section-17.2.2">
          <h4 id="name-discussion-of-environments">
<a href="#section-17.2.2" class="section-number selfRef">17.2.2. </a><a href="#name-discussion-of-environments" class="section-name selfRef">Discussion of Environments</a>
          </h4>
<p id="section-17.2.2-1">
   [Author Aside]: All unannotated paragraphs within this section
   are considered part of Consensus Item #40b.<a href="#section-17.2.2-1" class="pilcrow">¶</a></p>
<p id="section-17.2.2-2">
   Although the security goal for Nfsv4 has been and remains
   "secure use on the internet", much use of NFSv4 occurs on more
   restricted IP networks with NFS access from outside the owning
   organization prevented by firewalls.<a href="#section-17.2.2-2" class="pilcrow">¶</a></p>
<p id="section-17.2.2-3">
   This security considerations section will not deal separately
   with such environments since the threats that need to be discussed
   are essentially the same, despite the assumption by many that
   the restricted network access would eliminate the possibility
   of attacks originating inside the network by attackers who have
   some legitimate Nfsv4 access within it.<a href="#section-17.2.2-3" class="pilcrow">¶</a></p>
<p id="section-17.2.2-4">
          In organizations of significant size, this sort of assumption of
   trusted access is usually not valid and this document will not
   deal with them explicitly.  In any case, there is little point in
   doing so, since, if everyone can be trusted, there can be no
   attackers, rendering threat analysis superfluous.<a href="#section-17.2.2-4" class="pilcrow">¶</a></p>
<p id="section-17.2.2-5">
   This does not mean that NFSv4 use cannot, as a practical matter,
   be made secure through means outside the scope of this document
   including strict administrative controls on all software running
   within it, frequent polygraph tests, and threats of prosecution.
   However, this document is not prepared to discuss the details of 
   such policies, their implementation, or legal issues associated
   with them and treats
   such matters as out-of-scope.<a href="#section-17.2.2-5" class="pilcrow">¶</a></p>
<p id="section-17.2.2-6">
   Nfsv4 can be used in very restrictive IP network environments
   where outside access is quite restricted and there is sufficient
   trust to allow, for example, every node to have the same root
   password. The case of a simple network only accessible by a
   single user is similar.  In such networks, many thing that this
   document says "SHOULD NOT" be done are unexceptionable but the
   responsibility for making that determination is one for those
   creating such networks to take on. This document will not deal
   further with NFSv4 use on such networks.<a href="#section-17.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SECCON-major">
<section id="section-17.3">
        <h3 id="name-major-new-recommendations">
<a href="#section-17.3" class="section-number selfRef">17.3. </a><a href="#name-major-new-recommendations" class="section-name selfRef">Major New Recommendations</a>
        </h3>
<div id="SECCON-major-data">
<section id="section-17.3.1">
          <h4 id="name-recommendations-regarding-s">
<a href="#section-17.3.1" class="section-number selfRef">17.3.1. </a><a href="#name-recommendations-regarding-s" class="section-name selfRef">Recommendations Regarding Security of Data in Flight</a>
          </h4>
<p id="section-17.3.1-1">
   [Author Aside]: All unannotated paragraphs within this section
   are considered part of Consensus Item #41a.<a href="#section-17.3.1-1" class="pilcrow">¶</a></p>
<p id="section-17.3.1-2">
          It is RECOMMENDED that requesters always issue requests with data
   security (i.e. with protection from disclosure or modification
   in flight) whether provided at the RPC request level or by the
   RPC transport, irrespective of the responder's requirements.<a href="#section-17.3.1-2" class="pilcrow">¶</a></p>
<p id="section-17.3.1-3">
          It is RECOMMENDED that implementers provide servers the ability
   to configure policies in which requests without data security
   will be rejected as having insufficient security.<a href="#section-17.3.1-3" class="pilcrow">¶</a></p>
<p id="section-17.3.1-4">
          it is RECOMMENDED that servers use such policies over either their
   entire local namespace or for all file systems except those
   clearly designed for the general dissemination of non-sensitive data.<a href="#section-17.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-major-cpeer">
<section id="section-17.3.2">
          <h4 id="name-recommendations-regarding-c">
<a href="#section-17.3.2" class="section-number selfRef">17.3.2. </a><a href="#name-recommendations-regarding-c" class="section-name selfRef">Recommendations Regarding Client Peer Authentication</a>
          </h4>
<p id="section-17.3.2-1">
   [Author Aside]: All unannotated paragraphs within this section
   are considered part of Consensus Item #41b.<a href="#section-17.3.2-1" class="pilcrow">¶</a></p>
<p id="section-17.3.2-2">
          It is RECOMMENDED that clients provide authentication material
   whenever a connection is established with a server capable
   of using it to provide client peer authentication.<a href="#section-17.3.2-2" class="pilcrow">¶</a></p>
<p id="section-17.3.2-3">
          It is RECOMMENDED that implementers provide servers the ability to
   configure policies in which attempts to establish connections
   without client peer authentication will be rejected.<a href="#section-17.3.2-3" class="pilcrow">¶</a></p>
<p id="section-17.3.2-4">
          it is RECOMMENDED that servers adopt such policies whenever requests
   not using RPCSEC_GSS are allowed to be executed.<a href="#section-17.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-major-bypass">
<section id="section-17.3.3">
          <h4 id="name-issues-regarding-valid-reas">
<a href="#section-17.3.3" class="section-number selfRef">17.3.3. </a><a href="#name-issues-regarding-valid-reas" class="section-name selfRef">Issues Regarding Valid Reasons to Bypass Recommendations</a>
          </h4>
<p id="section-17.3.3-1">
   [Author Aside]: All unannotated paragraphs within this section
   are considered part of Consensus Item #41c.<a href="#section-17.3.3-1" class="pilcrow">¶</a></p>
<p id="section-17.3.3-2">
          Clearly, the maturity and compatibility issues mentioned in
   <a href="#SECCON-changes-compat" class="xref">Section 17.1.4</a> are valid reasons to
   bypass the above recommendations, as long as these issues
   continue to exist.<a href="#section-17.3.3-2" class="pilcrow">¶</a></p>
<p id="section-17.3.3-3">
   [Author Aside]: The question the working group
   needs to address is whether other valid reasons exist.<a href="#section-17.3.3-3" class="pilcrow">¶</a></p>
<p id="section-17.3.3-4">
   [Author Aside]: In particular, some members of
   the group might feel that the performance cost of encrypted
   transports constitutes, in itself, a valid reason to ignore the
   above recommendations.<a href="#section-17.3.3-4" class="pilcrow">¶</a></p>
<p id="section-17.3.3-5">
          [Author Aside]: I cannot agree and feel that
   accepting that as a valid reason would undercut Nfsv4 security
   improvement, and probably would not be acceptable to the
   security directorate.  However, I do want to work out an a
   generally acceptable compromise.  I propose something along
   the following lines:<a href="#section-17.3.3-5" class="pilcrow">¶</a></p>
<p id="section-17.3.3-6">
          In dealing with these issues it needs to be understood that
   the transport-based encryption facilities are designed to be
   compatible with facilities to offload the work of encryption
   and decryption.  When such facilities are not available, at a
   reasonable cost, to NFSv4 servers and clients anticipating
   heavy use of NFSv4, then the lack of such facilities can be
   considered a valid reason to bypass the above recommendations,
   as long as that situation continues.<a href="#section-17.3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SECCON-data">
<section id="section-17.4">
        <h3 id="name-data-security-threats">
<a href="#section-17.4" class="section-number selfRef">17.4. </a><a href="#name-data-security-threats" class="section-name selfRef">Data Security Threats</a>
        </h3>
<p id="section-17.4-1">
 Will be addressed in a later draft as part of Consensus Item
 #42a.<a href="#section-17.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-auth">
<section id="section-17.5">
        <h3 id="name-authentication-based-threat">
<a href="#section-17.5" class="section-number selfRef">17.5. </a><a href="#name-authentication-based-threat" class="section-name selfRef">Authentication-based threats</a>
        </h3>
<div id="SECCON-auth-sys">
<section id="section-17.5.1">
          <h4 id="name-attacks-based-on-the-use-of">
<a href="#section-17.5.1" class="section-number selfRef">17.5.1. </a><a href="#name-attacks-based-on-the-use-of" class="section-name selfRef">Attacks based on the use of AUTH_SYS</a>
          </h4>
<p id="section-17.5.1-1">
     Will be addressed in a later draft as part of Consensus Item
   #43a.<a href="#section-17.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-auth-mapping">
<section id="section-17.5.2">
          <h4 id="name-attacks-on-name-userid-mapp">
<a href="#section-17.5.2" class="section-number selfRef">17.5.2. </a><a href="#name-attacks-on-name-userid-mapp" class="section-name selfRef">Attacks on Name/Userid Mapping Facilities</a>
          </h4>
<p id="section-17.5.2-1">
     Will be addressed in a later draft as part of Consensus Item
   #44a.<a href="#section-17.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SECCON-denial">
<section id="section-17.6">
        <h3 id="name-disruption-and-denial-of-se">
<a href="#section-17.6" class="section-number selfRef">17.6. </a><a href="#name-disruption-and-denial-of-se" class="section-name selfRef">Disruption and Denial-of-Service Attacks</a>
        </h3>
<div id="SECCON-denial-disrupt">
<section id="section-17.6.1">
          <h4 id="name-attacks-based-on-the-disrup">
<a href="#section-17.6.1" class="section-number selfRef">17.6.1. </a><a href="#name-attacks-based-on-the-disrup" class="section-name selfRef">Attacks Based on the Disruption of Client-Server Shared State</a>
          </h4>
<p id="section-17.6.1-1">
     Will be addressed in a later draft as part of Consensus Item
   #45a.<a href="#section-17.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-denial-resource">
<section id="section-17.6.2">
          <h4 id="name-attacks-based-on-forcing-th">
<a href="#section-17.6.2" class="section-number selfRef">17.6.2. </a><a href="#name-attacks-based-on-forcing-th" class="section-name selfRef">Attacks Based on Forcing the Misuse of Server Resources</a>
          </h4>
<p id="section-17.6.2-1">
     Will be addressed in a later draft as part of Consensus Item
   #46a.<a href="#section-17.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-18">
      <h2 id="name-iana-considerations">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-18-1">
      [Author Aside]: All unannotated paragraphs in this section are
      to be considered part of Consensus Item #33f.<a href="#section-18-1" class="pilcrow">¶</a></p>
<p id="section-18-2">
      Because of the shift from implementing security-related services
      only in connection with RPCSEC_GSS to one in which transport-level
      security has a prominent role, a number if new values need to be
      assigned.<a href="#section-18-2" class="pilcrow">¶</a></p>
<p id="section-18-3">
      These include new authstat values to guide selection of a
      Transports acceptable to both client and server, presented in
      <a href="#IANA-authstat" class="xref">Section 18.1</a> and new pseudo-flavors to be used
      in the process of security negotiation, presented in
      <a href="#IANA-flavors" class="xref">Section 18.2</a>.<a href="#section-18-3" class="pilcrow">¶</a></p>
<div id="IANA-authstat">
<section id="section-18.1">
        <h3 id="name-new-authstat-values">
<a href="#section-18.1" class="section-number selfRef">18.1. </a><a href="#name-new-authstat-values" class="section-name selfRef">New Authstat Values</a>
        </h3>
<p id="section-18.1-1">
 [Author Aside]: All unannotated paragraphs in this section are
 to be considered part of Consensus Item #33g.<a href="#section-18.1-1" class="pilcrow">¶</a></p>
<p id="section-18.1-2">
 The following new authstat values are necessary to enable a
 server to indicate that the server's policy does not allows
 requests to be made on the current connection because of
 security issues associated with the rpc transport.  In the
 event they are received, the client needs to establish a new
 connection.<a href="#section-18.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18.1-3.1">
            <p id="section-18.1-3.1.1">
   The value XP_CRYPT indicates that the server will not support
   access using unencrypted connections while the current connection
   is not encrypted.<a href="#section-18.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.1-3.2">
            <p id="section-18.1-3.2.1">
   The value XP_CPAUTH indicates that the server will not support
   access using connections for which the client peer has not
   authenticated itself as part of connection while the current
   connection has not been set up in that way.<a href="#section-18.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="IANA-flavors">
<section id="section-18.2">
        <h3 id="name-new-authentication-pseudo-f">
<a href="#section-18.2" class="section-number selfRef">18.2. </a><a href="#name-new-authentication-pseudo-f" class="section-name selfRef">New Authentication Pseudo-Flavors</a>
        </h3>
<p id="section-18.2-1">
 [Author Aside]: All unannotated paragraphs in this section are
 to be considered part of Consensus Item #33h.<a href="#section-18.2-1" class="pilcrow">¶</a></p>
<p id="section-18.2-2">
 The new pseudo-flavors described in this section are to be made
 available to allow their
 return as part of the response to SECINFO operation described
 in <a href="#NEGO-secinfo" class="xref">Section 15.5</a> and for similar operations.<a href="#section-18.2-2" class="pilcrow">¶</a></p>
<p id="section-18.2-3">
 The following transport-specifying flavors are to be defined:<a href="#section-18.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18.2-4.1">
            <p id="section-18.2-4.1.1">
   XPT_TCP denotes use of a TCP transport to support to RPC.
   The use of TLS as provided by RPC-with-TLS is orthogonal
   to the transport type,
   as is the use of optional authentication features.  Such
   facilities are treated as transport characteristics.<a href="#section-18.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-18.2-4.1.2">
   When RDMA support is layered on TCP, that fact is not
   relevant to the transport type, which is still XPT_RDMA.<a href="#section-18.2-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-4.2">
            <p id="section-18.2-4.2.1">
   XPT_RDMA denotes use of any version of RPC-over-RDMA to
   support RPC.   Although Version 1 has no security-support,
   future version may have such facilities.<a href="#section-18.2-4.2.1" class="pilcrow">¶</a></p>
<p id="section-18.2-4.2.2">
   In any case, the specification of the presence or need
   for such facilities are handled as transport characteristics.<a href="#section-18.2-4.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-4.3">
            <p id="section-18.2-4.3.1">
   XPT_ALL is currently equivalent to XPT_TCP followed by
   XPT_RDMA.  When new transport types are made available for use
   wit NFSv4, it is intended that<a href="#section-18.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-18.2-5">
 The following transport-restricting flavors are to be defined:<a href="#section-18.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18.2-6.1">
            <p id="section-18.2-6.1.1">
   XPCH_ENCRYPT restrict connections to those providing
   encryption.<a href="#section-18.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-6.2">
            <p id="section-18.2-6.2.1">
   XPCH_SVRAUTH restricts connections allowed  to those that provide,
   at connection time authentication of the server peer.<a href="#section-18.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-6.3">
            <p id="section-18.2-6.3.1">
   XPCH_CLAUTH restricts connections allowed  to those that provide,
   at connection time authentication of the server peer.<a href="#section-18.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-6.4">
            <p id="section-18.2-6.4.1">
   XPCH_PEERAUTH is equivalent to XPCH_SVRAUTH combined
   with XPCH_CLAUTH.<a href="#section-18.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-6.5">
            <p id="section-18.2-6.5.1">
   XPCH_SECURE is equivalent to XPCH_ENCRYPT combined with
   XPCH_PEERAUTH.<a href="#section-18.2-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-18.2-7">
 The follow connection-specifying flavors are to be defined:<a href="#section-18.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18.2-8.1">
            <p id="section-18.2-8.1.1">
   AUTH_TLS is equivalent to XP_TCP combined with
   XPCH_ENCRYPT and XPCH_CLPEERAUTH<a href="#section-18.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-8.2">
            <p id="section-18.2-8.2.1">
   XP_TCP_SECURE is equivalent to XP_TCP combined with
   XPCH_SECURE.<a href="#section-18.2-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-18.2-9">
 The following special flavors are to be defined:<a href="#section-18.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18.2-10.1">
            <p id="section-18.2-10.1.1">
   XPCLEAR reset the state of processing to an empty state.
   This is useful if the current connection type is not usable
   for the specified region of the namespace or if it is
   of lower server preference.<a href="#section-18.2-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-10.2">
            <p id="section-18.2-10.2.1">
   XPBREAK forces the use of a new set transport restrictions,
   separate from previous ones and applying to the same set of
   transport types.<a href="#section-18.2-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-18.2-10.3">
            <p id="section-18.2-10.3.1">
   XPCURRENT specifies that the type of the current connection
   is usable for access, with the preference derived from its
   location in the SECINFO response array.<a href="#section-18.2-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-19">
      <h2 id="name-references">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-19.1">
        <h3 id="name-normative-references">
<a href="#section-19.1" class="section-number selfRef">19.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[1]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2203">[2]</dt>
        <dd>
<span class="refAuthor">Eisler, M.</span>, <span class="refAuthor">Chiu, A.</span>, and <span class="refAuthor">L. Ling</span>, <span class="refTitle">"RPCSEC_GSS Protocol Specification"</span>, <span class="seriesInfo">RFC 2203</span>, <span class="seriesInfo">DOI 10.17487/RFC2203</span>, <time datetime="1997-09" class="refDate">September 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2203">https://www.rfc-editor.org/info/rfc2203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2743">[3]</dt>
        <dd>
<span class="refAuthor">Linn, J.</span>, <span class="refTitle">"Generic Security Service Application Program Interface Version 2, Update 1"</span>, <span class="seriesInfo">RFC 2743</span>, <span class="seriesInfo">DOI 10.17487/RFC2743</span>, <time datetime="2000-01" class="refDate">January 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2743">https://www.rfc-editor.org/info/rfc2743</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5531">[4]</dt>
        <dd>
<span class="refAuthor">Thurlow, R.</span>, <span class="refTitle">"RPC: Remote Procedure Call Protocol Specification Version 2"</span>, <span class="seriesInfo">RFC 5531</span>, <span class="seriesInfo">DOI 10.17487/RFC5531</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5531">https://www.rfc-editor.org/info/rfc5531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[5]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7530">[6]</dt>
        <dd>
<span class="refAuthor">Haynes, T., Ed.</span> and <span class="refAuthor">D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Protocol"</span>, <span class="seriesInfo">RFC 7530</span>, <span class="seriesInfo">DOI 10.17487/RFC7530</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7530">https://www.rfc-editor.org/info/rfc7530</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7531">[7]</dt>
        <dd>
<span class="refAuthor">Haynes, T., Ed.</span> and <span class="refAuthor">D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 External Data Representation Standard (XDR) Description"</span>, <span class="seriesInfo">RFC 7531</span>, <span class="seriesInfo">DOI 10.17487/RFC7531</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7531">https://www.rfc-editor.org/info/rfc7531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8881">[8]</dt>
        <dd>
<span class="refAuthor">Noveck, D., Ed.</span> and <span class="refAuthor">C. Lever</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 Protocol"</span>, <span class="seriesInfo">RFC 8881</span>, <span class="seriesInfo">DOI 10.17487/RFC8881</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8881">https://www.rfc-editor.org/info/rfc8881</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5662">[9]</dt>
        <dd>
<span class="refAuthor">Shepler, S., Ed.</span>, <span class="refAuthor">Eisler, M., Ed.</span>, and <span class="refAuthor">D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 External Data Representation Standard (XDR) Description"</span>, <span class="seriesInfo">RFC 5662</span>, <span class="seriesInfo">DOI 10.17487/RFC5662</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5662">https://www.rfc-editor.org/info/rfc5662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7862">[10]</dt>
        <dd>
<span class="refAuthor">Haynes, T.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 2 Protocol"</span>, <span class="seriesInfo">RFC 7862</span>, <span class="seriesInfo">DOI 10.17487/RFC7862</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7862">https://www.rfc-editor.org/info/rfc7862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7863">[11]</dt>
        <dd>
<span class="refAuthor">Haynes, T.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 2 External Data Representation Standard (XDR) Description"</span>, <span class="seriesInfo">RFC 7863</span>, <span class="seriesInfo">DOI 10.17487/RFC7863</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7863">https://www.rfc-editor.org/info/rfc7863</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nfsv4-rpc-tls">[12]</dt>
      <dd>
<span class="refAuthor">Myklebust, T.</span> and <span class="refAuthor">C. Lever</span>, <span class="refTitle">"Towards Remote Procedure Call Encryption By Default"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nfsv4-rpc-tls-11</span>, <time datetime="2020-11-23" class="refDate">23 November 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-nfsv4-rpc-tls-11">https://datatracker.ietf.org/doc/html/draft-ietf-nfsv4-rpc-tls-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-19.2">
        <h3 id="name-informative-references">
<a href="#section-19.2" class="section-number selfRef">19.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8257">[13]</dt>
      <dd>
<span class="refAuthor">Bensley, S.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Balasubramanian, P.</span>, <span class="refAuthor">Eggert, L.</span>, and <span class="refAuthor">G. Judd</span>, <span class="refTitle">"Data Center TCP (DCTCP): TCP Congestion Control for Data Centers"</span>, <span class="seriesInfo">RFC 8257</span>, <span class="seriesInfo">DOI 10.17487/RFC8257</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8257">https://www.rfc-editor.org/info/rfc8257</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="CHG">
<section id="appendix-A">
      <h2 id="name-changes-made">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-changes-made" class="section-name selfRef">Changes Made</a>
      </h2>
<p id="appendix-A-1">
      This section summarizes the substantive changes between the treatment
      of security in previous minor version specification documents
      (i.e. RFCs 7530 and 8881) and the new treatment applying to NFSv4 as
      a whole.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">
      This is expected to be helpful to implementers familiar with previous
      specifications but also has an important role in verifying the working
      group consensus for these changes and in guiding the search for
      potential compatibility issues.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="CHG-motive">
<section id="appendix-A.1">
        <h3 id="name-motivating-changes">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-motivating-changes" class="section-name selfRef">Motivating Changes</a>
        </h3>
<p id="appendix-A.1-1">
        A number of changes reflect the basic motivation for a new
 treatment of NFSv4 security.  These include the ability to
 obtain privacy and integrity services from the RPC transport
 rather than as a service ancillary to a specific authentication
 flavor.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">
 This motivated a major reorganization of the treatment of
 security together with a needed emphasis on the security of
 data in flight.  In addition, the security negotiation framework
 for NFSv4 has been significantly enhanced to support the
 combined negotiation of authentication-related services and
 transport characteristics.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">
 Despite these major changes there are not expected to be
 compatibility issues between peers supporting secure transport
 characteristics and those without such support.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">
 Another such change was in the treatment of AUTH_SYS, previously
 described, inaccurately, as an "OPTIONAL means of authentication"
 with the unfortunate use of the RFC2119 keyword obscuring the negative
 consequences of the typical use of AUTH_SYS (in the clear;
 without client-peer authentication) for security by enabling the
 execution of unauthenticated requests.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1-5">
        The new treatment avoids the inappropriate use of term
 "authentication" for all activities triggered by the use of RPC
 authentication flavors and clearly distinguishes those flavors
 providing authentication from those providing identification only
 or neither identification nor authentication.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CHG-other">
<section id="appendix-A.2">
        <h3 id="name-other-major-changes">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-other-major-changes" class="section-name selfRef">Other Major Changes</a>
        </h3>
<p id="appendix-A.2-1">
 The need to make the major changes discussed in
 <a href="#CHG-motive" class="xref">Appendix A.1</a> has meant that much text dealing
 with security has needed to be significantly revised or
 rewritten.  As a result of the process, may issues involving
 unclear, inconsistent, or otherwise inappropriate text were
 uncovered and needed to be dealt with.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">
 While the author believes such changes are necessary, the fact
 that we are changing a document adopted by consensus requires
 the working group to be clear about the acceptability of the
 changes.   This applies to both the troublesome issues
 discussed in <a href="#UINTRO-needwork" class="xref">Section 3.4</a> and to the other
 changes included below.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">
 Because of concurrent re-organizations, the ordering of the
 list  follows the text of the current version which may differ
 considerably from that in earlier versions of the I-D.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-4.1">
            <p id="appendix-A.2-4.1.1">
   In order to deal better with the fact that ACLs have multiple uses
   some significant structural changes have been made.<a href="#appendix-A.2-4.1.1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.1.2">
   <a href="#ACL" class="xref">Section 5</a>, a new top-level section describes the
   the structure of ACLs,<a href="#appendix-A.2-4.1.2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.1.3"></p>
<p id="appendix-A.2-4.1.4"></p>
</li>
          <li class="normal" id="appendix-A.2-4.2">
            <p id="appendix-A.2-4.2.1">
   In <a href="#AUTHFA-two" class="xref">Section 7.2</a>,
   makes clear that owner and owner group are essentially
   <span class="bcp14">REQUIRED</span> attributes.<a href="#appendix-A.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-4.3">
            <p id="appendix-A.2-4.3.1">
   Also in <a href="#AUTHFA-two" class="xref">Section 7.2</a>,
   there is added clarity in the discussion of support for multiple
   authorization approaches by
   eliminating use of the subjective term "reasonable semantics".<a href="#appendix-A.2-4.3.1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.3.2">
   In connection with this clarification, we have switched from
   describing the needed co-ordination between modes and acls
   as "goals" to describing them as "requirements" to give
   clients some basis for expecting interopherability in handling
   these issues.<a href="#appendix-A.2-4.3.2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.3.3">
   As a result of this shift to a prescriptive framework applying
   to all minor versions it becomes possible to treat all minor
   versions together.  In earlier versions of this document, it had
   been assumed that NFSv4.0 was free to ignore the relevant
   prescriptions first put forth in RFC 5661 and only needed to
   address the "goals" for this co-ordination.<a href="#appendix-A.2-4.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-4.4">
            <p id="appendix-A.2-4.4.1"></p><a href="#appendix-A.2-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="ISSUES">
<section id="appendix-B">
      <h2 id="name-issues-for-which-consensus-">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-issues-for-which-consensus-" class="section-name selfRef">Issues for which Consensus Needs to be Ascertained</a>
      </h2>
<p id="appendix-B-1">
      The section helps to keep track of specific changes which the
      author has made or intends to make to deal with issues found
      in RFCs 7530 and 7881.  The changes listed here exclude those which
      are clearly editorial but includes some that the author believes are
      editorial but for which the issues are sufficiently complicated that
      working group consensus on the issue is probably necessary.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">
      These changes are presented in the table below, organized into a set
      of "Consensus Items" identified by the numeric code appearing  in
      annotations in the proposed document text.  For each such item, a type
      code is assigned with the following codes defined:<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">
          <p id="appendix-B-3.1.1">
 "NM" denotes a change which is new material that is not purely
 editorial and thus requires Working Group consensus for
 eventual publication.<a href="#appendix-B-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.2">
          <p id="appendix-B-3.2.1">
 "BE" denotes a change which the author believes is editorial but
 for which the change is sufficiently complex that the judgment is best
 confirmed by the Working Group.<a href="#appendix-B-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.3">
          <p id="appendix-B-3.3.1">
 "BC" denotes a change which is a substantive change that the author
 believes is correct.  This does not exclude the possibility of
 compatibility issues becoming an issue but is used to indicate that
 the author believes any such issues are unlikely to prevent
 its eventual acceptance.<a href="#appendix-B-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.4">
          <p id="appendix-B-3.4.1">
 "CI" denotes a change for which the potential for compatibility issues
 is major concern with the expected result that working group
 discussion of change will focus on clarifying our knowledge of how
 existing clients and server deal with the issue and how they might
 be affected by the change or the change modified to accommodate them.<a href="#appendix-B-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.5">
          <p id="appendix-B-3.5.1">
 "NS" denotes a change which represents the author's best effort to
 resolve a difficulty but for which the author is not yet
 confident that it will be adopted in its present form,
 principally because of the possibility of
 troublesome compatibility issues.<a href="#appendix-B-3.5.1" class="pilcrow">¶</a></p>
<p id="appendix-B-3.5.2">
        When the document is promoted to a working group document, there should
        be very few issues in this state and, for each such issue,
 a clear plan to
 address the
 possibility of any compatibility problems, enabling resolution of the
 issue to be reasonably anticipated.<a href="#appendix-B-3.5.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.6">
          <p id="appendix-B-3.6.1">
 "NE" denotes change based on an existing issue in
 the spec
 but for which the replacement text is incomplete and needs further
 elaboration.<a href="#appendix-B-3.6.1" class="pilcrow">¶</a></p>
<p id="appendix-B-3.6.2">
        There will be no changes in this state when promotion to a working group
        document is requested.<a href="#appendix-B-3.6.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.7">
          <p id="appendix-B-3.7.1">
 "WI" denotes a potential change based on an existing issue in
 the spec
 but for which replacement text is not yet available because
 further working group input is necessary before drafting.
 It is expected that replacement text
 will be available in a later draft once that discussion is done.<a href="#appendix-B-3.7.1" class="pilcrow">¶</a></p>
<p id="appendix-B-3.7.2">
        There will be no changes in this state when promotion to a working group
        document is requested.<a href="#appendix-B-3.7.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.8">
          <p id="appendix-B-3.8.1">
 "LD" denotes a potential change based on an existing issue in the
 spec but for which replacement text is not yet available due to
 the press of time.   It is expected that replacement text
 will be available in a later draft.<a href="#appendix-B-3.8.1" class="pilcrow">¶</a></p>
<p id="appendix-B-3.8.2">
        There will be no changes in this state when promotion to a working group
        document is requested.<a href="#appendix-B-3.8.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-4">
      When asterisk is appended to a state of "NM", "BE" or "BE" it
      that there has been adequate working group discussion leading
      one to reasonably expect it will be adopted, without major change,
      in a subsequent document revision.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<p id="appendix-B-5">
      Such general acceptance is not equivalent to a formal
      working group consensus and it not expected to result in major
      changes to the draft document,<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<p id="appendix-B-6">
      On the other hand, once there is a working group consensus with
      regard to a particular issue, the document will be modified to remove
      associated annotations, with the previously conditional text
      appearing just as other document text does.  The issue will be removed
      from this table although it will be mentioned in
      Appendices <a href="#CHG-other" class="xref">A.2</a> or
      <a href="#CHG-motive" class="xref">A.1</a><a href="#appendix-B-6" class="pilcrow">¶</a></p>
<p id="appendix-B-7">
      It is is expected that these designations will change
      as discussion proceeds and new document versions are published.
      It is hoped that most such shifts will be upward in the above list or
      result in the deletion of a pending item, by reaching a consensus to
      accept or reject it.  This would enable, once all items are dealt with,
      an eventual request for publication as an RFC, with this appendix
      having been deleted.<a href="#appendix-B-7" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
        <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">#</th>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
            <th class="text-left" rowspan="1" colspan="1">...References...</th>
            <th class="text-left" rowspan="1" colspan="1">Substance</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">NM*</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.1.3.1">
       #1a in S <a href="#INTRO" class="xref">4</a><a href="#appendix-B-8.2.1.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.1.4.1">
              Outline of new approach to authetication/identification,
       replacing confusion about the matter in previous
       specifications.<a href="#appendix-B-8.2.1.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">NM*</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.2.3.1">
       #2a in S <a href="#INTRO" class="xref">4</a><a href="#appendix-B-8.2.2.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.2.4.1">
              Introduction to and outline of changes needed in
       negotiation framework to support provision of security by the
       RPC transport.<a href="#appendix-B-8.2.2.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">BE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.3.3.1">
       #3a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.3.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.3.4.1">
       Conversion of mask bit descriptions from being about
       "permissions" to being about the action permitted,
       denied, or specified as being audited or generating
       alarms.<a href="#appendix-B-8.2.3.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.4.3.1">
       #4a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.4.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.4.4.1">
              Elimination of uses of <span class="bcp14">SHOULD</span> believed
       inappropriate in <a href="#ACL-maskd" class="xref">Section 5.4</a>.<a href="#appendix-B-8.2.4.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">BE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.5.3.1">
       #5a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.5.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.5.4.1">
              Explicit inclusion of ACCESS as an operation affected in the
       mask bit definitions.<a href="#appendix-B-8.2.5.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.6.3.1">
       #6a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.6.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.6.3.2">
       #6b in S <a href="#ACL-deletes" class="xref">5.6</a><a href="#appendix-B-8.2.6.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.6.3.3">
       #6c in S <a href="#AUTHFA-posix-mode" class="xref">7.3.1</a><a href="#appendix-B-8.2.6.3.3" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.6.4.1">
       New/revised description of the role of the "sticky bit" for
       directories, both with respect to ACL handling and mode
       handling.<a href="#appendix-B-8.2.6.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">BE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.7.3.1">
       #7a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.7.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.7.4.1">
              Clarification of relationship between READ_DATA and EXECUTE.<a href="#appendix-B-8.2.7.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">8</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.8.3.1">
       #8a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.8.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.8.4.1">
              Revised discussion of relationship between WRITE_DATA and
       APPEND_DATA.<a href="#appendix-B-8.2.8.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">9</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.9.3.1">
       #9a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.9.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.9.4.1">
              Clarification of how ADD_DIRECTORY relates to RENAME.<a href="#appendix-B-8.2.9.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.10.3.1">
       #10a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.10.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.10.3.2">
       #10b in S <a href="#ACL-maskr" class="xref">5.5</a><a href="#appendix-B-8.2.10.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.10.4.1">
       Revisions in handling of the masks WRITE_RETENTION and
       WRITE_RETENTION_HOLD.<a href="#appendix-B-8.2.10.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">11</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.11.3.1">
       #11a in S <a href="#ACL-maskd" class="xref">5.4</a><a href="#appendix-B-8.2.11.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.11.3.2">
       #11b in S <a href="#ACL-maskr" class="xref">5.5</a><a href="#appendix-B-8.2.11.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.11.3.3">
       #11c in S <a href="#ACL-aclsupport" class="xref">5.11</a><a href="#appendix-B-8.2.11.3.3" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.11.4.1">
              Explicit recommendation and requirements for mask 
       granularity, replacing the previous treatment which gave
       the server license to ignore most of the previous section,
       placing clients in an unfortunate situation.<a href="#appendix-B-8.2.11.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">12</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.12.3.1">
       #12a in S <a href="#ACL-deletes" class="xref">5.6</a><a href="#appendix-B-8.2.12.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.12.3.2">
       #12b in S <a href="#ACL-deletes-old" class="xref">5.6.1</a><a href="#appendix-B-8.2.12.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.12.4.1">
              Revised treatment of directory entry deletion.<a href="#appendix-B-8.2.12.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">13</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.13.3.1">
       #13a in <a href="#ACL-flags" class="xref">5.7</a><a href="#appendix-B-8.2.13.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.13.4.1">
              Attempt to put some reasonable limits on possible non-support
       (or variations in the support provided) for the ACE flags.
       This is to replace a situation in which the client has no real
       way to deal with the freedom granted to server implementations.<a href="#appendix-B-8.2.13.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">14</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.14.3.1">
       #14a in S <a href="#ACL-aclsupport" class="xref">5.11</a><a href="#appendix-B-8.2.14.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.14.4.1">
              Explicit discussion of the case in which aclsupport is
       not supported.<a href="#appendix-B-8.2.14.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">15</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.15.3.1">
       #15a in S <a href="#ACL-aclsupport" class="xref">5.11</a><a href="#appendix-B-8.2.15.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.15.3.2">
       #15b in S <a href="#AUTHFA-attr" class="xref">7.1</a><a href="#appendix-B-8.2.15.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.15.3.3">
       #15c in S <a href="#AUTHFA-two" class="xref">7.2</a><a href="#appendix-B-8.2.15.3.3" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.15.4.1">
              Handling of the proper relationship between support for
       ALLOW and DENY ACEs.<a href="#appendix-B-8.2.15.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">16</td>
            <td class="text-left" rowspan="1" colspan="1">NM</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.16.3.1">
       #16a in S <a href="#ACL-ace" class="xref">5.1</a><a href="#appendix-B-8.2.16.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.16.4.1">
              Discussion of coherence of acl, sacl, and dacl
       attributes.<a href="#appendix-B-8.2.16.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">17</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.17.3.1">
       #17a in S <a href="#AUTHFA-attr" class="xref">7.1</a><a href="#appendix-B-8.2.17.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.17.3.2">
       #17b in S <a href="#AUTHFA-two" class="xref">7.2</a><a href="#appendix-B-8.2.17.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.17.4.1">
       Relationship of support for ALLOW and DENY ACEs<a href="#appendix-B-8.2.17.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">18</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.18.3.1">
       #18a in S <a href="#AUTHFA-attr" class="xref">7.1</a><a href="#appendix-B-8.2.18.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.18.3.2">
       #18b in S <a href="#AUTHFA-two" class="xref">7.2</a><a href="#appendix-B-8.2.18.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.18.4.1">
       Need for support of owner, owner_group.<a href="#appendix-B-8.2.18.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">19</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.19.3.1">        
       #19a in S <a href="#AUTHFA-two" class="xref">7.2</a><a href="#appendix-B-8.2.19.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.19.4.1">
       Revised discussion of coordination of mode and the ACL-related
       attributes.<a href="#appendix-B-8.2.19.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">20</td>
            <td class="text-left" rowspan="1" colspan="1">WI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.20.3.1">
       #20 in S <a href="#AUTHFA-posix-mode" class="xref">7.3.1</a><a href="#appendix-B-8.2.20.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.20.4.1">
       More closely align ACL_based and mode-based semantics with
       regard to SVTX.<a href="#appendix-B-8.2.20.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">21</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.21.3.1">
       #21a in S <a href="#AUTHFA-posix-mode" class="xref">7.3.1</a><a href="#appendix-B-8.2.21.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.21.3.2">
       #21b in S <a href="#AUTHCOMB-computemode" class="xref">9.3</a><a href="#appendix-B-8.2.21.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.21.3.3">
       #21c in S <a href="#AUTHCOMB-setmode" class="xref">9.6</a><a href="#appendix-B-8.2.21.3.3" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.21.4.1">
              Introduce the concept of reverse-slope modes and deal 
       properly with them.   The decision as to the proper
       handling is addressed as Consensus Item #28.<a href="#appendix-B-8.2.21.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">22</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.22.3.1">
       #22a in S <a href="#AUTHCOMM-server" class="xref">8.1</a><a href="#appendix-B-8.2.22.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.22.4.1">
              Revise treatment of divergences between AC/mode authorization
       and server behavior, dividing the treatment between cases
       in which something authorized  is still not allowed (OK),
       and those in which something not authorized is allowed
       (highly problematic from a security point of view).<a href="#appendix-B-8.2.22.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">23</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.23.3.1">
       #23a in S <a href="#AUTHCOMM-client" class="xref">8.2</a><a href="#appendix-B-8.2.23.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.23.4.1">
       Revise discussion of client access to of ACLs.<a href="#appendix-B-8.2.23.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">24</td>
            <td class="text-left" rowspan="1" colspan="1">BE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.24.3.1">
       #24a in S <a href="#AUTHCOMM-client" class="xref">8.2</a><a href="#appendix-B-8.2.24.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.24.4.1">
              Delete bogus reference.<a href="#appendix-B-8.2.24.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">25</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.25.3.1">
       #25a in S <a href="#UINTRO-feat" class="xref">3.3</a><a href="#appendix-B-8.2.25.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.25.3.2">
       #25b in S <a href="#AUTHCOMB-bg" class="xref">9.1</a><a href="#appendix-B-8.2.25.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.25.3.3">
       #25d in S <a href="#AUTHCOMB-settingacl" class="xref">9.7</a><a href="#appendix-B-8.2.25.3.3" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.25.3.4">
       #25e in S <a href="#AUTHCOMB-fetchattr" class="xref">9.9</a><a href="#appendix-B-8.2.25.3.4" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.25.3.5">
       #25f in S <a href="#AUTHCOMB-aclcreate" class="xref">9.10</a><a href="#appendix-B-8.2.25.3.5" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.25.3.6">
       #25g in S <a href="#AUTHCOMB-inheritreq" class="xref">9.11</a><a href="#appendix-B-8.2.25.3.6" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.25.4.1">
              Revised description of co-ordination of acl and mode
       attributes to apply to NFSv4 as a whole. While this includes
       many aspects of the shift
       to be more specific about the co-ordination
       requirements including addressing apparently
       unmotivated uses of the terms
       "<span class="bcp14">SHOULD</span>" and "<span class="bcp14">SHOULD NOT</span>",
       it excludes some arguably related
       matters dealt with as Consensus Items #26 and #27.<a href="#appendix-B-8.2.25.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">26</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.26.3.1">
       #26a in S <a href="#AUTHCOMB-attr" class="xref">9.2</a><a href="#appendix-B-8.2.26.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.26.3.2">
       #26 in S <a href="#AUTHCOMB-setmode-p" class="xref">9.6.3</a><a href="#appendix-B-8.2.26.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.26.4.1">
              Decide how ACEs with who values other than OWNER@,
       Group, or EVERYONE@ are be dealt with when setting mode.<a href="#appendix-B-8.2.26.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">27</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.27.3.1">
       #27a in S <a href="#AUTHCOMB-attr" class="xref">9.2</a><a href="#appendix-B-8.2.27.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.27.3.2">
       #27b in S <a href="#AUTHCOMB-computemode" class="xref">9.3</a><a href="#appendix-B-8.2.27.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.27.3.3">
       #27c in S <a href="#AUTHCOMB-computealt" class="xref">9.4</a><a href="#appendix-B-8.2.27.3.3" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.27.4.1">
              Concerns the possibility of establishing one way of computing a
       mode from an acl that clients can depend on, rather than two or
       an unbounded number.<a href="#appendix-B-8.2.27.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">28</td>
            <td class="text-left" rowspan="1" colspan="1">WI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.28.3.1">
       #28a in S <a href="#AUTHCOMB-computemode" class="xref">9.3</a><a href="#appendix-B-8.2.28.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.28.3.2">
       #28 in S <a href="#AUTHCOMB-setmode-p" class="xref">9.6.3</a><a href="#appendix-B-8.2.28.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.28.4.1">
              Decide how to address flaws in mapping to/from reverse-
       slope modes.<a href="#appendix-B-8.2.28.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">29</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.29.3.1">
       #29 in S <a href="#AUTHCOMB-setmode-p" class="xref">9.6.3</a><a href="#appendix-B-8.2.29.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.29.4.1">
              Address the coordination of mode and ACL-based attributes
       in  unified way for all minor versions.<a href="#appendix-B-8.2.29.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">30</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.30.3.1">
       #30a in S <a href="#AUTHCOMB-setmode-v" class="xref">9.6.1</a><a href="#appendix-B-8.2.30.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.30.3.2">
       #30b in S <a href="#AUTHCOMB-setmode-d" class="xref">9.6.2</a><a href="#appendix-B-8.2.30.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.30.3.3">
       #30c in S <a href="#AUTHCOMB-setmode-p" class="xref">9.6.3</a><a href="#appendix-B-8.2.30.3.3" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.30.4.1">
              New proposed treatment of setting mode incorporating
       some consequences of anticipated decisions regarding
       other consensus items (#26, #28, #29)<a href="#appendix-B-8.2.30.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">31</td>
            <td class="text-left" rowspan="1" colspan="1">WI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.31.3.1">
       #31a in S <a href="#AUTHCOMB-setmode-p" class="xref">9.6.3</a><a href="#appendix-B-8.2.31.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.31.4.1">
              Need to deal with mask bits ACE4_READ_ATTRIBUTES,
       ACE4_WRITE_RETENTION, ACE4_WRITE_RETENTION_HOLD,
       ACE4_READ_ACL to reflect the semantics of the mode
       attribute.<a href="#appendix-B-8.2.31.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">32</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.32.3.1">
       #32a in S <a href="#NEGO" class="xref">15</a><a href="#appendix-B-8.2.32.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.32.3.2">
       #32b in S <a href="#NEGO-flandpfl" class="xref">15.1</a><a href="#appendix-B-8.2.32.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.32.3.3">
       #32c in S <a href="#NEGO-flavor" class="xref">15.2</a><a href="#appendix-B-8.2.32.3.3" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.32.3.4">
       #32d in S <a href="#NEGO-xports" class="xref">15.3</a><a href="#appendix-B-8.2.32.3.4" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.32.3.5">
       #32e in S <a href="#NEGO-algo" class="xref">15.4</a><a href="#appendix-B-8.2.32.3.5" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.32.4.1">
              Expanded negotiation framework to accomodate multiple
       transport types and services derivable from transport
       characteristics, i.e. encryption and peer authentication.<a href="#appendix-B-8.2.32.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">33</td>
            <td class="text-left" rowspan="1" colspan="1">BE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.33.3.1">
       #33a in S <a href="#NEGO-secinfo" class="xref">15.5</a><a href="#appendix-B-8.2.33.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.33.3.2">
       #33b in S <a href="#NEGO-secinfo-args" class="xref">15.5.1</a><a href="#appendix-B-8.2.33.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.33.3.3">
       #33c in S <a href="#NEGO-secinfo-resulta" class="xref">15.5.2</a><a href="#appendix-B-8.2.33.3.3" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.33.3.4">
       #33d in S <a href="#NEGO-secinfo-descr" class="xref">15.5.3</a><a href="#appendix-B-8.2.33.3.4" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.33.3.5">
       #33e in S <a href="#NEGO-secinfo-impl" class="xref">15.5.4</a><a href="#appendix-B-8.2.33.3.5" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.33.3.6">
       #33f in S <a href="#IANA" class="xref">18</a><a href="#appendix-B-8.2.33.3.6" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.33.3.7">
       #33g in S <a href="#IANA-authstat" class="xref">18.1</a><a href="#appendix-B-8.2.33.3.7" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.33.3.8">
       #33h in S <a href="#IANA-flavors" class="xref">18.2</a><a href="#appendix-B-8.2.33.3.8" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.33.4.1">
              Reorganization of description of SECINFO op to apply
       to all minor versions.  Assumes basics of proposal for
       Item #32.<a href="#appendix-B-8.2.33.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">34</td>
            <td class="text-left" rowspan="1" colspan="1">BC</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.34.3.1">
       #34a in S <a href="#NEGO-secinfo-impl1" class="xref">15.5.6</a><a href="#appendix-B-8.2.34.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.34.4.1">
              Revision to NFSv4.0 SECINFO implementation section to
       be compatible with expanded approach to negotiation.
       Assumes basics of proposals for Items #32 and #33.<a href="#appendix-B-8.2.34.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">35</td>
            <td class="text-left" rowspan="1" colspan="1">NE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.35.3.1">
       #35a in S <a href="#FUTURE" class="xref">16</a><a href="#appendix-B-8.2.35.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.35.4.1">
              Now has preliminary work on future security needs.<a href="#appendix-B-8.2.35.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">36</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.36.3.1">
       #36a in S <a href="#SECCON-changes-diverge" class="xref">17.1.3</a><a href="#appendix-B-8.2.36.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.36.4.1">
              Threat analysis only dealing with RECOMMENDED behavior
       regarding use of transport security facilities and
       handling of AUTH_SYS.<a href="#appendix-B-8.2.36.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">37</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.37.3.1">
       #37a in S <a href="#SECCON-changes-diverge" class="xref">17.1.3</a><a href="#appendix-B-8.2.37.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.37.4.1">
              Threat analysis only dealing with RECOMMENDED behavior
              with regard to acl support including ACL/mode coordination.<a href="#appendix-B-8.2.37.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">38</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.38.3.1">
       #38a in S <a href="#SECCON-changes-compat" class="xref">17.1.4</a><a href="#appendix-B-8.2.38.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.38.4.1">
              Address the need to temporarily allow unsafe behavior
       mistakenly allowed by previous specifications<a href="#appendix-B-8.2.38.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">39</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.39.3.1">
       #39a in S <a href="#SECCON-changes-authsys" class="xref">17.1.5</a><a href="#appendix-B-8.2.39.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.39.4.1">
              Define new approach to AUTH_SYS.<a href="#appendix-B-8.2.39.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">40</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.40.3.1">
       #40a in S <a href="#SECCON-scope-levels" class="xref">17.2.1</a><a href="#appendix-B-8.2.40.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.40.3.2">
       #40a in S <a href="#SECCON-scope-env" class="xref">17.2.2</a><a href="#appendix-B-8.2.40.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.40.4.1">
              Discussion of scope for security considerations and the
       corresponding threat analysis.<a href="#appendix-B-8.2.40.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">41</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.41.3.1">
       #41a in S <a href="#SECCON-major-data" class="xref">17.3.1</a><a href="#appendix-B-8.2.41.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.41.3.2">
       #41b in S <a href="#SECCON-major-cpeer" class="xref">17.3.2</a><a href="#appendix-B-8.2.41.3.2" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.41.3.3">
       #41c in S <a href="#SECCON-major-bypass" class="xref">17.3.3</a><a href="#appendix-B-8.2.41.3.3" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.41.3.4"></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.41.4.1">
              Discuss major new security recommendations regarding
       protection of data in flight and client peer authentication.
       Also, covers the circumstances under which such recommendations
       can be bypassed.<a href="#appendix-B-8.2.41.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">42</td>
            <td class="text-left" rowspan="1" colspan="1">LD</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.42.3.1">
       #42a in S <a href="#SECCON-data" class="xref">17.4</a><a href="#appendix-B-8.2.42.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.42.4.1">
              Placeholder for threat analysis section regarding security of
       data in flight.<a href="#appendix-B-8.2.42.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">43</td>
            <td class="text-left" rowspan="1" colspan="1">LD</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.43.3.1">
       #43a in S <a href="#SECCON-auth-sys" class="xref">17.5.1</a><a href="#appendix-B-8.2.43.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.43.4.1">
              Placeholder for threat analysis section dealing with the
       use of AUTH_SYS.<a href="#appendix-B-8.2.43.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">44</td>
            <td class="text-left" rowspan="1" colspan="1">LD</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.44.3.1">
       #44a in S <a href="#SECCON-auth-mapping" class="xref">17.5.2</a><a href="#appendix-B-8.2.44.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.44.4.1">
              Placeholder for threat analysis section dealing with
       attacks on userid/name mapping.<a href="#appendix-B-8.2.44.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">45</td>
            <td class="text-left" rowspan="1" colspan="1">LD</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.45.3.1">
       #45a in S <a href="#SECCON-denial-disrupt" class="xref">17.6.1</a><a href="#appendix-B-8.2.45.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.45.4.1">
              Placeholder for threat analysis section dealing with
       disruption attacks based on attacks on shared state.<a href="#appendix-B-8.2.45.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">46</td>
            <td class="text-left" rowspan="1" colspan="1">LD</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.46.3.1">
       #46a in S <a href="#SECCON-denial-resource" class="xref">17.6.2</a><a href="#appendix-B-8.2.46.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.46.4.1">
              Placeholder for threat analysis section dealing with
       attacks on shared state design to cause misuse of
       resources.<a href="#appendix-B-8.2.46.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">47</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.47.3.1">
       #47a in S <a href="#NEGO-secinfo-impl0" class="xref">15.5.5</a><a href="#appendix-B-8.2.47.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.47.4.1">
              Dubious paragraph which should be deleted if there
       are no compatibility issues that make that impossible.<a href="#appendix-B-8.2.47.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">48</td>
            <td class="text-left" rowspan="1" colspan="1">CI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.48.3.1">
       #48a in S <a href="#NEGO-algo-ctx" class="xref">15.4.2</a><a href="#appendix-B-8.2.48.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B-8.2.48.3.2">
       #48b in S <a href="#NEGO-algo-flx" class="xref">15.4.3</a><a href="#appendix-B-8.2.48.3.2" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.48.4.1">
              Missing pieces of secinfo processing algorithm that
       didn't get done in -02.<a href="#appendix-B-8.2.48.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">49</td>
            <td class="text-left" rowspan="1" colspan="1">NE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.49.3.1">
       #49a in S <a href="#NEGO-algo-main" class="xref">15.4.1</a><a href="#appendix-B-8.2.49.3.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-8.2.49.4.1">
              Main secinfo processing algorithm that needs to
       finished in -02.<a href="#appendix-B-8.2.49.4.1" class="pilcrow">¶</a></p>
</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-B-9">
      The following table summarizes the issues in each particular
      state, dividing them into those associated with the
      motivating changes for this new document and those that
      derive from other issues, that were uncovered later, once
      work on a new treatment of NFSv4 security had begun.<a href="#appendix-B-9" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
        <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
            <th class="text-left" rowspan="1" colspan="1">Cnt</th>
            <th class="text-left" rowspan="1" colspan="1">Issues</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NM*(M)</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.1.3.1">
       1, 2<a href="#appendix-B-10.2.1.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">BE(M)</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.2.3.1">
       33<a href="#appendix-B-10.2.2.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">BC(M)</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.3.3.1">
       32, 34<a href="#appendix-B-10.2.3.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">CI(M)</td>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.4.3.1">
       36, 38, 39, 40, 41, 47, 48<a href="#appendix-B-10.2.4.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NE(M)</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.5.3.1">
       35, 49<a href="#appendix-B-10.2.5.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">LD(M)</td>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.6.3.1">
       42, 43, 44, 45, 46<a href="#appendix-B-10.2.6.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">All(M)</td>
            <td class="text-left" rowspan="1" colspan="1">19</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.7.3.1">
       As listed above.<a href="#appendix-B-10.2.7.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NM(O)</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.8.3.1">
       16<a href="#appendix-B-10.2.8.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">BE(O)</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.9.3.1">
       3, 5, 7, 24<a href="#appendix-B-10.2.9.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">BC(O)</td>
            <td class="text-left" rowspan="1" colspan="1">12</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.10.3.1">
       9, 10, 12, 13, 14, 15, 17, 18, 21, 22, 23, 29<a href="#appendix-B-10.2.10.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">CI(O)</td>
            <td class="text-left" rowspan="1" colspan="1">11</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.11.3.1">
       4, 6, 8, 11, 19, 25, 26, 27, 28, 30, 37<a href="#appendix-B-10.2.11.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">WI(O)</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.12.3.1">
       20, 31<a href="#appendix-B-10.2.12.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">All(O)</td>
            <td class="text-left" rowspan="1" colspan="1">30</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.13.3.1">
       As described above<a href="#appendix-B-10.2.13.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">*All*</td>
            <td class="text-left" rowspan="1" colspan="1">49</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-B-10.2.14.3.1">
       Grand total for above table.<a href="#appendix-B-10.2.14.3.1" class="pilcrow">¶</a></p>
</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="ACK">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">
      The author wishes to thank Tom Haynes for his helpful suggestion
      to deal with security for all NFSv4 minor versions in the same
      document.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">
      The author wishes to draw people's attention to Nico Williams'
      remark that NFSv4 security was not so bad, except that there was
      no provision for authentication of the client peer.  This
      perceptive remark, which now seems like common sense, did not seem
      so when made, but it has served as a beacon for those putting NFSv4
      security on a firmer footing.  We appreciate this perceptive
      guidance.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">
      The author wishes to acknowledge the important role of the authors
      of RPC-with-TLS, Chuck Lever and Trond Myklebust, in moving the
      NFS security agenda forward and thank them for all their efforts
      to improve NFS security.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">
      The author wishes to thank Chuck Lever for his many helpful
      comments about nfsv4 security issues, his explanation of many
      unclear points, and and much important guidance he provided that
      is reflected in this document.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5">
      The author wishes to thank Rick Macklem for his role in
      clarifying possible server policies regarding RPC-over-TLS
      and bringing possible approaches to the attention of the working group.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Noveck (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">NetApp</span></div>
<div dir="auto" class="left"><span class="street-address">1601 Trapelo Road, Suite 16</span></div>
<div dir="auto" class="left">
<span class="locality">Waltham</span>, <span class="region">MA</span> <span class="postal-code">02451</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1-781-572-8038" class="tel">+1-781-572-8038</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:davenoveck@gmail.com" class="email">davenoveck@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
