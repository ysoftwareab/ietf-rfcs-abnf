<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)">
<meta name="keywords" content="Internet-Draft, PKIX, X.509, certificates, TLS, Transport Layer Security">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">P. Saint-Andre</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">J. Hodges</td></tr>
<tr><td class="header">Expires: June 16, 2011</td><td class="header">PayPal</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">December 13, 2010</td></tr>
</table></td></tr></table>
<h1><br />Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)<br />draft-saintandre-tls-server-id-check-12</h1>

<h3>Abstract</h3>

<p>Many application technologies enable secure communication between two entities by means of Internet Public Key Infrastructure Using X.509 (PKIX) certificates in the context of Transport Layer Security (TLS).  This document specifies best current practices for representing and verifying the identity of application services in such interactions.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on June 16, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#motivation">1.1.</a>&nbsp;
Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#applicability">1.2.</a>&nbsp;
Applicability and Audience<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#overview">1.3.</a>&nbsp;
Overview of Recommendations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scope">1.4.</a>&nbsp;
Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#in-scope">1.4.1.</a>&nbsp;
In Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#out-of-scope">1.4.2.</a>&nbsp;
Out of Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">1.5.</a>&nbsp;
Terminology<br />
<a href="#names">2.</a>&nbsp;
Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#names-apps">2.1.</a>&nbsp;
Naming Application Services<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#names-dns">2.2.</a>&nbsp;
DNS Domain Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#names-pkix">2.3.</a>&nbsp;
Subject Naming in PKIX Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#names-pkix-notes">2.3.1.</a>&nbsp;
Implementation Notes<br />
<a href="#representation">3.</a>&nbsp;
Representation of Server Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#representation-rules">3.1.</a>&nbsp;
Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#representation-examples">3.2.</a>&nbsp;
Examples<br />
<a href="#verify">4.</a>&nbsp;
Verification of Service Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-overview">4.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-reference">4.2.</a>&nbsp;
Constructing a List of Reference Identifiers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-reference-rules">4.2.1.</a>&nbsp;
Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-reference-examples">4.2.2.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-seek">4.3.</a>&nbsp;
Preparing to Seek a Match<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-domain">4.4.</a>&nbsp;
Matching the DNS Domain Name Portion<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-domain-trad">4.4.1.</a>&nbsp;
Checking of Traditional Domain Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-domain-idn">4.4.2.</a>&nbsp;
Checking of Internationalized Domain Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-domain-wildcards">4.4.3.</a>&nbsp;
Checking of Wildcard Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-domain-cn">4.4.4.</a>&nbsp;
Checking of Common Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-app">4.5.</a>&nbsp;
Matching the Application Type Portion<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-app-srv">4.5.1.</a>&nbsp;
SRV-ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-app-uri">4.5.2.</a>&nbsp;
URI-ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-outcome">4.6.</a>&nbsp;
Outcome<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-outcome-matched">4.6.1.</a>&nbsp;
Case #1: Match Found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-outcome-pin">4.6.2.</a>&nbsp;
Case #2: No Match Found, Pinned Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-outcome-nopin">4.6.3.</a>&nbsp;
Case #3: No Match Found, No Pinned Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify-outcome-fallback">4.6.4.</a>&nbsp;
Fallback<br />
<a href="#security">5.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-pinning">5.1.</a>&nbsp;
Pinned Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-wildcards">5.2.</a>&nbsp;
Wildcard Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-idn">5.3.</a>&nbsp;
Internationalized Domain Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-multi">5.4.</a>&nbsp;
Multiple Identifiers<br />
<a href="#iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#contributors">7.</a>&nbsp;
Contributors<br />
<a href="#acknowledgements">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#prior">Appendix&nbsp;A.</a>&nbsp;
Prior Art<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-imap">A.1.</a>&nbsp;
IMAP, POP3, and ACAP (1999)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-http">A.2.</a>&nbsp;
HTTP (2000)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-ldap">A.3.</a>&nbsp;
LDAP (2000/2006)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-smtp">A.4.</a>&nbsp;
SMTP (2002/2007)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-xmpp">A.5.</a>&nbsp;
XMPP (2004)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-nntp">A.6.</a>&nbsp;
NNTP (2006)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-netconf">A.7.</a>&nbsp;
NETCONF (2006/2009)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-syslog">A.8.</a>&nbsp;
Syslog (2009)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-sip">A.9.</a>&nbsp;
SIP (2010)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-snmp">A.10.</a>&nbsp;
SNMP (2010)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-gist">A.11.</a>&nbsp;
GIST (2010)<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<a name="motivation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Motivation</h3>

<p>The visible face of the Internet largely consists of services that employ a client-server architecture in which an interactive or automated client communicates with an application service in order to retrieve or upload information, communicate with other entities, or access a broader network of services.  When a client communicates with an application service using Transport Layer Security <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> or Datagram Transport Layer Security <a class='info' href='#DTLS'>[DTLS]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a>, it references some notion of the server's identity (e.g., "the website at example.com") while attempting to establish secure communication.  Likewise, during TLS negotiation the server presents its notion of the service's identity in the form of a public-key certificate that was issued by a certification authority (CA) in the context of the Internet Public Key Infrastructure using X.509 <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  Informally, we can think of these identities as the client's "reference identity" and the server's "presented identity" (these rough ideas are defined more precisely later in this document through the concept of particular identifiers).  In general, a client needs to verify that the server's presented identity matches its reference identity so it can be sure that the certificate can legitimately be used to authenticate the communication.
</p>
<p>Many application technologies adhere to the pattern just outlined, including but not limited to the following:
</p>
<p>
          </p>
<ul class="text">
<li>The Internet Message Access Protocol <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> and the Post Office Protocol <a class='info' href='#POP3'>[POP3]<span> (</span><span class='info'>Myers, J. and M. Rose, &ldquo;Post Office Protocol - Version 3,&rdquo; May&nbsp;1996.</span><span>)</span></a>, for which see also <a class='info' href='#USINGTLS'>[USINGTLS]<span> (</span><span class='info'>Newman, C., &ldquo;Using TLS with IMAP, POP3 and ACAP,&rdquo; June&nbsp;1999.</span><span>)</span></a><br />
<br />

</li>
<li>The Hypertext Transfer Protocol <a class='info' href='#HTTP'>[HTTP]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>, for which see also <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a><br />
<br />

</li>
<li>The Lightweight Directory Access Protocol <a class='info' href='#LDAP'>[LDAP]<span> (</span><span class='info'>Sermersheim, J., &ldquo;Lightweight Directory Access Protocol (LDAP): The Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>, for which see also <a class='info' href='#LDAP-AUTH'>[LDAP&#8209;AUTH]<span> (</span><span class='info'>Harrison, R., &ldquo;Lightweight Directory Access Protocol (LDAP): Authentication Methods and Security Mechanisms,&rdquo; June&nbsp;2006.</span><span>)</span></a> and its predecessor <a class='info' href='#LDAP-TLS'>[LDAP&#8209;TLS]<span> (</span><span class='info'>Hodges, J., Morgan, R., and M. Wahl, &ldquo;Lightweight Directory Access Protocol (v3): Extension for Transport Layer Security,&rdquo; May&nbsp;2000.</span><span>)</span></a><br />
<br />

</li>
<li>The Simple Mail Transfer Protocol <a class='info' href='#SMTP'>[SMTP]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>, for which see also <a class='info' href='#SMTP-AUTH'>[SMTP&#8209;AUTH]<span> (</span><span class='info'>Siemborski, R. and A. Melnikov, &ldquo;SMTP Service Extension for Authentication,&rdquo; July&nbsp;2007.</span><span>)</span></a> and <a class='info' href='#SMTP-TLS'>[SMTP&#8209;TLS]<span> (</span><span class='info'>Hoffman, P., &ldquo;SMTP Service Extension for Secure SMTP over Transport Layer Security,&rdquo; February&nbsp;2002.</span><span>)</span></a><br />
<br />

</li>
<li>The Extensible Messaging and Presence Protocol <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a>, for which see also <a class='info' href='#XMPP-OLD'>[XMPP&#8209;OLD]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a><br />
<br />

</li>
<li>The Network News Transfer Protocol <a class='info' href='#NNTP'>[NNTP]<span> (</span><span class='info'>Feather, C., &ldquo;Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a>, for which see also <a class='info' href='#NNTP-TLS'>[NNTP&#8209;TLS]<span> (</span><span class='info'>Murchison, K., Vinocur, J., and C. Newman, &ldquo;Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a><br />
<br />

</li>
<li>The NETCONF Configuration Protocol <a class='info' href='#NETCONF'>[NETCONF]<span> (</span><span class='info'>Enns, R., &ldquo;NETCONF Configuration Protocol,&rdquo; December&nbsp;2006.</span><span>)</span></a>, for which see also <a class='info' href='#NETCONF-SSH'>[NETCONF&#8209;SSH]<span> (</span><span class='info'>Wasserman, M. and T. Goddard, &ldquo;Using the NETCONF Configuration Protocol over Secure SHell (SSH),&rdquo; December&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#NETCONF-TLS'>[NETCONF&#8209;TLS]<span> (</span><span class='info'>Badra, M., &ldquo;NETCONF over Transport Layer Security (TLS),&rdquo; May&nbsp;2009.</span><span>)</span></a><br />
<br />

</li>
<li>The Syslog Protocol <a class='info' href='#SYSLOG'>[SYSLOG]<span> (</span><span class='info'>Gerhards, R., &ldquo;The Syslog Protocol,&rdquo; March&nbsp;2009.</span><span>)</span></a>, for which see also <a class='info' href='#SYSLOG-TLS'>[SYSLOG&#8209;TLS]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#SYSLOG-DTLS'>[SYSLOG&#8209;DTLS]<span> (</span><span class='info'>Salowey, J., Petch, T., Gerhards, R., and H. Feng, &ldquo;Datagram Transport Layer Security (DTLS) Transport Mapping for Syslog,&rdquo; October&nbsp;2010.</span><span>)</span></a><br />
<br />

</li>
<li>The Session Initiation Protocol <a class='info' href='#SIP'>[SIP]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>, for which see also <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and A. Jeffrey, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2010.</span><span>)</span></a><br />
<br />

</li>
<li>The Simple Network Management Protocol <a class='info' href='#SNMP'>[SNMP]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>, for which see also <a class='info' href='#SNMP-TLS'>[SNMP&#8209;TLS]<span> (</span><span class='info'>Hardaker, W., &ldquo;Transport Layer Security (TLS) Transport Model for the Simple Network Management Protocol (SNMP),&rdquo; August&nbsp;2010.</span><span>)</span></a><br />
<br />

</li>
<li>The General Internet Signalling Transport <a class='info' href='#GIST'>[GIST]<span> (</span><span class='info'>Schulzrinne, H. and R. Hancock, &ldquo;GIST: General Internet Signalling Transport,&rdquo; October&nbsp;2010.</span><span>)</span></a>
</li>
</ul><p>
        
</p>
<p>Application protocols have traditionally specified their own rules for representing and verifying application service identity.  Unfortunately, this divergence of approaches has caused some confusion among certification authorities, application developers, and protocol designers.
</p>
<p>Therefore, to codify best current practices regarding the implementation and deployment of secure PKIX-based authentication, this document specifies recommended procedures for representing and verifying application service identity in certificates intended for use in application protocols employing TLS.
</p>
<a name="applicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Applicability and Audience</h3>

<p>This document does not supersede the rules for certificate issuance or validation provided in <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  Therefore, <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> is authoritative on any point that might also be discussed in this document.  Furthermore, <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> also governs any certificate-related topic on which this document is silent, including but limited to certificate syntax, certificate extensions such as name constraints and extended key usage, and handling of certification paths.
</p>
<p>This document addresses only name forms in the leaf "end entity" server certificate, not any name forms in the chain of certificates used to validate the server certificate.  Therefore, in order to ensure proper authentication, application clients need to verify the entire certification path per <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<p>This document also does not supersede the rules for verifying service identity provided in specifications for existing application protocols published prior to this BCP, such as those excerpted under <a class='info' href='#prior'>Appendix&nbsp;A<span> (</span><span class='info'>Prior Art</span><span>)</span></a>.  However, the best current practices described here can be referenced by future specifications, including updates to specifications for existing application protocols if the relevant technology communities agree to do so.  It is also expected that this document will be updated or obsoleted in the future as best practices for issuance and verification of PKIX certificates continue to evolve through more widespread implementation and deployment of TLS-protected application services over the Internet.
</p>
<p>The primary audience for this document consists of application protocol designers, who can reference this document instead of defining their own rules for the representation and verification of application service identity.  Secondarily, the audience consists of certification authorities, client developers, service providers, and other members of technology communities that can re-use the recommendations in this document when defining certificate issuance policies, writing software algorithms for identity matching, generating certificate signing requests, and so forth.
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Overview of Recommendations</h3>

<p>To orient the reader, this section provides an informational overview of the recommendations contained in this document.
</p>
<p>For the primary audience of application protocol designers, based on best current practices this document provides recommended procedures for the representation and verification of application service identity within PKIX certificates used in the context of TLS.
</p>
<p>For the secondary audiences, in essence this document encourages certification authorities, application service providers, and application client developers to coalesce on the following best current practices:
</p>
<p>
          </p>
<ul class="text">
<li>Move away from including and checking strings that look like domain names in the subject's Common Name.<br />
<br />

</li>
<li>Move toward including and checking DNS domain names via the subjectAlternativeName extension designed for that purpose: dNSName.<br />
<br />

</li>
<li>Move toward including and checking even more specific subjectAlternativeName extensions where appropriate for the using protocol (e.g., uniformResourceIdentifier and the otherName form SRVName).<br />
<br />

</li>
<li>Move away from the issuance of so-called wildcard certificates (e.g., a certificate containing an identifier for "*.example.com").
</li>
</ul><p>
        
</p>
<p>These suggestions are not entirely consistent with all practices that are currently followed by certification authorities, client developers, and service providers.  However, they reflect the best aspects of current practices and are expected to become more widely adopted in the coming years.
</p>
<a name="scope"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Scope</h3>

<a name="in-scope"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4.1"></a><h3>1.4.1.&nbsp;
In Scope</h3>

<p>This document applies only to service identities associated with fully-qualified DNS domain names, only to TLS and DTLS (or the older Secure Sockets Layer (SSL) technology), and only to PKIX-based systems.  As a result, the scenarios described in the following section are out of scope for this specification (although they might be addressed by future specifications).
</p>
<a name="out-of-scope"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4.2"></a><h3>1.4.2.&nbsp;
Out of Scope</h3>

<p>The following topics are out of scope for this specification:
</p>
<p>
            </p>
<ul class="text">
<li>
                Client or end-user identities.

                <br />
<br />
 

                Certificates representing client or end-user identities (e.g., the rfc822Name identifier) can be used for mutual authentication between a client and server or between two clients, thus enabling stronger client-server security or end-to-end security.  However, certification authorities, application developers, and service operators have less experience with client certificates than with server certificates, thus giving us fewer models from which to generalize and a less solid basis for defining best practices.

                <br />
<br />
 
              
</li>
<li>
                Identifiers other than fully-qualified DNS domain names.

                <br />
<br />
 

                Some certification authorities issue server certificates based on IP addresses, but preliminary evidence indicates that such certificates are a very small percentage (less than 1%) of issued certificates.  Furthermore, IP addresses are not necessarily reliable identifiers for application services because of the existence of private internets <a class='info' href='#PRIVATE'>[PRIVATE]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a>, host mobility, multiple interfaces on a given host, Network Address Translators (NATs) resulting in different addresses for a host from different locations on the network, the practice of grouping many hosts together behind a single IP address, etc.  Most fundamentally, most users find DNS domain names much easier to work with than IP addresses, which is why the domain name system was designed in the first place.  We prefer to define best practices for the much more common use case and not to complicate the rules in this specification.

                <br />
<br />
 

                Furthermore, we focus here on application service identities, not specific resources located at such services.  Therefore this document discusses Uniform Resource Identifiers <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> only as a way to communicate a DNS domain name (via the URI "authority" component), not as a way to communicate other aspects of a service such as a specific resource (via the URI "path" component) or parameters (via the URI "query" component).

                <br />
<br />
 

                We also do not discuss attributes unrelated to DNS domain names, such as those defined in <a class='info' href='#X.520'>[X.520]<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Selected attribute types,&rdquo; August&nbsp;2005.</span><span>)</span></a> and other such specifications (e.g., organizational attributes, geographical attributes, company logos, and the like).

                <br />
<br />

              
</li>
<li>
                Security protocols other than <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>, <a class='info' href='#DTLS'>[DTLS]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a>, or the older Secure Sockets Layer (SSL) technology.  

                <br />
<br />
 

                Although other secure, lower-layer protocols exist and even employ PKIX certificates at times (e.g., IPsec <a class='info' href='#IPSEC'>[IPSEC]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>), their use cases can differ from those of TLS-based and DTLS-based application technologies.  Furthermore, application technologies have less experience with IPsec than with TLS, thus making it more difficult to gather feedback on proposed best practices.

                <br />
<br />
 
              
</li>
<li>
                Keys or certificates employed outside the context of PKIX-based systems.  

                <br />
<br />
 
                
                Some deployed application technologies use a web of trust model based on or similar to OpenPGP <a class='info' href='#OPENPGP'>[OPENPGP]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>, or use self-signed certificates, or are deployed on networks that are not directly connected to the public Internet and therefore cannot depend on Certificate Revocation Lists (CRLs) or the Online Certificate Status Protocol <a class='info' href='#OCSP'>[OCSP]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a> to check CA-issued certificates.  However, the method for binding a public key to an identifier in OpenPGP differs essentially from the method in X.509, the data in self-signed certificates has not been certified by a third party in any way, and checking of CA-issued certificates via CRLs or OSCP is critically important to maintaining the security of PKIX-based systems.  Attempting to define best practices for such technologies would unduly complicate the rules defined in this specification.

                <br />
<br />

              
</li>
<li>
                Certification authority policies, such as:

                <br />
<br />


                
<ul class="text">
<li>What types or "classes" of certificates to issue and whether to apply different policies for them (e.g., allow the wildcard character in certificates issued to individuals who have provided proof of identity but do not allow the wildcard character in "Extended Validation" certificates <a class='info' href='#EV-CERTS'>[EV&#8209;CERTS]<span> (</span><span class='info'>CA/Browser Forum, &ldquo;Guidelines For The Issuance And Management Of Extended Validation Certificates,&rdquo; October&nbsp;2009.</span><span>)</span></a>).<br />
<br />

</li>
<li>Whether to issue certificates based on IP addresses (or some other form, such as relative domain names) in addition to fully-qualified DNS domain names.<br />
<br />

</li>
<li>Which identifiers to include (e.g., whether to include SRV-IDs or URI-IDs as defined in the body of this specification).<br />
<br />

</li>
<li>How to certify or validate fully-qualified DNS domain names and application service types.<br />
<br />

</li>
<li>How to certify or validate other kinds of information that might be included in a certificate (e.g., organization name).
</li>
</ul>
                <br />
<br />

              
</li>
<li>
                Resolution of DNS domain names.

                <br />
<br />


                Although the process whereby a client resolves the DNS domain name of an application service can involve several steps (e.g., this is true of resolutions that depend on DNS SRV resource records, Naming Authority Pointer (NAPTR) DNS resource records <a class='info' href='#NAPTR'>[NAPTR]<span> (</span><span class='info'>Mealling, M., &ldquo;Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database,&rdquo; October&nbsp;2002.</span><span>)</span></a>, and related technologies such as <a class='info' href='#S-NAPTR'>[S&#8209;NAPTR]<span> (</span><span class='info'>Daigle, L. and A. Newton, &ldquo;Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS),&rdquo; January&nbsp;2005.</span><span>)</span></a>), for our purposes we care only about the fact that the client needs to verify the identity of the entity with which it communicates as a result of the resolution process.  Thus the resolution process itself is out of scope for this specification.

                <br />
<br />

              
</li>
<li>
                User interface issues.

                <br />
<br />


                In general, such issues are properly the responsibility of client software developers and standards development organizations dedicated to particular application technologies (see for example <a class='info' href='#WSC-UI'>[WSC&#8209;UI]<span> (</span><span class='info'>Saldhana, A. and T. Roessler, &ldquo;Web Security Context: User Interface Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>).
              
</li>
</ul><p>
          
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5"></a><h3>1.5.&nbsp;
Terminology</h3>

<p>Because many concepts related to "identity" are often too vague to be actionable in application protocols, we define a set of more concrete terms for use in this specification.
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>application service:</dt>
<dd>A service on the Internet that enables interactive and automated clients to connect for the purpose of retrieving or uploading information, communicating with other entities, or connecting to a broader network of services.<br />

</dd>
<dt>application service provider:</dt>
<dd>An organization or individual that hosts or deploys an application service.<br />

</dd>
<dt>attribute-type-and-value pair:</dt>
<dd>A colloquial name for the ASN.1-based construction comprising a Relative Distinguished Name (RDN), which itself is a building-block component of Distinguished Names. See Section 2 of <a class='info' href='#LDAP-DN'>[LDAP&#8209;DN]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names,&rdquo; June&nbsp;2006.</span><span>)</span></a>.<br />

</dd>
<dt>automated client:</dt>
<dd>A software agent or device that is not directly controlled by a human user.<br />

</dd>
<dt>delegated domain:</dt>
<dd>A domain name or host name that is explicitly configured for communicating with the source domain, by either (a) the human user controlling an interactive client or (b) a trusted administrator.  In case (a), one example of delegation is an account setup that specifies the domain name of a particular host to be used for retrieving information or connecting to a network, which might be different from the server portion of the user's account name (e.g., a server at mailhost.example.com for connecting to an IMAP server hosting an email address of juliet@example.com).  In case (b), one example of delegation is an admin-configured host-to-address/address-to-host lookup table.<br />

</dd>
<dt>derived domain:</dt>
<dd>A domain name or host name that a client has derived from the source domain in an automated fashion (e.g., by means of a <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a> lookup).<br />

</dd>
<dt>identifier:</dt>
<dd>A particular instance of an identifier type that is either presented by a server in a certificate or referenced by a client for matching purposes.<br />

</dd>
<dt>identifier type:</dt>
<dd>A formally defined category of identifier that can be included in a certificate and therefore that can also be used for matching purposes.  For conciseness and convenience, we define the following identifier types of interest, which are based on those found in the PKIX specification <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> and various PKIX extensions.
              <br />

<ul class="text">
<li>CN-ID = a Relative Distinguished Name (RDN) in the certificate subject field that contains one and only one attribute-type-and-value pair of type Common Name (CN), where the value matches the overall form of a domain name (informally, dot-separated letter-digit-hyphen labels); see <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> and also <a class='info' href='#LDAP-SCHEMA'>[LDAP&#8209;SCHEMA]<span> (</span><span class='info'>Sciberras, A., &ldquo;Lightweight Directory Access Protocol (LDAP): Schema for User Applications,&rdquo; June&nbsp;2006.</span><span>)</span></a><br />
<br />

</li>
<li>DNS-ID = a subjectAltName entry of type dNSName; see <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a><br />
<br />

</li>
<li>SRV-ID = a subjectAltName entry of type otherName whose name form is SRVName; see <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a><br />
<br />

</li>
<li>URI-ID = a subjectAltName entry of type uniformResourceIdentifier whose value includes both (i) a "scheme" and (ii) an "authority" component whose "host" subcomponent matches the "reg-name" rule (where the quoted terms represent the associated <a class='info' href='#ABNF'>[ABNF]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a> productions from <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>); see <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> and <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
</li>
</ul>
              <br />
<br />

            
</dd>
<dt>interactive client:</dt>
<dd>A software agent or device that is directly controlled by a human user.  (Other specifications related to security and application protocols, such as <a class='info' href='#WSC-UI'>[WSC&#8209;UI]<span> (</span><span class='info'>Saldhana, A. and T. Roessler, &ldquo;Web Security Context: User Interface Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>, often refer to this entity as a "user agent".<br />

</dd>
<dt>pinning:</dt>
<dd>The act of establishing a cached name association between the application service's certificate and one of the client's reference identifiers, despite the fact that none of the presented identifiers matches the given reference identifier.  Pinning is accomplished by allowing a human user to positively accept the mismatch during an attempt to communicate with the application service.  Once a cached name association is established, the certificate is said to be pinned to the reference identifier and in future communication attempts the client simply verifies that the service's presented certificate matches the pinned certificate, as described under <a class='info' href='#verify-outcome-pin'>Section&nbsp;4.6.2<span> (</span><span class='info'>Case #2: No Match Found, Pinned Certificate</span><span>)</span></a>.  (A similar definition of "pinning" is provided in <a class='info' href='#WSC-UI'>[WSC&#8209;UI]<span> (</span><span class='info'>Saldhana, A. and T. Roessler, &ldquo;Web Security Context: User Interface Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>.)<br />

</dd>
<dt>PKIX:</dt>
<dd>PKIX is a short name for the Internet Public Key Infrastructure using X.509 defined in RFC 5280 [PKIX], which comprises a profile of the X.509v3 certificate specifications and X.509v2 certificate revocation list (CRL) specifications for use in the Internet.<br />

</dd>
<dt>PKIX-based system:</dt>
<dd>A software implementation or deployed service that makes use of X.509v3 certificates and X.509v2 certificate revocation lists (CRLs).<br />

</dd>
<dt>PKIX certificate:</dt>
<dd>An X.509v3 certificate generated and employed in the context of PKIX.<br />

</dd>
<dt>presented identifier:</dt>
<dd>An identifier that is presented by a server to a client within a PKIX certificate when the client attempts to establish secure communication with the server; the certificate can include one or more presented identifiers of different types, and if the server hosts more than one domain then the certificate might present distinct identifiers for each domain.<br />

</dd>
<dt>reference identifier:</dt>
<dd>An identifier, constructed from a source domain and optionally a service type, used by the client for matching purposes when examining presented identifiers.<br />

</dd>
<dt>service type:</dt>
<dd>A formal identifier for the application protocol used to provide a particular kind of service at a domain; the service type typically takes the form of a Uniform Resource Identifier scheme <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> or a DNS SRV Service <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>.<br />

</dd>
<dt>source domain:</dt>
<dd>The fully-qualified DNS domain name that a client expects an application service to present in the certificate (e.g., "www.example.com"), typically input by a human user, configured into a client, or provided by reference such as in a hyperlink.  The combination of a source domain and, optionally, a service type enables a client to construct one or more reference identifiers.<br />

</dd>
<dt>subjectAltName entry:</dt>
<dd>An identifier placed in a subjectAltName extension.<br />

</dd>
<dt>subjectAltName extension:</dt>
<dd>A standard PKIX certificate extension <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> enabling identifiers of various types to be bound to the certificate subject -- in addition to, or in place of, identifiers that may be embedded within or provided as a certificate's subject field.<br />

</dd>
<dt>subject field:</dt>
<dd>The subject field of a PKIX certificate identifies the entity associated with the public key stored in the subject public key field (see Section 4.1.2.6 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>).<br />

</dd>
<dt>subject name:</dt>
<dd>In an overall sense, a subject's name(s) can be represented by or in the subject field, the subjectAltName extension, or both (see <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> for details).  More specifically, the term often refers to the name of a PKIX certificate's subject, encoded as the X.501 type Name and conveyed in a certificate's subject field (see Section 4.1.2.6 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>).<br />

</dd>
<dt>TLS client:</dt>
<dd>An entity that assumes the role of a client in a Transport Layer Security <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> negotiation; in this specification we generally assume that the TLS client is an (interactive or automated) application client, however in application protocols that enable server-to-server communication the TLS client could be a peer application service.<br />

</dd>
<dt>TLS server:</dt>
<dd>An entity that assumes the role of a server in a Transport Layer Security <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> negotiation; in this specfication we assume that the TLS server is an application service.
</dd>
</dl></blockquote><p>
        
</p>
<p>Most security-related terms in this document are to be understood in the sense defined in <a class='info' href='#SECTERMS'>[SECTERMS]<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a>; such terms include, but are not limited to, "attack", "authentication", "authorization", "certification authority", "certification path", "certificate", "credential", "identity", "self-signed certificate", "trust", "trust anchor", "trust chain", "validate", and "verify".
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#KEYWORDS'>[KEYWORDS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="names"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Names</h3>

<p>This section discusses naming of application services on the Internet, followed by a brief tutorial about subject naming in PKIX.
</p>
<a name="names-apps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Naming Application Services</h3>

<p>This specification assumes that the name of an application service is based on a DNS domain name (e.g., "example.com") -- supplemented in some circumstances by a service type (e.g., "the IMAP server at example.com").
</p>
<p>From the perspective of the application client or user, some names are direct because they are provided directly by a human user (e.g., via runtime input, prior configuration, or explicit acceptance of a client communication attempt) whereas other names are indirect because they are automatically resolved by the client based on user input (e.g., a target name resolved from a source name using DNS SRV or NAPTR records). This dimension matters most for certificate consumption, specifically verification as discussed in this document.
</p>
<p>From the perspective of the application service, some names are unrestricted because they can be used in any type of service (e.g., a certificate might be re-used for both the HTTP service and the IMAP service at example.com) whereas other names are restricted because they can be used in only one type of service (e.g., a special-purpose certificate that can be used only for an IMAP service).  This dimension matters most for certificate issuance.
</p>
<p>Therefore we can categorize the identifier types of interest as follows:
</p>
<p>
          </p>
<ul class="text">
<li>A CN-ID is direct and unrestricted.<br />
<br />

</li>
<li>A DNS-ID is direct and unrestricted.<br />
<br />

</li>
<li>An SRV-ID can be either direct or (more typically) indirect, and is restricted.<br />
<br />

</li>
<li>A URI-ID is direct and restricted.
</li>
</ul><p>
        
</p>
<p>We summarize this taxonomy in the following table.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-----------+-----------+---------------+
|           |  Direct   |  Restricted   |
+-----------+-----------+---------------+
|  CN-ID    |  Yes      |  No           |
+-----------+-----------+---------------+
|  DNS-ID   |  Yes      |  No           |
+-----------+-----------+---------------+
|  SRV-ID   |  Either   |  Yes          |
+-----------+-----------+---------------+
|  URI-ID   |  Yes      |  Yes          |
+-----------+-----------+---------------+
</pre></div>
<p>When implementing software, deploying services, and issuing certificates for secure PKIX-based authentication, it is important to keep these distinctions in mind.  In particular, best practices differ somewhat for application server implementations, application client implementations, application service providers, and certification authorities.  Ideally, protocol specifications that reference this document will specify which identifiers are mandatory-to-implement by servers and clients, which identifiers ought to be supported by certificate issuers, and which identifiers ought to be requested by application service providers.  Because these requirements differ across applications, it is impossible to categorically stipulate universal rules (e.g., that all software implementations, service providers, and certification authorities for all application protocols need to use or support DNS-IDs as a baseline for the purpose of interoperability).
</p>
<p>However, it is preferable that each application protocol will at least define a baseline that applies to the community of software developers, application service providers, and CAs actively using or supporting that technology (one such community, the CA/Browser Forum, has codified such a baseline for "Extended Validation Certificates" in <a class='info' href='#EV-CERTS'>[EV&#8209;CERTS]<span> (</span><span class='info'>CA/Browser Forum, &ldquo;Guidelines For The Issuance And Management Of Extended Validation Certificates,&rdquo; October&nbsp;2009.</span><span>)</span></a>).
</p>
<a name="names-dns"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
DNS Domain Names</h3>

<p>For the purposes of this specification, the name of an application service is (or is based on) a DNS domain name that conforms to one of the following forms:
</p>
<p>
          </p>
<ol class="text">
<li>A "traditional domain name", i.e., a fully-qualified DNS domain name or "FQDN" (see <a class='info' href='#DNS-CONCEPTS'>[DNS&#8209;CONCEPTS]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a>) all of whose labels are "LDH labels" as described in <a class='info' href='#IDNA-DEFS'>[IDNA&#8209;DEFS]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a>.  Informally, such labels are constrained to <a class='info' href='#US-ASCII'>[US&#8209;ASCII]<span> (</span><span class='info'>American National Standards Institute, &ldquo;Coded Character Set - 7-bit American Standard Code for Information Interchange,&rdquo; 1986.</span><span>)</span></a> letters, digits, and the hyphen, with the hyphen prohibited in the first character position.  Additional qualifications apply (please refer to the above-referenced specifications for details) but they are not relevant to this specification.<br />
<br />

</li>
<li>An "internationalized domain name", i.e., a DNS domain name that conforms to the overall form of a domain name (informally, dot-separated letter-digit-hyphen labels) but includes at least one label containing appropriately encoded Unicode code points outside the traditional US-ASCII range. That is, it contains at least one U-label or A-label, but otherwise may contain any mixture of NR-LDH labels, A-labels, or U-labels, as described in <a class='info' href='#IDNA-DEFS'>[IDNA&#8209;DEFS]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a> and the associated documents).
</li>
</ol><p>
        
</p>
<a name="names-pkix"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Subject Naming in PKIX Certificates</h3>

<p>In theory, the Internet Public Key Infrastructure using X.509 <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> employs the global directory service model defined in <a class='info' href='#X.500'>[X.500]<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Overview of concepts, models and services,&rdquo; August&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#X.501'>[X.501]<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Models,&rdquo; August&nbsp;2005.</span><span>)</span></a>.  Under that model, information is held in a directory information base (DIB) and entries in the DIB are organized in a hierarchy called the directory information tree (DIT).  An object or alias entry in that hierarchy consists of a set of attributes (each of which has a defined type and one or more values) and is uniquely identified by a Distinguished Name (DN).  The DN of an entry is constructed by combining the Relative Distinguished Names of its superior entries in the tree (all the way down to the root of the DIT) with one or more specially-nominated attributes of the entry itself (which together comprise the Relative Distinguished Name (RDN) of the entry, so-called because it is relative to the Distinguished Names of the superior entries in the tree).  The entry closest to the root is sometimes referred to as the "most significant" entry and the entry farthest from the root is sometimes referred to as the "least significant" entry.  An RDN is a set (i.e., an unordered group) of attribute-type-and-value pairs (see also <a class='info' href='#LDAP-DN'>[LDAP&#8209;DN]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names,&rdquo; June&nbsp;2006.</span><span>)</span></a>), each of which asserts some attribute about the entry.
</p>
<p>In practice, the certificates used in <a class='info' href='#X.509'>[X.509]<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks,&rdquo; August&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> borrow key concepts from X.500 and X.501 (e.g., DNs and RDNs) to identify entities, but such certificates are not necessarily part of a global directory information base.  Specifically, the subject field of a PKIX certificate is an X.501 type Name that "identifies the entity associated with the public key stored in the subject public key field" (see Section 4.1.2.6 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>).  However, it is perfectly acceptable for the subject field to be empty, as long as the certificate contains a subject alternative name ("subjectAltName") extension that includes at least one subjectAltName entry, because the subjectAltName extension allows various identities to be bound to the subject (see Section 4.2.1.6 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>).  The subjectAltName extension itself is a sequence of typed entries, where each type is a distinct kind of identifier.
</p>
<p>For our purposes, an application service can be identified by a name or names carried in the subject field (i.e., a CN-ID) and/or in one of the following identifier types within subjectAltName entries:
</p>
<p>
          </p>
<ul class="text">
<li>DNS-ID
</li>
<li>SRV-ID
</li>
<li>URI-ID
</li>
</ul><p>
        
</p>
<p>Existing certificates often use a CN-ID in the subject field to represent a fully-qualified DNS domain name; for example, consider the following three subject names, where the attribute of type Common Name contains a string whose form matches that of a fully-qualified DNS domain name ("im.example.org", "mail.example.net", and "www.example.com" respectively):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   CN=im.example.org,O=Example Org,C=GB

   C=CA,O=Example Internetworking,CN=mail.example.net

   O=Examples-R-Us,CN=www.example.com,C=US
</pre></div>
<p>However, a Common Name might contain a human-friendly string for the service, rather than a string whose form matches that of a fully-qualified DNS domain name (a certificate with such a single Common Name will tyupically have at least one subjectAltName entry containing the fully-qualified DNS domain name):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   CN=A Free Chat Service,O=Example Org,C=GB
</pre></div>
<p>Or, a certificate's subject might contain both a CN-ID as well as another common name attribute containing a human-friendly string:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   CN=A Free Chat Service,CN=im.example.org,O=Example Org,C=GB
</pre></div>
<p>In general, this specification recommends and prefers use of subjectAltName entries (DNS-ID, SRV-ID, URI-ID, etc.) over use of the subject field (CN-ID) where possible, as more completely described in the following sections.  However, specifications that re-use this one can legitimately encourage continued support for the CN-ID identifier type if they have good reasons to do so, such as backward compatibility with deployed infrastructure (see, for example, <a class='info' href='#EV-CERTS'>[EV&#8209;CERTS]<span> (</span><span class='info'>CA/Browser Forum, &ldquo;Guidelines For The Issuance And Management Of Extended Validation Certificates,&rdquo; October&nbsp;2009.</span><span>)</span></a>).
</p>
<a name="names-pkix-notes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Implementation Notes</h3>

<p>Confusion sometimes arises from different renderings or encodings of the hierarchical information contained in a certificate.
</p>
<p>Certificates are binary objects and are encoded using the Distinguished Encoding Rules (DER) specified in <a class='info' href='#X.690'>[X.690]<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER),&rdquo; August&nbsp;2008.</span><span>)</span></a>.  However, some implementations generate displayable (a.k.a. printable) renderings of the certificate issuer, subject field, and subjectAltName extension, and these renderings convert the DER-encoded sequences into a "string representation" before being displayed.  Because a certificate subject field (of type Name <a class='info' href='#X.509'>[X.509]<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks,&rdquo; August&nbsp;2005.</span><span>)</span></a>, the same as for a Distinguished Name (DN) <a class='info' href='#X.501'>[X.501]<span> (</span><span class='info'>International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Models,&rdquo; August&nbsp;2005.</span><span>)</span></a>) is an ordered sequence, order is typically preserved in subject string representations, although the two most prevalent subject (and DN) string representations differ in employing left-to-right vs. right-to-left ordering.  However, because a Relative Distinguished Name (RDN) is an unordered group of attribute-type-and-value pairs, the string representation of an RDN can differ from the canonical DER encoding (and the order of attribute-type-and-value pairs can differ in the RDN string representations or display orders provided by various implementations).  Furthermore, various specifications refer to the order of RDNs in DNs or certificate subject fields using terminology that is implicitly related to an information hierarchy (which may or may not actually exist), such as "most specific" vs. "least specific", "left-most" vs. "right-most", "first" vs. "last", or "most significant" vs. "least significant" (see for example <a class='info' href='#LDAP-DN'>[LDAP&#8209;DN]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names,&rdquo; June&nbsp;2006.</span><span>)</span></a>).
</p>
<p>To reduce confusion, in this specification we avoid such terms and instead use the terms provided under <a class='info' href='#terminology'>Section&nbsp;1.5<span> (</span><span class='info'>Terminology</span><span>)</span></a>; in particular, we do not use the term "(most specific) Common Name field in the subject field" from <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> and instead state that a CN-ID is a Relative Distinguished Name (RDN) in the certificate subject containing one and only one attribute-type-and-value pair of type Common Name (thus removing the possibility that an RDN might contain multiple AVAs of type CN, one of which could be considered "most specific").
</p>
<p>Finally, although theoretically some consider the order of RDNs within a subject field to have meaning, in practice that rule is often not observed.  An AVA of type CN is considered to be valid at any position within the subject field.
</p>
<a name="representation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Representation of Server Identity</h3>

<a name="representation-rules"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Rules</h3>

<p>When a certification authority issues a certificate based on the fully-qualified DNS domain name at which the application service provider will provide the relevant application, the following rules apply to the representation of application service identities.  The reader needs to be aware that some of these rules are cumulative and can interact in important ways that are illustrated later in this document.
</p>
<p>
          </p>
<ol class="text">
<li>The certificate SHOULD include a "DNS-ID" if possible as a baseline for interoperability.<br />
<br />

</li>
<li>If the service using the certificate deploys a technology in which a server is discovered by means of DNS SRV records <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a> (e.g., this is true of <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a>), then the certificate SHOULD include an "SRV-ID".<br />
<br />

</li>
<li>If the service using the certificate deploys a technology in which a server is programatically associated with a URI for security purposes (e.g., this is true of <a class='info' href='#SIP'>[SIP]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> as specified by <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and A. Jeffrey, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2010.</span><span>)</span></a>, but not true of <a class='info' href='#HTTP'>[HTTP]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> since <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> does not describe usage of a URI-ID for HTTP services), then the certificate SHOULD include a URI-ID; the scheme SHALL be that of the protocol associated with the service type and the "authority" component SHALL be the fully-qualified DNS domain name of the service.  A specification that re-uses this one MUST specify which URI schemes are to be considered acceptable in URI-IDs contained in PKIX certificates used for the application protocol (e.g., "sip" but not "sips" or "tel" for SIP as described in <a class='info' href='#SIP-SIPS'>[SIP&#8209;SIPS]<span> (</span><span class='info'>Audet, F., &ldquo;The Use of the SIPS URI Scheme in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2009.</span><span>)</span></a>, or perhaps http and https for HTTP as might be described in a future specification).<br />
<br />

</li>
<li>The certificate MAY include other application-specific identifiers for types that were defined before publication of <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a> (e.g., XmppAddr for <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a>) or for which service names or URI schemes do not exist; however, such application-specific identifiers are not applicable to all application technologies and therefore are out of scope for this specification.<br />
<br />

</li>
<li>Even though many deployed clients still check for the CN-ID within the certificate subject field, the certificate SHOULD NOT represent the server's fully-qualified DNS domain name in a CN-ID unless a specification that re-uses this one encourages continued support for the CN-ID identifier type.<br />
<br />

</li>
<li>The certificate MAY contain more than one DNS-ID, SRV-ID, or URI-ID but SHOULD NOT contain more than one CN-ID, as further explained under <a class='info' href='#security-multi'>Section&nbsp;5.4<span> (</span><span class='info'>Multiple Identifiers</span><span>)</span></a>.<br />
<br />

</li>
<li>Unless a specification that re-uses this one allows continued support for the wildcard character '*', the DNS domain name portion of a presented identifier SHOULD NOT contain the wildcard character, whether as the complete left-most label within the identifier (following the definition of "label" from <a class='info' href='#DNS'>[DNS]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>, e.g., "*.example.com") or as a fragment thereof (e.g., *oo.example.com, f*o.example.com, or foo*.example.com).  A more detailed discussion of so-called "wildcard certificates" is provided under <a class='info' href='#security-wildcards'>Section&nbsp;5.2<span> (</span><span class='info'>Wildcard Certificates</span><span>)</span></a>.
</li>
</ol><p>
        
</p>
<a name="representation-examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Examples</h3>

<p>Consider a simple website at "www.example.com", which is not discoverable via DNS SRV lookups.  A certificate for this service might include only a DNS-ID of "www.example.com".
</p>
<p>Consider an IMAP-accessible email server at "mail.example.net" servicing email addresses of the form "user@example.net" and discoverable via DNS SRV lookups on the "example.net" domain.  A certificate for this service might include SRV-IDs of "_imap.example.net" and "_imaps.example.net" (see <a class='info' href='#EMAIL-SRV'>[EMAIL&#8209;SRV]<span> (</span><span class='info'>Daboo, C., &ldquo;Use of SRV Records for Locating Email Submission/Access services,&rdquo; May&nbsp;2010.</span><span>)</span></a>) along with a DNS-ID of "example.net".
</p>
<p>Consider a SIP-accessible voice-over-IP (VoIP) server at "voice.example.edu" servicing SIP addresses of the form "user@voice.example.edu" and identified by a URI of &lt;sip:voice.example.edu&gt;.  A certificate for this service would include a URI-ID of "sip:voice.example.edu" (see <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and A. Jeffrey, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2010.</span><span>)</span></a>).
</p>
<p>Consider an XMPP-compatible instant messaging (IM) server at "im.example.org" servicing IM addresses of the form "user@im.example.org" and discoverable via DNS SRV lookups on the "im.example.org" domain.  A certificate for this service might include SRV-IDs of "_xmpp-client.im.example.org" and "_xmpp-server.im.example.org" (see <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a>), a DNS-ID of "im.example.org", and an XMPP-specific "XmppAddr" of "im.example.org" (see <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a>).
</p>
<a name="verify"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Verification of Service Identity</h3>

<a name="verify-overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Overview</h3>

<p>At a high level, the client verifies the application service's identity by performing the actions listed below (which are defined in the following subsections of this document):
</p>
<p>
          </p>
<ol class="text">
<li>The client constructs a list of acceptable reference identifiers based on the source domain and, optionally, the type of service to which the client is connecting.<br />
<br />

</li>
<li>The server provides its identifiers in the form of a PKIX certificate.<br />
<br />

</li>
<li>The client checks each of its reference identifiers against the presented identifiers for the purpose of finding a match.<br />
<br />

</li>
<li>When checking a reference identifier against a presented identifier, the client matches the source domain of the identifiers and, optionally, their service type.
</li>
</ol><p>
        
</p>
<p>Naturally, in addition to checking identifiers, a client might complete further checks to ensure that the server is authorized to provide the requested service.  However, such checking is not a matter of verifying the application service identity presented in a certificate, and therefore methods for doing so (e.g., consulting local policy information) are out of scope for this document.
</p>
<a name="verify-reference"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Constructing a List of Reference Identifiers</h3>

<a name="verify-reference-rules"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Rules</h3>

<p>The client MUST construct a list of acceptable reference identifiers, and MUST do so independently of the identifiers presented by the service.
</p>
<p>The inputs used by the client to construct its list of reference identifiers might be a URI that a user has typed into an interface (e.g., an HTTPS URL for a web site), configured account information (e.g., the domain name of a particular host or URI used for retrieving information or connecting to a network, which might be different from the DNS domain name portion of a username), a hyperlink in a web page that triggers a browser to retrieve a media object or script, or some other combination of information that can yield a source domain and a service type.
</p>
<p>The client might need to extract the source domain and service type from the input(s) it has received.  The extracted data MUST include only information that can be securely parsed out of the inputs (e.g., parsing the fully-qualified DNS domain name out of the "authority" component of a URI or deriving the service type from the scheme of a URI) or information that is derived in a manner not subject to subversion by network attackers (e.g., pulling the data from a delegated domain that is explicitly established via client or system configuration, resolving the data via <a class='info' href='#DNSSEC'>[DNSSEC]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a>, or obtaining the data from a third-party domain mapping service in which a human user has explicitly placed trust and with which the client communicates over a connection or association that provides both mutual authentication and integrity checking).  These considerations apply only to extraction of the source domain from the inputs; naturally, if the inputs themselves are invalid or corrupt (e.g., a user has clicked a link provided by a malicious entity in a phishing attack), then the client might end up communicating with an unexpected application service.
</p>
<p></p>
<blockquote class="text">
<p>Example: Given an input URI of &lt;sips:alice@example.net&gt;, a client would derive the service type "sip" from the "scheme" and parse the domain name "example.net" from the "authority" component.
</p>
</blockquote>

<p>Each reference identifier in the list SHOULD be based on the source domain and SHOULD NOT be based on a derived domain (e.g., a host name or domain name discovered through DNS resolution of the source domain).  This rule is important because only a match between the user inputs and a presented identifier enables the client to be sure that the certificate can legitimately be used to secure the client's communication with the server.  There is only one scenario in which it is acceptable for an interactive client to override the recommendation in this rule and therefore communicate with a domain name other than the source domain: because a human user has "pinned" the application service's certificate to the alternative domain name as further discussed under <a class='info' href='#verify-outcome-fallback'>Section&nbsp;4.6.4<span> (</span><span class='info'>Fallback</span><span>)</span></a> and <a class='info' href='#security-pinning'>Section&nbsp;5.1<span> (</span><span class='info'>Pinned Certificates</span><span>)</span></a>.  In this case, the inputs used by the client to construct its list of reference identifiers might include more than one fully-qualified DNS domain name, i.e., both (a) the source domain and (b) the alternative domain contained in the pinned certificate.
</p>
<p>Using the combination of fully-qualified DNS domain name(s) and service type, the client constructs a list of reference identifiers in accordance with the following rules:
</p>
<p>
            </p>
<ul class="text">
<li>The list MUST include a DNS-ID.  A reference identifier of type DNS-ID can be directly constructed from a fully-qualified DNS domain name that is (a) contained in or securely derived from the inputs (i.e., the source domain), or (b) explicitly associated with the source domain by means of user configuration (i.e., a derived domain).<br />
<br />

</li>
<li>If a server for the service type is typically discovered by means of DNS SRV records, then the list SHOULD include an SRV-ID.<br />
<br />

</li>
<li>If a server for the service type is typically associated with a URI for security purposes, then the list SHOULD include a URI-ID.<br />
<br />

</li>
<li>The list MAY include a CN-ID, mainly for the sake of backward compatibility with deployed infrastructure.
</li>
</ul><p>
          
</p>
<p>The client does not need to construct the foregoing identifiers in the actual formats found in a certificate (e.g., as ASN.1 types); it only needs to construct the functional equivalent of such identifiers for matching purposes.
</p>
<p></p>
<blockquote class="text">
<p>Security Warning: A client MUST NOT construct a reference identifier corresponding to Relative Distinguished Names (RDNs) other than those of type Common Name and MUST NOT check for RDNs other than those of type Common Name in the presented identifiers.
</p>
</blockquote>

<a name="verify-reference-examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Examples</h3>

<p>A web browser that is connecting via HTTPS to the website at "www.example.com" might have two reference identifiers: a DNS-ID of "www.example.com" and, as a fallback, a CN-ID of "www.example.com".
</p>
<p>A mail user agent that is connecting via IMAP to the email service at "example.net" (resolved as "mail.example.net") might have two reference identifiers: an SRV-ID of "_imaps.example.net" (see <a class='info' href='#EMAIL-SRV'>[EMAIL&#8209;SRV]<span> (</span><span class='info'>Daboo, C., &ldquo;Use of SRV Records for Locating Email Submission/Access services,&rdquo; May&nbsp;2010.</span><span>)</span></a>) and a DNS-ID of "example.net".
</p>
<p>A voice-over-IP (VoIP) user agent that is connecting via SIP to the voice service at "voice.example.edu" might have only one reference identifier: a URI-ID of "sip:voice.example.edu" (see <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and A. Jeffrey, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2010.</span><span>)</span></a>).
</p>
<p>An instant messaging (IM) client that is connecting via XMPP to the IM service at "im.example.org" might have three reference identifiers: an SRV-ID of "_xmpp-client.im.example.org" (see <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a>), a DNS-ID of "im.example.org", and an XMPP-specific "XmppAddr" of "im.example.org" (see <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a>).
</p>
<a name="verify-seek"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Preparing to Seek a Match</h3>

<p>Once the client has constructed its list of reference identifiers and has received the server's presented identifiers in the form of a PKIX certificate, the client checks its reference identifiers against the presented identifiers for the purpose of finding a match.  The search fails if the client exhausts its list of reference identifiers without finding a match.  The search succeeds if any presented identifier matches one of the reference identifiers, at which point the client SHOULD stop the search.
</p>
<p></p>
<blockquote class="text">
<p>Implementation Note: A client might be configured to perform multiple searches, i.e., to match more than one reference identifier; although such behavior is not forbidden by this specification, rules for matching multiple reference identifiers are a matter for implementation or future specification.
</p>
</blockquote>

<p></p>
<blockquote class="text">
<p>Security Warning: A client MUST NOT seek a match for a reference identifier of CN-ID if the presented identifiers include a DNS-ID, SRV-ID, URI-ID, or any application-specific identifier types supported by the client.
</p>
</blockquote>

<p>Before applying the comparison rules provided in the following sections, the client might need to split the reference identifier into its DNS domain name portion and its service type portion, as follows:
</p>
<p>
          </p>
<ul class="text">
<li>A reference identifier of type DNS-ID does not include a service type portion and thus can be used directly as the DNS domain name for comparison purposes.  As an example, a DNS-ID of "www.example.com" would result in a DNS domain name portion of "www.example.com".<br />
<br />

</li>
<li>A reference identifier of type CN-ID also does not include a service type portion and thus can be used directly as the DNS domain name for comparison purposes.  As previously mentioned, this document specifies that a CN-ID always contains a string whose form matches that of a DNS domain name (thus differentiating a CN-ID from a Common Name containing a human-friendly name).<br />
<br />

</li>
<li>For a reference identifier of type SRV-ID, the DNS domain name portion is the Name and the service type portion is the Service.  As an example, an SRV-ID of "_imaps.example.net" would be split into a DNS domain name portion of "example.net" and a service type portion of "imaps" (mapping to an application protocol of IMAP as explained in <a class='info' href='#EMAIL-SRV'>[EMAIL&#8209;SRV]<span> (</span><span class='info'>Daboo, C., &ldquo;Use of SRV Records for Locating Email Submission/Access services,&rdquo; May&nbsp;2010.</span><span>)</span></a>).<br />
<br />

</li>
<li>For a reference identifier of type URI-ID, the DNS domain name portion is the "reg-name" part of the "authority" component and the service type portion is the service type associated with the scheme name matching the <a class='info' href='#ABNF'>[ABNF]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a> "scheme" rule from <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> (not including the ':' separator).  As previously mentioned, this document specifies that a URI-ID always contains an "authority" component whose "host" subcomponent contains a "reg-name".  (Matching only the "reg-name" rule from <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> limits verification to DNS domain names, thereby differentiating a URI-ID from a uniformResourceIdentifier entry that contains an IP address or a mere host name, or that does not contain an "authority" component at all.). Furthermore, note that extraction of the "reg-name" might necessitate normalization of the URI (as explained in <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>).  As an example, a URI-ID of "sip:voice.example.edu" would be split into a DNS domain name portion of "voice.example.edu" and a service type of "sip" (associated with an application protocol of SIP as explained in <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and A. Jeffrey, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2010.</span><span>)</span></a>).
</li>
</ul><p>
        
</p>
<p>Detailed comparison rules for matching the DNS domain name portion and service type portion of the reference identifier are provided in the following sections.
</p>
<a name="verify-domain"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Matching the DNS Domain Name Portion</h3>

<p>The client MUST match the DNS domain name portion of a reference identifier according to the following rules (and SHOULD also check the service type as described under <a class='info' href='#verify-app'>Section&nbsp;4.5<span> (</span><span class='info'>Matching the Application Type Portion</span><span>)</span></a>).  The rules differ depending on whether the domain to be checked is a "traditional domain name" or an "internationalized domain name" (as defined under <a class='info' href='#names-dns'>Section&nbsp;2.2<span> (</span><span class='info'>DNS Domain Names</span><span>)</span></a>).  Furthermore, to meet the needs of clients that support presented identifiers containing the wildcard character '*', we define a supplemental rule for so-called "wildcard certificates".  Finally, we also specify the circumstances under which it is acceptable to check the "CN-ID" identifier type.
</p>
<a name="verify-domain-trad"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Checking of Traditional Domain Names</h3>

<p>If the DNS domain name portion of a reference identifier is a "traditional domain name", then matching of the reference identifier against the presented identifier is performed by comparing the set of domain name labels using a case-insensitive ASCII comparison, as clarified by <a class='info' href='#DNS-CASE'>[DNS&#8209;CASE]<span> (</span><span class='info'>Eastlake, D., &ldquo;Domain Name System (DNS) Case Insensitivity Clarification,&rdquo; January&nbsp;2006.</span><span>)</span></a> (e.g., "WWW.Example.Com" would be lower-cased to "www.example.com" for comparison purposes).  Each label MUST match in order for the names to be considered to match, except as supplemented by the rule about checking of wildcard labels (<a class='info' href='#verify-domain-wildcards'>Section&nbsp;4.4.3<span> (</span><span class='info'>Checking of Wildcard Certificates</span><span>)</span></a>).
</p>
<a name="verify-domain-idn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Checking of Internationalized Domain Names</h3>

<p>If the DNS domain name portion of a reference identifier is an internationalized domain name, then an implementation MUST convert any U-labels <a class='info' href='#IDNA-DEFS'>[IDNA&#8209;DEFS]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a> in the domain name to A-labels before checking the domain name.  In accordance with <a class='info' href='#IDNA-PROTO'>[IDNA&#8209;PROTO]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names in Applications (IDNA): Protocol,&rdquo; August&nbsp;2010.</span><span>)</span></a>, A-labels MUST be compared as case-insensitive ASCII.  Each label MUST match in order for the domain names to be considered to match, except as supplemented by the rule about checking of wildcard labels (<a class='info' href='#verify-domain-wildcards'>Section&nbsp;4.4.3<span> (</span><span class='info'>Checking of Wildcard Certificates</span><span>)</span></a>; but see also <a class='info' href='#security-wildcards'>Section&nbsp;5.2<span> (</span><span class='info'>Wildcard Certificates</span><span>)</span></a> regarding wildcards in internationalized domain names).
</p>
<a name="verify-domain-wildcards"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.3"></a><h3>4.4.3.&nbsp;
Checking of Wildcard Certificates</h3>

<p>A client employing this specification's rules MAY match the reference identifier against a presented identifier whose DNS domain name portion contains the wildcard character '*' as part or all of a label (following the definition of "label" from <a class='info' href='#DNS-CONCEPTS'>[DNS&#8209;CONCEPTS]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a>).
</p>
<p>For information regarding the security characteristics of wildcard certificates, see <a class='info' href='#security-wildcards'>Section&nbsp;5.2<span> (</span><span class='info'>Wildcard Certificates</span><span>)</span></a>.
</p>
<p>If a client matches the reference identifier against a presented identifier whose DNS domain name portion contains the wildcard character '*', the following rules apply:
</p>
<p>
            </p>
<ol class="text">
<li>The client SHOULD NOT attempt to match a presented identifier in which the wildcard character comprises a label other than the left-most label (e.g., do not match bar.*.example.net).<br />
<br />

</li>
<li>If the wildcard character is the only character of the left-most label in the presented identifier, the client SHOULD NOT compare against anything but the left-most label of the reference identifier (e.g., *.example.com would match foo.example.com but not bar.foo.example.com or example.com).<br />
<br />

</li>
<li>The client MAY match a presented identifier in which the wildcard character is not the only character of the label (e.g., baz*.example.net and *baz.example.net and b*z.example.net would be taken to match baz1.example.net and foobaz.example.net and buzz.example.net, respectively).  However, the client SHOULD NOT attempt to match a presented identifier where the wildcard character is embedded within an A-label or U-label <a class='info' href='#IDNA-DEFS'>[IDNA&#8209;DEFS]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a> of an internationalized domain name <a class='info' href='#IDNA-PROTO'>[IDNA&#8209;PROTO]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names in Applications (IDNA): Protocol,&rdquo; August&nbsp;2010.</span><span>)</span></a>.
</li>
</ol><p>
          
</p>
<a name="verify-domain-cn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.4"></a><h3>4.4.4.&nbsp;
Checking of Common Names</h3>

<p>As noted, a client MUST NOT seek a match for a reference identifier of CN-ID if the presented identifiers include a DNS-ID, SRV-ID, URI-ID, or any application-specific identifier types supported by the client.
</p>
<p>Therefore, if and only if the presented identifiers do not include a DNS-ID, SRV-ID, URI-ID, or any application-specific identifier types supported by the client, then the client MAY as a last resort check for a string whose form matches that of a fully-qualified DNS domain name in a Common Name field of the subject field (i.e., a CN-ID).  If the client chooses to compare a reference identifier of type CN-ID against that string, it MUST follow the comparison rules for the DNS domain name portion of an identifier of type DNS-ID, SRV-ID, or URI-ID, as described under <a class='info' href='#verify-domain-trad'>Section&nbsp;4.4.1<span> (</span><span class='info'>Checking of Traditional Domain Names</span><span>)</span></a>, <a class='info' href='#verify-domain-idn'>Section&nbsp;4.4.2<span> (</span><span class='info'>Checking of Internationalized Domain Names</span><span>)</span></a>, and <a class='info' href='#verify-domain-wildcards'>Section&nbsp;4.4.3<span> (</span><span class='info'>Checking of Wildcard Certificates</span><span>)</span></a>.
</p>
<a name="verify-app"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Matching the Application Type Portion</h3>

<p>When checking identifiers of type SRV-ID and URI-ID, a client SHOULD check not only the domain name but also the service type of the application service with which it communicates.  This is a best practice because typically a client is not designed to communicate with all kinds of services using all possible application protocols, but instead is designed to communicate with one kind of service, such as websites, email services, VoIP services, or IM services.
</p>
<p>The service type is verified by means of an SRV-ID or a URI-ID.
</p>
<a name="verify-app-srv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
SRV-ID</h3>

<p>The service name portion of an SRV-ID (e.g., "imaps") MUST be matched in a case-insensitive manner, in accordance with <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>.  Note that the "_" character is prepended to the service identifier in DNS SRV records and in SRV-IDs (per <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a>), and thus does not need to be included in any comparison.
</p>
<a name="verify-app-uri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
URI-ID</h3>

<p>The scheme name portion of a URI-ID (e.g., "sip") MUST be matched in a case-insensitive manner, in accordance with <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>.  Note that the ":" character is a separator between the scheme name and the rest of the URI, and thus does not need to be included in any comparison.
</p>
<a name="verify-outcome"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Outcome</h3>

<p>The outcome of the matching procedure is one of the following cases.
</p>
<a name="verify-outcome-matched"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.1"></a><h3>4.6.1.&nbsp;
Case #1: Match Found</h3>

<p>If the client has found a presented identifier that matches a reference identifier, then the service identity check has succeeded.  In this case, the client MUST use the matched reference identifier as the validated identity of the application service.
</p>
<a name="verify-outcome-pin"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.2"></a><h3>4.6.2.&nbsp;
Case #2: No Match Found, Pinned Certificate</h3>

<p>If the client does not find a presented identifier matching any of the reference identifiers but the client has previously pinned the application service's certificate to one of the reference identifiers in the list it constructed for this communication attempt (as "pinning" is explained under <a class='info' href='#terminology'>Section&nbsp;1.5<span> (</span><span class='info'>Terminology</span><span>)</span></a>), and the presented certificate matches the pinned certificate (including the context as described under <a class='info' href='#security-pinning'>Section&nbsp;5.1<span> (</span><span class='info'>Pinned Certificates</span><span>)</span></a>), then the service identity check has succeeded.
</p>
<a name="verify-outcome-nopin"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.3"></a><h3>4.6.3.&nbsp;
Case #3: No Match Found, No Pinned Certificate</h3>

<p>If the client does not find a presented identifier matching any of the reference identifiers and the client has not previously pinned the certificate to one of the reference identifiers in the list it constructed for this communication attempt, then the client MUST proceed as described under <a class='info' href='#verify-outcome-fallback'>Section&nbsp;4.6.4<span> (</span><span class='info'>Fallback</span><span>)</span></a>.
</p>
<a name="verify-outcome-fallback"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.4"></a><h3>4.6.4.&nbsp;
Fallback</h3>

<p>If the client is an interactive client that is directly controlled by a human user, then it SHOULD inform the user of the identity mismatch and automatically terminate the communication attempt with a bad certificate error; this behavior is preferable because it prevents users from inadvertently bypassing security protections in hostile situations.
</p>
<p></p>
<blockquote class="text">
<p>Security Warning: Some interactive clients give advanced users the option of proceeding with acceptance despite the identity mismatch, thereby "pinning" the certificate to one of the reference identifiers in the list constructed by the client for this communication attempt.  Although this behavior can be appropriate in certain specialized circumstances, in general it ought to be exposed only to advanced users.  Even then it needs to be handled with extreme caution, for example by first encouraging even an advanced user to terminate the communication attempt and, if the advanced user chooses to proceed anyway, by forcing the user to view the entire certification path and only then allowing the user to pin the certificate (on a temporary or permanent basis, at the user's option).
</p>
</blockquote>

<p>Otherwise, if the client is an automated application not directly controlled by a human user, then it SHOULD terminate the communication attempt with a bad certificate error and log the error appropriately.  An automated application MAY provide a configuration setting that disables this behavior, but MUST enable the behavior by default.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<a name="security-pinning"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Pinned Certificates</h3>

<p>As defined under <a class='info' href='#terminology'>Section&nbsp;1.5<span> (</span><span class='info'>Terminology</span><span>)</span></a>, a certificate is said to be "pinned" to a DNS domain name when a user has explicitly chosen to associate a service's certificate with that DNS domain name despite the fact that the certificate contains some other DNS domain name (e.g., the user has explicitly approved "apps.example.net" as a domain associated with a source domain of "example.com").  The cached name association MUST take account of both the certificate presented and the context in which it was accepted or configured (where the "context" includes the chain of certificates from the presented certificate to the trust anchor, the source domain, the service type, the service's derived domain and port number, and any other relevant information provided by the user or associated by the client).
</p>
<a name="security-wildcards"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Wildcard Certificates</h3>

<p>This document states that the wildcard character '*' SHOULD NOT be included in presented identifiers but MAY be checked by application clients (mainly for the sake of backward compatibility with deployed infrastructure); as a result, the rules provided in this document are more restrictive than the rules for many existing application technologies (such as those excerpted under <a class='info' href='#prior'>Appendix&nbsp;A<span> (</span><span class='info'>Prior Art</span><span>)</span></a>).  Several security considerations justify tightening the rules:
</p>
<p>
          </p>
<ul class="text">
<li>Wildcard certificates automatically vouch for any and all host names within their domain. This can be convenient for administrators but also poses the risk of vouching for rogue or buggy hosts. See for example <a class='info' href='#Defeating-SSL'>[Defeating&#8209;SSL]<span> (</span><span class='info'>Marlinspike, M., &ldquo;New Tricks for Defeating SSL in Practice,&rdquo; February&nbsp;2009.</span><span>)</span></a> (beginning at slide 91) and <a class='info' href='#HTTPSbytes'>[HTTPSbytes]<span> (</span><span class='info'>Sokol, J. and R. Hansen, &ldquo;HTTPS Can Byte Me,&rdquo; November&nbsp;2010.</span><span>)</span></a> (slides 38-40).<br />
<br />

</li>
<li>
              Specifications for existing application technologies are not clear or consistent about the allowable location of the wildcard character, such as whether it can be:
              <br />
<br />

                
<ul class="text">
<li>only the complete left-most label (e.g., *.example.com)<br />
<br />

</li>
<li>some fragment of the left-most label (e.g., foo*.example.com, f*o.example.com, or *oo.example.com)<br />
<br />

</li>
<li>all or part of a label other than the left-most label (e.g., www.*.example.com or www.foo*.example.com)<br />
<br />

</li>
<li>all or part of a label that identifies a so-called "public suffix" (e.g., *.co.uk or *.com)<br />
<br />

</li>
<li>included more than once in a given label (e.g., f*b*r.example.com<br />
<br />

</li>
<li>included as all or part of more than one label (e.g., *.*.example.com)<br />
<br />

</li>
</ul>
              These ambiguities might introduce exploitable differences in identity checking behavior among client implementations and necessitate overly complex and inefficient identity checking algorithms.
            <br />
<br />

</li>
<li>There is no specification that defines how the wildcard character may be embedded within the A-labels or U-labels <a class='info' href='#IDNA-DEFS'>[IDNA&#8209;DEFS]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a> of an internationalized domain name [IDNA-PROTO]; as a result, implementations are strongly discouraged from including or attempting to check for the wildcard character emdedded within A-labels and/or U-labels of an internationalized domain name.  Note, however, that a presented domain name identifier MAY contain the wildcard character where it occupies the entire leftmost label position, and where some or all of the remaining labels are A-labels or U-labels.
            
</li>
</ul><p>
        
</p>
<p>Notwithstanding the foregoing security considerations, specifications that re-use this one can legitimately encourage continued support for the wildcard character if they have good reasons to do so, such as backward compatibility with deployed infrastructure (see, for example, <a class='info' href='#EV-CERTS'>[EV&#8209;CERTS]<span> (</span><span class='info'>CA/Browser Forum, &ldquo;Guidelines For The Issuance And Management Of Extended Validation Certificates,&rdquo; October&nbsp;2009.</span><span>)</span></a>).
</p>
<a name="security-idn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Internationalized Domain Names</h3>

<p>Allowing internationalized domain names can lead to the inclusion of visually similar (so-called "confusable") characters in certificates; for discussion, see for example <a class='info' href='#IDNA-DEFS'>[IDNA&#8209;DEFS]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a>.
</p>
<a name="security-multi"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Multiple Identifiers</h3>

<p>A given application service might be addressed by multiple DNS domain names for a variety of reasons, and a given deployment might service multiple domains (e.g., in so-called "virtual hosting" environments).  In the default TLS handshake exchange, the client is not able to indicate the DNS domain name with which it wants to communicate, and the TLS server returns only one certificate for itself.  Absent an extension to TLS, a typical workaround used to facilitate mapping an application service to multiple DNS domain names is to embed all of the domain names into a single certificate.
</p>
<p>A more recent approach, formally specified in <a class='info' href='#TLS-EXT'>[TLS&#8209;EXT]<span> (</span><span class='info'>3rd, D., &ldquo;Transport Layer Security (TLS) Extensions: Extension Definitions,&rdquo; September&nbsp;2010.</span><span>)</span></a>, is for the client to use the TLS "Server Name Indication" (SNI) extension when sending the client_hello message, stipulating the DNS domain name it desires or expects of the service.  The service can then return the appropriate certificate in its Certificate message, and that certificate can represent a single DNS domain name.
</p>
<p>To accommodate the workaround that was needed before the development of the SNI extension, this specification allows multiple DNS-IDs, SRV-IDs, or URI-IDs in a certificate; however, it explicitly discourages multiple CN-IDs.  Although it would be preferable to forbid multiple CN-IDs entirely, there are several reasons at this time why this specification states that they SHOULD NOT (instead of MUST NOT) be included:
</p>
<p>
          </p>
<ul class="text">
<li>At least one significant technology community of interest explicitly allows multiple CN-IDs <a class='info' href='#EV-CERTS'>[EV&#8209;CERTS]<span> (</span><span class='info'>CA/Browser Forum, &ldquo;Guidelines For The Issuance And Management Of Extended Validation Certificates,&rdquo; October&nbsp;2009.</span><span>)</span></a>.<br />
<br />

</li>
<li>At least one significant certification authority is known to issue certificates containing multiple CN-IDs.<br />
<br />

</li>
<li>Many service providers often deem inclusion of multiple CN-IDs necessary in virtual hosting environments because at least one widely-deployed operating system does not yet support the SNI extension.
</li>
</ul><p>
        
</p>
<p>It is hoped that the recommendation regarding multiple CN-IDs can be further tightened in the future.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document specifies no actions for the IANA.
</p>
<a name="contributors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Contributors</h3>

<p>The following individuals made important contributions to the text of this document: Shumon Huque, RL 'Bob' Morgan, and Kurt Zeilenga.
</p>
<a name="acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>The editors and contributors wish to thank the following individuals for their feedback and suggestions: Bernard Aboba, Richard Barnes, Uri Blumenthal, Nelson Bolyard, Kaspar Brand, Anthony Bryan, Scott Cantor, Wan-Teh Chang, Bil Corry, Dave Cridland, Dave Crocker, Cyrus Daboo, Charles Gardiner, Philip Guenther, Phillip Hallam-Baker, Bruno Harbulot, Wes Hardaker, David Harrington, Paul Hoffman, Love Hornquist Astrand, Henry Hotz, Russ Housley, Jeffrey Hutzelman, Simon Josefsson, Geoff Keating, John Klensin, Scott Lawrence, Matt McCutchen, Alexey Melnikov, Subramanian Moonesamy, Eddy Nigg, Ludwig Nussel, Joe Orton, Tom Petch, Yngve N. Pettersen, Tim Polk, Robert Relyea, Eric Rescorla, Pete Resnick, Martin Rex, Joe Salowey, Stefan Santesson, Jim Schaad, Rob Stradling, Michael Stroeder, Andrew Sullivan, Peter Sylvester, Martin Thomson, Paul Tiemann, Sean Turner, Nicolas Williams, Dan Wing, Dan Winship, and Stefan Winter.
</p>
<p>Thanks also to Barry Leiba and Ben Campbell for their reviews on behalf of the Security Directorate and the General Area Review Team, respectively.
</p>
<p>The responsible Area Director was Alexey Melnikov.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DNS">[DNS]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="ftp://ftp.isi.edu/in-notes/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DNS-CONCEPTS">[DNS-CONCEPTS]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="ftp://ftp.isi.edu/in-notes/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DNS-SRV">[DNS-SRV]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IDNA-DEFS">[IDNA-DEFS]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5890">Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework</a>,&rdquo; RFC&nbsp;5890, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5890.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IDNA-PROTO">[IDNA-PROTO]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5891">Internationalized Domain Names in Applications (IDNA): Protocol</a>,&rdquo; RFC&nbsp;5891, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5891.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="KEYWORDS">[KEYWORDS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP-DN">[LDAP-DN]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4514">Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names</a>,&rdquo; RFC&nbsp;4514, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4514.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="PKIX">[PKIX]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SRVNAME">[SRVNAME]</a></td>
<td class="author-text">Santesson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4985">Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name</a>,&rdquo; RFC&nbsp;4985, August&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4985.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="URI">[URI]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ABNF">[ABNF]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTPSbytes">[HTTPSbytes]</a></td>
<td class="author-text">Sokol, J. and R. Hansen, &ldquo;<a href="https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf">HTTPS Can Byte Me</a>,&rdquo; BlackHat&nbsp;Abu Dhabi, November&nbsp;2010 (<a href="https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Defeating-SSL">[Defeating-SSL]</a></td>
<td class="author-text">Marlinspike, M., &ldquo;<a href="http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf">New Tricks for Defeating SSL in Practice</a>,&rdquo; BlackHat&nbsp;DC, February&nbsp;2009 (<a href="http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DNS-CASE">[DNS-CASE]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4343">Domain Name System (DNS) Case Insensitivity Clarification</a>,&rdquo; RFC&nbsp;4343, January&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4343.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DNSSEC">[DNSSEC]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DTLS">[DTLS]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://tools.ietf.org/html/rfc4347">Datagram Transport Layer Security</a>,&rdquo; RFC&nbsp;4347, April&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4347.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="EMAIL-SRV">[EMAIL-SRV]</a></td>
<td class="author-text">Daboo, C., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-daboo-srv-email-05.txt">Use of SRV Records for Locating Email Submission/Access services</a>,&rdquo; draft-daboo-srv-email-05 (work in progress), May&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-daboo-srv-email-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="EV-CERTS">[EV-CERTS]</a></td>
<td class="author-text">CA/Browser Forum, &ldquo;<a href="http://www.cabforum.org/Guidelines_v1_2.pdf">Guidelines For The Issuance And Management Of Extended Validation Certificates</a>,&rdquo; October&nbsp;2009 (<a href="http://www.cabforum.org/Guidelines_v1_2.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="GIST">[GIST]</a></td>
<td class="author-text">Schulzrinne, H. and R. Hancock, &ldquo;<a href="http://tools.ietf.org/html/rfc5971">GIST: General Internet Signalling Transport</a>,&rdquo; RFC&nbsp;5971, October&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5971.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTP">[HTTP]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">TXT</a>, <a href="ftp://ftp.isi.edu/in-notes/rfc2616.ps">PS</a>, <a href="ftp://ftp.isi.edu/in-notes/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTP-TLS">[HTTP-TLS]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP">[IMAP]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>,&rdquo; RFC&nbsp;3501, March&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3501.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IDNA2003">[IDNA2003]</a></td>
<td class="author-text">Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;<a href="http://tools.ietf.org/html/rfc3490">Internationalizing Domain Names in Applications (IDNA)</a>,&rdquo; RFC&nbsp;3490, March&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3490.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IP">[IP]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;791, September&nbsp;1981 (<a href="ftp://ftp.isi.edu/in-notes/rfc791.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IPv6">[IPv6]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="ftp://ftp.isi.edu/in-notes/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IPSEC">[IPSEC]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP">[LDAP]</a></td>
<td class="author-text">Sermersheim, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4511">Lightweight Directory Access Protocol (LDAP): The Protocol</a>,&rdquo; RFC&nbsp;4511, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4511.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP-AUTH">[LDAP-AUTH]</a></td>
<td class="author-text">Harrison, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4513">Lightweight Directory Access Protocol (LDAP): Authentication Methods and Security Mechanisms</a>,&rdquo; RFC&nbsp;4513, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4513.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP-SCHEMA">[LDAP-SCHEMA]</a></td>
<td class="author-text">Sciberras, A., &ldquo;<a href="http://tools.ietf.org/html/rfc4519">Lightweight Directory Access Protocol (LDAP): Schema for User Applications</a>,&rdquo; RFC&nbsp;4519, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4519.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP-TLS">[LDAP-TLS]</a></td>
<td class="author-text">Hodges, J., Morgan, R., and M. Wahl, &ldquo;<a href="http://tools.ietf.org/html/rfc2830">Lightweight Directory Access Protocol (v3): Extension for Transport Layer Security</a>,&rdquo; RFC&nbsp;2830, May&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2830.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NAPTR">[NAPTR]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3403">Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database</a>,&rdquo; RFC&nbsp;3403, October&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3403.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NETCONF">[NETCONF]</a></td>
<td class="author-text">Enns, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4741">NETCONF Configuration Protocol</a>,&rdquo; RFC&nbsp;4741, December&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4741.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NETCONF-SSH">[NETCONF-SSH]</a></td>
<td class="author-text">Wasserman, M. and T. Goddard, &ldquo;<a href="http://tools.ietf.org/html/rfc4742">Using the NETCONF Configuration Protocol over Secure SHell (SSH)</a>,&rdquo; RFC&nbsp;4742, December&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4742.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NETCONF-TLS">[NETCONF-TLS]</a></td>
<td class="author-text">Badra, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5539">NETCONF over Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;5539, May&nbsp;2009 (<a href="ftp://ftp.isi.edu/in-notes/rfc5539.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NNTP">[NNTP]</a></td>
<td class="author-text">Feather, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3977">Network News Transfer Protocol (NNTP)</a>,&rdquo; RFC&nbsp;3977, October&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc3977.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NNTP-TLS">[NNTP-TLS]</a></td>
<td class="author-text">Murchison, K., Vinocur, J., and C. Newman, &ldquo;<a href="http://tools.ietf.org/html/rfc4642">Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)</a>,&rdquo; RFC&nbsp;4642, October&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4642.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OCSP">[OCSP]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:rankney@erols.com">Ankney, R.</a>, <a href="mailto:ambarish@valicert.com">Malpani, A.</a>, <a href="mailto:galperin@mycfo.com">Galperin, S.</a>, and <a href="mailto:cadams@entrust.com">C. Adams</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>,&rdquo; RFC&nbsp;2560, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2560.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OPENPGP">[OPENPGP]</a></td>
<td class="author-text">Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;<a href="http://tools.ietf.org/html/rfc4880">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;4880, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4880.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="POP3">[POP3]</a></td>
<td class="author-text"><a href="mailto:jgm+@cmu.edu">Myers, J.</a> and <a href="mailto:mrose@dbc.mtview.ca.us">M. Rose</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1939">Post Office Protocol - Version 3</a>,&rdquo; STD&nbsp;53, RFC&nbsp;1939, May&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc1939.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="PRIVATE">[PRIVATE]</a></td>
<td class="author-text"><a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net">Groot, G.</a>, and <a href="mailto:lear@sgi.com">E. Lear</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>,&rdquo; BCP&nbsp;5, RFC&nbsp;1918, February&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc1918.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="PKIX-OLD">[PKIX-OLD]</a></td>
<td class="author-text"><a href="mailto:housley@spyrus.com">Housley, R.</a>, <a href="mailto:wford@verisign.com">Ford, W.</a>, <a href="mailto:wpolk@nist.gov">Polk, T.</a>, and <a href="mailto:david.solo@citicorp.com">D. Solo</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2459">Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a>,&rdquo; RFC&nbsp;2459, January&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2459.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="S-NAPTR">[S-NAPTR]</a></td>
<td class="author-text">Daigle, L. and A. Newton, &ldquo;<a href="http://tools.ietf.org/html/rfc3958">Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS)</a>,&rdquo; RFC&nbsp;3958, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3958.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SECTERMS">[SECTERMS]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4949.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP">[SIP]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP-CERTS">[SIP-CERTS]</a></td>
<td class="author-text">Gurbani, V., Lawrence, S., and A. Jeffrey, &ldquo;<a href="http://tools.ietf.org/html/rfc5922">Domain Certificates in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;5922, June&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5922.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP-SIPS">[SIP-SIPS]</a></td>
<td class="author-text">Audet, F., &ldquo;<a href="http://tools.ietf.org/html/rfc5630">The Use of the SIPS URI Scheme in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;5630, October&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5630.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP">[SMTP]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;5321, October&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-AUTH">[SMTP-AUTH]</a></td>
<td class="author-text">Siemborski, R. and A. Melnikov, &ldquo;<a href="http://tools.ietf.org/html/rfc4954">SMTP Service Extension for Authentication</a>,&rdquo; RFC&nbsp;4954, July&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4954.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-TLS">[SMTP-TLS]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc3207">SMTP Service Extension for Secure SMTP over Transport Layer Security</a>,&rdquo; RFC&nbsp;3207, February&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3207.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SNMP">[SNMP]</a></td>
<td class="author-text">Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3411">An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3411, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3411.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SNMP-TLS">[SNMP-TLS]</a></td>
<td class="author-text">Hardaker, W., &ldquo;<a href="http://tools.ietf.org/html/rfc5953">Transport Layer Security (TLS) Transport Model for the Simple Network Management Protocol (SNMP)</a>,&rdquo; RFC&nbsp;5953, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5953.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SYSLOG">[SYSLOG]</a></td>
<td class="author-text">Gerhards, R., &ldquo;<a href="http://tools.ietf.org/html/rfc5424">The Syslog Protocol</a>,&rdquo; RFC&nbsp;5424, March&nbsp;2009 (<a href="ftp://ftp.isi.edu/in-notes/rfc5424.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SYSLOG-DTLS">[SYSLOG-DTLS]</a></td>
<td class="author-text">Salowey, J., Petch, T., Gerhards, R., and H. Feng, &ldquo;<a href="http://tools.ietf.org/html/rfc6012">Datagram Transport Layer Security (DTLS) Transport Mapping for Syslog</a>,&rdquo; RFC&nbsp;6012, October&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc6012.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SYSLOG-TLS">[SYSLOG-TLS]</a></td>
<td class="author-text">Miao, F., Ma, Y., and J. Salowey, &ldquo;<a href="http://tools.ietf.org/html/rfc5425">Transport Layer Security (TLS) Transport Mapping for Syslog</a>,&rdquo; RFC&nbsp;5425, March&nbsp;2009 (<a href="ftp://ftp.isi.edu/in-notes/rfc5425.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS">[TLS]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS-EXT">[TLS-EXT]</a></td>
<td class="author-text">3rd, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4366-bis-12.txt">Transport Layer Security (TLS) Extensions: Extension Definitions</a>,&rdquo; draft-ietf-tls-rfc4366-bis-12 (work in progress), September&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4366-bis-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="US-ASCII">[US-ASCII]</a></td>
<td class="author-text">American National Standards Institute, &ldquo;Coded Character Set - 7-bit American Standard Code for Information Interchange,&rdquo; ANSI&nbsp;X3.4, 1986.</td></tr>
<tr><td class="author-text" valign="top"><a name="USINGTLS">[USINGTLS]</a></td>
<td class="author-text"><a href="mailto:chris.newman@innosoft.com">Newman, C.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2595">Using TLS with IMAP, POP3 and ACAP</a>,&rdquo; RFC&nbsp;2595, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2595.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="WSC-UI">[WSC-UI]</a></td>
<td class="author-text">Saldhana, A. and T. Roessler, &ldquo;<a href="http://www.w3.org/TR/2010/WD-wsc-ui-20100309">Web Security Context: User Interface Guidelines</a>,&rdquo; World Wide Web Consortium LastCall&nbsp;WD-wsc-ui-20100309, March&nbsp;2010 (<a href="http://www.w3.org/TR/2010/WD-wsc-ui-20100309">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.500">[X.500]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Overview of concepts, models and services,&rdquo; ITU-T&nbsp;Recommendation X.500, ISO&nbsp;Standard 9594-1, August&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.501">[X.501]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Models,&rdquo; ITU-T&nbsp;Recommendation X.501, ISO&nbsp;Standard 9594-2, August&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.509">[X.509]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks,&rdquo; ITU-T&nbsp;Recommendation X.509, ISO&nbsp;Standard 9594-8, August&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.520">[X.520]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;Information Technology - Open Systems Interconnection - The Directory: Selected attribute types,&rdquo; ITU-T&nbsp;Recommendation X.509, ISO&nbsp;Standard 9594-6, August&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.690">[X.690]</a></td>
<td class="author-text">International Telecommunications Union, &ldquo;Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER),&rdquo; ITU-T&nbsp;Recommendation X.690, ISO&nbsp;Standard 8825-1, August&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPP">[XMPP]</a></td>
<td class="author-text">Saint-Andre, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-xmpp-3920bis-19.txt">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; draft-ietf-xmpp-3920bis-19 (work in progress), November&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-xmpp-3920bis-19.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPP-OLD">[XMPP-OLD]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3920">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; RFC&nbsp;3920, October&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3920.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3920.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3920.xml">XML</a>).</td></tr>
</table>

<a name="prior"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Prior Art</h3>

<p>(This section is non-normative.)
</p>
<p>The recommendations in this document are an abstraction from recommendations in specifications for a wide range of application protocols.  For the purpose of comparison and to delineate the history of thinking about application service identity verification within the IETF, this informative section gathers together prior art by including the exact text from various RFCs (the only modifications are changes to the names of several references to maintain coherence with the main body of this document, and the elision of irrelevant text as marked by the characters "[...]").
</p>
<a name="prior-imap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
IMAP, POP3, and ACAP (1999)</h3>

<p>In 1999, <a class='info' href='#USINGTLS'>[USINGTLS]<span> (</span><span class='info'>Newman, C., &ldquo;Using TLS with IMAP, POP3 and ACAP,&rdquo; June&nbsp;1999.</span><span>)</span></a> specified the following text regarding application service identity verification in IMAP, POP3, and ACAP:
</p>
<p>######
</p>
<p>2.4. Server Identity Check
</p>
<p>During the TLS negotiation, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man-in-the-middle attacks.  Matching is performed according to these rules:
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the connection as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>A "*" wildcard character MAY be used as the left-most name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc. but would not match example.com.
</li>
<li>If the certificate contains multiple names (e.g. more than one dNSName field), then a match with any one of the fields is considered acceptable.
</li>
</ul><p>
        
</p>
<p>If the match fails, the client SHOULD either ask for explicit user confirmation, or terminate the connection and indicate the server's identity is suspect.
</p>
<p>######
</p>
<a name="prior-http"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
HTTP (2000)</h3>

<p>In 2000, <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> specified the following text regarding application service identity verification in HTTP:
</p>
<p>######
</p>
<p>3.1. Server Identity
</p>
<p>In general, HTTP/TLS requests are generated by dereferencing a URI.  As a consequence, the hostname for the server is known to the client.  If the hostname is available, the client MUST check it against the server's identity as presented in the server's Certificate message, in order to prevent man-in-the-middle attacks.
</p>
<p>If the client has external information as to the expected identity of the server, the hostname check MAY be omitted. (For instance, a client may be connecting to a machine whose address and hostname are dynamic but the client knows the certificate that the server will present.) In such cases, it is important to narrow the scope of acceptable certificates as much as possible in order to prevent man in the middle attacks.  In special cases, it may be appropriate for the client to simply ignore the server's identity, but it must be understood that this leaves the connection open to active attack.
</p>
<p>If a subjectAltName extension of type dNSName is present, that MUST be used as the identity. Otherwise, the (most specific) Common Name field in the Subject field of the certificate MUST be used. Although the use of the Common Name is existing practice, it is deprecated and Certification Authorities are encouraged to use the dNSName instead.
</p>
<p>Matching is performed using the matching rules specified by <a class='info' href='#PKIX-OLD'>[PKIX&#8209;OLD]<span> (</span><span class='info'>Housley, R., Ford, W., Polk, T., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and CRL Profile,&rdquo; January&nbsp;1999.</span><span>)</span></a>.  If more than one identity of a given type is present in the certificate (e.g., more than one dNSName name, a match in any one of the set is considered acceptable.) Names may contain the wildcard character * which is considered to match any single domain name component or component fragment. E.g., *.a.com matches foo.a.com but not bar.foo.a.com. f*.com matches foo.com but not bar.com.
</p>
<p>In some cases, the URI is specified as an IP address rather than a hostname. In this case, the iPAddress subjectAltName must be present in the certificate and must exactly match the IP in the URI.
</p>
<p>If the hostname does not match the identity in the certificate, user oriented clients MUST either notify the user (clients MAY give the user the opportunity to continue with the connection in any case) or terminate the connection with a bad certificate error. Automated clients MUST log the error to an appropriate audit log (if available) and SHOULD terminate the connection (with a bad certificate error).  Automated clients MAY provide a configuration setting that disables this check, but MUST provide a setting which enables it.
</p>
<p>Note that in many cases the URI itself comes from an untrusted source. The above-described check provides no protection against attacks where this source is compromised. For example, if the URI was obtained by clicking on an HTML page which was itself obtained without using HTTP/TLS, a man in the middle could have replaced the URI.  In order to prevent this form of attack, users should carefully examine the certificate presented by the server to determine if it meets their expectations.
</p>
<p>######
</p>
<a name="prior-ldap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
LDAP (2000/2006)</h3>

<p>In 2000, <a class='info' href='#LDAP-TLS'>[LDAP&#8209;TLS]<span> (</span><span class='info'>Hodges, J., Morgan, R., and M. Wahl, &ldquo;Lightweight Directory Access Protocol (v3): Extension for Transport Layer Security,&rdquo; May&nbsp;2000.</span><span>)</span></a> specified the following text regarding application service identity verification in LDAP:
</p>
<p>######
</p>
<p>3.6. Server Identity Check
</p>
<p>The client MUST check its understanding of the server's hostname against the server's identity as presented in the server's Certificate message, in order to prevent man-in-the-middle attacks.
</p>
<p>Matching is performed according to these rules:
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the LDAP connection as the value to compare against the server name as expressed in the server's certificate.  The client MUST NOT use the server's canonical DNS name or any other derived form of name.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>The "*" wildcard character is allowed.  If present, it applies only to the left-most name component.
</li>
</ul><p>
        
</p>
<p>E.g. *.bar.com would match a.bar.com, b.bar.com, etc. but not bar.com.  If more than one identity of a given type is present in the certificate (e.g. more than one dNSName name), a match in any one of the set is considered acceptable.
</p>
<p>If the hostname does not match the dNSName-based identity in the certificate per the above check, user-oriented clients SHOULD either notify the user (clients MAY give the user the opportunity to continue with the connection in any case) or terminate the connection and indicate that the server's identity is suspect. Automated clients SHOULD close the connection, returning and/or logging an error indicating that the server's identity is suspect.
</p>
<p>Beyond the server identity checks described in this section, clients SHOULD be prepared to do further checking to ensure that the server is authorized to provide the service it is observed to provide. The client MAY need to make use of local policy information.
</p>
<p>######
</p>
<p>In 2006, <a class='info' href='#LDAP-AUTH'>[LDAP&#8209;AUTH]<span> (</span><span class='info'>Harrison, R., &ldquo;Lightweight Directory Access Protocol (LDAP): Authentication Methods and Security Mechanisms,&rdquo; June&nbsp;2006.</span><span>)</span></a> specified the following text regarding application service identity verification in LDAP:
</p>
<p>######
</p>
<p>3.1.3. Server Identity Check
</p>
<p>In order to prevent man-in-the-middle attacks, the client MUST verify the server's identity (as presented in the server's Certificate message).  In this section, the client's understanding of the server's identity (typically the identity used to establish the transport connection) is called the "reference identity".
</p>
<p>The client determines the type (e.g., DNS name or IP address) of the reference identity and performs a comparison between the reference identity and each subjectAltName value of the corresponding type until a match is produced.  Once a match is produced, the server's identity has been verified, and the server identity check is complete.  Different subjectAltName types are matched in different ways.  Sections 3.1.3.1 - 3.1.3.3 explain how to compare values of various subjectAltName types.
</p>
<p>The client may map the reference identity to a different type prior to performing a comparison.  Mappings may be performed for all available subjectAltName types to which the reference identity can be mapped; however, the reference identity should only be mapped to types for which the mapping is either inherently secure (e.g., extracting the DNS name from a URI to compare with a subjectAltName of type dNSName) or for which the mapping is performed in a secure manner (e.g., using <a class='info' href='#DNSSEC'>[DNSSEC]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a>, or using user- or admin-configured host-to-address/address-to-host lookup tables).
</p>
<p>The server's identity may also be verified by comparing the reference identity to the Common Name (CN) <a class='info' href='#LDAP-SCHEMA'>[LDAP&#8209;SCHEMA]<span> (</span><span class='info'>Sciberras, A., &ldquo;Lightweight Directory Access Protocol (LDAP): Schema for User Applications,&rdquo; June&nbsp;2006.</span><span>)</span></a> value in the last Relative Distinguished Name (RDN) of the subject field of the server's certificate (where "last" refers to the DER-encoded order, not the order of presentation in a string representation of DER-encoded data).  This comparison is performed using the rules for comparison of DNS names in Section 3.1.3.1, below, with the exception that no wildcard matching is allowed.  Although the use of the Common Name value is existing practice, it is deprecated, and Certification Authorities are encouraged to provide subjectAltName values instead.  Note that the TLS implementation may represent DNs in certificates according to X.500 or other conventions.  For example, some X.500 implementations order the RDNs in a DN using a left-to-right (most significant to least significant) convention instead of LDAP's right-to-left convention.
</p>
<p>If the server identity check fails, user-oriented clients SHOULD either notify the user (clients may give the user the opportunity to continue with the LDAP session in this case) or close the transport connection and indicate that the server's identity is suspect.  Automated clients SHOULD close the transport connection and then return or log an error indicating that the server's identity is suspect or both.
</p>
<p>Beyond the server identity check described in this section, clients should be prepared to do further checking to ensure that the server is authorized to provide the service it is requested to provide.  The client may need to make use of local policy information in making this determination.
</p>
<p>3.1.3.1. Comparison of DNS Names
</p>
<p>If the reference identity is an internationalized domain name, conforming implementations MUST convert it to the ASCII Compatible Encoding (ACE) format as specified in Section 4 of RFC 3490 <a class='info' href='#IDNA2003'>[IDNA2003]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a> before comparison with subjectAltName values of type dNSName.  Specifically, conforming implementations MUST perform the conversion operation specified in Section 4 of RFC 3490 as follows:
</p>
<p>
          </p>
<ul class="text">
<li>in step 1, the domain name SHALL be considered a "stored string";
</li>
<li>in step 3, set the flag called "UseSTD3ASCIIRules";
</li>
<li>in step 4, process each label with the "ToASCII" operation; and
</li>
<li>in step 5, change all label separators to U+002E (full stop).
</li>
</ul><p>
        
</p>
<p>After performing the "to-ASCII" conversion, the DNS labels and names MUST be compared for equality according to the rules specified in Section 3 of RFC3490.
</p>
<p>The '*' (ASCII 42) wildcard character is allowed in subjectAltName values of type dNSName, and then only as the left-most (least significant) DNS label in that value.  This wildcard matches any left-most DNS label in the server name.  That is, the subject *.example.com matches the server names a.example.com and b.example.com, but does not match example.com or a.b.example.com.
</p>
<p>3.1.3.2. Comparison of IP Addresses
</p>
<p>When the reference identity is an IP address, the identity MUST be converted to the "network byte order" octet string representation <a class='info' href='#IP'>[IP]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> <a class='info' href='#IPv6'>[IPv6]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a>.  For IP Version 4, as specified in RFC 791, the octet string will contain exactly four octets.  For IP Version 6, as specified in RFC 2460, the octet string will contain exactly sixteen octets.  This octet string is then compared against subjectAltName values of type iPAddress.  A match occurs if the reference identity octet string and value octet strings are identical.
</p>
<p>3.1.3.3. Comparison of Other subjectName Types
</p>
<p>Client implementations MAY support matching against subjectAltName values of other types as described in other documents.
</p>
<p>######
</p>
<a name="prior-smtp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
SMTP (2002/2007)</h3>

<p>In 2002, <a class='info' href='#SMTP-TLS'>[SMTP&#8209;TLS]<span> (</span><span class='info'>Hoffman, P., &ldquo;SMTP Service Extension for Secure SMTP over Transport Layer Security,&rdquo; February&nbsp;2002.</span><span>)</span></a> specified the following text regarding application service identity verification in SMTP:
</p>
<p>######
</p>
<p>4.1 Processing After the STARTTLS Command
</p>
<p>[...]
</p>
<p>The decision of whether or not to believe the authenticity of the other party in a TLS negotiation is a local matter.  However, some general rules for the decisions are:
</p>
<p>
          </p>
<ul class="text">
<li>A SMTP client would probably only want to authenticate an SMTP server whose server certificate has a domain name that is the domain name that the client thought it was connecting to.
</li>
</ul><p>
        
</p>
<p>[...]
</p>
<p>######
</p>
<p>In 2006, <a class='info' href='#SMTP-AUTH'>[SMTP&#8209;AUTH]<span> (</span><span class='info'>Siemborski, R. and A. Melnikov, &ldquo;SMTP Service Extension for Authentication,&rdquo; July&nbsp;2007.</span><span>)</span></a> specified the following text regarding application service identity verification in SMTP:
</p>
<p>######
</p>
<p>14. Additional Requirements When Using SASL PLAIN over TLS
</p>
<p>[...]
</p>
<p>After a successful <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> negotiation, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man-in-the-middle attacks.  If the match fails, the client MUST NOT attempt to authenticate using the SASL PLAIN mechanism.  Matching is performed according to the following rules:
</p>
<p>
          </p>
<blockquote class="text">
<p>The client MUST use the server hostname it used to open the connection as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</p>
<p>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</p>
<p>Matching is case-insensitive.
</p>
<p>A "*" wildcard character MAY be used as the leftmost name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc., but would not match example.com.
</p>
<p>If the certificate contains multiple names (e.g., more than one dNSName field), then a match with any one of the fields is considered acceptable.
</p>
</blockquote><p>
        
</p>
<p>######
</p>
<a name="prior-xmpp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.5"></a><h3>A.5.&nbsp;
XMPP (2004)</h3>

<p>In 2004, <a class='info' href='#XMPP-OLD'>[XMPP&#8209;OLD]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a> specified the following text regarding application service identity verification in XMPP:
</p>
<p>######
</p>
<p>14.2. Certificate Validation
</p>
<p>When an XMPP peer communicates with another peer securely, it MUST validate the peer's certificate.  There are three possible cases:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Case #1:</dt>
<dd>The peer contains an End Entity certificate which appears to be certified by a certification path terminating in a trust anchor (as described in Section 6.1 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>).
</dd>
<dt>Case #2:</dt>
<dd>The peer certificate is certified by a Certificate Authority not known to the validating peer.
</dd>
<dt>Case #3:</dt>
<dd>The peer certificate is self-signed.
</dd>
</dl></blockquote><p>
        
</p>
<p>In Case #1, the validating peer MUST do one of two things:
          </p>
<ol class="text">
<li>Verify the peer certificate according to the rules of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  The certificate SHOULD then be checked against the expected identity of the peer following the rules described in <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, except that a subjectAltName extension of type "xmpp" MUST be used as the identity if present.  If one of these checks fails, user-oriented clients MUST either notify the user (clients MAY give the user the opportunity to continue with the connection in any case) or terminate the connection with a bad certificate error.  Automated clients SHOULD terminate the connection (with a bad certificate error) and log the error to an appropriate audit log.  Automated clients MAY provide a configuration setting that disables this check, but MUST provide a setting that enables it.
</li>
<li>The peer SHOULD show the certificate to a user for approval, including the entire certification path.  The peer MUST cache the certificate (or some non-forgeable representation such as a hash).  In future connections, the peer MUST verify that the same certificate was presented and MUST notify the user if it has changed.
</li>
</ol><p>
        
</p>
<p>In Case #2 and Case #3, implementations SHOULD act as in (2) above.
</p>
<p>######
</p>
<p>Although <a class='info' href='#XMPP-OLD'>[XMPP&#8209;OLD]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a> defined its own rules, <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2010.</span><span>)</span></a> re-uses the rules in this document regarding application service identity verification in XMPP.
</p>
<a name="prior-nntp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.6"></a><h3>A.6.&nbsp;
NNTP (2006)</h3>

<p>In 2006, <a class='info' href='#NNTP-TLS'>[NNTP&#8209;TLS]<span> (</span><span class='info'>Murchison, K., Vinocur, J., and C. Newman, &ldquo;Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a> specified the following text regarding application service identity verification in NNTP:
</p>
<p>######
</p>
<p>5. Security Considerations
</p>
<p>[...]
</p>
<p>During the TLS negotiation, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man-in-the-middle attacks.  Matching is performed according to these rules:
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the connection (or the hostname specified in TLS "server_name" extension <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>) as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>A "*" wildcard character MAY be used as the left-most name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc., but would not match example.com.
</li>
<li>If the certificate contains multiple names (e.g., more than one dNSName field), then a match with any one of the fields is considered acceptable.
</li>
</ul><p>
        
</p>
<p>If the match fails, the client SHOULD either ask for explicit user confirmation or terminate the connection with a QUIT command and indicate the server's identity is suspect.
</p>
<p> Additionally, clients MUST verify the binding between the identity of the servers to which they connect and the public keys presented by those servers.  Clients SHOULD implement the algorithm in Section 6 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> for general certificate validation, but MAY supplement that algorithm with other validation methods that achieve equivalent levels of verification (such as comparing the server certificate against a local store of already-verified certificates and identity bindings).
</p>
<p>######
</p>
<a name="prior-netconf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.7"></a><h3>A.7.&nbsp;
NETCONF (2006/2009)</h3>

<p>In 2006, <a class='info' href='#NETCONF-SSH'>[NETCONF&#8209;SSH]<span> (</span><span class='info'>Wasserman, M. and T. Goddard, &ldquo;Using the NETCONF Configuration Protocol over Secure SHell (SSH),&rdquo; December&nbsp;2006.</span><span>)</span></a> specified the following text regarding application service identity verification in NETCONF:
</p>
<p>######
</p>
<p>6. Security Considerations
</p>
<p>The identity of the server MUST be verified and authenticated by the client according to local policy before password-based authentication data or any configuration or state data is sent to or received from the server.  The identity of the client MUST also be verified and authenticated by the server according to local policy to ensure that the incoming client request is legitimate before any configuration or state data is sent to or received from the client.  Neither side should establish a NETCONF over SSH connection with an unknown, unexpected, or incorrect identity on the opposite side.
</p>
<p>######
</p>
<p>In 2009, <a class='info' href='#NETCONF-TLS'>[NETCONF&#8209;TLS]<span> (</span><span class='info'>Badra, M., &ldquo;NETCONF over Transport Layer Security (TLS),&rdquo; May&nbsp;2009.</span><span>)</span></a> specified the following text regarding application service identity verification in NETCONF:
</p>
<p>######
</p>
<p>3.1. Server Identity
</p>
<p>During the TLS negotiation, the client MUST carefully examine the certificate presented by the server to determine if it meets the client's expectations.  Particularly, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man- in-the-middle attacks.
</p>
<p>Matching is performed according to the rules below (following the example of <a class='info' href='#NNTP-TLS'>[NNTP&#8209;TLS]<span> (</span><span class='info'>Murchison, K., Vinocur, J., and C. Newman, &ldquo;Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a>):
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the connection (or the hostname specified in the TLS "server_name" extension <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>) as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it MUST be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>A "*" wildcard character MAY be used as the leftmost name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc., but would not match example.com.
</li>
<li>If the certificate contains multiple names (e.g., more than one dNSName field), then a match with any one of the fields is considered acceptable.
</li>
</ul><p>
        
</p>
<p>If the match fails, the client MUST either ask for explicit user confirmation or terminate the connection and indicate the server's identity is suspect.
</p>
<p>Additionally, clients MUST verify the binding between the identity of the servers to which they connect and the public keys presented by those servers.  Clients SHOULD implement the algorithm in Section 6 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> for general certificate validation, but MAY supplement that algorithm with other validation methods that achieve equivalent levels of verification (such as comparing the server certificate against a local store of already-verified certificates and identity bindings).
</p>
<p>If the client has external information as to the expected identity of the server, the hostname check MAY be omitted.
</p>
<p>######
</p>
<a name="prior-syslog"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.8"></a><h3>A.8.&nbsp;
Syslog (2009)</h3>

<p>In 2009, <a class='info' href='#SYSLOG-TLS'>[SYSLOG&#8209;TLS]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a> specified the following text regarding application service identity verification in Syslog:
</p>
<p>######
</p>
<p>5.2. Subject Name Authorization
</p>
<p>Implementations MUST support certification path validation <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  In addition, they MUST support specifying the authorized peers using locally configured host names and matching the name against the certificate as follows.
</p>
<p>
          </p>
<ul class="text">
<li>Implementations MUST support matching the locally configured host name against a dNSName in the subjectAltName extension field and SHOULD support checking the name against the common name portion of the subject distinguished name.
</li>
<li>The '*' (ASCII 42) wildcard character is allowed in the dNSName of the subjectAltName extension (and in common name, if used to store the host name), but only as the left-most (least significant) DNS label in that value.  This wildcard matches any left-most DNS label in the server name.  That is, the subject *.example.com matches the server names a.example.com and b.example.com, but does not match example.com or a.b.example.com.  Implementations MUST support wildcards in certificates as specified above, but MAY provide a configuration option to disable them.
</li>
<li>Locally configured names MAY contain the wildcard character to match a range of values.  The types of wildcards supported MAY be more flexible than those allowed in subject names, making it possible to support various policies for different environments.  For example, a policy could allow for a trust-root-based authorization where all credentials issued by a particular CA trust root are authorized.
</li>
<li>If the locally configured name is an internationalized domain name, conforming implementations MUST convert it to the ASCII Compatible Encoding (ACE) format for performing comparisons, as specified in Section 7 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</li>
<li>Implementations MAY support matching a locally configured IP address against an iPAddress stored in the subjectAltName extension.  In this case, the locally configured IP address is converted to an octet string as specified in <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>, Section 4.2.1.6.  A match occurs if this octet string is equal to the value of iPAddress in the subjectAltName extension.
</li>
</ul><p>
        
</p>
<p>######
</p>
<a name="prior-sip"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.9"></a><h3>A.9.&nbsp;
SIP (2010)</h3>

<p>In 2010, <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and A. Jeffrey, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2010.</span><span>)</span></a> specified the following text regarding application service identity verification in SIP:
</p>
<p>######
</p>
<p>7.2. Comparing SIP Identities
</p>
<p>When an implementation (either client or server) compares two values as SIP domain identities:
          </p>
<blockquote class="text">
<p>Implementations MUST compare only the DNS name component of each SIP domain identifier; an implementation MUST NOT use any scheme or parameters in the comparison.
</p>
<p>Implementations MUST compare the values as DNS names, which means that the comparison is case insensitive as specified by <a class='info' href='#DNS-CASE'>[DNS&#8209;CASE]<span> (</span><span class='info'>Eastlake, D., &ldquo;Domain Name System (DNS) Case Insensitivity Clarification,&rdquo; January&nbsp;2006.</span><span>)</span></a>.  Implementations MUST handle Internationalized Domain Names (IDNs) in accordance with Section 7.2 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<p>Implementations MUST match the values in their entirety:
              </p>
<blockquote class="text">
<p>Implementations MUST NOT match suffixes.  For example, "foo.example.com" does not match "example.com".
</p>
<p>Implemenations MUST NOT match any form of wildcard, such as a leading "." or "*." with any other DNS label or sequence of labels.  For example, "*.example.com" matches only "*.example.com" but not "foo.example.com".   Similarly, ".example.com" matches only ".example.com", and does not match "foo.example.com."
                  </p>
<blockquote class="text">
<p><a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> allows the dNSName component to contain a wildcard; e.g., "DNS:*.example.com".  <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>, while not disallowing this explicitly, leaves the interpretation of wildcards to the individual specification.  <a class='info' href='#SIP'>[SIP]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> does not provide any guidelines on the presence of wildcards in certificates.  Through the rule above, this document prohibits such wildcards in certificates for SIP domains.
</p>
</blockquote>
                

</blockquote>
            

</blockquote><p>
        
</p>
<p>######
</p>
<a name="prior-snmp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.10"></a><h3>A.10.&nbsp;
SNMP (2010)</h3>

<p>In 2010, <a class='info' href='#SNMP-TLS'>[SNMP&#8209;TLS]<span> (</span><span class='info'>Hardaker, W., &ldquo;Transport Layer Security (TLS) Transport Model for the Simple Network Management Protocol (SNMP),&rdquo; August&nbsp;2010.</span><span>)</span></a> specified the following text regarding application service identity verification in SNMP:
</p>
<p>######
</p>
<p>If the server's presented certificate has passed certification path validation <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> to a configured trust anchor, and an active row exists with a zero-length snmpTlstmAddrServerFingerprint value, then the snmpTlstmAddrServerIdentity column contains the expected host name.  This expected host name is then compared against the server's certificate as follows:
</p>
<p>
          </p>
<ul class="text">
<li>Implementations MUST support matching the expected host name against a dNSName in the subjectAltName extension field and MAY support checking the name against the CommonName portion of the subject distinguished name.<br />
<br />

</li>
<li>The '*' (ASCII 0x2a) wildcard character is allowed in the dNSName of the subjectAltName extension (and in common name, if used to store the host name), but only as the left-most (least significant) DNS label in that value.  This wildcard matches any left-most DNS label in the server name.  That is, the subject *.example.com matches the server names a.example.com and b.example.com, but does not match example.com or a.b.example.com.  Implementations MUST support wildcards in certificates as specified above, but MAY provide a configuration option to disable them.<br />
<br />

</li>
<li>If the locally configured name is an internationalized domain name, conforming implementations MUST convert it to the ASCII Compatible Encoding (ACE) format for performing comparisons, as specified in Section 7 of <a class='info' href='#PKIX'>[PKIX]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</li>
</ul><p>
        
</p>
<p>If the expected host name fails these conditions then the connection MUST be closed.
</p>
<p>######
</p>
<a name="prior-gist"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.11"></a><h3>A.11.&nbsp;
GIST (2010)</h3>

<p>In 2010, <a class='info' href='#GIST'>[GIST]<span> (</span><span class='info'>Schulzrinne, H. and R. Hancock, &ldquo;GIST: General Internet Signalling Transport,&rdquo; October&nbsp;2010.</span><span>)</span></a> specified the following text regarding application service identity verification in the General Internet Signalling Transport:
</p>
<p>######
</p>
<p>5.7.3.1. Identity Checking in TLS
</p>
<p>After TLS authentication, a node MUST check the identity presented by the peer in order to avoid man-in-the-middle attacks, and verify that the peer is authorised to take part in signalling at the GIST layer.  The authorisation check is carried out by comparing the presented identity with each Authorised Peer Database (APD) entry in turn, as discussed in Section 4.4.2.  This section defines the identity comparison algorithm for a single APD entry.
</p>
<p>For TLS authentication with X.509 certificates, an identity from the DNS namespace MUST be checked against each subjectAltName extension of type dNSName present in the certificate.  If no such extension is present, then the identity MUST be compared to the (most specific) Common Name in the Subject field of the certificate.  When matching DNS names against dNSName or Common Name fields, matching is case- insensitive.  Also, a "*" wildcard character MAY be used as the left- most name component in the certificate or identity in the APD.  For example, *.example.com in the APD would match certificates for a.example.com, foo.example.com, *.example.com, etc., but would not match example.com.  Similarly, a certificate for *.example.com would be valid for APD identities of a.example.com, foo.example.com, *.example.com, etc., but not example.com.
</p>
<p>Additionally, a node MUST verify the binding between the identity of the peer to which it connects and the public key presented by that peer.  Nodes SHOULD implement the algorithm in Section 6 of [PKIX] for general certificate validation, but MAY supplement that algorithm with other validation methods that achieve equivalent levels of verification (such as comparing the server certificate against a local store of already-verified certificates and identity bindings).
</p>
<p>For TLS authentication with pre-shared keys, the identity in the psk_identity_hint (for the server identity, i.e. the Responding node) or psk_identity (for the client identity, i.e. the Querying node) MUST be compared to the identities in the APD.
</p>
<p>######
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Peter Saint-Andre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1899 Wyknoop Street, Suite 600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Denver, CO  80202</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-303-308-3282</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:psaintan@cisco.com">psaintan@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jeff Hodges</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PayPal</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2211 North First Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, California  95131</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Jeff.Hodges@PayPal.com">Jeff.Hodges@PayPal.com</a></td></tr>
</table>
</body></html>
