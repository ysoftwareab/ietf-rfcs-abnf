


WG                                                               R. Mahy
Internet-Draft                                              SIP Edge LLC
Expires: January 9, 2008                                    July 8, 2007


   A Location Dereference Event Package using the Session Initiation
                             Protocol (SIP)
                 draft-mahy-geopriv-sip-loc-pkg-02.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on January 9, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This document describes a Session Initiation Protocol (SIP) event
   package to dereference raw location data about named SIP resources
   (as opposed to presence data with embedded filtered location) as a
   GEOPRIV Using Protocol.  The resulting location information is
   conveyed in existing location formats wrapped in GEOPRIV privacy
   extensions to the Presence Information Document Format (PIDF-LO).  In
   the envisioned usage, location disclosure is limited to voluntary
   disclosure to the target of its own location or to a trusted service



Mahy                     Expires January 9, 2008                [Page 1]

Internet-Draft           Location Event Package                July 2007


   (such as a presence server) which enforces the target's privacy rules
   on the target's behalf.


Table of Contents

   1.  Conventions . . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   3.  Event Package Formal Definition . . . . . . . . . . . . . . . . 3
     3.1.  Event Package Name  . . . . . . . . . . . . . . . . . . . . 3
     3.2.  Event Package Parameters  . . . . . . . . . . . . . . . . . 4
     3.3.  SUBSCRIBE Bodies  . . . . . . . . . . . . . . . . . . . . . 4
     3.4.  Subscription Duration . . . . . . . . . . . . . . . . . . . 4
     3.5.  NOTIFY Bodies . . . . . . . . . . . . . . . . . . . . . . . 4
     3.6.  Subscriber generation of SUBSCRIBE requests . . . . . . . . 4
     3.7.  Notifier processing of SUBSCRIBE requests . . . . . . . . . 5
     3.8.  Notifier generation of NOTIFY requests  . . . . . . . . . . 5
     3.9.  Subscriber processing of NOTIFY requests  . . . . . . . . . 5
     3.10. Handling of Forked Requests . . . . . . . . . . . . . . . . 5
     3.11. Rate of notifications . . . . . . . . . . . . . . . . . . . 6
     3.12. State Agents and Lists  . . . . . . . . . . . . . . . . . . 6
     3.13. Behavior of a Proxy Server  . . . . . . . . . . . . . . . . 6
   4.  Security Considerations . . . . . . . . . . . . . . . . . . . . 6
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 6
     5.1.  SIP Event Package Registration for 'location' . . . . . . . 7
   6.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . 7
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . 7
     7.1.  Normative References  . . . . . . . . . . . . . . . . . . . 7
     7.2.  Informational References  . . . . . . . . . . . . . . . . . 8
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . . . 8
   Intellectual Property and Copyright Statements  . . . . . . . . . . 9




















Mahy                     Expires January 9, 2008                [Page 2]

Internet-Draft           Location Event Package                July 2007


1.  Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC-2119 [5].


2.  Introduction

   The GEOPRIV working group has developed a set of requirements [8] for
   providing raw location by reference in PIDF-LO [3] format.  In many
   of the use cases discussed asynchronous notifications of changes to
   that location is also a requirement.  For example this allows a
   presence server for a target or other trusted entity to be fetch
   location about that target from a Location Generator without
   requiring the target (possibly a battery operated wireless device) to
   continually poll and republish its location data to the trusted
   server.

   This document defines a SIP [1] event package [2] for location data
   to meet these requirements for nodes that require asynchronous
   notification, or simply those that already implement SIP.

   One difficult part about asynchronous notification of location
   information is that many forms of location are measured as a
   continous gradient.  Unlike notications using discreet quanties, it
   is difficult to know when a change in location is large enough to
   warrant notifications.  Moreover, different applications require a
   wide variety of location resolutions.  Any optimization made for one
   application would ultimately result in wasteful polling or a sluggish
   user interface for other applications.

   The mechanism described here uses location filters [4] in XML [6]
   documents which limit location notification to events which are of
   relevance to the subscriber.  These filters are provided in the body
   of SIP subscription requests and persist for the duration of the
   subscription or until they are changed in an updated SIP subscription
   request with a replacement filter.


3.  Event Package Formal Definition

3.1.  Event Package Name

   This document defines a SIP Event Package as defined in RFC 3265 [2].
   The event-package token name for this package is:

       "location"



Mahy                     Expires January 9, 2008                [Page 3]

Internet-Draft           Location Event Package                July 2007


3.2.  Event Package Parameters

   This package does not define any event package parameters.

3.3.  SUBSCRIBE Bodies

   For this package the subscriber SHOULD include an 'application/
   location-delta-filter+xml' SUBSCRIBE body in the format defined in
   [4], which is used to filter notifications.  Subscribers normally
   includes a location filter with at least one filter event in every
   new subscription request, or when the subscriber wants to modify the
   current filter.  A filter is not necessary, nor desirable in an
   unsubscription or subscription refresh request.

3.4.  Subscription Duration

   Subscriptions to this event package MAY range from minutes to weeks.
   Subscriptions in hours or days are more typical and are RECOMMENDED.
   The default subscription duration for this event package is one hour.

3.5.  NOTIFY Bodies

   Both subscribers and notifiers MUST implement PIDF-LO.  Notifiers MAY
   send location information in any format acceptable to the subscriber
   (based on the subscriber inclusion of these formats in an Accept
   header). "application/cpim-pidf+xml"

   A future extension MAY define other NOTIFY bodies.  If no "Accept"
   header is present in the SUBSCRIBE, the body type defined in this
   document MUST be assumed.

3.6.  Subscriber generation of SUBSCRIBE requests

   Each new subscribe request establishes a notification filter.
   Subsequent subscriptions keep the same filter unless a new filter is
   provided.  If a new filter is provided in a subscription, it
   completely replaces the previous filter.

   Subscriber User Agents will typically SUBSCRIBE to location
   information for a period of hours or days, and automatically attempt
   to re-SUBSCRIBE well before the subscription is completely expired.
   If re-subscription fails, the Subscriber SHOULD periodically retry
   again until a subscription is successful, taking care to backoff to
   avoid network congestion.  If a subscription has expired, new re-
   subscriptions MUST use a new Call-ID.

   The Subscriber MAY also explicitly fetch the current status at any
   time.  The subscriber SHOULD renew its subscription immediately after



Mahy                     Expires January 9, 2008                [Page 4]

Internet-Draft           Location Event Package                July 2007


   a reboot, or when the subscriber's network connectivity has just been
   re-established.

   The Subscriber MUST be prepared to receive and process a NOTIFY with
   new state immediately after sending a new SUBSCRIBE, a SUBSCRIBE
   renewal, an unsubscribe, or a fetch; or at any time during the
   subscription.

3.7.  Notifier processing of SUBSCRIBE requests

   When a Notifier receives SUBSCRIBE messages with the location event-
   type, it MUST authenticate the subscription request.  If
   authentication is successful, the Notifier SHOULD authorize the
   subscriber.  Note that in some cases, the SIP URI itself may act as a
   form of "metro pass" or "pawn ticket" authentication.  If no
   location-filter is provided, the Notifier SHOULD reject the
   subscription with a 403 Forbidden response.  The Notifier MAY further
   limit the duration of the subscription to an administrator defined
   amount of time as described in SIP Events.

   For new subscriptions, or anytime the location-filter is updated by
   the subscriber, the notifier MUST include appropriate containment
   locations for every feature mentioned in an enterOrExit element in
   the corresponding filter.  If the subscriber is not authorized to
   receive this information, the notifier MUST either include each these
   locations with the value of undefined, or alternatively, send a 403
   Forbidden response to the subscriber.

3.8.  Notifier generation of NOTIFY requests

   Immediately after a subscription is accepted, the Notifier MUST send
   a NOTIFY with the current location information as appropriate based
   on the identity of the subscriber.  This allows the Subscriber to
   resynchronize its state.  When the location changes sufficiently to
   trigger any of the filter events in the current location-filter for
   the subscription, the notifier sends a notification with the new
   location information.

3.9.  Subscriber processing of NOTIFY requests

   No special processing is defined here.

3.10.  Handling of Forked Requests

   Forked requests are not allowed for this event type.






Mahy                     Expires January 9, 2008                [Page 5]

Internet-Draft           Location Event Package                July 2007


3.11.  Rate of notifications

   A Notifier MAY choose to hold NOTIFY requests in "quarantine" for a
   short administrator-defined period (milliseconds or seconds) when the
   location is changing rapidly.  Requests in the quarantine which
   become invalid are replaced by newer notifications, thus reducing the
   total volume of notifications.  This behavior is encouraged for
   implementations with heavy interactive use.

   Notifiers SHOULD NOT generate NOTIFY requests more frequently than
   ten per second, nor more frequently than thirty in a thirty-second
   period of time.

3.12.  State Agents and Lists

   This document does not preclude implementations from building state
   agents which support this event package.

3.13.  Behavior of a Proxy Server

   There are no additional requirements on a SIP Proxy, other than to
   transparently forward the SUBSCRIBE and NOTIFY methods as required in
   SIP.


4.  Security Considerations

   Location information is typically very privacy sensitive.  At
   minimum, subscriptions to this event package MUST be authenticated
   and SHOULD be properly authorized.  Furthermore, GEOPRIV requires
   that notifications MUST be encrypted and integrity protected using
   either end-to-end mechanisms, or the hop-by-hop protection afforded
   messages sent to SIPS URIs.

   Implementations of this event package MUST implement the sips:
   scheme, and MUST implement the security requirements described in
   PIDF-LO [3].  In addition, all SIP implementations are already
   requried to implement Digest authentication.

   Additional privacy and security considerations are discussed in
   detail in [7] and in SIP [1] and SIP Events [2].


5.  IANA Considerations







Mahy                     Expires January 9, 2008                [Page 6]

Internet-Draft           Location Event Package                July 2007


5.1.  SIP Event Package Registration for 'location'

         Package name: location

         Type: package

         Contact: [Mahy]

         Published Specification: This document.


6.  Acknowledgments

   Thanks to Allan Thompson, James Winterbottom, and Martin Thomson for
   their comments.


7.  References

7.1.  Normative References

   [1]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
        Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP:
        Session Initiation Protocol", RFC 3261, June 2002.

   [2]  Roach, A., "Session Initiation Protocol (SIP)-Specific Event
        Notification", RFC 3265, June 2002.

   [3]  Peterson, J., "A Presence-based GEOPRIV Location Object Format",
        draft-ietf-geopriv-pidf-lo-03 (work in progress),
        September 2004.

   [4]  Mahy, R., "A Document Format for Filtering and Reporting
        Location Notications in the  Presence Information Document
        Format Location Object (PIDF-LO)",
        draft-ietf-geopriv-loc-filters-01 (work in progress),
        March 2007.

   [5]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", BCP 14, RFC 2119, March 1997.

   [6]  Bray, T., Paoli, J., Sperberg-McQueen, C., and E. Maler,
        "Extensible Markup Language (XML) 1.0 (2nd ed)", W3C REC-xml,
        October 2000, <http://www.w3.org/TR/REC-xml>.

   [7]  Winterbottom, J., "GEOPRIV PIDF-LO Usage Clarification,
        Considerations and Recommendations",
        draft-winterbottom-geopriv-pdif-lo-profile-00 (work in



Mahy                     Expires January 9, 2008                [Page 7]

Internet-Draft           Location Event Package                July 2007


        progress), February 2005.

7.2.  Informational References

   [8]  Marshall, R., "Requirements for a Location-by-Reference
        Mechanism used in Location  Configuration and Conveyance",
        draft-marshall-geopriv-lbyr-requirements-01 (work in progress),
        March 2007.


Author's Address

   Rohan Mahy
   SIP Edge LLC

   Email: rohan@ekabal.com



































Mahy                     Expires January 9, 2008                [Page 8]

Internet-Draft           Location Event Package                July 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Mahy                     Expires January 9, 2008                [Page 9]

