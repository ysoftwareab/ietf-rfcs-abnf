


Network Working Group                                       O. Saarenmaa
Internet-Draft                                                  F-Secure
Intended status: Informational                              J. Galbraith
Expires: August 11, 2007                                VanDyke Software
                                                        February 7, 2007


                      X.509 authentication in SSH
                    draft-saarenmaa-ssh-x509-00.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on August 11, 2007.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This document specifies how X.509 certificates and signatures are
   used within the Secure Shell protocol for user and server
   authentication.







Saarenmaa & Galbraith    Expires August 11, 2007                [Page 1]

Internet-Draft         X.509 authentication in SSH         February 2007


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.  Conventions Used in This Document . . . . . . . . . . . . . . . 3
   3.  Certificate validation  . . . . . . . . . . . . . . . . . . . . 3
   4.  Use in SSH Protocol . . . . . . . . . . . . . . . . . . . . . . 3
     4.1.  x509v3-sign-rsa . . . . . . . . . . . . . . . . . . . . . . 3
     4.2.  x509v3-sign-dss . . . . . . . . . . . . . . . . . . . . . . 4
   5.  Implementation Considerations . . . . . . . . . . . . . . . . . 4
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 5
   7.  Security Considerations . . . . . . . . . . . . . . . . . . . . 5
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . 5
     8.1.  Normative References  . . . . . . . . . . . . . . . . . . . 5
     8.2.  Informative References  . . . . . . . . . . . . . . . . . . 6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . . . 6
   Intellectual Property and Copyright Statements  . . . . . . . . . . 7



































Saarenmaa & Galbraith    Expires August 11, 2007                [Page 2]

Internet-Draft         X.509 authentication in SSH         February 2007


1.  Introduction

   The Secure Shell protocol can use public keys for both server and
   user authentication.  However, particularly for server
   authentication, plain public keys lack a good method of verifying
   that the the key provided really does belong to the host asserting
   ownership.  X.509v3 certificates can address this problem in
   environments where a PKI infrastructure is available.


2.  Conventions Used in This Document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].


3.  Certificate validation

   Implementations are expected to follow the basic certificate and
   certificate path validation guidelines defined in [RFC3280].  This
   document does not define new X.509v3 extensions.

   Users deploying certificates have often had little control over the
   capabilities of CAs available to them.  Implementations of this
   specification MAY include configuration knobs to disable checks
   required by this specification in order to permit use with inflexible
   and/or noncompliant CAs.  Before disabling any checks the
   administrators and users need to understand the purposes of those
   checks as well as the security implications that may raise when they
   are disabled.


4.  Use in SSH Protocol

   Key type names are of the form "x509v3-sign*".  This document defines
   two new key formats.  As opposed to formats defined in [RFC4253],
   these new formats do NOT include the key type or length of any fields
   inside the key blob.  Implementations are expected to have obtained
   these values out-of-band.

4.1.  x509v3-sign-rsa

   Certificates that use the RSA public key algorithm MUST use the
   "x509v3-sign-rsa" key format.  This format is as follows:

       byte[n]   DER encoded X.509v3 certificate data




Saarenmaa & Galbraith    Expires August 11, 2007                [Page 3]

Internet-Draft         X.509 authentication in SSH         February 2007


   Signing using this key format, uses the certificate's private key, in
   exactly the same manner specified for "ssh-rsa" public keys in
   [RFC4253].  That is to say, signing and verifying using this key
   format is performed according to the RSASSA-PKCS1-v1_5 scheme in
   [RFC3447] using the SHA-1 hash [FIPS-180-2].

   The signature format for x509v3-sign-rsa-sha1 certificates is the
   "ssh-rsa" signing format specified in [RFC4253].  This format is as
   follows:

       string    "ssh-rsa"
       string    rsa_signature_blob

   The value for 'rsa_signature_blob' is encoded as a string containing
   s (which is an integer, without lengths or padding, unsigned and in
   network byte order).

4.2.  x509v3-sign-dss

   Certificates that use the DSA public key algorithm MUST use the
   "x509v3-sign-dss" key format.  This format is as follows:

       byte[n]   DER encoded X.509v3 certificate data

   Signing and verifying using this key format, uses the certificate's
   private key, in exactly the same manner specified for "ssh-dss"
   public keys in [RFC4253].  That is to say, signing and verifying
   using this key format is done according to the Digital Signature
   Standard [FIPS-186-2] using the SHA-1 hash [FIPS-180-2].

   The signature format for x509v3-sign-dss-sha1 certificates is the
   "ssh-dss" signing format specified in [RFC4253].  This format is as
   follows:

       string    "ssh-dss"
       string    dss_signature_blob

   The value for 'dss_signature_blob' is encoded as a string containing
   r followed by s (which are 160-bit integers, without lengths or
   padding, unsigned and in network byte order).


5.  Implementation Considerations

   Implementations should be careful when using X.509v3 certificates as
   hostkeys.  If the peer does not implement the required algorithms to
   validate both the end-entity certificate and all certificates in the
   chain, it MUST disconnect.  There is no way to renegotiate the key



Saarenmaa & Galbraith    Expires August 11, 2007                [Page 4]

Internet-Draft         X.509 authentication in SSH         February 2007


   during key exchange.


6.  IANA Considerations

   This document adds "x509v3-sign-rsa" and "x509v3-sign-dss" to the SSH
   publickey type registry.


7.  Security Considerations

   PKI is an extremely complex topic, and care must be taken by both
   implementors and deployers to understand the complex interactions
   involved.  This document intentionally leaves the details of
   certificate validation and PKI profile to use unspecified.

   Implementations should carefully validate the certificate, including
   but not limited to, certificate expiration, certificate signature,
   certification revocation status etcetera.  Implementations must also
   be careful to validate all these properties of all certificates in
   the path leading to a trust anchor.  For more information
   implementors should refer to [ITU.X509.2000] and [RFC3280].


8.  References

8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3447]  Jonsson, J. and B. Kaliski, "Public-Key Cryptography
              Standards (PKCS) #1: RSA Cryptography Specifications
              Version 2.1", RFC 3447, February 2003.

   [RFC4253]  Ylonen, T. and C. Lonvick, "The Secure Shell (SSH)
              Transport Layer Protocol", RFC 4253, January 2006.

   [FIPS-180-2]
              National Institute of Standards and Technology, "Secure
              Hash Standard (SHS)", Federal Information Processing
              Standards Publication 180-2, August 2002.

   [FIPS-186-2]
              National Institute of Standards and Technology, "Digital
              Signature Standard (DSS)", Federal Information Processing
              Standards Publication 186-2, January 2000.




Saarenmaa & Galbraith    Expires August 11, 2007                [Page 5]

Internet-Draft         X.509 authentication in SSH         February 2007


8.2.  Informative References

   [RFC3280]  Housley, R., Polk, W., Ford, W., and D. Solo, "Internet
              X.509 Public Key Infrastructure Certificate and
              Certificate Revocation List (CRL) Profile", RFC 3280,
              April 2002.

   [ITU.X509.2000]
              International Telecommunications Union, "Information
              technology - Open Systems Interconnection - The Directory:
              Public-key and attribute certificate frameworks", ITU-
              T Recommendation X.509, ISO Standard 9594-8, March 2000.

Trademark notice

   "ssh" is a registered trademark in the United States and/or other
   countries.


Authors' Addresses

   Oskari Saarenmaa
   F-Secure
   Tammasaarenkatu 7
   PL 24
   Helsinki  00181
   FI

   Email: oskari.saarenmaa@f-secure.com


   Joseph Galbraith
   VanDyke Software
   4848 Tramway Ridge Blvd
   Suite 101
   Albuquerque, NM  87111
   US

   Phone: +1 505 332 5700
   Email: galb-list@vandyke.com











Saarenmaa & Galbraith    Expires August 11, 2007                [Page 6]

Internet-Draft         X.509 authentication in SSH         February 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Saarenmaa & Galbraith    Expires August 11, 2007                [Page 7]


