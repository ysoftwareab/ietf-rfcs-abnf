other                = ALPHA / DIGIT / "+" / "-" / "."

any                  = other / ":" / "[" / "]" / "/" / "_" / '"' / <">
                          / "#" / "(" / ")" / "="

hexoctet             = HEXDIG HEXDIG

decimaloctet         = DIGIT / DIGIT DIGIT
                          / DIGIT DIGIT DIGIT
                           ;  0 - 255, no leading 0 allowed

digitstring          = 1*DIGIT

otherstring          = 1*other

hexstring            = 1*hexoctet
dotstring            = decimaloctet "." dotstring
                          / decimaloctet "." decimaloctet

dothexstring         = dotstring / hexstring

presentation-address = [[[ psel "/" ] ssel "/" ] tsel "/" ]
                          network-address-list

network-address-list = network-address "_" network-address-list
                          / network-address

psel                 = selector

ssel                 = selector

tsel                 = selector

selector             = '"' otherstring '"'
                            ;  IA5
                            ;  For characters not in this string use hex
                          / "#" digitstring
                            ;  US GOSIP
                          / "'" hexstring   "'H"
                            ;  Hex
                          / ""
                            ;  Empty but present

network-address      =   "NS" "+" dothexstring
                              ;  Concrete Binary Representation
                              ;  This is the compact encoding
                            / afi "+" idi [ "+" dsp ]
                              ;  A user oriented form
                            / idp "+" hexstring
                              ;  ISO 8348 Compatibility

idp                  = digitstring
                            ;  This is afi + idi

dsp                  = "d" digitstring
                            ; Abstract Decimal
                          / "x" dothexstring
                            ; Abstract Binary
                          / "l" otherstring
                            ; IA5:  local form only
                          / dsp_rfc1006
                          / "X.25(80)" "+" prefix "+" dte
                            [ "+" cudf-or-pid "+" hexstring   ]
                          / "ECMA-117-Binary" "+" hexstring
                            "+" hexstring "+" hexstring
                          / "ECMA-117-Decimal" "+" digitstring "+"
                            digitstring "+" digitstring

dsp_rfc1006          = "RFC-1006" "+" [prefix] "+" iphost
                          [ "+" port [ "+" tset ]]
                           ;  The "tset" and the "prefix" MUST NOT be used
                           ;    with "IPV6ADDR" or "IPV6FULL" AFIs.
                           ;
                           ;  The port MUST NOT be used with "IPV6ADDR" AFI.
                           ;
                           ;  The "prefix" is REQUIRED for all other AFIs.

idi                  = digitstring / ""
                           ; IDI can be empty, e.g. for AFI "LOCAL"

afi                  = "X121" / "DCC" / "TELEX" / "PSTN" / "ISDN"
                          / "ICD" / "LOCAL" / ipv6_afi

ipv6_afi             = "IPV6ADDR" / "IPV6FULL"
                           ;  "IPV6ADDR" is AFI=35 as defined in section 6
                           ;    of RFC 1888.
                           ;  "IPV6FULL" is for the AFI defined in
                           ;    draft-melnikov-nsap-ipv6-XX.txt

ipv6reference        = "[" IPv6address "]"

prefix               = DIGIT DIGIT

iphost               = hostname | IPv4address | ipv6reference
                           ;  domain (e.g., example.com) or
                           ;  dotted decimal form of IPv4 address
                           ;  (e.g., 10.0.0.6) or an IPv6 address
                           ;  (e.g., [1234::567f:890a:bcde])

port                 = digitstring
                           ; 1-65535

tset                 = digitstring

dte                  = digitstring

cudf-or-pid          = "CUDF" / "PID"


macro_name           = otherstring

