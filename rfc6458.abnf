cmsgptr = CMSG_NXTHDR(&msg, cmsgptr)) {
ptr = CMSG_DATA(cmsgptr);
total = CMSG_SPACE(sizeof(struct sctp_sndrcvinfo)) +
           CMSG_SPACE(sizeof(struct in6_pktinfo));

buf = malloc(total);

opt_len = (socklen_t)sizeof(status);
snp = buf;

sac = &snp->sn_assoc_change;
spc = &snp->sn_paddr_change;
sin = (struct sockaddr_in *)&spc->spc_aaddr;
ap = inet_ntop(AF_INET, &sin->sin_addr,
                        addrbuf, INET6_ADDRSTRLEN);
sin6 = (struct sockaddr_in6 *)&spc->spc_aaddr;
ap = inet_ntop(AF_INET6, &sin6->sin6_addr,
                        addrbuf, INET6_ADDRSTRLEN);
sad = &snp->sn_adaptation_event;
timeout = TIMEOUT;
on = 1;
flags = 0;
fromlen = (socklen_t)sizeof(addr);
infolen = (socklen_t)sizeof(info);
infotype = 0;
n = sctp_recvv(sd, &iov, 1,
                      &addr.sa, &fromlen,
                      &info, &infolen, &infotype,
                      &flags);

ap = inet_ntop(AF_INET, &addr.sin.sin_addr,
                               addrbuf, INET6_ADDRSTRLEN);
port = ntohs(addr.sin.sin_port);
ap = inet_ntop(AF_INET6, &addr.sin6.sin6_addr,
                               addrbuf, INET6_ADDRSTRLEN);
port = ntohs(addr.sin6.sin6_port);
