webpackage = [
  magic1: h'F0 9F 8C 90 F0 9F 93 A6',  ; &#127760;&#128230; in UTF-8.
  section-offsets: { * (($section-name .within tstr) => uint) },
  sections: [ *$section ],
  length: uint,                        ; Total number of bytes in the package.
  magic2: h'F0 9F 8C 90 F0 9F 93 A6',  ; &#127760;&#128230; in UTF-8.
tail = (
  length: uint,                        ; Total number of bytes in the package.
  magic2: h'F0 9F 8C 90 F0 9F 93 A6',  ; &#127760;&#128230; in UTF-8.
section-offsets = { * tstr => uint },

index = [* [resource-key: http-headers,
               offset: uint,
               ? length: uint] ]

http-headers = bstr

signed-manifest = {
  manifest: manifest,
  certificates: [+ certificate],
  signatures: [+ signature]
manifest = {
  metadata: manifest-metadata,
  resource-hashes: {* hash-algorithm => [hash-value]},
  ? subpackages: [* subpackage],
manifest-metadata = {
  date: time,
  origin: uri,
  * tstr => any,
hash-value = bstr

certificate = bstr

signature = {
  ; This is the index of the certificate within the certificates array to use
  ; to validate the signature.
  keyIndex: uint,
  signature: bstr,
subpackage = [
     resource: resource-key,
     validation: {
       ? hash: {+ hash-algorithm => hash-value},
       ? notbefore: time,
     }
response = [response-headers: http-headers, body: bstr]

resource-bytes = [
     request: [
       *(header-name: bstr, header-value: bstr)
     ],
     response-headers: [
       *(header-name: bstr, header-value: bstr)
     ],
     response-body: bstr
