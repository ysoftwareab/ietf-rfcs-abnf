EMK = Archie-PRF(KDK,
            AuthNonce | PeerNonce | "Archie session key",
            32)

TSK = Archie-PRF(SK, AddrS | AddrP | "Archie transient EAP key",
                       128)

S = S[1] S[2] ... S[n-1] S'[n], with S[1], S[2], ..., S[n-1]
IV = AES-Encrypt(K, S[i] XOR IV)
Output = Output | AES-CBC-MAC-128(K, i | S | Length)
MAC1 = AES-CBC-MAC-96(KCK, Archie-Request(Type...AuthID) |
                Archie-Response(Type...Binding))

MAC = AES-CBC-MAC-96(KCK, Archie-Request(Type...AuthID) |
             Archie-Response(Type...Bindings))

MAC = AES-CBC-MAC-96(KCK, Archie-Request(Type...AuthID) |
             Archie-Response(NonceP) |
             Archie-Confirm(Type...Bindings))

MAC = AES-CBC-MAC-96(KCK, Archie-Finish(Type...SessionID))

