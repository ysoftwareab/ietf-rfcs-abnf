inTok = readToken();

clientCred = mgr.createCredential(null /*default princ*/,
                   GSSCredential.INDEFINITE_LIFETIME /* max lifetime */,
                   mech /* mechanism to use */,
                   GSSCredential.INITIATE_ONLY /* init context */);
context = mgr.createContext(peer, mech, gssCred,
                      GSSContext.INDEFINITE_LIFETIME/*lifetime*/);

outToken = context.initSecContext(inToken, 0,
                                                   inToken.length);

inToken = readGSSToken();
buffer = readFromFile();

outToken = context.wrap(buffer, 0, buffer.length,
                                       messgInfo);

inToken = readGSSToken();
buffer = context.unwrap(inToken, 0,
                             inToken.length, messgInfo);
mgr = GSSManager.getInstance();

name = mgr.createName(serviceName,
                     GSSName.NT_HOSTBASED_SERVICE);

cred = mgr.createCredential(name,
                     GSSCredential.INDEFINITE_LIFETIME,
                     null,
                     GSSCredential.ACCEPT_ONLY);

inToken = readGSSToken();
outToken = context.acceptSecContext(inToken,
                                                0, inToken.length);
inToken = readGSSToken();

buffer = context.unwrap(inToken, 0,
                               inToken.length, supplInfo);
buffer = serverProcess(buffer);

outToken = context.wrap(buffer, 0, buffer.length,
                                              supplInfo);
