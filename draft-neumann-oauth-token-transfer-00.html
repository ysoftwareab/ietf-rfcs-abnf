<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Secure Token
    Transfer Protocol (STTP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Secure Token
    Transfer Protocol (STTP)">
<meta name="keywords" content="token transfer">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">N. Neumann, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">F. Tegeler</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">X. Fu</td></tr>
<tr><td class="header">Expires: April 21, 2011</td><td class="header">University of Goettingen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 18, 2010</td></tr>
</table></td></tr></table>
<h1><br />Secure Token
    Transfer Protocol (STTP)<br />draft-neumann-oauth-token-transfer-00</h1>

<h3>Abstract</h3>

<p>The Secure Token Transfer Protocol (STTP) provides the means for two
      entities to exchange a set of tokens that is needed to perform a certain
      task such as authentication. The exact context of the tokens and their
      further usage is outside the scope of the protocol. STTP is intended to
      be employed to in case a mechanism to securely transfer tokens is
      missing for a particular scenario or context within other protocols.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 21, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Notation and Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Terminology<br />
<a href="#anchor4">2.</a>&nbsp;
Usage Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
OAuth<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.</a>&nbsp;
Dynamic Password Provisioning<br />
<a href="#anchor7">3.</a>&nbsp;
Protocol details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.1.</a>&nbsp;
STTP over HTTP<br />
<a href="#anchor9">4.</a>&nbsp;
Token Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.1.</a>&nbsp;
OAuth<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.</a>&nbsp;
Generic Tokens<br />
<a href="#anchor12">5.</a>&nbsp;
Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.1.</a>&nbsp;
Server authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.2.</a>&nbsp;
Client authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.2.1.</a>&nbsp;
Authentication Method Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.2.2.</a>&nbsp;
Authenticated Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.2.3.</a>&nbsp;
SCRAM-SHA-1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.2.4.</a>&nbsp;
RSA-SHA1<br />
<a href="#anchor19">6.</a>&nbsp;
Commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.1.</a>&nbsp;
GETTOKENS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.1.1.</a>&nbsp;
Arguments<br />
<a href="#anchor22">7.</a>&nbsp;
Arguments<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">7.1.</a>&nbsp;
Service-URI<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">7.2.</a>&nbsp;
Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">7.3.</a>&nbsp;
Server-Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">7.4.</a>&nbsp;
Client-Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec_reflection-key">7.5.</a>&nbsp;
Reflection-Key<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">7.5.1.</a>&nbsp;
TLS-based transport<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">7.5.2.</a>&nbsp;
Other transport<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">7.5.3.</a>&nbsp;
Manual verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">7.6.</a>&nbsp;
Auth-Scheme<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">7.7.</a>&nbsp;
Client-Proof<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">7.8.</a>&nbsp;
Auth-Proposals<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">7.9.</a>&nbsp;
Iteration-Count<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">7.10.</a>&nbsp;
Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">7.11.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">7.11.1.</a>&nbsp;
Plain<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">7.11.2.</a>&nbsp;
OAuth<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">7.12.</a>&nbsp;
Expires-In<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">7.13.</a>&nbsp;
OAuth-Grant-Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">7.14.</a>&nbsp;
OAuth-Client-Id<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">7.15.</a>&nbsp;
OAuth-Client-Secret<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">7.16.</a>&nbsp;
OAuth-Code<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">7.17.</a>&nbsp;
OAuth-Access-Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">7.18.</a>&nbsp;
OAuth-Refresh-Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">7.19.</a>&nbsp;
IToken<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">7.20.</a>&nbsp;
AToken<br />
<a href="#anchor47">8.</a>&nbsp;
Response Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">8.1.</a>&nbsp;
Informational 1xx<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor49">8.2.</a>&nbsp;
Successful 2xx<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor50">8.2.1.</a>&nbsp;
200 OK<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor51">8.3.</a>&nbsp;
Redirection 3xx<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor52">8.4.</a>&nbsp;
Client Error 4xx<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor53">8.4.1.</a>&nbsp;
400 Bad Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#response_code_401">8.4.2.</a>&nbsp;
401 Authentication Required<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor54">8.4.3.</a>&nbsp;
402 Not Responsible<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">8.4.4.</a>&nbsp;
403 Authentication Failed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor56">8.4.5.</a>&nbsp;
404 No Common Authentication Scheme<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor57">8.5.</a>&nbsp;
Server Error 5xx<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor58">8.5.1.</a>&nbsp;
501 Not Implemented<br />
<a href="#anchor59">9.</a>&nbsp;
Security considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor60">9.1.</a>&nbsp;
Token security<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor61">9.2.</a>&nbsp;
Man-in-the-middle attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor62">9.3.</a>&nbsp;
Privacy protection<br />
<a href="#rfc.references1">10.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Overview</h3>

<p>Tokens are commonly used in access authentication and authorization,
      for example, in a rather generic way in form of usernames and passwords
      or in more complex ways such as OAuth access tokens. The Secure Token
      Transfer Protocol (STTP) provides means to securely transfer such access
      tokens between different entities that might be involved in the
      provisioning of such tokens. While tokens are commonly required for
      authentication and authorization purposes within protocols, they do not
      always provide means to securely transport or provision them in every
      scenario. If such means are missing for a specific protocol or scenario,
      STTP can be used for such tasks.
</p>
<p><a class='info' href='#fig_example'>Figure&nbsp;1<span> (</span><span class='info'>STTP Example</span><span>)</span></a> shows an example where STTP is
      used to transport a set of tokens between three entities to access a
      resource that is available on a fourth entity. Client A wants to access
      a protected resource on a server. Between Client A and the server an
      application specific authentication or authorization protocol is
      employed (e.g. HTTP Basic Access Authentication or OAuth) within an
      application specific workflow to access a protected resource (A). The
      server in turn requests an authentication or authorization protocol
      specific set of tokens in order to grant the Client access to the
      requested resource (B). As a set of appropriate tokens is not available
      on Client A it uses STTP to request a set of tokens from Client B which
      is under the control and trusted by the resource owner (C). Client A and
      Client B can be running in different applications and even on different
      devices. If the user approves the token request, Client B will again use
      STTP to request a set of tokens that matches the request from Client A
      from the appropriate authentication or authorization server (D). The
      corresponding request can be authenticated within STTP if the server
      requires so. If the user is authorized to access the protected resource
      the authentication or authorization server will issue a corresponding
      set of tokens that are opaque to STTP (E). Client B transfers this set
      of tokens to Client A (F) which in turn can use it in a protocol
      specific way to authenticate or authorize the access request to the
      protected resource (G).
</p><br /><hr class="insert" />
<a name="fig_example"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>                                                            ----+
+----------+                                +-----------------+ |Appl.
| Client A |--(A) Access request ----------&gt;|    Resource     | |spec.
|          |&lt;-(B) Access token req. --------|                 | |prot.
|(Consumer)|--(G) Access request + token --&gt;|     Server      | |
+----------+                                +-----------------+ |
  |      ^                                                  ----+
  |      |                                                  ----+
 (C) GETTOKENS                                                  |
  |      |                                                      |
  |     (F) 200 OK + tokens                                     |
  |      |                                                      |STTP
  V      |                                                      |
+----------+                                +-----------------+ |
| Client B |--(D) GETTOKENS ---------------&gt;| Authentication/ | |
|(Resource |                                | Authorization   | |
|  owner)  |&lt;-(E) 200 OK + tokens ----------| Server          | |
+----------+                                +-----------------+ |
                                                            ----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: STTP Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Notation and Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>The following terminology is used throughout this document:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Token</dt>
<dd>A data string that is required by another
            protocol to perform a specific task such as authentication or
            authorization. The exact context and the further use of tokens is
            outside the scope of this document. Tokens are opaque to STTP.
</dd>
<dt>Client</dt>
<dd>The entity requesting a set of tokens.
</dd>
<dt>Server</dt>
<dd>The entity that a set of tokens is requested
            from.
</dd>
</dl></blockquote>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Usage Scenarios</h3>

<p>This document addresses a number of particular scenarios where STTP
      could be used that are detailed below.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
OAuth</h3>

<p>The OAuth 2.0 Protocol <a class='info' href='#I-D.ietf-oauth-v2'>[I&#8209;D.ietf&#8209;oauth&#8209;v2]<span> (</span><span class='info'>Hammer-Lahav, E., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Protocol,&rdquo; July&nbsp;2010.</span><span>)</span></a>
        specifies a workflow that requires end-user authorization. To acquire
        end-user authorization an application needs to either access a HTTP
        resource (the end-user authorization endpoint) with an appropriate
        user-agent or have access to the user's credentials and perform HTTP
        Basic authentication. In cases where an application does not have
        access to such an appropriate user-agent or where HTTP Basic
        authentication is not supported, STTP can be used to request the
        corresponding OAuth tokens.
</p>
<p>OAuth also requires the transfer of an Access Grant and an Access
        Token between the entity accessing the resource server and the
        application accessing the authorization server. In scenarios where
        these entities are not part of the same application, STTP can be used
        to transfer the tokens securely between applications even if they are
        running on different hosts (e.g. the authorizing application is
        running on a mobile device).
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Dynamic Password Provisioning</h3>

<p>Passwords as shared secrets are very common for authentication and
        authorization. While in many cases they are pre-established, STTP can
        be used to dynamically provision passwords for specific scenarios. An
        example scenario is the generation of one-time-passwords that can be
        used to access services over an untrusted link or using an untrusted
        device. For example, a user can use a trusted mobile device that
        connects over a secure low-bandwidth link to the authentication and
        authorization server to retrieve a (one time) token that he can use to
        access a service on a public Internet terminal that uses a non-secured
        WiFi connection. In such a scenario the application on the public
        terminal could use STTP to request a set of tokens from the user's
        device which in turn uses STTP to retrieve the tokens (after a
        successful authentication) from the authentication and authorization
        server.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol details</h3>

<p>To transfer a set of tokens a STTP client contacts a STTP server over
      an appropriate protocol and they exchanges a set of requests and
      responses. A request is a command string followed by a number of
      arguments and a response is a numeric code together with a textual
      representation followed by a number of arguments. Within one connection
      multiple requests and responses can be exchanged until either the client
      or the server terminate the connection.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>GETTOKENS
Type: OAuth
OAuth-Grant-Type: authorization_code
OAuth-Client-Id: s6BhdRkqt3
OAuth-Client-Secret: gX1fBat3bV
OAuth-Code: i1WsRn1uB

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Example of a request message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>200 OK
Type: OAuth
OAuth-Access-Token: SlAV32hkKG
OAuth-Refresh-Token: 8xLOxBtZp8
Expires-In: 3600

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Example of a response message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p>
<p>
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
STTP over HTTP</h3>

<p>STTP can be used over HTTP(s). When using STTP over HTTP(s) a
        command MUST be included in the entity-body of a HTTP "POST" request
        with the "application/x-www-form-urlencoded" content-type.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>POST /resource HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

GETTOKENS
Type: Plain
Identifier: john.doe@example.com

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;STTP over HTTP example request&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Token Types</h3>

<p>STTP supports a number of different token types.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
OAuth</h3>

<p>OAuth tokens are OAuth access grant tokens that can be further used
        by an application to gain access to a resource that is protected using
        the OAuth protocol.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Generic Tokens</h3>

<p>Generic tokens are sets of each an identifier token (e.g. a
        username) and an authentication token (e.g. a password) that be
        further used by an application to gain access to a username/password
        protected resource.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Authentication</h3>

<p>STTP delegates server authentication to the (optionally) underlying
      TLS protocol. This document does describe its own methods to perform
      client authentication. Currently, client authentication via
      public/private key cryptography and password-based authentication using
      the Salted Challenge Response Authentication Mechanism (SCRAM) is
      supported.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Server authentication</h3>

<p>Server authentication is performed using certificates during the
        TLS handshake (see <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>, Section 7.4.2.). If
        the server did not authentication itself during the TLS handshake, the
        STTP client MAY terminate the connection if it requires server
        authentication.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Client authentication</h3>

<p>If a server requires client authentication for a particular
        command, it will send a "Authentication Required" response message
        (see <a class='info' href='#response_code_401'>Section&nbsp;8.4.2<span> (</span><span class='info'>401 Authentication Required</span><span>)</span></a>) on receiving a command
        message that does not include sufficient arguments to authenticate the
        client. The server MUST include a Server-Nonce argument in the
        response message.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Authentication Method Negotiation</h3>

<p>To negotiate an authentication method, the client includes an
          Auth-Proposals argument in a command message which contains a list
          of supported authentication methods. If the client expects that an
          authentication will be required, for example, for the first command
          message of an STTP session, it can effectively save one
          protocol-round-trip by including an Auth-Proposals argument in the
          initial command message instead of waiting for an "Authentication
          Required" response message. A command message that includes an
          Auth-Proposals argument MUST also include a Client-Nonce
          argument.
</p>
<p>When the server receives a command message that includes an
          Auth-Proposals argument and the server does indeed require client
          authentication, it MUST choose one of the proposals and return a
          "Authentication Required" response message with an appropriate
          Auth-Scheme argument and the corresponding arguments that are
          required for the particular authentication method including the
          Client-Nonce. If the server does require client authentication but
          does not support any of the offered authentication methods it MUST
          respond with a "No Common Authentication Scheme" message. If the
          server does not require client authentication but the command
          message includes an Auth-Proposals argument, the server MUST ignore
          the argument.
</p>
<p>When selecting an authentication methods the server SHOULD assume
          that the list of authentication proposals is ordered by client
          preference. The server SHOULD try to honor the client preferences by
          selecting the first authentication methods on the list that the
          server supports. However, operational or administrative directives
          MAY implement a server-side preference list (for example, by ranking
          the different authentication methods by the server load they induce)
          which CAN be used to override the client preferences.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Authenticated Request</h3>

<p>To successfully complete an authentication, the client must
          compose an authenticated command message. An authenticated command
          message is a command message that includes a valid Client-Proof
          argument. The Client-Proof is an authentication method specific
          string that is computed over the particular command message. Please
          refer to the details of the authentication methods for the details
          how the Client-Proof is calculated. The input string for the
          calculation of the Client-Proof MUST be identical to the command
          message that the Client-Proof is valid for exclusive of the
          Client-Proof argument itself. Besides the Client-Proof argument, an
          authenticated command message MUST also include a Server-Nonce
          argument that reflects the Server-Nonce that was included by the
          server in the initial "Authentication Required" response message, a
          Client-Nonce argument, and a Reflection-Key argument.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
SCRAM-SHA-1</h3>

<p>SCRAM authentication is based on the Salted Challenge Response
          Authentication Mechanism (SCRAM) as described in <a class='info' href='#RFC5802'>[RFC5802]<span> (</span><span class='info'>Newman, C., Menon-Sen, A., Melnikov, A., and N. Williams, &ldquo;Salted Challenge Response Authentication Mechanism (SCRAM) SASL and GSS-API Mechanisms,&rdquo; July&nbsp;2010.</span><span>)</span></a> with the AuthMessage being the
          authenticated command message itself (without the Client-Proof
          argument). SCRAM is only used to authenticate the client.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.4"></a><h3>5.2.4.&nbsp;
RSA-SHA1</h3>

<p>Authentication based on Section 8.2. of <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> (RSASSA-PKCS1-v1_5) with the message to be
          signed (M) being the authenticated command message (without the
          Client-Proof argument).
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Commands</h3>

<p>
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
GETTOKENS</h3>

<p>The GETTOKENS command is used by an agent to request a token pair
        for a particular service URI.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Arguments</h3>

<p>A client MUST include the following arguments in every GETTOKENS
          command:</p>
<ul class="text">
<li>Service-URI
</li>
</ul>

<p>A client CAN include the following arguments in a GETTOKENS
          command:</p>
<ul class="text">
<li>Auth-Proposals
</li>
<li>Client-Nonce
</li>
<li>Reflection-Key
</li>
<li>...
</li>
</ul>

<p>
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Arguments</h3>

<p>A STTP command can have a number of arguments. Arguments consist of
      an identifier followed by a colon (":") and the argument value. An
      argument is terminated by a line break. Basically 4.2 in <a class='info' href='#RFC2661'>[RFC2661]<span> (</span><span class='info'>Townsley, W., Valencia, A., Rubens, A., Pall, G., Zorn, G., and B. Palter, &ldquo;Layer Two Tunneling Protocol &quot;L2TP&quot;,&rdquo; August&nbsp;1999.</span><span>)</span></a>
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Service-URI</h3>

<p>The particular service URI that the current command pertains to.
        Within the context of a GETTOKENS command this is the service URI that
        the client is requesting a set of tokens for.
</p>
<p>The Service-URI argument MUST follow the syntax described in <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>. When determining if a Service-URI matches a
        valid resource, a server MUST follow the rules for URI comparison for
        the particular service context (e.g. <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>
        for HTTP resources). If no service specific rules exists, a server
        MUST use a case-sensitive octet-by-octet comparison of the given URI
        with the following exceptions:</p>
<ul class="text">
<li>Comparisons of scheme names MUST be case-insensitive;
</li>
<li>Comparisons of host names MUST be case-insensitive;
</li>
<li>A port that is empty or not given is equivalent to the default
            port for the particular scheme;
</li>
<li>An empty path component is equivalent to the root path "/".
</li>
</ul><p>Characters that are not classified as "reserved" by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> are equivalent to their corresponding
        percent-encoding ("%" HEXDIG HEXDIG).
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Identifier</h3>

<p>The identifier token (e.g. a username) of the entity that the
        current exchange is intended for (either a user or another STTP
        agent).
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Server-Nonce</h3>

<p>A nonce value
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Client-Nonce</h3>

<p>A nonce value
</p>
<a name="sec_reflection-key"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Reflection-Key</h3>

<p>To prevent man-in-the-middle attacks during authenticated requests,
        STTP introduces a Reflection-Key. The Reflection-Key argument is
        included in an authenticated request and reflects the server that the
        client is talking to. If a server receives a Reflection-Key that
        doesn't match it's own properties, it MUST terminate the connection.
        The actual value of the Reflection-Key is dependent on the protocol
        that STTP is run over.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5.1"></a><h3>7.5.1.&nbsp;
TLS-based transport</h3>

<p>When STTP is run over a TLS-based protocol such as HTTPS the
          Reflection-Key argument is the SHA-1 fingerprint of the public key
          that was used to establish the TLS connection.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5.2"></a><h3>7.5.2.&nbsp;
Other transport</h3>

<p>When STTP is run over other transport protocols the
          Reflection-Key argument is the SHA-1 hash of the IP-Address and port
          number that was used to initiate the connection.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5.3"></a><h3>7.5.3.&nbsp;
Manual verification</h3>

<p>In n-party scenarios where a STTP server is used to request a
          token on behalf on another client (e.g. a mobile device is used to
          request a token for an untrusted terminal) the STTP server and the
          STTP client SHOULD present the user with a human readable form of
          the Reflection-Key. This allows the user to manually verify that
          both Reflection-Keys match and to prevent a man-in-the-middle
          attack.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Auth-Scheme</h3>

<p>The authentication scheme that is used in the request.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Client-Proof</h3>

<p>The client-side result of an authentication run.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.8"></a><h3>7.8.&nbsp;
Auth-Proposals</h3>

<p>Comma separated list of authentication schemes that are supported
        by the client to perform client authentication. MUST be included in a
        request that follows a "Authentication Required" response for the same
        service URI.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.9"></a><h3>7.9.&nbsp;
Iteration-Count</h3>

<p>Integer value
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.10"></a><h3>7.10.&nbsp;
Message</h3>

<p>A message which contains more verbose information and that is
        intended to be displayed to the end user.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.11"></a><h3>7.11.&nbsp;
Type</h3>

<p>The type of tokens that are being transferred.</p>
<ul class="text">
<li>PLAIN
</li>
<li>OAuth
</li>
</ul>

<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.11.1"></a><h3>7.11.1.&nbsp;
Plain</h3>

<p>If the Type argument is set to Plain, the tokens that are being
          requested/transferred are generic tokens.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.11.2"></a><h3>7.11.2.&nbsp;
OAuth</h3>

<p>If the Type argument is set to Plain, the tokens that are being
          requested/transferred are OAuth tokens.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.12"></a><h3>7.12.&nbsp;
Expires-In</h3>

<p>Number of seconds the transferred tokens are still valid for.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.13"></a><h3>7.13.&nbsp;
OAuth-Grant-Type</h3>

<p>
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.14"></a><h3>7.14.&nbsp;
OAuth-Client-Id</h3>

<p>
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.15"></a><h3>7.15.&nbsp;
OAuth-Client-Secret</h3>

<p>
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.16"></a><h3>7.16.&nbsp;
OAuth-Code</h3>

<p>
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.17"></a><h3>7.17.&nbsp;
OAuth-Access-Token</h3>

<p>
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.18"></a><h3>7.18.&nbsp;
OAuth-Refresh-Token</h3>

<p>
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.19"></a><h3>7.19.&nbsp;
IToken</h3>

<p>Generic identifier token (e.g. username).
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.20"></a><h3>7.20.&nbsp;
AToken</h3>

<p>Generic authentication token (e.g. password).
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Response Codes</h3>

<p>A server's response starts with a response code that reflects the
      outcome of the last client request. The available response codes are
      described in this section including the arguments that are valid for
      each response.
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Informational 1xx</h3>

<p>Currently no use.
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Successful 2xx</h3>

<p>
</p>
<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2.1"></a><h3>8.2.1.&nbsp;
200 OK</h3>

<p>
</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Redirection 3xx</h3>

<p>
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Client Error 4xx</h3>

<p>
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.1"></a><h3>8.4.1.&nbsp;
400 Bad Request</h3>

<p>
</p>
<a name="response_code_401"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.2"></a><h3>8.4.2.&nbsp;
401 Authentication Required</h3>

<p>
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.3"></a><h3>8.4.3.&nbsp;
402 Not Responsible</h3>

<p>
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.4"></a><h3>8.4.4.&nbsp;
403 Authentication Failed</h3>

<p>
</p>
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.5"></a><h3>8.4.5.&nbsp;
404 No Common Authentication Scheme</h3>

<p>
</p>
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Server Error 5xx</h3>

<p>
</p>
<a name="anchor58"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5.1"></a><h3>8.5.1.&nbsp;
501 Not Implemented</h3>

<p>
</p>
<a name="anchor59"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security considerations</h3>

<p>
</p>
<a name="anchor60"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Token security</h3>

<p>Currently STTP relies on the transport protocol to protect the
        tokens. STTP MUST be used over a secure transport protocol such as
        HTTPS if the tokens are to be protected from eavesdropping.
</p>
<a name="anchor61"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Man-in-the-middle attacks</h3>

<p>The goal of an adversary in STTP is to obtain a valid set of tokens
        pair which he can use to authenticate as the user or to obtain the
        user's credentials themselves. There are two possible attacks if an
        adversary successfully tricks a client to connect to a fraudulent
        server: either the adversary continues with a phishing attack with the
        goal to obtain user credentials or he switches to a man-in-the-middle
        attack to gain access to a valid set of tokens that are being
        transferred. In case he continues the phishing attack the fraudulent
        server is setup to successfully complete the user authentication even
        if the credentials cannot be verified. However, STTP only supports a
        very selective number of authentication methods that do not rely on
        shared secrets. Neither of the methods supported provide the party
        that a user is authenticating to with any data that can be used to
        impersonate the user. In case the attacker switches to a
        man-in-the-middle attack the STTP authentication that is being relayed
        from the attacker to the proper STTP server will fail since the
        Reflection-Key attribute (c.p. <a class='info' href='#sec_reflection-key'>Section&nbsp;7.5<span> (</span><span class='info'>Reflection-Key</span><span>)</span></a>) during the authentication doesn't
        match. However in cases where no user authentication is used, STTP
        relies on user interaction to manually compare the
        Reflection-Keys.
</p>
<a name="anchor62"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Privacy protection</h3>

<p>To protect the users privacy against eavesdroppers, a secure
        transport protocol such as TLS-based transports must be used. If such
        a secure transport is not used, STTP discloses privacy-relevant
        information such as the URI that tokens are being requested for and
        the username.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a></td>
<td class="author-text">Hammer-Lahav, E., Recordon, D., and D. Hardt, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-10.txt">The OAuth 2.0 Protocol</a>,&rdquo; draft-ietf-oauth-v2-10 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2661">[RFC2661]</a></td>
<td class="author-text"><a href="mailto:townsley@cisco.com">Townsley, W.</a>, <a href="mailto:vandys@cisco.com">Valencia, A.</a>, <a href="mailto:acr@del.com">Rubens, A.</a>, <a href="mailto:gurdeep@microsoft.com">Pall, G.</a>, <a href="mailto:gwz@acm.org">Zorn, G.</a>, and <a href="mailto:palter@zev.net">B. Palter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2661">Layer Two Tunneling Protocol "L2TP"</a>,&rdquo; RFC&nbsp;2661, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3447">[RFC3447]</a></td>
<td class="author-text">Jonsson, J. and B. Kaliski, &ldquo;<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>,&rdquo; RFC&nbsp;3447, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3447.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5802">[RFC5802]</a></td>
<td class="author-text">Newman, C., Menon-Sen, A., Melnikov, A., and N. Williams, &ldquo;<a href="http://tools.ietf.org/html/rfc5802">Salted Challenge Response Authentication Mechanism (SCRAM) SASL and GSS-API Mechanisms</a>,&rdquo; RFC&nbsp;5802, July&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5802.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Niklas Neumann (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of
      Goettingen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Computer Networks Group</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Goldschmidtstrasse 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Goettingen  37077</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:neumann@cs.uni-goettingen.de">neumann@cs.uni-goettingen.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Florian Tegeler</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of
      Goettingen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Computer Networks Group</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Goldschmidtstrasse 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Goettingen  37077</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tegeler@cs.uni-goettingen.de">tegeler@cs.uni-goettingen.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Xiaoming Fu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of
      Goettingen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Computer Networks Group</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Goldschmidtstrasse 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Goettingen  37077</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fu@cs.uni-goettingen.de">fu@cs.uni-goettingen.de</a></td></tr>
</table>
</body></html>
