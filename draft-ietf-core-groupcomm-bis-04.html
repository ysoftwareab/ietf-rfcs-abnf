<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Group Communication for the Constrained Application Protocol (CoAP)</title>
<meta content="Esko Dijk" name="author">
<meta content="Chonggang Wang" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="
       This document specifies the use of the Constrained Application Protocol (CoAP) for group communication, including the use of UDP/IP multicast as the default underlying data transport. Both unsecured and secured CoAP group communication are specified. Security is achieved by use of the Group Object Security for Constrained RESTful Environments (Group OSCORE) protocol. The target application area of this specification is any group communication use cases that involve resource-constrained devices or networks that support CoAP. This document replaces RFC7390, while it updates RFC7252 and RFC7641. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-groupcomm-bis-04" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 57.0.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-core-groupcomm-bis-04-is69u2vf.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Group Communication for CoAP</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Dijk, et al.</td>
<td class="center">Expires 13 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-groupcomm-bis-04</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc7390" class="eref">7390</a> (if approved)</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7252" class="eref">7252</a>, <a href="https://www.rfc-editor.org/rfc/rfc7641" class="eref">7641</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-12" class="published">12 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-13">13 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Dijk</div>
<div class="org">IoTconsultancy.nl</div>
</div>
<div class="author">
      <div class="author-name">C. Wang</div>
<div class="org">InterDigital</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Group Communication for the Constrained Application Protocol (CoAP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the use of the Constrained Application Protocol (CoAP) for group communication, including the use of UDP/IP multicast as the default underlying data transport. Both unsecured and secured CoAP group communication are specified. Security is achieved by use of the Group Object Security for Constrained RESTful Environments (Group OSCORE) protocol. The target application area of this specification is any group communication use cases that involve resource-constrained devices or networks that support CoAP. This document replaces RFC7390, while it updates RFC7252 and RFC7641.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  CORE Working Group mailing list (core@ietf.org),
  which is archived at <a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/core-wg/groupcomm-bis">https://github.com/core-wg/groupcomm-bis</a>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-scope" class="xref">Scope</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-group-definition-and-group-" class="xref">Group Definition and Group Configuration</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-group-definition" class="xref">Group Definition</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-coap-group" class="xref">CoAP Group</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-application-group" class="xref">Application Group</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="xref">2.1.3</a>.  <a href="#name-security-group" class="xref">Security Group</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a href="#section-2.1.4" class="xref">2.1.4</a>.  <a href="#name-relations-between-group-typ" class="xref">Relations Between Group Types</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-group-configuration" class="xref">Group Configuration</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-group-naming" class="xref">Group Naming</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-group-creation-and-membersh" class="xref">Group Creation and Membership</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="xref">2.2.3</a>.  <a href="#name-group-discovery" class="xref">Group Discovery</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="xref">2.2.4</a>.  <a href="#name-group-maintenance" class="xref">Group Maintenance</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-coap-usage-in-group-communi" class="xref">CoAP Usage in Group Communication</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-request-response-model" class="xref">Request/Response Model</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-general" class="xref">General</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-response-suppression" class="xref">Response Suppression</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-repeating-a-request" class="xref">Repeating a Request</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="xref">3.1.4</a>.  <a href="#name-request-response-matching-a" class="xref">Request/Response Matching and Distinguishing Responses</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a href="#section-3.1.5" class="xref">3.1.5</a>.  <a href="#name-token-reuse" class="xref">Token Reuse</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.1.2.6">
                    <p id="section-toc.1-1.3.2.1.2.6.1"><a href="#section-3.1.6" class="xref">3.1.6</a>.  <a href="#name-client-handling-of-multiple" class="xref">Client Handling of Multiple Responses With Same Token</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-caching" class="xref">Caching</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-freshness-model" class="xref">Freshness Model</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-validation-model" class="xref">Validation Model</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-uri-path-selection" class="xref">URI Path Selection</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-port-selection-for-udp-tran" class="xref">Port Selection for UDP Transport</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-proxy-operation" class="xref">Proxy Operation</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-forward-proxies" class="xref">Forward-Proxies</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-reverse-proxies" class="xref">Reverse-Proxies</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-congestion-control" class="xref">Congestion Control</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-observing-resources" class="xref">Observing Resources</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-block-wise-transfer" class="xref">Block-Wise Transfer</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-transport-protocols" class="xref">Transport Protocols</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.9.2.1">
                    <p id="section-toc.1-1.3.2.9.2.1.1"><a href="#section-3.9.1" class="xref">3.9.1</a>.  <a href="#name-udp-ipv6-multicast-transpor" class="xref">UDP/IPv6 Multicast Transport</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.9.2.2">
                    <p id="section-toc.1-1.3.2.9.2.2.1"><a href="#section-3.9.2" class="xref">3.9.2</a>.  <a href="#name-udp-ipv4-multicast-transpor" class="xref">UDP/IPv4 Multicast Transport</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.9.2.3">
                    <p id="section-toc.1-1.3.2.9.2.3.1"><a href="#section-3.9.3" class="xref">3.9.3</a>.  <a href="#name-6lowpan" class="xref">6LoWPAN</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.9.2.4">
                    <p id="section-toc.1-1.3.2.9.2.4.1"><a href="#section-3.9.4" class="xref">3.9.4</a>.  <a href="#name-other-transports" class="xref">Other Transports</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="xref">3.10</a>. <a href="#name-interworking-with-other-pro" class="xref">Interworking with Other Protocols</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.10.2.1">
                    <p id="section-toc.1-1.3.2.10.2.1.1"><a href="#section-3.10.1" class="xref">3.10.1</a>.  <a href="#name-mld-mldv2-igmp-igmpv3" class="xref">MLD/MLDv2/IGMP/IGMPv3</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.10.2.2">
                    <p id="section-toc.1-1.3.2.10.2.2.1"><a href="#section-3.10.2" class="xref">3.10.2</a>.  <a href="#name-rpl" class="xref">RPL</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3.2.10.2.3">
                    <p id="section-toc.1-1.3.2.10.2.3.1"><a href="#section-3.10.3" class="xref">3.10.3</a>.  <a href="#name-mpl" class="xref">MPL</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-unsecured-group-communicati" class="xref">Unsecured Group Communication</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-secured-group-communication" class="xref">Secured Group Communication using Group OSCORE</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-group-oscore" class="xref">Group OSCORE</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-secure-group-maintenance" class="xref">Secure Group Maintenance</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-proxy-security" class="xref">Proxy Security</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-coap-nosec-mode" class="xref">CoAP NoSec Mode</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-group-oscore-2" class="xref">Group OSCORE</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-group-key-management" class="xref">Group Key Management</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-source-authentication" class="xref">Source Authentication</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-countering-attacks" class="xref">Countering Attacks</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-risk-of-amplification" class="xref">Risk of Amplification</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-replay-of-non-confirmable-m" class="xref">Replay of Non-Confirmable Messages</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-use-of-coap-no-response-opt" class="xref">Use of CoAP No-Response Option</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-6lowpan-and-mpl" class="xref">6LoWPAN and MPL</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="xref">6.7</a>.  <a href="#name-wi-fi" class="xref">Wi-Fi</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="xref">6.8</a>.  <a href="#name-monitoring" class="xref">Monitoring</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.8.2.1">
                    <p id="section-toc.1-1.6.2.8.2.1.1"><a href="#section-6.8.1" class="xref">6.8.1</a>.  <a href="#name-general-monitoring" class="xref">General Monitoring</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6.2.8.2.2">
                    <p id="section-toc.1-1.6.2.8.2.2.1"><a href="#section-6.8.2" class="xref">6.8.2</a>.  <a href="#name-pervasive-monitoring" class="xref">Pervasive Monitoring</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-use-cases" class="xref">Use Cases</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-discovery" class="xref">Discovery</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#appendix-A.1.1" class="xref">A.1.1</a>.  <a href="#name-distributed-device-discover" class="xref">Distributed Device Discovery</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#appendix-A.1.2" class="xref">A.1.2</a>.  <a href="#name-distributed-service-discove" class="xref">Distributed Service Discovery</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#appendix-A.1.3" class="xref">A.1.3</a>.  <a href="#name-directory-discovery" class="xref">Directory Discovery</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-operational-phase" class="xref">Operational Phase</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#appendix-A.2.1" class="xref">A.2.1</a>.  <a href="#name-actuator-group-control" class="xref">Actuator Group Control</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#appendix-A.2.2" class="xref">A.2.2</a>.  <a href="#name-device-group-status-request" class="xref">Device Group Status Request</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#appendix-A.2.3" class="xref">A.2.3</a>.  <a href="#name-network-wide-query" class="xref">Network-wide Query</a></p>
</li>
                  <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#appendix-A.2.4" class="xref">A.2.4</a>.  <a href="#name-network-wide-group-notifica" class="xref">Network-wide / Group Notification</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-software-update" class="xref">Software Update</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-multi-etag-option" class="xref">Multi-ETag Option</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-option-definition" class="xref">Option Definition</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-encoding-of-server-addressi" class="xref">Encoding of Server Addressing Information</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#appendix-B.3" class="xref">B.3</a>.  <a href="#name-processing-on-the-client-si" class="xref">Processing on the Client Side</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#appendix-B.4" class="xref">B.4</a>.  <a href="#name-processing-on-the-server-si" class="xref">Processing on the Server Side</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#appendix-B.5" class="xref">B.5</a>.  <a href="#name-coap-option-numbers-registr" class="xref">CoAP Option Numbers Registry</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-document-updates" class="xref">Document Updates</a></p>
<ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-version-03-to-04" class="xref">Version -03 to -04</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-version-02-to-03" class="xref">Version -02 to -03</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-version-01-to-02" class="xref">Version -01 to -02</a></p>
</li>
              <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-C.4" class="xref">C.4</a>.  <a href="#name-version-00-to-01" class="xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-D" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="chap-intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies group communication using the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, together with UDP/IP multicast as the default transport for CoAP group communication messages. CoAP is a RESTful communication protocol that is used in resource-constrained nodes, and in resource-constrained networks where packet sizes should be small. This area of use is summarized as Constrained RESTful Environments (CoRE).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">One-to-many group communication can be achieved in CoAP, by a client using UDP/IP multicast data transport to send multicast CoAP request messages. In response, each server in the addressed group sends a response message back to the client over UDP/IP unicast. Notable CoAP implementations supporting group communication include the framework "Eclipse Californium" 2.0.x <span>[<a href="#Californium" class="xref">Californium</a>]</span> from the Eclipse Foundation and the "Implementation of CoAP Server &amp; Client in Go" <span>[<a href="#Go-OCF" class="xref">Go-OCF</a>]</span> from the Open Connectivity Foundation (OCF).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Both unsecured and secured CoAP group communication are specified in this document. Security is achieved by using Group Object Security for Constrained RESTful Environments (Group OSCORE) <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, which in turn builds on Object Security for Constrained Restful Environments (OSCORE) <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>. This method provides end-to-end application-layer security protection of CoAP messages, by using CBOR Object Signing and Encryption (COSE) <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span><span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">All guidelines in <span>[<a href="#RFC7390" class="xref">RFC7390</a>]</span> are updated by this document, which replaces and obsoletes <span>[<a href="#RFC7390" class="xref">RFC7390</a>]</span>. Furthermore, this document updates <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, by specifying: a group request/response model; a response validation model for responses to group requests; and the use of Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> to achieve security for CoAP group communication. Finally, this document also updates <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>, by defining the multicast usage of the CoAP Observe Option for both the GET and FETCH methods.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">All sections in the body of this document are normative, while appendices are informative. For additional background about use cases for CoAP group communication in resource-constrained devices and networks, see <a href="#appendix-usecases" class="xref">Appendix A</a>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="scope">
<section id="section-1.1">
        <h3 id="name-scope">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<p id="section-1.1-1">For group communication, only those solutions that use CoAP messages over a "one-to-many" (i.e., non-unicast) transport protocol are in the scope of this document. There are alternative methods to achieve group communication using CoAP, using unicast only. One example is Publish-Subscribe <span>[<a href="#I-D.ietf-core-coap-pubsub" class="xref">I-D.ietf-core-coap-pubsub</a>]</span> which uses a central broker server that CoAP clients access via unicast communication. These alternative methods may be usable for the same or similar use cases as the ones targeted in this document.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document defines UDP/IP multicast as the default transport protocol for CoAP group requests, as in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. Other transport protocols (which may include broadcast, non-IP multicast, geocast, etc.) are not described in detail and are left for future work. Although UDP/IP multicast transport is assumed in most of the text in this document, we expect many of the considerations for UDP/IP multicast can be re-used for alternative transport protocols.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Furthermore, this document defines Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> as the default group communication security solution for CoAP. Security solutions for group communication and configuration other than Group OSCORE are left for future work. General principles for secure group configuration are in scope.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL"
in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">This specification requires readers to be familiar with CoAP terminology <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. Terminology related to group communication is defined in <a href="#sec-groupdef" class="xref">Section 2.1</a>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Furthermore, "Security material" refers to any security keys, counters or parameters stored in a device that are required to participate in secure group communication with other devices.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="chap-general-groupcomm">
<section id="section-2">
      <h2 id="name-group-definition-and-group-">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-group-definition-and-group-" class="section-name selfRef">Group Definition and Group Configuration</a>
      </h2>
<p id="section-2-1">In the following, different group types are first defined in <a href="#sec-groupdef" class="xref">Section 2.1</a>. Then, Group configuration, including group creation and maintenance by an application, user or commissioning entity is considered in <a href="#sec-groupconf" class="xref">Section 2.2</a>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="sec-groupdef">
<section id="section-2.1">
        <h3 id="name-group-definition">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-group-definition" class="section-name selfRef">Group Definition</a>
        </h3>
<p id="section-2.1-1">Three types of groups and their mutual relations are defined in this section: CoAP group, application group, and security group.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div id="sec-groupdef-coapgroup">
<section id="section-2.1.1">
          <h4 id="name-coap-group">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-coap-group" class="section-name selfRef">CoAP Group</a>
          </h4>
<p id="section-2.1.1-1">A CoAP group is defined as a set of CoAP endpoints, where each endpoint is configured to receive CoAP group messages that are sent to the group's associated IP multicast address and UDP port. An endpoint may be a member of multiple CoAP groups by subscribing to multiple IP multicast groups and/or listening on multiple UDP ports. Group membership(s) of an endpoint may dynamically change over time. A device sending a CoAP group message to a CoAP group is not necessarily itself a member of this CoAP group: it is a member only if it also has a CoAP endpoint listening on the group's associated IP multicast address and UDP port. A CoAP group can be encoded within a Group URI. This is defined as a CoAP URI that has the "coap" scheme and includes in the authority part either an IP multicast address or a group hostname (e.g., a Group Fully Qualified Domain Name (FQDN)) that can be resolved to an IP multicast address. A Group URI also contains an optional UDP port number in the authority part. Group URIs follow the regular CoAP URI syntax (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-6" class="relref">Section 6</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-groupdef-applicationgroup">
<section id="section-2.1.2">
          <h4 id="name-application-group">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-application-group" class="section-name selfRef">Application Group</a>
          </h4>
<p id="section-2.1.2-1">Besides CoAP groups, that have relevance at the level of IP networks and CoAP endpoints, there are also application groups. An application group is a set of CoAP server endpoints that share a common set of CoAP resources. An endpoint may be a member of multiple application groups. An application group has relevance at the application level -- for example an application group could denote all lights in an office room or all sensors in a hallway. A client endpoint that sends a group communication message to an application group is not necessarily itself a member of this application group. There can be a one-to-one or a one-to-many relation between a CoAP group and application group(s). An application group identifier is optionally encoded explicitly in the CoAP request, for example as a name in the URI path. If not explicitly encoded, the application group is implicitly derived by the receiver, based on information in the CoAP request. See <a href="#sec-groupnaming" class="xref">Section 2.2.1</a> for more details on identifying the application group.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-groupdef-securitygroup">
<section id="section-2.1.3">
          <h4 id="name-security-group">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-security-group" class="section-name selfRef">Security Group</a>
          </h4>
<p id="section-2.1.3-1">For secure group communication, a security group is required. A security group is a group of endpoints that each store group security material, such that they can mutually exchange secured messages and verify secured messages. So, a client endpoint needs to be a member of a security group in order to send a valid secured group communication message to this group. An endpoint may be a member of multiple security groups. There can be a one-to-one or a one-to-many relation between security groups and CoAP groups. Also, there can be a one-to-one or a one-to-many relation between security groups and application groups. A special security group named "NoSec" identifies group communication without any security at the transport layer nor at the CoAP layer.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-groupdef-grouprelations">
<section id="section-2.1.4">
          <h4 id="name-relations-between-group-typ">
<a href="#section-2.1.4" class="section-number selfRef">2.1.4. </a><a href="#name-relations-between-group-typ" class="section-name selfRef">Relations Between Group Types</a>
          </h4>
<p id="section-2.1.4-1">Using the above group type definitions, a CoAP group communication message sent by an endpoint can be represented as a tuple that contains one instance of each group type:<a href="#section-2.1.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1.4-2">
<pre>
(application group, CoAP group, security group)
</pre><a href="#section-2.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1.4-3">A special note is appropriate about the possible relation between security groups and application groups.<a href="#section-2.1.4-3" class="pilcrow">¶</a></p>
<p id="section-2.1.4-4">On one hand, multiple application groups may use the same security group. Thus, the same group security material is used to protect the messages targeting any of those application groups. This has the benefit that typically less storage, configuration and updating are required for security material. In this case, a CoAP endpoint is supposed to know the exact application group to refer to for each message that is sent or received, based on, e.g., the used server port number, the targeted resource, or the content and structure of the message payload.<a href="#section-2.1.4-4" class="pilcrow">¶</a></p>
<p id="section-2.1.4-5">On the other hand, a single application group may use multiple security groups. Thus, different messages targeting the resources of the application group can be protected with different security material. This can be convenient, for example, if the security groups differ with respect to the cryptographic algorithms and related parameters they use. In this case, a CoAP client can join just one of the security groups, based on what it supports and prefers, while a CoAP server in the application group would rather have to join all of them.<a href="#section-2.1.4-5" class="pilcrow">¶</a></p>
<p id="section-2.1.4-6">Beyond this particular case, applications should be careful in associating a same application group to multiple security groups. In particular, it is NOT RECOMMENDED to use different security groups to reflect different access policies for resources in a same application group. That is, being a member of a security group actually grants access only to exchange secured messages and enables authentication of group members, while access control (authorization) to use resources in the application group belongs to a separate security domain. It has to be separately enforced by leveraging the resource properties or through dedicated access control credentials assessed by separate means.<a href="#section-2.1.4-6" class="pilcrow">¶</a></p>
<p id="section-2.1.4-7"><a href="#fig-group-relation" class="xref">Figure 1</a> summarizes the relations between the different types of groups described above in UML class diagram notation. The class attributes in square brackets are optionally defined.<a href="#section-2.1.4-7" class="pilcrow">¶</a></p>
<span id="name-relations-among-different-g"></span><div id="fig-group-relation">
<figure id="figure-1">
            <div class="artwork art-text alignCenter" id="section-2.1.4-8.1">
<pre>
+------------------------+                 +--------------------+
|   Application group    |                 |    CoAP group      |
|........................|                 |....................|
|                        |                 |                    |
| [ - group name ]       +-----------------+ - IP mcast address |
| [ - group identifier ] |  1...N       1  | - UDP port         |
|                        |                 |                    |
|                        |                 |                    |
+-------------+----------+                 +---------+----------+
              |  1...N                               |  1...N
              |                                      |
              |                                      |
              |                                      |  1...N
              |                           +----------+------------+
              |                           |   Security group      |
              |                           |.......................|
              |                           |                       |
              \---------------------------+ - Security group name |
                                   1...N  | - Security material   |
                                          |                       |
                                          +-----------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-relations-among-different-g" class="selfRef">Relations Among Different Group Types</a>
            </figcaption></figure>
</div>
<p id="section-2.1.4-9"><a href="#fig-group-relation-example" class="xref">Figure 2</a> provides a deployment example of the relations between the different types of groups. It shows six CoAP servers (Srv1-Srv6) and their respective resources hosted (/resX). There are three application groups (1, 2, 3) and two security groups (1, 2). Security Group 1 is used by both Application Group 1 and 2. Three clients (Cli1, Cli2, Cli3) are configured with security material for Security Group 1. Two clients (Cli2, Cli4) are  configured with security material for Security Group 2. All the shown application groups use the same CoAP group (not shown in the figure), i.e., one specific multicast IP address and UDP port on which all the shown resources are hosted for each server.<a href="#section-2.1.4-9" class="pilcrow">¶</a></p>
<span id="name-deployment-example-of-diffe"></span><div id="fig-group-relation-example">
<figure id="figure-2">
            <div class="artwork art-text alignCenter" id="section-2.1.4-10.1">
<pre>
 ________________________________    _________________________________
/                                \  /                                 \
|       +---------------------+  |  |  +---------------------+        |
|       | Application Group 1 |  |  |  | Application Group 3 |  Cli2  |
|       |                     |  |  |  |                     |        |
| Cli1  | Srv1   Srv2   Srv3  |  |  |  | Srv5   Srv6         |  Cli4  |
|       | /resA  /resA  /resA |  |  |  | /resC  /resC        |        |
| Cli2  +---------------------+  |  |  | /resD  /resD        |        |
|                                |  |  +---------------------+        |
| Cli3     Security Group 1      |  |                                 |
|                                |  |        Security Group 2         |
|       +---------------------+  |  \_________________________________/
|       | Application Group 2 |  |
|       |                     |  |
|       | Srv1   Srv4         |  |
|       | /resB  /resB        |  |
|       +---------------------+  |
\________________________________/
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-deployment-example-of-diffe" class="selfRef">Deployment Example of Different Group Types</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-groupconf">
<section id="section-2.2">
        <h3 id="name-group-configuration">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-group-configuration" class="section-name selfRef">Group Configuration</a>
        </h3>
<p id="section-2.2-1">The following defines how groups of different types are named, created, discovered and maintained.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div id="sec-groupnaming">
<section id="section-2.2.1">
          <h4 id="name-group-naming">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-group-naming" class="section-name selfRef">Group Naming</a>
          </h4>
<p id="section-2.2.1-1">A CoAP group is identified and named by the authority component in the Group URI, which includes host (possibly an IP multicast address literal) and an optional UDP port number. It is recommended to configure an endpoint with an IP multicast address literal, instead of a hostname, when configuring a CoAP group membership. This is because DNS infrastructure may not be deployed in many constrained networks. In case a group hostname is configured, it can be uniquely mapped to an IP multicast address via DNS resolution - if DNS client functionality is available in the endpoint being configured and the DNS service is supported in the network. Some examples of hierarchical CoAP group FQDN naming (and scoping) for a building control application were shown in <span><a href="https://rfc-editor.org/rfc/rfc7390#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC7390" class="xref">RFC7390</a>]</span>.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">An application group can be named in many ways through different types of identifiers, such as numbers, URIs or other strings. An application group name or identifier, if explicitly encoded in a CoAP request, is typically included in the path component or in the query component of a Group URI. It may also be encoded using the Uri-Host Option <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> in case application group members implement a virtual CoAP server specific to that application group. The application group can then be identified by the value of the Uri-Host Option and each virtual server serves one specific application group. However, encoding the application group in the Uri-Host Option is not the preferred method because in this case the application group cannot be encoded in a Group URI, and also the Uri-Host Option is being used for another purpose than encoding the host part of a URI as intended by <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> -- which is potentially confusing.
Appendix A of <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span> shows an example registration of an application group into a Resource Directory (RD), along with the CoAP group it uses and the resources supported by the application group. In this example an application group identifier is not explicitly encoded in the RD nor in CoAP requests made to the group, but it implicitly follows from the CoAP group used for the request. So there is a one-to-one binding between the CoAP group and the application group. The "NoSec" security group is used.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1-3">A best practice for encoding application group into a Group URI is to use one URI path component to identify the application group and use the following URI paths component(s) to identify the resource within this application group. For example, /&lt;groupname&gt;/res1 or /base/&lt;groupname&gt;/res1/res2 conform to this practice. An application group identifier (like &lt;groupname&gt;) should be as short as possible when used in constrained networks.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4">A security group is identified by a stable and invariant string used as group name, which is generally not related with other kinds of group identifiers, specific to the chosen security solution. The "NoSec" security group name MUST be only used to represent the case of group communication without any security. It is typically characterized by the absence of any security group name, identifier, or security-related data structures in the CoAP message.<a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sssec-group-creation">
<section id="section-2.2.2">
          <h4 id="name-group-creation-and-membersh">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-group-creation-and-membersh" class="section-name selfRef">Group Creation and Membership</a>
          </h4>
<p id="section-2.2.2-1">To create a CoAP group, a configuring entity defines an IP multicast address (or hostname) for the group and optionally a UDP port number in case it differs from the default CoAP port 5683. Then, it configures one or more devices as listeners to that IP multicast address, with a CoAP endpoint listening on the group's associated UDP port. These endpoints/devices are the group members. The configuring entity can be, for example, a local application with pre-configuration, a user, a software developer, a cloud service, or a local commissioning tool. Also, the devices sending CoAP requests to the group in the role of CoAP client need to be configured with the same information, even though they are not necessarily group members. One way to configure a client is to supply it with a CoAP Group URI. The IETF does not define a mandatory protocol to accomplish CoAP group creation. <span>[<a href="#RFC7390" class="xref">RFC7390</a>]</span> defined an experimental protocol for configuration of group membership for unsecured group communication, based on JSON-formatted configuration resources. For IPv6 CoAP groups, common multicast address ranges that are used to configure group addresses from are ff1x::/16 and ff3x::/16.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">To create an application group, a configuring entity may configure a resource (name) or set of resources on CoAP endpoints, such that a CoAP request with Group URI sent by a configured CoAP client will be processed by one or more CoAP servers that have the matching URI path configured. These servers are the application group members.<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2.2-3">To create a security group, a configuring entity defines an initial subset of the related security material. This comprises a set of group properties including the cryptographic algorithms and parameters used in the group, as well as additional information relevant throughout the group life-cycle, such as the security group name and description. This task MAY be entrusted to a dedicated administrator, that interacts with a Group Manager as defined in <a href="#chap-oscore" class="xref">Section 5</a>. After that, further security materials to protect group communications have to be generated, compatible with the specified group configuration.<a href="#section-2.2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2.2-4">To participate in a security group, CoAP endpoints have to be configured with the group security material used to protect communications in the associated application/CoAP groups. The part of the process that involves secure distribution of group security material MAY use standardized communication with a Group Manager as defined in <a href="#chap-oscore" class="xref">Section 5</a>. For unsecure group communication using the "NoSec" security group, any CoAP endpoint may become a group member at any time: there is no configuring entity that needs to provide security material for this group, as there is no security material for it. This means that group creation and membership cannot be tightly controlled for the "NoSec" group.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2.2-5">The configuration of groups and membership may be performed at different moments in the life-cycle of a device; for example during product (software) creation, in the factory, at a reseller, on-site during first deployment, or on-site during a system reconfiguration operation.<a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="group-discovery">
<section id="section-2.2.3">
          <h4 id="name-group-discovery">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-group-discovery" class="section-name selfRef">Group Discovery</a>
          </h4>
<p id="section-2.2.3-1">It is possible for CoAP endpoints to discover application groups as well as CoAP groups, by using the RD-Groups usage pattern of the CoRE Resource Directory (RD), as defined in Appendix A of <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>. In particular, an application group can be registered to the RD, specifying the reference IP multicast address, hence its associated CoAP group. The registration is typically performed by a Commissioning Tool. Later on, CoAP endpoints can discover the registered application groups and related CoAP group, by using the lookup interface of the RD.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.2.3-2">CoAP endpoints can also discover application groups by performing a group discovery query using the /.well-known/core resource. Such a request may be sent to a known CoAP group multicast address associated to application group(s), or to the All CoAP Nodes multicast address.<a href="#section-2.2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.2.3-3">When secure communication is provided with Group OSCORE (see <a href="#chap-oscore" class="xref">Section 5</a>), the approach described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span> and also based on the RD can be used, in order to discover the security group to join.<a href="#section-2.2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.2.3-4">In particular, the responsible OSCORE Group Manager registers its own security groups to the RD, as links to its own corresponding resources for joining the security groups <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. Later on, CoAP endpoints can discover the registered security groups and related application groups, by using the lookup interface of the RD, and then join the security group through the respective Group Manager.<a href="#section-2.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-group-maintenance">
<section id="section-2.2.4">
          <h4 id="name-group-maintenance">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-group-maintenance" class="section-name selfRef">Group Maintenance</a>
          </h4>
<p id="section-2.2.4-1">Maintenance of a group includes any necessary operations to cope with changes in a system, such as: adding group members, removing group members, changing group security material, reconfiguration of UDP port and/or IP multicast address, reconfiguration of the Group URI, renaming of application groups, splitting of groups, or merging of groups.<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.2.4-2">For unsecured group communication (see <a href="#chap-unsecured-groupcomm" class="xref">Section 4</a>) i.e., the "NoSec" security group, addition/removal of CoAP group members is simply done by configuring these devices to start/stop listening to the group IP multicast address on the group's UDP port.<a href="#section-2.2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.2.4-3">For secured group communication (see <a href="#chap-oscore" class="xref">Section 5</a>), the maintenance operations of the protocol Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> MUST be implemented. When using Group OSCORE, CoAP endpoints participating in group communication are also members of a corresponding OSCORE security group, and thus share common security material. Additional related maintenance operations are discussed in <a href="#chap-sec-group-maintenance" class="xref">Section 5.2</a>.<a href="#section-2.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-coap-usage">
<section id="section-3">
      <h2 id="name-coap-usage-in-group-communi">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-coap-usage-in-group-communi" class="section-name selfRef">CoAP Usage in Group Communication</a>
      </h2>
<p id="section-3-1">This section specifies the usage of CoAP in group communication, both unsecured and secured. This includes additional support for protocol extensions, such as Observe (see <a href="#sec-observe" class="xref">Section 3.7</a>) and block-wise transfer (see <a href="#sec-block-wise" class="xref">Section 3.8</a>).<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">How CoAP group messages are carried over various transport layers is the subject of <a href="#sec-transport" class="xref">Section 3.9</a>. Finally, <a href="#sec-other-protocols" class="xref">Section 3.10</a> covers the interworking of CoAP group communication with other protocols that may operate in the same network.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="sec-request-response">
<section id="section-3.1">
        <h3 id="name-request-response-model">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-request-response-model" class="section-name selfRef">Request/Response Model</a>
        </h3>
<div id="general">
<section id="section-3.1.1">
          <h4 id="name-general">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-general" class="section-name selfRef">General</a>
          </h4>
<p id="section-3.1.1-1">A CoAP client is an endpoint able to transmit CoAP requests and receive CoAP responses. Since the underlying UDP transport supports multiplexing by means of UDP port number, there can be multiple independent CoAP clients operational on a single host. On each UDP port, an independent CoAP client can be hosted. Each independent CoAP client sends requests that use the associated endpoint's UDP port number as the UDP source port of the request.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">All CoAP requests that are sent via IP multicast MUST be Non-confirmable; see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>.  The Message ID in an IP multicast CoAP message is used for optional message deduplication by both clients and servers, as detailed in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>. A server sends back a unicast response to a CoAP group request. The unicast responses received by the CoAP client may be a mixture of success (e.g., 2.05 Content) and failure (e.g., 4.04 Not Found) codes, depending on the individual server processing results.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-request-response-suppress">
<section id="section-3.1.2">
          <h4 id="name-response-suppression">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-response-suppression" class="section-name selfRef">Response Suppression</a>
          </h4>
<p id="section-3.1.2-1">A server MAY suppress its response for various reasons given in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>. This document adds the requirement that a server SHOULD suppress the response in case of error or in case there is nothing useful to respond, unless the application related to a particular resource requires such a response to be made for that resource.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">The CoAP No-Response Option <span>[<a href="#RFC7967" class="xref">RFC7967</a>]</span> can be used by a client to influence the default response suppression on the server side. It is RECOMMENDED for a server to support this option only on selected resources where it is useful in the application context. If the option is supported on a resource, it MUST override the default response suppression of that resource.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2-3">Any default response suppression by a server SHOULD be performed consistently, as follows: if a request on a resource produces a particular Response Code and this response is not suppressed, then another request on the same resource that produces a response of the same Response Code class is also not suppressed. For example, if a 4.05 Method Not Allowed error response code is suppressed by default on a resource, then a 4.15 Unsupported Content-Format error response code is also suppressed by default for that resource.<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="repeating-a-request">
<section id="section-3.1.3">
          <h4 id="name-repeating-a-request">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-repeating-a-request" class="section-name selfRef">Repeating a Request</a>
          </h4>
<p id="section-3.1.3-1">A CoAP client MAY repeat a group request using the same Token value and same Message ID value, in order to ensure that enough (or all) group members have been reached with the request. This is useful in case a number of group members did not respond to the initial request and the client suspects that the request did not reach these group members. However, in case one or more servers did receive the initial request but the response to that request was lost, this repeat does not help to retrieve the lost response(s) if the server(s) implement the optional Message ID based deduplication (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">A CoAP client MAY repeat a group request using the same Token value and a different Message ID, in which case all servers that received the initial request will again process the repeated request since it appears within a new CoAP message. This is useful in case a client suspects that one or more response(s) to its original request were lost and the client needs to collect more, or even all, responses from group members, even if this comes at the cost of the overhead of certain group members responding twice (once to the original request, and once to the repeated request with different Message ID).<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requestresponse-matching-and-distinguishing-responses">
<section id="section-3.1.4">
          <h4 id="name-request-response-matching-a">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-request-response-matching-a" class="section-name selfRef">Request/Response Matching and Distinguishing Responses</a>
          </h4>
<p id="section-3.1.4-1">A CoAP client can distinguish the origin of multiple server responses by the source IP address of the message containing the CoAP response and/or any other available application-specific source identifiers contained in the CoAP response payload or CoAP response options, such as an application-level unique ID associated to the server. If secure communication is provided with Group OSCORE (see <a href="#chap-oscore" class="xref">Section 5</a>), additional security-related identifiers in the CoAP response enable the client to retrieve the right security material for decrypting each response and authenticating its source.<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.4-2">While processing a response on the client, the source endpoint of the response is not matched to the destination endpoint of the request, since for a group request these will never match. This is specified in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, with reference to IP multicast. Also, when UDP transport is used, this implies that a server MAY respond from a UDP port number that differs from the destination UDP port number of the request, although a CoAP server normally SHOULD respond from the UDP port number that equals the destination port of the request -- following the convention for UDP-based protocols. In case a single client has sent multiple group requests and concurrent CoAP transactions are ongoing, the responses received by that client are matched to an active request using only the Token value. Due to UDP level multiplexing, the UDP destination port of the response MUST match to the client endpoint's UDP port value, i.e., to the UDP source port of the client's request.<a href="#section-3.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-reuse">
<section id="section-3.1.5">
          <h4 id="name-token-reuse">
<a href="#section-3.1.5" class="section-number selfRef">3.1.5. </a><a href="#name-token-reuse" class="section-name selfRef">Token Reuse</a>
          </h4>
<p id="section-3.1.5-1">For CoAP group requests, there are additional constraints on the reuse of Token values at the client, compared to the unicast case defined in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> and updated by <span>[<a href="#I-D.ietf-core-echo-request-tag" class="xref">I-D.ietf-core-echo-request-tag</a>]</span>. Since for CoAP group requests the number of responses is not bound a priori, the client cannot use the reception of a response as a trigger to "free up" a Token value for reuse. Reusing a Token value too early could lead to incorrect response/request matching on the client, and would be a protocol error.  Therefore, the time between reuse of Token values for different group requests MUST be greater than:<a href="#section-3.1.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.5-2">
<pre>
MIN_TOKEN_REUSE_TIME = (NON_LIFETIME + MAX_LATENCY +
                        MAX_SERVER_RESPONSE_DELAY)
</pre><a href="#section-3.1.5-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.5-3">where NON_LIFETIME and MAX_LATENCY are defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.8" class="relref">Section 4.8</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>.  This specification defines MAX_SERVER_RESPONSE_DELAY as was done in <span>[<a href="#RFC7390" class="xref">RFC7390</a>]</span>, that is: the expected maximum response delay over all servers that the client can send a CoAP group request to.  This delay includes the maximum Leisure time period as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>. However, CoAP does not define a time limit for the server response delay.  Using the default CoAP parameters, the Token reuse time MUST be greater than 250 seconds plus MAX_SERVER_RESPONSE_DELAY.  A preferred solution to meet this requirement is to generate a new unique Token for every new group request, such that a Token value is never reused.  If a client has to reuse Token values for some reason, and also MAX_SERVER_RESPONSE_DELAY is unknown, then using MAX_SERVER_RESPONSE_DELAY = 250 seconds is a reasonable guideline. The time between Token reuses is in that case set to a value greater than MIN_TOKEN_REUSE_TIME = 500 seconds.<a href="#section-3.1.5-3" class="pilcrow">¶</a></p>
<p id="section-3.1.5-4">When securing CoAP group communication with Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, secure binding between requests and responses is ensured (see <a href="#chap-oscore" class="xref">Section 5</a>). Thus, a client may reuse a Token value after it has been freed up, as discussed above and considering a reuse time greater than MIN_TOKEN_REUSE_TIME. If an alternative security protocol for CoAP group communication is used which does not ensure secure binding between requests and responses, a client MUST follow the Token processing requirements as defined in <span>[<a href="#I-D.ietf-core-echo-request-tag" class="xref">I-D.ietf-core-echo-request-tag</a>]</span>.<a href="#section-3.1.5-4" class="pilcrow">¶</a></p>
<p id="section-3.1.5-5">Another method to more easily meet the above constraint is to instantiate multiple CoAP clients at multiple UDP ports on the same host. The Token values only have to be unique within the context of a single CoAP client, so using multiple clients can make it easier to meet the constraint.<a href="#section-3.1.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-request-response-multi">
<section id="section-3.1.6">
          <h4 id="name-client-handling-of-multiple">
<a href="#section-3.1.6" class="section-number selfRef">3.1.6. </a><a href="#name-client-handling-of-multiple" class="section-name selfRef">Client Handling of Multiple Responses With Same Token</a>
          </h4>
<p id="section-3.1.6-1">Since a client sending a group request with a Token T will accept multiple responses with the same Token T, it is possible in particular that the same server sends multiple responses with the same Token T back to the client. For example, this server might not implement the optional CoAP message deduplication based on Message ID; or it might be acting out of specification as a malicious, compromised or faulty server.<a href="#section-3.1.6-1" class="pilcrow">¶</a></p>
<p id="section-3.1.6-2">When this happens, the client normally processes at the CoAP layer each of those responses to the same request coming from the same server. If the processing of a response is successful, the client delivers this response to the application as usual.<a href="#section-3.1.6-2" class="pilcrow">¶</a></p>
<p id="section-3.1.6-3">Then, the application is in a better position to decide what to do, depending on the available context information. For instance, it might accept and process all the responses from the same server, even if they are not Observe notifications (i.e., they do not include an Observe option). Alternatively, the application might accept and process only one of those responses, such as the most recent one from that server, e.g., when this can trigger a change of state within the application.<a href="#section-3.1.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-caching">
<section id="section-3.2">
        <h3 id="name-caching">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-caching" class="section-name selfRef">Caching</a>
        </h3>
<p id="section-3.2-1">CoAP endpoints that are members of a CoAP group MAY cache responses to a group request as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>. In particular, these same rules apply to determine the set of request options used as "Cache-Key".<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Furthermore, building on what is defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2.1" class="relref">Section 8.2.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">A client sending a GET or FETCH group request MAY update a cache with the responses from the servers in the CoAP group. Then, the client uses both cached-still-fresh and new responses as the result of the group request.<a href="#section-3.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.2">A client sending a GET or FETCH group request MAY use a response received from a server, to satisfy a subsequent sent request intended to that server on the related unicast request URI. In particular, the unicast request URI is obtained by replacing the authority part of the request URI with the transport-layer source address of the cached response message.<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.3">A client MAY revalidate a cached response by making a GET or FETCH request on the related unicast request URI.<a href="#section-3.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-4">Note that, in the presence of proxies, doing any of the above (optional) unicast requests requires the client to distinguish the different responses to a group request, as well as to distinguish the different origin servers that responded. This in turn requires additional means to provide the client with information about the origin server of each response, e.g., using the forward-proxying method defines in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span>.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">The following subsections define the freshness model and validation model to use for cached responses, which update the models defined in Sections <a href="https://rfc-editor.org/rfc/rfc7252#section-5.6.1" class="relref">5.6.1</a> and <a href="https://rfc-editor.org/rfc/rfc7252#section-5.6.2" class="relref">5.6.2</a> of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, respectively.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<div id="sec-caching-freshness">
<section id="section-3.2.1">
          <h4 id="name-freshness-model">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-freshness-model" class="section-name selfRef">Freshness Model</a>
          </h4>
<p id="section-3.2.1-1">For caching of group communication responses at client endpoints, the same freshness model relying on the Max-Age Option as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.6.1" class="relref">Section 5.6.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> applies, and 
the multicast caching rules of <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2.1" class="relref">Section 8.2.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> apply except for the one discussed below.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">In <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2.1" class="relref">Section 8.2.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> it is stated that, regardless of the presence of cached responses to the group request, the client endpoint will always send out a new group request onto the network because new group members may have joined the group since the last group request to the same group/resource.
That is, a request is never served from cached responses only. This document updates <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> by adding the following exception case, where a client endpoint MAY serve a request by using cached responses only, and not send out a new group request onto the network:<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">The client knows all current CoAP server group members; and, for each group member, the client's cache currently stores a fresh response.<a href="#section-3.2.1-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.1-4">How the client in the case above determines the current CoAP server group members is out of scope for this document. It may be, for example, via a group manager server, or by observing group join requests, or observing IGMP/MLD multicast group join messages, etc.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1-5">For caching at proxies, the freshness model defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span>  can be used.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-caching-validation">
<section id="section-3.2.2">
          <h4 id="name-validation-model">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-validation-model" class="section-name selfRef">Validation Model</a>
          </h4>
<p id="section-3.2.2-1">For validation of cached group communication responses at client endpoints, the multicast validation rules in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2.1" class="relref">Section 8.2.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> apply, except for the last paragraph which states "A GET request to a multicast group MUST NOT contain an ETag option". 
This document updates <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> by allowing a group request to contain ETag Options as specified below.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">For validation at proxies, the validation model defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span> can be used.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<div id="etag-option-in-a-group-requestresponse">
<section id="section-3.2.2.1">
            <h5 id="name-etag-option-in-a-group-requ">
<a href="#section-3.2.2.1" class="section-number selfRef">3.2.2.1. </a><a href="#name-etag-option-in-a-group-requ" class="section-name selfRef">ETag Option in a Group Request/Response</a>
            </h5>
<p id="section-3.2.2.1-1">A client endpoint MAY include one or more ETag Options in a GET or FETCH group request to validate one or more stored responses it has cached. 
In case two or more servers in the group have responded to a previous request to the same resource with an identical ETag value, it is the responsibility of the client to handle this case. In particular, if the client 
wishes to validate, using a group request, a response from server 1 with an ETag value N, while it does not wish to validate a response from server 2 with the same ETag value N, there is no way to achieve this.
In such cases of identical ETag values returned by two or more servers, the client, by default, SHOULD NOT include an ETag Option in a group request containing that ETag value.<a href="#section-3.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-2">A server endpoint MUST process an ETag Option in a GET or FETCH group request in the same way it processes an ETag Option for a unicast request.
A server endpoint that includes an ETag Option in a response to a group request SHOULD construct the ETag Option value in such a way that the value
will be unique to this particular server with a high probability. This can be done, for example, by embedding a compact ID of the server within the ETag value, where the ID is unique (or unique with a high probability) in the scope of the group.<a href="#section-3.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-3">Note: a legacy CoAP server might treat an ETag Option in a group request as an unrecognized option per Sections <a href="https://rfc-editor.org/rfc/rfc7252#section-5.4" class="relref">5.4</a> and <a href="https://rfc-editor.org/rfc/rfc7252#section-8.2.1" class="relref">8.2.1</a> of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, causing it to ignore this (elective) ETag Option regardless of its value, and process the request normally as if that ETag Option was not included.<a href="#section-3.2.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="uri-path-selection">
<section id="section-3.3">
        <h3 id="name-uri-path-selection">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-uri-path-selection" class="section-name selfRef">URI Path Selection</a>
        </h3>
<p id="section-3.3-1">The URI Path used in a group request is preferably a path that is known to be supported across all group members. However there are valid use cases where a group request is known to be successful only for a subset of the CoAP group, for example only members of a specific application group, while those group members for which the request is unsuccessful (for example because they are outside the application group) either ignore the group request or respond with an error status code.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="port-selection-for-udp-transport">
<section id="section-3.4">
        <h3 id="name-port-selection-for-udp-tran">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-port-selection-for-udp-tran" class="section-name selfRef">Port Selection for UDP Transport</a>
        </h3>
<p id="section-3.4-1">A server that is a member of a CoAP group listens for CoAP request messages on the group's IP multicast address, usually on the CoAP default UDP port 5683, or another non-default UDP port if configured. Regardless of the method for selecting the port number, the same port number MUST be used across all CoAP servers that are members of a CoAP group and across all CoAP clients sending group requests to that group.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">One way to create multiple CoAP groups is using different UDP ports with the same IP multicast address, in case the devices' network stack only supports a limited number of multicast address subscriptions. However, it must be taken into account that this incurs additional processing overhead on each CoAP server participating in at least one of these groups: messages to groups that are not of interest to the node are only discarded at the higher transport (UDP) layer instead of directly at the network (IP) layer. Also, a constrained network may be additionally burdened in this case with multicast traffic that is eventually discarded at the UDP layer by most nodes.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">Port 5684 is reserved for DTLS-secured unicast CoAP and MUST NOT be used for any CoAP group communication.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">For a CoAP server node that supports resource discovery as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-2.4" class="relref">Section 2.4</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, the default port 5683 MUST be supported (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>) for the "All CoAP Nodes" multicast group as detailed in <a href="#sec-transport" class="xref">Section 3.9</a>.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-proxy">
<section id="section-3.5">
        <h3 id="name-proxy-operation">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-proxy-operation" class="section-name selfRef">Proxy Operation</a>
        </h3>
<p id="section-3.5-1">This section defines how proxies operate in a group communication scenario. In particular, <a href="#sec-proxy-forward" class="xref">Section 3.5.1</a> defines operations of forward-proxies, while <a href="#sec-proxy-reverse" class="xref">Section 3.5.2</a> defines operations of reverse-proxies.
Security operations for a proxy are discussed later in <a href="#chap-proxy-security" class="xref">Section 5.3</a>.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div id="sec-proxy-forward">
<section id="section-3.5.1">
          <h4 id="name-forward-proxies">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-forward-proxies" class="section-name selfRef">Forward-Proxies</a>
          </h4>
<p id="section-3.5.1-1">CoAP enables a client to request a forward-proxy to process a CoAP request on its behalf, as described in Sections <a href="https://rfc-editor.org/rfc/rfc7252#section-5.7.2" class="relref">5.7.2</a> and <a href="https://rfc-editor.org/rfc/rfc7252#section-8.2.2" class="relref">8.2.2</a> of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. For this purpose, the client specifies either the request group URI as a string in the Proxy-URI Option or it uses the Proxy-Scheme Option with the group URI constructed from the usual Uri-* Options. The forward-proxy then resolves the group URI to a destination CoAP group, sends (e.g., multicasts) the CoAP group request, receives the responses and forwards all the individual (unicast) responses back to the client.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">However, there are certain issues and limitations with this approach:<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-3.1">The CoAP client component that sent a unicast CoAP request to the proxy may be expecting only one (unicast) response, as usual for a CoAP unicast request. Instead, it receives multiple (unicast) responses, potentially leading to fault conditions in the component or to discarding any received responses following the first one. This issue may occur even if the application calling the CoAP client component is aware that the forward-proxy is going to execute a CoAP group URI request.<a href="#section-3.5.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.1-3.2">Each individual CoAP response received by the client will appear to originate (based on its IP source address) from the CoAP Proxy, and not from the server that produced the response.  This makes it impossible for the client to identify the server that produced each response, unless the server identity is contained as a part of the response payload or inside a CoAP option in the response.<a href="#section-3.5.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.1-3.3">The proxy does not necessarily know how many members there are in the CoAP group or how many group members will actually respond. Also, the proxy does not know for how long to collect responses before it stops forwarding them to the client. A CoAP client that is not using a Proxy might face the same problems in collecting responses to a group request. However, the client itself would typically have application-specific rules or knowledge on how to handle this situation, while an application-agnostic CoAP Proxy would typically not have this knowledge. For example, a CoAP client could monitor incoming responses and use this information to decide how long to continue collecting responses - which is something a proxy cannot do.<a href="#section-3.5.1-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.5.1-4">A forward-proxying method using this approach and addressing the issues raised above is defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span>.<a href="#section-3.5.1-4" class="pilcrow">¶</a></p>
<p id="section-3.5.1-5">An alternative solution is for the proxy to collect all the individual (unicast) responses to a CoAP group request and then send back only a single (aggregated) response to the client. However, this solution brings up new issues:<a href="#section-3.5.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-6.1">Like for the approach discussed above, the proxy does not know for how long to collect responses before sending back the aggregated response to the client. Analogous considerations apply to this approach too, both on the client and proxy side.<a href="#section-3.5.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.1-6.2">There is no default format defined in CoAP for aggregation of multiple responses into a single response. Such a format could be standardized based on, for example, the multipart content-format <span>[<a href="#RFC8710" class="xref">RFC8710</a>]</span>.<a href="#section-3.5.1-6.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.5.1-7">Due to the above issues, it is RECOMMENDED that a CoAP Proxy only processes a group URI request if it is explicitly enabled to do so. The default response (if the function is not explicitly enabled) to a group URI request is 5.01 Not Implemented. Furthermore, a proxy SHOULD be explicitly configured (e.g., by allow-listing and/or client authentication) to allow proxied CoAP group requests only from specific client(s).<a href="#section-3.5.1-7" class="pilcrow">¶</a></p>
<p id="section-3.5.1-8">The operation of HTTP-to-CoAP proxies for multicast CoAP requests is specified in Sections <a href="https://rfc-editor.org/rfc/rfc8075#section-8.4" class="relref">8.4</a> and <a href="https://rfc-editor.org/rfc/rfc8075#section-10.1" class="relref">10.1</a> of <span>[<a href="#RFC8075" class="xref">RFC8075</a>]</span>. In this case, the "application/http" media type is used to let the proxy return multiple CoAP responses -- each translated to a HTTP response -- back to the HTTP client. Of course, in this case the HTTP client sending a group URI to the proxy needs to be aware that it is going to receive this format, and needs to be able to decode it into the responses of multiple CoAP servers. Also, the IP source address of each CoAP response cannot be determined anymore from the "application/http" response. The HTTP client still identify the CoAP servers by other means such as application-specific information in the response payload.<a href="#section-3.5.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-proxy-reverse">
<section id="section-3.5.2">
          <h4 id="name-reverse-proxies">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-reverse-proxies" class="section-name selfRef">Reverse-Proxies</a>
          </h4>
<p id="section-3.5.2-1">CoAP enables the use of a reverse-proxy, as an endpoint that stands in for one or more other server(s), and satisfies requests on behalf of these, doing any necessary translations (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.7.3" class="relref">Section 5.7.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">In a group communication scenario, a reverse-proxy can rely on its configuration and/or on information in a request from a client, in order to determine that a group request has to be sent to a group of servers over a one-to-many transport such as IP/UDP multicast.<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
<p id="section-3.5.2-3">For example, specific resources on the reverse-proxy could be allocated, each to a specific application group and/or CoAP group. Or alternatively, the application group and/or CoAP group in question could be encoded as URI path segments. The URI path encodings for a reverse-proxy may also use a URI mapping template as described in <span><a href="https://rfc-editor.org/rfc/rfc8075#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8075" class="xref">RFC8075</a>]</span>.<a href="#section-3.5.2-3" class="pilcrow">¶</a></p>
<p id="section-3.5.2-4">Furthermore, the reverse-proxy can actually stand in for (and thus prevent to directly reach) only the whole set of servers in the group, or also for each of those individual servers (e.g., if acting as firewall).<a href="#section-3.5.2-4" class="pilcrow">¶</a></p>
<p id="section-3.5.2-5">For a reverse-proxy that sends a request to a group of servers, the considerations as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.7.3" class="relref">Section 5.7.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> hold, with the following additions:<a href="#section-3.5.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-6.1">The three issues and limitations defined in <a href="#sec-proxy-forward" class="xref">Section 3.5.1</a> for a forward proxy apply to a reverse-proxy as well, and have to be addressed, e.g., using the signaling method defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span> or other means.<a href="#section-3.5.2-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.2-6.2">A reverse-proxy MAY have preconfigured time duration(s) that are used for the collecting of server responses and forwarding these back to the client. These duration(s) may be set as global configuration or resource-specific configurations. If there is such preconfiguration, then an explicit signaling of the time period in the client's request as defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span> is not necessarily needed.<a href="#section-3.5.2-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.2-6.3">
              <p id="section-3.5.2-6.3.1">A client that is configured to access a reverse-proxy resource (i.e., one that triggers a CoAP group communication request) SHOULD be configured also to handle potentially multiple responses with the same Token value caused by a single request.<a href="#section-3.5.2-6.3.1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-6.3.2">
That is, the client needs to preserve the Token value used for the request also after the reception of the first response forwarded back by the proxy (see <a href="#sec-request-response-multi" class="xref">Section 3.1.6</a>) and keep the request open to potential further responses with this Token. This requirement can be met by a combination of client implementation and proper proxied group communication configuration on the client.<a href="#section-3.5.2-6.3.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.5.2-6.4">
              <p id="section-3.5.2-6.4.1">A client might re-use a Token value in a valid new request to the reverse-proxy, while the reverse-proxy still has an ongoing group communication request for this client with the same Token value (i.e., its time period for response collection has not ended yet).<a href="#section-3.5.2-6.4.1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-6.4.2">
If this happens, the reverse-proxy MUST stop the ongoing request and associated response forwarding, it MUST NOT forward the new request to the group of servers, and it MUST send a 4.00 Bad Request error response to the client. The diagnostic payload of the error response SHOULD indicate to the client that the resource is a reverse-proxy resource, and that for this reason immediate Token re-use is not possible.<a href="#section-3.5.2-6.4.2" class="pilcrow">¶</a></p>
<p id="section-3.5.2-6.4.3">
If the reverse-proxy supports the signalling protocol of <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span> it can include a Multicast-Signaling Option in the error response to convey the reason for the error in a machine-readable way.<a href="#section-3.5.2-6.4.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.5.2-7">For the operation of HTTP-to-CoAP reverse proxies, see the last paragraph of <a href="#sec-proxy-forward" class="xref">Section 3.5.1</a> which applies also to the case of reverse-proxies.<a href="#section-3.5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-congestion">
<section id="section-3.6">
        <h3 id="name-congestion-control">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-congestion-control" class="section-name selfRef">Congestion Control</a>
        </h3>
<p id="section-3.6-1">CoAP group requests may result in a multitude of responses from different nodes, potentially causing congestion. Therefore, both the sending of CoAP group requests and the sending of the unicast CoAP responses to these group requests should be conservatively controlled.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> reduces IP multicast-specific congestion risks through the following measures:<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-3.1">A server may choose not to respond to an IP multicast request if there is nothing useful to respond to, e.g., error or empty response (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3.6-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-3.2">A server should limit the support for IP multicast requests to specific resources where multicast operation is required (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.3" class="relref">Section 11.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3.6-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-3.3">An IP multicast request MUST be Non-confirmable (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3.6-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-3.4">A response to an IP multicast request SHOULD be Non-confirmable (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.2.3" class="relref">Section 5.2.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3.6-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-3.5">A server does not respond immediately to an IP multicast request and should first wait for a time that is randomly picked within a predetermined time interval called the Leisure (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3.6-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-4">This document also defines these measures to be applicable to alternative transports (other than IP multicast), if not defined otherwise.
Additional guidelines to reduce congestion risks defined in this document are as follows:<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-5.1">A server in a constrained network SHOULD only support group requests for resources that have a small representation (where the representation may be retrieved via a GET, FETCH or POST method in the request). For example, "small" can be defined as a response payload limited to approximately 5% of the IP Maximum Transmit Unit (MTU) size, so that it fits into a single link-layer frame in case IPv6 over Low-Power Wireless Personal Area Networks (6LoWPAN, see <a href="#sec-6lowpan" class="xref">Section 3.9.3</a>) is used on the constrained network.<a href="#section-3.6-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-5.2">A server SHOULD minimize the payload size of a response to a group GET or FETCH request on "/.well-known/core" by using hierarchy in arranging link descriptions for the response. An example of this is given in <span><a href="https://rfc-editor.org/rfc/rfc6690#section-5" class="relref">Section 5</a> of [<a href="#RFC6690" class="xref">RFC6690</a>]</span>.<a href="#section-3.6-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-5.3">A server MAY minimize the payload size of a response to a group GET or FETCH request (e.g., on "/.well-known/core") by using CoAP block-wise transfers <span>[<a href="#RFC7959" class="xref">RFC7959</a>]</span> in case the payload is long, returning only a first block of the CoRE Link Format description.  For this reason, a CoAP client sending a CoAP group request to "/.well-known/core" SHOULD support block-wise transfers. See also <a href="#sec-block-wise" class="xref">Section 3.8</a>.<a href="#section-3.6-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-5.4">A client SHOULD be configured to use CoAP groups with the smallest possible IP multicast scope that fulfills the application needs. As an example, site-local scope is always preferred over global scope IP multicast if this fulfills the application needs. Similarly, realm-local scope is always preferred over site-local scope if this fulfills the application needs.<a href="#section-3.6-5.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-observe">
<section id="section-3.7">
        <h3 id="name-observing-resources">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-observing-resources" class="section-name selfRef">Observing Resources</a>
        </h3>
<p id="section-3.7-1">The CoAP Observe Option <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span> is a protocol extension of CoAP, that allows a CoAP client to retrieve a representation of a resource and automatically keep this representation up-to-date over a longer period of time. The client gets notified when the representation has changed. <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span> does not mention whether the Observe Option can be combined with CoAP (multicast) group communication.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">This section updates <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span> with the use of the Observe Option in a CoAP GET group request, and defines normative behavior for both client and server. Consistent with <span><a href="https://rfc-editor.org/rfc/rfc8132#section-2.4" class="relref">Section 2.4</a> of [<a href="#RFC8132" class="xref">RFC8132</a>]</span>, it is also possible to use the Observe Option in a CoAP FETCH group request.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">Multicast Observe is a useful way to start observing a particular resource on all members of a CoAP group at the same time. Group members that do not have this particular resource or do not allow the GET or FETCH method on it will either respond with an error status -- 4.04 Not Found or 4.05 Method Not Allowed, respectively -- or will silently suppress the response following the rules of <a href="#sec-request-response-suppress" class="xref">Section 3.1.2</a>, depending on server-specific configuration.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<p id="section-3.7-4">A client that sends a group GET or FETCH request with the Observe Option MAY repeat this request using the same Token value and the same Observe Option value, in order to ensure that enough (or all) members of the CoAP group have been reached with the request. This is useful in case a number of group members did not respond to the initial request. The client MAY additionally use the same Message ID in the repeated request to avoid that group members that had already received the initial request would respond again. Note that using the same Message ID in a repeated request will not be helpful in case of loss of a response message, since the server that responded already will consider the repeated request as a duplicate message. On the other hand, if the client uses a different, fresh Message ID in the repeated request, then all the group members that receive this new message will typically respond again, which increases the network load.<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<p id="section-3.7-5">A client that has sent a group GET or FETCH request with the Observe Option MAY follow up by sending a new unicast CON request with the same Token value and same Observe Option value to a particular server, in order to ensure that the particular server receives the request. This is useful in case a specific group member, that was expected to respond to the initial group request, did not respond to the initial request. In this case, the client MUST use a Message ID that differs from the initial group request message.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<p id="section-3.7-6">Furthermore, consistent with <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.3.1" class="relref">Section 3.3.1</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span> and following its guidelines, a client MAY at any time send a new group/multicast GET or FETCH request with the same Token value and same Observe Option value as the original request.  This allows the client to verify that it has an up-to-date representation of an observed resource and/or to re-register its interest to observe a resource.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
<p id="section-3.7-7">In the above client behaviors, the Token value is kept identical to the initial request to avoid that a client is included in more than one entry in the list of observers (<span><a href="https://rfc-editor.org/rfc/rfc7641#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>).<a href="#section-3.7-7" class="pilcrow">¶</a></p>
<p id="section-3.7-8">Before repeating a request as specified above, the client SHOULD wait for at least the expected round-trip time plus the Leisure time period defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, to give the server time to respond.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
<p id="section-3.7-9">A server that receives a GET or FETCH request with the Observe Option, for which request processing is successful, SHOULD respond to this request and not suppress the response. If a server adds a client (as a new entry) to the list of observers for a resource due to an Observe request, the server SHOULD respond to this request and SHOULD NOT suppress the response. An exception to the above is the overriding of response suppression according to a CoAP No-Response Option <span>[<a href="#RFC7967" class="xref">RFC7967</a>]</span> specified by the client in the GET or FETCH request (see <a href="#sec-request-response-suppress" class="xref">Section 3.1.2</a>).<a href="#section-3.7-9" class="pilcrow">¶</a></p>
<p id="section-3.7-10">A server SHOULD have a mechanism to verify liveness of its observing clients and the continued interest of these clients in receiving the observe notifications. This can be implemented by sending notifications occassionally using a Confirmable message. See <span><a href="https://rfc-editor.org/rfc/rfc7641#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span> for details. This requirement overrides the regular behavior of sending Non-confirmable notifications in response to a Non-confirmable request.<a href="#section-3.7-10" class="pilcrow">¶</a></p>
<p id="section-3.7-11">A client can use the unicast cancellation methods of <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span> and stop the ongoing observation of a particular resource on members of a CoAP group. This can be used to remove specific observed servers, or even all servers in the group (using serial unicast to each known group member). In addition, a client MAY explicitly deregister from all those servers at once, by sending a group/multicast GET or FETCH request that includes the Token value of the observation to be cancelled and includes an Observe Option with the value set to 1 (deregister). In case not all the servers in the CoAP group received this deregistration request, either the unicast cancellation methods can be used at a later point in time or the group/multicast deregistration request MAY be repeated upon receiving another observe response from a server.<a href="#section-3.7-11" class="pilcrow">¶</a></p>
<p id="section-3.7-12">For observing a group of servers through a CoAP-to-CoAP proxy, the limitations stated in <a href="#sec-proxy" class="xref">Section 3.5</a> apply. The method defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span> enables group communication including resource observation through proxies and addresses those limitations.<a href="#section-3.7-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-block-wise">
<section id="section-3.8">
        <h3 id="name-block-wise-transfer">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-block-wise-transfer" class="section-name selfRef">Block-Wise Transfer</a>
        </h3>
<p id="section-3.8-1"><span><a href="https://rfc-editor.org/rfc/rfc7959#section-2.8" class="relref">Section 2.8</a> of [<a href="#RFC7959" class="xref">RFC7959</a>]</span> specifies how a client can use block-wise transfer (Block2 Option) in a multicast GET request to limit the size of the initial response of each server. Consistent with <span><a href="https://rfc-editor.org/rfc/rfc8132#section-2.5" class="relref">Section 2.5</a> of [<a href="#RFC8132" class="xref">RFC8132</a>]</span>, the same can be done with a multicast FETCH request.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">The client has to use unicast for any further request, separately addressing each different server, in order to retrieve more blocks of the resource from that server, if any. Also, a server (member of a targeted CoAP group) that needs to respond to a group request with a particularly large resource can use block-wise transfer (Block2 Option) at its own initiative, to limit the size of the initial response. Again, a client would have to use unicast for any further requests to retrieve more blocks of the resource.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">A solution for group/multicast block-wise transfer using the Block1 Option is not specified in <span>[<a href="#RFC7959" class="xref">RFC7959</a>]</span> nor in the present document. Such a solution would be useful for group FETCH/PUT/POST/PATCH/iPATCH requests, to efficiently distribute a large request payload as multiple blocks to all members of a CoAP group. Multicast usage of Block1 is non-trivial due to potential message loss (leading to missing blocks or missing confirmations), and potential diverging block size preferences of different members of the CoAP group.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<p id="section-3.8-4"><span>[<a href="#I-D.ietf-core-new-block" class="xref">I-D.ietf-core-new-block</a>]</span> specifies an alternative method for CoAP block-wise transfer. It specifies that "servers MUST ignore multicast requests that contain the Q-Block2 Option".<a href="#section-3.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-transport">
<section id="section-3.9">
        <h3 id="name-transport-protocols">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-transport-protocols" class="section-name selfRef">Transport Protocols</a>
        </h3>
<p id="section-3.9-1">In this document UDP, both over IPv4 and IPv6, is considered as the default transport protocol for CoAP group communication.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<div id="sec-udptransport">
<section id="section-3.9.1">
          <h4 id="name-udp-ipv6-multicast-transpor">
<a href="#section-3.9.1" class="section-number selfRef">3.9.1. </a><a href="#name-udp-ipv6-multicast-transpor" class="section-name selfRef">UDP/IPv6 Multicast Transport</a>
          </h4>
<p id="section-3.9.1-1">CoAP group communication can use UDP over IPv6 as a transport protocol, provided that IPv6 multicast is enabled. IPv6 multicast MAY be supported in a network only for a limited scope. For example, <a href="#sec-rpl" class="xref">Section 3.10.2</a> describes the potential limited support of RPL for multicast, depending on how the protocol is configured.<a href="#section-3.9.1-1" class="pilcrow">¶</a></p>
<p id="section-3.9.1-2">For a CoAP server node that supports resource discovery as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-2.4" class="relref">Section 2.4</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, the default port 5683 MUST be supported as per Sections <a href="https://rfc-editor.org/rfc/rfc7252#section-7.1" class="relref">7.1</a> and <a href="https://rfc-editor.org/rfc/rfc7252#section-12.8" class="relref">12.8</a> of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> for the "All CoAP Nodes" multicast group. An IPv6 CoAP server SHOULD support the "All CoAP Nodes" groups with at least link-local (2), admin-local (4) and site-local (5) scopes. An IPv6 CoAP server on a 6LoWPAN node (see <a href="#sec-6lowpan" class="xref">Section 3.9.3</a>) SHOULD also support the realm-local (3) scope.<a href="#section-3.9.1-2" class="pilcrow">¶</a></p>
<p id="section-3.9.1-3">Note that a client sending an IPv6 multicast CoAP message to a port that is not supported by the server will not receive an ICMPv6 Port Unreachable error message from that server, because the server does not send it in this case, per <span><a href="https://rfc-editor.org/rfc/rfc4443#section-2.4" class="relref">Section 2.4</a> of [<a href="#RFC4443" class="xref">RFC4443</a>]</span>.<a href="#section-3.9.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="udpipv4-multicast-transport">
<section id="section-3.9.2">
          <h4 id="name-udp-ipv4-multicast-transpor">
<a href="#section-3.9.2" class="section-number selfRef">3.9.2. </a><a href="#name-udp-ipv4-multicast-transpor" class="section-name selfRef">UDP/IPv4 Multicast Transport</a>
          </h4>
<p id="section-3.9.2-1">CoAP group communication can use UDP over IPv4 as a transport protocol, provided that IPv4 multicast is enabled. For a CoAP server node that supports resource discovery as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-2.4" class="relref">Section 2.4</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, the default port 5683 MUST be supported as per Sections <a href="https://rfc-editor.org/rfc/rfc7252#section-7.1" class="relref">7.1</a> and <a href="https://rfc-editor.org/rfc/rfc7252#section-12.8" class="relref">12.8</a> of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, for the "All CoAP Nodes" IPv4 multicast group.<a href="#section-3.9.2-1" class="pilcrow">¶</a></p>
<p id="section-3.9.2-2">Note that a client sending an IPv4 multicast CoAP message to a port that is not supported by the server will not receive an ICMP Port Unreachable error message from that server, because the server does not send it in this case, per <span><a href="https://rfc-editor.org/rfc/rfc1122#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC1122" class="xref">RFC1122</a>]</span>.<a href="#section-3.9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-6lowpan">
<section id="section-3.9.3">
          <h4 id="name-6lowpan">
<a href="#section-3.9.3" class="section-number selfRef">3.9.3. </a><a href="#name-6lowpan" class="section-name selfRef">6LoWPAN</a>
          </h4>
<p id="section-3.9.3-1">In 6LoWPAN <span>[<a href="#RFC4944" class="xref">RFC4944</a>]</span> <span>[<a href="#RFC6282" class="xref">RFC6282</a>]</span> networks, IPv6 packets (up to 1280 bytes) may be fragmented into smaller IEEE 802.15.4 MAC frames (up to 127 bytes), if the packet size requires this. Every 6LoWPAN IPv6 router that receives a multi-fragment packet reassembles the packet and refragments it upon transmission. Since the loss of a single fragment implies the loss of the entire IPv6 packet, the performance in terms of packet loss and throughput of multi-fragment multicast IPv6 packets is typically far worse than the performance of single-fragment IPv6 multicast packets. For this reason, a CoAP request sent over multicast in 6LoWPAN networks SHOULD be sized in such a way that it fits in a single IEEE 802.15.4 MAC frame, if possible.<a href="#section-3.9.3-1" class="pilcrow">¶</a></p>
<p id="section-3.9.3-2">On 6LoWPAN networks, multicast groups can be defined with realm-local scope <span>[<a href="#RFC7346" class="xref">RFC7346</a>]</span>. Such a realm-local group is restricted to the local 6LoWPAN network/subnet. In other words, a multicast request to that group does not propagate beyond the 6LoWPAN network segment where the request originated. For example, a multicast discovery request can be sent to the realm-local "All CoAP Nodes" IPv6 multicast group (see <a href="#sec-udptransport" class="xref">Section 3.9.1</a>) in order to discover only CoAP servers on the local 6LoWPAN network.<a href="#section-3.9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-transports">
<section id="section-3.9.4">
          <h4 id="name-other-transports">
<a href="#section-3.9.4" class="section-number selfRef">3.9.4. </a><a href="#name-other-transports" class="section-name selfRef">Other Transports</a>
          </h4>
<p id="section-3.9.4-1">CoAP group communication may be used over transports other than UDP/IP multicast. For example broadcast, non-UDP multicast, geocast, serial unicast, etc. In such cases the particular considerations for UDP/IP multicast in this document may need to be applied to that particular transport.<a href="#section-3.9.4-1" class="pilcrow">¶</a></p>
<p id="section-3.9.4-2">Because it supports unicast only, <span>[<a href="#RFC8323" class="xref">RFC8323</a>]</span> (CoAP over TCP, TLS, and WebSockets) is not in scope as a transport for CoAP group communication.<a href="#section-3.9.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-other-protocols">
<section id="section-3.10">
        <h3 id="name-interworking-with-other-pro">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-interworking-with-other-pro" class="section-name selfRef">Interworking with Other Protocols</a>
        </h3>
<div id="mldmldv2igmpigmpv3">
<section id="section-3.10.1">
          <h4 id="name-mld-mldv2-igmp-igmpv3">
<a href="#section-3.10.1" class="section-number selfRef">3.10.1. </a><a href="#name-mld-mldv2-igmp-igmpv3" class="section-name selfRef">MLD/MLDv2/IGMP/IGMPv3</a>
          </h4>
<p id="section-3.10.1-1">CoAP nodes that are IP hosts (i.e., not IP routers) are generally unaware of the specific IP multicast routing/forwarding protocol
being used in their network.  When such a host needs to join a specific (CoAP) multicast group, it requires a way to signal to IP multicast routers
which IP multicast address(es) it needs to listen to.<a href="#section-3.10.1-1" class="pilcrow">¶</a></p>
<p id="section-3.10.1-2">The MLDv2 protocol <span>[<a href="#RFC3810" class="xref">RFC3810</a>]</span> is the standard IPv6 method to achieve this; therefore, this method SHOULD be used by members of a CoAP group to subscribe to its multicast IPv6 address, on IPv6 networks that support it. CoAP server nodes then act in the role of MLD Multicast Address Listener. MLDv2 uses link-local communication between Listeners and IP multicast routers. Constrained IPv6 networks that implement either RPL (see <a href="#sec-rpl" class="xref">Section 3.10.2</a>) or MPL (see <a href="#sec-mpl" class="xref">Section 3.10.3</a>) typically
do not support MLDv2 as they have their own mechanisms defined for subscribing to multicast groups.<a href="#section-3.10.1-2" class="pilcrow">¶</a></p>
<p id="section-3.10.1-3">The IGMPv3 protocol <span>[<a href="#RFC3376" class="xref">RFC3376</a>]</span> is the standard IPv4 method to signal multicast group subscriptions. This SHOULD be used by members of a CoAP group to subscribe to its multicast IPv4 address on IPv4 networks.<a href="#section-3.10.1-3" class="pilcrow">¶</a></p>
<p id="section-3.10.1-4">The guidelines from <span>[<a href="#RFC6636" class="xref">RFC6636</a>]</span> on the tuning of MLD for mobile and wireless networks may be useful when implementing MLD in constrained networks.<a href="#section-3.10.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-rpl">
<section id="section-3.10.2">
          <h4 id="name-rpl">
<a href="#section-3.10.2" class="section-number selfRef">3.10.2. </a><a href="#name-rpl" class="section-name selfRef">RPL</a>
          </h4>
<p id="section-3.10.2-1">RPL <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> is an IPv6 based routing protocol suitable for low-power, lossy networks (LLNs). In such a context, CoAP is often used as an application protocol.<a href="#section-3.10.2-1" class="pilcrow">¶</a></p>
<p id="section-3.10.2-2">If only RPL is used in a network for routing and its optional multicast support is disabled, there will be no IP multicast routing available.  Any IPv6 multicast packets in this case will not propagate beyond a single hop (to direct neighbors in the LLN). This implies that any CoAP group request will be delivered to link-local nodes only, for any scope value &gt;= 2 used in the IPv6 destination address.<a href="#section-3.10.2-2" class="pilcrow">¶</a></p>
<p id="section-3.10.2-3">RPL supports (see <span><a href="https://rfc-editor.org/rfc/rfc6550#section-12" class="relref">Section 12</a> of [<a href="#RFC6550" class="xref">RFC6550</a>]</span>) advertisement of IP multicast destinations using Destination Advertisement Object (DAO) messages and subsequent routing of multicast IPv6 packets based on this.  It requires the RPL mode of operation to be 3 (Storing mode with multicast support).<a href="#section-3.10.2-3" class="pilcrow">¶</a></p>
<p id="section-3.10.2-4">In this mode, RPL DAO can be used by a CoAP node that is either an RPL router or RPL Leaf Node, to advertise its CoAP group membership to parent RPL routers. Then, RPL will route any IP multicast CoAP requests over multiple hops to those CoAP servers that are group members.<a href="#section-3.10.2-4" class="pilcrow">¶</a></p>
<p id="section-3.10.2-5">The same DAO mechanism can be used to convey CoAP group membership information to an edge router (e.g., 6LBR), in case the edge router is also the root of the RPL Destination-Oriented Directed Acyclic Graph (DODAG). This is useful because the edge router then learns which IP multicast traffic it needs to pass through from the backbone network into the LLN subnet, and which traffic not.  In LLNs, such ingress filtering helps to avoid congestion of the resource-constrained network segment, due to IP multicast traffic from the high-speed backbone IP network.<a href="#section-3.10.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-mpl">
<section id="section-3.10.3">
          <h4 id="name-mpl">
<a href="#section-3.10.3" class="section-number selfRef">3.10.3. </a><a href="#name-mpl" class="section-name selfRef">MPL</a>
          </h4>
<p id="section-3.10.3-1">The Multicast Protocol for Low-Power and Lossy Networks (MPL) <span>[<a href="#RFC7731" class="xref">RFC7731</a>]</span> can be used for propagation of IPv6 multicast packets throughout a defined network domain, over multiple hops.  MPL is designed to work in LLNs and can operate alone or in combination with RPL. The protocol involves a predefined group of MPL Forwarders to collectively distribute IPv6 multicast packets throughout their MPL Domain. An MPL Forwarder may be associated to multiple MPL Domains at the same time. Non-Forwarders will receive IPv6 multicast packets from one or more of their neighboring Forwarders. Therefore, MPL can be used to propagate a CoAP multicast group request to all group members.<a href="#section-3.10.3-1" class="pilcrow">¶</a></p>
<p id="section-3.10.3-2">However, a CoAP multicast request to a group that originated outside of the MPL Domain will not be propagated by MPL - unless an MPL Forwarder is explicitly configured as an ingress point that introduces external multicast packets into the MPL Domain. Such an ingress point could be located on an edge router (e.g., 6LBR). Methods to configure which multicast groups are to be propagated into the MPL Domain could be:<a href="#section-3.10.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.10.3-3.1">Manual configuration on each ingress MPL Forwarder.<a href="#section-3.10.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.10.3-3.2">MLDv2 protocol, which works only in case all CoAP servers joining a group are in link-local communication range of an ingress MPL Forwarder. This is typically not the case on mesh networks.<a href="#section-3.10.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.10.3-3.3">A new/custom protocol to register multicast groups at an ingress MPL Forwarder. This could be for example a CoAP-based protocol offering multicast group subscription features similar to MLDv2.<a href="#section-3.10.3-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.10.3-4">For security and performance reasons also other filtering criteria may be defined at an ingress MPL Forwarder. See <a href="#sec-security-considerations-6lowpan-mpl" class="xref">Section 6.6</a> for more details.<a href="#section-3.10.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="chap-unsecured-groupcomm">
<section id="section-4">
      <h2 id="name-unsecured-group-communicati">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-unsecured-group-communicati" class="section-name selfRef">Unsecured Group Communication</a>
      </h2>
<p id="section-4-1">CoAP group communication can operate in CoAP NoSec (No Security) mode, without using application-layer and transport-layer security mechanisms. The NoSec mode uses the "coap" scheme, and is defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-9" class="relref">Section 9</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>. The conceptual "NoSec" security group as defined in <a href="#sec-groupdef" class="xref">Section 2.1</a> is used for unsecured group communication.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Before using this mode of operation, the security implications (<a href="#chap-security-considerations-nosec-mode" class="xref">Section 6.1</a>) must be well understood, especially as to the risk and impact of amplification attacks (see <a href="#ssec-amplification" class="xref">Section 6.3</a>).<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chap-oscore">
<section id="section-5">
      <h2 id="name-secured-group-communication">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-secured-group-communication" class="section-name selfRef">Secured Group Communication using Group OSCORE</a>
      </h2>
<p id="section-5-1">This section defines how CoAP group communication can be secured. In particular, <a href="#chap-group-oscore" class="xref">Section 5.1</a> describes how the Group OSCORE security protocol <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> can be used to protect messages exchanged in a CoAP group, while <a href="#chap-sec-group-maintenance" class="xref">Section 5.2</a> provides guidance on required maintenance operations for OSCORE groups used as security groups.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="chap-group-oscore">
<section id="section-5.1">
        <h3 id="name-group-oscore">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-group-oscore" class="section-name selfRef">Group OSCORE</a>
        </h3>
<p id="section-5.1-1">The application-layer protocol Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> provides end-to-end encryption, integrity and replay protection of CoAP messages exchanged between two CoAP endpoints. These can act both as CoAP Client as well as CoAP Server, and share an OSCORE Security Context used to protect and verify exchanged messages. The use of OSCORE does not affect the URI scheme and OSCORE can therefore be used with any URI scheme defined for CoAP.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">OSCORE uses COSE <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span> <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span> to perform encryption operations and protect a CoAP message carried in a COSE object, by using an Authenticated Encryption with Associated Data (AEAD) algorithm. In particular, OSCORE takes as input an unprotected CoAP message and transforms it into a protected CoAP message transporting the COSE object.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">OSCORE makes it possible to selectively protect different parts of a CoAP message in different ways, while still allowing intermediaries (e.g., CoAP proxies) to perform their intended funtionalities. That is, some message parts are encrypted and integrity protected; other parts are only integrity protected to be accessible to, but not modifiable by, proxies; and some parts are kept as plain content to be both accessible to and modifiable by proxies. Such differences especially concern the CoAP options included in the unprotected message.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> builds on OSCORE, and provides end-to-end security of CoAP messages exchanged between members of an OSCORE group, while fulfilling the same security requirements.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">In particular, Group OSCORE protects CoAP group requests sent by a CoAP client, e.g., over UDP/IP multicast, as well as multiple corresponding CoAP responses sent as (IP) unicast by different CoAP servers. However, the same security material can also be used to protect CoAP requests sent over (IP) unicast to a single CoAP server in the OSCORE group, as well as the corresponding responses.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">Group OSCORE ensures source authentication of all messages exchanged within the OSCORE group, by means of two possible methods.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">The first method, called group mode, relies on digital signatures. That is, sender devices sign their outgoing messages using their own private key, and embed the signature in the protected CoAP message.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">The second method, called pairwise mode, relies on a symmetric key, which is derived from a pairwise shared secret computed from the asymmetric keys of the message sender and recipient. This method is intended for one-to-one messages sent in the group, such as all responses individually sent by servers, as well as requests addressed to an individual server.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">A Group Manager is responsible for managing one or multiple OSCORE groups. In particular, the Group Manager acts as repository of public keys of group members; manages, renews and provides security material in the group; and handles the join process of new group members.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">As defined in <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>, an administrator entity can interact with the Group Manager to create OSCORE groups and specify their configuration (see <a href="#sssec-group-creation" class="xref">Section 2.2.2</a>). During the lifetime of the OSCORE group, the administrator can further interact with the Group Manager, in order to possibly update the group configuration and eventually delete the group.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<p id="section-5.1-11">As recommended in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, a CoAP endpoint can join an OSCORE group by using the method described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> and based on the ACE framework for Authentication and Authorization in constrained environments <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<p id="section-5.1-12">A CoAP endpoint can discover OSCORE groups and retrieve information to join them through their respective Group Managers by using the method described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span> and based on the CoRE Resource Directory <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>.<a href="#section-5.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1-13">If security is required, CoAP group communication as described in this specification MUST use Group OSCORE. In particular, a CoAP group as defined in <a href="#sec-groupdef" class="xref">Section 2.1</a> and using secure group communication is associated to an OSCORE security group, which includes:<a href="#section-5.1-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-14.1">All members of the CoAP group, i.e., the CoAP endpoints configured to receive CoAP group messages sent to the particular group and -- in case of IP multicast transport -- are listening to the group's multicast IP address on the group's UDP port.<a href="#section-5.1-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-14.2">All further CoAP endpoints configured only as CoAP clients, that may send CoAP group requests to the CoAP group.<a href="#section-5.1-14.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="chap-sec-group-maintenance">
<section id="section-5.2">
        <h3 id="name-secure-group-maintenance">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-secure-group-maintenance" class="section-name selfRef">Secure Group Maintenance</a>
        </h3>
<p id="section-5.2-1">As part of group maintenance operations (see <a href="#sec-group-maintenance" class="xref">Section 2.2.4</a>), additional key management operations are required for an OSCORE group, also depending on the security requirements of the application (see <a href="#chap-security-considerations-sec-mode" class="xref">Section 6.2</a>). Specifically:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">
            <p id="section-5.2-2.1.1">Adding new members to a CoAP group or enabling new client-only endpoints to interact with that group require also that each of such members/endpoints join the corresponding OSCORE group. By doing so, they are securely provided with the necessary cryptographic material.<a href="#section-5.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.1.2">
In case backward security is needed, this also requires to first renew such material and distribute it to the current members/endpoints, before new ones are added and join the OSCORE group. This prevents the new group members to access secure group communications that occurred in the group before their joining.<a href="#section-5.2-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">Removing members from a CoAP group or stopping client-only endpoints from interacting with that group requires removing such members/endpoints from the corresponding OSCORE group. To this end, new cryptographic material is generated and securely distributed only to the remaining members/endpoints, together with the list of removed members/endpoints.<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.2.2">
This ensures that only the members/endpoints intended to remain are able to continue participating in secure group communication, while the evicted ones are not able to. Also, it ensures that the members/endpoints intended to remain are able to confidently assert the group membership of other sender nodes, when receiving protected messages in the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-5.2-2.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-3">The key management operations mentioned above are entrusted to the Group Manager responsible for the OSCORE group <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, and it is RECOMMENDED to perform them according to the approach described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chap-proxy-security">
<section id="section-5.3">
        <h3 id="name-proxy-security">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-proxy-security" class="section-name selfRef">Proxy Security</a>
        </h3>
<p id="section-5.3-1">Different solutions may be selected for secure group communication via a proxy depending on proxy type, use case and deployment requirements. In this section the options based on Group OSCORE are listed.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">For a client performing a group communication request via a forward-proxy, end-to-end security should be implemented. The client then creates a group request protected with Group OSCORE and unicasts this to the proxy. The proxy adapts the request from a forward-proxy request to a regular request and multicasts this adapted request to the indicated CoAP group. During the adaptation, the security provided by Group OSCORE persists, in either case of using the group mode or using the pairwise mode. The first leg of communication from client to proxy can optionally be further protected, e.g., by using (D)TLS and/or OSCORE.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">For a client performing a group communication request via a reverse-proxy, either end-to-end-security or hop-by-hop security can be implemented.
The case of end-to-end security is the same as for the forward-proxy case.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The case of hop-by-hop security is only possible if the proxy can be completely trusted and it is configured as a member of the OSCORE security group(s) that it needs to access, on behalf of clients. The first leg of communication between client and proxy is then protected with a security method for CoAP unicast, such as (D)TLS, OSCORE or a combination of such methods. The second leg between proxy and servers is protected using Group OSCORE. This can be useful in applications where for example the origin client does not implement Group OSCORE, or the group management operations are confined to a particular network domain and the client is outside this domain.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">For all the above cases, more details on using Group OSCORE are defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span>.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="chap-security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">This section provides security considerations for CoAP group communication, in general and for the particular transport of IP multicast.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="chap-security-considerations-nosec-mode">
<section id="section-6.1">
        <h3 id="name-coap-nosec-mode">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-coap-nosec-mode" class="section-name selfRef">CoAP NoSec Mode</a>
        </h3>
<p id="section-6.1-1">CoAP group communication, if not protected, is vulnerable to all the attacks mentioned in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11" class="relref">Section 11</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> for IP multicast.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Thus, for sensitive and mission-critical applications (e.g., health monitoring systems and alarm monitoring systems), it is NOT RECOMMENDED to deploy CoAP group communication in NoSec mode.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Without application-layer security, CoAP group communication SHOULD only be deployed in applications that are non-critical, and that do not involve or may have an impact on sensitive data and personal sphere. These include, e.g., read-only temperature sensors deployed in non-sensitive environments, where the client reads out the values but does not use the data to control actuators or to base an important decision on.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">Early discovery of devices and resources is a typical use case where NoSec mode is applied, since the devices involved do not have yet configured any mutual security relations at the time the discovery takes place.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">If NoSec mode is used, amplification attacks <span>[<a href="#I-D.mattsson-core-coap-attacks" class="xref">I-D.mattsson-core-coap-attacks</a>]</span> are especially feasible to perform and effective in their impact. Therefore, in order to prevent an easy proliferation of high-volume amplification attacks, it is generally NOT RECOMMENDED to use CoAP group communication in NoSec mode, as further discussed in <a href="#ssec-amplification" class="xref">Section 6.3</a>.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chap-security-considerations-sec-mode">
<section id="section-6.2">
        <h3 id="name-group-oscore-2">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-group-oscore-2" class="section-name selfRef">Group OSCORE</a>
        </h3>
<p id="section-6.2-1">Group OSCORE provides end-to-end application-level security. This has many desirable properties, including maintaining security assurances while forwarding traffic through intermediaries (proxies). Application-level security also tends to more cleanly separate security from the dynamics of group membership (e.g., the problem of distributing security keys across large groups with many members that come and go).<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">For sensitive and mission-critical applications, CoAP group communication MUST be protected by using Group OSCORE as specified in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. The same security considerations from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-10" class="relref">Section 10</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> hold for this specification.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<div id="chap-security-considerations-sec-mode-key-mgmt">
<section id="section-6.2.1">
          <h4 id="name-group-key-management">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-group-key-management" class="section-name selfRef">Group Key Management</a>
          </h4>
<p id="section-6.2.1-1">A key management scheme for secure revocation and renewal of group security material, namely group rekeying, is required to be adopted in OSCORE groups. The key management scheme has to preserve forward security in the OSCORE group, as well as backward security if this is required by the application. In particular, the key management scheme MUST comply with the functional steps defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">Group policies should also take into account the time that the key management scheme requires to rekey the group, on one hand, and the expected frequency of group membership changes, i.e., nodes' joining and leaving, on the other hand.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">That is, it may be desirable to not rekey the group upon every single membership change, in case members' joining and leaving are frequent, and at the same time a single group rekeying instance takes a non-negligible time to complete.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<p id="section-6.2.1-4">In such a case, the Group Manager may cautiously consider to rekey the group, e.g., after a minimum number of nodes has joined or left the group within a pre-defined time interval, or according to communication patterns with predictable time intervals of network inactivity. This would prevent paralyzing communications in the group, when a slow rekeying scheme is used and frequently invoked.<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<p id="section-6.2.1-5">At the same, the security implications of delaying the rekeying process have to be carefully considered and understood, before enforcing such group policies.<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<p id="section-6.2.1-6">In fact, this comes at the cost of not continuously preserving backward and forward security, since group rekeying might not occur upon every single group membership change. That is, most recently joined nodes would have access to the security material used prior to their join, and thus be able to access past group communications protected with that security material. Similarly, until the group is rekeyed, most recently left nodes would preserve access to group communications protected with the retained security material.<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chap-security-considerations-sec-mode-sauth">
<section id="section-6.2.2">
          <h4 id="name-source-authentication">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-source-authentication" class="section-name selfRef">Source Authentication</a>
          </h4>
<p id="section-6.2.2-1">Both the group mode and the pairwise mode of Group OSCORE ensure source authentication of messages exchanged by CoAP endpoints through CoAP group communication.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">To this end, outgoing messages are either countersigned by the message sender endpoint with its own private key (group mode), or protected with a symmetric key, which is in turn derived using the asymmetric keys of the message sender and recipient (pairwise mode).<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2.2-3">Thus, both modes allow a recipient CoAP endpoint to verify that a message has actually been originated by a specific and identified member of the OSCORE group.<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chap-security-considerations-sec-mode-attacks">
<section id="section-6.2.3">
          <h4 id="name-countering-attacks">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-countering-attacks" class="section-name selfRef">Countering Attacks</a>
          </h4>
<p id="section-6.2.3-1">As discussed below, Group OSCORE addresses a number of security attacks mentioned in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11" class="relref">Section 11</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, with particular reference to their execution over IP multicast.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.3-2.1">Since Group OSCORE provides end-to-end confidentiality and integrity of request/response messages, proxies capable of group communication cannot break message protection, and thus cannot act as man-in-the-middle beyond their legitimate duties (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.2" class="relref">Section 11.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>). In fact, intermediaries such as proxies are not assumed to have access to the OSCORE Security Context used by group members. Also, with the notable addition of signatures for the group mode, Group OSCORE protects messages using the same procedure as OSCORE (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8" class="relref">8</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-9" class="relref">9</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), and especially processes CoAP options according to the same classification in U/I/E classes.<a href="#section-6.2.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.3-2.2">
              <p id="section-6.2.3-2.2.1">Group OSCORE limits the feasibility and impact of amplification attacks, see <a href="#ssec-amplification" class="xref">Section 6.3</a> of this document and <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.3" class="relref">Section 11.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>.<a href="#section-6.2.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2.2.2">
In fact, upon receiving a request over IP multicast as protected with Group OSCORE in group mode, a server is able to verify whether the request is not a replay and originates from the alleged sender in the OSCORE group, by verifying the signature included in the request using the public key of that sender (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.2" class="relref">Section 8.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). Furthermore, as also discussed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, it is recommended that servers failing to decrypt and verify an incoming message do not send back any error message.<a href="#section-6.2.3-2.2.2" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2.2.3">
This limits an adversary to leveraging an intercepted group request protected with Group OSCORE, and then altering the source IP address to be the one of the intended amplification victim.<a href="#section-6.2.3-2.2.3" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2.2.4">
As discussed in the next point, a server can also rely on the Echo Option for CoAP described in <span>[<a href="#I-D.ietf-core-echo-request-tag" class="xref">I-D.ietf-core-echo-request-tag</a>]</span>, and possibly use it to assert that the alleged sender of the group request (i.e., the CoAP client associated to a certain public key) is indeed reachable at the claimed source address, especially if this differs from the one used in previous group requests from the same CoAP client. Although responses including the Echo Option do result in amplification, this is limited in volume compared to when all servers reply with a full-fledged response.<a href="#section-6.2.3-2.2.4" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2.2.5">
Furthermore, the adversary needs to consider a group request that specifically targets a resource for which the CoAP servers are configured to respond. While this can be often correctly assumed or inferrable from the application context, it is not explicit from the group request itself, since Group OSCORE protects the Uri-Path and Uri-Query CoAP Options conveying the respective components of the target URI.<a href="#section-6.2.3-2.2.5" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.3-2.3">
              <p id="section-6.2.3-2.3.1">Group OSCORE limits the impact of attacks based on IP spoofing also over IP multicast (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.4" class="relref">Section 11.4</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>). In fact, requests and corresponding responses sent in the OSCORE group can be correctly generated only by legitimate group members.<a href="#section-6.2.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2.3.2">
Within an OSCORE group, the shared symmetric-key security material strictly provides only group-level authentication. However, source authentication of messages is also ensured, both in the group mode by means of signatures (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.1" class="relref">8.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.3" class="relref">8.3</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), and in the pairwise mode by using additionally derived pairwise keys (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-9.3" class="relref">9.3</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-9.5" class="relref">9.5</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). Thus, recipient endpoints can verify a message to be originated by the alleged, identifiable sender in the OSCORE group.<a href="#section-6.2.3-2.3.2" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2.3.3">
Note that the server may additionally rely on the Echo Option for CoAP described in <span>[<a href="#I-D.ietf-core-echo-request-tag" class="xref">I-D.ietf-core-echo-request-tag</a>]</span>, in order to verify the aliveness and reachability of the client sending a request from a particular IP address.<a href="#section-6.2.3-2.3.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.3-2.4">Group OSCORE does not require group members to be equipped with a good source of entropy for generating security material (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.6" class="relref">Section 11.6</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>), and thus does not contribute to create an entropy-related attack vector against such (constrained) CoAP endpoints. In particular, the symmetric keys used for message encryption and decryption are derived through the same HMAC-based HKDF scheme used for OSCORE (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>). Besides, the OSCORE Master Secret used in such derivation is securely generated by the Group Manager responsible for the OSCORE group, and securely provided to the CoAP endpoints when they join the group.<a href="#section-6.2.3-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.3-2.5">Group OSCORE prevents to make any single group member a target for subverting security in the whole OSCORE group (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.6" class="relref">Section 11.6</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>), even though all group members share (and can derive) the same symmetric-key security material used in the OSCORE group. In fact, source authentication is always ensured for exchanged CoAP messages, as verifiable to be originated by the alleged, identifiable sender in the OSCORE group. This relies on including a signature computed with a node's individual private key (in the group mode), or on protecting messages with a pairwise symmetric key, which is in turn derived from the asymmetric keys of the sender and recipient CoAP endpoints (in the pairwise mode).<a href="#section-6.2.3-2.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ssec-amplification">
<section id="section-6.3">
        <h3 id="name-risk-of-amplification">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-risk-of-amplification" class="section-name selfRef">Risk of Amplification</a>
        </h3>
<p id="section-6.3-1"><span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.3" class="relref">Section 11.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> highlights that CoAP group requests may be used for accidentally or deliberately performing Denial of Service attacks, especially in the form of a high-volume amplification attack, by using all the servers in the CoAP group as attack vectors. Since potentially all the servers in the CoAP group may respond, the achieved amplification factor can be high, as multiple responses are sent and all are likely larger than the group request.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2"><span><a href="https://datatracker.ietf.org/doc/html/draft-mattsson-core-coap-attacks-00#section-3" class="relref">Section 3</a> of [<a href="#I-D.mattsson-core-coap-attacks" class="xref">I-D.mattsson-core-coap-attacks</a>]</span> further discusses this attack, and notes how the amplification factor would become even higher when group communication is combined with resource observation <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>. That is, a single group request may result in multiple notification responses from each of the responding servers, throughout the observation lifetime.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">Consistently with <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.3" class="relref">Section 11.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, a CoAP server in a CoAP group SHOULD limit the support for CoAP group requests only to the group resources of the application group(s) using that CoAP group.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">It is especially easy to perform an amplification attack when NoSec mode is used. Therefore, in order to prevent an easy proliferation of high-volume amplification attacks, it is generally NOT RECOMMENDED to use CoAP group communication in NoSec mode.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">Exceptions should be carefully limited to use cases and accesses to a group resource that have a specific, narrow and well understood scope, and where only a few CoAP servers (or ideally only one) would possibly respond to a group request.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">A relevant example is a CoAP client performing the discovery of hosts such as a group manager or a Resource Directory <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>, by probing for them through a group request sent to the CoAP group. This early, unprotected step is relevant for a CoAP client that does not know the address of such hosts in advance, and that does not have yet configured a mutual security relation with them. In this kind of deployments, such a discovery procedure does not result in a considerable and harmful amplification, since only the few CoAP servers object of discovery are going to respond to the group request targeting that specific resource. In particular, those hosts can be the only CoAP servers in that specific CoAP group (hence listening for group requests sent to that group), and/or the only CoAP servers explicitly configured to respond to group requests targeting specific group resources.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<p id="section-6.3-7">In any other case, group communications MUST be secured using Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, see <a href="#chap-oscore" class="xref">Section 5</a>. As discussed in <a href="#chap-security-considerations-sec-mode-attacks" class="xref">Section 6.2.3</a>, this limits the feasibility and impact of amplification attacks.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay-of-non-confirmable-messages">
<section id="section-6.4">
        <h3 id="name-replay-of-non-confirmable-m">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-replay-of-non-confirmable-m" class="section-name selfRef">Replay of Non-Confirmable Messages</a>
        </h3>
<p id="section-6.4-1">Since all requests sent over IP multicast are Non-confirmable, a client might not be able to know if an adversary has actually captured one of its transmitted requests and later re-injected it in the group as a replay to the server nodes. In fact, even if the servers sent back responses to the replayed request, the client would typically not have a valid matching request active anymore so this attack would not accomplish anything in the client.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">If Group OSCORE is used, such a replay attack on the servers is prevented, since a client protects every different request with a different Sequence Number value, which is in turn included as Partial IV in the protected message and takes part in the construction of the AEAD cipher nonce. Thus, a server would be able to detect the replayed request, by checking the conveyed Partial IV against its own replay window in the OSCORE Recipient Context associated to the client.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">This requires a server to have a synchronized, up to date view of the sequence number used by the client. If such synchronization is lost, e.g., due to a reboot, or suspected so, the server should use the challenge-response synchronization method described in Appendix E of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and based on the Echo Option for CoAP defined in <span>[<a href="#I-D.ietf-core-echo-request-tag" class="xref">I-D.ietf-core-echo-request-tag</a>]</span>, in order to (re-)synchronize with the client's sequence number.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-coap-no-response-option">
<section id="section-6.5">
        <h3 id="name-use-of-coap-no-response-opt">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-use-of-coap-no-response-opt" class="section-name selfRef">Use of CoAP No-Response Option</a>
        </h3>
<p id="section-6.5-1">When CoAP group communication is used in CoAP NoSec (No Security)
mode (see <a href="#chap-unsecured-groupcomm" class="xref">Section 4</a>), the CoAP No-Response Option <span>[<a href="#RFC7967" class="xref">RFC7967</a>]</span> could be misused by a malicious client to evoke as much responses from servers to a group request as possible, by using the value '0' - Interested in all responses. This even overrides the default behaviour of a CoAP server to suppress the response in case there is nothing of interest to respond with. Therefore, this option can be used to perform an amplification attack (see <a href="#ssec-amplification" class="xref">Section 6.3</a>).<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">A proposed mitigation is to only allow this option to relax the standard suppression rules for a resource in case the option is sent by an authenticated client. If sent by an unauthenticated client, the option can be used to expand the classes of responses suppressed compared to the default rules but not to reduce the classes of responses suppressed.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-security-considerations-6lowpan-mpl">
<section id="section-6.6">
        <h3 id="name-6lowpan-and-mpl">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-6lowpan-and-mpl" class="section-name selfRef">6LoWPAN and MPL</a>
        </h3>
<p id="section-6.6-1">In a 6LoWPAN network, a multicast IPv6 packet may be fragmented prior to transmission. A 6LoWPAN Router that forwards a fragmented packet may have a relatively high impact on the occupation of the wireless channel and may locally experience high memory load due to packet buffering. For example, the MPL <span>[<a href="#RFC7731" class="xref">RFC7731</a>]</span> protocol requires an MPL Forwarder to store the packet for a longer duration, to allow multiple forwarding transmissions to neighboring Forwarders. If one or more of the fragments are not received correctly by an MPL Forwarder during its packet reassembly time window, the Forwarder discards all received fragments and at a future point in time it needs to receive again all the packet fragments (this time, possibly from another neighboring MPL Forwarder).<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">For these reasons, a fragmented IPv6 multicast packet is a possible attack vector in a Denial of Service (DoS) amplification attack. See <a href="#ssec-amplification" class="xref">Section 6.3</a> of this document and <span><a href="https://rfc-editor.org/rfc/rfc7252#section-11.3" class="relref">Section 11.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> for more details on amplification. To mitigate the risk, applications sending multicast IPv6 requests to 6LoWPAN hosted CoAP servers SHOULD limit the size of the request to avoid 6LoWPAN fragmentation of the request packet. A 6LoWPAN Router or (MPL) multicast forwarder SHOULD deprioritize forwarding for multi-fragment 6LoWPAN multicast packets. 6LoWPAN Border Routers are typical ingress points where multicast traffic enters into a 6LoWPAN network. Specific MPL Forwarders (whether located on a 6LBR or not) may also be configured as ingress points. Any such ingress point SHOULD implement multicast packet filtering to prevent unwanted multicast traffic from entering a 6LoWPAN network from the outside. For example, it could filter out all multicast packets for which there is no known multicast listener on the 6LoWPAN network. See <a href="#sec-other-protocols" class="xref">Section 3.10</a> for protocols that allow multicast listeners to signal which groups they would like to listen to. As part of multicast packet filtering, the ingress point SHOULD implement a filtering criterium based on the size of the multicast packet. Ingress multicast packets above a defined size may then be dropped or deprioritized.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wi-fi">
<section id="section-6.7">
        <h3 id="name-wi-fi">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-wi-fi" class="section-name selfRef">Wi-Fi</a>
        </h3>
<p id="section-6.7-1">In a home automation scenario using Wi-Fi, Wi-Fi security
   should be enabled to prevent rogue nodes from joining.  The Customer
   Premises Equipment (CPE) that enables access to the Internet should
   also have its IP multicast filters set so that it enforces multicast
   scope boundaries to isolate local multicast groups from the rest of
   the Internet (e.g., as per <span>[<a href="#RFC6092" class="xref">RFC6092</a>]</span>).  In addition, the scope of
   IP multicast transmissions and listeners should be site-local (5) or smaller.  For
   site-local scope, the CPE will be an appropriate multicast scope
   boundary point.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="monitoring">
<section id="section-6.8">
        <h3 id="name-monitoring">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-monitoring" class="section-name selfRef">Monitoring</a>
        </h3>
<div id="general-monitoring">
<section id="section-6.8.1">
          <h4 id="name-general-monitoring">
<a href="#section-6.8.1" class="section-number selfRef">6.8.1. </a><a href="#name-general-monitoring" class="section-name selfRef">General Monitoring</a>
          </h4>
<p id="section-6.8.1-1">CoAP group communication can be used to control a set of
   related devices: for example, simultaneously turn on all the lights in a
   room.  This intrinsically exposes the group to some unique
   monitoring risks that devices not in a group
   are not as vulnerable to.  For example, assume an attacker is able to
   physically see a set of lights turn on in a room.  Then the attacker
   can correlate an observed CoAP group communication message to the observed
   coordinated group action -- even if the CoAP message is (partly) encrypted.
   This will give the attacker side-channel information
   to plan further attacks (e.g., by determining the members of the
   group some network topology information may be deduced).<a href="#section-6.8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pervasive-monitoring">
<section id="section-6.8.2">
          <h4 id="name-pervasive-monitoring">
<a href="#section-6.8.2" class="section-number selfRef">6.8.2. </a><a href="#name-pervasive-monitoring" class="section-name selfRef">Pervasive Monitoring</a>
          </h4>
<p id="section-6.8.2-1">A key additional threat consideration for group communication is
   pervasive monitoring <span>[<a href="#RFC7258" class="xref">RFC7258</a>]</span>.  CoAP group communication solutions that are built on top
   of IP multicast need to pay particular heed to these dangers.  This
   is because IP multicast is easier to intercept compared to IP unicast.  Also, CoAP traffic is typically used for
   the Internet of Things.  This means that CoAP (multicast) group communication may be used for
   the control and monitoring of critical infrastructure (e.g., lights,
   alarms, HVAC, electrical grid, etc.) that may be prime targets for attack.<a href="#section-6.8.2-1" class="pilcrow">¶</a></p>
<p id="section-6.8.2-2">For example, an attacker may attempt to record all the CoAP traffic
   going over a smart grid (i.e., networked electrical utility)
   and try to determine critical nodes for further attacks.  For
   example, the source node (controller) sends out CoAP group
   communication messages which easily identifies it as a controller. 
   CoAP multicast traffic is inherently more
   vulnerable compared to unicast, as the same packet may be
   replicated over many more links, leading to a higher probability of
   packet capture by a pervasive monitoring system.<a href="#section-6.8.2-2" class="pilcrow">¶</a></p>
<p id="section-6.8.2-3">One mitigation is to restrict the scope of IP multicast to the minimal scope that fulfills the
   application need. See the congestion control recommendations in the last bullet of
   <a href="#sec-congestion" class="xref">Section 3.6</a> to minimize the scope. Thus, for example, realm-local IP multicast scope
   is always preferred over site-local scope IP multicast if this fulfills the application needs.<a href="#section-6.8.2-3" class="pilcrow">¶</a></p>
<p id="section-6.8.2-4">Even if all CoAP multicast traffic is encrypted/protected,
   an attacker may still attempt to capture this traffic and perform an
   off-line attack in the future.<a href="#section-6.8.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no actions for IANA.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-core-echo-request-tag">[I-D.ietf-core-echo-request-tag]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"CoAP: Echo, Request-Tag, and Token Processing"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-echo-request-tag-12</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-echo-request-tag-12.txt">https://www.ietf.org/archive/id/draft-ietf-core-echo-request-tag-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-12</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-12.txt">https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-algs">[I-D.ietf-cose-rfc8152bis-algs]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-algs-12</span>, <time datetime="2020-09-24" class="refDate">24 September 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-struct">[I-D.ietf-cose-rfc8152bis-struct]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-struct-15</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3376">[RFC3376]</dt>
        <dd>
<span class="refAuthor">Cain, B.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Kouvelas, I.</span>, <span class="refAuthor">Fenner, B.</span>, and <span class="refAuthor">A. Thyagarajan</span>, <span class="refTitle">"Internet Group Management Protocol, Version 3"</span>, <span class="seriesInfo">RFC 3376</span>, <span class="seriesInfo">DOI 10.17487/RFC3376</span>, <time datetime="2002-10" class="refDate">October 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3376">https://www.rfc-editor.org/info/rfc3376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
        <dd>
<span class="refAuthor">Vida, R., Ed.</span> and <span class="refAuthor">L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4944">[RFC4944]</dt>
        <dd>
<span class="refAuthor">Montenegro, G.</span>, <span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Hui, J.</span>, and <span class="refAuthor">D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4944">https://www.rfc-editor.org/info/rfc4944</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6282">[RFC6282]</dt>
        <dd>
<span class="refAuthor">Hui, J., Ed.</span> and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7641">https://www.rfc-editor.org/info/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8075">[RFC8075]</dt>
        <dd>
<span class="refAuthor">Castellani, A.</span>, <span class="refAuthor">Loreto, S.</span>, <span class="refAuthor">Rahman, A.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">E. Dijk</span>, <span class="refTitle">"Guidelines for Mapping Implementations: HTTP to the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8075</span>, <span class="seriesInfo">DOI 10.17487/RFC8075</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8075">https://www.rfc-editor.org/info/rfc8075</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8132">[RFC8132]</dt>
        <dd>
<span class="refAuthor">van der Stok, P.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">A. Sehgal</span>, <span class="refTitle">"PATCH and FETCH Methods for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8132</span>, <span class="seriesInfo">DOI 10.17487/RFC8132</span>, <time datetime="2017-04" class="refDate">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8132">https://www.rfc-editor.org/info/rfc8132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8742">https://www.rfc-editor.org/info/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Californium">[Californium]</dt>
        <dd>
<span class="refAuthor">Eclipse Foundation</span>, <span class="refTitle">"Eclipse Californium"</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://github.com/eclipse/californium/tree/2.0.x/californium-core/src/main/java/org/eclipse/californium/core">https://github.com/eclipse/californium/tree/2.0.x/californium-core/src/main/java/org/eclipse/californium/core</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Go-OCF">[Go-OCF]</dt>
        <dd>
<span class="refAuthor">Open Connectivity Foundation (OCF)</span>, <span class="refTitle">"Implementation of CoAP Server &amp; Client in Go"</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://github.com/go-ocf/go-coap">https://github.com/go-ocf/go-coap</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-key-groupcomm-oscore">[I-D.ietf-ace-key-groupcomm-oscore]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Park, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Key Management for OSCORE Groups in ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-oscore-11</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-11.txt">https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-11.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-43</span>, <time datetime="2021-07-10" class="refDate">10 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-43.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-43.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-gm-admin">[I-D.ietf-ace-oscore-gm-admin]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Hoeglund, R.</span>, <span class="refAuthor">Stok, P. V. D.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Admin Interface for the OSCORE Group Manager"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-gm-admin-03</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oscore-gm-admin-03.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oscore-gm-admin-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
        <dd>
<span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Keranen, A.</span>, and <span class="refAuthor">J. Jimenez</span>, <span class="refTitle">"Publish-Subscribe Broker for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-09</span>, <time datetime="2019-09-30" class="refDate">30 September 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt">https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-new-block">[I-D.ietf-core-new-block]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span> and <span class="refAuthor">J. Shallow</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Block-Wise Transfer Options for Faster Transmission"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-new-block-14</span>, <time datetime="2021-05-26" class="refDate">26 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-new-block-14.txt">https://www.ietf.org/archive/id/draft-ietf-core-new-block-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-observe-multicast-notifications">[I-D.ietf-core-observe-multicast-notifications]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Hoeglund, R.</span>, <span class="refAuthor">Amsuess, C.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Observe Notifications as CoAP Multicast Responses"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-observe-multicast-notifications-01</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-observe-multicast-notifications-01.txt">https://www.ietf.org/archive/id/draft-ietf-core-observe-multicast-notifications-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-resource-directory">[I-D.ietf-core-resource-directory]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-resource-directory-28</span>, <time datetime="2021-03-07" class="refDate">7 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt">https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mattsson-core-coap-attacks">[I-D.mattsson-core-coap-attacks]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Fornehed, J.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">C. Amsüss</span>, <span class="refTitle">"Summarizing Known Attacks on CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mattsson-core-coap-attacks-00</span>, <time datetime="2021-05-16" class="refDate">16 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-mattsson-core-coap-attacks-00.txt">https://www.ietf.org/archive/id/draft-mattsson-core-coap-attacks-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-groupcomm-proxy">[I-D.tiloca-core-groupcomm-proxy]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">E. Dijk</span>, <span class="refTitle">"Proxy Operations for CoAP Group Communication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-groupcomm-proxy-04</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-tiloca-core-groupcomm-proxy-04.txt">https://www.ietf.org/archive/id/draft-tiloca-core-groupcomm-proxy-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsuess, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-09</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-09.txt">https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6092">[RFC6092]</dt>
        <dd>
<span class="refAuthor">Woodyatt, J., Ed.</span>, <span class="refTitle">"Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service"</span>, <span class="seriesInfo">RFC 6092</span>, <span class="seriesInfo">DOI 10.17487/RFC6092</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6092">https://www.rfc-editor.org/info/rfc6092</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6550">[RFC6550]</dt>
        <dd>
<span class="refAuthor">Winter, T., Ed.</span>, <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Brandt, A.</span>, <span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Kelsey, R.</span>, <span class="refAuthor">Levis, P.</span>, <span class="refAuthor">Pister, K.</span>, <span class="refAuthor">Struik, R.</span>, <span class="refAuthor">Vasseur, JP.</span>, and <span class="refAuthor">R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6636">[RFC6636]</dt>
        <dd>
<span class="refAuthor">Asaeda, H.</span>, <span class="refAuthor">Liu, H.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Tuning the Behavior of the Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) for Routers in Mobile and Wireless Networks"</span>, <span class="seriesInfo">RFC 6636</span>, <span class="seriesInfo">DOI 10.17487/RFC6636</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6636">https://www.rfc-editor.org/info/rfc6636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7346">[RFC7346]</dt>
        <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"IPv6 Multicast Address Scopes"</span>, <span class="seriesInfo">RFC 7346</span>, <span class="seriesInfo">DOI 10.17487/RFC7346</span>, <time datetime="2014-08" class="refDate">August 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7346">https://www.rfc-editor.org/info/rfc7346</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7390">[RFC7390]</dt>
        <dd>
<span class="refAuthor">Rahman, A., Ed.</span> and <span class="refAuthor">E. Dijk, Ed.</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7390</span>, <span class="seriesInfo">DOI 10.17487/RFC7390</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7390">https://www.rfc-editor.org/info/rfc7390</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7731">[RFC7731]</dt>
        <dd>
<span class="refAuthor">Hui, J.</span> and <span class="refAuthor">R. Kelsey</span>, <span class="refTitle">"Multicast Protocol for Low-Power and Lossy Networks (MPL)"</span>, <span class="seriesInfo">RFC 7731</span>, <span class="seriesInfo">DOI 10.17487/RFC7731</span>, <time datetime="2016-02" class="refDate">February 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7731">https://www.rfc-editor.org/info/rfc7731</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7967">[RFC7967]</dt>
        <dd>
<span class="refAuthor">Bhattacharyya, A.</span>, <span class="refAuthor">Bandyopadhyay, S.</span>, <span class="refAuthor">Pal, A.</span>, and <span class="refAuthor">T. Bose</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Option for No Server Response"</span>, <span class="seriesInfo">RFC 7967</span>, <span class="seriesInfo">DOI 10.17487/RFC7967</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7967">https://www.rfc-editor.org/info/rfc7967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8323">[RFC8323]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Lemay, S.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Hartke, K.</span>, <span class="refAuthor">Silverajan, B.</span>, and <span class="refAuthor">B. Raymor, Ed.</span>, <span class="refTitle">"CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets"</span>, <span class="seriesInfo">RFC 8323</span>, <span class="seriesInfo">DOI 10.17487/RFC8323</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8323">https://www.rfc-editor.org/info/rfc8323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8710">[RFC8710]</dt>
      <dd>
<span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Multipart Content-Format for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8710</span>, <span class="seriesInfo">DOI 10.17487/RFC8710</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8710">https://www.rfc-editor.org/info/rfc8710</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="appendix-usecases">
<section id="appendix-A">
      <h2 id="name-use-cases">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="appendix-A-1">To illustrate where and how CoAP-based group communication can be used, this section summarizes the most common use cases. These use cases include both secured and non-secured CoAP usage. Each subsection below covers one particular category of use cases for CoRE. Within each category, a use case may cover multiple application areas such as home IoT, commercial building IoT (sensing and control), industrial IoT/control, or environmental sensing.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="discovery">
<section id="appendix-A.1">
        <h3 id="name-discovery">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-discovery" class="section-name selfRef">Discovery</a>
        </h3>
<p id="appendix-A.1-1">Discovery of physical devices in a network, or discovery of information entities hosted on network devices, are operations that are usually required in a system during the phases of setup or (re)configuration. When a discovery use case involves devices that need to interact without having been configured previously with a common security context, unsecured CoAP communication is typically used. Discovery may involve a request to a directory server, which provides services to aid clients in the discovery process. One particular type of directory server is the CoRE Resource Directory <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>; and there may be other types of directories that can be used with CoAP.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div id="sec-uc-dd">
<section id="appendix-A.1.1">
          <h4 id="name-distributed-device-discover">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-distributed-device-discover" class="section-name selfRef">Distributed Device Discovery</a>
          </h4>
<p id="appendix-A.1.1-1">Device discovery is the discovery and identification of networked devices -- optionally only devices of a particular class, type, model, or brand. Group communication is used for distributed device discovery, if a central directory server is not used. Typically in distributed device discovery, a multicast request is sent to a particular address (or address range) and multicast scope of interest, and any devices configured to be discoverable will respond back. For the alternative solution of centralized device discovery a central directory server is accessed through unicast, in which case group communication is not needed. This requires that the address of the central directory is either preconfigured in each device or configured during operation using a protocol.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-2">In CoAP, device discovery can be implemented by CoAP resource discovery requesting (GET) a particular resource that the sought device class, type, model or brand is known to respond to. It can also be implemented using CoAP resource discovery (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-7" class="relref">Section 7</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>) and the CoAP query interface defined in <span><a href="https://rfc-editor.org/rfc/rfc6690#section-4" class="relref">Section 4</a> of [<a href="#RFC6690" class="xref">RFC6690</a>]</span> to find these particular resources. Also, a multicast GET request to /.well-known/core can be used to discover all CoAP devices.<a href="#appendix-A.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-uc-sd">
<section id="appendix-A.1.2">
          <h4 id="name-distributed-service-discove">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-distributed-service-discove" class="section-name selfRef">Distributed Service Discovery</a>
          </h4>
<p id="appendix-A.1.2-1">Service discovery is the discovery and identification of particular services hosted on network devices. Services can be identified by one or more parameters such as ID, name, protocol, version and/or type. Distributed service discovery involves group communication to reach individual devices hosting a particular service; with a central directory server not being used.<a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-2">In CoAP, services are represented as resources and service discovery is implemented using resource discovery (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-7" class="relref">Section 7</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>) and the CoAP query interface defined in <span><a href="https://rfc-editor.org/rfc/rfc6690#section-4" class="relref">Section 4</a> of [<a href="#RFC6690" class="xref">RFC6690</a>]</span>.<a href="#appendix-A.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-uc-dirdiscovery">
<section id="appendix-A.1.3">
          <h4 id="name-directory-discovery">
<a href="#appendix-A.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-directory-discovery" class="section-name selfRef">Directory Discovery</a>
          </h4>
<p id="appendix-A.1.3-1">This use case is a specific sub-case of Distributed Service Discovery (<a href="#sec-uc-sd" class="xref">Appendix A.1.2</a>), in which a device needs to identify the location of a Directory on the network to which it
can e.g., register its own offered services, or to which it can perform queries to identify and locate other devices/services it needs to access on
the network. <span><a href="https://rfc-editor.org/rfc/rfc7390#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC7390" class="xref">RFC7390</a>]</span> showed an example of discovering a CoRE Resource Directory using CoAP group communication. As defined in <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>, a resource directory is a web entity that stores information about web resources and implements REST interfaces for registration and lookup of those resources. For example, a device can register itself to a resource directory to let it be found by other devices and/or applications.<a href="#appendix-A.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-phase">
<section id="appendix-A.2">
        <h3 id="name-operational-phase">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-operational-phase" class="section-name selfRef">Operational Phase</a>
        </h3>
<p id="appendix-A.2-1">Operational phase use cases describe those operations that occur most frequently in a networked system, during its operational lifetime and regular operation. Regular usage is when the applications on networked devices perform the tasks they were designed for and exchange of application-related data using group communication occurs. Processes like system reconfiguration, group changes, system/device setup, extra group security changes, etc. are not part of regular operation.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div id="actuator-group-control">
<section id="appendix-A.2.1">
          <h4 id="name-actuator-group-control">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-actuator-group-control" class="section-name selfRef">Actuator Group Control</a>
          </h4>
<p id="appendix-A.2.1-1">Group communication can be beneficial to control actuators that need to act in synchrony, as a group, with strict timing (latency) requirements. Examples are office lighting, stage lighting, street lighting, or audio alert/Public Address systems. Sections <a href="https://rfc-editor.org/rfc/rfc7390#section-3.4" class="relref">3.4</a> and <a href="https://rfc-editor.org/rfc/rfc7390#section-3.5" class="relref">3.5</a> of <span>[<a href="#RFC7390" class="xref">RFC7390</a>]</span> showed examples of lighting control of a group of 6LoWPAN-connected lights.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="device-group-status-request">
<section id="appendix-A.2.2">
          <h4 id="name-device-group-status-request">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-device-group-status-request" class="section-name selfRef">Device Group Status Request</a>
          </h4>
<p id="appendix-A.2.2-1">To properly monitor the status of systems, there may be a need for ad-hoc, unplanned status updates. Group communication can be used to quickly send out a request to a (potentially large) number of devices for specific information. Each device then responds back with the requested data. Those devices that did not respond to the request can optionally be polled again via reliable unicast communication to complete the dataset. The device group may be defined e.g., as "all temperature sensors on floor 3", or "all lights in wing B". For example, it could be a status request for device temperature, most recent sensor event detected, firmware version, network load, and/or battery level.<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="network-wide-query">
<section id="appendix-A.2.3">
          <h4 id="name-network-wide-query">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-network-wide-query" class="section-name selfRef">Network-wide Query</a>
          </h4>
<p id="appendix-A.2.3-1">In some cases a whole network or subnet of multiple IP devices needs to be queried for status or other information. This is similar to the previous use case except that the device group is not defined in terms of its function/type but in terms of its network location. Technically this is also similar to distributed service discovery (<a href="#sec-uc-sd" class="xref">Appendix A.1.2</a>) where a query is processed by all devices on a network - except that the query is not about services offered by the device, but rather specific operational data is requested.<a href="#appendix-A.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="network-wide-group-notification">
<section id="appendix-A.2.4">
          <h4 id="name-network-wide-group-notifica">
<a href="#appendix-A.2.4" class="section-number selfRef">A.2.4. </a><a href="#name-network-wide-group-notifica" class="section-name selfRef">Network-wide / Group Notification</a>
          </h4>
<p id="appendix-A.2.4-1">In some cases a whole network, or subnet of multiple IP devices, or a specific target group needs to be notified of a status change or other information. This is similar to the previous two use cases except that the recipients are not expected to respond with some information. Unreliable notification can be acceptable in some use cases, in which a recipient does not respond with a confirmation of having received the notification. In such a case, the receiving CoAP server does not have to create a CoAP response. If the sender needs confirmation of reception, the CoAP servers can be configured for that resource to respond with a 2.xx success status after processing a notification request successfully.<a href="#appendix-A.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="software-update">
<section id="appendix-A.3">
        <h3 id="name-software-update">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-software-update" class="section-name selfRef">Software Update</a>
        </h3>
<p id="appendix-A.3-1">Group communication can be useful to efficiently distribute new software (firmware, image, application, etc.) to a group of multiple devices. In this case, the group is defined in terms of device type: all devices in the target group are known to be capable of installing and running the new software. The software is distributed as a series of smaller blocks that are collected by all devices and stored in memory. All devices in the target group are usually responsible for integrity verification of the received software; which can be done per-block or for the entire software image once all blocks have been received. Due to the inherent unreliability of CoAP multicast, there needs to be a backup mechanism (e.g., implemented using CoAP unicast) by which a device can individually request missing blocks of a whole software image/entity. Prior to a multicast software update, the group of recipients can be separately notified that there is new software available and coming, using the above network-wide or group notification.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="multi-etag-option">
<section id="appendix-B">
      <h2 id="name-multi-etag-option">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-multi-etag-option" class="section-name selfRef">Multi-ETag Option</a>
      </h2>
<p id="appendix-B-1"><span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2.1" class="relref">Section 8.2.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> explicitly forbids using an ETag Option in requests sent over multicast, and leaves a mechanism to suppress responses for that case for further study.
This appendix provides such a model to "validate" or "revalidate" responses that the client already has cached. In particular, the group request can indicate entity-tag values separately for each CoAP server from which the client wishes to get a response revalidation, together with addressing information identifying that server. It uses a new CoAP option, the Multi-ETag Option. Operations related to this validation model and using the new option are defined in <a href="#sec-caching-validation-client" class="xref">Appendix B.3</a> for the client side, and in <a href="#sec-caching-validation-server" class="xref">Appendix B.4</a> for the server side.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="option-definition">
<section id="appendix-B.1">
        <h3 id="name-option-definition">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-option-definition" class="section-name selfRef">Option Definition</a>
        </h3>
<p id="appendix-B.1-1">The Multi-ETag Option has the properties summarized in <a href="#fig-response-multi-etag-option" class="xref">Figure 3</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. The Multi-ETag Option is elective, safe to forward, part of the cache key, and repeatable.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">The option is intended only for group requests, as directly sent to a CoAP group or to a CoAP proxy that forwards it to the CoAP group (see <a href="#sec-proxy" class="xref">Section 3.5</a>).<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<span id="name-the-multi-etag-option"></span><div id="fig-response-multi-etag-option">
<figure id="figure-3">
          <div class="artwork art-text alignCenter" id="appendix-B.1-3.1">
<pre>
+------+---+---+---+---+------------+--------+--------+---------+
| No.  | C | U | N | R | Name       | Format | Length | Default |
+------+---+---+---+---+------------+--------+--------+---------+
|      |   |   |   |   |            |        |        |         |
| TBD1 |   |   |   | x | Multi-ETag |  (*)   |  any   | (none)  |
|      |   |   |   |   |            |        |        |         |
+------+---+---+---+---+------------+--------+--------+---------+
           C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable

(*) See below.
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-the-multi-etag-option" class="selfRef">The Multi-ETag Option.</a>
          </figcaption></figure>
</div>
<p id="appendix-B.1-4">The Multi-ETag Option has the same properties of the ETag Option defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.10.6" class="relref">Section 5.10.6</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, but it differs in the format and length, as well as having a different reason for its repeatability.<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<p id="appendix-B.1-5">Each occurrence of the Multi-ETag Option targets exactly one of the servers in the CoAP group, from which the client wishes to get a response revalidation. The option value is set to a CBOR sequence <span>[<a href="#RFC8742" class="xref">RFC8742</a>]</span> composed of (1+M) elements, where:<a href="#appendix-B.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-6.1">
            <p id="appendix-B.1-6.1.1">The first element specifies the addressing information of the corresponding server, encoded as defined in <a href="#sec-caching-validation-tpinfo" class="xref">Appendix B.2</a>.<a href="#appendix-B.1-6.1.1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-6.1.2">
This mirrors the format of the Response-Forwarding option defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-tiloca-core-groupcomm-proxy-04#section-3" class="relref">Section 3</a> of [<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span>. Thus, in the presence of a forward proxy supporting the mechanism defined in <span>[<a href="#I-D.tiloca-core-groupcomm-proxy" class="xref">I-D.tiloca-core-groupcomm-proxy</a>]</span>, the client can seamlessly use the server addressing information obtained from the proxy, when this forwards back a response to a group request from that server.<a href="#appendix-B.1-6.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-6.2">
            <p id="appendix-B.1-6.2.1">The following M elements are CBOR byte strings, each of which has as value an entity-tag value that the client wants to try against the corresponding server.<a href="#appendix-B.1-6.2.1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-6.2.2">
The entity-tag values included in the Multi-ETag Option are subject to the same considerations for the entity-tag values used in an ETag Option (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.10.6" class="relref">Section 5.10.6</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#appendix-B.1-6.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.1-7">The Multi-ETag Option is of class E in terms of OSCORE processing (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>).<a href="#appendix-B.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-caching-validation-tpinfo">
<section id="appendix-B.2">
        <h3 id="name-encoding-of-server-addressi">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-encoding-of-server-addressi" class="section-name selfRef">Encoding of Server Addressing Information</a>
        </h3>
<p id="appendix-B.2-1">The first element of the CBOR sequence in the Multi-ETag Option value is set to the byte serialization of the CBOR array 'tp_info' defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-observe-multicast-notifications-01#section-2.2.1" class="relref">Section 2.2.1</a> of [<a href="#I-D.ietf-core-observe-multicast-notifications" class="xref">I-D.ietf-core-observe-multicast-notifications</a>]</span>, including only the set of elements 'srv_addr'.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">In turn, the set includes the integer 'tp_id' identifying the used transport protocol, and further elements whose number, format and encoding depend on the value of 'tp_id'.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">When the Multi-ETag Option is used in group requests transported over UDP as in this specification, the 'tp_info' array includes the following elements, encoded as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-observe-multicast-notifications-01#section-2.2.1.1" class="relref">Section 2.2.1.1</a> of [<a href="#I-D.ietf-core-observe-multicast-notifications" class="xref">I-D.ietf-core-observe-multicast-notifications</a>]</span>.<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-4.1">'tp_id': the CBOR integer with value 1 ("UDP"), from the "Value" column of the "CoAP Transport Information Registry" Registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-observe-multicast-notifications-01#section-14.4" class="relref">Section 14.4</a> of [<a href="#I-D.ietf-core-observe-multicast-notifications" class="xref">I-D.ietf-core-observe-multicast-notifications</a>]</span><a href="#appendix-B.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-4.2">'srv_host': a CBOR byte string, with value the unicast IP address of the server. This element is tagged and identified by the CBOR tag 260 "Network Address (IPv4 or IPv6 or MAC Address)".<a href="#appendix-B.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-4.3">'srv_port': as a CBOR unsigned integer or the CBOR simple value Null. If it is a CBOR integer, it has as value the destination port number where to send individual requests intended to the server. This element MAY be present. If not included, the default port number 5683 is assumed.<a href="#appendix-B.2-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-B.2-5">The CDDL notation <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> provided below describes the 'tp_info' CBOR array using the format above.<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-B.2-6">
<pre>
tp_info = [
       tp_id : 1,             ; UDP as transport protocol
    srv_host : #6.260(bstr),  ; IP address where to reach the server
    srv_port : uint / null    ; Port number where to reach the server
]
</pre><a href="#appendix-B.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-caching-validation-client">
<section id="appendix-B.3">
        <h3 id="name-processing-on-the-client-si">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-processing-on-the-client-si" class="section-name selfRef">Processing on the Client Side</a>
        </h3>
<p id="appendix-B.3-1">Similar to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.6.2" class="relref">Section 5.6.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, the client may have one or more stored responses for a GET or FETCH group request sent to the CoAP group, but cannot use any of them (e.g., because they are not fresh).<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">In that case, the client can send a GET or FETCH group request, in order to give the origin servers an opportunity both to select a stored response to be used, and to update its freshness. As in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, this process is known as "validating" or "revalidating" the stored response.<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3-3">When sending such a group request, the endpoint SHOULD include one Multi-ETag Option for each server it wishes to revalidate the corresponding response with. As defined in <a href="#sec-caching-validation" class="xref">Section 3.2.2</a>, the Multi-ETag Option can include multiple entity-tag values, each applicable to a stored response from the corresponding server for that group request.<a href="#appendix-B.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.3-4">Specifically, in the same GET or FETCH group request:<a href="#appendix-B.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.3-5.1">The client MUST NOT include one or more ETag Option(s) together with one or more Multi-ETag Option(s).<a href="#appendix-B.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.3-5.2">The client MUST include only one Multi-ETag Option for each server it wishes to get a response revalidation from.<a href="#appendix-B.3-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.3-5.3">
            <p id="appendix-B.3-5.3.1">The client SHOULD limit the number of Multi-ETag Options, hence limiting the number of servers as intended target of the revalidation process, and SHOULD rather spread revalidation with different sets of servers over different group requests. Also, the client SHOULD limit the number of entity-tag values specified in each Multi-ETag Option, preferably indicating only one entity-tag value.<a href="#appendix-B.3-5.3.1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-5.3.2">
This allows for limiting the overall size of the group request. As a guideline, the server addressing information can be 9-24 bytes in size, while each entity-tag value can be 1-8 bytes in size. Thus, a single Multi-ETag Option can be up to (24 + 8 * M) bytes in size, where M is the number of entity-tag values it includes.<a href="#appendix-B.3-5.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.3-6">A 2.03 (Valid) response indicates that the stored response identified by the entity-tag given in the response's ETag Option can be reused, after updating the stored response as described in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.9.1.3" class="relref">Section 5.9.1.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>. So the client can determine if any one of the stored representations from that server is current, without need to transfer the current resource representation again.<a href="#appendix-B.3-6" class="pilcrow">¶</a></p>
<p id="appendix-B.3-7">Any other Response Code indicates that none of the stored responses from that server, identified in the Multi-ETag Option of the group request, are suitable.  Instead, such response SHOULD be used to satisfy the request and MAY replace the stored response.<a href="#appendix-B.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-caching-validation-server">
<section id="appendix-B.4">
        <h3 id="name-processing-on-the-server-si">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-processing-on-the-server-si" class="section-name selfRef">Processing on the Server Side</a>
        </h3>
<p id="appendix-B.4-1">If a GET or FETCH request includes both one or more ETag Options together with one or more Multi-ETag Options, then the server MUST ignore all the included ETag and Multi-ETag Options.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.4-2">The server MUST ignore any Multi-ETag Option which is malformed, or included in a request that is neither GET nor FETCH, or which specifies addressing information not matching with its own endpoint address.<a href="#appendix-B.4-2" class="pilcrow">¶</a></p>
<p id="appendix-B.4-3">The server considers only its pertaining Multi-ETag Option, i.e., specifying addressing information associated to its own endpoint. The server MUST ignore any pertaining Multi-ETag Option that occurs more than once.<a href="#appendix-B.4-3" class="pilcrow">¶</a></p>
<p id="appendix-B.4-4">If the pertaining Multi-ETag Option specifies the CBOR simple value Null for the 'srv_port' element of 'tp_info' (see <a href="#sec-caching-validation-tpinfo" class="xref">Appendix B.2</a>), the server MUST assume the default port number 5683.<a href="#appendix-B.4-4" class="pilcrow">¶</a></p>
<p id="appendix-B.4-5">Then, the server can issue a 2.03 (Valid) response in place of a 2.05 (Content) response, if one of the entity-tag values from the pertaining Multi-ETag Option is the entity-tag for the current resource representation, i.e., it is valid. The 2.03 (Valid) response echoes this specific entity-tag within an ETag Option included in the response.<a href="#appendix-B.4-5" class="pilcrow">¶</a></p>
<p id="appendix-B.4-6">The inclusion of an ETag Option in a response works as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.6.10.1" class="relref">Section 5.6.10.1</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>.<a href="#appendix-B.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-coap-options-multi-etag">
<section id="appendix-B.5">
        <h3 id="name-coap-option-numbers-registr">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="appendix-B.5-1">IANA is asked to enter the following option numbers to the "CoAP Option Numbers" registry defined in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> within the "CoRE Parameters" registry.<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="appendix-B.5-2">
<pre>
+--------+-------------+-----------------+
| Number |    Name     |    Reference    |
+--------+-------------+-----------------+
|  TBD1  |  Multi-ETag | [This document] |
+--------+-------------+-----------------+
</pre><a href="#appendix-B.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-C">
      <h2 id="name-document-updates">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-C-1">RFC EDITOR: PLEASE REMOVE THIS SECTION.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="sec-03-04">
<section id="appendix-C.1">
        <h3 id="name-version-03-to-04">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">Multi-ETag Option for response revalidation moved to appendix.<a href="#appendix-C.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.2">ETag Option usage added.<a href="#appendix-C.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.3">Q-Block Options added in the block-wise transfer section.<a href="#appendix-C.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.4">Caching at proxies moved to draft-tiloca-core-groupcomm-proxy.<a href="#appendix-C.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.5">Client-Proxy response revalidation with the Group-ETag Option moved to draft-tiloca-core-groupcomm-proxy.<a href="#appendix-C.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.6">Security considerations on amplification attacks.<a href="#appendix-C.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.7">Generalized transport protocols to include others than UDP/IP multicast; and security protocols other than Group OSCORE.<a href="#appendix-C.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.8">Overview of security cases with proxies.<a href="#appendix-C.1-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.9">Editorial improvements.<a href="#appendix-C.1-1.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-C.2">
        <h3 id="name-version-02-to-03">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">Multiple responses from same server handled at the application.<a href="#appendix-C.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.2">Clarifications about issues with forward-proxies.<a href="#appendix-C.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.3">Operations for reverse-proxies.<a href="#appendix-C.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.4">Caching of responses at proxies.<a href="#appendix-C.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.5">Client-Server response revalidation, with Multi-ETag Option.<a href="#appendix-C.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.6">Client-Proxy response revalidation, with the Group-ETag Option.<a href="#appendix-C.2-1.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-C.3">
        <h3 id="name-version-01-to-02">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">Clarified relation between security groups and application groups.<a href="#appendix-C.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.2">Considered also FETCH for requests over IP multicast.<a href="#appendix-C.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.3">More details on Observe re-registration.<a href="#appendix-C.3-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.4">More details on Proxy intermediaries.<a href="#appendix-C.3-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.5">More details on servers changing port number in the response.<a href="#appendix-C.3-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.6">Usage of the Uri-Host Option to indicate an application group.<a href="#appendix-C.3-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.7">Response suppression based on classes of error codes.<a href="#appendix-C.3-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-C.4">
        <h3 id="name-version-00-to-01">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.4-1.1">Clarifications on group memberships for the different group types.<a href="#appendix-C.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.2">Simplified description of Token reusage, compared to the unicast case.<a href="#appendix-C.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.3">More details on the rationale for response suppression.<a href="#appendix-C.4-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.4">Clarifications of creation and management of security groups.<a href="#appendix-C.4-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.5">Clients more knowledgeable than proxies about stopping receiving responses.<a href="#appendix-C.4-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.6">Cancellation of group observations.<a href="#appendix-C.4-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.7">Clarification on multicast scope to use.<a href="#appendix-C.4-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.8">Both the group mode and pairwise mode of Group OSCORE are considered.<a href="#appendix-C.4-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.9">Updated security considerations.<a href="#appendix-C.4-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.10">Editorial improvements.<a href="#appendix-C.4-1.10" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">The authors sincerely thank Christian Amsuess, Carsten Bormann, Thomas Fossati, Rikard Hoeglund, John Mattsson and Jim Schaad for their comments and feedback.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Esko Dijk</span></div>
<div dir="auto" class="left"><span class="org">IoTconsultancy.nl</span></div>
<div dir="auto" class="left"><span class="street-address">\________________\</span></div>
<div dir="auto" class="left"><span class="locality">Utrecht</span></div>
<div dir="auto" class="left"><span class="country-name">Netherlands</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:esko.dijk@iotconsultancy.nl" class="email">esko.dijk@iotconsultancy.nl</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chonggang Wang</span></div>
<div dir="auto" class="left"><span class="org">InterDigital</span></div>
<div dir="auto" class="left"><span class="street-address">1001 E Hector St, Suite 300</span></div>
<div dir="auto" class="left">
<span class="locality">Conshohocken</span>,  <span class="postal-code">PA 19428</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Chonggang.Wang@InterDigital.com" class="email">Chonggang.Wang@InterDigital.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
