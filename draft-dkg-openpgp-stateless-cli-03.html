<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Stateless OpenPGP Command Line Interface</title>
<meta content="Daniel Kahn Gillmor" name="author">
<meta content="
       This document defines a generic stateless command-line interface for dealing with OpenPGP messages, known as  sop .
It aims for a minimal, well-structured API covering OpenPGP object security. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-dkg-openpgp-stateless-cli-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-openpgp-stateless-cli-trtrvc0p.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Stateless OpenPGP Command Line Interface</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Gillmor</td>
<td class="center">Expires 28 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">openpgp</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dkg-openpgp-stateless-cli-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-25" class="published">25 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-28">28 April 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D.K. Gillmor</div>
<div class="org">ACLU</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Stateless OpenPGP Command Line Interface</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a generic stateless command-line interface for dealing with OpenPGP messages, known as <code>sop</code>.
It aims for a minimal, well-structured API covering OpenPGP object security.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-using-sop-in-a-test-suite" class="xref">Using sop in a Test Suite</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-examples" class="xref">Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-subcommands" class="xref">Subcommands</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-version-version-information" class="xref">version: Version Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-generate-key-generate-a-sec" class="xref">generate-key: Generate a Secret Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-extract-cert-extract-a-cert" class="xref">extract-cert: Extract a Certificate from a Secret Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-sign-create-detached-signat" class="xref">sign: Create Detached Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-verify-verify-detached-sign" class="xref">verify: Verify Detached Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-encrypt-encrypt-a-message" class="xref">encrypt: Encrypt a Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-decrypt-decrypt-a-message" class="xref">decrypt: Decrypt a Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-armor-convert-binary-to-asc" class="xref">armor: Convert binary to ASCII</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-dearmor-convert-ascii-to-bi" class="xref">dearmor: Convert ASCII to binary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="xref">3.10</a>. <a href="#name-detach-inband-signature-and" class="xref">detach-inband-signature-and-message: split a clearsigned message</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-input-string-types" class="xref">Input String Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-date" class="xref">DATE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-userid" class="xref">USERID</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-input-output-indirect-types" class="xref">Input/Output Indirect Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-special-designators-for-ind" class="xref">Special Designators for Indirect Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-certs" class="xref">CERTS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-keys" class="xref">KEYS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-ciphertext" class="xref">CIPHERTEXT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-signatures" class="xref">SIGNATURES</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-sessionkey" class="xref">SESSIONKEY</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-micalg" class="xref">MICALG</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-password" class="xref">PASSWORD</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-verifications" class="xref">VERIFICATIONS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="xref">5.10</a>. <a href="#name-data" class="xref">DATA</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-failure-modes" class="xref">Failure Modes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-alternate-interfaces" class="xref">Alternate Interfaces</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-guidance-for-implementers" class="xref">Guidance for Implementers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-one-openpgp-message-at-a-ti" class="xref">One OpenPGP Message at a Time</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-simplified-subset-of-openpg" class="xref">Simplified Subset of OpenPGP Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-validate-signatures-only-fr" class="xref">Validate Signatures Only from Known Signers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-openpgp-inputs-can-be-eithe" class="xref">OpenPGP inputs can be either Binary or ASCII-armored</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-detached-signatures" class="xref">Detached Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-reliance-on-supplied-certs-" class="xref">Reliance on Supplied Certs and Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-text-is-always-utf-8" class="xref">Text is always UTF-8</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-passwords-are-human-readabl" class="xref">Passwords are Human-Readable</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="xref">8.9</a>.  <a href="#name-be-careful-with-special-des" class="xref">Be careful with Special Designators</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-guidance-for-consumers" class="xref">Guidance for Consumers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-choosing-between-astext-and" class="xref">Choosing between -as=text  and -as=binary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-special-designators-and-unu" class="xref">Special Designators and Unusual Filenames</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-signature-verification" class="xref">Signature Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-compression" class="xref">Compression</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-object-security-vs-transpor" class="xref">Object Security vs. Transport Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-document-considerations" class="xref">Document Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-document-history" class="xref">Document History</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-future-work" class="xref">Future Work</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Different OpenPGP implementations have many different requirements, which typically break down in two main categories: key/certificate management and object security.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The purpose of this document is to provide a "stateless" interface that primarily handles the object security side of things, and assumes that secret key management and certificate management will be handled some other way.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Isolating object security from key/certificate management should make it easier to provide interoperability testing for the object security side of OpenPGP implementations, as described in <a href="#test-suite" class="xref">Section 1.3</a>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document defines a generic stateless command-line interface for dealing with OpenPGP messages, known here by the placeholder <code>sop</code>.
It aims for a minimal, well-structured API.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">An OpenPGP implementation should not name its executable <code>sop</code> to implement this specification.  It just needs to provide a program that conforms to this interface.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">A <code>sop</code> implementation should leave no trace on the system, and its behavior should not be affected by anything other than command-line arguments and input.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Obviously, the user will need to manage their secret keys (and their peers' certificates) somehow,
but the goal of this interface is to separate out that task from the task of interacting with OpenPGP messages.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">While this document identifies a command-line interface,
the rough outlines of this interface should also be amenable to relatively straightforward library implementations in different languages.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">This document uses the term "key" to refer exclusively to OpenPGP Transferable Secret Keys (see section 11.2 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>).<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">It uses the term "certificate" to refer to OpenPGP Transferable Public Key (see section 11.1 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>).<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">"Stateless" in "Stateless OpenPGP" means avoiding secret key and certificate state.
The user is responsible for managing all OpenPGP certificates and secret keys themselves,
and passing them to <code>sop</code> as needed.
The user should also not be concerned that any state could affect the underlying operations.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">OpenPGP revocations can have "Reason for Revocation" (section 5.2.3.23 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>), which can be either "soft" or "hard".
The set of "soft" reasons is: "Key is superseded" and "Key is retired and no longer used".
All other reasons (and revocations that do not state a reason) are "hard" revocations.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="test-suite">
<section id="section-1.3">
        <h3 id="name-using-sop-in-a-test-suite">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-using-sop-in-a-test-suite" class="section-name selfRef">Using sop in a Test Suite</a>
        </h3>
<p id="section-1.3-1">If an OpenPGP implementation provides a <code>sop</code> interface, it can be used to test interoperability (e.g., <span>[<a href="#OpenPGP-Interoperability-Test-Suite" class="xref">OpenPGP-Interoperability-Test-Suite</a>]</span>).<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Such an interop test suite can, for example, use custom code (<em>not</em> <code>sop</code>) to generate a new OpenPGP object that incorporates new primitives, and feed that object to a stable of <code>sop</code> implementations, to determine whether those implementations can consume the new form.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">Or, the test suite can drive each <code>sop</code> implementation with a simple input, and observe which cryptographic primitives each implementation chooses to use as it produces output.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-2">
      <h2 id="name-examples">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-2-1">These examples show no error checking, but give a flavor of how <code>sop</code> might be used in practice from a shell.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The key and certificate files described in them (e.g. <code>alice.sec</code>) could be for example those found in <span>[<a href="#I-D.draft-bre-openpgp-samples-01" class="xref">I-D.draft-bre-openpgp-samples-01</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-3">
<pre>
sop generate-key "Alice Lovelace &lt;alice@openpgp.example&gt;" &gt; alice.sec
sop extract-cert &lt; alice.sec &gt; alice.pgp

sop generate-key "Bob Babbage &lt;bob@openpgp.example&gt;" &gt; bob.sec
sop extract-cert &lt; bob.sec &gt; bob.pgp

sop sign --as=text alice.sec &lt; statement.txt &gt; statement.txt.asc
sop verify statement.txt.asc alice.pgp &lt; statement.txt

sop encrypt --sign-with=alice.sec --as=mime bob.pgp &lt; msg.eml &gt; ciphertext.asc
sop decrypt bob.sec &lt; ciphertext.asc &gt; cleartext.eml
</pre><a href="#section-2-3" class="pilcrow">¶</a>
</div>
<p id="section-2-4">See <a href="#failure-modes" class="xref">Section 6</a> for more information about errors and error handling.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subcommands">
<section id="section-3">
      <h2 id="name-subcommands">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-subcommands" class="section-name selfRef">Subcommands</a>
      </h2>
<p id="section-3-1"><code>sop</code> uses a subcommand interface, similar to those popularized by systems like <code>git</code> and <code>svn</code>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">If the user supplies a subcommand that <code>sop</code> does not implement, it fails with <code>UNSUPPORTED_SUBCOMMAND</code>.
If a <code>sop</code> implementation does not handle a supplied option for a given subcommand, it fails with <code>UNSUPPORTED_OPTION</code>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">All subcommands that produce OpenPGP material on standard output produce ASCII-armored (section 6 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>) objects by default (except for <code>sop dearmor</code>).
These subcommands have a <code>--no-armor</code> option, which causes them to produce binary OpenPGP material instead.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">All subcommands that accept OpenPGP material on input should be able to accept either ASCII-armored or binary inputs (see <a href="#optional-input-armoring" class="xref">Section 8.4</a>) and behave accordingly.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">See <a href="#indirect-types" class="xref">Section 5</a> for details about how various forms of OpenPGP material are expected to be structured.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="version">
<section id="section-3.1">
        <h3 id="name-version-version-information">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-version-version-information" class="section-name selfRef">version: Version Information</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.1-1">
<pre>
sop version [--backend|--extended]
</pre><a href="#section-3.1-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">Standard Input: ignored<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">Standard Output: version information<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">This subcommand emits version information as UTF-8-encoded text.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">With no arguments, the version string emitted should contain the name of the <code>sop</code> implementation, followed by a single space, followed by the version number.
A <code>sop</code> implementation should use a version number that respects an established standard that is easily comparable and parsable, like <span>[<a href="#SEMVER" class="xref">SEMVER</a>]</span>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">If <code>--backend</code> is supplied, the implementation should produce a comparable line of implementation and version information about the primary underlying OpenPGP toolkit.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">If <code>--extended</code> is supplied, the implementation may emit multiple lines of version information.
The first line MUST match the information produced by a simple invocation, but the rest of the text has no defined structure.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7"><code>--backend</code> and <code>--extended</code> are mutually-exclusive options.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">Example:<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-9">
<pre>
$ sop version
ExampleSop 0.2.1
$ sop version --backend
LibExamplePGP 3.4.2
$ sop version --extended
ExampleSop 0.2.1
Running on MonkeyScript 4.5
LibExamplePGP 3.4.2
LibExampleCrypto 3.1.1
LibXCompression 4.0.2
See https://pgp.example/sop/ for more information
$
</pre><a href="#section-3.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="generate-key">
<section id="section-3.2">
        <h3 id="name-generate-key-generate-a-sec">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-generate-key-generate-a-sec" class="section-name selfRef">generate-key: Generate a Secret Key</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.2-1">
<pre>
sop generate-key [--no-armor] [--] [USERID...]
</pre><a href="#section-3.2-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">Standard Input: ignored<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.2">Standard Output: <code>KEYS</code> (<a href="#keys" class="xref">Section 5.3</a>)<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-3">Generate a single default OpenPGP key with zero or more User IDs.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">The generated secret key SHOULD be usable for as much of the <code>sop</code> functionality as possible.
In particular:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">It should be possible to extract an OpenPGP certificate from the key in <code>KEYS</code> with <code>sop extract-cert</code>.<a href="#section-3.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-5.2">The key in <code>KEYS</code> should be able to create signatures (with <code>sop sign</code>) that are verifiable by using <code>sop verify</code> with the extracted certificate.<a href="#section-3.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-5.3">The key in <code>KEYS</code> should be able to decrypt messages (with <code>sop decrypt</code>) that are encrypted by using <code>sop encrypt</code> with the extracted certificate.<a href="#section-3.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-6">The detailed internal structure of the certificate is left to the discretion of the <code>sop</code> implementation.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">Example:<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-8">
<pre>
$ sop generate-key 'Alice Lovelace &lt;alice@openpgp.example&gt;' &gt; alice.sec
$ head -n1 &lt; alice.sec
-----BEGIN PGP PRIVATE KEY BLOCK-----
$
</pre><a href="#section-3.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="extract-cert">
<section id="section-3.3">
        <h3 id="name-extract-cert-extract-a-cert">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-extract-cert-extract-a-cert" class="section-name selfRef">extract-cert: Extract a Certificate from a Secret Key</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.3-1">
<pre>
sop extract-cert [--no-armor]
</pre><a href="#section-3.3-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">Standard Input: <code>KEYS</code> (<a href="#keys" class="xref">Section 5.3</a>)<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-2.2">Standard Output: <code>CERTS</code> (<a href="#certs" class="xref">Section 5.2</a>)<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-3">The output should contain one OpenPGP certificate in <code>CERTS</code> per OpenPGP Transferable Secret Key found in <code>KEYS</code>.
There is no guarantee what order the <code>CERTS</code> will be in.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Example:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-5">
<pre>
$ sop extract-cert &lt; alice.sec &gt; alice.pgp
$ head -n1 &lt; alice.pgp
-----BEGIN PGP PUBLIC KEY BLOCK-----
$
</pre><a href="#section-3.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sign">
<section id="section-3.4">
        <h3 id="name-sign-create-detached-signat">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-sign-create-detached-signat" class="section-name selfRef">sign: Create Detached Signatures</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.4-1">
<pre>
sop sign [--no-armor] [--micalg-out=MICALG]
     [--as={binary|text}] [--] KEYS [KEYS...]
</pre><a href="#section-3.4-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">Standard Input: <code>DATA</code> (<a href="#data" class="xref">Section 5.10</a>)<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.2">Standard Output: <code>SIGNATURES</code> (<a href="#signature" class="xref">Section 5.5</a>)<a href="#section-3.4-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-3">Exactly one signature will be made by each key in the supplied <code>KEYS</code> arguments.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4"><code>--as</code> defaults to <code>binary</code>.  If <code>--as=text</code> and the input <code>DATA</code> is
not valid <code>UTF-8</code> (<a href="#utf8" class="xref">Section 8.7</a>), <code>sop sign</code> fails with <code>EXPECTED_TEXT</code>.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5"><code>--as=binary</code> SHOULD result in an OpenPGP signature of type 0x00 ("Signature of a binary document").
<code>--as=text</code> SHOULD result in an OpenPGP signature of type 0x01 ("Signature of a canonical text document").
See section 5.2.1 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span> for more details.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">When generating PGP/MIME messages (<span>[<a href="#RFC3156" class="xref">RFC3156</a>]</span>), it is useful to know what digest algorithm was used for the generated signature.
When <code>--micalg-out</code> is supplied, <code>sop sign</code> emits the digest algorithm used to the specified <code>MICALG</code> file in a way that can be used to populate the <code>micalg</code> parameter for the Content-Type (see <a href="#micalg" class="xref">Section 5.7</a>).
If the specified <code>MICALG</code> file already exists in the filesystem, <code>sop sign</code> will fail with <code>OUTPUT_EXISTS</code>.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4-7">When signing with multiple keys, <code>sop sign</code> SHOULD use the same digest algorithm for every signature generated in a single run, unless there is some internal constraint on the <code>KEYS</code> objects.
If <code>--micalg-out</code> is requested, and multiple incompatibly-constrained <code>KEYS</code> objects are supplied, <code>sop sign</code> MUST emit the empty string to the designated <code>MICALG</code>.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">If any key in the <code>KEYS</code> objects is not capable of producing a signature, <code>sop sign</code> will fail with <code>KEY_CANNOT_SIGN</code>.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9"><code>sop sign</code> MUST NOT produce any extra signatures beyond those from <code>KEYS</code> objects supplied on the command line.<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<p id="section-3.4-10">Example:<a href="#section-3.4-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-11">
<pre>
$ sop sign --as=text alice.sec &lt; message.txt &gt; message.txt.asc
$ head -n1 &lt; message.txt.asc
-----BEGIN PGP SIGNATURE-----
$
</pre><a href="#section-3.4-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verify">
<section id="section-3.5">
        <h3 id="name-verify-verify-detached-sign">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-verify-verify-detached-sign" class="section-name selfRef">verify: Verify Detached Signatures</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.5-1">
<pre>
sop verify [--not-before=DATE] [--not-after=DATE]
    [--] SIGNATURES CERTS [CERTS...]
</pre><a href="#section-3.5-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.5-2.1">Standard Input: <code>DATA</code> (<a href="#data" class="xref">Section 5.10</a>)<a href="#section-3.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-2.2">Standard Output: <code>VERIFICATIONS</code> (<a href="#verifications" class="xref">Section 5.9</a>)<a href="#section-3.5-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.5-3"><code>--not-before</code> and <code>--not-after</code> indicate that signatures with dates outside certain range MUST NOT be considered valid.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4"><code>--not-before</code> defaults to the beginning of time.
Accepts the special value <code>-</code> to indicate the beginning of time (i.e. no lower boundary).<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5"><code>--not-after</code> defaults to the current system time (<code>now</code>).
Accepts the special value <code>-</code> to indicate the end of time (i.e. no upper boundary).<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<p id="section-3.5-6"><code>sop verify</code> only returns <code>OK</code> if at least one certificate included in any <code>CERTS</code> object made a valid signature in the range over the <code>DATA</code> supplied.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">For details about the valid signatures, the user MUST inspect the <code>VERIFICATIONS</code> output.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">If no <code>CERTS</code> are supplied, <code>sop verify</code> fails with <code>MISSING_ARG</code>.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<p id="section-3.5-9">If no valid signatures are found, <code>sop verify</code> fails with <code>NO_SIGNATURE</code>.<a href="#section-3.5-9" class="pilcrow">¶</a></p>
<p id="section-3.5-10">See <a href="#signature-verification" class="xref">Section 10.1</a> for more details about signature verification.<a href="#section-3.5-10" class="pilcrow">¶</a></p>
<p id="section-3.5-11">Example:<a href="#section-3.5-11" class="pilcrow">¶</a></p>
<p id="section-3.5-12">(In this example, we see signature verification succeed first, and then fail on a modified version of the message.)<a href="#section-3.5-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-13">
<pre>
$ sop verify message.txt.asc alice.pgp &lt; message.txt
2019-10-29T18:36:45Z EB85BB5FA33A75E15E944E63F231550C4F47E38E EB85BB5FA33A75E15E944E63F231550C4F47E38E signed by alice.pgp
$ echo $?
0
$ tr a-z A-Z &lt; message.txt | sop verify message.txt.asc alice.pgp
$ echo $?
3
$
</pre><a href="#section-3.5-13" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="encrypt">
<section id="section-3.6">
        <h3 id="name-encrypt-encrypt-a-message">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-encrypt-encrypt-a-message" class="section-name selfRef">encrypt: Encrypt a Message</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.6-1">
<pre>
sop encrypt [--as={binary|text|mime}]
    [--no-armor]
    [--with-password=PASSWORD...]
    [--sign-with=KEYS...]
    [--] [CERTS...]
</pre><a href="#section-3.6-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.6-2.1">Standard Input: <code>DATA</code> (<a href="#data" class="xref">Section 5.10</a>)<a href="#section-3.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-2.2">Standard Output: <code>CIPHERTEXT</code> (<a href="#ciphertext" class="xref">Section 5.4</a>)<a href="#section-3.6-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-3"><code>--as</code> defaults to <code>binary</code>.
The setting of <code>--as</code> corresponds to the one octet format field found in the Literal Data packet at the core of the output <code>CIPHERTEXT</code>.
If <code>--as</code> is set to <code>binary</code>, the octet is <code>b</code> (<code>0x62</code>).
If it is <code>text</code>, the format octet is <code>u</code> (<code>0x75</code>).
If it is <code>mime</code>, the format octet is <code>m</code> (<code>0x6d</code>).<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<p id="section-3.6-4"><code>--with-password</code> enables symmetric encryption (and can be used multiple times if multiple passwords are desired).
If <code>sop encrypt</code> encounters a <code>PASSWORD</code> which is not a valid <code>UTF-8</code> string (<a href="#utf8" class="xref">Section 8.7</a>), or is otherwise not robust in its representation to humans,
it fails with <code>PASSWORD_NOT_HUMAN_READABLE</code>.
If <code>sop encrypt</code> sees trailing whitespace at the end of a <code>PASSWORD</code>,
it will trim the trailing whitespace before using the password.
See <a href="#human-readable-passwords" class="xref">Section 8.8</a> for more discussion about passwords.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<p id="section-3.6-5"><code>--sign-with</code> creates exactly one signature by for each secret key found in the supplied <code>KEYS</code> object (this can also be used multiple times if signatures from keys found in separaate files are desired).
If any key in any supplied <code>KEYS</code> objects is not capable of producing a signature, <code>sop sign</code> will fail with <code>KEY_CANNOT_SIGN</code>.<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<p id="section-3.6-6">If <code>--as</code> is set to <code>binary</code>, then <code>--sign-with</code> will sign as a binary document (OpenPGP signature type <code>0x00</code>).<a href="#section-3.6-6" class="pilcrow">¶</a></p>
<p id="section-3.6-7">If <code>--as</code> is set to <code>text</code>, then <code>--sign-with</code> will sign as a canonical text document (OpenPGP signature type <code>0x01</code>).
In this case, if the input <code>DATA</code> is not valid <code>UTF-8</code>  (<a href="#utf8" class="xref">Section 8.7</a>), <code>sop encrypt</code> fails with <code>EXPECTED_TEXT</code>.<a href="#section-3.6-7" class="pilcrow">¶</a></p>
<p id="section-3.6-8"><code>sop</code> should only be invoked with <code>--as=mime</code> when the input <code>DATA</code> is a MIME message (<span>[<a href="#RFC2045" class="xref">RFC2045</a>]</span>.
If <code>--sign-with</code> is supplied for such a message, then if the input data is valid <code>UTF-8</code>,  <code>sop</code> SHOULD sign as a canonical text document (OpenPGP signature type <code>0x01</code>).
However, a MIME message itself might not be valid <code>UTF-8</code>, for example, if a MIME subpart contains a raw binary object.
If <code>--sign-with</code> is supplied for input <code>DATA</code> that is not valid <code>UTF-8</code>, <code>sop encrypt</code> MAY sign as a binary document (OpenPGP signature type <code>0x00</code>).<a href="#section-3.6-8" class="pilcrow">¶</a></p>
<p id="section-3.6-9"><code>sop encrypt</code> MUST NOT produce any extra signatures beyond those from <code>KEYS</code> objects identified by <code>--sign-with</code>.<a href="#section-3.6-9" class="pilcrow">¶</a></p>
<p id="section-3.6-10">The resulting <code>CIPHERTEXT</code> should be decryptable by the secret keys corresponding to every certificate included in all <code>CERTS</code>, as well as each password given with <code>--with-password</code>.<a href="#section-3.6-10" class="pilcrow">¶</a></p>
<p id="section-3.6-11">If no <code>CERTS</code> or <code>--with-password</code> options are present, <code>sop encrypt</code> fails with <code>MISSING_ARG</code>.<a href="#section-3.6-11" class="pilcrow">¶</a></p>
<p id="section-3.6-12">If at least one of the identified certificates requires encryption to an unsupported asymmetric algorithm, <code>sop encrypt</code> fails with <code>UNSUPPORTED_ASYMMETRIC_ALGO</code>.<a href="#section-3.6-12" class="pilcrow">¶</a></p>
<p id="section-3.6-13">If at least one of the identified certificates is not encryption-capable (e.g., revoked, expired, no encryption-capable flags on primary key and valid subkeys), <code>sop encrypt</code> fails with <code>CERT_CANNOT_ENCRYPT</code>.<a href="#section-3.6-13" class="pilcrow">¶</a></p>
<p id="section-3.6-14">If <code>sop encrypt</code> fails for any reason, it emits no <code>CIPHERTEXT</code>.<a href="#section-3.6-14" class="pilcrow">¶</a></p>
<p id="section-3.6-15">Example:<a href="#section-3.6-15" class="pilcrow">¶</a></p>
<p id="section-3.6-16">(In this example, <code>bob.bin</code> is a file containing Bob's binary-formatted OpenPGP certificate.
Alice is encrypting a message to both herself and Bob.)<a href="#section-3.6-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6-17">
<pre>
$ sop encrypt --as=mime --sign-with=alice.key alice.asc bob.bin &lt; message.eml &gt; encrypted.asc
$ head -n1 encrypted.asc
-----BEGIN PGP MESSAGE-----
$
</pre><a href="#section-3.6-17" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="decrypt">
<section id="section-3.7">
        <h3 id="name-decrypt-decrypt-a-message">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-decrypt-decrypt-a-message" class="section-name selfRef">decrypt: Decrypt a Message</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.7-1">
<pre>
sop decrypt [--session-key-out=SESSIONKEY]
    [--with-session-key=SESSIONKEY...]
    [--with-password=PASSWORD...]
    [--verify-out=VERIFICATIONS
     [--verify-with=CERTS...]
     [--verify-not-before=DATE]
     [--verify-not-after=DATE] ]
    [--] [KEYS...]
</pre><a href="#section-3.7-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.7-2.1">Standard Input: <code>CIPHERTEXT</code> (<a href="#ciphertext" class="xref">Section 5.4</a>)<a href="#section-3.7-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.7-2.2">Standard Output: <code>DATA</code> (<a href="#data" class="xref">Section 5.10</a>)<a href="#section-3.7-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.7-3">The caller can ask <code>sop</code> for the session key discovered during decryption by supplying the <code>--session-key-out</code> option.
If the specified file already exists in the filesystem, <code>sop decrypt</code> will fail with <code>OUTPUT_EXISTS</code>.
When decryption is successful, <code>sop decrypt</code> writes the discovered session key to the specified file.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<p id="section-3.7-4"><code>--with-session-key</code> enables decryption of the <code>CIPHERTEXT</code> using the session key directly against the <code>SEIPD</code> packet.
This option can be used multiple times if several possible session keys should be tried.<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<p id="section-3.7-5"><code>--with-password</code> enables decryption based on any <code>SKESK</code> (section 5.3 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>) packets in the <code>CIPHERTEXT</code>.
This option can be used multiple times if the user wants to try more than one password.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<p id="section-3.7-6">If <code>sop decrypt</code> tries and fails to use a supplied <code>PASSWORD</code>,
and it observes that there is trailing <code>UTF-8</code> whitespace at the end of the <code>PASSWORD</code>,
it will retry with the trailing whitespace stripped.
See <a href="#human-readable-passwords" class="xref">Section 8.8</a> for more discussion about passwords.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
<p id="section-3.7-7"><code>--verify-out</code> produces signature verification status to the designated file.
If the designated file already exists in the filesystem, <code>sop decrypt</code> will fail with <code>OUTPUT_EXISTS</code>.<a href="#section-3.7-7" class="pilcrow">¶</a></p>
<p id="section-3.7-8">The return code of <code>sop decrypt</code> is not affected by the results of signature verification.
The caller MUST check the returned <code>VERIFICATIONS</code> to confirm signature status.
An empty <code>VERIFICATIONS</code> output indicates that no valid signatures were found.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
<p id="section-3.7-9"><code>--verify-with</code> identifies a set of certificates whose signatures would be acceptable for signatures over this message.<a href="#section-3.7-9" class="pilcrow">¶</a></p>
<p id="section-3.7-10">If the caller is interested in signature verification, both <code>--verify-out</code> and at least one <code>--verify-with</code> must be supplied.
If only one of these arguments is supplied, <code>sop decrypt</code> fails with <code>INCOMPLETE_VERIFICATION</code>.<a href="#section-3.7-10" class="pilcrow">¶</a></p>
<p id="section-3.7-11"><code>--verify-not-before</code> and <code>--verify-not-after</code> provide a date range for acceptable signatures,
by analogy with the options for <code>sop verify</code> (see <a href="#verify" class="xref">Section 3.5</a>).
They should only be supplied when doing signature verification.<a href="#section-3.7-11" class="pilcrow">¶</a></p>
<p id="section-3.7-12">See <a href="#signature-verification" class="xref">Section 10.1</a> for more details about signature verification.<a href="#section-3.7-12" class="pilcrow">¶</a></p>
<p id="section-3.7-13">If no <code>KEYS</code> or <code>--with-password</code> or <code>--with-session-key</code> options are present, <code>sop decrypt</code> fails with <code>MISSING_ARG</code>.<a href="#section-3.7-13" class="pilcrow">¶</a></p>
<p id="section-3.7-14">If unable to decrypt, <code>sop decrypt</code> fails with <code>CANNOT_DECRYPT</code>.<a href="#section-3.7-14" class="pilcrow">¶</a></p>
<p id="section-3.7-15"><code>sop decrypt</code> only emits cleartext to Standard Output that was successfully decrypted.<a href="#section-3.7-15" class="pilcrow">¶</a></p>
<p id="section-3.7-16">Example:<a href="#section-3.7-16" class="pilcrow">¶</a></p>
<p id="section-3.7-17">(In this example, Alice stashes and re-uses the session key of an encrypted message.)<a href="#section-3.7-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7-18">
<pre>
$ sop decrypt --session-key-out=session.key alice.sec &lt; ciphertext.asc &gt; cleartext.out
$ ls -l ciphertext.asc cleartext.out
-rw-r--r-- 1 user user   321 Oct 28 01:34 ciphertext.asc
-rw-r--r-- 1 user user   285 Oct 28 01:34 cleartext.out
$ sop decrypt --with-session-key=session.key &lt; ciphertext.asc &gt; cleartext2.out
$ diff cleartext.out cleartext2.out
$
</pre><a href="#section-3.7-18" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="armor-convert-binary-to-ascii">
<section id="section-3.8">
        <h3 id="name-armor-convert-binary-to-asc">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-armor-convert-binary-to-asc" class="section-name selfRef">armor: Convert binary to ASCII</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.8-1">
<pre>
sop armor [--label={auto|sig|key|cert|message}]
</pre><a href="#section-3.8-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.8-2.1">Standard Input: OpenPGP material (<code>SIGNATURES</code>, <code>KEYS</code>, <code>CERTS</code>, or <code>CIPHERTEXT</code>)<a href="#section-3.8-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-2.2">Standard Output: the same material with ASCII-armoring added, if not already present<a href="#section-3.8-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.8-3">The user can choose to specify the label used in the header and tail of the armoring.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<p id="section-3.8-4">The default for <code>--label</code> is <code>auto</code>, in which case, <code>sop</code> inspects the input and chooses the label appropriately, based on the type of the first OpenPGP packet.
If the type of the first OpenPGP packet is:<a href="#section-3.8-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8-5.1">
            <code>0x02</code> (Signature), the packet stream should be parsed as a <code>SIGNATURES</code> input (with Armor Header <code>BEGIN PGP SIGNATURE</code>).<a href="#section-3.8-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-5.2">
            <code>0x05</code> (Secret-Key), the packet stream should be parsed as a <code>KEYS</code> input (with Armor Header <code>BEGIN PGP PRIVATE KEY BLOCK</code>).<a href="#section-3.8-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-5.3">
            <code>0x06</code> (Public-Key), the packet stream should be parsed as a <code>CERTS</code> input (with Armor Header <code>BEGIN PGP PUBLIC KEY BLOCK</code>).<a href="#section-3.8-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-5.4">
            <code>0x01</code> (Public-key Encrypted Session Key) or <code>0x03</code> (Symmetric-key Encrypted Session Key), the packet stream should be parsed as a <code>CIPHERTEXT</code> input (with Armor Header <code>BEGIN PGP MESSAGE</code>).<a href="#section-3.8-5.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.8-6">If the input packet stream does not match the expected sequence of packet types, <code>sop armor</code> fails with <code>BAD_DATA</code>.<a href="#section-3.8-6" class="pilcrow">¶</a></p>
<p id="section-3.8-7">Since <code>sop armor</code> accepts ASCII-armored input as well as binary input, this operation is idempotent on well-structured data.
A caller can use this subcommand blindly ensure that any well-formed OpenPGP packet stream is 7-bit clean.<a href="#section-3.8-7" class="pilcrow">¶</a></p>
<p id="section-3.8-8">Example:<a href="#section-3.8-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.8-9">
<pre>
$ sop armor &lt; bob.bin &gt; bob.pgp
$ head -n1 bob.pgp
-----BEGIN PGP PUBLIC KEY BLOCK-----
$
</pre><a href="#section-3.8-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dearmor-convert-ascii-to-binary">
<section id="section-3.9">
        <h3 id="name-dearmor-convert-ascii-to-bi">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-dearmor-convert-ascii-to-bi" class="section-name selfRef">dearmor: Convert ASCII to binary</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.9-1">
<pre>
sop dearmor
</pre><a href="#section-3.9-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.9-2.1">Standard Input: OpenPGP material (<code>SIGNATURES</code>, <code>KEYS</code>, <code>CERTS</code>, or <code>CIPHERTEXT</code>)<a href="#section-3.9-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.9-2.2">Standard Output: the same material with any ASCII-armoring removed<a href="#section-3.9-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.9-3">If the input packet stream does not match any of the expected sequence of packet types, <code>sop dearmor</code> fails with <code>BAD_DATA</code>.  See also <a href="#optional-input-armoring" class="xref">Section 8.4</a>.<a href="#section-3.9-3" class="pilcrow">¶</a></p>
<p id="section-3.9-4">Since <code>sop dearmor</code> accepts binary-formatted input as well as ASCII-armored input, this operation is idempotent on well-structured data.
A caller can use this subcommand blindly ensure that any well-formed OpenPGP packet stream is in its standard binary representation.<a href="#section-3.9-4" class="pilcrow">¶</a></p>
<p id="section-3.9-5">Example:<a href="#section-3.9-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.9-6">
<pre>
$ sop dearmor &lt; message.txt.asc &gt; message.txt.sig
$
</pre><a href="#section-3.9-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="detach-inband-signature-and-message-split-a-clearsigned-message">
<section id="section-3.10">
        <h3 id="name-detach-inband-signature-and">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-detach-inband-signature-and" class="section-name selfRef">detach-inband-signature-and-message: split a clearsigned message</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.10-1">
<pre>
sop detach-inband-signature-and-message [--no-armor] --signatures-out=SIGNATURES
</pre><a href="#section-3.10-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.10-2.1">Standard Input: <code>DATA</code> (clearsigned message)<a href="#section-3.10-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-2.2">Standard Output: <code>DATA</code> (the message without the cleartext signature framework)<a href="#section-3.10-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.10-3">In some contexts, the user may encounter a clearsigned ("inline PGP") message (section 7 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>) rather than a message and its detached signature.
This subcommand takes such a clearsigned message on standard input, and splits it into:<a href="#section-3.10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.10-4.1">the potentially signed material on standard output, and<a href="#section-3.10-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.10-4.2">a detached signature block to the destination identified by <code>--signatures-out</code><a href="#section-3.10-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.10-5">Note that no cryptographic verification of the signatures is done by this subcommand.
Once the clearsigned message is separated, verification of the detached signature can be done with <code>sop verify</code>.<a href="#section-3.10-5" class="pilcrow">¶</a></p>
<p id="section-3.10-6">If no <code>--signatures-out</code> is supplied, <code>sop detach-inband-signature-and-message</code> fails with <code>MISSING_ARG</code>.<a href="#section-3.10-6" class="pilcrow">¶</a></p>
<p id="section-3.10-7">Note that the signature block in a clearsigned message may contain multiple signatures.
All signatures found in the signature block will be emitted to the <code>--signatures-out</code> destination.<a href="#section-3.10-7" class="pilcrow">¶</a></p>
<p id="section-3.10-8">The message body in the clearsigned message will be dash-escaped on standard input (see section 7.1 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>).
The output of <code>sop detach-inband-signature-and-message</code> will have dash-escaping removed.<a href="#section-3.10-8" class="pilcrow">¶</a></p>
<p id="section-3.10-9">If the input <code>DATA</code> contains no clearsigned message, <code>sop detach-inband-signature-and-message</code> fails with <code>BAD_DATA</code>.
If the input <code>DATA</code> contains more than one clearsigned message, <code>sop detach-inband-signature-and-message</code> also fails with <code>BAD_DATA</code>.
A <code>sop</code> implementation MAY accept (and discard) leading and trailing data around the inline PGP clearsigned message.<a href="#section-3.10-9" class="pilcrow">¶</a></p>
<p id="section-3.10-10">If the file designated by <code>--signatures-out</code> already exists in the filesystem, <code>sop detach-inband-signature-and-message</code> will fail with <code>OUTPUT_EXISTS</code>.<a href="#section-3.10-10" class="pilcrow">¶</a></p>
<p id="section-3.10-11">Note that <code>--no-armor</code> here governs the data written to the <code>--signatures-out</code> destination.
Standard output is always the raw message, not an OpenPGP packet.<a href="#section-3.10-11" class="pilcrow">¶</a></p>
<p id="section-3.10-12">Example:<a href="#section-3.10-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.10-13">
<pre>
$ sop detach-inband-signature-and-message --signatures-out=Release.pgp &lt; InRelease &gt;Release
$ sop verify Release.pgp archive-keyring.pgp &lt; Release
$
</pre><a href="#section-3.10-13" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="input-string-types">
<section id="section-4">
      <h2 id="name-input-string-types">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-input-string-types" class="section-name selfRef">Input String Types</a>
      </h2>
<p id="section-4-1">Some material is passed to <code>sop</code> directly as a string on the command line.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="date">
<section id="section-4.1">
        <h3 id="name-date">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-date" class="section-name selfRef">DATE</a>
        </h3>
<p id="section-4.1-1">An ISO-8601 formatted timestamp with time zone, or the special value <code>now</code> to indicate the current system time.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Examples:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3">
<pre>
now
2019-10-29T12:11:04+00:00
2019-10-24T23:48:29Z
20191029T121104Z
</pre><a href="#section-4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1-4">In some cases where used to specify lower and upper boundaries, a <code>DATE</code> value can be set to <code>-</code> to indicate "no time limit".<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">A flexible implementation of <code>sop</code> MAY accept date inputs in other unambiguous forms.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Note that whenever <code>sop</code> emits a timestamp (e.g. in <a href="#verifications" class="xref">Section 5.9</a>) it MUST produce only a UTC-based ISO-8601 compliant representation.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="userid">
<section id="section-4.2">
        <h3 id="name-userid">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-userid" class="section-name selfRef">USERID</a>
        </h3>
<p id="section-4.2-1">This is an arbitrary <code>UTF-8</code> string (<a href="#utf8" class="xref">Section 8.7</a>).
By convention, most User IDs are of the form <code>Display Name &lt;email.address@example.com&gt;</code>, but they do not need to be.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="indirect-types">
<section id="section-5">
      <h2 id="name-input-output-indirect-types">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-input-output-indirect-types" class="section-name selfRef">Input/Output Indirect Types</a>
      </h2>
<p id="section-5-1">Some material is passed to <code>sop</code> indirectly, typically by referring to a filename containing the data in question.
This type of data may also be passed to <code>sop</code> on Standard Input, or delivered by <code>sop</code> to Standard Output.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If any input data is specified explicitly to be read from a file that does not exist, <code>sop</code> will fail with <code>MISSING_INPUT</code>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">If any input data does not meet the requirements described below, <code>sop</code> will fail with <code>BAD_DATA</code>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="special-designators">
<section id="section-5.1">
        <h3 id="name-special-designators-for-ind">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-special-designators-for-ind" class="section-name selfRef">Special Designators for Indirect Types</a>
        </h3>
<p id="section-5.1-1">An indirect argument or parameter that starts with <span class="unicode">"@" (COMMERCIAL AT, U+0040)</span> is not treated as a filename, but is reserved for special handling, based on the prefix that follows the <code>@</code>.
We describe two of those prefixes (<code>@ENV:</code> and <code>@FD:</code>) here.
A <code>sop</code> implementation that receives such a special designator but does not know how to handle a given prefix in that context MUST fail with <code>UNSUPPORTED_SPECIAL_PREFIX</code>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">If the filename for any indirect material used as input has the special form <code>@ENV:xxx</code>,
then contents of environment variable <code>$xxx</code> is used instead of looking in the filesystem.
<code>@ENV</code> is for input only: if the prefix <code>@ENV:</code> is used for any output argument, <code>sop</code> fails with <code>UNSUPPORTED_SPECIAL_PREFIX</code>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">If the filename for any indirect material used as either input or output has the special form <code>@FD:nnn</code> where <code>nnn</code> is a decimal integer,
then the associated data is read from file descriptor <code>nnn</code>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">See <a href="#special-designators-guidance" class="xref">Section 8.9</a> for more details about safe handling of these special designators.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certs">
<section id="section-5.2">
        <h3 id="name-certs">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-certs" class="section-name selfRef">CERTS</a>
        </h3>
<p id="section-5.2-1">One or more OpenPGP certificates (section 11.1 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>), aka "Transferable Public Key".
May be armored (see <a href="#optional-input-armoring" class="xref">Section 8.4</a>).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Although some existing workflows may prefer to use one <code>CERTS</code> object with multiple certificates in it (a "keyring"), supplying exactly one certificate per <code>CERTS</code> input will make error reporting clearer and easier.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keys">
<section id="section-5.3">
        <h3 id="name-keys">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-keys" class="section-name selfRef">KEYS</a>
        </h3>
<p id="section-5.3-1">One or more OpenPGP Transferable Secret Keys (section 11.2 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>).
May be armored (see <a href="#optional-input-armoring" class="xref">Section 8.4</a>).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">Secret key material should be in cleartext (that is, it should not be locked with a password).
If any secret key material is locked with a password, <code>sop</code> may fail with error <code>KEY_IS_PROTECTED</code>.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Although some existing workflows may prefer to use one <code>KEYS</code> object with multiple keys in it (a "secret keyring"), supplying exactly one key per <code>KEYS</code> input will make error reporting clearer and easier.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ciphertext">
<section id="section-5.4">
        <h3 id="name-ciphertext">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-ciphertext" class="section-name selfRef">CIPHERTEXT</a>
        </h3>
<p id="section-5.4-1"><code>sop</code> accepts only a restricted subset of the arbitrarily-nested grammar allowed by the OpenPGP Messages definition (section 11.3 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">In particular, it accepts and generates only:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">An OpenPGP message, consisting of a sequence of PKESKs (section 5.1 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>) and SKESKs (section 5.3 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>),
followed by one SEIPD (section 5.14 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>).<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">The SEIPD can decrypt into one of two things:<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-5.1">"Maybe Signed Data" (see below), or<a href="#section-5.4-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-5.2">Compressed data packet that contains "Maybe Signed Data"<a href="#section-5.4-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.4-6">"Maybe Signed Data" is a sequence of:<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-7.1">N (zero or more) one-pass signature packets, followed by<a href="#section-5.4-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-7.2">zero or more signature packets, followed by<a href="#section-5.4-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-7.3">one Literal data packet, followed by<a href="#section-5.4-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-7.4">N signature packets (corresponding to the outer one-pass signatures packets)<a href="#section-5.4-7.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.4-8">FIXME: does any tool do compression inside signing?  Do we need to handle that?<a href="#section-5.4-8" class="pilcrow">¶</a></p>
<p id="section-5.4-9">May be armored (see <a href="#optional-input-armoring" class="xref">Section 8.4</a>).<a href="#section-5.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature">
<section id="section-5.5">
        <h3 id="name-signatures">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-signatures" class="section-name selfRef">SIGNATURES</a>
        </h3>
<p id="section-5.5-1">One or more OpenPGP Signature packets.  May be armored (see <a href="#optional-input-armoring" class="xref">Section 8.4</a>).<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sessionkey">
<section id="section-5.6">
        <h3 id="name-sessionkey">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-sessionkey" class="section-name selfRef">SESSIONKEY</a>
        </h3>
<p id="section-5.6-1">This documentation uses the GnuPG defacto <code>ASCII</code> representation:<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2"><code>ALGONUM:HEXKEY</code><a href="#section-5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.6-3">where <code>ALGONUM</code> is the decimal value associated with the OpenPGP Symmetric Key Algorithms (section 9.3 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>) and <code>HEXKEY</code> is the hexadecimal
representation of the binary key.<a href="#section-5.6-3" class="pilcrow">¶</a></p>
<p id="section-5.6-4">Example AES-256 session key:<a href="#section-5.6-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.6-5">
<pre>
9:FCA4BEAF687F48059CACC14FB019125CD57392BAB7037C707835925CBF9F7BCD
</pre><a href="#section-5.6-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="micalg">
<section id="section-5.7">
        <h3 id="name-micalg">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-micalg" class="section-name selfRef">MICALG</a>
        </h3>
<p id="section-5.7-1">This output indicates the cryptographic digest used when making a signature.
It is useful specifically when generating signed PGP/MIME objects, which want a <code>micalg=</code> parameter for the <code>multipart/signed</code> content type as described in section 5 of <span>[<a href="#RFC3156" class="xref">RFC3156</a>]</span>.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">It will typically be a string like <code>pgp-sha512</code>, but in some situations (multiple signatures using different digests) it will be the empty string.
If the user of <code>sop</code> is assembling a PGP/MIME signed object, and the <code>MICALG</code> output is the empty string,
the user should omit the <code>micalg=</code> parameter entirely.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="password">
<section id="section-5.8">
        <h3 id="name-password">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-password" class="section-name selfRef">PASSWORD</a>
        </h3>
<p id="section-5.8-1">This is expected to be a <code>UTF-8</code> string (<a href="#utf8" class="xref">Section 8.7</a>), but for <code>sop decrypt</code>, any bytestring that the user supplies will be accepted.
Note the details in <code>sop encrypt</code> and <code>sop decrypt</code> about trailing whitespace!<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<p id="section-5.8-2">See also <a href="#human-readable-passwords" class="xref">Section 8.8</a> for more discussion.<a href="#section-5.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifications">
<section id="section-5.9">
        <h3 id="name-verifications">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-verifications" class="section-name selfRef">VERIFICATIONS</a>
        </h3>
<p id="section-5.9-1">One line per successful signature verification.
Each line has three structured fields delimited by a single space,
followed by arbitrary text to the end of the line that forms a message describing the verification.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.9-2.1">ISO-8601 UTC datestamp<a href="#section-5.9-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.9-2.2">Fingerprint of the signing key (may be a subkey)<a href="#section-5.9-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.9-2.3">Fingerprint of primary key of signing certificate (if signed by primary key, same as the previous field)<a href="#section-5.9-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.9-2.4">message describing the verification (free form)<a href="#section-5.9-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.9-3">Note that while <a href="#date" class="xref">Section 4.1</a> permits a <code>sop</code> implementation to accept other unambiguous date representations,
its date output here MUST be a strict ISO-8601 UTC date timestamp.
In particular:<a href="#section-5.9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.9-4.1">the date and time fields MUST be separated by <code>T</code>, not by whitespace, since whitespace is used as a delimiter<a href="#section-5.9-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.9-4.2">the time MUST be emitted in UTC, with the explicit suffix <code>Z</code><a href="#section-5.9-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.9-5">Example:<a href="#section-5.9-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.9-6">
<pre>
2019-10-24T23:48:29Z C90E6D36200A1B922A1509E77618196529AE5FF8 C4BC2DDB38CCE96485EBE9C2F20691179038E5C6 certificate from dkg.asc
</pre><a href="#section-5.9-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="data">
<section id="section-5.10">
        <h3 id="name-data">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-data" class="section-name selfRef">DATA</a>
        </h3>
<p id="section-5.10-1">Cleartext, arbitrary data.  This is either a bytestream or <code>UTF-8</code> text.<a href="#section-5.10-1" class="pilcrow">¶</a></p>
<p id="section-5.10-2">It MUST only be <code>UTF-8</code> text in the case of input supplied to <code>sop sign --as=text</code> or <code>sop encrypt --as={mime|text}</code>.
If <code>sop</code> receives <code>DATA</code> containing non-<code>UTF-8</code> octets in this case, it will fail (see <a href="#utf8" class="xref">Section 8.7</a>) with <code>EXPECTED_TEXT</code>.<a href="#section-5.10-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="failure-modes">
<section id="section-6">
      <h2 id="name-failure-modes">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-failure-modes" class="section-name selfRef">Failure Modes</a>
      </h2>
<p id="section-6-1"><code>sop</code> return codes have both mnemonics and numeric values.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">When <code>sop</code> succeeds, it will return 0 (<code>OK</code>) and emit nothing to Standard Error.
When <code>sop</code> fails, it fails with a non-zero return code, and emits one or more warning messages on Standard Error.
Known return codes include:<a href="#section-6-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Mnemonic</th>
            <th class="text-left" rowspan="1" colspan="1">Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>OK</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Success</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>NO_SIGNATURE</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">No acceptable signatures found (<code>sop verify</code>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">13</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>UNSUPPORTED_ASYMMETRIC_ALGO</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Asymmetric algorithm unsupported (<code>sop encrypt</code>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">17</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>CERT_CANNOT_ENCRYPT</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Certificate not encryption-capable (e.g., expired, revoked, unacceptable usage flags) (<code>sop encrypt</code>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">19</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>MISSING_ARG</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Missing required argument</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">23</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>INCOMPLETE_VERIFICATION</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Incomplete verification instructions (<code>sop decrypt</code>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">29</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>CANNOT_DECRYPT</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Unable to decrypt (<code>sop decrypt</code>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">31</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>PASSWORD_NOT_HUMAN_READABLE</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Non-<code>UTF-8</code> or otherwise unreliable password (<code>sop encrypt</code>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">37</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>UNSUPPORTED_OPTION</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Unsupported option</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">41</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>BAD_DATA</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Invalid data type (no secret key where <code>KEYS</code> expected, etc)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">53</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>EXPECTED_TEXT</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Non-text input where text expected</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">59</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>OUTPUT_EXISTS</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Output file already exists</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">61</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>MISSING_INPUT</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Input file does not exist</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">67</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>KEY_IS_PROTECTED</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">A <code>KEYS</code> input is protected (locked) with a password, and <code>sop</code> cannot unlock it</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">69</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>UNSUPPORTED_SUBCOMMAND</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Unsupported subcommand</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">71</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>UNSUPPORTED_SPECIAL_PREFIX</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">An indirect parameter is a special designator (it starts with <code>@</code>) but <code>sop</code> does not know how to handle the prefix</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">73</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>AMBIGUOUS_INPUT</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">A indirect input parameter is a special designator (it starts with <code>@</code>), and a filename matching the designator is actually present</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">79</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>KEY_CANNOT_SIGN</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Key not signature-capable (e.g., expired, revoked, unacceptable usage flags) (<code>sop sign</code> and <code>sop encrypt</code> with <code>--sign-with</code>)</td>
          </tr>
        </tbody>
      </table>
<p id="section-6-4">If a <code>sop</code> implementation fails in some way not contemplated by this document, it MAY return any non-zero error code, not only those listed above.<a href="#section-6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alternate-interfaces">
<section id="section-7">
      <h2 id="name-alternate-interfaces">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-alternate-interfaces" class="section-name selfRef">Alternate Interfaces</a>
      </h2>
<p id="section-7-1">This draft primarily defines a command line interface, but future versions may try to outline a comparable idiomatic interface for C or some other widely-used programming language.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Comparable idiomatic interfaces are already active in the wild for different programming languages, in particular:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">Rust: <span>[<a href="#RUST-SOP" class="xref">RUST-SOP</a>]</span><a href="#section-7-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-3.2">Java: <span>[<a href="#SOP-JAVA" class="xref">SOP-JAVA</a>]</span><a href="#section-7-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-3.3">Python: <span>[<a href="#PYTHON-SOP" class="xref">PYTHON-SOP</a>]</span><a href="#section-7-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-4">These programmatic interfaces are typically coupled with a wrapper that can automatically generate a command-line tool compatible with this draft.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">An implemention that uses one of these languages should target the corresponding idiomatic interface for ease of development and interoperability.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="guidance-for-implementers">
<section id="section-8">
      <h2 id="name-guidance-for-implementers">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-guidance-for-implementers" class="section-name selfRef">Guidance for Implementers</a>
      </h2>
<p id="section-8-1"><code>sop</code> uses a few assumptions that implementers might want to consider.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="one-openpgp-message-at-a-time">
<section id="section-8.1">
        <h3 id="name-one-openpgp-message-at-a-ti">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-one-openpgp-message-at-a-ti" class="section-name selfRef">One OpenPGP Message at a Time</a>
        </h3>
<p id="section-8.1-1"><code>sop</code> is intended to be a simple tool that operates on one OpenPGP object at a time.  It should be composable, if you want to use it to deal with multiple OpenPGP objects.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">FIXME: discuss what this means for streaming.
The stdio interface doesn't necessarily imply streamed output.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="simplified-subset-of-openpgp-message">
<section id="section-8.2">
        <h3 id="name-simplified-subset-of-openpg">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-simplified-subset-of-openpg" class="section-name selfRef">Simplified Subset of OpenPGP Message</a>
        </h3>
<p id="section-8.2-1">While the formal grammar for OpenPGP Message is arbitrarily nestable, <code>sop</code> constrains itself to what it sees as a single "layer" (see <a href="#ciphertext" class="xref">Section 5.4</a>).<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">This is a deliberate choice, because it is what most consumers expect.
Also, if an arbitrarily-nested structure is parsed with a recursive algorithm, this risks a denial of service vulnerability.
<code>sop</code> intends to be implementable with a parser that defensively declines to do recursive descent into an OpenPGP Message.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Note that an implementation of <code>sop decrypt</code> MAY choose to handle more complex structures, but if it does, it should document the other structures it handles and why it chooses to do so.
We can use such documentation to improve future versions of this spec.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validate-signatures-only-from-known-signers">
<section id="section-8.3">
        <h3 id="name-validate-signatures-only-fr">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-validate-signatures-only-fr" class="section-name selfRef">Validate Signatures Only from Known Signers</a>
        </h3>
<p id="section-8.3-1">There are generally only a few signers who are relevant for a given OpenPGP message.
When verifying signatures, <code>sop</code> expects that the caller can identify those relevant signers ahead of time.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="optional-input-armoring">
<section id="section-8.4">
        <h3 id="name-openpgp-inputs-can-be-eithe">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-openpgp-inputs-can-be-eithe" class="section-name selfRef">OpenPGP inputs can be either Binary or ASCII-armored</a>
        </h3>
<p id="section-8.4-1">OpenPGP material on input can be in either ASCII-armored or binary form.
This is a deliberate choice because there are typical scenarios where the program can't predict which form will appear.
Expecting the caller of <code>sop</code> to detect the form and adjust accordingly seems both redundant and error-prone.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">The simple way to detect possible ASCII-armoring is to see whether the high bit of the first octet is set:
section 4.2 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span> indicates that bit 7 is always one in the first octet of an OpenPGP packet.
In standard ASCII-armor, the first character is <span class="unicode">"-" (HYPHEN-MINUS, U+002D)</span>, so the high bit should be cleared.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">When considering an input as ASCII-armored OpenPGP material, <code>sop</code> MAY reject an input based on any of the following variations (see section 6.2 of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span> for precise definitions):<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-4.1">An unknown Armor Header Line<a href="#section-8.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-4.2">Any text before the Armor Header Line<a href="#section-8.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-4.3">Malformed lines in the Armor Headers section<a href="#section-8.4-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-4.4">Any non-whitespace data after the Armor Tail<a href="#section-8.4-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-4.5">Any Radix-64 encoded line with more than 76 characters<a href="#section-8.4-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-4.6">Invalid characters in the Radix-64-encoded data<a href="#section-8.4-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-4.7">An invalid Armor Checksum<a href="#section-8.4-4.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-4.8">A mismatch between the Armor Header Line and the Armor Tail<a href="#section-8.4-4.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.4-5">For robustness, <code>sop</code> SHOULD be willing to ignore whitespace after the Armor Tail.<a href="#section-8.4-5" class="pilcrow">¶</a></p>
<p id="section-8.4-6">When considering OpenPGP material as input, regardless of whether it is ASCII-armored or binary, <code>sop</code> SHOULD reject any material that doesn't produce a valid stream of OpenPGP packets.
For example, <code>sop</code> SHOULD raise an error if an OpenPGP packet header is malformed, or if there is trailing garbage after the end of a packet.<a href="#section-8.4-6" class="pilcrow">¶</a></p>
<p id="section-8.4-7">For a given type of OpenPGP input material (i.e.,  <code>SIGNATURES</code>, <code>CERTS</code>, <code>KEYS</code>, or <code>CIPHERTEXT</code>), <code>sop</code> SHOULD also reject any input that does not conform to the expected packet stream.
See <a href="#indirect-types" class="xref">Section 5</a> for the expected packet stream for different types.<a href="#section-8.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="detached-signatures">
<section id="section-8.5">
        <h3 id="name-detached-signatures">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-detached-signatures" class="section-name selfRef">Detached Signatures</a>
        </h3>
<p id="section-8.5-1"><code>sop</code> deals with detached signatures as the baseline form of OpenPGP signatures.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">The primary alternative to detached signatures is inline signatures, but handling an inline signature requires parsing to delimit the multiple parts of the document, including at least:<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-3.1">any preamble before the message<a href="#section-8.5-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-3.2">the inline message header (delimiter line, OpenPGP headers)<a href="#section-8.5-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-3.3">the message itself<a href="#section-8.5-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-3.4">the divider between the message and the signature (including any OpenPGP headers there)<a href="#section-8.5-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-3.5">the signature<a href="#section-8.5-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-3.6">the divider that terminates the signature<a href="#section-8.5-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-3.7">any suffix after the signature<a href="#section-8.5-3.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.5-4">Note also that the preamble or the suffix might be arbitrary text, and might themselves contain OpenPGP messages (whether signatures or otherwise).<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<p id="section-8.5-5">If the parser that does this split differs in any way from the parser that does the verification, or parts of the message are confused,
it would be possible to produce a verification status and an actual signed message that don't correspond to one another.<a href="#section-8.5-5" class="pilcrow">¶</a></p>
<p id="section-8.5-6">Blurred boundary problems like this can produce ugly attacks similar to those found in <span>[<a href="#EFAIL" class="xref">EFAIL</a>]</span>.<a href="#section-8.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cert-validity-performance">
<section id="section-8.6">
        <h3 id="name-reliance-on-supplied-certs-">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-reliance-on-supplied-certs-" class="section-name selfRef">Reliance on Supplied Certs and Keys</a>
        </h3>
<p id="section-8.6-1">A truly stateless implementation may find that it spends more time validating the internal consistency of certificates and keys than it does on the actual object security operations.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">For performance reasons, an implementation may choose to ignore validation on certificate and key material supplied to it.  The security implications of doing so depend on how the certs and keys are managed outside of <code>sop</code>.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="utf8">
<section id="section-8.7">
        <h3 id="name-text-is-always-utf-8">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-text-is-always-utf-8" class="section-name selfRef">Text is always UTF-8</a>
        </h3>
<p id="section-8.7-1">Various places in this specification require UTF-8 <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span> when encoding text. <code>sop</code> implementations SHOULD NOT consider textual data in any other character encoding.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2">OpenPGP Implementations MUST already handle UTF-8, because various parts of <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span> require it, including:<a href="#section-8.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.7-3.1">User ID<a href="#section-8.7-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.7-3.2">Notation name<a href="#section-8.7-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.7-3.3">Reason for revocation<a href="#section-8.7-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.7-3.4">ASCII-armor Comment: header<a href="#section-8.7-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.7-4">Dealing with messages in other charsets leads to weird security failures like <span>[<a href="#Charset-Switching" class="xref">Charset-Switching</a>]</span>, especially when the charset indication is not covered by any sort of cryptographic integrity check.
Restricting textual data to <code>UTF-8</code> universally across the OpenPGP ecosystem eliminates any such risk without losing functionality, since <code>UTF-8</code> can encode all known characters.<a href="#section-8.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="human-readable-passwords">
<section id="section-8.8">
        <h3 id="name-passwords-are-human-readabl">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-passwords-are-human-readabl" class="section-name selfRef">Passwords are Human-Readable</a>
        </h3>
<p id="section-8.8-1">Passwords are generally expected to be human-readable, as they are typically recorded and transmitted as human-visible, human-transferable strings.
However, they are used in the OpenPGP protocol as bytestrings, so ensuring that there is a reliable bidirectional mapping between strings and bytes.
The maximally robust behavior here is for <code>sop encrypt</code> to constrain the choice of passwords to strings that have such a mapping,
and for <code>sop decrypt</code> to try multiple plausible versions of any supplied <code>PASSWORD</code>.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<p id="section-8.8-2">When generating material based on a password, <code>sop encrypt</code> enforces that the password is actually meaningfully human-transferable (requiring <code>UTF-8</code>, trimming trailing whitespace).
Some <code>sop encrypt</code> implementations may make even more strict requirements on input to ensure that they are transferable between humans in a robust way.<a href="#section-8.8-2" class="pilcrow">¶</a></p>
<p id="section-8.8-3">For example, a more strict <code>sop encrypt</code> MAY also:<a href="#section-8.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.8-4.1">forbid leading whitespace<a href="#section-8.8-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.8-4.2">forbid non-printing characters other than <code>SPACE (U+0020)</code>, such as <code>ZERO WIDTH NON-JOINER (U+200C)</code> or <code>TAB (U+0009)</code><a href="#section-8.8-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.8-4.3">require the password to be in Unicode Normal Form C (<span>[<a href="#UNICODE-NORMALIZATION" class="xref">UNICODE-NORMALIZATION</a>]</span>)<a href="#section-8.8-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.8-5">Violations of these more-strict policies SHOULD result in an error of <code>PASSWORD_NOT_HUMAN_READABLE</code>.<a href="#section-8.8-5" class="pilcrow">¶</a></p>
<p id="section-8.8-6">A <code>sop encrypt</code> implementation typically SHOULD NOT attempt enforce a minimum "password strength",
but in the event that some implementation does, it MUST NOT represent a weak password with <code>PASSWORD_NOT_HUMAN_READABLE</code>.<a href="#section-8.8-6" class="pilcrow">¶</a></p>
<p id="section-8.8-7">When <code>sop decrypt</code> receives a <code>PASSWORD</code> input, it sees it as a bytestring.
If the bytestring fails to work as a password, but ends in <code>UTF-8</code> whitespace, it will try again with the trailing whitespace removed.
This handles a common pattern of using a file with a final newline, for example.
The pattern here is one of robustness in the face of typical errors in human-transferred textual data.<a href="#section-8.8-7" class="pilcrow">¶</a></p>
<p id="section-8.8-8">A more robust <code>sop decrypt</code> implementation that finds neither of the above two attempts work for a given <code>PASSWORD</code> MAY try additional variations if they produce a different bytestring, such as:<a href="#section-8.8-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.8-9.1">trimming any leading whitespace, if discovered<a href="#section-8.8-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.8-9.2">trimming any internal non-printable characters other than  <code>SPACE (U+0020)</code><a href="#section-8.8-9.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.8-9.3">converting the supplied <code>PASSWORD</code> into Unicode Normal Form C (<span>[<a href="#UNICODE-NORMALIZATION" class="xref">UNICODE-NORMALIZATION</a>]</span>)<a href="#section-8.8-9.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.8-10">A <code>sop decrypt</code> implementation that stages multiple decryption attempts like this SHOULD consider the computational resources consumed by each attempt, to avoid presenting an attack surface for resource exhaustion in the face of a non-standard <code>PASSWORD</code> input.<a href="#section-8.8-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="special-designators-guidance">
<section id="section-8.9">
        <h3 id="name-be-careful-with-special-des">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-be-careful-with-special-des" class="section-name selfRef">Be careful with Special Designators</a>
        </h3>
<p id="section-8.9-1">As documented in <a href="#special-designators" class="xref">Section 5.1</a>, special designators for indirect inputs like <code>@ENV:</code> and <code>@FD:</code> (and indirect outputs using <code>@FD:</code>) warrant some special/cautious handling.<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<p id="section-8.9-2">For one thing, it's conceivable that the filesystem could contain a file with these literal names.
If <code>sop</code> receives an indirect output parameter that starts with an <span class="unicode">"@" (COMMERCIAL AT, U+0040)</span> it MUST NOT write to the filesystem for that parameter.
A <code>sop</code> implementation that receives such a parameter as input MAY test for the presence of such a file in the filesystem and fail with <code>AMBIGUOUS_INPUT</code> to warn the user of the ambiguity and possible confusion.<a href="#section-8.9-2" class="pilcrow">¶</a></p>
<p id="section-8.9-3">These special designators are likely to be used to pass sensitive data (like secret key material or passwords) so that it doesn't need to touch the filesystem.
Given this sensitivity, <code>sop</code> should be careful with such an input, and minimize its leakage to other processes.
In particular, <code>sop</code> SHOULD NOT leak any environment variable identified by <code>@ENV:</code> or file descriptor identified by <code>@FD:</code> to any subprocess unless the subprocess specifically needs access to that data.<a href="#section-8.9-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="guidance-for-consumers">
<section id="section-9">
      <h2 id="name-guidance-for-consumers">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-guidance-for-consumers" class="section-name selfRef">Guidance for Consumers</a>
      </h2>
<p id="section-9-1">While <code>sop</code> is originally conceived of as an interface for interoperability testing, it's conceivable that an application that uses OpenPGP for object security would want to use it.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">FIXME: more guidance for how to use such a tool safely and efficiently goes here.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">FIXME: if an encrypted OpenPGP message arrives without metadata, it is difficult to know which signers to consider when decrypting.
How do we do this efficiently without invoking <code>sop decrypt</code> twice, once without <code>--verify-*</code> and again with the expected identity material?<a href="#section-9-3" class="pilcrow">¶</a></p>
<div id="choosing-between-astext-and-asbinary">
<section id="section-9.1">
        <h3 id="name-choosing-between-astext-and">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-choosing-between-astext-and" class="section-name selfRef">Choosing between -as=text  and -as=binary</a>
        </h3>
<p id="section-9.1-1">A program that invokes <code>sop</code> to generate an OpenPGP signature typically needs to decide whether it is making a text or binary signature.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">By default, <code>sop</code> will make a binary signature.
The caller of <code>sop sign</code> should choose <code>--as=text</code> only when it knows that:
 - the data being signed is in fact textual, and encoded in <code>UTF-8</code>, and
 - the signed data might be transmitted to the recipient (the verifier of the signature) over a channel that has the propensity to transform line-endings.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">Examples of such channels include FTP (<span>[<a href="#RFC0959" class="xref">RFC0959</a>]</span>) and SMTP (<span>[<a href="#RFC5321" class="xref">RFC5321</a>]</span>).<a href="#section-9.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="special-designators-and-unusual-filenames">
<section id="section-9.2">
        <h3 id="name-special-designators-and-unu">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-special-designators-and-unu" class="section-name selfRef">Special Designators and Unusual Filenames</a>
        </h3>
<p id="section-9.2-1">In some cases, a user of <code>sop</code> might want to pass all the files in a given directory as positional parameters (e.g., a list of CERTS files to test a signature against).<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">If one of the files has a name that starts with <code>--</code>, it might be confused by <code>sop</code> for an option.
If one of the files has a name that starts with <code>@</code>, it might be confused by <code>sop</code> as a special designator (<a href="#special-designators" class="xref">Section 5.1</a>).<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">If the user wants to deliberately refer to such an ambiguously-named file in the filesystem, they should prefix the filename with  <code>./</code> or use an absolute path.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">Any specific <code>@FD:</code> special designator SHOULD NOT be supplied more than once to an invocation of <code>sop</code>.
If a <code>sop</code> invocation sees multiple copies of a specific <code>@FD:n</code> input (e.g., <code>sop sign @FD:3 @FD:3</code>),
it MAY fail with <code>MISSING_INPUT</code> even if file descriptor 3 contains a valid <code>KEYS</code>, because the bytestream for the <code>KEYS</code> was consumed by the first argument.
Doubling up on the same <code>@FD:</code> for output (e.g., <code>sop decrypt --session-key-out=@FD:3 --verify-out=@FD:3</code>) also results in an ambiguous data stream.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">The OpenPGP object security model is typically used for confidentiality and authenticity purposes.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="signature-verification">
<section id="section-10.1">
        <h3 id="name-signature-verification">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-signature-verification" class="section-name selfRef">Signature Verification</a>
        </h3>
<p id="section-10.1-1">In many contexts, an OpenPGP signature is verified to prove the origin and integrity of an underlying object.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">When <code>sop</code> checks a signature (e.g. via <code>sop verify</code> or <code>sop decrypt --verify-with</code>), it MUST NOT consider it to be verified unless all of these conditions are met:<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-3.1">The signature must be made by a signing-capable public key that is present in one of the supplied certificates<a href="#section-10.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-3.2">The certificate and signing subkey must have been created before or at the signature time<a href="#section-10.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-3.3">The certificate and signing subkey must not have been expired at the signature time<a href="#section-10.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-3.4">The certificate and signing subkey must not be revoked with a "hard" revocation<a href="#section-10.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-3.5">If the certificate or signing subkey is revoked with a "soft" revocation, then the signature time must predate the revocation<a href="#section-10.1-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-3.6">The signing subkey must be properly bound to the primary key, and cross-signed<a href="#section-10.1-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-3.7">The signature (and any dependent signature, such as the cross-sig or subkey binding signatures) must be made with strong cryptographic algorithms (e.g., not <code>MD5</code> or a 1024-bit <code>RSA</code> key)<a href="#section-10.1-3.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.1-4">Implementers MAY also consider other factors in addition to the origin and authenticity, including application-specific information.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1-5">For example, consider the application domain of checking software updates.
If software package Foo version 13.3.2 was signed on 2019-10-04, and the user receives a copy of Foo version 12.4.8 that was signed on 2019-10-16, it may be authentic and have a more recent signature date.
But it is not an upgrade (12.4.8 &lt; 13.3.2), and therefore it should not be applied automatically.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1-6">In such cases, it is critical that the application confirms that the other information verified is <em>also</em> protected by the relevant OpenPGP signature.<a href="#section-10.1-6" class="pilcrow">¶</a></p>
<p id="section-10.1-7">Signature validity is a complex topic (see for example the discussion at <span>[<a href="#DISPLAYING-SIGNATURES" class="xref">DISPLAYING-SIGNATURES</a>]</span>), and this documentation cannot list all possible details.<a href="#section-10.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression">
<section id="section-10.2">
        <h3 id="name-compression">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-compression" class="section-name selfRef">Compression</a>
        </h3>
<p id="section-10.2-1">The interface as currently specified does not allow for control of compression.
Compressing and encrypting data that may contain both attacker-supplied material and sensitive material could leak information about the sensitive material (see the CRIME attack).<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">Unless an application knows for sure that no attacker-supplied material is present in the input, it should not compress during encryption.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-11-1">Material produced by <code>sop encrypt</code> may be placed on an untrusted machine (e.g., sent through the public <code>SMTP</code> network).
That material may contain metadata that leaks associational information (e.g., recipient identifiers in PKESK packets (section 5.1 of <span>[<a href="#I-D.ietf-openpgp-rfc4880bis" class="xref">I-D.ietf-openpgp-rfc4880bis</a>]</span>)).
FIXME: document things like PURBs and <code>--hidden-recipient</code>)<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="object-security-vs-transport-security">
<section id="section-11.1">
        <h3 id="name-object-security-vs-transpor">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-object-security-vs-transpor" class="section-name selfRef">Object Security vs. Transport Security</a>
        </h3>
<p id="section-11.1-1">OpenPGP offers an object security model, but says little to nothing about how the secured objects get to the relevant parties.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">When sending or receiving OpenPGP material, the implementer should consider what privacy leakage is implicit with the transport.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="document-considerations">
<section id="section-12">
      <h2 id="name-document-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-document-considerations" class="section-name selfRef">Document Considerations</a>
      </h2>
<p id="section-12-1">[ RFC Editor: please remove this section before publication ]<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">This document is currently edited as markdown.
Minor editorial changes can be suggested via merge requests at https://gitlab.com/dkg/openpgp-stateless-cli or by e-mail to the authors.
Please direct all significant commentary to the public IETF OpenPGP mailing list: openpgp@ietf.org<a href="#section-12-2" class="pilcrow">¶</a></p>
<div id="document-history">
<section id="section-12.1">
        <h3 id="name-document-history">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
        </h3>
<p id="section-12.1-1">substantive changes between -02 and -03:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-2.1">Added <code>--micalg-out</code> parameter to <code>sign</code><a href="#section-12.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-2.2">Change from <code>KEY</code> to <code>KEYS</code> (permit multiple secret keys in each blob)<a href="#section-12.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-2.3">New error code: <code>KEY_CANNOT_SIGN</code><a href="#section-12.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-2.4">
            <code>version</code> now has <code>--backend</code> and <code>--extended</code> options<a href="#section-12.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-12.1-3">substantive changes between -01 and -02:<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-4.1">Added mnemonics for return codes<a href="#section-12.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.2">
            <code>decrypt</code> should fail when asked to output to a pre-existing file<a href="#section-12.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.3">Removed superfluous <code>--armor</code> option<a href="#section-12.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.4">Much more specific about what <code>armor --label=auto</code> should do<a href="#section-12.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.5">
            <code>armor</code> and <code>dearmor</code> are now fully idempotent, but work only well-formed OpenPGP streams<a href="#section-12.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.6">Dropped <code>armor --allow-nested</code><a href="#section-12.1-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.7">Specified what <code>encrypt --as=</code> means<a href="#section-12.1-4.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.8">New error code: <code>KEY_IS_PROTECTED</code><a href="#section-12.1-4.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.9">Documented expectations around human-readable, human-transferable passwords<a href="#section-12.1-4.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.10">New subcommand: <code>detach-inband-signature-and-message</code><a href="#section-12.1-4.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-4.11">More specific guidance about special designators like <code>@FD:</code> and <code>@ENV:</code>, including new error codes <code>UNSUPPORTED_SPECIAL_PREFIX</code> and <code>AMBIGUOUS_INPUT</code><a href="#section-12.1-4.11" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-12.1-5">substantive changes between -00 and -01:<a href="#section-12.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-6.1">Changed <code>generate</code> subcommand to <code>generate-key</code><a href="#section-12.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.2">Changed <code>convert</code> subcommand to <code>extract-cert</code><a href="#section-12.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.3">Added "Input String Types" section as distinct from indirect I/O<a href="#section-12.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.4">Made implicit arguments potentially explicit (e.g. <code>sop armor --label=auto</code>)<a href="#section-12.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.5">Added <code>--allow-nested</code> to <code>sop armor</code> to make it idempotent by default<a href="#section-12.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.6">Added fingerprint of signing (sub)key to <code>VERIFICATIONS</code> output<a href="#section-12.1-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.7">Dropped <code>--mode</code> and <code>--session-key</code> arguments for <code>sop encrypt</code> (no plausible use, not needed for interop)<a href="#section-12.1-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.8">Added <code>--with-session-key</code> argument to <code>sop decrypt</code> to allow for session-key-based decryption<a href="#section-12.1-6.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.9">Added examples to each subcommand<a href="#section-12.1-6.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.10">More detailed error codes for <code>sop encrypt</code><a href="#section-12.1-6.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.1-6.11">Move from <code>CERT</code> to <code>CERTS</code> (each <code>CERTS</code> argument might contain multiple certificates)<a href="#section-12.1-6.11" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="future-work">
<section id="section-12.2">
        <h3 id="name-future-work">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-future-work" class="section-name selfRef">Future Work</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-12.2-1.1">
            <p id="section-12.2-1.1.1">certificate transformation into popular publication forms:<a href="#section-12.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-1.1.2.1">WKD<a href="#section-12.2-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2-1.1.2.2">DANE OPENPGPKEY<a href="#section-12.2-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-12.2-1.1.2.3">Autocrypt<a href="#section-12.2-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-12.2-1.2">
            <code>sop encrypt</code> - specify compression? (see <a href="#compression" class="xref">Section 10.2</a>)<a href="#section-12.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.3">
            <code>sop encrypt</code> - specify padding policy/mechanism?<a href="#section-12.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.4">
            <code>sop decrypt</code> - how can it more safely handle zip bombs?<a href="#section-12.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.5">
            <code>sop decrypt</code> - what should it do when encountering weakly-encrypted (or unencrypted) input?<a href="#section-12.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.6">
            <code>sop encrypt</code> - minimize metadata (e.g. <code>--throw-keyids</code>)?<a href="#section-12.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.7">handling secret keys that are locked with passwords?<a href="#section-12.2-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.8">specify an error if a <code>DATE</code> arrives as input without a time zone?<a href="#section-12.2-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.9">add considerations about what it means for armored <code>CERTS</code> to contain multiple certificates - multiple armorings?  one big blob?<a href="#section-12.2-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.10">do we need an interface or option (for performance?) with the semantics that <code>sop</code> doesn't validate certificates internally, it just accepts whatever's given as legit data? (see <a href="#cert-validity-performance" class="xref">Section 8.6</a>)<a href="#section-12.2-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.11">do we need to be able to assemble a clearsigned message? I'd rather not, given the additional complications.<a href="#section-12.2-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.2-1.12">does <code>detach-inband-signature-and-message</code> need to be able to split an OpenPGP signed message that <em>isn't</em> using the clearsigned framework (e.g., the output of <code>gpg --sign</code>, in addition to handling <code>gpg --clearsign</code>)?<a href="#section-12.2-1.12" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-13">
      <h2 id="name-acknowledgements">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-13-1">This work was inspired by Justus Winter's <span>[<a href="#OpenPGP-Interoperability-Test-Suite" class="xref">OpenPGP-Interoperability-Test-Suite</a>]</span>.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">The following people contributed helpful feedback and considerations to this draft, but are not responsible for its problems:<a href="#section-13-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-3.1">Allan Nordhoey<a href="#section-13-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-3.2">Antoine Beaupre<a href="#section-13-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-3.3">Edwin Taylor<a href="#section-13-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-3.4">Jameson Rollins<a href="#section-13-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-3.5">Justus Winter<a href="#section-13-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-3.6">Paul Schaub<a href="#section-13-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-3.7">Vincent Breitmoser<a href="#section-13-3.7" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-openpgp-rfc4880bis">[I-D.ietf-openpgp-rfc4880bis]</dt>
        <dd>
<span class="refAuthor">Koch, W.</span>, <span class="refAuthor">carlson, B. M.</span>, <span class="refAuthor">Tse, R. H.</span>, <span class="refAuthor">Atkins, D.</span>, and <span class="refAuthor">D. K. Gillmor</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-openpgp-rfc4880bis-10</span>, <time datetime="2020-08-31" class="refDate">31 August 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-openpgp-rfc4880bis-10.txt">https://www.ietf.org/archive/id/draft-ietf-openpgp-rfc4880bis-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3156">[RFC3156]</dt>
        <dd>
<span class="refAuthor">Elkins, M.</span>, <span class="refAuthor">Del Torto, D.</span>, <span class="refAuthor">Levien, R.</span>, and <span class="refAuthor">T. Roessler</span>, <span class="refTitle">"MIME Security with OpenPGP"</span>, <span class="seriesInfo">RFC 3156</span>, <span class="seriesInfo">DOI 10.17487/RFC3156</span>, <time datetime="2001-08" class="refDate">August 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3156">https://www.rfc-editor.org/info/rfc3156</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4880">[RFC4880]</dt>
        <dd>
<span class="refAuthor">Callas, J.</span>, <span class="refAuthor">Donnerhacke, L.</span>, <span class="refAuthor">Finney, H.</span>, <span class="refAuthor">Shaw, D.</span>, and <span class="refAuthor">R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 4880</span>, <span class="seriesInfo">DOI 10.17487/RFC4880</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4880">https://www.rfc-editor.org/info/rfc4880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Charset-Switching">[Charset-Switching]</dt>
        <dd>
<span class="refAuthor">Gillmor, D.K.</span>, <span class="refTitle">"Inline PGP Considered Harmful"</span>, <time datetime="2014-02-24" class="refDate">24 February 2014</time>, <span>&lt;<a href="https://dkg.fifthhorseman.net/notes/inline-pgp-harmful/">https://dkg.fifthhorseman.net/notes/inline-pgp-harmful/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DISPLAYING-SIGNATURES">[DISPLAYING-SIGNATURES]</dt>
        <dd>
<span class="refAuthor">Brunschwig, P.</span>, <span class="refTitle">"On Displaying Signatures"</span>, <span>n.d.</span>, <span>&lt;<a href="https://admin.hostpoint.ch/pipermail/enigmail-users_enigmail.net/2017-November/004683.html">https://admin.hostpoint.ch/pipermail/enigmail-users_enigmail.net/2017-November/004683.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EFAIL">[EFAIL]</dt>
        <dd>
<span class="refAuthor">Poddebniak, D.</span> and <span class="refAuthor">C. Dresen</span>, <span class="refTitle">"Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels"</span>, <span>n.d.</span>, <span>&lt;<a href="https://efail.de">https://efail.de</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-bre-openpgp-samples-01">[I-D.draft-bre-openpgp-samples-01]</dt>
        <dd>
<span class="refAuthor">Einarsson, B. R.</span>, <span class="refAuthor">"juga"</span>, and <span class="refAuthor">D. K. Gillmor</span>, <span class="refTitle">"OpenPGP Example Keys and Certificates"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bre-openpgp-samples-01</span>, <time datetime="2019-12-20" class="refDate">20 December 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-bre-openpgp-samples-01.txt">https://www.ietf.org/archive/id/draft-bre-openpgp-samples-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenPGP-Interoperability-Test-Suite">[OpenPGP-Interoperability-Test-Suite]</dt>
        <dd>
<span class="refTitle">"OpenPGP Interoperability Test Suite"</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://tests.sequoia-pgp.org/">https://tests.sequoia-pgp.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PYTHON-SOP">[PYTHON-SOP]</dt>
        <dd>
<span class="refAuthor">Gillmor, D.</span>, <span class="refTitle">"SOP for python"</span>, <span>n.d.</span>, <span>&lt;<a href="https://pypi.org/project/sop/">https://pypi.org/project/sop/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0959">[RFC0959]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span> and <span class="refAuthor">J. Reynolds</span>, <span class="refTitle">"File Transfer Protocol"</span>, <span class="seriesInfo">STD 9</span>, <span class="seriesInfo">RFC 959</span>, <span class="seriesInfo">DOI 10.17487/RFC0959</span>, <time datetime="1985-10" class="refDate">October 1985</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc959">https://www.rfc-editor.org/info/rfc959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5321">[RFC5321]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Simple Mail Transfer Protocol"</span>, <span class="seriesInfo">RFC 5321</span>, <span class="seriesInfo">DOI 10.17487/RFC5321</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5321">https://www.rfc-editor.org/info/rfc5321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RUST-SOP">[RUST-SOP]</dt>
        <dd>
<span class="refAuthor">Winter, J.</span>, <span class="refTitle">"A Rust implementation of the Stateless OpenPGP Protocol"</span>, <span>n.d.</span>, <span>&lt;<a href="https://sequoia-pgp.gitlab.io/sop-rs/">https://sequoia-pgp.gitlab.io/sop-rs/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEMVER">[SEMVER]</dt>
        <dd>
<span class="refAuthor">Preston-Werner, T.</span>, <span class="refTitle">"Semantic Versioning 2.0.0"</span>, <time datetime="2013-06-18" class="refDate">18 June 2013</time>, <span>&lt;<a href="https://semver.org/">https://semver.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SOP-JAVA">[SOP-JAVA]</dt>
        <dd>
<span class="refAuthor">Schaub, P.</span>, <span class="refTitle">"Stateless OpenPGP Protocol for Java."</span>, <span>n.d.</span>, <span>&lt;<a href="https://github.com/pgpainless/pgpainless/tree/master/sop-java">https://github.com/pgpainless/pgpainless/tree/master/sop-java</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UNICODE-NORMALIZATION">[UNICODE-NORMALIZATION]</dt>
      <dd>
<span class="refAuthor">Whistler, K.</span>, <span class="refTitle">"Unicode Normalization Forms"</span>, <time datetime="2019-02-04" class="refDate">4 February 2019</time>, <span>&lt;<a href="https://unicode.org/reports/tr15/">https://unicode.org/reports/tr15/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Kahn Gillmor</span></div>
<div dir="auto" class="left"><span class="org">American Civil Liberties Union</span></div>
<div dir="auto" class="left"><span class="street-address">125 Broad St.</span></div>
<div dir="auto" class="left">
<span class="locality">New York, NY</span>,  <span class="postal-code">10004</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dkg@fifthhorseman.net" class="email">dkg@fifthhorseman.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
