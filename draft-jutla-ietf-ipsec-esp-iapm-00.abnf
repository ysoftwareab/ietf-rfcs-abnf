checksum = P[1] xor P[2] xor ... xor P[m-1]
r= M[0]
checksum = P[1] xor P[2] xor ... xor P[m-1]
Integrity = (P[m] == checksum)

a= Encrypt(K0,r+1)
b= Encrypt(K0,r+2)
checksum = P[1] + P[2] + ... + P[m-1]
r= C[0]
checksum = P[1] + P[2] + ... + P[m-1]
Integrity = (P[m] == checksum)

a= Encrypt(K0,r+1)
