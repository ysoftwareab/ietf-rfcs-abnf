



Network Working Group                                          G. Mirsky
Internet-Draft                                                 ZTE Corp.
Updates: 5357, 7750 (if approved)                        S.  Baillargeon
Intended status: Standards Track                                Ericsson
Expires: August 25, 2017                               February 21, 2017


  Control and Monitoring Differentiated Service Code Point in Two-Way
                  Active Measurement Protocol (TWAMP)
               draft-bailmir-ippm-twamp-dscp-ctrl-mon-02

Abstract

   This document describes an optional extension for Two-Way Active
   Measurement Protocol (TWAMP) allowing control and monitoring of the
   Differentiated Service Code Point (DSCP) field in forward and reverse
   directions within single test session with the TWAMP-Test protocol.
   This document, if accepted, will be an update to the TWAMP core
   protocol specified in RFC 5357 and DSCP Monitoring mode defined in
   RFC 7750 .

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 25, 2017.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Mirsky &  Baillargeon    Expires August 25, 2017                [Page 1]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Conventions used in this document . . . . . . . . . . . .   3
       1.1.1.  Terminology . . . . . . . . . . . . . . . . . . . . .   3
       1.1.2.  Requirements Language . . . . . . . . . . . . . . . .   3
   2.  TWAMP Extensions  . . . . . . . . . . . . . . . . . . . . . .   3
     2.1.  Setting Up Connection to Test DSCP and ECN  . . . . . . .   4
     2.2.  TWAMP-Test Extension  . . . . . . . . . . . . . . . . . .   4
       2.2.1.  Session-Sender Packet Format for DSCP and ECN Testing   4
       2.2.2.  Combining DSCP and ECN Testing and Monitoring
               extensions  . . . . . . . . . . . . . . . . . . . . .   6
       2.2.3.  DSCP and ECN Testing with RFC 6038 extensions . . . .   6
       2.2.4.  Consideration for TWAMP Light mode  . . . . . . . . .   7
   3.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   5.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   8
   6.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     6.1.  Normative References  . . . . . . . . . . . . . . . . . .   8
     6.2.  Informative References  . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   The One-Way Active Measurement Protocol (OWAMP) [RFC4656] defines the
   Type-P Descriptor field and negotiation of its value in OWAMP-Control
   protocol.  The Two-Way Active Measurement Protocol (TWAMP) [RFC5357]
   states that only a Differentiated Services Code Point (DSCP)
   [RFC2474], [RFC3168], [RFC3260] value can be defined by Type-P
   Descriptor and the negotiated value must be used by both Session-
   Sender and Session-Reflector.  The TWAMP specification also states
   that the same DSCP value (found in the Session-Sender packet) MUST be
   used in the test packet reflected by the Session-Reflector.  The
   [RFC7750] introduced optional DSCP Monitoring mode that can be
   negotiated using TWAMP Control protocol and supported by TWAMP-Test
   protocol or by TWAMP Light mode.  Still the TWAMP-Test protocol does
   not support discovery of how Differentiated Services policies
   configured along the IP path process various DSCP values in single
   test session.  Hence method defined in [RFC7750] can be characterized
   as per-session DSCP Monitoring.  To provide higher efficiency and
   flexibility to monitoring how Differentiated Services policies being
   applied this document proposes ability to control DSCP value to be




Mirsky &  Baillargeon    Expires August 25, 2017                [Page 2]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


   used by Session-Reflector for each TWAMP-Test packet.  Such method
   can be characterized as per-packet DSCP monitoring with TWAMP.

   This document describes an OPTIONAL feature for TWAMP.  It is called
   the DSCP and ECN Testing.  It allows the Session-Sender to use set of
   DSCP values through single test session and to instruct the Session-
   Reflector on what DSCP value it must use for the reflected test
   packet.  Furthermore this feature tracks the Explicit Congestion
   Notification (ECN) [RFC2474], [RFC3168], [RFC3260] value received at
   the Session-Reflector.  This is helpful to determine if ECN is
   actually operating or if an ECN-capable node has detected congestion
   in the forward direction.

1.1.  Conventions used in this document

1.1.1.  Terminology

   DSCP: Differentiated Services Code Point

   ECN: Explicit Congestion Notification

   IPPM: IP Performance Metrics

   TWAMP: Two-Way Active Measurement Protocol

   OWAMP: One-Way Active Measurement Protocol

1.1.2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [RFC2119].

2.  TWAMP Extensions

   TWAMP connection establishment follows the procedure defined in
   Section 3.1 of [RFC4656] and Section 3.1 of [RFC5357] where the Modes
   field is used to identify and select specific communication
   capabilities.  At the same time the Modes field been recognized and
   used as an extension mechanism [RFC6038].  The new feature requires a
   new flag to identify the ability of a Session-Reflector to support
   the new Session-Sender packet format in the TWAMP-Test protocol and
   to use received DSCP and ECN values in the reflected to a Session-
   Sender test packet, See the Section 3 for details on the assigned bit
   position.





Mirsky &  Baillargeon    Expires August 25, 2017                [Page 3]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


2.1.  Setting Up Connection to Test DSCP and ECN

   The Server sets the DSCP and ECN Testing flag in the Modes field of
   the Server Greeting message to indicate its capabilities and
   willingness to monitor them.  If the Control-Client agrees to test
   DSCP and ECN on some or all test sessions invoked with this control
   connection, it MUST set the DSCP and ECN Testing flag in the Modes
   field in the Setup Response message.

2.2.  TWAMP-Test Extension

   Testing of DSCP and ECN requires support by the Session-Sender and
   changes the test packet format in all the original (unauthenticated,
   authenticated and encrypted) modes.  Testing of DSCP and ECN does not
   alter the Session-Reflector test packet format but certain
   considerations must be taken when and if this mode is accepted in
   combination with Symmetrical Size mode [RFC6038] and/or with DSCP and
   ECN Monitoring mode [RFC7750].

2.2.1.  Session-Sender Packet Format for DSCP and ECN Testing

   When the Session-Sender supports DSCP and ECN Testing it constructs
   the Reflector DSCP and ECN (R-DSCP-ECN) field, presented in Figure 1,
   for each test packet it sends to Session-Reflector according to the
   following procedure:

   o  value of the Reflector DSCP (R-DSCP) field MUST be set to the
      value that the Session-Reflector MUST use for the reflected test
      packet;

   o  value of the Reflector ECN (R-ECN) field MUST be set to the value
      that the Session-Reflector MAY use for the reflected test packet.

   When the Session-Reflector supports DSCP and ECN Testing mode it uses
   R-DSCP-ECN field of the received test packet to construct the
   reflected test packet according to the following procedure

   o  the R-DSCP field MUST be used as six (least-significant) bits of
      the Differentiated Service field of the reflected test packet;

   o  the R-ECN field MAY be used as the two bits of the ECN field of
      the reflected test packet.









Mirsky &  Baillargeon    Expires August 25, 2017                [Page 4]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


      0   1   2   3   4   5   6   7
    +---+---+---+---+---+---+---+---+
    |         R-DSCP        | R-ECN |
    +---+---+---+---+---+---+---+---+

                Figure 1: Sender DSCP and ECN field format

   Formats of the test packet transmitted by the Session-Sender in
   unauthenticated, authenticated and encrypted modes been defined in
   Section 4.1.2 [RFC4656].  For the Session-Sender that supports DSCP
   and ECN Testing these formats are displayed in Figure 2 and Figure 3.

   For unauthenticated mode:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                  Sequence Number                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          Timestamp                          |
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       Error Estimate        |  R-DSCP-ECN   |               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +
    |                                                             |
    ~                        Packet Padding                       ~
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Figure 2: Session-Sender test packet format with DSCP and ECN Testing
                          in unauthenticated mode

   Neither Session-Reflector, nor Session-Sender in the DSCP and ECN
   Testing mode analyze, nor act on ECN value of the received TWAMP test
   packet and therefore ignore congestion indications from the network.
   It is expected that sending rates are low enough, as TWAMP deployment
   experience had demonstrated since TWAMP base RFC 5357 publication in
   2008, that ignoring these congestion indications will not
   significantly contribute to network congestion.

   For authenticated and encrypted modes:










Mirsky &  Baillargeon    Expires August 25, 2017                [Page 5]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Sequence Number                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                             |
    |                     MBZ (12 octets)                         |
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       Timestamp                             |
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       Error Estimate        |  R-DSCP-ECN   |               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +
    |                        MBZ (5 octets)                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                             |
    |                      HMAC (16 octets)                       |
    |                                                             |
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                             |
    ~                     Packet Padding                          ~
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Figure 3: Session-Sender test packet format with DSCP and ECN Testing
                    in authenticated or encrypted modes

2.2.2.  Combining DSCP and ECN Testing and Monitoring extensions

   [RFC7750] defined DSCP and ECN Monitoring extension.  Using testing
   and monitoring modes in the same test session allows test DSCP in
   forward and reverse directions because Session-Reflector returns
   received DSCP and ECN values in S-DSCP-ECN field in the reflected
   test packet.

2.2.3.  DSCP and ECN Testing with RFC 6038 extensions

   [RFC6038] defined two extensions to TWAMP.  First, to ensure that
   Session-Sender and Session-Reflector exchange TWAMP-Test packets of
   equal size.  Second, to specify number of octets to be reflected by
   Session-Reflector.  If DSCP and ECN Testing and Symmetrical Size and/
   or Reflects Octets modes are being negotiated between Server and
   Control-Client in Unauthenticated mode, then, because R-DSCP-ECN
   field increases size of unauthenticated Session-Sender packet by 4
   octets, the Padding Length value SHOULD be >= 26 octets to allow for




Mirsky &  Baillargeon    Expires August 25, 2017                [Page 6]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


   the truncation process that TWAMP recommends in Section 4.2.1 of
   [RFC5357].

   If DSCP and ECN Testing mode to be used in combination with
   Symmetrical Size [RFC6038] and DSCP and ECN Monitoring [RFC7750]
   modes, then the Padding Length value SHOULD be >= 27 octets to allow
   the truncation process that TWAMP recommends in Section 4.2.1 of
   [RFC5357].

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Sequence Number                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          Timestamp                          |
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       Error Estimate        |  R-DSCP-ECN   |               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +
    |                                                             |
    |                       MBZ (26 octets)                       |
    |                                                             |
    +             +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |             |                                               |
    +-+-+-+-+-+-+-+                                               +
    |                                                             |
    .                                                             .
    .                        Packet Padding                       .
    |                                                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Figure 4: Session-Sender test packet format with DSCP and ECN Testing
            and Symmetrical Test Packet in unauthenticated mode

2.2.4.  Consideration for TWAMP Light mode

   Appendix I of [RFC5357] does not explicitly state how the value of
   the Type-P Descriptor is synchronized between Session-Sender and
   Session-Reflector and whether different values are considered as
   error condition and should be reported.

   In order to test DSCP over round-trip path between Session-Sender and
   Session-Reflector it is sufficient that Session-Reflector uses
   received DSCP value for the reflected test packet.  If the Session-
   Reflector supports both testing and monitoring of DSCP, then TWAMP
   Light mode MAY be used to test DSCP in forward and reverse
   directions.




Mirsky &  Baillargeon    Expires August 25, 2017                [Page 7]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


3.  IANA Considerations

   The TWAMP-Modes registry defined in [RFC5618].

   IANA is requested to reserve a new DSCP and ECN Testing Capability as
   follows:

   +-----+-----------------------+----------------------+--------------+
   | Bit | Description           | Semantics Definition | Reference    |
   +-----+-----------------------+----------------------+--------------+
   | TBA | DSCP and ECN Testing  | Section 2            | This         |
   |     | Capability            |                      | document     |
   +-----+-----------------------+----------------------+--------------+

             Table 1: New Type-P Descriptor Testing Capability

4.  Security Considerations

   Testing of DSCP and ECN does not appear to introduce any additional
   security threat to hosts that communicate with TWAMP as defined in
   [RFC5357], and existing extensions [RFC6038].  Sections such as 3.2,
   4., 4.1.2, 4.2, and 4.2.1 of [RFC5357] discuss unauthenticated,
   authenticated, and encrypted modes in varying degrees of detail.  The
   security considerations that apply to any active measurement of live
   networks are relevant here as well.  See the Security Considerations
   sections in [RFC4656], [RFC5357], and [RFC7750].

5.  Acknowledgments

   TBD

6.  References

6.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC2474]  Nichols, K., Blake, S., Baker, F., and D. Black,
              "Definition of the Differentiated Services Field (DS
              Field) in the IPv4 and IPv6 Headers", RFC 2474,
              DOI 10.17487/RFC2474, December 1998,
              <http://www.rfc-editor.org/info/rfc2474>.






Mirsky &  Baillargeon    Expires August 25, 2017                [Page 8]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


   [RFC3168]  Ramakrishnan, K., Floyd, S., and D. Black, "The Addition
              of Explicit Congestion Notification (ECN) to IP",
              RFC 3168, DOI 10.17487/RFC3168, September 2001,
              <http://www.rfc-editor.org/info/rfc3168>.

   [RFC4656]  Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M.
              Zekauskas, "A One-way Active Measurement Protocol
              (OWAMP)", RFC 4656, DOI 10.17487/RFC4656, September 2006,
              <http://www.rfc-editor.org/info/rfc4656>.

   [RFC5357]  Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J.
              Babiarz, "A Two-Way Active Measurement Protocol (TWAMP)",
              RFC 5357, DOI 10.17487/RFC5357, October 2008,
              <http://www.rfc-editor.org/info/rfc5357>.

   [RFC5618]  Morton, A. and K. Hedayat, "Mixed Security Mode for the
              Two-Way Active Measurement Protocol (TWAMP)", RFC 5618,
              DOI 10.17487/RFC5618, August 2009,
              <http://www.rfc-editor.org/info/rfc5618>.

   [RFC6038]  Morton, A. and L. Ciavattone, "Two-Way Active Measurement
              Protocol (TWAMP) Reflect Octets and Symmetrical Size
              Features", RFC 6038, DOI 10.17487/RFC6038, October 2010,
              <http://www.rfc-editor.org/info/rfc6038>.

   [RFC7750]  Hedin, J., Mirsky, G., and S. Baillargeon, "Differentiated
              Service Code Point and Explicit Congestion Notification
              Monitoring in the Two-Way Active Measurement Protocol
              (TWAMP)", RFC 7750, DOI 10.17487/RFC7750, February 2016,
              <http://www.rfc-editor.org/info/rfc7750>.

6.2.  Informative References

   [RFC3260]  Grossman, D., "New Terminology and Clarifications for
              Diffserv", RFC 3260, DOI 10.17487/RFC3260, April 2002,
              <http://www.rfc-editor.org/info/rfc3260>.

Authors' Addresses

   Greg Mirsky
   ZTE Corp.

   Email: gregimirsky@gmail.com








Mirsky &  Baillargeon    Expires August 25, 2017                [Page 9]

Internet-Draft      Control and Monitor DSCP in TWAMP      February 2017


   Steve  Baillargeon
   Ericsson

   Email: steve.baillargeon@ericsson.com















































Mirsky &  Baillargeon    Expires August 25, 2017               [Page 10]
