accept = application/oblivious-dns-message
cache-control = no-cache, no-store
content-type = application/oblivious-dns-message
content-length = 106

accept = application/oblivious-dns-message
cache-control = no-cache, no-store
content-type = application/oblivious-dns-message
content-length = 106

content-type = application/oblivious-dns-message
content-length = 154

aad = 0x01 || len(key_id) || key_id
ct = context.Seal(aad, Q_plain)
Q_encrypted = enc || ct
aad = 0x02 || len(response_nonce) || response_nonce
context = SetupBaseR(enc, skR, "odoh query")
aad = 0x01 || len(key_id) || key_id
secret = context.Export("odoh response", Nk)
salt = Q_plain || len(response_nonce) || response_nonce
prk = Extract(salt, secret)
key = Expand(odoh_prk, "odoh key", Nk)
nonce = Expand(odoh_prk, "odoh nonce", Nn)
aad = 0x02 || len(response_nonce) || response_nonce
R_encrypted = Seal(aead_key, aead_nonce, aad, R_plain)
