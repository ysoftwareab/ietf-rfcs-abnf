<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IPv6 Inverse Neighbor Discovery Update</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IPv6 Inverse Neighbor Discovery Update">
<meta name="keywords" content="Inverse Neighbor Discovery">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">P. Thubert, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">E. Levy-Abegnoli</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc3122'>3122</a> (if&nbsp;approved)</td><td class="header">Cisco</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">February 27, 2009</td></tr>
<tr><td class="header">Expires: August 31, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />IPv6 Inverse Neighbor Discovery Update<br />draft-thubert-3122bis-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 31, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This draft updates the Inverse Discovery 
	  Specification [RFC3122] to provide Secure Neighbor Discovery. The behaviour of
	  the protocol is slightly amended to enable an easier management of the addresses
	  on a link and enable Secure ND.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#int">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Requirements Language<br />
<a href="#indm">2.</a>&nbsp;
Inverse Neighbor Discovery Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#indsm">2.1.</a>&nbsp;
Inverse Neighbor Discovery Solicitation Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#indam">2.2.</a>&nbsp;
Inverse Neighbor Discovery Advertisement Message<br />
<a href="#indopt">3.</a>&nbsp;
Inverse Neighbor Discovery Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#indoal">3.1.</a>&nbsp;
Source/Target Address List<br />
<a href="#SeND">4.</a>&nbsp;
Secure Inverse Neighbor Discovery<br />
<a href="#inter">5.</a>&nbsp;
Interface Type and usages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#P2MP">5.1.</a>&nbsp;
Point to Multipoint Networks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#P2P">5.2.</a>&nbsp;
Point-to-Point Links<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transit">5.3.</a>&nbsp;
Broadcast Networks<br />
<a href="#IANA">6.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor2">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="int"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This draft updates the <a class='info' href='#RFC3122'>Inverse Neighbor Discovery 
	  Specification<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> [RFC3122].  Any behaviour 
	  or format that is not explicitely changed is preserved. 
</p>
<p>The behaviour of the protocol is slightly amended :
	 </p>
<ul class="text">
<li>Secure Inverse Neighbor Discovery is added for unicast 
	addresses with a 64bit interface ID.
	This specification provides the additional options that are required to sign Inverse
	ND messages with the properties that are defined in <a class='info' href='#RFC3971'>[RFC3971]<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a> and 
	details how they may be used to prove the ownership of advertised addresses. 
	
</li>
<li>Fragmentation of ND messages is accepted but not required. <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a>
	requires the use of multiple Advertisement messages when the Target Address List 
	does not fit within MTU. With this specification, it is acceptable to fragment
	a message, but it is still possible to use multiple Advertisement messages,
	which can be necessary in particular in the context of Secure Inverse Neighbor
	Discovery.
	
</li>
<li>
	<a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> does not allow a crisp management of all Addresses
	that a peer may use on an interface. When multiple Advertisement messages are
	used, it is possible to miss one and thus miss some information. With this 
	specification, Address Management is improved in such a way that it is possible 
	to advertise the addition or the deletion of a single address
	and to get the exhaustive list of all the addresses that a neighbor might use
	to source packets on an interface.
	
</li>
<li>With IPv4, Inverse ARP is traditionally applied to Point to Multipoint 
	networks only. 	<a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> claims to apply to "Frame Relay networks", 
	and "also apply to other networks with similar behavior". This specification
	extends the domain of applicability of Inverse Neighbor Discovery and provides
	some additional information on how and why Inverse ND MAY be used on all types of
	interface. 
	
</li>
<li>Typos such as the length field in the Source/Target Address List are corrected.
	
</li>
</ul><p>
	  
</p>
<p>The concept of transaction is introduced to group multiple messages into
	  a single set to enable the advertisement of the complete list of all
	  addresses used to source packets on on an interface.
	  Whenever possible, a node should use one message per transaction.
</p>
<p>
	  This is problematic when:
	 </p>
<ul class="text">
<li>The list of addresses is so large that it causes the message to be larger than MTU
	and the node can not fragment.
	
</li>
<li>Secure Inverse ND is applied and not all of the addresses are based on a same
	CGA modifier (see <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>).
	
</li>
</ul><p>
	  
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="indm"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Inverse Neighbor Discovery Messages</h3>

<p> This section updates the Inverse Neighbor Discovery Messages defined 
	in  <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> section 2. 
	
</p>
<p> A new field from the ICMP reserved part is used to indicate the version and 
	preserve backward compatibility. Version 0 is <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a>.
	Version 1 is this specification. A node proposes a version in the Inverse Neighbor
	Discovery Solicitation Message and responds with the smallest of its own preferred 
	version and the received proposed version in an Advertisement. 
</p>
<p> Another new field from the ICMP reserved part is used to indicate the Transaction
	ID of a Neighbor Discovery Solicitation Message, in order to correlate multiple
	Advertisement messages that may result from one Solicitation Message.
	When the information about an address is not seen after 2 consecutive advertisement
	of a full List of addresses that address is considered as removed. This decision is 
	made upon the reception of an advertisement with a Transaction ID that is sequentially
	later then the 2 consecutive advertisements.
	
</p>
<a name="indsm"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Inverse Neighbor Discovery Solicitation Message</h3>

<p> The Inverse Neighbor Discovery Solicitation Message can be used to obtain 
	the full list of IPv6 addresses from the remote end of a Point to Point link
	such as a PPP link, a tunnel or a Virtual Channel.
	
</p>
<p> The Inverse Neighbor Discovery Solicitation can also be used as a heartbeat
	mechanism to verify whether a Point to Point link such as a tunnel
	is still up when there is no signal from the lower layers to indicate a
	failure. 
	
</p>
<p> The Inverse Neighbor Discovery Solicitation Message is changed as follows:
	
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Version     | Trans ID      |   Reserved    |F|   Reserved  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Options ...
   +-+-+-+-+-+-+-+-+-+-+-+-


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Modified Inverse Neighbor Discovery Solicitation Message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	This specification adds the following fields:

	</p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd> 8bit field. Inverse Neighbor Discovery Solicitation.
    
</dd>
<dt>Version:</dt>
<dd> 8bit field.
	Version of 0 indicates the support of <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> only.
	Version of 1 indicates the desire to follow this specification 
	and the backward compatibility with version 0.
    
</dd>
<dt>Transaction ID:</dt>
<dd>8bit field.
	The Transaction ID is incremented with each Inverse Neighbor Discovery
	Solicitation Message sent to the same neighbor. The transaction ID
	can not be set to zero so it starts at 1 and wraps from 255 directly to 1.
    
</dd>
<dt>F:</dt>
<dd> 1bit field. 
	The "F" flag indicates a request of the Full List of addresses on the peer
	side of the Link. 
    
</dd>
</dl></blockquote><p>

    
</p>
<a name="indam"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Inverse Neighbor Discovery Advertisement Message</h3>

<p> The Inverse Neighbor Discovery Advertisement Message can be used as a response
	to an Inverse Neighbor Discovery Solicitation Message or asynchronously at any 
	point of time once a first Inverse Neighbor Discovery Solicitation Message 
	 was received indicating that the remote peer supports this specification.
	
</p>
<p>Multiple Inverse Neighbor Discovery Advertisement Messages might be needed
	to report the full list of addresses. Those messages are correlated by a same
	transaction ID.
</p>
<p>An unsolicited Advertisement is used to advertise the
      addition or the deletion of a single address and is contained in a single 
	  Inverse Neighbor Discovery Advertisement Message, with a transaction ID of 0.
	
</p>
<p> The Inverse Neighbor Discovery Advertisement Message is changed as follows:
	
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


	0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Version     | Trans ID      |   Reserved    |F|   Reserved  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Options ...
   +-+-+-+-+-+-+-+-+-+-+-+-


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Modified Inverse Neighbor Discovery Advertisement Message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	This specification adds the following fields:

	</p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd> 8bit field. Inverse Neighbor Discovery Advertisement.
    
</dd>
<dt>Version:</dt>
<dd> 8bit field.
	Version of 0 indicates the support of <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> only.
	Version of 1 indicates the desire to follow this specification. 
	Version can only be set to 1 if the Version in the Solicitation Message was 1 or above.
	 
</dd>
<dt>Transaction ID:</dt>
<dd>8bit field.
	The Transaction ID echoes that of the Inverse Neighbor
	Discovery Solicitation Message that this Message is responding to. 
	The transaction ID zero is used for unsolicited Advertisements.
    
</dd>
<dt>F:</dt>
<dd> 1bit field. 
	The "F" flag indicates that the Full List of addresses will be provided for that
	transaction.  
    
</dd>
</dl></blockquote><p>

    
</p>
<p>
	Upon a request by the remote peer of the Full List of addresses, this node SHOULD
	answer with all the addresses that can be used to reach it over this link in the
	modified Target Address List. 
    
</p>
<p>
	If the IND Solicitation does not request the full list then his node MAY
	answer with all the addresses that can be used to reach it over this link in the
	modified Target Address List.
	
</p>
<a name="indopt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Inverse Neighbor Discovery Options</h3>

<p> This section updates the Inverse Neighbor Discovery Options defined 
	in  <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> section 3.
</p>
<a name="indoal"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Source/Target Address List</h3>

<p> 
	With this specification, the Source/Target Address List may be partial or full. 
	It can be used to indicate addition or deletion of individual addresses.
	This new support can only be used once the first
	Inverse Neighbor Discovery Solicitation Message is received from the remote peer
	indicating the support of this specification. 
    
</p>
<p>Until the Version that is supported by the peer is known, the only 
	Inverse Neighbor Discovery Messages that this node should send are
	Solicitations, and this option if present can only be a Source Address List
	option with a list of addresses that can be used to reach this node over this link.
		
</p>
<p> This specification uses a Length field of 8 bits, assuming that most
	implementations of <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> also use a Length field of 8 bits
	and that the misalignment in section 3.1 is commonly undestood as an undetected typo.
	An error in reading the Length field can be detected when confronting the length
	of the IPv6 packet and the expected length of this option.
</p>
<p>
	The Inverse Neighbor Discovery Advertisement Message is changed as follows:
	
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |    Mode       |               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Reserved                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                        IPv6 Address                           +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                        IPv6 Address                           +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |
   ~
   |
   +-+-+-+-+...



</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Modified Source/Target Address List option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	This specification adds the following fields:

	</p>
<blockquote class="text"><dl>
<dt>Mode</dt>
<dd> 8bit enumeration
	
	
<blockquote class="text"><dl>
<dt>RFC3122:</dt>
<dd>Mode of 0 indicates that the list is built
	conforming to <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a>. All the addresses listed are usable
	but the list might not be complete.
	
</dd>
<dt>Full:</dt>
<dd>Mode of 1 indicates that the list might contain
	addresses that are defined on another interface but may be used
	to source or receive packets over this interface. This is the mode
	that is used to in reply to a Solicitation with the "F" bit set.
	
</dd>
<dt>Added:</dt>
<dd>Mode of 2 indicates that the list is a list of
	recently added addresses but not necessarily part of a full report.
	
</dd>
<dt>Deleted:</dt>
<dd>Mode of 3 indicates that the list is a list of
	recently removed addresses that may no more be used on this link.
	
</dd>
</dl></blockquote>
    
</dd>
</dl></blockquote><p>
    
</p>
<p>Upon receiving an Address List, a node should verify that the addresses in the list
        don't collide with any of its own address. In case it does, the duplicate address received
        in the list will be ignored.
	
</p>
<p>When Secure IND is being used, all the addresses listed in the Target Address 
	List option in one Inverse Neighbor Discovery Advertisement Message must be based
	on the same CGA modifier.
	If multiple modifiers are used or some addresses were not built
	based on CGA, then they must be split in multiple Inverse Neighbor Discovery
	Advertisement Messages.
	
</p>
<a name="SeND"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Secure Inverse Neighbor Discovery</h3>

<p>The list of addresses provided in Source/Target address list can be defended using the CGA
      and the RSA options specified in [RFC3972] and [RFC3971]. However, in the case of Secure
      Inverse Neighbor Discovery, several addresses announced in one message 
	  (IND Solicitation or Advertisement) are
      defended by a single CGA option and a single RSA option. T
	  hat mandates that all addresses in the list are based on CGA 
	  and were computed with the same public key, modifier, 
	  collision count, and the same security parameter sec.  
	  In this case, the CGA option is as following:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                      Modifier (16 octets)                     +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                  Subnet Prefix = 0 (8 octets)                 +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Col.Count = 0  |                                               |
   +-+-+-+-+-+-+-+-+                                               |
   |                                                               |
   ~                  Public Key (variable length)                 ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~           Extension Fields (optional, variable length)        ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>

</p>
<p>Since each address in the list is going to carry its own prefix (/64 if CGA is used),
      the Subnet Prefix in the CGA option is set to zero. Therefore, it should not be checked by the
      receiver  against the prefix (/64 bits) of each CGA address found in the Address List.
</p>
<p>The collision count is always zero, since no Duplicate Address Detection is performed, other
      than the node ignoring peer addresses colliding with one of its own.
</p>
<p>The remaining  of the CGA algorithm, as described in [RFC3972] applies. The 16*Sec leftmost
      bits of Hash2 should equal zero. Hash1 is computed separately for each address in the list,
      using the first 64 bits as the Subnet Prefix, and the interface identifier should match Hash1 
      (except for bits 0, 1, 2, 6, and 7, which encode the collision count and the "u" and "g"
	  bits).
</p>
<p>The RSA option must also be provided in the message, and the signature must verify with
	the public key provided in the CGA option
</p>
<p>In order to protect against replays, Timestamp and Nonce options, should also 
	be used in the message, with similar rules as one described in [RFC3971]. 
	When the message is a solicitation (INS), it should have a nonce option. 
	When the message is sollicited (INA as a response to INS), it should repeat the nonce value
    seen in the solicitation. As far as unsolicited message and solicitation, the timestamp option
	is required.  
    
</p>
<a name="inter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Interface Type and usages</h3>

<p>Because of IPv4 and the ARP legacy, Inverse Neighbor Discovery is usually
	associated to Point to Multipoint (P2MP) or Non-Broadcast Multi-Access (NBMA)
	networks. And certainly, this specification is usable on such networks as
	Frame Relay or Multidrop tunnels. 
</p>
<p>But the similarity with IPv4 is limited and this specification enables a lot
	more: 
</p>
<a name="P2MP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Point to Multipoint Networks</h3>

<p>
	IPv6 Secure Inverse Neighbor Discovery can be applied to P2MP and NBMA
	networks to prevent the theft an address by another Node.
	
</p>
<a name="P2P"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Point-to-Point Links</h3>

<p>As opposed to IPv4, using  Inverse Neighbor Discovery makes a lot of sense
	 on Point-to-Point link such as PPP or tunnels:
	 
</p>
<p>This specification inherits from <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> the support
	of the authentication header to authenticate the remote peer on the link.
	For P2P links, this might prove more relevant than Secure ND itself.
	
</p>
<p>Because IPv6 operates purely at layer 3, the PPP Network Control Protocol for IPv6
	defined in <a class='info' href='#RFC5072'>[RFC5072]<span> (</span><span class='info'>S.Varada, Haskins, D., and E. Allen, &ldquo;IP Version 6 over PPP,&rdquo; September&nbsp;2007.</span><span>)</span></a>  provides a way to negotiate a unique, 64bit
	interface identifier to be used for the address autoconfiguration
	but does not enable to advertise an IPv6 address. This would not fit anyway since
	IPv6 might use many addresses of various lifetimes on a same interface.
	This specification provides the means to create and maintain the list of addresses
	that can be used to reach the remote peer at any point of time.
	
</p>
<p>A number of Denial of Service attacks are documented when using 
	<a class='info' href='#RFC4861'>[RFC4861]<span> (</span><span class='info'>Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;Neighbor Discovery for IP version 6 (IPv6),&rdquo; September&nbsp;2007.</span><span>)</span></a>  by
	sending packets to addresses that are not assigned but belong to a prefix
	that is associated to the P2P link.
	On those links, Inverse Neighbor Discovery enables a proactive model
	that defeats those attacks.	Any packet that is received for a destination
	that is not in the ND table is simply dropped.
</p>
<a name="transit"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Broadcast Networks</h3>

<p>A multihomed host attached to a broadcast network might use an address that
	belongs to another interface on another subnet to source a packet. This makes the
	validation of source addresses very problematic. With this specification, a router
	may solicit the full list of all addreses that this host might use to source packets
	on that interface, and prove the ownership using SeND. The router might then
	accept packets that are sourced off-link and may install a host route to that address.
	
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This draft improves the security model in <a class='info' href='#RFC3122'>[RFC3122]<span> (</span><span class='info'>Conta, A., &ldquo;Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification,&rdquo; June&nbsp;2001.</span><span>)</span></a> by adding the
	  capability to use Secure Neighbor Discovery
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>
	Thanks to Tony Cheneau and Wojciech Dec for useful feedback and discussion.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3122">[RFC3122]</a></td>
<td class="author-text">Conta, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3122">Extensions to IPv6 Neighbor Discovery for Inverse Discovery Specification</a>,&rdquo; RFC&nbsp;3122, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3122.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3971">[RFC3971]</a></td>
<td class="author-text">Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;<a href="http://tools.ietf.org/html/rfc3971">SEcure Neighbor Discovery (SEND)</a>,&rdquo; RFC&nbsp;3971, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3971.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3972">[RFC3972]</a></td>
<td class="author-text">Aura, T., &ldquo;<a href="http://tools.ietf.org/html/rfc3972">Cryptographically Generated Addresses (CGA)</a>,&rdquo; RFC&nbsp;3972, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3972.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4861">[RFC4861]</a></td>
<td class="author-text">Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;<a href="http://tools.ietf.org/html/rfc4861">Neighbor Discovery for IP version 6 (IPv6)</a>,&rdquo; RFC&nbsp;4861, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4861.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2629">[RFC2629]</a></td>
<td class="author-text"><a href="mailto:mrose@not.invisible.net">Rose, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2629">Writing I-Ds and RFCs using XML</a>,&rdquo; RFC&nbsp;2629, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2629.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2629.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2629.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5072">[RFC5072]</a></td>
<td class="author-text">S.Varada, Haskins, D., and E. Allen, &ldquo;<a href="http://tools.ietf.org/html/rfc5072">IP Version 6 over PPP</a>,&rdquo; RFC&nbsp;5072, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5072.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Pascal Thubert (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Village d'Entreprises Green Side</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">400, Avenue de Roumanille</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Batiment T3</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Biot - Sophia Antipolis  06410</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">FRANCE</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33 4 97 23 26 34</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pthubert@cisco.com">pthubert@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Levy-Abegnoli</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Village d'Entreprises Green Side</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">400, Avenue de Roumanille</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Batiment T3</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Biot - Sophia Antipolis  06410</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">FRANCE</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33 4 97 23 26 20</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:elevyabe@cisco.com">elevyabe@cisco.com</a></td></tr>
</table>
</body></html>
