<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Datagram Transport Layer Security (DTLS) over Stream Control Transmission Protocol (SCTP)</title>
<meta content="Magnus Westerlund" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Claudio Porfiri" name="author">
<meta content="Michael Tüxen" name="author">
<meta content="
       This document describes a proposed update for the usage of the
   Datagram Transport Layer Security (DTLS) protocol to protect user
   messages sent over the Stream Control Transmission Protocol (SCTP). 
       DTLS over SCTP provides mutual authentication, confidentiality,
   integrity protection, and replay protection for applications that
   use SCTP as their transport protocol and allows client/server
   applications to communicate in a way that is designed to give
   communications privacy and to prevent eavesdropping and detect
   tampering or message forgery. 
       Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. This document intends
   to obsolete RFC 6083 and removes the 16 kB limitation on user
   message size by defining a secure user message fragmentation so
   that multiple DTLS records can be used to protect a single user
   message. It further updates the DTLS versions to use, as well as
   the HMAC algorithms for SCTP-AUTH, and simplifies the
   implementation by some stricter requirements on the establishment
   procedures. 
    " name="description">
<meta content="xml2rfc 3.7.0" name="generator">
<meta content="draft-ietf-tsvwg-dtls-over-sctp-bis-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 56.0.0
    six 1.15.0
-->
<link href="/tmp/draft-westerlund-tsvwg-dtls-over-sctp-bis-02-btp7desw.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTLS over SCTP</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Westerlund, et al.</td>
<td class="center">Expires 11 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TSVWG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tsvwg-dtls-over-sctp-bis-00</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6083" class="eref">6083</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-10" class="published">10 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-11">11 November 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Westerlund</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">C. Porfiri</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Tüxen</div>
<div class="org">Münster Univ. of Appl. Sciences</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Datagram Transport Layer Security (DTLS) over Stream Control Transmission Protocol (SCTP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a proposed update for the usage of the
   Datagram Transport Layer Security (DTLS) protocol to protect user
   messages sent over the Stream Control Transmission Protocol (SCTP).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">DTLS over SCTP provides mutual authentication, confidentiality,
   integrity protection, and replay protection for applications that
   use SCTP as their transport protocol and allows client/server
   applications to communicate in a way that is designed to give
   communications privacy and to prevent eavesdropping and detect
   tampering or message forgery.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. This document intends
   to obsolete RFC 6083 and removes the 16 kB limitation on user
   message size by defining a secure user message fragmentation so
   that multiple DTLS records can be used to protect a single user
   message. It further updates the DTLS versions to use, as well as
   the HMAC algorithms for SCTP-AUTH, and simplifies the
   implementation by some stricter requirements on the establishment
   procedures.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  TSVWG Working Group mailing list (tsvwg@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tsvwg/">https://mailarchive.ietf.org/arch/browse/tsvwg/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/gloinul/draft-westerlund-tsvwg-dtls-over-sctp-bis">https://github.com/gloinul/draft-westerlund-tsvwg-dtls-over-sctp-bis</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="xref">1.1.1</a>.  <a href="#name-comparison-with-tls-for-sct" class="xref">Comparison with TLS for SCTP</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="xref">1.1.2</a>.  <a href="#name-changes-from-rfc-6083" class="xref">Changes from RFC 6083</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-abbreviations" class="xref">Abbreviations</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-dtls-considerations" class="xref">DTLS Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-version-of-dtls" class="xref">Version of DTLS</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-cipher-suites" class="xref">Cipher Suites</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-message-sizes" class="xref">Message Sizes</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-replay-protection" class="xref">Replay Protection</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-path-mtu-discovery" class="xref">Path MTU Discovery</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-retransmission-of-messages" class="xref">Retransmission of Messages</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-sctp-considerations" class="xref">SCTP Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-mapping-of-dtls-records" class="xref">Mapping of DTLS Records</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-dtls-connection-handling" class="xref">DTLS Connection Handling</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-payload-protocol-identifier" class="xref">Payload Protocol Identifier Usage</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-stream-usage" class="xref">Stream Usage</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-chunk-handling" class="xref">Chunk Handling</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-sctp-auth-hash-function" class="xref">SCTP-AUTH Hash Function</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-renegotiation" class="xref">Renegotiation</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-dtls-epochs" class="xref">DTLS Epochs</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-handling-of-endpoint-pair-s" class="xref">Handling of Endpoint-Pair Shared Secrets</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="xref">4.10</a>. <a href="#name-shutdown" class="xref">Shutdown</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-dtls-over-sctp-service" class="xref">DTLS over SCTP Service</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-adaptation-layer-indication" class="xref">Adaptation Layer Indication in INIT/INIT-ACK</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-dtls-sctp-dtls_over_sctp_ma" class="xref">DTLS/SCTP "dtls_over_sctp_maximum_message_size" Extension</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-dtls-over-sctp-initializati" class="xref">DTLS over SCTP Initialization</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-client-use-case" class="xref">Client Use Case</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-server-use-case" class="xref">Server Use Case</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-rfc-6083-fallback" class="xref">RFC 6083 Fallback</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-tls-exporter-label" class="xref">TLS Exporter Label</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-dtls-dtls_over_sctp_buffer_" class="xref">DTLS "dtls_over_sctp_buffer_size_limit" Extension</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-sctp-parameter" class="xref">SCTP Parameter</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-cryptographic-consideration" class="xref">Cryptographic Considerations</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-downgrade-attacks" class="xref">Downgrade Attacks</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-dtls-sctp-message-sizes" class="xref">DTLS/SCTP Message Sizes</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-authentication-and-policy-d" class="xref">Authentication and Policy Decisions</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-pervasive-monitoring" class="xref">Pervasive Monitoring</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-motivation-for-changes" class="xref">Motivation for Changes</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="overview">
<section id="section-1.1">
        <h3 id="name-overview">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.1-1">This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol, as defined in <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>,
   over the Stream Control Transmission Protocol (SCTP), as defined in
   <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span> with Authenticated Chunks for SCTP (SCTP-AUTH)
   <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This specification provides mutual authentication of endpoints,
   confidentiality, integrity protection, and replay protection of
   user messages for applications that use SCTP as their transport
   protocol.  Thus it allows client/server applications to communicate
   in a way that is designed to give communications privacy and to
   prevent eavesdropping and detect tampering or message
   forgery. DTLS/SCTP uses DTLS for mutual authentication, key
   exchange with perfect forward secrecy for SCTP-AUTH, and
   confidentiality of user messages. DTLS/SCTP use SCTP and SCTP-AUTH
   for integrity protection and replay protection of user messages.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. DTLS/SCTP supports:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">preservation of message boundaries.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">a large number of unidirectional and bidirectional streams.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">ordered and unordered delivery of SCTP user messages.<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.4">the partial reliability extension as defined in <span>[<a href="#RFC3758" class="xref">RFC3758</a>]</span>.<a href="#section-1.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.5">the dynamic address reconfiguration extension as defined in
<span>[<a href="#RFC5061" class="xref">RFC5061</a>]</span>.<a href="#section-1.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.6">large user messages.<a href="#section-1.1-4.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5">The method described in this document requires that the SCTP
   implementation supports the optional feature of fragmentation of
   SCTP user messages as defined in <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>. To efficiently
   implement and support larger user messages it is also recommended
   that I-DATA chunks as defined in <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> as well as an SCTP API
   that supports partial user message delivery as discussed in
   <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span>.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<div id="comparison-with-tls-for-sctp">
<section id="section-1.1.1">
          <h4 id="name-comparison-with-tls-for-sct">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-comparison-with-tls-for-sct" class="section-name selfRef">Comparison with TLS for SCTP</a>
          </h4>
<p id="section-1.1.1-1">TLS, from which DTLS was derived, is designed to run on top of a
byte-stream-oriented transport protocol providing a reliable, in-
sequence delivery. TLS over SCTP as described in <span>[<a href="#RFC3436" class="xref">RFC3436</a>]</span> has
some serious limitations:<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.1-2.1">It does not support the unordered delivery of SCTP user messages.<a href="#section-1.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-2.2">It does not support partial reliability as defined in
   <span>[<a href="#RFC3758" class="xref">RFC3758</a>]</span>.<a href="#section-1.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-2.3">It only supports the usage of the same number of streams in both
 directions.<a href="#section-1.1.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-2.4">It uses a TLS connection for every bidirectional stream, which
 requires a substantial amount of resources and message exchanges
 if a large number of streams is used.<a href="#section-1.1.1-2.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="changes-from-rfc-6083">
<section id="section-1.1.2">
          <h4 id="name-changes-from-rfc-6083">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-changes-from-rfc-6083" class="section-name selfRef">Changes from RFC 6083</a>
          </h4>
<p id="section-1.1.2-1">The DTLS over SCTP solution defined in RFC 6083 had the following
limitation:<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-2.1">The maximum user message size is 2^14 bytes, which is a single
 DTLS record limit.<a href="#section-1.1.2-2.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-1.1.2-3">This update that replaces RFC6083 defines the following changes:<a href="#section-1.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-4.1">Removes the limitations on user messages sizes by defining a
secure fragmentation mechanism.<a href="#section-1.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.2">Defines a DTLS extension for the endpoints to declare the user
message size supported to be received.<a href="#section-1.1.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.3">Mandates that more modern DTLS version are required (DTLS 1.2 or
1.3)<a href="#section-1.1.2-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.4">Mandates use of modern HMAC algorithm (SHA-256) in the SCTP
authentication extension <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-1.1.2-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.5">Recommends support of <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> to enable interleaving of large
SCTP user messages to avoid scheduling issues.<a href="#section-1.1.2-4.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.6">Recommends support of partial message delivery API, see <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span>
if larger usage messages are intended to be used.<a href="#section-1.1.2-4.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.7">Applies stricter requirements on always using DTLS for all user
messages in the SCTP association.<a href="#section-1.1.2-4.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-4.8">Requires that SCTP-AUTH is applied to all SCTP Chunks that can be
authenticated.<a href="#section-1.1.2-4.8" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">This document uses the following terms:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Association:  An SCTP association.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Stream: A unidirectional stream of an SCTP association.  It is uniquely
identified by a stream identifier.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="abbreviations">
<section id="section-1.3">
        <h3 id="name-abbreviations">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<p id="section-1.3-1">DTLS:  Datagram Transport Layer Security<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">MTU:  Maximum Transmission Unit<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">PPID:  Payload Protocol Identifier<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">SCTP:  Stream Control Transmission Protocol<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5">TCP:  Transmission Control Protocol<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">TLS:  Transport Layer Security<a href="#section-1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
   capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-considerations">
<section id="section-3">
      <h2 id="name-dtls-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dtls-considerations" class="section-name selfRef">DTLS Considerations</a>
      </h2>
<div id="version-of-dtls">
<section id="section-3.1">
        <h3 id="name-version-of-dtls">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-version-of-dtls" class="section-name selfRef">Version of DTLS</a>
        </h3>
<p id="section-3.1-1">This document is based on DTLS 1.3 <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>, but
   works also for DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>. Earlier versions of DTLS MUST
   NOT be used. It is expected that DTLS/SCTP as described in this
   document will work with future versions of DTLS.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cipher-suites">
<section id="section-3.2">
        <h3 id="name-cipher-suites">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cipher-suites" class="section-name selfRef">Cipher Suites</a>
        </h3>
<p id="section-3.2-1">For DTLS 1.2, the cipher suites forbidden by <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span> MUST NOT
   be used. Cipher suites without encryption MUST NOT be used.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Msg-size">
<section id="section-3.3">
        <h3 id="name-message-sizes">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-message-sizes" class="section-name selfRef">Message Sizes</a>
        </h3>
<p id="section-3.3-1">DTLS/SCTP, automatically fragments and reassembles user
   messages. This specification defines how to fragment the user
   messages into DTLS records, where each DTLS 1.3 record allows a
   maximum of 2^14 protected bytes. Each DTLS record adds some
   overhead, thus using records of maximum possible size are
   recommended to minimize the overhead.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The sequence of DTLS records is then fragmented into DATA or I-DATA
   Chunks to fit the path MTU by SCTP. The largest possible user
   messages using the mechanism defined in this specification is
   2^64-1 bytes.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The security operations and reassembly process requires that the
   protected user message, i.e. with DTLS record overhead, is buffered
   in the receiver. This buffer space will thus put a limit on the
   largest size of plain text user message that can be transferred
   securely.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">A receiver that doesn't support partial delivery of user messages
   from SCTP <span>[<a href="#RFC6458" class="xref">RFC6458</a>]</span> will advertise its largest supported
   protected message using SCTP's mechanism for Advertised Receiver
   Window Credit (a_rwnd) as specified in Section 3.3.2 of
   <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>. Note that the a_rwnd value is across all user messages
   being delivered.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">For a receiver supporting partial delivery of user messages a_rwnd
   will not limit the maximum size of the DTLS protected user message
   because the receiver can move parts of the DTLS protected user
   message from the SCTP receiver buffer into a buffer for DTLS
   processing. When each complete DTLS record have been received
   from SCTP, it can  be processed and the plain text fragment can,
   in its turn, be partially delivered to the user application.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">Thus, the limit of the largest user message is dependent on
   buffering allocated for DTLS processing as well as the DTLS/SCTP
   API to the application. To ensure that the sender have some
   understanding of the maximum receiver size a TLS extension
   "dtls_over_sctp_maximum_message_size" <a href="#TLS-Extension" class="xref">Section 5.2</a> is used to
   signal the endpoints receiver capability when it comes to user
   message size.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">All implementors of this specification MUST support user messages
   of at least 16383 bytes. Where 16383 bytes is the supported message
   size in RFC 6083. By requiring this message size in this document,
   we ensure compatibility with existing usage of RFC 6083, not
   requiring the upper layer protocol to implement additional features
   or requirements.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">Due to SCTP's capability to transmit concurrent user messages the
   total memory consumption in the receiver is not bounded. In cases
   where one or more user messages are affected by packet loss, the
   DATA chunks may require more data in the receiver's buffer.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">The necessary buffering space for a single user message of
   dtls_over_sctp_maximum_message_size (MMS) is dependent on the
   implementation.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10">When no partial data delivery is supported, the message size is
   limited by the a_rwnd as this is the largest protected user message
   that can be received and then processed by DTLS and where the plain
   text user message is expected to be no more than the signalled MMS.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">With partial processing it is possible to have a receiver
   implementation that is bound to use no more buffer space than MMS
   (for the plaintext) plus one maximum size DTLS record. The later
   assumes that one can realign the start of the buffer after each
   DTLS record has been consumed. A more realistic implementation is
   two maximum DTLS record sizes.<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<p id="section-3.3-12">If an implementation supports partial delivery in both the SCTP API
  and the ULP API, and also partial processing in the DTLS/SCTP
  implementation, then the buffering space in the DTLS/SCTP layer
  ought to be no more than two DTLS records. In which case the MMS to
  set is dependent on the ULP and the endpoints capabilities.<a href="#section-3.3-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay-protection">
<section id="section-3.4">
        <h3 id="name-replay-protection">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-replay-protection" class="section-name selfRef">Replay Protection</a>
        </h3>
<p id="section-3.4-1">SCTP-AUTH <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> does not have explicit replay
   protection. However, the combination of SCTP-AUTH's protection of
   DATA or I-DATA chunks and SCTP user message handling will prevent
   third party attempts to inject or replay SCTP packets resulting in
   impact on the received protected user message. In fact this
   document's solution is dependent on SCTP-AUTH and SCTP to prevent
   reordering of the DTLS records within each protected user message.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">DTLS optionally supports record replay detection. Such replay
   detection could result in the DTLS layer dropping valid messages
   received outside of the DTLS replay window. As DTLS/SCTP provides
   replay protection even without DTLS replay protection, the replay
   detection of DTLS MUST NOT be used.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-mtu-discovery">
<section id="section-3.5">
        <h3 id="name-path-mtu-discovery">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-path-mtu-discovery" class="section-name selfRef">Path MTU Discovery</a>
        </h3>
<p id="section-3.5-1">DTLS Path MTU Discovery MUST NOT be used.  Since SCTP provides own
   Path MTU discovery and fragmentation/reassembly for user messages,
   and according to <a href="#Msg-size" class="xref">Section 3.3</a>, DTLS can send maximum sized DTLS
   Records.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retransmission-of-messages">
<section id="section-3.6">
        <h3 id="name-retransmission-of-messages">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-retransmission-of-messages" class="section-name selfRef">Retransmission of Messages</a>
        </h3>
<p id="section-3.6-1">SCTP provides a reliable and in-sequence transport service for DTLS
   messages that require it.  See <a href="#Stream-Usage" class="xref">Section 4.4</a>.  Therefore, DTLS
   procedures for retransmissions MUST NOT be used.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sctp-considerations">
<section id="section-4">
      <h2 id="name-sctp-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-sctp-considerations" class="section-name selfRef">SCTP Considerations</a>
      </h2>
<div id="Mapping-DTLS">
<section id="section-4.1">
        <h3 id="name-mapping-of-dtls-records">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-mapping-of-dtls-records" class="section-name selfRef">Mapping of DTLS Records</a>
        </h3>
<p id="section-4.1-1">The SCTP implementation MUST support fragmentation of user messages
   using DATA <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>, and optionally I-DATA <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> chunks.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">DTLS/SCTP works as a shim layer between the user message API and
   SCTP. The fragmentation works similar as the DTLS fragmentation of
   handshake messages.  On the sender side a user message fragmented
   into fragments m0, m1, m2, each no larger than 2^14 - 1 = 16383
   bytes.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-3">
<pre>
   m0 | m1 | m2 | ... = user_message
</pre><a href="#section-4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1-4">The resulting fragments are protected with DTLS and the records are
   concatenated<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-5">
<pre>
   user_message' = DTLS( m0 ) | DTLS( m1 ) | DTLS( m2 ) ...
</pre><a href="#section-4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-6">The new user_message', i.e the protected user message, is the input
   to SCTP.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">On the receiving side DTLS is used to decrypt the records.  If a
   DTLS decryption fails, the DTLS connection and the SCTP association
   are terminated. Due to SCTP-AUTH preventing delivery of corrupt
   fragments of the protected user message this should only occur in
   case of implementation errors or internal hardware failures.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The DTLS Connection ID SHOULD NOT be negotiated (Section 9 of
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>). If DTLS 1.3 is used, the
   length field MUST NOT be omitted and a 16 bit sequence number
   SHOULD be used.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-connection-handling">
<section id="section-4.2">
        <h3 id="name-dtls-connection-handling">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-dtls-connection-handling" class="section-name selfRef">DTLS Connection Handling</a>
        </h3>
<p id="section-4.2-1">The DTLS connection MUST be established at the beginning of the
   SCTP association and be terminated when the SCTP association is
   terminated, (i.e. there's only one DTLS connection within one
   association).  A DTLS connection MUST NOT span multiple SCTP
   associations.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">As it is required to establish the DTLS connection at the beginning
   of the SCTP association, either of the peers should never send any
   SCTP user messages that are not protected by DTLS. So the case that
   an endpoint receives data that is not either DTLS messages on Strea
   0 or protecetd user messages in the form of a sequence of DTLS
   Records on any stream is a protocol violation. The receiver MAY
   terminate the SCTP association due to this protocol violation.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payload-protocol-identifier-usage">
<section id="section-4.3">
        <h3 id="name-payload-protocol-identifier">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-payload-protocol-identifier" class="section-name selfRef">Payload Protocol Identifier Usage</a>
        </h3>
<p id="section-4.3-1">SCTP Payload Protocol Identifiers are assigned by IANA.
   Application protocols using DTLS over SCTP SHOULD register and use
   a separate Payload Protocol Identifier (PPID) and SHOULD NOT reuse
   the PPID that they registered for running directly over SCTP.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Using the same PPID does not harm as long as the application can
   determine whether or not DTLS is used.  However, for protocol
   analyzers, for example, it is much easier if a separate PPID is used.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">This means, in particular, that there is no specific PPID for DTLS.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Stream-Usage">
<section id="section-4.4">
        <h3 id="name-stream-usage">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-stream-usage" class="section-name selfRef">Stream Usage</a>
        </h3>
<p id="section-4.4-1">All DTLS Handshake, Alert, or ChangeCipherSpec (DTLS 1.2 only)
   messages MUST be transported on stream 0 with unlimited reliability
   and with the ordered delivery feature.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">DTLS messages of the record protocol, which carries the protected
   user messages, SHOULD use multiple streams other than stream 0;
   they MAY use stream 0 as long as the ordered message semantics is
   acceptable. On stream 0 protected user messages as well as any DTLS
   messages that isn't record protocol will be mixed, thus the additional
   head of line blocking can occur.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chunk-handling">
<section id="section-4.5">
        <h3 id="name-chunk-handling">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-chunk-handling" class="section-name selfRef">Chunk Handling</a>
        </h3>
<p id="section-4.5-1">DATA chunks of SCTP MUST be sent in an authenticated way as
   described in <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.  All other chunks that can be
   authenticated, i.e. all chunk types that can be listed in the Chunk
   List Parameter <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>, MUST also be sent in an authenticated
   way.  This makes sure that an attacker cannot modify the stream in
   which a message is sent or affect the ordered/unordered delivery of
   the message.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">If PR-SCTP as defined in <span>[<a href="#RFC3758" class="xref">RFC3758</a>]</span> is used, FORWARD-TSN chunks
   MUST also be sent in an authenticated way as described in
   <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.  This makes sure that it is not possible for an
   attacker to drop messages and use forged FORWARD-TSN, SACK, and/or
   SHUTDOWN chunks to hide this dropping.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">I-DATA chunk type as defined in <span>[<a href="#RFC8260" class="xref">RFC8260</a>]</span> is RECOMMENDED to be
   supported to avoid some of the down sides that large user messages
   have on blocking transmission of later arriving high priority user
   messages. However, the support is not mandated and negotiated
   independently from DTLS/SCTP. If I-DATA chunks are used then
   they MUST be sent in an authenticated way as described in
   <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp-auth-hash-function">
<section id="section-4.6">
        <h3 id="name-sctp-auth-hash-function">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-sctp-auth-hash-function" class="section-name selfRef">SCTP-AUTH Hash Function</a>
        </h3>
<p id="section-4.6-1">When using DTLS/SCTP, the SHA-256 Message Digest Algorithm MUST be
   supported in the SCTP-AUTH <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> implementation. SHA-1 MUST
   NOT be used when using DTLS/SCTP. <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> requires support and
   inclusion of of SHA-1 in the HMAC-ALGO parameter, thus, to meet
   both requirements the HMAC-ALGO parameter will include both SHA-256
   and SHA-1 with SHA-256 listed prior to SHA-1 to indicate the
   preference.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="renegotiation">
<section id="section-4.7">
        <h3 id="name-renegotiation">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-renegotiation" class="section-name selfRef">Renegotiation</a>
        </h3>
<p id="section-4.7-1">Renegotiation enables rekeying and reauthentication inside an DTLS
   1.2 connection. It is up to the upper layer to use/allow it or not.
   Application writers should be aware that allowing renegotiations
   may result in changes of security parameters. Renegotiation has
   been removed from DTLS 1.3 and partly replaced with Post-Handshake
   messages such as KeyUpdate. See <a href="#sec-Consideration" class="xref">Section 7</a> for security
   considerations regarding rekeying.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-epochs">
<section id="section-4.8">
        <h3 id="name-dtls-epochs">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-dtls-epochs" class="section-name selfRef">DTLS Epochs</a>
        </h3>
<p id="section-4.8-1">In general, DTLS implementations SHOULD discard records from
   earlier epochs, as described in Section 4.2.1 of
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>. To avoid discarding messages, the
   processing guidelines in Section 4.2.1 of DTLS 1.3
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span> or Section 4.1 or DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>
   should be followed.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handling-of-endpoint-pair-shared-secrets">
<section id="section-4.9">
        <h3 id="name-handling-of-endpoint-pair-s">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-handling-of-endpoint-pair-s" class="section-name selfRef">Handling of Endpoint-Pair Shared Secrets</a>
        </h3>
<p id="section-4.9-1">SCTP-AUTH <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span> is keyed using Endpoint-Pair Shared
   Secrets. In SCTP associations where DTLS is used, DTLS is used to
   establish these secrets. The endpoints MUST NOT use another
   mechanism for establishing shared secrets for SCTP-AUTH.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<p id="section-4.9-2">The endpoint-pair shared secret for Shared Key Identifier 0 is
   empty and MUST be used when establishing a DTLS connection.  In
   DTLS 1.2, whenever the main secret changes, a 64-byte shared secret
   is derived from every main secret and provided as a new
   endpoint-pair shared secret by using the TLS-Exporter. In DTLS 1.3,
   the exporter_secret never change. For DTLS 1.3, the exporter is
   described in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. For DTLS 1.2, the exporter is described
   in <span>[<a href="#RFC5705" class="xref">RFC5705</a>]</span>. The exporter MUST use the label given in Section
   <a href="#IANA-Consideration" class="xref">Section 6</a> and no context.  The new Shared Key
   Identifier MUST be the old Shared Key Identifier incremented by 1.
   If the old one is 65535, the new one MUST be 1.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
<p id="section-4.9-3">Before sending the DTLS Finished message, the active SCTP-AUTH key
   MUST be switched to the new one.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
<p id="section-4.9-4">Once the corresponding Finished message from the peer has been
   received, the old SCTP-AUTH key SHOULD be removed.<a href="#section-4.9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="shutdown">
<section id="section-4.10">
        <h3 id="name-shutdown">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-shutdown" class="section-name selfRef">Shutdown</a>
        </h3>
<p id="section-4.10-1">To prevent DTLS from discarding DTLS user messages while it is
   shutting down, a CloseNotify message MUST only be sent after all
   outstanding SCTP user messages have been acknowledged by the SCTP
   peer and MUST NOT be revoked by the SCTP peer.<a href="#section-4.10-1" class="pilcrow">¶</a></p>
<p id="section-4.10-2">Prior to processing a received CloseNotify, all other received SCTP
   user messages that are buffered in the SCTP layer MUST be read and
   processed by DTLS.<a href="#section-4.10-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Negotiation">
<section id="section-5">
      <h2 id="name-dtls-over-sctp-service">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dtls-over-sctp-service" class="section-name selfRef">DTLS over SCTP Service</a>
      </h2>
<p id="section-5-1">The adoption of DTLS over SCTP according to the current description
   is meant to add to SCTP the option for transferring encrypted data.
   When DTLS over SCTP is used, all data being transferred MUST be
   protected by chunk authentication and DTLS encrypted.  Chunks that
   need to be received in an authenticated way will be specified
   in the CHUNK list parameter according to <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.
   Error handling for authenticated chunks is according to <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="adaptation-layer-indication-in-initinit-ack">
<section id="section-5.1">
        <h3 id="name-adaptation-layer-indication">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-adaptation-layer-indication" class="section-name selfRef">Adaptation Layer Indication in INIT/INIT-ACK</a>
        </h3>
<p id="section-5.1-1">At the initialization of the association, a sender of the INIT or
   INIT ACK chunk that intends to use DTLS/SCTP as specified in this
   specification MUST include an Adaptation Layer Indication Parameter
   with the IANA assigned value TBD to inform its peer that it is
   able to support DTLS over SCTP per this specification.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="TLS-Extension">
<section id="section-5.2">
        <h3 id="name-dtls-sctp-dtls_over_sctp_ma">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-dtls-sctp-dtls_over_sctp_ma" class="section-name selfRef">DTLS/SCTP "dtls_over_sctp_maximum_message_size" Extension</a>
        </h3>
<p id="section-5.2-1">The endpoint's DTLS/SCTP maximum message size is declared in the
   "dtls_over_sctp_maximum_message_size" TLS extension. The
   ExtensionData of the extension is MessageSizeLimit:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-2">
<pre>
   uint64 MessageSizeLimit;
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">The value of MessageSizeLimit is the maximum plaintext user message
   size in octets that the endpoint is willing to receive. When the
   "dtls_over_sctp_maximum_message_size" extension is negotiated, an
   endpoint MUST NOT send a user message larger than the
   MessageSizeLimit value it receives from its peer.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">This value is the length of the user message before DTLS
   fragmentation and protection. The value does not account for the
   expansion due to record protection, record padding, or the DTLS
   header.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">The "dtls_over_sctp_maximum_message_size" MUST be used to negotiate
   maximum message size for DTLS/SCTP. A DTLS/SCTP endpoint MUST treat
   the omission of "dtls_over_sctp_maximum_message_size" as a fatal
   error unless supporting RFC 6083 fallback <a href="#Fallback" class="xref">Section 5.6</a>, and it
   SHOULD generate an "illegal_parameter" alert. Endpoints MUST NOT
   send a "dtls_over_sctp_maximum_message_size" extension with a value
   smaller than 16383.  An endpoint MUST treat receipt of a smaller
   value as a fatal error and generate an "illegal_parameter" alert.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">The "dtls_over_sctp_maximum_message_size" MUST NOT be send in TLS
   or in DTLS versions earlier than 1.2. In DTLS 1.3, the server sends
   the "dtls_over_sctp_maximum_message_size" extension in the
   EncryptedExtensions message.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">During resumption, the maximum message size is renegotiated.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="DTLS-init">
<section id="section-5.3">
        <h3 id="name-dtls-over-sctp-initializati">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-dtls-over-sctp-initializati" class="section-name selfRef">DTLS over SCTP Initialization</a>
        </h3>
<p id="section-5.3-1">Initialization of DTLS/SCTP requires all the following options to
   be part of the INIT/INIT-ACK handshake:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">RANDOM: defined in <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span><a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">CHUNKS: list of permitted chunks, defined in <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span><a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">HMAC-ALGO: defined in <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span><a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">ADAPTATION-LAYER-INDICATION: defined in <span>[<a href="#RFC5061" class="xref">RFC5061</a>]</span><a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">When all the above options are present, the Association will start
   with support of DTLS/SCTP.  The set of options indicated are the
   DTLS/SCTP Mandatory Options.  No data transfer is permitted before
   DTLS handshake is complete. Chunk bundling is permitted according
   to <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span>. The DTLS handshake will enable authentication of
   both the peers and also have the declare their support message
   size.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">The extension described in this document is given by the following
   message exchange.<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3-8">
<pre>
   --- INIT[RANDOM; CHUNKS; HMAC-ALGO; ADAPTATION-LAYER-IND] ---&gt;
   &lt;- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO; ADAPTATION-LAYER-IND] -
   ------------------------ COOKIE-ECHO ------------------------&gt;
   &lt;------------------------ COOKIE-ACK -------------------------
   ---------------- AUTH; DATA[DTLS Handshake] -----------------&gt;
                               ...
                               ...
   &lt;--------------- AUTH; DATA[DTLS Handshake] ------------------
</pre><a href="#section-5.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="client-use-case">
<section id="section-5.4">
        <h3 id="name-client-use-case">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-client-use-case" class="section-name selfRef">Client Use Case</a>
        </h3>
<p id="section-5.4-1">When a SCTP Client initiates an Association with DTLS/SCTP
   Mandatory Options, it can receive an INIT-ACK also containing
   DTLS/SCTP Mandatory Options, in that case the Association will
   proceed as specified in the previous <a href="#DTLS-init" class="xref">Section 5.3</a> section.  If the
   peer replies with an INIT-ACK not containing all DTLS/SCTP
   Mandatory Options, the Client can decide to keep on working with
   RFC 6083 fallback, plain data only, or to ABORT the association.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-use-case">
<section id="section-5.5">
        <h3 id="name-server-use-case">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-server-use-case" class="section-name selfRef">Server Use Case</a>
        </h3>
<p id="section-5.5-1">If a SCTP Server supports DTLS/SCTP, when receiving an INIT chunk
   with all DTLS/SCTP Mandatory Options it must reply with INIT-ACK
   also containing the all DTLS/SCTP Mandatory Options, then it must
   follow the sequence for DTLS initialization <a href="#DTLS-init" class="xref">Section 5.3</a> and the
   related traffic case.  If a SCTP Server supports DTLS, when
   receiving an INIT chunk with not all DTLS/SCTP Mandatory
   Options, it can decide to continue by creating an Association with
   RFC 6083 fallback, plain data only or to ABORT it.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Fallback">
<section id="section-5.6">
        <h3 id="name-rfc-6083-fallback">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-rfc-6083-fallback" class="section-name selfRef">RFC 6083 Fallback</a>
        </h3>
<p id="section-5.6-1">This section discusses how an endpoint supporting this
   specification can fallback to follow the DTLS/SCTP behavior in RFC
   6083. It is recommended to define a setting that represents the
   policy to allow fallback or not. However, the possibility to use
   fallback is based on the ULP can operate using user messages that
   are no longer than 16383 bytes and where the security issues can be
   mitigated or considerd acceptable. Fallback is NOT RECOMMEND to be
   enabled as it enables downgrade to weaker algorithms and versions
   of DTLS.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">A SCTP client that receives an INIT-ACK that is not compliant
   according this specification may in certain cases potentially
   perform an fallback to RFC 6083 behavior. The first case is when
   the SCTP client receives an INIT-ACK doesn't contain the
   SCTP-Adaptation-Indication parameter with the DTLS/SCTP adaptation
   layer codepoint but do include the SCTP-AUTH parameters on a server
   that are expected to provide services using DTLS. The second case
   is when the INIT-ACK do contain the SCTP-Adaptation-Indication
   parameter with the correct code point, however the HMAC-ALGO or the
   Chunks parameters values are such that do not fullfil the
   requirement of this specification but do meet the requirements of
   RFC 6083. In either of these cases the client could attempt DTLS
   per RFC 6083 as fallback. However, the fallback attempt should only
   be performed if policy says that is acceptable.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.6-3">If fallback is allowed it is possible that the client will send
   plain text user messages prior to DTLS handshake as it is allowed
   per RFC 6083.  So that needs to be part of the consideration for a
   policy allowing fallback. When performing the the DTLS handshake,
   the server is required accepting that lack of the TLS extension
   "dtls_over_sctp_maximum_message_size" and can't treat it as fatal
   error. In case the "dtls_over_sctp_maximum_message_size" TLS
   extension is present in the handshake the server SHALL continue the
   handshake including the extension with its value also, and from
   that point follow this specification. In case the TLS option is
   missing RFC 6083 applies.<a href="#section-5.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA-Consideration">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="tls-exporter-label">
<section id="section-6.1">
        <h3 id="name-tls-exporter-label">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-tls-exporter-label" class="section-name selfRef">TLS Exporter Label</a>
        </h3>
<p id="section-6.1-1">RFC 6083 defined a TLS Exporter Label registry as described in
   <span>[<a href="#RFC5705" class="xref">RFC5705</a>]</span>. IANA is requested to update the reference for the
   label "EXPORTER_DTLS_OVER_SCTP" to this specification.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-dtlsoversctpbuffersizelimit-extension">
<section id="section-6.2">
        <h3 id="name-dtls-dtls_over_sctp_buffer_">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-dtls-dtls_over_sctp_buffer_" class="section-name selfRef">DTLS "dtls_over_sctp_buffer_size_limit" Extension</a>
        </h3>
<p id="section-6.2-1">This document registers the "dtls_over_sctp_maximum_message_size"
   extension in the TLS "ExtensionType Values" registry established in
   <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>.  The "dtls_over_sctp_maximum_message_size" extension
   has been assigned a code point of TBD. This entry [[will
   be|is]] marked as recommended (<span>[<a href="#RFC8447" class="xref">RFC8447</a>]</span> and marked as
   "Encrypted" in (D)TLS 1.3 <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>. The IANA
   registry <span>[<a href="#RFC8447" class="xref">RFC8447</a>]</span> [[will list|lists]] this extension as
   "Recommended" (i.e., "Y") and indicates that it may appear in the
   ClientHello (CH) or EncryptedExtensions (EE) messages in (D)TLS 1.3
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp-parameter">
<section id="section-6.3">
        <h3 id="name-sctp-parameter">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-sctp-parameter" class="section-name selfRef">SCTP Parameter</a>
        </h3>
<p id="section-6.3-1">IANA is requested to assign a Adaptation Code Point for DTLS/SCTP.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-Consideration">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The security considerations given in <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>,
   <span>[<a href="#RFC4895" class="xref">RFC4895</a>]</span>, and <span>[<a href="#RFC4960" class="xref">RFC4960</a>]</span> also apply to this document.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="cryptographic-considerations">
<section id="section-7.1">
        <h3 id="name-cryptographic-consideration">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-cryptographic-consideration" class="section-name selfRef">Cryptographic Considerations</a>
        </h3>
<p id="section-7.1-1">Over the years, there have been several serious attacks on earlier
   versions of Transport Layer Security (TLS), including attacks on
   its most commonly used ciphers and modes of operation.  <span>[<a href="#RFC7457" class="xref">RFC7457</a>]</span>
   summarizes the attacks that were known at the time of publishing
   and BCP 195 <span>[<a href="#RFC7525" class="xref">RFC7525</a>]</span> provides recommendations for improving the
   security of deployed services that use TLS.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">When DTLS/SCTP is used with DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>, DTLS 1.2 MUST be
   configured to disable options known to provide insufficient
   security. HTTP/2 <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span> gives good minimum requirements based
   on the attacks that where publicly known in 2015. DTLS 1.3
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span> only define strong algorithms without major
   weaknesses at the time of publication. Many of the TLS registries
   have a "Recommended" column. Parameters not marked as "Y" are NOT
   RECOMMENDED to support.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">DTLS 1.3 requires rekeying before algorithm specific AEAD limits
   have been reached. The AEAD limits equations are equally valid for
   DTLS 1.2 and SHOULD be followed for DTLS/SCTP, but are not mandated
   by the DTLS 1.2 specification. HMAC-SHA-256 as used in SCTP-AUTH
   has a very large tag length and very good integrity properties. The
   SCTP-AUTH key can be used until the DTLS handshake is re-run at
   which point a new SCTP-AUTH key is derived using the TLS-Exporter.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">DTLS/SCTP is in many deployments replacing IPsec. For IPsec, NIST
   (US), BSI (Germany), and ANSSI (France) recommends very frequent
   re-run of Diffie-Hellman to provide Perfect Forward Secrecy. ANSSI
   writes "It is recommended to force the periodic renewal of the
   keys, e.g. every hour and every 100 GB of data, in order to limit
   the impact of a key compromise." <span>[<a href="#ANSSI-DAT-NT-003" class="xref">ANSSI-DAT-NT-003</a>]</span>.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">For many DTLS/SCTP deployments the DTLS connections are expected to
   have very long lifetimes of months or even years. For connections
   with such long lifetimes there is a need to frequently
   re-authenticate both client and server.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">When using DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>, AEAD limits, frequant
   re-authentication and frequent re-run of Diffie-Hellman can be
   achieved with frequent renegotiation, see TLS 1.2 <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>. When
   renegotiation is used both clients and servers MUST use the
   renegotiation_info extension <span>[<a href="#RFC5746" class="xref">RFC5746</a>]</span> and MUST follow the
   renegotiation guidelines in BCP 195 <span>[<a href="#RFC7525" class="xref">RFC7525</a>]</span>.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">In DTLS 1.3 renegotiation has been removed from DTLS 1.3 and partly
   replaced with Post-Handshake KeyUpdate. When using DTLS 1.3
   <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>, AEAD limits and frequent rekeying can be
   achieved by sending frequent Post-Handshake KeyUpdate
   messages. Symmetric rekeying gives less protection against key
   leakage than re-running Diffie-Hellman.  After leakage of
   application_traffic_secret_N, a passive attacker can passively
   eavesdrop on all future application data sent on the connection
   including application data encrypted with
   application_traffic_secret_N+1, application_traffic_secret_N+2,
   etc. The is no way to do Post-Handshake server authentication or
   Ephemeral Diffie-Hellman inside a DTLS 1.3 connection. Note that
   KeyUpdate does not update the exporter_secret.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="downgrade-attacks">
<section id="section-7.2">
        <h3 id="name-downgrade-attacks">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-downgrade-attacks" class="section-name selfRef">Downgrade Attacks</a>
        </h3>
<p id="section-7.2-1">A peer supporting DTLS/SCTP according to this specification,
   DTLS/SCTP according to <span>[<a href="#RFC6083" class="xref">RFC6083</a>]</span> and/or SCTP without DTLS may be
   vulnerable to downgrade attacks where on on-path attacker
   interferes with the protocol setup to lower or disable security. If
   possible, it is RECOMMENDED that the peers have a policy only
   allowing DTLS/SCTP according to this specification.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtlssctp-message-sizes">
<section id="section-7.3">
        <h3 id="name-dtls-sctp-message-sizes">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-dtls-sctp-message-sizes" class="section-name selfRef">DTLS/SCTP Message Sizes</a>
        </h3>
<p id="section-7.3-1">The DTLS/SCTP maximum message size extension enables secure
   negation of a message sizes that fit in the DTLS/SCTP buffer, which
   improves security and availability. Very small plain text user
   fragment sizes might generate additional work for senders and
   receivers, limiting throughput and increasing exposure to denial of
   service.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The maximum message size extension does not protect against peer
   nodes intending to negatively affect the peer node through flooding
   attacks. The attacking node can both send larger messages than the
   expressed capability as well as initiating a large number of
   concurrent user message transmissions that never are concluded. For
   the target of the attack it is more straight forward to determine
   that a peer is ignoring the node's stated limitation.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-and-policy-decisions">
<section id="section-7.4">
        <h3 id="name-authentication-and-policy-d">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-authentication-and-policy-d" class="section-name selfRef">Authentication and Policy Decisions</a>
        </h3>
<p id="section-7.4-1">DTLS/SCTP MUST be mutually authenticated. It is RECOMMENDED that
   DTLS/SCTP is used with certificate based authentication.  All
   security decisions MUST be based on the peer's authenticated
   identity, not on its transport layer identity.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">It is possible to authenticate DTLS endpoints based on IP addresses
   in certificates. SCTP associations can use multiple IP addresses
   per SCTP endpoint. Therefore, it is possible that DTLS records will
   be sent from a different source IP address or to a different
   destination IP address than that originally authenticated. This is
   not a problem provided that no security decisions are made based on
   the source or destination IP addresses.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7.5">
        <h3 id="name-privacy-considerations">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-7.5-1"><span>[<a href="#RFC6973" class="xref">RFC6973</a>]</span> suggests that the privacy considerations of IETF
   protocols be documented.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">For each SCTP user message, the user also provides a stream
   identifier, a flag to indicate whether the message is sent ordered
   or unordered, and a payload protocol identifier.  Although
   DTLS/SCTP provides privacy for the actual user message, the other
   three information fields are not confidentiality protected.  They
   are sent as clear text, because they are part of the SCTP DATA
   chunk header.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">It is RECOMMENDED that DTLS/SCTP is used with certificate based
   authentication in DTLS 1.3 <span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span> to provide
   identity protection. DTLS/SCTP MUST be used with a key exchange
   method providing Perfect Forward Secrecy. Perfect Forward Secrecy
   significantly limits the amount of data that can be compromised due
   to key compromise.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pervasive-monitoring">
<section id="section-7.6">
        <h3 id="name-pervasive-monitoring">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-pervasive-monitoring" class="section-name selfRef">Pervasive Monitoring</a>
        </h3>
<p id="section-7.6-1">As required by <span>[<a href="#RFC7258" class="xref">RFC7258</a>]</span>, work on IETF protocols needs to
   consider the effects of pervasive monitoring and mitigate them when
   possible.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">Pervasive Monitoring is widespread surveillance of users.  By
   encrypting more information including user identities, DTLS 1.3
   offers much better protection against pervasive monitoring.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<p id="section-7.6-3">Massive pervasive monitoring attacks relying on key exchange
   without forward secrecy has been reported. By mandating perfect
   forward secrecy, DTLS/SCTP effectively mitigate many forms of
   passive pervasive monitoring and limits the amount of compromised
   data due to key compromise.<a href="#section-7.6-3" class="pilcrow">¶</a></p>
<p id="section-7.6-4">In addition to the privacy attacks discussed above, surveillance on
   a large scale may enable tracking of a user over a wider
   geographical area and across different access networks.  Using
   information from DTLS/SCTP together with information gathered from
   other protocols increases the risk of identifying individual users.<a href="#section-7.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-8">
      <h2 id="name-acknowledgments">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-8-1">The authors of RFC 6083 which this document is based on are
   Michael Tuexen, Eric Rescorla, and Robin Seggelmann.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The RFC 6083 authors thanked Anna Brunstrom, Lars Eggert, Gorry
   Fairhurst, Ian Goldberg, Alfred Hoenes, Carsten Hohendorf, Stefan
   Lindskog, Daniel Mentz, and Sean Turner for their invaluable
   comments.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3758">[RFC3758]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Ramalho, M.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">P. Conrad</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Partial Reliability Extension"</span>, <span class="seriesInfo">RFC 3758</span>, <span class="seriesInfo">DOI 10.17487/RFC3758</span>, <time datetime="2004-05" class="refDate">May 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3758">https://www.rfc-editor.org/info/rfc3758</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4895">[RFC4895]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 4895</span>, <span class="seriesInfo">DOI 10.17487/RFC4895</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4895">https://www.rfc-editor.org/info/rfc4895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4960">[RFC4960]</dt>
        <dd>
<span class="refAuthor">Stewart, R., Ed.</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 4960</span>, <span class="seriesInfo">DOI 10.17487/RFC4960</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4960">https://www.rfc-editor.org/info/rfc4960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5746">[RFC5746]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Ray, M.</span>, <span class="refAuthor">Dispensa, S.</span>, and <span class="refAuthor">N. Oskov</span>, <span class="refTitle">"Transport Layer Security (TLS) Renegotiation Indication Extension"</span>, <span class="seriesInfo">RFC 5746</span>, <span class="seriesInfo">DOI 10.17487/RFC5746</span>, <time datetime="2010-02" class="refDate">February 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5746">https://www.rfc-editor.org/info/rfc5746</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7540">[RFC7540]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span>, <span class="refAuthor">Peon, R.</span>, and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8260">[RFC8260]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Loreto, S.</span>, and <span class="refAuthor">R. Seggelmann</span>, <span class="refTitle">"Stream Schedulers and User Message Interleaving for the Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 8260</span>, <span class="seriesInfo">DOI 10.17487/RFC8260</span>, <time datetime="2017-11" class="refDate">November 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8260">https://www.rfc-editor.org/info/rfc8260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8447">https://www.rfc-editor.org/info/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-43</span>, <time datetime="2021-04-30" class="refDate">30 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt">https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3436">[RFC3436]</dt>
        <dd>
<span class="refAuthor">Jungmaier, A.</span>, <span class="refAuthor">Rescorla, E.</span>, and <span class="refAuthor">M. Tuexen</span>, <span class="refTitle">"Transport Layer Security over Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 3436</span>, <span class="seriesInfo">DOI 10.17487/RFC3436</span>, <time datetime="2002-12" class="refDate">December 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3436">https://www.rfc-editor.org/info/rfc3436</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5061">[RFC5061]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Maruyama, S.</span>, and <span class="refAuthor">M. Kozuka</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration"</span>, <span class="seriesInfo">RFC 5061</span>, <span class="seriesInfo">DOI 10.17487/RFC5061</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5061">https://www.rfc-editor.org/info/rfc5061</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6083">[RFC6083]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Seggelmann, R.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6083</span>, <span class="seriesInfo">DOI 10.17487/RFC6083</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6083">https://www.rfc-editor.org/info/rfc6083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6458">[RFC6458]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Poon, K.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">V. Yasevich</span>, <span class="refTitle">"Sockets API Extensions for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6458</span>, <span class="seriesInfo">DOI 10.17487/RFC6458</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6458">https://www.rfc-editor.org/info/rfc6458</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ANSSI-DAT-NT-003">[ANSSI-DAT-NT-003]</dt>
      <dd>
<span class="refAuthor">Agence nationale de la sécurité des systèmes d'information, .</span>, <span class="refTitle">"Recommendations for securing networks with IPsec"</span>, <span class="seriesInfo">ANSSI Technical Report DAT-NT-003 </span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf">https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="motivation-for-changes">
<section id="section-appendix.a">
      <h2 id="name-motivation-for-changes">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-motivation-for-changes" class="section-name selfRef">Motivation for Changes</a>
      </h2>
<p id="section-appendix.a-1">This document proposes a number of changes to RFC 6083 that have
various different motivations:<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">Supporting Large User Messages: RFC 6083 allowed only user messages
   that could fit within a single DTLS record. 3GPP has run into this
   limitation where they have at least four SCTP using protocols (F1,
   E1, Xn, NG-C) that can potentially generate messages over the size
   of 16384 bytes.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<p id="section-appendix.a-3">New Versions: Almost 10 years has passed since RFC 6083 was written,
   and significant evolution has happened in the area of DTLS and
   security algorithms. Thus DTLS 1.3 is the newest version of DTLS
   and also the SHA-1 HMAC algorithm of RFC 4895 is getting towards
   the end of usefulness. Thus, this document mandates usage of
   relevant versions and algorithms.<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
<p id="section-appendix.a-4">Clarifications: Some implementation experiences has been gained that
   motivates additional clarifications on the specification.<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-5.1">Avoid unsecured messages prior to DTLS handshake have completed.<a href="#section-appendix.a-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-5.2">Make clear that all messages are encrypted after DTLS handshake.<a href="#section-appendix.a-5.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Magnus Westerlund</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:magnus.westerlund@ericsson.com" class="email">magnus.westerlund@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Claudio Porfiri</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:claudio.porfiri@ericsson.com" class="email">claudio.porfiri@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Tüxen</span></div>
<div dir="auto" class="left"><span class="org">Münster University of Applied Sciences</span></div>
<div dir="auto" class="left"><span class="street-address">Stegerwaldstrasse 39</span></div>
<div dir="auto" class="left">
<span class="postal-code">48565</span> <span class="locality">Steinfurt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tuexen@fh-muenster.de" class="email">tuexen@fh-muenster.de</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
