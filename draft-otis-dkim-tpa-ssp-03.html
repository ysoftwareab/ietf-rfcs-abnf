<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DKIM Third-Party Authorization for Sender Signer Practices</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DKIM Third-Party Authorization for Sender Signer Practices">
<meta name="keywords" content="TPA-SSP, Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DKIM Working Group</td><td class="header">D. Otis</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Trend Micro, NSSG</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">February 25, 2008</td></tr>
<tr><td class="header">Expires: August 28, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />DKIM Third-Party Authorization for Sender Signer Practices<br />draft-otis-dkim-tpa-ssp-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 28, 2008.</p>

<h3>Abstract</h3>

<p>TPA-SSP (DKIM Third-Party Authorization for Sender Signing Practices) is a DNS-based label
        prefix mechanism for authorizing Third-Party domains. This mechanism allows a first-party
        domain to autonomously authorize a range of third-party domains in a scalable, individual
        DNS transaction. This authorization can extend the scope of DKIM-SSP policy assertions and
        eliminate more difficult to administer mechanisms. Alternatives for facilitating third-party
        authorizations currently necessitate coordination between two domains by setting up
        selector/key DNS records, DNS zone delegations, or the regular exchange of public/private
        keys.
</p>
<p>Checking Sender Signing Practices occurs when a From header email-address is not within the
        domain of a valid DKIM signature. When a Third-Party signature is found, TPA-SSP offers an
        efficient means for the email address domain within the From header to specifically
        authorize other third-party signing domains. The scope of the authorization may also assert
        identity authentication for Sender and Resent-* headers for email-addresses within the
        signing domain. Identity authentication within the From header domain may be asserted by the
        scope of the authorization, even when signed by a Third-Party domain. In addition, the
        RFC2821.MailFrom domain can authorize domains for controlling DSNs.<br />
<br />

</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Envelope Authorizations<br />
<a href="#anchor3">3.</a>&nbsp;
Evaluating Signing Domains<br />
<a href="#anchor4">4.</a>&nbsp;
Authorization Scope<br />
<a href="#anchor5">5.</a>&nbsp;
TPA-SSP Assertions<br />
<a href="#anchor6">6.</a>&nbsp;
Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">6.1.</a>&nbsp;
From Originator Header Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.2.</a>&nbsp;
MailFrom Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.3.</a>&nbsp;
Other than From Originating Header Fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.4.</a>&nbsp;
NO-TPA<br />
<a href="#anchor11">7.</a>&nbsp;
Authorized Signing Domain<br />
<a href="#anchor12">8.</a>&nbsp;
Modification to Sender Signing Practices Check Procedures<br />
<a href="#anchor13">9.</a>&nbsp;
Restricted Local-part<br />
<a href="#IANA">10.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">11.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">12.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#anchor16">Appendix&nbsp;A.</a>&nbsp;
Change Log<br />
<a href="#anchor17">Appendix&nbsp;B.</a>&nbsp;
DNS Example of TPA-SSP From record<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes how any email-address domain publishing SSP records defined in
          <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> can also specifically autonomously authorize <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> signing by third-party domains. Recommended or suggested actions for a
        DKIM receiver are not included, and are considered "out-of-scope" for this document. The
        receiver is assumed to better understand their environment's impact upon the performance of
        DKIM signatures and how results are utilized within their domain.
</p>
<p>TPA-SSP records permit signing domains that are not at or above the From header
        email-address domain to comply with Sender Signing Practices. TPA-SSP authorized domains are
        to be considered equivalent to the authorizing domain for applying Sender Signing Practices.
        This mechanism eliminates a complex coordination of selector/key DNS records, DNS
        delegation, or exchanges of public/private keys between two domains otherwise required to
        facilitate desired authorizations.
</p>
<p>Trust is an essential requisite before DKIM signature header field's 'i=' semantics or the
        TPA-SSP "-i" suffix scope assertions provide valuable advisory information. Advisory
        information regarding identity authentication enables safer message annotations that ensure
        trusted identities are recognized. TPA-SSP assertions also convey which third-party domains
        are authoritative for asserting which identifiers are to be considered to have been
        authenticated. This information is essential for the proper recognition of trusted
        identities, as well as noting when a message source may require added scrutiny.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Envelope Authorizations</h3>

<p>DKIM is fully independent of the SMTP Client and the <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a>.MailFrom
        email-address. Allowing the <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a>.MailFrom email-address to authorize
        signing domains and assert signing practices may prevent Delivery Status Notifications
        (DSNs) from being sent when the signing domain is not authorized and a "discardable" TPA-SSP
        practice is being asserted. Conversely, this may also ensure DSNs are not dropped when the
        signing domain does happen to be authorized or is not precluded. The application of TPA-SSP
        at the MailFrom represents an entirely optional strategy which may or may not prove either
        effective or practical. The MailFrom scope is offered only for experimentation.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Evaluating Signing Domains</h3>

<p>Regulatory agencies are unable to control Internet abuse by curtailing access. Unlike IPv4
        addresses, there is virtually no limit on the number of domain-names available. Registrar
        pricing of domain-names need to remain uniform. Otherwise, fees based upon the intrinsic
        value of a name could cause name holders to become extortion targets. High initial costs for
        domain-names are also unlikely to represent a deterrent, largely due to high levels of
        payment fraud. Driven by market forces, registrars offer the sampling of domain names
        (domain tasting) to generate additional revenue.
</p>
<p>In addition, DKIM can not directly identify the domain transmitting the message, and can
        not prevent abusive message replay. Abusive message replay may prove indistinguishable from
        bulk mailings of various types. Since abuse may not be controlled by the signing domain,
        message acceptance will likely remain largely dependent upon the reputation of the SMTP
        client's IP address. Abuse reporting facilitated by DKIM signatures should therefore first
        select signing domains that correspond with domains administering the SMTP Client publicly
        transmitting the message.
</p>
<p>A domain evaluation process will confront many domains with unknown reputations. New
        domains are constantly being introduced where registrars are unable to prevent bad actors
        from controlling either a new or previously held domain name. When the receiver seeks to
        protect a DKIM verification process with a preliminary filter, acquiring SSP records or DKIM
        keys may inadvertently leak valuable information that benefits bad actors. Processing all
        DKIM signatures may also inundate a receiver's limited resources. As a result, validating
        DKIM signatures and obtaining TPA-SSP resource records may need to be limited to known
        trustworthy domains. Signatures authorized by domains with good reputations provide a means
        to safely extend limited verification resources.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Authorization Scope</h3>

<p>An Authorization effort without TPA-SSP will likely involve sharing details between the
        email provider, the domain owner, and DNS providers. Since there are many ways in which
        authorizations can be accomplished, it is unlikely there will be consistent or standardized
        formats for exchanging the necessary information. In addition, in the case of security
        breaches, the wrong party might be held accountable for content never seen nor logged by
        them. The TPA-SSP authorization scheme clarifies who signed the message and on who's behalf,
        while permitting greater control by the authorizing domain.
</p>
<p>TPA-SSP records replace domain delegation, selector/key record mirroring, or key exchanges.
        A significant amount of detail is associated with selector/key records. These details
        include user limitations, suitable services, key resource record's Time-To-Live, revocation
        and update procedures, and whether the DKIM Signature header field's 'i=' semantics are
        applied to indicate authenticated email-addresses. The TPA-SSP records allow authorizing
        domains the ability to limit the scope of the authorizations and authentications.
</p>
<p>When a signing domain differs from that of a domain within the From header email-address,
        TPA-SSP records can safely extend compliance with SSP where actions of only the
        email-address domain are required. In addition, just as a DKIM signature can assert an
        email-address has been authenticated via the "i" construct, a signing domain that only signs
        authenticated email-addresses can be denoted by the "-i" suffix on the scope assertion
        within the corresponding TPA-SSP record. When obtained using the "tpa-label", a returned
        scope with an "-i" suffix indicates that the domain plays the role of assuring that
        email-addresses identities have been authenticated. This assertion remains valid even when
        signing domains and the From email-address domains differ.
</p>
<p>Without the "-i" suffix on the scope assertion within the TPA-SSP record, the domain is
        designated as providing only acceptable signatures. The same would be true for a DKIM
        signature lacking the "i" parameter. While offering only valid signatures will not ensure
        all possible spoofing is prevented, messages signed in this manner should also not receive
        annotations indicating authenticated identities either.
</p>
<p>Choosing not to implement identity authentication may represent an economical means to
        administer domains employing DKIM signatures. Authorizing domains to play the role of only
        providing acceptable signatures may be suitable for non-critical messages, where the goal
        might be to improve delivery acceptance.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
TPA-SSP Assertions</h3>

<p>Syntax descriptions use the form described in Augmented BNF for Syntax Specifications <a class='info' href='#RFC4234'>[RFC4234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; October&nbsp;2005.</span><span>)</span></a>. The "base32" function is defined in <a class='info' href='#RFC4648'>[RFC4648]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> and the
        "sha-1" hash function is defined in <a class='info' href='#FIPS.180-2.2002'>[FIPS.180&#8209;2.2002]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a>. The TPA-SSP records
        follow the tag-value syntax described in section 4.3 of <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a>
        and section 3.2 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. Unrecognized tags and tags with illegal values
        MUST be ignored. In the ABNF below, the FWS token is inherited from <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>
        with the exclusion of obs-FWS. The ALPHA and DIGIT tokens are imported from <a class='info' href='#RFC4234'>[RFC4234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; October&nbsp;2005.</span><span>)</span></a>. The function "lcase" converts upper-case ALPHA characters to
        lower-case. The function "sha-1" returns a hash in base32 base-char set. The terminating
        period is not included in domain-name conversions. The tags used in TPA-SSP records are as
        follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  asterisk = %x2A ; "*"
  dash = %x2D ; "-"
  dot = %x2E ; "."
  underscore = %x5F ; "_"
  ANY = asterisk dot ; "*."
  dns-char = ALPHA / DIGIT / dash
  id-prefix = ALPHA / DIGIT
  label = id-prefix [*61dns-char id-prefix]
  sldn = label dot label
  base-char = (dns-char / underscore)
  domain = *(label dot) sldn
         ; not to exceed 238 characters
         ; excluding "_ssp._domainkey."
  tpa-label = base32( sha-1( lcase(signing-domain)))
            ; 32 base-char characters
</pre></div><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">Tag</th><th align="left">Function</th></tr>
<tr>
<td align="center">scope=</td>
<td align="left">Authorization Scope List (as-list)</td>
</tr>
<tr>
<td align="center">tpa=</td>
<td align="left">Authorized Domains List (ad-list)</td>
</tr>
<tr>
<td align="center">g=</td>
<td align="left">Local-part restriction</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-SSP Tags&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="10%"><col align="left"><col align="left" width="20%">
<tr><th align="left">Scope Values</th><th align="left">Field or Parameter</th><th align="left">Identity Authenticated</th></tr>
<tr>
<td align="left">F</td>
<td align="left">From Originator Header</td>
<td align="left">No</td>
</tr>
<tr>
<td align="left">F-i</td>
<td align="left">From Originator Header</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">O</td>
<td align="left">Other than From Originator Headers</td>
<td align="left">No</td>
</tr>
<tr>
<td align="left">O-i</td>
<td align="left">Other than From Originator Headers</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">M</td>
<td align="left">MailFrom</td>
<td align="left">No</td>
</tr>
<tr>
<td align="left">M-i</td>
<td align="left">MailFrom</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">NO-TPA</td>
<td align="left">All</td>
<td align="left">No</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA Scope Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The receiver obtains the TPA-SSP email-address domain practices using a DNS query for an IN
        class TXT resource record. The tpa-label is created by processing the domain found within
        the signature's "d=" parameter (does not include the trailing period). This tpa-label is
        then placed below the "._asp.domainkey.&lt;email-address domain&gt;" and used to
        access the TPA-SSP TXT records. Character-strings contained within the TXT resource record
        are concatenated into forming a single string. A character-string is a single length octet
        followed by that number of characters treated as binary information. A TPA-SSP record may be
        located at these domains:</p>
<blockquote class="text">
<p>
</p>
<p>&lt;tpa-label&gt;._asp._domainkey.&lt;email-address domain&gt;.
</p>
</blockquote><p>
        <br />
<br />

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Scope</h3>

<p>scope= Authorization Scope List (Optional). This tag defines a list of scoping assertions
        for various email-address locations within the message.
</p>
<p>
        </p>
<blockquote class="text">
<p>scope = "F" / "F-i" / "O" / "O-i" / "M" / "M-i" / "NO-TPA"
</p>
<p>as-list = "scope" [WSP] "=" [WSP] scope 0*([WSP] ":" [WSP] scope)
</p>
</blockquote><p>
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
From Originator Header Field</h3>

<p>The "F" or "F-i" scope asserts that messages carrying the email-address domain within the
          From header field are authorized to be signed by the tpa listed domain. When the "-i"
          suffix is included, it can be assumed identities for the scoped header have been
            authenticated.<br />
<br />

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
MailFrom Parameter</h3>

<p>This "M" or "M-i" scope asserts that messages carrying the email-address domain within
          the MailFrom parameter are authorized to be signed by the authorized domain. When the "-i"
          suffix is included, it can be assumed identities for the MailFrom have been
            authenticated.<br />
<br />

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Other than From Originating Header Fields</h3>

<p>The "O" or "O-i" scope asserts that messages carrying the email-address domain within the
          Sender or Resent-* header fields are authorized to be signed by the authorized domain.
          When the "-i" suffix is included, it can be assumed identities for the scoped header have
          been authenticated.<br />
<br />

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
NO-TPA</h3>

<p>The "NO-TPA" scope asserts that domain does not publish TPA-SSP records.<br />
<br />

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Authorized Signing Domain</h3>

<p>tpa= Authorized Signing Domain list (Optional). This tag repeats all or portions of the
        domain encoded within the tpa-label. This option ensures proper handling of possible hash
        collisions. When a domain is prefixed with the "*." ANY label, then all subdomains of this
        domain are to be considered included within the list.
</p>
<p>
        </p>
<blockquote class="text">
<p>ad = [ANY] domain
</p>
<p>ad-list = "tpa" [WSP] "=" [WSP] ad 0*([WSP] ":" [WSP] ad)
</p>
<p>
            <br />
<br />

          
</p>
</blockquote><p>
      
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Modification to Sender Signing Practices Check Procedures</h3>

<p>Section 4.4 step 9 is modified. Step 9 becomes:
</p>
<p>
        </p>
<blockquote class="text">
<p>When one or more valid Third-Party Signatures are present in the message, and a scope
            tag exists, and the scope tag does not contain "NO-TPA" within the SSP record,
              then:</p>
<ul class="text">
<li>When the "dkim" tag indicates "signing complete" and a TPA-SSP record within the
                From header domain has a scope tag of "F" or "F-i", then the message is to be
                considered signed by an Originator Acceptable Third-Party Signature. When the scope
                tag within the TPA-SSP record is "F-i", the From email-address is to be considered
                authenticated by the Third-Party Domain.
</li>
<li>When the "dkim" tag is "all" and a TPA-SSP record within the From header domain has
                a scope tag of "O" or "O-i" and the email-address domain within the Sender, or
                Resent-* headers are within the signing domain, then the message is considered
                signed with an Originator Acceptable Third-Party Signature. When the scope tag
                within the TPA-SSP record is "O-i", then email-addresses within the third-party
                signing domain are considered to have been authenticated when included within the
                signature.
</li>
<li>When the "dkim" tag is "all" and no TPA-SSP record is found or published, and a
                valid Third-party signature is acceptable to the verifier, then the message is
                considered signed by a Verifier Acceptable Third-Party Signature.
</li>
</ul>If an acceptable valid Third-Party Signature has been determined, the message is
            not Suspicious and the algorithm terminates.

</blockquote><p>
      
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Restricted Local-part</h3>

<p>The "g=" tag provides a means for an authorizing domain to restrict authorization for
        local-parts appearing within the From header.
</p>
<p>G= Granularity of the TPA authorization (plain-text; OPTIONAL, default is "*"). This value
        MUST match the Local-part of the From header email-address. A single optional "*" character
        matches a sequence of zero or more arbitrary characters ("wildcarding"). An email with a
        From address local-part that does not match the value of this tag constitutes a failed TPA
        authorization. The intent of this tag is to constrain which email-addresses the domain can
        legitimately be authorized to sign. Wildcarding allows matching for addresses such as
        "user+*" or "*-offer". An empty "g=" value never matches any addresses.
</p>
<p>
        </p>
<blockquote class="text">
<p>ABNF: tpa-g-tag = %x67 [FWS] "=" [FWS] tpa-tag-lpart 
</p>
<p>tpa-g-tag-lpart = [dot-atom-text] ["*" [dot-atom-text] ]
</p>
</blockquote><p>
      
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>Unless a registry is established for SSP record tags, there are no IANA requirements in
        this draft.
</p>
<p>Note to RFC Editor: this section may be removed on publication as an RFC and no request is
        desired or registration is not considered practical.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>This draft extends signing policies related to <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. Security
        considerations in the Sender Signing Practices are mostly related to attempts on the part of
        malicious senders to represent themselves as other senders, often in an attempt to defraud
        either the recipient or the Alleged Originator. Additional security considerations regarding
        Sender Signing Practices may be found in the DKIM threat analysis <a class='info' href='#RFC4686'>[RFC4686]<span> (</span><span class='info'>Fenton, J., &ldquo;Analysis of Threats Motivating DomainKeys Identified Mail (DKIM),&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<p>The use of the SHA-1 hash algorithm does not represent a security concern. The hash simply
        ensures a deterministic domain-name size is achieved. Unexpected collisions can be detected
        and handled by using the extended TPA-SSP "tpa=" option.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgements</h3>

<p>Frank Ellermann.<br />
<br />
<br />
<br />
<br />
<br />

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS.180-2.2002">[FIPS.180-2.2002]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">Secure Hash Standard</a>,&rdquo; FIPS&nbsp;PUB 180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dkim-ssp">[I-D.ietf-dkim-ssp]</a></td>
<td class="author-text">field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-ssp-10.txt">DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)</a>,&rdquo; draft-ietf-dkim-ssp-10 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-ssp-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2821">[RFC2821]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc2821">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;2821, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2821.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2822">[RFC2822]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="http://tools.ietf.org/html/rfc2822">Internet Message Format</a>,&rdquo; RFC&nbsp;2822, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2822.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4234">[RFC4234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; RFC&nbsp;4234, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
</table>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<p>Changes to 00 version:</p>
<ul class="text">
<li>Removed the term policy.
</li>
<li>Corrected _domainkey vs _domainkeys label.
</li>
<li>Corrected appendix SSP a= vs d= tag.
</li>
<li>Added additional scopes in appendix example.
</li>
</ul>

<p>Changes to 01 version:</p>
<ul class="text">
<li>Modified abstract and introduction.
</li>
<li>Removed The Signing Domain Section.
</li>
<li>Added Evaluating Signing Domains section.
</li>
<li>Added Authorized Scope section.
</li>
<li>Changed SSP-TPA "s=" tag from to "scope=".
</li>
<li>Expanded scope to include an identity ("-i") instead of "strict".
</li>
<li>Changed SSP-TPA "a=" tag from to "tpa=".
</li>
<li>Added Modification to Sender Signing Practices Check Procedures.
</li>
</ul>

<p>Changes to 01 version:</p>
<ul class="text">
<li>Modified FWS to WSP.
</li>
<li>Introduced "Discardable" assertion for DSN filtering.
</li>
<li>Updated the policy label.
</li>
<li>Modified statements regarding Domain Tasting.
</li>
</ul><p>
      
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
DNS Example of TPA-SSP From record</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
####
# Policies for Example.com email domain using both example.com, isp.com,
# and example.com.isp.com as signing domains.
####

#### 2822.From authorization for TP domains ####
                                _asp._domainkey.example.com.  IN TXT
    "dkim=all; scope=F-i:O:M;"

## "isp.com" tpa-label ##
hgssd3snmi6635j5743vdjhajkmpmfif._asp._domainkey.example.com.  IN TXT
    "dkim=all; tpa=isp.com; scope=F;"

#### 2822.From/Originator/MailFrom authorization for TP domains ####

## "example.com.isp.com" tpa-label ##
zzhffxwcfi7rpddqdigyhpbtaa7vwitu._asp._domainkey.example.com.  IN TXT
    "dkim=all; tpa=*.isp.com; scope=F-i:O:M; "
</pre></div>
<p>
        
      
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Douglas Otis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trend Micro, NSSG</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10101 N. De Anza Blvd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.408.257-1500</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:doug_otis@trendmicro.com">doug_otis@trendmicro.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
