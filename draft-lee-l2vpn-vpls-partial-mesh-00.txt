

Network Working Group                                            CY. Lee
Internet-Draft                                                   Alcatel
Expires: April 19, 2005                                 October 19, 2004


                          Partial Mesh in VPLS
               draft-lee-l2vpn-vpls-partial-mesh-00.txt

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.
   By submitting this Internet-Draft, we certify that any applicable
   patent or other IPR claims of which we are aware have been disclosed,
   and any of which we become aware will be disclosed, in accordance with
   RFC 3668.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 19, 2005.

Copyright Notice

   Copyright (C) The Internet Society (2004).  All Rights Reserved.

Abstract

   Some standard network devices may not be able to communicate with
   each other as if they were connected to a common LAN segment in the
   event of partial mesh connectivity in a VPLS.  Unless this problem is
   addressed, the deployment of VPLS may eventually be limited to sites
   not using link state routing or bridges.










Lee                      Expires April 19, 2005                 [Page 1]

Internet-Draft            Partial Mesh in VPLS              October 2004


Table of Contents

   1.   Examples of Partial Mesh Connectivity  . . . . . . . . . . . . 3
   2.   Consequences of Partial Mesh Connectivity  . . . . . . . . . . 4
   3.   Security Considerations  . . . . . . . . . . . . . . . . . . . 6
   4.   Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 7
   5.   Normative References . . . . . . . . . . . . . . . . . . . . . 7
        Author's Address . . . . . . . . . . . . . . . . . . . . . . . 7
        Intellectual Property and Copyright Statements . . . . . . . . 8










































Lee                      Expires April 19, 2005                 [Page 2]

Internet-Draft            Partial Mesh in VPLS              October 2004


1.  Examples of Partial Mesh Connectivity

   Some standard network devices may not be able to communicate with
   each other as if they were connected to a common LAN segment in the
   event of partial mesh connectivity in a VPLS.

   An example of partial mesh connectivity is :- in a full-meshed of
   tunnels connecting node A, B, C, the tunnel between A and B may be
   missing while the tunnels between A and C, and B and C are working.
   A tunnel shall be referred to as a Pseudo-Wire (PW) in this document.

   Partial mesh connectivity may occur due to various reasons, for
   instance, a PW not being configured or established properly, failed
   PWs are not restored, mal-functioning PE, a VPLS instance being
   enabled before all the PWs from/to a new site have been established
   or a PW of the full-mesh is being disabled.

   As an example, node A, B, C and D belong to a VPLS and are supposed
   to be fully-meshed.  If B has no PW to C and B does not know C is a
   member of a VPLS, then the network operator cannot be alerted of the
   partial  mesh connectivity in a VPLS.  In contrast, if node A, B, C
   and D span a tree, and there is supposed to be a branch from B to C,
   but B does not know C is a member of a VPLS and hence has no PW to C,
   then the tree is simply partitioned with B on one partition and C on
   the other partition.


























Lee                      Expires April 19, 2005                 [Page 3]

Internet-Draft            Partial Mesh in VPLS              October 2004


2.  Consequences of Partial Mesh Connectivity

   In a tree-based emulated LAN architecture, if a link is not working
   and not protected or restored,  the emulated LAN or tree is
   partitioned.  Routers and bridges work in this situation as on a LAN.

   If a VPLS is partitioned like a tree such that all all members cannot
   reach another member, routers and bridges function as they are on a
   LAN as well.  However, if a VPLS is not partitioned in that manner,
   such that only  a pair of PEs cannot reach each other, while other
   PEs can reach each other, aka partial mesh connectivity; routers and
   bridges may not behave as expected.

   Some examples where routers and bridges cannot work as on a LAN (when
   there is partial mesh connectivity in VPLS) are :

   1.  If a customer router B has no corresponding working PW to one of
   the sites of a VPLS, say site C, but has corresponding working PWs to
   all other sites including the site where the Designated Router is,
   the customer router may black-hole traffic to the site C where the
   corresponding PW is not working.  The customer router B black-hole
   traffic because it can still receive link states advertised by the
   router at site C via the Designated Router at A.

   To illustrate this issue, assume three routers R1, R2, and R3, which
   is using OSPF or IS-IS with broadcast mode, are connected in a VPLS.
   R1 is DR (OSPF) or DIS (IS-IS), and the other routers are BDR/DROther
   (OSPF) or non-DIS (IS-IS).  Routing information is propagated between
   R1-R2 and R1-R3.  In this situation, if a PW between R2 and R3 is
   missing, the OSPF/IS-IS protocol cannot notify R1 DR/DIS.  This is
   because the broadcast mode assumes routers are interconnected with a
   single medium and is not designed to handle this kind of error.
   Therefore routing information is not changed and as a result, a
   black-hole is formed between R2 and R3.  Note that the NBMA mode has
   the same problem.

   This problem can be avoided by using the point-to-multipoint mode of
   OSPF [On VPLS and Routing Protocols].  However, there is no need for
   a VPLS in that case.  The customer subscribes point-to-point links
   from the provider and the customer uses the point-to-multipoint mode
   in OSPF.  Further, it does not seem to make sense if the provider has
   a VPLS solution but provide point-to-point connectivity instead to
   allow the customer to get around this partial mesh issue.

   On the other hand, if a customer uses point-to-point links :-

   - the number of router "adjacencies that need to be established is
   O(N^2) (vs O(N) in the broadcast network case) which affects the



Lee                      Expires April 19, 2005                 [Page 4]

Internet-Draft            Partial Mesh in VPLS              October 2004


   complexity of the routing protocol operation, most notably", in terms
   of the link-state database size, the amount of routing protocol
   traffic and SPF computation.

   - the customer may have to manually configure neighbors.

   2.  If a customer bridge has no corresponding working PW to one of
   the sites of a VPLS, but has corresponding working PWs to all other
   sites including the site where the Root Bridge is located, the
   customer bridge cannot failover to a backup link.

   Hence bridges and link state routers experience loss of connectivity
   (that persist as long as the PW is missing) to a site even if the
   customer devices have alternate paths to the site.  On the other
   hand, a customer device cannot simply use alternate paths since the
   customer device is still partially connected to the emulated LAN.  If
   a customer uses the point-to-multipoint mode in OSPF to get around
   this problem, there is no need for a VPLS then.

   If this issue is not addressed, the deployment of VPLS may eventually
   be limited to sites which do not use bridges or link state routing.






























Lee                      Expires April 19, 2005                 [Page 5]

Internet-Draft            Partial Mesh in VPLS              October 2004


3.  Security Considerations

   This draft does not introduce any new security issues in VPLS.
















































Lee                      Expires April 19, 2005                 [Page 6]

Internet-Draft            Partial Mesh in VPLS              October 2004


4.  Acknowledgements

   We would like to thank the IS-IS and OSPF WG and IEEE 802.1 for
   clarifying some of the issues routers and bridges have with partial
   mesh connectivity in an emulated LAN.  The draft has also benefited
   from valuable suggestions by Muneyoshi Suzuki, Vach Kompella, Dimitri
   Papadimitriou, Italo Busi and Chris Liljenstolpe.

5  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", RFC 2119, March 1997.

   [VPLS]     Lasseurre, M. and V. Kompella, "Virtual Private LAN
              Service",  draft-ietf-l2vpn-vpls-ldp-05.txt, 2004.

   [On VPLS and Routing Protocols]
              Zinin, A., "On VPLS and Routing Protocols",
              http://www1.ietf.org/mail-archive/web/l2vpn/current/msg000
              65.html.


Author's Address

   Cheng-Yin Lee
   Alcatel
   600 March Rd
   Ottawa
   Canada

   Phone:
   EMail: Cheng-Yin.Lee@alcatel.com



















Lee                      Expires April 19, 2005                 [Page 7]

Internet-Draft            Partial Mesh in VPLS              October 2004


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11.  Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.


Full Copyright Statement

   Copyright (C) The Internet Society (2004).  All Rights Reserved.

   This document is subject to the rights, licenses and restrictions contained 
   in BCP 78, and except as set forth therein, the authors retain all their rights.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.









Lee                      Expires April 19, 2005                 [Page 8]

Internet-Draft            Partial Mesh in VPLS              October 2004


    This document and the information contained herein are provided on an
    "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
    OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
    ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED
    INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
    INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
    WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.











































Lee                      Expires April 19, 2005                 [Page 9]


