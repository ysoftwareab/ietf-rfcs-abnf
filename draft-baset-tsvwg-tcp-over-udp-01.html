<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>TCP-over-UDP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TCP-over-UDP">
<meta name="keywords" content="TCP UDP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Transport Area Working Group</td><td class="header">S. Baset</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">H. Schulzrinne</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">Columbia University</td></tr>
<tr><td class="header">Expires: December 9, 2009</td><td class="header">June 07, 2009</td></tr>
</table></td></tr></table>
<h1><br />TCP-over-UDP<br />draft-baset-tsvwg-tcp-over-udp-01</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 9, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>We present TCP-over-UDP (ToU), an instance of TCP on top of UDP. It provides
      exactly the same congestion control, flow control, reliability, and extension
      mechanisms as offered by TCP. It is intended for use in scenarios where applications
      running on two hosts may not be able to establish a direct TCP connection but are 
      able to exchange UDP packets.      
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Terminology<br />
<a href="#anchor4">2.</a>&nbsp;
Model of Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
Setup and tear down<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.</a>&nbsp;
Connection tracking<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.3.</a>&nbsp;
MTU discovery<br />
<a href="#anchor8">3.</a>&nbsp;
Congestion Control, Flow Control, and Reliability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.1.</a>&nbsp;
Explicit Congestion Notification (ECN)<br />
<a href="#anchor10">4.</a>&nbsp;
Header Format<br />
<a href="#anchor11">5.</a>&nbsp;
NAT related issues<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.1.</a>&nbsp;
Using ToU<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.2.</a>&nbsp;
NAT bindings<br />
<a href="#anchor14">6.</a>&nbsp;
ToU, TLS, and DTLS<br />
<a href="#anchor15">7.</a>&nbsp;
Implementation Guidelines<br />
<a href="#anchor16">8.</a>&nbsp;
Design Alternatives<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">8.1.</a>&nbsp;
Changing IP protocol number<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">8.2.</a>&nbsp;
Simplified TCP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">8.3.</a>&nbsp;
TCP-like mechanism within an application layer protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">8.4.</a>&nbsp;
Tunneling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tfrc">8.5.</a>&nbsp;
TFRC<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">8.6.</a>&nbsp;
SCTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">8.7.</a>&nbsp;
Criticism<br />
<a href="#Acknowledgements">9.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">10.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">11.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#anchor25">Appendix&nbsp;A.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">A.1.</a>&nbsp;
Changes since draft-baset-tsvwg-tcp-over-udp-00<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        Network address translators (NATs) pose a challenge for establishing
        a direct TCP connection between hosts. While TCP connectivity works when 
        a TCP client is behind a NAT device and the server is not, it is 
        problematic when both the TCP client and server are behind different NAT 
        devices. Thus, applications running on hosts behind different NAT devices
        may not be able to establish a direct TCP connection with each other.
        Instead, these applications must establish a TCP connection with a 
        reachable host, which relays the traffic of the application on the first 
        host to the application on the second host and vice versa. While this 
        works, this is undesirable as it creates a dependency on a reachable host. 
        With certain NAT types, even though the applications cannot 
        establish a direct TCP connection, they may be able to exchange UDP 
        traffic by using techniques such as 
        <a class='info' href='#I-D.ietf-mmusic-ice'>ICE-UDP<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mmusic&#8209;ice]. Thus, using UDP is
        attractive for such applications as it removes the dependency on a
        reachable host. However, these applications have a requirement
        that the underlying transport be reliable. Further, these applications
        may run on machines with heterogeneous network connectivity, thereby
        requiring flow control. UDP does not provide reliability, congestion
        control, or flow control semantics. Therefore, these applications may
        either use TCP with a reachable host, or invent their own reliable,
        congestion control, and flow control transport protocol to establish
        a direct connection.
      
</p>
<p>
        We present TCP-over-UDP (ToU), a reliable, congestion control, and flow control 
        transport protocol on top of UDP. The idea is that TCP is a well-designed
        transport protocol that provides reliable, congestion control, and flow control
        mechanisms and these mechanisms must be reused as much as possible. Further, 
        a transport protocol that provides reliability and flow control mechanisms 
        must not be tied to a specific application and must be designed to provide modular
        functionality. To accomplish this, ToU almost uses the same header as TCP
        which allows to easily incorporate TCP's reliable and congestion 
        control algorithms as defined in 
        <a class='info' href='#I-D.ietf-tcpm-rfc2581bis'>TCP congestion control<span> (</span><span class='info'>Allman, M., Paxson, V., and E. Blanton, &ldquo;TCP Congestion Control,&rdquo; July&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;tcpm&#8209;rfc2581bis] 
        document. In essence, ToU is not a new protocol 
        but merely an instance (or profile) of TCP over UDP minus the TCP checksum, 
        urgent flag, and urgent data.
      
</p>
<p>
        We think that our approach is attractive for several reasons. First,
        we are not proposing a new congestion control algorithm. Designing
        new congestion control algorithms is complex, and requires
        a large validation effort. Second, our approach takes advantage
        of existing user-level-TCP (such as <a class='info' href='#Daytona'>Daytona<span> (</span><span class='info'>Pradhan, P., Kandula, S., Xu, W., Sheikh, A., and E. Nahum, &ldquo;Daytona : A User-Level TCP Stack,&rdquo; 2004.</span><span>)</span></a> [Daytona]
        and <a class='info' href='#MINET'>MINET<span> (</span><span class='info'>Dinda, P., &ldquo;The Minet TCP/IP Stack,&rdquo; 2002.</span><span>)</span></a> [MINET])
        or TCP-over-UDP implementations (such as <a class='info' href='#atou'>atou<span> (</span><span class='info'>Dunigan, T. and F. Fowler, &ldquo;A TCP-over-UDP Test Harness,&rdquo; 2002.</span><span>)</span></a> [atou]). Finally,
        since we are replicating TCP semantics over UDP, any TCP options such 
        as <a class='info' href='#RFC1323'>window scaling<span> (</span><span class='info'>Jacobson, V., Braden, B., and D. Borman, &ldquo;TCP Extensions for High Performance,&rdquo; May&nbsp;1992.</span><span>)</span></a> [RFC1323],         
        <a class='info' href='#RFC2018'>selective acknowledgement option (SACK)<span> (</span><span class='info'>Mathis, M., Mahdavi, J., Floyd, S., and A. Romanow, &ldquo;TCP Selective Acknowledgment Options,&rdquo; October&nbsp;1996.</span><span>)</span></a> [RFC2018],
        or proposed TCP options such 
        as <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>TCP-Auth<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt] can be 
        easily incorporated in ToU without a new standardization effort.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>
          We use the terms such as congestion window (cwnd), initial window (IW),
          restart window (RW), receiver window (rwnd), and sender maximum segment 
          size (SMSS) as defined 
          in <a class='info' href='#I-D.ietf-tcpm-rfc2581bis'>TCP congestion control<span> (</span><span class='info'>Allman, M., Paxson, V., and E. Blanton, &ldquo;TCP Congestion Control,&rdquo; July&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;tcpm&#8209;rfc2581bis]
          document.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Model of Operation</h3>

<p>Like TCP, ToU has a client and a server. A client connects to a TCP server to establish
      a ToU connection. Below, we describe the key ToU operations.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Setup and tear down</h3>

<p>
          Like TCP, ToU uses a three-way handshake to establish a connection. Similarly, it
          follows TCP's semantics in tearing down the connection.
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Connection tracking</h3>

<p>
          A key difference between TCP and UDP is that the former is connection-oriented whereas
          the later is not. This means that a ToU server must provide a way to keep track of existing
          connections. It does so through the source port and IP address of the UDP packet.
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
MTU discovery</h3>

<p>ToU uses <a class='info' href='#RFC4821'>packetization layer path MTU discovery<span> (</span><span class='info'>Mathis, M. and J. Heffner, &ldquo;Packetization Layer Path MTU Discovery,&rdquo; March&nbsp;2007.</span><span>)</span></a> [RFC4821] to discover 
        link MTU. 
</p>
<p>Some NAT devices placed in front of PPPoE devices perform MSS clamping, i.e., they
        rewrite TCP's MSS option in a SYN packet from 1500 bytes to 1492 bytes. This operation is
        performed because PPPoE has a MTU of 1492 bytes instead of Ethernet's 1500 bytes. 
        MSS clamping is considered a 'faster' way of discovering MTU in such scenarios. MSS clamping 
        does not work for ToU because NAT devices treat ToU packets as a stream of UDP packets. It is 
        an open question how a ToU stack should deal with PPPoE MTU if faster MTU discovery is desired. 
        One option is to configure ToU stack with a default MTU of 1492 bytes.
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Congestion Control, Flow Control, and Reliability</h3>

<p>ToU follows the TCP congestion control algorithms described in 
        <a class='info' href='#I-D.ietf-tcpm-rfc2581bis'>TCP congestion control<span> (</span><span class='info'>Allman, M., Paxson, V., and E. Blanton, &ldquo;TCP Congestion Control,&rdquo; July&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;tcpm&#8209;rfc2581bis] document. 
        Thus, a ToU sender goes through the slow-start and congestion-avoidance phases. 
        A ToU sender
        starts with an initial window (IW) following the guidelines in 
        <a class='info' href='#RFC3390'>RFC 3390<span> (</span><span class='info'>Allman, M., Floyd, S., and C. Partridge, &ldquo;Increasing TCP's Initial Window,&rdquo; October&nbsp;2002.</span><span>)</span></a> [RFC3390]. During slow start, a ToU sender 
        increments congestion window (cwnd) by at most SMSS bytes for each ACK 
        received that cumulatively acknowledges new data. It switches to congestion 
        avoidance when the congestion window (cwnd) exceeds slow start threshold 
        (ssthresh). A ToU receiver generates an acknowledgement following the
        guidelines in 
        <a class='info' href='#I-D.ietf-tcpm-rfc2581bis'>Section 4.2 of TCP congestion control<span> (</span><span class='info'>Allman, M., Paxson, V., and E. Blanton, &ldquo;TCP Congestion Control,&rdquo; July&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;tcpm&#8209;rfc2581bis]
        document. It immediately generates an ACK when an out-of-order
        segment arrives. The ToU sender uses the fast retransmit algorithm
        to detect and repair losses, and fast recovery algorithm to govern the 
        transmission of new data until a non-duplicate ACK arrives. When ToU sender 
        has not received a segment for more than one retransmission timeout (RTO), cwnd 
        is reduced to the value of the restart window (RW) before transmission begins.
        The ToU sender may also use 
        <a class='info' href='#RFC2018'>selective acknowledgement option (SACK)<span> (</span><span class='info'>Mathis, M., Mahdavi, J., Floyd, S., and A. Romanow, &ldquo;TCP Selective Acknowledgment Options,&rdquo; October&nbsp;1996.</span><span>)</span></a> [RFC2018] to improve
        loss recovery when multiple packets are lost from one window of data. Like
        TCP, it uses receiver window (rwnd) to achieve flow control.
      
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Explicit Congestion Notification (ECN)</h3>

<p>
          TCP-over-UDP operates above UDP. To use <a class='info' href='#RFC3168'>ECN<span> (</span><span class='info'>Ramakrishnan, K., Floyd, S., and D. Black, &ldquo;The Addition of Explicit Congestion Notification (ECN) to IP,&rdquo; September&nbsp;2001.</span><span>)</span></a> [RFC3168] with
          ToU, a UDP socket must allow ToU to set and retrieve the ECN bits in the
          IP header. Currently, UDP sockets do not provide such a mechanism. However,
          ToU assumes that in future, UDP sockets will provide this mechanism so that
          ECN can be incorporated in the congestion control mechanism of ToU.
        
</p>
<p>
          ToU endpoints also need to determine whether they both support ECN.
          Similar to ECE and CWR flags for TCP as defined in <a class='info' href='#RFC3168'>ECN<span> (</span><span class='info'>Ramakrishnan, K., Floyd, S., and D. Black, &ldquo;The Addition of Explicit Congestion Notification (ECN) to IP,&rdquo; September&nbsp;2001.</span><span>)</span></a> [RFC3168],
          ToU header includes these flags.
        
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Header Format</h3>

<p>
        A ToU header is like a <a class='info' href='#RFC0793'>TCP header<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> [RFC0793]
        except that it does not include source port, destination port,
        and checksum, as they are already included in the UDP header.
        ToU header also does not include the 1-bit Urgent flag and bit 
        corresponding to this flags are reserved in the ToU header. Further, it 
        also does not include the 16-bit Urgent Pointer. The reason for 
        excluding Urgent flag and Urgent pointer is that they are only used 
        in <a class='info' href='#RFC0854'>Telnet<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;Telnet Protocol Specification,&rdquo; May&nbsp;1983.</span><span>)</span></a> [RFC0854] which is not a widely used 
        protocol.
      
</p>
<p>
        Between sequence number and acknowledgement number, ToU header 
        has a 32-bit magic cookie to demultiplex it with other UDP-based 
        protocols such as <a class='info' href='#RFC5389'>STUN<span> (</span><span class='info'>Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;Session Traversal Utilities for NAT (STUN),&rdquo; October&nbsp;2008.</span><span>)</span></a> [RFC5389].
        A ToU header also includes ECE and CWR flags for negotiating ECN
        capabilities. These flags are defined 
        in <a class='info' href='#RFC3168'>RFC 3168<span> (</span><span class='info'>Ramakrishnan, K., Floyd, S., and D. Black, &ldquo;The Addition of Explicit Congestion Notification (ECN) to IP,&rdquo; September&nbsp;2001.</span><span>)</span></a> [RFC3168].
        The rest of the fields in a ToU header have exactly the same meaning
        as those in a TCP header. The size of the fixed ToU header is 
        16 bytes, whereas the size of fixed TCP header is 20 bytes. The fixed 
        ToU header and UDP header have a cumulative size of 24 bytes, four 
        more than a fixed TCP header.
      
</p><br /><hr class="insert" />
<a name="tou_header"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Magic Cookie                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Acknowledgment Number                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Data |       |C|E| |A|P|R|S|F|                               |
   | Offset|Reserve|W|C|R|C|S|S|Y|I|            Window             |
   |       |       |R|E| |K|H|T|N|N|                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Options                    |    Padding    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             data                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p style='text-align: center'>Header for TCP-over-UDP (ToU)
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
        Since ToU header fields are exactly the same as TCP, we have borrowed
        their descriptions from the <a class='info' href='#RFC0793'>TCP RFC<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> [RFC0793].
        </p>
<blockquote class="text"><dl>
<dt>Sequence Number (32-bits):</dt>
<dd> Same as a TCP sequence number.
</dd>
<dt>Magic Cookie (32-bits):</dt>
<dd>
            A fixed value of 0x7194B32E in network byte order to demultiplex ToU from 
            other application layer protocols.
          
</dd>
<dt>Acknowledgement Number (32-bits):</dt>
<dd> Same as a TCP acknowledgement number.
</dd>
<dt>Data offset (4-bits):</dt>
<dd>
            The number of 32-bit words in ToU header. Like a TCP header,
            ToU header is an integral number of 32-bits long.
          
</dd>
<dt>Reserved (4-bits):</dt>
<dd> Reserved for future use. Must be zero.
</dd>
<dt>Control Bits (8-bits):</dt>
<dd>8-bits from left to right. Unlike TCP, the 
           Urgent bit is excluded.
</dd>
<dt></dt>
<dd> CWR:  Congestion window reduced flag as defined in <a class='info' href='#RFC3168'>RFC 3168<span> (</span><span class='info'>Ramakrishnan, K., Floyd, S., and D. Black, &ldquo;The Addition of Explicit Congestion Notification (ECN) to IP,&rdquo; September&nbsp;2001.</span><span>)</span></a> [RFC3168].
</dd>
<dt></dt>
<dd> ECE:  ECN-Echo flag as defined in <a class='info' href='#RFC3168'>RFC 3168<span> (</span><span class='info'>Ramakrishnan, K., Floyd, S., and D. Black, &ldquo;The Addition of Explicit Congestion Notification (ECN) to IP,&rdquo; September&nbsp;2001.</span><span>)</span></a> [RFC3168].
</dd>
<dt></dt>
<dd> R:    Reserved in ToU. In the TCP header, it is used for the Urgent bit.
</dd>
<dt></dt>
<dd> ACK:  Acknowledgment field significant
</dd>
<dt></dt>
<dd> PSH:  PSH function.
</dd>
<dt></dt>
<dd> RST:  Reset the connection
</dd>
<dt></dt>
<dd> SYN:  Synchronize sequence numbers
</dd>
<dt></dt>
<dd> FIN:  No more data from sender
</dd>
<dt>Window (16-bits):</dt>
<dd>
            Same as the window in TCP header. The number of data octets beginning with 
            the one indicated in the acknowledgment field which the sender of this segment is 
            willing to accept.
          
</dd>
<dt>Options:</dt>
<dd>Same as TCP options.
</dd>
<dt>Padding:</dt>
<dd>
            Like TCP, the ToU header padding is used to ensure that the ToU header ends
            and data begins on a 32 bit boundary.  The padding is composed of zeros.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
NAT related issues</h3>

<p>
        This section discusses how to determine if hosts should use ToU and the impact
        of UDP NAT bindings on ToU connection management.
      
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Using ToU</h3>

<p>
          Hosts should only use ToU when establishing a direct TCP connection fails.
          It is outside the scope of this draft to specify a mechanism to determine 
          if establishing a TCP connection fails between two hosts behind NATs.
          Hosts may use <a class='info' href='#I-D.ietf-mmusic-ice-tcp'>ICE-TCP<span> (</span><span class='info'>Perreault, S. and J. Rosenberg, &ldquo;TCP Candidates with Interactive Connectivity Establishment (ICE),&rdquo; October&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mmusic&#8209;ice&#8209;tcp]
          and <a class='info' href='#I-D.ietf-mmusic-ice'>ICE-UDP<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mmusic&#8209;ice] to determine if hosts
          can directly establish a TCP connection or directly exchange UDP packets, 
          respectively. If hosts fail to establish a direct TCP connection but 
          are able to directly exchange UDP packets, they can establish a ToU connection.
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
NAT bindings</h3>

<p>
          NAT devices maintain a binding for mapping an internal IP address and port number
          to an external IP address and port number. The lifetime of bindings for UDP is 
          much smaller than TCP because UDP is a connection less protocol. If an application
          does not send packets over ToU, the UDP binding may be lost resulting in a broken
          ToU connection.
        
</p>
<p>
          ToU does not provide any mechanism to determine UDP binding lifetimes or to refresh 
          these bindings. Rather, an application establishing a ToU connection can use <a class='info' href='#RFC5389'>STUN<span> (</span><span class='info'>Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;Session Traversal Utilities for NAT (STUN),&rdquo; October&nbsp;2008.</span><span>)</span></a> [RFC5389] 
          to <a class='info' href='#I-D.ietf-behave-nat-behavior-discovery'>discover<span> (</span><span class='info'>MacDonald, D. and B. Lowekamp, &ldquo;NAT Behavior Discovery Using STUN,&rdquo; September&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;behave&#8209;nat&#8209;behavior&#8209;discovery] binding 
          lifetimes and periodically refresh these bindings. Running STUN in conjunction
          with ToU has a design implication that a ToU packet must be differentiated from 
          a STUN packet. The magic cookie in a ToU packet serves this purpose.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
ToU, TLS, and DTLS</h3>

<p>
        <a class='info' href='#RFC5246'>Transport layer security (TLS)<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] and
        <a class='info' href='#RFC4347'>Datagram transport layer security (DTLS)<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a> [RFC4347] 
        protocols provide privacy and data integrity between two communicating applications. 
        TLS is layered on top of some reliable transport protocol such as TCP, whereas DTLS
        only assumes a datagram service. A question is what is the layering relationship 
        between ToU protocol, TLS, and DTLS. <a class='info' href='#tou_tls'>Figure&nbsp;2</a> shows 
        three possible options. Option-3 is not feasible since ToU layer must be
        made aware of the size of header which DTLS may add. Option-2 layers
        DTLS on top of ToU. Unlike TLS, DTLS carries a sequence number because
        it assumes a datagram service. However, the use of sequence number is
        made redundant because ToU provides reliable and inorder delivery semantics.
        Therefore, Option-1 is most feasible in which TLS is layered on top of
        ToU.
      
</p><br /><hr class="insert" />
<a name="tou_tls"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   +-+-+-+-+   +-+-+-+-+   +-+-+-+-+
   |  TLS  |   |  DTLS |   |  ToU  |
   +-+-+-+-+   +-+-+-+-+   +-+-+-+-+
   |  ToU  |   |  ToU  |   |  DTLS |
   +-+-+-+-+   +-+-+-+-+   +-+-+-+-+
   |  UDP  |   |  UDP  |   |  UDP  |
   +-+-+-+-+   +-+-+-+-+   +-+-+-+-+
   Option-1    Option-2    Option-3

</pre></div>
<p style='text-align: center'>Layering options for ToU, TLS, DTLS
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Implementation Guidelines</h3>

<p>
        From the implementers perspective, the use of ToU should be as modular
        as possible. Once way to achieve this modularity is to implement ToU
        as a user-level library that provides socket-like function calls to
        the applications. The library may have its own thread of execution and
        can be instantiated at the start of the program. The library implements the
        reliable, inorder, congestion control, and flow control semantics of TCP.
        Applications can interact with the ToU library through socket-like function calls.
      
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Design Alternatives</h3>

<p>
        ToU is strictly meant for scenarios where end-points desire to establish a TCP
        connection but are unable to do so due to the presence of NATs and firewalls.
        Below, we briefly discuss the design alternatives and address possible criticisms
        for ToU.
      
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Changing IP protocol number</h3>

<p>
          One solution is to change the IP protocol number of TCP packets to UDP before
          sending them on the wire. Similarly, when the packets are received, the protocol
          number is changed back to TCP and the received packets are passed to the TCP stack.
          The idea behind this approach is to reuse TCP stack as much as possible.
          This approach suffers from a number of problems. First, it requires a change in the
          operating system kernel to rewrite IP protocol number of TCP packets to UDP and it
          is unrealistic to expect all the OS kernels to implement this change. Second, TCP 
          checksum has a different offset than a UDP checksum and many NAT devices parsing 
          the UDP packet will reject the packet because the UDP checksum is incorrect.
          Third, since applications can use the same port number for TCP and UDP ports,
          it is unclear how the kernel will correctly differentiate between TCP and UDP
          packets for the same port number.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Simplified TCP</h3>

<p>It may be argued that TCP semantics are too complicated and it might be easier
        to define a protocol that adds retransmission of individual UDP packets, and
        ACK mechanisms, and sequencing layer. However, unless one is content with 
        stop-and-wait congestion control (and roughly modem data rates), it is necessary 
        for a transport protocol to have AIMD or rate-based congestion control (TFRC). 
        As discussed in <a class='info' href='#tfrc'>Section&nbsp;8.5<span> (</span><span class='info'>TFRC</span><span>)</span></a>, rate-based congestion control 
        is not suitable for mid-sized transfers and is not any simpler than AIMD.        
        Further, since hosts may have heterogeneous network connectivity, a transport protocol
        needs to provide flow control. Moreover, it may not be easy to validate a new
        transport protocol that only provides selective TCP semantics. 
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
TCP-like mechanism within an application layer protocol</h3>

<p>
          In this approach, key TCP mechanisms such as reliability, congestion control, 
          and flow control are designed as part of the application layer protocol. This approach 
          has several disadvantages. First, every application layer protocol that is unable 
          to establish TCP connections in the presence of NAT and firewalls but may 
          use UDP will need to invent its own reliable, congestion control and flow 
          control transport protocol. Second, it is non-trivial to get the first implementations 
          of a conceptually new protocol right. Third, any new transport protocol, even if 
          it is specified within an application layer protocol must undergo a large 
          validation effort. Finally, most long-term successful protocols are those 
          that provide modular functionality, and not extremely narrowly-tailored protocols.
        
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Tunneling</h3>

<p>
          Another design option is to provide a VPN-like tunnel for sending and receiving TCP 
          packets over UDP. The idea is to use tunneling solutions between hosts so that hosts can 
          use the kernel TCP stack and unmodified socket functions calls.
        
</p>
<p>
          This approach is not desirable for several reasons. First, tunneling solutions
          typically require support from kernel or require kernel upgrades to work. Requiring 
          kernel upgrades to work is not plausible for an application that is trying to get 
          deployment traction. Second, establishing a tunnel typically requires root access to
          the system and it is unrealistic for user-space applications to require root
          access for proper functioning. Third, peer-to-peer applications, which are expected
          to use ToU, establish a large number of connections with other hosts. Even, if a 
          tunneling solution does not require any kernel support, such a solution consumes
          significant bandwidth and CPU resources to maintain a large number of tunnels with 
          other hosts. Popular P2P applications such as Skype and Bittorrent do not 
          take advantage of a layer-3 tunneling solution.
</p>
<a name="tfrc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
TFRC</h3>

<p>
          <a class='info' href='#RFC5348'>TFRC<span> (</span><span class='info'>Floyd, S., Handley, M., Padhye, J., and J. Widmer, &ldquo;TCP Friendly Rate Control (TFRC): Protocol Specification,&rdquo; September&nbsp;2008.</span><span>)</span></a> [RFC5348] is a congestion control mechanism (not
          a protocol) that is designed for long-lived media streams. Its main benefit
          is of smoothing rates to these media streams. It does not
          provide any packet formats, reliability, or flow control. It's congestion
          control mechanism is not suited for exchanging data objects that range from a 
          few dozen to a few hundred packets. The reason is that TFRC is based on 
          estimating loss rates within 8 loss intervals. With a loss rate of 
          1%, this translates, very roughly, into 800 packets or roughly 800 kB, 
          before a reliable estimate of a better (higher) rate is computed. Further, 
          its main  benefit, smoothing rates, is of no importance to applications desiring
          to replicate TCP functionality over UDP.          
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.6"></a><h3>8.6.&nbsp;
SCTP</h3>

<p>
          <a class='info' href='#RFC4960'>SCTP<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4960] is significantly more complicated than 
          TCP in its implementation and
          its performance is generally the same, except in circumstances involving
          head-of-line blocking. Further, SCTP will have trouble getting traction in 
          the consumer and enterprise Internet space unless it (also) runs over UDP, 
          as there seem to be few NATs that know how to handle SCTP and thus it is 
          effectively unusable by a fair fraction of the Internet user population.
        
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.7"></a><h3>8.7.&nbsp;
Criticism</h3>

<p>
          A criticism of the ToU approach is that it is deceptively simple to describe but
          difficult to implement and is likely to suffer from
          broken implementations. We think that this assertion is not valid for three reasons.
          First, ToU does not define a new congestion control protocol and thus stays away from
          all the validation issues associated with a new congestion control protocol. Second,
          a reasonable implementation approach is to first implement connection
          management and AIMD congestion control and test it with regular TCP to determine
          if the implemented congestion control mechanisms are broken. This implementation
          can be followed by implementing TCP options such as window scaling and SACK. Third,
          ToU like other protocols such as SIP will be implemented as a module or library
          and is likely to mature over time.
        
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>
        The draft incorporates comments from the discussion on TSVWG and P2PSIP mailing list. We also
        acknowledge an earlier draft by R. Denis-Courmont on UDP transports.
      
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>TBD.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>ToU is subject to the same security considerations as TCP.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tcpm-rfc2581bis">[I-D.ietf-tcpm-rfc2581bis]</a></td>
<td class="author-text">Allman, M., Paxson, V., and E. Blanton, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-rfc2581bis-07.txt">TCP Congestion Control</a>,&rdquo; draft-ietf-tcpm-rfc2581bis-07 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-rfc2581bis-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tcpm-tcp-auth-opt">[I-D.ietf-tcpm-tcp-auth-opt]</a></td>
<td class="author-text">Touch, J., Mankin, A., and R. Bonica, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">The TCP Authentication Option</a>,&rdquo; draft-ietf-tcpm-tcp-auth-opt-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0854">[RFC0854]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc854">Telnet Protocol Specification</a>,&rdquo; STD&nbsp;8, RFC&nbsp;854, May&nbsp;1983 (<a href="http://www.rfc-editor.org/rfc/rfc854.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1122">[RFC1122]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1122">Requirements for Internet Hosts - Communication Layers</a>,&rdquo; STD&nbsp;3, RFC&nbsp;1122, October&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1122.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1323">[RFC1323]</a></td>
<td class="author-text"><a href="mailto:van@CSAM.LBL.GOV">Jacobson, V.</a>, <a href="mailto:Braden@ISI.EDU">Braden, B.</a>, and <a href="mailto:dab@cray.com">D. Borman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1323">TCP Extensions for High Performance</a>,&rdquo; RFC&nbsp;1323, May&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1323.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2018">[RFC2018]</a></td>
<td class="author-text"><a href="mailto:mathis@psc.edu">Mathis, M.</a>, <a href="mailto:mahdavi@psc.edu">Mahdavi, J.</a>, <a href="mailto:floyd@ee.lbl.gov">Floyd, S.</a>, and <a href="mailto:allyn@eng.sun.com">A. Romanow</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2018">TCP Selective Acknowledgment Options</a>,&rdquo; RFC&nbsp;2018, October&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2018.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2018.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2018.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3168">[RFC3168]</a></td>
<td class="author-text">Ramakrishnan, K., Floyd, S., and D. Black, &ldquo;<a href="http://tools.ietf.org/html/rfc3168">The Addition of Explicit Congestion Notification (ECN) to IP</a>,&rdquo; RFC&nbsp;3168, September&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3168.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3390">[RFC3390]</a></td>
<td class="author-text">Allman, M., Floyd, S., and C. Partridge, &ldquo;<a href="http://tools.ietf.org/html/rfc3390">Increasing TCP's Initial Window</a>,&rdquo; RFC&nbsp;3390, October&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3390.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4347">[RFC4347]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://tools.ietf.org/html/rfc4347">Datagram Transport Layer Security</a>,&rdquo; RFC&nbsp;4347, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4347.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4821">[RFC4821]</a></td>
<td class="author-text">Mathis, M. and J. Heffner, &ldquo;<a href="http://tools.ietf.org/html/rfc4821">Packetization Layer Path MTU Discovery</a>,&rdquo; RFC&nbsp;4821, March&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4821.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4960">[RFC4960]</a></td>
<td class="author-text">Stewart, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4960">Stream Control Transmission Protocol</a>,&rdquo; RFC&nbsp;4960, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4960.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5348">[RFC5348]</a></td>
<td class="author-text">Floyd, S., Handley, M., Padhye, J., and J. Widmer, &ldquo;<a href="http://tools.ietf.org/html/rfc5348">TCP Friendly Rate Control (TFRC): Protocol Specification</a>,&rdquo; RFC&nbsp;5348, September&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5348.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5389">[RFC5389]</a></td>
<td class="author-text">Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;<a href="http://tools.ietf.org/html/rfc5389">Session Traversal Utilities for NAT (STUN)</a>,&rdquo; RFC&nbsp;5389, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5389.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="Daytona">[Daytona]</a></td>
<td class="author-text">Pradhan, P., Kandula, S., Xu, W., Sheikh, A., and E. Nahum, &ldquo;<a href="http://nms.lcs.mit.edu/~kandula/data/daytona.pdf">Daytona : A User-Level TCP Stack</a>,&rdquo; 2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-behave-nat-behavior-discovery">[I-D.ietf-behave-nat-behavior-discovery]</a></td>
<td class="author-text">MacDonald, D. and B. Lowekamp, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-nat-behavior-discovery-08.txt">NAT Behavior Discovery Using STUN</a>,&rdquo; draft-ietf-behave-nat-behavior-discovery-08 (work in progress), September&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-nat-behavior-discovery-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-ice">[I-D.ietf-mmusic-ice]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols</a>,&rdquo; draft-ietf-mmusic-ice-19 (work in progress), October&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-ice-tcp">[I-D.ietf-mmusic-ice-tcp]</a></td>
<td class="author-text">Perreault, S. and J. Rosenberg, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-tcp-08.txt">TCP Candidates with Interactive Connectivity Establishment (ICE)</a>,&rdquo; draft-ietf-mmusic-ice-tcp-08 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-tcp-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MINET">[MINET]</a></td>
<td class="author-text">Dinda, P., &ldquo;<a href="http://cs.northwestern.edu/~pdinda/minet/NWU-CS-02-08.pdf">The Minet TCP/IP Stack</a>,&rdquo; 2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="atou">[atou]</a></td>
<td class="author-text">Dunigan, T. and F. Fowler, &ldquo;<a href="http://www.csm.ornl.gov/~dunigan/atou.ps">A TCP-over-UDP Test Harness</a>,&rdquo; 2002.</td></tr>
</table>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Changes since draft-baset-tsvwg-tcp-over-udp-00</h3>

<p>
          </p>
<ul class="text">
<li>Updated introduction to reflect that it is difficult for two hosts behind 
            two different NATs to establish a TCP connection.
</li>
<li>Added PSH bit.
</li>
<li>Added MTU discovery to model of operation section.
</li>
<li>Added text on ECN to congestion control section.
</li>
<li>Added a section on NAT related issues.
</li>
<li>Updated text in design alternatives section.
</li>
</ul><p>
        
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salman A. Baset</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1214 Amsterdam Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">New York, NY</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:salman@cs.columbia.edu">salman@cs.columbia.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henning Schulzrinne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1214 Amsterdam Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">New York, NY</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hgs@cs.columbia.edu">hgs@cs.columbia.edu</a></td></tr>
</table>
</body></html>
