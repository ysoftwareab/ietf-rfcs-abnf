


Lemonade                                                         N. Cook
Internet-Draft                                                 Cloudmark
Updates: 5092 (if approved)                             January 21, 2009
Intended status: Standards Track
Expires: July 25, 2009


    Internet Message Access Protocol (IMAP) - URL Access Identifier
                               Extension
                    draft-ncook-urlauth-accessid-01

Status of this Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on July 25, 2009.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.






Cook                      Expires July 25, 2009                 [Page 1]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


Abstract

   The existing IMAP URL specification (RFC 5092) lists several <access>
   identifiers and <access> identifier prefixes, that can be used to
   restrict access to URLAUTH-generated URLs.  However, these
   identifiers do not provide facilities for new services such as
   streaming.  This document proposes a set of new <access> identifiers
   as well as an IANA mechanism to register new <access> identifiers for
   future applications.

   This document updates RFC 5092.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Conventions Used in this Document  . . . . . . . . . . . . . .  3
   3.  Additional Authorized Access Identifiers . . . . . . . . . . .  3
     3.1.  Existing Access Identifiers  . . . . . . . . . . . . . . .  3
     3.2.  Requirement for Additional Access Identifiers  . . . . . .  4
     3.3.  Additional Access Identifier Specification . . . . . . . .  4
     3.4.  Defining an access identifier for Streaming  . . . . . . .  5
   4.  Formal Syntax  . . . . . . . . . . . . . . . . . . . . . . . .  5
   5.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  6
   6.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  6
     6.1.  Access Identifier Registration Template  . . . . . . . . .  6
     6.2.  Stream Application Registration  . . . . . . . . . . . . .  7
     6.3.  Submit Application Registration  . . . . . . . . . . . . .  7
     6.4.  User Application Registration  . . . . . . . . . . . . . .  8
     6.5.  Authuser Application Registration  . . . . . . . . . . . .  8
     6.6.  Anonymous Application Registration . . . . . . . . . . . .  9
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . .  9
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  9
     8.1.  Normative References . . . . . . . . . . . . . . . . . . .  9
     8.2.  Informative References . . . . . . . . . . . . . . . . . .  9
   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 10















Cook                      Expires July 25, 2009                 [Page 2]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


1.  Introduction

   The IMAP URL specification [RFC5092] provides a way to carry
   authorization information in IMAP URLs.  Several authorization
   <access> identifiers are specified in the document, which allow
   URLAUTH-authorized URLs to be used only by anonymous users,
   authenticated users, or message submission entities.  However there
   is no mechanism defined to create new <access> identifiers, and
   overloading the existing mechanisms has security as well as
   administrative implications.

   This document describes a new <access> identifier "stream", to be
   used by message streaming entities (as described in [STREAMING]), and
   defines an IANA registration template, which can be used to register
   new <access> identifiers for future applications.  IANA definitions
   for the existing access identifiers and prefixes from RFC 5092 are
   also defined in this document - this document updates RFC 5092 and
   should be taken as the master in the event of any differences or
   discrepancies.


2.  Conventions Used in this Document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

   In examples, "C:" and "S:" indicate lines sent by the client and
   server respectively.  If a single "C:" or "S:" label applies to
   multiple lines, then some of the line breaks between those lines are
   for editorial clarity only and may not be part of the actual protocol
   exchange.


3.  Additional Authorized Access Identifiers

3.1.  Existing Access Identifiers

   The IMAP URL specification, IMAPURL [RFC5092], specifies the
   following authorized <access> identifiers:

   o  "authuser" - Indicating that use of this URL is limited to
      authenticated IMAP sessions that are logged in as any non-
      anonymous user

   o  "anonymous" - Indicating that use of this URL is not restricted by
      session authorization identity




Cook                      Expires July 25, 2009                 [Page 3]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


   Additionally the following <access> identifier prefixes are defined:

   o  "submit+" - Followed by a userid, indicating that only a userid
      authorized as a message submission entity on behalf of the
      specified userid is permitted to use this URL

   o  "user+" - Followed by a userid, indicating that use of this URL is
      limited to IMAP sessions that are logged in as the specified
      userid

3.2.  Requirement for Additional Access Identifiers

   The existing <access> identifiers are suitable for user-based
   authorization, but only the "submit+" <access> identifier prefix is
   suitable for entities acting on behalf of a user.  Generic support
   for external entities acting on behalf of users is required for new
   services such as streaming [STREAMING].

   The "submit+" <access> identifier prefix is not suitable for use as a
   general mechanism to grant access to entities acting on behalf of
   users, for reasons that include:

   o  Security - The IMAP server maintains a list of submission server
      entities that are entitled to retrieve IMAP URLs specifying the
      "submit+" <ccess> identifier prefix.  If this list is extended to
      include the set of all external entities that could act on behalf
      of users, then the attack surface would be increased.

   o  Administration - When URLAUTH-style IMAP URLs are presented to an
      IMAP server by entities acting on behalf of users, the server
      administrator has no way of determining the intended use of that
      URL from the server logs.

   o  Resourcing - Without a mechanism to distinguish between the
      application for which an IMAP URL is to be used, the IMAP server
      has no way to prioritize resources for particular applications.
      For example, the server could prioritize "submit+" URL fetch
      requests over other access identifiers.

3.3.  Additional Access Identifier Specification

   The previous section established that additional access identifiers
   are required to support applications, such as streaming [STREAMING],
   that require entities to retrieve URLAUTH URLs on behalf of users.
   This section describes the scope and meaning of any additional
   <access> identifiers that are created.

   Additional <access> identifiers MUST take one of two forms (Section 4



Cook                      Expires July 25, 2009                 [Page 4]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


   gives the formal ABNF syntax):

   o  <access> identifier - The name of the application e.g. "stream"

   o  <access> identifier prefix - The name of the application e.g.
      "stream" followed by a "+" and then a userid.  For example
      "stream+testuser".

   In both cases, the semantics are the same as those for "submit+",
   i.e. the <access> identifier or <access> identifier prefix (which
   MUST be followed by a userid), indicates that only a userid
   authorized as an application entity for the specified application is
   permitted to use this URL.  In the case of <access> identifier
   prefixes, the IMAP server SHALL NOT validate the specified userid but
   MUST validate that the IMAP session has an authorization identity
   that is authorized as an application entity for the specified
   application.  The application entity itself MAY choose to perform
   validation on any specified userid before attempting to retrieve the
   URL.

   The authorization granted by any <access> identifiers used as
   described above is self-describing, and so requires the IMAP server
   to provide an extensible mechanism for associating userids with new
   applications.  For example, imagine a new application "foo" is
   created, which requires application entities to retrieve URLs on
   behalf of users.  In this case, the IMAP server would need to provide
   a way to register a new application "foo", and to associate the set
   of userids to be used by those entities with the application "foo".
   Any attempt to retrieve URLs containing the <access> identifier "foo"
   would be checked for authorization against the list of userids
   associated with the application "foo".

   Section 6 provides the template required to register new <access>
   identifiers or prefixes with IANA.

3.4.  Defining an access identifier for Streaming

   One application that makes use of URLAUTH-authorized URLs is that of
   streaming multimedia files received as internet messaging
   attachments.  This application is described in [STREAMING].

   See Section 6.2 for the IANA registration template for the "stream"
   <access> identifier.


4.  Formal Syntax

   The following syntax specification uses the Augmented Backus-Naur



Cook                      Expires July 25, 2009                 [Page 5]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


   Form (ABNF) notation as specified in [RFC5234].

   Except as noted otherwise, all alphabetic characters are case-
   insensitive.  The use of upper or lower case characters to define
   token strings is for editorial clarity only.  Implementations MUST
   accept these strings in a case-insensitive fashion.

   The ABNF specified below updates the formal syntax of <access>
   identifier as defined in IMAP URL [RFC5092].

           application = 1*(ALPHA/DIGIT)

           access      =/ application / (application "+" enc-user)


5.  Acknowledgements

   This document was inspired by discussions in the Lemonade Working
   Group.


6.  IANA Considerations

   Access identifiers and prefixes MUST be specified in a standards
   track or IESG approved experimental RFC.  This section gives the IAN
   registration entries for the existing access identifiers and prefixes
   from RFC 5092 as well as the entry for the "stream" application.

6.1.  Access Identifier Registration Template

           To: iana@iana.org
           Subject: IMAP URL Access Identifier Registration

           Type:          [Either "<access> identifier" or
                           "<access> identifier prefix"]

           Application:   [Name of the application, e.g. "stream"]

           Description:   [A description of the application and its use
                           of IMAP URLs]

           RFC Number:    [Number of the RFC that the application was
                           defined in ]

           Contact:       [email and/or physical address to contact for
                           additional information]





Cook                      Expires July 25, 2009                 [Page 6]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


6.2.  Stream Application Registration


             To: iana@iana.org
             Subject: IMAP URL Access Identifier Registration

             Type:          <access> identifier

             Application:   stream

             Description:   Used by SIP Media Servers to retrieve
                            attachments for streaming to email
                            clients

             RFC Number:    This RFC

             Contact:       Neil Cook mailto:neil.cook@noware.co.uk

6.3.  Submit Application Registration


             To: iana@iana.org
             Subject: IMAP URL Access Identifier Registration

             Type:          <access> identifier prefix

             Application:   submit

             Description:   Used by message submission entities to
                            retrieve attachments to be included in
                            submitted messages

             RFC Number:    This RFC

             Contact:       Neil Cook mailto:neil.cook@noware.co.uk
















Cook                      Expires July 25, 2009                 [Page 7]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


6.4.  User Application Registration


             To: iana@iana.org
             Subject: IMAP URL Access Identifier Registration

             Type:          <access> identifier prefix

             Application:   user

             Description:   Used to restrict access to to IMAP sessions
                            that are logged in as the specified userid

             RFC Number:    This RFC

             Contact:       Neil Cook mailto:neil.cook@noware.co.uk

6.5.  Authuser Application Registration


             To: iana@iana.org
             Subject: IMAP URL Access Identifier Registration

             Type:          <access> identifier

             Application:   authuser

             Description:   Used to restrict access to to IMAP sessions
                            that are logged in as any non-anonymous
                            user of that IMAP server

             RFC Number:    This RFC

             Contact:       Neil Cook mailto:neil.cook@noware.co.uk

















Cook                      Expires July 25, 2009                 [Page 8]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


6.6.  Anonymous Application Registration


             To: iana@iana.org
             Subject: IMAP URL Access Identifier Registration

             Type:          <access> identifier

             Application:   anonymous

             Description:   Indicates that use of this URL is
                            not restricted by session authorization
                            identity

             RFC Number:    This RFC

             Contact:       Neil Cook mailto:neil.cook@noware.co.uk


7.  Security Considerations

   The extension to <access> identifiers specified in this document
   provides a mechanism for extending the semantics of the "submit+"
   <access> prefix to arbitrary applications.  The use of such
   additional <access> identifiers and prefixes is primarily for
   security purposes, i.e. to prevent the overloading of "submit+" as a
   generic mechanism to allow entities to retrieve IMAP URLs on behalf
   of userids.  Other than this, the security implications are identical
   to those discussed in Section 10.1 of IMAPURL [RFC5092].


8.  References

8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC5092]  Melnikov, A. and C. Newman, "IMAP URL Scheme", RFC 5092,
              November 2007.

   [RFC5234]  Crocker, D. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", STD 68, RFC 5234, January 2008.

8.2.  Informative References

   [STREAMING]
              Cook, N., "Streaming Internet Messaging Attachments",



Cook                      Expires July 25, 2009                 [Page 9]

Internet-Draft   IMAP URL - Access Identifier Extension     January 2009


              draft-ietf-lemonade-streaming-08.txt (Work in Progress) ,
              Dec 2008.


Author's Address

   Neil L Cook
   Cloudmark

   Email: neil.cook@noware.co.uk









































Cook                      Expires July 25, 2009                [Page 10]


