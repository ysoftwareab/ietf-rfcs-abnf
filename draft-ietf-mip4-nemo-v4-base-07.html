<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Network Mobility (NEMO) Extensions for Mobile IPv4</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Network Mobility (NEMO) Extensions for Mobile IPv4">
<meta name="keywords" content="I-D, XML">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">MIP4</td><td class="header">K. Leung</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">G. Dommety</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Expires: July 7, 2008</td><td class="header">V. Narayanan</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Qualcomm, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Petrescu</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Motorola</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 04, 2008</td></tr>
</table></td></tr></table>
<h1><br />Network Mobility (NEMO) Extensions for Mobile IPv4<br />draft-ietf-mip4-nemo-v4-base-07.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 7, 2008.</p>

<h3>Abstract</h3>

<p>
	This document describes a protocol for supporting Mobile
	Networks between a Mobile Router and a Home Agent by extending
	the Mobile IPv4 protocol.  A Mobile Router is responsible for
	the mobility of one or more network segments or subnets moving
	together.  The Mobile Router hides its mobility from the nodes
	on the mobile network.  The nodes on the Mobile Network may be
	fixed in relationship to the Mobile Router and may not have
	any mobility function.
      
</p>
<p>
	Extensions to Mobile IPv4 are introduced to support Mobile
	Networks.
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#reqs">3.</a>&nbsp;
Requirements<br />
<a href="#mobnetext">4.</a>&nbsp;
Mobile Network Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mnreqext">4.1.</a>&nbsp;
Mobile Network Request Extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mnackext">4.2.</a>&nbsp;
Mobile Network Acknowledgement Extension<br />
<a href="#mroperation">5.</a>&nbsp;
Mobile Router Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#errprocessing">5.1.</a>&nbsp;
Error Processing<br />
<a href="#haoperation">6.</a>&nbsp;
Home Agent Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#haoperation-summary">6.1.</a>&nbsp;
Summary<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#datastruct">6.2.</a>&nbsp;
Data Structures<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#regtable">6.2.1.</a>&nbsp;
Registration Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prefixtable">6.2.2.</a>&nbsp;
Prefix Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mnetprefixreg">6.3.</a>&nbsp;
Mobile Network Prefix Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#advreach">6.4.</a>&nbsp;
Advertising Mobile Network Reachability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#establishment-bidir">6.5.</a>&nbsp;
Establishment of Bi-directional Tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sendingregreps">6.6.</a>&nbsp;
Sending Registration Replies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mnetprefix-deregistration">6.7.</a>&nbsp;
Mobile Network Prefix De-registration<br />
<a href="#dataforwarding">7.</a>&nbsp;
Data Forwarding Operation<br />
<a href="#nested">8.</a>&nbsp;
Nested Mobile Networks<br />
<a href="#routingprotocol">9.</a>&nbsp;
Routing Protocol
		    between Mobile Router and Home Agent<br />
<a href="#seccons">10.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#secrtprotocol">10.1.</a>&nbsp;
Security when Dynamic Routing Protocol is Used<br />
<a href="#IANA">11.</a>&nbsp;
IANA Considerations<br />
<a href="#Acknowledgements">12.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#changelog">Appendix&nbsp;A.</a>&nbsp;
ChangeLog<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
	This document describes protocol extensions to Mobile IPv4 as
	per <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis], to enable
	support for Mobile Networks.  This draft addresses mainly the
	co-located Care-of Address mode.  Foreign Agent Care-of
	Address mode (with 'legacy' Foreign Agents, <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344]) are supported but without
	optimization, double encapsulation being used.  For an
	optimization of this mode, the gentle reader is directed to
	<a class='info' href='#I-D.ietf-mip4-nemov4-fa'>an extension
	document<span> (</span><span class='info'>Tsirtsis, G., Park, V., Narayanan, V., and K. Leung, &ldquo;FA extensions to NEMOv4 Base,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;nemov4&#8209;fa].
      
</p>
<p>
	A Mobile Network is defined as a network segment or subnet
	that can change its point of attachment to the routing
	infrastructure.  Such movement is performed by a Mobile
	Router, which is the mobility entity that provides
	connectivity and reachability as well as session continuity
	for all the nodes in the Mobile Network.  The Mobile Router
	typically serves as the default gateway for the hosts on the
	Mobile Network.
      
</p>
<p>
	Mobility for the Mobile Network is supported by the Mobile
	Router registering the point of attachment to its Home Agent.
	This signaling sets up the tunnel between the two entities.
      
</p>
<p>
	The Mobile Networks (either implicitly configured on the Home
	Agent or explicitly identified by the Mobile Router) are
	advertised by the Home Agent for route propagation.  Traffic
	to and from nodes in the Mobile Network are tunneled by the
	Home Agent to the Mobile Router, and vice versa.  Though
	packets from the Mobile Network can be forwarded directly
	without tunneling (if reverse tunneling is not used) packets
	will be dropped if ingress filtering is turned on.
      
</p>
<p>
	This document specifies an additional tunnel between a Mobile
	Router's Home Address and the Home Agent.  This tunnel is
	encapsulated within the normal tunnel between the Care-of
	Address (CoA) and Home Agent.  In Foreign Agent CoA mode, the
	tunnel between the Mobile Router and Home Agent is needed to
	allow the Foreign Agent to direct the decapsulated packet to
	the proper visiting Mobile Router.  However, in Collocated CoA
	mode, the additional tunnel is not essential and could be
	eliminated because the Mobile Router is the recipient of the
	encapsulated packets for the Mobile Network; a proposal for
	this feature is in <a class='info' href='#I-D.ietf-mip4-nemov4-fa'>an
	extension document<span> (</span><span class='info'>Tsirtsis, G., Park, V., Narayanan, V., and K. Leung, &ldquo;FA extensions to NEMOv4 Base,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;nemov4&#8209;fa].
      
</p>
<p>
	All traffic between the nodes in the Mobile Network and
	Correspondent Nodes passes through the Home Agent.  This
	document does not cover route optimization of this traffic.
      
</p>
<p>
	A similar protocol has been documented in <a class='info' href='#RFC3963'>RFC&nbsp;3963<span> (</span><span class='info'>Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;Network Mobility (NEMO) Basic Support Protocol,&rdquo; January&nbsp;2005.</span><span>)</span></a> [RFC3963] for supporting IPv6 mobile
	networks with Mobile IPv6 extensions.
      
</p>
<p>
	Multihoming for Mobile Routers is outside the scope of this
	document.
      
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
	The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
	NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
	"OPTIONAL" in this document are to be interpreted as described
	in <a class='info' href='#RFC2119'>RFC&nbsp;2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
      
</p>
<p>
	Terminology for network mobility support is defined in <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis].  In
	addition, this document defines the following terms.
      
</p>
<p>
	</p>
<blockquote class="text"><dl>
<dt>Mobile Network Prefix</dt>
<dd>
	    <br />

	    The network prefix of the subnet delegated to a Mobile
	    Router as the Mobile Network.
	  <br />
<br />

	  
</dd>
<dt>Prefix Table</dt>
<dd>
	    <br />

	    A list of Mobile Network Prefixes indexed by the Home
	    Address of a Mobile Router.  The Home Agent manages and
	    uses Prefix Table to determine which Mobile Network
	    Prefixes belong to a particular Mobile Router.
	  
</dd>
</dl></blockquote><p>
      
</p>
<a name="reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requirements</h3>

<p>
	Although Mobile IPv4 stated that Mobile Network can be
	supported by the Mobile Router and Home Agent using static
	configuration or running a routing protocol, there is no
	solution for explicit registration of the Mobile Networks
	served by the Mobile Router.  A solution needs to provide the
	Home Agent a means to ensure that a Mobile Router claiming a
	certain Mobile Network Prefix is authorized to do so.  A
	solution would also expose the Mobile Network Prefixes (and
	potentially other subnet-relevant information) in the
	exchanged messages, to aid in network debugging.
      
</p>
<p>
	The following requirements for Mobile Network support are
	enumerated:
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    A Mobile Router should be able to operate in explicit or
	    implicit mode.  A Mobile Router may explicitly inform the
	    Home Agent which Mobile Network(s) need to be propagated
	    via a routing protocol.  A Mobile Router may also function
	    in implicit mode, where the Home Agent may learn the
	    mobile networks through other means, such as from the AAA
	    server, via pre-configuration, or via a dynamic routing
	    protocol.
	  
</li>
<li>
	    The Mobile Network should be supported using Foreign
	    Agents that are compliant to <a class='info' href='#RFC3344'>RFC
	    3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] without any changes ('legacy' Foreign Agents).
	  
</li>
<li>
	    The mobile network should allow Fixed Nodes, Mobile Nodes,
	    or Mobile Routers to be on it.
	  
</li>
</ul><p>
      
</p>
<a name="mobnetext"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Mobile Network Extensions</h3>

<a name="mnreqext"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Mobile Network Request Extension</h3>

<p>
	  For Explicit Mode, the Mobile Router informs the Home Agent
	  about the Mobile Network Prefixes during registration.  The
	  Registration Request contains zero, one or several Mobile
	  Network Request extensions in addition to any other
	  extensions defined by or in the context of <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344].  When several Mobile
	  Networks are needed to be registered, each is included in a
	  separate Mobile Network Request extension, with its own
	  Type, Length, Sub-Type, Prefix Length and Prefix fields.  A
	  Mobile Network Request extension is encoded in
	  Type-Length-Value (TLV) format and respects the following
	  format:
	
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   0               1               2               3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |    Length     |   Sub-Type    | Prefix Length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                          Prefix                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p>
	</p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd>
	    <br />

	    Mobile Network Extension (skippable type range to be
	    assigned by IANA).
	    <br />
<br />

	  
</dd>
<dt>Length:</dt>
<dd>
	    <br />

	    6
	    <br />
<br />

	  
</dd>
<dt>Sub-Type:</dt>
<dd>
	    
<blockquote class="text"><dl>
<dt>TBA</dt>
<dd>
		(Mobile Network Request)
	      
</dd>
</dl></blockquote>
	    <br />
<br />

	  
</dd>
<dt>Prefix Length:</dt>
<dd>
	    <br />

	    8-bit unsigned integer indicating the number of bits
	    covering the network part of the address contained in the
	    Prefix field.
	    <br />
<br />

	  
</dd>
<dt>Prefix:</dt>
<dd>
	    <br />

	    32-bit unsigned integer in network byte-order containing
	    an IPv4 address whose first Prefix Length bits make up the
	    Mobile Network Prefix.
	  
</dd>
</dl></blockquote><p>
      
</p>
<a name="mnackext"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Mobile Network Acknowledgement Extension</h3>

<p>
	  The Registration Reply contains zero, one or several Mobile
	  Network Acknowledgement extensions in addition to any other
	  extensions defined by or in the context of <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis].  For
	  Implicit Mode, the Mobile Network Acknowledgement informs
	  the Mobile Router the prefixes for which the Home Agent sets
	  up forwarding with respect to this Mobile Router.  Policies
	  such as permitting only traffic from these Mobile Networks
	  to be tunneled to the Home Agent may be applied by the
	  Mobile Router.  For Explicit Mode, when several Mobile
	  Networks are needed to be acknowledged explicitly, each is
	  included in a separate Mobile Network Acknowledgement
	  extension, with its own Type, Sub-Type, Length and Prefix
	  Length fields.  Optionally, all requested Mobile Networks
	  could be acknowledged using only one Mobile Network
	  Acknowledgement extension with "Prefix Length" and "Prefix"
	  fields set to zero.  At least one Mobile Network
	  Acknowledgement extension MUST be in a successful
	  Registration Reply to indicate to the Mobile Router that the
	  Mobile Network Request extension was processed, thereby not
	  skipped by the Home Agent.
	
</p>
<p>
	  A Registration Reply may contain any non-zero number of
	  Explicit Mode and Implicit Mode Acknowledgements sub-types.
	  Both sub-types can be present in a single Registration
	  Reply.  A Mobile Network Acknowledgement extension is
	  encoded in Type-Length-Value (TLV) format.  When the
	  registration is denied with code HA_MOBNET_ERROR, the Code
	  field in the extension provides the reason for the failure.
	
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0               1               2               3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |   Sub-Type    |      Code     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Prefix Length |    Reserved   |            Prefix
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p>
	</p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd>
	    
<blockquote class="text"><dl>
<dt>TBA</dt>
<dd>
		Mobile Network Extension (skippable type range to be
		assigned by IANA).
	      
</dd>
</dl></blockquote>
	    <br />
<br />

	  
</dd>
<dt>Length:</dt>
<dd>
	    <br />

	    8
	    <br />
<br />

	  
</dd>
<dt>Sub-Type:</dt>
<dd>
	    
<blockquote class="text"><dl>
<dt>TBA</dt>
<dd>
		(Explicit Mode Acknowledgement)
	      
</dd>
<dt>TBA</dt>
<dd>
		(Implicit Mode Acknowledgement)
	      
</dd>
</dl></blockquote>
	    <br />
<br />

	  
</dd>
<dt>Code:</dt>
<dd>
	    <br />

	    Value indicating success or failure:
	    
<blockquote class="text"><dl>
<dt>TBA</dt>
<dd>
		Success
	      
</dd>
<dt>TBA</dt>
<dd>
		Invalid prefix (MOBNET_INVALID_PREFIX_LEN)
	      
</dd>
<dt>TBA</dt>
<dd>
		Mobile Router is not authorized for prefix
		(MOBNET_UNAUTHORIZED)
	      
</dd>
<dt>TBA</dt>
<dd>
		Forwarding setup failed (MOBNET_FWDING_SETUP_FAILED)
	      
</dd>
</dl></blockquote>
	    <br />
<br />

	  
</dd>
<dt>Prefix Length:</dt>
<dd>
	    <br />

	    8-bit unsigned integer indicating the number of bits
	    covering the network part of the address contained in the
	    Prefix field.
	    <br />
<br />

	  
</dd>
<dt>Reserved:</dt>
<dd>
	    <br />

	    Sent as zero; ignored on reception.
	    <br />
<br />

	  
</dd>
<dt>Prefix:</dt>
<dd>
	    <br />

	    32-bit unsigned integer in network byte-order containing
	    an IPv4 address whose first Prefix Length bits make up the
	    Mobile Network Prefix.
	    <br />
<br />

	  
</dd>
</dl></blockquote><p>
      
</p>
<a name="mroperation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Mobile Router Operation</h3>

<p>      
	A Mobile Router's operation is generally derived from the
	behavior of a Mobile Node, as set in <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis].  In
	addition to maintaining mobility bindings for its Home
	Address, the Mobile Router, together with the Home Agent,
	maintains forwarding information for the Mobile Network
	Prefix(es) assigned to the Mobile Router.
      
</p>
<p>
	A Mobile Router SHOULD set the 'T' bit to 1 in all
	Registration Request messages it sends to indicate the need
	for reverse tunnels for all traffic.  Without reverse tunnels,
	all the traffic from the mobile network will be subject to
	ingress filtering in the visited networks.  Upon reception of
	a successful Registration Reply, the Mobile Router processes
	the registration in accordance to <a class='info' href='#RFC3344'>RFC
	3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344].  In addition, the following steps are taken:
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    Check for Mobile Network Acknowledgement extension(s) in
	    Registration Reply
	  
</li>
<li>
	    Create tunnel to the Home Agent if registered in reverse
	    tunneling mode
	  
</li>
<li>
	    Set up default route via this tunnel or egress interface
	    when registered with or without reverse tunneling,
	    respectively
	  
</li>
</ul><p>
      
</p>
<p>
	In accordance with this specification, a Mobile Router may
	operate in one of the following two modes: explicit and
	implicit.  In explicit mode, the Mobile Router includes Mobile
	Network Prefix information in all Registration Requests (as
	Mobile Network Request extensions), while in implicit mode it
	does not include this information in any Registration Request.
	In this latter case, the Home Agent obtains the Mobile Network
	Prefixes by other means than Mobile IP.  One example of
	obtaining the Mobile Network Prefix is through static
	configuration on the Home Agent.
      
</p>
<p>
	A Mobile Router can obtain a Collocated or Foreign Agent
	Care-of Address while operating in explicit or implicit modes.
      
</p>
<p>
	For de-registration, the Mobile Router sends a registration
	request with lifetime set to zero without any Mobile Network
	Request extensions.
      
</p>
<a name="errprocessing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Error Processing</h3>

<p>
	  A Mobile Router interprets the values of the Code field in
	  the Mobile Network Acknowledgement Extension of the
	  Registration Reply in order to identify any error related to
	  managing the Mobile Network Prefixes by the Home Agent.
	
</p>
<p>
	  If the value of the Code field in the Registration Reply is
	  set to HA_MOBNET_DISALLOWED, then the Mobile Router MUST
	  stop sending Registration Requests with any Mobile Network
	  Prefix extensions to that Home Agent.
	
</p>
<p>
	  If the value of the Code field in the Registration Reply is
	  set to HA_MOBNET_ERROR then the Mobile Router MUST stop
	  sending Registration Requests that contain any of the Mobile
	  Network Prefixes that are defined by the values of the
	  fields Prefix and Prefix Length in the Mobile Network
	  Acknowledgement extension.  Note that the registration is
	  denied in this case and no forwarding for any Mobile Network
	  Prefixes would be set up by the Home Agent for the Mobile
	  Router.
	
</p>
<p>
	  It is possible that the Mobile Router receives a
	  Registration Reply with no mobile network extensions if the
	  registration was processed by a Mobile IPv4 home agent that
	  does not support this specification at all.  In that case,
	  the absence of mobile network extensions must be interpreted
	  by the Mobile Router as the case where the Home Agent does
	  not support mobile networks.
	
</p>
<p>
	  All the error code values are TBA (To Be Assigned) subject
	  to IANA allocation.
	
</p>
<a name="haoperation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Home Agent Operation</h3>

<a name="haoperation-summary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Summary</h3>

<p>
	  A Home Agent MUST support all the operations specified in
	  <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis] for
	  Mobile Node support.  The Home Agent MUST support both
	  implicit and explicit modes of operation for a Mobile
	  Router.
	
</p>
<p>
	  The Home Agent processes the registration in accordance to
	  <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344], which includes route
	  set up to the Mobile Router's Home Address via the tunnel to
	  the Care-of Address.  In addition, for a Mobile Router
	  registering in explicit mode, the following steps are taken:
	
</p>
<p>
	  </p>
<ol class="text">
<li>
	      Check that the Mobile Network Prefix information is
	      valid
	    
</li>
<li>
	      Ensure the Mobile Network Prefix(es) is or are
	      authorized to be on the Mobile Router
	    
</li>
<li>
	      Create tunnel to the Mobile Router if it does not
	      already exist
	    
</li>
<li>
	      Set up route for the Mobile Network Prefix via this
	      tunnel
	    
</li>
<li>
	      Propagate Mobile Network Prefix routes via routing
	      protocol
	    
</li>
<li>
	      Send the Registration Reply with the Mobile Network
	      Acknowledgement extension(s)
	    
</li>
</ol><p>
	
</p>
<p>
	  If there are any subnet routes via the tunnel to the Mobile
	  Router that are not specified in the Mobile Network
	  extensions, these routes are removed.
	
</p>
<p>
	  In the case where the Mobile Node is not permitted to act as
	  a Mobile Router, the Home Agent sends a registration denied
	  message with error code HA_MOBNET_DISALLOWED.
	
</p>
<p>
	  For a Mobile Router registering in implicit mode, the Home
	  Agent performs steps 3-6 above, once the registration
	  request is processed successfully.
	
</p>
<p>
	  For deregistration, the Home Agent removes the tunnel to the
	  Mobile Router and all routes using this tunnel.  The Mobile
	  Network extensions are ignored.
	
</p>
<a name="datastruct"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Data Structures</h3>

<a name="regtable"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Registration Table</h3>

<p>
	    The Registration Table in the Home Agent, in accordance
	    with <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis],
	    contains binding information for every Mobile Node
	    registered with it.  <a class='info' href='#RFC3344'>RFC
	    3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis] define
	    the format of a Registration Table.  In addition to all
	    the parameters specified by <a class='info' href='#RFC3344'>RFC
	    3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis], the
	    Home Agent MUST store the Mobile Network Prefixes
	    associated with the Mobile Router in the corresponding
	    registration entry, when the corresponding registration
	    was performed in explicit mode.  When the Home Agent is
	    advertising reachability to Mobile Network Prefixes served
	    by a Mobile Router, the information stored in the
	    Registration Table can be used.
	  
</p>
<a name="prefixtable"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Prefix Table</h3>

<p>
	    The Home Agent must be able to authorize a Mobile Router
	    for use of Mobile Network Prefixes when the Mobile Router
	    is operating in explicit mode.  Also, when the Mobile
	    Router operates in implicit mode, the Home Agent must be
	    able to locate the Mobile Network Prefixes associated with
	    that Mobile Router.  The Home Agent may store the Home
	    Address of the Mobile Router along with the mobile network
	    prefixes associated with that Mobile Router.  If the
	    Mobile Router does not have a Home Address assigned, this
	    table may store the NAI <a class='info' href='#RFC2794'>RFC
	    2794<span> (</span><span class='info'>Calhoun, P. and C. Perkins, &ldquo;Mobile IP Network Access Identifier Extension for IPv4,&rdquo; March&nbsp;2000.</span><span>)</span></a> [RFC2794] of the Mobile Router that will be used in
	    dynamic Home Address assignment.
	  
</p>
<a name="mnetprefixreg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Mobile Network Prefix Registration</h3>

<p>
	  The Home Agent must process registration requests coming
	  from Mobile Routers in accordance with this section.  The
	  document <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis]
	  specify that the Home Address of a mobile node registering
	  with a Home Agent must belong to a prefix advertised on
	  the home network.  In accordance with this specification,
	  however, the Home Address must be configured from a prefix
	  that is served by the Home Agent, not necessarily the one
	  on the home network.
	
</p>
<p>
	  If the registration request is valid, the Home Agent
	  checks to see if there are any Mobile Network Prefix
	  extensions included in the Registration Request.
	
</p>
<p>
	  If so, the Mobile Network Prefix information is obtained
	  from the included extensions, and the Home Address from
	  the Home Address field of the Registration Request.  For
	  every Mobile Network Prefix extension included in the
	  registration request, the Home Agent MUST perform a check
	  against the Prefix Table.  If the Prefix Table does not
	  contain at least one entry pairing that Home Address to
	  that Mobile Network Prefix then the check fails, otherwise
	  it succeeds.
	
</p>
<p>
	  Following this check against the Prefix Table, the Home
	  Agent MUST construct a Registration Reply containing
	  Mobile Network Acknowledgement extensions.  For a Mobile
	  Network Prefix for which the check was unsuccessfull the
	  Code field in the corresponding Mobile Network
	  Acknowledgement extension should be set to
	  MOBNET_UNAUTHORIZED.
	
</p>
<p>
	  For a Mobile Network Prefix for which the check was
	  successfull the Code field in the respective Mobile
	  Network Acknowledgement extensions should be set to 0.
	
</p>
<p>
	  The Home Agent MUST attempt to set up forwarding for each
	  Mobile Network Prefix extension for which the Prefix Table
	  check was successfull.  If the forwarding setup fails for
	  a particular Mobile Network Prefix (for reasons like not
	  enough memory available, or not enough devices available,
	  or other similar) the Code field in the respective Mobile
	  Network Acknowledgement extension should be set to
	  MOBNET_FWDING_SETUP_FAILED.
	
</p>
<p>
	  If forwarding and setup was successful for at least one
	  Mobile Network Prefix then the Code field of the
	  Registration Reply message should be set to 0.  Otherwise
	  that Code should be HA_MOBNET_ERROR.
	
</p>
<p>
	  If the registration request is sent in implicit mode,
	  i.e., without any Mobile Network Request extension, the
	  Home Agent may use pre- configured mobile network prefix
	  information for the Mobile Router to set up forwarding.
	
</p>
<p>
	  If the Home Agent is updating an existing binding entry
	  for the Mobile Router, it MUST check all the prefixes in
	  the registration table against the prefixes included in
	  the registration request.  If one or more mobile network
	  prefix is missing from the included information in the
	  registration request, it MUST delete those prefixes from
	  the registration table.  Also, the Home Agent MUST disable
	  forwarding for those prefixes.
	
</p>
<p>
	  If all checks are successful, the Home Agent either
	  creates a new entry for the Mobile Router or updates an
	  existing binding entry for it and returns a successful
	  registration reply back to the Mobile Router or the
	  Foreign Agent (if the registration request was received
	  from a Foreign Agent).
	
</p>
<p>
	  In accordance with <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344],
	  the Home Agent does proxy ARP for the Mobile Router Home
	  Address, when the Mobile Router Home Address is derived
	  from the home network.
	
</p>
<p>
	  If the 'T' bit is set, the Home Agent creates a
	  bi-directional tunnel for the corresponding mobile network
	  prefixes or updates the existing bi-directional tunnel.
	  This tunnel is maintained independent of the reverse
	  tunnel for the Mobile Router home address itself.
	
</p>
<a name="advreach"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Advertising Mobile Network Reachability</h3>

<p>
	  If the mobile network prefixes served by the Home Agent are
	  aggregated with the home network prefix and if the Home
	  Agent is the default router on the home network, the Home
	  Agent does not have to advertise the Mobile Network
	  Prefixes.  The routes for the Mobile Network Prefix are
	  automatically aggregated into the home network prefix (it is
	  assumed that the Mobile Network Prefixes are automatically
	  aggregated into the home network prefix).  If the Mobile
	  Router updates the mobile network prefix routes via a
	  dynamic routing protocol, the Home Agent SHOULD propagate
	  the routes on the appropriate networks.
	
</p>
<a name="establishment-bidir"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Establishment of Bi-directional Tunnel</h3>

<p>
	  The Home Agent creates and maintains a bi-directional tunnel
	  for the mobile network prefixes of a Mobile Router
	  registered with it.  A home agent supporting IPv4 Mobile
	  Router operation MUST be able to forward packets destined to
	  the mobile network prefixes served by the Mobile Router to
	  its Care-of Address.  Also, the Home Agent MUST be able to
	  accept packets tunneled by the Mobile Router with the source
	  address of the outer header set to the Care-of Address of
	  the Mobile Router and that of the inner header set to the
	  Mobile Router's Home Address or an address from one of the
	  registered mobile network prefixes.
	
</p>
<a name="sendingregreps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Sending Registration Replies</h3>

<p>
	  The Home Agent MUST set the status code in the registration
	  reply to 0 to indicate successful processing of the
	  registration request and successful set up of forwarding for
	  all the mobile network prefixes served by the Mobile Router.
	  The registration reply MUST contain at least one Mobile
	  Network Acknowledgement extension.
	
</p>
<p>
	  If the Home Agent is unable to set up forwarding for one of
	  more mobile network prefixes served by the Mobile Router, it
	  MUST set the Mobile Network Acknowledgement Extension status
	  code in the registration reply to
	  MOBNET_FWDING_SETUP_FAILED.  When the prefix length is zero
	  or greater than 32, the status code MUST be set to
	  MOBNET_INVALID_PREFIX_LEN.
	
</p>
<p>
	  If the Mobile Router is not authorized to forward packets to
	  one or mobile network prefixes included in the request, the
	  Home Agent MUST set the code to MOBNET_UNAUTHORIZED_MR.
	
</p>
<a name="mnetprefix-deregistration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
Mobile Network Prefix De-registration</h3>

<p>
	  If the received registration request is for de-registration
	  of the Care-of Address, the Home Agent, upon successful
	  processing of it, MUST delete the entry(ies) from its
	  registration table.  The home agent tears down the
	  bi-directional tunnel and stops forwarding any packets
	  to/from the Mobile Router.  The Home Agent MUST ignore any
	  included Mobile Network Request extension in a
	  de-registration request.
	
</p>
<a name="dataforwarding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Data Forwarding Operation</h3>

<p>
	For traffic to the nodes in the Mobile Network, the Home Agent
	MUST perform double tunneling of the packet, if the Mobile
	Router had registered with a Foreign Agent Care-of Address.
	In this case, the Home Agent MUST encapsulate the packet with
	tunnel header (source IP address set to Home Agent and
	destination IP address set to Mobile Router's Home Address)
	and then encapsulate one more time with tunnel header (source
	IP address set to Home Agent and destination IP address set to
	CoA).
      
</p>
<p>
	For optimization, the Home Agent SHOULD only encapsulate the
	packet with the tunnel header (source IP address set to Home
	Agent and destination IP address set to CoA) for Collocated
	CoA mode.
      
</p>
<p>
	When a Home Agent receives a packet from the mobile network
	prefix in the bi-directional tunnel, it MUST de-encapsulate
	the packet and route it as a normal IP packet.  It MUST verify
	that the incoming packet has the source IP address set to the
	Care-of Address of the Mobile Router.  The packet MUST be
	dropped if the source address is not set to the Care-of
	Address of the Mobile Router.
      
</p>
<p>
	For traffic from the nodes in the Mobile Network, the Mobile
	Router encapsulates the packet with a tunnel header (source IP
	address set to Mobile Router's Home Address and destination IP
	address set to Home Agent) if reverse tunnel is enabled.
	Otherwise, the packet is routed directly to the Foreign Agent
	or access router.
      
</p>
<p>
	In Collocated CoA mode, the Mobile Router MAY encapsulate one
	more times with a tunnel header (source IP address set to the
	CoA and destination IP address set to Home Agent).
      
</p>
<a name="nested"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Nested Mobile Networks</h3>

<p>
	Nested Network Mobility is a scenario where a Mobile Router
	allows another Mobile Router to attach to its Mobile Network.
	There could be arbitrary levels of nested mobility.  The
	operation of each Mobile Router remains the same whether the
	Mobile Router attaches to another Mobile Router or to a fixed
	Access Router on the Internet.  The solution described here
	does not place any restriction on the number of levels for
	nested mobility.  But note that this might introduce
	significant overhead on the data packets as each level of
	nesting introduces another tunnel header encapsulation.
      
</p>
<a name="routingprotocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Routing Protocol
		    between Mobile Router and Home Agent</h3>

<p>
	There are several benefits of running a dynamic routing
	protocol between the Mobile Router and the Home Agent.  If the
	mobile network is relatively large, including several wireless
	subnets, then the topology changes within the moving network
	can be exposed from the Mobile Router to the Home Agent by
	using a dynamic routing protocol.  The purpose of the NEMOv4
	protocol extensions to Mobile IPv4, as defined in previous
	sections, is not to inform the Home Agent about these topology
	changes, but to manage the mobility of the Mobile Router.
      
</p>
<p>
	Similarly, topology changes in the home network can be exposed
	to the Mobile Router by using a dynamic routing protocol.
	This may be necessary when new fixed networks are added in the
	home network.  Here too, the purpose of NEMOv4 extensions is
	not to inform the Mobile Router about topology changes at
	home.
      
</p>
<p>
	Examples of dynamic routing protocol include but are not
	limited to OSPF Version 2 <a class='info' href='#RFC2328'>RFC
	2328<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> [RFC2328], BGP <a class='info' href='#RFC4271'>RFC&nbsp;4271<span> (</span><span class='info'>Rekhter, Y., Li, T., and S. Hares, &ldquo;A Border Gateway Protocol 4 (BGP-4),&rdquo; January&nbsp;2006.</span><span>)</span></a> [RFC4271] and
	RIP <a class='info' href='#RFC2453'>RFC&nbsp;2453<span> (</span><span class='info'>Malkin, G., &ldquo;RIP Version 2,&rdquo; November&nbsp;1998.</span><span>)</span></a> [RFC2453].
      
</p>
<p>
	The recommendations are related to how the routing protocol
	and the Mobile IPv4 implementation work in tandem on the
	Mobile Router and on the Home Agent (1) without creating
	incoherent states in the forwarding information bases at home
	and on the Mobile Router, (2) without introducing
	topologically incorrect addressing information in the visited
	domain and (3) efficiently avoid duplication of sent data or
	over-provisioning of security.
      
</p>
<p>
	The information exchanged between the Mobile Router and the
	Home Agent is sent over the bi-directional tunnel established
	by the Mobile IPv4 exchange Registration Request -
	Registration Reply (see <a class='info' href='#establishment-bidir'>Section&nbsp;6.5<span> (</span><span class='info'>Establishment of Bi-directional Tunnel</span><span>)</span></a>).  If a network address and prefix about a subnet in the
	moving network is sent by the Mobile Router within a routing
	protocol message then they SHOULD NOT be sent in the Mobile
	IPv4 Registration Request too, in order to avoid incoherencies
	in the forwarding information bases.  The Mobile Router SHOULD
	use NEMOv4 implicit mode in this case (see <a class='info' href='#reqs'>Section&nbsp;3<span> (</span><span class='info'>Requirements</span><span>)</span></a>).
      
</p>
<p>
	The Mobile Router SHOULD NOT send routing protocol information
	updates in the foreign network.  The subnet addresses and
	prefixes valid in the moving network are topologically
	incorrect in the visited network.
      
</p>
<p>
	If the Mobile Router and the Home Agent use a dynamic routing
	protocol over the tunnel interface, and if that protocol
	offers security mechanisms to protect that protocol's
	messages, then the security recommendations in <a class='info' href='#secrtprotocol'>Section&nbsp;10.1<span> (</span><span class='info'>Security when Dynamic Routing Protocol is Used</span><span>)</span></a> apply.
      
</p>
<a name="seccons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>
	The Mobile Network extension is protected by the same rules
	for Mobile IP extensions in registration messages.  See the
	Security Considerations section in <a class='info' href='#RFC3344'>RFC
	3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344].
      
</p>
<p>
	The Home Agent MUST be able to verify that the Mobile Router
	is authorized to provide mobility service for the Mobile
	Networks in the registration request, before anchoring these
	Mobile Network Prefixes on behalf of the Mobile Router.
	Forwarding for prefixes MUST NOT be set up without successful
	authorization of the Mobile Router for those prefixes.  A
	registration failure MUST be notified to the mobile router
	when it cannot be successfully authorized for prefixes
	requested by it.
      
</p>
<p>
	All registration requests and replies MUST be authenticated by
	the MN-HA Authentication Extension as specified in <a class='info' href='#RFC3344'>RFC&nbsp;3344<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344] and <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>its update<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis].  When the
	registration request is sent in explicit mode, i.e., with one
	or more Mobile Network Prefix extensions, all the Mobile
	Network Prefix extensions MUST be included before the MN-HA
	Authentication extension.  Also, these extensions MUST be
	included in the calculation of the MN-HA authenticator value.
      
</p>
<p>
	The Mobile Router should perform ingress filtering on all the
	packets received on the mobile network prior to reverse
	tunneling them to the Home Agent.  The Mobile Router MUST drop
	any packets that do not have a source address belonging to the
	mobile network.
      
</p>
<p>
	The Mobile Router MUST also ensure that the source address of
	packets arriving on the mobile network is not the same as the
	Mobile Router's IP address on any interface.  These checks
	will protect against nodes attempting to launch IP spoofing
	attacks through the bi-directional tunnel.
      
</p>
<p>
	The Home Agent, upon receiving packets through the
	bi-directional tunnel, MUST verify that the source addresses
	of the outer IP header of the packets are set to the Mobile
	Router's care-of-address.  Also, it MUST ensure that the
	source address of the inner IP header is a topologically
	correct address on the mobile network.  This will prevent
	nodes from using the Home Agent to launch attacks inside the
	protected network.
      
</p>
<a name="secrtprotocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Security when Dynamic Routing Protocol is Used</h3>

<p>
	  If a dynamic routing protocol is used between the Mobile
	  Router and the Home Agent to propagate the mobile network
	  information into the home network, the routing updates
	  SHOULD be protected with IPsec ESP confidentiality between
	  the Mobile Router and Home Agent, to prevent information
	  about home network topology from being visible to
	  eavesdroppers.
	
</p>
<p>
	  A routing protocol message protected with ESP, and sent
	  through the Mobile Router - Home Agent bidirectional tunnel,
	  SHOULD NOT contain the Mobile IPv4 Mobile-Home
	  Authentication Extension, since ESP provides enough
	  security.
	
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA Considerations</h3>

<p>
	IANA to modify rules for the existing registry "Mobile IPv4
	numbers - per RFC&nbsp;3344".  The numbering space for
	Extensions that may appear in Mobile IP control messages
	(those sent to and from UDP port number 434) should be
	modified.
      
</p>
<p>
	The new Values and Names for the Type for Extensions appearing
	in Mobile IP control messages are the following:
      
</p><br /><hr class="insert" />
<a name="valuesnames-typeext"></a>

<p style='text-align: center'>
	
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="left">
<tr><th align="right">Value</th><th align="left">Name</th></tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Mobile Network Extension (To Be Assigned by IANA)
	</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
	
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: New Values and Names for Extensions
			in Mobile IP Control Messages&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	A new number space should be created for the Values and Names
	for the Sub-Type for Mobile Network Extensions.  This number
	space is initially defined to hold the following entries,
	allocated by this document:
      
</p><br /><hr class="insert" />
<a name="valuesnames-subtype"></a>

<p style='text-align: center'>
	
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="left">
<tr><th align="right">Value</th><th align="left">Name</th></tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Mobile Network Request Extension
	</td>
</tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Explicit Mode Acknowledgement Extension
	</td>
</tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Implicit Mode Acknowledgement Extension
	</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
	
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: New Values and Names for the Sub-Type
			for Mobile Network Extensions&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	The policy of future assignments to this number space should
	be following Expert Review.
      
</p>
<p>
	The new Code Values for Mobile IP Registration Reply messages
	are the following (for a registration denied by the Home
	Agent):
      
</p><br /><hr class="insert" />
<a name="codevalues-regrep"></a>

<p style='text-align: center'>
	
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="left">
<tr><th align="right">Value</th><th align="left">Name</th></tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Mobile Network Prefix operation error (HA_MOBNET_ERROR)
	</td>
</tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Mobile Router operation is not permitted
	  (HA_MOBNET_DISALLOWED)
	</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
	
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: New Code Values
			for Mobile IP Registration Reply&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	A new number space should be created for the Code Values for
	the Mobile Network Acknowledgement Extension.  This number
	space is initially defined to hold the following entries,
	allocated by this document (result of registration, as sent by
	the Home Agent):
      
</p><br /><hr class="insert" />
<a name="codevalues-mnack"></a>

<p style='text-align: center'>
	
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="left">
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Success
	</td>
</tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Invalid prefix length (MOBNET_INVALID_PREFIX_LEN)
	</td>
</tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Mobile Router is not authorized for prefix
	  (MOBNET_UNAUTHORIZED)
	</td>
</tr>
<tr>
<td align="right">
	  TBA
	</td>
<td align="left">
	  Forwarding setup failed (MOBNET_FWDING_SETUP_FAILED)
	</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
	
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: New Code Values
			for Mobile Network Acknowledgement Extension&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	The policy of future assignments to this number space should
	be following Expert Review.
      
</p>
<p>
	The current non-modified numbering spaces could be consulted
	at the URL
	<a href='http://www.iana.org/assignments/mobileip-numbers'>http://www.iana.org/assignments/mobileip-numbers</a>
	  (contents last updated 2007-12-20 and last browsed
	  2008-01-04).
      
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgements</h3>

<p>
	The authors would like to thank Christophe Janneteau, George
	Popovich, Ty Bekiares, Ganesh Srinivasan, Alpesh Patel, Ryuji
	Wakikawa, George Tsirtsis, and Henrik Levkowetz for their
	helpful discussions, reviews and comments.  Vijay Devarapalli
	extensively reviewed one of the later versions of the draft.
	Hans Sjostrand (Hans Sj\"ostrand) identified the last
	clarifications with respect to Foreign Agent mode treatment.
	Pete McCann contributed necessary refinements of many
	statements.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2328">[RFC2328]</a></td>
<td class="author-text"><a href="mailto:jmoy@casc.com">Moy, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>,&rdquo; STD&nbsp;54, RFC&nbsp;2328, April&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2328.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2328.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2328.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2453">[RFC2453]</a></td>
<td class="author-text"><a href="mailto:gmalkin@baynetworks.com">Malkin, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2453">RIP Version 2</a>,&rdquo; STD&nbsp;56, RFC&nbsp;2453, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2453.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2453.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2453.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2794">[RFC2794]</a></td>
<td class="author-text"><a href="mailto:pcalhoun@eng.sun.com">Calhoun, P.</a> and <a href="mailto:charliep@iprg.nokia.com">C. Perkins</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2794">Mobile IP Network Access Identifier Extension for IPv4</a>,&rdquo; RFC&nbsp;2794, March&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2794.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3344">[RFC3344]</a></td>
<td class="author-text">Perkins, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3344">IP Mobility Support for IPv4</a>,&rdquo; RFC&nbsp;3344, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3344.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4271">[RFC4271]</a></td>
<td class="author-text">Rekhter, Y., Li, T., and S. Hares, &ldquo;<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>,&rdquo; RFC&nbsp;4271, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4271.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip4-nemov4-fa">[I-D.ietf-mip4-nemov4-fa]</a></td>
<td class="author-text">Tsirtsis, G., Park, V., Narayanan, V., and K. Leung, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip4-nemov4-fa-03.txt">FA extensions to NEMOv4 Base</a>,&rdquo; draft-ietf-mip4-nemov4-fa-03 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip4-nemov4-fa-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mip4-rfc3344bis">[I-D.ietf-mip4-rfc3344bis]</a></td>
<td class="author-text">Perkins, C., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip4-rfc3344bis-10.txt">IP Mobility Support for IPv4, revised</a>,&rdquo; draft-ietf-mip4-rfc3344bis-10 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mip4-rfc3344bis-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3963">[RFC3963]</a></td>
<td class="author-text">Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;<a href="http://tools.ietf.org/html/rfc3963">Network Mobility (NEMO) Basic Support Protocol</a>,&rdquo; RFC&nbsp;3963, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3963.txt">TXT</a>).</td></tr>
</table>

<a name="changelog"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
ChangeLog</h3>

<p>
	The changes are listed in reverse chronological order, most
	recent changes appearing at the top of the list.
      
</p>
<p>
	From draft-ietf-mip4-nemo-v4-base-06.txt to
	draft-ietf-mip4-nemo-v4-base-07.txt
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    encoded the draft into xml.  Compiled with xml2rfc version
	    1.33pre4.
	  
</li>
<li>
	    checked against 'idnits' script version 2.05.03.
	  
</li>
<li>
	    substituted 'Care-of Address' for 'CoA'.
	  
</li>
</ul><p>
      
</p>
<p>
	From draft-ietf-mip4-nemo-v4-base-05.txt to
	draft-ietf-mip4-nemo-v4-base-06.txt
      
</p>
<p>
      </p>
<ul class="text">
<li>
	  substituted "TBA" for "1" in Sub-type of Mobile Network
	  Request Extension.
	
</li>
<li>
	  substituted "TBA" for "0" in Code of Mobile Network
	  Acknowledgement Extension and in the IANA Section.
	
</li>
<li>
	  modified the IANA section to request definition two new
	  spaces (instead of just defining new values) for Sub-Type of
	  Mobile Network Extensions and for Code Values for Mobile
	  Network Acknowledgement Extension, and to suggest "Expert
	  Review" as method of new assignments in these two spaces
	  (and not necessarily "IETF Consensus").
	
</li>
</ul><p>
      
</p>
<p>
	From draft-ietf-mip4-nemo-v4-base-04.txt to
	draft-ietf-mip4-nemo-v4-base-05.txt
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    updated the Acknowledgements section.
	  
</li>
<li>
	    capitalized all occurences of "Home Address", "Mobile
	    Router" and "Care-of Address".
	  
</li>
<li>
	    refined many statements.
	  
</li>
<li>
	    checked against 'idnits' script version 2.04.16.
	  
</li>
</ul><p>
      
</p>
<p>
	From draft-ietf-mip4-nemo-v4-base-03.txt to
	draft-ietf-mip4-nemo-v4-base-04.txt
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    more changes in Introduction to say that with FA mode only
	    the non-optimized double-encapsulation operation is
	    supported and <a class='info' href='#I-D.ietf-mip4-nemov4-fa'>[I&#8209;D.ietf&#8209;mip4&#8209;nemov4&#8209;fa]<span> (</span><span class='info'>Tsirtsis, G., Park, V., Narayanan, V., and K. Leung, &ldquo;FA extensions to NEMOv4 Base,&rdquo; April&nbsp;2008.</span><span>)</span></a>
	    proposes a optimization.
	  
</li>
</ul><p>
      
</p>
<p>
	From draft-ietf-mip4-nemo-v4-base-02.txt to
	draft-ietf-mip4-nemo-v4-base-03.txt
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    changed a sentence in the Introduction to say that FA mode
	    _is_ supported but unoptimized, and that a <a class='info' href='#I-D.ietf-mip4-nemov4-fa'>reference<span> (</span><span class='info'>Tsirtsis, G., Park, V., Narayanan, V., and K. Leung, &ldquo;FA extensions to NEMOv4 Base,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;nemov4&#8209;fa]
	    optimizes that mode.
	  
</li>
<li>
	    added <a class='info' href='#I-D.ietf-mip4-rfc3344bis'>reference<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4, revised,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mip4&#8209;rfc3344bis] to the
	    rfc3344bis draft.
	  
</li>
</ul><p>
      
</p>
<p>
	From draft-ietf-mip4-nemo-v4-base-01.txt to
	draft-ietf-mip4-nemo-v4-base-02.txt
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    changed title from "IPv4 Network Mobility (NEMO) Protocol"
	    to "Network Mobility (NEMO) Extensions for Mobile IPv4".
	  
</li>
</ul><p>
      
</p>
<p>
	From draft-ietf-mip4-nemo-v4-base-00.txt to
	draft-ietf-mip4-nemo-v4-base-01.txt
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    added a section on Routing Protocol between Mobile Router
	    and Home Agent.
	  
</li>
<li>
	    added a security subsection about running simultaneously a
	    secure routing protocol with secure Mobile IPv4.
	  
</li>
<li>
	    added a date tag on the IANA URL for Mobile IP numbering
	    spaces.
	  
</li>
<li>
	    substituted 'Mobile Router' for 'MR' everywhere.
	  
</li>
<li>
	    updated reference to NEMOv4 FA draft.
	  
</li>
</ul><p>
      
</p>
<p>
	From draft-ietf-nemo-v4-base-01.txt to
	draft-ietf-mip4-nemo-v4-base-00.txt:
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    changed draft name, headers and footers.
	  
</li>
<li>
	    changed title.
	  
</li>
<li>
	    a more coherent use of terms 'subnet', 'prefix' and
	    'mobile network'.
	  
</li>
<li>
	    clarified only co-located CoA mode is supported (not FA
	    CoA) for Mobile Routers in this specification.  And added
	    reference to the FA NEMO optimizations draft.
	  
</li>
<li>
	    changed 'devices' to 'hosts'.
	  
</li>
<li>
	    changed 'moving networks' to 'mobile networks'.
	  
</li>
<li>
	    clarified what 'reachability' in a certain context is:
	    packets may be dropped if ingress filtering is turned on.
	  
</li>
<li>
	    removed the MR-FA-CoA tunnel overhead optimization.  There
	    is still an issue with text at HA doing optimization.
	  
</li>
</ul><p>
      
</p>
<p>
	This document was first presented as an individual
	contribution to the NEMO Working Group, then adopted as a WG
	item to that group.  The 01 version in the NEMO WG has been
	Last Called on the INFORMATIONAL track.  The evolution was:
      
</p>
<p>
	From version draft-ietf-nemo-v4-base-00 to
	draft-ietf-nemo-v4-base-01:
      
</p>
<p>
	</p>
<ul class="text">
<li>
	    removed error code HA_MOBNET_UNSUPPORTED.
	  
</li>
<li>
	    changed all values to be assigned by IANA, from specific
	    numbers to "TBA" (To Be Assigned).
	  
</li>
<li>
	    substituted "egress interface" for "roaming interface".
	  
</li>
<li>
	    changed HA behaviour upon reception of MNPs.  In 00 the HA
	    replied positively only if all MNPs in RegReq were valid,
	    in 01 a reply is constructed specifying which MNP was
	    valid and which not.
	  
</li>
<li>
	    clarified a 3-line paragraph saying that RegRep may
	    contain both implicit and explicit acknowledgements.
	  
</li>
</ul><p>
      
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kent Leung</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W. Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408-526-5030</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kleung@cisco.com">kleung@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gopal Dommety</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W. Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408-525-1404</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gdommety@cisco.com">gdommety@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vidya Narayanan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">QUALCOMM, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5775 Morehouse Dr</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Diego, CA  </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 858-845-2483</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vidyan@qualcomm.com">vidyan@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alexandru Petrescu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Motorola</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Parc les Algorithmes Saint Aubin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gif-sur-Yvette, Essonne  91140</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33 169354827</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:alexandru.petrescu@motorola.com">alexandru.petrescu@motorola.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
