<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Coupling of Service and Neighbor Discovery in 6LowPAN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Coupling of Service and Neighbor Discovery in 6LowPAN">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Manner</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">TKK</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">October 19, 2009</td></tr>
<tr><td class="header">Expires: April 22, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Coupling of Service and Neighbor Discovery in 6LowPAN<br />draft-manner-6lowapp-sdnd-00.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 22, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>

Finding out functionality, nodes or services, in general resources, 
in a network has a number of well-known solutions. A sensor network 
has inherent limitations and requires a solution that has a low 
footprint and follows the networking concepts defined within 6LoWPAN. 
This draft discusses two alternative solutions to service discovery 
in a sensor network. Both approaches are based on the 6LowPAN 
Neighbor Discovery.

	
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Service discovery using ND<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Approach 1: piggy-backing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Approach 2: SD as ND<br />
<a href="#anchor5">3.</a>&nbsp;
Service descriptions<br />
<a href="#anchor6">4.</a>&nbsp;
Discussion<br />
<a href="#anchor7">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor8">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor9">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>

Service discovery has been a research topic for years. Currently the 
topic is rather well understood and we have had products on the market 
for years, Universal Plug and Play (UPnP) being the most well-known 
example. In the IETF, the Service Location Protocol (SLP) is probably 
the most familiar outcome of activities in this area, yet, the 
protocol does not seem to have had a tremendeous deployment.


</p>
<p>

If we look at the landscape in service discovery for resource 
constrained devices, such as nodes in a sensor network, there exists 
many proposal from the academic community. However, they all seem 
somewhat uncessary complex. A 6LoWPAN-based solution should be simple 
and enable low overheard, while trying to be as flexible and powerful 
as possible within the constraints imposed by the sensor devices.


</p>
<p>

The 6Lowpan Neighbour Discovery (ND) <a class='info' href='#I-D.ietf-6lowpan-nd'>[I&#8209;D.ietf&#8209;6lowpan&#8209;nd]<span> (</span><span class='info'>Shelby, Z., Chakrabarti, S., and E. Nordmark, &ldquo;Neighbor Discovery Optimization for Low-power and Lossy Networks,&rdquo; April&nbsp;2010.</span><span>)</span></a> describes means for a sensor node to 
disseminate it's IPv6 address to the network, and if needed, defend it 
against other nodes. The functionality presented in the ND draft is 
based on Edge Routers (ER) that maintain a white board, a database, 
of addresses claimed in the sensor network. This makes ND a 
centralized service. ERs can be used when the sensor network is 
connected to a backbone link, but an ad-hoc sensor network can also 
have ERs that function as the centralized address allocation 
database.


</p>
<p>

What is interesting about the ND functionality is that it has the 
same overall goal as service discovery (SD): a node has a 
characteristic, a functionality, it wants to disseminate to other 
nodes. This is analoguous to SD, a node has a service it wants to 
make known and enable others to use. This is a simplistic view, of 
course, but in general the goal of ND is very close to what SD 
requires, make a resource known to others (claim it). In ND, an IP 
address, a resource, can only be assigned to a single node, but in SD 
numerous nodes can host the same resource, the service. In SD, the 
possibility of having several nodes host the same resource enables us 
to drop much of the more complex ND functionality.


</p>
<p>

One of the issues with enabling service discovery is how to describe 
a service. We need a common means to describe a service when it is 
advertised or search for. In a sensor network, we have to rely on 
very small messages, thus, lenghty service descriptions are not 
possible. We need a means to define services in a compact format.


</p>
<p>

The purpose of this draft is to discuss two distinct approaches to 
enabling service discovery in a 6LowPan-enabled sensor network. The 
rest of this draft presents the two alternatives, discusses their 
pros and cons, and seeks to trigger some community response from 
6LowApp.


</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Service discovery using ND</h3>

<p>

This section presents two approaches for running SD in a sensor 
network, piggy-backing SD payloads in ND messages, or running a 
separate SD protocol that has much of the same functionality as ND.


</p>
<p>

In both cases, there are two commonalities. First of all, we need to 
define two new ICMP messages. The structure of these two new messages 
would be similar to the ND ICMP messages, only slightly simpler.


</p>
<p>

</p>
<ol class="text">
<li>Service query (SQ): sent by a node to look up a service from the 
whiteboard on an ER.
</li>
<li>Service reply (SR): sent by an ER to the requesting node 
indicating which, if any, node(s) hosts the service.
</li>
</ol><p>


</p>
<p>

In both of these messages, we need to have a request ID, or similar 
serial number, to match replies to requests. This is needed when a 
node is looking for several services, and one SQ can only indicate a 
single service to be found; a node can have several outstanding 
queries and needs to match incoming replies to the right query.


</p>
<p>

Secondly, in the normal case the same service can run on more than 
one node. Analoguous to the ND specification, we could make use of 
the so-called "Duplicate flag" that if set allows more than one host 
to offer a certain service. Yet, when the bit is not set, only one 
node in the network can host a certain service at a time. Here we 
could make use of the DAD functionality of ND and enable nodes to 
claim and defend their services.


</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Approach 1: piggy-backing</h3>

<p>

The first approach to enabling service discovery in a sensor network 
is to piggy-back service availability information within ND messages. 
In particular, when a node sends its IP address information to an ER 
(or refreshes it), the node also includes additional information 
about the services it is hosting.


</p>
<p>

The basic functionality for SD would be the same as in ND, i.e., 
nodes announce their services to ERs, and maintain this information 
along the refresh messages sent by ND for the IPv6 address mapping. 
If a service is taken down from a node, it can send a refresh ND 
message


</p>
<p>

The ND specification mentions but does not define a "Configuration 
Option" that may be used to carry options. We can make use of this 
particular functionality, or define a separate option that is very 
much similar. This option should be stackable, meaning we want to be 
able to carry information about more than one service running on a 
single node.


</p>
<p>

The same object would be used on the service lookup message (SQ) to 
indicate the service the node is looking for. Only one service can be 
looked up in one message, otherwise sending back an answer becomes 
complex, as discussed above.


</p>
<p>

To make service deregistration easier, we could add a bit in the 
object above to indicate that the service is not being introduced but 
rather an existing binding should be removed from the ER.


</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Approach 2: SD as ND</h3>

<p>

An alternative to the first approach would be to define an SD 
protocol that makes use of most of the functionality of ND. In 
general, we would re-use from ND the registration (and ack) of IPv6 
addresses on ERs, the claiming and defending of services (optional), 
and add the SQ/SR messaging. The end result would be quite similar to 
ND, on a high level, except that nodes store service availability on 
ERs, instead of IPv6 addresses.


</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Service descriptions</h3>

<p>

A key issue to design is an efficient encoding of the service 
descriptions. We do not want to have a verbose format and expressions 
in a sensor network. In this respect, we propose to present services 
as fixed-size hashes. In particular, a hash can be calculated from e.g.


</p>
<p>

</p>
<ul class="text">
<li>a verbose (e.g. XML-based) description of a service, or
</li>
<li>a simple string describing a resource (e.g. "gateway", 
"temperature sensor").
</li>
</ul><p>


</p>
<p>

We could also allocate services to pre-defined integer values. This 
has the downside that we need to maintain a list of well-known 
services, such as an IANA registry. Also, having fixed numbers is less 
flexible.


</p>
<p>

In a sensor network, the typical use cases are about finding a sink 
or a gateway (or ER) from a sensor node, or finding a particular 
sensor from the gateway. We don't usually have use cases for 
situations where a node would be looking for services in general, and 
then picking something "interesting" or otherwise random. All use 
cases are about finding whether (or actually just where) a particular 
service is available in the sensor network.


</p>
<p>

In some use cases, it might be important to hide the SD messaging, in 
particular make it harder to figure out what service a particular 
node is hosting, or looking for. If we use a simple hash of a service 
description that remains static all the time, an outsider, if link 
layer encryption is not used or has been broken, can analyze the SD 
messaging and employ statistical analysis to seek to find out the 
services available; at least what are the most frequently asked 
services.


</p>
<p>

To make this guessing harder, we can calculate the hash from a more 
dynamic data. For example, we could calculate the hash from the 
service description or string but also add a further data element to 
make each hash in the network different. This way an outsider will 
only see a huge number of different service descriptions. An example 
for such an additional data element could be the IP address of the 
node asking for or providing a service. It would be straightforward 
for a legitimate node to dig the actual service information from a 
received message, provided it knows the service descriptions that are 
used in the sensor network. The use of hashing needs some more study 
to fine-tune all details.


</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Discussion</h3>

<p>

The first approach would be clearly more desirable since it would 
allow for code reuse on a sensor node, and limit the amount of bytes 
sent due to SD. This would be most beneficial to the sensor nodes 
with limited resources. Moreover, specifying a full protocol that 
would essentially only carry additional information to ERs along ND 
seems like a waste of resources.


</p>
<p>

If the network does not have ND deployed, we would be forced to 
introduce SD as the described separate protocol. If that is the case, 
we should aim for a simple messaging and limited functionality, 
instead of trying to design a solution that has the same level and 
features as, e.g., UPnP.


</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>

This draft presents two overall approaches to service discovery. A 
detailed security analysis will be done if the work proceeds to 
target a protocol specification.


</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>

This document does not make requests to IANA at this stage.


</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>

This work is a joint effort by the FP7 211998 AWISSENET and TKK ISMO 
research projects. Ad-hoc PAN and Wireless Secure Sensor Networks 
(AWISSENET) is an EU-funded FP7 project. Intelligent Structural 
Health Monitoring System (ISMO) is funded by the Multidisciplinary 
Institute of Digitalisation and Energy (MIDE, 
http://mide.tkk.fi/en/), a technology initiative by the Helsinki 
University of Technology (TKK).


</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-6lowpan-nd">[I-D.ietf-6lowpan-nd]</a></td>
<td class="author-text">Shelby, Z., Chakrabarti, S., and E. Nordmark, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-6lowpan-nd-09.txt">Neighbor Discovery Optimization for Low-power and Lossy Networks</a>,&rdquo; draft-ietf-6lowpan-nd-09 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-6lowpan-nd-09.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jukka Manner</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Helsinki University of Technology (TKK)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Communications and Networking (Comnet)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.O. Box 3000</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  FIN-02015 TKK</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 9 451 2481</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jukka.manner@tkk.fi">jukka.manner@tkk.fi</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.netlab.tkk.fi/~jmanner/">http://www.netlab.tkk.fi/~jmanner/</a></td></tr>
</table>
</body></html>
