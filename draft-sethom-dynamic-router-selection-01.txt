                                                      
                                                                                                 
                  Internet Draft                                       Kaouthar Sethom 
                                                                             INT-France 
                  Document: draft-sethom-dynamic-router-                 Sidi-Mohammed 
                  selection-01.txt                                             Senouci 
                                                                         FRANCE TELECOM 
                  Expires: June 2006                                   Hossam Afifi 
                                                                             INT-France 
                                                                           January 2006 
                   
                   
                                         Dynamic router selection 
                   
                   
               Status of this Memo 
                   
                  By submitting this Internet-Draft, each author represents that any 
                  applicable patent or other IPR claims of which he or she is aware 
                  have been or will be disclosed, and any of which he or she becomes 
                  aware will be disclosed, in accordance with Section 6 of BCP 79. 
                   
                                 
                                    
                  Internet-Drafts are working documents of the Internet Engineering 
                  Task Force (IETF), its areas, and its working groups.  Note that      
                  other groups may also distribute working documents as Internet-
                  Drafts. 
                   
                  Internet-Drafts are draft documents valid for a maximum of six months 
                  and may be updated, replaced, or obsoleted by other documents at any 
                  time.  It is inappropriate to use Internet-Drafts as reference 
                  material or to cite them other than as "work in progress." 
                   
                  The list of current Internet-Drafts can be accessed at 
                       http://www.ietf.org/ietf/1id-abstracts.txt 
                  The list of Internet-Draft Shadow Directories can be accessed at 
                       http://www.ietf.org/shadow.html. 
                   
                   
                   
                   
               Abstract 
                   
                
                
               Sethom                  Expires - June 2006                [Page 1] 
                                      Dynamic router selection           January 2006 
                
                
                  In a network topology where the host has multiple routers on its 
                  Default Router List, it is important to select the most suitable one 
                  according to node’s application requirements. This document describes 
                  an extension to router advertisement message [RFC 1256, RFC 2461] for 
                  dynamic router selection. This new functionality is implemented in 
                  routers with additional capabilities.  
                   
                   
               Conventions used in this document 
                   
                  The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
                  "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this 
                  document are to be interpreted as described in RFC-2119 [i]. 
                   
               Table of Contents 
                   
                  1. Introduction...................................................2 
                  2. Terminology....................................................2 
                  3. Protocol Overview..............................................3 
                     3.1 Message Formats............................................4 
                       3.1.1  ICMP Router Advertisement Message                     4 
                       3.1.2  IPv6 Router Advertisement Message                     6 
                  Security Considerations...........................................8 
                  References........................................................8 
                  Author's Addresses................................................9 
                   
                   
               1. Introduction 
                   
                  The core of the next generation infrastructure is expected to be the 
                  IP  based  multi-service  network  that  provides  connectivity  and 
                  transport  via  any  access  technology,  including  optical  fibre, 
                  wireless local area networks (WLAN), 3G systems and future access 
                  technologies. Since each system may be different in terms of QoS 
                  capabilities, availability (coverage), capacity and price; a node 
                  with a list of default routers must be able to choose the most 
                  suitable one in terms of offered QoS. 
                   
                  As current router discovery protocols do not offer such opportunity, 
                  we describe here an optional extension to router discovery process to 
                  support dynamic gateway selection. Each router will be able to 
                  broadcast “fresh” informations about its offered QoS. This improves 
                  the  ability  of  nodes  to  choose  an  appropriate  router  for  a 
                  destination. 
                   
                   
               2. Terminology 
                   

                
                
               Sethom                  Expires - June 2006                [Page 2] 
                                      Dynamic router selection           January 2006 
                
                
                  - Router Egress interface:  One of the router’s interfaces used to 
                     forward packets upstream to the rest of the Internet. 
                  - Router Ingress interface: one of the router’s interfaces used to 
                     forward packets downstream to the nodes inside a subnet. 
                   
                   
                   
               3. Protocol Overview 
                   
                  In this section, we describe the dynamic gateway selection process 
                  that is designed to work in the case of IPv4 as well as in the case 
                  of IPv6 addressing system. 
                   
                  Traditionally, nodes on a LAN learn about default routers by 
                  receiving Router Advertisements [1,2].  Each router periodically 
                  multicasts a Router Advertisement from each of its multicast 
                  interfaces, announcing the IP address(es) of that interface.  
                  Delivery of a packet to another subnetwork requires that the packet 
                  be sent to a router on the same subnetwork as the sender for 
                  forwarding to the ultimate destination. Since the only router known 
                  to the end system is the default gateway, this would be the router 
                  used. Routers, on the other hand, learn through their router-to-
                  router routing protocols of all other routers that they can reach and 
                  that provide the best path to each possible destination. If another 
                  router on the same subnetwork as the sender has a better route to the 
                  desired destination, the router initially receiving the packet would 
                  forward the original packet along the best path available. It would 
                  also send a re-direct packet back to the sending end system, 
                  informing it of the better router available for that destination. 
                  Depending upon the sophistication of the protocol implementation on 
                  the sending end system, that new router information might be 
                  remembered for future use with packets destined to the same 
                  destination, or it might be ignored. Either way, the off-network 
                  packets would be delivered correctly. 
                   
                  A Router Advertisement can includes a "preference field" [1,3] for 
                  each advertised router address.  When a node must choose a default 
                  router, it is expected to choose from those router addresses that 
                  have the highest preference level. 
                   
                  These preference values are not automatically derived from routing 
                  table, they are generally pre-configured by the network administrator 
                  to encourage or discourage the use of particular routers as default 
                  routers. Changes in the availability or characteristics of some links 
                  - such as congestion - can result in a situation, where the user 
                  wants to move already established traffic flows from one path to 
                  another. “Fresh” information on the routers’ egress interfaces 
                  characteristics should then always be available to the application 

                
                
               Sethom                  Expires - June 2006                   [Page 3] 
                                      Dynamic router selection              January 2006 
                
                
                  layers, so that they can dynamically adapt to such changes and choose 
                  the best available router. 
                   
                   
                  To that’s end, we propose to add a new option field “Dynamic router 
                  selection (DRS)” to the router advertisement message that will 
                  contain information about router’s interfaces characteristics such as 
                  throughput, type... 
                   
                  At each node in the network, all received router advertisement 
                  packets (with DRS field) are registered in what we called the gateway 
                  table. This information repository is re-freshed periodically. This 
                  means that entries are deleted as soon as their validity time 
                  expires. Each time a host wants to send IP data datagrams, it uses 
                  the information on its local gateway table to choose among available 
                  router the best one to destination according to its applications 
                  requirements or needs. 
                   
                  Note that, for nodes that do not support dynamic router selection 
                  processing, they simply ignore the DRS field and continue to choose a 
                  default router in the traditional way. 
                   
                  When a new router advertisement message is received, the host updates 
                  its gateway table either by updating an existing entry, or if no 
                  entry exists for the gateway address, creating a new entry. 
                   
               3.1 Message Formats 
                   

               3.1.1 ICMP Router Advertisement Message 
                   
                  Changes to ICMP Router Advertisement Message [RFC 1256] section 3 are 
                  as follows: 
                   
                   0                   1                   2                   3 
                   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |     Type      |     Code      |           Checksum            | 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |   Num Addrs   |Addr Entry Size|           Lifetime            | 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |                       Router Address[1]                       | 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |                      DRS option[1]                            | 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |                       Router Address[2]                       | 
                
                
               Sethom                  Expires - June 2006                [Page 4] 
                                      Dynamic router selection              January 2006 
                
                
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |                      DRS option[2]                            | 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |                               .                               | 
                   |                               .                               | 
                    
                   ICMP Fields: 
                    
                    
                   Type                 9 
                    
                    
                   Code                 1 to indicate that the IP addresses in the 
                                        Router address fields refer to reachable 
                                        networks through this router and is not on-link 
                                        router interfaces addresses. 
                    
                    
                    
                   Num Addrs             the number of router addresses advertised 
                                         in this message. 
                    
                    
                    
                   Router Address[i],    the address of a network reachable through 
                    i = 1..Num Addrs     the engress interface i of this router. 
                    
                    
                    
                    
                   DRS option [i]        characteristics of the router’s egress 
                                          interface i associated with the Address[i]. 
                    
                   0                   1                   2                   3 
                   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   |Interface Type |     Cost       |  Throughput                  | 
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                    
                    
                           Interface Type   This field indicates the technology used by 
                                            the  router  Egress  interface.  Example 
                                            Bluetooth, 802.11, Ethernet, UMTS... 
                             

                
                
               Sethom                  Expires - June 2006                [Page 5] 
                                      Dynamic router selection            January 2006 
                
                
                             
                                            Type values can be encoded as follows:  
                                             
                                                   0x00      Ethernet (default) 
                                                   0x01      Bluetooth  
                                                   0x10      UMTS 
                                                   0x11      802.16 
                                                     … 
                                
                            
                           Cost             This field indicates the communication cost 
                                            associated with the use of this interface: 
                                            high, medium, low.  This parameter can be a 
                                            combination of different metrics such as 
                                            offered QoS, security issues, price and 
                                            possibly other preferences. 
                             
                             
                           Throughput          This  field  indicates  the  throughput 
                                            associated with the router egress interface. 
                    
                
                
                                   

               3.1.2 IPv6 Router Advertisement Message 
                   
                  Changes to Router Advertisement Message [RFC 2461] section 4.6.2 are 
                  as follows: 
                   
                  0                   1                   2                   3 
                  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                  |     Type      |    Length     | Prefix Length |L|A|O|Reserved1| 
                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                  |                         Valid Lifetime                        | 
                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                  |                       Preferred Lifetime                      | 
                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                  |                         DRS option                            | 
                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                  |                         Prefix                                | 

                
                
               Sethom                  Expires - June 2006                [Page 6] 
                                      Dynamic router selection              January 2006 
                
                
                  +                                                               + 
                  |                                                               | 
                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                   
                   
                   
                  Fields: 
                
                   L              1-bit link flag.  When set to 1, indicates that this              
                                   prefix can be used for on-link determination. When 
                                   set to zero, indicates that if the field O is set to 
                                   1 this prefix can be used for off-link determination.   
                       
                   A         1-bit autonomous address-configuration flag.  When              
                                   set indicates that this prefix can be used for              
                                   autonomous address configuration as specified in              
                                   [ADDRCONF]. 
                    
                   O               1-bit off-link flag.  When set, indicates that the 
                                   router has an egress-interface with this prefix and 
                                   can be used for off-link determination.   
                    
                   DRS option      characteristics of the router’s egress interface i 
                                   associated with the prefix announced in the next 
                                   field. 
                
                
                
                    0                   1                   2                   3 
                    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                    |Interface Type |     Cost      |  Throughput                   | 
                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
                
                
                              Interface Type   This field indicates the technology used 
                                                by the router Egress interface. Example 
                                                Bluetooth, 802.11, Ethernet, UMTS ... 
                                    
                                    
                                             Type values can be encoded as follows:  
                                              
                                                   0x00      Ethernet (default) 

                
                
               Sethom                  Expires - June 2006                [Page 7] 
                                      Dynamic router selection              January 2006 
                
                
                                                    0x01      Bluetooth  
                                                    0x10      UMTS 
                                                    0x11      802.16 
                                                    … 
                                       
                                    
                              Cost            This field indicates the communication 
                                                cost associated with the use of this 
                                                interface: high, medium, low.  This 
                                                parameter  can  be  a  combination  of 
                                                different metrics such as offered QoS, 
                                                security  issues,  price  and  possibly 
                                                other preferences. 
                                    
                                    
                              Throughput      This  field  indicates  the  throughput 
                                                associated  with  the  router  egress 
                                                interface.   
                                    
                                    
                                    
                              Prefix         An IP address or a prefix of an IP 
                                                address.  The  Prefix  Length  field 
                                                contains the number of valid leading 
                                                bits in the prefix.  When the bit L is 
                                                set to zero and O to 1, it indicates 
                                                the IP address of a network reachable 
                                                through this router. The Prefix Length 
                                                field  contains  the  number  of  valid 
                                                leading bits in the prefix.  The bits 
                                                in the prefix after the prefix length 
                                                are reserved and MUST be initialized to 
                                                zero by the sender and ignored by the 
                                                receiver. 
                   
                   
                   
                   
               Security Considerations 
                   
                  This memo does not specify any security considerations. 
                   
                   
               References 
                   
                   
                
                
               Sethom                  Expires - June 2006                [Page 8] 
                                      Dynamic router selection              January 2006 
                
                
                    [1]  Stephen E. Deering. “ICMP router discovery messages”. Internet 
                         RFC 1256, September 1991 
                     
                     
                    [2]  Narten, T., E. Nordmark, W. Simpson, "Neighbor Discovery              
                         for IP Version 6 (IPv6)", RFC2461, December 1998. 
                     
                     
                    [3]  R. Draves, D. Thaler,    "Default Router Preferences and 
                         More-Specific Routes", draft-ietf-ipv6-router-selection-
                         07.txt, January 2005 
                   
                   
                   
                   
               Author's Addresses 
                   
                  Kaouthar Sethom 
                  INT-France 
                  9 rue charles fourrier 91011 evry cedex France 
                  Email: kaouthar.sethom@int-evry.fr 
                   
                   
                  Sidi-Mohammed Senouci 
                  France Télécom R&D 
                  2, Avenue Pierre Marzin 
                  22307 Lannion Cedex France 
                  Email : sidimohammed.senouci@francetelecom.com 
                   
                   
                  Hossam Afifi 
                  INT-France 
                  9 rue charles fourrier 91011 evry cedex France 
                  Email: hassam.afifi@int-evry.fr 
                   
                   
                                    
                   
                  Copyright (C) The Internet Society (2006) 
                   
                  This document is subject to the rights, licenses and restrictions 
                  contained in BCP 78, and except as set forth therein, the authors 
                  retain all their rights.  
                   
                  This document and the information contained herein are provided on an 
                  "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
                  OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET 
                
                
               Sethom                  Expires - June 2006                [Page 9] 
                                      Dynamic router selection           January 2006 
                
                
                                                                                        
                  ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, 
                  INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE 
                  INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
                  WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 












































                
                
               Sethom                  Expires - June 2006               [Page 10] 
