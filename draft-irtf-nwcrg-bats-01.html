<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BATS Coding Scheme for Multi-hop Data Transport</title>
<meta content="Shenghao Yang" name="author">
<meta content="Xuan Huang" name="author">
<meta content="Raymond W. Yeung" name="author">
<meta content="John K. Zao" name="author">
<meta content="
       BATS code is a class of efficient linear network coding scheme with a matrix generalization of fountain codes as the outer code, and batch-based linear network coding as the inner code. This document describes a baseline BATS coding scheme for communication through multi-hop networks, and discusses the related research issues towards a more sophisticated BATS coding scheme. This document is a product of the Coding for Efficient Network Communications Research Group (NWCRG). 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="BATS code" name="keyword">
<meta content="multi-hop" name="keyword">
<meta content="draft-irtf-nwcrg-bats-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-irtf-nwcrg-bats-01-uncsrl97.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BATS Code</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Yang, et al.</td>
<td class="center">Expires 29 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">NWCRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-nwcrg-bats-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-28" class="published">28 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-29">29 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Yang</div>
<div class="org">CUHK(SZ)</div>
</div>
<div class="author">
      <div class="author-name">X. Huang</div>
<div class="org">CUHK</div>
</div>
<div class="author">
      <div class="author-name">R. W. Yeung</div>
<div class="org">CUHK</div>
</div>
<div class="author">
      <div class="author-name">J. K. Zao</div>
<div class="org">NCTU</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BATS Coding Scheme for Multi-hop Data Transport</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">BATS code is a class of efficient linear network coding scheme with a matrix generalization of fountain codes as the outer code, and batch-based linear network coding as the inner code. This document describes a baseline BATS coding scheme for communication through multi-hop networks, and discusses the related research issues towards a more sophisticated BATS coding scheme. This document is a product of the Coding for Efficient Network Communications Research Group (NWCRG).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty ulBare toc">
<li class="compact ulEmpty ulBare toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology-and-definitions" class="xref">Terminology and Definitions</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-a-use-case-of-bats-coding-s" class="xref">A Use Case of BATS Coding Scheme</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-data-delivery-procedures" class="xref">Data Delivery Procedures</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-source-node-data-partitioni" class="xref">Source Node Data Partitioning and Padding</a></p>
</li>
                  <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-source-node-outer-code-enco" class="xref">Source Node Outer Code Encoding Procedure</a></p>
</li>
                  <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="xref">2.2.3</a>.  <a href="#name-recoding-procedures" class="xref">Recoding Procedures</a></p>
</li>
                  <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="xref">2.2.4</a>.  <a href="#name-destination-node-procedures" class="xref">Destination Node Procedures</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-recommendation-for-the-para" class="xref">Recommendation for the Parameters</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-example-ddp-packet-format" class="xref">Example DDP Packet Format</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="xref">2.4.1</a>.  <a href="#name-packet-header" class="xref">Packet Header</a></p>
</li>
                  <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2.2.4.2.2">
                    <p id="section-toc.1-1.2.2.4.2.2.1"><a href="#section-2.4.2" class="xref">2.4.2</a>.  <a href="#name-packet-payload" class="xref">Packet Payload</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-bats-code-specification" class="xref">BATS Code Specification</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-common-parts" class="xref">Common Parts</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-outer-code-encoder" class="xref">Outer Code Encoder</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-inner-code-encoder-recoder" class="xref">Inner Code Encoder (Recoder)</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-belief-propagation-decoder" class="xref">Belief Propagation Decoder</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-research-issues" class="xref">Research Issues</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-coding-design-issues" class="xref">Coding Design Issues</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-protocol-design-issues" class="xref">Protocol Design Issues</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-application-related-issues" class="xref">Application Related Issues</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-provision-of-confidentialit" class="xref">Provision of Confidentiality Protection</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-countermeasures-against-pol" class="xref">Countermeasures against Pollution Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-additional-stuff" class="xref">Additional Stuff</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies a baseline <span><a href="#Yang14" class="xref">BATS code</a> [<a href="#Yang14" class="xref">Yang14</a>]</span> scheme for data delivery in multi-hop networks, and discusses the related research issues towards a more sophisticated scheme. The BATS code described here includes an outer code and an inner code. The outer code is a matrix generalization of fountain codes (see also the RapterQ code described in <span><a href="#RFC6330" class="xref">RFC 6330</a> [<a href="#RFC6330" class="xref">RFC6330</a>]</span>), which inherits the advantages of reliability and efficiency and possesses the extra desirable property of being network coding compatible. The inner code, also called recoding, is formed by linear network coding for combating packet loss, improving the multicast efficiency, etc. A detailed design and analysis of BATS codes are provided in the <span><a href="#Yang17" class="xref">BATS monograph</a> [<a href="#Yang17" class="xref">Yang17</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">A BATS coding scheme can be applied in multi-hop networks formed by wireless communication links, which are inherently unreliable due to interference. Existing transport  protocols like TCP use end-to-end retransmission, while network protocols such as IP might enable store-and-forward at the relays, so that packet loss would accumulate along the way.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">A BATS coding scheme can be used for various data delivery applications like file transmission, video streaming over wireless multi-hop networks, etc. Different from traditional forward error correcting (FEC) schemes that are applied either hop-by-hop or end-to-end, the BATS coding scheme combines the end-to-end coding (the outer code) with certain hop-by-hop coding (the inner code), and hence can potentially achieve better performance.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The baseline coding scheme described here considers a network with multiple communication flows. For each flow, the source node encodes the data for transmission separately. Inside the network, however, it is possible to mix the packets from different flows for recoding. In this document, we describe a simple case where recoding is performed within each flow. Note that the same encoding/decoding scheme described here can be used with different recoding schemes as long as they follow the principle as we illustrate in this document.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The purpose of the baseline BATS coding scheme is twofold. First, it provides researchers and engineers a starting point for developing network communication applications/protocols based on BATS codes. Second, it helps to make the research issues more clear towards a sophisticated BATS code based network protocol. Important research directions include the security issues, congestion control and routing algorithms for BATS codes, etc.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"> This document is a product of and represents the collaborative work and consensus of the Coding for Efficient Network Communications Research Group (NWCRG); it is not an IETF product and is not an IETF standard.<a href="#section-1-6" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <span><a href="#RFC2119" class="xref">RFC 2119</a> [<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-terminology-and-definitions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology-and-definitions" class="section-name selfRef">Terminology and Definitions</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.2-1.1">DDP: data delivery protocol.<a href="#section-1.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-1.2">DDP packet: the packet formed by a DDP employing a BATS coding scheme.<a href="#section-1.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-1.3">source packet: the packet formed by the data for delivery.<a href="#section-1.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-1.4">BATS/coded packet: the packet generated by a BATS code encoder/recoder.<a href="#section-1.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-1.5">batch: a set of coded packets generated by a BATS coding scheme with the same subset of the source packets.<a href="#section-1.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-1.6">recoded packet: a coded packet generated by a recoder.<a href="#section-1.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-1.7">degree: the number of source packets used in a batch generation.<a href="#section-1.2-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
<div id="procedures">
<section id="section-2">
      <h2 id="name-a-use-case-of-bats-coding-s">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-a-use-case-of-bats-coding-s" class="section-name selfRef">A Use Case of BATS Coding Scheme</a>
      </h2>
<p id="section-2-1">The BATS coding scheme described in this document can be used, for example, by a Data Delivery Protocol (DDP). Though this document is not about a DDP, we briefly illustrate in this section how a BATS coding scheme is employed by a DDP to make the role of the coding scheme clear.<a href="#section-2-1" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-introduction-2">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
        </h3>
<p id="section-2.1-1">A BATS coding scheme includes an outer code encoder (also called encoder), an inner code encoder (also called recoder) and a decoder, which decodes the outer code and the inner code jointly. We describe a data delivery process that involves one source node, one destination node, and multiple intermediate nodes in between as illustrated in <a href="#network_model" class="xref">Figure 1</a>. This process includes the following procedures:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-a-network-model-for-data-de"></span><div id="network_model">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-2.1-2.1">
<pre>
    +-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+-+-+
    | source node | --&gt; | intermediate node | --&gt; ...
    +-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+-+-+

        +-+-+-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+-+-+
    --&gt; | intermediate node | --&gt; | destination node  |
        +-+-+-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-a-network-model-for-data-de" class="selfRef">A network model for data delivery.</a>
          </figcaption></figure>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">Outer code encoding is performed at the source node which has the data for transmission:<a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1.2.1">The DDP provides the data to be delivered and the related information to the BATS encoder.<a href="#section-2.1-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.1-3.1.2.2">The BATS encoder generates a sequence of batches, each consisting of a set of coded packets (also called BATS packets) and the information pertaining to the batch.<a href="#section-2.1-3.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1">The batches generated at the source node are further recoded before transmitting:<a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.2.2.1">A BATS recoder generates recoded packets of a batch.<a href="#section-2.1-3.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.1-3.2.2.2">The DDP forms and transmits the DDP packets using the batches and the corresponding batch information.<a href="#section-2.1-3.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-2.1-3.3">
            <p id="section-2.1-3.3.1">Recoding is performed at an intermediate node that does not need the data:<a href="#section-2.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.3.2.1">The DDP extracts the batches and the corresponding batch information from its received DDP packets.<a href="#section-2.1-3.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.1-3.3.2.2">A BATS recoder generates recoded packets of a batch.<a href="#section-2.1-3.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.1-3.3.2.3">The DDP forms and transmits DDP packets using the recoded packets and the corresponding batch information.<a href="#section-2.1-3.3.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-2.1-3.4">
            <p id="section-2.1-3.4.1">Decoding is performed at the destination node that needs the data:<a href="#section-2.1-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.4.2.1">The DDP extracts the batches and the corresponding batch information from its received DDP packets.<a href="#section-2.1-3.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.1-3.4.2.2">A BATS decoder tries to recover the transmitted data using the received batches.<a href="#section-2.1-3.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.1-3.4.2.3">The DDP sends the decoded data to the application that needs the data.<a href="#section-2.1-3.4.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
<section id="section-2.2">
        <h3 id="name-data-delivery-procedures">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-data-delivery-procedures" class="section-name selfRef">Data Delivery Procedures</a>
        </h3>
<p id="section-2.2-1">Suppose that the DDP has F octets of data for transmission. We describe the procedures of one BATS session for transmitting the F octets. There is a limit on F of a single BATS session. If the total data has more than the limit, the data needs to be transmitted using multiple BATS sessions. The limit on F of a single BATS session depends on the PMTU (path maximum transmission unit) of the network, which MUST be known by the DDP. We have F is no more than (PMTU-7)2^16-1 octets.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<section id="section-2.2.1">
          <h4 id="name-source-node-data-partitioni">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-source-node-data-partitioni" class="section-name selfRef">Source Node Data Partitioning and Padding</a>
          </h4>
<p id="section-2.2.1-1">
            The DDP first determines the following parameters:<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-2.1">Batch size (M): the number of coded packets in a batch.<a href="#section-2.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-2.2">Recoding field size (q): the number of elements in the finite field for recoding. q is 2 or 2^8<a href="#section-2.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-2.3">BATS payload size (TO): the number of payload octets in a BATS packet, including the coded data and the coefficient vector.<a href="#section-2.2.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.1-3"> Based on the above parameters, the parameters T, O and K are calculated as follows:<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-4.1">O: the number of octets of a coefficient vector, calculated as O = ceil(M*log2(q)/8).<a href="#section-2.2.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-4.2">T: the number of data octets of a coded packet, calculated as T = TO - O.<a href="#section-2.2.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-4.3">K: number of source packets, calculated as K = floor(F/T)+1.<a href="#section-2.2.1-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.1-5">
         The data MUST be padded to have T*K octets, which will be partitioned into K source packets b[0], ..., b[K-1], each of T octets.
         In our padding scheme, b[0], ..., b[K-2] are filled with data octets, and b[K-1] is filled with the remaining data octets and padding octets.
       Let P = K*T-F denote the number of padding octets. We use b[K-1, 0], ..., b[K-1, T-P-1] to denote the T-P source octets and b[K-1, T-P], ..., b[K-1, T-1] to denote the P padding octets in b[K-1], respectively. The padding insertion process is shown in <a href="#data_padding" class="xref">Figure 2</a>.<a href="#section-2.2.1-5" class="pilcrow">¶</a></p>
<span id="name-data-padding-insertion-proc"></span><div id="data_padding">
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-2.2.1-6.1">
<pre>
    Z = T - P
    j = 1
    v = 1
    Let bl be the last source packet b[K-1]
    for i = Z, Z+1, ..., T-1 do
      bl[i] = j
      if i+1 &gt;= v+Z do
        j += 1
        v += j
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-data-padding-insertion-proc" class="selfRef">Data Padding Insertion Process</a>
            </figcaption></figure>
</div>
</section>
<section id="section-2.2.2">
          <h4 id="name-source-node-outer-code-enco">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-source-node-outer-code-enco" class="section-name selfRef">Source Node Outer Code Encoding Procedure</a>
          </h4>
<p id="section-2.2.2-1">
          The DDP provides the BATS encoder to be decribed at <a href="#encoder" class="xref">Section 3.2</a> with the following information:<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-2.1">Batch size (M): the number of coded packets in a batch.<a href="#section-2.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-2.2">Recoding field size (q): the number of elements in the finite field for recoding.<a href="#section-2.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-2.3">Maximum degree (MAX_DEG): a positive integer.<a href="#section-2.2.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-2.4">Degree distribution (DD): an unsigned integer array of size MAX_DEG+1.<a href="#section-2.2.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-2.5">A sequence of batch IDs (BID) (j, j = 0, 1, ...).<a href="#section-2.2.2-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-2.6">Number of source packets (K).<a href="#section-2.2.2-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-2.7">Packet size (T): the number of octets in a source packet.<a href="#section-2.2.2-2.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-2.8">Source packets (b[i], i = 0, 1, ..., K-1).<a href="#section-2.2.2-2.8" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.2-3">
          Using this information, the (outer code) encoder generates a batch for each batch ID. The DDP recieves from the encoder a sequence of batches, where the batch with ID j has<a href="#section-2.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-4.1">a degree d[j], and<a href="#section-2.2.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-4.2">M coded packets (x[j,i], i =0, 1, ..., M-1), each containing TO octets.<a href="#section-2.2.2-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.2-5">
          The DDP will use the batches to form DDP packets to be transmitted to other network nodes towards the destination nodes. The DDP MUST deliver with each coded packet with its<a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-6.1">d: degree<a href="#section-2.2.2-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-6.2">BID: batch ID<a href="#section-2.2.2-6.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.2-7">
          The DDP MUST deliver the following information to each recoder:<a href="#section-2.2.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-8.1">M: batch size M<a href="#section-2.2.2-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-8.2">q: recoding field size<a href="#section-2.2.2-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.2-9">
          The DDP MUST deliver the following information to each decoder:<a href="#section-2.2.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-10.1">M: batch size<a href="#section-2.2.2-10.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-10.2">q: recoding field size<a href="#section-2.2.2-10.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-10.3">K: the number of source packets<a href="#section-2.2.2-10.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-10.4">T: the number of octets in a source packet<a href="#section-2.2.2-10.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.2-11">
          The BID is used by both recoders and decoders. The BATS payload size TO MUST be known by all the nodes.<a href="#section-2.2.2-11" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2.3">
          <h4 id="name-recoding-procedures">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-recoding-procedures" class="section-name selfRef">Recoding Procedures</a>
          </h4>
<p id="section-2.2.3-1">
       Both the source node and the intermediate nodes perform recoding on the batches before transmission. At the source node, the recoder receives the batches from the outer code encoding procedure. At an intermediate node, the DDP receives the DDP packets from the other network nodes, and should be able to extract coded packets and the corresponding batch information from these packets.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.2.3-2">
           If the DDP choose not to recode, it just forwards the packets it received. Otherwise, the DDP can choose a recoder to be described in <a href="#recoder" class="xref">Section 3.3</a> and provides the recoder with the following information:<a href="#section-2.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3-3.1">the batch size M,<a href="#section-2.2.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.3-3.2">the recoding field size q,<a href="#section-2.2.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.3-3.3">a number of received coded packets of the same batch, each containing TO octets, and<a href="#section-2.2.3-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.3-3.4">link statistics, e.g., packet loss rates.<a href="#section-2.2.3-3.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.3-4">
       For a received batch, the recoder determines a positive integer Mr, the number of recoded packets to be transmitted for the batch. The recoder uses the information provided by the DDP to generate Mr recoded packets, each containing TO octets. The DDP uses the Mr recoded packets to form the DDP packets for transmitting.<a href="#section-2.2.3-4" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2.4">
          <h4 id="name-destination-node-procedures">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-destination-node-procedures" class="section-name selfRef">Destination Node Procedures</a>
          </h4>
<p id="section-2.2.4-1">
          A destination node needs the data transmitted by the source node. At the destination node, the DDP receives DDP packets from an intermediate network node, and should be able to extract coded packets and the corresponding batch information from these packets.<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.2.4-2">
          The DDP use a decoder described in <a href="#bp_decoder" class="xref">Section 3.4</a> and provides the decoder with the following information:<a href="#section-2.2.4-2" class="pilcrow">¶</a></p>
<ul class="normal"><li class="normal" id="section-2.2.4-3.1">M: batch size,<a href="#section-2.2.4-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.4-3.2">q: recoding field size,<a href="#section-2.2.4-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.4-3.3">K: the number of source packets<a href="#section-2.2.4-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.4-3.4">T: the number of octets of a source packet<a href="#section-2.2.4-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.4-3.5">A sequence of batches, each of which is formed by a number of coded packets belonging to the same batch, with their corresponding BIDs and degrees.<a href="#section-2.2.4-3.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.4-4"> The decoder uses this information to decode the outer code and the inner code jointly and recover the K source packets. If successful, the decoder returns the recovered K source packets to the DDP, which will use the K source packets to form the F octets data. The recommended padding deletion process is shown as follows:<a href="#section-2.2.4-4" class="pilcrow">¶</a></p>
<span id="name-data-padding-deletion-proce"></span><div id="data_depadding">
<figure id="figure-3">
            <div class="artwork art-text alignLeft" id="section-2.2.4-5.1">
<pre>
    // this procedure returns the number P of padding octets
    // at the end of b[K-1]
    Let bl be the last decoded source packet b[K-1]
    PL = bl[T-1]
    if PL == 1 do
        return P = 1
    WI = T - 1
    while bl[WI] == PL do
        WI = WI - 1
    return P = (1 + bl[WI]) * bl[WI] + T - WI - 1
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-data-padding-deletion-proce" class="selfRef">Data Padding Deletion Process</a>
            </figcaption></figure>
</div>
</section>
</section>
<section id="section-2.3">
        <h3 id="name-recommendation-for-the-para">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-recommendation-for-the-para" class="section-name selfRef">Recommendation for the Parameters</a>
        </h3>
<p id="section-2.3-1">
        The recommendation for the parameters M and q is shown as follows:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">When q=2, M=16,32,64<a href="#section-2.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.2">When q=256, M=8,16,32,64<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-3">
        It is RECOMMENDED that K is at least 128. The encoder/decoder SHALL support an arbitrary positive integer value less than 2^16. However, the BATS coding scheme to be described is not optimized for small K.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
<section id="section-2.4">
        <h3 id="name-example-ddp-packet-format">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-example-ddp-packet-format" class="section-name selfRef">Example DDP Packet Format</a>
        </h3>
<p id="section-2.4-1">A DDP can form a DDP packet with a header (5 octets) and a payload (TO octets). A DDP packet has totally 5+TO octets.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<section id="section-2.4.1">
          <h4 id="name-packet-header">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-packet-header" class="section-name selfRef">Packet Header</a>
          </h4>
<p id="section-2.4.1-1"> The BATS packet header has 40 bits (5 octets) and includes fields K, Mq, BID, and d.<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<span id="name-bats-packet-header-format"></span><div id="packet_header">
<figure id="figure-4">
            <div class="artwork art-text alignLeft" id="section-2.4.1-2.1">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                K              |  Mq   |         BID           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       d       |
    +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-bats-packet-header-format" class="selfRef">BATS packet header format.</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-2.4.1-3.1">K: 16-bit unsigned integer, specifying the number of source packets of the BATS session.<a href="#section-2.4.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.4.1-3.2">Mq: 4-bit unsigned integer to specify the value of M and q as <a href="#Mq_value" class="xref">Table 1</a>.<a href="#section-2.4.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.4.1-3.3">BID: 12-bit unsigned integer, specifying the batch ID of the batch the packet belongs to.<a href="#section-2.4.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.4.1-3.4">d: 8-bit unsigned integer, specifying the batch degree of the batch the packet belongs to.<a href="#section-2.4.1-3.4" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-values-of-mq-field"></span><div id="Mq_value">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-values-of-mq-field" class="selfRef">Values of Mq field</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Mq</th>
                <th class="text-left" rowspan="1" colspan="1">M</th>
                <th class="text-left" rowspan="1" colspan="1">q</th>
                <th class="text-left" rowspan="1" colspan="1">O</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0010</td>
                <td class="text-left" rowspan="1" colspan="1">16</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0100</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0110</td>
                <td class="text-left" rowspan="1" colspan="1">64</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0001</td>
                <td class="text-left" rowspan="1" colspan="1">8</td>
                <td class="text-left" rowspan="1" colspan="1">256</td>
                <td class="text-left" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0011</td>
                <td class="text-left" rowspan="1" colspan="1">16</td>
                <td class="text-left" rowspan="1" colspan="1">256</td>
                <td class="text-left" rowspan="1" colspan="1">16</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0101</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">256</td>
                <td class="text-left" rowspan="1" colspan="1">32</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0111</td>
                <td class="text-left" rowspan="1" colspan="1">64</td>
                <td class="text-left" rowspan="1" colspan="1">256</td>
                <td class="text-left" rowspan="1" colspan="1">64</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-2.4.2">
          <h4 id="name-packet-payload">
<a href="#section-2.4.2" class="section-number selfRef">2.4.2. </a><a href="#name-packet-payload" class="section-name selfRef">Packet Payload</a>
          </h4>
<span id="name-bats-packet-payload-format"></span><div id="packet_payload">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-2.4.2-1.1">
<pre>
                  O                         T
      +-----------------------+-------------------------------+
      |   coefficient vector  |          coded data           |
      +-----------------------+-------------------------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-bats-packet-payload-format" class="selfRef">BATS packet payload format.</a>
            </figcaption></figure>
</div>
<p id="section-2.4.2-2">
          The payload has TO octets, where the first O octets contain the coefficient vector and the remaining T octets contain the coded data.
          .<a href="#section-2.4.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4.2-3.1">coefficient vector: O octets. The range of the value of O is in <a href="#Mq_value" class="xref">Table 1</a>.<a href="#section-2.4.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.4.2-3.2">coded data: T octets. T is at most PMTU - 7, where 7 is the total length of the header plus 2, the minimum value of O.<a href="#section-2.4.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</section>
</section>
</div>
<div id="specification">
<section id="section-3">
      <h2 id="name-bats-code-specification">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-bats-code-specification" class="section-name selfRef">BATS Code Specification</a>
      </h2>
<div id="common">
<section id="section-3.1">
        <h3 id="name-common-parts">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-common-parts" class="section-name selfRef">Common Parts</a>
        </h3>
<p id="section-3.1-1">
          The T octets of a source packets are treated as a column vector of T elements in GF(256). Linear algebra and matrix operations over finite fields are assumed in this section.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2"> Suppose that a pseudorandom number generator Rand() which generates an unsigned integer of 32 bits is shared by both encoding and decoding. The pseudorandom generator can be initialized by Rand_Init(S) with seed S. When S is not provided, the pseudorandom generator is initialized arbitrarily. One example of such a pseudorandom generator is defined in <span><a href="#RFC8682" class="xref">RFC 8682</a> [<a href="#RFC8682" class="xref">RFC8682</a>]</span>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">A function called BatchSampler is used in both encoding and decoding. The function takes two integers j and d as input, and generates an array idx of d integers and a d x M matrix G.  The function first initializes the pseudorandom generator with j, sample d distinct integers from 0 to K-1 as idx, and sample d*M integers from 0 to 255 as G. See the pseudocode in <a href="#batch_sampler" class="xref">Figure 6</a>.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-batch-sampler-function"></span><div id="batch_sampler">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-3.1-4.1">
<pre>
function BatchSampler(j,d)
    // initialize the pseudorandom generator by seed j.
    Rand_Init(j)
    // sample d distinct integers between 0 and K-1.
    for k = 0, ..., d-1 do
        r = Rand() % K
        while r already exists in idx do
            r = Rand() % K
        idx[k] = r

    // sample d x M matrix
    for r = 0, ..., d-1 do
        for c = 0,...,M-1 do
            G[r,c] = Rand() % 256

    return idx, G
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-batch-sampler-function" class="selfRef">Batch Sampler Function</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="encoder">
<section id="section-3.2">
        <h3 id="name-outer-code-encoder">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-outer-code-encoder" class="section-name selfRef">Outer Code Encoder</a>
        </h3>
<p id="section-3.2-1">Define a function called DegreeSampler that return an integer d using the degree distribution DD. We expect that the empirical distribution of the returning d converges to DD(d) when d &lt; K. One design of DegreeSampler is illustrated in <a href="#degree_sampler" class="xref">Figure 7</a>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-degree-sampler-function"></span><div id="degree_sampler">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-3.2-2.1">
<pre>
function DegreeSampler(j, DD)
    Let CDF be an array
    CDF[0] = 0
    for i = 1, ..., MAX_DEG do
        CDF[i] = CDF[i-1] + DD[i]
    Rand_Init()
    r = Rand() % CDF[MAX_DEG]
    for d = 1, ..., MAX_DEG do
        if r &gt;= CDF[d] do
            return min(d,K)
    return min(MAX_DEG,K)
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-degree-sampler-function" class="selfRef">Degree Sampler Function</a>
          </figcaption></figure>
</div>
<p id="section-3.2-3">
          Let b[0], b[1], ..., b[K-1] be the K source packets. A batch with BID j is generated using the following steps.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">Obtain a degree d by calling DegreeSampler with input j.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-4.2">Obtain idx and G[j] by calling BatchSampler with input j and d.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-4.3">Let B[j] = (b[idx[0]], b[idx[1]], ..., b[idx[d-1]]). Form the batch X[j] = B[j]*G[j], whose dimension is T x M.<a href="#section-3.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-4.4">Form the TO x M matrix Xr[j], where the first O rows of Xr[j] form the M x M identity matrix I with entries in GF(q), and the last T rows of Xr[j] is X[j].<a href="#section-3.2-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-5">See the pseudocode of the batch generating process in <a href="#gen_batch" class="xref">Figure 8</a>.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<span id="name-batch-generation-function"></span><div id="gen_batch">
<figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-3.2-6.1">
<pre>
function GenBatch(j)
    d = DegreeSampler(j)
    (idx, G) = BatchSampler(j,d)
    B = (b[idx[0]], b[idx[i]], ..., b[idx[d-1]])
    X = B * G
    Xr = [I_M; X]
    return Xr
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-batch-generation-function" class="selfRef">Batch Generation Function</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="recoder">
<section id="section-3.3">
        <h3 id="name-inner-code-encoder-recoder">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-inner-code-encoder-recoder" class="section-name selfRef">Inner Code Encoder (Recoder)</a>
        </h3>
<p id="section-3.3-1">
          The inner code comprises (random) linear network coding applied on the coded packets belonging to the same batch.
          At a particular network node, recoded packets are generated by (random) linear combinations of the received coded packets of a batch.
          The recoded packets have the same BID, degree and coded packet length.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
       The number Mr of recoded packets for a batch is decided first by the recoder. Mr can be set as M.
       When the link statistics is known, the recoder can try to obtain the link packet loss rate e for the link to transmit the recoded batch, and set Mr to be (1+e)M.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">
          Suppose that coded packets xr[i], i = 0, 1, ..., r-1, which have the same BID j, have been received at an intermediate node. Using the recommended packet format, it can be verified whether the corresponding packet headers of these coded packets are the same. Then a recoded packet can be generated by one of the following two approaches:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">forwarding: when receiving xr[i], directly use xr[i] as a recoded packet.<a href="#section-3.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-4.2">linear combination recoding: (randomly) choose a sequence of coefficients c[i], i = 0, 1, ..., r-1 from GF(q). Generate c[0]xr[0]+c[1]xr[1]+...+c[r-1]xr[r-1] as a recoded packet.<a href="#section-3.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-5">
          A recoder can combine these two approaches to generate recoded packets. For example, the recoder will output xr[i], i = 0, 1, ..., r-1 as r systematic recoded packets and generate Mr-r recoded packets using linear combinations of randomly chosen coefficients.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bp_decoder">
<section id="section-3.4">
        <h3 id="name-belief-propagation-decoder">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-belief-propagation-decoder" class="section-name selfRef">Belief Propagation Decoder</a>
        </h3>
<p id="section-3.4-1"> The decoder receives a sequence of batches Yr[j], j = 0, 1, ..., n-1, each of which is a TO-row matrix over GF(256). The degree d[j] of batch j is also known. Let Y[j] be the submatrix of the last T rows of Yr[j]. When q = 256, let H[j] be the first M rows of Yr[j]; when q = 2, let H[j] be the matrix over GF(256) formed by embedding each bit in the first M/8 rows of Yr[j] into GF(256).<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2"> By calling BatchSampler with input j and d[j], we obtain idx[j] and G[j]. According to the encoding and recoding processes described in <a href="#encoder" class="xref">Section 3.2</a> and <a href="#recoder" class="xref">Section 3.3</a>, we have the system of linear equations Y[j] = B[j]G[j]H[j] for each received batch with ID j, where B[j] = (b[idx[j,0]], b[idx[j,1]], ..., b[idx[j,d-1]]) is unknown.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3"> We describe a belief propagation (BP) decoder that can efficiently solve the source packets when a sufficient number of batches have been received. A batch j is said to be decodable if rank(G[j]H[j]) = d[j] (i.e., the system of linear equations Y[j] = B[j]G[j]H[j] with B[j] as the variable matrix has a unique solution). The BP decoding algorithm has multiple iterations. Each iteration is formed by the following steps:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-4.1"> Decoding step: Find a batches j that is decodable. Solve the corresponding system of linear equations Y[j] = B[j]G[j]H[j] and decode B[j].<a href="#section-3.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-4.2"> Substitution step: Substitute the decoded source packets into undecodable batches. Suppose that a decoded source packet b[k] is used in generating a undecodable Y[j]. The substitution involves 1) removing the entry in idx[j] corresponding to k, 2) removing the row in G[j] corresponding to b[k], and 3) reducing d[j] by 1.<a href="#section-3.4-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-5">
        The BP decoder repeats the above steps until no batches are decodable during the decoding step.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="research">
<section id="section-4">
      <h2 id="name-research-issues">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-research-issues" class="section-name selfRef">Research Issues</a>
      </h2>
<p id="section-4-1">The baseline BATS coding scheme described in <a href="#procedures" class="xref">Section 2</a> and <a href="#specification" class="xref">Section 3</a> needs various refinement and complement towards becoming a more sophisticated network communication application. Various related research issues are discussed in this section, but the security related issues are left to <a href="#Security" class="xref">Section 6</a>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="coding">
<section id="section-4.1">
        <h3 id="name-coding-design-issues">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-coding-design-issues" class="section-name selfRef">Coding Design Issues</a>
        </h3>
<p id="section-4.1-1">The BATS code specification in <a href="#specification" class="xref">Section 3</a> has nearly optimal throughput when the number of source packets K is sufficiently large. But when K is small, the degree sampler function in <a href="#degree_sampler" class="xref">Figure 7</a> and the BatchSampler function in <a href="#batch_sampler" class="xref">Figure 6</a> based on a pseudorandom generator may not sample all the source packets evenly, so that some of the source packets are not well protected. One approach to solve this issue is to generate a deterministic degree sequence when the number of batches is relatively small, and design a special pseudorandom generator that has a good sampling performance when K is small.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The belief propagation decoder in <a href="#bp_decoder" class="xref">Section 3.4</a> guarantees the recovery of a given fraction of the source packets. To recover all the source packets, a precode can be applied to the source packets to generate a fraction of redundant packets before applying the outer code encoding. Moreover, when the belief propagation decoder stops, it is possible to continue with inactivation decoding, where certain source packets are treated inactive so that a similar belief propagation process can be resumed. The reader is referred to <span><a href="#RFC6330" class="xref">RFC 6330</a> [<a href="#RFC6330" class="xref">RFC6330</a>]</span> for the design of a precode with a good inactivation decoding performance.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">There are research issues related to recoding discussed in <a href="#recoder" class="xref">Section 3.3</a>. One question is how many recoded packets to generate for each batch. Though it is asymptotically optimal when using the same number of recoded packets for all batches, it has been shown that transmitting a different number of recoded packets for different batches can improve the recoding efficiency. The intuition is that for a batch with a lower rank, a smaller number of recoded packets need to be transmitted. This kind of recoding scheme is called <span><a href="#Yin19" class="xref">adaptive recoding</a> [<a href="#Yin19" class="xref">Yin19</a>]</span>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Packet loss in network communication is usually bursty, which may harm the recoding performance. One way to resolve this issue is to transmit the packets of different batches in a mixed order, which is also called <span><a href="#Yin20" class="xref">batch interleaving</a> [<a href="#Yin20" class="xref">Yin20</a>]</span>. How to efficiently interleave batches without increasing too much end-to-end latency is a research issue.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5"> Though we only focus on the BATS coding scheme with one source node and one destination node, a BATS coding scheme can be used for multiple source and destination nodes. To benefit from multiple source nodes, we would need different source nodes to generate statistically independent batches. For communicating the same data to multiple destination nodes, which is also call multicast, it is well-known that <span><a href="#Li03" class="xref">linear network coding</a> [<a href="#Li03" class="xref">Li03</a>]</span> achieves the mulicast capacity. BATS codes can benefit from network coding due to its inner code, but how to efficiently implement multicast needs further research.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-4.2">
        <h3 id="name-protocol-design-issues">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-protocol-design-issues" class="section-name selfRef">Protocol Design Issues</a>
        </h3>
<p id="section-4.2-1">The baseline scheme in this document focuses on reliable communication. There are other issues to be considered towards designing a fully functionally DDP based on a BATS coding scheme. Here we discuss some network management issues that are closely related to a BATS coding scheme: routing, congestion control and media access control.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The outer code of a BATS code can be regarded as a channel code for the channel induced by the inner code, and hence the network management algorithms should try to maximize the capacity of the channel induced by the inner code. A <span><a href="#Dong20" class="xref">network utility maximization problem</a> [<a href="#Dong20" class="xref">Dong20</a>]</span> for BATS coding can be applied to study routing, congestion control and media access control jointly. Compared with the network utility maximization for Internet, there are two major differences. First, the network flow rate is not measured by the rate of the raw packets. Instead, a rank based measurement induced by the inner code is applied for BATS coding schemes. Second, due to recoding, the raw packet rate of a flow may not be the same for different links, i.e., no flow conservation for BATS coding schemes. These differences affect both the objective and the constraints of the utility maximization problem.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Practical congestion control, routing and media access control algorithms for BATS coding schemes deserve more research efforts. Due to the recoding operation, congestion control cannot be only performed end-to-end. The rate of transmitting batches can be controlled end-to-end, but the number of recoded packets generated for a batch must be controlled at the intermediate nodes, which introduces new research issues for congestion control. For routing, the BATS coding scheme is flexible for implementing multi-path data transmission, and different batches can be transmitted on a different path between a source node and a destination node. Under the scenario of BATS coding schemes, media access control can have some different considerations: Retransmission is not necessary, and a reasonably high packet loss rate can be tolerated.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application">
<section id="section-4.3">
        <h3 id="name-application-related-issues">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-application-related-issues" class="section-name selfRef">Application Related Issues</a>
        </h3>
<p id="section-4.3-1">There are more research issues pertaining to different applications. The reliable communication technique provided by BATS codes can be used for a broad range of network communication scenarios. In general, a BATS coding scheme is suitable for data delivery in networks with multiple hops and unreliable links.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">One class of typical application scenario is <span><a href="#Toh02" class="xref">wireless mesh and ad hoc networks</a> [<a href="#Toh02" class="xref">Toh02</a>]</span>, including vehicular networks, wireless sensor networks, smart-lamppost networks, etc. These networks are characterized by a large number of network devices connected wirelessly with each other without a centralized network infrastructure. A BATS coding scheme is suitable for high data load delivery in such networks without the requirement that the point-to-point/one-hop communication is highly reliable. Therefore, employing a BATS coding scheme can provide more freedom for media access control, including power control so that the overall network throughput can be improved.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Another typical application scenario of BATS coding schemes is <span><a href="#Sprea19" class="xref">underwater acoustic networks</a> [<a href="#Sprea19" class="xref">Sprea19</a>]</span>, where the propagation delay of acoustic waves in underwater can be as long as several seconds. Due to the long delay, feedback based mechanisms become inefficient. Moreover, point-to-point/one-hop underwater acoustic communication (for both the forward and reverse directions) is highly unreliable. Due to these reasons, traditional networking techinques developed for radio and wireline networks cannot be directly applied to underwater networks. As a BATS coding scheme does not rely on the feedback for reliability communication and can tolerate highly unreliable links, it makes a good candidate for developing data delivery protocols for underwater acoustic networks.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">Last but not least, due to its capability of performing multi-source multi-destination communications, a BATS coding scheme can be applied in various content distribution scenarios. For example, a BATS coding scheme can be a candidate for the erasure code used in the <span><a href="#Byers20" class="xref">liquid data networking framework</a> [<a href="#Byers20" class="xref">Byers20</a>]</span> of CCN (content centric networking), and provides the extra <span><a href="#Zhang16" class="xref">benefit of network coding</a> [<a href="#Zhang16" class="xref">Zhang16</a>]</span>.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This memo includes no request to IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">
        Subsuming both Random Linear Network Codes (RLNC) and fountain codes, BATS codes naturally inherit both their desirable capability of offering confidentiality protection as well as their vulnerability towards pollution attacks.<a href="#section-6-1" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-provision-of-confidentialit">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-provision-of-confidentialit" class="section-name selfRef">Provision of Confidentiality Protection</a>
        </h3>
<p id="section-6.1-1">
          Since the transported messages are linearly combined with random coefficients at each recoding node, it is statistically impossible to recover the individual messages by capturing the coded messages at any one or small number of nodes. As long as the coding matrices of the transported messages cannot be fully recovered, any attempt of decoding any particular symbol of the transported messages is equivalent to random guessing <span>[<a href="#Bhattad05" class="xref">Bhattad05</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
          The threat towards confidentiality, however, also exists in the form of eavesdropping on the initial encoding process, which takes place at the encoding nodes. In these nodes, the transported data are presented in plain text and can be read along their transfer paths. Hence, information isolation between the encoding process and all other user processes running on the node must be assured.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
          In addition, the authenticity and trustworthiness of the encoding, recoding and decoding program running on all the nodes must be attested by a trusted authority. Such a measure is also necessary in countering pollution attacks.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2">
        <h3 id="name-countermeasures-against-pol">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-countermeasures-against-pol" class="section-name selfRef">Countermeasures against Pollution Attacks</a>
        </h3>
<p id="section-6.2-1">Like all network codes, BATS codes are vulnerable under pollution attacks. In these attacks, one or more compromised coding node(s) can pollute the coded messages by injecting forged messages into the coding network and thus prevent the receivers from
   recovering the transported data correctly.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The research community has long been investigating the use of various signature schemes (including homomorphic signatures) to identify the forged messages and stall the attacks (see <span>[<a href="#Zhao07" class="xref">Zhao07</a>]</span>, <span>[<a href="#Yu08" class="xref">Yu08</a>]</span>, <span>[<a href="#Agrawal09" class="xref">Agrawal09</a>]</span>). However, these countermeasures are regarded as being too computationally expensive to be employed in broadband communications. Hence, a system-level approach based on <span><a href="#TC-Wikipedia" class="xref">Trusted Computing</a> [<a href="#TC-Wikipedia" class="xref">TC-Wikipedia</a>]</span> is proposed as a practical alternative to protect BATS codes against pollution attacks. This Trusted Computing based protection consists of the following countermeasures:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3">
<li id="section-6.2-3.1"> Attestation and Validation of all BATS encoding, recoding and decoding
       nodes in the network.  Remote attestation and repetitive validation of
       the identity and capability of these node based on valid public key certificates with proper authorization MUST be a pre-requisite for admitting these nodes to a network and permitting them to remain on that network.<a href="#section-6.2-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-3.2"> Attestation of all encoding, recoding and decoding programs used in the coding nodes. All programs used to perform the BATS encoding, recoding and decoding processes MUST be remotely attested before they are permitted to run on any of the coding nodes. Reloading or alteration of programs MUST NOT be permitted during an encoding session. Programs MUST be attested or validated again when they are executed in new execution environments instantiated even in the same node.<a href="#section-6.2-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-3.3"> Original Authentication of all coded messages using network level security protocols such as IPsec or Peer Authentication over session-based communication using transport level security protocols such as TLS/DTLS MUST be employed in order to provide Message Origin or Communication Peer Authentication to every coded message sent through the coding network.<a href="#section-6.2-3.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8682">[RFC8682]</dt>
      <dd>
<span class="refAuthor">Saito, M.</span>, <span class="refAuthor">Matsumoto, M.</span>, <span class="refAuthor">Roca, V., Ed.</span>, and <span class="refAuthor">E. Baccelli</span>, <span class="refTitle">"TinyMT32 Pseudorandom Number Generator (PRNG)"</span>, <span class="seriesInfo">RFC 8682</span>, <span class="seriesInfo">DOI 10.17487/RFC8682</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8682">https://www.rfc-editor.org/info/rfc8682</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Agrawal09">[Agrawal09]</dt>
        <dd>
<span class="refAuthor">Agrawal, S.</span> and <span class="refAuthor">D. Boneh</span>, <span class="refTitle">"Homomorphic MACs: MAC-based integrity for network coding"</span>, <span class="seriesInfo">International Conference on Applied Cryptography and Network Security </span>, <time datetime="2009" class="refDate">2009</time>. </dd>
<dd class="break"></dd>
<dt id="Bhattad05">[Bhattad05]</dt>
        <dd>
<span class="refAuthor">Bhattad, K.</span> and <span class="refAuthor">K.R. Narayanan</span>, <span class="refTitle">"Weakly Secure Network Coding"</span>, <span class="seriesInfo">ISIT </span>, <time datetime="2007" class="refDate">2007</time>. </dd>
<dd class="break"></dd>
<dt id="Byers20">[Byers20]</dt>
        <dd>
<span class="refAuthor">Byers, J.W.</span> and <span class="refAuthor">M. Luby</span>, <span class="refTitle">"Liquid Data Networking"</span>, <span class="seriesInfo">ICN </span>, <time datetime="2020" class="refDate">2020</time>. </dd>
<dd class="break"></dd>
<dt id="Dong20">[Dong20]</dt>
        <dd>
<span class="refAuthor">Dong, Y.</span>, <span class="refAuthor">Jin, S.</span>, <span class="refAuthor">Yang, S.</span>, and <span class="refAuthor">H.H.F. Yin</span>, <span class="refTitle">"Network Utility Maximization for BATS Code enabled Multihop Wireless Networks"</span>, <span class="seriesInfo">ICC </span>, <time datetime="2020" class="refDate">2020</time>. </dd>
<dd class="break"></dd>
<dt id="Li03">[Li03]</dt>
        <dd>
<span class="refAuthor">Li, S.-Y.R..</span>, <span class="refAuthor">Yeung, R.W.</span>, and <span class="refAuthor">N. Cai</span>, <span class="refTitle">"Linear Network Coding"</span>, <span class="seriesInfo">IEEE Transactions on Information Theory </span>, <time datetime="2003" class="refDate">2003</time>. </dd>
<dd class="break"></dd>
<dt id="RFC6330">[RFC6330]</dt>
        <dd>
<span class="refAuthor">Luby, M.</span>, <span class="refAuthor">Shokrollahi, A.</span>, <span class="refAuthor">Watson, M.</span>, <span class="refAuthor">Stockhammer, T.</span>, and <span class="refAuthor">L. Minder</span>, <span class="refTitle">"RaptorQ Forward Error Correction Scheme for Object Delivery"</span>, <span class="seriesInfo">RFC 6330</span>, <span class="seriesInfo">DOI 10.17487/RFC6330</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6330">https://www.rfc-editor.org/info/rfc6330</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Sprea19">[Sprea19]</dt>
        <dd>
<span class="refAuthor">Sprea, N.</span>, <span class="refAuthor">Bashir, M.</span>, <span class="refAuthor">Truhachev, D.</span>, <span class="refAuthor">Srinivas, K.V.</span>, <span class="refAuthor">Schlegel, C.</span>, and <span class="refAuthor">C. Claudio Sacchi</span>, <span class="refTitle">"BATS Coding for Underwater Acoustic Communication Networks"</span>, <span class="seriesInfo">OCEANS </span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="TC-Wikipedia">[TC-Wikipedia]</dt>
        <dd>
<span class="refTitle">"Trusted Computing"</span>, <span class="seriesInfo">Wikipedia https://en.wikipedia.org/wiki/Trusted_Computing</span>. </dd>
<dd class="break"></dd>
<dt id="Toh02">[Toh02]</dt>
        <dd>
<span class="refAuthor">Toh, C.K.</span>, <span class="refTitle">"Ad Hoc Mobile Wireless Networks"</span>, <span class="seriesInfo">Prentice Hall Publishers </span>, <time datetime="2002" class="refDate">2002</time>. </dd>
<dd class="break"></dd>
<dt id="Yang14">[Yang14]</dt>
        <dd>
<span class="refAuthor">Yang, S.</span> and <span class="refAuthor">R.W. Yeung</span>, <span class="refTitle">"Batched Sparse Codes"</span>, <span class="seriesInfo">IEEE Transactions on Information Theory 60(9), 5322-5346</span>, <time datetime="2014" class="refDate">2014</time>. </dd>
<dd class="break"></dd>
<dt id="Yang17">[Yang17]</dt>
        <dd>
<span class="refAuthor">Yang, S.</span> and <span class="refAuthor">R.W. Yeung</span>, <span class="refTitle">"BATS Codes: Theory and Practice"</span>, <span class="seriesInfo">Morgan &amp; Claypool Publishers </span>, <time datetime="2017" class="refDate">2017</time>. </dd>
<dd class="break"></dd>
<dt id="Yin19">[Yin19]</dt>
        <dd>
<span class="refAuthor">Yin, H.H.F.</span>, <span class="refAuthor">Tang, B.</span>, <span class="refAuthor">Ng, K.H.</span>, <span class="refAuthor">Yang, S.</span>, <span class="refAuthor">Wang, X.</span>, and <span class="refAuthor">Q. Zhou</span>, <span class="refTitle">"A Unified Adaptive Recoding Framework for Batched Network Coding"</span>, <span class="seriesInfo">ISIT </span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="Yin20">[Yin20]</dt>
        <dd>
<span class="refAuthor">Yin, H.H.F.</span>, <span class="refAuthor">Yeung, R.W.</span>, and <span class="refAuthor">S. Yang</span>, <span class="refTitle">"A Protocol Design Paradigm for Batched Sparse Codes"</span>, <span class="seriesInfo">Entroy </span>, <time datetime="2020" class="refDate">2020</time>. </dd>
<dd class="break"></dd>
<dt id="Yu08">[Yu08]</dt>
        <dd>
<span class="refAuthor">Yu, Z.</span>, <span class="refAuthor">Wei, Y.</span>, <span class="refAuthor">Ramkumar, B.</span>, and <span class="refAuthor">Y. Guan</span>, <span class="refTitle">"An Efficient Signature-Based Scheme for Securing Network Coding Against Pollution Attacks"</span>, <span class="seriesInfo">INFOCOM </span>, <time datetime="2008" class="refDate">2008</time>. </dd>
<dd class="break"></dd>
<dt id="Zhang16">[Zhang16]</dt>
        <dd>
<span class="refAuthor">Zhang, G.</span> and <span class="refAuthor">Z. Xu</span>, <span class="refTitle">"Combing CCN with network coding: An architectural perspective"</span>, <span class="seriesInfo">Computer Networks </span>, <time datetime="2016" class="refDate">2016</time>. </dd>
<dd class="break"></dd>
<dt id="Zhao07">[Zhao07]</dt>
      <dd>
<span class="refAuthor">Zhao, F.</span>, <span class="refAuthor">Kalker, T.</span>, <span class="refAuthor">Medard, M.</span>, and <span class="refAuthor">K.J. Han</span>, <span class="refTitle">"Signatures for content distribution with network coding"</span>, <span class="seriesInfo">ISIT </span>, <time datetime="2007" class="refDate">2007</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="app-additional">
<section id="appendix-A">
      <h2 id="name-additional-stuff">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-additional-stuff" class="section-name selfRef">Additional Stuff</a>
      </h2>
<p id="appendix-A-1"></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shenghao Yang</span></div>
<div dir="auto" class="left"><span class="org">CUHK(SZ)</span></div>
<div dir="auto" class="left"><span class="locality">Shenzhen</span></div>
<div dir="auto" class="left">
<span class="region">Guangdong</span>, </div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+86%20755%208427%203827" class="tel">+86 755 8427 3827</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:shyang@cuhk.edu.cn" class="email">shyang@cuhk.edu.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Xuan Huang</span></div>
<div dir="auto" class="left"><span class="org">CUHK</span></div>
<div dir="auto" class="left"><span class="locality">Hong Kong</span></div>
<div dir="auto" class="left">
<span class="region">Hong Kong SAR</span>, </div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+852%203943%208375" class="tel">+852 3943 8375</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:1155136647@link.cuhk.edu.hk" class="email">1155136647@link.cuhk.edu.hk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Raymond W. Yeung</span></div>
<div dir="auto" class="left"><span class="org">CUHK</span></div>
<div dir="auto" class="left"><span class="locality">Hong Kong</span></div>
<div dir="auto" class="left">
<span class="region">Hong Kong SAR</span>, </div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+852%203943%208375" class="tel">+852 3943 8375</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:whyeung@ie.cuhk.edu.hk" class="email">whyeung@ie.cuhk.edu.hk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John K. Zao</span></div>
<div dir="auto" class="left"><span class="org">NCTU</span></div>
<div dir="auto" class="left"><span class="locality">Hsinchu</span></div>
<div dir="auto" class="left">
<span class="region">Taiwan</span>, </div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jkzao@ieee.org" class="email">jkzao@ieee.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
