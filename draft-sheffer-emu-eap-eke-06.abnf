y_s = g ^ x_s (mod p),

DHComponent_S = Encr(prf+(password, "EAP-EKE Password"), y_s),

y_p = g ^ x_p (mod p)

DHComponent_P = Encr(prf+(password, "EAP-EKE Password"), y_p)

SharedSecret = prf(0+, g ^ (x_s * x_p) (mod p))

Commit_P = Prot(Ke, Ki, Nonce_P),

Confirm_S = Prot(Ke, Ki, Nonce_P | Nonce_S),

Ka = prf+(SharedSecret, "EAP-EKE Ka" | ID_S | ID_P | Nonce_P |
Auth_S = prf(Ka, "EAP-EKE server" | EAP-EKE-ID/Request | EAP-EKE-
Confirm_P = Prot(Ke, Ki, Nonce_S)

Auth_P = prf(Ka, "EAP-EKE peer" | EAP-EKE-ID/Request | EAP-EKE-ID/
MSK = prf+(SharedSecret, "EAP-EKE MSK" | ID_S | ID_P | Nonce_P |
EMSK = prf+(SharedSecret, "EAP-EKE EMSK" | ID_S | ID_P | Nonce_P |
T1 = prf(K, S | 0x01)
T2 = prf(K, T1 | S | 0x02)
T3 = prf(K, T2 | S | 0x03)
T4 = prf(K, T3 | S | 0x04)

