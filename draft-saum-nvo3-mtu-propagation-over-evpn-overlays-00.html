<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>MTU propagation over EVPN Overlays</title>
<meta content="Saumya Dikshit" name="author">
<meta content="Vinayak Joshi" name="author">
<meta content="A. Sujeet Nayak" name="author">
<meta content='
       Path MTU Discovery between end-host-devices/Virtual-Machines/servers/workloads connected over an EVPN-Overlay Network in an Datacenter/Campus/enterprise deployment, is a problem, yet to be resolved in the standards forums. It needs a converged solution to ensure optimal usage of network and computational resources of the underlay routers/switches forming the basis of the overlay network. This documents takes leads from the guidelines presented in  . 
       The overlay connectivity can pan across various sites (geographically seperated or collocated) for realizing a Datacenter Interconnect or intersite VPNs between campus sites (buildings, branch offices etc). 
       This literature intends to solve problem of icmp error propagation from an underlay routing/switching device to an end-host (hooked to EVPN overlay), thus facilitating "accurate MTU"  learnings. 
       This document also leverages the icmp multipart message extension, mentioned in   to carry the original packet in the icmp PDU. 
    ' name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="RFC" name="keyword">
<meta content="Request for Comments" name="keyword">
<meta content="I-D" name="keyword">
<meta content="Internet-Draft" name="keyword">
<meta content="XML" name="keyword">
<meta content="Extensible Markup Language" name="keyword">
<meta content="draft-saum-nvo3-mtu-propagation-over-evpn-overlays-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-mtu-propagation-over-vxlan-0i3dc85n.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">MTU propagation over EVPN Overlays</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Dikshit, et al.</td>
<td class="center">Expires 5 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">NVO3</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-saum-nvo3-mtu-propagation-over-evpn-overlays-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-04" class="published">4 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-05">5 February 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Dikshit</div>
<div class="org">Aruba, HPE</div>
</div>
<div class="author">
      <div class="author-name">V. Joshi</div>
<div class="org">Aruba, HPE</div>
</div>
<div class="author">
      <div class="author-name">A. Sujeet Nayak</div>
<div class="org">Cisco</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">MTU propagation over EVPN Overlays</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Path MTU Discovery between end-host-devices/Virtual-Machines/servers/workloads connected over an EVPN-Overlay Network in an Datacenter/Campus/enterprise deployment, is a problem, yet to be resolved in the standards forums. It needs a converged solution to ensure optimal usage of network and computational resources of the underlay routers/switches forming the basis of the overlay network. This documents takes leads from the guidelines presented in <span>[<a href="#RFC4459" class="xref">RFC4459</a>]</span>.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The overlay connectivity can pan across various sites (geographically seperated or collocated) for realizing a Datacenter Interconnect or intersite VPNs between campus sites (buildings, branch offices etc).<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This literature intends to solve problem of icmp error propagation from an underlay routing/switching device to an end-host (hooked to EVPN overlay), thus facilitating "accurate MTU"  learnings.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This document also leverages the icmp multipart message extension, mentioned in <span>[<a href="#RFC4884" class="xref">RFC4884</a>]</span> to carry the original packet in the icmp PDU.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty ulBare toc">
<li class="compact ulEmpty ulBare toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements" class="xref">Requirements</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-solution-requirements" class="xref">Solution Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-problem-description" class="xref">Problem Description</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-issues-in-mtu-propagation-i" class="xref">Issues in MTU propagation in an underlay</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-inaccurate-mtu-relayed-to-e" class="xref">Inaccurate MTU relayed to end hosts</a></p>
</li>
                  <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-packet_too_big-not-relayed-" class="xref">Packet_Too_Big not-relayed to host</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-solutions" class="xref">Solution(s)</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-discovery-of-end-to-end-pat" class="xref">Discovery of end-to-end Path MTU</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-icmp-extensions-leveraged-f" class="xref">ICMP extensions leveraged for MTU propagation</a></p>
</li>
                  <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-packet-path-processing" class="xref">Packet Path Processing</a></p>
</li>
                  <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-icmpv6-error-translation" class="xref">ICMP(v6) Error Translation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-inter-site-mtu-propagation" class="xref">Inter-site MTU Propagation</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-same-subnet-considerations" class="xref">Same subnet Considerations</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-ecmp-considerations" class="xref">Ecmp Considerations</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">There is an operational disconnect between underlay network provisioned as the underlay network, and the overlay network which intends to connect islands of customer deployments. The deployments can range from cloud based services to storage applications or web(over the top) servers hosted over virtual machines or any other end devices like blade servers. Overlay network are provisioned as tunnels leveraging  Vxlan (and associated ones like gpe, geneve, gue), NVGRE, MPLS and other overlay encapsulations.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The end hosts (VMs, workloads, user-devices) in a datacenter/campus deployment are connected to gateway. In case the core network is laid out with EVPN-overlays, the gateways are Vteps (Vxlan-fabric gateways). These are the networking devices which encapsulate the packet in an Overlay construct and relays it over the underlay network.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">For campus deployments, various branch offices can be provisioned with EVPN-overlays and the vpn connectivity between them can be realized via EVPN-overlays (VXLAN, MPLS, NVGRE fabrics) itself. Thus it involves interworking/stitching of same/different overlays at DCI/VPN transit routing/switching devices. The transit devices can be on-premise WAN gateways (SDWAN or otherwize) or service provider network entry points.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">IPv6/IPv4 enabled hosts/end-points, triggering PMTUD, may not get the right/inconsistent (or none) information from (over) the underlay network in case MTU errors are encountered in the packet path (encapsulated in the overlay). This document validates the detailed solution for Vxlan-fabric (though equally applicable to other EVPN-overlays like Geneve, GUE, GPE, NVGRE) faciliated by an underlay network (via any routing protocol like BGP, OSPF, ISIS, EIGRP etc). This solution is equally applicable to other tunnel/overlay specifications falling into EVPN-overlay category.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The proposal in this document, formulates an integrated approach which falls inline with OAM modelling discussed in NVO3.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements">
<section id="section-2">
      <h2 id="name-requirements">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<div id="req_language">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">When used in lowercase, these words convey their typical use in common language, and they are not to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="solution-requirement">
<section id="section-2.2">
        <h3 id="name-solution-requirements">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-solution-requirements" class="section-name selfRef">Solution Requirements</a>
        </h3>
<p id="section-2.2-1">This section describes the advantages of the proposed solution, considering deployment in a typical EVPN-overlay underlay network:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-2.2-2">
<dt>(a)</dt>
<dd id="section-2.2-2.1">Optimal use of bandwidth in underlay and end-host network.<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(b)</dt>
<dd id="section-2.2-2.2">In case Vxlan Gateway nodes complies to this solution, it MAY avoid black holing of icmp errors generated by underlay network devices.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(c)</dt>
<dd id="section-2.2-2.3">All end host applications (like web servers) can tailor the MSS accordingly against their respective transports.<a href="#section-2.2-2.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(d)</dt>
<dd id="section-2.2-2.4">Facilitates seamless integration of IPv6 or dual stack applications over IPv4 based overlays and vice versa.<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(e)</dt>
<dd id="section-2.2-2.5">The proposed solution is applicable to all encapsulations <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span>, <span>[<a href="#I-D.draft-ietf-nvo3-vxlan-gpe" class="xref">I-D.draft-ietf-nvo3-vxlan-gpe</a>]</span>, <span>[<a href="#I-D.draft-ietf-nvo3-gue" class="xref">I-D.draft-ietf-nvo3-gue</a>]</span>, <span>[<a href="#I-D.draft-gross-geneve" class="xref">I-D.draft-gross-geneve</a>]</span> and <span>[<a href="#RFC7637" class="xref">RFC7637</a>]</span>. Although the problem and solution refers to VXLAN <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span> as a use-case in this document.<a href="#section-2.2-2.5" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="problem-description">
<section id="section-3">
      <h2 id="name-problem-description">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-problem-description" class="section-name selfRef">Problem Description</a>
      </h2>
<p id="section-3-1">In current vendor implementation(s) of Vxlan-Gateway or other network devices, which form part of the underlay network and is configured with an overlay(tunnel) mechanism to transport packets from one customer end point to another, are incapable of relaying the errors encountered in routing/switching path in their networks (underlay network) to the customer end points (hosts/vm/blade-servers). This deems right, as the underlay network should be transparent and  water-tight with respect to leaking any public (underlay) network information to customer devices (and vice versa), thus ensuring seclusion between different customers provisioning tunneled over the common underlay network.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">For example, the information carried in the IP header of a Vxlan encapsulated packet is transparent to the payload (end-point generated packet). Hence, any network-specific information related to IPv6/IPv4 native functionality is carried to the end-point devices, as is the case with an end-to-end private network. The information generated in the underlay network devices while processing packets destined-to/sourced-from end-point devices, need to be percolated from underlay encapsulation to end customer specific payload. This is something which is NOT directed by any standards, and also NOT implemented by current deployment(s) of routers and switches.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Thus end-host sending out packets may never know about a lingering problem, impacting it's traffic in the underlay network.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Note that terms "icmpv6" or "icmpv4" are used in the document with an intention to refer to both icmp and icmpv6, in case same context applies to both.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="ipmtudi">
<section id="section-3.1">
        <h3 id="name-issues-in-mtu-propagation-i">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-issues-in-mtu-propagation-i" class="section-name selfRef">Issues in MTU propagation in an underlay</a>
        </h3>
<p id="section-3.1-1">As mentioned in the <span>[<a href="#RFC1981" class="xref">RFC1981</a>]</span>, IPV6 PMTUD is based on the "Packet too big" icmpv6 error code, generated by the networking device which is capable of generating such messages on encountering packet paths which go over link with MTU size smaller than packet size.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">There are problems getting this working when end-point device initiates a "Path MTU Discovery" to remote end-point device.  It may lead to black-holing as per the current implementations.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">The following bullets provides pointers to potential black holing of PMTUD packets,<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.1-4">
<dt>(1)</dt>
<dd id="section-3.1-4.1">Vxlan Gateway MAY not set the DF bit in the outer IP header encapsulation.<a href="#section-3.1-4.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(2)</dt>
<dd id="section-3.1-4.2">Vxlan Gateway is incapable of relaying icmp error "Fragmentation Needed and Don't Fragment was Set", generated by IPv4 enabled underlay network device, to IPv6 enabled end-point host/vm/server(source of the original packet).<a href="#section-3.1-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-5">The problems are discussed in detail in the following sub-sections.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<div id="imturteh">
<section id="section-3.1.1">
          <h4 id="name-inaccurate-mtu-relayed-to-e">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-inaccurate-mtu-relayed-to-e" class="section-name selfRef">Inaccurate MTU relayed to end hosts</a>
          </h4>
<p id="section-3.1.1-1">Figure 1 depicts the topology referenced in the document for explaining the problem statement and the solution.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1.1-2">
<pre>
+----------+                    +----------+
|    H1    |                    |    H2    |
|          |                    |          |
|(H1_IPv6) |                    |(H2_IPv6) |
+----------+                    +----------+
     |                               |
     |                               |
+------------+   +----------+   +------------+
|(VtepA_IPv6)|   |          |   |(VtepB_IPv6)|
|   VtepA    |   |    R1    |   |  VtepB     |
|(VtepA_IPv4)|---| (R1_IPv4)|---|(VtepB_IPv4)|
+------------+   +----------+   +------------+

               Figure 1. L3 Overlay
</pre><a href="#section-3.1.1-2" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-3.1.1-3">
<pre>
       LEGEND:
       MAC address : &lt;Node_name&gt;_MAC
       IP address  : &lt;Node_name&gt;_IPv4
       IPv6 address: &lt;Node_name&gt;_IPv6
       &lt;Node_name&gt; : node names in the above topology are
                     H1, VtepA, R1, VtepB, H2.
       VtepA, VtepB: Vxlan gateways
                 R1: Intermediate router in underlay network
              H1,H2: End-point devices communicating withe each other
</pre><a href="#section-3.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1.1-4">H1 and H2 are the end point hosts in different subnet connected over Vxlan Overlays in the underlay network. The Vtep tunnel end points, christened as VtepA and VtepB, are reachabile over an underlay IPv4 network.  In this example,  VtepA and VtepB are dual stack enabled and act as Vxlan gateways to connected hosts. Link mtu between VtepA, R1 and VtepB is configured as 1300 bytes; where as for the links between H1 and VtepA, H2 and VtepB, it is configured as 1500 bytes.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">H1 sends out a packet obliging to 1500 bytes MTU packet size containment over the H1 and VtepA link. VtepA encapsulates the packet with (Vxlan + UDP) header and outer IP header corresponding to underlay reachability to destination tunnel end-point, that is VtepB, to reach out to H2.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1.1-6">If size of encapsulated packet to be send over the link VtepA-R1 exceeds the MTU (1300 bytes). IPv4 packet with (IP header + UDP header + Vxlan header + Original L2 Packet from H1 containing the IPv6 Payload) SHOULD be fragmented.  In case Vxlan gateway, VtepA, does not sets the DF-bit in the outer IP header, the packet gets fragmented, with the reassembly done at the egress gateway (VtepB).<a href="#section-3.1.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1.1-7">The re-assembled packet is routed by VtepB to H2. This can potentially lead to inaccurate Path MTU calculation at H1. H1 assumes it to be 1500 bytes as no icmp error is received. This opens the door for fragment/reassembly and more cpu cycles on networking devices in the underlay network.<a href="#section-3.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tbrf">
<section id="section-3.1.2">
          <h4 id="name-packet_too_big-not-relayed-">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-packet_too_big-not-relayed-" class="section-name selfRef">Packet_Too_Big not-relayed to host</a>
          </h4>
<p id="section-3.1.2-1">In figure 1, assume that link between VtepA and R1 is 1500 as the only change from the figure 1 topology. Hence the packet send by H1, leads to VtepA setting the DF-bit in the outer IP header(as part of Vxlan Encapsulation). When R1 receives the packet and the routing table lookup points to the outgoing link with mtu size R1_VtepB_MTU bytes, less than the packet size (1500 bytes). As DF-bit is set, R1 generates icmpv4 error directed towards the src-ip (VtepA_IPv4). It encapsulates the inner PDU of the original packet. However, VtepA drops the icmp error packet and fails to relay it to H1. This leads to black-holing.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">The above two sub-sections lay down potential problems for IPv6 Path MTU Discovery mechanism in an Overlay network.  Although these problem are generic to any combination of underlay and overlay network types (IPv4 or IPv6), the use-case topology in this document is specific to IPv6 end-point devices connected over Vxlan network, wherein, the underlay is connected over IPv4 network, unless mentioned specifically.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="solution">
<section id="section-4">
      <h2 id="name-solutions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-solutions" class="section-name selfRef">Solution(s)</a>
      </h2>
<div id="tdetd">
<section id="section-4.1">
        <h3 id="name-discovery-of-end-to-end-pat">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-discovery-of-end-to-end-pat" class="section-name selfRef">Discovery of end-to-end Path MTU</a>
        </h3>
<p id="section-4.1-1">Since Vxlan Gateway is the one, which encapsulates the Vxlan (or any other overlay) header onto the packet traversing through the overlay network and also decapsulates the overlay header for packets egressing out of same and heading towards the end devices, the solution becomes more apt to be installed on devices playing such role.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Firstly, It is a MUST that Vxlan gateways (VtepA and VtepB) SHOULD set the DF-bit in Outer header encapsulation for client packets that are wrapped with vxlan, related encapsulation, for Path MTU Discovery. Thus ensuring that icmp error packet is generated for packet size exceeding the link MTU in underlay network.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Secondly, it is MUST that Vxlan gateway devices translates the icmp error "Destination Unreachable" with code 'Fragmentation Needed and Don't Fragment was Set', into a icmpv6 error 'Packet too big' packet. This mandates that original packet carried in the icmp error message MUST carry information about the inner payload(original packet), and it is an IPv6 Packet, originated from the end-point device (H1 for VtepA in figure 1), connected to the Vxlan gateway over L3/L2 network.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Thirdly, it is MUST that Vxlan gateway devices translates the icmpv6 error 'Packet too big' into a icmp error 'Destination Unreachable' with code 'Fragmentation Needed and Don't Fragment was Set' packet. Successfully translation mandates that, original packet carried in the icmp error message gives information about the inner payload (original packet), and it is an IPv4 packet, which originated from the end-point device connected to gateway over L3/L2 network.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">Fourthly, incase both, the client side network connected to Vxlan Gateway and the underlay network are same, that is, either both are ipv4 or both are ipv6, then icmp error code error translation is NOT required. Rest of the process to retrieve original packet is identical.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<div id="icmpvxlan">
<section id="section-4.1.1">
          <h4 id="name-icmp-extensions-leveraged-f">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-icmp-extensions-leveraged-f" class="section-name selfRef">ICMP extensions leveraged for MTU propagation</a>
          </h4>
<p id="section-4.1.1-1">This solution leverages extensions in icmp and icmpv6 standards, <span>[<a href="#RFC4884" class="xref">RFC4884</a>]</span>, for the maximum size of the original packet that can be encapsulated in icmp error message with code as "Fragmentation Required(icmp)" or "Packet too big(icmpv6)" respectively. As the host info is encapsulated in the inner payload, this requires additional bytes of data in icmp packet: (Outer IP Header + UDP Header + Vxlan + Inner L2 Header + Inner IPv6 SRC/DST IPs).<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">In case Vxlan underlay network is provisioned over IPv6 underlay, then similar extensions are applicable to icmpv6.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">The processing of icmpv6 packet is extended from the current standards of 'non-delivery of icmpv6 packets to upper-layers on Vxlan gateways' to 'relaying it to the end-point devices'.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ppb">
<section id="section-4.1.2">
          <h4 id="name-packet-path-processing">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-packet-path-processing" class="section-name selfRef">Packet Path Processing</a>
          </h4>
<p id="section-4.1.2-1">Packet Path handling and processing is explained in this section. The assumptions are made with respect to network topology mentioned in <a href="#imturteh" class="xref">Section 3.1.1</a>. The packet format in each flow captures packet fields which are significant with respect to this solution. To understand the solution, the packet flow is explained which leads to generation of icmp or icmpv6 error by intermediate node in underlay network.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">IPv6 packet is sent by host H1 destined to host H2, both are in different IPv6 subnets.This packet is referred to as P1 in the document.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.2-3">
<pre>
    +----------------------------------------------------+
H1--|L2_Hdr(14 bytes): src-mac:H1_MAC, dest-mac:VtepA_MAC|--&gt;VtepA
    +----------------------------------------------------+
    |IPv6_Hdr(40 bytes): src-ip:H1_IPV6, dest-ip:H2_IPv6 |
    +----------------------------------------------------+
    |Host/App specific Payload                           |
    +----------------------------------------------------+
    Figure 2a. Packet P1 sent by host H1 to host H2
</pre><a href="#section-4.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-4">VtepA re-writes the mac addresses in 'P1' as part of Vxlan encapsulation. This encapsulation is referred as 'P2' in the document.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.2-5">
<pre>
    +------------------------------------------------------+
H1--|L2_Hdr(14 bytes):src-mac:VtepA_MAC, dest-mac:VtepB_MAC|--&gt;VtepA
    +------------------------------------------------------+
    |IPv6_Hdr(40 bytes): src-ip:H1_IPV6, dest-ip:H2_IPv6   |
    +------------------------------------------------------+
    |Host/App specific Payload                             |
    +------------------------------------------------------+
    Figure 2b. Packet P1 re-written by VtepA
</pre><a href="#section-4.1.2-5" class="pilcrow">¶</a>
</div>
<div id="vxlangateway">
<section id="section-4.1.2.1">
            <h5 id="name-packet-processing-at-vxlan-">
<a href="#section-4.1.2.1" class="section-number selfRef">4.1.2.1. </a><a href="#name-packet-processing-at-vxlan-" class="section-name selfRef">Packet Processing at Vxlan Gateway</a>
            </h5>
<p id="section-4.1.2.1-1">Processing at VtepA, in packet path from H1 to H2.<a href="#section-4.1.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.2.1-2">
<dt>(1)</dt>
<dd id="section-4.1.2.1-2.1">VtepA(Vxlan gateway) performs the Vxlan encapsulation over the packet received from H1, based on route lookup. The detail for encap are mentioned in <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span>.<a href="#section-4.1.2.1-2.1" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(2)</dt>
<dd id="section-4.1.2.1-2.2">VtepA MUST set the DF-bit in the Outer IP header.<a href="#section-4.1.2.1-2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(3)</dt>
<dd id="section-4.1.2.1-2.3">Since the MTU of outgoing link is more than the packet, packet is sent out towards the underlay next hop, R1.<a href="#section-4.1.2.1-2.3" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(4)</dt>
<dd id="section-4.1.2.1-2.4">P3 packets encapsulation is shown in figure 3. P3 may find a reference without outer header encapsulation  <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span> provides details of the vxlan encapsulation.<a href="#section-4.1.2.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.1.2.1-3">
<pre>
      +----------------------------------------------------------+
VtepA-|L2_Hdr(14bytes):src-mac:VtepA_Mac, dest-mac:R1_MAC        |--&gt;R1
      +----------------------------------------------------------+
      |IPv4_Hdr(20 bytes):src-ip:VtepA_IPv4,dest-ip:VtepB_IPv4,DF|
      +----------------------------------------------------------+
      |UDP(8 bytes): src-port: ephemeral-port, dest-port: 4789   |
      +----------------------------------------------------------+
      |Vxlan(8 bytes): Vxlan network identifier                  |
      +----------------------------------------------------------+
      |P2 packet (refer to H1 to VtepA flow for details of P1)   |
      +----------------------------------------------------------+
      Figure 3. Vxlan Encap packet sent by Vxlan Gateway to underlay
</pre><a href="#section-4.1.2.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="underlayicmperror">
<section id="section-4.1.2.2">
            <h5 id="name-underlay-generates-icmp-err">
<a href="#section-4.1.2.2" class="section-number selfRef">4.1.2.2. </a><a href="#name-underlay-generates-icmp-err" class="section-name selfRef">Underlay Generates             ICMP error</a>
            </h5>
<p id="section-4.1.2.2-1">In case the underlay is ipv6 and not ipv4, icmpv6 error is generated.<a href="#section-4.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-2">Processing at R1:<a href="#section-4.1.2.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.2.2-3">
<dt>(1)</dt>
<dd id="section-4.1.2.2-3.1">Packet Size (1500 bytes) is more than the outgoing link's mtu (1300 bytes) and DF-bit is set in the Outer IPv4 header added as part of Vxlan encapsulation at VtepA.<a href="#section-4.1.2.2-3.1" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(2)</dt>
<dd id="section-4.1.2.2-3.2">R1 MUST generate icmp error message (Destination Unreachable) with error code (Fragmentation Needed and Don't Fragment was Set). For ease of solution description, mtu is assumed to be symmetric over the reverse path, hence reverse path mtu from R1 to VtepA is 1500 bytes. icmpv6 error message MUST include MTU of link between R1 and VtepB.<a href="#section-4.1.2.2-3.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(3)</dt>
<dd id="section-4.1.2.2-3.3">In a nut shell, the icmp PDU encapsulation SHOULD be performed as mentioned in <span>[<a href="#RFC4884" class="xref">RFC4884</a>]</span> , <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span>. These standards atleast ensure, that original packet carried in icmp error PDU captures enough bytes to include the inner packets IPv6 header atleast. The capture of application specific details depends on the size of the Optional header in the original packet (generated by H1 as in Figure 2b) and subsequent transport header.  This helps Vxlan Gateway to trace(L3 reachability) the original packet generator  (end-point device) atleast and translate icmp error generted by underlay into icmpv6 one  and relay it to end-point device.  The length field in icmp PDU, include the maximum possible length permissible in reverse path MTU<a href="#section-4.1.2.2-3.3" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-4.1.2.2-4">For simplicity, not including the original packet header in the flow diagram in figure 4.  icmp PDU details are depicted in the follow up figure 5.<a href="#section-4.1.2.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.2.2-5">
<pre>
   +-----------------------------------------------------------+
R1-|L2_Hdr(14 bytes): src-mac:R1_MAC, dest-mac:VtepA_MAC       |--&gt;VtepA
   +-----------------------------------------------------------+
   |IPv4_Hdr(20 bytes): src-ip:R1_IPv4, dest-ip:VtepA_IPv4     |
   +-----------------------------------------------------------+
   |ICMP PDU,type:3,code:4,R1_VtepB_MTU, P3(No outer L2 Header)|
   +-----------------------------------------------------------+
            Figure 4. Flow diagram from R1 to VtepA

</pre><a href="#section-4.1.2.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2.2-6">The details of icmp PDU are in the following figure. Type '3' is "Destination Unreachable". Code '4' is "Fragmentation Needed and Don't Fragment bit is set".<a href="#section-4.1.2.2-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.2.2-7">
<pre>
 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4s 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|     Type=3    |     Code=4    |          Checksum             | ICMP
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=3
|     unused    |    Length     |   Next Hop Mtu = R1_VtepB_MTU | Code=4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol=UDP  | Header Checksum               |(Outer)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+Max 40
|            src-ip  : VtepA_IPv4                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : VtepB_IPv4                               |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|   Source UDP Port (ephemeral) |  Dest UDP Port = 4789 (Vxlan) |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+8 bytes
|   Length                      |  Checksum                     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
| | | | | | | | |     Reserved                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+8 bytes
|Vxlan Network identifier (VNI)                 | Reserved      |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ -------
|                  Inner Packet Dest-Mac = VtepB_MAC            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Inner Packet Src-Mac =     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Inner
|                       VtepA_MAC                               |14 byte)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X86dd (IPv6)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Header    | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     H1_IPv6                        |IPv6
|                                                               |Header
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6   =     H2_IPv6                       |  |
|                                                               |  |
|                                                               |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|    ~       Optional Headers and  transport header/Payload ~   | Varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
             Figure 5. ICMP PDU Original Packet Capture in Detail
</pre><a href="#section-4.1.2.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="relayicmperror">
<section id="section-4.1.2.3">
            <h5 id="name-relay-icmpv6-error-to-end-d">
<a href="#section-4.1.2.3" class="section-number selfRef">4.1.2.3. </a><a href="#name-relay-icmpv6-error-to-end-d" class="section-name selfRef">Relay ICMP(v6) Error to End Devices</a>
            </h5>
<p id="section-4.1.2.3-1">This sub-section can also be generalized as: "handling of icmp errors, which are generated by underlay network in response to end-device packets, by Vxlan Gateway".<a href="#section-4.1.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-2">Processing at VtepA: Processing of icmp error message with code (Fragmentation Needed and Don't Fragment was Set):<a href="#section-4.1.2.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.2.3-3">
<dt>(1)</dt>
<dd id="section-4.1.2.3-3.1">The icmp error is processed by Vxlan gateways as per the standards defined in <span>[<a href="#RFC1981" class="xref">RFC1981</a>]</span> , <span>[<a href="#RFC4884" class="xref">RFC4884</a>]</span> and <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span> .<a href="#section-4.1.2.3-3.1" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(2)</dt>
<dd id="section-4.1.2.3-3.2">If error code is (Fragmentation Needed and Don't Fragment was Set), it SHOULD perform further inspection of the original packet, P3(ethernet payload without its header) carried as data in icmp PDU in extension to standards referred in previous bullet. The extension processing MUST be done prior to taking a decision to either drop the packet or deliver to upper-layer protocols.<a href="#section-4.1.2.3-3.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(3)</dt>
<dd id="section-4.1.2.3-3.3">In extension to above, Vxlan gateway device SHOULD perform the vxlan decap as defined in <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span>, to arrive at the inner packet (P2, original packet with VtepA rewrite). The underlay encap is not carrying the layer-2 header in the icmp error packet. Once this processing is done, P2 is the packet which needs attention now, as it carries the credentials of actual host which should receive the relayed icmp packet.<a href="#section-4.1.2.3-3.3" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(4)</dt>
<dd id="section-4.1.2.3-3.4">Post encap, the VNI should be cached and a check should be made if its a Layer-2 VNI (L2VNI) or an Layer-3 VNI (L3VNI). If it's an L2VNI, go to the next step to check on the payload (ethernet) type. If and only if, it is ipv6 or ipv4, then only process it further else terminate the processing. If it's an L3VNI, then the mapping VRF should found to perform the route lookup for inner packet source IP address.<a href="#section-4.1.2.3-3.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(5)</dt>
<dd id="section-4.1.2.3-3.5">The layer-3 payload type SHOULD be verified using ethernet type field in ethernet header. In case it point to IPv6, src-ipv6 field should be picked up to check for reahability, as the icmp packet MUST be sent to original sender, that is, H1. In case H1 is reachable, icmp packet SHOULD be constructed as mentioned in the following bullet.<a href="#section-4.1.2.3-3.5" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(6)</dt>
<dd id="section-4.1.2.3-3.6">Now that P2 is out in the open, it's L2 header is decapsulated, and the leftover, in the figure 6, is run through the icmpv6 processing as mentioned in <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span>.<a href="#section-4.1.2.3-3.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(7)</dt>
<dd id="section-4.1.2.3-3.7">It SHOULD generate icmpv6 error message with type (Packet too big) destined to H1_IPv6, that is inner ipv6 packet's source ipv6 address. The mtu 'R1_VtepB_MTU' is copied from icmp error packet recieved from the underlay.<a href="#section-4.1.2.3-3.7" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(8)</dt>
<dd id="section-4.1.2.3-3.8">The IPv6 header is constructed from original payload as shown in figure 5.  The source ipv6 address is picked as local ipv6 address "VtepA_IPv6". The destination ipv6 address is set as the "src-ipv6" in original payload, H1_IPv6. The Next Header is set as "58" which denote icmpv6. The derivation of ethernet header is based on next hop to mac address mapping as is performed in any L3 lookup. The follow up figure 9, shows the icmpv6 error packet sent out to node H1. H1 is the original IPv6 packet generator as mentioned in Figure 2b.<a href="#section-4.1.2.3-3.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(9)</dt>
<dd id="section-4.1.2.3-3.9">The route lookup is performed for H1_IPv6 in the VNI mapped VRF, as also mentioned in one of the earlier bullets. Thus {inner packet source IP, VNI} as a tuple is required to resolve the path back to the inner packet source.<a href="#section-4.1.2.3-3.9" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.1.2.3-4">
<pre>
 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Header    | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     H1_IPv6                        | Inner
|                                                               | IPv6
|                                                               | 40 byt)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6   =     H2_IPv6                       |  |
|                                                               |  |
|                                                               |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|    ~  Optional Headers and  Transport/Application Payload ~   | Varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
      Figure 6. Original IPv6 Packet sent from H1 directed to H2
</pre><a href="#section-4.1.2.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2.3-5">Figure 6 gives a typical IPv6 format sent by end-host, H1 towards H2 and encapsulated by Vxlan gateway, to translate the icmp error generated by underlay hop, R1, to the one understood in right context by H1.<a href="#section-4.1.2.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.2.3-6">
<pre>
 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|    Type=2     | Code=0        |      CheckSum                 |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=2
|                 Mtu = R1_VtepB_MTU                            |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Header    | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     H1_IPv6                        | Orig
|                                                               | Packet
|                                                               |40 byte)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6   =     H2_IPv6                       |  |
|                                                               |  |
|                                                               |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ -----
|    ~ Optional/Transport Headers and Application Payload ~     |varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
 Figure 7. ICMPv6 "Packet Too Big" PDU relayed
           to H1 by Vxlan Gateway (VtepA)
</pre><a href="#section-4.1.2.3-6" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.1.2.3-7">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|                  Dest-Mac = H1_MAC                            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Inner Packet Src-Mac =     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+eth hdr
|                       VtepA_MAC                               |14 byte)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X86dd (IPv6)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Hdr = 58  | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     VtepA_IPv6                     | IPv6
|                                                               |header
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6   =     H1_IPv6                       |  |
|                                                               |  |
|                                                               |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
Figure 8. Ethernet and IPv6 encap for ICMPv6 PDU mentioned in
          figure 7
</pre><a href="#section-4.1.2.3-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2.3-8">The translated icmp packet encapsulation looks similar to, figure 7 and figure 8 put together in reverse order. The flow diagram in figure 9 gives a concise form of "packet too big" icmpv6 error relayed by VtepA (Vxlan Gateway) towards H1 (end point device).<a href="#section-4.1.2.3-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.2.3-9">
<pre>
       +--------------------------------------------------------+
VtepA--|L2_Hdr(14): src-mac:VtepA_MAC and Dest_Mac: H1_MAC      |--&gt;H1
       +--------------------------------------------------------+
       |IPv6_Hdr(40 bytes): src-ip:Vtep_IPv6, dest-ip:H1_IPv6   |
       +--------------------------------------------------------+
       |ICMPv6: Packet_Too_Big, mtu, data: first 128 bytes of P3|
       +--------------------------------------------------------+
Figure 9. Flow diagram:  VtepA to H1
</pre><a href="#section-4.1.2.3-9" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2.3-10">There are few more potential flows worth mentioning in this section. These cases are related to, icmp error getting generated from, ingress Vxlan gateway (VtepA) and egress Vxlan gateway (VtepB) with respect to packet sent from H1 to H2. For ingress Vxlan gateway (VtepA) case, the legacy IPv6 PMTUD rules from <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span> SHOULD be applied as no Vxlan encap is involved.<a href="#section-4.1.2.3-10" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-11">Where as, egress Vxlan gateway (VtepB) SHOULD send packet P3 (without L2 header) in the icmp data, even though mtu calculation MAY be done post vxlan decapsulation. That is when the outgoing link is identified as the one from VtepB to H2. It MAY buffer packet P3 prior to lookup based on inner packet (P2) credentials, so that P3 can be encapsulated in the icmp packet. This also ensures the packet format consistency, when accessed at the VtepA for translation before relaying it to H1.<a href="#section-4.1.2.3-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="relay_icmp">
<section id="section-4.1.3">
          <h4 id="name-icmpv6-error-translation">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-icmpv6-error-translation" class="section-name selfRef">ICMP(v6) Error Translation</a>
          </h4>
<p id="section-4.1.3-1">This section specifically mentions about icmp and icmpv6 packet translation, generated in an underlay network to the one which is, understood by the end point device, with encapsulation aligning with the network-type(IPv4 and IPv6), end-point device and underlay is provisioned with.  The last leg processing mentioned in previous sub-section is specific to the topology mentioned in <a href="#imturteh" class="xref">Section 3.1.1</a>.  However, this subsection elaborates on all possible topology combination of underlay and end-device networks with respect to IPv4 or IPv6. The explanation provided in form of figures for error generated by underlay and the translated one relayed to the end-point device by Vxlan gateway.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.3-2">
<dt>(a)</dt>
<dd id="section-4.1.3-2.1">End-Point is IPv6 connected and Underlay is IPv4 provisioned.<a href="#section-4.1.3-2.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>(b)</dt>
<dd id="section-4.1.3-2.2">End-Point is IPv4 connected and Underlay is IPv6 provisioned.<a href="#section-4.1.3-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>(c)</dt>
<dd id="section-4.1.3-2.3">Both End-Point and Underlay are provisioned with IPv6.<a href="#section-4.1.3-2.3" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>(d)</dt>
<dd id="section-4.1.3-2.4">Both End-Point and Underlay are provisioned with IPv4.<a href="#section-4.1.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="ipv6_ipv4">
<section id="section-4.1.3.1">
            <h5 id="name-end-point-is-ipv6-connected">
<a href="#section-4.1.3.1" class="section-number selfRef">4.1.3.1. </a><a href="#name-end-point-is-ipv6-connected" class="section-name selfRef">End-Point is IPv6 connected            and Underlay is IPv4 provisioned</a>
            </h5>
<p id="section-4.1.3.1-1">This case is similar to the last leg processing described in <a href="#ppb" class="xref">Section 4.1.2</a> and does not needs any more description.<a href="#section-4.1.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ipv4_ipv6">
<section id="section-4.1.3.2">
            <h5 id="name-end-point-is-ipv4-connected">
<a href="#section-4.1.3.2" class="section-number selfRef">4.1.3.2. </a><a href="#name-end-point-is-ipv4-connected" class="section-name selfRef">End-Point is IPv4 connected            and Underlay is IPv6 provisioned</a>
            </h5>
<p id="section-4.1.3.2-1">Topology drawn in figure 10, provides for the icmpv6 PDU encap generated by R1. H1_IPv4 and H2_IPv4 are in distinct ipv4 subnets. R1_IPv6 represents IPv6 addresses falling in both subnets connecting to VtepA and VtepB.<a href="#section-4.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-2">Another difference between an IPv4 and IPv6 underlay is that for IPv6 underlay there is no concept of DF-bit. The fragmentation can only be done at ingress. At all other underlay nodes "Packet too big" icmpv6 error is generated.  Vxlan Gateway SHOULD ensure that fragmentation is avoided at Vxlan Gateway and icmp error is sent back to H1. This procedure is applicable if and only if, original packet contains DF-bit set in it's IP header.<a href="#section-4.1.3.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.3.2-3">
<pre>
+----------+                    +----------+
|    H1    |                    |    H2    |
|          |                    |          |
|(H1_IPv4) |                    |(H2_IPv4) |
+----------+                    +----------+
     |                               |
     |                               |
+------------+   +----------+   +------------+
|(VtepA_IPv4)|   |          |   |(VtepB_IPv4)|
|   VtepA    |   |    R1    |   |  VtepB     |
|(VtepA_IPv6)|---| (R1_IPv6)|---|(VtepB_IPv6)|
+------------+   +----------+   +------------+

               Figure 10. L3 Overlay
</pre><a href="#section-4.1.3.2-3" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.1.3.2-4">
<pre>
       LEGEND:
       MAC address : &lt;Node_name&gt;_MAC
       IPv4 address: &lt;Node_name&gt;_IPv4
       IPv6 address: &lt;Node_name&gt;_IPv6
       &lt;Node_name&gt; : node names in the above topology are
                     H1, VtepA, R1, VtepB, H2.
       VtepA, VtepB: Vxlan gateways to underlay network
</pre><a href="#section-4.1.3.2-4" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.1.3.2-5">
<pre>
 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|     Type=2    |     Code=0    |          Checksum             | ICMPv6
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=2
|        Next Hop Mtu = R1_VtepB_MTU                            | Code=0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Hdr       | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     R1_IPv6                        | IPv6
|                                                               |40 byte)
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6  =     VtepA_IPv6                     |  |
|                                                               |  |
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         ~      Extension Headers ~ (payload type is UDP)      |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|   Source UDP Port (ephemeral) |  Dest UDP Port = 4789 (Vxlan) |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 8 byte
|   Length                      |  Checksum                     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
| | | | | | | | |     Reserved                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 8 byte
|Vxlan Network identifier (VNI)                 | Reserved      |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|                  Inner Packet Dest-Mac = VtepA_MAC            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Inner Packet Src-Mac =     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+eth hdr
|                       VtepB_MAC                               |14 byte
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X0800 (IPv4)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol      | Header Checksum               | Orig
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Hdr
|            src-ip  : H1_IPv4                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : H2_IPv4                                  |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|    ~     transport-header and Application specific Payload ~  | varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
        Figure 11. ICMPV6 PDU Sent by R1 to VtepA

</pre><a href="#section-4.1.3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3.2-6">R1 sends an icmpv6 error "Packet Too Big" directed towards VtepA. The icmpv6 PDU is shown in Figure 11. VtepA receives the packet with this icmpv6 PDU and translates it to icmp PDU with type "Destination Unreachable" and code "Fragmentation Needed" before relaying it to H1 over ipv4 network. Figure 12, reflects the relayed packet sent by VtepA to H1. All other references SHOULD be taken as it is from  <a href="#ppb" class="xref">Section 4.1.2</a>.<a href="#section-4.1.3.2-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.3.2-7">
<pre>
0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|                  Dest-Mac = H1_MAC                            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Inner Packet Src-Mac =     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+eth hdr
|                       VtepA_MAC                               |14 byte)
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X0800 (IPv4)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol=1    | Header Checksum               | IPv4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            src-ip  : VtepA_IPv4                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : H1_IPv4                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            Optional Header                                    |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|     Type=3    |     Code=4    |          Checksum             | ICMP
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=3
|     unused    |    Length     |   Next Hop Mtu = R1_VtepB_MTU | Code=4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol      | Header Checksum               |Orig
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+iPv4
|            src-ip  : H1_IPv4                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : H2_IPv4                                  |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|       Optional and Transport Header and Application data      | varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
Figure 12. ICMPv4 error Packet relayed to end point Host, H1
</pre><a href="#section-4.1.3.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ipv6_ipv6">
<section id="section-4.1.3.3">
            <h5 id="name-both-end-point-and-underlay">
<a href="#section-4.1.3.3" class="section-number selfRef">4.1.3.3. </a><a href="#name-both-end-point-and-underlay" class="section-name selfRef">Both End-Point and Underlay            are provisioned with IPv6</a>
            </h5>
<p id="section-4.1.3.3-1">Topology is mentioned in Figure 13 with minor changes along with the legend. Figure 14, outlines the icmpv6 PDU, encapsulation generated by R1. H1_IPv6 and H2_IPv6 in different ipv6 subnets. R1_IPv6 reflects both subnets connecting to VtepA and VtepB.<a href="#section-4.1.3.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.3.3-2">
<pre>
+----------+                    +----------+
|    H1    |                    |    H2    |
|          |                    |          |
|(H1_IPv6) |                    |(H2_IPv6) |
+----------+                    +----------+
     |                               |
     |                               |
+------------+   +----------+   +------------+
|(VtepA_IPv6)|   |          |   |(VtepB_IPv6)|
|   VtepA    |   |    R1    |   |  VtepB     |
|(VtepA_IPv6)|---| (R1_IPv6)|---|(VtepB_IPv6)|
+------------+   +----------+   +------------+

               Figure 13. L3 Overlay
</pre><a href="#section-4.1.3.3-2" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.1.3.3-3">
<pre>
       LEGEND:
       MAC address : &lt;Node_name&gt;_MAC
       IPv6 address: &lt;Node_name&gt;_IPv6
       &lt;Node_name&gt; : node names in the above topology are
                     H1, VtepA, R1, VtepB, H2.
       VtepA, VtepB: Vxlan gateways to underlay network
</pre><a href="#section-4.1.3.3-3" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.1.3.3-4">
<pre>
 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|     Type=2    |     Code=0    |          Checksum             | ICMPv6
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=2
|        Next Hop Mtu = R1_VtepB_MTU                            | Code=0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Hdr       | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     R1_IPv6                        |  IPv6
|                                                               | Header
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6  =     VtepA_IPv6                     |  |
|                                                               |  |
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         ~      Extension Headers ~ (payload type is UDP)      |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|   Source UDP Port (ephemeral) |  Dest UDP Port = 4789 (Vxlan) |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+8 bytes
|   Length                      |  Checksum                     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
| | | | | | | | |     Reserved                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+8 bytes
|Vxlan Network identifier (VNI)                 | Reserved      |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|                  Inner Packet Dest-Mac = VtepB_MAC            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Inner Packet Src-Mac =     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+eth hdr
|                       VtepA_MAC                               |14 byte
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X0800 (IPv4)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Hdr       | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     VtepA_IPv6                     |Inner
|                                                               | Ipv6
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6  =     H1_IPv6                        |  |
|                                                               |  |
|                                                               |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|         ~ Extension and Transport Headers, Application Data ~ | varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
Figure 14. ICMPv6 PDU generated by Intermediate Hop, R1 in Vxlan Network

</pre><a href="#section-4.1.3.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3.3-5">R1 sends an icmpv6 error "Packet Too Big" directed towards VtepA. The icmpv6 PDU is shown in Figure 14. VtepA receives the packet with this icmpv6 PDU and relays it to H1 without any translation as H1 is connected to VtepA over ipv6 network.  All other references about original packet to be include in the icmpv6 PDU can be taken as it is from <a href="#ppb" class="xref">Section 4.1.2</a>.<a href="#section-4.1.3.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.3.3-6">
<pre>
0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|                  Dest-Mac = H1_MAC                            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Inner Packet Src-Mac =     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+eth hdr
|                       VtepA_MAC                               |14 byte
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X86dd (IPv6)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Hdr       | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     VtepA_IPv6                     |IPv6
|                                                               | Header
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6  =     H1_IPv6                        |  |
|                                                               |  |
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         ~      Extension Headers ~ (payload type is ICMPV6)   |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|     Type=2    |     Code=0    |          Checksum             | ICMPv6
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=2
|        Next Hop Mtu = R1_VtepB_MTU                            | Code=0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|Ver=6  |Traffic Class  |      Flow Label                       |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|payload length                 |Next Hdr       | Hop Limit     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               src-ipv6   =     H1_IPv6                        |Orig
|                                                               |IPv6
|                                                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                                                               |  |
|               dest-ipv6  =     H2_IPv6                        |  |
|                                                               |  |
|                                                               |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
| ~ Extension and Transport Headers and Applcation data     ~   | varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
Figure 15. ICMPv6 error Complete Packet sent to H1 by VtepA
</pre><a href="#section-4.1.3.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ipv4_ipv4">
<section id="section-4.1.3.4">
            <h5 id="name-both-end-point-and-underlay-">
<a href="#section-4.1.3.4" class="section-number selfRef">4.1.3.4. </a><a href="#name-both-end-point-and-underlay-" class="section-name selfRef">Both End-Point and Underlay           are provisioned with IPv4</a>
            </h5>
<p id="section-4.1.3.4-1">Topology is mentioned in figure 16, with minor changes along with the legend, figure 17, provides the icmp PDU encap generated by R1. H1_IPv4 and H2_IPv4 are in different ipv4 subnets.<a href="#section-4.1.3.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.3.4-2">
<pre>
+----------+                    +----------+
|    H1    |                    |    H2    |
|          |                    |          |
|(H1_IPv4) |                    |(H2_IPv4) |
+----------+                    +----------+
     |                               |
     |                               |
+------------+   +----------+   +------------+
|(VtepA_IPv4)|   |          |   |(VtepB_IPv4)|
|   VtepA    |   |    R1    |   |  VtepB     |
|(VtepA_IPv4)|---| (R1_IPv4)|---|(VtepB_IPv4)|
+------------+   +----------+   +------------+

               Figure 16. L3 Overlay
</pre><a href="#section-4.1.3.4-2" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.1.3.4-3">
<pre>
       LEGEND:
       MAC address : &lt;Node_name&gt;_MAC
       IPv4 address: &lt;Node_name&gt;_IPv4
       &lt;Node_name&gt; : node names in the above topology are
                     H1, VtepA, R1, VtepB, H2.
       VtepA, VtepB: Vxlan gateways to underlay network
</pre><a href="#section-4.1.3.4-3" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-4.1.3.4-4">
<pre>
 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|     Type=3    |     Code=4    |          Checksum             | ICMP
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=3
|     unused    |    Length     |   Next Hop Mtu = R1_VtepB_MTU | Code=4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol=UDP  | Header Checksum               | IPv4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+Header
|            src-ip  : VtepA_IPv4                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : H1_IPv4                                  |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|   Source UDP Port (ephemeral) |  Dest UDP Port = 4789 (Vxlan) |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+8 bytes
|   Length                      |  Checksum                     |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
| | | | | | | | |     Reserved                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+8 bytes
|Vxlan Network identifier (VNI)                 | Reserved      |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|                  Inner Packet Dest-Mac = VtepB_MAC            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Inner Packet Src-Mac =     |inner
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+packet
|                       VtepA_MAC                               |eth hdr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X0800 (IPv4)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol      | Header Checksum               | IPv4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ hdr
|            src-ip  : H1_IPv4                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : H2_IPv4                                  |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
| ~ Optional and Transport Header and Application Payload ~     |varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------

 Figure 17. ICMP PDU generated by R1 towards VtepA
</pre><a href="#section-4.1.3.4-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3.4-5">R1 sends an icmp error  directed towards VtepA. The icmp PDU is shown in figure 17. VtepA receives the packet with this icmp PDU and relays it to H1 over ipv4 network.  Figure 16, displays the packet sent by VtepA to H1. All other references can be taken as it is from <a href="#ppb" class="xref">Section 4.1.2</a>.<a href="#section-4.1.3.4-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.3.4-6">
<pre>
0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|                  Dest-Mac = H1_MAC                            |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|                               |    Src-Mac =                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  eth
|                       VtepA_MAC                               |header
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
| Inner Vlan if present         |Ethtype = 0X0800 (IPv4)        |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol=1    | Header Checksum               |IPv4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+Header
|            src-ip  : VtepA_IPv4                               |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : H1_IPv4                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            Optional Header                                    |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|     Type=3    |     Code=4    |          Checksum             | ICMP
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Type=3
|     unused    |    Length     |   Next Hop Mtu = R1_VtepB_MTU | Code=4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|  Ver=4|IHL=5  |  TOS          |     Total length              |  ^
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|         Id                    |Flags| Fragment Offset         |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|  TTL          | Protocol      | Header Checksum               |Orig
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+IPv4
|            src-ip  : H1_IPv4                                  |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
|            dest-ip : H2_IPv4                                  |  v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|~ Optional and Transport Header and Application Payload     ~  | varies
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------

Figure 18. Complete ICMP error Packet sent to H1 by VtepA
</pre><a href="#section-4.1.3.4-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="multi_fabric_cons">
<section id="section-5">
      <h2 id="name-inter-site-mtu-propagation">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-inter-site-mtu-propagation" class="section-name selfRef">Inter-site MTU Propagation</a>
      </h2>
<div class="artwork art-text alignLeft" id="section-5-1">
<pre>
                          +--+
                          |CE|
                          +--+
                            |
                         +----+
                    +----| PE |----+
        +---------+ |    +----+    | +---------+
+----+  |        +---+            +---+        |  +----+
|NVE1|--|        |   |            |   |        |--|NVE3|
+----+  |---U1---|GW1|-----P------|GW3|---U2---|  +----+
        |        +---+            +---+        |
        |  NVO-1   |       WAN      |    NVO-2 |
        |        +---+            +---+        |
        |        |   |            |   |        |
+----+  |        |GW2|            |GW4|        |  +----+
|NVE2|--|        +---+            +---+        |--|NVE4|
+----+  +---------+ |              | +---------+  +----+
                    +--------------+
Figure 18. Datacenter/Site Interconnect Between Remote EVPN fabrics
</pre><a href="#section-5-1" class="pilcrow">¶</a>
</div>
<p id="section-5-2">This section specifically calls out the relay of icmp errors generated by underlay in an intersite/interfabric connectivity across EVPN-overlays. The reference diagram shown above is picked up from <span>[<a href="#RFC9014" class="xref">RFC9014</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The topology in the above diagram describes two disparate NVO fabrics connected across WAN; leveraging an EVPN provisioned overlay. Lets consider the interconnect as EVPN-Overlay over the WAN network (between GW1/2 and GW3/4). Thus there is a multi-hop overlay (tunnel) reachability between hosts in fabric(s) behind the edges NVE1/2 and NVE3/4. There is a EVPN-Overlay tunnel between NVEs and their respective gateways, i.e., between NVE1/2 and GW1/2 and another one between NVE3/4 and GW3/4. There is an intersite connect leveraging EVPN-Overlay, thus ensuring end to end connectivity between NVEs across the WAN. The fabric in dataplane can be Vxlan, MPLS, NVGRE, GENEVE, GUE, GPE etc.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The packet traversing between networks behind NVE1 to NVE3 shall transit through three EVPN-Overlay tunnels. First one, between NVE1 and GW1; second one, between the WAN gateways GW1 and GW3 and the third one, between GW3 and NVE3. There is an EVPN-Overlay handoff at all the EVPN-tunnel end-points in the packet path, GW1 and GW2 respectively.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">There is a possibility that the overlay encapsulated packet hits the MTU blockage at one of the underlay routers, lets say, P3 in this case. P3 generates icmp error targetted towards GW3 as the tunnel end-point. GW3 should check the credentials of the original PDU, carried in the icmp error and perform the route lookup. It's very likely that the path to reach packet source (behind NVE1) is also via the EVPN-Overlay tunnel from GW3 to GW1. The icmp error is relayed back over the EVPN-Overlay construct towards GW3. In the same flow GW1 should peek into the original PDU credentials to get the reachability to the inner packet source. As luck may have it, the packet source is reachable over the EVPN-overlay tunnel from GW1 to NVE1. It should go through the similar decap/re-encap as mentioned in earlier sections. The EVIs at each stitching point may be different, although ensuring that routes are exported between the VNIs. The first-hop vtep towards the source i.e. NVE1 should perform procedures mentioned in <a href="#ppb" class="xref">Section 4.1.2</a>, to relay out the icmp packet to the original source of the packet.<a href="#section-5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="same_subnet_considerations">
<section id="section-6">
      <h2 id="name-same-subnet-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-same-subnet-considerations" class="section-name selfRef">Same subnet Considerations</a>
      </h2>
<p id="section-6-1">This section proposes propagation of icmp or icmpv6 error (specific to MTU) at source Vtep to inner packet source, which is generated by an underlay device for a case, when, inner packet source and destination ipv4(or ipv6) addresses are in the same subnet.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The steps in section <a href="#relayicmperror" class="xref">Section 4.1.2.3</a>, elaborate on the check to be performed, if the icmp error is carrying the original PDU encapsulated with an L2VNI or L3VNI. In case it is an L2VNI, then the possibility of the inner packet traffic being a "same subnet" one is, very high. Hence <a href="#relayicmperror" class="xref">Section 4.1.2.3</a>, also talks about doing the ethernet type check in the inner packet payload. If and only if, it's ipv4 or ipv6, relay the icmp error back to the inner packet source ip (or ipv6) address. Else, don't process the relay message further. As the inner packet is a non layer-3 PDU, it does not makes sense to relay back the icmp error.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecmp_cons">
<section id="section-7">
      <h2 id="name-ecmp-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-ecmp-considerations" class="section-name selfRef">Ecmp Considerations</a>
      </h2>
<p id="section-7-1">Ecmp considerations are driven by the packet sent by the end host application and the way it's leveraged.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">To ensure "MTU propagation" via "icmpv6 error", is agnostic to ecmp paths in a Vxlan network, there are few more consideration. In Vxlan Gateway, the route look-up is done based on attributes carried in packet generated by end point host. The packet generated can potentially be from a tcp based end host application (although should not be generalized).<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Where as, for an intermediate node, (lets say, Spine node in Clos topology) in underlay network the look ups are based on Outer Encap (Vtep ip addresses and and UDP Header).<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The packet traversing from site behind NE1 to NVE3 shall transit through three EVPN-Overlay tunnels. First one, between NVE1 and GW1; second one, between the WAN gateways GW1 and GW3 and the third one, between GW3 and NVE3. There is an EVPN-Overlay handoff at all the EVPN-tunnel end-points in the packet path, GW1 and GW2 respectively. On another note, for an L2 gateway case, wherein Vxlan gateway (Vtep Node) bridges (and not routes) host packets destined to same subnet destination, MTU calculation SHOULD come into play only in the Spine devices.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">As a potential solution,the MTU values recieved over ECMP underlay paths can be cached at the ingress Vteps. The Vtep MAY propagate/relay the lowest of the all MTUs received across ECMP underlay paths, to the end-host.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec_cons">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">This document inherits all the security considerations discussed in <span>[<a href="#RFC1981" class="xref">RFC1981</a>]</span> and <span>[<a href="#RFC1191" class="xref">RFC1191</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana_considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">TBD<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledge">
<section id="section-10">
      <h2 id="name-acknowledgements">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-10-1">Thanks to Vengada Prasad Govindan, Deepak Kumar, Matthew Bocci and Rohit Mendiratta for providing the inputs.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">http://www.rfc-editor.org/rfc/rfc2119.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-gross-geneve">[I-D.draft-gross-geneve]</dt>
        <dd>
<span class="refAuthor">Gross, J.</span>, <span class="refAuthor">Sridhar, T.</span>, <span class="refAuthor">Garg, P.</span>, <span class="refAuthor">Wright, C.</span>, <span class="refAuthor">Ganga, G.</span>, <span class="refAuthor">Agarwal, P.</span>, <span class="refAuthor">Duda, C.</span>, <span class="refAuthor">Dutt, D.</span>, and <span class="refAuthor">J. Hudson</span>, <span class="refTitle">"Geneve: Generic Network Virtualization Encapsulation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-gross-geneve-02</span>, <time datetime="2015-10-25" class="refDate">25 October 2015</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-gross-geneve-02.txt">http://www.ietf.org/internet-drafts/draft-gross-geneve-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-nvo3-gue">[I-D.draft-ietf-nvo3-gue]</dt>
        <dd>
<span class="refAuthor">Herbert, T.</span>, <span class="refAuthor">Yong, L.</span>, and <span class="refAuthor">O. Zia</span>, <span class="refTitle">"Generic Protocol Extension for VXLAN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nvo3-gue-03</span>, <time datetime="2015-03-06" class="refDate">6 March 2015</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-nvo3-gue-03.txt">http://www.ietf.org/internet-drafts/draft-ietf-nvo3-gue-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-nvo3-vxlan-gpe">[I-D.draft-ietf-nvo3-vxlan-gpe]</dt>
        <dd>
<span class="refAuthor">Quinn, P.</span>, <span class="refAuthor">Manur, R.</span>, <span class="refAuthor">Kreeger, L.</span>, <span class="refAuthor">Lewis, D.</span>, <span class="refAuthor">Maino, F.</span>, <span class="refAuthor">Smith, M.</span>, <span class="refAuthor">Agarwal, P.</span>, <span class="refAuthor">Yong, L.</span>, <span class="refAuthor">Xu, X.</span>, <span class="refAuthor">Elzur, U.</span>, and <span class="refAuthor">D. Melman</span>, <span class="refTitle">"Generic Protocol Extension for VXLAN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nvo3-vxlan-gpe-02</span>, <time datetime="2015-05-01" class="refDate">1 May 2015</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-nvo3-vxlan-gpe-02.txt">http://www.ietf.org/internet-drafts/draft-ietf-nvo3-vxlan-gpe-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.nordmark-nvo3-transcending-traceroute">[I-D.nordmark-nvo3-transcending-traceroute]</dt>
        <dd>
<span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Appanna, C.</span>, and <span class="refAuthor">A. Lo</span>, <span class="refTitle">"Layer-Transcending Traceroute for Overlay Networks like VXLAN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-nordmark-nvo3-transcending-traceroute-02</span>, <time datetime="2015-03-04" class="refDate">4 March 2015</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-nordmark-nvo3-transcending-traceroute-02.txt">http://www.ietf.org/internet-drafts/draft-nordmark-nvo3-transcending-traceroute-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1191">[RFC1191]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Path MTU discovery"</span>, <span class="seriesInfo">RFC 1191</span>, <time datetime="1990-11-01" class="refDate">1 November 1990</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc1191.txt">http://www.rfc-editor.org/rfc/rfc1191.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1981">[RFC1981]</dt>
        <dd>
<span class="refAuthor">McCann, J.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">J. Mogul</span>, <span class="refTitle">"Path MTU Discovery for IP version 6"</span>, <span class="seriesInfo">RFC 1981</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc1981.txt">http://www.rfc-editor.org/rfc/rfc1981.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta</span>, <span class="refTitle">"Internet Control Message Protocol (icmpv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc4443.txt">http://www.rfc-editor.org/rfc/rfc4443.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4459">[RFC4459]</dt>
        <dd>
<span class="refAuthor">Savola, P.</span>, <span class="refTitle">"MTU and Fragmentation Issues with In-the-Network Tunneling"</span>, <span class="seriesInfo">RFC 9014</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc9014.txt">http://www.rfc-editor.org/rfc/rfc9014.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4821">[RFC4821]</dt>
        <dd>
<span class="refAuthor">Mathis, M.</span> and <span class="refAuthor">J. Heffner</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery"</span>, <span class="seriesInfo">RFC 4821</span>, <time datetime="2007-03" class="refDate">March 2007</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc4821.txt">http://www.rfc-editor.org/rfc/rfc4821.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4884">[RFC4884]</dt>
        <dd>
<span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Gan, D.</span>, <span class="refAuthor">Tappan, D.</span>, and <span class="refAuthor">C. Pignataro</span>, <span class="refTitle">"Extended ICMP to Support Multi-Part Messages"</span>, <span class="seriesInfo">RFC 4884</span>, <time datetime="2007-04" class="refDate">April 2007</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc4884.txt">http://www.rfc-editor.org/rfc/rfc4884.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7348">[RFC7348]</dt>
        <dd>
<span class="refAuthor">Mahalingam, M.</span>, <span class="refAuthor">Dutt, D.</span>, <span class="refAuthor">Duda, K.</span>, <span class="refAuthor">Agarwal, P.</span>, <span class="refAuthor">Kreeger, L.</span>, <span class="refAuthor">Sridhar, T.</span>, <span class="refAuthor">Bursell, M.</span>, and <span class="refAuthor">C. Wright</span>, <span class="refTitle">"Virtual eXtensible Local Area Network (VXLAN): A Framework for Overlaying Virtualized Layer 2 Networks over Layer 3 Networks"</span>, <span class="seriesInfo">RFC 7348</span>, <time datetime="2014-08" class="refDate">August 2014</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc7348.txt">http://www.rfc-editor.org/rfc/rfc7348.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7637">[RFC7637]</dt>
        <dd>
<span class="refAuthor">Yang, S.</span> and <span class="refAuthor">M. Garg</span>, <span class="refTitle">"Network Virtualization Using Generic Routing Encapsulation"</span>, <span class="seriesInfo">RFC 7637</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc7637.txt">http://www.rfc-editor.org/rfc/rfc7637.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9014">[RFC9014]</dt>
      <dd>
<span class="refAuthor">Rabadan, J.</span>, <span class="refAuthor">Sathappan, S.</span>, <span class="refAuthor">Henderickx, W.</span>, <span class="refAuthor">Sajassi, A.</span>, and <span class="refAuthor">W. Drake</span>, <span class="refTitle">"Interconnect Solution for Ethernet VPN (EVPN) Overlay Networks"</span>, <span class="seriesInfo">RFC 9014</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc9014.txt">http://www.rfc-editor.org/rfc/rfc9014.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Saumya Dikshit</span></div>
<div dir="auto" class="left"><span class="org">Aruba Networks, HPE</span></div>
<div dir="auto" class="left"><span class="street-address">Mahadevpura</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560 048</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:saumya.dikshit@hpe.com" class="email">saumya.dikshit@hpe.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vinayak Joshi</span></div>
<div dir="auto" class="left"><span class="org">Aruba Networks, HPE</span></div>
<div dir="auto" class="left"><span class="street-address">Mahadevpura</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560 048</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vinayak.joshi@hpe.com" class="email">vinayak.joshi@hpe.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">A. Sujeet Nayak</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div dir="auto" class="left"><span class="street-address">Cessna Business Park</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560 087</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sua@cisco.com" class="email">sua@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
