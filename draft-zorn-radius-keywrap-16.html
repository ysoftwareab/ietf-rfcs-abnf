<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Vendor Specific RADIUS Attributes for the Delivery of Keying Material</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Vendor Specific RADIUS Attributes for the Delivery of Keying Material">
<meta name="keywords" content="RADIUS, Security">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">G. Zorn</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Network Zen</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">T. Zhang</td></tr>
<tr><td class="header">Expires: January 10, 2011</td><td class="header">Advista Technologies</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Walker</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Intel Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Salowey</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 9, 2010</td></tr>
</table></td></tr></table>
<h1><br />Vendor Specific RADIUS Attributes for the Delivery of Keying Material<br />draft-zorn-radius-keywrap-16.txt</h1>

<h3>Abstract</h3>

<p>
			This document defines a set of vendor specific RADIUS Attributes designed to allow both 
			the secure transmission of cryptographic keying material and strong authentication of any RADIUS message.
			
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 10, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Specification of Requirements<br />
<a href="#anchor3">3.</a>&nbsp;
Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Keying-Material<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
MAC-Randomizer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Message-Authentication-Code<br />
<a href="#anchor7">4.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor8">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor9">6.</a>&nbsp;
Contributors<br />
<a href="#anchor10">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
			Many remote access deployments 
			(for example, deployments utilizing wireless LAN technology)
			require the secure
			transmission of cryptographic keying material from a RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> server to
			a network access point.  Typically, this material is produced as a by-product of an EAP <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> authentication
			and is of a form that may be used in virtually any cryptographic algorithm after appropriate processing.

			
</p>
<p>
			This document defines a set of vendor specific RADIUS Attributes that can be used to securely transfer cryptographic keying material 
			using
			standard techniques with well understood security properties.  
			In addition, the Message-Authentication-Code Attribute may be used to provide strong 
			authentication for any RADIUS message, including
			those used for accounting and dynamic authorization.
			
</p>
<p>
			Discussion of this draft may be directed to the authors.
			
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Specification of Requirements</h3>

<p>
			The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
			"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
           	 	and "OPTIONAL" in this document are to be interpreted as
           	 	described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Attributes</h3>

<p>
			The following subsections describe sub-attributes which are transmitted in one or more RADIUS attributes of type Vendor-Specific <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>. The Vendor-ID field of the Vendor-Specific Attribute(s) MUST be set to decimal 9 (Cisco).  The general format of the attributes is: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type (26)   |    Length   |         Vendor ID
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Vendor ID (cont'd)           |   Sub-type (1)|   Sub-length  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                            Value...
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p>
</p>
<blockquote class="text">
<p>
</p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd>
<br />

26 for vendor specific

</dd>
<dt>Length</dt>
<dd>
<br />

Length of entire attribute including type and length field

</dd>
<dt>Vendor ID</dt>
<dd>
<br />

4 octets encoding the Cisco Vendor ID of 9

</dd>
<dt>Sub-type</dt>
<dd>
<br />

Attribute sub-type of 1

</dd>
<dt>Sub-length</dt>
<dd>
<br />

Length of the sub attribute including the sub-type and sub-length fields

</dd>
<dt>Value</dt>
<dd>
<br />

Value of the sub attribute.

</dd>
</dl></blockquote>


</blockquote><p>

</p>
<p>
</p>
<p>This specification concerns the following sub-attributes:

			</p>
<ul class="text">
<li>Keying-Material
</li>
<li>MAC-Randomizer
</li>
<li>Message-Authentication-Code
</li>
</ul><p>

</p>
<p>
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Keying-Material</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>Description</dt>
<dd>
							<br />

					This Attribute MAY be used
					to transfer cryptographic keying material from a RADIUS server to a client. 
					<br />
<br />

					It MAY be sent in request messages (e.g., Access-Request, etc.), 
					as well; if the Keying-Material Attribute is present in a request, 
					it SHOULD be 
					taken as a hint by the server that the client prefers this method of key delivery over others, 
					the server is not obligated to honor the hint, however.
					When the Keying-Material Attribute is included in a request message the Key ID, 
					Lifetime, IV and Key Material
					fields MAY be omitted.
					<br />
<br />

					If the client requires the use of the Keying-Material Attribute
					for keying material delivery and it is not present in the Access-Accept or Access-Challenge message, 
					the client MAY ignore the message in question and end the user session. 	
					<br />
<br />

					Any packet 
					that contains a Keying-Material Attribute MUST also include the Message-Authentication-Code Attribute.
					<br />
<br />

					Any packet that contains an instance of the Keying-Material Attribute MUST NOT contain an instance of any other 
					attribute (e.g., MS-CHAP-MPPE-Keys <a class='info' href='#RFC2548'>[RFC2548]<span> (</span><span class='info'>Zorn, G., &ldquo;Microsoft Vendor-specific RADIUS Attributes,&rdquo; March&nbsp;1999.</span><span>)</span></a>, Tunnel-Password <a class='info' href='#RFC2868'>[RFC2868]<span> (</span><span class='info'>Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;RADIUS Attributes for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a>, etc.)
					encapsulating identical keying material.
					<br />
<br />

					The Keying-Material Attribute MUST NOT be used to transfer long-lived keys (i.e., passwords)
					between RADIUS servers and clients.
					<br />
<br />

					A summary of the Keying-Material attribute format is shown below.  The fields are transmitted from left to right.
					
</dd>
</dl></blockquote><p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type (26)   |    Length   |   Vendor ID
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Vendor ID (cont'd)           |   Sub-type (1)|    Sub-length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                     String ID  ("radius:app-key=")
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)     |    Enc Type   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                             App ID                            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                             KEK ID
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             KEK ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             KEK ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             KEK ID (cont'd)                      |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                             KM ID
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             KM ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             KM ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             KM ID (cont'd)                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                            Lifetime                           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                               IV
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                               IV (cont'd)                        |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                              Data
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>

					</p>
<blockquote class="text">
<p>
							</p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd>
<br />

26 for vendor specific

</dd>
<dt>Length</dt>
<dd>
<br />

Length of entire attribute including type and length field

</dd>
<dt>Vendor ID</dt>
<dd>
<br />

4 octets encoding the Cisco Vendor ID of 9

</dd>
<dt>Sub-type</dt>
<dd>
<br />

Attribute sub-type of 1

</dd>
<dt>Sub-length</dt>
<dd>
<br />

Length of the sub attribute including the sub-type and sub-length fields

</dd>
<dt>String-ID</dt>
<dd>
<br />

The ASCII characters "radius:app-key=" without quotes or null termination.

</dd>
<dt>Enc Type</dt>
<dd>
									<br />

					The Enc Type field indicates the method used to encrypt the contents of the Data field.  
					This document defines only one value (decimal) for this field:
					
<blockquote class="text"><dl>
<dt></dt>
<dd>
					0	AES Key Wrap with 128-bit KEK <a class='info' href='#RFC3394'>[RFC3394]<span> (</span><span class='info'>Schaad, J. and R. Housley, &ldquo;Advanced Encryption Standard (AES) Key Wrap Algorithm,&rdquo; September&nbsp;2002.</span><span>)</span></a>
										
</dd>
</dl></blockquote>
					Implementations MUST support Enc Type 0 (AES Key Wrap with 128-bit KEK).
									
<blockquote class="text"><dl>
<dt>Implementation Note</dt>
<dd>
											<br />

	  					A shared secret is used as the key-encrypting-key (KEK)
	  					for the AES key wrap algorithm.
 						Implementations SHOULD provide a means to provision a key 
 						(cryptographically separate from the normal RADIUS shared secret)
 						to be used exclusively as a KEK.
 					
</dd>
</dl></blockquote>
								
</dd>
<dt>App ID</dt>
<dd>
									<br />

					The App ID field is 4 octets in length and identifies the type of application
					for which the key material is to be used.  This allows for multiple keys for different purposes to be present in the same message. 
					This document defines two values for the App ID:
					
<blockquote class="text"><dl>
<dt></dt>
<dd>
					0	Unspecified
										
</dd>
<dt></dt>
<dd>
					1	EAP MSK
										
</dd>
</dl></blockquote>
				 further specification of the content of this field is outside the scope 
					of this document.
								
</dd>
<dt>KEK ID</dt>
<dd>
									<br />

					The KEK ID field is 16 octets in length and contains an identifier for the KEK. 
					The KEK ID MUST refer to an encryption key of a type and length appropriate 
					for use with the algorithm specified by the Enc Type field (see above).  This key is used to protect the contents of 
					the Data field (below).
					Further specification of the content of this field is outside the scope 
					of this document.
								
</dd>
<dt>KM ID</dt>
<dd>
									<br />

					The KM ID field is 16 octets in length and contains an identifier for the contents of the Data field.  
					The KM ID MAY be used by communicating parties to identify the material being transmitted.  
					The combination of App ID and KM ID MUST uniquely identify the keying material between the parties utilizing it. 
					The KM ID is assumed to be known to the parties that derived the keying material. If the KM ID is not used it is set to 0. 
					Further specification of the content of this field is outside the scope 
					of this document.
								
</dd>
<dt>Lifetime</dt>
<dd>
									<br />

					The Lifetime field is an integer <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> representing
					the period of time (in seconds) for which the keying material is valid.
									<br />
<br />

					Note: Applications using this value SHOULD consider the beginning of 
					the lifetime to be 
					the point in time when the keying material is first used.
								
</dd>
<dt>IV</dt>
<dd>
									<br />

									The length of the IV field depends upon the value of the Enc Type field, 
									but is fixed for any given value thereof.  
									When the value of the Enc Type field is 0 (decimal), the IV field MUST be
									 8 octets in length (as illustrated above) and the value of the IV
									 field MUST be as specified in <a class='info' href='#RFC3394'>[RFC3394]<span> (</span><span class='info'>Schaad, J. and R. Housley, &ldquo;Advanced Encryption Standard (AES) Key Wrap Algorithm,&rdquo; September&nbsp;2002.</span><span>)</span></a>.							
								
</dd>
<dt>Data</dt>
<dd>
									<br />

								The Data field is variable length and contains the actual encrypted
								keying material.  
								
</dd>
</dl></blockquote>
						

</blockquote><p>
				
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
MAC-Randomizer</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>Description</dt>
<dd>
							<br />

							The MAC-Randomizer Attribute MUST be present
							in any message that includes an instance of the Message-Authentication-Code Attribute.
							The Random field MUST contain a 32 octet random number which
							SHOULD satisfy the requirements of <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>.
			 				
<blockquote class="text"><dl>
<dt>Implementation Note</dt>
<dd>
								<br />

 					 				The Random field MUST be filled in before the MAC is computed.
 					 				The MAC-Randomizer Attribute SHOULD be placed at the beginning of the RADIUS message if possible.
</dd>
</dl></blockquote>	
							A summary of the MAC-Randomizer attribute format is shown
							below.  The fields are transmitted from left to right.							
							
</dd>
</dl></blockquote><p>							
					
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type (26)   |    Length   |   Vendor ID
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Vendor ID (cont'd)           |   Sub-type (1)|    Sub-length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                     String ID  ("radius:random-nonce=")
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                           Random...
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>
					</p>
<blockquote class="text">
<p>
</p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd>
<br />

26 for vendor specific

</dd>
<dt>Length</dt>
<dd>
<br />

Length of entire attribute including type and length field

</dd>
<dt>Vendor ID</dt>
<dd>
<br />

4 octets encoding the Cisco Vendor ID of 9

</dd>
<dt>Sub-type</dt>
<dd>
<br />

Attribute sub-type of 1

</dd>
<dt>Sub-length</dt>
<dd>
<br />

Length of the sub attribute including the sub-type and sub-length fields

</dd>
<dt>String-ID</dt>
<dd>
<br />

The ASCII characters "radius:random-nonce=" without quotes or null termination.

</dd>
<dt>Random</dt>
<dd>
									<br />

									This field MUST contain a 32 octet random number which SHOULD satisfy the requirements of 
									<a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>.
								
</dd>
</dl></blockquote>
						

</blockquote><p>
					
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Message-Authentication-Code</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>Description</dt>
<dd>
							<br />

					This Attribute MAY be used to "sign" messages to prevent
					spoofing.   If it is present in a request, the receiver should take this a hint that the sender 
					prefers the use of this Attribute for message authentication; the receiver is not obligated to do so, however.
					<br />
<br />

					The Message-Authentication-Code Attribute MUST be included
					in any message
					that contains a Keying-Material attribute.
					<br />
<br />

					Any packet that contains an instance of the Message-Authentication-Code Attribute SHOULD NOT contain an instance of the 
					Message-Authenticator Attribute <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a>.
					If both attributes are to be included in a message (e.g., for backward compatibility in a network containing both old and new clients), 
					the value of the
					Message-Authentication-Code Attribute MUST be computed first.
					<br />
<br />

					If any message is received containing an instance of the Message-Authentication-Code Attribute,
					the receiver MUST calculate the correct value
					of the Message-Authentication-Code and silently discard the packet if the computed value
					does not match the value received.
					<br />
<br />

					If a received message contains an instance of the MAC-Randomizer Attribute (Section 3.2),
					the received MAC-Randomizer Attribute SHOULD
					be included in the computation of the Message-Authentication-Code Attribute sent in the response, as described below.
					<br />
<br />

					A summary of the Message-Authentication-Code attribute format is shown
					below.  The fields are transmitted from left to right.
					
</dd>
</dl></blockquote><p>
				
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type (26)   |    Length   |           Vendor ID
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Vendor ID (cont'd)           |   Sub-type (1)|    Sub-length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |       String ID  ("radius:message-authenticator-code=")
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           String ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           String ID (cont'd)     |   MAC Type    |  MAC Key ID
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                       MAC Key ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          MAC Key ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          MAC Key ID (cont'd)
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          MAC Key ID (cont'd)     |    MAC
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                             MAC (cont'd) ...
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>
					</p>
<blockquote class="text">
<p>
							</p>
<blockquote class="text"><dl>
<dt>Type</dt>
<dd>
<br />

26 for vendor specific

</dd>
<dt>Length</dt>
<dd>
<br />

Length of entire attribute including type and length field

</dd>
<dt>Vendor ID</dt>
<dd>
<br />

4 octets encoding the Cisco Vendor ID of 9

</dd>
<dt>Sub-type</dt>
<dd>
<br />

Attribute sub-type of 1

</dd>
<dt>Sub-length</dt>
<dd>
<br />

Length of the sub attribute including the sub-type and sub-length fields

</dd>
<dt>String-ID</dt>
<dd>
<br />

The ASCII characters "radius:message-authenticator-code=" without quotes or null termination.

</dd>
<dt>MAC Type</dt>
<dd>
								<br />

									The MAC Type field specifies the algorithm used to create the 
									value in the MAC field.  This document defines six values for the 
									MAC Type field:
									
<blockquote class="text"><dl>
<dt></dt>
<dd>
											0	HMAC-SHA-1 <a class='info' href='#FIPS.180-2.2002'>[FIPS.180&#8209;2.2002]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a> <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>
										
</dd>
<dt></dt>
<dd>
											1	HMAC-SHA-256 <a class='info' href='#FIPS.180-2.2002'>[FIPS.180&#8209;2.2002]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a> <a class='info' href='#RFC4231'>[RFC4231]<span> (</span><span class='info'>Nystrom, M., &ldquo;Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512,&rdquo; December&nbsp;2005.</span><span>)</span></a>
										
</dd>
<dt></dt>
<dd>
											2	HMAC-SHA-512 <a class='info' href='#FIPS.180-2.2002'>[FIPS.180&#8209;2.2002]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a> <a class='info' href='#RFC4231'>[RFC4231]<span> (</span><span class='info'>Nystrom, M., &ldquo;Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512,&rdquo; December&nbsp;2005.</span><span>)</span></a>
										
</dd>
<dt></dt>
<dd>
										    3	CMAC-AES-128 <a class='info' href='#NIST.SP800-38B'>[NIST.SP800&#8209;38B]<span> (</span><span class='info'>Dworkin, M., &ldquo;Recommendation for Block Cipher Modes of Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a>
										
</dd>
<dt></dt>
<dd>
										    4	CMAC-AES-192 <a class='info' href='#NIST.SP800-38B'>[NIST.SP800&#8209;38B]<span> (</span><span class='info'>Dworkin, M., &ldquo;Recommendation for Block Cipher Modes of Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a>
										
</dd>
<dt></dt>
<dd>
										    5	CMAC-AES-256 <a class='info' href='#NIST.SP800-38B'>[NIST.SP800&#8209;38B]<span> (</span><span class='info'>Dworkin, M., &ldquo;Recommendation for Block Cipher Modes of Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a>
										
</dd>
</dl></blockquote>
										Implementations MUST support MAC Type 0 (HMAC-SHA-1).
								
</dd>
<dt>MAC Key ID</dt>
<dd>
								<br />

									The MAC Key ID field is 16 octets in length and contains an identifier for the key.  
									The MAC Key ID MUST refer to a key of a type and length appropriate for use with the 
									algorithm specified by the MAC Type field (see above).
									Further specification of the content of this field is outside the scope 
									of this document.
								
</dd>
<dt>MAC</dt>
<dd>
								<br />

									Both the length and value of the MAC field depend upon the algorithm specified 
									by the value of the MAC Type field.  If the algorithm specified is HMAC-SHA-1, HMAC-SHA-256 or HMAC-SHA-512, the MAC field MUST be 20,
									32 or 64 octets in length, respectively.  
									If the algorithm specified is CMAC-AES-128, CMAC-AES-192 or CMAC-AES-256, the MAC field SHOULD be 64 octets in length.
									The derivation of the MAC field value 
									for all the algorithms specified in this document is identical, except for the algorithm used.  
									There are differences, however, depending upon whether the MAC is being computed for a request message or 
									a response.  These differences are detailed below, with the free variable HASH-ALG representing the actual algorithm used.
									
<blockquote class="text"><dl>
<dt>Request Messages</dt>
<dd>
										<br />

											For requests (e.g., CoA-Request <a class='info' href='#RFC5176'>[RFC5176]<span> (</span><span class='info'>Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&rdquo; January&nbsp;2008.</span><span>)</span></a>, Accounting-Request <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a>, etc.),
											the value 
											of the MAC field is a hash of the entire packet
											except the Request Authenticator in the header of the RADIUS packet, 
											using a shared secret as the key, as follows.
										
<blockquote class="text"><dl>
<dt>MAC = MAC-ALG(Key, Type + Identifier + Length + Attributes) where '+' represents concatenation</dt>
<dd>
</dd>
</dl></blockquote>
										The MAC-Randomizer Attribute (Section 3.2) MUST be included in any request in which the Message-Authentication-Code 
 					 					Attribute is used.
 					 					The Random field of the MAC-Randomizer Attribute MUST be filled in before the value of the MAC field is computed.
 					 					<br />
<br />

 					 					If the Message-Authenticator-Code Attribute is included in a client request, the server SHOULD ignore the contents of 
                                        the Request Authenticator.	
  						 					
<blockquote class="text"><dl>
<dt>Implementation Notes</dt>
<dd>
													<br />

													When the hash is calculated, both the MAC field of the Message-Authenticator-Code attribute 
													and the String field of the Message-Authenticator Attribute (if any) MUST be considered to be zero-filled.
													<br />
<br />

													Implementations SHOULD provide a means to provision a key 
												(cryptographically separate from the normal RADIUS shared secret)
												to be used exclusively in the generation of the
												Message-Authentication-Code. 
</dd>
</dl></blockquote> 
</dd>
<dt>Response Messages</dt>
<dd>
										<br />

									 	For responses (e.g., CoA-ACK <a class='info' href='#RFC5176'>[RFC5176]<span> (</span><span class='info'>Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&rdquo; January&nbsp;2008.</span><span>)</span></a>, Accounting-Response <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a>, etc.),
									 	the value 
									 	of the MAC field is a hash of the entire packet
									 	except the Response Authenticator in the header of the RADIUS packet
									 	using a shared secret as the key, as follows.
										
<blockquote class="text"><dl>
<dt>MAC = HASH-ALG(Key, Type + Identifier + Length + Attributes) where '+
									' represents concatenation</dt>
<dd>
</dd>
</dl></blockquote>		
										If the request contained an instance of the MAC-Randomizer Attribute and the responder 
										wishes to include an instance of the Message-Authentication-Code Attribute in the corresponding
										response, 
										then the MAC-Randomizer Attribute from the request MUST 
										be included in the response.	 
					 					<br />
<br />

 					 					If the Message-Authenticator-Code Attribute is included in a server response, the client SHOULD ignore the contents of 
                                        the Response Authenticator.										
  					 					
<blockquote class="text"><dl>
<dt>Implementation Notes</dt>
<dd>
											<br />

											When the hash is calculated, both the MAC field of the Message-Authenticator-Code attribute 
											and the String field of the Message-Authenticator Attribute (if any) MUST be considered to be zero-filled. 		
											<br />
<br />

		 			 						The Message-Authentication-Code Attribute MUST be created 
		 			 						and inserted in the packet
 											before the Response Authenticator is calculated.
											<br />
<br />

 											Implementations SHOULD provide a means to provision a key 
 											(cryptographically separate from the normal RADIUS shared secret)
 											to be used exclusively in the 
 											generation of the Message-Authentication-Code.
 					 					
</dd>
</dl></blockquote>
							
</dd>
</dl></blockquote>
							
</dd>
</dl></blockquote>
						

</blockquote><p>
						
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
IANA Considerations</h3>

<p>This document does not define any actions for IANA.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
			It is RECOMMENDED in this memo that
			two new keys, a key encrypting key and a message authentication key, be shared by the RADIUS client and server.
			If implemented, these two keys MUST be different from each other
			and SHOULD NOT be based on a password.  
			These two keys SHOULD be cryptographically 
			independent of the RADIUS shared secret used in 
			calculating the Response Authenticator <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>,
			Request Authenticator <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a> <a class='info' href='#RFC5176'>[RFC5176]<span> (</span><span class='info'>Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&rdquo; January&nbsp;2008.</span><span>)</span></a>
			and Message-Authenticator Attribute <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a>; otherwise if the shared secret is broken, all is lost.
			<br />
<br />

			To avoid the possibility of collisions, the same MAC key SHOULD NOT be used with more than 2^(n/2) messages, where 'n' is the length of the MAC value in octets.
			<br />
<br />

            If a packet that contains an instance of the Keying-Material Attribute also contains an instance of another, weaker key transport
			attribute (e.g., MS-MPPE-Recv-Key <a class='info' href='#RFC2548'>[RFC2548]<span> (</span><span class='info'>Zorn, G., &ldquo;Microsoft Vendor-specific RADIUS Attributes,&rdquo; March&nbsp;1999.</span><span>)</span></a>)
			encapsulating identical keying material, then breaking the weaker attribute
			might facilitate a known-plaintext attack against the KEK.
			
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Contributors</h3>

<p>
			Hao Zhou, Nancy Cam-Winget, Alex Lam, Paul Funk and
			John Fossaceca all contributed to this document.
			
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>
			Thanks (in no particular order) to Keith McCloghrie, Kaushik Narayan, Murtaza Chiba, Bill Burr, Russ Housley, David McGrew, 
			Pat Calhoun, Joel Halpern, Jim Schaad and Greg Weber for useful feedback.
			
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS.180-2.2002">[FIPS.180-2.2002]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">Secure Hash Standard</a>,&rdquo; FIPS&nbsp;PUB 180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST.SP800-38B">[NIST.SP800-38B]</a></td>
<td class="author-text">Dworkin, M., &ldquo;<a href="http://csrc.nist.gov/CryptoToolkit/modes/800-38_Series_Publications/SP800-38B.pdf">Recommendation for Block Cipher Modes of Operation: The CMAC Mode for Authentication</a>,&rdquo; May&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2866">[RFC2866]</a></td>
<td class="author-text">Rigney, C., &ldquo;<a href="http://tools.ietf.org/html/rfc2866">RADIUS Accounting</a>,&rdquo; RFC&nbsp;2866, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2866.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2868">[RFC2868]</a></td>
<td class="author-text">Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;<a href="http://tools.ietf.org/html/rfc2868">RADIUS Attributes for Tunnel Protocol Support</a>,&rdquo; RFC&nbsp;2868, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2868.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3394">[RFC3394]</a></td>
<td class="author-text">Schaad, J. and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc3394">Advanced Encryption Standard (AES) Key Wrap Algorithm</a>,&rdquo; RFC&nbsp;3394, September&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3394.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3579">[RFC3579]</a></td>
<td class="author-text">Aboba, B. and P. Calhoun, &ldquo;<a href="http://tools.ietf.org/html/rfc3579">RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3579, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4231">[RFC4231]</a></td>
<td class="author-text">Nystrom, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4231">Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512</a>,&rdquo; RFC&nbsp;4231, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4231.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5176">[RFC5176]</a></td>
<td class="author-text">Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc5176">Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;5176, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5176.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2548">[RFC2548]</a></td>
<td class="author-text"><a href="mailto:glennz@microsoft.com">Zorn, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2548">Microsoft Vendor-specific RADIUS Attributes</a>,&rdquo; RFC&nbsp;2548, March&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2548.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glen Zorn</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Zen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1463 East Republican Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">#358</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98112</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tiebing Zhang</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Advista Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5252 Orange Ave, Suite 108</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cypress, CA  90630</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (949) 242 0391</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tzhang@advistatech.com">tzhang@advistatech.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jesse Walker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Intel Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">JF3-206</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2111 N.E. 25th Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hillsboro, OR  97214-5961</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (503) 712-1849</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jesse.walker@intel.com">jesse.walker@intel.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 Third Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SEA1/6/</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (206) 256-3380</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
</table>
</body></html>
