<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>DRIP Authentication Formats</title>
<meta content="Adam Wiethuechter" name="author">
<meta content="Stuart Card" name="author">
<meta content="Robert Moskowitz" name="author">
<meta content="
       This document describes how to include trust into the ASTM Remote ID specification defined in ASTM F3411-19 under a Broadcast Remote ID (RID) scenario. It defines a few different message schemes (based on the Authentication Message) that can be used to assure past messages sent by a UA and also act as an assurance for UA trustworthiness in the absence of Internet connectivity at the receiving node. 
    " name="description">
<meta content="xml2rfc 3.5.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-drip-auth-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.2
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.25.1
    setuptools 51.0.0
    six 1.15.0
-->
<link href="/tmp/auth-e_520css.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">auth-formats</td>
<td class="right">December 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wiethuechter, et al.</td>
<td class="center">Expires 21 June 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DRIP Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-drip-auth-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-12-18" class="published">18 December 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-06-21">21 June 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Wiethuechter</div>
<div class="org">AX Enterprize, LLC</div>
</div>
<div class="author">
      <div class="author-name">S. Card</div>
<div class="org">AX Enterprize, LLC</div>
</div>
<div class="author">
      <div class="author-name">R. Moskowitz</div>
<div class="org">HTT Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">DRIP Authentication Formats</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes how to include trust into the ASTM Remote ID specification defined in ASTM F3411-19 under a Broadcast Remote ID (RID) scenario. It defines a few different message schemes (based on the Authentication Message) that can be used to assure past messages sent by a UA and also act as an assurance for UA trustworthiness in the absence of Internet connectivity at the receiving node.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 June 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-drip-requirements-addressed" class="xref">DRIP Requirements Addressed</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-required-terminology" class="xref">Required Terminology</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-problem-space-and-focus" class="xref">Problem Space and Focus</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-astm-authentication-message" class="xref">ASTM Authentication Message</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-drip-authentication-framing" class="xref">DRIP Authentication Framing Formats</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-drip-general-frame" class="xref">DRIP General Frame</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-drip-header" class="xref">DRIP Header</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-drip-authentication-data" class="xref">DRIP Authentication Data</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-forward-error-correction" class="xref">Forward Error Correction</a><a href="#section-toc.1-1.4.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-drip-wrapper-frame" class="xref">DRIP Wrapper Frame</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-ua-hierarchical-host-identi" class="xref">UA Hierarchical Host Identity Tag</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-trust-timestamp" class="xref">Trust Timestamp</a><a href="#section-toc.1-1.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-wrapped-authentication-data" class="xref">Wrapped Authentication Data</a><a href="#section-toc.1-1.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="xref">4.2.4</a>.  <a href="#name-wrapper-signature" class="xref">Wrapper Signature</a><a href="#section-toc.1-1.4.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-drip-attestation-frame" class="xref">DRIP Attestation Frame</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-attestation-data" class="xref">Attestation Data</a><a href="#section-toc.1-1.4.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-expiration-timestamp" class="xref">Expiration Timestamp</a><a href="#section-toc.1-1.4.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="xref">4.3.3</a>.  <a href="#name-attestation-signature" class="xref">Attestation Signature</a><a href="#section-toc.1-1.4.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-transport-methods-recommend" class="xref">Transport Methods &amp; Recommendations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-legacy-advertisements-bluet" class="xref">Legacy Advertisements (Bluetooth 4.X)</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-extended-advertisements-blu" class="xref">Extended Advertisements (Bluetooth 5.X and Wifi NaN)</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-astm-considerations" class="xref">ASTM Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-appendix-a-thoughts-on-astm" class="xref">Appendix A: Thoughts on ASTM Authentication Message</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">UA Systems (UAS) are usually in a volatile environment when it comes to communication. UA are generally small with little computational (or flying)  horsepower to carry standard communication equipment. This limits  the mediums of communication to few viable options.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Observer systems (e.g. smartphones and tablets) place further constraints on the communication options. The Remote ID Broadcast messages MUST be available to applications on these platforms without modifying the devices.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The ASTM standard <span>[<a href="#F3411-19" class="xref">F3411-19</a>]</span> focuses on two ways of communicating to a UAS for RID: Broadcast and Network.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document will focus on adding trust to Broadcast RID in the current (and an expanded) Authentication Message format.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="drip-requirements-addressed">
<section id="section-1.1">
        <h3 id="name-drip-requirements-addressed">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-drip-requirements-addressed" class="section-name selfRef">DRIP Requirements Addressed</a>
        </h3>
<p id="section-1.1-1">The following <span>[<a href="#drip-requirements" class="xref">drip-requirements</a>]</span> will be addressed:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">GEN 1: Provable Ownership</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">
  This will be addressed using the Certificate Message type (<a href="#drip-certificate" class="xref">Section 4.3.1.1</a>).<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3">GEN 2: Provable Binding</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">
  This requirement is addressed using the Wrapped ASTM Message (<a href="#wrapped-astm-messages" class="xref">Section 4.2.3.1.2</a>), Manifest Message (<a href="#manifests" class="xref">Section 4.2.3.2</a>) and Message Pack Signature (<a href="#message-pack-signature" class="xref">Section 4.2.3.1.1</a>) types.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.5">GEN 3: Provable Registration</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.6">
  This requirement is addressed using the Certificate Message type (<a href="#drip-certificate" class="xref">Section 4.3.1.1</a>).<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="required-terminology">
<section id="section-2.1">
        <h3 id="name-required-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-required-terminology" class="section-name selfRef">Required Terminology</a>
        </h3>
<p id="section-2.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-2.2">
        <h3 id="name-definitions">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<p id="section-2.2-1">See <span>[<a href="#drip-requirements" class="xref">drip-requirements</a>]</span> for common DRIP terms.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-2">
          <dt id="section-2.2-2.1">Aircraft:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">
  In this document whenever the word Aircraft is used it is referring to an Unmanned Aircraft (UA) not a Manned Aircraft.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="background">
<section id="section-3">
      <h2 id="name-background">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<div id="problem-space-and-focus">
<section id="section-3.1">
        <h3 id="name-problem-space-and-focus">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-problem-space-and-focus" class="section-name selfRef">Problem Space and Focus</a>
        </h3>
<p id="section-3.1-1">The current standard for Remote ID (RID) does not, in any meaningful capacity, address the concerns of trust in the UA space with communication in the Broadcast RID environment. This is a requirement that will need to be addressed eventually for various different parties that have a stake in the UA industry.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The following subsections will provide a high level reference to the ASTM standard for Authentication Messages and how their current limitations effect trust in the Broadcast RID environment.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="astm-authentication-message">
<section id="section-3.2">
        <h3 id="name-astm-authentication-message">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-astm-authentication-message" class="section-name selfRef">ASTM Authentication Message</a>
        </h3>
<span id="name-standard-astm-authenticatio"></span><div id="astm-auth">
<figure id="figure-1">
          <div class="artwork art-text alignCenter" id="section-3.2-1.1">
<pre>
Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  Auth Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               |               |
+-----------------------------------------------+               |
|                                                               |
|                                                               |
|                                                               |
|                Authentication Data / Signature                |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 1 - 4:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  Auth Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                Authentication Data / Signature                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Auth Header (1 byte):
    Contains Authentication Type (AuthType) and Page Number. For
    DRIP Authentication AuthType is a value of 0x5.

ASTM Authentication Headers: (6 bytes)
    Contains other header information for the Authentication
    Message from ASTM UAS RID Standard.

Authentication Data / Signature: (109 bytes: 17+23*4)
    Opaque authentication data.
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-standard-astm-authenticatio" class="selfRef">Standard ASTM Authentication Message format</a>
          </figcaption></figure>
</div>
<p id="section-3.2-2">The above diagram is the format defined by ASTM <span>[<a href="#F3411-19" class="xref">F3411-19</a>]</span> that is the frame which everything this document fits into. The specific details of the ASTM headers are abstracted away as they are not necessarily required for this document.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">There is a 25th byte exclude in the diagrams that comes before the Auth Header. This is the ASTM Header and consists of the Protocol Version and Message Type of the given message frame/page.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="drip-authentication-framing-formats">
<section id="section-4">
      <h2 id="name-drip-authentication-framing">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-drip-authentication-framing" class="section-name selfRef">DRIP Authentication Framing Formats</a>
      </h2>
<p id="section-4-1">Currently the ASTM AuthType of 0x5 should be used to denote DRIP based Authentication. The max page count of the Authentication Message is increased to 10, instead of being capped at 5.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">To keep consistent formatting across the different mediums (Bluetooth 4, Bluetooth 5 and Wifi NaN) and their independent restrictions the authentication data being sent is REQUIRED to fit within the first 9 pages of the Authentication Message. The final (10th) page of the message is reserved exclusively for Forward Error Correction bytes and is only present on Bluetooth 4.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="drip-general-frame">
<section id="section-4.1">
        <h3 id="name-drip-general-frame">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-drip-general-frame" class="section-name selfRef">DRIP General Frame</a>
        </h3>
<span id="name-drip-general-frame-format"></span><div id="drip-general">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-4.1-1.1">
<pre>
Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  Auth Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               |  DRIP Header  |
+-----------------------------------------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                    DRIP Authentication Data                   |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 1 - Page N-1:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  Auth Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                    DRIP Authentication Data                   |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page N:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  Auth Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                    Forward Error Correction                   |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

DRIP Header (1 byte):
       7     6     5     4     3     2     1     0
    +-----+-----+-----+-----+-----+-----+-----+-----+
    | FEC |              DRIP AuthType              |
    +-----+-----+-----+-----+-----+-----+-----+-----+

    FEC (1 bit):
        Enabled [1] or Disabled [0]. Signals if Page N is
        filled with XOR FEC.

    DRIP AuthType (7 bits):
        DRIP AuthType                        Values
        -------------                        ------
        0 Wrapped ASTM Message(s)            0
        1 Wrapped ASTM Message(s)            1
        2 Wrapped ASTM Message(s)            2
        3 Wrapped ASTM Message(s)            3
        4 Wrapped ASTM Message(s)            4
        5 Wrapped ASTM Message(s)            5
        8 Byte Manifest                      6
        4 Byte Manifest                      7
        Reserved (Wrapped Messages)          8-15
        Certificate: Registry on Aircraft    16
        Reserved (Certificates)              17-31
        Private Use                          32-63
        Reserved                             64-111
        Experimental Use                     112-127

DRIP Authentication Data (200 bytes):
    DRIP Authentication data. 0 to 200 bytes.

Forward Error Correction (23 bytes):
    Optional and signaled using DRIP Header. Always last
    Authentication page.
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-drip-general-frame-format" class="selfRef">DRIP General Frame Format</a>
          </figcaption></figure>
</div>
<div id="drip-header">
<section id="section-4.1.1">
          <h4 id="name-drip-header">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-drip-header" class="section-name selfRef">DRIP Header</a>
          </h4>
<p id="section-4.1.1-1">The DRIP Header is used to signal what kind of Authentication under DRIP that the message is using and consists of two fields.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<div id="forward-error-correction-bit-8">
<section id="section-4.1.1.1">
            <h5 id="name-forward-error-correction-bi">
<a href="#section-4.1.1.1" class="section-number selfRef">4.1.1.1. </a><a href="#name-forward-error-correction-bi" class="section-name selfRef">Forward Error Correction (Bit 8)</a>
            </h5>
<p id="section-4.1.1.1-1">The Most Significant Bit is used to signal if FEC is present in the final page of the Authentication Message. It MUST be set to 1 if FEC is being used. This is only enabled under Bluetooth 4 and MUST be set to 0 on Bluetooth 5 or Wifi NaN.<a href="#section-4.1.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="drip-authtype-bits-1-7">
<section id="section-4.1.1.2">
            <h5 id="name-drip-authtype-bits-1-7">
<a href="#section-4.1.1.2" class="section-number selfRef">4.1.1.2. </a><a href="#name-drip-authtype-bits-1-7" class="section-name selfRef">DRIP AuthType (Bits 1-7)</a>
            </h5>
<p id="section-4.1.1.2-1">The lower 7 bits are used as the DRIP AuthType field denoting what Authentication type is being used. There are 5 major areas carved out of the DRIP AuthType defined by the following bitmaps:<a href="#section-4.1.1.2-1" class="pilcrow">¶</a></p>
<span id="name-drip-header-bitmasks"></span><div id="header-bitmaps">
<figure id="figure-3">
              <div class="artwork art-text alignCenter" id="section-4.1.1.2-2.1">
<pre>
000 xxxx (0x00-0x0F): Wrapped Messages (16)
001 xxxx (0x10-0x1F): Certificates (16)
01x xxxx (0x20-0x3F): Private Use (32)
1xx xxxx (0x40-0x6F): Reserved (48)
111 xxxx (0x70-0x7F): Experimental Use (16)
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-drip-header-bitmasks" class="selfRef">DRIP Header Bitmasks</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="drip-authentication-data">
<section id="section-4.1.2">
          <h4 id="name-drip-authentication-data">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-drip-authentication-data" class="section-name selfRef">DRIP Authentication Data</a>
          </h4>
<p id="section-4.1.2-1">This field has a maximum size of 200 bytes. If the data is less than the max and a page is only partially filled then the rest of the partially filled page must be null padded.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">This section is generally filled with either the Wrapper Frame (<a href="#drip-wrapper-frame" class="xref">Section 4.2</a>) or the Attestation Frame (<a href="#drip-attestation-frame" class="xref">Section 4.3</a>).<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forward-error-correction">
<section id="section-4.1.3">
          <h4 id="name-forward-error-correction">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-forward-error-correction" class="section-name selfRef">Forward Error Correction</a>
          </h4>
<p id="section-4.1.3-1">To help Bluetooth (specifically Bluetooth 4) achieve the goal of reliable receipt of paged messages a Forward Error Correction (FEC) scheme is introduced and MUST be used for Legacy Advertising (Bluetooth 4) and MUST NOT be used for Extended Advertising (Bluetooth 5, Wifi NaN) under DRIP.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<div id="encoding">
<section id="section-4.1.3.1">
            <h5 id="name-encoding">
<a href="#section-4.1.3.1" class="section-number selfRef">4.1.3.1. </a><a href="#name-encoding" class="section-name selfRef">Encoding</a>
            </h5>
<p id="section-4.1.3.1-1">A compliant implementation of this standard MUST use XOR for the FEC. When generating the parity the first byte of every Authentication Page MUST be exclude from the XOR operation. For pages 1 through N this leaves the data portion of the page while page 0 will include a number of headers along with 17 bytes of data.<a href="#section-4.1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-2">To generate the parity a simple XOR operation using the previous and current page is used. For page 0, a 23 byte null pad is used for the previous page. The resulting 23 bytes of parity is appended in one full page (always the last) allowing for recovery when any single page is lost in transmission.<a href="#section-4.1.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decoding">
<section id="section-4.1.3.2">
            <h5 id="name-decoding">
<a href="#section-4.1.3.2" class="section-number selfRef">4.1.3.2. </a><a href="#name-decoding" class="section-name selfRef">Decoding</a>
            </h5>
<p id="section-4.1.3.2-1">Due to the nature of Bluetooth 4 and the existing ASTM paging structure an optimization can be used. If a Bluetooth frame fails its CRC check, then the frame is dropped without notification to the upper protocol layers. From the Remote ID perspective this means the loss of a complete frame/message/page. In Authentication Messages, each page is already numbered so the loss of a page allows  the receiving application to build a "dummy" page filling the Authentication Data field (and ASTM Authentication Headers fields if page 0) with nulls.<a href="#section-4.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-2">Using the same methods as encoding, an XOR operation is used between the previous and current page (a 23 byte null pad is used when page 0 is the current page). The resulting 23 bytes is the data of the missing page.<a href="#section-4.1.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-3">If page 0 is being reconstructed an additional check of the Page Count, to check against how many pages are actually present, MUST be performed for sanity. An additional check on the Data Length field can also be performed, but is not required.<a href="#section-4.1.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="limitations-recommendations">
<section id="section-4.1.3.3">
            <h5 id="name-limitations-recommendations">
<a href="#section-4.1.3.3" class="section-number selfRef">4.1.3.3. </a><a href="#name-limitations-recommendations" class="section-name selfRef">Limitations &amp; Recommendations</a>
            </h5>
<p id="section-4.1.3.3-1">If more than one page is lost (&gt;1/5 for 5 page messages, &gt;1/10 for 10 page messages) than the error rate of the link is already beyond saving and the application has more issues to deal with.<a href="#section-4.1.3.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.3-2">In theory under Bluetooth 4 up to 15 pages Authentication could be sent (9 pages reserved to Authentication and 6 pages reserved for Forward Error Correction). It is currently recommended however for a max of 10 pages total.<a href="#section-4.1.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="drip-wrapper-frame">
<section id="section-4.2">
        <h3 id="name-drip-wrapper-frame">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-drip-wrapper-frame" class="section-name selfRef">DRIP Wrapper Frame</a>
        </h3>
<p id="section-4.2-1">This format MUST be encapsulated by the General Frame (<a href="#drip-general-frame" class="xref">Section 4.1</a>) and reside in its data field (<a href="#drip-authentication-data" class="xref">Section 4.1.2</a>).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Typically the DRIP Header is set in the range of 0x00 through 0x0F (FEC disabled) or 0x80 through 0x8F (FEC enabled).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-drip-wrapper-frame-format"></span><div id="drip-wrapper">
<figure id="figure-4">
          <div class="artwork art-text alignCenter" id="section-4.2-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                                                               |
|                        UA Hierarchical                        |
|                       Host Identity Tag                       |
|                                                               |
+---------------+---------------+---------------+---------------+
|                         Trust Timestamp                       |
+---------------+---------------+---------------+---------------+
|                                                               |
.                                                               .
.                      Authentication Data                      .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                            Signature                          |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+

UA Hierarchial Host Identity Tag (16 bytes):
    The UAs HHIT in byte form. Hashed from the EdDSA25519
    public key.

Trust Timestamp (4 bytes):
    Timestamp denoting current time plus an offset to trust
    message to.

Authentication Data (116 bytes):
    Opaque authentication data using DRIP format specified in
    the DRIP Header. 0 to 116 bytes.

Signature (64 bytes):
    Signature over preceding fields using the EdDSA25519
    keypair of the UA.
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-drip-wrapper-frame-format" class="selfRef">DRIP Wrapper Frame Format</a>
          </figcaption></figure>
</div>
<div id="ua-hierarchical-host-identity-tag">
<section id="section-4.2.1">
          <h4 id="name-ua-hierarchical-host-identi">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-ua-hierarchical-host-identi" class="section-name selfRef">UA Hierarchical Host Identity Tag</a>
          </h4>
<p id="section-4.2.1-1">To avoid needing the UAs HHIT via the ASTM Basic ID in a detached fashion the 16 byte HHIT of the UA is included in the wrapper frame.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">The HHIT for the UA (and other entities in the RID and greater UTM system under DRIP) is an enhancement of the Host Identity Tag (HIT) <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span> introducing hierarchy (and how they are used in UAS RID) as defined in <span>[<a href="#drip-rid" class="xref">drip-rid</a>]</span>.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-timestamp">
<section id="section-4.2.2">
          <h4 id="name-trust-timestamp">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-trust-timestamp" class="section-name selfRef">Trust Timestamp</a>
          </h4>
<p id="section-4.2.2-1">The Trust Timestamp is of the format defined in <span>[<a href="#F3411-19" class="xref">F3411-19</a>]</span>. That is a UNIX timestamp offset by 01/01/2019 00:00:00. An additional offset is then added to push the timestamp a short time into the future to avoid replay attacks.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">When wrapping a Vector (Position/Location) Message the payload WILL contain (by ASTM rules) constantly changing data, this includes its own timestamp. This timestamp is only 2 bytes, which is easily attacked and only expresses the 1/10th of seconds since the last hour.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">Other ASTM message types, such as Basic ID and Self-ID are static messages with no changing data. To protect a replay of these signed messages the Trust Timestamp is the field during signing to be guaranteed to change.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">The offset used against the UNIX timestamp is not defined in this document. Best practices to identify a acceptable offset should be used taking into consideration the UA environment, and propagation characteristics of the messages being sent.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrapped-authentication-data">
<section id="section-4.2.3">
          <h4 id="name-wrapped-authentication-data">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-wrapped-authentication-data" class="section-name selfRef">Wrapped Authentication Data</a>
          </h4>
<p id="section-4.2.3-1">This field has a maximum of 116 bytes in length.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<div id="wrapped-astm-message-formats">
<section id="section-4.2.3.1">
            <h5 id="name-wrapped-astm-message-format">
<a href="#section-4.2.3.1" class="section-number selfRef">4.2.3.1. </a><a href="#name-wrapped-astm-message-format" class="section-name selfRef">Wrapped ASTM Message Formats</a>
            </h5>
<p id="section-4.2.3.1-1">When wrapping any ASTM Messages and filling the Wrapped Authentication Data field under DRIP the messages MUST be in Message Type order as defined by ASTM. All message types except Authentication (0x2) and Message Pack (0xF) are allowed.<a href="#section-4.2.3.1-1" class="pilcrow">¶</a></p>
<div id="message-pack-signature">
<section id="section-4.2.3.1.1">
              <h6 id="name-0-wrapped-astm-messages">
<a href="#section-4.2.3.1.1" class="section-number selfRef">4.2.3.1.1. </a><a href="#name-0-wrapped-astm-messages" class="section-name selfRef">0 Wrapped ASTM Message(s)</a>
              </h6>
<p id="section-4.2.3.1.1-1">This payload type MUST only be used under Extended Advertisement (Bluetooth 5.X and Wifi NaN).<a href="#section-4.2.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3.1.1-2">The Wrapped Authentication Data is the concatenation of all messages in the Message Pack (excluding Authentication) in Message Type order. No actual data payload is present in this format as the data is found outside the Authentication Message in the same Message Pack.<a href="#section-4.2.3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3.1.1-3">The DRIP Header is set to 0x00 (0).<a href="#section-4.2.3.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrapped-astm-messages">
<section id="section-4.2.3.1.2">
              <h6 id="name-1-to-4-wrapped-astm-message">
<a href="#section-4.2.3.1.2" class="section-number selfRef">4.2.3.1.2. </a><a href="#name-1-to-4-wrapped-astm-message" class="section-name selfRef">1 to 4 Wrapped ASTM Message(s)</a>
              </h6>
<p id="section-4.2.3.1.2-1">This payload type can be used on either Legacy or Extended Advertisements.<a href="#section-4.2.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3.1.2-2">The DRIP Header is set to 0x81-0x84 (129-134) when using Legacy Advertisements (FEC is enabled) and 0x01-0x04 (1-4) when using Extended Advertisements (FEC is disabled).<a href="#section-4.2.3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="legacy-message-pack">
<section id="section-4.2.3.1.3">
              <h6 id="name-5-wrapped-astm-messages">
<a href="#section-4.2.3.1.3" class="section-number selfRef">4.2.3.1.3. </a><a href="#name-5-wrapped-astm-messages" class="section-name selfRef">5 Wrapped ASTM Message(s)</a>
              </h6>
<p id="section-4.2.3.1.3-1">Editors Note: This payload type does not currently fit in the 116 byte limit of the Wrapper Frame. If the ASTM relaxes the Max Page Count limit for Legacy Advertisements to use all 15 pages then this is possible.<a href="#section-4.2.3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3.1.3-2">This payload type MUST only be used on Legacy Advertisements (Bluetooth 4.X). It requires 11 pages to complete.<a href="#section-4.2.3.1.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3.1.3-3">The DRIP Header is set to 0x85 (133).<a href="#section-4.2.3.1.3-3" class="pilcrow">¶</a></p>
<p id="section-4.2.3.1.3-4">This payload type allows in Legacy Advertisements to have a pseudo-Message Pack like what is found in Extended Advertisements.<a href="#section-4.2.3.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="limitations">
<section id="section-4.2.3.1.4">
              <h6 id="name-limitations">
<a href="#section-4.2.3.1.4" class="section-number selfRef">4.2.3.1.4. </a><a href="#name-limitations" class="section-name selfRef">Limitations</a>
              </h6>
<p id="section-4.2.3.1.4-1">When wrapping a single ASTM Message the 25 byte payload actually causes an inefficiency in the framing format, create a whole page unused except for a single byte. This can be optimized by removing a single byte out of the wrapped message but creates an issue on the receiver of knowing which byte was removed.<a href="#section-4.2.3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3.1.4-2">When sending a Location Message (Message Type 0x1) a single byte can be removed at the end of the message as it is currently unused. Many other messages in the ASTM Message set however do not have this ability. The first byte can not be removed as it is the key to know how to decode the message.<a href="#section-4.2.3.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="manifests">
<section id="section-4.2.3.2">
            <h5 id="name-manifests">
<a href="#section-4.2.3.2" class="section-number selfRef">4.2.3.2. </a><a href="#name-manifests" class="section-name selfRef">Manifests</a>
            </h5>
<p id="section-4.2.3.2-1">Manifests fill the Wrapped Authentication Data field with hashes of previously send messages.<a href="#section-4.2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3.2-2">By hashing previously sent messages and signing them we gain trust in UAs previous reports. An observer who has been listening for any considerable length of time can hash received messages and cross check against listed hashes.<a href="#section-4.2.3.2-2" class="pilcrow">¶</a></p>
<div id="hash-algorithm-and-operation">
<section id="section-4.2.3.2.1">
              <h6 id="name-hash-algorithm-and-operatio">
<a href="#section-4.2.3.2.1" class="section-number selfRef">4.2.3.2.1. </a><a href="#name-hash-algorithm-and-operatio" class="section-name selfRef">Hash Algorithm and Operation</a>
              </h6>
<p id="section-4.2.3.2.1-1">The hash algorithm used for the Manifest Message is the same hash algorithm used in creation of the HHIT that is signing the Manifest.<a href="#section-4.2.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3.2.1-2">A standard HHIT would be using cSHAKE128 from <span>[<a href="#NIST.SP.800-185" class="xref">NIST.SP.800-185</a>]</span>. With cSHAKE128, the hash is computed as follows:<a href="#section-4.2.3.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2.3.2.1-3">
<pre>
cSHAKE128(MAC Address|Message, 8*H-Len, "", "RemoteID Auth Hash")
</pre><a href="#section-4.2.3.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.3.2.1-4">The message MAC Address of the transmitter is prepended to the message, as the MAC Address is the only information that links UA messages from a specific UA.<a href="#section-4.2.3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.3.2.1-5">Editors Note: It should be noted that for Bluetooth mediums this is valid - however Wifi NaN does not give the receiver device the transmitters MAC Address - making this impossible. Either MAC Address should be removed entirely or something different be used in its place to link to a given UA. Thanks Soren Friis for pointing this out.<a href="#section-4.2.3.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="byte">
<section id="section-4.2.3.2.2">
              <h6 id="name-8-byte">
<a href="#section-4.2.3.2.2" class="section-number selfRef">4.2.3.2.2. </a><a href="#name-8-byte" class="section-name selfRef">8 Byte</a>
              </h6>
<span id="name-4-byte-manifest"></span><figure id="figure-5">
                <div class="artwork art-text alignCenter" id="section-4.2.3.2.2-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                   Hash of Previous Manifest                   |
|                                                               |
+---------------+---------------+---------------+---------------+
|                    Hash of Current Manifest                   |
|                                                               |
+---------------+---------------+---------------+---------------+
|                         Message Hash 1                        |
|                                                               |
+---------------+---------------+---------------+---------------+
|                         Message Hash 2                        |
|                                                               |
+---------------+---------------+---------------+---------------+
.                                                               .
.                                                               .
.                                                               .
+---------------+---------------+---------------+---------------+
|                        Message Hash 12                        |
|                                                               |
+---------------+---------------+---------------+---------------+

DRIP Header:
    With FEC: 0x87 [135] (RECOMMENDED)
    Without FEC: 0x07 [7]

Hash of Previous Manifest: (8 bytes)
    A hash of the previously sent Authentication message.

Hash of Current Manifest: (8 bytes)
    A hash of the current Authentication message.

Message Hash: (8 bytes)
    A hash of a previously sent message. 12 max.
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-4-byte-manifest" class="selfRef">4 Byte Manifest</a>
                </figcaption></figure>
</section>
</div>
<div id="byte-1">
<section id="section-4.2.3.2.3">
              <h6 id="name-4-byte">
<a href="#section-4.2.3.2.3" class="section-number selfRef">4.2.3.2.3. </a><a href="#name-4-byte" class="section-name selfRef">4 Byte</a>
              </h6>
<span id="name-4-byte-manifest-2"></span><figure id="figure-6">
                <div class="artwork art-text alignCenter" id="section-4.2.3.2.3-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                   Hash of Previous Manifest                   |
+---------------+---------------+---------------+---------------+
|                    Hash of Current Manifest                   |
+---------------+---------------+---------------+---------------+
|                         Message Hash 1                        |
+---------------+---------------+---------------+---------------+
|                         Message Hash 2                        |
+---------------+---------------+---------------+---------------+
.                                                               .
.                                                               .
.                                                               .
+---------------+---------------+---------------+---------------+
|                        Message Hash 27                        |
+---------------+---------------+---------------+---------------+

DRIP Header:
    With FEC: 0x86 [132] (RECOMMENDED)
    Without FEC: 0x06 [6]

Hash of Previous Manifest: (4 bytes)
    A hash of the previously sent Authentication message.

Hash of Current Manifest: (4 bytes)
    A hash of the current Authentication message.

Message Hash: (4 bytes)
    A hash of a previously sent message. 27 max.
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-4-byte-manifest-2" class="selfRef">4 Byte Manifest</a>
                </figcaption></figure>
</section>
</div>
<div id="pseudo-blockchain-hashes">
<section id="section-4.2.3.2.4">
              <h6 id="name-pseudo-blockchain-hashes">
<a href="#section-4.2.3.2.4" class="section-number selfRef">4.2.3.2.4. </a><a href="#name-pseudo-blockchain-hashes" class="section-name selfRef">Pseudo-Blockchain Hashes</a>
              </h6>
<p id="section-4.2.3.2.4-1">Two special hashes are included in all Manifest messages; a previous manifest hash, which links to the previous manifest message, as well as a current manifest hash. This gives a pseudo-blockchain provenance to the manifest message that could be traced back if the observer was present for extended periods of time.<a href="#section-4.2.3.2.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.3.2.4-2">
                <dt id="section-4.2.3.2.4-2.1">Creation:</dt>
                <dd style="margin-left: 1.5em" id="section-4.2.3.2.4-2.2">
  During creation and signing of this message format this field MUST be set to 0. So the signature will be based on this field being 0, as well as its own hash. It is an open question of if we compute the hash, then sign or sign then compute.<a href="#section-4.2.3.2.4-2.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-4.2.3.2.4-2.3">Cycling:</dt>
                <dd style="margin-left: 1.5em" id="section-4.2.3.2.4-2.4">
  There a few different ways to cycle this message. We can "roll up" the hash of 'current' to 'previous' when needed or to completely recompute the hash. This mostly depends on the previous note.<a href="#section-4.2.3.2.4-2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-limitation">
<section id="section-4.2.3.2.5">
              <h6 id="name-manifest-limitation">
<a href="#section-4.2.3.2.5" class="section-number selfRef">4.2.3.2.5. </a><a href="#name-manifest-limitation" class="section-name selfRef">Manifest Limitation</a>
              </h6>
<p id="section-4.2.3.2.5-1">A potential limitation to this format is dwell time of the UA. If the UA is not sticking to a general area then most likely the Observer will not obtain many (if not all) of the messages in the manifest. Without the original messages received no verification can be done. Examples of such scenarios include delivery or survey UA.<a href="#section-4.2.3.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="wrapper-signature">
<section id="section-4.2.4">
          <h4 id="name-wrapper-signature">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-wrapper-signature" class="section-name selfRef">Wrapper Signature</a>
          </h4>
<p id="section-4.2.4-1">The wrapper signature is generated using the private key half of the the UAs Host Identity (HI) and is done over all preceding data. ASTM/DRIP Headers are exclude from this operation only information within the Wrapper Fame (<a href="#drip-wrapper-frame" class="xref">Section 4.2</a>) is signed.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="drip-attestation-frame">
<section id="section-4.3">
        <h3 id="name-drip-attestation-frame">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-drip-attestation-frame" class="section-name selfRef">DRIP Attestation Frame</a>
        </h3>
<p id="section-4.3-1">This format MUST be encapsulated by the General Frame (<a href="#drip-general-frame" class="xref">Section 4.1</a>) and reside in its data field (<a href="#drip-authentication-data" class="xref">Section 4.1.2</a>).<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">This format is typically used to form a complete certificate using attestation data from a Registry defined in <span>[<a href="#identity-claims" class="xref">identity-claims</a>]</span>. The DRIP Header is normally in the range of 0x10 through 0x1F (FEC disable) or 0x90 through 0x9F (FEC enabled).<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<span id="name-drip-attestation-format"></span><div id="attestation-format">
<figure id="figure-7">
          <div class="artwork art-text alignCenter" id="section-4.3-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                                                               |
.                                                               .
.                        Attestation Data                       .
.                                                               .
|                                                               |
+---------------+---------------+---------------+---------------+
|                      Expiration Timestamp                     |
+---------------+---------------+---------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                            Signature                          |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------+---------------+---------------+---------------+

Attestation Data: (up to 132 bytes):
    Data the UA asserts claim to.
    Up to 132 bytes in length.

Expiration Timestamp (4 bytes):
    Generated by the UA to protect against replay attacks.

Signature (64 bytes):
    Signature over preceding fields using the EdDSA25519
    keypair of the UA.
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-drip-attestation-format" class="selfRef">DRIP Attestation Format</a>
          </figcaption></figure>
</div>
<div id="attestation-data">
<section id="section-4.3.1">
          <h4 id="name-attestation-data">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-attestation-data" class="section-name selfRef">Attestation Data</a>
          </h4>
<p id="section-4.3.1-1">Any data up to 132 bytes in length that the UA wishes to assert truth to.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div id="drip-certificate">
<section id="section-4.3.1.1">
            <h5 id="name-drip-certificate">
<a href="#section-4.3.1.1" class="section-number selfRef">4.3.1.1. </a><a href="#name-drip-certificate" class="section-name selfRef">DRIP Certificate</a>
            </h5>
<p id="section-4.3.1.1-1">This payload type can be used in either Legacy or Extended Advertising. It is used to grant the ability to authenticate UA Remote ID when the receiving device of the observer (e.g. a smartphone with a dedicated RID application) has no Internet service (e.g. LTE signal).<a href="#section-4.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-2">The DRIP Header is set to 0x90 (144) when used for Legacy Advertisements and 0x10 (16) for Extended Advertisements.<a href="#section-4.3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-3">The Attestation Data field is filled with the Attestation: Registry on Aircraft (Section 3.2.2 Attestation: X on Y (Offline Form) from <span>[<a href="#identity-claims" class="xref">identity-claims</a>]</span>). This is binding claim between the Registry and the Aircraft, asserting the relationship between the two entities. It also provides the UA Host Identity to allow signature verification of messages signed by the UA. Also included in its structure is the HHIT of the Registry to check the local shortlist of Registries that the Observer device trusts (mapping HHITs to HIs).<a href="#section-4.3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-4">More details about this Attestation and other certificates and the provisioning process can be found in <span>[<a href="#identity-claims" class="xref">identity-claims</a>]</span>.<a href="#section-4.3.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="expiration-timestamp">
<section id="section-4.3.2">
          <h4 id="name-expiration-timestamp">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-expiration-timestamp" class="section-name selfRef">Expiration Timestamp</a>
          </h4>
<p id="section-4.3.2-1">Generated by the UA during the creation of the Authentication message. It is set a short time into the future to protect against replay attacks of this DRIP format.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">It shares the same format as the Trust Timestamp (<a href="#trust-timestamp" class="xref">Section 4.2.2</a>).<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attestation-signature">
<section id="section-4.3.3">
          <h4 id="name-attestation-signature">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-attestation-signature" class="section-name selfRef">Attestation Signature</a>
          </h4>
<p id="section-4.3.3-1">Performed by the UA using the onboard keypair which matches the HHIT in the Basic ID Message (0x0).<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="transport-methods-recommendations">
<section id="section-5">
      <h2 id="name-transport-methods-recommend">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-transport-methods-recommend" class="section-name selfRef">Transport Methods &amp; Recommendations</a>
      </h2>
<div id="legacy-advertisements-bluetooth-4x">
<section id="section-5.1">
        <h3 id="name-legacy-advertisements-bluet">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-legacy-advertisements-bluet" class="section-name selfRef">Legacy Advertisements (Bluetooth 4.X)</a>
        </h3>
<p id="section-5.1-1">With Legacy Advertisements the goal is to attempt to bring reliable receipt of the paged Authentication Message. Forward Error Correction (<a href="#forward-error-correction" class="xref">Section 4.1.3</a>) MUST be enabled when using Legacy Advertising methods (such as Bluetooth 4.X).<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Under ASTM Bluetooth 4.X rules, transmission of dynamic messages are at least every 1 second while static messages (which is what Authentication is classified under) are sent at least every 3 seconds.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Under DRIP the Certificate Message MUST be transmitted to properly meet the GEN 1 and GEN 3 requirement.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The ASTM Message Wrapper and Manifest both satisfy the GEN 2 requirement. At least one MUST be implemented to comply with the GEN 2 requirement.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">A single Manifest can carry at most (using the full 10 page limit and 8 byte hashes) 12 unique hashes of previously sent messages (of any type). This results in a total of 22 (12 + 10) frames of Bluetooth data being transmitted over Bluetooth.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">In comparison the Message Wrapper sends 6 pages (each a single frame) for each  wrapped message. For backwards compatibility the implementation should also send the standard ASTM message that was wrapped for non-DRIP compliant receivers to obtain. This method results in 84 total Bluetooth frames (12 + (12 * 6)) sent.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">The question of which is better suited is up to the implementation.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extended-advertisements-bluetooth-5x-and-wifi-nan">
<section id="section-5.2">
        <h3 id="name-extended-advertisements-blu">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-extended-advertisements-blu" class="section-name selfRef">Extended Advertisements (Bluetooth 5.X and Wifi NaN)</a>
        </h3>
<p id="section-5.2-1">Under the ASTM specification, Bluetooth 5 or Wifi NaN transport of Remote ID is to use the Message Pack (Type 0xF) format for all transmissions. Under Message Pack all messages are sent together (in Message Type order) in a single Bluetooth frame (up to 9 single frame equivalent messages). Message Packs are required by ASTM to be sent at a rate of 1 per second (like dynamic messages).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Without any fragmentation or loss of pages with transmission Forward Error Correction (<a href="#forward-error-correction" class="xref">Section 4.1.3</a>) MUST NOT be used as it is impractical.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="astm-considerations">
<section id="section-6">
      <h2 id="name-astm-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-astm-considerations" class="section-name selfRef">ASTM Considerations</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-6-1.1">Increase Authentication Max Page Count from 5 to 10. Legacy Advertising can use all 10 while Extended Advertising has a maximum of 9 due to Bluetooth 5 limitations.<a href="#section-6-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-1.2">Allocate Authentication Type 0x5 for DRIP from ASTM AuthType field.<a href="#section-6-1.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document does not require any actions by IANA.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">TODO<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">(Ed. Note: Hash lengths (length vs strength/collision rate); replay attacks with timestamps; static Cra (issue but nulled if UA signing other stuff dynamically meaning signatures will fail as HI won't match - this is probably a deeper discussion topic for provisioning security considerations when we get to there))<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-9">
      <h2 id="name-acknowledgments">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-9-1">Ryan Quigley and James Mussi of AX Enterprize, LLC for early prototyping to find holes in the draft specifications.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appendix-a-thoughts-on-astm-authentication-message">
<section id="section-10">
      <h2 id="name-appendix-a-thoughts-on-astm">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-appendix-a-thoughts-on-astm" class="section-name selfRef">Appendix A: Thoughts on ASTM Authentication Message</a>
      </h2>
<p id="section-10-1">The format standardized by the ASTM is designed with a few major considerations in mind, which the authors of this document feel put significant limitations on the expansion of the standard.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The primary consideration (in this context) is the use of the Bluetooth 5.X Extended Frame format. This method allows for a 255 byte payload to be sent in what the ASTM refers to as a "Message Pack".<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">The idea is to include up to five standard ASTM Broadcast RID messages (each of which are 25 bytes) plus a single authentication message (5 pages of 25 bytes each) in the Message Pack. The reasoning is then the Authentication Message is for the entire Message Pack.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">The authors have no issues with this proposed approach; this is a valid format to use for the Authentication Message provided by the ASTM. However, by limiting the Authentication Message to ONLY five pages in the standard it ignores the possibility of other formatting options to be created and used.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">Another issue with this format, not fully addressed in this document is fragmentation. Under Bluetooth 4.X, each page is sent separately which can result in lose of pages on the receiver. This is disastrous as the loss of even a single page means any signature is incomplete.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">With the current limitation of 5 pages, Forward Error Correction (FEC) is nearly impossible without sacrificing the amount of data sent. More pages would allow FEC to be performed on the Authentication Message pages so loss of pages can be mitigated.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">All these problems are further amplified by the speed at which UA fly and the Observer's position to receive transmissions. There is no guarantee that the Observer will receive all the pages of even a 5 page Authentication Message in the time it takes a UA to traverse across their line of sight. Worse still is that is not including other UA in the area, which congests the spectrum and could cause further confusion attempting to collate messages from various UA. This specific problem is out of scope for this document and our solutions in general, but should be noted as a design consideration.<a href="#section-10-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="F3411-19">[F3411-19]</dt>
        <dd>
<span class="refTitle">"Standard Specification for Remote ID and Tracking"</span>, <time datetime="2020-02" class="refDate">February 2020</time>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-185">[NIST.SP.800-185]</dt>
        <dd>
<span class="refAuthor">Kelsey, J.</span><span class="refAuthor">, Change, S.</span><span class="refAuthor">, and R. Perlner</span>, <span class="refTitle">"SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash"</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-185</span>, <span class="seriesInfo">NIST Special Publication SP 800-185</span>, <time datetime="2016-12" class="refDate">December 2016</time>, <span>&lt;<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="drip-requirements">[drip-requirements]</dt>
        <dd>
<span class="refAuthor">Card, S.</span><span class="refAuthor">, Wiethuechter, A.</span><span class="refAuthor">, Moskowitz, R.</span><span class="refAuthor">, and A. Gurtov</span>, <span class="refTitle">"Drone Remote Identification Protocol (DRIP) Requirements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-drip-reqs-06</span>, <time datetime="2020-11-01" class="refDate">1 November 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-drip-reqs-06.txt">http://www.ietf.org/internet-drafts/draft-ietf-drip-reqs-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="drip-rid">[drip-rid]</dt>
        <dd>
<span class="refAuthor">Moskowitz, R.</span><span class="refAuthor">, Card, S.</span><span class="refAuthor">, Wiethuechter, A.</span><span class="refAuthor">, and A. Gurtov</span>, <span class="refTitle">"UAS Remote ID"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-drip-uas-rid-01</span>, <time datetime="2020-09-09" class="refDate">9 September 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-drip-uas-rid-01.txt">http://www.ietf.org/internet-drafts/draft-ietf-drip-uas-rid-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="identity-claims">[identity-claims]</dt>
        <dd>
<span class="refAuthor">Wiethuechter, A.</span><span class="refAuthor">, Card, S.</span><span class="refAuthor">, and R. Moskowitz</span>, <span class="refTitle">"DRIP Identity Claims"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-wiethuechter-drip-identity-claims-03</span>, <time datetime="2020-11-02" class="refDate">2 November 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-wiethuechter-drip-identity-claims-03.txt">http://www.ietf.org/internet-drafts/draft-wiethuechter-drip-identity-claims-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7401">[RFC7401]</dt>
      <dd>
<span class="refAuthor">Moskowitz, R., Ed.</span><span class="refAuthor">, Heer, T.</span><span class="refAuthor">, Jokela, P.</span><span class="refAuthor">, and T. Henderson</span>, <span class="refTitle">"Host Identity Protocol Version 2 (HIPv2)"</span>, <span class="seriesInfo">RFC 7401</span>, <span class="seriesInfo">DOI 10.17487/RFC7401</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7401">https://www.rfc-editor.org/info/rfc7401</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adam Wiethuechter</span></div>
<div dir="auto" class="left"><span class="org">AX Enterprize, LLC</span></div>
<div dir="auto" class="left"><span class="street-address">4947 Commercial Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:adam.wiethuechter@axenterprize.com" class="email">adam.wiethuechter@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stuart Card</span></div>
<div dir="auto" class="left"><span class="org">AX Enterprize, LLC</span></div>
<div dir="auto" class="left"><span class="street-address">4947 Commercial Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stu.card@axenterprize.com" class="email">stu.card@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robert Moskowitz</span></div>
<div dir="auto" class="left"><span class="org">HTT Consulting</span></div>
<div dir="auto" class="left">
<span class="locality">Oak Park</span>, <span class="region">MI</span> <span class="postal-code">48237</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rgm@labs.htt-consult.com" class="email">rgm@labs.htt-consult.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
