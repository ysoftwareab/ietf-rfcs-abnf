



Network Working Group                                         P. Pfister
Internet-Draft                                              IJ. Wijnands
Intended status: Standards Track                               S. Venaas
Expires: January 8, 2017                                   Cisco Systems
                                                             M. Stenberg
                                                            July 7, 2016


 BIER Ingress Multicast Flow Overlay using Multicast Listener Discovery
                               Protocols
                       draft-pfister-bier-mld-01

Abstract

   This document specifies the ingress part of a multicast flow overlay
   for BIER networks.  Using existing multicast listener discovery
   protocols, it enables multicast membership information sharing from
   egress routers, acting as listeners, toward ingress routers, acting
   as queriers.  Ingress routers keep per-egress-router state, used to
   construct the BIER bit mask associated with IP multicast packets
   entering the BIER domain.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 8, 2017.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents



Pfister, et al.          Expires January 8, 2017                [Page 1]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  Applicability Statement . . . . . . . . . . . . . . . . . . .   4
   5.  Querier and Listener Specifications . . . . . . . . . . . . .   4
     5.1.  Configuration Parameters  . . . . . . . . . . . . . . . .   4
     5.2.  MLDv2 instances.  . . . . . . . . . . . . . . . . . . . .   5
       5.2.1.  Sending Queries . . . . . . . . . . . . . . . . . . .   5
       5.2.2.  Sending Reports . . . . . . . . . . . . . . . . . . .   6
       5.2.3.  Receiving Queries . . . . . . . . . . . . . . . . . .   6
       5.2.4.  Receiving Reports . . . . . . . . . . . . . . . . . .   6
     5.3.  Packet Forwarding . . . . . . . . . . . . . . . . . . . .   7
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   7
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   7
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .   8
     8.2.  Informative References  . . . . . . . . . . . . . . . . .   8
   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   The Bit Index Explicit Replication (BIER -
   [I-D.ietf-bier-architecture]) forwarding technique enables IP
   multicast transport across a BIER domain.  When receiving or
   originating a packet, ingress routers have to construct a bit mask
   indicating which BIER egress routers located within the same BIER
   domain will receive the packet.  A stateless approach would consist
   in forwarding all incoming packets toward all egress routers, which
   would in turn make a forwarding decision based on local information.
   But any more efficient approach would require ingress routers to keep
   some state about egress routers multicast membership information,
   hence requiring state sharing from egress routers toward ingress
   routers.

   This document specifies how to use the Multicast Listener Discovery
   protocol version 2 [RFC3810] (resp. the Internet Group Management
   protocol version 3 [RFC3376]) as the ingress part of a BIER multicast
   flow overlay (BIER layering is described in
   [I-D.ietf-bier-architecture]) for IPv6 (resp.  IPv4).  It enables



Pfister, et al.          Expires January 8, 2017                [Page 2]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


   multicast membership information sharing from egress routers, acting
   as listeners, toward ingress routers, acting as queriers.  Ingress
   routers keep per-egress-router state, used to construct the BIER bit
   mask associated with IP multicast packets entering the BIER domain.

   This specification is applicable to both IP version 4 and version 6.
   It therefore specifies two separate mechanisms operating
   independently.  For the sake of simplicity, the rest of this document
   uses IPv6 terminology.  It can be applied to IPv4 by replacing
   'MLDv2' with 'IGMPv3', and following specific requirements when
   explicitly stated.

2.  Terminology

   In this document, the key words "MAY", "MUST", "MUST NOT",
   "RECOMMENDED", and "SHOULD", are to be interpreted as described in
   [RFC2119].

   The terms "Bit-Forwarding Router" (BFR), "Bit-Forwarding Egress
   Router" (BFER), "Bit-Forwarding Ingress Router" (BFIR), "BFR-id" and
   "BFR-Prefix" are to be interpreted as described in
   [I-D.ietf-bier-architecture].

   Additionally, the following definitions are used:

   BIER Multicast Listener Discovery (BMLD):  The modified version of
      MLD specified in this document.

   BMLD Querier:  A BFR implementing the Querier part of this
      specification.  A BMLD Node MAY be both a Querier and a Listener.

   BMLD Listener:  A BFR implementing the Listener part of this
      specification.  A BMLD Node MAY be both a Querier and a Listener.

3.  Overview

   This document proposes to use the mechanisms described in MLDv2 in
   order to enable multicast membership information sharing from BFERs
   toward BFIRs within a given BIER domain.  BMLD queries (resp.
   reports) are sent over BIER toward all BMLD Nodes (resp.  BMLD
   Queriers) using modified MLDv2 messages which IP destination is set
   to a configured 'all BMLD Nodes' (resp. 'all BMLD Queriers') IP
   multicast address.

   By running MLDv2 instances with per-listener explicit tracking, BMLD
   Queriers are able to map BMLD Listeners with MLDv2 membership states.
   This state is then used to construct the set of BFERs associated with
   each incoming IP multicast data packet.



Pfister, et al.          Expires January 8, 2017                [Page 3]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


4.  Applicability Statement

   BMLD runs on top of a BIER Layer and provides the ingress part of a
   BIER multicast flow overlay, i.e, it specifies how BFIRs construct
   the set of BFERs for each ingress IP multicast data packet.  The BFER
   part of the Multicast Flow Overlay is out of scope of this document.

   The BIER Layer MUST be able to transport BMLD messages toward all
   BMLD Queriers and Listeners.  Such packets are IP multicast packets
   with a BFR-Prefix as source address, a multicast destination address,
   and containing a MLDv2 message.

   BMLD only requires state to be kept by Queriers, and is therefore
   more scalable than PIMv2 [RFC7761] in terms of overall state, but is
   also likely to be less scalable than PIMv2 in terms of the amount of
   control traffic and the size of the state that is kept by individual
   routers.

   This specification is applicable to both IP version 4 and version 6.
   It therefore specifies two separate mechanisms operating
   independently.  For the sake of simplicity, this document uses IPv6
   terminology.  It can be applied to IPv4 by replacing 'MLDv2' with
   'IGMPv3', and following specific requirements when explicitly stated.

5.  Querier and Listener Specifications

   Routers desiring to receive IP multicast traffic (e.g., for their own
   use, or for forwarding) MUST behave as BMLD Listeners.  Routers
   receiving IP multicast traffic from outside the BIER domain, or
   originating multicast traffic, MUST behave as BMLD Queriers.

   BMLD Queriers (resp.  BMLD Listeners) MUST act as MLDv2 Queriers
   (resp.  MLDv2 Listeners) as specified in [RFC3810] unless stated
   otherwise in this section.

5.1.  Configuration Parameters

   Both Queriers and Listeners MUST operate as BFIRs and BFERs within
   the BIER domain in order to send and receive BMLD messages.  They
   MUST therefore be configured accordingly, as specified in
   [I-D.ietf-bier-architecture].

   All Listeners MUST be configured with a 'all BMLD Queriers' multicast
   address and the BFR-ids of all the BMLD Queriers.  This is used by
   Listeners to send BMLD Reports over BIER toward all Queriers.

   All Queriers MUST be configured with a 'all BMLD Nodes' multicast
   address and the BFR-ids of all the Queriers and Listeners.  This



Pfister, et al.          Expires January 8, 2017                [Page 4]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


   information is used by Queriers to send BMLD queries over BIER toward
   all BMLD Nodes.

   Note that BMLD (unlike MLDv2) makes use of per-instance configured
   multicast group addresses rather than well-known addresses so that
   multiple instances of BMLD (using different group addresses) can be
   run simultaneously within the same BIER domain.  Configured group
   addresses MAY be obtained from allocated IP prefixes using [RFC3306].

   IP packets coming from outside of the BIER domain and having a
   destination address set to the configured 'all BMLD Queriers' or the
   'all BMLD Nodes' group address MUST be dropped.  It is RECOMMENDED
   that these configured addresses have a limited scope, enforcing this
   behavior by scope-based filtering on BIER domain's egress interfaces.

5.2.  MLDv2 instances.

   BMLD Queriers MUST run a MLDv2 Querier instance with per-host
   tracking, which means they keep track of the MLDv2 state associated
   with each BMLD Listener.  For that purpose, Listeners are identified
   by their respective BFR-Prefix, used as IP source address in all BMLD
   reports.

   BMLD Listeners MUST run a MLDv2 Listener instance expressing their
   interest in the multicast traffic they are supposed to receive for
   local use or forwarding.

   BMLD Listeners and Queriers MUST NOT run the MLDv1 (IGMPv2 and IGMPv1
   for IPv4) backward compatibility procedures.

5.2.1.  Sending Queries

   BMLD Queries are IP packets sent over BIER by BMLD Queriers:

   o  Toward all BMLD Nodes (i.e., providing to the BIER Layer the BFR-
      ids of all BMLD Nodes).

   o  Without the IPv6 router alert option [RFC2711] in the hop-by-hop
      extension header [RFC2460] (or the IPv4 router alert option
      [RFC2113] for IPv4).

   o  With the IP destination address set to the 'all BMLD Nodes' group
      address.

   o  With the IP source address set to the BFR-Prefix of the sender.

   o  With a TTL value great enough such that the packet can be received
      by all BMLD Nodes, depending on the underlying BIER layer (whether



Pfister, et al.          Expires January 8, 2017                [Page 5]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


      it decrements the IP TTL or not) and the size of the network.  The
      default value is 64.

5.2.2.  Sending Reports

   BMLD Reports are IP packets sent over BIER by BMLD Listeners:

   o  Toward all BMLD Queriers (i.e., providing to the BIER layer the
      BFR-ids of all BMLD Queriers).

   o  Without the IPv6 router alert option [RFC2711] in the hop-by-hop
      extension header [RFC2460] (or the IPv4 router alert option
      [RFC2113] for IPv4).

   o  With the IP destination address set to the 'all BMLD Queriers'
      group address.

   o  With the IP source address set to the BFR-Prefix of the sender.

   o  With a TTL value great enough such that the packet can be received
      by all BMLD Queriers, depending on the underlying BIER layer
      (whether it decrements the IP TTL or not) and the size of the
      network.  The default value is 64.

5.2.3.  Receiving Queries

   BMLD Queriers and Listeners MUST check the destination address of all
   the IP packets that are received or forwarded over BIER whenever
   their own BIER bit is set in the packet.  If the destination address
   is equal to the 'all BMLD Nodes' group address the packet is
   processed as specified in this section.

   If the IPv6 (resp.  IPv4) packet contains an ICMPv6 (resp.  IGMP)
   message of type 'Multicast Listener Query' (resp. of type 'Membership
   Query'), it is processed by the MLDv2 (resp.  IGMPv3) instance run by
   the BMLD Querier.  It MUST be dropped otherwise.

   During the MLDv2 processing, the packet MUST NOT be checked against
   the MLDv2 consistency conditions (i.e., the presence of the router
   alert option, the TTL equaling 1 and, for IPv6 only, the source
   address being link-local).

5.2.4.  Receiving Reports

   BMLD Queriers MUST check the destination address of all the IP
   packets that are received or forwarded over BIER whenever their own
   BIER bit is set.  If the destination address is equal to the 'all
   BMLD Queriers' the packet is processed as specified in this section.



Pfister, et al.          Expires January 8, 2017                [Page 6]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


   If the IPv6 (resp.  IPv4) packet contains an ICMPv6 (resp.  IGMP)
   message of type 'Multicast Listener Report Message v2' (resp.
   'Version 3 Membership Report'), it is processed by the MLDv2 (resp.
   IGMPv3) instance run by the BMLD Querier.  It MUST be dropped
   otherwise.

   During the MLDv2 processing, the packet MUST NOT be checked against
   the MLDv2 consistency conditions (i.e., the presence of the router
   alert option, the TTL equaling 1 and, for IPv6 only, the source
   address being link-local).

5.3.  Packet Forwarding

   BMLD Queriers configure the BIER Layer using the information obtained
   using BMLD, which associates BMLD Listeners (identified by their BFR-
   Prefixes) with their respective MLDv2 membership state.

   More specifically, the MLDv2 state associated with each BMLD Listener
   is provided to the BIER layer such that whenever a multicast packet
   enters the BIER domain, if that packet matches the membership
   information from a BMLD Listener, its BFR-id is added to the set of
   BFR-ids the packet should be forwarded to by the BIER-Layer.

6.  Security Considerations

   BMLD makes use of IP MLDv2 messages transported over BIER in order to
   configure the BIER Layer of BFIRs.  BMLD messages MUST be secured,
   either by relying on physical or link-layer security, by securing the
   IP packets (e.g., using IPSec [RFC4301]), or by relying on security
   features provided by the BIER Layer.

   Whenever an attacker would be able to spoof the identity of a router,
   it could:

   o  Redirect undesired traffic toward the spoofed router by
      subscribing to undesired multicast traffic.

   o  Prevent desired multicast traffic from reaching the spoofed router
      by unsubscribing to some desired multicast traffic.

7.  IANA Considerations

   This specification does not require any action from IANA.








Pfister, et al.          Expires January 8, 2017                [Page 7]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


8.  References

8.1.  Normative References

   [RFC2113]  Katz, D., "IP Router Alert Option", RFC 2113,
              DOI 10.17487/RFC2113, February 1997,
              <http://www.rfc-editor.org/info/rfc2113>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC3376]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
              Thyagarajan, "Internet Group Management Protocol, Version
              3", RFC 3376, DOI 10.17487/RFC3376, October 2002,
              <http://www.rfc-editor.org/info/rfc3376>.

   [RFC3810]  Vida, R., Ed. and L. Costa, Ed., "Multicast Listener
              Discovery Version 2 (MLDv2) for IPv6", RFC 3810,
              DOI 10.17487/RFC3810, June 2004,
              <http://www.rfc-editor.org/info/rfc3810>.

   [I-D.ietf-bier-architecture]
              Wijnands, I., Rosen, E., Dolganow, A., Przygienda, T., and
              S. Aldrin, "Multicast using Bit Index Explicit
              Replication", draft-ietf-bier-architecture-03 (work in
              progress), January 2016.

8.2.  Informative References

   [RFC2460]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", RFC 2460, DOI 10.17487/RFC2460,
              December 1998, <http://www.rfc-editor.org/info/rfc2460>.

   [RFC2711]  Partridge, C. and A. Jackson, "IPv6 Router Alert Option",
              RFC 2711, DOI 10.17487/RFC2711, October 1999,
              <http://www.rfc-editor.org/info/rfc2711>.

   [RFC3306]  Haberman, B. and D. Thaler, "Unicast-Prefix-based IPv6
              Multicast Addresses", RFC 3306, DOI 10.17487/RFC3306,
              August 2002, <http://www.rfc-editor.org/info/rfc3306>.

   [RFC4301]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", RFC 4301, DOI 10.17487/RFC4301,
              December 2005, <http://www.rfc-editor.org/info/rfc4301>.





Pfister, et al.          Expires January 8, 2017                [Page 8]

Internet-Draft        MLD BIER ingress flow overlay            July 2016


   [RFC7761]  Fenner, B., Handley, M., Holbrook, H., Kouvelas, I.,
              Parekh, R., Zhang, Z., and L. Zheng, "Protocol Independent
              Multicast - Sparse Mode (PIM-SM): Protocol Specification
              (Revised)", STD 83, RFC 7761, DOI 10.17487/RFC7761, March
              2016, <http://www.rfc-editor.org/info/rfc7761>.

Appendix A.  Acknowledgements

   Comments concerning this document are very welcome.

Authors' Addresses

   Pierre Pfister
   Cisco Systems
   Paris
   France

   Email: pierre.pfister@darou.fr


   IJsbrand Wijnands
   Cisco Systems
   De Kleetlaan 6a
   Diegem  1831
   Belgium

   Email: ice@cisco.com


   Stig Venaas
   Cisco Systems
   Tasman Drive
   San Jose, CA  95134
   USA

   Email: stig@cisco.com


   Markus Stenberg
   Helsinki  00930
   Finland

   Email: markus.stenberg@iki.fi








Pfister, et al.          Expires January 8, 2017                [Page 9]
