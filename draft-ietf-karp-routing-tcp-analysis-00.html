<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Analysis of BGP, LDP, PCEP, and MSDP Security According to KARP Design Guide</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Contributing Authors">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Abbreviations">
<link href="#rfc.section.2" rel="Chapter" title="2 Current State of BGP, LDP, PCEP and MSDP">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Transport level">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Keying mechanisms">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 LDP">
<link href="#rfc.section.2.3.1" rel="Chapter" title="2.3.1 Spoofing attacks">
<link href="#rfc.section.2.3.1.1" rel="Chapter" title="2.3.1.1 Discovery exchanges using UDP">
<link href="#rfc.section.2.3.1.2" rel="Chapter" title="2.3.1.2 Session communication using TCP">
<link href="#rfc.section.2.3.2" rel="Chapter" title="2.3.2 Privacy Issues">
<link href="#rfc.section.2.3.3" rel="Chapter" title="2.3.3 Denial of Service Attacks">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 PCEP">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 MSDP">
<link href="#rfc.section.3" rel="Chapter" title="3 Optimal State for BGP, LDP, PCEP, and MSDP">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 LDP">
<link href="#rfc.section.4" rel="Chapter" title="4 Gap Analysis for BGP, LDP, PCEP and MSDP">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 LDP">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 PCEP">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Requirements">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document analyzes BGP, LDP, PCEP and MSDP according to guidelines set forth in section 4.2 of " />
  <meta name="description" content="This document analyzes BGP, LDP, PCEP and MSDP according to guidelines set forth in section 4.2 of " />
  <meta name="keywords" content="Internet-Draft" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Routing Working Group</td>
<td class="right">M. Jethanandani</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">K. Patel</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">Cisco Systems, Inc</td>
</tr>
<tr>
<td class="left">Expires: December 30, 2011</td>
<td class="right">L. Zheng</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Huawei</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">June 28, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Analysis of BGP, LDP, PCEP, and MSDP Security According to KARP Design Guide<br />
  <span class="filename">draft-ietf-karp-routing-tcp-analysis-00.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document analyzes BGP, LDP, PCEP and MSDP according to guidelines set forth in section 4.2 of <a href="#draft-ietf-karp-design-guide">[draft-ietf-karp-design-guide]</a>.</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>..</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on December 30, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Contributing Authors</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Abbreviations</a>
</li>
<li>2.   <a href="#rfc.section.2">Current State of BGP, LDP, PCEP and MSDP</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Transport level</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Keying mechanisms</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">LDP</a>
</li>
<li>2.3.1.   <a href="#rfc.section.2.3.1">Spoofing attacks</a>
</li>
<li>2.3.1.1.   <a href="#rfc.section.2.3.1.1">Discovery exchanges using UDP</a>
</li>
<li>2.3.1.2.   <a href="#rfc.section.2.3.1.2">Session communication using TCP</a>
</li>
<li>2.3.2.   <a href="#rfc.section.2.3.2">Privacy Issues</a>
</li>
<li>2.3.3.   <a href="#rfc.section.2.3.3">Denial of Service Attacks</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">PCEP</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">MSDP</a>
</li>
<li>3.   <a href="#rfc.section.3">Optimal State for BGP, LDP, PCEP, and MSDP</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">LDP</a>
</li>
<li>4.   <a href="#rfc.section.4">Gap Analysis for BGP, LDP, PCEP and MSDP</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">LDP</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">PCEP</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Requirements</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgements</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">In March 2006 the Internet Architecture Board (IAB) in its "Unwanted Internet Traffic" workshop described an attack on core routing infrastructure as an ideal attack with the most amount of damage. It called for the tightening the security of the core routing infrastructure.</p>
<p id="rfc.section.1.p.2">This document performs the initial analysis of the current state of BGP, LDP, PCEP and MSDP according to the requirements of <a href="#draft-ietf-karp-design-guide">[draft-ietf-karp-design-guide]</a>. This draft builds on several previous analysis efforts into routing security. The OPSEC working group put together <a href="#draft-ietf-opsec-routing-protocols-crypto-issues">Issues with existing Cryptographic Protection Methods for Routing Protocols </a> <cite title="NONE">[draft-ietf-opsec-routing-protocols-crypto-issues]</cite> an analysis of cryptographic issues with routing protocols and draft-hartman-ospf-analysis-01 which has a analysis for OSPF.</p>
<p id="rfc.section.1.p.3">Section 2 looks at the current state of the four routing protocols.  Section 3 goes into what the optimal state would be for the three routing protocols according to <a href="#draft-ietf-karp-design-guide">KARP Design Guidelines </a> <cite title="NONE">[draft-ietf-karp-design-guide]</cite> and Section 4 does a analysis of the gap between the existing state and the optimal state of the protocols and suggest some areas where we need to improve.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Contributing Authors</h1>
<p id="rfc.section.1.1.p.1">Anantha Ramaiah, Mach Chen</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Abbreviations</h1>
<p id="rfc.section.1.2.p.1">BGP - Border Gateway Protocol</p>
<p id="rfc.section.1.2.p.2">DoS - Denial of Service</p>
<p id="rfc.section.1.2.p.3">KARP - Key and Authentication for Routing Protocols</p>
<p id="rfc.section.1.2.p.4">KDF - Key Derivation Function</p>
<p id="rfc.section.1.2.p.5">KEK - Key Encrypting Key</p>
<p id="rfc.section.1.2.p.6">KMP - Key Management Protocol</p>
<p id="rfc.section.1.2.p.7">LDP - Label Distribution Protocol</p>
<p id="rfc.section.1.2.p.8">LSR - Label Switch Routers</p>
<p id="rfc.section.1.2.p.9">MAC - Message Authentication Code</p>
<p id="rfc.section.1.2.p.10">MKT - Master Key Tuple</p>
<p id="rfc.section.1.2.p.11">MSDP - Multicast Source Distribution Protocol</p>
<p id="rfc.section.1.2.p.12">MD5 - Message Digest algorithm 5</p>
<p id="rfc.section.1.2.p.13">OSPF - OPen Shortest Path First</p>
<p id="rfc.section.1.2.p.14">PCEP - Path Computation Element Protocol</p>
<p id="rfc.section.1.2.p.15">TCP - Transmission Control Protocol</p>
<p id="rfc.section.1.2.p.16">UDP - User Datagram Protocol</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Current State of BGP, LDP, PCEP and MSDP</h1>
<p id="rfc.section.2.p.1">This section looks at the underlying transport protocol and key mechanisms built for the protocol. It describes the security mechanisms built into BGP, LDP, PCEP and MSDP.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Transport level</h1>
<p id="rfc.section.2.1.p.1">At a transport level, routing protocols are subject to a variety of DoS attacks. Such attacks can cause the routing protocol to become congested with the result that routing updates are supplied too slowly to be useful or in extreme case prevent route convergence after a change.</p>
<p id="rfc.section.2.1.p.2">Routing protocols use several methods to protect themselves. Those that run on TCP use access list to permit packets only from know sources. These access lists also help edge routers from attacks originating from outside the protected cloud. In addition for edge routers running eBGP, TCP LISTEN is run only on interfaces on which its peers have been discovered or that are configured to expect sessions on.</p>
<p><a href="#RFC5082">GTSM</a> <cite title="NONE">[RFC5082]</cite> describes a generalized Time to Live (TTL) security mechanism to protect a protocol stack from CPU-utilization based attacks.<a href="#RFC5961">TCP Robustness</a> <cite title="NONE">[RFC5961]</cite> recommends some TCP level mitigations against spoofing attacks targeted towards long lived routing protocol sessions.</p>
<p id="rfc.section.2.1.p.4">Even when BGP, LDP, PCEP and MSDP sessions use access list they are subject to spoofing and man in the middle attacks. Authentication and integrity checks allow the receiver of a routing protocol update to know that the message genuinely comes from the node that purports to have sent it and to know whether the message has been modified.</p>
<p><a href="#RFC2385">TCP MD5</a> <cite title="NONE">[RFC2385]</cite> specifies such a mechanism to protect BGP and other TCP based routing protocols via the TCP MD5 option. TCP MD5 option provides a way for carrying an MD5 digest in a TCP segment. This digest acts like a signature for that segment, incorporating information known only to the connection end points. The MD5 key used to compute the digest is stored locally on the router.  This option is used by routing protocols to provide for session level protection against the introduction of spoofed TCP segments into any existing TCP streams, in particular TCP Reset segments. TCP MD5 does not provide a generic mechanism to support key roll-over.</p>
<p id="rfc.section.2.1.p.6">However, the Message Authentication Codes (MACs) used by MD5 to compute the signature are considered to be too weak. <a href="#RFC5925">TCP-AO </a> <cite title="NONE">[RFC5925]</cite> and its companion document<a href="#RFC5926">Crypto Algorithms for TCP-AO</a> <cite title="NONE">[RFC5926]</cite> is a step towards correcting both the MAC weakness and KMP. For MAC it specifies two MAC algorithms that MUST be supported. They are HMAC-SHA-1-96 as specified in <a href="#RFC2104">HMAC</a> <cite title="NONE">[RFC2104]</cite> and AES-128-CMAC-96 as specified in <a href="#NIST-SP800-38B">NIST-SP800-38B</a> <cite title="NONE">[NIST-SP800-38B]</cite>.  Cryptographic research suggests that both these MAC algorithms defined are fairly secure and are not known to be broken in any ways. It also provides for additional MACs to be added in the future.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Keying mechanisms</h1>
<p id="rfc.section.2.2.p.1">For <a href="#RFC5925">TCP-AO</a> <cite title="NONE">[RFC5925]</cite> there is no Key Management Protocol (KMP) used to manage the keys that are used for generating the Message Authentication Code (MAC). It allows for a master key to be configured manually or for it to be managed from a out of band mechanism. Most routers are configured with a static key that does not change over the life of the session.</p>
<p id="rfc.section.2.2.p.2">For point-to-point key management <a href="#RFC2409">IKE</a> <cite title="NONE">[RFC2409]</cite> tries to solve the issue of key exchange under a SA.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> LDP</h1>
<p id="rfc.section.2.3.p.1">Section 5 of <a href="#RFC5036">LDP</a> <cite title="NONE">[RFC5036]</cite> states that LDP is subject to three different types of attacks. It talks about spoofing, protection of privacy of label distribution and denial of service attacks.</p>
<h1 id="rfc.section.2.3.1">
<a href="#rfc.section.2.3.1">2.3.1.</a> Spoofing attacks</h1>
<p id="rfc.section.2.3.1.p.1">Spoofing attack for LDP occur both during the discovery phase and during the session communication phase.</p>
<h1 id="rfc.section.2.3.1.1">
<a href="#rfc.section.2.3.1.1">2.3.1.1.</a> Discovery exchanges using UDP</h1>
<p id="rfc.section.2.3.1.1.p.1">Label Switching Routers (LSRs) indicate their willingness to establish and maintain LDP sessions by periodically sending Hello messages. Receipt of a Hello message serves to create a new "Hello adjacency", if one does not already exist, or to refresh an existing one.</p>
<p id="rfc.section.2.3.1.1.p.2">Unlike all other LDP messages, the Hello messages are sent using UDP not TCP. This means that they cannot benefit from the security mechanisms available with TCP. <a href="#RFC5036">LDP</a> <cite title="NONE">[RFC5036]</cite> does not provide any security mechanisms for use with Hello messages except to note that some configuration may help protect against bogus discovery events.</p>
<p id="rfc.section.2.3.1.1.p.3">Spoofing a Hello packet for an existing adjacency can cause the adjacency to time out and that can result in termination of the associated session. This can occur when the spoofed Hello message specifies a small Hold Time, causing the receiver to expect Hello messages within this interval, while the true neighbor continues sending Hello messages at the lower, previously agreed to, frequency.</p>
<p id="rfc.section.2.3.1.1.p.4">Spoofing a Hello packet can also cause the LDP session to be terminated directly. This can occur when the spoofed Hello specifies a different Transport Address from the previously agreed one between neighbors. Spoofed Hello messages are observed and reported as real problem in production networks.</p>
<h1 id="rfc.section.2.3.1.2">
<a href="#rfc.section.2.3.1.2">2.3.1.2.</a> Session communication using TCP</h1>
<p id="rfc.section.2.3.1.2.p.1">LDP like other TCP based routing protocols specifies use of the TCP MD5 Signature Option to provide for the authenticity and integrity of session messages. As stated above, some assert that MD5 authentication is now considered by some to be too weak for this application. A stronger hashing algorithm e.g SHA1, could be deployed to take care of the weakness.</p>
<h1 id="rfc.section.2.3.2">
<a href="#rfc.section.2.3.2">2.3.2.</a> Privacy Issues</h1>
<p id="rfc.section.2.3.2.p.1">LDP provides no mechanism for protecting the privacy of label distribution. The security requirements of label distribution are similar to other routing protocols that need to distribute routing information.</p>
<h1 id="rfc.section.2.3.3">
<a href="#rfc.section.2.3.3">2.3.3.</a> Denial of Service Attacks</h1>
<p id="rfc.section.2.3.3.p.1">LDP is subject to Denial of Service (DoS) attacks both in its discovery mode as well as during the session mode.</p>
<p id="rfc.section.2.3.3.p.2">The discovery mode attack is similar to the spoofing attack except that when the spoofed Hello messages are sent with a high enough frequency can cause the adjacency to time out.</p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> PCEP</h1>
<p id="rfc.section.2.4.p.1">Attacks on <a href="#RFC5440">PCEP</a> <cite title="NONE">[RFC5440]</cite> may result in damage to active networks. This may include computation responses, which if changed can cause protocols like LDP to setup sub-optimal or inappropriate LSPs. In addition, PCE itself can be attacked by a variety of DoS attacks. Such attacks can cause path computations to be supplied too slowly to be of any value particularly as it relates to recovery or establishment of LSPs.</p>
<p id="rfc.section.2.4.p.2">As the RFC states, PCEP could be the target of the following attacks.</p>
<p></p>

<ul>
<li>Spoofing (PCC or PCE implementation)</li>
<li>Snooping (message interception)</li>
<li>Falsification</li>
<li>Denial of Service</li>
</ul>

<p>According to the RFC, inter-AS scenarios when PCE-to-PCE communication is required, attacks may be particularly significant with commercial as well as service-level implications.</p>
<p id="rfc.section.2.4.p.4">Additionally, snooping of PCEP requests and responses may give an attacker information about the operation of the network. Simply by viewing the PCEP messages someone can determine the pattern of service establishment in the network and can know where traffic is being routed, thereby making the network susceptible to targeted attacks and the data within specific LSPs vulnerable.</p>
<p id="rfc.section.2.4.p.5">Ensuring PCEP communication privacy is of key importance, especially in an inter-AS context, where PCEP communication end-points do not reside in the same AS, as an attacker that intercepts a PCE message could obtain sensitive information related to computed paths and resources.</p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> MSDP</h1>
<p id="rfc.section.2.5.p.1">Similar to BGP and LDP, <a href="#RFC2385">TCP MD5</a> <cite title="NONE">[RFC2385]</cite> specifies a mechanism to protect TCP sessions via the TCP MD5 option.  But with a weak MD5 authentication, TCP MD5 is considered too weak for this application.</p>
<p id="rfc.section.2.5.p.2">MSDP also advocates imposing a limit on number of source address and group addresses (S,G) that can be stored within the protocol and thereby mitigate state explosion due to any denial of service and other attacks.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Optimal State for BGP, LDP, PCEP, and MSDP</h1>
<p id="rfc.section.3.p.1">The ideal state for BGP, LDP and MSDP protocols are when they can withstand any of the known types of attacks.</p>
<p id="rfc.section.3.p.2">Additionally, Key Management Protocol (KMP) for the routing sessions should help negotiate unique, pair wise random keys without administrator involvement. It should also negotiate Security Association (SA) parameter required for the session connection, including key life times. It should keep track of those lifetimes and negotiate new keys and parameters before they expire and do so without administrator involvement. In the event of a breach, the keys should be changed immediately.</p>
<p id="rfc.section.3.p.3">The DoS attacks for BGP, LDP, PCEP and MSDP are attacks to the transport protocol, TCP in this case. TCP should be able to withstand any of DoS scenarios by dropping packets that are attack packets in a way that does not impact legitimate packets.</p>
<p id="rfc.section.3.p.4">The routing protocols should provide a mechanism to determine authenticate and validate the routing information carried within the payload.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> LDP</h1>
<p id="rfc.section.3.1.p.1">For the spoofing kind of attacks that LDP is vulnerable to during the discovery phase, it should be able to determine the authenticity of the neighbors sending the Hello message.</p>
<p id="rfc.section.3.1.p.2">There is currently no requirement to protect the privacy of label distribution as labels are carried in the clear like other routing information.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Gap Analysis for BGP, LDP, PCEP and MSDP</h1>
<p id="rfc.section.4.p.1">This section outlines the differences between the current state of the routing protocol and the desired state as outlined in section 4.2 of <a href="#draft-ietf-karp-design-guide">KARP Design Guidelines </a> <cite title="NONE">[draft-ietf-karp-design-guide]</cite>. It covers issues that are common to the four protocols leaving protocol specific issues to sub-sections.</p>
<p id="rfc.section.4.p.2">At a transport level the routing protocols are subject to some of the same attacks that TCP applications are subject to. These include but are not limited to DoS attacks. Recommendations to make the transport protocol should be followed and implemented. An example of such a draft is <a href="#RFC5961">Improving TCP's Robustness to Blind In-Window Attacks.</a> <cite title="NONE">[RFC5961]</cite></p>
<p id="rfc.section.4.p.3">From a security perspective we lack comprehensive KMP. As an example <a href="#RFC5925">TCP-AO</a> <cite title="NONE">[RFC5925]</cite> talks about coordinating keys derived from MKT between endpoints, but the MKT itself has to be configured manually or through a out of band mechanism. Even when keys are configured manually, a method for their rollover has not been defined. This leads to keys not being updated regularly which in itself increases the security risk. Also TCP-AO does not address the issue of connectionless reset.</p>
<p id="rfc.section.4.p.4">Authentication, tamper protection, and encryption all require the use of keys by sender and receiver. An automated KMP therefore has to include a way to distribute MKT between two end points with little or no administration overhead. It has to cover automatic key rollover.</p>
<p id="rfc.section.4.p.5">There are two methods of automatic key rollover. Implicit key rollover can be initiated after certain volume of data gets exchanged or when a certain time has elapsed. This does not require explicit signaling. On the other hand, explicit key rollover requires a out of band key signaling mechanism. An example of this is <a href="#RFC2409">IKE</a> <cite title="NONE">[RFC2409]</cite> but it could be any other new mechanisms also.</p>
<p id="rfc.section.4.p.6">There is a need to protect authenticity and validity of the routing/label information that is carried in the payload of the sessions. However, we believe that is outside the scope of this document at this time and is being addressed by SIDR WG. Similar mechanisms could be used for intra-domain protocols.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> LDP</h1>
<p id="rfc.section.4.1.p.1">As described in <a href="#RFC5036">LDP</a> <cite title="NONE">[RFC5036]</cite>, the threat of spoofed Basic Hellos can be reduced by accepting Basic Hellos on interfaces that LSRs trust, employing <a href="#RFC5082">GTSM</a> <cite title="NONE">[RFC5082]</cite> and ignoring Basic Hellos not addressed to the "all routers on this subnet" multicast group. Spoofing attacks via Extended Hellos are potentially a more serious threat. An LSR can reduce the threat of spoofed Extended Hellos by filtering them and accepting Hellos from sources permitted by an access list. However, performing the filtering using access lists requires LSR resource, and the LSR is still vulnerable to the IP source address spoofing.  Spoofing attacks can be solved by being able to authenticate the Hello messages, and an LSR can be configured to only accept Hello messages from specific peers when authentication is in use.</p>
<p><a href="#draft-zheng-mpls-ldp-hello-crypto-auth-01">LDP Hello Cryptographic Authentication</a> <cite title="NONE">[draft-zheng-mpls-ldp-hello-crypto-auth-01]</cite> suggest a new Cryptographic Authentication TLV that can be used as an authentication mechanism to secure Hello messages.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> PCEP</h1>
<p id="rfc.section.4.2.p.1">PCE discovery according to its RFC is a significant feature for the successful deployment of PCEP in large networks. This mechanism allows a PCC to discover the existence of suitable PCEs within the network without the necessity of configuration. It should be obvious that, where PCEs are discovered and not configured, the PCC cannot know the correct key to use. There are different approaches to retain some aspect of security, but all of them require use of a keys and a keying mechanism, the need for which has been discussed above.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Security Requirements</h1>
<p id="rfc.section.5.p.1">This section describes requirements for BGP, LDP, PCEP and MSDP security that should be met within the routing protocol.</p>
<p id="rfc.section.5.p.2">As with all routing protocols, they need protection from both on-path and off-path blind attacks. A better way to protect them would be with per-packet protection using a cryptographic MAC. In order to provide for the MAC, keys are needed.</p>
<p id="rfc.section.5.p.3">Once keys are used, mechanisms are required to support key rollover.  This should cover both manual and automatic key rollover. Multiple approaches could be used. However since the existing mechanisms provide a protocol field to identify the key as well as management mechanisms to introduce and retire new keys, focusing on the existing mechanism as a starting point is prudent.</p>
<p id="rfc.section.5.p.4">Finally, replay protection is required. The replay mechanism needs to be sufficient to prevent an attacker from creating a denial of service or disrupting the integrity of the routing protocol by replaying packets. It is important that an attacker not be able to disrupt service by capturing packets and waiting for replay state to be lost.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Acknowledgements</h1>
<p id="rfc.section.6.p.1">We would like to thank Brian Weis for encouraging us to write this draft and providing comments on it.</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="draft-ietf-karp-design-guide">[draft-ietf-karp-design-guide]</b></td>
<td class="top">
<a title="Juniper Networks, Inc">Lebovitz, G</a>, "<a>KARP Design Guidelines</a>", September 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2385">[RFC2385]</b></td>
<td class="top">
<a href="mailto:ahh@cisco.com" title="cisco Systems">Heffernan, A.</a>, "<a href="http://tools.ietf.org/html/rfc2385">Protection of BGP Sessions via the TCP MD5 Signature Option</a>", RFC 2385, August 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5926">[RFC5926]</b></td>
<td class="top">
<a>Lebovitz, G.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5926">Cryptographic Algorithms for the TCP Authentication Option (TCP-AO)</a>", RFC 5926, June 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2104">[RFC2104]</b></td>
<td class="top">
<a href="mailto:hugo@watson.ibm.com" title="IBM, T.J. Watson Research Center">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu" title="University of California at San Diego, Dept of Computer Science and Engineering">Bellare, M.</a> and <a href="mailto:canetti@watson.ibm.com" title="IBM T.J. Watson Research Center">R. Canetti</a>, "<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>", RFC 2104, February 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2409">[RFC2409]</b></td>
<td class="top">
<a href="mailto:dharkins@cisco.com" title="cisco Systems">Harkins, D.</a> and <a href="mailto:carrel@ipsec.org">D. Carrel</a>, "<a href="http://tools.ietf.org/html/rfc2409">The Internet Key Exchange (IKE)</a>", RFC 2409, November 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3547">[RFC3547]</b></td>
<td class="top">
<a>Baugher, M.</a>, <a>Weis, B.</a>, <a>Hardjono, T.</a> and <a>H. Harney</a>, "<a href="http://tools.ietf.org/html/rfc3547">The Group Domain of Interpretation</a>", RFC 3547, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4271">[RFC4271]</b></td>
<td class="top">
<a>Rekhter, Y.</a>, <a>Li, T.</a> and <a>S. Hares</a>, "<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>", RFC 4271, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5036">[RFC5036]</b></td>
<td class="top">
<a>Andersson, L.</a>, <a>Minei, I.</a> and <a>B. Thomas</a>, "<a href="http://tools.ietf.org/html/rfc5036">LDP Specification</a>", RFC 5036, October 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5082">[RFC5082]</b></td>
<td class="top">
<a>Gill, V.</a>, <a>Heasley, J.</a>, <a>Meyer, D.</a>, <a>Savola, P.</a> and <a>C. Pignataro</a>, "<a href="http://tools.ietf.org/html/rfc5082">The Generalized TTL Security Mechanism (GTSM)</a>", RFC 5082, October 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5440">[RFC5440]</b></td>
<td class="top">
<a>Vasseur, JP.</a> and <a>JL. Le Roux</a>, "<a href="http://tools.ietf.org/html/rfc5440">Path Computation Element (PCE) Communication Protocol (PCEP)</a>", RFC 5440, March 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5925">[RFC5925]</b></td>
<td class="top">
<a>Touch, J.</a>, <a>Mankin, A.</a> and <a>R. Bonica</a>, "<a href="http://tools.ietf.org/html/rfc5925">The TCP Authentication Option</a>", RFC 5925, June 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5961">[RFC5961]</b></td>
<td class="top">
<a>Ramaiah, A.</a>, <a>Stewart, R.</a> and <a>M. Dalal</a>, "<a href="http://tools.ietf.org/html/rfc5961">Improving TCP's Robustness to Blind In-Window Attacks</a>", RFC 5961, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="draft-ietf-opsec-routing-protocols-crypto-issues">[draft-ietf-opsec-routing-protocols-crypto-issues]</b></td>
<td class="top">
<a title="IP Infusion">Manral, </a>, "<a>Issues with existing Cryptographic Protection Methods for Routing Protocols</a>", September 2010.</td>
</tr>
<tr>
<td class="reference"><b id="NIST-SP800-38B">[NIST-SP800-38B]</b></td>
<td class="top">
<a title="National Institute of Standards and Technology">Dworking, </a>, "<a>Recommendation for Block Cipher Modes of Operation: The CMAC Mode for Authentication</a>", May 2005.</td>
</tr>
<tr>
<td class="reference"><b id="draft-zheng-mpls-ldp-hello-crypto-auth-01">[draft-zheng-mpls-ldp-hello-crypto-auth-01]</b></td>
<td class="top">
<a title="Huawei Technologies, Ltd">Zheng, </a>, "<a>LDP Hello Cryptographic Authentication</a>", March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mahesh Jethanandani</span> 
	  <span class="n hidden">
		<span class="family-name">Jethanandani</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc</span>
	<span class="adr">
	  <span>170 Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 (408) 527-8230</span>

<span class="vcardline">EMail: <a href="mailto:mjethanandani@gmail.com">mjethanandani@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Keyur Patel</span> 
	  <span class="n hidden">
		<span class="family-name">Patel</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc</span>
	<span class="adr">
	  <span>170 Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 (408) 526-7183</span>

<span class="vcardline">EMail: <a href="mailto:keyupate@cisco.com">keyupate@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lianshu Zheng</span> 
	  <span class="n hidden">
		<span class="family-name">Zheng</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei</span>
	<span class="adr">
	  <span>No. 3 Xinxi Road, Hai-Dian District</span>

	  <span class="vcardline">
		<span class="locality">Beijing</span>,  
		<span class="region"></span>
		<span class="code">100085</span>
	  </span>
	  <span class="country-name vcardline">China</span>
	</span>
	<span class="vcardline">Phone: +86 (10) 82882008</span>

<span class="vcardline">EMail: <a href="mailto:verozheng@huawei.com">verozheng@huawei.com</a></span>

  </address>
</div>

</body>
</html>