<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Syslog Extension for Cloud Using Syslog Structured Data</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions Used in This Document">
<link href="#rfc.section.3" rel="Chapter" title="3 Problem Statement">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Scope of the application">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 The Traditional Logging and its Applications">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Challenges with the cloud deployment">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 SaaS Use Case">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 PaaS Use Case">
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 IaaS Use Case">
<link href="#rfc.section.4" rel="Chapter" title="4 Cloud Log Structured Data Definitions">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 SD-ELEMENT context">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 SD-PARAM aid - Mandatory">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 SD-PARAM provider - Optional">
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 SD-PARAM rid - Optional">
<link href="#rfc.section.4.1.4" rel="Chapter" title="4.1.4 SD-PARAM eid - Optional">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 SD-ELEMENT transit">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 SD-PARAM client - Mandatory">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 SD-PARAM gw - Optional">
<link href="#rfc.section.5" rel="Chapter" title="5 Log Format Samples">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Log Sample of Simple Non-Authenticated Request">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Successful Authenticated User Request">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Log Sample of Successful Request on Behalf of Another Identity">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 SD-IDs">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document provides an open and extensible log format to be used by any cloud entity or cloud application to log and trace activities that occur in the cloud. It is equally applicable for cloud infrastructure (IaaS), platform (PaaS), and application (SaaS) services.  CloudLog is defferent in content, but not in nature from the traditional logging as it takes in account transient nature of identities and resources in the cloud." />
  <meta name="description" content="This document provides an open and extensible log format to be used by any cloud entity or cloud application to log and trace activities that occur in the cloud. It is equally applicable for cloud infrastructure (IaaS), platform (PaaS), and application (SaaS) services.  CloudLog is defferent in content, but not in nature from the traditional logging as it takes in account transient nature of identities and resources in the cloud." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">G. Golovinsky</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Alert Logic, Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Experimental Protocol</td>
<td class="right">S. Johnston</td>
</tr>
<tr>
<td class="left">Expires: September 15, 2011</td>
<td class="right">Google</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Birk</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Ruhr University Bochum; Horst G&#246;rtz Institute for IT Security</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 14, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Syslog Extension for Cloud Using Syslog Structured Data<br />
  <span class="filename">draft-golovinsky-cloud-log-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document provides an open and extensible log format to be used by any cloud entity or cloud application to log and trace activities that occur in the cloud. It is equally applicable for cloud infrastructure (IaaS), platform (PaaS), and application (SaaS) services.  CloudLog is defferent in content, but not in nature from the traditional logging as it takes in account transient nature of identities and resources in the cloud.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 15, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions Used in This Document</a>
</li>
<li>3.   <a href="#rfc.section.3">Problem Statement</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Scope of the application</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">The Traditional Logging and its Applications</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Challenges with the cloud deployment</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">SaaS Use Case</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">PaaS Use Case</a>
</li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">IaaS Use Case</a>
</li>
<li>4.   <a href="#rfc.section.4">Cloud Log Structured Data Definitions</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">SD-ELEMENT context</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">SD-PARAM aid - Mandatory</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">SD-PARAM provider - Optional</a>
</li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">SD-PARAM rid - Optional</a>
</li>
<li>4.1.4.   <a href="#rfc.section.4.1.4">SD-PARAM eid - Optional</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">SD-ELEMENT transit</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">SD-PARAM client - Mandatory</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">SD-PARAM gw - Optional</a>
</li>
<li>5.   <a href="#rfc.section.5">Log Format Samples</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Log Sample of Simple Non-Authenticated Request</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Successful Authenticated User Request</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Log Sample of Successful Request on Behalf of Another Identity</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">SD-IDs</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This document describes a standard for syslog structured data elements in messages generated by services that may be running on different physical or virtual machines when those services are processing information generated by a single request. The purpose of which is to provide an audit trail that allows correlation of such messages. In addition, this document defines a number of parameters that MUST or SHOULD be included in these structured data elements so these messages can be used to identify users of such services, when the real and/or effective identities of users is known.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#conventions" id="conventions">Conventions Used in This Document</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<p></p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Problem Statement</h1>
<p></p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Scope of the application</h1>
<p id="rfc.section.3.1.p.1">The three service models proposed by the NIST differ in the way the single cloud services are offered to the customers. Hence, besides the usage of general logging concepts which can be applied to all three service models alike, individual logging measures for each single service model with its specific circumstances have to be taken into account.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> The Traditional Logging and its Applications</h1>
<p id="rfc.section.3.2.p.1">Practically all hardware and software entities deployed on the network log their activities. Network elements such as routers, servers, firewalls and switches log information about their activities using mostly Syslog (except for Windows). Applications running on the network also log activities, but often using proprietary mechanisms.  While logging mechanisms are inconsistent between different entities &#8211; Syslog, Windows events, proprietary files &#8211; they generally carry enough information to identify type of the activity, time of the occurrence, physical entity involved in the event, and often user(s) that participated in the event. Availability of this information is crucial for accomplishing multiple business objectives ranging from assuring security and performing forensics to adhering to compliance regulations (SOX, PCI, etc.). The existence of logs and information in them is necessary, but not sufficient for achieving security, compliance and other business objectives. The process of collecting, processing, searching and even simply interpreting information in logs is exceptionally labor and time consuming process and often cannot even be done on any meaningful scale without appropriate tools in place. Log Management tools used to solve the problem of scale and interpretation heavily depend on the fact that format of logs is largely well defined and understood.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Challenges with the cloud deployment</h1>
<p id="rfc.section.3.3.p.1">In cloud deployments the situation with availability of logs in reliability of information in them is drastically different. By definition, cloud resources are shared. A piece of hardware is now running multiple Virtual Instances of &#8220;it&#8221;. They can be brought up and down within very short period of time and at any given moment the hardware can be shared not just by different users but by different users from different companies. Even if Linux or Windows VMs continue to log their activity the information in these logs is very likely to be irrelevant since you cannot really tie logs to the physical entity. Moreover, even if one managed to map logs to a physical entity, there is absolutely no guarantee that the same VM image will be running on the same hardware in its next reincarnation.  And there is really no clear way to determine how many users share the hardware and what are their identities and roles. Tracing environmental changes is practically impossible task unless there is traceability between physical and virtual entities. As a result, achieving such business objectives as adhering to compliance regulations or performing regular security auditing is very difficult if not an impossible task.</p>
<p id="rfc.section.3.3.p.2">Generally, logging mechanisms for cloud environments do not differ in the way traditional logging mechanisms work. However, the environmental circumstances of the cloud presuppose additional measurements. Customers mostly rely on the CSP if logging data is required. In SaaS scenarios, the customers have almost no chance to prepare the application with additional logging features. This situation slightly changes for PaaS and also states in IaaS a tremendous problem. Hence, logging standards should be applied by the CSP in order to improve this situation for the customers. The following use cases underline the need for an additional standard and the differentiation between the various cloud services. </p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> SaaS Use Case</h1>
<p id="rfc.section.3.3.1.p.1">In SaaS scenarios, the CSP obtains all the power over the application itself and the offered services. The customer mainly uses a client device for communicating with a specific API offered by the CSP. In most of the cases, the user agent on the client is a web browser communicating with a web application located on the server infrastructure of the CSP. Unfortunately, the customer does not obtain the ability to manage or control the underlying cloud infrastructure, network components, servers, operating systems etc.  Hence, the CSP has to provide additional logging mechanisms to improve this situation. In case of a web-based email service, the customer has almost no chance to figure out whether his account has been compromised or accessed from an unknown IP address. Even some providers provide some of the last IP addresses which accessed the application, this procedure does not solve the problem of NAT or used proxies. Furthermore, if the customer's account has been compromised, he can't determine which emails have been edited or accessed by the adversary. Additional, fine granular logging mechanisms could improve this situation for the customer and even forensic investigations in case of an account compromise could be possible. </p>
<p></p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> PaaS Use Case</h1>
<p id="rfc.section.3.3.2.p.1">The logging situation in PaaS scenarios slightly changes compared to SaaS. The CSP decides which system-specific logging information is provided to the customers, however, the application deployed by the customer can contain hard-coded logging features. This unfortunately requires the underlying OS environment to support that. For instance, the application could contain mechanisms which transfer encrypted and signed logging data to third party logging servers in real-time. CSP claim that the transfer of data between the PaaS instance and the corresponding database backend is encrypted. This can hardly be confirmed by the customer. Hence, customers should not rely on such promises but apply their own logging mechanisms as far as possible. This logging information could be improved by information provided by CSP which cannot directly been extracted by the customer application. </p>
<h1 id="rfc.section.3.3.3">
<a href="#rfc.section.3.3.3">3.3.3.</a> IaaS Use Case</h1>
<p id="rfc.section.3.3.3.p.1">In IaaS cloud environments the situation with availability of logs in reliability of information in them has somewhat been improved. The customers can prepare their VM for logging purposes and control the single instance. Therefore, crucial application specific logging information can be collected by the customer itself under the theoretical reserve, that the CSP can theoretically maliciously or unintentionally modify this logging information.  Unfortunately, by definition, cloud resources are shared. This means, the customer could share the same physical host with an potential adversary. Hence, it is of greater importance whether the customer shares the physical host with any other tenant or is the only virtual instance. This information cannot be obtained by the customer without the help of the CSP. This situation is further complicated by the flexibility of the cloud. Within a short range of time, virtual instances are transferred to other physical hosts without the knowledge of the customer. These transactions cannot be detected and logged by the customer without the assistance of the CSP. IaaS cloud environments should provide the ability to detect and log the bounding of the virtual instance to a specific hardware.  For an exhaustive forensic analysis of an incident, this information is however of greater importance. Moreover network components containing important information about the network in which the instance is deployed, cannot be accessed by the customer without the help of the CSP. As a result, achieving such business objectives as adhering to compliance regulations or performing regular security auditing is very difficult if not an impossible task.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#struct" id="struct">Cloud Log Structured Data Definitions</a>
</h1>
<p></p>

<ol>
<li>RUI &#8211; real user identity, the identity of the user that has authenticated to the entity.</li>
<li>EUI - effective or impersonated user identity, the identity of the user that the real user identity is acting for. For example, an administrator account could have the ability to impersonate another user account.</li>
<li>Provider - is the domain, service, application, or other entity providing the user identities.</li>
</ol>

<p> </p>
<p id="rfc.section.4.p.2">Structured data elements, defined in <a href="#RFC5424">RFC 5424</a> <cite title="NONE">[RFC5424]</cite>, provides a mechanism for adding data to syslog messages.  Since additional data is necessary to trace user identities and their activities in the cloud we use the mechanism of structured data elements to provide this additional information in the syslog messages.</p>
<p></p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#context" id="context">SD-ELEMENT context</a>
</h1>
<p id="rfc.section.4.1.p.1">The SD-ELEMENT identified by the SD-ID &#8220;context&#8221; defines the context of the external request that causes for the activity to take place. The syslog message that is generated as a result of this activity should be identified by this &#8220;context&#8221;.</p>
<p></p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#aid" id="aid">SD-PARAM aid - Mandatory</a>
</h1>
<p id="rfc.section.4.1.1.p.1">The parameter "aid" represents the audit identifier, which uniquely identifies an external request for activity. The value is a UTF-8-STRING representation of the UUID generated by the entity when request is received.</p>
<p id="rfc.section.4.1.1.p.2">This parameter MUST be present within the SD-ELEMENT "context".</p>
<h1 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#provider" id="provider">SD-PARAM provider - Optional</a>
</h1>
<p id="rfc.section.4.1.2.p.1">The parameter "provider" represents the provider of the identity for the Real User Identity - 'rid' and Effective User Identity - 'eid', User identities are not always exist or available. In cases that they are, either "rid" or "eid" MUST be present in the syslog messages.</p>
<p id="rfc.section.4.1.2.p.2">The parameter "provider" is not required, but SHOULD be present within the SD-ELEMENT "context" when either the 'rid' or 'eid' identifiers are present.</p>
<p></p>
<h1 id="rfc.section.4.1.3">
<a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#rid" id="rid">SD-PARAM rid - Optional</a>
</h1>
<p id="rfc.section.4.1.3.p.1">The parameter "rid" represents the real user identity.</p>
<p id="rfc.section.4.1.3.p.2">This parameter SHOULD be present within the SD-ELEMENT "context" when the real user identity is availbale.</p>
<p></p>
<h1 id="rfc.section.4.1.4">
<a href="#rfc.section.4.1.4">4.1.4.</a> <a href="#eid" id="eid">SD-PARAM eid - Optional</a>
</h1>
<p id="rfc.section.4.1.4.p.1">The parameter "eid" represents the effective user identity. This parameter SHOULD be present within the SD-ELEMENT &#8221;context&#8221; when user impersonation has happened and the effective user identity is available.</p>
<p id="rfc.section.4.1.4.p.2">The 'eid' parameter represents the effective user identity.</p>
<p id="rfc.section.4.1.4.p.3">This parameter SHOULD be present within the 'context' SD-ELEMENT when the effective user identity is known.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#transit" id="transit">SD-ELEMENT transit</a>
</h1>
<p id="rfc.section.4.2.p.1">The SD-ELEMENT identified by the SD-ID &#8220;transit&#8221; defines logical gateway entities which were traversed while request for activity was routed to the final destination entity that would satisfy the request.</p>
<p></p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#client" id="client">SD-PARAM client - Mandatory</a>
</h1>
<p id="rfc.section.4.2.1.p.1">The parameter &#8220;client&#8221; represents the IP address or Fully Qualified Domain Name (FQDN) of the client entity on behalf of which the request is being made. This is different from SD-ID &#8216;ip&#8217; in RFC 5424 that defines IP of the entity producing the log message itself. IPv4 or IPv6 addresses MUST be represented as STRING-UTF-8 .</p>
<p id="rfc.section.4.2.1.p.2">The parameter "client" represents the IP address or FQDN of the client on behalf of which the request is being made.</p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#gw" id="gw">SD-PARAM gw - Optional</a>
</h1>
<p id="rfc.section.4.2.2.p.1">The parameter &#8220;gw&#8221; represents a gateway entity through which the request for activity passes before arriving to the final destination entity actually responsible processing of the request. The value of the parameter is comprised of the STRING-UTF-8 representation of UUID of the entity , identifying the gateway, a colon character (i.e. ':'), and finally the STRING-UTF-8 representation of IP address or FQDN of the gateway through which the request has been routed.</p>
<p id="rfc.section.4.2.2.p.2">This parameter MAY appear more than once within the SD-ELEMENT &#8220;transit&#8221; as request may pass through multiple gateway entities. Each occurrence represents a different gateway through which the request passed.</p>
<p></p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Log Format Samples</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Log Sample of Simple Non-Authenticated Request</h1>
<p></p>
<p id="rfc.section.5.1.p.2">Here is an example of a log produced as a result of simple non-authenticated request to a web service. Only the mandatory parameters &#8220;aid&#8221; and &#8220;client&#8221; are represented.</p>
<p id="rfc.section.5.1.p.3">Jul 7 09:01:40 [context aid="9BE817EB-8ACC-1004-D9DF- 00000A00065E"][transit client="56.2.222.83"] Initializing request to /example_api/index</p>
<p id="rfc.section.5.1.p.4">Jul 7 09:01:40 [context aid="9BE817EB-8ACC-1004-D9DF- 00000A00065E"][transit client="56.2.222.83"] "64.39.0.40" - "1023" ""GET /example_api/index HTTP/1.1"" 200 2543 -- performed in 600 ms</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Successful Authenticated User Request</h1>
<p></p>
<p id="rfc.section.5.2.p.2">Here is an example of a simple request including user authentication. Note that the 'provider' and 'rid' SD-PARAMs are added to the message after the user has authenticated to the service, and that those parameters are included in each subsequent message.</p>
<p id="rfc.section.5.2.p.3">Aug 16 13:34:18 [context aid="149683FC-8DF5-1004-E1A8-00000A000152"][transit client="172.16.1.82"] Initializing request to /api/example:instance/1</p>
<p id="rfc.section.5.2.p.4">Aug 16 13:34:18 [context aid="149683FC-8DF5-1004-E1A8-00000A000152" provider="example.com" rid="1:123"][transit client="172.16.1.82"] User authentication successful for 1:123</p>
<p id="rfc.section.5.2.p.5">Aug 16 13:34:18 [context aid="149683FC-8DF5-1004-E1A8-00000A000152" provider="example.com" rid="1:123"][transit client="172.16.1.82"] "172.16.1.82" - "-" ""GET /api/example:instance/1 HTTP/1.1"" 200 119 -- performed in 2 ms</p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Log Sample of Successful Request on Behalf of Another Identity</h1>
<p id="rfc.section.5.3.p.1">Here is a request made by an authenticated user on behalf of another identity. Note that the parameter &#8220;eid&#8221; is added after the user authentication takes place and the effective user identity is validated. This parameter is included in each subsequent message.</p>
<p id="rfc.section.5.3.p.2">Aug 16 13:34:18 [context aid="149683FC-8DF5-1004-E1A8-00000A000152"][transit client="172.16.1.82"] Initializing request to /api/example:instance/1</p>
<p id="rfc.section.5.3.p.3">Aug 16 13:34:18 [context aid="149683FC-8DF5-1004-E1A8-00000A000152" provider="example.com" rid="1:123"][transit client="172.16.1.82"] User authentication successful for 1:123</p>
<p id="rfc.section.5.3.p.4">Aug 16 13:34:18 [context aid="149683FC-8DF5-1004-E1A8-00000A000152" eid="2:456" provider="example.com" rid="1:123"][transit client="172.16.1.82"] User impersonation successful for 1:123 to 2:456</p>
<p id="rfc.section.5.3.p.5">Aug 16 13:34:18 [context aid="149683FC-8DF5-1004-E1A8-00000A000152" eid="2:456" provider="example.com" rid="1:123"][transit client="172.16.1.82"] "172.16.1.82" - "-" ""GET /api/example:instance/1 HTTP/1.1"" 200 119 -- performed in 2 ms</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">In addition to general syslog security considerations discussed in <a href="#RFC5424">RFC 5424</a> <cite title="NONE">[RFC5424]</cite>, he information contained in these messages may provide information about how services interact, user identities, and other information about network or service inventory.</p>
<p id="rfc.section.6.p.2">Users should not have access to these messages if they would not have access to this information through other authenticated means.</p>
<p></p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#sdids" id="sdids">SD-IDs</a>
</h1>
<p id="rfc.section.7.1.p.1">ANA is requested to register the syslog structured data element SD-IDs and PARAM-NAMEs shown below:</p>
<div id="#rfc.table.1"></div>
<div id="#new-sd-ids"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">SD-ID</th>
<th class="left">PARAM-NAME</th>
<th class="left"></th>
</tr></thead>
<tbody>
<tr>
<td class="left">context</td>
<td class="left"></td>
<td class="left">OPTIONAL</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">aid</td>
<td class="left">MANDATORY</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">eid</td>
<td class="left">OPTIONAL</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">provider</td>
<td class="left">OPTIONAL</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">rid</td>
<td class="left">OPTIONAL</td>
</tr>
<tr>
<td class="left">transit</td>
<td class="left"></td>
<td class="left">OPTIONAL</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">client</td>
<td class="left">MANDATORY</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">gw</td>
<td class="left">OPTIONAL</td>
</tr>
</tbody>
</table>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Gene Golovinsky</span> 
	  <span class="n hidden">
		<span class="family-name">Golovinsky</span>
	  </span>
	</span>
	<span class="org vcardline">Alert Logic, Inc.</span>
	<span class="adr">
	  <span>1776 Yorktown</span>
<span>Suite 700</span>

	  <span class="vcardline">
		<span class="locality">Houston</span>,  
		<span class="region">TX</span> 
		<span class="code">77056</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: (713) 484-8383</span>

<span class="vcardline">EMail: <a href="mailto:gene@alertlogic.com">gene@alertlogic.com</a></span>

<span class="vcardline">URI: <a href="www.alertlogic.com">www.alertlogic.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Sam Johnston</span> 
	  <span class="n hidden">
		<span class="family-name">Johnston</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  <span>Brandschenkestrasse, 110</span>

	  <span class="vcardline">
		<span class="locality">Zurich</span>,  
		<span class="region"></span>
		<span class="code">8002</span>
	  </span>
	  <span class="country-name vcardline">Switzerland</span>
	</span>
	<span class="vcardline">Phone: +41.446681679</span>

<span class="vcardline">EMail: <a href="mailto:sj@google.com">sj@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dominik Birk</span> 
	  <span class="n hidden">
		<span class="family-name">Birk</span>
	  </span>
	</span>
	<span class="org vcardline">Ruhr University Bochum; Horst Görtz Institute for IT Security</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Bochum</span>,  
		<span class="region"></span>
		<span class="code">44780</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49(0)234-32-26740 </span>

<span class="vcardline">EMail: <a href="mailto:dominik.birk@rub.de">dominik.birk@rub.de</a></span>

  </address>
</div>

</body>
</html>