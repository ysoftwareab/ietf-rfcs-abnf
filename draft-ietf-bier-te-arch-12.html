<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Tree Engineering for Bit Index Explicit Replication (BIER-TE)</title>
<meta content="Toerless Eckert" name="author">
<meta content="Michael Menth" name="author">
<meta content="Gregory Cauchie" name="author">
<meta content='
        This memo describes per-packet stateless strict and loose path
steered replication and forwarding for "Bit Index Explicit Replication" (BIER, RFC8279) packets.  It is called BIER Tree Engineering (BIER-TE) and is intended to be used as the path steering mechanism for Traffic Engineering
with BIER. 
       BIER-TE introduces a new semantic for "bit positions" (BP). They indicate adjacencies
of the network topology, as opposed to (non-TE) BIER in which BPs indicate
 "Bit-Forwarding Egress Routers" (BFER).  A BIER-TE packets BitString therefore indicates the
edges of the (loop-free) tree that the packet is forwarded across by BIER-TE.
BIER-TE can leverage BIER forwarding engines with little changes.
Co-existence of BIER and BIER-TE forwarding in the same domain is possible, for example by using
separate BIER "sub-domains" (SDs). Except for the optional routed adjacencies, BIER-TE does not
require a BIER routing underlay, and can therefore operate without depending
on an "Interior Gateway Routing protocol" (IGP). 
       As it operates on the same per-packet stateless forwarding principles, BIER-TE
can also be a good fit to support multicast path steering in "Segment Routing" (SR) networks. 
    ' name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-ietf-bier-te-arch-12" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-bier-te-arch-rjgy2g72.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BIER-TE ARCH</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Eckert, et al.</td>
<td class="center">Expires 1 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-bier-te-arch-12</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01" class="published">January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-01">1 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T.T.E. Eckert, <span class="editor">Ed.</span>
</div>
<div class="org">Futurewei</div>
</div>
<div class="author">
      <div class="author-name">M.M. Menth</div>
<div class="org">University of Tuebingen</div>
</div>
<div class="author">
      <div class="author-name">G.C. Cauchie</div>
<div class="org">Bouygues Telecom</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Tree Engineering for Bit Index Explicit Replication (BIER-TE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1"> This memo describes per-packet stateless strict and loose path
steered replication and forwarding for "Bit Index Explicit Replication" (BIER, RFC8279) packets.  It is called BIER Tree Engineering (BIER-TE) and is intended to be used as the path steering mechanism for Traffic Engineering
with BIER.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">BIER-TE introduces a new semantic for "bit positions" (BP). They indicate adjacencies
of the network topology, as opposed to (non-TE) BIER in which BPs indicate
 "Bit-Forwarding Egress Routers" (BFER).  A BIER-TE packets BitString therefore indicates the
edges of the (loop-free) tree that the packet is forwarded across by BIER-TE.
BIER-TE can leverage BIER forwarding engines with little changes.
Co-existence of BIER and BIER-TE forwarding in the same domain is possible, for example by using
separate BIER "sub-domains" (SDs). Except for the optional routed adjacencies, BIER-TE does not
require a BIER routing underlay, and can therefore operate without depending
on an "Interior Gateway Routing protocol" (IGP).<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">As it operates on the same per-packet stateless forwarding principles, BIER-TE
can also be a good fit to support multicast path steering in "Segment Routing" (SR) networks.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 July 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-basic-examples" class="xref">Basic Examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-bier-te-topology-and-adjace" class="xref">BIER-TE Topology and adjacencies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-relationship-to-bier" class="xref">Relationship to BIER</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-accelerated-hardware-forwar" class="xref">Accelerated/Hardware forwarding comparison</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-components" class="xref">Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-the-multicast-flow-overlay" class="xref">The Multicast Flow Overlay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-the-bier-te-control-plane" class="xref">The BIER-TE Control Plane</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-the-bier-te-controller" class="xref">The BIER-TE Controller</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1.2.1">
                        <p id="section-toc.1-1.3.2.2.2.1.2.1.1"><a href="#section-3.2.1.1" class="xref">3.2.1.1</a>.  <a href="#name-bier-te-topology-discovery-" class="xref">BIER-TE Topology discovery and creation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1.2.2">
                        <p id="section-toc.1-1.3.2.2.2.1.2.2.1"><a href="#section-3.2.1.2" class="xref">3.2.1.2</a>.  <a href="#name-engineered-trees-via-bitstr" class="xref">Engineered Trees via BitStrings</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1.2.3">
                        <p id="section-toc.1-1.3.2.2.2.1.2.3.1"><a href="#section-3.2.1.3" class="xref">3.2.1.3</a>.  <a href="#name-changes-in-the-network-topo" class="xref">Changes in the network topology</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1.2.4">
                        <p id="section-toc.1-1.3.2.2.2.1.2.4.1"><a href="#section-3.2.1.4" class="xref">3.2.1.4</a>.  <a href="#name-link-node-failures-and-reco" class="xref">Link/Node Failures and Recovery</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-the-bier-te-forwarding-plan" class="xref">The BIER-TE Forwarding Plane</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-the-routing-underlay" class="xref">The Routing Underlay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-traffic-engineering-conside" class="xref">Traffic Engineering Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-bier-te-forwarding" class="xref">BIER-TE Forwarding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-the-bier-te-bit-index-forwa" class="xref">The BIER-TE Bit Index Forwarding Table (BIFT)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-adjacency-types" class="xref">Adjacency Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-forward-connected" class="xref">Forward Connected</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-forward-routed" class="xref">Forward Routed</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-ecmp" class="xref">ECMP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="xref">4.2.4</a>.  <a href="#name-local-decapsulation" class="xref">Local Decap(sulation)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-encapsulation-co-existence-" class="xref">Encapsulation / Co-existence with BIER</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-bier-te-forwarding-pseudoco" class="xref">BIER-TE Forwarding Pseudocode</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-basic-bier-te-forwarding-ex" class="xref">Basic BIER-TE Forwarding Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-bfr-requirements-for-bier-t" class="xref">BFR Requirements for BIER-TE forwarding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-bier-te-controller-operatio" class="xref">BIER-TE Controller Operational Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-bit-position-assignments" class="xref">Bit Position Assignments</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-p2p-links" class="xref">P2P Links</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-bfer" class="xref">BFER</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-leaf-bfers" class="xref">Leaf BFERs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.  <a href="#name-lans" class="xref">LANs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="xref">5.1.5</a>.  <a href="#name-hub-and-spoke" class="xref">Hub and Spoke</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a href="#section-5.1.6" class="xref">5.1.6</a>.  <a href="#name-rings" class="xref">Rings</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.7">
                    <p id="section-toc.1-1.5.2.1.2.7.1"><a href="#section-5.1.7" class="xref">5.1.7</a>.  <a href="#name-equal-cost-multipath-ecmp" class="xref">Equal Cost MultiPath (ECMP)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.8">
                    <p id="section-toc.1-1.5.2.1.2.8.1"><a href="#section-5.1.8" class="xref">5.1.8</a>.  <a href="#name-forward-routed-adjacencies" class="xref">Forward Routed adjacencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.8.2.1">
                        <p id="section-toc.1-1.5.2.1.2.8.2.1.1"><a href="#section-5.1.8.1" class="xref">5.1.8.1</a>.  <a href="#name-reducing-bit-positions" class="xref">Reducing bit positions</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.8.2.2">
                        <p id="section-toc.1-1.5.2.1.2.8.2.2.1"><a href="#section-5.1.8.2" class="xref">5.1.8.2</a>.  <a href="#name-supporting-nodes-without-bi" class="xref">Supporting nodes without BIER-TE</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.9">
                    <p id="section-toc.1-1.5.2.1.2.9.1"><a href="#section-5.1.9" class="xref">5.1.9</a>.  <a href="#name-reuse-of-bit-positions-with" class="xref">Reuse of bit positions (without DNC)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.10">
                    <p id="section-toc.1-1.5.2.1.2.10.1"><a href="#section-5.1.10" class="xref">5.1.10</a>. <a href="#name-summary-of-bp-optimizations" class="xref">Summary of BP optimizations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-avoiding-duplicates-and-loo" class="xref">Avoiding duplicates and loops</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-loops" class="xref">Loops</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-duplicates" class="xref">Duplicates</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-managing-si-sub-domains-and" class="xref">Managing SI, sub-domains and BFR-ids</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-why-si-and-sub-domains" class="xref">Why SI and sub-domains</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-assigning-bits-for-the-bier" class="xref">Assigning bits for the BIER-TE topology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="xref">5.3.3</a>.  <a href="#name-assigning-bfr-id-with-bier-" class="xref">Assigning BFR-id with BIER-TE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="xref">5.3.4</a>.  <a href="#name-mapping-from-bfr-to-bitstri" class="xref">Mapping from BFR to BitStrings with BIER-TE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5">
                    <p id="section-toc.1-1.5.2.3.2.5.1"><a href="#section-5.3.5" class="xref">5.3.5</a>.  <a href="#name-assigning-bfr-ids-for-bier-" class="xref">Assigning BFR-ids for BIER-TE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.6">
                    <p id="section-toc.1-1.5.2.3.2.6.1"><a href="#section-5.3.6" class="xref">5.3.6</a>.  <a href="#name-example-bit-allocations" class="xref">Example bit allocations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.6.2.1">
                        <p id="section-toc.1-1.5.2.3.2.6.2.1.1"><a href="#section-5.3.6.1" class="xref">5.3.6.1</a>.  <a href="#name-with-bier" class="xref">With BIER</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.6.2.2">
                        <p id="section-toc.1-1.5.2.3.2.6.2.2.1"><a href="#section-5.3.6.2" class="xref">5.3.6.2</a>.  <a href="#name-with-bier-te" class="xref">With BIER-TE</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.7">
                    <p id="section-toc.1-1.5.2.3.2.7.1"><a href="#section-5.3.7" class="xref">5.3.7</a>.  <a href="#name-summary" class="xref">Summary</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-change-log-rfc-editor-pleas" class="xref">Change log [RFC Editor: Please remove]</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-bier-te-and-segment-routing" class="xref">BIER-TE and Segment Routing</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="overview">
<section id="section-1">
      <h2 id="name-overview">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-1-1"> BIER-TE is based on the (non-TE) BIER architecture, terminology and packet formats as described
in <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span> and <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span>.
This document describes BIER-TE in the expectation that the reader is familiar
with these two documents.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">BIER-TE introduces a new semantic for "bit positions" (BP). They indicate adjacencies
of the network topology, as opposed to (non-TE) BIER in which BPs indicate
 "Bit-Forwarding Egress Routers" (BFER).  A BIER-TE packets BitString therefore indicates the 
edges of the (loop-free) tree that the packet is forwarded across by BIER-TE.
With BIER-TE, the "Bit Index Forwarding Table" (BIFT) of each "Bit Forwarding Router" (BFR)
is only populated with BP that are adjacent to the BFR
in the BIER-TE Topology. Other BPs are empty in the BIFT. The BFR replicate
and forwards BIER packets to adjacent BPs that are set in the packet.
BPs are normally also cleared upon forwarding to avoid duplicates and loops.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">BIER-TE can leverage BIER forwarding engines with little or no changes.
It can also co-exist with BIER forwarding in the same domain, for example by using
separate BIER sub-domains. Except for the optional routed adjacencies, BIER-TE does not
require a BIER routing underlay, and can therefore operate without depending
on an "Interior Gateway Routing protocol" (IGP).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">As it operates on the same per-packet stateless forwarding principles, BIER-TE
can also be a good fit to support multicast path steering in "Segment Routing" (SR) networks (<span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document is structured as follows:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
          <a href="#introduction" class="xref">Section 2</a> introduces BIER-TE with two 
    forwarding examples, followed by an introduction of the new concepts of the BIER-TE
    (overlay) topology and finally a summary of the relationship between BIER and BIER-TE and a discussion of accelerated hardware forwarding.<a href="#section-1-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.2">
          <a href="#components" class="xref">Section 3</a> describes the components of the BIER-TE architecture,
     Flow overlay, BIER-TE layer with the BIER-TE control plane (including the BIER-TE controller) and BIER-TE forwarding plane, and the routing underlay.<a href="#section-1-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.3">
          <a href="#forwarding" class="xref">Section 4</a> specifies the behavior of the BIER-TE forwarding plane with the different type of adjacencies and possible variations of BIER-TE forwarding pseudocode, and finally the mandatory and optional requirements.<a href="#section-1-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.4">
          <a href="#controller-ops" class="xref">Section 5</a> describes operational considerations for the BIER-TE controller, foremost how the BIER-TE controller can optimize the use of BP by using specific type of BIER-TE adjacencies for different type of topological situations, but also how to assign bits to avoid loops and duplicates (which in BIER-TE does not come for free), and finally how "Set Identifier" (SI), "sub-domain" (SD) and BFR-ids can be managed by a BIER-TE controller, examples and summary.<a href="#section-1-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.5">
          <a href="#SR" class="xref">Appendix A</a> concludes the technology specific sections of the document by further relating BIER-TE to SR.<a href="#section-1-6.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-7">Note that related work, <span>[<a href="#I-D.ietf-roll-ccast" class="xref">I-D.ietf-roll-ccast</a>]</span>
uses Bloom filters <span>[<a href="#Bloom70" class="xref">Bloom70</a>]</span> to represent leaves or edges of the intended delivery tree.  Bloom filters
in general can support larger trees/topologies with fewer addressing bits than explicit BitStrings,
but they introduce the heuristic risk of false positives and cannot clear bits in
the BitString during forwarding to avoid loops. For these reasons, BIER-TE 
uses explicit BitStrings like BIER. The explicit BitStrings of BIER-TE can also
be seen as a special type of Bloom filter, and this is how related work <span>[<a href="#ICC" class="xref">ICC</a>]</span>
describes it.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="boilerplate">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
 The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
 "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",  "MAY", and "OPTIONAL"
 in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="introduction">
<section id="section-2">
      <h2 id="name-introduction">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="examples">
<section id="section-2.1">
        <h3 id="name-basic-examples">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-basic-examples" class="section-name selfRef">Basic Examples</a>
        </h3>
<p id="section-2.1-1">BIER-TE forwarding is best introduced with simple examples. These examples
use formal terms defined later in the document (<a href="#adjacencies" class="xref">Figure 4</a>),
including forward_connected(), forward_routed() and local_decap().<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-bier-te-basic-example"></span><div id="basic-example">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.1-2.1">
<pre>

BIER-TE Topology:

   Diagram:

                    p5    p6
                  --- BFR3 ---
               p3/    p13     \p7          p15
   BFR1 ---- BFR2              BFR5 ----- BFR6
      p1   p2  p4\    p14     /p10 p11   p12
                  --- BFR4 ---
                    p8    p9

   (simplified) BIER-TE Bit Index Forwarding Tables (BIFT):

   BFR1:   p1  -&gt; local_decap()
           p2  -&gt; forward_connected() to BFR2

   BFR2:   p1  -&gt; forward_connected() to BFR1
           p5  -&gt; forward_connected() to BFR3
           p8  -&gt; forward_connected() to BFR4

   BFR3:   p3  -&gt; forward_connected() to BFR2
           p7  -&gt; forward_connected() to BFR5
           p13 -&gt; local_decap()

   BFR4:   p4  -&gt; forward_connected() to BFR2
           p10 -&gt; forward_connected() to BFR5
           p14 -&gt; local_decap()

   BFR5:   p6  -&gt; forward_connected() to BFR3
           p9  -&gt; forward_connected() to BFR4
           p12 -&gt; forward_connected() to BFR6

   BFR6:   p11 -&gt; forward_connected() to BFR5
           p15 -&gt; local_decap()

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-bier-te-basic-example" class="selfRef">BIER-TE basic example</a>
          </figcaption></figure>
</div>
<p id="section-2.1-3">
Consider the simple network in the above BIER-TE overview example picture
with 6 BFRs. p1...p15 are the bit positions used. All BFRs can act as
an ingress BFR (BFIR), BFR1, BFR3, BFR4 and
BFR6 can also be BFERs. Forward_connected() is the name for
adjacencies that are representing subnet adjacencies of the network.
Local_decap() is the name of the adjacency to decapsulate BIER-TE packets and
pass their payload to higher layer processing.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">
Assume a packet from BFR1 should be sent via BFR4 to BFR6. This requires
a BitString (p2,p8,p10,p12,p15). When this packet is examined by BIER-TE
on BFR1, the only bit position from the BitString that is also set in
the BIFT is p2. This will cause BFR1 to send the only copy of the packet
to BFR2. Similarly, BFR2 will forward to BFR4 because of p8, BFR4 to BFR5
because of p10 and BFR5 to BFR6 because of p12. p15 finally makes BFR6 receive
and decapsulate the packet.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">To send a copy to BFR6 via BFR4 and also a copy to BFR3, the BitString needs
to be (p2,p5,p8,p10,p12,p13,p15). When this packet is examined by 
BFR2, p5 causes one copy to be sent to BFR3 and p8 one copy to BFR4.
When BFR3 receives the packet, p13 will cause it to receive and decapsulate
the packet.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">If instead the BitString was (p2,p6,p8,p10,p12,p13,p15), the packet
would be copied by BFR5 towards BFR3 because of p6 instead of being copied by 
BFR2 to BFR3 because of p5 in the prior case. This is showing the ability of the shown
BIER-TE Topology to make the traffic pass across any possible path and be
replicated where desired.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">BIER-TE has various options to minimize BP assignments,
many of which are based on out-of-band knowledge about the required multicast traffic
paths and bandwidth consumption in the network, such as from pre-deployment planning.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8"><a href="#basic-overlay" class="xref">Figure 2</a> shows a modified example, in which Rtr2 and Rtr5 are
assumed not to support BIER-TE, so traffic has to be unicast encapsulated across
them.  To emphasize non-L2, but routed/tunneled forwarding of BIER-TE packets,
these adjacencies are called "forward_routed". Otherwise, there is no difference
in their processing over the aforementioned forward_connected() adjacencies.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">In addition, bits are saved in the following example by assuming that BFR1 only
needs to be BFIR but not BFER or transit BFR.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<span id="name-bier-te-basic-overlay-examp"></span><div id="basic-overlay">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-2.1-10.1">
<pre>

BIER-TE Topology:

   Diagram:

                   p1  p3  p7
                ....&gt; BFR3 &lt;....       p5
        ........                ........&gt;
   BFR1       (Rtr2)          (Rtr5)      BFR6
        ........                ........&gt; p9
                ....&gt; BFR4 &lt;....       p6
                   p2  p4  p8

   (simplified) BIER-TE Bit Index Forwarding Tables (BIFT):

   BFR1:   p1  -&gt; forward_routed() to BFR3
           p2  -&gt; forward_routed() to BFR4

   BFR3:   p3  -&gt; local_decap()
           p5  -&gt; forward_routed() to BFR6

   BFR4:   p4  -&gt; local_decap()
           p6  -&gt; forward_routed() to BFR6

   BFR6:   p7  -&gt; forward_routed() to BFR3
           p8  -&gt; forward_routed() to BFR4
           p9  -&gt; local_decap()

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-bier-te-basic-overlay-examp" class="selfRef">BIER-TE basic overlay example</a>
          </figcaption></figure>
</div>
<p id="section-2.1-11">To send a BIER-TE packet from BFR1 via BFR3 to be received by BFR6,
the BitString is (p1,p5,p9). From BFR1 via BFR4 to be received by BFR6,
the BitString is (p2,p6,p9). A packet from BFR1 to be received by BFR3,BFR4
and from BFR3 to be received by BFR6 uses (p1,p2,p3,p4,p5,p9). A packet
from BFR1 to be received by BFR3,BFR4 and from BFR4 to be received by BFR6
uses (p1,p2,p3,p4,p6,p9). A packet from BFR1 to be received by BFR4, 
and from BFR4 to be received by BFR6 and from there to be received by BFR3 uses (p2,p3,p4,p6,p7,p9).
A packet from BFR1 to be received by BFR3, and from BFR3 to be received by BFR6
 there to be received by BFR4 uses (p1,p3,p4,p5,p8,p9).<a href="#section-2.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="topology">
<section id="section-2.2">
        <h3 id="name-bier-te-topology-and-adjace">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-bier-te-topology-and-adjace" class="section-name selfRef">BIER-TE Topology and adjacencies</a>
        </h3>
<p id="section-2.2-1">The key new component in BIER-TE compared to (non-TE) BIER is the BIER-TE topology
as introduced through the two examples in <a href="#examples" class="xref">Section 2.1</a>.
It is used  to control where replication can or should happen and how to
minimize the required number of BP for adjacencies.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">
The BIER-TE Topology consists of the BIFTs of all the BFR and
can also be expressed as a directed graph where the edges are the adjacencies 
between the BFRs labelled with the BP used for the adjacency. Adjacencies are
naturally unidirectional.  BP can be reused across multiple adjacencies as long as this does not
lead to undesired duplicates or loops as explained in <a href="#avoiding" class="xref">Section 5.2</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">If the BIER-TE topology represents (a subset of) the underlying (layer 2)
topology of the network as shown in the first example, this may be called a "native"
BIER-TE topology. A topology consisting only of "forward_routed" adjacencies as
shown in the second example may be called an "overlay" BIER-TE topology.
A BIER-TE topology with both forward_connected() and forward_routed() adjacencies
may be called a "hybrid" BIER-TE topology.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="comparison">
<section id="section-2.3">
        <h3 id="name-relationship-to-bier">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-relationship-to-bier" class="section-name selfRef">Relationship to BIER</a>
        </h3>
<p id="section-2.3-1">BIER-TE is designed so that its forwarding plane is a simple extension to the (non-TE) BIER forwarding plane, hence allowing for it to be added to BIER deployments where it can be beneficial.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">BIER-TE is also intended as an option to expand the BIER architecture into deployments where (non-TE) BIER  may not be the best fit, such as statically provisioned networks with needs for path steering but without desire for distributed routing protocols.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3">
<li id="section-2.3-3.1">
            <p id="section-2.3-3.1.1">BIER-TE inherits the following aspects from BIER unchanged:<a href="#section-2.3-3.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3.1.2">
<li id="section-2.3-3.1.2.1">The fundamental purpose of per-packet signaled replication and delivery via a BitString.<a href="#section-2.3-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.1.2.2">The overall architecture consisting of three layers, flow overlay, BIER(-TE) layer and routing underlay.<a href="#section-2.3-3.1.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.1.2.3">The supported encapsulations <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span>.<a href="#section-2.3-3.1.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.1.2.4">The semantic of all <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span> header elements used by the BIER-TE forwarding plane other than the semantic of the BP in the BitString.<a href="#section-2.3-3.1.2.4" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.1.2.5">The BIER forwarding plane, except for how bits have to be cleared during replication.<a href="#section-2.3-3.1.2.5" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-2.3-3.2">
            <p id="section-2.3-3.2.1">BIER-TE has the following key changes with respect to BIER:<a href="#section-2.3-3.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3.2.2">
<li id="section-2.3-3.2.2.1">In BIER, bits in the BitString of a BIER packet header indicate a BFER
        and bits in the BIFT indicate the BIER control plane calculated next-hop
        toward that BFER. In BIER-TE, a bit in the BitString of a BIER packet
        header indicates an adjacency in the BIER-TE topology, and only the
        BFR that is the upstream of that adjacency has its BP populated with
        the adjacency in its BIFT.<a href="#section-2.3-3.2.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.2.2.2">In BIER, the implied reference option for the core part of the BIER layer
       control plane are the BIER extensions for distributed routing protocols.
       This includes ISIS/OSPF extensions for BIER, <span>[<a href="#RFC8401" class="xref">RFC8401</a>]</span>
       and <span>[<a href="#RFC8444" class="xref">RFC8444</a>]</span>.<a href="#section-2.3-3.2.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.2.2.3">The reference option for the core part of the BIER-TE control plane is
       the BIER-TE controller. Nevertheless, both the BIER and BIER-TE BIFTs forwarding
       plane state could equally be populated by any mechanism.<a href="#section-2.3-3.2.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.2.2.4">Assuming the reference options for the control plane,  BIER-TE replaces in-network autonomous path calculation by explicit paths calculated by the BIER-TE controller.<a href="#section-2.3-3.2.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-2.3-3.3">
            <p id="section-2.3-3.3.1">The following elements/functions described in the BIER architecture are not required by the BIER-TE architecture:<a href="#section-2.3-3.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3.3.2">
<li id="section-2.3-3.3.2.1">"Bit Index Routing Tables" (BIRTs) are not required on BFRs for BIER-TE when using a BIER-TE controller because the controller can directly populate the BIFTs. In BIER, BIRTs are populated by the distributed routing protocol support for BIER, allowing BFRs to populate their BIFTs locally from their BIRTs. Other BIER-TE control plane  or management plane options may introduce requirements for BIRTs for BIER-TE BFRs.<a href="#section-2.3-3.3.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.3.2.2">The BIER-TE layer forwarding plane does not require BFRs to have a unique BP and therefore also no unique BFR-id.  See <a href="#leaf-bfer" class="xref">Section 5.1.3</a>.<a href="#section-2.3-3.3.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.3.2.3">Identification of BFRs by the BIER-TE control plane is outside the scope of this specification. Whereas the BIER control plane uses BFR-ids in its BFR to BFR signaling, a BIER-TE controller may choose any form of identification deemed appropriate.<a href="#section-2.3-3.3.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.3.2.4">BIER-TE forwarding does not require the BFIR-id field of the BIER packet header.<a href="#section-2.3-3.3.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-2.3-3.4">
            <p id="section-2.3-3.4.1">Co-existence of BIER and BIER-TE in the same network requires the following:<a href="#section-2.3-3.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3.4.2">
<li id="section-2.3-3.4.2.1">The BIER/BIER-TE packet header needs to allow addressing both BIER and BIER-TE BIFTs. Depending on the encapsulation option, the same SD may or may not be reusable across BIER and BIER-TE.  See <a href="#encapsulation" class="xref">Section 4.3</a>. 
In either case, a packet is always only forwarded end-to-end via BIER or via BIER-TE (ships in the nights forwarding).<a href="#section-2.3-3.4.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-3.4.2.2">BIER-TE deployments will have to assign BFR-ids to BFRs and insert them into the BFIR-id field of BIER packet headers as BIER does, whenever the deployment uses (unchanged) components developed for BIER that use BFR-id, such as multicast flow overlays or BIER layer control plane elements. See also <a href="#bfr-id" class="xref">Section 5.3.3</a>.<a href="#section-2.3-3.4.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
        </ol>
</section>
</div>
<div id="fwd-comparison">
<section id="section-2.4">
        <h3 id="name-accelerated-hardware-forwar">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-accelerated-hardware-forwar" class="section-name selfRef">Accelerated/Hardware forwarding comparison</a>
        </h3>
<p id="section-2.4-1">BIER-TE forwarding rules, especially the BitString parsing are designed to be as close
as possible to those of BIER in the expectation that this eases the programming of BIER-TE forwarding 
code and/or BIER-TE forwarding hardware on platforms supporting BIER. 
The pseudocode in <a href="#pseudocode" class="xref">Section 4.4</a> shows how existing 
(non-TE) BIER/BIFT forwarding can be modified to support the required BIER-TE forwarding
functionality (<a href="#requirements" class="xref">Section 4.6</a>), by using BIER BIFT's "Forwarding Bit Mask" (F-BM):
Only the clearing of bits to avoid duplicate
packets to a BFR's neighbor is skipped in BIER-TE forwarding because it is not necessary
and could not be done when using BIER F-BM.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Whether to use BIER or BIER-TE forwarding is simply a choice of the mode
of the BIFT indicated by the packet (BIER or BIER-TE BIFT). This is determined
by the BFR configuration for the encapsulation, see <a href="#encapsulation" class="xref">Section 4.3</a>.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="components">
<section id="section-3">
      <h2 id="name-components">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-components" class="section-name selfRef">Components</a>
      </h2>
<p id="section-3-1">BIER-TE can be thought of being constituted from the same three
layers as BIER: The "multicast flow overlay", the "BIER layer" and
the "routing underlay".  The following picture also shows how the "BIER layer"
is constituted from the "BIER-TE forwarding plane" and the "BIER-TE control plane"
represent by the "BIER-TE Controller".<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-bier-te-architecture"></span><div id="architecture">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-3-2.1">
<pre>
                &lt;------BGP/PIM-----&gt;
   |&lt;-IGMP/PIM-&gt;  multicast flow   &lt;-PIM/IGMP-&gt;|
                     overlay

       BIER-TE  [BIER-TE Controller] &lt;=&gt; [BIER-TE Topology]
       control     ^      ^     ^
       plane      /       |      \   BIER-TE control protocol
                 |        |       |  e.g. YANG/NETCONF/RESTCONF
                 |        |       |       PCEP/...
                 v        v       v
 Src -&gt; Rtr1 -&gt; BFIR-----BFR-----BFER -&gt; Rtr2 -&gt; Rcvr

                |&lt;-----------------&gt;|
              BIER-TE forwarding plane

                |&lt;- BIER-TE domain-&gt;|

              |&lt;---------------------&gt;|
                  Routing underlay
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-bier-te-architecture" class="selfRef">BIER-TE architecture</a>
        </figcaption></figure>
</div>
<div id="flow-overlay">
<section id="section-3.1">
        <h3 id="name-the-multicast-flow-overlay">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-the-multicast-flow-overlay" class="section-name selfRef">The Multicast Flow Overlay</a>
        </h3>
<p id="section-3.1-1">The Multicast Flow Overlay has the same role as described for BIER
in <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span>, Section 4.3. See also <a href="#engineered-bitstrings" class="xref">Section 3.2.1.2</a>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">When a BIER-TE controller is used, then the signaling for the Multicast Flow Overlay may 
also be preferred to operate through a central point of control. For BGP based
overlay flow services such as "Multicast VPN Using BIER" (<span>[<a href="#RFC8556" class="xref">RFC8556</a>]</span>) this
can be achieved by making the BIER-TE controller operate as a BGP Route
Reflector (<span>[<a href="#RFC4456" class="xref">RFC4456</a>]</span>) and combining it with signaling through BGP
or a different protocol for the BIER-TE controller calculated BitStrings.
See <a href="#engineered-bitstrings" class="xref">Section 3.2.1.2</a> and <a href="#bitstring-mappings" class="xref">Section 5.3.4</a>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="control-plane">
<section id="section-3.2">
        <h3 id="name-the-bier-te-control-plane">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-the-bier-te-control-plane" class="section-name selfRef">The BIER-TE Control Plane</a>
        </h3>
<p id="section-3.2-1">In the (non-TE) BIER architecture <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span>, the BIER control
plane is not explicitly separated from the BIER forwarding plane,
but instead their functions are summarized together in Section 4.2.
Example standardized options for the BIER control plane include
ISIS/OSPF extensions for BIER, <span>[<a href="#RFC8401" class="xref">RFC8401</a>]</span> and <span>[<a href="#RFC8444" class="xref">RFC8444</a>]</span>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">For BIER-TE, the control plane includes at minimum the following functionality.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-3">
          <dt id="section-3.2-3.1">1. BIER-TE topology control:</dt>
          <dd id="section-3.2-3.2" style="margin-left: 1.5em">
<div id="topology-control">
            <p id="section-3.2-3.2.1">During initial provisioning of the network and/or during modifications of its topology and/or services, the protocols and/or procedures to establish BIER-TE BIFTs:<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3.2.2">
<li id="section-3.2-3.2.2.1">
<div id="topology-control-1">Determine the desired BIER-TE topology for a BIER-TE sub-domains: the native and/or overlay adjacencies that are assigned to BPs. Topology discovery is discussed in <a href="#topology-discovery" class="xref">Section 3.2.1.1</a> and the various aspects of the BIER-TE controllers determinations about the topology are discussed throughout <a href="#controller-ops" class="xref">Section 5</a><a href="#topology-control-1" class="pilcrow">¶</a>
</div>
              </li>
<li id="section-3.2-3.2.2.2">Determine the per-BFR BIFT from the BIER-TE topology. This is achieved by simply extracting the adjacencies of the BFR from the BIER-TE topology and populating the BFRs BIFT with them.<a href="#section-3.2-3.2.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.2.2.3">Optionally assign BFR-ids to BFIRs for later insertion into BIER headers on BFIRs as BFIR-id. Alternatively, BFIR-id in BIER packet headers may be managed solely by the flow overlay layer and/or be unused. This is discussed in <a href="#bfr-id" class="xref">Section 5.3.3</a>.<a href="#section-3.2-3.2.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.2.2.4">Install/update the BIFTs into the BFRs and optionally BFR-ids into BFIRs. This is discussed in <a href="#topology-discovery" class="xref">Section 3.2.1.1</a>.<a href="#section-3.2-3.2.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</div>
          </dd>
<dd class="break"></dd>
<dt id="section-3.2-3.3">2. BIER-TE tree control:</dt>
          <dd id="section-3.2-3.4" style="margin-left: 1.5em">
<div id="tree-control">
            <p id="section-3.2-3.4.1">During operations of the network, protocols and/or procedures to support creation/change/removal of overlay flows on BFIRs:<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3.4.2">
<li id="section-3.2-3.4.2.1">Process the BIER-TE requirements for the multicast overlay flow: BFIR and BFERs of the flow as well as policies for the path selection of the flow. This is discussed in <a href="#te-considerations" class="xref">Section 3.5</a>.<a href="#section-3.2-3.4.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.4.2.2">Determine the BitStrings and optionally Entropy. This is discussed in <a href="#engineered-bitstrings" class="xref">Section 3.2.1.2</a>, <a href="#te-considerations" class="xref">Section 3.5</a> and <a href="#bitstring-mappings" class="xref">Section 5.3.4</a>.<a href="#section-3.2-3.4.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.4.2.3">Install state on the BFIR to impose the desired BIER packet header(s) for packets of the overlay flow. Different aspects of this and the next point are discussed throughout <a href="#bier-te-controller" class="xref">Section 3.2.1</a> and in <a href="#encapsulation" class="xref">Section 4.3</a>, but the main responsibility of these two points is with the Multicast Flow Overlay (<a href="#flow-overlay" class="xref">Section 3.1</a>), which is architecturally inherited from BIER.<a href="#section-3.2-3.4.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.4.2.4">Install the necessary state on the BFERs to decapsulate the BIER packet header and properly dispatch its payload.<a href="#section-3.2-3.4.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</div>
        </dd>
<dd class="break"></dd>
</dl>
<div id="bier-te-controller">
<section id="section-3.2.1">
          <h4 id="name-the-bier-te-controller">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-the-bier-te-controller" class="section-name selfRef">The BIER-TE Controller</a>
          </h4>
<p id="section-3.2.1-1">[RFC-Editor: the following text has three references to anchors topology-control, topology-control-1 and tree-control. Unfortunately, XMLv2 does not offer any tagging that reasonable references are generated (i had this problem already in RFCs last year. Please make sure there are useful-to-read cross-references in the RFC in these three places after you convert to XMLv3.]<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">This architecture describes the
BIER-TE control plane as shown in <a href="#architecture" class="xref">Figure 3</a> to consist of:<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">A BIER-TE controller.<a href="#section-3.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.2">BFR data-models and protocols to communicate between controller and BFRs 
           in support of <span><a href="#topology-control" class="xref">BIER-TE topology control</a> (<a href="#topology-control" class="xref">Section 3.2</a>)</span>,
           such as YANG/NETCONF/RESTCONF (<span>[<a href="#RFC7950" class="xref">RFC7950</a>]</span>/<span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span>/<span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span>).<a href="#section-3.2.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.3">BFR data-models and protocols to communicate between controller and BFIR in support of
           <span><a href="#tree-control" class="xref">BIER-TE tree control</a> (<a href="#tree-control" class="xref">Section 3.2</a>)</span>, such as BIER-TE extensions
           for <span>[<a href="#RFC5440" class="xref">RFC5440</a>]</span>.<a href="#section-3.2.1-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.1-4">The single, centralized BIER-TE controller is used in this document as reference option for the BIER-TE control plane but other options are equally feasible. 

The BIER-TE control plane could equally be implemented without automated configuration/protocols,
by an operator via CLI on the BFRs.

 In that case, operator configured local policy on the BFIR would have to
determine how to set the appropriate BIER header fields.  The BIER-TE control plane could also be decentralized
and/or distributed, but this document does not consider any additional protocols and/or procedures
which would then be necessary to coordinate its (distributed/decentralized) entities to achieve the above described functionality.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<div id="topology-discovery">
<section id="section-3.2.1.1">
            <h5 id="name-bier-te-topology-discovery-">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-bier-te-topology-discovery-" class="section-name selfRef">BIER-TE Topology discovery and creation</a>
            </h5>
<p id="section-3.2.1.1-1"><span><a href="#topology-control-1" class="xref">The first item of BIER-TE topology control</a> (<a href="#topology-control-1" class="xref">Section 3.2, Paragraph 3, Item 2.2.1</a>)</span>
includes network topology discovery and BIER-TE topology creation. The latter describes
the process by which a Controller determines which routers are to be configured as BFRs and the
adjacencies between them.<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-2">In statically managed networks, such as in industrial environments, both discovery and creation can be a manual/offline process.<a href="#section-3.2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-3">In other networks, topology discovery may rely on protocols including extending a "Link-State-Protocol" based IGP into the BIER-TE controller itself, <span>[<a href="#RFC7752" class="xref">RFC7752</a>]</span> (BGP-LS) or <span>[<a href="#RFC8345" class="xref">RFC8345</a>]</span> (YANG topology) as well as BIER-TE specific methods, for example via <span>[<a href="#I-D.ietf-bier-te-yang" class="xref">I-D.ietf-bier-te-yang</a>]</span>. These options are non-exhaustive.<a href="#section-3.2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-4">Dynamic creation of the BIER-TE topology can be as easy as mapping the network topology 1:1 to the BIER-TE topology by assigning a BP for every network subnet adjacency. In larger networks, it likely involves more complex policy and optimization decisions including how to minimize the number of BPs required and how to assign BPs across different BitStrings to minimize the number of duplicate packets across links when delivering an overlay flow to BFER using different SIs/BitStrings. These topics are discussed in <a href="#controller-ops" class="xref">Section 5</a>.<a href="#section-3.2.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-5">When the BIER-TE topology is determined, the BIER-TE Controller then pushes
the BitPositions/adjacencies to the BIFT of the BFRs. On each BFR only those SI:BitPositions
are populated that are adjacencies to other BFRs in the BIER-TE topology.<a href="#section-3.2.1.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-6">Communications between the BIER-TE Controller and BFRs for both BIER-TE topology
control and BIER-TE tree control is ideally via standardized protocols and data-models such
as NETCONF/RESTCONF/YANG/PCEP.  Vendor-specific CLI on the BFRs is also an option (as in many other SDN
solutions lacking definition of standardized data models).<a href="#section-3.2.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="engineered-bitstrings">
<section id="section-3.2.1.2">
            <h5 id="name-engineered-trees-via-bitstr">
<a href="#section-3.2.1.2" class="section-number selfRef">3.2.1.2. </a><a href="#name-engineered-trees-via-bitstr" class="section-name selfRef">Engineered Trees via BitStrings</a>
            </h5>
<p id="section-3.2.1.2-1">In BIER, the same set of BFER in a single sub-domain is always encoded as the same BitString.
In BIER-TE, the BitString used to reach the same set of BFER in the same sub-domain can be
different for different overlay flows because the BitString encodes the paths towards the BFER,
so the BitStrings from different BFIR to the same set of BFER will often be different. 
Likewise, the BitString from the same BFIR to the same set of BFER can be different for different overlay
flows for policy reasons such as shortest path trees, Steiner trees (minimum cost trees),
diverse path trees for redundancy and so on.<a href="#section-3.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.2-2">See also <span>[<a href="#I-D.ietf-bier-multicast-http-response" class="xref">I-D.ietf-bier-multicast-http-response</a>]</span> for an application
leveraging BIER-TE engineered trees.<a href="#section-3.2.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-in-topo">
<section id="section-3.2.1.3">
            <h5 id="name-changes-in-the-network-topo">
<a href="#section-3.2.1.3" class="section-number selfRef">3.2.1.3. </a><a href="#name-changes-in-the-network-topo" class="section-name selfRef">Changes in the network topology</a>
            </h5>
<p id="section-3.2.1.3-1">If the network topology changes (not failure based) so that adjacencies
that are assigned to bit positions are no longer needed, the BIER-TE Controller can
re-use those bit positions for new adjacencies.  First, these bit positions
need to be removed from any BFIR flow state and BFR BIFT state, then they
can be repopulated, first into BIFT and then into the BFIR.<a href="#section-3.2.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="failures">
<section id="section-3.2.1.4">
            <h5 id="name-link-node-failures-and-reco">
<a href="#section-3.2.1.4" class="section-number selfRef">3.2.1.4. </a><a href="#name-link-node-failures-and-reco" class="section-name selfRef">Link/Node Failures and Recovery</a>
            </h5>
<p id="section-3.2.1.4-1">When link or nodes fail or recover in the topology, BIER-TE could quickly
respond with FRR procedures such as <span>[<a href="#I-D.eckert-bier-te-frr" class="xref">I-D.eckert-bier-te-frr</a>]</span>, the details of which are out of scope for this document. It can also more slowly react by
recalculating the BitStrings of affected multicast flows. This reaction is
slower than the FRR procedure because the BIER-TE Controller needs to receive
link/node up/down indications, recalculate the desired BitStrings and push
them down into the BFIRs. With FRR, this is all performed locally on a BFR
receiving the adjacency up/down notification.<a href="#section-3.2.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="forwarding-plane">
<section id="section-3.3">
        <h3 id="name-the-bier-te-forwarding-plan">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-the-bier-te-forwarding-plan" class="section-name selfRef">The BIER-TE Forwarding Plane</a>
        </h3>
<p id="section-3.3-1">[RFC-editor Q: "is constituted from" / "consists of" / "composed from..." ???]<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The BIER-TE Forwarding Plane is constituted from the following components:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-3">
<li id="section-3.3-3.1">On a BFIR, imposition of the BIER header for packets from overlay flows. This is driven by a combination of state established by the BIER-TE control plane and/or the multicast flow overlay as explained in <a href="#flow-overlay" class="xref">Section 3.1</a>.<a href="#section-3.3-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.2">On BFRs (including BFIR and BFER), forwarding/replication of BIER packets according to their SD, SI, "BitStringLength" (BSL), BitString and optionally Entropy fields as explained in <a href="#forwarding" class="xref">Section 4</a>. Processing of other BIER header fields such as DSCP is outside the scope of this document.<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.3">On BFERs, removal of the BIER header and dispatching of the payload according to state created by the BIER-TE control plane and/or overlay layer.<a href="#section-3.3-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-4">When the BIER-TE Forwarding Plane receives a packet, it simply looks
up the bit positions that are set in the BitString of the packet in the
BIFT that was populated by the BIER-TE Controller.
For every BP that is set in the BitString, and that has one or
more adjacencies in the BIFT, a copy is made according to the type
of adjacencies for that BP in the BIFT. Before sending any copy, the
BFR clears all BPs in the BitString of the packet for which the
BFR has one or more adjacencies in the BIFT.  Clearing these bits inhibits
packets from looping when the BitStrings erroneously includes a forwarding loop.
When a forward_connected() adjacency has the "DoNotClear" (DNC) flag
set, then this BP is re-set for the packet copied to that adjacency.
See <a href="#forward-connected" class="xref">Section 4.2.1</a>.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing-underlay">
<section id="section-3.4">
        <h3 id="name-the-routing-underlay">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-the-routing-underlay" class="section-name selfRef">The Routing Underlay</a>
        </h3>
<p id="section-3.4-1">For forward_connected() adjacencies, BIER-TE is sending BIER packets to directly connected
BIER-TE neighbors as L2 (unicasted) BIER packets without requiring a
routing underlay. For forward_routed() adjacencies, BIER-TE forwarding encapsulates
a copy of the BIER packet so that it can be delivered by the forwarding plane
of the routing underlay to the routable destination address indicated in the adjacency.
See <a href="#forward-routed" class="xref">Section 4.2.2</a> for the adjacency definition.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">BIER relies on the routing underlay to calculate paths towards BFERs and derive
next-hop BFR adjacencies for those paths. This commonly relies on BIER specific extensions
to the routing protocols of the routing underlay but may also be established
by a controller. In BIER-TE, the next-hops of a packet are determined by the BitString
through the BIER-TE Controller established adjacencies on the BFR for the BPs of the BitString.
There is thus no need for BFR specific routing underlay extensions to forward BIER packets with
BIER-TE semantics.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">Encapsulation parameters can be provisioned by the BIER-TE controller into 
the forward_connected() or forward_routed() adjacencies directly without relying on a routing underlay.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">If the BFR intends to support FRR for BIER-TE, then the BIER-TE
forwarding plane needs to receive fast adjacency up/down notifications:
Link up/down or neighbor up/down, e.g. from BFD. Providing these notifications
is considered to be part of the routing underlay in this document.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="te-considerations">
<section id="section-3.5">
        <h3 id="name-traffic-engineering-conside">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-traffic-engineering-conside" class="section-name selfRef">Traffic Engineering Considerations</a>
        </h3>
<p id="section-3.5-1">Traffic Engineering (<span>[<a href="#I-D.ietf-teas-rfc3272bis" class="xref">I-D.ietf-teas-rfc3272bis</a>]</span>)
provides performance optimization of operational IP networks while utilizing
 network resources economically and
reliably.  The key elements needed to effect TE are policy, path steering
and resource management. These elements require support at the
control/controller level and within the forwarding plane.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">Policy decisions are made within the BIER-TE control plane, i.e., within
BIER-TE Controllers.  Controllers use policy when composing BitStrings 
and BFR BIFT state. The mapping of user/IP traffic to specific
BitStrings/BIER-TE flows is made based on policy. The specific details of
BIER-TE policies and how a controller uses them are out of scope of this
document.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">Path steering is supported via the definition of a BitString.  BitStrings
used in BIER-TE are composed based on policy and resource management
considerations.  For example, when composing BIER-TE BitStrings, a Controller must take
into account the resources available at each BFR and for each BP
when it is providing congestion-loss-free services such as 
Rate Controlled Service Disciplines <span>[<a href="#RCSD94" class="xref">RCSD94</a>]</span>.  Resource availability 
could be provided for example via routing protocol information, but
may also be obtained via a BIER-TE control protocol such as NETCONF or
any other protocol commonly used by a Controller to understand the resources
of the network it operates on.  The
resource usage of the BIER-TE traffic admitted by the BIER-TE controller
can be solely tracked on the BIER-TE Controller based on local accounting
as long as no forward_routed() adjacencies are used (see <a href="#forward-connected" class="xref">Section 4.2.1</a> for the definition
of forward_routed() adjacencies).  When forward_routed() adjacencies are used,
the paths selected by the underlying routing protocol need to be tracked as well.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">Resource management has implications on the forwarding plane beyond
the BIER-TE defined steering of packets.  This includes allocation of
buffers to guarantee the worst case requirements of admitted RCSD traffic
and potentially policing and/or rate-shaping mechanisms, typically done
via various forms of queuing.  This level of resource control,
while optional, is important in networks that wish to
support congestion management policies to control or regulate the offered
traffic to deliver different levels of service and alleviate congestion
problems, or those networks that wish to control latencies experienced by
specific traffic flows.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="forwarding">
<section id="section-4">
      <h2 id="name-bier-te-forwarding">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-bier-te-forwarding" class="section-name selfRef">BIER-TE Forwarding</a>
      </h2>
<div id="btft">
<section id="section-4.1">
        <h3 id="name-the-bier-te-bit-index-forwa">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-the-bier-te-bit-index-forwa" class="section-name selfRef">The BIER-TE Bit Index Forwarding Table (BIFT)</a>
        </h3>
<p id="section-4.1-1">The BIER-TE BIFT is the equivalent to the BIER BIFT for (non-TE) BIER. It
exists on every BFR running BIER-TE. For every BIER sub-domain (SD) in use for BIER-TE,
it is a table as shown shown in <a href="#adjacencies" class="xref">Figure 4</a>. That example
BIFT assumes a BSL of 8 bit positions (BPs) in the packets BitString.
As in <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span> this BSL is purely used for the example and not a BIER/BIER-TE
supported BSL (minimum BSL is 64).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">A BIER-TE BIFT compares to a BIER BIFT as shown in <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span> as
follows.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">In both BIER and BIER-TE, BIFT rows/entries are indexed in their respective BIER pseudocode
(<span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span> Section 6.5) and BIER-TE pseudocode (<a href="#pseudocode" class="xref">Section 4.4</a>)
by the BIFT-index derived from the packets SI, BSL and the one bit position of the
packets BitString (BP) addressing the BIFT row: BIFT-index = SI * BSL + BP - 1.
BP within a BitString are numbered from 1 to BSL, hence the - 1 offset when converting
to a BIFT-index. This document also uses the notion SI:BP to indicate BIFT rows,
<span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span> uses the equivalent notion SI:BitString, where the BitString is
filled with only the BP for the BIFT row.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">In BIER, each BIFT-index addresses one BFER by its BFR-id = BIFT-index + 1
and is populated on each BFR with the next-hop "BFR Neighbor" (BFR-NBR) towards that BFER.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">In BIER-TE, each BIFT-index and therefore SI:BP indicates one or more adjacencies
between BFRs in the topology and is only populated with those adjacencies  forwarding
entries on the BFR that is the upstream for these adjacencies. The BIFT entry are
empty on all other BFRs.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">In BIER, each BIFT rows also requires a "Forwarding Bit Mask" (F-BM) entry 
for BIER forwarding rules. In BIER-TE forwarding, F-BM is not required, but can be used
when implementing BIER-TE on forwarding hardware derived from BIER forwarding, that
must use F-BM. This is discussed in the first BIER-TE forwarding pseudocode in
 <a href="#pseudocode" class="xref">Section 4.4</a>.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<span id="name-bier-te-bift-with-different"></span><div id="adjacencies">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.1-7.1">
<pre>
  ------------------------------------------------------------------
  | BIFT-index |     | Adjacencies:                                |
  | (SI:BP)    |(FBM)| &lt;empty&gt; or one or more per entry            |
  ==================================================================
  |       BIFT indices for Packets with SI=0                       |
  ------------------------------------------------------------------
  | 0 (0:1)    | ... | forward_connected(interface,neighbor{,DNC}) |
  ------------------------------------------------------------------
  | 1 (0:2)    | ... | forward_connected(interface,neighbor{,DNC}) |
  |            | ... | forward_connected(interface,neighbor{,DNC}) |
  ------------------------------------------------------------------
  |  ...       | ... | ...                                         |
  ------------------------------------------------------------------
  | 4 (0:5)    | ... | local_decap({VRF})                          |
  ------------------------------------------------------------------
  | 5 (0:6)    | ... | forward_routed({VRF,}l3-neighbor)           |
  ------------------------------------------------------------------
  | 6 (0:7)    | ... | &lt;empty&gt;                                     |
  ------------------------------------------------------------------
  | 7 (0:8)    | ... | ECMP((adjacency1,...adjacencyN){,seed})     |
  -----------------------------------------------------------------
  |       BIFT indices for BitString/Packet with SI=1              |
  ------------------------------------------------------------------
  | 9 (1:1)    |     | ...                                         |
  |  ...       |...  | ...                                         |
  ------------------------------------------------------------------
               BIER-TE Bit Index Forwarding Table (BIFT)

</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-bier-te-bift-with-different" class="selfRef">BIER-TE BIFT with different adjacencies</a>
          </figcaption></figure>
</div>
<p id="section-4.1-8">The BIFT is configured for the BIER-TE data plane of a BFR by the BIER-TE
Controller through an appropriate protocol and data-model. The BIFT is then 
used to forward packets, according to the rules
specified in the BIER-TE Forwarding Procedures.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">Note that a BIFT index (SI:BP) may be populated in the BIFT of more
than one BFR to save BPs. See <a href="#rings" class="xref">Section 5.1.6</a> for an example of how a BIER-TE controller
could assign BPs to (logical) adjacencies shared across multiple BFRs,
<a href="#leaf-bfer" class="xref">Section 5.1.3</a> for an example of assigning the same BP to different
adjacencies, and <a href="#reuse" class="xref">Section 5.1.9</a> for general guidelines regarding re-use of BPs across different adjacencies.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">{VRF} indicates the Virtual Routing and Forwarding context into which
the BIER payload is to be delivered. This is optional and depends
on the multicast flow overlay.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="atypes">
<section id="section-4.2">
        <h3 id="name-adjacency-types">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-adjacency-types" class="section-name selfRef">Adjacency Types</a>
        </h3>
<div id="forward-connected">
<section id="section-4.2.1">
          <h4 id="name-forward-connected">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-forward-connected" class="section-name selfRef">Forward Connected</a>
          </h4>
<p id="section-4.2.1-1">A "forward_connected()" adjacency is towards a directly connected
BFR neighbor using an interface address of that BFR on the connecting
interface. A forward_connected() adjacency does not route packets
but only L2 forwards them to the neighbor.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">Packets sent to an adjacency with "DoNotClear" (DNC) set in the
BIFT MUST NOT have the bit position for that adjacency cleared when the
BFR creates a copy for it. The bit position will still be cleared for
copies of the packet made towards other adjacencies. This can be
used for example in ring topologies as explained in <a href="#rings" class="xref">Section 5.1.6</a>.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">For protection against loops from misconfiguration (see <a href="#loops" class="xref">Section 5.2.1</a>),
DNC is only permissible for forward_connected() adjacencies. No need or benefit
of DNC for other type of adjacencies was identified and their risk was not analyzed.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forward-routed">
<section id="section-4.2.2">
          <h4 id="name-forward-routed">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-forward-routed" class="section-name selfRef">Forward Routed</a>
          </h4>
<p id="section-4.2.2-1">A "forward_routed()" adjacency is an adjacency towards a BFR that
uses a (tunneling) encapsulation which will cause the packet to be
forwarded by the routing underlay toward the adjacent BFR.  This can
leverage any feasible encapsulation, such as MPLS or tunneling over IP/IPv6,
as long as the BIER-TE packet can be identified as a payload. This identification
can either rely on the BIER/BIER-TE co-existence mechanisms described in
<a href="#encapsulation" class="xref">Section 4.3</a>, or by explicit support for a BIER-TE payload type
in the tunneling encapsulation.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">forward_routed() adjacencies are necessary to pass BIER-TE traffic across
non BIER-TE capable routers or to minimize the number of required BP by
tunneling over (BIER-TE capable) routers on which neither replication nor
path-steering is desired, or simply to leverage path redundancy and FRR of the
routing underlay towards the next BFR. They may also be useful to a 
multi-subnet adjacent BFR to leverage the routing underlay ECMP 
independent of BIER-TE ECMP (<a href="#forward-ecmp" class="xref">Section 4.2.3</a>).<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forward-ecmp">
<section id="section-4.2.3">
          <h4 id="name-ecmp">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-ecmp" class="section-name selfRef">ECMP</a>
          </h4>
<p id="section-4.2.3-1">(non-TE) BIER ECMP is tied to the BIER BIFT processing semantic and is therefore
not directly usable with BIER-TE.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">A BIER-TE "Equal Cost Multipath" (ECMP()) adjacency as shown in <a href="#adjacencies" class="xref">Figure 4</a>
for BIFT-index 7 has a list of two or more non-ECMP adjacencies as parameters and an optional
seed parameter. When a BIER-TE packet is copied
onto such an ECMP() adjacency, an implementation specific so-called hash function
will select one out of the list's adjacencies to which the packet is forwarded.
If the packet's encapsulation contains an entropy field, the entropy field SHOULD
be respected; two packets with the same value of the entropy field SHOULD be sent on
the same adjacency.  The seed parameter allows to design
hash functions that are easy to implement at high speed without running into
polarization issues across multiple consecutive ECMP hops. See <a href="#ecmp" class="xref">Section 5.1.7</a>
for more explanations.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forward-local">
<section id="section-4.2.4">
          <h4 id="name-local-decapsulation">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-local-decapsulation" class="section-name selfRef">Local Decap(sulation)</a>
          </h4>
<p id="section-4.2.4-1">A "local_decap()" adjacency passes a copy of the payload of
the BIER-TE packet to the protocol ("NextProto") within the BFR (IPv4/IPv6, Ethernet,...) responsible for
that payload according to the packet header fields.
A local_decap() adjacency turns the BFR into a BFER for matching
packets. Local_decap() adjacencies require the BFER to support
routing or switching for NextProto to determine how to further
process the packet.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="encapsulation">
<section id="section-4.3">
        <h3 id="name-encapsulation-co-existence-">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-encapsulation-co-existence-" class="section-name selfRef">Encapsulation / Co-existence with BIER</a>
        </h3>
<p id="section-4.3-1">Specifications for BIER-TE encapsulation are outside the scope of this document.
This section gives explanations and guidelines.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Like <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span>, handling of "Maximum Transmission Unit" (MTU)
limitations is outside the scope of this document and instead part of the
BIER-TE packet encapsulation and/or flow overlay. See for example <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span>, Section 3.
It applies equally to BIER-TE as it does to BIER.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Because a BFR needs to interpret the BitString of a BIER-TE packet differently
from a (non-TE) BIER packet, it is necessary to distinguish BIER from BIER-TE packets.
In the BIER encapsulation <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span>, 
the BIFT-id field of the packet indicates the BIFT of the packet. BIER and BIER-TE can
therefore be run simultaneously, when the BIFT-id address space is shared across
BIER BIFT and BIER-TE BIFT. Partitioning the BIFT-id address space is subject
to BIER-TE/BIER control plane procedures.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">When <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span> is used for BIER with MPLS, BIFT-id address ranges
can be dynamically allocated from MPLS label space only for the set of actually
used SD:BSL BIFT.  This allows to also allocate non-overlapping label ranges for BIFT-id
that are to be used with BIER-TE BIFTs.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">With MPLS, it is also possible to reuse the
same SD space for both BIER-TE and BIER, so that the same SD has both a 
BIER BIFT with a corresponding range of BIFT-ids and disjoint BIER-TE BIFTs with a non-overlapping range of BIFT-ids.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">When a fixed mapping from BSL, SD and SI to BIFT-id is used which does
not explicitly partition the BIFT-id space between BIER and BIER-TE,
such as proposed for non-MPLS forwarding with <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span> encapsulation
in <span>[<a href="#I-D.ietf-bier-non-mpls-bift-encoding" class="xref">I-D.ietf-bier-non-mpls-bift-encoding</a>]</span> 
revision 04, section 5, then it is necessary to allocate disjoint SDs to BIER
and BIER-TE BIFTs so that both can be addressed by the BIFT-ids. The encoding
proposed in section 6. of the same document does not statically encode BSL
or SD into the BIFT-id, but allows for a mapping, and hence could provide for
the same freedom as when MPLS is being used (same or different SD for BIER/BIER-TE).<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">forward_routed() requires an encapsulation that permits to direct unicast encapsulated BIER-TE packets to a specific interface address on a target BFR. With MPLS encapsulation, this can
simply be done via a label stack with that addresses label as the top label - followed
by the label assigned to the (BSL,SD,SI) BitString.
With non-MPLS encapsulation, some form of IP encapsulation would be required (for example IP/GRE).<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">The encapsulation used for forward_routed() adjacencies can equally support
existing advanced adjacency information such as "loose source routes" via e.g. MPLS
label stacks or appropriate header extensions (e.g. for IPv6).<a href="#section-4.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pseudocode">
<section id="section-4.4">
        <h3 id="name-bier-te-forwarding-pseudoco">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-bier-te-forwarding-pseudoco" class="section-name selfRef">BIER-TE Forwarding Pseudocode</a>
        </h3>
<p id="section-4.4-1">
The following pseudocode, <a href="#simple-pseudocode-picture" class="xref">Figure 5</a>, for BIER-TE forwarding is based
on the (non-TE) BIER forwarding pseudocode of <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span>, section 6.5 with one modification.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<span id="name-bier-te-forwarding-pseudocod"></span><div id="simple-pseudocode-picture">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-4.4-2.1">
<pre>
   void ForwardBitMaskPacket_withTE (Packet)
   {
       SI=GetPacketSI(Packet);
       Offset=SI*BitStringLength;
       for (Index = GetFirstBitPosition(Packet-&gt;BitString); Index ;
            Index = GetNextBitPosition(Packet-&gt;BitString, Index)) {
           F-BM = BIFT[Index+Offset]-&gt;F-BM;
           if (!F-BM) continue;                            [3]
           BFR-NBR = BIFT[Index+Offset]-&gt;BFR-NBR;
           PacketCopy = Copy(Packet);
           PacketCopy-&gt;BitString &amp;= F-BM;                  [2]
           PacketSend(PacketCopy, BFR-NBR);
           // The following must not be done for BIER-TE:
           // Packet-&gt;BitString &amp;= ~F-BM;                  [1]
       }
   }
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-bier-te-forwarding-pseudocod" class="selfRef">BIER-TE Forwarding Pseudocode for required functions, based on BIER Pseudocode</a>
          </figcaption></figure>
</div>
<p id="section-4.4-3">In step [2], the F-BM is used to clear bit(s) in PacketCopy.
This step exists in both BIER and BIER-TE, but the F-BMs need to be
populated differently for BIER-TE than for BIER for the desired clearing.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">In BIER, multiple bits of a BitString can have the same BFR-NBR.
When a received packets BitString has more than one of those bits set,
the BIER replication logic has to avoid that more than one PacketCopy is 
sent to that BFR-NBR ([1]). Likewise, the PacketCopy sent to a BFR-NBR
must clear all bits in its BitString that are not routed across BFR-NBR.
This protects against BIER replication on any possible further
BFR to create duplicates ([2]).<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">To solve both [1] and [2] for BIER, the F-BM of each bit index needs to have all
bits set that this BFR wants to route across BFR-NBR. [2] clears
all other bits in PacketCopy-&gt;BitString, and [1] clears those bits from
Packet-&gt;BitString after the first PacketCopy.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6">In BIER-TE, a BFR-NBR in this pseudocode is an adjacency, forward_connected(), forward_routed()
or local_decap(). There is no need for [2] to suppress duplicates in the way
BIER does because in general, different BP would never have the same
adjacency. If a BIER-TE controller actually finds some optimization in
which this would be desirable, then the controller is also responsible to
ensure that only one of those bits is set in any Packet-&gt;BitString, unless
 the controller explicitly wants for duplicates to be created.<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<p id="section-4.4-7">The following points describe how the forwarding bit mask (F-BM) for each BP is configured in the BIFT and how this impacts the BitString of the packet being processed with that BIFT:<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-8">
<li id="section-4.4-8.1">The F-BMs of all BIFT BPs without an adjacency have all their bits clear.
  This will cause [3] to skip further processing of such a BP.<a href="#section-4.4-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-8.2">All BIFT BPs with an adjacency (with DNC flag clear) have an F-BM
  that has only those BPs set for which this BFR does not have an adjacency.
  This causes [2] to clear all bits from PacketCopy-&gt;BitString for which this
  BFR does have an adjacency.<a href="#section-4.4-8.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-8.3">[1] is not performed for BIER-TE. All bit clearing required by BIER-TE
  is performed by [2].<a href="#section-4.4-8.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.4-9">This Forwarding Pseudocode can support the required BIER-TE forwarding
functions (see <a href="#requirements" class="xref">Section 4.6</a>), forward_connected(),
forward_routed() and local_decap(), but not the recommended functions DNC flag
and multiple adjacencies per bit nor the optional function, ECMP() adjacencies.
The DNC flag cannot be supported when using only [1] to mask bits.<a href="#section-4.4-9" class="pilcrow">¶</a></p>
<p id="section-4.4-10">The modified and expanded Forwarding Pseudocode in <a href="#pseudocode-picture" class="xref">Figure 6</a> specifies how to
support all BIER-TE forwarding functions (required, recommended and optional):<a href="#section-4.4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-11.1">
            <p id="section-4.4-11.1.1">This pseudocode eliminates per-bit F-BM, therefore reducing the size of BIFT state by BSL^2*SI and eliminating the need for per-packet-copy BitString masking operations except for adjacencies with the DNC flag set:<a href="#section-4.4-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-11.1.2.1">AdjacentBits[SI] are bit positions with a non-empty list of adjacencies in this BFR BIFT. This can be computed whenever the BIER-TE Controller updates (add/removes) adjacencies in the BIFT.<a href="#section-4.4-11.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.4-11.1.2.2">The BFR needs to create packet copies for these adjacent bits when they are set in the packets BitString. This set of bits is calculated in PktAdjacentBits.<a href="#section-4.4-11.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.4-11.1.2.3">All bit positions to which the BFR creates copies have to be cleared in packet copies to avoid loops. This is done by masking the BitString of the packet with ~AdjacentBits[SI]. When an adjacency has DNC set, this bit position is set again only for the packet copy towards that bit position.<a href="#section-4.4-11.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-11.2">BIFT entries may contain more than one adjacency in support of specific configurations such as <a href="#hubnspoke" class="xref">Section 5.1.5</a>. The code therefore includes a loop over these adjacencies.<a href="#section-4.4-11.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-11.3">The ECMP() adjacency is shown. Its parameters are a seed and a ListOfAdjacencies from which one is picked.<a href="#section-4.4-11.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-11.4">The forward_connected(), forward_routed(), local_decap() adjacencies are shown with their parameters.<a href="#section-4.4-11.4" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-complete-bier-te-forwarding"></span><div id="pseudocode-picture">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-4.4-12.1">
<pre>
 void ForwardBitMaskPacket_withTE (Packet)
 {
     SI = GetPacketSI(Packet);
     Offset = SI * BitStringLength;
     // Determine adjacent bits in the Packets BitString
     PktAdjacentBits = Packet-&gt;BitString &amp; AdjacentBits[SI];

     // Clear adjacent bits in Packet header to avoid loops
     Packet-&gt;BitString &amp;= ~AdjacentBits[SI];

     // Loop over PktAdjacentBits to create packet copies
     for (Index = GetFirstBitPosition(PktAdjacentBits); Index ;
          Index = GetNextBitPosition(PktAdjacentBits, Index)) {
         for adjacency in BIFT[Index+Offset]-&gt;Adjacencies {
             if(adjacency.type == ECMP(ListOfAdjacencies,seed) ) {
                 I = ECMP_hash(sizeof(ListOfAdjacencies),
                               Packet-&gt;Entropy,seed);
                 adjacency = ListOfAdjacencies[I];
             }
             PacketCopy = Copy(Packet);
             switch(adjacency.type) {
                 case forward_connected(interface,neighbor,DNC):
                     if(DNC)
                         PacketCopy-&gt;BitString |= 1&lt;&lt;(Index-1);
                     SendToL2Unicast(PacketCopy,interface,neighbor);

                 case forward_routed({VRF,}l3-neighbor):
                     SendToL3(PacketCopy,{VRF,}l3-neighbor);

                 case local_decap({VRF},neighbor):
                     DecapBierHeader(PacketCopy);
                     PassTo(PacketCopy,{VRF,}Packet-&gt;NextProto);
             }
         }
     }
 }
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-complete-bier-te-forwarding" class="selfRef">Complete BIER-TE Forwarding Pseudocode for required, recommended and optional functions</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="basic">
<section id="section-4.5">
        <h3 id="name-basic-bier-te-forwarding-ex">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-basic-bier-te-forwarding-ex" class="section-name selfRef">Basic BIER-TE Forwarding Example</a>
        </h3>
<p id="section-4.5-1">[RFC Editor: remove this section.]<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">THIS SECTION TO BE REMOVED IN RFC BECAUSE IT WAS SUPERSEDED BY SECTION 1.1 EXAMPLE - IN CASE FINAL REVIES FIND A GOOD REASON TO KEEP IT, BUT DOESN'T SEEM TO SHOW IMPORTANT NEW STUFF OVER INITIAL EXAMPLES.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">Step-by-step example of basic BIER-TE forwarding. This example does not
use ECMP() or forward_routed() adjacencies nor does it try to minimize
the number of required BitPositions for the topology.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<span id="name-bier-te-forwarding-example"></span><div id="forwarding-example">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-4.5-4.1">
<pre>
               [BIER-TE Controller]
                /       |       \
               v        v        v
           .                          .
        | p13   p1 |                  .
        +- BFIR2 --+          |       .
        |  .       | p2   p6  |       .   LAN2
        |  .       +-- BFR3 --+       .   |
        |  .       |          |  p7  p11  |
   Src -+  .                  +-- BFER1 --+
        |  .       | p3   p8  |       .   |
        |  .       +-- BFR4 --+       .   +-- Rcv1
        |  .       |          |       .   |
        |  .       |                  .
        | p14  p4  |                  .
        +- BFIR1 --+          |       .
        |  .       +-- BFR5 --+ p10  p12  |
      LAN1 .       | p5   p9  +-- BFER2 --+
           .                  |       .   +-- Rcv2
           .                          .   |
           .                          .   LAN3
           .                          .
       IP  |..... BIER-TE network.....| IP
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-bier-te-forwarding-example" class="selfRef">BIER-TE Forwarding Example</a>
          </figcaption></figure>
</div>
<p id="section-4.5-5">pXX indicate the BitPositions number
assigned by the BIER-TE Controller to adjacencies in the
BIER-TE topology. For example, p9 is the adjacency towards BFR5
on the LAN connecting to BFER2.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<span id="name-bier-te-forwarding-example-"></span><div id="example-adjacencies">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="section-4.5-6.1">
<pre>
   BIFT BFIR2:
     p13: local_decap
      p2: forward_connected(BFR3)

   BIFT BFR3:
      p1: forward_connected(BFIR2)
      p7: forward_connected(BFER1)
      p8: forward_connected(BFR4)

   BIFT BFER1:
     p11: local_decap
      p6: forward_connected(BFR3)
      p8: forward_connected(BFR4)
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-bier-te-forwarding-example-" class="selfRef">BIER-TE Forwarding Example Adjacencies</a>
          </figcaption></figure>
</div>
<p id="section-4.5-7">...and so on.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<p id="section-4.5-8">For example, we assume that some multicast traffic seen on LAN1 needs to be sent via BIER-TE by BFIR2 towards Rcv1 and Rcv2.  The BIER-TE Controller determines it wants it to pass this traffic across the following paths:<a href="#section-4.5-8" class="pilcrow">¶</a></p>
<span id="name-bier-te-forwarding-example-p"></span><div id="example-paths">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="section-4.5-9.1">
<pre>
              -&gt; BFER1 ---------------&gt; Rcv1
 BFIR2 -&gt; BFR3
              -&gt; BFR4 -&gt; BFR5 -&gt; BFER2 -&gt; Rcv2
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-bier-te-forwarding-example-p" class="selfRef">BIER-TE Forwarding Example Paths</a>
          </figcaption></figure>
</div>
<p id="section-4.5-10">These paths equal to the following BitString:
p2, p5, p7, p8, p10, p11, p12.<a href="#section-4.5-10" class="pilcrow">¶</a></p>
<p id="section-4.5-11">This BitString is assigned by BFIR2 to the example multicast traffic received from LAN1.<a href="#section-4.5-11" class="pilcrow">¶</a></p>
<p id="section-4.5-12">Then BFIR2 forwards this multicast traffic with BIER-TE based on that BitString.
The BIFT of BFIR2 has only p2 and p13 populated. Only p2 is in the BitString and this is
an adjacency towards BFR3. BFIR2 therefore clears p2 in the BitString
 and sends a copy towards BFR2.<a href="#section-4.5-12" class="pilcrow">¶</a></p>
<p id="section-4.5-13">BFR3 sees a BitString of p5,p7,p8,p10,p11,p12.
For those BPs, it has only adjacencies for p7,p8. It creates a copy of the
packet to BFER1 (due to p7) and one to BFR4 (due to p8). It
clears both p7 and p8 before sending.<a href="#section-4.5-13" class="pilcrow">¶</a></p>
<p id="section-4.5-14">BFER1 sees a BitString of p5,p10,p11,p12.
For those BPs, it only has an adjacency for p11.
p11 is a local_decap() adjacency installed
by the BIER-TE Controller to receive a copy of the BIER
packet - dispose of the BIER header and pass the payload to IP multicast.
IP multicast will then forward the packet out to LAN2 because
it did receive PIM or IGMP joins on LAN2 for the traffic.<a href="#section-4.5-14" class="pilcrow">¶</a></p>
<p id="section-4.5-15">Further processing of the packet in BFR4, BFR5 and BFER2
accordingly.<a href="#section-4.5-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements">
<section id="section-4.6">
        <h3 id="name-bfr-requirements-for-bier-t">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-bfr-requirements-for-bier-t" class="section-name selfRef">BFR Requirements for BIER-TE forwarding</a>
        </h3>
<p id="section-4.6-1">BFR that support BIER-TE and BIER MUST support configuration that enables
BIER-TE instead of (non-TE) BIER forwarding rules for all BIFT of one or more
BIER sub-domains. Every BP in a BIER-TE BIFT MUST support to have
zero or one adjacency. BIER-TE forwarding MUST support the adjacency types forward_connected() with the DNC flag not set, forward_routed() and local_decap().
As explained in <a href="#pseudocode" class="xref">Section 4.4</a>, these required BIER-TE forwarding functions
can be implemented via the same Forwarding Pseudocode as BIER forwarding except for
one modification (skipping one masking with F-BM).<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">BIER-TE forwarding SHOULD support forward_connected() adjacencies with a set DNC flag,
as this is highly useful to save bits in rings (see <a href="#rings" class="xref">Section 5.1.6</a>).<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">BIER-TE forwarding SHOULD support more than one adjacency on a bit.
This allows to save bits in hub and spoke scenarios (see <a href="#hubnspoke" class="xref">Section 5.1.5</a>).<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">BIER-TE forwarding MAY support ECMP() adjacencies to save bits in ECMP
scenarios, see <a href="#ecmp" class="xref">Section 5.1.7</a> for an example.
This is an optional requirement, because for ECMP deployments using BIER-TE
one can also leverage ECMP of the routing underlay via forwarded_routed
adjacencies and/or might prefer to have more explicit control of the path
chosen via explicit BP/adjacencies for each ECMP path alternative.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="controller-ops">
<section id="section-5">
      <h2 id="name-bier-te-controller-operatio">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-bier-te-controller-operatio" class="section-name selfRef">BIER-TE Controller Operational Considerations</a>
      </h2>
<div id="bitpositions">
<section id="section-5.1">
        <h3 id="name-bit-position-assignments">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-bit-position-assignments" class="section-name selfRef">Bit Position Assignments</a>
        </h3>
<p id="section-5.1-1">This section describes how the BIER-TE Controller can use the
different BIER-TE adjacency types to define the bit positions of a BIER-TE domain.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Because the size of the BitString limits the size of the
BIER-TE domain, many of the options described exist to support larger
topologies with fewer bit positions.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="p2p-links">
<section id="section-5.1.1">
          <h4 id="name-p2p-links">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-p2p-links" class="section-name selfRef">P2P Links</a>
          </h4>
<p id="section-5.1.1-1">On a P2P link that connects two BFRs, the same bit position can be used on
both BFRs for the adjacency to the neighboring BFR. A P2P link requires therefore
only one bit position.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bfer">
<section id="section-5.1.2">
          <h4 id="name-bfer">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-bfer" class="section-name selfRef">BFER</a>
          </h4>
<p id="section-5.1.2-1">Every non-Leaf BFER is given a unique bit position with a local_decap() adjacency.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="leaf-bfer">
<section id="section-5.1.3">
          <h4 id="name-leaf-bfers">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-leaf-bfers" class="section-name selfRef">Leaf BFERs</a>
          </h4>
<span id="name-leaf-vs-non-leaf-bfer-examp"></span><div id="leaf-bfer-picture">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-5.1.3-1.1">
<pre>
        BFR1(P) BFR2(P)             BFR1(P)  BFR2(P)
          |  \ /  |                    |       |
          |   X   |                    |       |
          |  / \  |                    |       |
     BFER1(PE)  BFER2(PE)        BFER1(PE)----BFER2(PE)

                                           ^ U-turn link

         Leaf BFER /               Non-Leaf BFER /
          PE-router                  PE-router
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-leaf-vs-non-leaf-bfer-examp" class="selfRef">Leaf vs. non-Leaf BFER Example</a>
            </figcaption></figure>
</div>
<p id="section-5.1.3-2">A leaf BFER is one where incoming BIER-TE packets never need to
be forwarded to another BFR but are only sent to the BFER
to exit the BIER-TE domain. For example, in networks where Provider Edge (PE) router
are spokes connected to Provider (P) routers, those PEs are Leaf BFERs unless
there is a U-turn between two PEs.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.1.3-3">Consider how redundant disjoint
traffic can reach BFER1/BFER2 in <a href="#leaf-bfer-picture" class="xref">Figure 10</a>: When BFER1/BFER2
are Non-Leaf BFER as shown on the right-hand side, one traffic
copy would be forwarded to BFER1 from BFR1, but the other one
could only reach BFER1 via BFER2, which makes BFER2 a non-Leaf
BFER. Likewise, BFER1 is a non-Leaf BFER when forwarding traffic to BFER2.
Note that the BFERs in the left-hand picture are only guaranteed to
be leaf-BFER by fitting routing configuration that prohibits transit
traffic to pass through the BFERs, which is commonly applied in these
topologies.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
<p id="section-5.1.3-4">In most situations, leaf-BFER that are to be addressed via the same BitString can share a single bit position for their local_decap() adjacency in that BitString and therefore save bit positions. On a non-leaf BFER, a received BIER-TE packet may only need to transit the BFER or it may need to also be decapsulated. Whether or not to decapsulate the packet therefore needs to be indicated by a unique bit position populated only on the BIFT of this BFER with a local_decap() adjacency. On a leaf-BFER, packets never need to pass through; any packet received is therefore usually intended to be decapsulated. This can be expressed by a single, shared bit position that is populated with a local_decap() adjacency on all leaf-BFER addressed by the BitString.<a href="#section-5.1.3-4" class="pilcrow">¶</a></p>
<p id="section-5.1.3-5">The possible exception from this leaf-BFER bit position optimization can be cases where the bit position on the prior BIER-TE BFR (which created the packet copy for the leaf-BFER in question) is populated with multiple adjacencies as an optimization, such as in <a href="#lans" class="xref">Section 5.1.4</a> or <a href="#hubnspoke" class="xref">Section 5.1.5</a>. With either of these two optimizations, the sender of the packet could only control explicitly whether the packet was to be decapsulated on the leaf-BFER in question, if the leaf-BFER has a unique bit position for its local_decap() adjacency.<a href="#section-5.1.3-5" class="pilcrow">¶</a></p>
<p id="section-5.1.3-6">However, if the bit position is shared across leaf-BFER, and packets are therefore decapsulated potentially unnecessarily, this may still be appropriate if the decapsulated payload of the BIER-TE packet does indicate whether or not the packet needs to be further processed/received. This is typically true for example if the payload is IP multicast because IP multicast on a BFER would know the membership state of the IP multicast payload and be able to discard it if the packet was delivered unnecessarily by the BIER-TE layer. If the payload has no such membership indication, and the BFIR wants to have explicit control about which BFER are to receive and decapsulate a packet, then these two optimizations can not be used together with shared bit positions optimization for leaf-BFER.<a href="#section-5.1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lans">
<section id="section-5.1.4">
          <h4 id="name-lans">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-lans" class="section-name selfRef">LANs</a>
          </h4>
<p id="section-5.1.4-1">In a LAN, the adjacency to each neighboring BFR
is given a unique bit position. The adjacency of this bit position
is a forward_connected() adjacency towards the BFR and this bit position
is populated into the BIFT of all the other BFRs on that LAN.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<span id="name-lan-example"></span><div id="lan-picture">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-5.1.4-2.1">
<pre>
                                 BFR1
                                  |p1
                           LAN1-+-+---+-----+
                               p3|  p4|   p2|
                               BFR3 BFR4  BFR7
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-lan-example" class="selfRef">LAN Example</a>
            </figcaption></figure>
</div>
<p id="section-5.1.4-3">If Bandwidth on the LAN is not an issue and most BIER-TE traffic
should be copied to all neighbors on a LAN, then bit positions
can be saved by assigning just a single bit position to the LAN
and populating the bit position of the BIFTs of each BFRs on
the LAN with a list of forward_connected() adjacencies to all other
neighbors on the LAN.<a href="#section-5.1.4-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4-4">This optimization does not work in the case of BFRs redundantly
connected to more than one LAN with this optimization because
these BFRs would receive duplicates and forward those duplicates into
the opposite LANs. Adjacencies of such BFRs into their LAN still
need a separate bit position.<a href="#section-5.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hubnspoke">
<section id="section-5.1.5">
          <h4 id="name-hub-and-spoke">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-hub-and-spoke" class="section-name selfRef">Hub and Spoke</a>
          </h4>
<p id="section-5.1.5-1">In a setup with a hub and multiple spokes connected via separate
p2p links to the hub, all p2p adjacencies from the hub to the spokes links can share the same bit position.
The bit position on the hub's BIFT is  set up with a list of
forward_connected() adjacencies, one for each Spoke.<a href="#section-5.1.5-1" class="pilcrow">¶</a></p>
<p id="section-5.1.5-2">This option is similar to the bit position optimization in
LANs: Redundantly connected spokes need their own bit positions,
unless they are themselves Leaf-BFER.<a href="#section-5.1.5-2" class="pilcrow">¶</a></p>
<p id="section-5.1.5-3">This type of optimized BP could be used for example when all
traffic is "broadcast" traffic (very dense receiver set)
such as live-TV or many-to-many telemetry including situation-awareness (SA).
This BP optimization can then be used to explicitly steer different traffic
flows across different ECMP paths in Data-Center or broadband-aggregation
networks with minimal use of BPs.<a href="#section-5.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rings">
<section id="section-5.1.6">
          <h4 id="name-rings">
<a href="#section-5.1.6" class="section-number selfRef">5.1.6. </a><a href="#name-rings" class="section-name selfRef">Rings</a>
          </h4>
<p id="section-5.1.6-1">In L3 rings, instead of assigning a single bit position for
every p2p link in the ring, it is possible to save bit positions by
setting the "DoNotClear" (DNC) flag on forward_connected() adjacencies.<a href="#section-5.1.6-1" class="pilcrow">¶</a></p>
<p id="section-5.1.6-2">For the rings shown in <a href="#ring-picture" class="xref">Figure 12</a>, a single bit position
will suffice to forward traffic entering the ring at BFRa or BFRb
all the way up to BFR1:<a href="#section-5.1.6-2" class="pilcrow">¶</a></p>
<p id="section-5.1.6-3">On BFRa, BFRb, BFR30,... BFR3, the bit position is populated with
a forward_connected() adjacency pointing to the clockwise neighbor
on the ring and with DNC set. On BFR2, the adjacency also points
to the clockwise neighbor BFR1, but without DNC set.<a href="#section-5.1.6-3" class="pilcrow">¶</a></p>
<p id="section-5.1.6-4">Handling DNC this way ensures that copies forwarded from any BFR in
the ring to a BFR outside the ring will not have the ring bit position set,
therefore minimizing the chance to create loops.<a href="#section-5.1.6-4" class="pilcrow">¶</a></p>
<span id="name-ring-example"></span><div id="ring-picture">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-5.1.6-5.1">
<pre>
               v        v
               |        |
        L1     |   L2   |   L3
    /-------- BFRa ---- BFRb --------------------\
    |                                            |
    \- BFR1 - BFR2 - BFR3 - ... - BFR29 - BFR30 -/
        |      |    L4               |      |
     p33|                         p15|
        BFRd                       BFRc
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-ring-example" class="selfRef">Ring Example</a>
            </figcaption></figure>
</div>
<p id="section-5.1.6-6">Note that this example only permits for packets intended to make it all
the way around the ring to enter it at
BFRa and BFRb, and that packets will always travel clockwise. If
packets should be allowed to enter the ring at any ring BFR, then one
would have to use two ring bit positions. One for each direction:
clockwise and counterclockwise.<a href="#section-5.1.6-6" class="pilcrow">¶</a></p>
<p id="section-5.1.6-7">Both would be set up to stop rotating on the same link, e.g. L1. When the
ingress ring BFR creates the clockwise copy, it will clear the counterclockwise
bit position because the DNC bit only applies to the bit for which the
replication is done. Likewise for the clockwise
bit position for the counterclockwise copy. As a result, the ring ingress
BFR will send a copy in both directions, serving BFRs on either side of the
ring up to L1.<a href="#section-5.1.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecmp">
<section id="section-5.1.7">
          <h4 id="name-equal-cost-multipath-ecmp">
<a href="#section-5.1.7" class="section-number selfRef">5.1.7. </a><a href="#name-equal-cost-multipath-ecmp" class="section-name selfRef">Equal Cost MultiPath (ECMP)</a>
          </h4>
<p id="section-5.1.7-1">[RFC-Editor: A reviewer (Lars Eggert) noted that the infinite "to use" in the following sentence is not correct. The same was also noted for several other similar instances. The following URL seems to indicate though that this is a per-case decision, which seems undefined: https://writingcenter.gmu.edu/guides/choosing-between-infinitive-and-gerund-to-do-or-doing. What exactly should be done about this ?].<a href="#section-5.1.7-1" class="pilcrow">¶</a></p>
<p id="section-5.1.7-2">An ECMP() adjacency allows to use just one BP to deliver packets
to one one of N adjacencies instead of one BP for each adjacency. 
In the common example case <a href="#ecmp-picture" class="xref">Figure 13</a>,
a link-bundle of three links L1,L2,L3 connects BFR1 and BFR2, and
only one BP is used instead of three BP to deliver packets from
BFR1 to BFR2.<a href="#section-5.1.7-2" class="pilcrow">¶</a></p>
<span id="name-ecmp-example"></span><div id="ecmp-picture">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-5.1.7-3.1">
<pre>
             --L1-----
        BFR1 --L2----- BFR2
             --L3-----

  BIFT entry in BFR1:
  ------------------------------------------------------------------
  | Index |  Adjacencies                                           |
  ==================================================================
  | 0:6   |  ECMP({forward_connected(L1, BFR2),                    |
  |       |        forward_connected(L2, BFR2),                    |
  |       |        forward_connected(L3, BFR2)}, seed)             |
  ------------------------------------------------------------------

  BIFT entry in BFR2:
  ------------------------------------------------------------------
  | Index |  Adjacencies                                           |
  ==================================================================
  | 0:6   |  ECMP({forward_connected(L1, BFR1),                    |
  |       |        forward_connected(L2, BFR1),                    |
  |       |        forward_connected(L3, BFR1)}, seed)             |
  ------------------------------------------------------------------
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-ecmp-example" class="selfRef">ECMP Example</a>
            </figcaption></figure>
</div>
<p id="section-5.1.7-4">This document does not standardize any ECMP algorithm because it
is sufficient for implementations to document their freely chosen 
ECMP algorithm.
<a href="#ecmp-algo-picture" class="xref">Figure 14</a> shows an example ECMP algorithm,
and would double as its documentation: A BIER-TE controller could
determine which adjacency is chosen based on the seed and adjacencies parameters
and the packet entropy.<a href="#section-5.1.7-4" class="pilcrow">¶</a></p>
<span id="name-ecmp-algorithm-example"></span><div id="ecmp-algo-picture">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-5.1.7-5.1">
<pre>

   forward(packet, ECMP(adj(0), adj(1),... adj(N-1), seed)):
      i = (packet(bier-header-entropy) XOR seed) % N
      forward packet to adj(i)

</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-ecmp-algorithm-example" class="selfRef">ECMP algorithm Example</a>
            </figcaption></figure>
</div>
<p id="section-5.1.7-6">In the following example, all traffic from BFR1 towards BFR10 is
intended to be ECMP load split equally across the topology. This
example is not meant as a likely setup, but to illustrate that ECMP can
be used to share BPs not only across link bundles, but also across
alternative paths across different transit BFR, and it explains
the use of the seed parameter.<a href="#section-5.1.7-6" class="pilcrow">¶</a></p>
<span id="name-polarization-example"></span><div id="polarization-picture">
<figure id="figure-15">
            <div class="alignLeft art-text artwork" id="section-5.1.7-7.1">
<pre>
                 BFR1         (BFIR)
               /L11  \L12
              /       \
          BFR2         BFR3
         /L21 \L22    /L31 \L32
        /      \     /      \
       BFR4  BFR5   BFR6  BFR7
        \      /     \      /
         \    /       \    /
          BFR8         BFR9
              \       /
               \     /
                BFR10         (BFER)

  BIFT entry in BFR1:
  ------------------------------------------------------------------
  | 0:6   |  ECMP({forward_connected(L11, BFR2),                   |
  |       |        forward_connected(L12, BFR3)}, seed1)           |
  ------------------------------------------------------------------

  BIFT entry in BFR2:
  ------------------------------------------------------------------
  | 0:7   |  ECMP({forward_connected(L21, BFR4),                   |
  |       |        forward_connected(L22, BFR5)}, seed1)           |
  ------------------------------------------------------------------

  BIFT entry in BFR3:
  ------------------------------------------------------------------
  | 0:7   |  ECMP({forward_connected(L31, BFR6),                   |
  |       |        forward_connected(L32, BFR7)}, seed1)           |
  ------------------------------------------------------------------

  BIFT entry in BFR4, BFR5:
  ------------------------------------------------------------------
  | 0:8   |  forward_connected(Lxx, BFR8)  |xx differs on BFR4/BFR5|
  ------------------------------------------------------------------

  BIFT entry in BFR6, BFR7:
  ------------------------------------------------------------------
  | 0:8   |  forward_connected(Lxx, BFR9)  |xx differs on BFR6/BFR7|
  ------------------------------------------------------------------

  BIFT entry in BFR8, BFR9:
  ------------------------------------------------------------------
  | 0:9   |  forward_connected(Lxx, BFR10) |xx differs on BFR8/BFR9|
  ------------------------------------------------------------------

</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-polarization-example" class="selfRef">Polarization Example</a>
            </figcaption></figure>
</div>
<p id="section-5.1.7-8">Note that for the following discussion of ECMP, only the BIFT ECMP
adjacencies on BFR1, BFR2, BFR3 are relevant. The re-use of BP across
BFR in this example is further explained in <a href="#reuse" class="xref">Section 5.1.9</a>
below.<a href="#section-5.1.7-8" class="pilcrow">¶</a></p>
<p id="section-5.1.7-9"> With the setup of ECMP in the topology above, traffic would not be
equally load-split. Instead, links L22 and L31 would see no traffic
at all: BFR2 will only see traffic from BFR1 for which the ECMP
hash in BFR1 selected the first adjacency in the list of 2 adjacencies
given as parameters to the ECMP. It is link L11-to-BFR2. BFR2 performs 
again ECMP with two adjacencies on that subset of traffic using the same
seed1, and will therefore again select the first of its two adjacencies:
L21-to-BFR4. And therefore L22 and BFR5 sees no traffic. Likewise for
L31 and BFR6.<a href="#section-5.1.7-9" class="pilcrow">¶</a></p>
<p id="section-5.1.7-10">This issue in BFR2/BFR3 is called polarization. It results from the
re-use of the same hash function across multiple consecutive hops in
topologies like these.  To resolve this issue, the ECMP() adjacency on BFR1 
can be set up with a different seed2 than the ECMP() adjacencies on BFR2/BFR3.
BFR2/BFR3 can use the same hash because packets will not sequentially
pass across both of them. Therefore, they can also use the same BP 0:7.<a href="#section-5.1.7-10" class="pilcrow">¶</a></p>
<p id="section-5.1.7-11">Note that ECMP solutions outside of BIER often hide the
seed by auto-selecting it from local entropy such as unique local or
next-hop identifiers. Allowing the BIER-TE Controller to explicitly set the seed gives
the ability for it to control same/different path selection across multiple
consecutive ECMP hops.<a href="#section-5.1.7-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routed">
<section id="section-5.1.8">
          <h4 id="name-forward-routed-adjacencies">
<a href="#section-5.1.8" class="section-number selfRef">5.1.8. </a><a href="#name-forward-routed-adjacencies" class="section-name selfRef">Forward Routed adjacencies</a>
          </h4>
<div id="reducing">
<section id="section-5.1.8.1">
            <h5 id="name-reducing-bit-positions">
<a href="#section-5.1.8.1" class="section-number selfRef">5.1.8.1. </a><a href="#name-reducing-bit-positions" class="section-name selfRef">Reducing bit positions</a>
            </h5>
<p id="section-5.1.8.1-1">Forward_routed() adjacencies can reduce the number of bit positions
required when the path steering requirement is not hop-by-hop
explicit path selection, but loose-hop selection. Forward_routed() adjacencies
can also allow to operate BIER-TE across intermediate hop routers
that do not support BIER-TE.<a href="#section-5.1.8.1-1" class="pilcrow">¶</a></p>
<span id="name-forward-routed-adjacencies-"></span><div id="routed-picture">
<figure id="figure-16">
              <div class="alignLeft art-text artwork" id="section-5.1.8.1-2.1">
<pre>
                   ...............
         ...BFR1--...           ...--L1-- BFR2...
                  ... .Routers. ...--L2--/
         ...BFR4--...           ...--L3-- BFR3...
                  ...           ...--L4--/ |
                   ...............         |
                                          LO
                    Network Area 1
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-forward-routed-adjacencies-" class="selfRef">Forward Routed Adjacencies Example</a>
              </figcaption></figure>
</div>
<p id="section-5.1.8.1-3">Assume the requirement in <a href="#routed-picture" class="xref">Figure 16</a> is to explicitly steer 
traffic flows that have arrived at BFR1 or BFR4 via a path
in the routing underlay "Network Area 1" to one of the following three next
segments: (1) BFR2 via link L1, (2) BFR2 via link L2, or (3) via BFR3 and then
nor caring whether the packet is forwarded via L3 or L4.<a href="#section-5.1.8.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.8.1-4">To enable this, both BFR1 and BFR4 are set up with a forward_routed
adjacency bit position towards an address of BFR2 on link L1, another
forward_routed() bit position towards an address of BFR2 on link L2 and a third
forward_routed() bit position towards a node address LO of BFR3.<a href="#section-5.1.8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="without">
<section id="section-5.1.8.2">
            <h5 id="name-supporting-nodes-without-bi">
<a href="#section-5.1.8.2" class="section-number selfRef">5.1.8.2. </a><a href="#name-supporting-nodes-without-bi" class="section-name selfRef">Supporting nodes without BIER-TE</a>
            </h5>
<p id="section-5.1.8.2-1">Forward_routed() adjacencies also enable incremental deployment of BIER-TE.
Only the nodes through which BIER-TE traffic needs to be steered -
with or without replication - need to support BIER-TE. Where
they are not directly connected to each other, forward_routed
adjacencies are used to pass over non BIER-TE enabled nodes.<a href="#section-5.1.8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="reuse">
<section id="section-5.1.9">
          <h4 id="name-reuse-of-bit-positions-with">
<a href="#section-5.1.9" class="section-number selfRef">5.1.9. </a><a href="#name-reuse-of-bit-positions-with" class="section-name selfRef">Reuse of bit positions (without DNC)</a>
          </h4>
<p id="section-5.1.9-1">Bit positions can be re-used across multiple BFRs to minimize the number
of BP needed. This happens when adjacencies on multiple BFRs use the DNC
flag as described above, but it can also be done for non-DNC adjacencies.
This section only discusses this non-DNC case.<a href="#section-5.1.9-1" class="pilcrow">¶</a></p>
<p id="section-5.1.9-2">Because BP are cleared when passing a BFR with an adjacency for that
BP, reuse of BP across multiple BFRs does not introduce any problems
with duplicates or loops that do not also exist when every adjacency has
a unique BP. Instead, the challenge when reusing BP is whether it
allows to still achieve the desired Tree Engineering goals.<a href="#section-5.1.9-2" class="pilcrow">¶</a></p>
<p id="section-5.1.9-3">BP cannot be reused across two BFRs that would need to be passed
sequentially for some path: The first BFR will clear the BP, so those
paths cannot be built. BP can be set across BFR that would (A) only
occur across different paths or (B) across different branches of the same tree.<a href="#section-5.1.9-3" class="pilcrow">¶</a></p>
<p id="section-5.1.9-4">An example of (A) was given in <a href="#polarization-picture" class="xref">Figure 15</a>,
where BP 0:7, BP 0:8 and BP 0:9 are each reused across multiple BFRs because
a single packet/path would never be able to reach more than one BFR 
sharing the same BP.<a href="#section-5.1.9-4" class="pilcrow">¶</a></p>
<p id="section-5.1.9-5">Assume the example was changed: BFR1 has no ECMP() adjacency for BP 0:6,
but instead BP 0:5 with forward_connected() to BFR2 and BP 0:6 with
forward_connected() to BFR3.  Packets with both BP 0:5 and BP 0:6 would
now be able to reach both BFR2 and BFR3 and the still existing re-use
of BP 0:7 between BFR2 and BFR3 is a case of (B) where reuse of BP
is perfect because it does not limit the set of useful path choices:<a href="#section-5.1.9-5" class="pilcrow">¶</a></p>
<p id="section-5.1.9-6">If instead of reusing BP 0:7, BFR3 used a separate BP 0:10 for its
ECMP() adjacency, no useful additional path steering options would be enabled.
If duplicates at BFR10 where undesirable, this would be done by not
setting BP 0:5 and BP 0:6 for the same packet. If the duplicates where
desirable (e.g.: resilient transmission), the additional BP 0:10
would also not render additional value.<a href="#section-5.1.9-6" class="pilcrow">¶</a></p>
<span id="name-reuse-of-bp"></span><div id="scaling-picture2">
<figure id="figure-17">
            <div class="alignLeft art-text artwork" id="section-5.1.9-7.1">
<pre>
                       area1
                   BFR1a BFR1b
                     /    \
        ....................................
        .                Core              .
        ....................................
        |    /       \    /           \  |
      BFR2a BFR2b  BFR3a BFR3b      BFR6a BFR6b
       /-------\   /---------\      /--------\
       | area2 |   |  area3  | ...  | area6  |
       | ring  |   |  ring   |      | ring   |
       \-------/   \---------/      \--------/
        more BFR     more BFR        more BFR
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-reuse-of-bp" class="selfRef">Reuse of BP</a>
            </figcaption></figure>
</div>
<p id="section-5.1.9-8">Reuse may also save BPs in larger topologies.  Consider the topology
shown in <a href="#scaling-picture2" class="xref">Figure 17</a>. A BFIR/sender (e.g.: video headend) is attached to area 1,
and area 2...6 contain receivers/BFER. Assume each area had a distribution
ring, each with two BPs to indicate the direction (as explained before). 
These two BPs could be reused across the 5 areas.  Packets would be replicated
through other BPs for the Core to the desired subset of areas, and once a packet copy
reaches the ring of the area, the two ring BPs come into play. This reuse is 
a case of (B), but it limits the topology choices: Packets
can only flow around the same direction in the rings of all areas. This may or may not
be acceptable based on the desired path steering options: If resilient
transmission is the path engineering goal, then it is likely a good
optimization, if the bandwidth of each ring was to be optimized separately,
it would not be a good limitation.<a href="#section-5.1.9-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bits-summary">
<section id="section-5.1.10">
          <h4 id="name-summary-of-bp-optimizations">
<a href="#section-5.1.10" class="section-number selfRef">5.1.10. </a><a href="#name-summary-of-bp-optimizations" class="section-name selfRef">Summary of BP optimizations</a>
          </h4>
<p id="section-5.1.10-1">This section reviewed a range of techniques by which a BIER-TE Controller can create
a BIER-TE topology in a way that minimizes the number of necessary BPs.<a href="#section-5.1.10-1" class="pilcrow">¶</a></p>
<p id="section-5.1.10-2">Without any optimization, a BIER-TE Controller would attempt to map the network
subnet topology 1:1 into the BIER-TE topology and  every subnet adjacent
neighbor requires a forward_connected() BP and every BFER requires a local_decap() BP.<a href="#section-5.1.10-2" class="pilcrow">¶</a></p>
<p id="section-5.1.10-3">The optimizations described are then as follows:<a href="#section-5.1.10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.10-4.1">P2P links require only one BP (<a href="#p2p-links" class="xref">Section 5.1.1</a>).<a href="#section-5.1.10-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.10-4.2">All leaf-BFER can share a single local_decap() BP (<a href="#leaf-bfer" class="xref">Section 5.1.3</a>).<a href="#section-5.1.10-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.10-4.3">A LAN with N BFR needs at most N BP (one for each BFR). It only needs one BP for all those BFR that are not redundantly connected to multiple LANs (<a href="#lans" class="xref">Section 5.1.4</a>).<a href="#section-5.1.10-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.10-4.4">A hub with p2p connections to multiple non-leaf-BFER spokes can share one BP to all spokes if traffic can be flooded to all spokes, e.g.: because of no bandwidth concerns or dense receiver sets (<a href="#hubnspoke" class="xref">Section 5.1.5</a>).<a href="#section-5.1.10-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.10-4.5">Rings of BFR can be built with just two BP (one for each direction) except for BFR with multiple ring connections - similar to LANs (<a href="#rings" class="xref">Section 5.1.6</a>).<a href="#section-5.1.10-4.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.10-4.6">ECMP() adjacencies to N neighbors can replace N BP with 1 BP. Multihop ECMP can avoid polarization through different seeds of the ECMP algorithm (<a href="#ecmp" class="xref">Section 5.1.7</a>).<a href="#section-5.1.10-4.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.10-4.7">Forward_routed() adjacencies allow to "tunnel" across non-BIER-TE capable routers and across BIER-TE capable routers where no traffic-steering or replications are required (<a href="#routed" class="xref">Section 5.1.8</a>).<a href="#section-5.1.10-4.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.10-4.8">BP can generally be reused across a set of nodes where it can be guaranteed that no path will
ever need to traverse more than one node of the set. Depending on scenario, this may limit the feasible path steering options (<a href="#reuse" class="xref">Section 5.1.9</a>).<a href="#section-5.1.10-4.8" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.10-5">Note that the described list of optimizations is not exhaustive. Especially when the set of required path steering choices is limited and the set of possible subsets of BFERs that should be able to receive traffic is limited, further optimizations of BP are possible. The hub and spoke optimization is a simple example of such traffic pattern dependent optimizations.<a href="#section-5.1.10-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="avoiding">
<section id="section-5.2">
        <h3 id="name-avoiding-duplicates-and-loo">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-avoiding-duplicates-and-loo" class="section-name selfRef">Avoiding duplicates and loops</a>
        </h3>
<div id="loops">
<section id="section-5.2.1">
          <h4 id="name-loops">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-loops" class="section-name selfRef">Loops</a>
          </h4>
<p id="section-5.2.1-1">Whenever BIER-TE creates a copy of a packet, the BitString of
that copy will have all bit positions cleared that are associated
with adjacencies on the BFR. This inhibits looping of packets.
The only exception are adjacencies with DNC set.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<span id="name-miswired-ring-example"></span><div id="ring-picture2">
<figure id="figure-18">
            <div class="alignLeft art-text artwork" id="section-5.2.1-2.1">
<pre>
               v        v
               |        |
        L1     |   L2   |   L3
    /-------- BFRa ---- BFRb ---------------------\
    |        .                                    |
    |         ......  Wrong link wiring           |
    |               .                             |
    \- BFR1 - BFR2   BFR3 - ... - BFR29 - BFR30 -/
        |      |    L4               |      |
     p33|                         p15|
        BFRd                       BFRc
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-miswired-ring-example" class="selfRef">Miswired Ring Example</a>
            </figcaption></figure>
</div>
<p id="section-5.2.1-3">With DNC set, looping can happen.  Consider in <a href="#ring-picture2" class="xref">Figure 18</a>
that link L4 from BFR3 is (inadvertently) plugged into the L1 interface of
BFRa (instead of BFR2). This creates a loop where the rings clockwise bit position is
never cleared for copies of the packets traveling clockwise
around the ring.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">To inhibit looping in the face of such physical misconfiguration,
only forward_connected() adjacencies are permitted to have DNC set,
and the link layer port unique unicast destination address of the adjacency (e.g. MAC address)
protects against closing the loop. Link layers without port unique
link layer addresses should not be used with the DNC flag set.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="duplicates">
<section id="section-5.2.2">
          <h4 id="name-duplicates">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-duplicates" class="section-name selfRef">Duplicates</a>
          </h4>
<span id="name-duplicates-example"></span><div id="duplicates-picture">
<figure id="figure-19">
            <div class="alignLeft art-text artwork" id="section-5.2.2-1.1">
<pre>
                 BFIR1
                /    \
               / p2   \ p3
              BFR2   BFR3
               \ p4   / p5
                \    /
                 BFER4
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-duplicates-example" class="selfRef">Duplicates Example</a>
            </figcaption></figure>
</div>
<p id="section-5.2.2-2">Duplicates happen when the graph expressed by a BitString is not a
tree but redundantly connecting BFRs with each other. In <a href="#duplicates-picture" class="xref">Figure 19</a>,
a BitString of p2,p3,p4,p5 would result in duplicate packets to arrive on BFER4.
The BIER-TE Controller must therefore ensure to only create BitStrings that are trees.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">When links are incorrectly physically re-connected before the
BIER-TE Controller updates BitStrings in BFIRs, duplicates can happen.
Like loops, these can be inhibited by link layer addressing
in forward_connected() adjacencies.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4">If interface or loopback addresses used in forward_routed() adjacencies
are moved from one BFR to another, duplicates can equally happen.
Such re-addressing operations must be coordinated with the BIER-TE Controller.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="mgmt-stuff">
<section id="section-5.3">
        <h3 id="name-managing-si-sub-domains-and">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-managing-si-sub-domains-and" class="section-name selfRef">Managing SI, sub-domains and BFR-ids</a>
        </h3>
<p id="section-5.3-1">When the number of bits required to represent the necessary hops
in the topology and BFER exceeds the supported BitStringLength (BSL),
multiple SIs and/or sub-domains must be used. This section discusses how.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">BIER-TE forwarding does not require the concept of BFR-id, but routing
underlay, flow overlay and BIER headers may. This section also discusses
how BFR-ids can be assigned to BFIR/BFER for BIER-TE.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div id="why">
<section id="section-5.3.1">
          <h4 id="name-why-si-and-sub-domains">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-why-si-and-sub-domains" class="section-name selfRef">Why SI and sub-domains</a>
          </h4>
<p id="section-5.3.1-1">For (non-TE) BIER and BIER-TE forwarding, the most important result of using multiple
SI and/or sub-domains is the same: Packets that need to be sent to BFERs in
different SIs or sub-domains require different BIER packets: each one with a
BitString for a different (SI,sub-domain) combination. Each such BitString uses
one BSL sized SI block in the BIFT of the sub-domain. We call this
a BIFT:SI (block).<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">For BIER and BIER-TE forwarding themselves there is also no difference whether
different SIs and/or sub-domains are chosen, but SI and sub-domain have
different purposes in the BIER architecture shared by BIER-TE.
This impacts how operators are managing them and how especially flow overlays
will likely use them.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3">By default, every possible BFIR/BFER in a BIER network would likely be given
a BFR-id in sub-domain 0 (unless there are &gt; 64k BFIR/BFER).<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
<p id="section-5.3.1-4">If there are different flow services (or service instances) requiring replication
to different subsets of BFERs, then it will likely not be possible to achieve
the best replication efficiency for all of these service instances via sub-domain 0.

Ideal replication efficiency for N BFER exists in a sub-domain if they are
split over not more than ceiling(N/BitStringLength) SI.<a href="#section-5.3.1-4" class="pilcrow">¶</a></p>
<p id="section-5.3.1-5">If service instances justify additional BIER:SI state in the network, additional
sub-domains will be used: BFIR/BFER are assigned BFR-id in those sub-domains
and each service instance is configured to use the most appropriate sub-domain.
This results in improved replication efficiency for different services.<a href="#section-5.3.1-5" class="pilcrow">¶</a></p>
<p id="section-5.3.1-6">Even if creation of sub-domains and assignment of BFR-id to BFIR/BFER in those
sub-domains is automated, it is not expected that individual
service instances can deal with BFER in different sub-domains. A service
instance may only support configuration of a single sub-domain it should rely on.<a href="#section-5.3.1-6" class="pilcrow">¶</a></p>
<p id="section-5.3.1-7">To be able to easily reuse (and modify as little as possible) existing
BIER procedures including flow-overlay and routing underlay, when BIER-TE
forwarding is added, we therefore reuse SI and sub-domain logically in the
same way as they are used in BIER: All necessary BFIR/BFER for a service use
a single BIER-TE BIFT and are split across as many SIs as necessary (see <a href="#bit-requirements" class="xref">Section 5.3.2</a>).
Different services may use different sub-domains that primarily exist to
provide more efficient replication (and for BIER-TE desirable path steering)
for different subsets of BFIR/BFER.<a href="#section-5.3.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bit-requirements">
<section id="section-5.3.2">
          <h4 id="name-assigning-bits-for-the-bier">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-assigning-bits-for-the-bier" class="section-name selfRef">Assigning bits for the BIER-TE topology</a>
          </h4>
<p id="section-5.3.2-1">In BIER, BitStrings only need to carry bits for BFERs, which leads to the
model that BFR-ids map 1:1 to each bit in a BitString.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">In BIER-TE, BitStrings need to carry bits to indicate not only the receiving
BFER but also the intermediate hops/links across which the packet must be sent.
The maximum number of BFER that can be supported in a single BitString or BIFT:SI
depends on the number of bits necessary to represent the desired topology between
them.<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2-3">"Desired" topology because it depends on the physical topology, and
on the desire of the operator to allow for explicit path steering across
every single hop (which requires more bits), or reducing the number of required
bits by exploiting optimizations such as unicast (forward_routed()), ECMP() or flood
(DNC) over "uninteresting" sub-parts of the topology - e.g. parts where different
trees do not need to take different paths due to path steering reasons.<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.2-4">The total number of bits to describe the topology vs. the number of BFERs in a BIFT:SI can
range widely based on the size of the topology and the amount of alternative paths
in it. In a BIER-TE topology crafted by a BIER-TE expert, the higher the percentage of non-BFER bits, the higher the likelihood, that those topology
bits are not just BIER-TE overhead without additional benefit, but instead that they
will allow to express desirable path steering alternatives.<a href="#section-5.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bfr-id">
<section id="section-5.3.3">
          <h4 id="name-assigning-bfr-id-with-bier-">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-assigning-bfr-id-with-bier-" class="section-name selfRef">Assigning BFR-id with BIER-TE</a>
          </h4>
<p id="section-5.3.3-1">BIER-TE forwarding does not use the BFR-id, nor does it require for
the BFIR-id field of the BIER header to be set to a particular value.
However, other parts of a BIER-TE deployment may need a BFR-id, specifically
multicast flow overlay signaling and multicast flow overlay packet disposition,
and in that case BFRs need to also have BFR-ids for BIER-TE SDs.<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3-2">For example, for BIER overlay signaling, BFIRs need to have a BFR-id, because this
BFIR BFR-id is carried in the BFIR-id field of the BIER header to indicate
to the overlay signaling on the receiving BFER which BFIR originated the packet.<a href="#section-5.3.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.3-3">In BIER, BFR-id = SI * BSL + BP, such that the SI and BP of a BFER
can be calculated from the BFR-id and vice versa. This also means
that every BFR with a BFR-id has a reserved BP in an SI, even if
that is not necessary for BIER forwarding, because the BFR may
never be a BFER but only a BFIR.<a href="#section-5.3.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3.3-4">In BIER-TE, for a non-leaf BFER, there is usually a single BP for that BFER with a
local_decap() adjacency on the BFER. The BFR-id for such a BFER can therefore
be determined using the same procedure as in (non-TE) BIER: BFR-id = SI * BSL + BP.<a href="#section-5.3.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3.3-5">As explained in <a href="#leaf-bfer" class="xref">Section 5.1.3</a>, leaf BFERs do not need such
a unique local_decap() adjacency. Likewise, BFIRs that are not also BFERs
may not have a unique local_decap() adjacency either. For all those BFIRs
and (leaf) BFERs, the controller needs to determine unique BFR-ids that
do not collide with the BFR-ids derived from the non-leaf BFER local_decap() BPs.<a href="#section-5.3.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3.3-6">While this document defines no requirements on how to allocate such BFR-id,
a simple option is to derive it from the (SI,BP) of an adjacency that is
unique to the BFR in question. For a BFIR this can be the first adjacency
only populated on this BFIR, for a leaf-BFER, this could be the first BP
with an adjacency towards that BFER.<a href="#section-5.3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bitstring-mappings">
<section id="section-5.3.4">
          <h4 id="name-mapping-from-bfr-to-bitstri">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-mapping-from-bfr-to-bitstri" class="section-name selfRef">Mapping from BFR to BitStrings with BIER-TE</a>
          </h4>
<p id="section-5.3.4-1">In BIER, applications of the flow overlay on a BFIR can calculate the (SI,BP) of a
BFER from the BFR-id of the BFER and can therefore easily determine the BitStrings
for a BIER packet to a set of BFERs with known BFR-ids.<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
<p id="section-5.3.4-2">In BIER-TE this mapping needs to be equally supported for flow overlays.
This section outlines two core options, based on what type of Tree Engineering
the BIER-TE controller needs to performs for a particular application.<a href="#section-5.3.4-2" class="pilcrow">¶</a></p>
<p id="section-5.3.4-3">"Independent branches": For a given flow overlay instance, the branches
from a BFIR to every BFER are calculated by the BIER-TE controller to be
independent of the branches to any other BFER.  Shortest path trees are the most common
examples of trees with independent branches.<a href="#section-5.3.4-3" class="pilcrow">¶</a></p>
<p id="section-5.3.4-4">"Interdependent branches": When a BFER is added or deleted from a particular
distribution tree, the BIER-TE controller has to recalculate the branches to other BFER,
because they may need to change.  Steiner trees are examples of interdependent branch trees.<a href="#section-5.3.4-4" class="pilcrow">¶</a></p>
<p id="section-5.3.4-5">If "independent branches" are used, the BIER-TE Controller 
can signal to the BFIR flow overlay for every BFER an SI:BitString that
represents the branch to that BFER.  The flow overlay on the BIFR can then independently
of the controller calculate the SI:BitString for all desired BFERs by OR'ing their BitStrings.
This allows for flow overlay applications to operate independently of the controller
whenever it needs to determine which subset of BFERs need to receive a particular packet.<a href="#section-5.3.4-5" class="pilcrow">¶</a></p>
<p id="section-5.3.4-6">If "interdependent branches" are required, the application would need to inquire
the SI:BitString for a given set of BFER whenever the set changes.<a href="#section-5.3.4-6" class="pilcrow">¶</a></p>
<p id="section-5.3.4-7">Note that in either case (unlike in BIER), the bits may need to
change upon link/node failure/recovery, network expansion and network resource consumption 
by other traffic as part of traffic engineering goals (e.g.: re-optimization of lower
priority traffic flows). Interactions between such BFIR applications and the BIER-TE Controller
do therefore need to support dynamic updates to the SI:BitStrings.<a href="#section-5.3.4-7" class="pilcrow">¶</a></p>
<p id="section-5.3.4-8">Communications between the BFIR flow overlay and the BIER-TE controller
requires some way to identify the BFER. If BFR-ids are used in the deployment, as
outlined in <a href="#bfr-id" class="xref">Section 5.3.3</a>, then those are the natural BFR identifier. If
BFR-ids are not used, then any other unique identifier, such as the BFR-prefix
of the BFR (<span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span>) could be used.<a href="#section-5.3.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="assigning">
<section id="section-5.3.5">
          <h4 id="name-assigning-bfr-ids-for-bier-">
<a href="#section-5.3.5" class="section-number selfRef">5.3.5. </a><a href="#name-assigning-bfr-ids-for-bier-" class="section-name selfRef">Assigning BFR-ids for BIER-TE</a>
          </h4>
<p id="section-5.3.5-1">It is not currently determined if a single sub-domain could or should be
allowed to forward both (non-TE) BIER and BIER-TE packets. If this should be
supported, there are two options:<a href="#section-5.3.5-1" class="pilcrow">¶</a></p>
<p id="section-5.3.5-2">A. BIER and BIER-TE have different BFR-id in the same sub-domain. This allows
higher replication efficiency for BIER because their BFR-id can be assigned
sequentially, while the BitStrings for BIER-TE will have also the additional
bits for the topology. There is no relationship between a BFR BIER BFR-id and its
BIER-TE BFR-id.<a href="#section-5.3.5-2" class="pilcrow">¶</a></p>
<p id="section-5.3.5-3">B. BIER and BIER-TE share the same BFR-id. The BFR-ids are assigned as explained
above for BIER-TE and simply reused for BIER. The replication efficiency for BIER will
be as low as that for BIER-TE in this approach.<a href="#section-5.3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="allocation-example">
<section id="section-5.3.6">
          <h4 id="name-example-bit-allocations">
<a href="#section-5.3.6" class="section-number selfRef">5.3.6. </a><a href="#name-example-bit-allocations" class="section-name selfRef">Example bit allocations</a>
          </h4>
<div id="with-bier">
<section id="section-5.3.6.1">
            <h5 id="name-with-bier">
<a href="#section-5.3.6.1" class="section-number selfRef">5.3.6.1. </a><a href="#name-with-bier" class="section-name selfRef">With BIER</a>
            </h5>
<p id="section-5.3.6.1-1">Consider a network setup with a BSL of 256 for a network
topology as shown in <a href="#scaling-picture" class="xref">Figure 20</a>. The network has 6 areas, each with
170 BFERs, connecting via a core with 4 (core) BFRs. To address all BFERs with BIER,
4 SIs are required. To send a BIER
packet to all BFER in the network, 4 copies need to be sent by the BFIR. On the
BFIR it does not make a difference how the BFR-ids are allocated to BFER
in the network, but for efficiency further down in the network it does
make a difference.<a href="#section-5.3.6.1-1" class="pilcrow">¶</a></p>
<span id="name-scaling-bier-te-bits-by-reu"></span><div id="scaling-picture">
<figure id="figure-20">
              <div class="alignLeft art-text artwork" id="section-5.3.6.1-2.1">
<pre>
             area1           area2        area3
            BFR1a BFR1b  BFR2a BFR2b   BFR3a BFR3b
              |  \         /    \        /  |
              ................................
              .                Core          .
              ................................
              |    /       \    /        \  |
            BFR4a BFR4b  BFR5a BFR5b   BFR6a BFR6b
             area4          area5        area6
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-scaling-bier-te-bits-by-reu" class="selfRef">Scaling BIER-TE bits by reuse</a>
              </figcaption></figure>
</div>
<p id="section-5.3.6.1-3">With random allocation of BFR-id to BFER, each receiving area would (most likely)
have to receive all 4 copies of the BIER packet because there would be
BFR-id for each of the 4 SIs in each of the areas. Only further towards each
BFER would this duplication subside - when each of the 4 trees runs out of
branches.<a href="#section-5.3.6.1-3" class="pilcrow">¶</a></p>
<p id="section-5.3.6.1-4">If BFR-ids are allocated intelligently, then all the BFER in an area
would be given BFR-id with as few as possible different SIs.
Each area would only have to forward one or two packets instead of 4.<a href="#section-5.3.6.1-4" class="pilcrow">¶</a></p>
<p id="section-5.3.6.1-5">Given how networks can grow over time, replication efficiency in an area
will then also go down over time when BFR-ids are only allocated sequentially, network wide.
An area that initially only has BFR-id in one SI
might end up with many SIs over a longer period of growth. Allocating SIs
to areas with initially sufficiently many spare bits for growths can help
to alleviate this issue. Or renumber BFERs after network expansion. In
this example one may consider to use 6 SIs and assign one to each area.<a href="#section-5.3.6.1-5" class="pilcrow">¶</a></p>
<p id="section-5.3.6.1-6">This example shows that intelligent BFR-id allocation within at least
sub-domain 0 can even be helpful or even necessary in BIER.<a href="#section-5.3.6.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="with-bier-te">
<section id="section-5.3.6.2">
            <h5 id="name-with-bier-te">
<a href="#section-5.3.6.2" class="section-number selfRef">5.3.6.2. </a><a href="#name-with-bier-te" class="section-name selfRef">With BIER-TE</a>
            </h5>
<p id="section-5.3.6.2-1">In BIER-TE one needs to determine a subset of the physical topology
and attached BFERs so that the "desired" representation of this topology
and the BFER fit into a single BitString. This process needs to be
repeated until the whole topology is covered.<a href="#section-5.3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.6.2-2">Once bits/SIs are assigned to topology and BFERs, BFR-id is just a derived
set of identifiers from the operator/BIER-TE Controller as explained above.<a href="#section-5.3.6.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.6.2-3">Every time that different sub-topologies have overlap, bits need to
be repeated across the BitStrings, increasing the overall amount of bits
required across all BitString/SIs. In the worst case, one assigns random subsets of BFERs 
to different SIs. This will result in an outcome much worse than in (non-TE) BIER: It 
maximizes the amount of unnecessary topology overlap across SI and therefore
reduces the number of BFER that can be reached across each individual SI.
Intelligent BFER to SI assignment and selecting specific "desired" subtopologies can
minimize this problem.<a href="#section-5.3.6.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.6.2-4">To set up BIER-TE efficiently for the topology of <a href="#scaling-picture" class="xref">Figure 20</a>, the following bit
allocation method can be used. This method can easily be expanded to
other, similarly structured larger topologies.<a href="#section-5.3.6.2-4" class="pilcrow">¶</a></p>
<p id="section-5.3.6.2-5">Each area is allocated one or more SIs depending on the number of future
expected BFERs and number of bits required for the topology in the area.
In this example, 6 SIs, one per area.<a href="#section-5.3.6.2-5" class="pilcrow">¶</a></p>
<p id="section-5.3.6.2-6">In addition, we use 4 bits in each SI: bia, bib, bea, beb: (b)it (i)ngress (a),
(b)it (i)ngress (b), (b)it (e)gress (a), (b)it (e)gress (b). These bits will be used to pass BIER
packets from any BFIR via any combination of ingress area a/b BFR and egress area
 a/b BFR into a specific target area. These bits are then set up with the right
 forward_routed() adjacencies on the BFIR and area edge BFR:<a href="#section-5.3.6.2-6" class="pilcrow">¶</a></p>
<p id="section-5.3.6.2-7">On all BFIRs in an area j|j=1...6, bia in each BIFT:SI is populated with the same
forward_routed(BFRja), and bib with forward_routed(BFRjb). On all area
edge BFR, bea in BIFT:SI=k|k=1...6 is populated with forward_routed(BFRka) and
beb in BIFT:SI=k with forward_routed(BFRkb).<a href="#section-5.3.6.2-7" class="pilcrow">¶</a></p>
<p id="section-5.3.6.2-8">For BIER-TE forwarding of a packet to a subset of BFERs across all areas,
a BFIR would create at most 6 copies, with SI=1...SI=6, In each packet,
the bits indicate bits for topology and BFER in that topology plus the four bits
to indicate whether to pass this packet via the ingress area a or b border BFR
and the egress area a or b border BFR, therefore allowing path steering
for those two "unicast" legs: 1) BFIR to ingress area edge and 2) core to egress
area edge. Replication only happens inside the egress areas. For BFER in the
same area as in the BFIR, these four bits are not used.<a href="#section-5.3.6.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="summary">
<section id="section-5.3.7">
          <h4 id="name-summary">
<a href="#section-5.3.7" class="section-number selfRef">5.3.7. </a><a href="#name-summary" class="section-name selfRef">Summary</a>
          </h4>
<p id="section-5.3.7-1">BIER-TE can, like BIER, support multiple SIs within a sub-domain. This allows
to apply the mapping BFR-id = SI * BSL + BP. This allows to re-use
the BIER architecture concept of BFR-id and therefore minimize BIER-TE specific functions in possible
BIER layer control plane mechanisms with BIER-TE, including flow overlay methods and BIER header fields.<a href="#section-5.3.7-1" class="pilcrow">¶</a></p>
<p id="section-5.3.7-2">The number of BFIR/BFER possible in a sub-domain is smaller than in BIER
because BIER-TE uses additional bits for topology.<a href="#section-5.3.7-2" class="pilcrow">¶</a></p>
<p id="section-5.3.7-3">Sub-domains (SDs) in BIER-TE can be used like in BIER to create more efficient
replication to known subsets of BFERs.<a href="#section-5.3.7-3" class="pilcrow">¶</a></p>
<p id="section-5.3.7-4">Assigning bits for BFERs intelligently into the right SI is more important in
BIER-TE than in BIER because of replication efficiency and overall amount of
bits required.<a href="#section-5.3.7-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">If <span>[<a href="#RFC8296" class="xref">RFC8296</a>]</span> is used, BIER-TE shares its security considerations.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">BIER-TE shares the security considerations of BIER, <span>[<a href="#RFC8279" class="xref">RFC8279</a>]</span>, with
the following overriding or additional considerations.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">BIER-TE forwarding explicitly supports unicast "tunneling" of BIER packets via forward_routed()
adjacencies. The BIER domain security model is based on a subset of interfaces on a BFR
that connect to other BFRs of the same BIER domain. For BIER-TE, this security model equally applies
to such unicast "tunneled" BIER packets. This does not only include the need to filter
received unicast "tunneled" BIER packets to prohibit injection of such "tunneled" BIER
packets from outside the BIER domain, but also prohibiting forward_routed() adjacencies
to leak BIER packets from the BIER domain. It SHOULD be possible to configure
interfaces to be part of a BIER domain solely for sending and receiving of unicast
"tunneled" BIER packets even if the interface can not send/receive BIER encapsulated packets.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">In BIER, the standardized methods for the routing underlays are IGPs
with extensions to distribute BFR-ids and BFR-prefixes. 
<span>[<a href="#RFC8401" class="xref">RFC8401</a>]</span> specifies the extensions for IS-IS and <span>[<a href="#RFC8444" class="xref">RFC8444</a>]</span> specifies the extensions for OSPF.
Attacking the protocols for the BIER routing underlay or (non-TE) BIER layer control
plane, or impairment of any BFR in a domain may lead to successful attacks
against  the results of the routing protocol, enabling DoS attacks against
paths or the addressing (BFR-id, BFR-prefixes) used by BIER.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">The reference model for the BIER-TE layer control plane is a BIER-TE controller.
When such a controller is used, impairment of an individual BFR in a domain causes
no impairment of the BIER-TE control plane on other BFRs. If a routing
protocol is used to support forward_routed() adjacencies, then this is still an
attack vector as in BIER, but only for BIER-TE forward_routed() adjacencies, and
not other adjacencies.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">Whereas IGP routing protocols are most often not well secured through
cryptographic authentication and confidentiality, communications between controllers and routers such as those
to be considered for the BIER-TE controller/control-plane can be and are much more commonly
secured with those security properties, for example by using Secure SHell (SSH), <span>[<a href="#RFC4253" class="xref">RFC4253</a>]</span> for NETCONF (<span>[<a href="#RFC6242" class="xref">RFC6242</a>]</span>), or via Transport Layer Security (TLS), such as <span>[<a href="#RFC8253" class="xref">RFC8253</a>]</span> for PCEP, <span>[<a href="#RFC5440" class="xref">RFC5440</a>]</span>, or <span>[<a href="#RFC7589" class="xref">RFC7589</a>]</span> for NETCONF. BIER-TE controllers SHOULD use security equal to or better than these mechanisms.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">When any of these security mechanisms/protocols are used for communications
between a BIER-TE controller and BFRs, their security considerations apply to BIER-TE.
In addition, the security considerations of PCE, <span>[<a href="#RFC4655" class="xref">RFC4655</a>]</span> apply.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">The most important attack vector in BIER-TE is misconfiguration,
either on the BFR themselves or via the BIER-TE controller.
Forwarding entries with DNC could be set up to create persistent loops, in which
packets only expire because of TTL. To minimize the impact of such attacks
(or more likely unintentional misconfiguration by operators and/or bad BIER-TE controller software),
the BIER-TE forwarding rules are defined to be as strict in clearing
bits as possible. The clearing of all bits with an adjacency on
a BFR prohibits that a looping packet creates additional packet amplification
through the misconfigured loop on the packet's second or further times around the
loop, because all relevant adjacency bits would have been cleared on the first round
through the loop.  In result, BIER-TE has the same degree of looping packets
as possible with unintentional or malicious loops in the routing underlay
with BIER or even with unicast traffic.<a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9">Deployments where BIER-TE would likely be beneficial 
may include operational models where actual configuration changes
from the controller are only required during non-production phases of
the network's life-cycle, such as in embedded networks or in manufacturing
networks during e.g. plant reworking/repairs. In these
type of deployments, configuration changes could be locked out when the
network is in production state and could only be (re-)enabled through 
reverting the network/installation into non-production state. Such
security designs would not only allow to provide additional layers
of protection against configuration attacks, but would foremost
protect the active production process from such configuration attacks.<a href="#section-6-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document requests no action by IANA.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ack">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">The authors would like to thank Greg Shepherd, Ijsbrand Wijnands, Neale Ranns, Dirk Trossen, Sandy Zheng, Lou Berger, Jeffrey Zhang, Carsten Borman and Wolfgang Braun for their reviews and suggestions.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2"> Special thanks to Xuesong Geng for shepherding the document and for IESG review/suggestions by Alvaro Retana (responsible AD/RTG), Benjamin Kaduk (SEC), Tommy Pauly (TSV), Zaheduzzaman Sarker (TSV), Eric Vyncke (INT), Martin Vigoureux (RTG), Robert Wilton (OPS), Eric Kline (INT), Lars Eggert (GEN), Roman Danyliv (SEC), Ines Robles (RTGDIR), Robert Sparks (Gen-ART), Yingzhen Qu (RTGdir), Martin Duke (TSV).<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes">
<section id="section-9">
      <h2 id="name-change-log-rfc-editor-pleas">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-change-log-rfc-editor-pleas" class="section-name selfRef">Change log [RFC Editor: Please remove]</a>
      </h2>
<p id="section-9-1">draft-ietf-bier-te-arch:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9-2.1">12:<a href="#section-9-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.2">AD review Alvaro Retana.<a href="#section-9-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.3">Various textual/editorial nits including adding () to all instances of forwarding adjacency name instances.<a href="#section-9-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.4">3.1 Added new paragraph outlining possible use of BGP as RR in BIER-TE controller
         as core of multicast flow overlay component of BIER-TE.<a href="#section-9-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.5">3.2 added xref's to relevant sections to the listed control plane points.<a href="#section-9-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.6">4.1 rewrote paragraphs of 4.1 leading up to Figure 4. to eliminate any confusion in
         how the BIFT work and how it compares to the notions in rfc8279, as well as better
         linking it to the Pseudocode.<a href="#section-9-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.7">Moved SR section into appendix.<a href="#section-9-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.8">TSV review Martin Duke.<a href="#section-9-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.9">Text/editorial nits.<a href="#section-9-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.10">4.4 improved text describing handling of F-BM.<a href="#section-9-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.11">RTGdir review Yingzhen Qu.<a href="#section-9-2.11" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.12">Various text/editorial nits.<a href="#section-9-2.12" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.13">Added notion that BitStrings represent loop free tree for packet to abstract and intro.<a href="#section-9-2.13" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.14">Various text nit and editorial improvements.<a href="#section-9-2.14" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.15">Fixed some BFR-id field -&gt; BFIR-id field mistakes.<a href="#section-9-2.15" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.16">Capitalized NETCONF/RESTCONF/YANG, added RFC references.<a href="#section-9-2.16" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.17">Improved Figure 16 with explicitly two links into BFR3 and explanatory text.<a href="#section-9-2.17" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.18">Gen-ART review Robert Sparks.<a href="#section-9-2.18" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.19">Various textual nits, editorial improvements.<a href="#section-9-2.19" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.20">3.2 Introduced terms "BIER-TE topology control" and "BIER-TE tree control" for the two functional components of the control plane.<a href="#section-9-2.20" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.21">3.2.1 - 3.2 change introduces the open RFC-editor issue of appropriate xrfs (to be resolved by RFC-editor).<a href="#section-9-2.21" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.22">3.3 Rewrote last paragraph to better describe loop prevention through clearing of bits in BitString.<a href="#section-9-2.22" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.23">4.1 Fixed up text/formula describing mapping between bfr-id, SI:BP and SI,BSL and BP. Fix offset bug.<a href="#section-9-2.23" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.24">5.3.6.2 Improved description paragraph explaining overlap of topology for different SI.<a href="#section-9-2.24" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.25">5.3.7 Improved first summary paragraph.<a href="#section-9-2.25" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.26">7. Rephrased applicability statement of control plane protocol security considerations to BIER-TE security.<a href="#section-9-2.26" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.27">RTGDIR review Ines Robles.<a href="#section-9-2.27" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.28">Fixed up adjacencies in Example 2 and explanation text to be explicit about which BFR not
         only passes, but also receives the packet.<a href="#section-9-2.28" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.29">7. (security considerations). Added paragraph about forward_routed() and prohibiting BIER packet leaking in/out of domain.<a href="#section-9-2.29" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.30">IESG review Roman Danyliv (SEC).<a href="#section-9-2.30" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.31">Several textual/sentence nits/editorials.<a href="#section-9-2.31" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.32">IESG review Lars Eggert (GEN).<a href="#section-9-2.32" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.33">Various good editorial word fixed.<a href="#section-9-2.33" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.34">Pointer to non-false-positive bloom filter work that looks like it happened after our IETF discussions documented in this doc, so will not add it to doc, but here is URL for folks interested: https://ieeexplore.ieee.org/document/8486415.<a href="#section-9-2.34" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.35">Did not change "native" to a different word for inclusivity because of my worry there is no estavblished single replacement word, making reading/searching/understanding more difficult.<a href="#section-9-2.35" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.36">IESG review Martin Vigeureux (RTG).<a href="#section-9-2.36" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.37">Added back reference to RFC8402. Textual fixes.<a href="#section-9-2.37" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.38">IESG review Eric Kline (INT).<a href="#section-9-2.38" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.39">2.1 Fixed typo in BFR* explanations.<a href="#section-9-2.39" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.40">4.3 Added explanatio about MTU handling.<a href="#section-9-2.40" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.41">IESG review Eric Vyncke (INT).<a href="#section-9-2.41" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.42">Fixed up initial text to introduce various abbreviations.<a href="#section-9-2.42" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.43">2.4 refined wording to "with the _intent_ to easily build common forwarding planes...".<a href="#section-9-2.43" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.44">4.2.3 refined text about entropy in ECMP - now taken text from rfc8279.<a href="#section-9-2.44" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.45">IESG review Zaheduzzaman Sarker (TSV).<a href="#section-9-2.45" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.46">5.1.7 Refined text explaining documentation of ECMP algorithm.<a href="#section-9-2.46" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.47">5.3.6.2. fixed range of areas/SI over which to build the example large network BPs - removed explanation of the large network shown to be only used for sources in area 1 (IPTV), because it was a stale explanation.<a href="#section-9-2.47" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.48">IESG review Ben Kaduk (round 2):<a href="#section-9-2.48" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.49">4.4 Advanced pseudocode still had one wrong "~". Root cause seems to have been day 0 problem in pseudocode written for -01, "~" was inserted in the wrong one of two code lines. Also enhanced textual description and comments in pseudocode, changed variable name AdjacentBits to PktAdjacentBits to avoid confusion with AdjacentBits[SI].<a href="#section-9-2.49" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.50">5.1.3 Rewrote last two paragraphs explaining the sharing of bit positions for lead-BFER hopefully better. Also detailled how it interacts with other optimizations and the type of payload BIER-TE packets may carry.<a href="#section-9-2.50" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.51">4.4 (from Carsten Borman) changed spacing in pseudocode to be consistent. Fixed {VRF}, clarified pseudocode object syntax, typos.<a href="#section-9-2.51" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.52">11:  IESG review Ben Kaduk, summary:<a href="#section-9-2.52" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.53">One discuss for bug in pseudocode. turned out to be one cahrcter typo.<a href="#section-9-2.53" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.54">Added (non-TE) prefix in places where BIER by itsels had to be better disambiguated.<a href="#section-9-2.54" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.55">enhanced text for hub-and-spoke to indicate we're only talking about hub to spoke traffic.<a href="#section-9-2.55" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.56"> long list ot language fixes/improvement (nits). Thanks a lot!.<a href="#section-9-2.56" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.57">add suggestion to SHOULD use known confidentiality protocols between controller and BFR.<a href="#section-9-2.57" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.58">10:  AD review Alvaro Retana, summary:<a href="#section-9-2.58" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.59">Note: rfcdiff shows more changes than actually exist because text moved around.<a href="#section-9-2.59" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.60">
          <p id="section-9-2.60.1">Summary:<a href="#section-9-2.60.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9-2.60.2">
<li id="section-9-2.60.2.1">restructuring: merged all controller sections under common controller ops main section, moved unfitting stuff out to other parts of doc. Split Intro section into Overview and Intro. Shortened Abstract, moved text into Overview,
   added sections overview.<a href="#section-9-2.60.2.1" class="pilcrow">¶</a>
</li>
            <li id="section-9-2.60.2.2">enhanced/rewrote: 2.3 Comparison with -&gt; Relationship to BIER-TE<a href="#section-9-2.60.2.2" class="pilcrow">¶</a>
</li>
            <li id="section-9-2.60.2.3">enhanced/rewrote: 3.2 BIER-TE controller -&gt; BIER-TE control plane, 3.2.1 BIER-TE controller, for consistency with rfc8279<a href="#section-9-2.60.2.3" class="pilcrow">¶</a>
</li>
            <li id="section-9-2.60.2.4">additional subsections for Alvaros asks<a href="#section-9-2.60.2.4" class="pilcrow">¶</a>
</li>
            <li id="section-9-2.60.2.5">added to: 3.3 BIER-TE forwarding plane (consistency with rfc8279)<a href="#section-9-2.60.2.5" class="pilcrow">¶</a>
</li>
            <li id="section-9-2.60.2.6">Enhanced description of 4.3/encap considerations to better explain how BIER/BIER-TE can run together.<a href="#section-9-2.60.2.6" class="pilcrow">¶</a>
</li>
          </ol>
</li>
        <li class="normal ulEmpty" id="section-9-2.61">Notation: Markers (a),(b),... at end of points are references from the review discussion with Alvaro to the changes made.<a href="#section-9-2.61" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.62">Details:.<a href="#section-9-2.62" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.63">Throughout text: changed term spelling to rfc8279 - bit positions, sub-domain, ... (i).<a href="#section-9-2.63" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.64">Reset changed to clear, also DNR changed to DNC (Do Not Clear) (q).<a href="#section-9-2.64" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.65">Abstract: Shortened. Removed name explanation note (Tree Engineering), (a).<a href="#section-9-2.65" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.66">1. Introduction -&gt; Overview: Moved important explanation paragraph from abstract to Introduction. Fixed text,  (a).<a href="#section-9-2.66" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.67">   Added bullet point list explanation of structure of document (e).<a href="#section-9-2.67" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.68">   Renamed to Overview because that is now more factually correct.<a href="#section-9-2.68" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.69">1.1. Fixed bug in example adding bit p15.(l).<a href="#section-9-2.69" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.70">2. (New - Introduction): Moved section 1.1 - 1.3 (examples, comparison with BIER-TE) from Introduction into new "Overview" section. Primarily so that "requirements language" section (at end of Introduction) is not in middle of document after all the Introduction.<a href="#section-9-2.70" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.71">2.1 Removed discussion of encap, moved to 4.2.2 (m).<a href="#section-9-2.71" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.72">2.2 enhanced paragraph suggesting native/overlay topology types, also sugest type hybrid (n).<a href="#section-9-2.72" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.73">2.3 Overhauled comparison text BIER/BIER-TE, structured into common, different, not-required-by-te, integration-bier-bier-te. Changed title to "Relationship" to allow including last point. (f).<a href="#section-9-2.73" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.74">2.4 moved Hardware forwarding comparison section into section 2 to allow coalescing of sections into section 5 about the controller operations (hardware forwarding was in the middle of it, wrong place). Shortened/improved third paragraph by pointing to BIFT as deciding element for selection between BIER/BIER-TE. Removed notion of experimentation (this now targets standard) (g).<a href="#section-9-2.74" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.75">3. (Components): Aligned component name and descriptions better with RFC8279.  Now describe exactly same three layers. BIER layer constituted from BIER-TE control plane and BIER-TE forwarding plane. BIER-TE controller is now simply component of BIER-TE control plane. (b).<a href="#section-9-2.75" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.76">3.1. shortened/improved paragraph explaining use of SI:BP instead of also bfr-id as index into BIFT, rewrote paragraph talking about reuse of BPs(o).<a href="#section-9-2.76" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.77">3.2. rewrote explanation of BIER-TE control plane in the style of RFC8729 Section 4.2 (BIER layer) with numbered points. Note that RFC8729 mixes control and forwarding plane bullet points (this doc does not). Merged text from old sections 2.2.1 and 2.2.3 into list. (b).<a href="#section-9-2.77" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.78">3.2.1. Expanded/improved explanation of BIER-TE Controller (b).<a href="#section-9-2.78" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.79">3.2.1.1. Added subsection for topology discovery and creation (d).<a href="#section-9-2.79" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.80">3.2.1.2. Added subsection for engineered BitStrings as key novel aspect not found in BIER. (X).<a href="#section-9-2.80" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.81">3.3. Added numbered list for components of BIER-TE forwarding plane (completing the comparable text from RFC8729 Section 4.2).<a href="#section-9-2.81" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.82">3.4 Alvaro does not mind additional example, fixed bugs.<a href="#section-9-2.82" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.83">3.5 Removed notion about using IGP BIER extensions for BIER-TE, such as BIFT address ranges. After -10 making use of BIFT clearer, it now looks to authors as if use of IGP extensions would not be beneficial, as long as we do need to use the BIER-TE controller, e.g. unlike in BIER, a BFR could not learn from the IGP information what traffic to send towards a particular BIFT-ID, but instead that is the core of what the controller needs to provide.<a href="#section-9-2.83" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.84">4.2.2 Improved text to explain requirement to identify BIER-TE in the tunnel encap and compress description of use-cases (m).<a href="#section-9-2.84" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.85">4.2.3 enhanced ECMP text (p).<a href="#section-9-2.85" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.86">4.3. rewrote most of Encapsulation Considerations to better explain to Alvaros question re sharing or not sharing SD via BIER/BIER-TE. Added reference to I-D.ietf-bier-non-mpls-bift-encoding as a very helpful example. (f).<a href="#section-9-2.86" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.87">4.3 Renamed title to "...Co-Existence with BIER" as this is what it is about and to help finding it from abstract/intro ("co-exist")  (j).<a href="#section-9-2.87" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.88">4.4. Moved BIER-TE Forwarding Pseudocode here to coalesce text logically. Changed text to better compare with BIER pseudo forwarding code. Numerical list of how F-BM works for BIER-TE. Removed efficiency comparison with BIER (too difficult to provide sufficient justification, derails from focus of section) (j).<a href="#section-9-2.88" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.89">4.6. (Requirements) Restructured: Removed notion of "basic" BIER-TE forwarding, simply referring to it now as "mandatory" BIER-TE forwarding. Cleaned up text to have requirements for different adjacencies in different paragraphs. (c).<a href="#section-9-2.89" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.90">5. Created new main section "BIER-TE Controller operational considerations", coalesced old sections 4., 5., 7. into this new main section. No text changes. (k).<a href="#section-9-2.90" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.91">5.1.9 Added new separate picture instead of referring to a picture later in text, adjusted text (r).<a href="#section-9-2.91" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.92">5.3.2 Changed title to not include word "comparison" to avoid this being accounted against Alvaros concern about scattering comparison (IMHO text already has little comparison, so title was misleading) (h).<a href="#section-9-2.92" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.93">co-authors internal review:<a href="#section-9-2.93" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.94">4.4 Added xref to Figure 5.<a href="#section-9-2.94" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.95">5.2.1 Duplicated ring picture, added visuals for described miswiring (s).<a href="#section-9-2.95" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.96">5.2.2 replace "topology" with graph (wrong word).<a href="#section-9-2.96" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.97">5.3.3 rewrote explanation of how to map BFR-id to SI:BP and assign them, clarified BFR-id is option. Retitled to better explain scope of section.<a href="#section-9-2.97" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.98">5.3.4 Removed considerations in 5.3.4 for sharing BFR-id across BIER/BIER-TE (t), changed title to explain how BFIR/BIER-TE controller interactions need some form of identifying BFR but this does not have to be BFR-id.<a href="#section-9-2.98" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.99">7. Added new security considerations (u).<a href="#section-9-2.99" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.100">
        <li class="normal ulEmpty" id="section-9-2.101">09: Incorporated fixes for feedback from Shepherd (Xuesong Geng).<a href="#section-9-2.101" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.102">    Added references for Bloom Filters and Rate Controlled Service Disciplines.<a href="#section-9-2.102" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.103">    1.1 Fixed numbering of example 1 topology explanation. Improved language on second example (less abbreviating to avoid confusion about meaning).<a href="#section-9-2.103" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.104">    1.2 Improved explanation of BIER-TE topology, fixed terminology of graphs (BIER-TE topology is a directed graph where the edges are the adjacencies).<a href="#section-9-2.104" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.105">    2.4 Fixed and amended routing underlay explanations: detailed why no need for BFER routing underlay routing protocol extensions, but potential to re-use BIER routing underlay routing protocol extensions for non-BFER related extensions.<a href="#section-9-2.105" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.106">    3.1 Added explanation for VRF and its use in adjacencies.<a href="#section-9-2.106" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.107">08: Incorporated (with hopefully acceptable fixes) for Lou suggested section 2.5, TE considerations.<a href="#section-9-2.107" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.108">    Fixes are primarily to the point to a) emphasize that BIER-TE does not depend on the routing underlay unless forward_routed() adjacencies are used, and b) that the allocation and tracking of resources does not explicitly have to be tied to BPs, because they are just steering labels. Instead, it would ideally come from per-hop resource management that can be maintained only via local accounting in the controller.<a href="#section-9-2.108" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.109">07: Further reworking text for Lou.<a href="#section-9-2.109" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.110">    Renamed BIER-PE to BIER-TE standing for "Tree Engineering" after votes from BIER WG.<a href="#section-9-2.110" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.111">    Removed section 1.1 (introduced by version 06) because not considered necessary in this doc by Lou (for framework doc).<a href="#section-9-2.111" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.112">    Added [RFC editor pls. remove] Section to explain name change to future reviewers.<a href="#section-9-2.112" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.113">06: Concern by Lou Berger re. BIER-TE as full traffic engineering solution.<a href="#section-9-2.113" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.114">    Changed title "Traffic Engineering" to "Path Engineering"<a href="#section-9-2.114" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.115">    Added intro section of relationship BIER-PE to traffic engineering.<a href="#section-9-2.115" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.116">    Changed "traffic engineering" term in text" to "path engineering", where appropriate<a href="#section-9-2.116" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.117">    Other:<a href="#section-9-2.117" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.118">    Shortened "BIER-TE Controller Host" to "BIER-TE Controller". Fixed up all instances of controller to do this.<a href="#section-9-2.118" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.119">05: Review Jeffrey Zhang.<a href="#section-9-2.119" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.120">    Part 2:<a href="#section-9-2.120" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.121">    4.3 added note about leaf-BFER being also a propery of routing setup.<a href="#section-9-2.121" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.122">    4.7 Added missing details from example to avoid confusion with routed adjacencies, also compressed explanatory text and better justification why seed is explicitly configured by controller.<a href="#section-9-2.122" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.123">    4.9 added section discussing generic reuse of BP methods.<a href="#section-9-2.123" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.124">    4.10 added section summarizing BP optimizations of section 4.<a href="#section-9-2.124" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.125">    6. Rewrote/compressed explanation of comparison BIER/BIER-TE forwarding difference. Explained benefit of BIER-TE per-BP forwarding being independent of forwarding for other BPs.<a href="#section-9-2.125" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.126">    Part 1:<a href="#section-9-2.126" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.127">    Explicitly ue forwarded_connected adjcency in ECMP adjcency examples to avoid confusion.<a href="#section-9-2.127" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.128">    4.3 Add picture as example for leav vs. non-leaf BFR in topology. Improved description.<a href="#section-9-2.128" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.129">    4.5 Exampe for traffic that can be broadcast -&gt; for single BP in hub&amp;spoke.<a href="#section-9-2.129" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.130">    4.8.1 Simplified example picture for routed adjacency, explanatory text.<a href="#section-9-2.130" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.131">    Review from Dirk Trossen:<a href="#section-9-2.131" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.132">    Fixed up explanation of ICC paper vs. bloom filter.<a href="#section-9-2.132" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.133">04: spell check run.<a href="#section-9-2.133" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.134">    Addded remaining fixes for Sandys (Zhang Zheng) review:<a href="#section-9-2.134" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.135">    4.7 Enhance ECMP explanations:<a href="#section-9-2.135" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.136">    example ECMP algorithm, highlight that doc does not standardize ECMP algorithm.<a href="#section-9-2.136" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.137">    Review from Dirk Trossen:<a href="#section-9-2.137" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.138">    1. Added mentioning of prior work for traffic engineered paths with bloom filters.<a href="#section-9-2.138" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.139">    2. Changed title from layers to components and added "BIER-TE control plane" to "BIER-TE Controller" to make it clearer, what it does.<a href="#section-9-2.139" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.140">    2.2.3. Added reference to I-D.ietf-bier-multicast-http-response as an example solution.<a href="#section-9-2.140" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.141">    2.3. clarified sentence about resetting BPs before sending copies (also forgot to mention DNR here).<a href="#section-9-2.141" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.142">    3.4. Added text saying this section will be removed unless IESG review finds enough redeeming value in this example given how -03 introduced section 1.1 with basic examples.<a href="#section-9-2.142" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.143">    7.2. Removed explicit numbers 20%/80% for number of topology bits in BIER-TE, replaced with more vague (high/low) description, because we do not have good reference material Added text saying this section will be removed unless IESG review finds enough redeeming value in this example given how -03 introduced section 1.1 with basic examples.<a href="#section-9-2.143" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.144">    many typos fixed. Thanks a lot.<a href="#section-9-2.144" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.145">03: Last call textual changes by authors to improve readability:<a href="#section-9-2.145" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.146">    removed Wolfgang Braun as co-authors (as requested).<a href="#section-9-2.146" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.147">    Improved abstract to be more explanatory. Removed mentioning of FRR (not concluded on so far).<a href="#section-9-2.147" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.148">    Added new text into Introduction section because the text was too difficult to jump into
             (too many forward pointers). This primarily consists of examples and the early introduction
             of the BIER-TE Topology concept enabled by these examples.<a href="#section-9-2.148" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.149">    Amended comparison to SR.<a href="#section-9-2.149" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.150">    Changed syntax from [VRF] to {VRF} to indicate its optional and to make idnits happy.<a href="#section-9-2.150" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.151">    Split references into normative / informative, added references.<a href="#section-9-2.151" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.152">02: Refresh after IETF104 discussion: changed intended status back to standard. Reasoning:<a href="#section-9-2.152" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.153">    Tighter review of standards document == ensures arch will be better prepared for possible adoption by other WGs (e.g. DetNet) or std. bodies.<a href="#section-9-2.153" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.154">    Requirement against the degree of existing implementations is self defined by the WG. BIER WG seems to think it is not necessary to apply multiple interoperating implementations against an architecture level document at this time to make it qualify to go to standards track. Also, the levels of support introduced in -01 rev. should allow all BIER forwarding engines to also be able to support the base level BIER-TE forwarding.<a href="#section-9-2.154" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.155">01: Added note comparing BIER and SR to also hopefully clarify BIER-TE vs. BIER comparison re. SR.<a href="#section-9-2.155" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.156"> - added requirements section mandating only most basic BIER-TE forwarding features as MUST.<a href="#section-9-2.156" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.157"> - reworked comparison with BIER forwarding section to only summarize and point to pseudocode section.<a href="#section-9-2.157" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.158"> - reworked pseudocode section to have one pseudocode that mirrors the BIER forwarding pseudocode to make comparison easier and a second pseudocode that shows the complete set of BIER-TE forwarding options and simplification/optimization possible vs. BIER forwarding. Removed MyBitsOfInterest (was pure optimization).<a href="#section-9-2.158" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.159"> - Added captions to pictures.<a href="#section-9-2.159" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.160"> - Part of review feedback from Sandy (Zhang Zheng) integrated.<a href="#section-9-2.160" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.161">00: Changed target state to experimental (WG conclusion), updated references, mod auth association.<a href="#section-9-2.161" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.162"> - Source now on https://www.github.com/toerless/bier-te-arch<a href="#section-9-2.162" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-2.163"> - Please open issues on the github for change/improvement requests to the document - in addition to posting them on the list (bier@ietf.). Thanks!.<a href="#section-9-2.163" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-9-3">draft-eckert-bier-te-arch:<a href="#section-9-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9-4.1">06: Added overview of forwarding differences between BIER, BIER-TE.<a href="#section-9-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.2">05: Author affiliation change only.<a href="#section-9-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.3">04: Added comparison to Live-Live and BFIR to FRR section (Eckert).<a href="#section-9-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.4">04: Removed FRR content into the new FRR draft [I-D.eckert-bier-te-frr] (Braun).<a href="#section-9-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.5"> - Linked FRR information to new draft in Overview/Introduction<a href="#section-9-4.5" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.6"> - Removed BTAFT/FRR from "Changes in the network topology"<a href="#section-9-4.6" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.7"> - Linked new draft in "Link/Node Failures and Recovery"<a href="#section-9-4.7" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.8"> - Removed FRR from "The BIER-TE Forwarding Layer"<a href="#section-9-4.8" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.9"> - Moved FRR section to new draft<a href="#section-9-4.9" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.10"> - Moved FRR parts of Pseudocode into new draft<a href="#section-9-4.10" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.11"> - Left only non FRR parts<a href="#section-9-4.11" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.12"> - removed FrrUpDown(..) and //FRR operations in ForwardBierTePacket(..)<a href="#section-9-4.12" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.13"> - New draft contains FrrUpDown(..) and ForwardBierTePacket(Packet) from bier-arch-03<a href="#section-9-4.13" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.14"> - Moved "BIER-TE and existing FRR to new draft<a href="#section-9-4.14" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.15"> - Moved "BIER-TE and Segment Routing" section one level up<a href="#section-9-4.15" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.16"> - Thus, removed "Further considerations" that only contained this section<a href="#section-9-4.16" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.17"> - Added Changes for version 04<a href="#section-9-4.17" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.18">
        <li class="normal ulEmpty" id="section-9-4.19">03: Updated the FRR section.  Added examples for FRR key concepts.  Added BIER-in-BIER tunneling as option for tunnels in backup paths.  BIFT structure is expanded and contains an additional match field to support full node protection with BIER-TE FRR.<a href="#section-9-4.19" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.20">03: Updated FRR section.  Explanation how BIER-in-BIER encapsulation provides P2MP protection for node failures even though the routing underlay does not provide P2MP.<a href="#section-9-4.20" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.21">02: Changed the definition of BIFT to be more inline with BIER. In revs. up to -01, the idea was that a BIFT has only entries for a single BitString, and every SI and sub-domain would be a separate BIFT. In BIER, each BIFT covers all SI. This is now also how we define it in BIER-TE.<a href="#section-9-4.21" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.22">02: Added <a href="#mgmt-stuff" class="xref">Section 5.3</a> to explain the use of SI, sub-domains and BFR-id in BIER-TE and to give an example how to efficiently assign bits for a large topology requiring multiple SI.<a href="#section-9-4.22" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.23">02: Added further detailed for rings - how to support input from all ring nodes.<a href="#section-9-4.23" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.24">01: Fixed BFIR -&gt; BFER for section 4.3.<a href="#section-9-4.24" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.25">01: Added explanation of SI, difference to BIER ECMP, consideration for Segment Routing, unicast FRR, considerations for encapsulation, explanations of BIER-TE Controller and CLI.<a href="#section-9-4.25" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-9-4.26">00: Initial version.<a href="#section-9-4.26" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8279">[RFC8279]</dt>
        <dd>
<span class="refAuthor">Wijnands, IJ., Ed.</span>, <span class="refAuthor">Rosen, E., Ed.</span>, <span class="refAuthor">Dolganow, A.</span>, <span class="refAuthor">Przygienda, T.</span>, and <span class="refAuthor">S. Aldrin</span>, <span class="refTitle">"Multicast Using Bit Index Explicit Replication (BIER)"</span>, <span class="seriesInfo">RFC 8279</span>, <span class="seriesInfo">DOI 10.17487/RFC8279</span>, <time datetime="2017-11" class="refDate">November 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8279">https://www.rfc-editor.org/info/rfc8279</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8296">[RFC8296]</dt>
      <dd>
<span class="refAuthor">Wijnands, IJ., Ed.</span>, <span class="refAuthor">Rosen, E., Ed.</span>, <span class="refAuthor">Dolganow, A.</span>, <span class="refAuthor">Tantsura, J.</span>, <span class="refAuthor">Aldrin, S.</span>, and <span class="refAuthor">I. Meilik</span>, <span class="refTitle">"Encapsulation for Bit Index Explicit Replication (BIER) in MPLS and Non-MPLS Networks"</span>, <span class="seriesInfo">RFC 8296</span>, <span class="seriesInfo">DOI 10.17487/RFC8296</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8296">https://www.rfc-editor.org/info/rfc8296</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Bloom70">[Bloom70]</dt>
        <dd>
<span class="refAuthor">Bloom, B. H.</span>, <span class="refTitle">"Space/time trade-offs in hash coding with allowable errors"</span>, <span class="seriesInfo">Comm. ACM 13(7):422-6</span>, <time datetime="1970-07" class="refDate">July 1970</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/362686.362692">https://dl.acm.org/doi/10.1145/362686.362692</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.eckert-bier-te-frr">[I-D.eckert-bier-te-frr]</dt>
        <dd>
<span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Cauchie, G.</span>, <span class="refAuthor">Braun, W.</span>, and <span class="refAuthor">M. Menth</span>, <span class="refTitle">"Protection Methods for BIER-TE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-eckert-bier-te-frr-03</span>, <time datetime="2018-03-05" class="refDate">5 March 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-eckert-bier-te-frr-03.txt">https://www.ietf.org/archive/id/draft-eckert-bier-te-frr-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bier-multicast-http-response">[I-D.ietf-bier-multicast-http-response]</dt>
        <dd>
<span class="refAuthor">Trossen, D.</span>, <span class="refAuthor">Rahman, A.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">T. Eckert</span>, <span class="refTitle">"Applicability of BIER Multicast Overlay for Adaptive Streaming Services"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bier-multicast-http-response-06</span>, <time datetime="2021-07-10" class="refDate">10 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-bier-multicast-http-response-06.txt">https://www.ietf.org/archive/id/draft-ietf-bier-multicast-http-response-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bier-non-mpls-bift-encoding">[I-D.ietf-bier-non-mpls-bift-encoding]</dt>
        <dd>
<span class="refAuthor">Wijnands, I.</span>, <span class="refAuthor">Mishra, M.</span>, <span class="refAuthor">Xu, X.</span>, and <span class="refAuthor">H. Bidgoli</span>, <span class="refTitle">"An Optional Encoding of the BIFT-id Field in the non-MPLS BIER Encapsulation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bier-non-mpls-bift-encoding-04</span>, <time datetime="2021-05-30" class="refDate">30 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-bier-non-mpls-bift-encoding-04.txt">https://www.ietf.org/archive/id/draft-ietf-bier-non-mpls-bift-encoding-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bier-te-yang">[I-D.ietf-bier-te-yang]</dt>
        <dd>
<span class="refAuthor">Zhang, Z.</span>, <span class="refAuthor">Wang, C.</span>, <span class="refAuthor">Chen, R.</span>, <span class="refAuthor">Hu, F.</span>, <span class="refAuthor">Sivakumar, M.</span>, and <span class="refAuthor">H. Chen</span>, <span class="refTitle">"A YANG data model for Tree Engineering for Bit Index Explicit Replication (BIER-TE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bier-te-yang-04</span>, <time datetime="2021-11-07" class="refDate">7 November 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-bier-te-yang-04.txt">https://www.ietf.org/archive/id/draft-ietf-bier-te-yang-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-roll-ccast">[I-D.ietf-roll-ccast]</dt>
        <dd>
<span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Gerdes, S.</span>, and <span class="refAuthor">H. Chen</span>, <span class="refTitle">"Constrained-Cast: Source-Routed Multicast for RPL"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-roll-ccast-01</span>, <time datetime="2017-10-30" class="refDate">30 October 2017</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-roll-ccast-01.txt">https://www.ietf.org/archive/id/draft-ietf-roll-ccast-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teas-rfc3272bis">[I-D.ietf-teas-rfc3272bis]</dt>
        <dd>
<span class="refAuthor">Farrel, A.</span>, <span class="refTitle">"Overview and Principles of Internet Traffic Engineering"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teas-rfc3272bis-13</span>, <time datetime="2021-11-08" class="refDate">8 November 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-teas-rfc3272bis-13.txt">https://www.ietf.org/archive/id/draft-ietf-teas-rfc3272bis-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ICC">[ICC]</dt>
        <dd>
<span class="refAuthor">Reed, M. J.</span>, <span class="refAuthor">Al-Naday, M.</span>, <span class="refAuthor">Thomos, N.</span>, <span class="refAuthor">Trossen, D.</span>, <span class="refAuthor">Petropoulos, G.</span>, and <span class="refAuthor">S. Spirou</span>, <span class="refTitle">"Stateless multicast switching in software defined networks"</span>, <span class="seriesInfo"> IEEE International Conference on Communications (ICC), Kuala Lumpur, Malaysia, 2016</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/7511036">https://ieeexplore.ieee.org/document/7511036</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RCSD94">[RCSD94]</dt>
        <dd>
<span class="refAuthor">Zhang, H.</span> and <span class="refAuthor">D. Domenico</span>, <span class="refTitle">"Rate-Controlled Service Disciplines"</span>, <span class="seriesInfo"> Journal of High-Speed Networks, 1994</span>, <time datetime="1994-05" class="refDate">May 1994</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.5555/2692227.2692232">https://dl.acm.org/doi/10.5555/2692227.2692232</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4253">[RFC4253]</dt>
        <dd>
<span class="refAuthor">Ylonen, T.</span> and <span class="refAuthor">C. Lonvick, Ed.</span>, <span class="refTitle">"The Secure Shell (SSH) Transport Layer Protocol"</span>, <span class="seriesInfo">RFC 4253</span>, <span class="seriesInfo">DOI 10.17487/RFC4253</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4253">https://www.rfc-editor.org/info/rfc4253</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4456">[RFC4456]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chen, E.</span>, and <span class="refAuthor">R. Chandra</span>, <span class="refTitle">"BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)"</span>, <span class="seriesInfo">RFC 4456</span>, <span class="seriesInfo">DOI 10.17487/RFC4456</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4456">https://www.rfc-editor.org/info/rfc4456</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4655">[RFC4655]</dt>
        <dd>
<span class="refAuthor">Farrel, A.</span>, <span class="refAuthor">Vasseur, J.-P.</span>, and <span class="refAuthor">J. Ash</span>, <span class="refTitle">"A Path Computation Element (PCE)-Based Architecture"</span>, <span class="seriesInfo">RFC 4655</span>, <span class="seriesInfo">DOI 10.17487/RFC4655</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4655">https://www.rfc-editor.org/info/rfc4655</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5440">[RFC5440]</dt>
        <dd>
<span class="refAuthor">Vasseur, JP., Ed.</span> and <span class="refAuthor">JL. Le Roux, Ed.</span>, <span class="refTitle">"Path Computation Element (PCE) Communication Protocol (PCEP)"</span>, <span class="seriesInfo">RFC 5440</span>, <span class="seriesInfo">DOI 10.17487/RFC5440</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5440">https://www.rfc-editor.org/info/rfc5440</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6242">[RFC6242]</dt>
        <dd>
<span class="refAuthor">Wasserman, M.</span>, <span class="refTitle">"Using the NETCONF Protocol over Secure Shell (SSH)"</span>, <span class="seriesInfo">RFC 6242</span>, <span class="seriesInfo">DOI 10.17487/RFC6242</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6242">https://www.rfc-editor.org/info/rfc6242</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7589">[RFC7589]</dt>
        <dd>
<span class="refAuthor">Badra, M.</span>, <span class="refAuthor">Luchuk, A.</span>, and <span class="refAuthor">J. Schoenwaelder</span>, <span class="refTitle">"Using the NETCONF Protocol over Transport Layer Security (TLS) with Mutual X.509 Authentication"</span>, <span class="seriesInfo">RFC 7589</span>, <span class="seriesInfo">DOI 10.17487/RFC7589</span>, <time datetime="2015-06" class="refDate">June 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7589">https://www.rfc-editor.org/info/rfc7589</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7752">[RFC7752]</dt>
        <dd>
<span class="refAuthor">Gredler, H., Ed.</span>, <span class="refAuthor">Medved, J.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">S. Ray</span>, <span class="refTitle">"North-Bound Distribution of Link-State and Traffic Engineering (TE) Information Using BGP"</span>, <span class="seriesInfo">RFC 7752</span>, <span class="seriesInfo">DOI 10.17487/RFC7752</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7752">https://www.rfc-editor.org/info/rfc7752</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7988">[RFC7988]</dt>
        <dd>
<span class="refAuthor">Rosen, E., Ed.</span>, <span class="refAuthor">Subramanian, K.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"Ingress Replication Tunnels in Multicast VPN"</span>, <span class="seriesInfo">RFC 7988</span>, <span class="seriesInfo">DOI 10.17487/RFC7988</span>, <time datetime="2016-10" class="refDate">October 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7988">https://www.rfc-editor.org/info/rfc7988</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8253">[RFC8253]</dt>
        <dd>
<span class="refAuthor">Lopez, D.</span>, <span class="refAuthor">Gonzalez de Dios, O.</span>, <span class="refAuthor">Wu, Q.</span>, and <span class="refAuthor">D. Dhody</span>, <span class="refTitle">"PCEPS: Usage of TLS to Provide a Secure Transport for the Path Computation Element Communication Protocol (PCEP)"</span>, <span class="seriesInfo">RFC 8253</span>, <span class="seriesInfo">DOI 10.17487/RFC8253</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8253">https://www.rfc-editor.org/info/rfc8253</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8345">[RFC8345]</dt>
        <dd>
<span class="refAuthor">Clemm, A.</span>, <span class="refAuthor">Medved, J.</span>, <span class="refAuthor">Varga, R.</span>, <span class="refAuthor">Bahadur, N.</span>, <span class="refAuthor">Ananthakrishnan, H.</span>, and <span class="refAuthor">X. Liu</span>, <span class="refTitle">"A YANG Data Model for Network Topologies"</span>, <span class="seriesInfo">RFC 8345</span>, <span class="seriesInfo">DOI 10.17487/RFC8345</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8345">https://www.rfc-editor.org/info/rfc8345</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8401">[RFC8401]</dt>
        <dd>
<span class="refAuthor">Ginsberg, L., Ed.</span>, <span class="refAuthor">Przygienda, T.</span>, <span class="refAuthor">Aldrin, S.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"Bit Index Explicit Replication (BIER) Support via IS-IS"</span>, <span class="seriesInfo">RFC 8401</span>, <span class="seriesInfo">DOI 10.17487/RFC8401</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8401">https://www.rfc-editor.org/info/rfc8401</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8444">[RFC8444]</dt>
        <dd>
<span class="refAuthor">Psenak, P., Ed.</span>, <span class="refAuthor">Kumar, N.</span>, <span class="refAuthor">Wijnands, IJ.</span>, <span class="refAuthor">Dolganow, A.</span>, <span class="refAuthor">Przygienda, T.</span>, <span class="refAuthor">Zhang, J.</span>, and <span class="refAuthor">S. Aldrin</span>, <span class="refTitle">"OSPFv2 Extensions for Bit Index Explicit Replication (BIER)"</span>, <span class="seriesInfo">RFC 8444</span>, <span class="seriesInfo">DOI 10.17487/RFC8444</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8444">https://www.rfc-editor.org/info/rfc8444</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8556">[RFC8556]</dt>
      <dd>
<span class="refAuthor">Rosen, E., Ed.</span>, <span class="refAuthor">Sivakumar, M.</span>, <span class="refAuthor">Przygienda, T.</span>, <span class="refAuthor">Aldrin, S.</span>, and <span class="refAuthor">A. Dolganow</span>, <span class="refTitle">"Multicast VPN Using Bit Index Explicit Replication (BIER)"</span>, <span class="seriesInfo">RFC 8556</span>, <span class="seriesInfo">DOI 10.17487/RFC8556</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8556">https://www.rfc-editor.org/info/rfc8556</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="SR">
<section id="appendix-A">
      <h2 id="name-bier-te-and-segment-routing">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-bier-te-and-segment-routing" class="section-name selfRef">BIER-TE and Segment Routing</a>
      </h2>
<p id="appendix-A-1">SR (xref target="RFC8402"/&gt;) aims to enable lightweight path steering
via loose source routing. Compared to its more heavy-weight predecessor RSVP-TE,
SR does for example not require per-path signaling to each of these hops.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">BIER-TE supports the same design philosophy for multicast.
Like in SR, it relies on source-routing -
via the definition of a BitString. Like SR, it only requires to consider
the "hops" on which either replication has to happen, or across which the
traffic should be steered (even without replication).  Any other hops can
be skipped via the use of routed adjacencies.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">BIER-TE bit position (BP) can be understood as the BIER-TE equivalent of
"forwarding segments" in SR, but they have a different scope than SR forwarding
segments. Whereas forwarding segments in SR are global or local, BPs in BIER-TE
have a scope that is the group of BFR(s) that have adjacencies for this BP in
their BIFT. This can be called "adjacency" scoped forwarding segments.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">Adjacency scope could be global, but then every BFR would need an adjacency
for this BP, for example a forward_routed() adjacency with encapsulation to
the global SR SID of the destination. Such a BP would always result in ingress
replication though (as in <span>[<a href="#RFC7988" class="xref">RFC7988</a>]</span>). The first BFR encountering this BP would directly
replicate to it. Only by using non-global adjacency scope for BPs can 
traffic be steered and replicated on non-ingress BFR.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">SR can naturally be combined with BIER-TE and help to optimize it. For example,
instead of defining bit positions for non-replicating hops, it is equally
possible to use segment routing encapsulations (e.g. SR-MPLS label stacks)
for the encapsulation of "forward_routed" adjacencies.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<p id="appendix-A-6">Note that (non-TE) BIER itself can also be seen to be similar to SR. BIER BPs act
as global destination Node-SIDs and the BIER BitString is simply a highly optimized
mechanism to indicate multiple such SIDs and let the network take care of effectively
replicating the packet hop-by-hop to each destination Node-SID.  What BIER does not allow is to
indicate intermediate hops, or in terms of SR the ability to indicate a sequence of SID
to reach the destination. This is what BIER-TE and its adjacency scoped BP enables.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Toerless Eckert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Futurewei Technologies Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">2330 Central Expy</span></div>
<div dir="auto" class="left">
<span class="locality">Santa Clara</span>,  <span class="postal-code">95050</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tte+ietf@cs.fau.de" class="email">tte+ietf@cs.fau.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Menth</span></div>
<div dir="auto" class="left"><span class="org">University of Tuebingen</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:menth@uni-tuebingen.de" class="email">menth@uni-tuebingen.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gregory Cauchie</span></div>
<div dir="auto" class="left"><span class="org">Bouygues Telecom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:GCAUCHIE@bouyguestelecom.fr" class="email">GCAUCHIE@bouyguestelecom.fr</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
