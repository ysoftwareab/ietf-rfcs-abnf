



Network Working Group                                       M. Sivakumar
Internet-Draft                                          Juniper Networks
Intended status: Standards Track                               S. Venaas
Expires: 25 July 2022                                Cisco Systems, Inc.
                                                                Z. Zhang
                                                         ZTE Corporation
                                                               H. Asaeda
                                                                    NICT
                                                         21 January 2022


  Internet Group Management Protocol version 3 (IGMPv3) and Multicast
         Listener Discovery version 2 (MLDv2) Message Extension
                  draft-ietf-pim-igmp-mld-extension-06

Abstract

   This document specifies a generic mechanism to extend IGMPv3 and
   MLDv2 by using a list of TLVs (Type, Length and Value).

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 25 July 2022.

Copyright Notice

   Copyright (c) 2022 IETF Trust and the persons identified as the
   document authors.  All rights reserved.










Sivakumar, et al.         Expires 25 July 2022                  [Page 1]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions used in this document . . . . . . . . . . . . . .   3
   3.  Extension Format  . . . . . . . . . . . . . . . . . . . . . .   3
     3.1.  Multicast Listener Query Extension  . . . . . . . . . . .   4
     3.2.  Version 2 Multicast Listener Report Extension . . . . . .   5
     3.3.  IGMP Membership Query Extension . . . . . . . . . . . . .   6
     3.4.  IGMP Version 3 Membership Report Extension  . . . . . . .   7
   4.  Processing the extension  . . . . . . . . . . . . . . . . . .   8
   5.  Applicability and backwards compatibility . . . . . . . . . .   9
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .  10
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  10
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  10
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  10
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  10
     9.2.  Informative References  . . . . . . . . . . . . . . . . .  11
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  11

1.  Introduction

   This document defines a generic method to extend IGMPv3 [RFC3376] and
   MLDv2 [RFC3810] messages to accommodate information other than what
   is contained in the current message formats.  This is done by
   allowing a list of TLVs (Type, Length and Value) to be used in the
   Additional Data part of IGMPv3 and MLDv2 messages.  This document
   defines a registry for such TLVs, while other documents will define
   the specific types and their values, and their semantics.  The
   extension would only be used when at least one TLV is to be added to
   the message.  This extension also applies to the lightweight versions
   of IGMPv3 and MLDv2 as defined in [RFC5790].

   When this extension mechanism is used, it replaces the Additional
   Data section defined in IGMPv3/MLDv2 for TLVs.

   Additional Data is defined for Query messages in IGMPv3 [RFC3376]
   Section 4.1.10 and MLDv2 [RFC3810] Section 5.1.12, and for Report
   messages in IGMPv3 [RFC3376] Section 4.2.11 and MLDv2 [RFC3810]
   Section 5.2.11.



Sivakumar, et al.         Expires 25 July 2022                  [Page 2]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


2.  Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Extension Format

   For each of the IGMPv3 and MLDv2 headers, a previously reserved bit
   is used to indicate the presence of this extension.  When this
   extension is used, the Additional Data of IGMPv3 and MLDv2 messages
   is formatted as follows.  Note that this format contains a variable
   number of TLVs.  It MUST contain at least one TLV.


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Extension Type 1       |       Extension Length 1      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Extension Value 1                       |
       .                               .                               .
       .                               .                               .
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Extension Type 2       |       Extension Length 2      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Extension Value 2                       |
       .                               .                               .
       .                               .                               .
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Extension Type n       |       Extension Length n      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Extension Value n                       |
       .                               .                               .
       .                               .                               .
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Figure 1: Figure 1: Extension Format

      Extension Type: 2 octets.  This identifies a particular Extension
      Type as defined in the IGMP/MLD Extension Type Registry.  If this
      is not the first TLV, it will follow immediately after the end of
      the previous one.  There is no alignment or padding.






Sivakumar, et al.         Expires 25 July 2022                  [Page 3]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


      Extension Length: 2 octets.  This specifies the length in octets
      of the following Extension Value field.  The length may be zero if
      no value is needed.

      Extension Value: This field contains the value.  The length and
      the contents of this field is according to the specification of
      the Extension Type.

   IGMPv3 and MLDv2 messages are defined so that they can fit within the
   network MTU, in order to avoid fragmentation.  When this extension
   mechanism is used, the number of Group Records in each Report message
   SHOULD be kept small enough that the entire message, including any
   extension TLVs can fit within the network MTU.

3.1.  Multicast Listener Query Extension

   The MLDv2 Query Message format [RFC3810] with extension is shown
   below.  The E-bit MUST be set to 1 to indicate that the extension is
   present.  Otherwise, it MUST be 0.


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 130   |      Code     |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    Maximum Response Code      |           Reserved            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       *                                                               *
       |                                                               |
       *                       Multicast Address                       *
       |                                                               |
       *                                                               *
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E| Resv|S| QRV |     QQIC      |     Number of Sources (N)     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       *                                                               *
       |                                                               |
       *                       Source Address [1]                      *
       |                                                               |
       *                                                               *
       |                                                               |
       +-                                                             -+
       |                                                               |
       *                                                               *



Sivakumar, et al.         Expires 25 July 2022                  [Page 4]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


       |                                                               |
       *                       Source Address [2]                      *
       |                                                               |
       *                                                               *
       |                                                               |
       +-                              .                              -+
       .                               .                               .
       .                               .                               .
       +-                                                             -+
       |                                                               |
       *                                                               *
       |                                                               |
       *                       Source Address [N]                      *
       |                                                               |
       *                                                               *
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 2: Figure 2: MLD Query Extension

3.2.  Version 2 Multicast Listener Report Extension

   The MLDv2 Report Message format [RFC3810] with extension is shown
   below.  The E-bit MUST be set to 1 to indicate that the extension is
   present.  Otherwise, it MUST be 0.























Sivakumar, et al.         Expires 25 July 2022                  [Page 5]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 143   |    Reserved   |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E|         Reserved            |Nr of Mcast Address Records (M)|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                  Multicast Address Record [1]                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                  Multicast Address Record [2]                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                               .                               |
       .                               .                               .
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                  Multicast Address Record [M]                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                  Figure 3: Figure 3: MLD Report Extension

3.3.  IGMP Membership Query Extension

   The IGMPv3 Query Message format [RFC3376] with the extension is shown
   below.  The E-bit MUST be set to 1 to indicate that the extension is
   present.  Otherwise, it MUST be 0.










Sivakumar, et al.         Expires 25 July 2022                  [Page 6]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 0x11  | Max Resp Code |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                         Group Address                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E| Resv|S| QRV |     QQIC      |     Number of Sources (N)     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Source Address [1]                      |
       +-                                                             -+
       |                       Source Address [2]                      |
       +-                              .                              -+
       .                               .                               .
       .                               .                               .
       +-                                                             -+
       |                       Source Address [N]                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                  Figure 4: Figure 4: IGMP Query Extension

3.4.  IGMP Version 3 Membership Report Extension

   The IGMPv3 Report Message format [RFC3376] with the extension is
   shown below.  The E-bit MUST be set to 1 to indicate that the
   extension is present.  Otherwise, it MUST be 0.





















Sivakumar, et al.         Expires 25 July 2022                  [Page 7]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Type = 0x22  |    Reserved   |           Checksum            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |E|         Reserved            |  Number of Group Records (M)  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Group Record [1]                       .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Group Record [2]                       .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                               .                               |
       .                               .                               .
       |                               .                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Group Record [M]                       .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Extension                          |
       ~                                                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                 Figure 5: Figure 5: IGMP Report Extension

4.  Processing the extension

   The procedure specified in this document applies only when the E-bit
   is set.

   If the validation of the TLVs fails, the entire Additional Data field
   MUST be ignored as specified in IGMPv3 [RFC3376] and MLDv2 [RFC3810].
   The following checks must pass for the validation of the TLVs not to
   fail:

      At least one TLV MUST be present.




Sivakumar, et al.         Expires 25 July 2022                  [Page 8]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


      There MUST NOT be any data in the IP payload after the last TLV.
      To check this, the parser needs to walk through each of the TLVs
      until there are less than four octets left in the IP payload.  If
      there are any octets left, validation fails.

      The total length of the Extension MUST NOT exceed the remainder of
      the IP payload length.  For this validation, one only examines the
      content of the Extension Length fields.

   Future documents defining a new type MUST specify any additional
   processing and validation.  These rules, if any, will be examined
   only after the general validation (above) succeeds.

   Unsupported types MUST be ignored.

5.  Applicability and backwards compatibility

   IGMP and MLD implementations, particularly implementations on hosts,
   rarely change, and the adoption process of this extension mechanism
   is expected to be slow.  Also as new extensions are defined, it may
   take a long time before they are supported.  Due to this, defining
   extensions should not be taken lightly, and it is crucial to consider
   backwards compatibility.

   Implementations that do not support this extension mechanism will
   ignore it, as specified in [RFC3376] and [RFC3810].

   It is possible that a new extension type only applies to queries, or
   only to reports, or there may be other specific conditions for when
   it is to be used.  A document defining a new type MUST specify under
   what conditions the new type should be used, including for which
   message types.  It MUST also be specified what the behavior should be
   if a message is not used in the defined manner, e.g., if it is
   present in a query message, when it was only expected to be used in
   reports.

   When defining new types, care should be taken to consider the effect
   of partial support for the new TLV, by either the hosts or routers,
   on the same link.  Further, it must be considered whether there are
   any dependencies or restrictions on combinations between the new
   types and any pre-existing types.

   This document defines an extension mechanism only for IGMPv3 and
   MLDv2.  Hence this mechanism does not apply if hosts or routers send
   older version messages.






Sivakumar, et al.         Expires 25 July 2022                  [Page 9]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


6.  Security Considerations

   The Security Considerations of [RFC3376] and [RFC3810] also apply
   here.

   This document extends the IGMP and MLD message formats, allowing for
   a variable number of TLVs.  Implementations must take care when
   parsing the TLVs to not exceed the packet boundary, an attacker could
   intentionally specify a TLV with a length exceeding the boundary.

   An implementation could add a large number of minimal TLVs in a
   message to increase the cost of processing the message to magnify a
   Denial of Service attack.

7.  IANA Considerations

   IANA is asked to create a new registry called "IGMP/MLD Extension
   Types" in the "Internet Group Management Protocol (IGMP) Type
   Numbers" section, with registration procedure "IETF Review"
   [RFC8126], and with this document as a reference.  The registry is
   common for IGMP and MLD.  The initial content of the registry should
   be as below (empty).

    Type  Length   Name                        Reference
   --------------------------------------------------------------

8.  Acknowledgements

   The authors thank Ron Bonica, Ian Duncan, Wesley Eddy, Leonard
   Giuliano, Jake Holland, Tommy Pauly, Pete Resnick, Alvaro Retana and
   Zhaohui Zhang for reviewing the document and providing valuable
   feedback.

9.  References

9.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3376]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
              Thyagarajan, "Internet Group Management Protocol, Version
              3", RFC 3376, DOI 10.17487/RFC3376, October 2002,
              <https://www.rfc-editor.org/info/rfc3376>.





Sivakumar, et al.         Expires 25 July 2022                 [Page 10]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


   [RFC3810]  Vida, R., Ed. and L. Costa, Ed., "Multicast Listener
              Discovery Version 2 (MLDv2) for IPv6", RFC 3810,
              DOI 10.17487/RFC3810, June 2004,
              <https://www.rfc-editor.org/info/rfc3810>.

   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", BCP 26,
              RFC 8126, DOI 10.17487/RFC8126, June 2017,
              <https://www.rfc-editor.org/info/rfc8126>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

9.2.  Informative References

   [RFC5790]  Liu, H., Cao, W., and H. Asaeda, "Lightweight Internet
              Group Management Protocol Version 3 (IGMPv3) and Multicast
              Listener Discovery Version 2 (MLDv2) Protocols", RFC 5790,
              DOI 10.17487/RFC5790, February 2010,
              <https://www.rfc-editor.org/info/rfc5790>.

Authors' Addresses

   Mahesh Sivakumar
   Juniper Networks
   64 Butler St
   Milpitas,  CA 95035
   United States of America

   Email: sivakumar.mahesh@gmail.com


   Stig Venaas
   Cisco Systems, Inc.
   Tasman Drive
   San Jose,  CA 95134
   United States of America

   Email: stig@cisco.com











Sivakumar, et al.         Expires 25 July 2022                 [Page 11]

Internet-Draft       IGMPv3/MLDv2 message extension         January 2022


   Zheng(Sandy) Zhang
   ZTE Corporation
   No. 50 Software Ave, Yuhuatai District
   Nanjing
   210000
   China

   Email: zhang.zheng@zte.com.cn


   Hitoshi Asaeda
   National Institute of Information and Communications Technology
   4-2-1 Nukui-Kitamachi,
   184-8795
   Japan

   Email: asaeda@nict.go.jp


































Sivakumar, et al.         Expires 25 July 2022                 [Page 12]
