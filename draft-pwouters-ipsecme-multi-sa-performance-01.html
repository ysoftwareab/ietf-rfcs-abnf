<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>IKEv2 support for per-queue Child SAs</title>
<meta content="Antony Antony" name="author">
<meta content="Tobias Brunner" name="author">
<meta content="Steffen Klassert" name="author">
<meta content="Paul Wouters" name="author">
<meta content="
       
       This document defines two Notify Message Type Payloads for the Internet
       Key Exchange Protocol Version 2 (IKEv2) indicating support for
       the negotiation of multiple identical Child SAs to optimize
       performance.
       
       
       The CPU_QUEUES notification indicates support for multiple queues
       or CPUs. The CPU_QUEUE_INFO notification are used to confirm and
       optionally convey information about the specific queue, such as QoS level.
       
       
       Using multiple identical Child SAs has the benefit that each
       stream has its own Sequence Number Counter, ensuring that CPUs don't
       have to synchronize their crypto state or disable their packet
       replay protection.
       
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="IKEv2" name="keyword">
<meta content="IPsec" name="keyword">
<meta content="draft-pwouters-ipsecme-multi-sa-performance-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.2
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.0.4
    six 1.16.0
-->
<link href="/tmp/draft-pwouters-ipsecme-multi-sa-performance-01-2sp48j6i.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">IKEv2 support for per-queue Child SAs</td>
<td class="right">September 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Antony, et al.</td>
<td class="center">Expires 1 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-pwouters-ipsecme-multi-sa-performance-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-09-28" class="published">28 September 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-01">1 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Antony</div>
<div class="org">secunet</div>
</div>
<div class="author">
      <div class="author-name">T. Brunner</div>
<div class="org">codelabs</div>
</div>
<div class="author">
      <div class="author-name">S. Klassert</div>
<div class="org">secunet</div>
</div>
<div class="author">
      <div class="author-name">P. Wouters</div>
<div class="org">Aiven</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">IKEv2 support for per-queue Child SAs</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
       This document defines two Notify Message Type Payloads for the Internet
       Key Exchange Protocol Version 2 (IKEv2) indicating support for
       the negotiation of multiple identical Child SAs to optimize
       performance.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
       The CPU_QUEUES notification indicates support for multiple queues
       or CPUs. The CPU_QUEUE_INFO notification are used to confirm and
       optionally convey information about the specific queue, such as QoS level.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
       Using multiple identical Child SAs has the benefit that each
       stream has its own Sequence Number Counter, ensuring that CPUs don't
       have to synchronize their crypto state or disable their packet
       replay protection.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-performance-bottlenecks" class="xref">Performance bottlenecks</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-negotiation-of-cpu-specific" class="xref">Negotiation of CPU specific Child SAs</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-implementation-consideratio" class="xref">Implementation Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-payload-format" class="xref">Payload Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-cpu_queues-notify-message-p" class="xref">CPU_QUEUES Notify Message Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-cpu_queue_info-notify-messa" class="xref">CPU_QUEUE_INFO Notify Message Payload</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-operational-considerations" class="xref">Operational Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-linux-xfrm" class="xref">Linux XFRM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-libreswan" class="xref">Libreswan</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-strongswan" class="xref">strongSwan</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-iproute2" class="xref">iproute2</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
       IPsec implementations are currently limited to using one queue
       or CPU per Child SA. The result is that a machine with many
       queues/CPUs is limited to only using one of these per Child SA. This
       severely limits the throughput that can be attained. An unencrypted
       link of 10Gbps or more is commonly reduced to 2-5Gbps when IPsec
       is used to encrypt the link using AES-GCM. By using the implementation
       specified in this document, aggregate throughput increased from 5Gbps
       using 1 CPU to 40-60 Gbps using 25-30 CPUs<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
       While this could be (partially) mitigated by setting up multiple
       narrowed Child SAs, for example using Populate From Packet (PFP)
       as specified in <span>[<a href="#RFC4301" class="xref">RFC4301</a>]</span>, this IPsec feature is
       not widely implemented. Some route based IPsec implementations
       might be able to implement this with specific rules into separate
       network interfaces, but these methods might not be available for
       policy based IPsec implementations.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
       To make better use of multiple network queues and CPUs, it can
       be beneficial to negotiate and install multiple identical Child
       SAs. IKEv2 <span>[<a href="#RFC7296" class="xref">RFC7296</a>]</span> already allows installing
       multiple identical Child SAs, it offers no method to negotiate
       the number of Child SAs or indicate the purpose for the multiple
       Child SAs that are requested.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
       When two IKEv2 peers want to negotiate multiple Child SAs, it
       is useful to be able to convey how many Child SAs are required
       for optimized traffic. This avoids triggering CREATE_CHILD_SA
       exchanges that will only be rejected by the peer.<a href="#section-1-4" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
       The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
       "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
       "OPTIONAL" in this document are to be interpreted as described in BCP
       14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="performance">
<section id="section-2">
      <h2 id="name-performance-bottlenecks">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-performance-bottlenecks" class="section-name selfRef">Performance bottlenecks</a>
      </h2>
<p id="section-2-1">
       Currently, most IPsec implementations are limited by using one CPU
       or network queue per Child SA. There are a number of practical
       reasons for this, but a key limitation is that sharing the crypto
       state, counters and sequence numbers between multiple CPUs is
       not feasible without a significant performance penalty. There
       is a need to negotiate and establish multiple Child SAs with
       identical TSi/TSr on a per-queue or per-CPU basis.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="neg_cpu">
<section id="section-3">
      <h2 id="name-negotiation-of-cpu-specific">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-negotiation-of-cpu-specific" class="section-name selfRef">Negotiation of CPU specific Child SAs</a>
      </h2>
<p id="section-3-1">
       When negotiating CPU specific Child SAs, the first SA negotiated
       either in an IKE_AUTH exchange or CREATE_CHILD_SA is called
       Fallback SA. This Child SA is similar to a regular Cgild SA in
       that it is not bound to a single CPU. This
       Fallback Child SA (or its rekeyed successors) MUST remain active
       for the lifetime of the IPsec session to ensure that there is
       always a Child SA that can be selected to send traffic over,
       in case a per-resource Child SA is not available. Additional
       Child SAs are installed bound to a specific CPU. These Child SAs
       are responsible for the bulk of the traffic.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
       The CPU_QUEUES notification payload is sent in the IKE_AUTH or
       CREATE_CHILD_SA Exchange indicating the negotiated Child SA is
       a Fallback SA.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
       The CPU_QUEUES notification value refers to the number of
       additional resource-specific Child SAs that may be installed for
       this particular TSi/TSr combination excluding the Fallback Child
       SA. Both peers send the preferred minimum number of additional
       Child SAs to install. Both peers pick the maximum of the two
       numbers (within reason). That is, if the initiator prefers 16
       and the responder prefers 48, then the number negotiated is
       48. The responder may at any time reject additional Child SAs
       by returning TS_UNACCEPTABLE. It should not return NO_ADDITIONAL_SAS,
       as there might be another Child SAs with different Traffic Selectors
       that would still be allowed by the peer.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">[Antony: Valery's feedback was not to use TS_UNACCEPTABLE. instead
       create a new notify or use TEMPORARY_FAILURE.
       TEMPORARY_FAILURE because the situation may change again if you try
       again. I have preference to define new NO_CPU_QUEUE_INFO_SA]<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
       CPU-specific Child SAs are negotiated as regular Child
       SAs using the CREATE_CHILD_SA exchange and are identified by a
       CPU_QUEUE_INFO notification. Upon installation, each Child SA
       is associated with an additional local selector, such as CPU
       or queue.  These additional Child SAs MUST be negotiated with
       identical Child SA properties that were negotiated for the Fallback
       SA. This includes cryptographic algorithms, Traffic Selectors, Mode
       (e.g. transport mode), compression usage, etc. However, the Child
       SAs do have their own individual keying material that is derived
       according to the regular IKEv2 process. The CPU_QUEUE_INFO can
       be empty or contain some identifying data that could be useful
       for debugging purposes.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">
       Additional Child SAs can be started on-demand or can be started
       all at once. Peers may also delete specific per-resource Child SAs if
       they deem the associated resource to be idle. The Fallback SA MUST
       NOT be deleted while any per-resource Child SAs are still present.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">
       During the CREATE_CHILD_SA rekey for the Child SA, the
       CPU_QUEUE_INFO notification MAY be included, but regardless of whether
       or not it is included, the rekeyed Child SA MUST be bound to the same
       resource(s) as the Child SA that is being rekeyed.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">
       As with regular Child SA rekeying, the new Child SA may not be
       different from the rekeyed Child SA with respect to cryptographic
       algorithms and MUST cover the original Traffic Selector ranges.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">
       If a CREATE_CHILD_SA exchange request containing both a
       CPU_QUEUE_INFO and a CPU_QUEUES notification is received, the responder
       MUST ignore the CPU_QUEUE_INFO payload. If a CREATE_CHILD_SA
       exchange reply is received with both CPU_QUEUE_INFO and CPU_QUEUES
       notifications, the initiator MUST ignore the notification that it
      did not send in the request.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">
       [Steffen: I tend to tread these cases as an error.]<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">[Tobias: That's currently how I implemented it (being lenient on what
          I accept). But we could also treat those cases as errors. The
          question would just be what we should return (NO_PROPOSAL_CHOSEN
          and keep IKE and other Child SAs or even INALID_SYNTAX and kill the
          whole IKE_SA - and as initiator we either have to terminate the Child
          or the IKE_SA actively if we receive both notifies).]<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">
       The CPU_QUEUES notification, even when it is sent in the IKE_AUTH
       exchange, is not an attribute of the IKE peer. It is an attribute
       of the Child SA, similar to the USE_TRANSPORT notification.
       That is, an IKE peer can have multiple Child SAs covering
       different traffic selectors and selectively decide whether or
       not to enable additional per-resource Child SAs for each of these
       Child SAs covering different Traffic Selectors.<a href="#section-3-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="impl_consider">
<section id="section-4">
      <h2 id="name-implementation-consideratio">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<p id="section-4-1">
       There are various considerations that an implementation can
       use to determine the best way to install multiple Child SAs.
       Below are examples of such strategies.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
       A simple distribution could be to install one additional Child
       SA on each CPU. The Fallback Child SA ensures that any CPU
       generating traffic to be encrypted has an available (if not
       optimal) Child SA to use. Any subsequent Child SAs with identical
       TSi/TSr Traffic Selectors are installed in such a way to only be
       used by a single CPU or network queue.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
       Performing per-CPU Child SA negotiations can result in both peers
       initiating additional Child SAs at once. This is especially
       likely if per-CPU Child SAs are triggered by individual
       SADB_ACQUIRE <span>[<a href="#RFC2367" class="xref">RFC2367</a>]</span> messages. Responders should
       install the additional Child SA on a CPU with the least amount of
       additional Child SAs for this TSi/TSr pair. It should count outstanding
       SADB_ACQUIREs as an assigned additional Child SA. It is still possible
       that when the peers only have one slot left to assign, that both peers send
       a CREATE_CHILD_SA request at the same time. [Paul: Is there
       anything we can do at the protocol level to terminate one of
       these without race conditions?] [Antony: if CPU_QUEUE_INFO is
       a MUST, that info could be used for better one-to-one mapping,
       as well as delete the extra SAs. Also, keep in mind the general
       case IKE window &gt; 1]<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
       As an optimization, additional Child SAs that see little traffic
       MAY be deleted. The Fallback Child SA MUST NOT be deleted when
       idle, as it is likely to be idle if enough per-CPU Child SAs
       are installed. However, if one of those per-CPU child SAs is
       deleted because it was idle, and subsequently that CPU starts
       to generate traffic again, that traffic does not have a per-CPU
       Child SA and will be encrypted using the Fallback Child SA. Meanwhile,
       the IKE daemon might be negotiating to bring up a new per-CPU Child SA.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
       When the number of queues or CPUs are different between the
       peers, the peer with the least amount of queues or CPUs MAY
       decide to not install a second outbound Child SA for the same
       resource as it will never use it to send traffic. However, it MUST
       install all inbound Child SAs as it has committed to receiving traffic
       on these negotiated Child SAs.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">
       If per-CPU SADB_ACQUIRE messages are implemented (see <a href="#Operations" class="xref">Section 6</a>),
       the Traffic Selector (TSi) entry containing the information of the
       trigger packet should still be included in the TS set.  This information
       MAY be used by the peer to select the most optimal target CPU to install
       the additional Child SA on. For example, if the trigger packet was for a
       TCP destination to port 25 (SMTP), it might be able to install the Child
       SA on the CPU that is also running the mail server process. Trigger packet
       Traffic Selectors are documented in <span>[<a href="#RFC7296" class="xref">RFC7296</a>]</span> Section 2.9.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">
       As per RFC 7296, rekeying a Child SA SHOULD use the same (or wider) Traffic
       Selectors to ensure that the new Child SA covers everything that the
       rekeyed Child SA covers. This includes Traffic Selectors negotiated
       via Configuration Payloads (CP) such as INTERNAL_IP4_ADDRESS which may
       use the original wide TS set or use the narrowed TS set.<a href="#section-4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payload_formats">
<section id="section-5">
      <h2 id="name-payload-format">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-payload-format" class="section-name selfRef">Payload Format</a>
      </h2>
<p id="section-5-1">
      All multi-octet fields representing integers are laid out in big
      endian order (also known as "most significant byte first", or
      "network byte order").<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="payload_pcpuq">
<section id="section-5.1">
        <h3 id="name-cpu_queues-notify-message-p">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-cpu_queues-notify-message-p" class="section-name selfRef">CPU_QUEUES Notify Message Payload</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.1-1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-----------------------------+-------------------------------+
! Next Payload  !C!  RESERVED   !         Payload Length        !
+---------------+---------------+-------------------------------+
!  Protocol ID  !   SPI Size    !      Notify Message Type      !
+---------------+---------------+-------------------------------+
!  Minimum number of IPsec SAs                                  !
+-------------------------------+-------------------------------+
</pre><a href="#section-5.1-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">Protocol ID (1 octet) - MUST be 0. MUST be ignored if not 0.<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">SPI Size (1 octet) - MUST be 0. MUST be ignored if not 0.<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">Notify Message Type (2 octets) - set to [TBD1]<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.4">Minimum number of per-CPU IPsec SAs (4 octets).
               MUST be greater than 0. If 0 is received, it MUST be interpreted as 1.<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-3">
       Note: The Fallback Child SA that is not bound to a single CPU is not counted as part of these numbers.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payload_info_cpu">
<section id="section-5.2">
        <h3 id="name-cpu_queue_info-notify-messa">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-cpu_queue_info-notify-messa" class="section-name selfRef">CPU_QUEUE_INFO Notify Message Payload</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.2-1">
<pre>
                    1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-----------------------------+-------------------------------+
! Next Payload  !C!  RESERVED   !         Payload Length        !
+---------------+---------------+-------------------------------+
!  Protocol ID  !   SPI Size    !      Notify Message Type      !
+---------------+---------------+-------------------------------+
!                                                               !
~               Optional queue identifier                       ~
!                                                               !
+-------------------------------+-------------------------------+
</pre><a href="#section-5.2-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">Protocol ID (1 octet) - MUST be 0. MUST be ignored if not 0.<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.2">SPI Size (1 octet) - MUST be 0. MUST be ignored if not 0.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.3">Notify Message Type (2 octets) - set to [TBD3]<a href="#section-5.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.4">Optional Payload Data. This value MAY be set to convey the local identity of the queue.
               The value SHOULD be a unique identifier and the peer SHOULD only use it for debugging purposes.<a href="#section-5.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="Operations">
<section id="section-6">
      <h2 id="name-operational-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<p id="section-6-1">
      Implementations supporting per-CPU SAs SHOULD extend their local
      SPD selector, and the mechanism of on-demand negotiation that is
      triggered by traffic to include a CPU (or queue) identifier in
      their SADB_ACQUIRE message from the SPD to the IKE daemon. If the IKEv2
      extension defined in this document is negotiated with the peer, a
      node which does not support receiving per-CPU SADB_ACQUIRE messages MAY
      initiate all its Child SAs immediately upon receiving the (only)
      SADB_ACQUIRE it will receive from the IPsec stack. Such implementations
      also need to be careful when receiving a Delete Notify request for a
      per-CPU Child SA, as it has no method to detect when it should bring
      up such a per-CPU Child SA again later. And bringing the deleted
      per-CPU Child SA up again immediately after receiving the Delete
      Notify might cause an infinite loop between the peers. Another
      issue of not bringing up all its per-CPU Child SAs is that if
      the peer acts similarly, the two peers might end up with only the
      Fallback SA without ever activating any per-CPU Child SAs. It is
      there for RECOMMENDED to implement per-CPU SADB_ACQUIRE messages.
      [ Antony: It would be nice to add manual/scripts for starting of connection
       and bringing up per-CPU SAs. It could be very simple, a external
       program decides to start a per-CPU SA. ]<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
      The minimum number of Child SAs negotiated should not be treated
      as the maximum number of allowed Child SAs. Peers SHOULD
      be lenient with this number to account for corner cases. For
      example, during Child SA rekeying, there might be a large number
      of additional Child SAs created before the old Child SAs are torn
      down. Similarly, when using on-demand Child SAs, both ends could
      trigger multiple Child SA requests as the initial packet causing
      the Child SA negotiation might have been transported to the peer
      via the Fallback SA where its reply packet might also trigger an
      on-demand Child SA negotiation to start. A peer may want to allow
      up to double the negotiated minimum number of Child SAs, and rely on
      idleness of Child SAs to tear down any unused Child SAs gradually to
      to reach an optimal number of Child SAs. Adding too many SAs may slow
      down per-packet SAD lookup.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
     Implementations might support dynamically moving a per-CPU Child
     SAs from one CPU to another CPU. If this method is supported,
     implementations must be careful to move both the inbound and outbound
     SAs. If the IPsec endpoint is a gateway, it can move the inbound SA
     and outbound SA independently from each other. It is likely that
     for a gateway, IPsec traffic would be asymmetric.  If the IPsec
     endpoint is the same host responsible for generating the traffic,
     the inbound and outbound SAs SHOULD remain as a pair on the same CPU.
     If a host previously skipped installing an outbound SA because it
     would be an unused duplicate outbound SA, it will have to create
     and add the previously skipped outbound SA to the SAD with the new
     CPU ID. The inbound SA may not have CPU ID in the SAD.  Adding the
     outbound SA to the SAD requires access to the key material, whereas
     for updating the CPU selector on an existing outbound SAs. access
     to key material might not be needed.  To support this, the IKE
     software might have to hold on to the key material longer than it
     normally would, as it might actively attempt to destroy key material
     from memorya that it no longer needs access to.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">
      [TO DO]<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="impl_status">
<section id="section-8">
      <h2 id="name-implementation-status">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-8-1">
      [Note to RFC Editor: Please remove this section and the reference to
      <span>[<a href="#RFC6982" class="xref">RFC6982</a>]</span> before publication.]<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
      This section records the status of known implementations of the
      protocol defined by this specification at the time of posting of
      this Internet-Draft, and is based on a proposal described in
      <span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>. The description of implementations in this
      section is intended to assist the IETF in its decision processes
      in progressing drafts to RFCs. Please note that the listing of
      any individual implementation here does not imply endorsement
      by the IETF. Furthermore, no effort has been spent to verify the
      information presented here that was supplied by IETF contributors.
      This is not intended as, and must not be construed to be, a catalog
      of available implementations or their features. Readers are advised
      to note that other implementations may exist.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">
      According to <span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>, "this will allow reviewers
      and working groups to assign due consideration to documents that
      have the benefit of running code, which may serve as evidence of
      valuable experimentation and feedback that have made the implemented
      protocols more mature.  It is up to the individual working groups
      to use this information as they see fit".<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">
      Authors are requested to add a note to the RFC Editor at the
      top of this section, advising the Editor to remove the entire
      section before publication, as well as the reference to <span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>.<a href="#section-8-4" class="pilcrow">¶</a></p>
<div id="section.impl-status.xfrm">
<section id="section-8.1">
        <h3 id="name-linux-xfrm">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-linux-xfrm" class="section-name selfRef">Linux XFRM</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-8.1-1">
          <dt id="section-8.1-1.1">Organization: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.2">Linux kernel XFRM<a href="#section-8.1-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-1.3">Name: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.4">XFRM-PCPU-v1 https://git.kernel.org/pub/scm/linux/kernel/git/klassert/linux-stk.git/log/?h=xfrm-pcpu-v1<a href="#section-8.1-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-1.5">Description: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.6"> An initial Kernel IPsec implementation
             of the per-CPU method.<a href="#section-8.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-1.7">Level of maturity: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.8">Alpha<a href="#section-8.1-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-1.9">Coverage: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.10">
            Implements Fallback Child SA and per-CPU Child SAs. It only supports
            the NETLINK API. The PFKEYv2 API is not supported.<a href="#section-8.1-1.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-1.11">Licensing: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.12">GPLv2<a href="#section-8.1-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-1.13">Implementation experience: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.14"> The Linux XFRM
             implementation added two additional attributes to support per-CPU SAs.

             There is a new attribute XFRMA_SA_PCPU, u32, for the SAD entry.
             This attribute should present on the outgoing SA, per-CPU Child SAs,
             starting from 0. This attribute MUST NOT be present on the Fallback
             XFRM SA. It is used by the kernel only for the outgoing traffic,
             (clear to encrypted).
             The incoming SAs, both the Fallback and the per-CPU SA, do not need
             XFRMA_SA_PCPU attribute. XFRM stack can not use CPU id on the incoming SA.
             The kernel internally sets the value to 0xFFFFFF for the
             incoming SA and the Fallback SA.

             However, one may add XFRMA_SA_PCPU to the incoming  per-CPU SA to steer
             the ESP flow, to a specific Q or CPU e.g ethtool ntuple configuration.

      The SPD entry has new flag XFRM_POLICY_CPU_ACQUIRE.
             It should be set only on the "out" policy. The flag should
             be disabled when the policy is a trap policy, without SPD entries.
             After a successful negotiation of CPU_QUEUES, while adding the
             Fallback Child SA, the SPD entry can be updated with the
             XFRM_POLICY_CPU_ACQUIRE flag.
             When XFRM_POLICY_CPU_ACQUIRE is set, the XFRM_MSG_ACQUIRE generated
             will include the XFRMA_SA_PCPU attribute.<a href="#section-8.1-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-1.15">Contact: </dt>
          <dd style="margin-left: 1.5em" id="section-8.1-1.16">Steffen Klassert steffen.klassert@secunet.com<a href="#section-8.1-1.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="section.impl-status.libreswan">
<section id="section-8.2">
        <h3 id="name-libreswan">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-libreswan" class="section-name selfRef">Libreswan</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-8.2-1">
          <dt id="section-8.2-1.1">Organization: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.2">The Libreswan Project<a href="#section-8.2-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-1.3">Name: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.4">pcpu-3 https://libreswan.org/wiki/XFRM_pCPU<a href="#section-8.2-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-1.5">Description: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.6">
           An initial IKE implementation of the per-CPU method.<a href="#section-8.2-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-1.7">Level of maturity: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.8">Alpha<a href="#section-8.2-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-1.9">Coverage: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.10">
            implements Fallback Child SA and per-CPU additional Child SAs<a href="#section-8.2-1.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-1.11">Licensing: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.12">GPLv2<a href="#section-8.2-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-1.13">Implementation experience: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.14">TBD<a href="#section-8.2-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-1.15">Contact: </dt>
          <dd style="margin-left: 1.5em" id="section-8.2-1.16">Libreswan Development: swan-dev@libreswan.org<a href="#section-8.2-1.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="section.impl-status.strongswan">
<section id="section-8.3">
        <h3 id="name-strongswan">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-strongswan" class="section-name selfRef">strongSwan</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-8.3-1">
          <dt id="section-8.3-1.1">Organization: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.2">The StrongSwan Project<a href="#section-8.3-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-1.3">Name: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.4">StrongSwan https://github.com/strongswan/strongswan/tree/per-cpu-sas-poc/<a href="#section-8.3-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-1.5">Description: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.6">
           An initial IKE implementation of the per-CPU method.<a href="#section-8.3-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-1.7">Level of maturity: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.8">Alpha<a href="#section-8.3-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-1.9">Coverage: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.10">
            implements Fallback Child SA and per-CPU additional Child SAs<a href="#section-8.3-1.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-1.11">Licensing: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.12">GPLv2<a href="#section-8.3-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-1.13">Implementation experience: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.14">
             StrongSwan use private space values for notifications
             CPU_QUEUES (40970) and QUEUE_INFO (40971).<a href="#section-8.3-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-1.15">Contact: </dt>
          <dd style="margin-left: 1.5em" id="section-8.3-1.16">Tobias Brunner tobias@strongswan.org<a href="#section-8.3-1.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="section.impl-status.iproute2">
<section id="section-8.4">
        <h3 id="name-iproute2">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-iproute2" class="section-name selfRef">iproute2</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-8.4-1">
          <dt id="section-8.4-1.1">Organization: </dt>
          <dd style="margin-left: 1.5em" id="section-8.4-1.2">The iproute2 Project<a href="#section-8.4-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-1.3">Name: </dt>
          <dd style="margin-left: 1.5em" id="section-8.4-1.4"> iproute2 https://github.com/antonyantony/iproute2/tree/pcpu-v1<a href="#section-8.4-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-1.5">Description: </dt>
          <dd style="margin-left: 1.5em" id="section-8.4-1.6">Implemented the per-CPU attributes for the "ip xfrm" command.<a href="#section-8.4-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-1.7">Level of maturity: </dt>
          <dd style="margin-left: 1.5em" id="section-8.4-1.8">Alpha<a href="#section-8.4-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-1.9">Licensing: </dt>
          <dd style="margin-left: 1.5em" id="section-8.4-1.10">GPLv2<a href="#section-8.4-1.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-1.11">Implementation experience: </dt>
          <dd style="margin-left: 1.5em" id="section-8.4-1.12">TBD<a href="#section-8.4-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-1.13">Contact: </dt>
          <dd style="margin-left: 1.5em" id="section-8.4-1.14">Antony Antony antony.antony@secunet.com<a href="#section-8.4-1.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">
        This document defines four new IKEv2 Notify Message Type payloads for the IANA "IKEv2 Notify Message Types - Status Types" registry.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="iana_requests">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-9-2.1">
<pre>
      Value   Notify Type Messages - Status Types    Reference
      -----   ------------------------------    ---------------
      [TBD1]   CPU_QUEUES                        [this document]
      [TBD3]   CPU_QUEUE_INFO                    [this document]
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2367">[RFC2367]</dt>
        <dd>
<span class="refAuthor">McDonald, D.</span>, <span class="refAuthor">Metz, C.</span>, and <span class="refAuthor">B. Phan</span>, <span class="refTitle">"PF_KEY Key Management API, Version 2"</span>, <span class="seriesInfo">RFC 2367</span>, <span class="seriesInfo">DOI 10.17487/RFC2367</span>, <time datetime="1998-07" class="refDate">July 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2367">https://www.rfc-editor.org/info/rfc2367</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6982">[RFC6982]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">RFC 6982</span>, <span class="seriesInfo">DOI 10.17487/RFC6982</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6982">https://www.rfc-editor.org/info/rfc6982</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Antony Antony</span></div>
<div dir="auto" class="left"><span class="org">secunet Security Networks AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:antony.antony@secunet.com" class="email">antony.antony@secunet.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Brunner</span></div>
<div dir="auto" class="left"><span class="org">codelabs GmbH</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias@codelabs.ch" class="email">tobias@codelabs.ch</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Steffen Klassert</span></div>
<div dir="auto" class="left"><span class="org">secunet Security Networks AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:steffen.klassert@secunet.com" class="email">steffen.klassert@secunet.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul Wouters</span></div>
<div dir="auto" class="left"><span class="org">Aiven</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:paul.wouters@aiven.io" class="email">paul.wouters@aiven.io</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
