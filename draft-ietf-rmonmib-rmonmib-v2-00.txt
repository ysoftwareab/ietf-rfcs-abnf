

              Remote Network Monitoring Management Information Base
                       <draft-ietf-rmonmib-rmonmib-01.txt>

                                   June 1, 1995


                                     Editor:

                                Steven Waldbusser

                                waldbusser@ins.com






          1.  Status of this Memo

          This document is an Internet-Draft.  Internet-Drafts are
          working documents of the Internet Engineering Task Force
          (IETF), its areas, and its working groups.  Note that other
          groups may also distribute working documents as Internet-
          Drafts.

          Internet-Drafts are draft documents valid for a maximum of six
          months.  Internet-Drafts may be updated, replaced, or
          obsoleted by other documents at any time.  It is not
          appropriate to use Internet-Drafts as reference material or to
          cite them other than as a ``working draft'' or ``work in
          progress.''

          To learn the current status of any Internet-Draft, please
          check the 1id-abstracts.txt listing contained in the
          Internet-Drafts Shadow Directories on ds.internic.net,
          nic.nordu.net, venera.isi.edu, or munnari.oz.au.


          2.  Abstract

          This memo defines an experimental portion of the Management
          Information Base (MIB) for use with network management
          protocols in TCP/IP-based internets.  In particular, it
          defines objects for managing remote network monitoring
          devices.











          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          This memo does not specify a standard for the Internet
          community.
















































          Steven Waldbusser    Expires Nov 22, 1995             [Page 2]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          3.  The Network Management Framework

          The Internet-standard Network Management Framework consists of
          three components.  They are:

          RFC 1155[1] which defines the SMI, the mechanisms used for
          describing and naming objects for the purpose of management.
          RFC 1212[2] defines a more concise description mechanism,
          which is wholly consistent with the SMI.

          RFC 1213[3] which defines MIB-II, the core set of managed
          objects for the Internet suite of protocols.

          RFC 1157[4] which defines the SNMP, the protocol used for
          network access to managed objects.

          The Framework permits new objects to be defined for the
          purpose of experimentation and evaluation.

          Managed objects are accessed via a virtual information store,
          termed the Management Information Base or MIB.  Within a given
          MIB module, objects are defined using RFC 1212's OBJECT-TYPE
          macro.  At a minimum, each object has a name, a syntax, an
          access-level, and an implementation-status.

          The name is an object identifier, an administratively assigned
          name, which specifies an object type.  The object type
          together with an object instance serves to uniquely identify a
          specific instantiation of the object.  For human convenience,
          we often use a textual string, termed the object descriptor,
          to also refer to the object type.

          The syntax of an object type defines the abstract data
          structure corresponding to that object type.  The ASN.1[5]
          language is used for this purpose.  However, RFC 1155
          purposely restricts the ASN.1 constructs which may be used.
          These restrictions are explicitly made for simplicity.

          The access-level of an object type defines whether it makes
          "protocol sense" to read and/or write the value of an instance
          of the object type.  (This access-level is independent of any
          administrative authorization policy.)

          The implementation-status of an object type indicates whether
          the object is mandatory, optional, obsolete, or deprecated.





          Steven Waldbusser    Expires Nov 22, 1995             [Page 3]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          4.  Overview

          Remote network monitoring devices, often called monitors or
          probes, are instruments that exist for the purpose of managing
          a network.  Often these remote probes are stand-alone devices
          and devote significant internal resources for the sole purpose
          of managing a network.  An organization may employ many of
          these devices, one per network segment, to manage its
          internet.  In addition, these devices may be used for a
          network management service provider to access a client
          network, often geographically remote.

          The objects defined in this document are intended as an
          interface between an RMON agent and an RMON management
          application and are not intended for direct manipulation by
          humans.  While some users may tolerate the direct display of
          some of these objects, few will tolerate the complexity of
          manually manipulating objects to accomplish row creation.
          These functions should be handled by the management
          application.


          4.1.  Remote Network Management Goals

              o Offline Operation
                  There are sometimes conditions when a management
                  station will not be in constant contact with its
                  remote monitoring devices.  This is sometimes by
                  design in an attempt to lower communications costs
                  (especially when communicating over a WAN or
                  dialup link), or by accident as network failures
                  affect the communications between the management
                  station and the probe.

                  For this reason, this MIB allows a probe to be
                  configured to perform diagnostics and to collect
                  statistics continuously, even when communication with
                  the management station may not be possible or
                  efficient.  The probe may then attempt to notify
                  the management station when an exceptional condition
                  occurs.  Thus, even in circumstances where
                  communication between management station and probe is
                  not continuous, fault, performance, and configuration
                  information may be continuously accumulated and
                  communicated to the management station conveniently





          Steven Waldbusser    Expires Nov 22, 1995             [Page 4]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  and efficiently.

              o Proactive Monitoring
                  Given the resources available on the monitor, it
                  is potentially helpful for it continuously to run
                  diagnostics and to log network performance.  The
                  monitor is always available at the onset of any
                  failure.  It can notify the management station of the
                  failure and can store historical statistical
                  information about the failure.  This historical
                  information can be played back by the management
                  station in an attempt to perform further diagnosis
                  into the cause of the problem.

              o Problem Detection and Reporting
                  The monitor can be configured to recognize
                  conditions, most notably error conditions, and
                  continuously to check for them.  When one of these
                  conditions occurs, the event may be logged, and
                  management stations may be notified in a number of
                  ways.

              o Value Added Data
                  Because a remote monitoring device represents a
                  network resource dedicated exclusively to network
                  management functions, and because it is located
                  directly on the monitored portion of the network, the
                  remote network monitoring device has the opportunity
                  to add significant value to the data it collects.
                  For instance, by highlighting those hosts on the
                  network that generate the most traffic or errors, the
                  probe can give the management station precisely the
                  information it needs to solve a class of problems.

              o Multiple Managers
                  An organization may have multiple management stations
                  for different units of the organization, for different
                  functions (e.g. engineering and operations), and in an
                  attempt to provide disaster recovery.  Because
                  environments with multiple management stations are
                  common, the remote network monitoring device has to
                  deal with more than own management station,
                  potentially using its resources concurrently.







          Steven Waldbusser    Expires Nov 22, 1995             [Page 5]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          4.2.  Structure of MIB

          The objects are arranged into the following groups:

                  - protocol directory

                  - protocol distribution

                  - address mapping

                  - network layer host

                  - network layer matrix

          These groups are the basic unit of conformance.  If a remote
          monitoring device implements a group, then it must implement
          all objects in that group.  For example, a managed agent that
          implements the network layer matrix group must implement the
          nlMatrixSDTable and the nlMatrixDSTable.

          Implementations of this MIB must also implement the system and
          interfaces group of MIB-II [6].  MIB-II may also mandate the
          implementation of additional groups.

          These groups are defined to provide a means of assigning
          object identifiers, and to provide a method for managed agents
          to know which objects they must implement.























          Steven Waldbusser    Expires Nov 22, 1995             [Page 6]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          5.  Control of Remote Network Monitoring Devices

          Due to the complex nature of the available functions in these
          devices, the functions often need user configuration.  In many
          cases, the function requires parameters to be set up for a
          data collection operation.  The operation can proceed only
          after these parameters are fully set up.

          Many functional groups in this MIB have one or more tables in
          which to set up control parameters, and one or more data
          tables in which to place the results of the operation.  The
          control tables are typically read-write in nature, while the
          data tables are typically read-only.  Because the parameters
          in the control table often describe resulting data in the data
          table, many of the parameters can be modified only when the
          control entry is invalid.  Thus, the method for modifying
          these parameters is to invalidate the control entry, causing
          its deletion and the deletion of any associated data entries,
          and then create a new control entry with the proper
          parameters.  Deleting the control entry also gives a
          convenient method for reclaiming the resources used by the
          associated data.

          Some objects in this MIB provide a mechanism to execute an
          action on the remote monitoring device.  These objects may
          execute an action as a result of a change in the state of the
          object.  For those objects in this MIB, a request to set an
          object to the same value as it currently holds would thus
          cause no action to occur.

          To facilitate control by multiple managers, resources have to
          be shared among the managers.  These resources are typically
          the memory and computation resources that a function requires.


          5.1.  Resource Sharing Among Multiple Management Stations

          When multiple management stations wish to use functions that
          compete for a finite amount of resources on a device, a method
          to facilitate this sharing of resources is required.
          Potential conflicts include:

              o Two management stations wish to simultaneously use
                resources that together would exceed the capability of
                the device.





          Steven Waldbusser    Expires Nov 22, 1995             [Page 7]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              o A management station uses a significant amount of
                resources for a long period of time.
              o A management station uses resources and then crashes,
                forgetting to free the resources so others may
                use them.

          A mechanism is provided for each management station initiated
          function in this MIB to avoid these conflicts and to help
          resolve them when they occur.  Each function has a label
          identifying the initiator (owner) of the function.  This label
          is set by the initiator to provide for the following
          possibilities:

              o A management station may recognize resources it owns
                and no longer needs.
              o A network operator can find the management station that
                owns the resource and negotiate for it to be freed.
              o A network operator may decide to unilaterally free
                resources another network operator has reserved.
              o Upon initialization, a management station may recognize
                resources it had reserved in the past.  With this
                information it may free the resources if it no longer
                needs them.

          Management stations and probes should support any format of
          the owner string dictated by the local policy of the
          organization.  It is suggested that this name contain one or
          more of the following: IP address, management station name,
          network manager's name, location, or phone number.  This
          information will help users to share the resources more
          effectively.

          There is often default functionality that the device or the
          administrator of the probe (often the network administrator)
          wishes to set up.  The resources associated with this
          functionality are then owned by the device itself or by the
          network administrator, and are intended to be long-lived.  In
          this case, the device or the administrator will set the
          relevant owner object to a string starting with 'monitor'.
          Indiscriminate modification of the monitor-owned configuration
          by network management stations is discouraged.  In fact, a
          network management station should only modify these objects
          under the direction of the administrator of the probe.

          Resources on a probe are scarce and are typically allocated





          Steven Waldbusser    Expires Nov 22, 1995             [Page 8]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          when control rows are created by an application.  Since many
          applications may be using a probe simultaneously,
          indiscriminate allocation of resources to particular
          applications is very likely to cause resource shortages in the
          probe.

          When a network management station wishes to utilize a function
          in a monitor, it is encouraged to first scan the control table
          of that function to find an instance with similar parameters
          to share.  This is especially true for those instances owned
          by the monitor, which can be assumed to change infrequently.
          If a management station decides to share an instance owned by
          another management station, it should understand that the
          management station that owns the instance may indiscriminately
          modify or delete it.

          It should be noted that a management application should have
          the most trust in a monitor-owned row because it should be
          changed very infrequently.  A row owned by the management
          application is less long-lived because a network administrator
          is more likely to re-assign resources from a row that is in
          use by one user than from a monitor-owned row that is
          potentially in use by many users.  A row owned by another
          application would be even less long-lived because the other
          application may delete or modify that row completely at its
          discretion.


          5.2.  Row Addition Among Multiple Management Stations

          The addition of new rows is achieved using the method
          described in RFC 1212 [9].  In this MIB, rows are often added
          to a table in order to configure a function.  This
          configuration usually involves parameters that control the
          operation of the function.  The agent must check these
          parameters to make sure they are appropriate given
          restrictions defined in this MIB as well as any implementation
          specific restrictions such as lack of resources.  The agent
          implementor may be confused as to when to check these
          parameters and when to signal to the management station that
          the parameters are invalid.  There are two opportunities:

              o When the management station sets each parameter object.

              o When the management station sets the entry status object





          Steven Waldbusser    Expires Nov 22, 1995             [Page 9]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                to valid.

          If the latter is chosen, it would be unclear to the management
          station which of the several parameters was invalid and caused
          the badValue error to be emitted.  Thus, wherever possible,
          the implementor should choose the former as it will provide
          more information to the management station.

          A problem can arise when multiple management stations attempt
          to set configuration information simultaneously using SNMP.
          When this involves the addition of a new conceptual row in the
          same control table, the managers may collide, attempting to
          create the same entry.  To guard against these collisions,
          each such control entry contains a status object with special
          semantics that help to arbitrate among the managers.  If an
          attempt is made with the row addition mechanism to create such
          a status object and that object already exists, an error is
          returned.  When more than one manager simultaneously attempts
          to create the same conceptual row, only the first will
          succeed.  The others will receive an error.

          When a manager wishes to create a new control entry, it needs
          to choose an index for that row.  It may choose this index in
          a variety of ways, hopefully minimizing the chances that the
          index is in use by another manager.  If the index is in use,
          the mechanism mentioned previously will guard against
          collisions.  Examples of schemes to choose index values
          include random selection or scanning the control table looking
          for the first unused index.  Because index values may be any
          valid value in the range and they are chosen by the manager,
          the agent must allow a row to be created with any unused index
          value if it has the resources to create a new row.

          Some tables in this MIB reference other tables within this
          MIB.  When creating or deleting entries in these tables, it is
          generally allowable for dangling references to exist.  There
          is no defined order for creating or deleting entries in these
          tables.

          Define/describe the "limited extensibility" mechanism of the
          protocolDirectory.









          Steven Waldbusser    Expires Nov 22, 1995            [Page 10]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          6.  Conventions

          The following conventions are used throughout the RMON MIB and
          its companion documents.

          Good Packets

          Good packets are error-free packets that have a valid frame
          length.  For example, on Ethernet, good packets are error-free
          packets that are between 64 octets long and 1518 octets long.
          They follow the form defined in IEEE 802.3 section 3.2.all.

          Bad Packets

          Bad packets are packets that have proper framing and are
          therefore recognized as packets, but contain errors within the
          packet or have an invalid length.  For example, on Ethernet,
          bad packets have a valid preamble and SFD, but have a bad CRC,
          or are either shorter than 64 octets or longer than 1518
          octets.






























          Steven Waldbusser    Expires Nov 22, 1995            [Page 11]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          7.  Definitions

          RMON2-MIB DEFINITIONS ::= BEGIN

          IMPORTS
              MODULE-IDENTITY, OBJECT-TYPE, Counter32, Integer32,
                  Gauge32, IpAddress, TimeTicks,
                  NOTIFICATION-TYPE, OBJECT-IDENTITY        FROM SNMPv2-SMI
              TEXTUAL-CONVENTION, RowStatus, DisplayString,
                  MacAddress                                FROM SNMPv2-TC
              MODULE-COMPLIANCE, OBJECT-GROUP FROM SNMPv2-CONF
              mib-2                           FROM RFC1213-MIB
              rmon, OwnerString               FROM RFC1757-MIB;

          --  Remote Network Monitoring MIB

          rmon MODULE-IDENTITY
              LAST-UPDATED "9506020000Z"
              ORGANIZATION "IETF RMON MIB Working Group"
              CONTACT-INFO
                  "Andy Bierman   (WG Chair)
                   Postal: Cisco Systems, Inc.
                   170 West Tasman Drive
                   San Jose, CA 95134-1706
                   USA
                   Phone:  +1 408 526 8951
                   Email:  abierman@cisco.com

                   Steve Waldbusser   (WG Editor)
                   Postal: International Network Services
                   650 Castro Street, Suite 260
                   Mountain View, CA 94041

                   Phone:  +1 415 254 4251
                   Email:  waldbusser@ins.com"
              DESCRIPTION
                  "The MIB module for managing remote monitoring
                   device implementations. This MIB module
                   augments the original RMON MIB as specified in
                   RFC 1757."
              ::= { mib-2 16 }

              protocolDir    OBJECT IDENTIFIER ::= { rmon 11 }
              protocolDist   OBJECT IDENTIFIER ::= { rmon 12 }
              addressMap     OBJECT IDENTIFIER ::= { rmon 13 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 12]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              nlHost         OBJECT IDENTIFIER ::= { rmon 14 }
              nlMatrix       OBJECT IDENTIFIER ::= { rmon 15 }
              alHost         OBJECT IDENTIFIER ::= { rmon 16 }
              alMatrix       OBJECT IDENTIFIER ::= { rmon 17 }
              usrHistory     OBJECT IDENTIFIER ::= { rmon 18 }
              probeConfig    OBJECT IDENTIFIER ::= { rmon 19 }












































          Steven Waldbusser    Expires Nov 22, 1995            [Page 13]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          -- Textual Conventions
          TimeFilter ::= TEXTUAL-CONVENTION
              STATUS        current
              DESCRIPTION
                  "To be used for the index to a table.  Allows an application
                  to download only those rows changed since a particular time.

                  When sysUpTime is equal to zero, this table shall be empty.

                  One entry exists for each past value of sysUpTime, except that
                  the whole table is purged should sysUpTime wrap.

                  As this basic row is updated new concptual rows are created
                  (which still share the now updated object values with all
                  other instances).  The number of instances which are created
                  is determined by the value of sysUpTime at which the basic row
                  was last updated.  One instance will exist for each value of
                  sysUpTime and the last update time for the row.  A new timeMark
                  instance is created for each new sysUpTime value.  Each new
                  conceptual row will be associated with the timeMark instance
                  which was created at the value of sysUpTime with which the
                  conceptual row is to be associated.

                  By definition all conceptual rows were updated at or after
                  time zero and so at least one conceptual row (associatd with
                  timeMark.0) must exist for each underlying (basic) row.

                  Consider the following fooTable:

                  fooTable ...
                  INDEX { timeMark, fooIndex }

                  FooEntry {
                     fooTimeMark  timeFilter
                     fooIndex     INTEGER,
                     fooCounts    Counter
                  }

                  Should there be two basic rows in this table (fooIndex == 1,
                  fooIndex == 2) and row 1 was updated most recently at time 6,
                  while row 2 was updated most recently at time 8, and both rows
                  had been updated on several earlier occaision such that the
                  current values were 5 and 9 respectively then the following
                  fooCounts instances would exist.






          Steven Waldbusser    Expires Nov 22, 1995            [Page 14]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  fooCounts.0.1  5
                  fooCounts.0.2  9
                  fooCounts.1.1  5
                  fooCounts.1.2  9
                  fooCounts.2.1  5
                  fooCounts.2.2  9
                  fooCounts.3.1  5
                  fooCounts.3.2  9
                  fooCounts.4.1  5
                  fooCounts.4.2  9
                  fooCounts.5.1  5
                  fooCounts.5.2  9
                  fooCounts.6.1  5
                  fooCounts.6.2  9
                  fooCounts.7.2  9
                  fooCounts.8.2  9"
              SYNTAX    TimeTicks

































          Steven Waldbusser    Expires Nov 22, 1995            [Page 15]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          protocolDirTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF ProtocolDirEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "This table lists the protocols that this agent has the
                  capability to decode and count.  There is one entry in this
                  table for each such protocol.  These protocols represent
                  different network layer, transport layer, and higher-layer
                  protocols.  The agent should boot up with this table
                  preconfigured with those protocols that it knows about and
                  wishes to monitor."
              ::= { protocolDir 1 }

          protocolDirEntry OBJECT-TYPE
              SYNTAX      ProtocolDirEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "This table lists the protocols that this agent has the
                  capability to decode and count.  There is one entry in this
                  table for each such protocol.  These protocols represent
                  different network layer, transport layer, and higher-layer
                  protocols.  The agent should boot up with this table
                  preconfigured with those protocols that it knows about and
                  wishes to monitor."
              INDEX       { protocolDirID, protocolDirParameters }
              ::= { protocolDirTable  1 }

          ProtocolDirEntry ::= SEQUENCE {
              protocolDirID                   OBJECT IDENTIFIER,
              protocolDirParameters           OCTET STRING,
              protocolDirIndex                Integer32,
              protocolDirDescr                DisplayString,
              protocolDirType                 BITS,
              protocolDirAddressMapConfig     INTEGER,
              protocolDirNlHostConfig         INTEGER,
              protocolDirNlMatrixConfig       INTEGER,
              protocolDirAlHostConfig         INTEGER,
              protocolDirAlMatrixConfig       INTEGER,
              protocolDirAddressCapable       INTEGER,
              protocolDirOwner                OwnerString,
              protocolDirStatus               RowStatus
          }






          Steven Waldbusser    Expires Nov 22, 1995            [Page 16]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          protocolDirID OBJECT-TYPE
              SYNTAX      OBJECT IDENTIFIER
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A unique identifier for a particular protocol.  Standard
                  object identifiers will be defined in a manner such that they
                  can often be used as specifications for new protocols - i.e.
                  a tree-structured assignment mechanism that matches the
                  protocol encapsulation `tree' and which has algorithmic
                  assignment mechanisms for certain subtrees. For example:

                  protocolDir.assignments.ethernet
                      -- children of ethernet will have values representing the
                      -- two byte ethertype value of an ethernet protocol.  Some
                      -- well-known ones are defined below.

                  protocolDir.assignments.ethernet.ip
                      -- children of ip will have values representing the
                      -- one byte value of an ip protocol.  Some
                      -- well-known ones are defined below.

                  ...

                  protocolDir.assignments.ethernet.ip.udp.dns

                  Despite the algorithmic mechanism, the probe will only place
                  entries in here for those protocols it chooses to collect.  In
                  other words, it need not populate this table with all of the
                  possible ethernet protocol types, nor need it create them on
                  the fly when it sees them.  Whether or not it does these
                  things is a matter of product definition (cost/benefit,
                  usability), and is up to the designer of the product.

                  If an entry is written to this table with a protocolID that
                  the agent doesn't understand, either directly or
                  algorithmicly, the SET request will be rejected with an
                  inconsistentName or badValue (for SNMPv1) error."
              ::= { protocolDirEntry 1 }

          protocolDirParameters OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 17]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  "A set of options for the associated protocolDirID.  There
                  will be one octet in this string for each sub-identifier in
                  the protocolDirID, and the options will appear here in the
                  same order as the associated protocolDirOptions.

                  Every node in the protocolDirID tree has a different, optional
                  set of parameters defined (that is, the definition of
                  parameters for a node is optional).  The proper parameter
                  value for each node is included in this string.  Note that the
                  inclusion of a parameter value in this string for each node is
                  not optional - what is optional is that a node may have no
                  parameters defined, in which the parameter field for that node
                  will be zero."
              ::= { protocolDirEntry 2 }

          protocolDirIndex OBJECT-TYPE
              SYNTAX    Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The locally arbitrary, but unique identifier associated
                  with this protocolDir entry.

                  The value for each supported protocol must remain constant at
                  least from one re-initialization of the entity's network
                  management system to the next re-initialization.

                  The specific value is meaningful only within a given SNMP
                  entity. A protocolDirIndex may not be re-used until the
                  next agent-restart, in the event the protocol directory entry
                  is deleted."
              ::= { protocolDirEntry 3 }

          protocolDirDescr OBJECT-TYPE
              SYNTAX    DisplayString (SIZE (1..64))
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "A textual description of the protocol encapsulation.
                  A probe may choose to describe only a subset of the
                  entire encapsulation (e.g. only the highest layer).

                  This object may not be modified if the associated
                  protocolDirStatus object is equal to active(1)."
              ::= { protocolDirEntry 4 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 18]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          protocolDirType OBJECT-TYPE
              SYNTAX      BITS {
                              extensible(0),
                              addressRecognitionCapable(1)
                          }
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "This object describes 2 attributes of this protocol
                  directory entry.

                   This object describes whether or not this protocol directory
                   entry can be extended by the user by creating protocol
                   directory entries which are children of this protocol.  Some
                   entries that a probe creates will be extensible, and no
                   entries that a user creates will be extensible.

                   An example of an entry that will often allow extensibility is
                   `ip.udp'.  The probe may automatically populate some children
                   of this node such as `ip.udp.snmp' and `ip.udp.dns'.
                   A probe administrator or user may also populate additional
                   children via remote SNMP requests that create entries in this
                   table.  When a child node added, extending a parent node,
                   that child node is not extendible.  This is termed `limited
                   extensibility'.

                   This object also describes whether or not this agent can
                   recognize addresses for this protocol, should it be a network
                   level protocol.  That is, while a probe may be able to
                   recognize packets of a particular network layer protocol and
                   count them, it takes additional logic to be able to recognize
                   the addresses in this protocol and to populate network layer
                   or application layer tables with the addresses in this
                   protocol."
              ::= { protocolDirEntry 5 }

          protocolDirAddressMapConfig OBJECT-TYPE
              SYNTAX      INTEGER {
                              notSupported(1),
                              supportedOff(2),
                              supportedOn(3)
                          }
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 19]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  "This object describes and configures the probe's support for
                  address mapping for this protocol.  When the probe creates
                  entries in this table for all protocols that it understands,
                  it will set the entry to notSupported(1) if it doesn't have the
                  capability to perform address mapping for the protocol or if
                  this protocol is not a network-layer protocol.  When
                  an entry is created in this table by a management operation,
                  the probe will set this value to notSupported(1), as the
                  limited extensibility of the protocolDirectory table does not
                  extend to interpreting addresses of the extended protocols.

                  If the value of this object is notSupported(1), the probe
                  will not perform address mapping for this protocol and
                  shall not allow this object to be changed to any other value.
                  If the value of this object is supportedOn(3), the probe
                  supports address mapping for this protocol and is configured
                  to perform address mapping for this protocol for all
                  addressMappingControlEntry's and all interfaces or ports.
                  If the value of this object is supportedOff(3), the probe
                  supports address mapping for this protocol but is configured
                  to not perform address mapping for this protocol for any
                  addressMappingControlEntry's and all interfaces or ports."
              ::= { protocolDirEntry 6 }

          protocolDirNlHostConfig OBJECT-TYPE
              SYNTAX      INTEGER {
                              notSupported(1),
                              supportedOff(2),
                              supportedOn(3)
                          }
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object describes and configures the probe's support for
                  the network layer host table for this protocol.  When the
                  probe creates entries in this table for all protocols that it
                  understands, it will set the entry to notSupported(1) if it
                  doesn't have the capability to track the nlHost table for the
                  protocol or if this protocol is not a network-layer protocol.
                  If the associated protocolDirAddressCapable object is equal to
                  addressCapable, then this is a network layer protocol which
                  the probe recognized addresses for, and thus the probe will
                  populate the alHostTable with addresses it discovers for this
                  protocol.






          Steven Waldbusser    Expires Nov 22, 1995            [Page 20]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  When an entry is created in this table by a management
                  operation, the probe will set this value to notSupported(1),
                  as the limited extensibility of the protocolDirectory table
                  does not extend to interpreting network level addresses of the
                  extended protocols.

                  If the value of this object is notSupported(1), the probe
                  will not track the nlHost table for this protocol and
                  shall not allow this object to be changed to any other value.
                  If the value of this object is supportedOn(3), the probe
                  supports tracking of the nlHost table for this protocol and is
                  configured to track the nlHost table for this protocol for all
                  nlHostControlEntry's and all interfaces or ports.
                  If the value of this object is supportedOff(3), the probe
                  supports tracking of the nlHost table for this protocol
                  but is configured to not track the nlHost for this
                  protocol for any nlHostControlEntry's and all interfaces or
                  ports."
              ::= { protocolDirEntry 7 }

          protocolDirNlMatrixConfig OBJECT-TYPE
              SYNTAX      INTEGER {
                              notSupported(1),
                              supportedOff(2),
                              supportedOn(3)
                          }
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object describes and configures the probe's support for
                  the network layer matrix table for this protocol.  When the
                  probe creates entries in this table for all protocols that it
                  understands, it will set the entry to notSupported(1) if it
                  doesn't have the capability to track the nlMatrix table for the
                  protocol or if this protocol is not a network-layer protocol.
                  If the associated protocolDirAddressCapable object is equal to
                  addressCapable, then this is a network layer protocol which
                  the probe recognized addresses for, and thus the probe will
                  populate the alHostTable with addresses it discovers for this
                  protocol.

                  When an entry is created in this table by a management
                  operation, the probe will set this value to notSupported(1),
                  as the limited extensibility of the protocolDirectory table
                  does not extend to interpreting network level addresses of the





          Steven Waldbusser    Expires Nov 22, 1995            [Page 21]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  extended protocols.

                  If the value of this object is notSupported(1), the probe
                  will not track the nlMatrix table for this protocol and
                  shall not allow this object to be changed to any other value.
                  If the value of this object is supportedOn(3), the probe
                  supports tracking of the nlMatrix table for this protocol and is
                  configured to track the nlMatrix table for this protocol for all
                  nlMatrixControlEntry's and all interfaces or ports.
                  If the value of this object is supportedOff(3), the probe
                  supports tracking of the nlMatrix table for this protocol
                  but is configured to not track the nlMatrix for this
                  protocol for any nlMatrixControlEntry's and all interfaces or
                  ports."
              ::= { protocolDirEntry 8 }

          protocolDirAlHostConfig OBJECT-TYPE
              SYNTAX      INTEGER {
                              notSupported(1),
                              supportedOff(2),
                              supportedOn(3)
                          }
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object describes and configures the probe's support for
                  the application layer host table for this protocol.  When the
                  probe creates entries in this table for all protocols that it
                  understands, it will set the entry to notSupported(1) if it
                  doesn't have the capability to track the nlHost table for the
                  protocol.  If the associated protocolDirAddressCapable object
                  is equal to addressCapable, then this is a network layer
                  protocol which the probe recognized addresses for, and thus
                  the probe will populate the alHostTable with addresses it
                  discovers for this protocol.

                  When an entry is created in this table by a management
                  operation, the probe will set this value to notSupported(1),
                  as the limited extensibility of the protocolDirectory table
                  does not extend to interpreting network level addresses of the
                  extended protocols.

                  If the value of this object is notSupported(1), the probe
                  will not track the nlHost table for this protocol and
                  shall not allow this object to be changed to any other value.





          Steven Waldbusser    Expires Nov 22, 1995            [Page 22]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  If the value of this object is supportedOn(3), the probe
                  supports tracking of the nlHost table for this protocol and is
                  configured to track the nlHost table for this protocol for all
                  nlHostControlEntry's and all interfaces or ports.
                  If the value of this object is supportedOff(3), the probe
                  supports tracking of the nlHost table for this protocol
                  but is configured to not track the nlHost for this
                  protocol for any nlHostControlEntry's and all interfaces or
                  ports."
              ::= { protocolDirEntry 9 }

          protocolDirAlMatrixConfig OBJECT-TYPE
              SYNTAX      INTEGER {
                              notSupported(1),
                              supportedOff(2),
                              supportedOn(3)
                          }
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object describes and configures the probe's support for
                  the network layer matrix table for this protocol.  When the
                  probe creates entries in this table for all protocols that it
                  understands, it will set the entry to notSupported(1) if it
                  doesn't have the capability to track the nlMatrix table for the
                  protocol or if this protocol is not a network-layer protocol.
                  If the associated protocolDirAddressCapable object is equal to
                  addressCapable, then this is a network layer protocol which
                  the probe recognized addresses for, and thus the probe will
                  populate the alHostTable with addresses it discovers for this
                  protocol.

                  When an entry is created in this table by a management
                  operation, the probe will set this value to notSupported(1),
                  as the limited extensibility of the protocolDirectory table
                  does not extend to interpreting network level addresses of the
                  extended protocols.

                  If the value of this object is notSupported(1), the probe
                  will not track the nlMatrix table for this protocol and
                  shall not allow this object to be changed to any other value.
                  If the value of this object is supportedOn(3), the probe
                  supports tracking of the nlMatrix table for this protocol and is
                  configured to track the nlMatrix table for this protocol for all
                  nlMatrixControlEntry's and all interfaces or ports.





          Steven Waldbusser    Expires Nov 22, 1995            [Page 23]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  If the value of this object is supportedOff(3), the probe
                  supports tracking of the nlMatrix table for this protocol
                  but is configured to not track the nlMatrix for this
                  protocol for any nlMatrixControlEntry's and all interfaces or
                  ports."
              ::= { protocolDirEntry 10 }

          protocolDirAddressCapable OBJECT-TYPE
              SYNTAX      INTEGER {
                              addressCapable(1),
                              notAddressCapable(2)
                          }
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  ""
              ::= { protocolDirEntry 11 }

          protocolDirOwner OBJECT-TYPE
              SYNTAX      OwnerString
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The owner of this protocol directory entry."
              ::= { protocolDirEntry 12 }

          protocolDirStatus OBJECT-TYPE
              SYNTAX      RowStatus
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The status of this protocol directory entry.

                   A protocol is not qualified for activation until instances of
                   all columns of its protocolDirEntry row have an
                   appropriate value. In particular, one or more management set
                   operations are required to configure the protocol entry:
                   a value must be written to the protocolDirDescr
                   object.

                   Until instances of all corresponding columns are
                   appropriately configured, the value of the corresponding
                   instance of the protocolDirStatus column is `notReady'.

                   For those columnar objects which permit write-access (after





          Steven Waldbusser    Expires Nov 22, 1995            [Page 24]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                   their initial creation), their value in an existing conceptual
                   row can be changed irrespective of the value of
                   protocolDirStatus for that row."
              ::= { protocolDirEntry 13 }

          protocolAssignments OBJECT IDENTIFIER ::= { protocolDir 2 }


          --
          -- Protocol Distribution Group  (protocolDist)
          --
          -- Controls basic segment-level data collection.
          --    protocolDistControlTable,
          --    protocolDistStatsTable

          protocolDistControlTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF ProtocolDistControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "Controls the setup of protocol type distribution statistics
                  tables.

                  Rationale:
                  This table controls collection of very basic statistics
                  for any or all of the protocols detected on a given interface.
                  An NMS can use this table to quickly determine bandwidth
                  allocation utilized by different protocols.

                  A media-specific statistics collection could also
                  be configured (e.g. etherStats, trPStats) to easily obtain
                  total frame, octet, and droppedEvents for the same
                  interface."
              ::= { protocolDist 1 }

          protocolDistControlEntry OBJECT-TYPE
              SYNTAX      ProtocolDistControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "Controls the setup of protocol type distribution statistics
                  tables."
              INDEX       { protocolDistControlIndex }
              ::= { protocolDistControlTable 1 }






          Steven Waldbusser    Expires Nov 22, 1995            [Page 25]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          ProtocolDistControlEntry ::= SEQUENCE {
              protocolDistControlIndex         Integer32 (1..65535),
              protocolDistControlDataSource    OBJECT IDENTIFIER,
              protocolDistControlDroppedFrames Counter32,
              protocolDistControlOwner         OwnerString,
              protocolDistControlStatus        RowStatus
          }

          protocolDistControlIndex OBJECT-TYPE
              SYNTAX      Integer32
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A unique index for this protocolDistControlEntry."
              ::= { protocolDistControlEntry 1 }

          protocolDistControlDataSource OBJECT-TYPE
              SYNTAX      OBJECT IDENTIFIER
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object identifies the source of the data that
                  this protocolDistControlEntry entry is configured to analyze.
                  This source can be any interface on this device.

                  The statistics in this group reflect all packets
                  on the local network segment attached to the
                  identified interface.

                  This object may not be modified if the associated
                  protocolDistControlStatus object is equal to active(1)."
              ::= { protocolDistControlEntry 2 }

          protocolDistControlDroppedFrames OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS     read-only
              STATUS     current
              DESCRIPTION
                 "The total number of frames which were received by the probe
                  and therefore not accounted for in the *StatsDropEvents, but
                  for which the probe chose not to count for this entry for
                  whatever reason.  Most often, this event occurs when the probe
                  is out of some resources and decides to shed load from this
                  collection.






          Steven Waldbusser    Expires Nov 22, 1995            [Page 26]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  Note that this number is the exact number of
                  frames dropped; it must be set as accurately as possible
                  by the probe."
              ::= { protocolDistControlEntry 3 }

          protocolDistControlOwner OBJECT-TYPE
              SYNTAX      OwnerString
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The owner of this entry."
              ::= { protocolDistControlEntry 4 }

          protocolDistControlStatus OBJECT-TYPE
              SYNTAX      RowStatus
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The status of this row.

                  An entry is not qualified for activation until instances of
                  all columns of its protocolDistControlEntry row have an
                  appropriate value. In particular, one or more management set
                  operations are required to configure the entry:
                  a value must be written to the protocolDistControlDataSource
                  object.

                  Until instances of all corresponding columns are
                  appropriately configured, the value of the corresponding
                  instance of the protocolDistControlStatus column is `notReady'.

                  For those columnar objects which permit write-access (after
                  their initial creation), their value in an existing conceptual
                  row can be changed irrespective of the value of
                   protocolDistControlStatus for that row."
              ::= { protocolDistControlEntry 5 }

          -- per interface protocol distribution statistics table
          protocolDistStatsTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF ProtocolDistStatsEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "An entry is made in this table for every entry in the
                  protocolDirTable for which the values of these counters would





          Steven Waldbusser    Expires Nov 22, 1995            [Page 27]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  be non-zero.  Counters are updated in this table
                  for every protocol type that is encountered when parsing a
                  packet."
              ::= { protocolDist 2 }

          protocolDistStatsEntry OBJECT-TYPE
              SYNTAX      ProtocolDistStatsEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "Every entry in the protocolDirTable potentially has a
                  corresponding entry in this table.  However, this table will
                  only contain those entries that have a non-zero value of
                  protocolDistStatsPkts.  Counters are updated in this table
                  for every protocol type that is encountered when parsing a
                  packet.

                  The index is composed of the protocolDistControlIndex of the
                  associated protocolDistControlEntry and the
                  protocolDirIndex of the associated protocol that this entry
                  represents."
              INDEX       { protocolDistControlIndex,
                            protocolDistStatsProtocolDirIndex }
              ::= { protocolDistStatsTable 1 }

          ProtocolDistStatsEntry ::= SEQUENCE {
              protocolDistStatsProtocolDirIndex   Integer32,
              protocolDistStatsPkts               Counter32,
              protocolDistStatsOctets             Counter32
          }

          protocolDistStatsProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the protocol this entry represents."
              ::= { protocolDistStatsEntry 1 }

          protocolDistStatsPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets received for this protocol.  Note that





          Steven Waldbusser    Expires Nov 22, 1995            [Page 28]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  this is the number of link-layer packets, so if a single
                  application layer frame is fragmented into several link-layer
                  packets, this counter is incremented several times."
              ::= { protocolDistStatsEntry 2 }

          protocolDistStatsOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets received for this protocol."
              ::= { protocolDistStatsEntry 3 }






































          Steven Waldbusser    Expires Nov 22, 1995            [Page 29]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          --
          -- Address Map Group   (addressMap)
          --
          -- network layer address map table
          --    addressMapControlTable
          --    addressMapTable
          --
          addressMapControlTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF AddressMapControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A table to control the collection of network layer address to
                  physical address to interface mappings.

                  This is not like the typical RMON controlTable/dataTable in
                  which each entry creates its own data table.  Each entry in
                  this table enables the discovery of addresses on a new
                  interface and the placement of address mappings into the
                  central addressMapTable."
              ::= { addressMap 1 }

          addressMapControlEntry OBJECT-TYPE
              SYNTAX      AddressMapControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  ""
              INDEX       { addressMapControlIndex }
              ::= { addressMapControlTable 1 }

          AddressMapControlEntry ::= SEQUENCE {
              addressMapControlIndex              Integer32 (1..65535),
              addressMapControlDataSource         Integer32,
              addressMapControlDroppedFrames      Counter32,
              addressMapControlActivateTimeStamp  TimeTicks,
              addressMapControlInserts            Counter32,
              addressMapControlDeletes            Counter32,
              addressMapControlOwner              OwnerString,
              addressMapControlStatus             RowStatus
          }

          addressMapControlIndex OBJECT-TYPE
              SYNTAX      Integer32
              MAX-ACCESS  not-accessible





          Steven Waldbusser    Expires Nov 22, 1995            [Page 30]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              STATUS      current
              DESCRIPTION
                  "A unique index for this entry in the addressMapControlTable."
              ::= { addressMapControlEntry 1 }

          addressMapControlDataSource OBJECT-TYPE
              SYNTAX      Integer32
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object identifies the source of the data that
                  this addressMapControlEntry entry is configured to analyze.
                  This source can be any interface on this device.

                  In order to identify a particular interface, this
                  object shall identify the instance of the ifIndex
                  object, defined in [4,6], for the desired interface.
                  For example, if an entry were to receive data from
                  interface #1, this object would be set to ifIndex.1.

                  In order to identify a particular repeater port, this
                  object shall identify the instance of the rptrGroupPortIndex XXX
                  object, defined in [XXX], for the desired interface.
                  For example, if an entry were to receive data from
                  group #1, port #1, this object would be set to
                  rptrGroupPortIndex.1.1."
              ::= { addressMapControlEntry 2 }

          addressMapControlDroppedFrames OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                 "The total number of frames which were received by the probe
                  and therefore not accounted for in the *StatsDropEvents, but
                  for which the probe chose not to count for this entry for
                  whatever reason.  Most often, this event occurs when the probe
                  is out of some resources and decides to shed load from this
                  collection.

                  Note that this number is the exact number of
                  frames dropped; it must be set as accurately as possible
                  by the probe."
              ::= { addressMapControlEntry 3 }






          Steven Waldbusser    Expires Nov 22, 1995            [Page 31]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          addressMapControlActivateTimeStamp OBJECT-TYPE
              SYNTAX     TimeTicks
              MAX-ACCESS read-only
              STATUS      current
              DESCRIPTION
                  "The value of sysUpTime when this control entry was activated.
                  This can be used by the management station to ensure that the
                  table has not been deleted and recreated between polls."
              ::= { addressMapControlEntry 4 }

          addressMapControlInserts OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an address mapping entry has been
                  deleted from this table.  If an entry is deleted, then
                  inserted, and then deleted, this counter will be incremented
                  by 2.

                  Note that the table size can be determined by subtracting
                  addressMapControlDeletes from addressMapControlInserts."
              ::= { addressMapControlEntry 5 }

          addressMapControlDeletes OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an address mapping entry has been
                  inserted into this table.  If an entry is inserted, then
                  deleted, and then inserted, this counter will be incremented
                  by 2.

                  Note that the table size can be determined by subtracting
                  addressMapControlDeletes from addressMapControlInserts."
              ::= { addressMapControlEntry 6 }

          addressMapControlOwner OBJECT-TYPE
              SYNTAX      OwnerString
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The owner of this addressMap control entry."
              ::= { addressMapControlEntry 7 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 32]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          addressMapControlStatus OBJECT-TYPE
              SYNTAX      RowStatus
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The status of this addressMap control entry.

                  An entry is not qualified for activation until instances of
                  all columns of its addressMapControlEntry row have an
                  appropriate value.
                  In particular, one or more management set operations are
                  required to configure the entry:
                  a value must be written to the addressMapControlDataSource
                  object.

                  Until instances of all corresponding columns are
                  appropriately configured, the value of the corresponding
                  instance of the addressMapControlStatus column is `notReady'.

                  For those columnar objects which permit write-access (after
                  their initial creation), their value in an existing conceptual
                  row can be changed irrespective of the value of
                   addressMapControlStatus for that row."
              ::= { addressMapControlEntry 8 }


          addressMapTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF AddressMapEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A table of network layer address to physical address to
                  interface mappings."
              ::= { addressMap 2 }

          addressMapEntry OBJECT-TYPE
              SYNTAX      AddressMapEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A table of network layer address to physical address to
                  interface mappings.

                  The probe will populate this table for all protocols in the
                  protocol directory table who's value of





          Steven Waldbusser    Expires Nov 22, 1995            [Page 33]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  protocolDirAddressMapConfig is equal to supportedOn(3)."
              INDEX       { addressMapTimeMark, addressMapProtocolDirIndex,
                            addressMapNetworkAddress, addressMapSource }
              ::= { addressMapTable 1 }

          AddressMapEntry ::= SEQUENCE {
              addressMapTimeMark            TimeFilter,
              addressMapProtocolDirIndex    Integer32,
              addressMapNetworkAddress      OCTET STRING,
              addressMapPhysicalAddress     OCTET STRING,
              addressMapSource              OBJECT IDENTIFIER,
              addressMapLastChange          TimeTicks
          }

          addressMapTimeMark OBJECT-TYPE
              SYNTAX      TimeFilter
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A TimeFilter for this entry.  See the TimeFilter textual
                  convention to see how this works."
              ::= { addressMapEntry 1 }

          addressMapProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the network layer protocol of
                  this entry's network address."
              ::= { addressMapEntry 2 }

          addressMapNetworkAddress OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "The network address for this relation.

                  This is represented as an octet string with
                  specific semantics and length as identified
                  by the addressMapProtocolDirIndex component.

                  For example, if the protocolDirIndex indicates an encapsulation
                  of ip, this object is encoded as the 4 octets of the ip address,





          Steven Waldbusser    Expires Nov 22, 1995            [Page 34]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  in network byte order. "
              ::= { addressMapEntry 3 }

          addressMapPhysicalAddress OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The last physical address on which the associated network address
                  was seen."
              ::= { addressMapEntry 4 }

          addressMapSource OBJECT-TYPE
              SYNTAX      OBJECT IDENTIFIER
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The last interface or port on which the associated network
                   address was seen.

                  If this address mapping was discovered on an interface, this
                  object shall identify the instance of the ifIndex
                  object, defined in [4,6], for the desired interface.
                  For example, if an entry were to receive data from
                  interface #1, this object would be set to ifIndex.1.

                  If this address mapping was discovered on a port, this
                  object shall identify the instance of the rptrGroupPortIndex XXX
                  object, defined in [XXX], for the desired port.
                  For example, if an entry were to receive data from
                  group #1, port #1, this object would be set to
                  rptrGroupPortIndex.1.1."
              ::= { addressMapEntry 5 }

          addressMapLastChange OBJECT-TYPE
              SYNTAX      TimeTicks
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The value of sysUpTime at the time this entry was created or
                  the values of the physical address or ifIndex changed."
              ::= { addressMapEntry 6 }


          hlHostControlTable OBJECT-TYPE





          Steven Waldbusser    Expires Nov 22, 1995            [Page 35]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              SYNTAX      SEQUENCE OF HlHostControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of higher layer (i.e. non-MAC) host table control entries.

                  These entries will enable the collection of the host and
                  application level tables indexed by network addresses.

                  Entries in the hlHostTable will be created on behalf of each
                  entry in this table. Additionally, if this probe implements
                  the alHostTable, entries in the alHostTable will be created on
                  behalf of each entry in this table."
              ::= { nlHost 1 }

          hlHostControlEntry OBJECT-TYPE
              SYNTAX      HlHostControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of parameters that set up the discovery of
                  hosts on a particular interface and the collection
                  of statistics about these hosts in the hlHostTable and
                  alHostTable."
              INDEX { hlHostControlIndex }
              ::= { hlHostControlTable 1 }

          HlHostControlEntry ::= SEQUENCE {
              hlHostControlIndex               Integer32 (1..65535),
              hlHostControlDataSource          OBJECT IDENTIFIER,
              hlHostControlActivateTimeStamp   TimeTicks,
              hlHostControlNlDroppedFrames     Counter32,
              hlHostControlNlInserts           Counter32,
              hlHostControlNlDeletes           Counter32,
              hlHostControlNlMaxDesiredEntries Integer32,
              hlHostControlAlDroppedFrames     Counter32,
              hlHostControlAlInserts           Counter32,
              hlHostControlAlDeletes           Counter32,
              hlHostControlAlMaxDesiredEntries Integer32,
              hlHostControlOwner               OwnerString,
              hlHostControlStatus              RowStatus
          }

          hlHostControlIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..65535)





          Steven Waldbusser    Expires Nov 22, 1995            [Page 36]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "An index that uniquely identifies an entry in the
                  hlHostControl table.  Each such entry defines
                  a function that discovers hosts on a particular
                  interface and places statistics about them in the
                  nlHostTable, and optionally in the alHostTable, on
                  behalf of this hlHostControlEntry."
              ::= { hlHostControlEntry 1 }

          hlHostControlDataSource OBJECT-TYPE
              SYNTAX      OBJECT IDENTIFIER
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object identifies the source of the data for
                  this instance of the host function.  This source
                  can be any interface on this device.  In order
                  to identify a particular interface, this object shall
                  identify the instance of the ifIndex object, defined
                  in [4,6], for the desired interface.  For example,
                  if an entry were to receive data from interface #1,
                  this object would be set to ifIndex.1.

                  The statistics in this group reflect all packets
                  on the local network segment attached to the
                  identified interface.

                  This object may not be modified if the associated
                  hlHostControlStatus object is equal to valid(1)."
              ::= { hlHostControlEntry 2 }

          hlHostControlActivateTimeStamp OBJECT-TYPE
              SYNTAX     TimeTicks
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The value of sysUpTime when this control entry was activated.
                  This can be used by the management station to ensure that the
                  table has not been deleted and recreated between polls."
              ::= { hlHostControlEntry 3 }

          hlHostControlNlDroppedFrames OBJECT-TYPE
              SYNTAX     Counter32





          Steven Waldbusser    Expires Nov 22, 1995            [Page 37]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                 "The total number of frames which were received by the probe
                  and therefore not accounted for in the *StatsDropEvents, but
                  for which the probe chose not to count for this entry for
                  whatever reason.  Most often, this event occurs when the probe
                  is out of some resources and decides to shed load from this
                  collection.

                  Note that this number is the exact number of
                  frames dropped; it must be set as accurately as possible
                  by the probe."
              ::= { hlHostControlEntry 4 }

          hlHostControlNlInserts OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an nlHost entry has been
                  deleted from the nlHost table.  If an entry is deleted, then
                  inserted, and then deleted, this counter will be incremented
                  by 2.

                  Note that the table size can be determined by subtracting
                  hlHostControlNlDeletes from hlHostControlNlInserts."
              ::= { hlHostControlEntry 5 }

          hlHostControlNlDeletes OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an nlHost entry has been
                  inserted into the nlHost table.  If an entry is inserted, then
                  deleted, and then inserted, this counter will be incremented
                  by 2.

                  Note that the table size can be determined by subtracting
                  hlHostControlDeletes from hlHostControlInserts."
              ::= { hlHostControlEntry 6 }

          hlHostControlNlMaxDesiredEntries OBJECT-TYPE
              SYNTAX      Integer32





          Steven Waldbusser    Expires Nov 22, 1995            [Page 38]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The maximum number of entries that are desired in the
                  associated nlHostTable. The probe will not create more than
                  this number of entries in the table, but may choose to create
                  fewer entries in this table for any reason including the lack
                  of resources.

                  If this value is set to zero, the probe may create any number
                  of entries in this table.

                  This object may be used to control how resources are allocated
                  on the probe for the various RMON functions."
              ::= { hlHostControlEntry 7 }

          hlHostControlAlDroppedFrames OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                 "The total number of frames which were received by the probe
                  and therefore not accounted for in the *StatsDropEvents, but
                  for which the probe chose not to count for this entry for
                  whatever reason.  Most often, this event occurs when the probe
                  is out of some resources and decides to shed load from this
                  collection.

                  Note that this number is the exact number of
                  frames dropped; it must be set as accurately as possible
                  by the probe."
              ::= { hlHostControlEntry 8 }

          hlHostControlAlInserts OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an alHost entry has been
                  deleted from the alHost table.  If an entry is deleted, then
                  inserted, and then deleted, this counter will be incremented
                  by 2.

                  Note that the table size can be determined by subtracting
                  hlHostControlAlDeletes from hlHostControlAlInserts."





          Steven Waldbusser    Expires Nov 22, 1995            [Page 39]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              ::= { hlHostControlEntry 9 }

          hlHostControlAlDeletes OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an alHost entry has been
                  inserted into the alHost table.  If an entry is inserted, then
                  deleted, and then inserted, this counter will be incremented
                  by 2.

                  Note that the table size can be determined by subtracting
                  hlHostControlAlDeletes from hlHostControlAlInserts."
              ::= { hlHostControlEntry 10 }

          hlHostControlAlMaxDesiredEntries OBJECT-TYPE
              SYNTAX      Integer32
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The maximum number of entries that are desired in the alHost
                  table. The probe will not create more than this number of
                  entries in the table, but may choose to create fewer entries
                  in this table for any reason including the lack of resources.

                  If this value is set to zero, the probe may create any number
                  of entries in this table.

                  This object may be used to control how resources are allocated
                  on the probe for the various RMON functions."
              ::= { hlHostControlEntry 11 }

          hlHostControlOwner OBJECT-TYPE
              SYNTAX      OwnerString
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The entity that configured this entry and is
                  therefore using the resources assigned to it."
              ::= { hlHostControlEntry 12 }

          hlHostControlStatus OBJECT-TYPE
              SYNTAX      RowStatus
              MAX-ACCESS  read-create





          Steven Waldbusser    Expires Nov 22, 1995            [Page 40]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              STATUS      current
              DESCRIPTION
                  "The status of this hlHostControl entry.

                  If this object is not equal to valid(1), all
                  associated entries in the nlHostTable and alHostTable
                  shall be deleted by the agent."
              ::= { hlHostControlEntry 13 }

          nlHostTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF NlHostEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of nlHost entries.  Each such entry defines statistics
                  for packets from and to a particular network address."
              ::= { nlHost 2 }

          nlHostEntry OBJECT-TYPE
              SYNTAX      NlHostEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A collection of statistics for a particular host
                  that has been discovered on an interface of this
                  device.

                  The probe will populate this table for all network layer
                  protocols in the protocol directory table who's value of
                  protocolDirNlHostConfig is equal to supportedOn(3).

                  The probe will add to this table all hosts who's address it
                  sees as the source or destination address in all good MAC
                  packets."
              INDEX { hlHostControlIndex, nlHostTimeMark,
                      nlHostProtocolDirIndex, nlHostAddress }
              ::= { nlHostTable 1 }

          NlHostEntry ::= SEQUENCE {
              nlHostTimeMark              TimeFilter,
              nlHostProtocolDirIndex      Integer32,
              nlHostAddress               OCTET STRING,
              nlHostInPkts                Counter32,
              nlHostOutPkts               Counter32,
              nlHostInOctets              Counter32,





          Steven Waldbusser    Expires Nov 22, 1995            [Page 41]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              nlHostOutOctets             Counter32,
              nlHostOutMacNonUnicastPkts  Counter32
          }

          nlHostTimeMark OBJECT-TYPE
              SYNTAX      TimeFilter
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A TimeFilter for this entry.  See the TimeFilter textual
                  convention to see how this works."
              ::= { nlHostEntry 1 }

          nlHostProtocolDirIndex OBJECT-TYPE
              SYNTAX    Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the network layer protocol of
                  this entry's network address."
              ::= { nlHostEntry 2 }

          nlHostAddress OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "The network address for this nlHostEntry.

                  This is represented as an octet string with
                  specific semantics and length as identified
                  by the protocolDirIndex component."
              ::= { nlHostEntry 3 }

          nlHostInPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets without errors transmitted to
                  this address since it was added to the nlHostTable."
              ::= { nlHostEntry 4 }

          nlHostOutPkts OBJECT-TYPE
              SYNTAX      Counter32





          Steven Waldbusser    Expires Nov 22, 1995            [Page 42]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets including errors transmitted
                  by this address since it was added to the nlHostTable."
              ::= { nlHostEntry 5 }

          nlHostInOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets transmitted to this address
                  since it was added to the nlHostTable (excluding
                  framing bits but including FCS octets), except for
                  those octets in packets that contained errors."
              ::= { nlHostEntry 6 }

          nlHostOutOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets transmitted by this address
                  since it was added to the nlHostTable (excluding
                  framing bits but including FCS octets), including
                  those octets in packets that contained errors."
              ::= { nlHostEntry 7 }

          nlHostOutMacNonUnicastPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of good packets transmitted by this
                  address that were directed to the broadcast address
                  or to the multicast address since this host was added
                  to the nlHostTable."
              ::= { nlHostEntry 8 }

          hlMatrixControlTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF HlMatrixControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 43]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  "A list of higher layer (i.e. non-MAC) matrix table control
                  entries.

                  These entries will enable the collection of the host and
                  application level matrix tables indexed by pairs of network
                  addresses.

                  Entries in the hlMatrixTable will be created on behalf of each
                  entry in this table.  Additionally, if this probe implements
                  the alMatrix tables, entries in the alMatrix tables will be
                  created on behalf of each entry in this table."
              ::= { nlMatrix 1 }

          hlMatrixControlEntry OBJECT-TYPE
              SYNTAX      HlMatrixControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of parameters that set up the discovery of
                  conversations on a particular interface and the collection
                  of statistics about these conversations in the hlMatrixTable and
                  alMatrixTable."
              INDEX { hlMatrixControlIndex }
              ::= { hlMatrixControlTable 1 }

          HlMatrixControlEntry ::= SEQUENCE {
              hlMatrixControlIndex                  Integer32 (1..65535),
              hlMatrixControlDataSource             OBJECT IDENTIFIER,
              hlMatrixControlActivateTimeStamp      TimeTicks,
              hlMatrixControlNlDroppedFrames        Counter32,
              hlMatrixControlNlInserts              Counter32,
              hlMatrixControlNlDeletes              Counter32,
              hlMatrixControlNlMaxDesiredEntries    Integer32,
              hlMatrixControlAlDroppedFrames        Counter32,
              hlMatrixControlAlInserts              Counter32,
              hlMatrixControlAlDeletes              Counter32,
              hlMatrixControlAlMaxDesiredEntries    Integer32,
              hlMatrixControlOwner                  OwnerString,
              hlMatrixControlStatus                 RowStatus
          }

          hlMatrixControlIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..65535)
              MAX-ACCESS  read-only
              STATUS      current





          Steven Waldbusser    Expires Nov 22, 1995            [Page 44]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              DESCRIPTION
                  "An index that uniquely identifies an entry in the
                  hlMatrixControl table.  Each such entry defines
                  a function that discovers conversations on a particular
                  interface and places statistics about them in the
                  hlMatrixSDTable and the hlMatrixDSTable, and optionally the
                  alMatrixSDTable and alMatrixDSTable, on behalf of this
                  hlMatrixControlEntry."
              ::= { hlMatrixControlEntry 1 }

          hlMatrixControlDataSource OBJECT-TYPE
              SYNTAX      OBJECT IDENTIFIER
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "This object identifies the source of
                  the data from which this entry creates a traffic matrix.
                  This source can be any interface on this device.  In
                  order to identify a particular interface, this object
                  shall identify the instance of the ifIndex object,
                  defined in [4,6], for the desired interface.  For
                  example, if an entry were to receive data from
                  interface #1, this object would be set to ifIndex.1.

                  The statistics in this group reflect all packets
                  on the local network segment attached to the
                  identified interface.

                  This object may not be modified if the associated
                  hlMatrixControlStatus object is equal to valid(1)."
              ::= { hlMatrixControlEntry 2 }

          hlMatrixControlActivateTimeStamp OBJECT-TYPE
              SYNTAX     TimeTicks
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The value of sysUpTime when this control entry was activated.
                  This can be used by the management station to ensure that the
                  table has not been deleted and recreated between polls."
              ::= { hlMatrixControlEntry 3 }

          hlMatrixControlNlDroppedFrames OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only





          Steven Waldbusser    Expires Nov 22, 1995            [Page 45]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              STATUS     current
              DESCRIPTION
                 "The total number of frames which were received by the probe
                  and therefore not accounted for in the *StatsDropEvents, but
                  for which the probe chose not to count for this entry for
                  whatever reason.  Most often, this event occurs when the probe
                  is out of some resources and decides to shed load from this
                  collection.

                  Note that this number is the exact number of
                  frames dropped; it must be set as accurately as possible
                  by the probe."
              ::= { hlMatrixControlEntry 4 }

          hlMatrixControlNlInserts OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an nlMatrix entry has been
                  inserted to the nlMatrix tables.  If an entry is deleted, then
                  inserted, and then deleted, this counter will be incremented
                  by 2.  The addition of a conversation into both the
                  nlMatrixSDTable and nlMatrixDSTable shall be counted as two
                  insertions (even though every addition into one table must be
                  accompanied by an insertion into the other).

                  Note that the table size can be determined by subtracting
                  hlMatrixControlNlDeletes from hlMatrixControlNlInserts."
              ::= { hlMatrixControlEntry 5 }

          hlMatrixControlNlDeletes OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an nlMatrix entry has been
                  deleted from the nlMatrix tables.  If an entry is inserted, then
                  deleted, and then inserted, this counter will be incremented
                  by 2.  The deletion of a conversation from both the
                  nlMatrixSDTable and nlMatrixDSTable shall be counted as two
                  deletions (even though every deletion from one table must be
                  accompanied by a deletion from the other).

                  Note that the table size can be determined by subtracting





          Steven Waldbusser    Expires Nov 22, 1995            [Page 46]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  hlMatrixMatrixNlDeletes from hlMatrixControlNlInserts."
              ::= { hlMatrixControlEntry 6 }

          hlMatrixControlNlMaxDesiredEntries OBJECT-TYPE
              SYNTAX      Integer32
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The maximum number of entries that are desired in the
                  nlMatrix tables. The probe will not create more than this
                  number of entries in the table, but may choose to create fewer
                  entries in this table for any reason including the lack of
                  resources.

                  If this value is set to zero, the probe may create any number
                  of entries in this table.

                  This object may be used to control how resources are allocated
                  on the probe for the various RMON functions."
              ::= { hlMatrixControlEntry 7 }

          hlMatrixControlAlDroppedFrames OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                 "The total number of frames which were received by the probe
                  and therefore not accounted for in the *StatsDropEvents, but
                  for which the probe chose not to count for this entry for
                  whatever reason.  Most often, this event occurs when the probe
                  is out of some resources and decides to shed load from this
                  collection.

                  Note that this number is the exact number of
                  frames dropped; it must be set as accurately as possible
                  by the probe."
              ::= { hlMatrixControlEntry 8 }

          hlMatrixControlAlInserts OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an alMatrix entry has been
                  inserted to the alMatrix tables.  If an entry is deleted, then





          Steven Waldbusser    Expires Nov 22, 1995            [Page 47]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  inserted, and then deleted, this counter will be incremented
                  by 2.  The addition of a conversation into both the
                  alMatrixSDTable and alMatrixDSTable shall be counted as two
                  insertions (even though every addition into one table must be
                  accompanied by an insertion into the other).

                  Note that the table size can be determined by subtracting
                  hlMatrixControlAlDeletes from hlMatrixControlAlInserts."
              ::= { hlMatrixControlEntry 9 }

          hlMatrixControlAlDeletes OBJECT-TYPE
              SYNTAX     Counter32
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The number of times an alMatrix entry has been
                  deleted from the alMatrix tables.  If an entry is inserted, then
                  deleted, and then inserted, this counter will be incremented
                  by 2.  The deletion of a conversation from both the
                  alMatrixSDTable and alMatrixDSTable shall be counted as two
                  deletions (even though every deletion from one table must be
                  accompanied by a deletion from the other).

                  Note that the table size can be determined by subtracting
                  hlMatrixMatrixAlDeletes from hlMatrixControlAlInserts."
              ::= { hlMatrixControlEntry 10 }

          hlMatrixControlAlMaxDesiredEntries OBJECT-TYPE
              SYNTAX      Integer32
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The maximum number of entries that are desired in the
                  alMatrix tables. The probe will not create more than this
                  number of entries in the table, but may choose to create fewer
                  entries in this table for any reason including the lack of
                  resources.

                  If this value is set to zero, the probe may create any number
                  of entries in this table.

                  This object may be used to control how resources are allocated
                  on the probe for the various RMON functions."
              ::= { hlMatrixControlEntry 11 }






          Steven Waldbusser    Expires Nov 22, 1995            [Page 48]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          hlMatrixControlOwner OBJECT-TYPE
              SYNTAX      OwnerString
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The entity that configured this entry and is
                  therefore using the resources assigned to it."
              ::= { hlMatrixControlEntry 12 }

          hlMatrixControlStatus OBJECT-TYPE
              SYNTAX      RowStatus
              MAX-ACCESS  read-create
              STATUS      current
              DESCRIPTION
                  "The status of this hlMatrixControl entry.

                  If this object is not equal to valid(1), all
                  associated entries in the hlMatrixSDTable and the
                  hlMatrixDSTable shall be deleted by the agent."
              ::= { hlMatrixControlEntry 13 }

          nlMatrixSDTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF NlMatrixSDEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of traffic matrix entries indexed by
                  source and destination network-level address."
              ::= { nlMatrix 2 }

          nlMatrixSDEntry OBJECT-TYPE
              SYNTAX      NlMatrixSDEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A collection of statistics for communications between
                  two addresses on a particular interface.

                  The probe will populate this table for all network layer
                  protocols in the protocol directory table who's value of
                  protocolDirNlMatrixConfig is equal to supportedOn(3)."
              INDEX { hlMatrixControlIndex, nlMatrixSDTimeMark,
                      nlMatrixSDProtocolDirIndex,
                      nlMatrixSDSourceAddress, nlMatrixSDDestAddress }
              ::= { nlMatrixSDTable 1 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 49]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          NlMatrixSDEntry ::= SEQUENCE {
              nlMatrixSDIndex               Integer32 (1..65535),
              nlMatrixSDTimeMark            TimeFilter,
              nlMatrixSDProtocolDirIndex    Integer32,
              nlMatrixSDSourceAddress       OCTET STRING,
              nlMatrixSDDestAddress         OCTET STRING,
              nlMatrixSDPkts                Counter32,
              nlMatrixSDOctets              Counter32
          }

          nlMatrixSDIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..65535)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The set of collected matrix statistics of which
                  this entry is a part.  The set of matrix statistics
                  identified by a particular value of this index
                  is associated with the same nlMatrixControlEntry
                  as identified by the same value of hlMatrixControlIndex."
              ::= { nlMatrixSDEntry 1 }

          nlMatrixSDTimeMark OBJECT-TYPE
              SYNTAX      TimeFilter
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A TimeFilter for this entry.  See the TimeFilter textual
                  convention to see how this works."
              ::= { nlMatrixSDEntry 2 }

          nlMatrixSDProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the network layer protocol of
                  this entry's network address."
              ::= { nlMatrixSDEntry 3 }

          nlMatrixSDSourceAddress OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 50]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  "The type of network source address for this nlMatrixSDEntry.

                   This object is formatted as appropriate to the
                   protocolDirIndex associated with this instance."
              ::= { nlMatrixSDEntry 4 }

          nlMatrixSDDestAddress OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The type of network destination address for this nlMatrixSDEntry.

                   This object is formatted as appropriate to the
                   protocolDirIndex associated with this instance."
              ::= { nlMatrixSDEntry 5 }

          nlMatrixSDPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets transmitted from the source
                  address to the destination address (this number
                  includes error packets)."
              ::= { nlMatrixSDEntry 6 }

          nlMatrixSDOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets (excluding framing bits but
                  including FCS octets) contained in all packets
                  transmitted from the source address to the
                  destination address."
              ::= { nlMatrixSDEntry 7 }

          -- Traffic matrix tables from destination to source

          nlMatrixDSTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF NlMatrixDSEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 51]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  "A list of traffic matrix entries indexed by
                  destination and source network-level address."
              ::= { nlMatrix 3 }

          nlMatrixDSEntry OBJECT-TYPE
              SYNTAX      NlMatrixDSEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A collection of statistics for communications between
                  two address on a particular interface.

                  The probe will populate this table for all network layer
                  protocols in the protocol directory table who's value of
                  protocolDirNlMatrixConfig is set to supportedOn(3)."
              INDEX { hlMatrixControlIndex, nlMatrixDSTimeMark,
                      nlMatrixDSProtocolDirIndex,
                      nlMatrixDSDestAddress, nlMatrixDSSourceAddress }
              ::= { nlMatrixDSTable 1 }

          NlMatrixDSEntry ::= SEQUENCE {
              nlMatrixDSIndex               Integer32 (1..65535),
              nlMatrixDSTimeMark            TimeFilter,
              nlMatrixDSProtocolDirIndex    Integer32,
              nlMatrixDSSourceAddress       OCTET STRING,
              nlMatrixDSDestAddress         OCTET STRING,
              nlMatrixDSPkts                Counter32,
              nlMatrixDSOctets              Counter32
          }

          nlMatrixDSIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..65535)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The set of collected matrix statistics of which
                  this entry is a part.  The set of matrix statistics
                  identified by a particular value of this index
                  is associated with the same nlMatrixControlEntry
                  as identified by the same value of hlMatrixControlIndex."
              ::= { nlMatrixDSEntry 1 }

          nlMatrixDSTimeMark OBJECT-TYPE
              SYNTAX      TimeFilter
              MAX-ACCESS  not-accessible





          Steven Waldbusser    Expires Nov 22, 1995            [Page 52]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              STATUS      current
              DESCRIPTION
                  "A TimeFilter for this entry.  See the TimeFilter textual
                  convention to see how this works."
              ::= { nlMatrixDSEntry 2 }

          nlMatrixDSProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the network layer protocol of
                  this entry's network address."
              ::= { nlMatrixDSEntry 3 }

          nlMatrixDSSourceAddress OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The type of network source address for this nlMatrixDSEntry.

                   This object is formatted as appropriate to the
                   protocolDirIndex associated with this instance."
              ::= { nlMatrixDSEntry 4 }

          nlMatrixDSDestAddress OBJECT-TYPE
              SYNTAX      OCTET STRING
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The type of network destination address for this nlMatrixDSEntry.

                   This object is formatted as appropriate to the
                   protocolDirIndex associated with this instance."
              ::= { nlMatrixDSEntry 5 }

          nlMatrixDSPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets transmitted from the source
                  address to the destination address (this number
                  includes error packets)."





          Steven Waldbusser    Expires Nov 22, 1995            [Page 53]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              ::= { nlMatrixDSEntry 6 }

          nlMatrixDSOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets (excluding framing bits
                  but including FCS octets) contained in all packets
                  transmitted from the source address to the
                  destination address."
              ::= { nlMatrixDSEntry 7 }

          nlMatrixTopNControlTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF NlMatrixTopNControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of nlMatrix top N control entries."
              ::= { nlMatrix 4 }

          nlMatrixTopNControlEntry OBJECT-TYPE
              SYNTAX      NlMatrixTopNControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A set of parameters that control the creation of a
                  report of the top N matrix entries according to several
                  metrics.  For example, an instance of the
                  nlMatrixTopNDuration object might be named
                  nlMatrixTopNDuration.3"
              INDEX       { nlMatrixTopNControlIndex }
              ::= { nlMatrixTopNControlTable 1 }

          NlMatrixTopNControlEntry ::= SEQUENCE {
            nlMatrixTopNControlIndex    Integer32 (1..65535),
            nlMatrixTopNMatrixIndex     Integer32 (1..65535),
            nlMatrixTopNRateBase        INTEGER,
            nlMatrixTopNTimeRemaining   Integer32,
            nlMatrixTopNDuration        Integer32,
            nlMatrixTopNRequestedSize   Integer32,
            nlMatrixTopNGrantedSize     Integer32,
            nlMatrixTopNStartTime       TimeTicks,
            nlMatrixTopNOwner           OwnerString,
            nlMatrixTopNStatus          RowStatus





          Steven Waldbusser    Expires Nov 22, 1995            [Page 54]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          }

          nlMatrixTopNControlIndex OBJECT-TYPE
            SYNTAX     Integer32 (1..65535)
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "An index that uniquely identifies an entry
                in the nlMatrixTopNControl table.  Each such
                entry defines one top N report prepared for
                one interface."
            ::= { nlMatrixTopNControlEntry 1 }

          nlMatrixTopNMatrixIndex OBJECT-TYPE
            SYNTAX     Integer32 (1..65535)
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The nlMatrix table for which a top N report will be
                prepared on behalf of this entry.  The nlMatrix table
                identified by a particular value of this index is
                associated with the same nlMatrix table as identified by
                the same value of nlMatrixIndex.

                This object may not be modified if the associated
                nlMatrixTopNStatus object is equal to valid(1)."
            ::= { nlMatrixTopNControlEntry 2 }

          nlMatrixTopNRateBase OBJECT-TYPE
            SYNTAX      INTEGER {
                              nlMatrixTopNSourceToDestPkts(1),
                              nlMatrixTopNDestToSourcePkts(2),
                              nlMatrixTopNSourceToDestOctets(3),
                              nlMatrixTopNDestToSourceOctets(4)
            }
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The variable for each nlMatrix entry that the nlMatrixTopNRate
                variable is based upon, as well as the selector of the matrix
                table that will be used.

                This object may not be modified if the associated
                nlMatrixTopNStatus object is equal to valid(1)."
            ::= { nlMatrixTopNControlEntry 3 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 55]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          nlMatrixTopNTimeRemaining OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The number of seconds left in the report currently
                being collected.  When this object is modified by
                the management station, a new collection is started,
                possibly aborting a currently running report.  The
                new value is used as the requested duration of this
                report, and is loaded into the associated
                nlMatrixTopNDuration object when the report is finished.
                When the report finishes, the probe will automatically
                start another collection with the same initial value
                of nlMatrixTopNTimeRemaining.

                While the value of this object is non-zero, it decrements
                by one per second until it reaches zero.  At the time
                that this object decrements to zero, the report is made
                accessible in the nlMatrixTopNTable, overwriting any report
                that may be there.

                (Note that this is a different algorithm than in
                the hostTopNTable)."
            DEFVAL { 0 }
            ::= { nlMatrixTopNControlEntry 4 }

          nlMatrixTopNDuration OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The number of seconds that this report has collected
                during the last sampling interval.

                When the associated nlMatrixTopNTimeRemaining object is
                set, this object shall be set by the probe to the
                same value and shall not be modified until the next
                time the nlMatrixTopNTimeRemaining is set.

                This value shall be zero if no reports have been
                requested for this nlMatrixTopNControlEntry."
            DEFVAL { 0 }
            ::= { nlMatrixTopNControlEntry 5 }






          Steven Waldbusser    Expires Nov 22, 1995            [Page 56]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          nlMatrixTopNRequestedSize OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The maximum number of matrix entries requested for the top N
                table.

                When this object is created or modified, the probe
                should set nlMatrixTopNGrantedSize as closely to this
                object as is possible for the particular probe
                implementation and available resources."
            DEFVAL { 10 }
            ::= { nlMatrixTopNControlEntry 6 }

          nlMatrixTopNGrantedSize OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The maximum number of matrix entries in the top N table.

                When the associated nlMatrixTopNRequestedSize object is
                created or modified, the probe should set this
                object as closely to the requested value as is
                possible for the particular implementation and
                available resources. The probe must not lower this
                value except as a result of a set to the associated
                nlMatrixTopNRequestedSize object.
                When the next topN report is generated, matrix entries
                with the highest value of nlMatrixTopNRate shall
                be placed in this table in decreasing order of this rate
                until there is no more room or until there are no more
                matrix entries."
            ::= { nlMatrixTopNControlEntry 7 }

          nlMatrixTopNStartTime OBJECT-TYPE
            SYNTAX     TimeTicks
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The value of sysUpTime when this top N report was
                last started.  In other words, this is the time that
                the associated nlMatrixTopNTimeRemaining object was
                modified to start the requested report or the time





          Steven Waldbusser    Expires Nov 22, 1995            [Page 57]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                the report was last automatically (re)started."
            ::= { nlMatrixTopNControlEntry 8 }

          nlMatrixTopNOwner OBJECT-TYPE
            SYNTAX     OwnerString
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The entity that configured this entry and is
                therefore using the resources assigned to it."
            ::= { nlMatrixTopNControlEntry 9 }

          nlMatrixTopNStatus OBJECT-TYPE
            SYNTAX     RowStatus
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The status of this nlMatrixTopNControl entry.

                If this object is not equal to valid(1), all
                associated nlMatrixTopNEntries shall be deleted by the
                agent."
            ::= { nlMatrixTopNControlEntry 10 }

          nlMatrixTopNTable OBJECT-TYPE
            SYNTAX     SEQUENCE OF NlMatrixTopNEntry
            MAX-ACCESS not-accessible
            STATUS     current
            DESCRIPTION
                "A list of top N nlMatrix entries."
            ::= { nlMatrix 5 }

          nlMatrixTopNEntry OBJECT-TYPE
            SYNTAX     NlMatrixTopNEntry
            MAX-ACCESS not-accessible
            STATUS     current
            DESCRIPTION
                "A set of statistics for a matrix entry that is part of a
                top N report.  For example, an instance of the
                nlMatrixTopNRate object might be named
                nlMatrixTopNRate.3.10

                The value of nlMatrixTopNControlIndex in the index is
                that of the associated nlMatrix on who's behalf this study
                was prepared."





          Steven Waldbusser    Expires Nov 22, 1995            [Page 58]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


            INDEX { nlMatrixTopNControlIndex, nlMatrixTopNIndex }
            ::= { nlMatrixTopNTable 1 }

          NlMatrixTopNEntry ::= SEQUENCE {
            nlMatrixTopNIndex                 Integer32 (1..65535),
            nlMatrixTopNProtocolDirIndex      OBJECT IDENTIFIER,
            nlMatrixTopNSourceAddress         OCTET STRING,
            nlMatrixTopNDestinationAddress    OCTET STRING,
            nlMatrixTopNRate                  Integer32
          }

          nlMatrixTopNIndex OBJECT-TYPE
            SYNTAX     Integer32 (1..65535)
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "An index that uniquely identifies an entry in
                the nlMatrixTopN table among those in the same report.
                This index is between 1 and N, where N is the
                number of entries in this table.  Increasing values
                of nlMatrixTopNIndex shall be assigned to entries with
                decreasing values of nlMatrixTopNRate until index N
                is assigned to the entry with the lowest value of
                nlMatrixTopNRate or there are no more nlMatrixTopNEntries."
            ::= { nlMatrixTopNEntry 1 }

          nlMatrixTopNProtocolDirIndex OBJECT-TYPE
            SYNTAX     OBJECT IDENTIFIER
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The network layer type of this matrix entry."
            ::= { nlMatrixTopNEntry 2 }

          nlMatrixTopNSourceAddress OBJECT-TYPE
            SYNTAX     OCTET STRING
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The network layer source address of this matrix entry."
            ::= { nlMatrixTopNEntry 3 }

          nlMatrixTopNDestinationAddress OBJECT-TYPE
            SYNTAX     OCTET STRING
            MAX-ACCESS read-only





          Steven Waldbusser    Expires Nov 22, 1995            [Page 59]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


            STATUS     current
            DESCRIPTION
                "The network layer destination address of this matrix entry."
            ::= { nlMatrixTopNEntry 4 }

          nlMatrixTopNRate OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The amount of change in the selected variable
                during this sampling interval.  The selected
                variable is this nlMatrix entry's instance of the object
                selected by nlMatrixTopNRateBase."
            ::= { nlMatrixTopNEntry 5 }



































          Steven Waldbusser    Expires Nov 22, 1995            [Page 60]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          -- The application analysis group
          --
          alHostTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF AlHostEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of alHost entries.  Each such entry defines statistics
                  for packets from and to a particular network address."
              ::= { alHost 1 }

          alHostEntry OBJECT-TYPE
              SYNTAX      AlHostEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A collection of statistics for a particular host
                  that has been discovered on an interface of this
                  device.

                  The probe will populate this table for all network layer
                  protocols in the protocol directory table who's value of
                  protocolDirAlHostConfig is equal to supportedOn(3).

                  The probe will add to this table all hosts who's address it
                  sees as the source or destination address in all good MAC
                  packets."
              INDEX { hlHostControlIndex, alHostTimeMark,
                      alHostProtocolDirIndex, nlHostAddress,
                      alHostAppProtocolDirIndex }
              ::= { alHostTable 1 }

          AlHostEntry ::= SEQUENCE {
              alHostTimeMark              TimeFilter,
              alHostProtocolDirIndex      Integer32,
              alHostAppProtocolDirIndex   Integer32,
              alHostInPkts                Counter32,
              alHostOutPkts               Counter32,
              alHostInOctets              Counter32,
              alHostOutOctets             Counter32
          }

          alHostTimeMark OBJECT-TYPE
              SYNTAX      TimeFilter
              MAX-ACCESS  not-accessible





          Steven Waldbusser    Expires Nov 22, 1995            [Page 61]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              STATUS      current
              DESCRIPTION
                  "A TimeFilter for this entry.  See the TimeFilter textual
                  convention to see how this works."
              ::= { alHostEntry 1 }

          alHostProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the network layer protocol of
                  this entry's network address."
              ::= { alHostEntry 2 }

          alHostAppProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the protocol this entry is counting."
              ::= { alHostEntry 3 }

          alHostInPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets without errors transmitted to
                  this address of this application type since it was added to
                  the alHostTable."
              ::= { alHostEntry 4 }

          alHostOutPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets including errors transmitted
                  by this address of this application type since it was added
                  to the alHostTable."
              ::= { alHostEntry 5 }

          alHostInOctets OBJECT-TYPE
              SYNTAX      Counter32





          Steven Waldbusser    Expires Nov 22, 1995            [Page 62]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets transmitted to this address
                  of this application type since it was added to the
                  alHostTable (excluding framing bits but including
                  FCS octets), except for those octets in packets that
                  contained errors."
              ::= { alHostEntry 6 }

          alHostOutOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets transmitted by this address
                  of this application type since it was added to the
                  alHostTable (excluding framing bits but including
                  FCS octets), including those octets in packets that
                  contained errors."
              ::= { alHostEntry 7 }

          -- The applications level matrix group

          alMatrixSDTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF AlMatrixSDEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of traffic matrix entries indexed by
                  source and destination network-level address and an
                  application protocol spoken between those addresses."
              ::= { alMatrix 1 }

          alMatrixSDEntry OBJECT-TYPE
              SYNTAX      AlMatrixSDEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A collection of statistics for communications between
                  two addresses on a particular interface.

                  The probe will populate this table for all network layer
                  protocols in the protocol directory table who's value of
                  protocolDirAlMatrixConfig is equal to supportedOn(3)."





          Steven Waldbusser    Expires Nov 22, 1995            [Page 63]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              INDEX { hlMatrixControlIndex, alMatrixSDTimeMark,
                      alMatrixSDProtocolDirIndex,
                      nlMatrixSDSourceAddress, nlMatrixSDDestAddress,
                      alMatrixSDAppProtocolDirIndex }
              ::= { alMatrixSDTable 1 }

          AlMatrixSDEntry ::= SEQUENCE {
              alMatrixSDTimeMark            TimeFilter,
              alMatrixSDProtocolDirIndex    Integer32,
              alMatrixSDAppProtocolDirIndex Integer32,
              alMatrixSDPkts                Counter32,
              alMatrixSDOctets              Counter32
          }

          alMatrixSDTimeMark OBJECT-TYPE
              SYNTAX      TimeFilter
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A TimeFilter for this entry.  See the TimeFilter textual
                  convention to see how this works."
              ::= { alMatrixSDEntry 1 }

          alMatrixSDProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the network layer protocol of
                  this entry's network address."
              ::= { alMatrixSDEntry 2 }

          alMatrixSDAppProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the protocol this entry is counting."
              ::= { alMatrixSDEntry 3 }

          alMatrixSDPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 64]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  "The number of packets transmitted from the source
                  address to the destination address (this number
                  includes error packets)."
              ::= { alMatrixSDEntry 4 }

          alMatrixSDOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of octets (excluding framing bits but
                  including FCS octets) contained in all packets
                  transmitted from the source address to the
                  destination address."
              ::= { alMatrixSDEntry 5 }

          -- Traffic matrix tables from destination to source

          alMatrixDSTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF AlMatrixDSEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of traffic matrix entries indexed by
                  destination and source network-level address."
              ::= { alMatrix 2 }

          alMatrixDSEntry OBJECT-TYPE
              SYNTAX      AlMatrixDSEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A collection of statistics for communications between
                  two address on a particular interface.

                  The probe will populate this table for all network layer
                  protocols in the protocol directory table who's value of
                  protocolDirAlMatrixConfig is set to supportedOn(3)."
              INDEX { nlMatrixDSIndex, alMatrixDSTimeMark, protocolDirIndex,
                      nlMatrixDSDestAddress, nlMatrixDSSourceAddress }
              ::= { alMatrixDSTable 1 }

          AlMatrixDSEntry ::= SEQUENCE {
              alMatrixDSTimeMark            TimeFilter,
              alMatrixDSProtocolDirIndex    Integer32,





          Steven Waldbusser    Expires Nov 22, 1995            [Page 65]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              alMatrixDSAppProtocolDirIndex Integer32,
              alMatrixDSPkts                Counter32,
              alMatrixDSOctets              Counter32
          }

          alMatrixDSTimeMark OBJECT-TYPE
              SYNTAX      TimeFilter
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A TimeFilter for this entry.  See the TimeFilter textual
                  convention to see how this works."
              ::= { alMatrixDSEntry 1 }

          alMatrixDSProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the network layer protocol of
                  this entry's network address."
              ::= { alMatrixDSEntry 2 }

          alMatrixDSAppProtocolDirIndex OBJECT-TYPE
              SYNTAX      Integer32 (1..2147483647)
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The protocolDirIndex of the protocol this entry is counting."
              ::= { alMatrixDSEntry 3 }

          alMatrixDSPkts OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current
              DESCRIPTION
                  "The number of packets transmitted from the source
                  address to the destination address (this number
                  includes error packets)."
              ::= { alMatrixDSEntry 4 }

          alMatrixDSOctets OBJECT-TYPE
              SYNTAX      Counter32
              MAX-ACCESS  read-only
              STATUS      current





          Steven Waldbusser    Expires Nov 22, 1995            [Page 66]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              DESCRIPTION
                  "The number of octets (excluding framing bits
                  but including FCS octets) contained in all packets
                  transmitted from the source address to the
                  destination address."
              ::= { alMatrixDSEntry 5 }

          alMatrixTopNControlTable OBJECT-TYPE
              SYNTAX      SEQUENCE OF AlMatrixTopNControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A list of alMatrix top N control entries."
              ::= { alMatrix 4 }

          alMatrixTopNControlEntry OBJECT-TYPE
              SYNTAX      AlMatrixTopNControlEntry
              MAX-ACCESS  not-accessible
              STATUS      current
              DESCRIPTION
                  "A set of parameters that control the creation of a
                  report of the top N matrix entries according to several
                  metrics.  For example, an instance of the
                  alMatrixTopNDuration object might be named
                  alMatrixTopNDuration.3"
              INDEX       { alMatrixTopNControlIndex }
              ::= { alMatrixTopNControlTable 1 }

          AlMatrixTopNControlEntry ::= SEQUENCE {
            alMatrixTopNControlIndex    Integer32 (1..65535),
            alMatrixTopNMatrixIndex     Integer32 (1..65535),
            alMatrixTopNRateBase        INTEGER,
            alMatrixTopNTimeRemaining   Integer32,
            alMatrixTopNDuration        Integer32,
            alMatrixTopNRequestedSize   Integer32,
            alMatrixTopNGrantedSize     Integer32,
            alMatrixTopNStartTime       TimeTicks,
            alMatrixTopNOwner           OwnerString,
            alMatrixTopNStatus          RowStatus
          }

          alMatrixTopNControlIndex OBJECT-TYPE
            SYNTAX     Integer32 (1..65535)
            MAX-ACCESS read-only
            STATUS     current





          Steven Waldbusser    Expires Nov 22, 1995            [Page 67]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


            DESCRIPTION
                "An index that uniquely identifies an entry
                in the alMatrixTopNControl table.  Each such
                entry defines one top N report prepared for
                one interface."
            ::= { alMatrixTopNControlEntry 1 }

          alMatrixTopNMatrixIndex OBJECT-TYPE
            SYNTAX     Integer32 (1..65535)
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The alMatrix table for which a top N report will be
                prepared on behalf of this entry.  The alMatrix table
                identified by a particular value of this index is
                associated with the same alMatrix table as identified by
                the same value of alMatrixIndex.

                This object may not be modified if the associated
                alMatrixTopNStatus object is equal to valid(1)."
            ::= { alMatrixTopNControlEntry 2 }

          alMatrixTopNRateBase OBJECT-TYPE
            SYNTAX     INTEGER {
                          alMatrixTopNSourceToDestPkts(1),
                          alMatrixTopNDestToSourcePkts(2),
                          alMatrixTopNSourceToDestOctets(3),
                          alMatrixTopNDestToSourceOctets(4)
            }
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The variable for each alMatrix entry that the alMatrixTopNRate
                variable is based upon, as well as the selector of the matrix
                table that will be used.

                This object may not be modified if the associated
                alMatrixTopNStatus object is equal to valid(1)."
            ::= { alMatrixTopNControlEntry 3 }

          alMatrixTopNTimeRemaining OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 68]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                "The number of seconds left in the report currently
                being collected.  When this object is modified by
                the management station, a new collection is started,
                possibly aborting a currently running report.  The
                new value is used as the requested duration of this
                report, and is loaded into the associated
                alMatrixTopNDuration object when the report is finished.
                When the report finishes, the probe will automatically
                start another collection with the same initial value
                of alMatrixTopNTimeRemaining.

                While the value of this object is non-zero, it decrements
                by one per second until it reaches zero.  At the time
                that this object decrements to zero, the report is made
                accessible in the alMatrixTopNTable, overwriting any report
                that may be there.

                (Note that this is a different algorithm than in
                the hostTopNTable)."
            DEFVAL { 0 }
            ::= { alMatrixTopNControlEntry 4 }

          alMatrixTopNDuration OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The number of seconds that this report has collected
                during the last sampling interval.

                When the associated alMatrixTopNTimeRemaining object is
                set, this object shall be set by the probe to the
                same value and shall not be modified until the next
                time the alMatrixTopNTimeRemaining is set.

                This value shall be zero if no reports have been
                requested for this alMatrixTopNControlEntry."
            DEFVAL { 0 }
            ::= { alMatrixTopNControlEntry 5 }

          alMatrixTopNRequestedSize OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 69]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                "The maximum number of matrix entries requested for the top N
                table.

                When this object is created or modified, the probe
                should set alMatrixTopNGrantedSize as closely to this
                object as is possible for the particular probe
                implementation and available resources."
            DEFVAL { 10 }
            ::= { alMatrixTopNControlEntry 6 }

          alMatrixTopNGrantedSize OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The maximum number of matrix entries in the top N table.

                When the associated alMatrixTopNRequestedSize object is
                created or modified, the probe should set this
                object as closely to the requested value as is
                possible for the particular implementation and
                available resources. The probe must not lower this
                value except as a result of a set to the associated
                alMatrixTopNRequestedSize object.
                When the next topN report is generated, matrix entries
                with the highest value of alMatrixTopNRate shall
                be placed in this table in decreasing order of this rate
                until there is no more room or until there are no more
                matrix entries."
            ::= { alMatrixTopNControlEntry 7 }

          alMatrixTopNStartTime OBJECT-TYPE
            SYNTAX     TimeTicks
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The value of sysUpTime when this top N report was
                last started.  In other words, this is the time that
                the associated alMatrixTopNTimeRemaining object was
                modified to start the requested report or the time
                the report was last automatically (re)started."
            ::= { alMatrixTopNControlEntry 8 }

          alMatrixTopNOwner OBJECT-TYPE
            SYNTAX     OwnerString





          Steven Waldbusser    Expires Nov 22, 1995            [Page 70]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The entity that configured this entry and is
                therefore using the resources assigned to it."
            ::= { alMatrixTopNControlEntry 9 }

          alMatrixTopNStatus OBJECT-TYPE
            SYNTAX     RowStatus
            MAX-ACCESS read-create
            STATUS     current
            DESCRIPTION
                "The status of this alMatrixTopNControl entry.

                If this object is not equal to valid(1), all
                associated alMatrixTopNEntries shall be deleted by the
                agent."
            ::= { alMatrixTopNControlEntry 10 }

          alMatrixTopNTable OBJECT-TYPE
            SYNTAX     SEQUENCE OF AlMatrixTopNEntry
            MAX-ACCESS not-accessible
            STATUS     current
            DESCRIPTION
                "A list of top N alMatrix entries."
            ::= { alMatrix 5 }

          alMatrixTopNEntry OBJECT-TYPE
            SYNTAX     AlMatrixTopNEntry
            MAX-ACCESS not-accessible
            STATUS     current
            DESCRIPTION
                "A set of statistics for a matrix entry that is part of a
                top N report.  For example, an instance of the
                alMatrixTopNRate object might be named
                alMatrixTopNRate.3.10

                The value of alMatrixTopNControlIndex in the index is
                that of the associated alMatrix on who's behalf this study
                was prepared."
            INDEX { alMatrixTopNControlIndex, alMatrixTopNIndex }
            ::= { alMatrixTopNTable 1 }

          AlMatrixTopNEntry ::= SEQUENCE {
            alMatrixTopNIndex                 Integer32 (1..65535),





          Steven Waldbusser    Expires Nov 22, 1995            [Page 71]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


            alMatrixTopNProtocolDirIndex      OBJECT IDENTIFIER,
            alMatrixTopNSourceAddress         OCTET STRING,
            alMatrixTopNDestinationAddress    OCTET STRING,
            alMatrixTopNAppProtocolDirIndex   OBJECT IDENTIFIER,
            alMatrixTopNRate                  Integer32
          }

          alMatrixTopNIndex OBJECT-TYPE
            SYNTAX     Integer32 (1..65535)
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "An index that uniquely identifies an entry in
                the alMatrixTopN table among those in the same report.
                This index is between 1 and N, where N is the
                number of entries in this table.  Increasing values
                of alMatrixTopNIndex shall be assigned to entries with
                decreasing values of alMatrixTopNRate until index N
                is assigned to the entry with the lowest value of
                alMatrixTopNRate or there are no more alMatrixTopNEntries."
            ::= { alMatrixTopNEntry 1 }

          alMatrixTopNProtocolDirIndex OBJECT-TYPE
            SYNTAX     OBJECT IDENTIFIER
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The network layer type of this matrix entry."
            ::= { alMatrixTopNEntry 2 }

          alMatrixTopNSourceAddress OBJECT-TYPE
            SYNTAX     OCTET STRING
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The network layer source address of this matrix entry."
            ::= { alMatrixTopNEntry 3 }

          alMatrixTopNDestinationAddress OBJECT-TYPE
            SYNTAX     OCTET STRING
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The network layer destination address of this matrix entry."
            ::= { alMatrixTopNEntry 4 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 72]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          alMatrixTopNAppProtocolDirIndex OBJECT-TYPE
            SYNTAX     OBJECT IDENTIFIER
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The type of the protocol counted by this matrix entry."
            ::= { alMatrixTopNEntry 5 }

          alMatrixTopNRate OBJECT-TYPE
            SYNTAX     Integer32
            MAX-ACCESS read-only
            STATUS     current
            DESCRIPTION
                "The amount of change in the selected variable
                during this sampling interval.  The selected
                variable is this alMatrix entry's instance of the object
                selected by alMatrixTopNRateBase."
            ::= { alMatrixTopNEntry 6 }

          --
          -- User History Collection Group (usrHistory)
          --
          -- The usrHistory group combines mechanisms seen in the alarm and
          -- history groups to provide user-specified history collection,
          -- utilizing two additional control tables and one additional data
          -- table. This function has traditionally been done by NMS
          -- applications, via periodic polling.  The usrHistory group allows
          -- this task to be offloaded to an RMON probe.
          --
          -- Data (an ASN.1 INTEGER based object) is collected in the same manner
          -- as any history data table (e.g. etherHistoryTable) except that
          -- the user specifies the MIB instances to be collected. Objects are
          -- collected in bucket-groups, with the intent that all MIB instances in
          -- the same bucket-group are collected as atomically as possible by the
          -- RMON probe.
          --
          -- The usrHistoryControlTable is a one-dimensional read-create table.
          -- Each row configures a collection of user history buckets, much
          -- the same as a historyControlEntry, except that the creation of a
          -- row in this table will cause one or more associated instances in the
          -- usrHistoryObjectTable to be created. The user specifies the
          -- number of bucket elements (rows in the usrHistoryObjectTable)
          -- requested, as well as the number of buckets requested.
          --
          -- The usrHistoryObjectTable is a 2-d read-write table.





          Steven Waldbusser    Expires Nov 22, 1995            [Page 73]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          -- Each row configures a single MIB instance to be collected.
          -- All rows with the same major index constitute a bucket-group.
          --
          -- The usrHistoryTable is a 3-d read-only table containing
          -- the data of associated usrHistoryControlEntries. Each
          -- entry represents the value of a single MIB instance
          -- during a specific sampling interval (or the rate of
          -- change during the interval).
          --
          -- A sample value is stored in two objects--an absolute value and
          -- a status object. This allows numbers from -(2G-1) to +4G to be stored.
          -- The status object also indicates whether a sample is valid. This allows
          -- data collection to continue if periodic retrieval of a particular
          -- instance fails for any reason.
          --
          -- Row Creation Order Relationships
          --
          -- The static nature of the usrHistoryObjectTable creates
          -- some row creation/modification issues. The rows in this
          -- table need to be set before the associated
          -- usrHistoryControlEntry can be activated.
          --
          -- Note that the usrHistoryObject entries associated with a
          -- particular usrHistoryControl entry are not required to
          -- be valid before the control entry is activated. However,
          -- the usrHistory data entries associated with an invalid
          -- usrHistoryObject entry will be invalid (i.e.
          -- usrHistoryValStatus == valueNotAvailable).
          --

          usrHistoryControlTable OBJECT-TYPE
              SYNTAX SEQUENCE OF UsrHistoryControlEntry
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "A list of data-collection configuration entries."
              ::= { usrHistory 1 }

          usrHistoryControlEntry OBJECT-TYPE
              SYNTAX UsrHistoryControlEntry
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "A list of parameters that set up a group of user-defined
                  MIB objects to be sampled periodically (called a





          Steven Waldbusser    Expires Nov 22, 1995            [Page 74]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  bucket-group).

                  For example, an instance of usrHistoryControlInterval
                  might be named usrHistoryControlInterval.1"
              INDEX { usrHistoryControlIndex }
              ::= { usrHistoryControlTable 1 }


          UsrHistoryControlEntry ::= SEQUENCE {
              usrHistoryControlIndex             Integer32,
              usrHistoryControlObjects           Integer32,
              usrHistoryControlBucketsRequested  Integer32,
              usrHistoryControlBucketsGranted    Integer32,
              usrHistoryControlInterval          Integer32,
              usrHistoryControlOwner             OwnerString,
              usrHistoryControlStatus            RowStatus
              }

          usrHistoryControlIndex OBJECT-TYPE
              SYNTAX Integer32 (1..65535)
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "An index that uniquely identifies an entry in the
                   usrHistoryControl table.  Each such entry defines a
                   set of samples at a particular interval for a specified
                   set of MIB instances available from the managed system."
              ::= { usrHistoryControlEntry 1 }

          usrHistoryControlObjects OBJECT-TYPE
              SYNTAX Integer32 (1..65535)
              MAX-ACCESS read-create
              STATUS current
              DESCRIPTION
                  "The number of MIB objects to be collected
                   in the portion of usrHistoryTable associated with this
                   usrHistoryControlEntry.

                   This object may not be modified if the associated instance
                   of usrHistoryControlStatus is equal to active(1)."
              ::= { usrHistoryControlEntry 2 }

          usrHistoryControlBucketsRequested OBJECT-TYPE
              SYNTAX Integer32 (1..65535)
              MAX-ACCESS read-create





          Steven Waldbusser    Expires Nov 22, 1995            [Page 75]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              STATUS current
              DESCRIPTION
                  "The requested number of discrete time intervals
                  over which data is to be saved in the part of the
                  usrHistoryTable associated with this usrHistoryControlEntry.

                  When this object is created or modified, the probe
                  should set usrHistoryControlBucketsGranted as closely to
                  this object as is possible for the particular probe
                  implementation and available resources."
              DEFVAL { 50 }
              ::= { usrHistoryControlEntry 3 }

          usrHistoryControlBucketsGranted OBJECT-TYPE
              SYNTAX Integer32 (1..65535)
              MAX-ACCESS read-only
              STATUS current
              DESCRIPTION
                  "The number of discrete sampling intervals
                   over which data shall be saved in the part of
                   the usrHistoryTable associated with this
                   usrHistoryControlEntry.

                   When the associated usrHistoryControlBucketsRequested
                   object is created or modified, the probe should set
                   this object as closely to the requested value as is
                   possible for the particular  probe implementation and
                   available resources.  The probe must not lower this
                   value except as a result of a modification to the associated
                   usrHistoryControlBucketsRequested object.

                   The associated usrHistoryControlObjectsRequested object
                   should be set before or at the same time as this object
                   to allow the probe to accurately estimate the resources
                   required for this usrHistoryControlEntry.

                   There will be times when the actual number of buckets
                   associated with this entry is less than the value of
                   this object.  In this case, at the end of each sampling
                   interval, a new bucket will be added to the usrHistoryTable.

                   When the number of buckets reaches the value of this object
                   and a new bucket is to be added to the usrHistoryTable,
                   the oldest bucket associated with this usrHistoryControlEntry
                   shall be deleted by the agent so that the new bucket can be added.





          Steven Waldbusser    Expires Nov 22, 1995            [Page 76]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995



                   When the value of this object changes to a value less than
                   the current value, entries are deleted from the usrHistoryTable
                   associated with this usrHistoryControlEntry.  Enough of
                   the oldest of these entries shall be deleted by the agent so
                   that their number remains less than or equal to the new value of
                   this object.

                   When the value of this object changes to a value greater
                   than the current value, the number of associated usrHistory
                   entries may be allowed to grow."
              ::= { usrHistoryControlEntry 4 }


          usrHistoryControlInterval OBJECT-TYPE
              SYNTAX Integer32 (1..2147483647)
              MAX-ACCESS read-create
              STATUS current
              DESCRIPTION
                  "The interval in seconds over which the data is
                   sampled for each bucket in the part of the usrHistory
                   table associated with this usrHistoryControlEntry.

                   Because the counters in a bucket may overflow at their
                   maximum value with no indication, a prudent manager will
                   take into account the possibility of overflow in any of
                   the associated counters. It is important to consider the
                   minimum time in which any counter could overflow on a
                   particular media type and set the usrHistoryControlInterval
                   object to a value less than this interval.

                   This object may not be modified if the associated
                   usrHistoryControlStatus object is equal to active(1)."
              DEFVAL { 1800 }
              ::= { usrHistoryControlEntry 5 }

          usrHistoryControlOwner OBJECT-TYPE
              SYNTAX OwnerString
              MAX-ACCESS read-create
              STATUS current
              DESCRIPTION
                  "The entity that configured this entry and is therefore using the
                  resources assigned to it."
              ::= { usrHistoryControlEntry 6 }






          Steven Waldbusser    Expires Nov 22, 1995            [Page 77]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          usrHistoryControlStatus OBJECT-TYPE
              SYNTAX RowStatus
              MAX-ACCESS read-create
              STATUS current
              DESCRIPTION
                  "The status of this variable history control entry."
              ::= { usrHistoryControlEntry 7 }
          -- Object table

          usrHistoryObjectTable OBJECT-TYPE
              SYNTAX SEQUENCE OF UsrHistoryObjectEntry
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "A list of data-collection configuration entries."
              ::= { usrHistory 2 }

          usrHistoryObjectEntry OBJECT-TYPE
              SYNTAX UsrHistoryObjectEntry
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "A list of MIB instances to be sampled periodically.

                  Entries in this table are created when an associated
                  usrHistoryControlObjects object is created.

                  For example, an instance of usrHistoryObjectVariable might be
                  usrHistoryObjectVariable.1.3"
              INDEX { usrHistoryControlIndex, usrHistoryObjectIndex }
              ::= { usrHistoryObjectTable 1 }

          UsrHistoryObjectEntry ::= SEQUENCE {
              usrHistoryObjectIndex             Integer32,
              usrHistoryObjectVariable          OBJECT IDENTIFIER,
              usrHistoryObjectSampleType        INTEGER
          }

          usrHistoryObjectIndex OBJECT-TYPE
              SYNTAX Integer32 (1..65535)
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "An index used to uniquely identify an entry in the
                   usrHistoryObject table.  Each such entry defines a





          Steven Waldbusser    Expires Nov 22, 1995            [Page 78]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                   MIB instance to be collected periodically."
              ::= { usrHistoryObjectEntry 1 }


          usrHistoryObjectVariable OBJECT-TYPE
              SYNTAX OBJECT IDENTIFIER
              MAX-ACCESS read-create
              STATUS current
              DESCRIPTION
                  "The object identifier of the particular variable to be sampled.

                  Only variables that resolve to an ASN.1 primitive type of Integer32
                  (Integer32, Counter, Gauge, or TimeTicks) may be sampled.

                  Because SNMP access control is articulated entirely in terms of
                  the contents of MIB views, no access control mechanism exists
                  that can restrict the value of this object to identify only
                  those objects that exist in a particular MIB view.  Because there
                  is thus no acceptable means of restricting the read access that
                  could be obtained through the user history mechanism, the probe
                  must only grant write access to this object in those views that
                  have read access to all objects on the probe.

                  During a set operation, if the supplied variable name is not
                  available in the selected MIB view, a badValue error must be returned.

                  This object may not be modified if the associated
                  usrHistoryControlStatus object is equal to active(1)."
              ::= { usrHistoryObjectEntry 2 }

          usrHistoryObjectSampleType OBJECT-TYPE
              SYNTAX INTEGER {
                      absoluteValue(1),
                      deltaValue(2)
              }
              MAX-ACCESS read-create
              STATUS current
              DESCRIPTION
                  "The method of sampling the selected variable for storage in the
                  usrHistoryTable.

                  If the value of this object is absoluteValue(1), the value of
                  the selected variable will be copied directly into the history
                  bucket.






          Steven Waldbusser    Expires Nov 22, 1995            [Page 79]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  If the value of this object is deltaValue(2), the value of the
                  selected variable at the last sample will be subtracted from
                  the current value, and the difference will be stored in the
                  history bucket. If the associated usrHistoryObjectVariable
                  instance could not be obtained at the previous sample interval,
                  then a delta sample is not possible, and the value of the
                  associated usrHistoryValStatus object for this interval will
                  be valueNotAvailable(1).

                  This object may not be modified if the associated
                  usrHistoryControlStatus object is equal to active(1)."
              ::= { usrHistoryObjectEntry 3 }

          -- data table

          usrHistoryTable OBJECT-TYPE
              SYNTAX SEQUENCE OF UsrHistoryEntry
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "A list of user defined history entries."
              ::= { usrHistory 3 }

          usrHistoryEntry OBJECT-TYPE
              SYNTAX UsrHistoryEntry
              MAX-ACCESS not-accessible
              STATUS current
              DESCRIPTION
                  "An historical sample of user-defined variables.  This sample is
                  associated with the usrHistoryControlEntry which set up the
                  parameters for a regular collection of these samples.
                  For example, an instance of usrHistoryValue, which represents
                  the 14th sample of a variable collected as specified by
                  usrHistoryControlEntry.1 and usrHistoryObjectEntry.1.5,
                  would be named usrHistoryValue.1.14.5"
              INDEX { usrHistoryControlIndex, usrHistorySampleIndex,
                      usrHistoryObjectIndex }
              ::= { usrHistoryTable 1 }

          UsrHistoryEntry ::= SEQUENCE {
              usrHistorySampleIndex   Integer32,
              usrHistoryIntervalStart TimeTicks,
              usrHistoryIntervalEnd   TimeTicks,
              usrHistoryAbsValue      Gauge32,
              usrHistoryValStatus     INTEGER





          Steven Waldbusser    Expires Nov 22, 1995            [Page 80]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              }

          usrHistorySampleIndex OBJECT-TYPE
              SYNTAX Integer32 (1..2147483647)
              MAX-ACCESS read-only
              STATUS current
              DESCRIPTION
                  "An index that uniquely identifies the particular sample this entry
                  represents among all samples associated with the same
                  usrHistoryControlEntry. This index starts at 1 and increases by
                  one as each new sample is taken."
              ::= { usrHistoryEntry 1 }

          usrHistoryIntervalStart OBJECT-TYPE
              SYNTAX TimeTicks
              MAX-ACCESS read-only
              STATUS current
              DESCRIPTION
                  "The value of sysUpTime at the start of the interval over which this
                  sample was measured.  If the probe keeps track of the time of day,
                  it should start the first sample of the history at a time such that
                  when the next hour of the day begins, a sample is started at
                  that instant.

                  Note that following this rule may require the probe to delay
                  collecting the first sample of the history, as each sample must be
                  of the same interval. Also note that the sample which is
                  currently being collected is not accessible in this table until
                  the end of its interval."
              ::= { usrHistoryEntry 2 }

          usrHistoryIntervalEnd OBJECT-TYPE
              SYNTAX TimeTicks
              MAX-ACCESS read-only
              STATUS current
              DESCRIPTION
                  "The value of sysUpTime at the end of the interval over which this
                  sample was measured."
              ::= { usrHistoryEntry 3 }

          usrHistoryAbsValue OBJECT-TYPE
              SYNTAX Gauge32
              MAX-ACCESS read-only
              STATUS current
              DESCRIPTION





          Steven Waldbusser    Expires Nov 22, 1995            [Page 81]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                  "The absolute value of the user-specified statistic during the
                  last sampling period. The value during the current sampling
                  period is not made available until the period is completed.

                  To obtain the true value for this sampling interval, the
                  associated instance of usrHistoryValStatus must be checked,
                  and usrHistoryAbsValue adjusted as necessary.

                  If the MIB instance could not be accessed during the sampling
                  interval, then this object will have a value of zero and the
                  associated instance of usrHistoryValStatus will be set to
                  'valueNotAvailable(1)'."
              ::= { usrHistoryEntry 4 }


          usrHistoryValStatus OBJECT-TYPE
              SYNTAX INTEGER {
                  valueNotAvailable(1),
                  valuePositive(2),
                  valueNegative(3)
              }
              MAX-ACCESS read-only
              STATUS current
              DESCRIPTION
                  "This object indicates the validity and sign of the data in
                  the associated instance of usrHistoryAbsValue.

                  If the MIB instance could not be accessed during the sampling
                  interval, then 'valueNotAvailable(1)' will be returned.

                  If the sample is valid and actual value of the sample is greater
                  than or equal to zero then 'valuePositive(2)' is returned.

                  If the sample is valid and the actual value of the sample is less
                  than zero, 'valueNegative(3)' will be returned. The associated
                  instance of usrHistoryAbsValue should be multiplied by -1 to
                  obtain the true sample value."
              ::= { usrHistoryEntry 5 }

          -- The probe config group

          ControlString ::= DisplayString
          -- This data type is used to communicate with a modem or a serial
          -- data switch.  A ControlString contains embeded commands to
          -- control how the device will interact with the remote device





          Steven Waldbusser    Expires Nov 22, 1995            [Page 82]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          -- through the serial interface.  Commands are represented as
          -- two character sequences beginning with the "^" character.
          -- The following commands are recognized by the device (note
          -- that command characters are case sensitive):
          --
          --    ^s  Send string that follows which is terminated by the next
          --        command or the end of string.
          --    ^c  Delay for the number of seconds that follows.  Toss out
          --        any data received rather than storing it in a buffer for
          --        parsing.
          --    ^t  Set timeout to the value represented by the decimal
          --        digits that follow.  The default timeout is 20 seconds.
          --        Note that this timeout may be override by a smaller
          --        serialTimeout configured for the associated serial
          --        interface (see serialConfigTable).
          --    ^w  Wait for the reply string that follows which is terminated
          --        by the next command or the end of string.  Partial and
          --        case insensitive matching is applied, ie. if the reply
          --        string (any case combination) is found anywhere in the
          --        received string, then the a match is found.  If the
          --        current timeout elapses without a match, then the
          --        remaining control string is ignored.
          --    ^!  The ^ character.
          --    ^d  Delay the number of seconds specified by the decimal
          --        digits that follow.
          --    ^b  Send break for the number of milliseconds specified by
          --        the decimal digits that follow.  If no digits follow,
          --        break will be enforced for 250 milliseconds by default.
          --
          -- The following ASCII control characters may be inserted into
          -- the "^s" send string or the "^w" reply string:
          --
          --    ^@    0x00
          --    ^A    0x01
          --     ..
          --    ^M    0x0D
          --     ..
          --    ^Z    0x1A
          --    ^[    0x1B
          --    ^    0x1C
          --    ^]    0x1D
          --    ^^    0x1E
          --    ^_    0x1F
          --
          -- Binary data may also be inserted into the data stream.  The





          Steven Waldbusser    Expires Nov 22, 1995            [Page 83]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          -- control sequence for each byte of binary data is ^0x##, where
          -- ## is the hexadecimal representation of the data byte.  Two
          -- ASCII characters (0-9, a-f, A-F) must follow the "^0x" control
          -- prefix.  For example, "^0x0D^0x0A" is interpreted as a carriage
          -- return followed by a line feed.

          probeCapabilities OBJECT-TYPE
              SYNTAX Integer32
              MAX-ACCESS read-only
              STATUS current
              DESCRIPTION
                  "An indication of the RMON MIB groups supported
                   on at least one interface by this probe.
                   The value of this mask is a sum.  This sum
                   initially takes the value zero.  Then, for each
                   MIB group G, that is supported by this probe,
                   2 raised to a value representing G is added to the
                   sum.

                   Over time, addition MIB groups may be defined. A
                   probe must set all unused bits to zero, and an NMS
                   must ignore unknown bits.

                   The RMON groups are defined as follows:

                    G (bit#)      Group name
                    --------------------------------------
                    From RFC 1757:
                    0             etherStats
                    1             historyControl
                    2             etherHistory
                    3             alarm
                    4             hosts
                    5             hostTopN
                    6             matrix
                    7             filter
                    8             capture
                    9             event

                    From RFC 1513:
                    10            tokenRingMLStats
                    11            tokenRingPStats
                    12            tokenRingMLHistory
                    13            tokenRingPHistory
                    14            ringStation





          Steven Waldbusser    Expires Nov 22, 1995            [Page 84]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                    15            ringStationOrder
                    16            ringStationConfig
                    17            sourceRouting

                    From [??? RMON-2 groups here ???]:
                    18            protocolDir
                    19            protocolDist
                    20            addressMapping
                    21            slHost
                    22            slMatrix
                    23            slHistory
                    24            slFilter
                    25            usrHistory
                    26            probeConfig

                    For example, an RMON probe supporting the etherStats,
                    historyControl, and etherHistory groups would have
                    a value of 7 (2^0 + 2^1 + 2^2)."
              ::= { probeConfig 1 }

          probeIdentification  OBJECT-TYPE
              SYNTAX      DisplayString (SIZE(0..127))
              MAX-ACCESS read-write
              STATUS     current
              DESCRIPTION
                  "A string uniquely identifying this device."
              ::= { probeConfig 2 }

          probeFirmwareRev  OBJECT-TYPE
              SYNTAX     DisplayString (SIZE(0..15))
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The firmware revision of this device."
              ::= { probeConfig 3 }

          probeHardwareRev  OBJECT-TYPE
              SYNTAX     DisplayString (SIZE(0..31))
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The hardware revision of this device."
              ::= { probeConfig 4 }

          probeDateTime  OBJECT-TYPE





          Steven Waldbusser    Expires Nov 22, 1995            [Page 85]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              SYNTAX     OCTET STRING (SIZE (0 | 8 | 11))
              MAX-ACCESS read-write
              STATUS     current
              DESCRIPTION
                  "Probe's current date and time.

                    field  octets  contents                  range
                    -----  ------  --------                  -----
                      1      1-2   year                      0..65536
                      2       3    month                     1..12
                      3       4    day                       1..31
                      4       5    hour                      0..23
                      5       6    minutes                   0..59
                      6       7    seconds                   0..60
                                   (use 60 for leap-second)
                      7       8    deci-seconds              0..9
                      8       9    direction from UTC        '+' / '-'
                      9      10    hours from UTC            0..11
                     10      11    minutes from UTC          0..59

                    For example, Tuesday May 26, 1992 at 1:30:15 PM
                    EDT would be displayed as:

                                1992-5-26,13:30:15.0,-4:0

                    Note that if only local time is known, then
                    timezone information (fields 8-10) is not
                    present, and if no time information is known, the null
                    string is returned."
              ::= { probeConfig 5 }

          probeResetControl  OBJECT-TYPE
              SYNTAX     INTEGER {
                              running(1),
                              warmBoot(2),
                              coldBoot(3)
                        }
              MAX-ACCESS read-write
              STATUS     current
              DESCRIPTION
                  "Setting this object to warmBoot(2) causes the device to
                   restart the application software with current configuration
                   parameters saved in non-volatile memory.  Setting this
                   object to coldBoot(3) causes the device to reinitialize
                   configuration parameters in non-volatile memory to default





          Steven Waldbusser    Expires Nov 22, 1995            [Page 86]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                   values and restart the application software.  When the device
                   is running normally, this variable has a value of running(1)."
              ::= { probeConfig 6 }

          probeDownloadFile  OBJECT-TYPE
              SYNTAX     DisplayString (SIZE(0..127))
              MAX-ACCESS read-write
              STATUS     current
              DESCRIPTION
                  "The file name to be downloaded from the TFTP server."
              ::= { probeConfig 7 }

          probeDownloadTFTPServer  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-write
              STATUS     current
              DESCRIPTION
                  "The IP address of the TFTP server that contains the boot
                   image to load."
              ::= { probeConfig 8 }

          probeDownloadAction  OBJECT-TYPE
              SYNTAX     INTEGER {
                            imageValid(1),
                            downloadToPROM(2),
                            downloadToRAM(3)
                         }
              MAX-ACCESS read-write
              STATUS     current
              DESCRIPTION
                  "When this object is set to downloadToRAM(2) or
                   downloadToPROM(3), the device will discontinue its
                   normal operation and begin download of the image specified
                   by probeDownLoadFile from the server specifed by
                   probeDownLoadTFTPServer using the TFTP protocol.  If
                   downloadToRAM(2) is specified, the new image is copied
                   to RAM only (the old image remains unaltered in the flash
                   EPROM).  If downloadToPROM(3) is specified
                   the new image is written to the flash EPROM
                   memory after its checksum has been verified to be correct.
                   When the download process is completed, the device will
                   warm boot to restart the newly loaded application.
                   When the device is not downloading, this object will have
                   a value of imageValid(1)."
              ::= { probeConfig 9 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 87]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995



          probeDownloadStatus  OBJECT-TYPE
              SYNTAX     INTEGER {
                              downloadSuccess(1),
                              downloadFailed(2),
                              downloadStatusUnknown(3)
                         }
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The status of the last download procedure, if any.  This object
                   will have a value of downloadStatusUnknown(3) if no download
                   process has been performed."
              ::= { probeConfig 10 }

          serialConfigTable  OBJECT-TYPE
              SYNTAX     SEQUENCE OF SerialConfigEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "A table of serial interface configuration entries.  This data
                  will be stored in non-volatile memory and preserved across
                  probe resets or power loss."
              ::= { probeConfig 11 }

          serialConfigEntry  OBJECT-TYPE
              SYNTAX     SerialConfigEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "A set of configuration parameters for a particular
                   serial interface on this device."
              INDEX  { serialIfIndex }
              ::= { serialConfigTable 1 }

          SerialConfigEntry ::= SEQUENCE {
              serialIfIndex                Integer32 (1..65535),
              serialIpAddress              IpAddress,
              serialSubnetMask             IpAddress,
              serialMode                   INTEGER,
              serialProtocol               INTEGER,
              serialSpeed                  INTEGER,
              serialTimeout                Integer32 (1..65535),
              serialModemInitString        ControlString (SIZE (0..255)),
              serialModemHangUpString      ControlString (SIZE (0..255)),





          Steven Waldbusser    Expires Nov 22, 1995            [Page 88]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              serialModemConnectResp       DisplayString (SIZE (0..255)),
              serialModemNoConnectResp     DisplayString (SIZE (0..255)),
              serialFlowControl            INTEGER,
              serialDialoutTimeout         Integer32 (1..65535)
          }

          serialIfIndex  OBJECT-TYPE
              SYNTAX     Integer32 (1..65535)
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The value of this object uniquely identifies the serial
                   interface on this device for which this entry contains
                   configuration parameters.  The interface identified by a
                   particular value of this object is the same interface as
                   identified by the same value of the ifIndex object, defined
                   in RFC 1213."
              ::= { serialConfigEntry 1 }

          serialIpAddress  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The IP address of this serial interface."
              ::= { serialConfigEntry 2 }

          serialSubnetMask  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The IP subnet mask of this serial interface."
              ::= { serialConfigEntry 3 }

          serialMode  OBJECT-TYPE
              SYNTAX     INTEGER {
                             direct(1),
                             modem(2)
                         }
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The type of incoming connection to expect on this serial
                   interface."





          Steven Waldbusser    Expires Nov 22, 1995            [Page 89]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              DEFVAL { direct }
              ::= { serialConfigEntry 4 }

          serialProtocol  OBJECT-TYPE
              SYNTAX     INTEGER {
                             other(1),
                             slip(2)
                         }
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The type of data link encapsulation to be used on this
                   serial interface."
              DEFVAL { slip }
              ::= { serialConfigEntry 5 }

          serialSpeed  OBJECT-TYPE
              SYNTAX     INTEGER {
                              speed300bps(1),
                              speed1200bps(2),
                              speed2400bps(3),
                              speed4800bps(4),
                              speed9600bps(5),
                              speed14400bps(6),
                              speed19200bps(7),
                              speed38400bps(8)
                         }
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The data rate to configure this serial interface to on startup
                   as well as after each serial connection."
              DEFVAL { speed9600bps }
              ::= { serialConfigEntry 6 }

          serialTimeout  OBJECT-TYPE
              SYNTAX     Integer32 (1..65535)
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "This timeout value is used when the Management Station has initiated
                   the conversation over the serial link. This variable represents the
                   number of seconds of inactivity allowed before terminating
                   the connection on this serial interface. Use the serialTrapTimeout
                   in the case where the probe has initiated the connection for the





          Steven Waldbusser    Expires Nov 22, 1995            [Page 90]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                   purpose of sending a trap."
              DEFVAL { 300 }
              ::= { serialConfigEntry 7 }

          serialModemInitString  OBJECT-TYPE
              SYNTAX     ControlString (SIZE (0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "A control string which controls how a modem attached to this
                   serial interface should be initialized.  The initialization is
                   performed once during startup and again after each connection
                   is terminated if the associated serialMode has the value
                   of modem(2).
                   A control string that is appropriate for a wide variety of
                   modems is: '^s^MATE0Q0V1X4 S0=1 S2=43^M'."
              ::= { serialConfigEntry 8 }

          serialModemHangUpString  OBJECT-TYPE
              SYNTAX     ControlString (SIZE (0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "A control string which specifies how to disconnect a modem
                   connection on this serial interface.  This object is only
                   meaningful if the associated serialMode has the value
                   of modem(2).
                   A control string that is appropriate for a wide variety of
                   modems is: '^d2^s+++^d2^sATH0^M^d2'."
              ::= { serialConfigEntry 9 }

          serialModemConnectResp  OBJECT-TYPE
              SYNTAX     DisplayString (SIZE (0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "An ASCII string conntaining substrings that desribe the
                   expected modem connection response code and associated bps
                   rate.  The substrings are delimited by the first character
                   in the string, for example:
                      /CONNECT/300/CONNECT 1200/1200/CONNECT 2400/2400/
                      CONNECT 4800/4800/CONNECT 9600/9600
                   will be interpreted as:
                      response code    bps rate
                      CONNECT            300





          Steven Waldbusser    Expires Nov 22, 1995            [Page 91]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                      CONNECT 1200      1200
                      CONNECT 2400      2400
                      CONNECT 4800      4800
                      CONNECT 9600      9600
                   The agent will use the information in this string to adjust
                   the bps rate of this serial interface once a modem connection
                   is established.

                   A value that is appropriate for a wide variety of modems is:
                   '/CONNECT/300/CONNECT 1200/1200/CONNECT 2400/2400/
                    CONNECT 4800/4800/CONNECT 9600/9600/CONNECT 14400/14400/
                   CONNECT 19200/19200/CONNECT 38400/38400/'."
              ::= { serialConfigEntry 10 }

          serialModemNoConnectResp  OBJECT-TYPE
              SYNTAX     DisplayString (SIZE (0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "An ASCII string containing response codes that may be
                   generated by a modem to report the reason why a connection
                   attempt has failed.  The response codes are delimited by
                   the first character in the string, for example:
                      /NO CARRIER/BUSY/NO DIALTONE/NO ANSWER/ERROR/
                   If one of these response codes is received via this serial
                   interface while attempting to make a modem connection,
                   the agent will issue the hang up command as specified by
                   modemHangUpString.

                   A value that is appropriate for a wide variety of modems is:
                   '/NO CARRIER/BUSY/NO DIALTONE/NO ANSWER/ERROR/'."
              ::= { serialConfigEntry 11 }

          serialFlowControl  OBJECT-TYPE
              SYNTAX     INTEGER {
                            noFlowControl(1),
                            hardwareFlowControl(2)
                         }
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The type of flow control to use on this serial
                   interface."
              DEFVAL { hardwareFlowControl }
              ::= { serialConfigEntry 12 }





          Steven Waldbusser    Expires Nov 22, 1995            [Page 92]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995



          serialDialoutTimeout  OBJECT-TYPE
              SYNTAX     Integer32 (1..65535)
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "This timeout value is used when the probe initiates the
                  serial connection with the intention of contacting a
                  management station. This variable represents the number
                  of seconds of inactivity allowed before terminating the
                  connection on this serial interface."
              DEFVAL { 20 }
              ::= { serialConfigEntry 13 }

          netConfigTable  OBJECT-TYPE
              SYNTAX     SEQUENCE OF NetConfigEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "A table of network configuration entries."
              ::= { probeConfig 12 }

          netConfigEntry  OBJECT-TYPE
              SYNTAX     NetConfigEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "A set of configuration parameters for a particular
                   network interface on this device."
              INDEX  { netConfigIfIndex }
              ::= { netConfigTable 1 }

          NetConfigEntry ::= SEQUENCE {
              netConfigIfIndex           Integer32 (1..65535),
              netConfigIPAddress         IpAddress,
              netConfigSubnetMask        IpAddress
          }

          netConfigIfIndex  OBJECT-TYPE
              SYNTAX     Integer32 (1..65535)
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "The value of this object uniquely identifies the physical
                   interface on this device for which this entry contains





          Steven Waldbusser    Expires Nov 22, 1995            [Page 93]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                   configuration parameters.  The interface identified by a
                   particular value of this object is the same interface as
                   identified by the same value of the ifIndex object, defined
                   in RFC 1213."
              ::= { netConfigEntry 1 }

          netConfigIPAddress  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The IP address of this Net interface.  The default value
                  for this object is 0.0.0.0.  If either the netConfigIPAddress or
                  netConfigSubnetMask are 0.0.0.0, then when the device boots, it will
                  use BOOTP to try to figure out what these values should be.
                  Otherwise, if BOOTP fails, before the device can talk on the
                  network, this value must be configured through a terminal
                  attached to the device."
              ::= { netConfigEntry 2 }

          netConfigSubnetMask  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The subnet mask of this Net interface.  The default value
                  for this object is 0.0.0.0.  If either the netConfigIPAddress
                  or netConfigSubnetMask are 0.0.0.0, then when the device boots, it
                  will use BOOTP to try to figure out what these values should be.
                  Otherwise, if BOOTP fails, before the device can talk on the
                  network, this value must be configured through a terminal
                  attached to the device."
              ::= { netConfigEntry 3 }

          netDefaultGateway  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The IP Address of the default gateway"
              ::= { probeConfig 13 }

          -- Trap Destination Table
          --
          -- This table defines the destination addresses for traps generated





          Steven Waldbusser    Expires Nov 22, 1995            [Page 94]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          -- from the device.  This table maps a community to one or more trap
          -- destination entries.
          --
          -- The same trap will be sent to all destinations specified in the
          -- entries that have the same trapDestCommunity as the eventCommunity
          -- (as defined by RMON MIB).  Information in this table will be stored
          -- in non-volatile memory.  If the device has gone through a hard
          -- restart, this information will be reset to its default state.

          trapDestTable  OBJECT-TYPE
              SYNTAX     SEQUENCE OF TrapDestEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "A list of trap destination entries."
              ::= { probeConfig 14 }

          trapDestEntry  OBJECT-TYPE
              SYNTAX     TrapDestEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "This entry includes a destination IP address to which to send
                  traps for this community.  It also includes a backup address in
                  case the primary address does not acknowledge the trap."
              INDEX { trapDestIndex }
              ::= { trapDestTable 1 }

          TrapDestEntry ::= SEQUENCE {
              trapDestIndex                Integer32 (1..65535),
              trapDestCommunity            OCTET STRING (SIZE(0..127)),
              trapDestIpAddress            IpAddress,
              trapDestOwner                OwnerString,
              trapDestStatus               RowStatus
          }

          trapDestIndex  OBJECT-TYPE
              SYNTAX     Integer32 (1..65535)
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "A value that uniquely identifies this trapDestEntry."
              ::= { trapDestEntry 1 }

          trapDestCommunity  OBJECT-TYPE





          Steven Waldbusser    Expires Nov 22, 1995            [Page 95]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              SYNTAX     OCTET STRING (SIZE(0..127))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "A community to which these destination IP addresses belong.
                   This entry is associated with any eventEntries in the RMON MIB
                   whose value of eventCommunity is equal to the value of this
                   object.  Every time an associated event entry sends a trap
                   due to an event, that trap will be sent according to the
                   addresses specified in this entry.

                  This object may not be modifed if the associated trapDestStatus
                  object is equal to valid(1)."
              ::= { trapDestEntry 2 }

          trapDestIpAddress  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The primary IP address to which to send traps.

                   This object may not be modifed if the associated trapDestStatus
                   object is equal to valid(1)."
              ::= { trapDestEntry 3 }

          trapDestOwner  OBJECT-TYPE
              SYNTAX     OwnerString
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The owner of this trap destination entry."
              ::= { trapDestEntry 4 }

          trapDestStatus  OBJECT-TYPE
              SYNTAX     RowStatus
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The status of this trap destination entry."
              ::= { trapDestEntry 5 }

          -- Serial Connection Table
          --
          -- The device may communicate with a management station using





          Steven Waldbusser    Expires Nov 22, 1995            [Page 96]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          -- SLIP.  In order for the device to send traps via SLIP, it must
          -- be able to initiate a connection over the serial interface.  The
          -- serial connection table stores the parameters for such connection
          -- initiation.

          serialConnectionTable  OBJECT-TYPE
              SYNTAX     SEQUENCE OF SerialConnectionEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "A list of serial connection entries."
              ::= { probeConfig 15 }

          serialConnectionEntry  OBJECT-TYPE
              SYNTAX     SerialConnectionEntry
              MAX-ACCESS not-accessible
              STATUS     current
              DESCRIPTION
                  "Configuration for a SLIP link over a serial line."
              INDEX { serialConnectIndex }
              ::= { serialConnectionTable 1 }

          SerialConnectionEntry ::= SEQUENCE {
              serialConnectIndex                   Integer32 (1..65535),
              serialConnectDestIpAddress           IpAddress,
              serialConnectType                    INTEGER,
              serialConnectDialString              ControlString (SIZE(0..255)),
              serialConnectSwitchConnectSeq        ControlString (SIZE(0..255)),
              serialConnectSwitchDisconnectSeq     ControlString (SIZE(0..255)),
              serialConnectSwitchResetSeq          ControlString (SIZE(0..255)),
              serialConnectOwner                   OwnerString,
              serialConnectStatus                  RowStatus
          }

          serialConnectIndex  OBJECT-TYPE
              SYNTAX     Integer32 (1..65535)
              MAX-ACCESS read-only
              STATUS     current
              DESCRIPTION
                  "A value that uniquely identifies this serialConnection entry."
              ::= { serialConnectionEntry 1 }

          serialConnectDestIpAddress  OBJECT-TYPE
              SYNTAX     IpAddress
              MAX-ACCESS read-create





          Steven Waldbusser    Expires Nov 22, 1995            [Page 97]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              STATUS     current
              DESCRIPTION
                  "The IP Address that can be reached at the other end of this
                   serial connection.
                   This object may not be modifed if the associated
                   serialConnectStatus object is equal to valid(1)."
              ::= { serialConnectionEntry 2 }


          serialConnectType  OBJECT-TYPE
              SYNTAX     INTEGER {
                              direct(1),
                              modem(2),
                              switch(3),
                              modemSwitch(4)
                         }
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The type of outgoing connection to make.  If this object
                   has the value direct(1), then a direct serial connection
                   is assumed.  If this object has the value modem(2),
                   then serialConnectDialString will be used to make a modem
                   connection.  If this object has the value switch(3),
                   then serialConnectSwitchConnectSeq will be used to establish
                   the connection over a serial data switch, and
                   serialConnectSwitchDisconnectSeq will be used to terminate
                   the connection.  If this object has the value modem-switch(4),
                   then a modem connection will be made first followed by
                   the switch connection.
                   This object may not be modifed if the associated
                   serialConnectStatus object is equal to valid(1)."
              DEFVAL { direct }
              ::= { serialConnectionEntry 3 }

          serialConnectDialString  OBJECT-TYPE
              SYNTAX     ControlString (SIZE(0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "A control string which specifies how to dial the phone
                   number in order to establish a modem connection.  The
                   string should include dialing prefix and suffix.  For
                   example: ``^s^MATD9,888-1234^M'' will instruct the Probe
                   to send a carriage return followed by the dialing prefix





          Steven Waldbusser    Expires Nov 22, 1995            [Page 98]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


                   ``ATD'', the phone number ``9,888-1234'', and a carriage
                   return as the dialing suffix.
                   This object may not be modifed if the associated
                   serialConnectStatus object is equal to valid(1)."
              ::= { serialConnectionEntry 4 }

          serialConnectSwitchConnectSeq  OBJECT-TYPE
              SYNTAX     ControlString (SIZE(0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "A control string which specifies how to establish a
                   data switch connection.
                   This object may not be modifed if the associated
                   serialConnectStatus object is equal to valid(1)."
               ::= { serialConnectionEntry 5 }

          serialConnectSwitchDisconnectSeq  OBJECT-TYPE
              SYNTAX     ControlString (SIZE(0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "A control string which specifies how to terminate a
                   data switch connection.
                   This object may not be modifed if the associated
                   serialConnectStatus object is equal to valid(1)."
              ::= { serialConnectionEntry 6 }

          serialConnectSwitchResetSeq  OBJECT-TYPE
              SYNTAX     ControlString (SIZE(0..255))
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "A control string which specifies how to reset a data
                   switch in the event of a timeout.
                   This object may not be modifed if the associated
                   serialConnectStatus object is equal to valid(1)."
              ::= { serialConnectionEntry 7 }

          serialConnectOwner  OBJECT-TYPE
              SYNTAX     OwnerString
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The owner of this serial connection entry."





          Steven Waldbusser    Expires Nov 22, 1995            [Page 99]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


              ::= { serialConnectionEntry 8 }

          serialConnectStatus  OBJECT-TYPE
              SYNTAX     RowStatus
              MAX-ACCESS read-create
              STATUS     current
              DESCRIPTION
                  "The status of this serial connection entry.

                   If the manager attempts to set this object to valid(1) when
                   the serialConnectType is set to modem(2) or modem-switch(4)
                   and the serialConnectDialString is a zero-length string or
                   cannot be correctly parsed as a ConnectString, the set
                   request will be rejected with badValue(3).

                   If the manager attempts to set this object to valid(1) when
                   the serialConnectType is set to switch(3) or modem-switch(4)
                   and the serialConnectSwitchConnectSeq,
                   the serialConnectSwitchDisconnectSeq, or
                   the serialConnectSwitchResetSeq are zero-length strings
                   or cannot be correctly parsed as ConnectStrings, the set
                   request will be rejected with badValue(3)."
              ::= { serialConnectionEntry 9 }

          END

























          Steven Waldbusser    Expires Nov 22, 1995           [Page 100]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          8.  Acknowledgments

          This document was produced by the IETF Remote Network
          Monitoring Working Group.














































          Steven Waldbusser    Expires Nov 22, 1995           [Page 101]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          9.  References

          [1]  V. Cerf, IAB Recommendations for the Development of
               Internet Network Management Standards.  Internet Working
               Group Request for Comments 1052.  Network Information
               Center, SRI International, Menlo Park, California,
               (April, 1988).

          [2]  V. Cerf, Report of the Second Ad Hoc Network Management
               Review Group, Internet Working Group Request for Comments
               1109.  Network Information Center, SRI International,
               Menlo Park, California, (August, 1989).

          [3]  M.T. Rose and K. McCloghrie, Structure and Identification
               of Management Information for TCP/IP-based internets,
               Internet Working Group Request for Comments 1155.
               Network Information Center, SRI International, Menlo
               Park, California, (May, 1990).

          [4]  K. McCloghrie and M.T. Rose, Management Information Base
               for Network Management of TCP/IP-based internets: MIB-II,
               Internet Working Group Request for Comments 1213 Network
               Information Center, SRI International, Menlo Park,
               California, (March, 1991).

          [5]  J.D. Case, M.S. Fedor, M.L. Schoffstall, and J.R. Davin,
               Simple Network Management Protocol, Internet Working
               Group Request for Comments 1157.  Network Information
               Center, SRI International, Menlo Park, California, (May,
               1990).

          [6]  K. McCloghrie and F. Kastenholz, Evolution of the
               Interfaces Group of MIB-II, Internet Working Group
               Request for Comments 1573.  Network Information Center,
               SRI International, Menlo Park, California, (Jan, 1994).

          [7]  Information processing systems - Open Systems
               Interconnection - Specification of Abstract Syntax
               Notation One (ASN.1), International Organization for
               Standardization.  International Standard 8824, (December,
               1987).

          [8]  Information processing systems - Open Systems
               Interconnection - Specification of Basic Encoding Rules
               for Abstract Notation One (ASN.1), International





          Steven Waldbusser    Expires Nov 22, 1995           [Page 102]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


               Organization for Standardization.  International Standard
               8825, (December, 1987).

          [9]  M.T. Rose, K. McCloghrie, Editors, Concise MIB
               Definitions, Internet Working Group Request for Comments
               1212.  Network Information Center, SRI International,
               Menlo Park, California, (March, 1991).

          [10] M.T. Rose, Editor, A Convention for Defining Traps for
               use with the SNMP, Internet Working Group Request for
               Comments 1215.  Network Information Center, SRI
               International, Menlo Park, California, (March, 1991).






































          Steven Waldbusser    Expires Nov 22, 1995           [Page 103]





          Internet Draft  Remote Network Monitoring MIB     June 1, 1995


          Table of Contents


          1 Status of this Memo ...................................    1
          2 Abstract ..............................................    1
          3 The Network Management Framework ......................    3
          4 Overview ..............................................    4
          4.1 Remote Network Management Goals .....................    4
          4.2 Structure of MIB ....................................    6
          5 Control of Remote Network Monitoring Devices ..........    7
          5.1 Resource Sharing Among  Multiple  Management  Sta-
               tions ..............................................    7
          5.2 Row Addition Among Multiple Management Stations .....    9
          6 Conventions ...........................................   11
          7 Definitions ...........................................   12
          8 Acknowledgments .......................................  101
          9 References ............................................  102

































          Steven Waldbusser    Expires Nov 22, 1995           [Page 104]

