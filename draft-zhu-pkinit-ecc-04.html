<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>ECC Support for PKINIT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="ECC Support for PKINIT">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">NETWORK WORKING GROUP</td><td class="header">L. Zhu</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">K. Jaganathan</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">K. Lauter</td></tr>
<tr><td class="header">Expires: April 26, 2008</td><td class="header">Microsoft Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 24, 2007</td></tr>
</table></td></tr></table>
<h1><br />ECC Support for PKINIT<br />draft-zhu-pkinit-ecc-04</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 26, 2008.</p>

<h3>Abstract</h3>

<p>This document describes the use of Elliptic Curve certificates, Elliptic Curve signature schemes and  
   Elliptic Curve Diffie-Hellman (ECDH) key agreement within the framework of
  PKINIT - the Kerberos Version 5 extension that provides for the use of public
  key cryptography.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions Used in This Document<br />
<a href="#anchor3">3.</a>&nbsp;
Using Elliptic Curve Certificates and Elliptic Curve Signature Schemes<br />
<a href="#anchor4">4.</a>&nbsp;
Using ECDH Key Exchange<br />
<a href="#anchor5">5.</a>&nbsp;
Choosing the Domain Parameters and the Key Size<br />
<a href="#anchor6">6.</a>&nbsp;
Interoperability Requirements<br />
<a href="#consider">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor7">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor8">9.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> Elliptic Curve Cryptography (ECC) is emerging as an attractive
   public-key cryptosystem that provides security equivalent to currently 
   popular public-key mechanisms such as RSA and DSA with smaller 
   key sizes <a class='info' href='#LENSTRA'>[LENSTRA]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial    Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>
   <a class='info' href='#NISTSP80057'>[NISTSP80057]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial    Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<p>
       Currently <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> permits the use of ECC algorithms but it does not specify
       how ECC parameters  are chosen and how to derive the shared key
       for key delivery using Elliptic Curve Diffie-Hellman (ECDH) <a class='info' href='#IEEE1363'>[IEEE1363]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a> <a class='info' href='#X9.63'>[X9.63]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial            Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<p>This document describes how to use Elliptic Curve certificates, Elliptic Curve signature schemes, 
       and ECDH with <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>. However, 
       it should be noted that there is no syntactic or semantic change to the existing <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> messages. Both the client and the KDC
       contribute one ECDH key pair using the key agrement protocol described in this document.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used in This Document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
       "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
       and "OPTIONAL" in this document are to be interpreted as
       described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Using Elliptic Curve Certificates and Elliptic Curve Signature Schemes</h3>

<p>ECC certificates and signature schemes can be used in   
    the Cryptographic Message Syntax (CMS) <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a> <a class='info' href='#RFC3278'>[RFC3278]<span> (</span><span class='info'>Blake-Wilson, S., Brown, D., and P. Lambert, &ldquo;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS),&rdquo; April&nbsp;2002.</span><span>)</span></a> content type 'SignedData'.
</p>
<p> X.509 certificates <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> containing ECC public keys or signed using ECC signature schemes
   MUST comply with <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>. 
</p>
<p> The signatureAlgorithm field of the CMS
   data type SignerInfo can contain one of the following ECC signature algorithm identifiers:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   ecdsa-with-Sha1   [RFC3279]
   ecdsa-with-Sha256 [X9.62]
   ecdsa-with-Sha384 [X9.62]
   ecdsa-with-Sha512 [X9.62]
</pre></div>
<p>The corresponding digestAlgorithm field contains one of the following hash algorithm 
   identifiers respectively:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   id-sha1           [RFC3279]
   id-sha256         [X9.62]
   id-sha384         [X9.62]
   id-sha512         [X9.62]
</pre></div>
<p>Namely id-sha1 MUST be used in conjunction with ecdsa-with-Sha1, id-sha256 MUST be used in conjunction with 
 ecdsa-with-Sha256, id-sha384 MUST be used in conjunction with 
 ecdsa-with-Sha384, and id-sha512 MUST be used in conjunction with 
 ecdsa-with-Sha512.
</p>
<p>Implementations of this specfication MUST support ecdsa-with-Sha256 and SHOULD support ecdsa-with-Sha1.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Using ECDH Key Exchange</h3>

<p> This section describes how ECDH can be used as the AS reply key delivery method <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>.  
     Note that the protocol description here is similar to that of Modular Exponential Diffie-Hellman (MODP DH), as described in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</p>
<p>If the client wishes to use ECDH key agreement method, 
       it encodes its ECDH public key value and the domain parameters <a class='info' href='#IEEE1363'>[IEEE1363]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a> <a class='info' href='#X9.63'>[X9.63]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial            Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a> for its ECDH public key in
       clientPublicValue of the PA-PK-AS-REQ message <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</p>
<p> As described in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>, the ECDH domain
       parameters for the client's public key are specified
       in the algorithm field of the type SubjectPublicKeyInfo <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>
       and the client's ECDH public key value is mapped to a
       subjectPublicKey (a BIT STRING) according to <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.
</p>
<p>The following algorithm identifier is used to identify the client's choice 
       of the ECDH key agreement method for key delivery.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     id-ecPublicKey  (Elliptic Curve Diffie-Hellman [RFC3279])
</pre></div>
<p>If the domain parameters are not accepted by the KDC, the KDC 
       sends back an error message <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> with the code
   KDC_ERR_DH_KEY_PARAMETERS_NOT_ACCEPTED <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>. This error 
   message contains the list of domain parameters acceptable to the KDC. 
   This list is encoded as TD-DH-PARAMETERS <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>, 
   and it is in the KDC's decreasing preference order. The client can then pick a set of 
   domain parameters from the list and retry the authentication.
</p>
<p>Both the client and the KDC MUST have local policy that specifies which set 
 of domain parameters are acceptable if they do not have a priori knowledge of the chosen domain parameters.
 The need for such local policy is explained in <a class='info' href='#consider'>Section&nbsp;7<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
</p>
<p>If the ECDH domain parameters are accepted by the KDC, the KDC sends back 
  its ECDH public key value in 
  the subjectPublicKey field of the PA-PK-AS-REP message <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</p>
<p>As described in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>, the KDC's ECDH public key value is encoded as a BIT
     STRING according to <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.
</p>
<p> Note that in the steps above, the client can indicate to the KDC that it wishes to reuse ECDH keys or to 
  allow the KDC to do so, by including the clientDHNonce field in the request <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>,
  and the KDC can then reuse the ECDH keys and include serverDHNonce field in the reply <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>. 
  This logic is the same 
  as that of the Modular Exponential Diffie-Hellman key agreement method <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</p>
<p>If ECDH is negotiated as the key delivery method, then the PA-PK-AS-REP 
and AS reply key are generated as in Section 3.2.3.1 of <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> with the 
following difference:  The DHSharedSecret is the x-coordinate of the shared secret value (an 
elliptic curve point);  DHSharedSecret is the output of operation 
ECSVDP-DH as described in Section 7.2.1 of <a class='info' href='#IEEE1363'>[IEEE1363]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<p>Both the client and KDC then proceed as described in <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a>.
</p>
<p>Lastly it should be noted that ECDH can be used with any certificates and signature schemes.  However, a significant advantage of using ECDH together with
  ECC certificates and signature schemes is that the ECC domain parameters in the client or KDC certificates can be used. 
  This obviates the need of locally preconfigured domain parameters as described in <a class='info' href='#consider'>Section&nbsp;7<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Choosing the Domain Parameters and the Key Size</h3>

<p>
       The domain parameters and the key size should be chosen so as to provide
       sufficient cryptographic security  <a class='info' href='#RFC3766'>[RFC3766]<span> (</span><span class='info'>Orman, H. and P. Hoffman, &ldquo;Determining Strengths For Public Keys Used For Exchanging Symmetric Keys,&rdquo; April&nbsp;2004.</span><span>)</span></a>.  The following table, based on
       table 2 on page 63 of NIST SP800-57 part 1 <a class='info' href='#NISTSP80057'>[NISTSP80057]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial    Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>, gives approximate comparable key sizes for symmetric-
       and asymmetric-key cryptosystems based on the best-known
       algorithms for attacking them. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

              Symmetric    |  ECC       |   RSA
              -------------+----------- +------------
                 80        |  160 - 223 |   1024
                112        |  224 - 255 |   2048
                128        |  256 - 383 |   3072
                192        |  384 - 511 |   7680
                256        |  512+      |  15360

             Table 1: Comparable key sizes (in bits)
</pre></div>
<p> Thus, for example, when securing a 128-bit symmetric key, it is
prudent to use 256-bit Elliptic Curve Cryptography (ECC), e.g. group P-256 (secp256r1) as described below.
</p>
<p> A set of ECDH domain parameters is also known as a curve. A curve is a named curve if the domain paratmeters 
       are well known and can be identified by an Object Identifier, otherwise it is called a custom curve.        
       <a class='info' href='#RFC4556'>[RFC4556]<span> (</span><span class='info'>Zhu, L. and B. Tung, &ldquo;Public Key Cryptography for Initial Authentication in Kerberos (PKINIT),&rdquo; June&nbsp;2006.</span><span>)</span></a> supports both named curves and custom curves, see <a class='info' href='#consider'>Section&nbsp;7<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>
       on the tradeoff of choosing between named curves and custom curves.
</p>
<p> The named curves recommended in this document are also recommended by
 NIST <a class='info' href='#FIPS186-2'>[FIPS186&#8209;2]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  These fifteen ECC curves are 
given in the following table <a class='info' href='#FIPS186-2'>[FIPS186&#8209;2]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a> <a class='info' href='#SEC2'>[SEC2]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial        Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
           Description                      SEC 2 OID
           -----------------                ---------

           ECPRGF192Random  group P-192     secp192r1
           EC2NGF163Random  group B-163     sect163r2
           EC2NGF163Koblitz group K-163     sect163k1

           ECPRGF224Random  group P-224     secp224r1
           EC2NGF233Random  group B-233     sect233r1
           EC2NGF233Koblitz group K-233     sect233k1

           ECPRGF256Random  group P-256     secp256r1
           EC2NGF283Random  group B-283     sect283r1
           EC2NGF283Koblitz group K-283     sect283k1

           ECPRGF384Random  group P-384     secp384r1
           EC2NGF409Random  group B-409     sect409r1
           EC2NGF409Koblitz group K-409     sect409k1

           ECPRGF521Random  group P-521     secp521r1
           EC2NGF571Random  group B-571     sect571r1
           EC2NGF571Koblitz group K-571     sect571k1
</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Interoperability Requirements</h3>

<p>Implementations conforming to this specification MUST support curve P-256 and P-384.
</p>
<a name="consider"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p> When using ECDH key agreement, the recipient of an elliptic curve public key 
should perform certain checks to avoid the attacks described in <a class='info' href='#ECC-Validation'>[ECC&#8209;Validation]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial            Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  
It is especially important if the recipient is using a long-term ECDH private 
key to check that the sender's public key is a valid point on the correct 
elliptic curve, otherwise information may be leaked about the 
recipient's private key, and iterating the attack will eventually 
completely expose the recipient's private key.
</p>
<p> Kerberos error messages are not integrity protected, as a result, the domain parameters sent by the KDC as TD-DH-PARAMETERS 
       can be tampered with by an attacker so that 
       the set of domain parameters selected could be either weaker or not mutually preferred. 
       Local policy can configure sets of domain parameters acceptable locally, or disallow 
       the negotiation of ECDH domain parameters.
</p>
<p> Beyond elliptic curve size, the main issue is elliptic curve
   structure.  As a general principle, it is more conservative to use
   elliptic curves with as little algebraic structure as possible - thus
   random curves are more conservative than special curves such as
   Koblitz curves, and curves over F_p with p random are more
   conservative than curves over F_p with p of a special form (and
   curves over F_p with p random might be considered more conservative
   than curves over F_2^m as there is no choice between multiple fields
   of similar size for characteristic 2).  Note, however, that algebraic
   structure can also lead to implementation efficiencies and
   implementors and users may, therefore, need to balance conservatism
   against a need for efficiency.  Concrete attacks are known against
   only very few special classes of curves, such as supersingular
   curves, and these classes are excluded from the ECC standards such as
   <a class='info' href='#IEEE1363'>[IEEE1363]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<p> Another issue is the potential for catastrophic failures when a
   single elliptic curve is widely used.  In this case, an attack on the
   elliptic curve might result in the compromise of a large number of
   keys.  Again, this concern may need to be balanced against efficiency
   and interoperability improvements associated with widely-used curves.
   Substantial additional information on elliptic curve choice can be
   found in <a class='info' href='#IEEE1363'>[IEEE1363]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#FIPS186-2'>[FIPS186&#8209;2]<span> (</span><span class='info'>Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial             Authentication in Kerberos,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p> No IANA actions are
  required for this document.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>
The following people have made significant contributions to this
draft: Paul Leach, Dan Simon, Kelvin Yiu, David Cross, Sam Hartman, Tolga Acar, and Stefan Santesson.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ECC-Validation">[ECC-Validation]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
           Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS186-2">[FIPS186-2]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
            Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="IEEE1363">[IEEE1363]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
            Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="NISTSP80057">[NISTSP80057]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
   Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3278">[RFC3278]</a></td>
<td class="author-text">Blake-Wilson, S., Brown, D., and P. Lambert, &ldquo;<a href="http://tools.ietf.org/html/rfc3278">Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3278, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3278.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3279">[RFC3279]</a></td>
<td class="author-text">Bassham, L., Polk, W., and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3279, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3279.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3766">[RFC3766]</a></td>
<td class="author-text">Orman, H. and P. Hoffman, &ldquo;<a href="http://tools.ietf.org/html/rfc3766">Determining Strengths For Public Keys Used For Exchanging Symmetric Keys</a>,&rdquo; BCP&nbsp;86, RFC&nbsp;3766, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3766.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3852">[RFC3852]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3852, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3852.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4556">[RFC4556]</a></td>
<td class="author-text">Zhu, L. and B. Tung, &ldquo;<a href="http://tools.ietf.org/html/rfc4556">Public Key Cryptography for Initial Authentication in Kerberos (PKINIT)</a>,&rdquo; RFC&nbsp;4556, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4556.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X9.62">[X9.62]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
            Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="X9.63">[X9.63]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
           Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="LENSTRA">[LENSTRA]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
   Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="SEC2">[SEC2]</a></td>
<td class="author-text">Tung, B., Neuman, B., and S. Medvinsky, &ldquo;Public Key Cryptography for Initial
       Authentication in Kerberos,&rdquo; August&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Larry Zhu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Microsoft Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redmond, WA  98052</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lzhu@microsoft.com">lzhu@microsoft.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Karthik Jaganathan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Microsoft Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redmond, WA  98052</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:karthikj@microsoft.com">karthikj@microsoft.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kristin Lauter</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Microsoft Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redmond, WA  98052</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:klauter@microsoft.com">klauter@microsoft.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
