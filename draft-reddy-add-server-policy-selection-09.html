<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>DNS Server Selection: DNS Server Information with Assertion Token</title>
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Dan Wing" name="author">
<meta content="Michael C. Richardson" name="author">
<meta content="Mohamed Boucadair" name="author">
<meta content="
       The document defines a mechanism that is meant to communicate DNS
      resolver information to DNS clients for use as a criteria for server
      selection decisions. Such an information that is cryptographically
      signed to attest its authenticity is used for the selection of DNS
      resolvers. Typically, evaluating the resolver information and the
      signatory, DNS clients with minimal or no human intervention can select
      the DNS servers for resolving domain names. 
       This assertion is useful for encrypted DNS (e.g., DNS-over-TLS,
      DNS-over-HTTPS, or DNS-over-QUIC) servers that are either public
      resolvers or discovered in a local network. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="draft-reddy-add-server-policy-selection-09" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.2
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.0.4
    six 1.16.0
-->
<link href="/tmp/draft-reddy-add-server-policy-selection-09-3q9hhioi.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DNS Server Info with Assertion Token</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Reddy, et al.</td>
<td class="center">Expires 10 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ADD WG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-reddy-add-server-policy-selection-09</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-07" class="published">7 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-10">10 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Akamai</div>
</div>
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Citrix</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman Software Works</div>
</div>
<div class="author">
      <div class="author-name">M. Boucadair</div>
<div class="org">Orange</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">DNS Server Selection: DNS Server Information with Assertion Token</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The document defines a mechanism that is meant to communicate DNS
      resolver information to DNS clients for use as a criteria for server
      selection decisions. Such an information that is cryptographically
      signed to attest its authenticity is used for the selection of DNS
      resolvers. Typically, evaluating the resolver information and the
      signatory, DNS clients with minimal or no human intervention can select
      the DNS servers for resolving domain names.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This assertion is useful for encrypted DNS (e.g., DNS-over-TLS,
      DNS-over-HTTPS, or DNS-over-QUIC) servers that are either public
      resolvers or discovered in a local network.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 10 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-resolver-assertion-token-re" class="xref">Resolver Assertion Token (REAT): Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-reat-header" class="xref">REAT Header</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-typ-type-header-parameter" class="xref">'typ' (Type) Header Parameter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-alg-algorithm-header-parame" class="xref">'alg' (Algorithm) Header Parameter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-x5u-x509-url-header-paramet" class="xref">'x5u' (X.509 URL) Header Parameter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-an-example-of-reat-header" class="xref">An Example of REAT Header</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-reat-payload" class="xref">REAT Payload</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-jwt-defined-claims" class="xref">JWT Defined Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-iat-issued-at-claim" class="xref">'iat' - Issued At Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-exp-expiration-time-claim" class="xref">'exp' - Expiration Time Claim</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-reat-specific-claims" class="xref">REAT Specific Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-dns-server-identity-claims" class="xref">DNS Server Identity Claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-resinfo-resolver-informatio" class="xref">'resinfo' (Resolver Information) Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-an-example" class="xref">An Example</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-reat-signature" class="xref">REAT Signature</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-extending-reat" class="xref">Extending REAT</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-deterministic-json-serializ" class="xref">Deterministic JSON Serialization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-example-reat-deterministic-" class="xref">Example REAT Deterministic JSON Form</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-using-resinfo-responses" class="xref">Using RESINFO Responses</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-media-type-registration" class="xref">Media Type Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-11.1.1" class="xref">11.1.1</a>.  <a href="#name-media-type-registry-content" class="xref">Media Type Registry Contents Additions Requested</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-json-web-token-claims-regis" class="xref">JSON Web Token Claims Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-11.2.1" class="xref">11.2.1</a>.  <a href="#name-registry-contents-additions" class="xref">Registry Contents Additions Requested</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-dns-resolver-information-re" class="xref">DNS Resolver Information Registration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-example-of-es256-based-reat" class="xref">Example of ES256-based REAT JWS Serialization and Signature</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-x509-private-key-in-pkcs8-f" class="xref">X.509 Private Key in PKCS#8 Format for ES256 Example**</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-x509-public-key-for-es256-e" class="xref">X.509 Public Key for ES256 Example**</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-complete-jws-json-serializa" class="xref">Complete JWS JSON Serialization Representation with multiple Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-x509-private-key-in-pkcs8-fo" class="xref">X.509 Private Key in PKCS#8 format for E384 Example**</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-x509-public-key-for-es384-e" class="xref">X.509 Public Key for ES384 Example**</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#RFC7626" class="xref">RFC7626</a>]</span> discusses DNS privacy considerations
      in both "on the wire" (Section 2.4 of <span>[<a href="#RFC7626" class="xref">RFC7626</a>]</span>)
      and "in the server" (Section 2.5 of <span>[<a href="#RFC7626" class="xref">RFC7626</a>]</span>)
      contexts. Examples of protocols that provide encrypted channels between
      DNS clients and servers are DNS-over-HTTPS (DoH) <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>, DNS-over-TLS (DoT) <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>, and DNS-over-QUIC (DoQ) <span>[<a href="#I-D.ietf-dprive-dnsoquic" class="xref">I-D.ietf-dprive-dnsoquic</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">DNS clients can discover and authenticate encrypted DNS servers
      provided by a local network, for example using the techniques proposed
      in <span>[<a href="#I-D.ietf-add-dnr" class="xref">I-D.ietf-add-dnr</a>]</span> and <span>[<a href="#I-D.ietf-add-ddr" class="xref">I-D.ietf-add-ddr</a>]</span>. If the mechanism used to discover the
      encrypted DNS server is insecure, the DNS client needs evidence about
      the encrypted server to assess its trustworthiness and a way to appraise
      such evidence. The mechanism specified in this document can be used by
      the DNS client to cryptographically identify if it is connecting to an
      encrypted DNS server hosted by a specific organization (e.g., ISP or
      Enterprise). This strengthens the protection as clients can detect and
      reject connections to encrypted DNS servers hosted by attackers.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notation">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span><span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and
      only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document makes use of the terms defined in <span>[<a href="#RFC8499" class="xref">RFC8499</a>]</span> and <span>[<a href="#I-D.ietf-dnsop-terminology-ter" class="xref">I-D.ietf-dnsop-terminology-ter</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">'Encrypted DNS' refers to a DNS protocol that provides an encrypted
      channel between a DNS client and server (e.g., DoT, DoH, or DoQ).<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The terms 'Evidence', 'Verifier', 'Background Check', 'Relying
      Party', 'Appraisal Policy', and 'Attestation Results' are defined in
      <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="PAT">
<section id="section-3">
      <h2 id="name-resolver-assertion-token-re">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-resolver-assertion-token-re" class="section-name selfRef">Resolver Assertion Token (REAT): Overview</a>
      </h2>
<p id="section-3-1">The mechanism used in this specification resembles the
      Background-Check Model discussed in Sections 5.2 and 5.3 of Remote
      attestation procedure (RATS) Architecture <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>. RATS enables a relying
      party to establish a level of confidence in the trustworthiness of a
      remote peer through the creation of Evidence to assess the peer's
      trustworthiness, and an Appraisal Policy for such Evidence.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">In this document, the Relying Party is the DNS client and the
      Attester is the encrypted DNS server. The Encrypted DNS servers MAY use
      "Domain Validation" (DV) certificates for certificate-based server
      authentication in TLS connections.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The DNS server's resolver information needs to be validated and
      signed. This signature is called an <span><a href="#I-D.ietf-rats-architecture" class="xref">Attestation Result</a> [<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>. This
      validation can be performed by the DNS operator itself (signed by the
      DNS operator's certificate) acting as a verifier or performed by an
      external Verifier (signed by that external Verifier). The signing
      certificate can to be an Extended Validation (EV) certificate issued by
      a public CA in specific scenarios listed below. An EV certificate is
      issued by the public CA after a thorough Background Check to verify the
      requesting organization's legal identity. If the signing certificate is
      a EV certificate, it leaves the client with a better audit trail of the
      organization hosting the DNS server in comparison with the DV
      certificate.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The use of EV certificate is needed in the following scenarios:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">It helps the client to avoid sending DNS queries to an Encrypted
          DNS server hosted by an attacker discovered insecurely (e.g., using
          DHCP/RA or DNS). For example, an attacker can get a domain name,
          domain-validated public certificate from a CA and host a Encrypted
          DNS server. Furthermore, an attacker can use a public IP address,
          get an 'IP address'-validated public certificate from a CA and host
          a Encrypted DNS server.<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-5.2">It can be used by the client to identify the Encrypted DNS server
          is hosted by a legal organization.<a href="#section-3-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-6">The use of EV certificate is not required in the following
      scenarios:<a href="#section-3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-7.1">If the Encrypted DNS server can only be discovered securely
          (e.g., using IKEv2 <span>[<a href="#I-D.btw-add-ipsecme-ike" class="xref">I-D.btw-add-ipsecme-ike</a>]</span>),
          the signing certificate need not be an EV certificate.<a href="#section-3-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-7.2">Secure Zero Touch Provisioning <span>[<a href="#RFC8572" class="xref">RFC8572</a>]</span>
          defines a bootstrapping strategy for enabling a networking device to
          securely obtain the required configuration information with no user
          input. If the encrypted DNS server is insecurely discovered and not
          preconfigured in the networking device, the DNS client on the
          networking device can validate the Resolver Assertion Token
          signature using the owner certificate as per Section 3.2 of <span>[<a href="#RFC8572" class="xref">RFC8572</a>]</span>.<a href="#section-3-7.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-8">JSON Web Token (JWT) <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> and JSON Web
      Signature (JWS) <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> and related
      specifications define a standard token format that can be used as a way
      of encapsulating claimed or asserted information with an associated
      digital signature using X.509 based certificates. JWT provides a set of
      claims in JSON format that can accommodate asserted resolver information
      of the Encrypted DNS server. Additionally, JWS provides a path for
      updating methods and cryptographic algorithms used for the associated
      digital signatures.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">JWS defines the use of JSON data structures in a specified canonical
      format for signing data corresponding to JOSE header, JWS Payload, and
      JWS Signature. The next sections define the header and claims that MUST
      be minimally used with JWT and JWS for resolver assertion token.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">The REsolver Assertion Token (REAT) specifically uses this token
      format and defines claims that convey the resolver information of
      Encrypted DNS server.<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">The client can retrieve the REAT object using the RESINFO RRtype
      defined in <span>[<a href="#I-D.reddy-add-resolver-info" class="xref">I-D.reddy-add-resolver-info</a>]</span> and QNAME
      of the domain name that is used to authenticate the DNS server (referred
      to as ADN in <span>[<a href="#RFC8310" class="xref">RFC8310</a>]</span>). If the special use domain
      name "resolver.arpa" defined in <span>[<a href="#I-D.ietf-add-ddr" class="xref">I-D.ietf-add-ddr</a>]</span>
      is used to discover the Encrypted DNS server, the client can retrieve
      the REAT object using the RESINFO RRtype and QNAME of the special use
      domain name.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">The signature of REAT object MUST be validated by the DNS client. If
      signature is invalid, the REAT object is rejected. If signature is valid
      and signer is trusted, the DNS client can use that encrypted DNS
      server.<a href="#section-3-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pat_header">
<section id="section-4">
      <h2 id="name-reat-header">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-reat-header" class="section-name selfRef">REAT Header</a>
      </h2>
<p id="section-4-1">The JWS token header is a JOSE header (Section 4 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>) that defines the type and encryption algorithm
      used in the token.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The REAT header MUST include, at a minimum, the header parameters
      defined in Sections <a href="#typ-type-header-parameter" class="xref">4.1</a>, <a href="#alg-algorithm-header-parameter" class="xref">4.2</a>, and <a href="#x5u-x509-url-header-parameter" class="xref">4.3</a>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="typ-type-header-parameter">
<section id="section-4.1">
        <h3 id="name-typ-type-header-parameter">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-typ-type-header-parameter" class="section-name selfRef">'typ' (Type) Header Parameter</a>
        </h3>
<p id="section-4.1-1">The 'typ' (Type) Header Parameter is defined in Section 4.1.9 of
        <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> to declare the media type of the
        complete JWS.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">For REAT Token the 'typ' header MUST be the string 'rat'. This
        represents that the encoded token is a JWT of type rat.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alg-algorithm-header-parameter">
<section id="section-4.2">
        <h3 id="name-alg-algorithm-header-parame">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-alg-algorithm-header-parame" class="section-name selfRef">'alg' (Algorithm) Header Parameter</a>
        </h3>
<p id="section-4.2-1">The 'alg' (Algorithm) Header Parameter is defined in Section 4.1.1
        of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>. It specifies the JWS signature
        cryptographic algorithm. It also refers to a list of defined 'alg'
        values as part of a registry established by JSON Web Algorithms (JWA)
        <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span> Section 3.1.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">For the creation and verification of REAT tokens and their digital
        signatures, implementations MUST support ES256 as defined in Section
        3.4 of <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span>. Implementations MAY support
        other algorithms registered in the JSON Web Signature and Encryption
        Algorithms registry created by <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span>. The
        content of that registry may be updated in the future depending on
        cryptographic strength requirements guided by current security best
        practice. The mandatory-to-support algorithm for REAT tokens may
        likewise be updated in the future.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Implementations of REAT digital signatures using ES256 as defined
        above SHOULD use deterministic ECDSA when supported for the reasons
        stated in <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="x5u-x509-url-header-parameter">
<section id="section-4.3">
        <h3 id="name-x5u-x509-url-header-paramet">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-x5u-x509-url-header-paramet" class="section-name selfRef">'x5u' (X.509 URL) Header Parameter</a>
        </h3>
<p id="section-4.3-1">As defined in Section 4.1.5 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>, the
        'x5u' header parameter defines a URI <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>
        referring to the resource for the X.509 public key certificate or
        certificate chain <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> corresponding to the
        key used to digitally sign the JWS. Generally, as defined in Section
        4.1.5 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> this corresponds to an HTTPS
        or DNSSEC resource using integrity protection.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-pat-header">
<section id="section-4.4">
        <h3 id="name-an-example-of-reat-header">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-an-example-of-reat-header" class="section-name selfRef">An Example of REAT Header</a>
        </h3>
<p id="section-4.4-1">An example of the REAT header is shown in <a href="#ex" class="xref">Figure 1</a>. It includes the specified REAT type, ES256
        algorithm, and an URI referencing the network location of the
        certificate needed to validate the REAT signature.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<span id="name-a-reat-header-example"></span><div id="ex">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.4-2.1">
<pre>{
  "typ":"rat",
  "alg":"ES256",
  "x5u":"https://cert.example.com/rat.cer"
}
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-a-reat-header-example" class="selfRef">A REAT Header Example</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="pat_payload">
<section id="section-5">
      <h2 id="name-reat-payload">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-reat-payload" class="section-name selfRef">REAT Payload</a>
      </h2>
<p id="section-5-1">The token claims consist of the resolver information of the DNS
      server that needs to be verified at the DNS client. These claims follow
      the definition of a JWT claim (Section 4 of <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>) and are encoded as defined by the JWS Payload
      (Section 3 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">REAT defines the use of a standard JWT-defined claim as well as
      custom claims corresponding to the DoT or DoH servers.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Claim names MUST use the US-ASCII character set. Claim values MAY
      contain characters that are outside the ASCII range, however they MUST
      follow the default JSON serialization defined in Section 7 of <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="jwt-defined-claims">
<section id="section-5.1">
        <h3 id="name-jwt-defined-claims">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-jwt-defined-claims" class="section-name selfRef">JWT Defined Claims</a>
        </h3>
<div id="iat-issued-at-claim">
<section id="section-5.1.1">
          <h4 id="name-iat-issued-at-claim">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-iat-issued-at-claim" class="section-name selfRef">'iat' - Issued At Claim</a>
          </h4>
<p id="section-5.1.1-1">The JSON claim MUST include the 'iat' (Section 4.1.6 of <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>) defined claim "Issued At". The 'iat'
          should be set to the date and time of issuance of the JWT. The time
          value should be of the format (NumericDate) defined in Section 2 of
          <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="exp-header-parameter">
<section id="section-5.1.2">
          <h4 id="name-exp-expiration-time-claim">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-exp-expiration-time-claim" class="section-name selfRef">'exp' - Expiration Time Claim</a>
          </h4>
<p id="section-5.1.2-1">The JSON claim MUST include the 'exp' (Section 4.1.4 of <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>) defined "claim Expiration Time". The 'exp'
          should be set to specify the expiration time on or after which the
          JWT is not accepted for processing. The REAT object should expire
          after a reasonable duration. A short expiration time for the REAT
          object periodically reaffirms the resolver information of the DNS
          server to the DNS client and ensures the DNS client does not use
          outdated resolver information. If the DNS client knows the REAT
          object has expired, it should make another request to get the new
          REAT object from the DNS server.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pat_claims">
<section id="section-5.2">
        <h3 id="name-reat-specific-claims">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-reat-specific-claims" class="section-name selfRef">REAT Specific Claims</a>
        </h3>
<div id="server-identity">
<section id="section-5.2.1">
          <h4 id="name-dns-server-identity-claims">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-dns-server-identity-claims" class="section-name selfRef">DNS Server Identity Claims</a>
          </h4>
<p id="section-5.2.1-1">The DNS server identity is represented by a claim that is
          required for REAT: the 'server' claim. The 'server' MUST contain
          claim values that are identity claim JSON objects where the child
          claim name represents an identity type and the claim value is the
          identity string, both defined in subsequent subsections.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">These identities can be represented as either authentication
          domain name (ADN) (defined in <span>[<a href="#RFC8310" class="xref">RFC8310</a>]</span>) or
          Uniform Resource Indicators (URI).<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">The DNS client constructs a reference identifier for the DNS
          server based on the ADN or the domain portion in the URI of the DNS
          server identity. The domain name in the DNS-ID identifier type
          within subjectAltName entry in the DNS server certificate conveyed
          in the TLS handshake is matched with the reference identifier. If
          the match is not successful, the client MUST not accept the REAT for
          further processing.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<div id="adn">
<section id="section-5.2.1.1">
            <h5 id="name-adn-authentication-domain-n">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-adn-authentication-domain-n" class="section-name selfRef">'adn' - Authentication Domain Name Identity</a>
            </h5>
<p id="section-5.2.1.1-1">If the DNS server identity is an ADN, the claim name
            representing the identity MUST be 'adn'. The claim value for the
            'adn' claim is the ADN.<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="uri-identity">
<section id="section-5.2.1.2">
            <h5 id="name-uri-uri-identity">
<a href="#section-5.2.1.2" class="section-number selfRef">5.2.1.2. </a><a href="#name-uri-uri-identity" class="section-name selfRef">'uri' - URI Identity</a>
            </h5>
<p id="section-5.2.1.2-1">If the DNS server identity is of the form URI Template, as
            defined in <span>[<a href="#RFC6570" class="xref">RFC6570</a>]</span>, the claim name
            representing the identity MUST be 'uri' and the claim value is the
            URI Template form of the DNS server identity.<a href="#section-5.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-2">As a reminder, if DoH is supported by the DNS server, the DNS
            client uses the URI Template (Section 3 of <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>).<a href="#section-5.2.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="policyinfo">
<section id="section-5.2.2">
          <h4 id="name-resinfo-resolver-informatio">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-resinfo-resolver-informatio" class="section-name selfRef">'resinfo' (Resolver Information) Claim</a>
          </h4>
<p id="section-5.2.2-1">The 'resinfo' claim contains the resolver information of the DNS
          server defined in Section 5 of [I-D.reddy-add-resolver-info].<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pat_payload_example">
<section id="section-5.2.3">
          <h4 id="name-an-example">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-an-example" class="section-name selfRef">An Example</a>
          </h4>
<p id="section-5.2.3-1"><a href="#poex" class="xref">Figure 2</a> shows an example of resolver
          information.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<span id="name-an-example-of-resolver-info"></span><div id="poex">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-5.2.3-2.1">
<pre>{
  "server":{
      "adn":"example.com"
  },
  "iat":1443208345,
  "exp":1443640345,
  "resinfo": {
     "qnameminimization":false,
  }
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-an-example-of-resolver-info" class="selfRef">An Example of Resolver Information</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="pat_signature">
<section id="section-6">
      <h2 id="name-reat-signature">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-reat-signature" class="section-name selfRef">REAT Signature</a>
      </h2>
<p id="section-6-1">The signature of the REAT is created as specified in Section 5.1 of
      <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> (Steps 1 through 6). REAT MUST use the
      JWS Protected Header.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">For the JWS Payload and the JWS Protected Header, the lexicographic
      ordering and white space rules described in <a href="#pat_header" class="xref">Section 4</a> and <a href="#pat_payload" class="xref">Section 5</a>, and
      JSON serialization rules in <a href="#json_serialization" class="xref">Section 8</a>
      MUST be followed.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The REAT is cryptographically signed by the domain hosting the DNS
      server and optionally by a third party who performed privacy and
      security audit of the DNS server.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The resolver information is attested using "Extended Validation" (EV)
      certificate to avoid bad actors taking advantage of this mechanism to
      advertise encrypted DNS servers for illegitimate and fraudulent purposes
      meant to trick DNS clients into believing that they are using a
      legitimate encrypted DNS server hosted to provide privacy for DNS
      transactions.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Alternatively, a DNS client has to be configured to trust the leaf of
      the signer of the REAT object. That is, trust of the signer MUST NOT be
      determined by validating the signer via the OS or the browser trust
      chain because that would allow any arbitrary entity to operate a DNS
      server and assert any sort of resolver information.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6"><a href="#example-es256-based-pat-jws-serialization-and-signature" class="xref">Appendix A</a>
      provides an example of how to follow the steps to create the JWS
      Signature.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">JWS JSON serialization (Step 7 in Section 5.1 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>) is supported for REAT to enable multiple
      signatures to be applied to the REAT object. For example, the REAT
      object can be cryptographically signed by the domain hosting the DNS
      server and by a third party who performed privacy and security audit of
      the DNS server.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8"><a href="#example-es256-based-pat-jws-serialization-and-signatures" class="xref">Appendix B</a>
      includes an example of the full JWS JSON serialization representation
      with multiple signatures.<a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9">Section 5.1 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> (Step 8) describes the
      method to create the final JWS Compact Serialization form of the REAT
      Token.<a href="#section-6-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extending_pat">
<section id="section-7">
      <h2 id="name-extending-reat">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-extending-reat" class="section-name selfRef">Extending REAT</a>
      </h2>
<p id="section-7-1">REAT includes the minimum set of claims needed to securely assert the
      resolver information of the DNS server. JWT supports a mechanism to add
      additional asserted or signed information by simply adding new claims.
      REAT can be extended beyond the defined base set of claims to represent
      other DNS server information requiring assertion or validation.
      Specifying new claims follows the baseline JWT procedures (<span><a href="#RFC7519" class="xref">Section 10.1 of</a> [<a href="#RFC7519" class="xref">RFC7519</a>]</span>). Understanding new claims on
      the DNS client is optional. The creator of a REAT object cannot assume
      that the DNS client will understand the new claims.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="json_serialization">
<section id="section-8">
      <h2 id="name-deterministic-json-serializ">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-deterministic-json-serializ" class="section-name selfRef">Deterministic JSON Serialization</a>
      </h2>
<p id="section-8-1">JSON objects can include spaces and line breaks, and key value pairs
      can occur in any order. It is therefore a non-deterministic string
      format. In order to make the digital signature verification work
      deterministically, the JSON representation of the JWS Protected Header
      object and JWS Payload object MUST be computed as follows.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The JSON object MUST follow the following rules. These rules are
      based on the thumbprint of a JSON Web Key (JWK) as defined in Section 3
      of <span>[<a href="#RFC7638" class="xref">RFC7638</a>]</span> (Step 1).<a href="#section-8-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8-3">
<li id="section-8-3.1">The JSON object MUST contain no whitespace or line breaks before
          or after any syntactic elements.<a href="#section-8-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-8-3.2">JSON objects MUST have the keys ordered lexicographically by the
          Unicode <span>[<a href="#UNICODE" class="xref">UNICODE</a>]</span> code points of the member
          names.<a href="#section-8-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-8-3.3">JSON value literals MUST be lowercase.<a href="#section-8-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-8-3.4">JSON numbers are to be encoded as integers unless the field is
          defined to be encoded otherwise.<a href="#section-8-3.4" class="pilcrow">¶</a>
</li>
        <li id="section-8-3.5">Encoding rules MUST be applied recursively to member values and
          array values.<a href="#section-8-3.5" class="pilcrow">¶</a>
</li>
      </ol>
<div id="example-pat-deterministic-json-form">
<section id="section-8.1">
        <h3 id="name-example-reat-deterministic-">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-example-reat-deterministic-" class="section-name selfRef">Example REAT Deterministic JSON Form</a>
        </h3>
<p id="section-8.1-1">This section demonstrates the deterministic JSON serialization for
        the example REAT Payload shown in <a href="#pat_payload_example" class="xref">Section 5.2.3</a>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The initial JSON object is shown in <a href="#initial" class="xref">Figure 3</a>.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<span id="name-initial-json-object"></span><div id="initial">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-8.1-3.1">
<pre>{
  "server":{
      "adn":"example.com"
  },
  "iat":1443208345,
  "exp":1443640345,
  "resinfo": {
     "qnameminimization":false,
  }
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-initial-json-object" class="selfRef">Initial JSON Object</a>
          </figcaption></figure>
</div>
<p id="section-8.1-4">The parent members of the JSON object are as follows, in
        lexicographic order: "exp", "iat", "resinfo", "server".<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">The final constructed deterministic JSON serialization
        representation, with whitespace and line breaks removed, (with line
        breaks used for display purposes only) is:<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<span id="name-deterministic-json-form"></span><div id="final">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-8.1-6.1">
<pre>{"exp":1443640345,"iat":1443208345,
"resinfo":{"qnameminimization":false},
"server":{"adn":"example.com"}}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-deterministic-json-form" class="selfRef">Deterministic JSON Form</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="Identity">
<section id="section-9">
      <h2 id="name-using-resinfo-responses">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-using-resinfo-responses" class="section-name selfRef">Using RESINFO Responses</a>
      </h2>
<p id="section-9-1">This document defines the following entry for the IANA DNS Resolver
      Information Registry that is defined in
      [I-D.reddy-add-resolver-info].<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">The "attested-resinfo" name contains the full REAT object. The
          REAT header, REAT payload, and REAT signature components comprise a
          full REAT object. If the "attested-resinfo" name is conveyed to the
          client, the server need not convey the attributes "resinfourl",
          "identityurl", "extendeddnserror" and "qnameminimization" attributes
          separately as that resolver information will be extracted by the
          client from the REAT payload.<a href="#section-9-2.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="Security">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">The use of REAT object based on the validation of the digital
      signature and the associated certificate requires consideration of the
      authentication and authority or reputation of the signer to attest the
      resolver information of the DNS server being asserted. Bad actors can
      host encrypted DNS servers to invade the privacy of the user. Bad actor
      can get a domain name, host encrypted DNS servers, and get the DNS
      server certificate signed by a CA. The resolver information will have to
      be attested using EV certificates or a REAT object signer trusted by the
      DNS client to prevent the attack.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The CA that issued the EV certificate does not attest the resolver
      information. The organization hosting the DNS server attests the
      resolver information using the EV certificate and the client uses the EV
      certificate to identify the organization (e.g., ISP or Enterprise)
      hosting the DNS server.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">If the REAT object is asserted by a third party, it can do a "time of
      check" but the DNS server is susceptible of "time of use" attack. For
      example, changes to the DNS server can cause a disagreement between the
      auditor and the DNS server operation, hence the REAT object needs to be
      also asserted by the domain hosting the DNS server. In addition, the
      REAT object needs to have a short expiration time (e.g., 7 days) to
      ensure the DNS server's domain re-asserts the resolver information and
      limits the damage from change in behaviour and mis-issuance.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="media-type-registration">
<section id="section-11.1">
        <h3 id="name-media-type-registration">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-media-type-registration" class="section-name selfRef">Media Type Registration</a>
        </h3>
<div id="media-type-registry-contents-additions-requested">
<section id="section-11.1.1">
          <h4 id="name-media-type-registry-content">
<a href="#section-11.1.1" class="section-number selfRef">11.1.1. </a><a href="#name-media-type-registry-content" class="section-name selfRef">Media Type Registry Contents Additions Requested</a>
          </h4>
<p id="section-11.1.1-1">This section registers the 'application/rat' media type <span>[<a href="#RFC2046" class="xref">RFC2046</a>]</span> in the 'Media Types' registry in the manner
          described in <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>, which can be used to
          indicate that the content is a REAT defined JWT.<a href="#section-11.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1.1-2.1">Type name: application<a href="#section-11.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.2">Subtype name: rat<a href="#section-11.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.3">Required parameters: n/a<a href="#section-11.1.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.4">Optional parameters: n/a<a href="#section-11.1.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.5">Encoding considerations: 8bit; application/rat values are
              encoded as a series of base64url-encoded values (some of which
              may be the empty string) separated by period ('.')
              characters..<a href="#section-11.1.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.6">Security considerations: See the Security Considerations
              Section of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>.<a href="#section-11.1.1-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.7">Interoperability considerations: n/a<a href="#section-11.1.1-2.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.8">Published specification: [THIS_DOCUMENT]<a href="#section-11.1.1-2.8" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.9">Applications that use this media type: DNS<a href="#section-11.1.1-2.9" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.10">Fragment identifier considerations: n/a<a href="#section-11.1.1-2.10" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.11">
              <p id="section-11.1.1-2.11.1">Additional information:<a href="#section-11.1.1-2.11.1" class="pilcrow">¶</a></p>
<p id="section-11.1.1-2.11.2"> Magic
              number(s): n/a File extension(s): n/a Macintosh file type
              code(s): n/a<a href="#section-11.1.1-2.11.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.1-2.12">Person &amp; email address to contact for further
              information: Tirumaleswar Reddy, kondtir@gmail.com<a href="#section-11.1.1-2.12" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.13">Intended usage: COMMON<a href="#section-11.1.1-2.13" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.14">Restrictions on usage: none<a href="#section-11.1.1-2.14" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.15">Author: Tirumaleswar Reddy, kondtir@gmail.com<a href="#section-11.1.1-2.15" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.16">Change Controller: IESG<a href="#section-11.1.1-2.16" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.1.1-2.17">Provisional registration? No<a href="#section-11.1.1-2.17" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="json-web-token-claims-registration">
<section id="section-11.2">
        <h3 id="name-json-web-token-claims-regis">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-json-web-token-claims-regis" class="section-name selfRef">JSON Web Token Claims Registration</a>
        </h3>
<div id="registry-contents-additions-requested">
<section id="section-11.2.1">
          <h4 id="name-registry-contents-additions">
<a href="#section-11.2.1" class="section-number selfRef">11.2.1. </a><a href="#name-registry-contents-additions" class="section-name selfRef">Registry Contents Additions Requested</a>
          </h4>
<p id="section-11.2.1-1">IANA is requested to assign the following claims in the registry
          maintained in: https://www.iana.org/assignments/jwt/jwt.xhtml.<a href="#section-11.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2.1-2.1">Claim Name: 'server'<a href="#section-11.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.2.1-2.2">Claim Description: DNS server identity<a href="#section-11.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.2.1-2.3">Change Controller: IESG<a href="#section-11.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.2.1-2.4">Specification Document(s): <a href="#server-identity" class="xref">Section 5.2.1</a> of [THIS_DOCUMENT]<a href="#section-11.2.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.2.1-2.5">Claim Name: 'resinfo'<a href="#section-11.2.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.2.1-2.6">Claim Description: Resolver information of DNS server.<a href="#section-11.2.1-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.2.1-2.7">Change Controller: IESG<a href="#section-11.2.1-2.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-11.2.1-2.8">Specification Document(s): <a href="#policyinfo" class="xref">Section 5.2.2</a>
              of [THIS_DOCUMENT]<a href="#section-11.2.1-2.8" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="resolver-information">
<section id="section-11.3">
        <h3 id="name-dns-resolver-information-re">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-dns-resolver-information-re" class="section-name selfRef">DNS Resolver Information Registration</a>
        </h3>
<p id="section-11.3-1">IANA will add the name "attested-resinfo" to the DNS Resolver
        Information registry defined in Section 7.2 of
        [I-D.reddy-add-resolver-info].<a href="#section-11.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-12">
      <h2 id="name-acknowledgments">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-12-1">This specification leverages some of the work that has been done in
      <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span>. Thanks to Tommy Jensen, Ted Lemon, Paul
      Wouters, Neil Cook, Vittorio Bertola, Vinny Parla, Chris Box, Ben
      Schwartz and Shashank Jain for the discussion and comments.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-add-ddr">[I-D.ietf-add-ddr]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">Wood, C. A.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"Discovery of Designated Resolvers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-add-ddr-03</span>, <time datetime="2021-10-01" class="refDate">1 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-add-ddr-03.txt">https://www.ietf.org/archive/id/draft-ietf-add-ddr-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-add-dnr">[I-D.ietf-add-dnr]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span>, <span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Cook, N.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"DHCP and Router Advertisement Options for the Discovery of Network-designated Resolvers (DNR)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-add-dnr-02</span>, <time datetime="2021-05-17" class="refDate">17 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-add-dnr-02.txt">https://www.ietf.org/archive/id/draft-ietf-add-dnr-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.reddy-add-resolver-info">[I-D.reddy-add-resolver-info]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span> and <span class="refAuthor">M. Boucadair</span>, <span class="refTitle">"DNS Resolver Information"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-reddy-add-resolver-info-03</span>, <time datetime="2021-04-13" class="refDate">13 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-reddy-add-resolver-info-03.txt">https://www.ietf.org/archive/id/draft-reddy-add-resolver-info-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6570">[RFC6570]</dt>
        <dd>
<span class="refAuthor">Gregorio, J.</span>, <span class="refAuthor">Fielding, R.</span>, <span class="refAuthor">Hadley, M.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">D. Orchard</span>, <span class="refTitle">"URI Template"</span>, <span class="seriesInfo">RFC 6570</span>, <span class="seriesInfo">DOI 10.17487/RFC6570</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6570">https://www.rfc-editor.org/info/rfc6570</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7493">[RFC7493]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The I-JSON Message Format"</span>, <span class="seriesInfo">RFC 7493</span>, <span class="seriesInfo">DOI 10.17487/RFC7493</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7493">https://www.rfc-editor.org/info/rfc7493</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7638">[RFC7638]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Key (JWK) Thumbprint"</span>, <span class="seriesInfo">RFC 7638</span>, <span class="seriesInfo">DOI 10.17487/RFC7638</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7638">https://www.rfc-editor.org/info/rfc7638</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Sullivan, A.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.btw-add-home">[I-D.btw-add-home]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span>, <span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Cook, N.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"DHCP and Router Advertisement Options for Encrypted DNS Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-btw-add-home-12</span>, <time datetime="2021-01-22" class="refDate">22 January 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-btw-add-home-12.txt">https://www.ietf.org/archive/id/draft-btw-add-home-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.btw-add-ipsecme-ike">[I-D.btw-add-ipsecme-ike]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span>, <span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Wing, D.</span>, and <span class="refAuthor">V. Smyslov</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2) Configuration for Encrypted DNS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-btw-add-ipsecme-ike-03</span>, <time datetime="2021-05-17" class="refDate">17 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-btw-add-ipsecme-ike-03.txt">https://www.ietf.org/archive/id/draft-btw-add-ipsecme-ike-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dnsop-terminology-ter">[I-D.ietf-dnsop-terminology-ter]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"Terminology for DNS Transports and Location"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnsop-terminology-ter-02</span>, <time datetime="2020-08-03" class="refDate">3 August 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-dnsop-terminology-ter-02.txt">https://www.ietf.org/archive/id/draft-ietf-dnsop-terminology-ter-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dprive-dnsoquic">[I-D.ietf-dprive-dnsoquic]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"Specification of DNS over Dedicated QUIC Connections"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dprive-dnsoquic-04</span>, <time datetime="2021-09-03" class="refDate">3 September 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-dprive-dnsoquic-04.txt">https://www.ietf.org/archive/id/draft-ietf-dprive-dnsoquic-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-architecture">[I-D.ietf-rats-architecture]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-architecture-12</span>, <time datetime="2021-04-23" class="refDate">23 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-rats-architecture-12.txt">https://www.ietf.org/archive/id/draft-ietf-rats-architecture-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7159">[RFC7159]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7159">https://www.rfc-editor.org/info/rfc7159</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7626">[RFC7626]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span>, <span class="refTitle">"DNS Privacy Considerations"</span>, <span class="seriesInfo">RFC 7626</span>, <span class="seriesInfo">DOI 10.17487/RFC7626</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7626">https://www.rfc-editor.org/info/rfc7626</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7816">[RFC7816]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span>, <span class="refTitle">"DNS Query Name Minimisation to Improve Privacy"</span>, <span class="seriesInfo">RFC 7816</span>, <span class="seriesInfo">DOI 10.17487/RFC7816</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7816">https://www.rfc-editor.org/info/rfc7816</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8225">[RFC8225]</dt>
        <dd>
<span class="refAuthor">Wendt, C.</span> and <span class="refAuthor">J. Peterson</span>, <span class="refTitle">"PASSporT: Personal Assertion Token"</span>, <span class="seriesInfo">RFC 8225</span>, <span class="seriesInfo">DOI 10.17487/RFC8225</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8225">https://www.rfc-editor.org/info/rfc8225</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Gillmor, D.</span>, and <span class="refAuthor">T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8310">https://www.rfc-editor.org/info/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8572">[RFC8572]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Farrer, I.</span>, and <span class="refAuthor">M. Abrahamsson</span>, <span class="refTitle">"Secure Zero Touch Provisioning (SZTP)"</span>, <span class="seriesInfo">RFC 8572</span>, <span class="seriesInfo">DOI 10.17487/RFC8572</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8572">https://www.rfc-editor.org/info/rfc8572</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8914">[RFC8914]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Hunt, E.</span>, <span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Hardaker, W.</span>, and <span class="refAuthor">D. Lawrence</span>, <span class="refTitle">"Extended DNS Errors"</span>, <span class="seriesInfo">RFC 8914</span>, <span class="seriesInfo">DOI 10.17487/RFC8914</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8914">https://www.rfc-editor.org/info/rfc8914</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UNICODE">[UNICODE]</dt>
      <dd>
<span class="refAuthor">The Unicode Consortium</span>, <span class="refTitle">"The Unicode Standard"</span>, <time datetime="2016-06-21" class="refDate">21 June 2016</time>, <span>&lt;<a href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="example-es256-based-pat-jws-serialization-and-signature">
<section id="appendix-A">
      <h2 id="name-example-of-es256-based-reat">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-example-of-es256-based-reat" class="section-name selfRef">Example of ES256-based REAT JWS Serialization and Signature</a>
      </h2>
<p id="appendix-A-1">For REAT, there will always be a JWS with the following members:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">'protected', with the value BASE64URL(UTF8(JWS Protected
          Header))<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">'payload', with the value BASE64URL (JWS Payload)<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">'signature', with the value BASE64URL(JWS Signature)<a href="#appendix-A-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-3">This example will follow the steps in JWS <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> Section 5.1, steps 1-6 and 8 and incorporates
      the additional serialization steps required for REAT.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">Step 1 for JWS references the JWS Payload, an example REAT Payload is
      as follows:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-5">
<pre>{
  "server":{
      "adn":"example.com"
  },
  "iat":1443208345,
  "exp":1443640345,
  "resinfo": {
     "qnameminimization":false
  }
}
</pre><a href="#appendix-A-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A-6">This would be serialized to the form (with line break used for
      display purposes only):<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-7">
<pre>{"exp":1443640345,"iat":1443208345,"resinfo":{
"qnameminimization":false},"server":{"adn":"example.com"}}
</pre><a href="#appendix-A-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A-8">Step 2 Computes the BASE64URL(JWS Payload) producing this value (with
      line break used for display purposes only):<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-9">
<pre>
eyJleHAiOjE0NDM2NDAzNDUsImlhdCI6MTQ0MzIwODM0NSwicmVzaW5mbyI6ey
JxbmFtZW1pbmltaXphdGlvbiI6ZmFsc2V9LCJzZXJ2ZXIiOnsiYWRuIjoiZXhh
bXBsZS5jb20ifX0


</pre><a href="#appendix-A-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A-10">For Step 3, an example REAT Protected Header comprising the JOSE
      Header is as follows:<a href="#appendix-A-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-11">
<pre>{
  "alg":"ES256",
  "typ":"rat",
  "x5u":"https://cert.example.com/rat.cer"
}
</pre><a href="#appendix-A-11" class="pilcrow">¶</a>
</div>
<p id="appendix-A-12">This would be serialized to the form (with line break used for
      display purposes only):<a href="#appendix-A-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-13">
<pre>
{"alg":"ES256","typ":"rat","x5u":"https://cert.example.com
/rat.cer"}
</pre><a href="#appendix-A-13" class="pilcrow">¶</a>
</div>
<p id="appendix-A-14">Step 4 Performs the BASE64URL(UTF8(JWS Protected Header)) operation
      and encoding produces this value (with line break used for display
      purposes only):<a href="#appendix-A-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-15">
<pre>
eyJhbGciOiJFUzI1NiIsInR5cCI6InJhdCIsIng1dSI6Imh0dHBzOi8vY2VydC5l
eGFtcGxlLmNvbS9yYXQuY2VyIn0


</pre><a href="#appendix-A-15" class="pilcrow">¶</a>
</div>
<p id="appendix-A-16">Step 5 and Step 6 performs the computation of the digital signature
      of the REAT Signing Input ASCII(BASE64URL(UTF8(JWS Protected Header)) ||
      '.' || BASE64URL(JWS Payload)) using ES256 as the algorithm
      and the BASE64URL(JWS Signature).<a href="#appendix-A-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-17">
<pre>

d1g7szj0roHsWe8psCzYVl4QdN2b7pQnq8EJhc4j3GOJj2NE6M9Em6aidtycnFJ5
mRj3ojiUfVF6rK5RksD0rg


</pre><a href="#appendix-A-17" class="pilcrow">¶</a>
</div>
<p id="appendix-A-18">Step 8 describes how to create the final REAT token, concatenating
      the values in the order Header.Payload.Signature with period
      ('.') characters. For the above example values this would
      produce the following (with line breaks between period used for
      readability purposes only):<a href="#appendix-A-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-19">
<pre>eyJhbGciOiJFUzI1NiIsInR5cCI6InJhdCIsIng1dSI6Imh0dHBzOi8vY2VydC5l
eGFtcGxlLmNvbS9yYXQuY2VyIn0
.

eyJhbGciOiJFUzI1NiIsInR5cCI6InJhdCIsIng1dSI6Imh0dHBzOi8vY2VydC5l
eGFtcGxlLmNvbS9yYXQuY2VyIn0
.
d1g7szj0roHsWe8psCzYVl4QdN2b7pQnq8EJhc4j3GOJj2NE6M9Em6aidtycnFJ5
mRj3ojiUfVF6rK5RksD0rg

</pre><a href="#appendix-A-19" class="pilcrow">¶</a>
</div>
<div id="x509-private-key-in-pkcs8-format-for-es256-example">
<section id="appendix-A.1">
        <h3 id="name-x509-private-key-in-pkcs8-f">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-x509-private-key-in-pkcs8-f" class="section-name selfRef">X.509 Private Key in PKCS#8 Format for ES256 Example**</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.1-1">
<pre>
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgevZzL1gdAFr88hb2
OF/2NxApJCzGCEDdfSp6VQO30hyhRANCAAQRWz+jn65BtOMvdyHKcvjBeBSDZH2r
1RTwjmYSi9R/zpBnuQ4EiMnCqfMPWiZqB4QdbAd0E7oH50VpuZ1P087G
-----END PRIVATE KEY-----
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="x509-public-key-for-es256-example">
<section id="appendix-A.2">
        <h3 id="name-x509-public-key-for-es256-e">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-x509-public-key-for-es256-e" class="section-name selfRef">X.509 Public Key for ES256 Example**</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.2-1">
<pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEVs/o5+uQbTjL3chynL4wXgUg2R9
q9UU8I5mEovUf86QZ7kOBIjJwqnzD1omageEHWwHdBO6B+dFabmdT9POxg==
-----END PUBLIC KEY-----
</pre><a href="#appendix-A.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="example-es256-based-pat-jws-serialization-and-signatures">
<section id="appendix-B">
      <h2 id="name-complete-jws-json-serializa">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-complete-jws-json-serializa" class="section-name selfRef">Complete JWS JSON Serialization Representation with multiple Signatures</a>
      </h2>
<p id="appendix-B-1">The JWS payload used in this example as follows.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>{
  "server":{
      "adn":"example.com"
  },
  "iat":1443208345,
  "exp":1443640345,
  "resinfo": {
     "qnameminimization":false
  }
}
</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B-3">This would be serialized to the form (with line break used for
      display purposes only):<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-4">
<pre>{"exp":1443640345,"iat":1443208345,"resinfo":{
"qnameminimization":false},"server":{"adn":"example.com"}}
</pre><a href="#appendix-B-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B-5"></p>
<p id="appendix-B-6">The JWS protected Header value used for the first signature is same
      as that used in the example in <a href="#example-es256-based-pat-jws-serialization-and-signature" class="xref">Appendix A</a>.
      The X.509 private key used for generating the first signature is same as
      that used in the example in <a href="#x509-private-key-in-pkcs8-format-for-es256-example" class="xref">Appendix A.1</a>.<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<p id="appendix-B-7">The JWS Protected Header value used for the second signature is:<a href="#appendix-B-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-8">
<pre>{
  "alg":"ES384",
  "typ":"rat",
  "x5u":"https://cert.audit-example.com/rat.cer"
}
</pre><a href="#appendix-B-8" class="pilcrow">¶</a>
</div>
<p id="appendix-B-9">The complete JWS JSON Serialization for these values is as follows
      (with line breaks within values for display purposes only):<a href="#appendix-B-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-10">
<pre>{
  "payload":
       "eyJhbGciOiJFUzI1NiIsInR5cCI6InJhdCIsIng1dSI6Imh0dHBzOi8vY2VydC5l
        eGFtcGxlLmNvbS9yYXQuY2VyIn0",
  "signatures":[
       {"protected":"eyJhbGciOiJFUzI1NiIsInR5cCI6InJhdCIsIng1dSI6Imh0dHBz
        Oi8vY2VydC5leGFtcGxlLmNvbS9yYXQuY2VyIn0",
        "signature":"d1g7szj0roHsWe8psCzYVl4QdN2b7pQnq8EJhc4j3GOJj2NE6M9E
        m6aidtycnFJ5mRj3ojiUfVF6rK5RksD0rg"},
       {"protected":"eyJhbGciOiJFUzM4NCIsInR5cCI6InJhdCIsIng1dSI6Imh0dHB
        zOi8vY2VydC5hdWRpdC1leGFtcGxlLmNvbS9yYXQuY2VyIn0",
        "signature":"GnKuEEFql_Y8HdZl_mqd027DlziGRXFHvjMoY_ukX-M0k5v2jSL
        vsQAYOGdKFnt3JY6t938HfBV1onsWerNhgceMJpx5hAsl-xus3fmNY8K1g6QK39
        hn2Dhbleeeyp0f"}]
}
</pre><a href="#appendix-B-10" class="pilcrow">¶</a>
</div>
<div id="x509-private-key-in-pkcs8-format-for-es384-example">
<section id="appendix-B.1">
        <h3 id="name-x509-private-key-in-pkcs8-fo">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-x509-private-key-in-pkcs8-fo" class="section-name selfRef">X.509 Private Key in PKCS#8 format for E384 Example**</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.1-1">
<pre>
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgevZzL1gdAFr88hb2
OF/2NxApJCzGCEDdfSp6VQO30hyhRANCAAQRWz+jn65BtOMvdyHKcvjBeBSDZH2r
1RTwjmYSi9R/zpBnuQ4EiMnCqfMPWiZqB4QdbAd0E7oH50VpuZ1P087G
-----END PRIVATE KEY-----
</pre><a href="#appendix-B.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="x509-public-key-for-es384-example">
<section id="appendix-B.2">
        <h3 id="name-x509-public-key-for-es384-e">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-x509-public-key-for-es384-e" class="section-name selfRef">X.509 Public Key for ES384 Example**</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.2-1">
<pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEVs/o5+uQbTjL3chynL4wXgUg2R9
q9UU8I5mEovUf86QZ7kOBIjJwqnzD1omageEHWwHdBO6B+dFabmdT9POxg==
-----END PUBLIC KEY-----
</pre><a href="#appendix-B.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Akamai</span></div>
<div dir="auto" class="left"><span class="street-address">Embassy Golf Link Business Park</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560071</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Wing</span></div>
<div dir="auto" class="left"><span class="org">Citrix Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dwing-ietf@fuggles.com" class="email">dwing-ietf@fuggles.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael C. Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mohamed Boucadair</span></div>
<div dir="auto" class="left"><span class="org">Orange</span></div>
<div dir="auto" class="left">
<span class="postal-code">35000</span> <span class="locality">Rennes</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mohamed.boucadair@orange.com" class="email">mohamed.boucadair@orange.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
