<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Session Initiation Protocol (SIP) Event Package for the Common Alerting
      Protocol (CAP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Session Initiation Protocol (SIP) Event Package for the Common Alerting
      Protocol (CAP)">
<meta name="keywords" content="Internet-Draft, CAP, Common Alerting Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIPPING</td><td class="header">B. Rosen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NeuStar, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">H. Schulzrinne</td></tr>
<tr><td class="header">Expires: January 14, 2010</td><td class="header">Columbia U.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 13, 2009</td></tr>
</table></td></tr></table>
<h1><br />Session Initiation Protocol (SIP) Event Package for the Common Alerting
      Protocol (CAP)<br />draft-rosen-sipping-cap-04.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 14, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The Common Alerting Protocol (CAP) is an XML document format for exchanging emergency
        alerts and public warnings. This document allows CAP documents to be distributed via the
        event notification mechanism available with the Session Initiation Protocol (SIP). 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#anchor1">3.</a>&nbsp;
The 'common-alerting-protocol' Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">3.1.</a>&nbsp;
Package Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.2.</a>&nbsp;
Event Package Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.3.</a>&nbsp;
SUBSCRIBE Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.4.</a>&nbsp;
Subscription Duration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.5.</a>&nbsp;
NOTIFY Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.6.</a>&nbsp;
Notifier Processing of SUBSCRIBE Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.7.</a>&nbsp;
Notifier Generation of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.8.</a>&nbsp;
Subscriber Processing of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.9.</a>&nbsp;
Handling of Forked Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.10.</a>&nbsp;
Rate of Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.11.</a>&nbsp;
State Agents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.12.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.13.</a>&nbsp;
Use of URIs to Retrieve State<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.14.</a>&nbsp;
PUBLISH Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">3.15.</a>&nbsp;
PUBLISH Response Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">3.16.</a>&nbsp;
Multiple Sources for Event State<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.17.</a>&nbsp;
Event State Segmentation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">3.18.</a>&nbsp;
Rate of Publication<br />
<a href="#example">4.</a>&nbsp;
Examples<br />
<a href="#sec-cons">5.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-stolen-assn">5.1.</a>&nbsp;
Man-in-the-Middle Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-forged-assn">5.2.</a>&nbsp;
Forgery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-replay-attack">5.3.</a>&nbsp;
Replay Attack<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-authorization">5.4.</a>&nbsp;
Unauthorized Distribution<br />
<a href="#iana">6.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.1.</a>&nbsp;
Registration of the 'common-alerting-protocol' Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.2.</a>&nbsp;
Registration of the 'application/common-alerting-protocol+xml' MIME type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">6.3.</a>&nbsp;
Early Warning Service URNs<br />
<a href="#anchor23">7.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">8.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> The Common Alerting Protocol (CAP) <a class='info' href='#cap'>[cap]<span> (</span><span class='info'>Jones, E. and A. Botterell, &ldquo;Common Alerting Protocol v. 1.1,&rdquo; October&nbsp;2005.</span><span>)</span></a> is an XML document format for
        exchanging emergency alerts and public warnings. This document allows CAP documents to be
        distributed via the event notification mechanism available with the Session Initiation
        Protocol (SIP). 
</p>
<p>Additionally, a MIME object is registered to allow CAP documents to be exchanged in other
        SIP documents.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
        RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
The 'common-alerting-protocol' Event Package</h3>

<p>RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> defines a SIP extension for subscribing to remote nodes
        and receiving notifications of changes (events) in their states. It leaves the definition of
        many aspects of these events to concrete extensions, known as event packages. This document
        defines such an event package. This section fills in the information required for all event
        packages by RFC 3265. 
</p>
<p> Additionally, RFC 3903 <a class='info' href='#RFC3903'>[RFC3903]<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> defines an extension that allows SIP User
        Agents to publish event state. According to RFC 3903, any event package intended to be used
        in conjunction with the SIP PUBLISH method has to include a considerations section. This
        section also fills the information for all event packages to be used with PUBLISH requests. 
</p>
<p>This document defines a new "common-alerting-protocol" event package. Event Publication
        Agents (EPA) use PUBLISH requests to inform an Event State Compositor (ESC) of changes in
        the common-alerting-protocol event package. Acting as a notifier, the ESC notifies
        subscribers about emergency alerts and public warnings. 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Package Name</h3>

<p> The name of this package is "common-alerting-protocol". As specified in RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, this value appears in the Event header field present in SUBSCRIBE
          and NOTIFY requests. As specified in RFC 3903 <a class='info' href='#RFC3903'>[RFC3903]<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a>, this value also
          appears in the Event header field present in PUBLISH requests. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Event Package Parameters</h3>

<p> RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> allows event packages to define additional parameters
          carried in the Event header field. This event package, "common-alerting-protocol", does
          not define additional parameters. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
SUBSCRIBE Bodies</h3>

<p>RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> allows a SUBSCRIBE request to contain a body. This
          document allows the body to contain the XML element &lt;warning-registration&gt;
          with the following child elements:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Civic and geodetic location information:</dt>
<dd> The 2D location shapes listed in
                <a class='info' href='#I-D.ietf-geopriv-pdif-lo-profile'>[I&#8209;D.ietf&#8209;geopriv&#8209;pdif&#8209;lo&#8209;profile]<span> (</span><span class='info'>Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations,&rdquo; November&nbsp;2008.</span><span>)</span></a> (e.g., &lt;Point&gt;
              &lt;Polygon&gt;, &lt;Circle&gt;, &lt;Ellipse&gt;,
              &lt;ArcBand&gt;) and the &lt;civicAddress&gt; element, defined in
                <a class='info' href='#RFC5139'>[RFC5139]<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO),&rdquo; February&nbsp;2008.</span><span>)</span></a>. Repeating these elements is allowed and the semantic is
              equivalent to a union. <br />

            
</dd>
<dt>Type of Warning Message:</dt>
<dd> One or more &lt;service&gt; elements
              that contain Service URNs <a class='info' href='#RFC5031'>[RFC5031]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;A Uniform Resource Name (URN) for Emergency and Other Well-Known Services,&rdquo; January&nbsp;2008.</span><span>)</span></a> may be added as a child element of
              the &lt;warning-registration&gt; element. They Service URNs indicate the type
              of alerts the recipient is interested in. The registered alerts can be found in <a class='info' href='#iana'>Section&nbsp;6<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
        
</p>
<p> An example of such a body can be found below. 
</p>
<p>
          <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;warning-registration&gt;
    &lt;civicAddress
     xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"&gt;
        &lt;country&gt;DE&lt;/country&gt;
    &lt;/civicAddress&gt;
    &lt;service&gt;urn:service:warning:security&lt;/service&gt;
&lt;/warning-registration&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Example of a SIP SUBSCRIBE Body&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Subscription Duration</h3>

<p>The default expiration time for subscriptions within this package is 3600 seconds. As per
          RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, the subscriber MAY specify an alternate expiration in
          the Expires header field. 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
NOTIFY Bodies</h3>

<p> As described in RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, the NOTIFY message will contain
          bodies describing the state of the subscribed resource. This body is in a format listed in
          the Accept header field of the SUBSCRIBE request, or a package-specific default format if
          the Accept header field was omitted from the SUBSCRIBE request. 
</p>
<p> In this event package, the body of the notification contains a Common Alerting Protocol
          (CAP) document, i.e., an XML document. The format of the XML documents used by CAP are
          described in <a class='info' href='#cap'>[cap]<span> (</span><span class='info'>Jones, E. and A. Botterell, &ldquo;Common Alerting Protocol v. 1.1,&rdquo; October&nbsp;2005.</span><span>)</span></a>. 
</p>
<p>For an initial notify, unlike for other event packages, there is no current initial
          state, unless there's a pending alert. Hence, returning a NOTIFY with a non-empty body
          only makes sense if there are indeed active alerts.
</p>
<p> All subscribers and notifiers of the "common-alerting-protocol" event package MUST
          support the "application/common-alerting-protocol+xml" data format. The SUBSCRIBE request
          MAY contain an Accept header field. If no such header field is present, it has a default
          value of "application/common-alerting-protocol+xml" (assuming that the Event header field
          contains a value of "common-alerting-protocol"). If the Accept header field is present, it
          MUST include "application/common-alerting-protocol+xml". 
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Notifier Processing of SUBSCRIBE Requests</h3>

<p> The contents of a CAP document may contain public information, depending on the alert
          message type and the intended recipient of the alert message. It is, however, expected
          that in many cases providing CAP documents does not require authorization by subscribers.
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Notifier Generation of NOTIFY Requests</h3>

<p> RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> details the formatting and structure of NOTIFY
          messages. However, packages are mandated to provide detailed information on when to send a
          NOTIFY, how to compute the state of the resource, how to generate neutral or fake state
          information, and whether state information is complete or partial. This section describes
          those details for the common-alerting-protocol event package. 
</p>
<p> A notifier MAY send a NOTIFY at any time. Typically, it will send one when an alert or
          early warning message is available. The NOTIFY request contains a body containing one or
          multiple CAP document(s). The times at which the NOTIFY is sent for a particular
          subscriber, and the contents of the body within that notification, are subject to any
          rules specified by the authorization policy that governs the subscription. 
</p>
<p> In the case of a pending subscription, when final authorization is determined, a NOTIFY
          can be sent. If the result of the authorization decision was success, a NOTIFY SHOULD be
          sent and SHOULD contain a complete CAP document. If the subscription is rejected, a NOTIFY
          MAY be sent. As described in RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, the Subscription-State
          header field indicates the state of the subscription. 
</p>
<p>The body of the NOTIFY MUST be sent using one of the types listed in the Accept header
          field in the most recent SUBSCRIBE request, or using the type
          "application/common-alerting-protocol+xml" if no Accept header field was present.
</p>
<p> Notifiers will typically act as Event State Compositors (ESC) and thus will learn the
          'common-alerting-protocol' event state via PUBLISH requests sent from authorized Event
          Publication Agents (EPAs). 
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Subscriber Processing of NOTIFY Requests</h3>

<p> RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> leaves it to event packages to describe the process
          followed by the subscriber upon receipt of a NOTIFY request, including any logic required
          to form a coherent resource state. 
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Handling of Forked Requests</h3>

<p> RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> requires each package to describe handling of forked
          SUBSCRIBE requests. 
</p>
<p> This specification only allows a single dialog to be constructed as a result of emitting
          an initial SUBSCRIBE request. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.10"></a><h3>3.10.&nbsp;
Rate of Notifications</h3>

<p> RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> requires each package to specify the maximum rate at
          which notifications can be sent. 
</p>
<p> Notifiers SHOULD NOT generate notifications for a single user at a rate of more than
          once every five seconds. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.11"></a><h3>3.11.&nbsp;
State Agents</h3>

<p> RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> requires each package to consider the role of state
          agents in the package and, if they are used, to specify how authentication and
          authorization are done. This specification allows state agents to be located in the
          network.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.12"></a><h3>3.12.&nbsp;
Examples</h3>

<p>An example is provided in <a class='info' href='#example'>Section&nbsp;4<span> (</span><span class='info'>Examples</span><span>)</span></a>. 
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.13"></a><h3>3.13.&nbsp;
Use of URIs to Retrieve State</h3>

<p> RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> allows packages to use URIs to retrieve large state
          documents. 
</p>
<p> CAP documents are fairly small. This event package does not provide a mechanism to use
          URIs to retrieve large state documents. 
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.14"></a><h3>3.14.&nbsp;
PUBLISH Bodies</h3>

<p>RFC 3903 <a class='info' href='#RFC3903'>[RFC3903]<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> requires event packages to define the content types
          expected in PUBLISH requests. 
</p>
<p> In this event package, the body of a PUBLISH request may contain a CAP document. A CAP
          document describes an emergency alert or an early warning event. 
</p>
<p> All EPAs and ESCs MUST support the "application/common-alerting-protocol+xml" data
          format and MAY support other formats. 
</p>
<p>Note that this document does not mandate how CAP documents are made available to the
          Public Warning System, for example by authorities or similar organizations. The PUBLISH
          mechanism is one way.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.15"></a><h3>3.15.&nbsp;
PUBLISH Response Bodies</h3>

<p> This specification assumes that a PUBLISH also conveys a CAP document that is later sent
          further on to watchers. 
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.16"></a><h3>3.16.&nbsp;
Multiple Sources for Event State</h3>

<p> RFC 3903 <a class='info' href='#RFC3903'>[RFC3903]<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> requires event packages to specify whether multiple
          sources can contribute to the event state view at the ESC. 
</p>
<p> This event package allows different EPAs to publish CAP documents for a particular user.
          The concept of composition is not applicable for this application usage.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.17"></a><h3>3.17.&nbsp;
Event State Segmentation</h3>

<p> RFC 3903 <a class='info' href='#RFC3903'>[RFC3903]<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> defines segments within a state document. Each segment
          is defined as one of potentially many identifiable sections in the published event state. 
</p>
<p> This event package defines does not differentiate between different segments. 
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.18"></a><h3>3.18.&nbsp;
Rate of Publication</h3>

<p> RFC 3903 <a class='info' href='#RFC3903'>[RFC3903]<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> allows event packages to define their own rate of
          publication. 
</p>
<p> There are no rate-limiting recommendations for common-alerting-protocol publication.
          Since emergency alerts and early warning events are typically rare there is no
          periodicity, nor a minimum or maximum rate of publication. 
</p>
<a name="example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Examples</h3>

<p>Here is an example of a CAP document.
</p>
<p>
        <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;alert xmlns="urn:oasis:names:tc:emergency:cap:1.1"&gt;
    &lt;identifier&gt;KSTO1055887203&lt;/identifier&gt;
    &lt;sender&gt;KSTO@NWS.NOAA.GOV&lt;/sender&gt;
    &lt;sent&gt;2003-06-17T14:57:00-07:00&lt;/sent&gt;
    &lt;status&gt;Actual&lt;/status&gt;
    &lt;msgType&gt;Alert&lt;/msgType&gt;
    &lt;scope&gt;Public&lt;/scope&gt;
    &lt;info&gt;
        &lt;category&gt;Met&lt;/category&gt;
        &lt;event&gt;SEVERE THUNDERSTORM&lt;/event&gt;
        &lt;urgency&gt;Severe&lt;/urgency&gt;
        &lt;certainty&gt;Likely&lt;/certainty&gt;
        &lt;senderName&gt;NATIONAL WEATHER SERVICE SACRAMENTO&lt;/senderName&gt;
        &lt;headline&gt;SEVERE THUNDERSTORM WARNING&lt;/headline&gt;
        &lt;description&gt; AT 254 PM PDT...
            NATIONAL WEATHER SERVICE
            DOPPLER RADAR INDICATED A SEVERE
            THUNDERSTORM OVER SOUTH CENTRAL ALPINE COUNTY...
            OR ABOUT 18 MILES SOUTHEAST OF
            KIRKWOOD... MOVING SOUTHWEST AT 5 MPH. HAIL...
            INTENSE RAIN AND STRONG DAMAGING WINDS
            ARE LIKELY WITH THIS STORM &lt;/description&gt;
        &lt;instruction&gt; TAKE COVER IN A SUBSTANTIAL SHELTER
            UNTIL THE STORM PASSES &lt;/instruction&gt;
        &lt;contact&gt;BARUFFALDI/JUSKIE&lt;/contact&gt;
        &lt;area&gt;
            &lt;areaDesc&gt; EXTREME NORTH CENTRAL TUOLUMNE COUNTY
                IN CALIFORNIA, EXTREME NORTHEASTERN
                CALAVERAS COUNTY IN CALIFORNIA, SOUTHWESTERN
                ALPINE COUNTY IN CALIFORNIA &lt;/areaDesc&gt;
            &lt;polygon&gt; 38.47,-120.14 38.34,-119.95 38.52,-119.74
                38.62,-119.89 38.47,-120.14 &lt;/polygon&gt;
        &lt;/area&gt;
    &lt;/info&gt;
&lt;/alert&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Example for a Severe Thunderstorm Warning&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<a name="sec-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p> This section discusses security considerations when using SIP to distribute warning
        messages using CAP. 
</p>
<a name="sec-cons-stolen-assn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Man-in-the-Middle Attacks</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
              <br />
 The attacker could then conceivably attempt to impersonate
              the subject (the putative caller) to some SIP-based target entity. <br />
<br />

            
</dd>
<dt>Countermeasures:</dt>
<dd>
              <br />
 Such an attack is implausible for several reasons. The
              subject's assertion: 
<ul class="text">
<li> should be signed, thus causing any alterations to break its integrity and make
                  such alterations detectable. 
</li>
<li> the intended recipients may be listed in the optionally present audience
                  restriction, which is a cleartext field. As such, it would not allow automatic
                  processing but could give the receiving user further hints.
</li>
<li> Issuer is represented in the CAP document (in the &lt;sender&gt;
                  element). 
</li>
<li> validity period for the CAP document may be restricted. 
</li>
</ul>
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="sec-cons-forged-assn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Forgery</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
              <br />
 A malicious user could forge or alter a CAP document in order
              to convey messages to SIP entities that get immediate attention of users.<br />
<br />

            
</dd>
<dt>Countermeasures:</dt>
<dd>
              <br />
 To avoid this kind of attack, the entities must assure that
              proper mechanisms for protecting the CAP documents are employed, e.g., signing the CAP
              document itself. Section 3.3.2.1 of <a class='info' href='#cap'>[cap]<span> (</span><span class='info'>Jones, E. and A. Botterell, &ldquo;Common Alerting Protocol v. 1.1,&rdquo; October&nbsp;2005.</span><span>)</span></a> specifies the signing of CAP
              documents. 
</dd>
</dl></blockquote><p>
        
</p>
<a name="sec-cons-replay-attack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Replay Attack</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
              <br />
 Theft of CAP documents described in this document and replay
              of it at a later time. <br />
<br />

</dd>
<dt>Countermeasures:</dt>
<dd>
              <br />
 A CAP document contains the mandatory
              &lt;identifier&gt;, &lt;sender&gt;, &lt;sent&gt; elements and
              an optional &lt;expire&gt; element. These attributes make the CAP document
              unique for a specific sender and provide time restrictions. An entity that has
              received a CAP message already within the indicated timeframe is able to detect a
              replayed message and, if the content of that message is unchanged, then no additional
              security vulnerability is created. Nodes that enter the area of a disaster after the
              initial distribution of warnings have not yet seen the CAP message and, as such, would
              not be able to distinguish a replay from the initial message being sent around.
              However, if the threat that lead to the distribution of warning messages is still
              imminent then there is no reason not to worry about that message. The source
              distributing the early warning messages is, however, adviced to carefully select a
              value for the &lt;expires&gt; element and it is RECOMMENDED to set this
              element. 
</dd>
</dl></blockquote><p>
        
</p>
<a name="sec-cons-authorization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Unauthorized Distribution</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
              <br />
 When an entity receives a CAP message it has to determine
              whether the entity distributing the CAP messages is genuine to avoid accepting
              messages that are injected by malicious users with the potential desire to at least
              get the users immediate attention. <br />
<br />

</dd>
<dt>Countermeasures:</dt>
<dd>
              <br />
 When receiving a CAP document a couple of verification steps
              must be performed. First, it needs to be ensured that the message was delivered via a
              trusted entitiy (such as a trusted SIP proxy) and that the communication channel
              between the User Agent and it's SIP proxy is properly secured to exclude various
              attacks at the SIP level. Then, the message contains the &lt;sender&gt; that
              may contain an entity that falls within the white list of the entity receiving the
              message. Finally, the message is protected by a digital signature and the entity
              signing the CAP message may again be listed in a white list of the receiving entity
              and may therefore be trusted. If none of these verification checks lead to a positive
              indication of a known sender then the CAP document should be treated as suspicious and
              configuration at the receiving entity may dictate how to process and display CAP
              documents in such a case. 
</dd>
</dl></blockquote><p>
        
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Registration of the 'common-alerting-protocol' Event Package</h3>

<p> This specification registers an event package, based on the registration procedures
          defined in RFC 3265 <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. The following is the information required
          for such a registration: </p>
<blockquote class="text"><dl>
<dt>Package Name:</dt>
<dd> common-alerting-protocol 
</dd>
<dt>Package or Template-Package:</dt>
<dd> This is a package. 
</dd>
<dt>Published Document:</dt>
<dd> RFC XXX [Replace by the RFC number of this
              specification]. 
</dd>
<dt>Person to Contact:</dt>
<dd> Hannes Tschofenig, Hannes.Tschofenig@nsn.com
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Registration of the 'application/common-alerting-protocol+xml' MIME type</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>To:</dt>
<dd> ietf-types@iana.org 
</dd>
<dt>Subject:</dt>
<dd>Registration of MIME media type application/
              common-alerting-protocol+xml
</dd>
<dt>MIME media type name:</dt>
<dd> application 
</dd>
<dt>MIME subtype name:</dt>
<dd>common-alerting-protocol+xml 
</dd>
<dt>Required parameters:</dt>
<dd> (none) 
</dd>
<dt>Optional parameters:</dt>
<dd> charset; Indicates the character encoding of
              enclosed XML. Default is UTF-8 <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a>.
</dd>
<dt>Encoding considerations:</dt>
<dd> Uses XML, which can employ 8-bit characters,
              depending on the character encoding used. See RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>,
              Section 3.2.
</dd>
<dt>Security considerations:</dt>
<dd> This content type is designed to carry payloads
              of the Common Alerting Protocol (CAP). 
</dd>
<dt>Interoperability considerations:</dt>
<dd> This content type provides a way to
              convey CAP payloads. 
</dd>
<dt>Published specification:</dt>
<dd> RFC XXX [Replace by the RFC number of this
              specification]. 
</dd>
<dt>Applications which use this media type:</dt>
<dd> Applications that convey alerts
              and early warnings according to the CAP standard.
</dd>
<dt>Additional information:</dt>
<dd> OASIS has published the Common Alerting Protocol
              at <a class='info' href='#cap'>[cap]<span> (</span><span class='info'>Jones, E. and A. Botterell, &ldquo;Common Alerting Protocol v. 1.1,&rdquo; October&nbsp;2005.</span><span>)</span></a>.
</dd>
<dt>Person &amp; email address to contact for further information:</dt>
<dd> Hannes
              Tschofenig, Hannes.Tschofenig@nsn.com 
</dd>
<dt>Intended usage:</dt>
<dd> Limited use 
</dd>
<dt>Author/Change controller:</dt>
<dd> IETF SIPPING working group 
</dd>
<dt>Other information:</dt>
<dd> This media type is a specialization of application/xml
              RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>, and many of the considerations described there also
              apply to application/common-alerting-protocol+xml. 
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Early Warning Service URNs</h3>

<p>In according with RFC 5031 this document defines a new top-level service called
          'warning'. This section defines the first service registration within the IANA registry
          using the top-level service label 'warning'. 
</p>
<p> The 'warning' service type describes emergency services requiring an immediate action or
          remedy by the recipient of the alert message as instructed by the author of the message.
          Additional sub-services can be added after expert review and must be of general public
          interest and have a similar emergency nature. The expert is designated by the ECRIT
          working group, its successor, or, in their absence, the IESG. The expert review should
          only approve emergency services that are offered widely and in different countries, with
          approximately the same caller expectation in terms of services rendered. 
</p>
<p> The following list contains the initial IANA registration for the 'warning' service. 
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>warning.geo</dt>
<dd> Geophysical (inc. landslide) 
</dd>
<dt>warning.met</dt>
<dd> Meteorological (inc. flood) 
</dd>
<dt>warning.safety</dt>
<dd> General emergency and public safety 
</dd>
<dt>warning.security</dt>
<dd>Law enforcement, military, homeland and local/private
              security 
</dd>
<dt>warning.rescue</dt>
<dd> Rescue and recovery 
</dd>
<dt>warning.fire</dt>
<dd>Fire suppression and rescue 
</dd>
<dt>warning.health</dt>
<dd> Medical and public health 
</dd>
<dt>warning.env</dt>
<dd>Pollution and other environmental 
</dd>
<dt>warning.transport</dt>
<dd>Public and private transportation 
</dd>
<dt>warning.infra</dt>
<dd> Utility, telecommunication, other non-transport
              infrastructure 
</dd>
<dt>warning.cbrne</dt>
<dd>Chemical, Biological, Radiological, Nuclear or High-Yield
              Explosive threat or attack 
</dd>
<dt>warning.other</dt>
<dd>Other events 
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgments</h3>

<p>The authors would like to thank Cullen Jennings for supporting this work. We would also
        like to thank the participants of the Early Warning Adhoc meeting at IETF#69.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="cap">[cap]</a></td>
<td class="author-text">Jones, E. and A. Botterell, &ldquo;<a href="http://www.oasis-open.org/apps/org/workgroup/emergency/download.php/14205/emergency-CAPv1.1-Committee%20Specification.pdf">Common Alerting Protocol v. 1.1</a>,&rdquo; October&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3903">[RFC3903]</a></td>
<td class="author-text">Niemi, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3903">Session Initiation Protocol (SIP) Extension for Event State Publication</a>,&rdquo; RFC&nbsp;3903, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3903.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3023">[RFC3023]</a></td>
<td class="author-text">Murata, M., St. Laurent, S., and D. Kohn, &ldquo;<a href="http://tools.ietf.org/html/rfc3023">XML Media Types</a>,&rdquo; RFC&nbsp;3023, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3023.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-pdif-lo-profile">[I-D.ietf-geopriv-pdif-lo-profile]</a></td>
<td class="author-text">Winterbottom, J., Thomson, M., and H. Tschofenig, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-pdif-lo-profile-14.txt">GEOPRIV PIDF-LO Usage Clarification, Considerations and Recommendations</a>,&rdquo; draft-ietf-geopriv-pdif-lo-profile-14 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-pdif-lo-profile-14.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5139">[RFC5139]</a></td>
<td class="author-text">Thomson, M. and J. Winterbottom, &ldquo;<a href="http://tools.ietf.org/html/rfc5139">Revised Civic Location Format for Presence Information Data Format Location Object (PIDF-LO)</a>,&rdquo; RFC&nbsp;5139, February&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5139.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5031">[RFC5031]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc5031">A Uniform Resource Name (URN) for Emergency and Other Well-Known Services</a>,&rdquo; RFC&nbsp;5031, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5031.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Rosen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NeuStar, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">470 Conrad Dr</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mars, PA  16046</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:br@brianrosen.net">br@brianrosen.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henning Schulzrinne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">450 Computer Science Building</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">New York, NY  10027</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 212 939 7004</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hgs+ecrit@cs.columbia.edu">hgs+ecrit@cs.columbia.edu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cs.columbia.edu">http://www.cs.columbia.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
</table>
</body></html>
