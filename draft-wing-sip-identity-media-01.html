<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SIP Identity using Media
    Path</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SIP Identity using Media
    Path">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Wing</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status:  Standards Track</td><td class="header">H. Kaplan</td></tr>
<tr><td class="header">Expires:  May 18, 2008</td><td class="header">Acme Packet</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 15, 2007</td></tr>
</table></td></tr></table>
<h1><br />SIP Identity using Media
    Path<br />draft-wing-sip-identity-media-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 18, 2008.</p>

<h3>Abstract</h3>

<p>The existing SIP identity mechanism (RFC4474) creates a signature
      over the SIP body, including the entire SDP. As part of their normal
      operation, Session Border Controllers (SBCs) and SIP Back-to-Back User
      Agents (B2BUAs) modify various fields in the SDP which breaks that
      signature.
</p>
<p>This document defines a new identity mechanism which operates with
      SBCs and B2BUAs. This new identity mechanism creates a signature over
      certain SIP headers and certain SDP lines, and uses both SIP signaling
      and the media path to perform its identity function.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Notational Conventions<br />
<a href="#anchor3">3.</a>&nbsp;
Analysis of SIP-Identity with SBCs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sip-identity-with-sbc">3.1.</a>&nbsp;
SIP-Identity with SBCs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.1.</a>&nbsp;
Validate the Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.2.</a>&nbsp;
Destroy Existing Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.3.</a>&nbsp;
Create New Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.4.</a>&nbsp;
Sign the New Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transport-address-identifier">3.2.</a>&nbsp;
Transport Address as Identifier<br />
<a href="#anchor8">4.</a>&nbsp;
Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#identity_media_signature">4.1.</a>&nbsp;
Identity Media Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.</a>&nbsp;
Authentication Service<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.3.</a>&nbsp;
Validation<br />
<a href="#techniques">5.</a>&nbsp;
Proof of Identity Techniques<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.1.</a>&nbsp;
TLS <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.2.</a>&nbsp;
DTLS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.2.1.</a>&nbsp;
SRTP after DTLS optional<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ice_extension">5.3.</a>&nbsp;
ICE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.3.1.</a>&nbsp;
ICE Public Key SDP Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.3.2.</a>&nbsp;
New STUN attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.4.</a>&nbsp;
HIP<br />
<a href="#abnf">6.</a>&nbsp;
ABNF<br />
<a href="#security_considerations">7.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">7.1.</a>&nbsp;
Device Disclosure<br />
<a href="#anchor20">8.</a>&nbsp;
Operational Differences from RFC4474<br />
<a href="#anchor21">9.</a>&nbsp;
Limitations<br />
<a href="#examples">10.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">10.1.</a>&nbsp;
DTLS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">10.2.</a>&nbsp;
ICE<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">10.3.</a>&nbsp;
Request without SDP<br />
<a href="#anchor25">11.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor26">12.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informational References<br />
<a href="#anchor29">Appendix&nbsp;A.</a>&nbsp;
ToDo List<br />
<a href="#anchor30">Appendix&nbsp;B.</a>&nbsp;
Changes From Previous Versions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">B.1.</a>&nbsp;
Changes from 00 to 01<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p><a class='info' href='#RFC4474'>SIP Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] provides cryptographic
      identity for SIP requests. It provides this protection by signing
      certain SIP header fields (Contact, Date, Call-ID, CSeq, To, and From)
      and the SIP message body. The SIP message body typically contains the
      SDP.
</p>
<p>In cases where the originating, authenticating domain directly
      connect to the terminating, validating domain, RFC4474 has questionable
      value. The reason is that in such cases TLS can simply be used for the
      communication between the edge proxies of each domain, which not only
      provides additional security properties (e.g., encryption), but is also
      more efficient and protects all signaling messages. The real value of
      RFC4474 lies in cases where SIP signaling crosses multiple domains,
      belonging to different organizations. Unfortunately, in the presence of
      SBCs or B2BUAs that are in a different trust domain than the calling
      party or called party, SIP Identity provides the same security
      properties as using <a class='info' href='#RFC3325'>P-Asserted-Identity<span> (</span><span class='info'>Jennings, C., Peterson, J., and M. Watson, &ldquo;Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks,&rdquo; November&nbsp;2002.</span><span>)</span></a> [RFC3325]
      between those same trust domains, if it succeeds at all. In most cases
      it would probably fail, and force the UAC to re-send its request without
      any Identity mechanism if it wanted to establish communication.
</p>
<p>The mechanism described in this document provides cryptographic
      assurance of the endpoint's identity by signing certain SIP headers,
      much like RFC4474. However, unlike RFC4474 which signs the entire SDP,
      the mechanism described in this document signs only certain SDP
      attributes, and not all the same SIP headers. The remote endpoint is
      expected to validate the signature over the SIP headers and specified
      SDP attributes, to initiate a proof of possession test over the media
      path, which proves the session has been established with the "From:"
      party in the SIP header. Mechanisms to perform this proof of possession
      are shown using DTLS and using a small extension to <a class='info' href='#I-D.ietf-mmusic-ice'>ICE<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mmusic&#8209;ice]. This mechanism is also
      extensible, in order to be usable by future mechanisms which need signed
      SDP attributes
</p>
<p>Readers of this document are expected to be familiar with RFC4474,
      "Enhancements for Authenticated Identity Management in the Session
      Initiation Protocol (SIP)", which defines the Identity and Identity-Info
      header fields. A future version of this document will have less reliance
      on RFC4474.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Notational Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Analysis of SIP-Identity with SBCs</h3>

<p>This section examines how <a class='info' href='#RFC4474'>SIP Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474]
      operates with SBCs(<a class='info' href='#sip-identity-with-sbc'>Section&nbsp;3.1<span> (</span><span class='info'>SIP-Identity with SBCs</span><span>)</span></a>) or
      certain back-to-back user-agents (B2BUAs), and how SIP Identity uses
      transport addresses as identifiers (<a class='info' href='#transport-address-identifier'>Section&nbsp;3.2<span> (</span><span class='info'>Transport Address as Identifier</span><span>)</span></a>).
</p>
<a name="sip-identity-with-sbc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
SIP-Identity with SBCs</h3>

<p>After an authorization agent signs a SIP request, the SIP request
        traverses SBC(s) operated by other trust domains and finally arrives
        at the destination domain. If all of those intervening SBCs support
        SIP Identity, those SBCs will validate the request's signature,
        destroy the existing signature, create a new identity for the request,
        and sign the request's new identity. These necessary SBC actions
        (described in detail below) provide the same identity assurance as
        using P-Asserted-Identity between trust domains.
</p>
<p>The functions of SBCs, and why they do what they do, is mainly
        detailed in <a class='info' href='#I-D.ietf-sipping-sbc-funcs'>[I&#8209;D.ietf&#8209;sipping&#8209;sbc&#8209;funcs]<span> (</span><span class='info'>Hautakorpi, J., Camarillo, G., Penfield, B., Hawrylyshen, A., and M. Bhatia, &ldquo;Requirements from Session Initiation Protocol (SIP) Session Border Control (SBC) Deployments,&rdquo; February&nbsp;2010.</span><span>)</span></a>.
        Regardless of the architectural implications of their actions, the
        fact is their functions are often performed as a SIP request/response
        traverses across SIP domains. Other B2BUAs in the path sometimes also
        perform functions which invalidate an RFC4474 signature. With regard
        to RFC4474, the SBC functions which impact the signature are:
</p>
<p></p>
<ul class="text">
<li>Replacing IP addresses in SDP body parts
</li>
<li>Replacing the Contact URI
</li>
<li>Modifying the Call-ID
</li>
<li>Modifying the CSeq
</li>
</ul>
<br /><hr class="insert" />
<a name="without_enterprise_sbc"></a>

<p>The following diagram shows two service providers (SP1 and
          SP2), and each has an SBC at the edge of their respective networks.
          Each of these SBCs would rewrite the IP addresses in the SDP. There
          may be an SBC in the Enterprise as well, however that SBC would own
          the appropriate Enterprise domain certificate and re-sign the
          request, and thus logically appear as the Enterprise User
          Agent
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+---------+ +---------+  +---------+  +---------+
|SP1-SBC-1|-|SP1-SBC-2|--|SP2-SBC-1|--|SP2-SBC-2|
+---+-----+ +---------+  +---------+  +-+-------+
    |                                   |
    |                                   |
+--------------+                 +------+-------+
|SIP User Agent|                 |SIP User Agent|
| Enterprise-A |                 | Enterprise-B |
+--------------+                 +--------------+</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Two Service Providers with SBCs Between Two Enterprises&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Enterprise-A can populate the "From:" address in its SIP requests
        using E.164 telephone numbers (e.g.,
        'sip:+17005551008@example.com;user=phone') or using a SIP URI (e.g.,
        'sip:john.doe@example.com'). The characteristics of each choice, as
        the message traverses the SBCs operated by another administrative
        domain (service providers) are described below:
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Validate the Signature</h3>

<p>Per RFC4474, the SBC would validate the incoming SIP request.
          This requires a public key operation to be performed against the SIP
          request.
</p>
<p>[[computationally expensive. Will use TLS or IPSEC instead
          (doesn't require public key operation for every SIP request), or
          will rely on ACLs or a dedicated link or dedicated network.]]
</p>
<p>This creates a natural incentive for the service providers to use
          transitive trust between themselves, rather than RFC4474, due to the
          computational expense of the per-call public key operations on each
          SIP request. For similar reasons, there is a natural incentive for
          the service providers to not even validate an enterprise's RFC4474
          signature but rather to rely on a contract or rely on TLS or IPSEC
          to ensure the SIP signaling originated from the enterprise. Since
          service providers do not allow Enterprises to be transitive domains,
          they only allow From-URI domains of the enterprise, and thus do not
          need a per-request 4474-style signature from the Enterprise at the
          first ingress hop.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Destroy Existing Signature</h3>

<p>SBCs and B2BUAs typically modify the media transport addresses
          and thus invalidate the RFC4474 signature. This prevents downstream
          systems from validating original signature.
</p>
<p>Because the original signature is invalidated by the first SBC,
          no other network (SP2 nor Enterprise-B) can validate the original
          signature. This means all downstream entities (in the example above,
          SP2 and Enterprise-B) are relying wholly on SP1 to validate the
          signature. This creates transitive trust which is undesirable - a
          single bad actor or compromised system anywhere along the path can
          compromise the entire identity system. Note this does not require
          malicious intent within the trust domain - a weak or mis-configured
          entry point into the trust chain of service providers compromises
          the entire trust chain.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Create New Identity</h3>

<p>In order to generate a SIP Identity signature (in the next step),
          the SBC requires the private key associated with the domain of that
          From: address. Because the SBC and the initiator of the SIP request
          are different entities, it is unlikely the SBC will possess the
          initiating domain's private key. Thus, the SBC will have to create a
          new identity -- using its domain -- for the request, if it wants to
          provide RFC4474.
</p>
<p>The new identity creates difficulties with downstream whitelists,
          call routing, and reputation systems. For example, downstream
          systems may sometimes see the identity +14085551212@example.com when
          the request is routed through certain SBCs, and may see a different
          identity, +14085551212@example.net, when the request is routed
          through different SBCs. Such different routing might be done due to
          network outages or for cost savings (e.g., evening rates). Due to
          these different identities, the domain name no longer has much
          meaning -- for E.164 telephone numbers, the user-part becomes the
          entire identity. In some sense that's appropriate; if the user-part
          is truly a global-scope E.164 number, then the domain portion is
          essentially meaningless. It might as well have been a tel-URI,
          except that making it a SIP-URI is more common and allows rfc4474 to
          be used.
</p>
<p>A SBC might receive an identity containing an E.164 phone number
          or containing a SIP URI. When forming a new identity, the SBC
          performs different steps for each of those cases:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>E.164 telephone numbers:</dt>
<dd>The SBC would remove the original domain name
              and substitute its own domain on the right-hand side.
</dd>
<dt>SIP URIs:</dt>
<dd>Unlike E.164
              telephone numbers, the SBC is not able to simply substitute its
              domain name for the enterprise's domain name due to user-part
              name collisions. There is only one unappealing solution: use the
              so-called escape-hack from email. For example, the SBC could
              rewrite sip:john.doe@example.com to
              sip:john.doe%example.com@sp1.example.net.
</dd>
</dl></blockquote>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.4"></a><h3>3.1.4.&nbsp;
Sign the New Identity</h3>

<p>Finally, the SBC will sign the new identity, using the private
          key associated with the new identity. This private key is known to
          the SBC (because it is the SBC's domain name). This function incurs
          a public key operation for that SIP request.
</p>
<a name="transport-address-identifier"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Transport Address as Identifier</h3>

<p>SIP Identity signs the SDP so that the IP address (contained in the
        SDP) provides identity. From <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>:
</p>
<p></p>
<blockquote class="text">
<p>"This mechanism also provides a signature over the bodies of
            SIP requests. The most important reason for doing so is to protect
            Session Description Protocol (SDP) bodies carried in SIP requests.
            There is little purpose in establishing the identity of the user
            that originated a SIP request if this assurance is not coupled
            with a comparable assurance over the media descriptors."
</p>
</blockquote>

<p>RFC4474 ties an identifier (IP address) with the identity (SIP
        "From:" address), which is counter to ongoing efforts in the IETF to
        split identifiers from identity (e.g., <a class='info' href='#I-D.ietf-hip-base'>[I&#8209;D.ietf&#8209;hip&#8209;base]<span> (</span><span class='info'>Moskowitz, R., Nikander, P., Jokela, P., and T. Henderson, &ldquo;Host Identity Protocol,&rdquo; October&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#I-D.farinacci-lisp'>[I&#8209;D.farinacci&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; March&nbsp;2009.</span><span>)</span></a>, <a class='info' href='#I-D.carpenter-idloc-map-cons'>[I&#8209;D.carpenter&#8209;idloc&#8209;map&#8209;cons]<span> (</span><span class='info'>Carpenter, B., &ldquo;General Identifier-Locator Mapping Considerations,&rdquo; June&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#I-D.whittle-ivip-arch'>[I&#8209;D.whittle&#8209;ivip&#8209;arch]<span> (</span><span class='info'>Whittle, R., &ldquo;Ivip (Internet Vastly Improved Plumbing) Architecture,&rdquo; March&nbsp;2010.</span><span>)</span></a>).
</p>
<p>The presence of media relays (e.g., <a class='info' href='#I-D.ietf-behave-turn'>TURN<span> (</span><span class='info'>Rosenberg, J., Mahy, R., and P. Matthews, &ldquo;Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN),&rdquo; July&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;behave&#8209;turn]), which may be used by an
        attacker, means that relying exclusively on such identifiers is risky.
        For example, if an attacker were able to cause re-use of the (signed)
        transport address within the replay window, the attacker can
        successfully impersonate the identity.
</p>
<p>Additionally, RFC4474's tying of identities to IP address causes a
        failure in certain NAT scenarios when the source transport address of
        arriving media does not agree with the SDP. While not written down in
        a standard at this time, if both endpoints are using <a class='info' href='#I-D.ietf-mmusic-ice'>ICE<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mmusic&#8209;ice], the ICE username and password
        (sent in SDP and signed by RFC4474) can be reliably used to establish
        identity. However, if either endpoint does not support ICE, the
        arriving media will be considered fraudulent because the arriving
        media does not match with the RFC4474-signed SDP.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Operation</h3>

<p>The operation of SIP-Identity-Media is similar to RFC4474 and uses
      authentication service proxies much like RFC4474. The basic steps
      are:
</p>
<p></p>
<ul class="text">
<li>A new header, Identity-Media, is created containing the names of
          certain SDP attributes from SDP bodyparts, and containing a hash of
          non-SDP bodyparts.
</li>
<li>Several SIP headers and the Identity-Media header are all signed
          (as detailed in <a class='info' href='#identity_media_signature'>Section&nbsp;4.1<span> (</span><span class='info'>Identity Media Signature</span><span>)</span></a>),
          and the result is placed in Identity-Media-Signature.
</li>
<li>The receiving domain validates the signature, and if the request
          is an invitation to establish a media channel, performs a proof of
          identity validation using DTLS, TLS, ICE, or HIP over the media
          path.
</li>
</ul>
<br /><hr class="insert" />
<a name="call_flow"></a>

<p>The following figure shows how the Authentication Service
        and the media validation is performed. The figure assumes the
        endpoints themselves perform the media validation.
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                        :  Service   :
       Enterprise-A     : Provider-1 :    Enterprise-B
                        :            :
                 Auth.  :  B2BUA or  :  Auth.
    Endpoint-A  Service :    SBC     : Service  Endpoint-B
        |          |    :     |      :   |         |
 1.     |--INVITE-&gt;|    :     |      :   |         |
 2.     |        sign   :     |      :   |         |
 3.     |          |-INVITE--&gt;|-INVITE--&gt;|         |
 4.     |          |    :     |      : validate    |
 5.     |          |    :     |      :   |--------&gt;|
 6.     |&lt;=========tls, dtls, ice, or hip=========&gt;|
 7.     |          |    :     |      :   |     validated
 8.     |          |    :     |      :   |     ring phone
        |          |    :     |      :   |         |
                        :            :</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Message Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text"><dl>
<dt>Step 1:</dt>
<dd>Originating endpoint prepares to send an INVITE and chooses the
          identity-challenge technique it supports, and indicates that in the
          SDP it generates. Described in this document are identity challenges
          for TLS, DTLS, ICE, and HIP. It then sends the INVITE to its local
          SIP proxy.
</dd>
<dt>Step 2:</dt>
<dd>Originating endpoint's authentication service creates a new
          header, Identity-Media, containing certain attribute names from the
          SDP (e.g., "a=fingerprint", "a=ice-pub-key"). The authentication
          service then creates a signature over certain SIP headers (e.g.,
          From, To) and this new Identity-Media header. The resulting
          signature is inserted into the new Identity-Media-Signature header.
          An Identity-Info header is added, pointing to this domain's
          certificate. The INVITE, with these additional headers, is forwarded
          to the next administrative domain.  [NOTE:
          alternatively, we could allow the UAC to create the Identity- Media
          header with the attributes it wants signed, then have the auth
          server sign them and insert the signature header - this would be
          more flexible]
</dd>
<dt>Step 3:</dt>
<dd>The next administrative domain has an SBC (or B2BUA). The SBC
          modifies or rewrites certain SDP fields. Most typically an SBC will
          modify the "m" and "c" lines. These modifications do not break the
          signature, so long as the SBC doesn't remove the headers
          Identity-Media, Identity-Media-Signature, or Identity-Info, and do
          not remove or alter the signed attributes from the SDP.
</dd>
<dt>Step 4:</dt>
<dd>The terminating endpoint's authentication service receives the
          INVITE. It validates that the signature contained in the
          Identity-Media-Signature header, and validates that the signing
          certificate is owned by the originating domain from step 2. This
          validation is done by using the certificate pointed to in the
          Identity-Info header, which MUST match the domain in the From:
          address.
</dd>
<dt>Step 5:</dt>
<dd>If the validation was successful, the terminating endpoint's
          authentication service forwards the INVITE to the endpoint.
</dd>
<dt>Step 6:</dt>
<dd>The terminating endpoint chooses a compatible identity-challenge
          technique from the INVITE (TLS, DTLS, ICE, or HIP), and performs
          that challenge. Described in this document are identity challenges
          for TLS, DTLS, ICE, and HIP.
</dd>
<dt>Step 7:</dt>
<dd>All of the identity challenges (TLS, DTLS, ICE, and HIP) cause
          the exchange of either a certificate or a public key in the media
          path. The terminating endpoint compares the certificate or public
          key with the fingerprint in the (signed) Identity-Media header
          (originally created in step 2). If they match, the terminating
          endpoint completes the identity challenge exchange. After
          completion, the originating endpoint has proven (to the terminating
          endpoint) that the originating endpoint knows the private key
          associated with the certificate (or public key) signed in step 2.
          The terminating endpoint has now validated the identity of the
          originating endpoint.
</dd>
<dt>Step 8:</dt>
<dd>The terminating endpoint can reliably and honestly indicate
          calling party information ("caller-id") and ring the phone.
</dd>
</dl></blockquote>

<a name="identity_media_signature"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Identity Media Signature</h3>

<p>In RFC4474, a signature is formed over some SIP headers and over
        the entire body (which most typically contains SDP). In this
        specification, some SIP headers are signed but only specific SDP
        attributes that provide cryptographic identity are signed (e.g.,
        "a=fingerprint" and its value). The specific SDP attributes that are
        signed depends on which cryptographic identity technique(s) is used;
        see section <a class='info' href='#techniques'>Section&nbsp;5<span> (</span><span class='info'>Proof of Identity Techniques</span><span>)</span></a>.
</p>
<p>The SIP headers that are signed, for the signature placed into the
        Identity-Media-Signature header are:
</p>
<p></p>
<ul class="text">
<li>The AoR of the UA sending the message, or addr-spec of the From
            header field (referred to occasionally here as the 'identity
            field').
</li>
<li>The addr-spec component of the To header field, which is the
            AoR to which the request is being sent.
</li>
<li>The SIP method.
</li>
<li>[NOTE: Contact, CSeq and Call-Id not included]
</li>
<li>The Date header field, with exactly one space each for each SP
            and the weekday and month items case set as shown in the BNF in
            RFC3261. RFC3261 specifies that the BNF for weekday and month is a
            choice amongst a set of tokens. The RFC2234 rules for the BNF
            specify that tokens are case sensitive. However, when used to
            construct the canonical string defined here, the first letter of
            each week and month MUST be capitalized, and the remaining two
            letters must be lowercase. This matches the capitalization
            provided in the definition of each token. All requests that use
            the Identity-Media mechanism MUST contain a Date header.
</li>
<li>The Identity-Media header field value.
</li>
</ul>

<p>The hash is formed of these elements:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   digest-string = addr-spec "|" addr-spec "|"
                   Method "|" SIP-date "|"
                   attrib-bodyhash-list
</pre></div>
<p>The first addr-spec MUST be taken from the From header
          field value, the second addr-spec MUST be taken from the To header
          field value.
</p>
<p>The Identity-Info header points to where the authentication
        service's certificate can be retrieved from.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Authentication Service</h3>

<p>The authentication service examines the SIP message body to build
        the Identity-Media header. For each message body found, in the order
        found:
</p>
<p></p>
<ul class="text">
<li>if the body part is application/sdp, the authentication service
            retrieves only the cryptographic attributes from the SDP (as
            described in <a class='info' href='#techniques'>Section&nbsp;5<span> (</span><span class='info'>Proof of Identity Techniques</span><span>)</span></a>), and appends that
            information to the Identity-Media header.
</li>
<li>otherwise, for all other body parts, the body part is hashed
            using SHA-1, and the first 96 bytes are appended to the
            Identity-Media header using "BPH=".
</li>
</ul>

<p>For example, A SIP request with three bodyparts:
          text/plain, application/sdp, and image/jpg, the Identity-Media
          attribute would contain a bodypart hash of the text/plain part,
          certain SDP attribute lines from the application/sdp bodypart
          (a=fingerprint in this example), and a bodypart hash of the
          image/jpg bodypart:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Identity-Media: BPH="e32je3j23cjek3dz","a=fingerprint",
    BPH="8fj289r3i892381c"
</pre></div>
<p>
</p>
<p>This Identity-Media header, along with the headers and portions of
        headers described in <a class='info' href='#identity_media_signature'>Section&nbsp;4.1<span> (</span><span class='info'>Identity Media Signature</span><span>)</span></a>
        are all signed by the authentication service. The resulting signature
        is placed on the new Identity-Media-Signature header.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Validation</h3>

<p>The validation service can be performed by the remote endpoint
        itself or by a device acting on behalf of the endpoint. The validation
        service first checks the signature in the Identity-Media-Signature
        field. If this is valid, the endpoint (or its validation service
        operating on its behalf) then initiates a DTLS, TLS, ICE, or HIP
        identity proof (<a class='info' href='#techniques'>Section&nbsp;5<span> (</span><span class='info'>Proof of Identity Techniques</span><span>)</span></a>). This causes the
        originating endpoint to prove possession of its private key that
        corresponds to the certificate (or public key) that was signed by the
        remote domain's authentication service.
</p>
<a name="techniques"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Proof of Identity Techniques</h3>

<p>Four techniques are described below, TLS, DTLS, ICE, and HIP. Each
      provides a means to cryptographically prove the identity signed by the
      authentication service in SIP is the same as the identity on the media
      path.
</p>
<p>Each of these techniques work similarly -- a fingerprint of the
      certificate (or, with ICE, the public key itself) is included in the
      SDP. The authentication service creates a new Identity-Media header and
      places into that header those SDP attribute names associated with that
      technique. The authentication service then creates a signature over
      specific SIP headers (see <a class='info' href='#identity_media_signature'>Section&nbsp;4.1<span> (</span><span class='info'>Identity Media Signature</span><span>)</span></a>), and places that signature
      into the new Identity-Media-Signature header. The SIP request is then
      sent outside of the originating domain.
</p>
<p>The receiving domain validates the Identity-Media-Signature. If
      successful, the SIP request is forwarded to the end system. The end
      system initiates a TLS, DTLS, ICE, or HIP session and validates that the
      (signed) certificate fingerprint presented in the SIP signaling matches
      the certificate presented in the TLS, DTLS, ICE, or HIP exchange. If
      they match, and the TLS, DTLS, ICE, or HIP exchange completes
      successfully, the local endpoint has validated the identity of the
      remote endpoint.
</p>
<p>Note: Due to SIP forking, the calling party may receive many identity
      challenges, each incurring a public key operation to prove identity.
      Mechanisms to deal with this are for future study.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
TLS </h3>

<p>TLS uses the "fingerprint" attribute to provide a hash of the
        certificate in the SDP. The fingerprint attribute is defined by <a class='info' href='#RFC4572'>[RFC4572]<span> (</span><span class='info'>Lennox, J., &ldquo;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP),&rdquo; July&nbsp;2006.</span><span>)</span></a> for TLS.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
DTLS</h3>

<p>DTLS uses the same "fingerprint" attribute originally described for
        TLS. The syntax is described in <a class='info' href='#I-D.ietf-sip-dtls-srtp-framework'>[I&#8209;D.ietf&#8209;sip&#8209;dtls&#8209;srtp&#8209;framework]<span> (</span><span class='info'>Fischl, J., Tschofenig, H., and E. Rescorla, &ldquo;Framework for Establishing an SRTP Security Context using DTLS,&rdquo; March&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
SRTP after DTLS optional</h3>

<p>[[Discussion Point: Is there interest in having identity without
          SRTP??]]
</p>
<p>
<p>DTLS is only necessary to prove identity with DTLS;
              <a class='info' href='#RFC3711'>SRTP<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a> [RFC3711] does not need to be used
              afterwards. Obviously, using SRTP provides significant benefits
              over continuing to use RTP, because an attacker can inject bogus
              RTP after a successful validation of identity which is quite
              undesirable. The SDP for doing RTP after a DTLS exchange might
              be signaled in SDP by using "RTP/AVP" rather than "RTP/SAVP"
              (lines folded for readability):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    v=0
    o=- 25678 753849 IN IP4 192.0.2.1
    s=
    c=IN IP4 192.0.2.1
    t=0 0
    m=audio 3456 RTP/AVP 0 18
    a=fingerprint:SHA-1
      4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
</pre></div>
<p>
</p>Of course, it would be desirable to more clearly indicate
          this somehow in SDP. The example above collides with non-standard,
          but deployed, "best-effort" media encryption mechanisms. <a class='info' href='#I-D.ietf-mmusic-sdp-capability-negotiation'>SDP Capability
          Negotiation<span> (</span><span class='info'>Andreasen, F., &ldquo;SDP Capability Negotiation,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mmusic&#8209;sdp&#8209;capability&#8209;negotiation] might be a useful consideration for this
          functionality.

<a name="ice_extension"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
ICE</h3>

<p>ICE doesn't have inherent support for public/private keys. If
        public keys were sent with other ICE attributes, there can be a real
        risk of an ICE connectivity check exceeding the MTU. ICE lacks a
        mechanism to fragment such large messages. It is also bandwidth
        inefficient to send multiple ICE connectivity checks containing public
        keys, either as retransmissions or with multiple candidates. Thus, for
        ICE, the public key is sent in SDP and the public key's fingerprint is
        exchanged on the media path -- opposite of TLS, DTLS, and HIP.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
ICE Public Key SDP Attribute</h3>

<p>The offerer includes its public key, which it will use for the
          subsequent PK-CHALLENGE and PK-RESPONSE, in its SDP. The syntax is a
          BASE64-encoded version of the endpoint's public key.
</p>
<p>The new attribute is called "ice-pub-key", which may appear on
          the session level, media level, or both.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
New STUN attributes</h3>

<p>Two new STUN attributes are defined to carry the plaintext
          challenge and the encrypted response.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.1"></a><h3>5.3.2.1.&nbsp;
PK-CHALLENGE</h3>

<p>This is sent in a STUN Binding Request, and contains the bits
            to be encrypted by the private key. Up to 256 bits can be included
            in the challenge. When a STUN Binding Request is received
            containing this attribute, the contents of the PK-CHALLENGE are
            encrypted using the private key, and the result is included in the
            PK-RESPONSE attribute of the Binding Response.
</p>
<p>The PK-CHALLENGE MUST be the same for each candidate address
            that is being tested for connectivity. If this requirement is not
            followed, the peer will incur a public key operation for every ICE
            connectivity check, which is not reasonable or necessary.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.2"></a><h3>5.3.2.2.&nbsp;
PK-RESPONSE</h3>

<p>This is sent in a STUN Binding Response from the offerer to the
            answerer, and contains the encrypted result of the
            PK-CHALLENGE.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
HIP</h3>

<p>In <a class='info' href='#I-D.tschofenig-hiprg-host-identities'>[I&#8209;D.tschofenig&#8209;hiprg&#8209;host&#8209;identities]<span> (</span><span class='info'>Tschofenig, H., Ott, J., Schulzrinne, H., Henderson, T., and G. Camarillo, &ldquo;Interaction between SIP and HIP,&rdquo; February&nbsp;2008.</span><span>)</span></a>, a
        new attribute "key-mgmt:host-identity-tag" is defined which contains
        the hash of the public key used in the subsequent HIP exchange. This
        can be utilized and signed exactly like the "fingerprint" attribute
        for TLS or DTLS.
</p>
<a name="abnf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
ABNF</h3>
<br /><hr class="insert" />
<a name="abnf_sip"></a>

<p>The following figure shows the syntax of the new SIP header
        fields using <a class='info' href='#RFC4234'>ABNF<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; October&nbsp;2005.</span><span>)</span></a> [RFC4234]
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   identity-media        = "Identity-Media" HCOLON
                           attrib-bodyhash-list
   attrib-bodyhash-list  = attrib-bodyhash *(COMMA attrib-bodyhash)
   attrib-bodyhash       = quoted-attrib | quoted-bodyparthash
   quoted-attribute      = DQUOTE attribute DQUOTE  ; SDP "a=" line
   quoted-bodyhash       = "BPH" EQUAL DQUOTE bodyparthash DQUOTE
   bodyparthash          = 32HEXDIG

   identity-media-sig    = "Identity-Media-Signature" HCOLON
                           signature
   signature             = DQUOT 32HEXDIG DQUOT

   Identity-Info = "Identity-Info" HCOLON ident-info
                    *( SEMI ident-info-params )
   ident-info = LAQUOT absoluteURI RAQUOT
   ident-info-params = ident-info-alg / ident-info-extension
   ident-info-alg = "alg" EQUAL token
   ident-info-extension = generic-param</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: ABNF for new SIP headers&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p><br /><hr class="insert" />
<a name="abnf_sdp"></a>

<p>The following figure shows the syntax of the new SDP
        attribute containing the ICE public key. This is used only by
        endpoints implementing the ICE proof of identity technique (<a class='info' href='#ice_extension'>Section&nbsp;5.3<span> (</span><span class='info'>ICE</span><span>)</span></a>).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  ice-pub-key        = token    ; BASE64 encoded public key</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: ABNF for new SDP attribute&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="security_considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>[[some of RFC4474's security considerations also apply.]]
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Device Disclosure</h3>

<p>Although the mechanism described in this paper allows SBCs to be
        used with a cryptographic identity scheme, it does expose the identity
        of the user's certificate. If a unique certificate is installed on
        each user's device, the remote party will be able to discern which
        device is terminating the call. This problem is more pronounced when
        SIP retargeting occurs in conjunction with <a class='info' href='#RFC4916'>Connected Identity<span> (</span><span class='info'>Elwell, J., &ldquo;Connected Identity in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2007.</span><span>)</span></a> [RFC4916].
</p>
<p>If this isn't desired, there are two solutions:
</p>
<p></p>
<ul class="text">
<li>All devices under the control of the user will need to have the
            same certificate (and associated private key) installed on
            them.
</li>
<li>The device needs to manufacture a new self-signed certificate
            (or public key) for each call, and populate the appropriate SDP
            attributes with that certificate (or public key). This is possible
            because the identity service described in this paper does not
            require the same certificate or public key to be used on every
            call.
</li>
</ul>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Operational Differences from RFC4474</h3>

<p>RFC4474 imposes one public key operation for the authentication
      service and one for validation. If <a class='info' href='#RFC4916'>Connected
      Identity<span> (</span><span class='info'>Elwell, J., &ldquo;Connected Identity in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2007.</span><span>)</span></a> [RFC4916] is used, only one additional public key operation is
      necessary for the header signature validation; the expense of the DTLS,
      TLS, or ICE public key operation has already been incurred by both
      parties and is not repeated.
</p>
<p>RFC4474 includes the Contact URI in the signed headers. That is not
      required by this mechanism because it adds no security property, and
      will fail validation when crossing SBCs and B2BUA's. It is of dubious
      security value because Via/Record-Route can be inserted for response
      interception regardless, and some requests don't contain a Contact
      anyway (e.g., MESSAGE). It does not provide any replay/copy-paste
      protection either, for the same reasons.
</p>
<p>RFC4474 includes the CSeq in the signed headers. That is not required
      by this mechanism because it adds little security, and will fail
      validation when crossing SBCs and B2BUA's in some cases. It is of little
      security value because it provides no protection from cut-paste attack
      for different targets, and although it would prevent replay attack
      within the same session, since the media key-related SDP portions are
      signed anyway, replaying the request will not do anything useful.
</p>
<p>RFC4474 includes the Call-Id in the signed headers. That is not
      required by this mechanism because it adds little security, and will
      fail validation when crossing SBCs and B2BUA's in some cases. It is of
      little security value because it provides no protection from cut-paste
      attack for different targets, and although it would prevent replay
      attack for the same target, since the media key-related SDP portions are
      signed anyway, replaying the request will not do anything useful.
</p>
<p>The mechanism described in this document has the following advantages
      over RFC4474:
</p>
<p></p>
<ul class="text">
<li>Only the edge network needs to create signatures on SIP requests
          -- not every intervening SBC,
</li>
<li>The original cryptographically-provable identity is preserved
          across any number of SBCs, B2BUA's, etc.
</li>
<li>SBCs, B2BUA's, and other "middle-boxes" in intermediate domains
          do not need to be upgraded or changed in order for the originating
          and terminating domains to use this new mechanism.
</li>
</ul>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Limitations</h3>

<p>For the identity procedure described in this document to function,
      every device -- including Session Border Controllers -- on the path MUST
      permit DTLS, TLS, ICE, or HIP messages to be exchanged in the media
      path. Further, those devices MUST NOT interfere with the signed SDP
      attributes or the new SIP headers necessary for Identity Media to
      operate.
</p>
<p>For the technique described in this document to function, all on-path
      SIP elements -- SBCs, B2BUAs, and SIP proxies -- MUST NOT interfere with
      the signed headers. The identity mechanism described in this document is
      not harmed if on-path SIP elements alter the SDP (e.g., by deleting
      non-signed attributes, connection addresses, etc.).
</p>
<a name="examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Examples</h3>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
DTLS</h3>

<p>This example shows how two a=fingerprint lines in SDP would
        populate the Identity-Media SIP header field. The following is an
        example of an INVITE created by the endpoint.
</p><br /><hr class="insert" />
<a name="example_dtls"></a>

<p>(lines folded for readability)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   INVITE sip:bob@biloxi.example.org SIP/2.0
   Via: SIP/2.0/TLS pc33.atlanta.example.com;branch=z9hG4bKnashds8
   To: Bob &lt;sip:bob@biloxi.example.org&gt;
   From: Alice &lt;sip:alice@atlanta.example.com&gt;;tag=1928301774
   Call-ID: a84b4c76e66710
   CSeq: 314159 INVITE
   Max-Forwards: 70
   Date: Thu, 21 Feb 2002 13:02:03 GMT
   Contact: &lt;sip:alice@pc33.atlanta.example.com&gt;
   Content-Type: application/sdp
   Content-Length: 147

   v=0
   o=- 6418913922105372816 2105372818 IN IP4 192.0.2.1
   s=example2
   c=IN IP4 192.0.2.1
   t=0 0
   m=audio 54113 RTP/SAVP 0
   a=fingerprint:SHA-1
     4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
   m=video 54115 RTP/SAVP 0
   a=fingerprint:SHA-1
     4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Example with DTLS&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="media_fingerprints_example"></a>

<p>The SIP proxy performing the Media Identity authentication
          service would then insert the following three SIP headers into the
          message. The Identity-Media header contains all of the SDP attribute
          lines that are signed and the Identity-Media header contains the
          signature of all of the relevant SIP headers and of the
          Identity-Media header. Lines are folded for readability:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Identity-Info: &lt;https://atlanta.example.com/atlanta.cer&gt;
     ;alg=rsa-sha1
  Identity-Media: "a=fingerprint","a=fingerprint"
  Identity-Media-Signature:
   "ZYNBbHC00VMZr2kZt6VmCvPonWJMGvQTBDqghoWeLxJfzB2a1pxAr3VgrB0SsSAa
    ifsRdiOPoQZYOy2wrVghuhcsMbHWUSFxI6p6q5TOQXHMmz6uEo3svJsSH49thyGn
    FVcnyaZ++yRlBYYQTLqWzJ+KVhPKbfU/pryhVn9Yc6U="</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: SIP Headers Inserted by Authentication Service&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
ICE</h3>

<p>With ICE, the public key is exchanged in the signaling path (in
        SDP) rather than in the media path (as is done with TLS, DTLS, and
        HIP).
</p><br /><hr class="insert" />
<a name="example_ice"></a>

<p>This is the INVITE as it left the SIP user agent (lines
          folded for readability):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   INVITE sip:bob@biloxi.example.org SIP/2.0
   Via: SIP/2.0/TLS pc33.atlanta.example.com;branch=z9hG4bKnashds8
   To: Bob &lt;sip:bob@biloxi.example.org&gt;
   From: Alice &lt;sip:alice@atlanta.example.com&gt;;tag=1928301774
   Call-ID: a84b4c76e66710
   CSeq: 314159 INVITE
   Max-Forwards: 70
   Date: Thu, 21 Feb 2002 13:02:03 GMT
   Contact: &lt;sip:alice@pc33.atlanta.example.com&gt;
   Content-Type: application/sdp
   Content-Length: 147

   v=0
   o=- 6418913922105372816 2105372818 IN IP4 192.0.2.1
   s=example2
   c=IN IP4 192.0.2.1
   t=0 0
   a=ice-pwd:asd88fgpdd777uzjYhagZg
   a=ice-ufrag:8hhY
   a=pub-key:ejfiwj289ceucuezeceEJFjefkcjeiquiefekureickejfeefe
     uirujejfecejejejkfeJJCEIUQQIEFJCQUCJCEQUURIE09dnjkeefjek
   m=audio 54113 RTP/AVP 0
   a=candidate:1 1 UDP 2130706431 192.0.2.1 54113 typ host</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Example with ICE&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p><br /><hr class="insert" />
<a name="media_fingerprints_ice"></a>

<p>The SIP proxy performing the Media Identity authentication
          service would then insert the following three SIP headers into the
          message. The Identity-Media header contains the ICE public key
          attribute and the Identity-Media header contains the signature of
          all of the relevant SIP headers and of the Identity-Media header
          (lines are folded for readability):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Identity-Info: &lt;https://atlanta.example.com/atlanta.cer&gt;
    ;alg=rsa-sha1
  Identity-Media: "a=pub-key"
  Identity-Media-Signature:
   "jjsRdiOPoQZYOy2wrVghuhcsMbHWUSFxI+p6q5TOQXHMmz6uEo3svJsSH49th8qc
    efQBbHC00VMZr2k+t6VmCvPonWJMGvQTBDqghoWeLxJfzB2a1pxAr3VgrB0Ssjcd
    VcunyaZucyRlBYYQTLqWzJ+KVhPKbfU/pryhVn9Jcqe="</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: Headers Inserted by Authentication Service&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
Request without SDP</h3>

<p>This example shows how a SIP request without SDP is signed.
</p><br /><hr class="insert" />
<a name="example_no_sdp"></a>

<p>Message as sent by the UAC (lines folded for
          readability)
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   MESSAGE sip:user2@example.com SIP/2.0
   Via: SIP/2.0/TCP user1pc.example.com;branch=z9hG4bK776sgdkse
   Max-Forwards: 70
   From: sip:user1@example.com;tag=49583
   To: sip:user2@example.com
   Call-ID: asd88asd77a@1.2.3.4
   CSeq: 1 MESSAGE
   Content-Type: text/plain
   Content-Length: 18

   Watson, come here.</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: Example with no SDP&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p><br /><hr class="insert" />
<a name="example_no_sdp_after_auth"></a>

<p>The authentication service would add the following headers
          to the above message:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Identity-Info: &lt;https://atlanta.example.com/atlanta.cer&gt;
    ;alg=rsa-sha1
  Identity-Media:
    BPH="MZr2k+t6VmCvPonWJMGvQTBDqghoWeLxJfzB2a1pxA"
  Identity-Media-Signature:
   "diOPoQZYOy2wrVghuhcsMbHWUSFxI+p6q5TOQXHMmz6uEo3svJsSH49th8qcjjsR
    bHC00VMZr2k+t6efQBVmCvPonWJMGvQTBDqghoWeLxJfzB2a1pxAr3VgrB09JcVc
    unyaZucyRlBYYQTLqWzJ+KVhPKbfU/pryhVnqeSsjcd="</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: added headers&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>The mechanism described in this paper is derived from Jon Peterson
      and Cullen Jennings' <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>, which was formerly
      a document of the SIP working group.
</p>
<p>Thanks to Hans Persson for his suggestions which improved this
      document.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>This document will add new IANA registrations for its new STUN
      attributes.
</p>
<p>[[This section will be completed in a later version of this
      document.]]
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-behave-turn">[I-D.ietf-behave-turn]</a></td>
<td class="author-text">Rosenberg, J., Mahy, R., and P. Matthews, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-turn-16.txt">Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)</a>,&rdquo; draft-ietf-behave-turn-16 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-turn-16.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3711">[RFC3711]</a></td>
<td class="author-text">Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3711">The Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; RFC&nbsp;3711, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3711.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sip-dtls-srtp-framework">[I-D.ietf-sip-dtls-srtp-framework]</a></td>
<td class="author-text">Fischl, J., Tschofenig, H., and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-dtls-srtp-framework-07.txt">Framework for Establishing an SRTP Security Context using DTLS</a>,&rdquo; draft-ietf-sip-dtls-srtp-framework-07 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-dtls-srtp-framework-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4572">[RFC4572]</a></td>
<td class="author-text">Lennox, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4572">Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;4572, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4572.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4234">[RFC4234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; RFC&nbsp;4234, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4916">[RFC4916]</a></td>
<td class="author-text">Elwell, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4916">Connected Identity in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4916, June&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4916.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.tschofenig-hiprg-host-identities">[I-D.tschofenig-hiprg-host-identities]</a></td>
<td class="author-text">Tschofenig, H., Ott, J., Schulzrinne, H., Henderson, T., and G. Camarillo, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-tschofenig-hiprg-host-identities-06.txt">Interaction between SIP and HIP</a>,&rdquo; draft-tschofenig-hiprg-host-identities-06 (work in progress), February&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-tschofenig-hiprg-host-identities-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-hip-base">[I-D.ietf-hip-base]</a></td>
<td class="author-text">Moskowitz, R., Nikander, P., Jokela, P., and T. Henderson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-hip-base-10.txt">Host Identity Protocol</a>,&rdquo; draft-ietf-hip-base-10 (work in progress), October&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-hip-base-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.farinacci-lisp">[I-D.farinacci-lisp]</a></td>
<td class="author-text">Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-farinacci-lisp-12.txt">Locator/ID Separation Protocol (LISP)</a>,&rdquo; draft-farinacci-lisp-12 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-farinacci-lisp-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.carpenter-idloc-map-cons">[I-D.carpenter-idloc-map-cons]</a></td>
<td class="author-text">Carpenter, B., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-carpenter-idloc-map-cons-01.txt">General Identifier-Locator Mapping Considerations</a>,&rdquo; draft-carpenter-idloc-map-cons-01 (work in progress), June&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-carpenter-idloc-map-cons-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.whittle-ivip-arch">[I-D.whittle-ivip-arch]</a></td>
<td class="author-text">Whittle, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-whittle-ivip-arch-04.txt">Ivip (Internet Vastly Improved Plumbing) Architecture</a>,&rdquo; draft-whittle-ivip-arch-04 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-whittle-ivip-arch-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-ice">[I-D.ietf-mmusic-ice]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols</a>,&rdquo; draft-ietf-mmusic-ice-19 (work in progress), October&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informational References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sipping-sbc-funcs">[I-D.ietf-sipping-sbc-funcs]</a></td>
<td class="author-text">Hautakorpi, J., Camarillo, G., Penfield, B., Hawrylyshen, A., and M. Bhatia, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-sbc-funcs-09.txt">Requirements from Session Initiation Protocol (SIP) Session Border Control (SBC) Deployments</a>,&rdquo; draft-ietf-sipping-sbc-funcs-09 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-sbc-funcs-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3325">[RFC3325]</a></td>
<td class="author-text">Jennings, C., Peterson, J., and M. Watson, &ldquo;<a href="http://tools.ietf.org/html/rfc3325">Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks</a>,&rdquo; RFC&nbsp;3325, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3325.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-sdp-capability-negotiation">[I-D.ietf-mmusic-sdp-capability-negotiation]</a></td>
<td class="author-text">Andreasen, F., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-sdp-capability-negotiation-13.txt">SDP Capability Negotiation</a>,&rdquo; draft-ietf-mmusic-sdp-capability-negotiation-13 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-sdp-capability-negotiation-13.txt">TXT</a>).</td></tr>
</table>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
ToDo List</h3>

<p></p>
<ul class="text">
<li>Add Table-2 of RFC3261
</li>
<li>re-use RFC4474 response code for failures, or invent new
          ones?
</li>
<li>describe what occurs if both SIP-Identity-Media and SIP-Identity
          are both used?
</li>
</ul>

<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Changes From Previous Versions</h3>

<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Changes from 00 to 01</h3>

<p></p>
<ul class="text">
<li>Removed "Contact" header from signature. SBCs need to change
            it.
</li>
<li>Removed "Call ID" header from signature. This header often
            contains an IP address, so many SBCs change it.
</li>
<li>Removed "CSeq" header from signature. This header is sometimes
            changed by SBCs and B2BUA's.
</li>
<li>include SDP attribute names in Identity-Media signature. This
            allows any attribute to be signed.
</li>
<li>Old "Identity-Fingerprints" header renamed to "Identity-Media",
            and only attribute names are listed in it, not attribute
            values.
</li>
<li>Old "Identity-Media" header renamed to
            "Identity-Media-Signature".
</li>
<li>Described how to sign SIP requests without an SDP body part,
            and with a mix of SDP and non-SDP bodyparts.
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dan Wing</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 West Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dwing@cisco.com">dwing@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hadriel Kaplan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Acme Packet</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">71 Third Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Burlington, MA  01803</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hkaplan@acmepacket.com">hkaplan@acmepacket.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
