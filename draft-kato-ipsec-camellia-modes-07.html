<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The Additional Modes of Operation for Camellia and Its Use With IPsec</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The Additional Modes of Operation for Camellia and Its Use With IPsec">
<meta name="keywords" content="Internet-Draft, Request for Comments, I-D, IPsec, Camellia, Block Cipher, Mode of operation">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">A. Kato</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NTT Software Corporation</td></tr>
<tr><td class="header">Obsoletes: <a href='http://tools.ietf.org/html/rfc4312'>4312</a> (if&nbsp;approved)</td><td class="header">M. Kanda</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Nippon Telegraph and Telephone</td></tr>
<tr><td class="header">Expires: September 20, 2008</td><td class="header">Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 19, 2008</td></tr>
</table></td></tr></table>
<h1><br />The Additional Modes of Operation for Camellia and Its Use With IPsec<br />draft-kato-ipsec-camellia-modes-07</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 20, 2008.</p>

<h3>Abstract</h3>

<p>This document describes the use of the Camellia block cipher
   algorithm in Cipher Block Chaining (CBC) mode, Counter (CTR) mode and 
   Counter with CBC-MAC (CCM) mode, as
   an IPsec  Encapsulating Security Payload (ESP) mechanism to provide 
   confidentiality, data origin authentication, and connectionless integrity.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Terminology<br />
<a href="#camellia">2.</a>&nbsp;
The Camellia Cipher Algorithm<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.1.</a>&nbsp;
Key Size<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#block">2.2.</a>&nbsp;
Weak Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.3.</a>&nbsp;
Block Size and Padding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.4.</a>&nbsp;
Performance<br />
<a href="#anchor5">3.</a>&nbsp;
Modes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.</a>&nbsp;
CBC<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Counter">3.2.</a>&nbsp;
Counter<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.</a>&nbsp;
Counter with CBC-MAC<br />
<a href="#anchor8">4.</a>&nbsp;
ESP Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.1.</a>&nbsp;
CBC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.1.1.</a>&nbsp;
ESP Algorithmic Interactions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.</a>&nbsp;
Counter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.2.1.</a>&nbsp;
Counter Block Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.2.</a>&nbsp;
Keying Material<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.3.</a>&nbsp;
Counter with CBC-MAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.3.1.</a>&nbsp;
Initialization Vector (IV)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.2.</a>&nbsp;
Encrypted Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.3.3.</a>&nbsp;
Authentication Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NONCE">4.3.4.</a>&nbsp;
Nonce Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AAD">4.3.5.</a>&nbsp;
AAD Construction<br />
<a href="#anchor18">5.</a>&nbsp;
IKE Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.1.</a>&nbsp;
Transform Type 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.2.</a>&nbsp;
Key Length Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.3.</a>&nbsp;
Keying Material<br />
<a href="#anchor22">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor23">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor24">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
This document describes the use of the Camellia block cipher
   algorithm in Cipher Block Chaining mode (CBC), Counter (CTR) mode and 
   Counter with CBC-MAC (CCM) mode, as
   an IPsec  Encapsulating Security Payload (ESP) mechanism to provide 
   confidentiality, data origin authentication, and connectionless integrity.

</p>
<p>
   Camellia is a symmetric cipher with a Feistel structure.  Camellia
   was developed jointly by NTT and Mitsubishi Electric Corporation in
   2000.  It was designed to withstand all known cryptanalytic attacks,
   and it has been scrutinized by worldwide cryptographic experts.
   Camellia is suitable for implementation in software and hardware,
   offering encryption speed in software and hardware implementations
   that is comparable to Advanced
   Encryption Standard (AES) <a class='info' href='#FIPS.197.2001'>[5]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a>.

</p>
<p>
   Camellia supports 128-bit block size and 128-, 192-, and 256-bit key
   lengths, i.e., the same interface specifications as the AES.
   Therefore, it is easy to implement Camellia based algorithms by replacing AES block
   of AES based algorithms to Camellia block.

</p>
<p>
   Camellia is adopted for the one of three ISO/IEC 
   international standard cipher <a class='info' href='#ISO/IEC 18033-3'>[6]<span> (</span><span class='info'>International Organization for Standardization, &ldquo;Information technology - Security techniques - Encryption algorithms - Part 3: Block ciphers,&rdquo; July&nbsp;2005.</span><span>)</span></a> as 
   128bit block cipher (Camellia, AES and SEED).  

   Camellia was selected as a recommended cryptographic 
   primitive by the EU NESSIE (New European Schemes for Signatures, Integrity and
   Encryption) project <a class='info' href='#NESSIE'>[7]<span> (</span><span class='info'>, &ldquo;The NESSIE project (New European Schemes for Signatures, Integrity and Encryption),&rdquo; .</span><span>)</span></a> and was included in the list of
   cryptographic techniques for Japanese e-Government systems that was
   selected by the Japan CRYPTREC (Cryptography Research and Evaluation
   Committees) <a class='info' href='#CRYPTREC'>[8]<span> (</span><span class='info'>Information-technology Promotion Agency (IPA), &ldquo;Cryptography Research and Evaluation Committees,&rdquo; .</span><span>)</span></a>. 

</p>
<p>
  Since optimized source code is provided by 
  <a href='http://info.isl.ntt.co.jp/crypt/eng/camellia/source.html'>several open source lisences</a>, 
  Camellia is also adopted by several open source projects (Openssl,
  FreeBSD, Linux and Gran Paradiso).

</p>
<p>
   
<p>The algorithm specification and object identifiers are described in
   <a class='info' href='#RFC3713'>[9]<span> (</span><span class='info'>Matsui, M., Nakajima, J., and S. Moriai, &ldquo;A Description of the Camellia Encryption Algorithm,&rdquo; April&nbsp;2004.</span><span>)</span></a>.

</p>

   <a href='http://info.isl.ntt.co.jp/camellia/'>The Camellia homepage</a>
   contains a wealth of information
   about Camellia, including detailed specification, security analysis,
   performance figures, reference implementation, optimized 
   implementation, test vectors, and intellectual property information.


<p>
   The remainder of this document specifies the additional modes of operation Camellia within
   the context of IPsec ESP.  For further information on how the various
   pieces of ESP fit together to provide security services, please refer
   to <a class='info' href='#RFC4301'>[10]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>, and <a class='info' href='#RFC2411'>[11]<span> (</span><span class='info'>Thayer, R., Doraswamy, N., and R. Glenn, &ldquo;IP Security Document Roadmap,&rdquo; November&nbsp;1998.</span><span>)</span></a>.

</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
     document are to be interpreted as described in
   <a class='info' href='#RFC2119'>[2]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="camellia"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
The Camellia Cipher Algorithm</h3>

<p>
   All symmetric block cipher algorithms share common characteristics
   and variables, including mode, key size, weak keys, block size, and
   rounds.  The following sections contain descriptions of the relevant
   characteristics of Camellia.
   
</p>
<p>The algorithm specification and object identifiers are described in
   <a class='info' href='#RFC3713'>[9]<span> (</span><span class='info'>Matsui, M., Nakajima, J., and S. Moriai, &ldquo;A Description of the Camellia Encryption Algorithm,&rdquo; April&nbsp;2004.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Key Size</h3>

<p>Camellia supports three key sizes: 128 bits, 192 bits, and 256 bits. 
   The default key size is 128 bits, and all implementations MUST 
   support this key size.  Implementations MAY also support key sizes of
   192 bits and 256 bits.
</p>
<p>Camellia uses a different number of rounds for each of the defined 
   key sizes.  When a 128-bit key is used, implementations MUST use 18
   rounds.  When a 192-bit key is used, implementations MUST use 24
   rounds.  When a 256-bit key is used, implementations MUST use 24
   rounds.
</p>
<a name="block"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Weak Keys</h3>

<p>
   At the time of writing this document there are no known weak keys for
   Camellia.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Block Size and Padding</h3>

<p>   Camellia uses a block size of sixteen octets (128 bits).
</p>
<p>Padding is required by the algorithms to maintain a 16-octet
   (128-bit) block size.  Padding MUST be added, as specified in <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>,
   such that the data to be encrypted (which includes the ESP Pad Length
   and Next Header fields) has a length that is a multiple of 16 octets.
</p>
<p>Because of the algorithm specific padding requirement, no additional
   padding is required to ensure that the ciphertext terminates on a
   4-octet boundary (i.e. maintaining a 16-octet block size guarantees
   that the ESP Pad Length and Next Header fields will be right aligned
   within a 4-octet word).  Additional padding MAY be included, as
   specified in <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>, as long as the 16-octet block size is maintained.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Performance</h3>

<p>
	Performance figures of Camellia are available at
   <a href='http://info.isl.ntt.co.jp/crypt/camellia/'>http://info.isl.ntt.co.jp/crypt/camellia/</a>. 
  NESSIE project has reported performance of Optimized
   Implementations independently <a class='info' href='#NESSIE'>[7]<span> (</span><span class='info'>, &ldquo;The NESSIE project (New European Schemes for Signatures, Integrity and Encryption),&rdquo; .</span><span>)</span></a>.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Modes</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
CBC</h3>

<p>
   NIST has defined seven modes of operation for AES and other FIPS-
   approved ciphers : CBC (Cipher Block Chaining), ECB
   (Electronic CodeBook), CFB (Cipher FeedBack), OFB (Output FeedBack),
    CTR (Counter), CMAC (Cipher-based MAC) and CCM (CBC MAC).  
   The CBC mode is well defined and well understood
   for symmetric ciphers, and it is currently used for all other ESP
   ciphers.  This document specifies the use of the Camellia cipher in
   CBC mode within ESP.  This mode requires an Initialization Vector
   (IV) size that is the same as the block size.  Use of a randomly
   generated IV prevents generation of identical cipher text from
   packets that have identical data spanning the first block of the
   cipher algorithm's block size.

</p>
<p>
   The CBC IV is XOR'd with the first plaintext block before it is
   encrypted.  Then, for successive blocks, the previous cipher text
   block is XOR'd with the current plain text before it is encrypted.
   More information on CBC mode can be obtained in <a class='info' href='#MODES'>[3]<span> (</span><span class='info'>Dworkin, M., &ldquo;Recommendation for Block Cipher Modes of Operation - Methods and Techniques,&rdquo; November&nbsp;2001.</span><span>)</span></a>.

</p>
<a name="Counter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Counter</h3>

<p>
   Camellia-CTR <a class='info' href='#CTRCCM'>[12]<span> (</span><span class='info'>Kato, A. and M. Kanda, &ldquo;Camellia Counter mode and Camellia Counter with CBC Mac mode algorithms,&rdquo; November&nbsp;2007.</span><span>)</span></a> requires the encryptor to generate a unique per-packet value,
   and communicate this value to the decryptor.  This specification
   calls this per-packet value an initialization vector (IV).  The same
   IV and key combination MUST NOT be used more than once.  The
   encryptor can generate the IV in any manner that ensures uniqueness.
   Common approaches to IV generation include incrementing a counter for
   each packet and linear feedback shift registers (LFSRs).

</p>
<p>
   This specification calls for the use of a nonce for additional
   protection against precomputation attacks.  The nonce value need not
   be secret.  However, the nonce MUST be unpredictable prior to the
   establishment of the IPsec Security Association (SA) that is making use of
   Camellia-CTR.

</p>
<p>
   Camellia-CTR has many properties that make it an attractive encryption
   algorithm for in high-speed networking.  Camellia-CTR uses the Camellia block
   cipher to create a stream cipher.  Data is encrypted and decrypted by
   XORing with the key stream produced by Camellia encrypting sequential
   counter block values.  Camellia-CTR is easy to implement, and Camellia-CTR can
   be pipelined and parallelized.  Camellia-CTR also supports key stream
   precomputation.

</p>
<p>
   Pipelining is possible because Camellia has multiple rounds (see
   <a class='info' href='#camellia'>Section&nbsp;2<span> (</span><span class='info'>The Camellia Cipher Algorithm</span><span>)</span></a>.).  A hardware implementation (and some software implementations)
   can create a pipeline by unwinding the loop implied by this round
   structure.  For example, after a 16-octet block has been input, one
   round later another 16-octet block can be input, and so on.  In Camellia-CTR,
    these inputs are the sequential counter block values used to
   generate the key stream.

</p>
<p>
   Multiple independent Camellia encrypt implementations can also be used to
   improve performance.  For example, one could use two Camellia encrypt
   implementations in parallel, to process a sequence of counter block
   values, doubling the effective throughput.

</p>
<p>
   The sender can precompute the key stream.  Since the key stream does
   not depend on any data in the packet, the key stream can be
   precomputed once the nonce and IV are assigned.  This precomputation
   can reduce packet latency.  The receiver cannot perform similar
   precomputation because the IV will not be known before the packet
   arrives.

</p>
<p>
   When used correctly, Camellia-CTR provides a high level of
   confidentiality.  Unfortunately, Camellia-CTR is easy to use incorrectly.
   Being a stream cipher, any reuse of the per-packet value, called the
   IV, with the same nonce and key is catastrophic.  An IV collision
   immediately leaks information about the plaintext in both packets.
   For this reason, it is inappropriate to use this mode of operation
   with static keys.  Extraordinary measures would be needed to prevent
   reuse of an IV value with the static key across power cycles.  To be
   safe, implementations MUST use fresh keys with Camellia-CTR.  The Internet
   Key Exchange (IKEv2) <a class='info' href='#RFC4306'>[4]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> protocol can be used to establish fresh
   keys.  IKE can also provide the nonce value.

</p>
<p>
   With Camellia-CTR, it is trivial to use a valid ciphertext to forge other
   (valid to the decryptor) ciphertexts.  Thus, it is equally
   catastrophic to use Camellia-CTR without a companion authentication
   function.  Implementations MUST use Camellia-CTR in conjunction with an
   authentication function, such as Camellia-CMAC-96 <a class='info' href='#CMAC'>[13]<span> (</span><span class='info'>Kato, A., Kanda, M., and T. Iwata, &ldquo;The Camellia-CMAC-96 and Camellia-CMAC-PRF-128 Algorithms and Its Use with IPsec,&rdquo; November&nbsp;2007.</span><span>)</span></a>.

</p>
<p>
 More information and Test Vectors for Camellia-CTR can be obtained in <a class='info' href='#CTRCCM'>[12]<span> (</span><span class='info'>Kato, A. and M. Kanda, &ldquo;Camellia Counter mode and Camellia Counter with CBC Mac mode algorithms,&rdquo; November&nbsp;2007.</span><span>)</span></a>.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Counter with CBC-MAC</h3>

<p>
   CCM is a generic authenticate-and-encrypt block cipher mode.
   In this specification, CCM is used with the Camellia <a class='info' href='#CTRCCM'>[12]<span> (</span><span class='info'>Kato, A. and M. Kanda, &ldquo;Camellia Counter mode and Camellia Counter with CBC Mac mode algorithms,&rdquo; November&nbsp;2007.</span><span>)</span></a> block cipher.

</p>
<p>
   Camellia-CCM <a class='info' href='#CTRCCM'>[12]<span> (</span><span class='info'>Kato, A. and M. Kanda, &ldquo;Camellia Counter mode and Camellia Counter with CBC Mac mode algorithms,&rdquo; November&nbsp;2007.</span><span>)</span></a> has two parameters:

</p>
<blockquote class="text"><dl>
<dt>M</dt>
<dd>
 	M indicates the size of the integrity check value (ICV).  CCM
         defines values of 4, 6, 8, 10, 12, 14, and 16 octets; However,
         to maintain alignment and provide adequate security, only the
         values that are a multiple of four and are at least eight are
         permitted.  Implementations MUST support M values of 8 octets
         and 16 octets, and implementations MAY support an M value of 12
         octets.
</dd>
<dt>L</dt>
<dd>
	L indicates the size of the length field in octets.  CCM
         defines values of L between 2 octets and 8 octets.  This
         specification only supports L = 4.  Implementations MUST
         support an L value of 4 octets, which accommodates a full
         Jumbogram <a class='info' href='#RFC2675'>[14]<span> (</span><span class='info'>Borman, D., Deering, S., and R. Hinden, &ldquo;IPv6 Jumbograms,&rdquo; August&nbsp;1999.</span><span>)</span></a>; however, the length includes all of the
         encrypted data, which also includes the ESP Padding, Pad
         Length, and Next Header fields.
</dd>
</dl></blockquote>
<p>
   There are four inputs to CCM originator processing:

</p>
<blockquote class="text"><dl>
<dt>key</dt>
<dd>

         A single key is used to calculate the ICV using CBC-MAC and to
         perform payload encryption using counter mode. Camellia supports
         key sizes of 128 bits, 192 bits, and 256 bits.  The default key
         size is 128 bits, and implementations MUST support this key
         size.  Implementations MAY also support key sizes of 192 bits
         and 256 bits.
 
</dd>
<dt>nonce</dt>
<dd>

         The size of the nonce depends on the value selected for the
         parameter L.  It is 15-L octets.  Implementations MUST support
         a nonce of 11 octets.  The construction of the nonce is
         described in <a class='info' href='#NONCE'>Section&nbsp;4.3.4<span> (</span><span class='info'>Nonce Format</span><span>)</span></a>.

</dd>
<dt>payload</dt>
<dd>

         The payload of the ESP packet.  The payload MUST NOT be longer
         than 4,294,967,295 octets, which is the maximum size of a
         Jumbogram <a class='info' href='#RFC2675'>[14]<span> (</span><span class='info'>Borman, D., Deering, S., and R. Hinden, &ldquo;IPv6 Jumbograms,&rdquo; August&nbsp;1999.</span><span>)</span></a>; however, the ESP Padding, Pad Length, and
         Next Header fields are also part of the payload.

</dd>
<dt>AAD</dt>
<dd>

         CCM provides data integrity and data origin authentication for
         some data outside the payload.  CCM does not allow additional
         authenticated data (AAD) to be longer than
         18,446,744,073,709,551,615 octets.  The ICV is computed from
         the ESP header, Payload, and ESP trailer fields, which is
         significantly smaller than the CCM-imposed limit.  The
         construction of the AAD described in <a class='info' href='#AAD'>Section&nbsp;4.3.5<span> (</span><span class='info'>AAD Construction</span><span>)</span></a>.

</dd>
</dl></blockquote>
<p>
   Camellia-CCM requires the encryptor to generate a unique per-packet value
   and to communicate this value to the decryptor.  This per-packet
   value is one of the component parts of the nonce, and it is referred
   to as the initialization vector (IV).  The same IV and key
   combination MUST NOT be used more than once.  The encryptor can
   generate the IV in any manner that ensures uniqueness.  Common
   approaches to IV generation include incrementing a counter for each
   packet and linear feedback shift registers (LFSRs).

</p>
<p>

   Camellia-CCM employs counter mode for encryption.  As with any stream
   cipher, reuse of the same IV value with the same key is catastrophic.
   An IV collision immediately leaks information about the plaintext in
   both packets.  For this reason, it is inappropriate to use this CCM
   with statically configured keys.  Extraordinary measures would be
   needed to prevent reuse of an IV value with the static key across
   power cycles.  To be safe, implementations MUST use fresh keys with
   Camellia-CCM.  The IKEv2 protocol <a class='info' href='#RFC4306'>[4]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> can be 
   used to establish fresh keys.


</p>
<p>
  More information and Test Vectors for Camellia-CCM can be obtained in <a class='info' href='#CTRCCM'>[12]<span> (</span><span class='info'>Kato, A. and M. Kanda, &ldquo;Camellia Counter mode and Camellia Counter with CBC Mac mode algorithms,&rdquo; November&nbsp;2007.</span><span>)</span></a>.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
ESP Payload</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
CBC</h3>

<p>
   The ESP payload for Camellia-CBC is made up of the IV followed by raw cipher-text.
   Thus, the payload field, as defined in <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>, is broken down
   according to the following diagram:

</p><br /><hr class="insert" />
<a name="payload0"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   +---------------+---------------+---------------+---------------+
   |                                                               |
   +               Initialization Vector (16 octets)               +
   |                                                               |
   +---------------+---------------+---------------+---------------+
   |                                                               |
   ~ Encrypted Payload (variable length, a multiple of 16 octets)  ~
   |                                                               |
   +---------------------------------------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: ESP Payload Encrypted with Camellia-CBC&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
   The IV field MUST be the same size as the block size of the cipher
   algorithm being used.  The IV MUST be chosen at random, and MUST be
   unpredictable.

</p>
<p>
   Including the IV in each datagram ensures that each received datagram
   can be decrypted, even when some datagrams are dropped or re-ordered
   in transit.

</p>
<p>
   To avoid CBC encryption of very similar plaintext blocks in different
   packets, implementations MUST NOT use a counter or other low
   Hamming-distance source for IVs.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
ESP Algorithmic Interactions</h3>

<p>
   Currently, there are no known issues regarding interactions between
   the Camellia and other aspects of ESP, such as the use of certain
   authentication schemes.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Counter</h3>

<p>
The ESP payload for Camellia-CBC is made up of the IV followed by raw cipher-text.
   bits.  <a class='info' href='#payload1'>Figure&nbsp;2<span> (</span><span class='info'>ESP Payload Encrypted with Camellia-CTR</span><span>)</span></a> shows the format of the counter block.

</p><br /><hr class="insert" />
<a name="payload1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Initialization Vector                     |
   |                            (8 octets)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                  Encrypted Payload (variable)                 ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                 Authentication Data (variable)                ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: ESP Payload Encrypted with Camellia-CTR&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
The components of the counter block are as follows:

</p>
<blockquote class="text"><dl>
<dt>Initialization Vector</dt>
<dd>

   The Camellia-CTR IV field MUST be eight octets.  The IV MUST be chosen by
   the encryptor in a manner that ensures that the same IV value is used
   only once for a given key.  The encryptor can generate the IV in any
   manner that ensures uniqueness.  Common approaches to IV generation
   include incrementing a counter for each packet and linear feedback
   shift registers (LFSRs).

   Including the IV in each packet ensures that the decryptor can
   generate the key stream needed for decryption, even when some packets
   are lost or reordered.

</dd>
<dt>Encrypted Payload</dt>
<dd>

   The encrypted payload contains the ciphertext.

   Camellia-CTR mode does not require plaintext padding.  However, ESP does
   require padding to 32-bit word-align the authentication data.  The
   padding, Pad Length, and the Next Header MUST be concatenated with
   the plaintext before performing encryption, as described in <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>.


</dd>
<dt>Authentication Data</dt>
<dd>

   Since it is trivial to construct a forgery Camellia-CTR ciphertext from a
   valid Camellia-CTR ciphertext, Camellia-CTR implementations MUST employ a non-NULL
   ESP authentication method.  Camellia-CMAC-96 <a class='info' href='#CMAC'>[13]<span> (</span><span class='info'>Kato, A., Kanda, M., and T. Iwata, &ldquo;The Camellia-CMAC-96 and Camellia-CMAC-PRF-128 Algorithms and Its Use with IPsec,&rdquo; November&nbsp;2007.</span><span>)</span></a> is a likely
   choice.

</dd>
</dl></blockquote>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Counter Block Format</h3>

<p>
   The Camellia-CTR counter block is 128
   bits.  <a class='info' href='#payload-CTR'>Figure&nbsp;3<span> (</span><span class='info'>Counter Block Format</span><span>)</span></a> shows the format of the counter block.

</p><br /><hr class="insert" />
<a name="payload-CTR"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Nonce                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  Initialization Vector (IV)                   |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Block Counter                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Counter Block Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
   The components of the counter block are as follows:

</p>
<blockquote class="text"><dl>
<dt>Nonce</dt>
<dd>

      The Nonce field is 32 bits.  As the name implies, the nonce is a
      single use value.  That is, a fresh nonce value MUST be assigned
      for each SA.  It MUST be assigned at the
      beginning of the SA.  The nonce value need not
      be secret, but it MUST be unpredictable prior to the beginning of
      the SA.

</dd>
<dt>Initialization Vector</dt>
<dd>

      The IV field is 64 bits.  As described in section 3.1, the IV MUST
      be chosen by the encryptor in a manner that ensures that the same
      IV value is used only once for a given key.

</dd>
<dt>Block Counter</dt>
<dd>

      The block counter field is the least significant 32 bits of the
      counter block.  The block counter begins with the value of one,
      and it is incremented to generate subsequent portions of the key
      stream.  The block counter is a 32-bit big-endian integer value.

</dd>
</dl></blockquote>
<p>
   Using the encryption process described in <a class='info' href='#Counter'>Section&nbsp;3.2<span> (</span><span class='info'>Counter</span><span>)</span></a>, this
   construction permits each packet to consist of up to:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      (2^32)-1 blocks  =  4,294,967,295 blocks
                       = 68,719,476,720 octets
</pre></div>
<p>
   This construction can produce enough key stream for each packet
   sufficient to handle any IPv6 jumbogram <a class='info' href='#RFC2675'>[14]<span> (</span><span class='info'>Borman, D., Deering, S., and R. Hinden, &ldquo;IPv6 Jumbograms,&rdquo; August&nbsp;1999.</span><span>)</span></a>.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Keying Material</h3>

<p>The minimum number of bits sent from the key exchange protocol to the
   ESP algorithm must be greater than or equal to the key size.
</p>
<p>The cipher's encryption and decryption key is taken from the first
   128, 192, or 256 bits of the keying material.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Counter with CBC-MAC</h3>

<p>
   The ESP payload is composed of the IV followed by the ciphertext.
   The payload field, as defined in <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>, is structured as shown in
   <a class='info' href='#payload-CCM'>Figure&nbsp;4<span> (</span><span class='info'>ESP Payload Encrypted with Camellia-CCM</span><span>)</span></a>.

</p><br /><hr class="insert" />
<a name="payload-CCM"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     Initialization Vector                     |
      |                            (8 octets)                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      ~                  Encrypted Payload (variable)                 ~
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      ~                 Authentication Data (variable)                ~
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: ESP Payload Encrypted with Camellia-CCM&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Initialization Vector (IV)</h3>

<p>
   The Camellia-CCM IV field MUST be eight octets.  The IV MUST be chosen by
   the encryptor in a manner that ensures that the same IV value is used
   only once for a given key.  The encryptor can generate the IV in any
   manner that ensures uniqueness.  Common approaches to IV generation
   include incrementing a counter for each packet and linear feedback
   shift registers (LFSRs).

</p>
<p>
   Including the IV in each packet ensures that the decryptor can
   generate the key stream needed for decryption, even when some
   datagrams are lost or reordered.

</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Encrypted Payload</h3>

<p>
    The encrypted payload contains the ciphertext.

</p>
<p>
    Camellia-CCM mode does not require plaintext padding.  However, ESP does
    require padding to 32-bit word-align the authentication data.  The
    Padding, Pad Length, and Next Header fields MUST be concatenated
    with the plaintext before performing encryption, as described in
    <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>.  When padding is required, it MUST be generated and checked
    in accordance with the conventions specified in <a class='info' href='#RFC4303'>[1]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>.

</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Authentication Data</h3>

<p>
   Camellia-CCM provides an encrypted ICV.  The ICV provided by CCM is
   carried in the Authentication Data fields without further encryption.
   Implementations MUST support ICV sizes of 8 octets and 16 octets.
   Implementations MAY also support ICV 12 octets.

</p>
<a name="NONCE"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.4"></a><h3>4.3.4.&nbsp;
Nonce Format</h3>

<p>
   Each packet conveys the IV that is necessary to construct the
   sequence of counter blocks used by counter mode to generate the key
   stream.  The Camellia counter block is 16 octets.  One octet is used for
   the CCM Flags, and 4 octets are used for the block counter, as
   specified by the CCM L parameter.  The remaining octets are the
   nonce.  These octets occupy the second through the twelfth octets in
   the counter block.  <a class='info' href='#Nonce CCM'>Figure&nbsp;5<span> (</span><span class='info'>Nonce Format of CCM</span><span>)</span></a> shows the format of the nonce.

</p><br /><hr class="insert" />
<a name="Nonce CCM"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                      |                  Salt                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     Initialization Vector                     |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Nonce Format of CCM&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
   The components of the nonce are as follows:

</p>
<blockquote class="text"><dl>
<dt>Salt</dt>
<dd>

The salt field is 24 bits.  As the name implies, it contains
         an unpredictable value.  It MUST be assigned at the beginning
         of the SA.  The salt value need not be
         secret, but it MUST NOT be predictable prior to the beginning
         of the SA.
</dd>
<dt>Initialization Vector</dt>
<dd>

 The IV field is 64 bits.  As described in
         Section 3.1, the IV MUST be chosen by the encryptor in a manner
         that ensures that the same IV value is used only once for a
         given key.

</dd>
</dl></blockquote>
<p>
   This construction permits each packet to consist of up to:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         2^32 blocks  =  4,294,967,296 blocks
                      = 68,719,476,736 octets
</pre></div>
<p>
   This construction provides more key stream for each packet than is
   needed to handle any IPv6 Jumbogram <a class='info' href='#RFC2675'>[14]<span> (</span><span class='info'>Borman, D., Deering, S., and R. Hinden, &ldquo;IPv6 Jumbograms,&rdquo; August&nbsp;1999.</span><span>)</span></a>.

</p>
<a name="AAD"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.5"></a><h3>4.3.5.&nbsp;
AAD Construction</h3>

<p>
   The data integrity and data origin authentication for the Security
   Parameters Index (SPI) and (Extended) Sequence Number fields is
   provided without encrypting them.  Two formats are defined: one for
   32-bit sequence numbers and one for 64-bit extended sequence numbers.
   The format with 32-bit sequence numbers is shown in <a class='info' href='#AAD32'>Figure&nbsp;6<span> (</span><span class='info'> AAD Format with 32-bit Sequence Number</span><span>)</span></a>, and the
   format with 64-bit extended sequence numbers is shown in <a class='info' href='#AAD64'>Figure&nbsp;7<span> (</span><span class='info'> AAD Format with 64-bit Sequence Number</span><span>)</span></a>.

</p>
<p>
   Sequence Numbers are conveyed canonical network byte order.  Extended
   Sequence Numbers are conveyed canonical network byte order, placing
   the high-order 32 bits first and the low-order 32 bits second.
   Canonical network byte order is fully described in RFC 791, Appendix
   B.

</p><br /><hr class="insert" />
<a name="AAD32"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                               SPI                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     32-bit Sequence Number                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6:  AAD Format with 32-bit Sequence Number&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="AAD64"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                               SPI                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                 64-bit Extended Sequence Number               |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7:  AAD Format with 64-bit Sequence Number&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IKE Conventions</h3>

<p>
   This section describes the transform ID and conventions used to generate keying
   material for use with ENCR_CAMELLIA_CBC, ENCR_CAMELLIA_CTR and
   ENCR_CAMELLIA_CCM using the Internet Key Exchange (IKEv2) <a class='info' href='#RFC4306'>[4]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
   
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Transform Type 1</h3>

<p>
   For IKEv2 negotiations, IANA has assigned five ESP Transform
   Identifiers for Camellia-CBC, Camellia-CTR and Camellia-CCM.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      &lt;TBD1&gt; for Camellia-CBC with explicit IV;
      &lt;TBD2&gt; for Camellia-CTR with explicit IV;
      &lt;TBD3&gt; for Camellia-CCM with an 8-octet ICV;
      &lt;TBD4&gt; for Camellia-CCM with a 12-octet ICV; and
      &lt;TBD5&gt; for Camellia-CCM with a 16-octet ICV.
</pre></div>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Key Length Attribute</h3>

<p>
   Since the Camellia supports three key lengths, the Key Length attribute
   MUST be specified in the IKE exchange <a class='info' href='#RFC4306'>[4]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.  The Key Length
   attribute MUST have a value of 128, 192, or 256.

</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Keying Material</h3>

<p>
    The size of KEYMAT MUST be equal or longer than the associated Camellia key.
    The keying material is used as follows:
</p>
<blockquote class="text"><dl>
<dt>Camellia-CBC with a 128-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CBC key is 16 octets. 
         The whole octets are the 128-bit Camellia key.
</dd>
<dt>Camellia-CBC with a 192-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CBC key is 24 octets. 
         The whole octets are the 192-bit Camellia key.
</dd>
<dt>Camellia-CBC with a 256-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CBC key is 32 octets. 
         The whole octets are the 256-bit Camellia key.
</dd>
<dt>Camellia-CTR with a 128-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CTR key is 20 octets.  The
         first 16 octets are the 128-bit Camellia key, and the remaining
         four octets are used as the nonce value in the counter block.
</dd>
<dt>Camellia-CTR with a 192-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CTR key is 28 octets.  The
         first 24 octets are the 192-bit Camellia key, and the remaining
         four octets are used as the nonce value in the counter block.
</dd>
<dt>Camellia-CTR with a 128-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CTR key is 36 octets.  The
         first 32 octets are the 256-bit Camellia key, and the remaining
         four octets are used as the nonce value in the counter block.
</dd>
<dt>Camellia-CCM with a 128-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CCM key is 19 octets.  The
         first 16 octets are the 128-bit Camellia key, and the remaining
         three octets are used as the salt value in the counter block.
</dd>
<dt>Camellia-CCM with a 192-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CCM key is 27 octets.  The
         first 24 octets are the 192-bit Camellia key, and the remaining
         three octets are used as the salt value in the counter block.
</dd>
<dt>Camellia-CCM with a 256-bit key</dt>
<dd>
    
         The KEYMAT requested for each Camellia-CCM key is 35 octets.  The
         first 32 octets are the 256-bit Camellia key, and the remaining
         three octets are used as the salt value in the counter block.
</dd>
</dl></blockquote>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
   Implementations are encouraged to use the largest key sizes they can,
   taking into account performance considerations for their particular
   hardware and software configuration.  Note that encryption
   necessarily affects both sides of a secure channel, so such
   consideration must take into account not only the client side, but
   also the server.  However, a key size of 128 bits is considered
   secure for the foreseeable future.

</p>
<p>
   Camellia-CTR and Camellia-CCM employs counter (CTR) mode for 
   confidentiality.  If a counter
   value is ever used for more that one packet with the same key, then
   the same key stream will be used to encrypt both packets, and the
   confidentiality guarantees are voided.

</p>
<p>
   What happens if the encryptor XORs the same key stream with two
   different packet plaintexts?  Suppose two packets are defined by two
   plaintext byte sequences P1, P2, P3 and Q1, Q2, Q3, then both are
   encrypted with key stream K1, K2, K3.  The two corresponding
   ciphertexts are:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      (P1 XOR K1), (P2 XOR K2), (P3 XOR K3)

      (Q1 XOR K1), (Q2 XOR K2), (Q3 XOR K3)

</pre></div>
<p>
   If both of these two ciphertext streams are exposed to an attacker,
   then a catastrophic failure of confidentiality results, because:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      (P1 XOR K1) XOR (Q1 XOR K1) = P1 XOR Q1
      (P2 XOR K2) XOR (Q2 XOR K2) = P2 XOR Q2
      (P3 XOR K3) XOR (Q3 XOR K3) = P3 XOR Q3
</pre></div>
<p>
   Once the attacker obtains the two plaintexts XORed together, it is
   relatively straightforward to separate them.  Thus, using any stream
   cipher, including Camellia-CTR, to encrypt two plaintexts under the same
   key stream leaks the plaintext.

</p>
<p>
   Therefore, Camellia-CTR and Camellia-CCM should not be used with statically configured
   keys.  Extraordinary measures would be needed to prevent the reuse of
   a counter block value with the static key across power cycles.  To be
   safe, implementations MUST use fresh keys with Camellia-CTR and 
   Camellia-CCM. The 
   IKEv2 <a class='info' href='#RFC4306'>[4]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> protocol can be used to establish fresh keys.

</p>
<p>
   When IKE is used to establish fresh keys between two peer entities,
   separate keys are established for the two traffic flows.  If a
   different mechanism is used to establish fresh keys, one that
   establishes only a single key to encrypt packets, then there is a
   high probability that the peers will select the same IV values for
   some packets.  Thus, to avoid counter block collisions, ESP
   implementations that permit use of the same key for encrypting and
   decrypting packets with the same peer MUST ensure that the two peers
   assign different salt values to the SA.

</p>
<p>
   Regardless of the mode used, Camellia with a 128-bit key is vulnerable to
   the birthday attack after 2^64 blocks are encrypted with a single
   key.  Since ESP with Extended Sequence Numbers allows for up to 2^64
   packets in a single SA, there is real potential for more than 2^64
   blocks to be encrypted with one key.  Implementations SHOULD generate
   a fresh key before 2^64 blocks are encrypted with the same key.  Note
   that ESP with 32-bit Sequence Numbers will not exceed 2^64 blocks
   even if all of the packets are maximum-length Jumbograms.

</p>
<p>
   No security problem has been found on Camellia <a class='info' href='#CRYPTREC'>[8]<span> (</span><span class='info'>Information-technology Promotion Agency (IPA), &ldquo;Cryptography Research and Evaluation Committees,&rdquo; .</span><span>)</span></a>, <a class='info' href='#NESSIE'>[7]<span> (</span><span class='info'>, &ldquo;The NESSIE project (New European Schemes for Signatures, Integrity and Encryption),&rdquo; .</span><span>)</span></a>.

</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>
   IANA has assigned five IKEv2 parameters
   for use with Camellia-CBC, Camellia-CTR and Camellia-CCM for
   Transform Type 1 (Encryption Algorithm):

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      &lt;TBD1&gt; for ENCR_CAMELLIA_CBC;
      &lt;TBD2&gt; for ENCR_CAMELLIA_CTR;
      &lt;TBD3&gt; for ENCR_CAMELLIA_CCM with an 8-octet ICV;
      &lt;TBD4&gt; for ENCR_CAMELLIA_CCM with a 12-octet ICV; and
      &lt;TBD5&gt; for ENCR_CAMELLIA_CCM with a 16-octet ICV.
</pre></div>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>
    We thank Tim Polk and Tero Kivinen for their initial review of this document.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4303">[1]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[2]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MODES">[3]</a></td>
<td class="author-text">Dworkin, M., &ldquo;<a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">Recommendation for Block Cipher Modes of Operation - Methods and Techniques</a>,&rdquo; NIST Special Publication&nbsp;800-38A, November&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[4]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS.197.2001">[5]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">Advanced Encryption Standard (AES)</a>,&rdquo; FIPS&nbsp;PUB 197, November&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO/IEC 18033-3">[6]</a></td>
<td class="author-text">International Organization for Standardization, &ldquo;Information technology - Security techniques - Encryption algorithms - Part 3: Block ciphers,&rdquo; ISO/IEC&nbsp;18033-3, July&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="NESSIE">[7]</a></td>
<td class="author-text">&ldquo;<a href="http://www.cosic.esat.kuleuven.ac.be/nessie/">The NESSIE project (New European Schemes for Signatures, Integrity and Encryption)</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="CRYPTREC">[8]</a></td>
<td class="author-text">Information-technology Promotion Agency (IPA), &ldquo;<a href="http://www.ipa.go.jp/security/enc/CRYPTREC/index-e.html">Cryptography Research and Evaluation Committees</a>&rdquo; (<a href="http://www.ipa.go.jp/security/enc/CRYPTREC/index-e.html.">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3713">[9]</a></td>
<td class="author-text">Matsui, M., Nakajima, J., and S. Moriai, &ldquo;<a href="http://tools.ietf.org/html/rfc3713">A Description of the Camellia Encryption Algorithm</a>,&rdquo; RFC&nbsp;3713, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3713.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[10]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2411">[11]</a></td>
<td class="author-text"><a href="mailto:mailto:rodney@sabletech.com">Thayer, R.</a>, <a href="mailto:naganand@baynetworks.com">Doraswamy, N.</a>, and <a href="mailto:rob.glenn@nist.gov">R. Glenn</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2411">IP Security Document Roadmap</a>,&rdquo; RFC&nbsp;2411, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2411.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2411.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2411.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="CTRCCM">[12]</a></td>
<td class="author-text"><a href="mailto:akato@po.ntts.co.jp">Kato, A.</a> and <a href="mailto:kanda.masayuki@lab.ntt.co.jp">M. Kanda</a>, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-kato-camellia-ctrccm-00.txt">Camellia Counter mode and Camellia Counter with CBC Mac mode algorithms</a>,&rdquo; draft-kato-camellia-ctrccm-00 (work in progress), November&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="CMAC">[13]</a></td>
<td class="author-text"><a href="mailto:akato@po.ntts.co.jp">Kato, A.</a>, <a href="mailto:kanda.masayuki@lab.ntt.co.jp">Kanda, M.</a>, and <a href="mailto:iwata@cse.nagoya-u.ac.jp">T. Iwata</a>, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-kato-ipsec-camellia-cmac96and128-02.txt">The Camellia-CMAC-96 and Camellia-CMAC-PRF-128 Algorithms and Its Use with IPsec</a>,&rdquo; draft-kato-ipsec-camellia-cmac96and128-02 (work in progress), November&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2675">[14]</a></td>
<td class="author-text"><a href="mailto:dab@bsdi.com">Borman, D.</a>, <a href="mailto:deering@cisco.com">Deering, S.</a>, and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2675">IPv6 Jumbograms</a>,&rdquo; RFC&nbsp;2675, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2675.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Akihiro Kato</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NTT Software Corporation</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-45-212-7577</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+81-45-212-7800</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:akato@po.ntts.co.jp">akato@po.ntts.co.jp</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Masayuki Kanda</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nippon Telegraph and Telephone Corporation</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-422-59-3456</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+81-422-59-4015</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kanda.masayuki@lab.ntt.co.jp">kanda.masayuki@lab.ntt.co.jp</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
