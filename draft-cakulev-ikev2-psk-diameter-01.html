<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Diameter IKEv2: Support for Interaction between IKEv2 Server and Diameter Server</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Diameter IKEv2: Support for Interaction between IKEv2 Server and Diameter Server">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">V. Cakulev</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Alcatel Lucent</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">A. Lior</td></tr>
<tr><td class="header">Expires: June 25, 2010</td><td class="header">Bridgewater Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">December 22, 2009</td></tr>
</table></td></tr></table>
<h1><br />Diameter IKEv2: Support for Interaction between IKEv2 Server and Diameter Server<br />draft-cakulev-ikev2-psk-diameter-01.txt</h1>

<h3>Abstract</h3>

<p>Internet Key Exchange is a component of IPsec used for 
performing mutual authentication as well as establishing and maintaining 
security associations (SAs) between two parties such as a user and a network 
entity. Internet Key Exchange v2 (IKEv2) protocol allows several different 
mechanisms for authenticating a user, namely the Extensible Authentication 
Protocol, certificates, and pre-shared secrets. To authenticate and/or 
authorize the user, the network element such as the Access Gateway may need to 
dynamically bootstrap a security association based on interaction with the 
Diameter server. This document specifies the interaction between the Access 
Gateway and Diameter server for the IKEv2 based on pre-shared 
secrets.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 25, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Requirements notation<br />
<a href="#anchor3">3.</a>&nbsp;
Application Identifier<br />
<a href="#anchor4">4.</a>&nbsp;
Protocol Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Support for IKEv2 and Pre-Shared Secrets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Session Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.1.</a>&nbsp;
Session-Termination-Request/Answer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.2.</a>&nbsp;
AbortSession-Request/Answer<br />
<a href="#ccsection">5.</a>&nbsp;
Command Codes for Diameter IKEv2 with PSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#request">5.1.</a>&nbsp;
IKEv2-PSK-Request (IKEPSKR) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#answer">5.2.</a>&nbsp;
IKEv2-PSK-Answer (IKEPSKA) Command<br />
<a href="#avps">6.</a>&nbsp;
Attribute Value Pair Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#msa">6.1.</a>&nbsp;
The Master-Security-Association<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#key">6.1.1.</a>&nbsp;
Key<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lifetime">6.1.2.</a>&nbsp;
MSA-Lifetime<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#spi">6.1.3.</a>&nbsp;
MSA-SPI<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#nonces">6.2.</a>&nbsp;
IKEv2-Nonces<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Nr">6.2.1.</a>&nbsp;
Ni<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Ni">6.2.2.</a>&nbsp;
Nr<br />
<a href="#anchor9">7.</a>&nbsp;
AVP Occurrence Tables<br />
<a href="#anchor10">8.</a>&nbsp;
AVP Flag Rules<br />
<a href="#anchor11">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">9.1.</a>&nbsp;
Command Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">9.2.</a>&nbsp;
AVP Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">9.3.</a>&nbsp;
Application Identifier<br />
<a href="#anchor15">10.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p><a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> defines IKEv2 as a protocol that 
performs mutual 
authentication between two parties and establishes a security association 
(SA) that includes shared secret information that can be used to efficiently 
establish SAs for Encapsulating Security Payload (ESP) <a class='info' href='#RFC4303'>[RFC4303]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> and/or 
Authentication Header (AH) <a class='info' href='#RFC4302'>[RFC4302]<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a>, and a set of cryptographic algorithms to 
be used by the SAs to protect the traffic that they carry. IKEv2 protocol 
allows several different mechanisms for authenticating a IKEv2 Peer to be used,
 such as the Extensible Authentication Protocol, certificates, and pre-shared 
secrets.
</p>
<p>From a service provider perspective it is important to ensure that a user 
is 
authorized to use the services. Therefore, the IKEv2 Server must verify that 
the IKEv2 Peer is authorized for the requested services possibly with the 
assistance of the operator’s Diameter servers.  Moreover, this document does 
not assume that the IKEv2 Server has the pre-shared secrets (PSK) with the 
IKEv2 Peer. Instead, it allows for PSK to be derived for a specific IKEv2 
session and exchanged between IKEv2 Server and HAAA. This is accomplished 
through the use of a new Diameter application specifically designed for 
performing IKEv2 authorization decisions.  This document specifies the 
Diameter support for shared secrets (PSK) based IKEv2.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
            "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
            and "OPTIONAL" in this document are to be interpreted as
            described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Application Identifier</h3>

<p>This specification defines a new Diameter application and its
   respective Application Identifier:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Diameter IKE PSK  (IKEPSK)  TBD by IANA

</pre></div>
<p>The IKEPSK Application Identifier is used when the IKEv2 Peer is to be authenticated
   and authorized using IKEv2 with PSK-based authentication. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Description</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Support for IKEv2 and Pre-Shared Secrets</h3>

<p>When IKEv2 is used with PSK-based initiator authentication, 
the Diameter commands IKEv2-PSK-Request and IKEv2-PSK-Answer defined in this 
document are used to authorize the IKEv2 Peer for the services.  Upon 
receiving the IKE_AUTH message from the IKEv2 Peer, the IKEv2 Server uses the 
information received in IDi to determine if it has the PSK for this IKEv2 Peer. 
If there is no PSK found associated with this IKEv2 Peer, the IKEv2 Server 
MUST send an Authorize-Only (Auth-Request-Type set to “Authorize-Only”) 
Diameter IKEv2-PSK message with the IKEv2 Peer’s IDi payload to the HAAA to 
obtain the PSK. The IDi payload extracted from the IKE_AUTH message has to 
contain an identity that is meaningful for the Diameter infrastructure, such 
as a Network Access Identifier (NAI), since it is used by the IKEv2 Server to 
populate the User-Name AVP in the Diameter message. The IKEv2 Server also 
includes in the IKEv2-Nonces AVP of the same Diameter message the 
initiator and responder nonces (Ni and Nr) exchanged during initial IKEv2 
exchange.  
</p>
<p>This message is routed to the IKEv2 Peer’s HAAA. Upon receiving Diameter 
IKEv2-PSK message from the IKEv2 Server, the HAAA shall use the User-Name 
AVP to retrieve the associated keying material. The HAAA SHALL use the 
nonces Ni and Nr received in IKEv2-Nonces AVP to generate the PSK. 
   It is outside of scope of this document how the 
HAAA obtains or generates the PSK. For example, if the HAAA previously 
performed EAP based access authentication and authorization of the IKEv2 Peer, 
it can use the available EMSK to generate the PSK <a class='info' href='#RFC5295'>[RFC5295]<span> (</span><span class='info'>Salowey, J., Dondeti, L., Narayanan, V., and M. Nakhjiri, &ldquo;Specification for the Derivation of Root Keys from an Extended Master Session Key (EMSK),&rdquo; August&nbsp;2008.</span><span>)</span></a>.  The HAAA returns the PSK 
to the IKEv2 Server using the Master-Security-Association AVP. 
</p>
<p>Once the IKEv2 Server receives the PSK from the HAAA, the IKEv2 Server 
verifies the IKE_AUTH message received from the IKEv2 Peer. If the 
verification of AUTH is successful, the IKEv2 Server sends the IKE message 
back to the IKEv2 Peer. 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Session Management</h3>

<p>The HAAA may maintain state or may be stateless.  This is indicated by 
presence or absence of the Auth-Session-State AVP.  The IKEv2 Server MUST 
support the Authorization Session State Machine defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
</p>
<p>This specification makes an assumption that each IKE_SA created between the 
IKEv2 Peer and the IKEv2 Server as a result of a successful IKEv2 negotiation 
exchange together with CHILD_SAs set up through that particular IKE_SA 
correspond to one currently active PSK and one active Diameter session. 
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Session-Termination-Request/Answer</h3>

<p>In the case where session tracking is being used, when the IKEv2 Server 
terminates the SA it SHALL send a Session-Termination-Request (STR) message 
<a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> to inform the HAAA that the authorized session has been 
terminated.
</p>
<p>The Session-Termination-Answer (STA) message [RFC3588] is sent by the 
HAAA to acknowledge the notification that the session has been terminated.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
AbortSession-Request/Answer</h3>

<p>The Abort-Session-Request (ASR) message <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the HAAA to 
the IKEv2 Server to terminate the authorized session.  When the IKEv2 Server 
receives the ASR message, it MUST delete the corresponding IKE_SA and all 
CHILD_SAs set up through it.  
</p>
<p>The Abort-Session-Answer (ASA) message <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the IKEv2 Server 
in response to an ASR message.
</p>
<a name="ccsection"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Command Codes for Diameter IKEv2 with PSK</h3>

<p>This section defines new Command-Code values that MUST be supported by all 
Diameter implementations conforming to this specification.
</p><br /><hr class="insert" />
<a name="CCtable"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Command-Name</th><th align="center">Abbrev.</th><th align="center">Code</th><th align="center">Reference</th><th align="center">Application</th></tr>
<tr>
<td align="center">IKEv2-PSK-Request</td>
<td align="center">IKEPSKR</td>
<td align="center">TBD</td>
<td align="center"><a class='info' href='#request'>Section&nbsp;5.1<span> (</span><span class='info'>IKEv2-PSK-Request (IKEPSKR) Command</span><span>)</span></a></td>
<td align="center">IKEPSK</td>
</tr>
<tr>
<td align="center">IKEv2-PSK-Answer</td>
<td align="center">IKEPSKA</td>
<td align="center">TBD</td>
<td align="center"><a class='info' href='#answer'>Section&nbsp;5.2<span> (</span><span class='info'>IKEv2-PSK-Answer (IKEPSKA) Command</span><span>)</span></a></td>
<td align="center">IKEPSK</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Command Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
IKEv2-PSK-Request (IKEPSKR) Command</h3>

<p>The IKEv2-PSK-Request message, indicated with the Command-Code set to TBD and 
the 'R' bit set in the Command Flags field is sent from the IKEv2 Server to the 
HAAA to initiate IKEv2 with PSK authorization. In this case, the
   Application-ID field of the Diameter Header MUST be set to the
   Diameter IKE PSK Application ID (value of TDB). 
</p>
<p>Message format
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      &lt;IKEv2-PSK-Request&gt; ::= &lt; Diameter Header: TBD, REQ, PXY &gt;
	                      &lt; Session-Id &gt;
 			      { Auth-Application-Id }
  			      { Origin-Host }
			      { Origin-Realm }
			      { Destination-Realm }
			      { Auth-Request-Type }
			      [ Destination-Host ]
			      [ NAS-Identifier ]
			      [ NAS-IP-Address ]
			      [ NAS-IPv6-Address ]
			      [ NAS-Port ]
			      [ Origin-State-Id ]
			      { User-Name }
			      [ Auth-Session-State ]
			      { IKEv2-Nonces }
			    * [ Proxy-Info ]
			    * [ Route-Record ]
			      ...
			    * [ AVP ]
</pre></div><p>


</p>
<p>IKEv2-PSK-Request message MUST 
include a IKEv2-Nonces AVP containing Ni and Nr nonces exchanged during 
initial IKEv2 exchange.
</p>
<a name="answer"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
IKEv2-PSK-Answer (IKEPSKA) Command</h3>

<p>The IKEv2-PSK-Answer (IKEPSKA) message, indicated by the Command-Code field 
set to TBD and the 'R' bit cleared in the Command Flags field, is sent 
by the HAAA to the IKEv2 Server in response to the IKEPSKR command. In this case, the
   Application-ID field of the Diameter Header MUST be set to the
   Diameter Mobile IPv6 IKE PSK Application ID (value of TDB). 
</p>
<p>Message format
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
	&lt;IKEv2-PSK-Answer&gt; ::= &lt; Diameter Header: TBD, PXY &gt;
			       &lt; Session-Id &gt;
			       { Auth-Application-Id }
			       { Auth-Request-Type }
			       { Result-Code }
			       { Origin-Host }
 		               { Origin-Realm }
			       [ User-Name ]
			       [Master-Security-Association ]
			       [ Error-Message ]
			       [ Error-Reporting-Host ]
			     * [ Failed-AVP ]
			       [ Origin-State-Id ]
	                     * [ Redirect-Host ]
			       [ Redirect-Host-Usage ]
			       [ Redirect-Max-Cache-Time ]
			     * [ Proxy-Info ]
			     * [ Route-Record ]
			       ...
			     * [ AVP ]
</pre></div><p>


</p>
<p>If the authorization procedure was successful then the IKEv2-PSK-Answer message shall include the 
Master-Security-Association. 
</p>
<a name="avps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Attribute Value Pair Definitions</h3>

<p>This section defines new AVPs for the IKEv2 with PSK.
</p>
<a name="msa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
The Master-Security-Association</h3>

<p>The Master-Security-Association AVP (AVP Code TBD) is of type Grouped 
and contains the session related information for use with the PSK based 
IKEv2.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Master-Security-Association::= &lt; AVP Header: TBD &gt;
				     { Key }
				     [ MSA-Lifetime ]
				     [ MSA-SPI ]
				   * [ AVP ]
</pre></div><p>


</p>
<a name="key"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Key</h3>

<p>Key AVP (AVP Code TBD) is of type OctetString and contains the PSK.  
The PSK is placed in this AVP most significant byte first. Exactly how 
the PSK is derived is beyond the scope of this document. 
</p>
<a name="lifetime"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
MSA-Lifetime</h3>

<p>MSA-Lifetime AVP (AVP Code TBD) is of type Unsigned32 and represents 
the period of time (in seconds) for which the PSK is valid.  The associated 
PSK shall not be used if the lifetime has expired.
</p>
<a name="spi"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3"></a><h3>6.1.3.&nbsp;
MSA-SPI</h3>

<p>MSA-SPI AVP (AVP Code TBD) is of is of type Unsigned32 and contains an 
SPI associated with the PSK. 
</p>
<a name="nonces"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
IKEv2-Nonces</h3>

<p>The IKEv2-Nonces AVP (Code TBD) is of type Grouped and contains the 
nonces exchanged between the IKEv2 Peer and the IKEv2 Server during IKEv2 
initial exchange. The nonces are used for PSK generation.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            IKEv2-Nonces ::= &lt; AVP Header: TBD&gt;
			     {Ni}
			     {Nr}
			    *[AVP]
</pre></div><p>


</p>
<a name="Nr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Ni</h3>

<p>The Ni AVP (AVP Code TBD) is of type Unsigned32 and contains the IKEv2 
initiator nonce.
</p>
<a name="Ni"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Nr</h3>

<p>The Nr AVP (AVP Code TBD) is of type Unsigned32 and contains the IKEv2 
responder nonce.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
AVP Occurrence Tables</h3>

<p>The following tables present the AVPs defined in this document and their occurrences in
        Diameter messages. Note that AVPs that can only be present within a Grouped AVP are not
        represented in this table.
</p>
<p>The table uses the following symbols:
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>0:</dt>
<dd><br />
The AVP MUST NOT be present in the
              message.<br />
<br />

</dd>
<dt>0+:</dt>
<dd><br />
Zero or more instances of the AVP MAY be present
            in the message.<br />
<br />

</dd>
<dt>0-1:</dt>
<dd><br />
Zero or one instance of the AVP MAY be present
            in the message.<br />
<br />

</dd>
<dt>1:</dt>
<dd><br />
One instance of the AVP MUST be present in the
            message. 
</dd>
</dl></blockquote><p>
      
</p>
<p>
          <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                  +-------------------+
                                  |   Command-Code    |
                                  |---------+---------+
   AVP Name                       | IKEPSKR | IKEPSKA |
   -------------------------------|---------+---------+
   Master-Security-Association    |    0    |   0-1   |
   IKEv2-Nonces                   |   0-1   |    0    |
                                  +---------+---------+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;IKEPSKR and IKEPSKA Commands AVP Table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
AVP Flag Rules</h3>

<p>The following table describes the Diameter AVPs, their AVP Code  
values, types, possible flag values, and whether the AVP MAY be encrypted. 
The Diameter base <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> specifies the AVP Flag rules for AVPs in Section 4.5. 
</p>
<p>
        <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                            +--------------------+
                                            |   AVP Flag rules   |
                                            +----+---+------+----+----+
                   AVP  Defined             |    |   |SHOULD|MUST|MAY |
 Attribute Name    Code in       Value Type |MUST|MAY| NOT  | NOT|Encr|
+-------------------------------------------+----+---+------+----+----+
|Master-Security-  TBD  6.1      Grouped    |  M | P |      | V  | Y  |
|  Association                              |    |   |      |    |    |
+-------------------------------------------+----+---+------+----+----+
|Key               TBD  6.1.1    OctetString|  M | P |      | V  | Y  |
+-------------------------------------------+----+---+------+----+----+
|MSA-Lifetime      TBD  6.1.2    Unsigned32 |  M | P |      |    |    |
+-------------------------------------------+----+---+------+----+----+
|MSA-SPI           TBD  6.1.3    Unsigned32 |  M | P |      | V  | Y  |
+-------------------------------------------+----+---+------+----+----+
|IKEv2-Nonces      TBD  6.2      Grouped    |  M | P |      | V  | Y  |
+-------------------------------------------+----+---+------+----+----+
|Ni                TBD  6.2.1    Unsigned32 |  M | P |      | V  | Y  |
+-------------------------------------------+----+---+------+----+----+
|Nr                TBD  6.2.2    Unsigned32 |  M | P |      | V  | Y  |
+-------------------------------------------+----+---+------+----+----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AVP Flag Rules Table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This section contains the namespaces that have either been created 
in this specification or had their values assigned to existing namespaces 
managed by IANA.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Command Codes</h3>

<p>IANA is requested to allocate a command code value for the IKEv2-PSK-Request 
message (IKEPSKR) and for the IKEv2-PSK-Answer message (IKEPSKA) from the Command Code 
namespace defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.  See <a class='info' href='#ccsection'>Section&nbsp;5<span> (</span><span class='info'>Command Codes for Diameter IKEv2 with PSK</span><span>)</span></a> for the assignment of the namespace 
in this specification.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
AVP Codes</h3>

<p> This specification requires IANA to register the following new AVPs from the AVP Code
          namespace defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.<br />
<br />

          </p>
<ul class="text">
<li>Master-Security-Association
</li>
<li>Key
</li>
<li>MSA-Lifetime
</li>
<li>MSA-SPI
</li>
<li>IKEv2-Nonces
</li>
<li>Ni
</li>
<li>Nr
</li>
</ul><br />
<br />
<p>The AVPs are defined in <a class='info' href='#avps'>Section&nbsp;6<span> (</span><span class='info'>Attribute Value Pair Definitions</span><span>)</span></a>.
        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Application Identifier</h3>

<p> This specification requires IANA to allocate one new
          value "Diameter IKE PSK" 
	  from the Application Identifier namespace defined
          in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Application Identifier         | Value
-------------------------------+------
Diameter IKE PSK (IKEPSK)      | TBD

</pre></div>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>Any authentication and key agreement protocol with pre-shared keys between 
an end-user client and AAA infrastructure relies on the assumption that the 
client and network can mutually authenticate each other. In context of, for 
example, 3GPP networks, the HAAA sharing a PSK with the IKEv2 Server is similar 
to the HSS sharing an authentication vector with the SGSN or MME in AKA based 
mutual authentication protocols.  
</p>
<p> The basic security assumptions in sharing the PSK are based on the 
following standard considerations.
</p>
<ul class="text">
<li> The security tunnel between the HAAA and the IKEv2 Server is typically 
a mutually authenticated tunnel, with ciphering and integrity protection for 
every packet. The existence of such tunnels ensures that on-going trust and 
security are enforced, and in particular the HAAA can guarantee that the 
IKEv2 Server is not misbehaving. 
</li>
<li> The protocol under discussion relies on the fact an IKEv2 Peer has 
successfully authenticated with the system and has, for example, an EMSK 
stored in the HAAA. The fact that the PSK is derived from the EMSK proves 
to the HAAA of the existence of an authenticated and active IKEv2 Peer. 
</li>
<li>If the HAAA is to treat an IKEv2 Server as adversarial, then we claim 
that under no circumstances can an IKEv2 Peer communicate with that IKEv2 
Server. Recall that any authentication and key agreement protocol with 
pre-shared keys between an end-user client and AAA infrastructure relies 
on the assumption that the client and network can mutually authenticate 
each other, and furthermore the client trusts the network elements that 
the AAA communicates with and delegates post authentication security 
parameters to be legitimate. If the HAAA is to treat the IKEv2 Server 
as adversarial, then the trust assumption is no longer valid. This in 
turn implies that the IKEv2 Peer is no longer guaranteed that the 
network elements it is communicating with are trusted. 
</li>
</ul><br />
<br />
<p> 
</p>
<p>Hence the following two assumptions are critical to ensure 
secure communications:
</p>
<ul class="text">
<li> The HAAA server and the IKEv2 Server share a trust relationship; 
for instance, may be owned and managed by the same network operator. 
</li>
<li>Moreover, transfer of keys between the HAAA and the IKEv2 Server 
rely on an existing security association between the above network 
elements.
</li>
</ul><br />
<br />
<p> 
</p>
<p> In addition, the security considerations of the Diameter Base 
protocol <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> are applicable to this document. 
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3588">[RFC3588]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4302">[RFC4302]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4302">IP Authentication Header</a>,&rdquo; RFC&nbsp;4302, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4302.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4303">[RFC4303]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5295">[RFC5295]</a></td>
<td class="author-text">Salowey, J., Dondeti, L., Narayanan, V., and M. Nakhjiri, &ldquo;<a href="http://tools.ietf.org/html/rfc5295">Specification for the Derivation of Root Keys from an Extended Master Session Key (EMSK)</a>,&rdquo; RFC&nbsp;5295, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5295.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Violeta Cakulev</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">600 Mountain Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3D-517</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Murray Hill, NJ  07974</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 908 582 3207</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cakulev@alcatel-lucent.com">cakulev@alcatel-lucent.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Avi Lior</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bridgewater Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">303 Terry Fox Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otawa, Ontario  K2K 3J1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 613-591-6655</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:avi@bridgewatersystems.com">avi@bridgewatersystems.com</a></td></tr>
</table>
</body></html>
