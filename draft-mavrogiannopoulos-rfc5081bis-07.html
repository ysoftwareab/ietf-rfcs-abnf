<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Using OpenPGP Keys for Transport Layer Security (TLS)
      Authentication</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Using OpenPGP Keys for Transport Layer Security (TLS)
      Authentication">
<meta name="keywords" content="OpenPGP, Certificate type negotiation, TLS, Transport Layer Security">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">N. Mavrogiannopoulos</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">KUL</td></tr>
<tr><td class="header">Obsoletes: <a href='http://tools.ietf.org/html/rfc5081'>5081</a> (if&nbsp;approved)</td><td class="header">D. Gillmor</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">Independent</td></tr>
<tr><td class="header">Expires: March 20, 2011</td><td class="header">September 16, 2010</td></tr>
</table></td></tr></table>
<h1><br />Using OpenPGP Keys for Transport Layer Security (TLS)
      Authentication<br />draft-mavrogiannopoulos-rfc5081bis-07</h1>

<h3>Abstract</h3>

<p>
	This memo proposes extensions to the Transport Layer Security (TLS) protocol to support
	the OpenPGP key format.  The extensions discussed here
	include a certificate type negotiation mechanism, and the required
	modifications to the TLS Handshake Protocol.  This memo replaces the
	Experimental <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>. 

         
</p>
<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on March 20, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#terms">2.</a>&nbsp;
Terminology<br />
<a href="#hsmod">3.</a>&nbsp;
Changes to the Handshake Message Contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#clihello">3.1.</a>&nbsp;
Client Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#servhello">3.2.</a>&nbsp;
Server Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#servcert">3.3.</a>&nbsp;
Server Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certreq">3.4.</a>&nbsp;
Certificate Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#clicert">3.5.</a>&nbsp;
Client Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#resthsk">3.6.</a>&nbsp;
Other Handshake Messages<br />
<a href="#security">4.</a>&nbsp;
Security Considerations<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor1">6.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#changes">Appendix&nbsp;A.</a>&nbsp;
Changes from RFC 5081<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
The IETF has two sets of standards for public key certificates,
one set for use of X.509 certificates <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> and one for
OpenPGP certificates <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>. At the time of writing,
TLS <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> standards are defined to use X.509 certificates.
This document specifies a way to negotiate use of OpenPGP certificates for a TLS 
session, and specifies how to transport OpenPGP certificates via TLS. The 
proposed extensions are backward compatible with the current TLS 
specification, so that existing client and server implementations 
that make use of X.509 certificates are not affected. 
	
</p>
<p>
The major changes from <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> are summarized in <a class='info' href='#changes'>Appendix&nbsp;A<span> (</span><span class='info'>Changes from RFC 5081</span><span>)</span></a>. 

        
</p>
<a name="terms"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
             The term "OpenPGP key" is used in this document as in the OpenPGP specification 
             <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>. We use the term "OpenPGP certificate" to refer to
             OpenPGP keys that are enabled for authentication.
         
</p>
<p>
           This document uses the same notation and terminology used in the TLS Protocol specification
           <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
	 
</p>
<p>
         The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
         NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
         "OPTIONAL" in this document are to be interpreted as described in
         <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
         
</p>
<a name="hsmod"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Changes to the Handshake Message Contents</h3>

<p>
	This section describes the changes to the TLS handshake message
	contents when OpenPGP certificates are to be used for authentication. 
            
</p>
<a name="clihello"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Client Hello</h3>

<p>
		   In order to indicate the support of multiple certificate types, clients MUST include an
                   extension of type "cert_type" to the extended client hello
                   message. The "cert_type" TLS extension is assigned the value of 9 from the TLS
                   ExtensionType registry. This value is used as the extension number 
                   for the extensions in both the client hello message and the server hello message. 
                   The hello extension mechanism is described in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
              
</p>
<p>
		   This extension carries a list of supported certificate types the client can use, sorted
                   by client preference. This extension MUST be omitted if the client only supports X.509
                   certificates. The "extension_data" field of this extension contains a
                   CertificateTypeExtension structure. Note that the
		   CertificateTypeExtension structure is being used both by
		   the client and the server, although specified once in
		   this document, a practice common in the TLS protocol
		   specification <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
            
</p>
<p>
              </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   enum { client, server } ClientOrServerExtension;

   enum { X.509(0), OpenPGP(1), (255) } CertificateType;

   struct {
      select(ClientOrServerExtension) {
         case client:
            CertificateType certificate_types&lt;1..2^8-1&gt;;
         case server:
            CertificateType certificate_type;
      }
   } CertificateTypeExtension;
</pre></div><p>

	    
</p>
<p>
                No new cipher suites are required to use OpenPGP certificates. 
                All existing cipher suites that support a key exchange method
                compatible with the key in the certificate can be used in combination 
                with OpenPGP certificates.
            
</p>
<a name="servhello"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Server Hello</h3>

<p>
If the server receives a client hello that contains the "cert_type" extension and 
chooses a cipher suite that requires a certificate, then two outcomes are possible.  
The server MUST either select a certificate type from the certificate_types
field in the extended client hello or terminate the session with a fatal alert of type
"unsupported_certificate".
		
</p>
<p>
		   The certificate type selected by the server is encoded in a CertificateTypeExtension structure, 
		   which is included in the extended server hello message using an extension of type "cert_type". 
		   Servers that only support X.509 certificates MAY omit including the "cert_type" extension in the extended server hello. 
		
</p>
<a name="servcert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Server Certificate</h3>

<p>
		   The contents of the certificate message sent from server to client and vice versa are 
		   determined by the negotiated certificate type and the selected cipher suite's key exchange algorithm. 
		
</p>
<p>
		   If the OpenPGP certificate type is negotiated, then it is required to present an OpenPGP certificate in 
		   the certificate message. The certificate must contain a public key that matches the selected key 
		   exchange algorithm, as shown below.
		
</p>
<p>
	    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Key Exchange Algorithm  OpenPGP Certificate Type

   RSA                     RSA public key that can be used for
                           encryption.

   DHE_DSS                 DSA public key that can be used for
                           authentication.

   DHE_RSA                 RSA public key that can be used for
                           authentication.
</pre></div><p>

	       
</p>
<p>
		   An OpenPGP certificate appearing in the certificate message is sent using 
                   the binary OpenPGP format. The certificate MUST contain all the elements required by
                   Section 11.1 of <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
               
</p>
<p>
                   OpenPGP certificates to be transferred are placed in the
                   Certificate structure and tagged with the OpenPGPCertDescriptorType
                   "subkey_cert". Since those certificates might contain several subkeys
                   the subkey ID to be used for this session is explicitely
                   specified in the OpenPGPKeyID field.
                   The key ID must be specified even if the certificate has only a primary key.
                   The peer once receiving this type has to either use the specified subkey
                   or terminate the session with a fatal alert of "unsupported_certificate". 
               
</p>
<p>
		   The option is also available to send an OpenPGP fingerprint, instead of sending the
                   entire certificate, by using the "subkey_cert_fingerprint" tag.
		   This tag uses the OpenPGPSubKeyFingerprint structure
		   and requires the primary key fingerprint to be specified, as well
		   as the subkey ID to be used for this session.
		   The peer shall respond with a "certificate_unobtainable" fatal alert if the certificate
                   with the given fingerprint cannot be found.  The "certificate_unobtainable" fatal alert
                   is defined in Section 5 of <a class='info' href='#I-D.ietf-tls-rfc4366-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4366&#8209;bis]<span> (</span><span class='info'>3rd, D., &ldquo;Transport Layer Security (TLS) Extensions: Extension Definitions,&rdquo; July&nbsp;2010.</span><span>)</span></a>.
               
</p>
<p>
                   Implementations of this protocol MUST ensure that the sizes,
                   of key IDs and fingerprints, in the
                   OpenPGPSubKeyCert and OpenPGPSubKeyFingerprint structures
                   comply with <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
                   Moreover it is RECOMMENDED that the keys to be used with this 
                   protocol have the authentication flag (0x20) set.
               
</p>
<p>
                   The process of fingerprint generation is described in Section 12.2 of 
                   <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>. 
               
</p>
<p>
               	   The enumerated types "cert_fingerprint" and "cert" of OpenPGPCertDescriptorType
               	   that were defined in <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> are not
               	   used and are marked as obsolete by this document. The
               	   "empty_cert" type has replaced "cert" and is a backwards
               	   compatible way to specify an empty certificate;
               	   cert_fingerprint" MUST NOT be used with this updated 
               	   specification, and hence that old alternative has been removed 
               	   from the Certificate struct description.
               
</p>
<p>
	    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   enum {
        empty_cert(1),
        subkey_cert(2),
        subkey_cert_fingerprint(3),
        (255)
   } OpenPGPCertDescriptorType;

   uint24 OpenPGPEmptyCert = 0;

   struct {
       opaque OpenPGPKeyID&lt;8..255&gt;;
       opaque OpenPGPCert&lt;0..2^24-1&gt;;
   } OpenPGPSubKeyCert;

   struct {
       opaque OpenPGPKeyID&lt;8..255&gt;;
       opaque OpenPGPCertFingerprint&lt;20..255&gt;;
   } OpenPGPSubKeyFingerprint;

   struct {
        OpenPGPCertDescriptorType descriptorType;
        select (descriptorType) {
             case empty_cert: OpenPGPEmptyCert;
             case subkey_cert: OpenPGPSubKeyCert;
             case subkey_cert_fingerprint:
                 OpenPGPSubKeyCertFingerprint;
        }
   } Certificate;
</pre></div><p>

	       
</p>
<a name="certreq"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Certificate Request</h3>

<p>
		   The semantics of this message remain the same as in the TLS specification. 
                   However, if this message is sent, and the negotiated
                   certificate type is OpenPGP, the "certificate_authorities" list
                   MUST be empty.
               
</p>
<a name="clicert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Client Certificate</h3>

<p>
  		   This message is only sent in response to the certificate request message.
		   The client certificate message is sent using the same formatting as
		   the server certificate message, and it is also required to present a certificate that
		   matches the negotiated certificate type. If OpenPGP certificates have been selected and no certificate is 
		   available from the client, then a certificate structure
  		   of type "empty_cert" that contains an OpenPGPEmptyCert value MUST be sent. 
		   The server SHOULD respond with a "handshake_failure" fatal alert if client authentication 
		   is required. 
		
</p>
<a name="resthsk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Other Handshake Messages</h3>

<p>
		   All the other handshake messages are identical to the TLS specification.
		
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>
              All security considerations discussed in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>, 
              <a class='info' href='#I-D.ietf-tls-rfc4366-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4366&#8209;bis]<span> (</span><span class='info'>3rd, D., &ldquo;Transport Layer Security (TLS) Extensions: Extension Definitions,&rdquo; July&nbsp;2010.</span><span>)</span></a>, and <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a> apply to this document.
              Considerations about the use of the web of trust or identity
              and certificate verification
              procedure are outside the scope of this document. These are considered
              issues to be handled by the application layer protocols.
          
</p>
<p>
              The protocol for certificate type negotiation is
              identical in operation to ciphersuite negotiation of the <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> 
              specification with the addition of default values when the extension is 
              omitted. Since those omissions have a unique meaning and the same 
              protection is applied to the values as with ciphersuites, it is 
              believed that the security properties of this negotiation are the same 
              as with ciphersuite negotiation.
          
</p>
<p>
              When using OpenPGP fingerprints instead of the full certificates,
              the discussion in Section 6.3 of <a class='info' href='#I-D.ietf-tls-rfc4366-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4366&#8209;bis]<span> (</span><span class='info'>3rd, D., &ldquo;Transport Layer Security (TLS) Extensions: Extension Definitions,&rdquo; July&nbsp;2010.</span><span>)</span></a> for 
              "Client Certificate URLs" applies, especially when external servers are
              used to retrieve keys. However, a major difference is that although the "client_certificate_url"
              extension allows identifying certificates without including the certificate hashes, this
              is not possible in the protocol proposed here. 
              In this protocol, the certificates, when not sent, are always identified by their fingerprint, which 
              serves as a cryptographic hash of the certificate (see Section 12.2 of <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>).
          
</p>
<p>
              The information that is available to participating parties and 
              eavesdroppers (when confidentiality is not available through a previous 
              handshake) is the number and the 
              types of certificates they hold, plus the contents of certificates.
          
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
              This document uses a registry and the "cert_type" extension originally defined in <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>. Existing IANA references should be updated to
              point to this document.
          
</p>
<p>
              In addition the "TLS Certificate Types" registry established
              by <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> has to be updated in the following way:
                  </p>
<ol class="text">
<li>Values 0 (X.509) and 1 (OpenPGP) are defined in this document.
</li>
<li>Values from 2 through 223 decimal inclusive are assigned
                          via "RFC Required" <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</li>
<li>Values from 224 decimal through 255 decimal
                          inclusive are reserved for Private Use <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
                          
</li>
</ol><p>
                  
              
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>
	 The authors wish to thank Alfred Hoenes and Ted Hardie for their suggestions on improving this document.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc4366-bis">[I-D.ietf-tls-rfc4366-bis]</a></td>
<td class="author-text">3rd, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4366-bis-10.txt">Transport Layer Security (TLS) Extensions: Extension Definitions</a>,&rdquo; draft-ietf-tls-rfc4366-bis-10 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4366-bis-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4880">[RFC4880]</a></td>
<td class="author-text">Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;<a href="http://tools.ietf.org/html/rfc4880">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;4880, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4880.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5081">[RFC5081]</a></td>
<td class="author-text">Mavrogiannopoulos, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5081">Using OpenPGP Keys for Transport Layer Security (TLS) Authentication</a>,&rdquo; RFC&nbsp;5081, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5081.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
</table>

<a name="changes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Changes from RFC 5081</h3>

<p>
   	  This document incorporates a major change in the "Server
   	  Certificate" and "Client Certificate" TLS messages, that will make
   	  implementations following this protocol incompatible with ones
   	  following <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>. This change
   	  requires the subkey IDs used for TLS authentication to marked explicitely 
   	  in the handshake procedure. This was decided in order to place no limitation 
   	  on the OpenPGP certificates' contents that can be used with with
   	  this protocol.
          
</p>
<p>
          <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> required that an OpenPGP key or subkey
          was marked with the authentication flag and thus would have failed if
          this flag was not set, or this flag was set in more than one
          subkeys. The protocol in this memo has no such limitation.
          
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nikos
      Mavrogiannopoulos</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ESAT/COSIC Katholieke Universiteit Leuven</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kasteelpark Arenberg 10, bus 2446</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Leuven-Heverlee,   B-3001</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Belgium</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:nikos.mavrogiannopoulos@esat.kuleuven.be">nikos.mavrogiannopoulos@esat.kuleuven.be</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Daniel Kahn Gillmor</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Independent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">119 Herkimer St</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brooklyn, NY  11216-2801</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:dkg@fifthhorseman.net">dkg@fifthhorseman.net</a></td></tr>
</table>
</body></html>
