<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Automated (DNSSEC) Child Parent Synchronization using DNS UPDATE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Automated (DNSSEC) Child Parent Synchronization using DNS UPDATE">
<meta name="keywords" content="DNS, DNSSEC">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Domain Name System Operations</td><td class="header">W. Mekking</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NLnet Labs</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">June 29, 2010</td></tr>
<tr><td class="header">Expires: December 31, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Automated (DNSSEC) Child Parent Synchronization using DNS UPDATE<br />draft-mekking-dnsop-auto-cpsync-00</h1>

<h3>Abstract</h3>

<p> 
  This document proposes a way to synchronise existing trust anchors
  automatically between a child zone and its parent. The algorithm can
  be used for other Resource Records that are required to delegate
  from a parent to a child such as NS and glue records.

</p>
<h3>Requirements Language</h3>

<p>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, 
&quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
&quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;,
&quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be
interpreted as described in  <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on December 31, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>

<a name="anchor1"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> This memo defines a way to synchronise existing trust anchors
automatically between a child zone and its parent. The algorithm can
be used for other Resource Records that are required to delegate
from a parent to a child such as NS and glue records.

</p>
<p> To create a DNSSEC <a class='info' href='#RFC4035'>RFC 4035<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Protocol Modifications for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4035] chain of
trust, child zones must submit their DNSKEYs, or hashes of their
DNSKEYs, to their parent zone. The parent zone publishes the hashes
of the DNSKEYs in the form of a DS record. The DNSKEY RRset at the
child may change over time. In order to keep the chain of trust
intact, the DS records at the parent zone also needs to be updated.
The rolling of the keys with the SEP bit on is one of the few tasks
in DNSSEC that yet has to be fully automated.

</p>
<p>
The DNS UPDATE mechanism <a class='info' href='#RFC2136'>RFC 2136<span> (</span><span class='info'>Vixie, P., Thomson, S., Rekhter, Y., and J. Bound, &ldquo;Dynamic Updates in the Domain Name System (DNS UPDATE),&rdquo; April&nbsp;1997.</span><span>)</span></a> [RFC2136]
can be used to push zone changes to the parent.

</p>
<p>
To bootstrap the direct communication channel, information must be
exchanged in order to detect service location and granting update
privileges. A new or existing child zone can request a direct
communication channel with the parent. If the parent allows for direct
communication with child zones, the parent can share the required
data to set up the channel to the child zone. Once the child has the
required credentials, it can use the direct communication channel with
the parent to request zone changes related to its delegation.

</p>
<p>
If a third party is involved, the third party can act on behalf of the
parent. In this case, the third party will give out the required
credentials to set up the communication channel.

</p>
<p>
It is RECOMMENDED that the direct communication channel is secured
with TSIG <a class='info' href='#RFC2845'>[RFC2845]<span> (</span><span class='info'>Vixie, P., Gudmundsson, O., Eastlake, D., and B. Wellington, &ldquo;Secret Key Transaction Authentication for DNS (TSIG),&rdquo; May&nbsp;2000.</span><span>)</span></a> or SIG0 <a class='info' href='#RFC2931'>[RFC2931]<span> (</span><span class='info'>Eastlake, D., &ldquo;DNS Request and Transaction Signatures ( SIG(0)s),&rdquo; September&nbsp;2000.</span><span>)</span></a>.

</p>
<a name="acl"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Access and Update Control</h3>

<p> 
The DNS UPDATE normally is used for granting update permissions to a
machine that is within the boundary of the same organization. This
document proposes to grant child zones the same permissions. However,
it MUST NOT be possible that a child zone updates information in the
parent zone that falls outside the administrative domain of the
corresponding delegation. For example, it MUST NOT be possible for a
child zone to update the data that the parent is authoritative for, or
update a delegation that is pointed to a different child zone. It MUST
only be able to update records that match one of the following:

</p>
<p>
  </p>
<blockquote class="text"><dl>
<dt>Or: </dt>
<dd> 
    The owner name is equal the child zone name and RRtype is delegation
    specific. Currently those are records with RRtype NS or DS.
    
</dd>
<dt>Or: </dt>
<dd> 
    The owner name is a subdomain of the child zone name and RRtype is
    glue specific. Currently those are records with RRtype A or AAAA.
    
</dd>
</dl></blockquote><p>

</p>
<p>
This list may be expanded in the future, if there is need for more
delegation related zone content.

</p>
<p>
In case of adding or deleting delegation specific records, the DNSSEC
related RRs in the parent zone might need to be updated.

</p>
<p>
The service location may be handed out by the registrar during bootstrap
If this information is missing, the normal guidelines for sending DNS
UPDATE messages SHOULD be followed.

</p>
<a name="mechanism"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Update Mechanism</h3>

<a name="child"></a><br /><hr />
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Child Duties</h3>

<p>
  Updating the NS RRset or corresponding glue at the parent, an update can
  be sent at any time. Updating the DS RRset is part of key rollover, as
  described in RFC 4641 <a class='info' href='#RFC4641'>[RFC4641]<span> (</span><span class='info'>Kolkman, O. and R. Gieben, &ldquo;DNSSEC Operational Practices,&rdquo; September&nbsp;2006.</span><span>)</span></a>. When performing a key
  rollover that involves updating the RRset at the parent, the child
  introduces a new DNSKEY in its zone that represents the security entry
  point for determining the chain of trust. After a while, it will revoke
  and/or remove the previous security entry point. The timings when to 
  update the DS RRset at the parent are described in 
  <a class='info' href='#keytiming'>draft-dnsop-morris-dnssec-key-timing<span> (</span><span class='info'>Morris, S., Ihren, J., and J. Dickinson, &ldquo;DNSSEC Key Timing Considerations,&rdquo; March&nbsp;2010.</span><span>)</span></a> [keytiming].
  When updating the DS RRset at the parent automatically, these timing
  specifications SHOULD be followed. To determine the propagation delays
  described in this document, the child should poll the parent zone for
  a short time, until the DS is visible at all parent name servers.
  
</p>
<p>
  To discuss: A child zone might be unable to reach all parent name
  servers.
  
</p>
<p>
  The child notifies the parent of the requested changes by sending a DNS
  UPDATE message. If it receives a NOERROR reply in return, the update is
  acknowledged by the parent zone. Otherwise, the child MAY retry
  transmitting the update. In order to prevent duplicate updates, it SHOULD
  follow the guidelines described in RFC 2136 <a class='info' href='#RFC2136'>[RFC2136]<span> (</span><span class='info'>Vixie, P., Thomson, S., Rekhter, Y., and J. Bound, &ldquo;Dynamic Updates in the Domain Name System (DNS UPDATE),&rdquo; April&nbsp;1997.</span><span>)</span></a>.
  
</p>
<a name="parent"></a><br /><hr />
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Parent Duties</h3>

<p>
  When the master DNS server of the parent receives a DNS UPDATE from one
  of its children the following must be done:
  
</p>
<p>
    </p>
<blockquote class="text"><dl>
<dt>Step 1:</dt>
<dd> Check the TSIG/SIG0 credentials. In case of
    TSIG, the parent should follow the TSIG processing described in
    section 3.2 of RFC 2845. In case of SIG0, the parent should follow the
    SIG0 processing described in section 3.2 of RFC 2931.
    
</dd>
<dt>Step 2:</dt>
<dd> Verify that the updates matches the update
    policy for child zones.
</dd>
<dt>Step 3:</dt>
<dd> If verified, send back DNS UPDATE OK.
    Otherwise, send back DNS UPDATE REFUSED.
    
</dd>
<dt>Step 4:</dt>
<dd> If verified, apply changes.
    How that is done is a matter of policy.
    
</dd>
</dl></blockquote><p>
  
</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Proxy considerations</h3>

<p>
  Some environments don't allow for direct communication between parent
  and child zone. In these case, the parent duties can be performed by a
  different party (for example, the registar). The third party will
  forward the update to the parent zone. In what format depends on local
  policy.
  
</p>
<a name="example"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Example BIND9 Configuration</h3>

<p>
This is how a parent zone can configure a policy to enable a child zone
synchronize delegation specific records. The first rule of the update
policy grants children to update their DS and NS records in the parent
zone, in this case example.com. The second rule of the update policy
grants children to update the corresponding glue records.

</p>
<p>
  key cs.example.com. { <br />

     algorithm HMAC-MD5; <br />

     secret "secretforcs"; <br />

  }

</p>
<p>
  key math.example.com. { <br />

     algorithm HMAC-MD5; <br />

     secret "secretformath"; <br />

  }

</p>
<p>
  ...

</p>
<p>
  zone "example.com" { <br />

    type master; <br />

    file "example.com"; <br />

    update-policy { grant *.example.com. self *.example.com. DS NS; }; <br />

    update-policy { grant *.example.com. selfsub *.example.com. A AAAA; }; <br />

  };

</p>
<a name="sec"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p> 
Automating the synchronization of (DNSSEC) records between the parent
and child created a new channel. We have recommended that this channel
should be secured with TSIG or SIG0. There is an advantage and a
disadvantage of the new security channel. The disadvantage is that you
create a new attack window for your DNSSEC credentials. If the automated
synchronization is used for updating DS records at the parent, you
SHOULD pick a cryptographically an equally strong or stronger TSIG/SIG0
key than the strength of your DNSSEC keys.

</p>
<p>
The advantage is that if somehow your DNSSEC keys are compromised, you
can still use this channel to perform an emergency key rollover.

</p>
<a name="IANA"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p> None. 
</p>
<a name="ack"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgments</h3>

<p> Rickard Bellgrim, Wolfgang Nagele, Wouter Wijngaards and more. 
</p>
<a name="rfc.references"></a><br /><hr />
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<h3>8.1.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2136">[RFC2136]</a></td>
<td class="author-text"><a href="mailto:paul@vix.com">Vixie, P.</a>, <a href="mailto:set@thumper.bellcore.com">Thomson, S.</a>, <a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, and <a href="mailto:bound@zk3.dec.com">J. Bound</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2136">Dynamic Updates in the Domain Name System (DNS UPDATE)</a>,&rdquo; RFC&nbsp;2136, April&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2136.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2136.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2136.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4641">[RFC4641]</a></td>
<td class="author-text">Kolkman, O. and R. Gieben, &ldquo;<a href="http://tools.ietf.org/html/rfc4641">DNSSEC Operational Practices</a>,&rdquo; RFC&nbsp;4641, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4641.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="keytiming">[keytiming]</a></td>
<td class="author-text">Morris, S., Ihren, J., and J. Dickinson, &ldquo;DNSSEC Key Timing Considerations,&rdquo; March&nbsp;2010.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<h3>8.2.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2845">[RFC2845]</a></td>
<td class="author-text">Vixie, P., Gudmundsson, O., Eastlake, D., and B. Wellington, &ldquo;<a href="http://tools.ietf.org/html/rfc2845">Secret Key Transaction Authentication for DNS (TSIG)</a>,&rdquo; RFC&nbsp;2845, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2845.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2931">[RFC2931]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc2931">DNS Request and Transaction Signatures ( SIG(0)s)</a>,&rdquo; RFC&nbsp;2931, September&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2931.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4035">[RFC4035]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4035">Protocol Modifications for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4035, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4035.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Matthijs Mekking</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NLnet Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Science Park 140</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Amsterdam  1098 XG</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">The Netherlands</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:matthijs@nlnetlabs.nl">matthijs@nlnetlabs.nl</a></td></tr>
</table>
</body></html>
