CRED_x = {
     1:  1,
    -1:  4,
    -2:  h'b1a3e89460e88d3a8d54211dc95f0b90
           3ff205eb71912d6db8f4af980d2db83a',
    "subject name" : "42-50-31-FF-EF-37-32-39"
PRK = Extract( salt, IKM )

PRK_2e = HMAC-SHA-256( salt, G_XY )
PRK_3e2m = PRK_2e.

PRK_4x3m = PRK_3e2m.

G_XY = X25519( Y, G_X ) = X25519( X, G_Y )

OKM = EDHOC-KDF( PRK, transcript_hash, label, length )
          = Expand( PRK, info, length )

info = [
      edhoc_aead_id : int / tstr,
      transcript_hash : bstr,
      label : tstr,
      length : uint
TH_4 = H( TH_3, CIPHERTEXT_3 )

PRK_4x3m = Extract( [ "TH_4", nonce ], PRK_4x3m )
bstr_identifier = bstr / int

message_1 = (
     METHOD_CORR : int,
     SUITES_I : [ selected : suite, supported : 2* suite ] / suite,
     G_X : bstr,
     C_I : bstr_identifier,
     ? AD_1 : bstr,
suite = int

message_2 = (
     data_2,
     CIPHERTEXT_2 : bstr,
data_2 = (
     ? C_I : bstr_identifier,
     G_Y : bstr,
     C_R : bstr_identifier,
message_3 = (
     data_3,
     CIPHERTEXT_3 : bstr,
data_3 = (
     ? C_R : bstr_identifier,
error = (
     ? C_x : bstr_identifier,
     DIAG_MSG : tstr,
     ? SUITES_R : [ supported : 2* suite ] / suite,
message_4 = (
     data_4,
     MAC_4 : bstr,
data_4 = (
     ? C_I : bstr_identifier,
message_1 =
PRK_2e = HMAC-SHA-256(salt, G_XY)

data_2 =
TH_2 = H( message_1, data_2 ), as a CBOR Sequence of these 2 data
ID_CRED_R = { 34 : COSE_CertHash }. In this example, the hash
ID_CRED_R =
A_2m =
M_2 =
K_2e = HKDF-Expand( PRK, info, length ), where length is the length
message_2 =
PRK_4x3m = HMAC-SHA-256 (PRK_3e2m, G_IY)

ID_CRED_I = { 34 : COSE_CertHash }. In this example, the hash
ID_CRED_I =
M_3 =
message_3 =
TH_4 = H( TH_3, CIPHERTEXT_3 ), as a CBOR Sequence of these 2 data
info_ms = [
    10,
    h'36457c25900b01263677902d3402e6dc96d38c457379f0dcca1e9b3aaf342e43',
    "OSCORE Master Secret",
    16
info_salt = [
    10,
    h'36457c25900b01263677902d3402e6dc96d38c457379f0dcca1e9b3aaf342e43',
    "OSCORE Master Salt",
    8
message_1 =
PRK_2e = HMAC-SHA-256(salt, G_XY)

PRK_3e2m = HKDF-Extract( PRK_2e, G_RX ), where G_RX is the ECDH
data_2 =
TH_2 = H( message_1, data_2 ), as a CBOR Sequence of these 2 data
ID_CRED_R =
A_2m =
K_2e = HKDF-Expand( PRK, info, length ), where length is the length
message_2 =
PRK_4x3m = HMAC-SHA-256 (PRK_3e2m, G_IY).

ID_CRED_I =
message_3 =
TH_4 = H( TH_3, CIPHERTEXT_3 ), as a CBOR Sequence of these 2 data
info_ms = [
     10,
     TODO,
     "OSCORE Master Secret",
     16
info_salt = [
     10,
     TODO,
     "OSCORE Master Salt",
     8
