<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Address Protected Neighbor Discovery for Low-power and Lossy Networks</title>
<meta content="Pascal Thubert" name="author">
<meta content="Behcet Sarikaya" name="author">
<meta content="Mohit Sethi" name="author">
<meta content="Rene Struik" name="author">
<meta content="
       
    This document updates the 6LoWPAN Neighbor Discovery (ND) protocol defined in RFC 6775 and RFC 8505.
    The new extension is called Address Protected Neighbor Discovery (AP-ND) and it protects the owner of an address against
     address theft and impersonation attacks in a low-power and lossy network (LLN).
     Nodes supporting this extension compute a cryptographic identifier (Crypto-ID) and use it with one or more of their
     Registered Addresses. The Crypto-ID identifies the owner of the Registered Address and can be used to provide proof of
     ownership of the Registered Addresses. Once an address is registered with the Crypto-ID and a proof-of-ownership is
     provided, only the owner of that address can modify the registration information, thereby enforcing Source Address
     Validation.
       
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="draft-ietf-6lo-ap-nd-20" name="ietf.draft">
<link href="/tmp/draft-ietf-6lo-ap-nd-yyozsjb5.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Address Protection ND for LLN</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thubert, et al.</td>
<td class="center">Expires 10 September 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">6lo</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8505" class="eref">8505</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03-09" class="published">9 March 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-09-10">10 September 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thubert, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">B. Sarikaya</div>
</div>
<div class="author">
      <div class="author-name">M. Sethi</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">R. Struik</div>
<div class="org">Struik Security Consultancy</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Address Protected Neighbor Discovery for Low-power and Lossy Networks</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
    This document updates the 6LoWPAN Neighbor Discovery (ND) protocol defined in RFC 6775 and RFC 8505.
    The new extension is called Address Protected Neighbor Discovery (AP-ND) and it protects the owner of an address against
     address theft and impersonation attacks in a low-power and lossy network (LLN).
     Nodes supporting this extension compute a cryptographic identifier (Crypto-ID) and use it with one or more of their
     Registered Addresses. The Crypto-ID identifies the owner of the Registered Address and can be used to provide proof of
     ownership of the Registered Addresses. Once an address is registered with the Crypto-ID and a proof-of-ownership is
     provided, only the owner of that address can modify the registration information, thereby enforcing Source Address
     Validation.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 10 September 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-bcp-14" class="xref">BCP 14</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-abbreviations" class="xref">Abbreviations</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-additional-references" class="xref">Additional References</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-updating-rfc-8505" class="xref">Updating RFC 8505</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-new-fields-and-options" class="xref">New Fields and Options</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-new-crypto-id" class="xref">New Crypto-ID</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-updated-earo" class="xref">Updated EARO</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-crypto-id-parameters-option" class="xref">Crypto-ID Parameters Option</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-ndp-signature-option" class="xref">NDP Signature Option</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-protocol-scope" class="xref">Protocol Scope</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-protocol-flows" class="xref">Protocol Flows</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-first-exchange-with-a-6lr" class="xref">First Exchange with a 6LR</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-ndpso-generation-and-verifi" class="xref">NDPSO generation and verification</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-multihop-operation" class="xref">Multihop Operation</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-inheriting-from-rfc-3971" class="xref">Inheriting from RFC 3971</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-related-to-6lowpan-nd" class="xref">Related to 6LoWPAN ND</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-rovr-collisions" class="xref">ROVR Collisions</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-implementation-attacks" class="xref">Implementation Attacks</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-cross-algorithm-and-cross-p" class="xref">Cross-Algorithm and Cross-Protocol Attacks</a><a href="#section-toc.1-1.7.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-compromised-6lr" class="xref">Compromised 6LR</a><a href="#section-toc.1-1.7.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-correlating-registrations" class="xref">Correlating Registrations</a><a href="#section-toc.1-1.7.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-cga-message-type" class="xref">CGA Message Type</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-ipv6-nd-option-types" class="xref">IPv6 ND option types</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-crypto-type-subregistry" class="xref">Crypto-Type Subregistry</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-new-codepoints-associated-t" class="xref">New Codepoints Associated to JWK Encoding</a><a href="#section-toc.1-1.8.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="xref">8.4.1</a>.  <a href="#name-cose-elliptic-curves-regist" class="xref">COSE Elliptic Curves Registration</a><a href="#section-toc.1-1.8.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="xref">8.4.2</a>.  <a href="#name-cose-algorithms-registratio" class="xref">COSE Algorithms Registration</a><a href="#section-toc.1-1.8.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="xref">8.4.3</a>.  <a href="#name-jose-elliptic-curves-regist" class="xref">JOSE Elliptic Curves Registration</a><a href="#section-toc.1-1.8.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4.2.4">
                    <p id="section-toc.1-1.8.2.4.2.4.1"><a href="#section-8.4.4" class="xref">8.4.4</a>.  <a href="#name-jose-algorithms-registratio" class="xref">JOSE Algorithms Registration</a><a href="#section-toc.1-1.8.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-informative-references" class="xref">Informative references</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-requirements-addressed-in-t" class="xref">Requirements Addressed in this Document</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-representation-conventions" class="xref">Representation Conventions</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-signature-schemes" class="xref">Signature Schemes</a><a href="#section-toc.1-1.13.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-integer-representation-for-" class="xref">Integer Representation for ECDSA signatures</a><a href="#section-toc.1-1.13.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-alternative-representations" class="xref">Alternative Representations of Curve25519</a><a href="#section-toc.1-1.13.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
     Neighbor Discovery Optimizations for 6LoWPAN networks <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>  (6LoWPAN ND) adapts the original IPv6
     Neighbor Discovery (IPv6 ND) protocols defined in <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> and <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> for constrained
     low-power and lossy network (LLN). In particular, 6LoWPAN ND introduces a unicast host Address Registration mechanism
     that reduces the use of multicast compared to the Duplicate Address Detection (DAD) mechanism defined in IPv6 ND.
        6LoWPAN ND defines a new Address Registration Option (ARO) that is carried in the
     unicast Neighbor Solicitation (NS) and Neighbor Advertisement (NA) messages exchanged between a 6LoWPAN Node (6LN) and
     a 6LoWPAN Router (6LR).
        It also defines the Duplicate Address Request (DAR) and Duplicate Address Confirmation (DAC)
     messages between the 6LR and the 6LoWPAN Border Router (6LBR).
     In LLN networks, the 6LBR is the central repository of all the registered addresses in its domain.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
     The registration mechanism in <span><a href="#RFC6775" class="xref">"Neighbor Discovery Optimization for Low-power and Lossy Networks"</a> [<a href="#RFC6775" class="xref">RFC6775</a>]</span> (aka 6LoWPAN ND) prevents the use of an address if that address
     is already registered in the subnet (first come first serve). In order to validate address ownership, the registration
     mechanism enables the 6LR and 6LBR to validate the association between the registered address of a node, and its
     Registration Ownership Verifier (ROVR). The ROVR is defined in <span><a href="#RFC8505" class="xref">"Registration Extensions for 6LoWPAN Neighbor
        Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span> and it can be derived from the
     MAC address of the device (using the 64-bit Extended Unique Identifier EUI-64 address format specified by IEEE).
     However, the EUI-64 can be spoofed, and therefore, any node connected to the subnet and aware of a
     registered-address-to-ROVR mapping could effectively fake the ROVR. This would allow the an attacker to steal the
     address and redirect traffic for that address. <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines an Extended Address Registration
     Option (EARO) option that allows to transport alternate forms of ROVRs, and is a pre-requisite for this specification.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
   In this specification, a 6LN generates a cryptographic ID (Crypto-ID) and places it in the ROVR field during the
   registration of one (or more) of its addresses with the 6LR(s). Proof of ownership of the Crypto-ID is passed with
   the first registration exchange to a new 6LR, and enforced at the 6LR.

          The 6LR validates ownership of the
   cryptographic ID before it creates any new registration state, or changes existing information.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
   The protected address registration protocol proposed in this document provides the same conceptual benefit as Source Address Validation (SAVI) <span>[<a href="#RFC7039" class="xref">RFC7039</a>]</span> that only the owner of an IPv6 address may source packets with that address.
          As opposed to <span>[<a href="#RFC7039" class="xref">RFC7039</a>]</span>, which relies on snooping protocols, the protection is based on a state that is installed and maintained in the network by the owner of the address. With this specification, a 6LN may use a 6LR for forwarding an IPv6 packets if and only if it has registered the address used as source of the packet with that 6LR.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
   With the 6lo adaptation layer in <span>[<a href="#RFC4944" class="xref">RFC4944</a>]</span> and <span>[<a href="#RFC6282" class="xref">RFC6282</a>]</span>, a 6LN can obtain a better compression for an IPv6 address with an Interface ID (IID) that is derived from a Layer-2 address. As a side note, this is incompatible with Secure Neighbor Discovery (SeND) <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> and Cryptographically Generated Addresses (CGAs)
   <span>[<a href="#RFC3972" class="xref">RFC3972</a>]</span>, since they derive the IID from cryptographic keys, whereas this specification separates the IID and the key material.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="bcp">
<section id="section-2.1">
        <h3 id="name-bcp-14">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-bcp-14" class="section-name selfRef">BCP 14</a>
        </h3>
<p id="section-2.1-1">

    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
    "OPTIONAL" in this document are to be interpreted as described in BCP 14
    <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when,
    they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acronyms">
<section id="section-2.2">
        <h3 id="name-abbreviations">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<p id="section-2.2-1"> This document uses the following abbreviations:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel dlCompact" id="section-2.2-2">
          <dt id="section-2.2-2.1">6BBR:</dt>
<dd id="section-2.2-2.2">  6LoWPAN Backbone Router<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.3">6LBR:</dt>
<dd id="section-2.2-2.4">6LoWPAN Border Router<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.5">6LN:</dt>
<dd id="section-2.2-2.6">  6LoWPAN Node<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.7">6LR:</dt>
<dd id="section-2.2-2.8">6LoWPAN Router<a href="#section-2.2-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.9">EARO:</dt>
<dd id="section-2.2-2.10"> Extended Address Registration Option<a href="#section-2.2-2.10" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.11">CIPO:</dt>
<dd id="section-2.2-2.12">Crypto-ID Parameters Option<a href="#section-2.2-2.12" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.13">LLN:</dt>
<dd id="section-2.2-2.14"> Low-Power and Lossy Network<a href="#section-2.2-2.14" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.15">NA:</dt>
<dd id="section-2.2-2.16">  Neighbor Advertisement<a href="#section-2.2-2.16" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.17">ND:</dt>
<dd id="section-2.2-2.18">  Neighbor Discovery<a href="#section-2.2-2.18" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.19">NDPSO:</dt>
<dd id="section-2.2-2.20"> Neighbor Discovery Protocol Signature Option<a href="#section-2.2-2.20" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.21">NS:</dt>
<dd id="section-2.2-2.22">  Neighbor Solicitation<a href="#section-2.2-2.22" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.23">ROVR:</dt>
<dd id="section-2.2-2.24"> Registration Ownership Verifier<a href="#section-2.2-2.24" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.25">RA:</dt>
<dd id="section-2.2-2.26"> Router Advertisement<a href="#section-2.2-2.26" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.27">RS:</dt>
<dd id="section-2.2-2.28"> Router Solicitation<a href="#section-2.2-2.28" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.29">RSAO:</dt>
<dd id="section-2.2-2.30"> RSA Signature Option<a href="#section-2.2-2.30" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-2.31">TID:</dt>
<dd id="section-2.2-2.32"> Transaction ID<a href="#section-2.2-2.32" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-2.2-3"><a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lo">
<section id="section-2.3">
        <h3 id="name-additional-references">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-additional-references" class="section-name selfRef">Additional References</a>
        </h3>
<p id="section-2.3-1">
 The reader may get additional context for this specification from the following references:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.3-2.1">
            <span><a href="#RFC3971" class="xref">"SEcure Neighbor Discovery (SEND)"</a> [<a href="#RFC3971" class="xref">RFC3971</a>]</span>,<a href="#section-2.3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-2.3-2.2">
            <span><a href="#RFC3972" class="xref">"Cryptographically Generated Addresses (CGA)"</a> [<a href="#RFC3972" class="xref">RFC3972</a>]</span>,<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-2.3-2.3">
            <span><a href="#RFC4861" class="xref">"Neighbor Discovery for IP version 6"</a> [<a href="#RFC4861" class="xref">RFC4861</a>]</span> ,<a href="#section-2.3-2.3" class="pilcrow">¶</a>
</li>
<li id="section-2.3-2.4">
            <span><a href="#RFC4862" class="xref">"IPv6 Stateless Address Autoconfiguration"</a> [<a href="#RFC4862" class="xref">RFC4862</a>]</span>, and<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</li>
<li id="section-2.3-2.5">
            <span><a href="#RFC4919" class="xref">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals "</a> [<a href="#RFC4919" class="xref">RFC4919</a>]</span>.<a href="#section-2.3-2.5" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
<section id="section-3">
      <h2 id="name-updating-rfc-8505">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-updating-rfc-8505" class="section-name selfRef">Updating RFC 8505</a>
      </h2>
<p id="section-3-1">
        Section 5.3 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the ROVR that is used to detect and reject duplicate registrations in the DAD process.
        The ROVR is a generic object that is designed for both backward compatibility and the capability to introduce new computation methods in the future. Using a Crypto-ID per this specification is the RECOMMENDED method. <a href="#sec-col" class="xref">Section 7.3</a> discusses collisions when heterogeneous methods to compute the ROVR field coexist inside a same network.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
        This specification introduces a new token called a cryptographic identifier (Crypto-ID) that is transported in the ROVR field and used to prove indirectly the ownership of an address that is being registered by means of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. The
        Crypto-ID is derived from a cryptographic public key and additional parameters.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
        The overall mechanism requires the support of Elliptic Curve Cryptography (ECC) and of a hash function as detailed in <a href="#ndpso-generation" class="xref">Section 6.2</a>. To enable the verification of the proof, the registering node needs to supply certain parameters including a nonce and a signature that will demonstrate that the node possesses the private-key corresponding to the public-key used to build the Crypto-ID.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4"> The elliptic curves and the hash functions listed in <a href="#cryptotypetable" class="xref">Table 2</a> in <a href="#cryptotypereg" class="xref">Section 8.3</a> can be used with this specification; more may be added in the future to the IANA registry.
 The signature scheme that specifies which combination is used (including the curve and the representation conventions) is signaled by a Crypto-Type in a new IPv6 ND Crypto-ID Parameters Option (CIPO, see <a href="#cryptoidopt" class="xref">Section 4.3</a>)
        that contains the parameters that are necessary for the proof, a Nonce option (<span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>) and a NDP Signature option (<a href="#ndpso" class="xref">Section 4.4</a>).  The NA(EARO) is modified to enable a challenge and transport a Nonce option.<a href="#section-3-4" class="pilcrow">¶</a></p>
</section>
<div id="cryptoifldg">
<section id="section-4">
      <h2 id="name-new-fields-and-options">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-new-fields-and-options" class="section-name selfRef">New Fields and Options</a>
      </h2>
<div id="cryptoidalg">
<section id="section-4.1">
        <h3 id="name-new-crypto-id">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-new-crypto-id" class="section-name selfRef">New Crypto-ID</a>
        </h3>
<p id="section-4.1-1">
 The Crypto-ID is transported in the ROVR field of the EARO option and the EDAR message, and is associated with the Registered Address at the 6LR and the 6LBR.
 The ownership of a Crypto-ID can be demonstrated by cryptographic mechanisms, and by association, the ownership of the Registered Address can be ascertained.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
 A node in possession of the necessary cryptographic primitives SHOULD use Crypto-ID by default as ROVR in its registrations. Whether a ROVR is a Crypto-ID is indicated by a new "C" flag in the NS(EARO) message.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">

   The Crypto-ID is derived from the public key and a modifier as follows:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.1-4">
          <li id="section-4.1-4.1">The hash function indicated by the Crypto-Type is applied to the CIPO. Note that all the reserved and padding bits MUST be set to zero.<a href="#section-4.1-4.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1-4.2"> The leftmost bits of the resulting hash, up to the desired size, are used as the Crypto-ID.<a href="#section-4.1-4.2" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-4.1-5">
   At the time of this writing, a minimal size for the Crypto-ID of 128 bits is RECOMMENDED unless backward compatibility is needed <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. This value is bound to augment in the future.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptoEARO">
<section id="section-4.2">
        <h3 id="name-updated-earo">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-updated-earo" class="section-name selfRef">Updated EARO</a>
        </h3>
<p id="section-4.2-1">
    This specification updates the EARO option to enable the use of the ROVR field to transport the Crypto-ID. The resulting format is as follows:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span id="name-enhanced-address-registrati"></span><div id="crypto-fig">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-4.2-2.1">
<pre>

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |    Status     |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |Rsvd |C| I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...            Registration Ownership Verifier (ROVR)           ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-enhanced-address-registrati" class="selfRef">Enhanced Address Registration Option</a>
          </figcaption></figure>
</div>
<p id="section-4.2-3"><a href="#section-4.2-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.2-4">
          <dt id="section-4.2-4.1">Type:</dt>
<dd id="section-4.2-4.2">
     33<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.3">Length:</dt>
<dd id="section-4.2-4.4">
      Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and copied in associated CIPO.<a href="#section-4.2-4.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.5">Status:</dt>
<dd id="section-4.2-4.6">
      Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-4.6" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.7">Opaque:</dt>
<dd id="section-4.2-4.8">
      Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-4.8" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.9">Rsvd (Reserved):</dt>
<dd id="section-4.2-4.10">3-bit unsigned integer.
        It MUST be set to zero by the sender and MUST be ignored by the receiver.<a href="#section-4.2-4.10" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.11">C:</dt>
<dd id="section-4.2-4.12">
       This "C" flag is set to indicate that the ROVR field contains a Crypto-ID and that the 6LN MAY be challenged for ownership as specified in this document.<a href="#section-4.2-4.12" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.13">I, R, T:</dt>
<dd id="section-4.2-4.14">
     Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-4.14" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.15">TID:</dt>
<dd id="section-4.2-4.16">
     Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-4.16" class="pilcrow">¶</a>
</dd>
<dt id="section-4.2-4.17">Registration Ownership Verifier (ROVR):</dt>
<dd id="section-4.2-4.18">
     When the "C" flag is set, this field contains a Crypto-ID.<a href="#section-4.2-4.18" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4.2-5">
 This specification uses Status values "Validation Requested" and
 "Validation Failed", which are defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">
 this specification does not define any new Status value.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptoidopt">
<section id="section-4.3">
        <h3 id="name-crypto-id-parameters-option">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-crypto-id-parameters-option" class="section-name selfRef">Crypto-ID Parameters Option</a>
        </h3>
<p id="section-4.3-1">
 This specification defines the Crypto-ID Parameters Option (CIPO).
    The CIPO carries the parameters used to form a Crypto-ID.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
    In order to provide cryptographic agility <span>[<a href="#RFC7696" class="xref">BCP 201</a>]</span>, this specification supports different elliptic curves,
 indicated by a Crypto-Type field:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.3-3.1">
    NIST P-256 <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>
 MUST be supported by all implementations.<a href="#section-4.3-3.1" class="pilcrow">¶</a>
</li>
<li id="section-4.3-3.2">
    The Edwards-Curve Digital
 Signature Algorithm (EdDSA) curve Ed25519 (PureEdDSA) <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> MAY be supported as an alternative.<a href="#section-4.3-3.2" class="pilcrow">¶</a>
</li>
<li id="section-4.3-3.3">
     This specification uses signature schemes that target similar cryptographic strength but rely on different curves, hash functions, signature algorithms, and/or
 representation conventions. Future specification may extend this to different cryptographic algorithms and key sizes, e.g., to provide better security properties or a
 simpler implementation.<a href="#section-4.3-3.3" class="pilcrow">¶</a>
</li>
</ul>
<span id="name-crypto-id-parameters-option-2"></span><div id="cgapar-fig">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-4.3-4.1">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |Reserved1|  Public Key Length  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Crypto-Type  | Modifier      |  EARO Length  |  Reserved2    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   .                                                               .
   .                  Public Key (variable length)                 .
   .                                                               .
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   .                           Padding                             .
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-crypto-id-parameters-option-2" class="selfRef">Crypto-ID Parameters Option</a>
          </figcaption></figure>
</div>
<p id="section-4.3-5"><a href="#section-4.3-5" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.3-6">
          <dt id="section-4.3-6.1">Type:</dt>
<dd id="section-4.3-6.2"> 8-bit unsigned integer.
       to be assigned by IANA, see <a href="#nexndopt" class="xref">Table 1</a>.<a href="#section-4.3-6.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.3">Length:</dt>
<dd id="section-4.3-6.4">
       8-bit unsigned integer. The length of the option in units of 8 octets.<a href="#section-4.3-6.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.5">Reserved1:</dt>
<dd id="section-4.3-6.6"> 5-bit unsigned integer.
        It MUST be set to zero by the sender and MUST be ignored by the receiver.<a href="#section-4.3-6.6" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.7">Public Key Length:</dt>
<dd id="section-4.3-6.8">
       11-bit unsigned integer. The length of the Public Key field in bytes.<a href="#section-4.3-6.8" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.9">Crypto-Type:</dt>
<dd id="section-4.3-6.10">8-bit unsigned integer.
       The type of cryptographic algorithm used in calculation Crypto-ID
        indexed by IANA in the "Crypto-Type Subregistry" in the "Internet Control Message Protocol version 6 (ICMPv6) Parameters"
        (see <a href="#cryptotypereg" class="xref">Section 8.3</a>).<a href="#section-4.3-6.10" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.11">Modifier:</dt>
<dd id="section-4.3-6.12">
       8-bit unsigned integer. Set to an arbitrary value by the creator of the Crypto-ID.
   The role of the modifier is to enable the formation of multiple Crypto-IDs from a same key pair, which reduces the traceability and thus improves the privacy of a constrained node that could not maintain many key-pairs.<a href="#section-4.3-6.12" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.13">EARO Length:</dt>
<dd id="section-4.3-6.14"> 8-bit unsigned integer.
      The option length of the EARO that contains the Crypto-ID associated with the CIPO.<a href="#section-4.3-6.14" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.15">Reserved2:</dt>
<dd id="section-4.3-6.16"> 16-bit unsigned integer.
        It MUST be set to zero by the sender and MUST be ignored by the receiver.<a href="#section-4.3-6.16" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.17">Public Key:</dt>
<dd id="section-4.3-6.18"> A variable-length field, size indicated in the Public Key Length field.
             JWK-Encoded Public Key <span>[<a href="#RFC7517" class="xref">RFC7517</a>]</span>.<a href="#section-4.3-6.18" class="pilcrow">¶</a>
</dd>
<dt id="section-4.3-6.19">Padding:</dt>
<dd id="section-4.3-6.20">
        A variable-length field completing the Public Key field to align to the next 8-bytes boundary. It MUST be set to zero by the sender and MUST be ignored by the receiver.<a href="#section-4.3-6.20" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4.3-7"><a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">
 The implementation of multiple hash functions in a constrained devices may
 consume excessive amounts of program memory. This specification enables the use of SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for all the supported ECC curves.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">
    Some code factorization is also possible for the ECC computation itself.
 <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPRESENTATIONS</a>]</span> provides information
 on how to represent Montgomery curves and (twisted) Edwards curves as curves in short-Weierstrass form and illustrates how this can be used to implement elliptic curve computations using existing implementations that already provide, e.g., ECDSA and ECDH using NIST <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> prime curves. For more details on representation conventions, we refer to
 <a href="#reprconv" class="xref">Appendix B</a>.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ndpso">
<section id="section-4.4">
        <h3 id="name-ndp-signature-option">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-ndp-signature-option" class="section-name selfRef">NDP Signature Option</a>
        </h3>
<p id="section-4.4-1">
 This specification defines the NDP Signature Option (NDPSO).
    The NDPSO carries the signature that proves the ownership of the Crypto-ID.
    The format of the NDPSO is illustrated in <a href="#ndpso-fig" class="xref">Figure 3</a>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
    As opposed to the RSA Signature Option (RSAO) defined in section 5.2. of <span><a href="#RFC3971" class="xref">SEND</a> [<a href="#RFC3971" class="xref">RFC3971</a>]</span>, the NDPSO does not have a key hash field. Instead, the leftmost 128 bits of the ROVR field in the EARO are used as hash to retrieve the CIPO that contains the key material used for signature verification, left-padded if needed.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">
    Another difference is that the NDPSO signs a fixed set of fields as opposed to all options that appear prior to it in the ND message that bears the signature. This allows to elide a CIPO that the 6LR already received, at the expense of the capability to add arbitrary options that would signed with a RSAO.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">
    An ND message that carries an NDPSO MUST have one and only one EARO. The EARO MUST contain a Crypto-ID in the ROVR field, and the Crypto-ID MUST be associated with the keypair used for the Digital Signature in the NDPSO.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">
    The CIPO may be present in the same message as the NDPSO. If it is not present, it can be found in an abstract table that was created by a previous message and indexed by the hash.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<span id="name-ndp-signature-option-2"></span><div id="ndpso-fig">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-4.4-6.1">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |Reserved1|  Signature Length   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Reserved2                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   .                                                               .
   .          Digital Signature  (variable length)                 .
   .                                                               .
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   .                           Padding                             .
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-ndp-signature-option-2" class="selfRef">NDP signature Option</a>
          </figcaption></figure>
</div>
<p id="section-4.4-7"><a href="#section-4.4-7" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.4-8">
          <dt id="section-4.4-8.1">Type:</dt>
<dd id="section-4.4-8.2">
       to be assigned by IANA, see <a href="#nexndopt" class="xref">Table 1</a>.<a href="#section-4.4-8.2" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4-8.3">Length:</dt>
<dd id="section-4.4-8.4">
       8-bit unsigned integer. The length of the option in units of 8 octets.<a href="#section-4.4-8.4" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4-8.5">Reserved1:</dt>
<dd id="section-4.4-8.6"> 5-bit unsigned integer.
        It MUST be set to zero by the sender and MUST be ignored by the receiver.<a href="#section-4.4-8.6" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4-8.7">Digital Signature Length:</dt>
<dd id="section-4.4-8.8">
       11-bit unsigned integer. The length of the Digital Signature field in bytes.<a href="#section-4.4-8.8" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4-8.9">Reserved2:</dt>
<dd id="section-4.4-8.10"> 32-bit unsigned integer.
        It MUST be set to zero by the sender and MUST be ignored by the receiver.<a href="#section-4.4-8.10" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4-8.11">Digital Signature:</dt>
<dd id="section-4.4-8.12">
       A variable-length field containing a digital signature. The length and computation of the digital signature both depend on the Crypto-Type which is found in the associated CIPO.
        For the values of the Crypto-Type that are defined in this specification, and unless specified otherwise for a future value of the Crypto-Type, the signature is computed as detailed in <a href="#ndpso-generation" class="xref">Section 6.2</a>.<a href="#section-4.4-8.12" class="pilcrow">¶</a>
</dd>
<dt id="section-4.4-8.13">Padding:</dt>
<dd id="section-4.4-8.14">
        A variable-length field completing the Digital Signature field to align to the next 8-bytes boundary. It MUST be set to zero by the sender and MUST be ignored by the receiver.<a href="#section-4.4-8.14" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-4.4-9"><a href="#section-4.4-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-5">
      <h2 id="name-protocol-scope">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-scope" class="section-name selfRef">Protocol Scope</a>
      </h2>
<p id="section-5-1">
      The scope of the protocol specified here is a 6LoWPAN LLN, typically a stub network connected to a larger IP network via a Border Router called a 6LBR per <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>. A 6LBR has sufficient capability to satisfy the needs of duplicate address detection.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
      The 6LBR maintains registration state for all devices in its attached LLN.  Together with the first-hop router (the 6LR), the 6LBR assures uniqueness and grants ownership of an IPv6 address before it can be used in the LLN. This is in contrast to a traditional network that relies on IPv6 address auto-configuration <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span>, where there is no guarantee of ownership from the network, and each IPv6 Neighbor Discovery packet must be individually secured <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<span id="name-basic-configuration"></span><div id="figco">
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-5-3.1">
<pre>
              ---+-------- ............
                 |      External Network
                 |
              +-----+
              |     | 6LBR
              +-----+
            o    o   o
     o     o   o     o
        o   o LLN   o    o     o
           o   o   o       (6LR)
                   o         (6LN)

</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-basic-configuration" class="selfRef">Basic Configuration</a>
        </figcaption></figure>
</div>
<p id="section-5-4">
      In a mesh network, the 6LR is directly connected to the host device. This specification mandates that the peer-wise layer-2 security is deployed so that all the packets from a particular host are securely identifiable by the 6LR. The 6LR may be multiple hops away from the 6LBR. Packets are routed between the 6LR and the 6LBR via other 6LRs. This specification mandates that a chain of trust is established so that a packet
      that was validated by the first 6LR can be safely routed by other on-path 6LRs to the 6LBR.<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
<section id="section-6">
      <h2 id="name-protocol-flows">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-protocol-flows" class="section-name selfRef">Protocol Flows</a>
      </h2>
<p id="section-6-1">
    The 6LR/6LBR ensures first-come/first-serve by storing the ROVR associated to the address being registered upon the first registration and rejecting a registration with a different ROVR value. A 6LN can claim any address as long as it is the first to make that claim. After a successful registration, the 6LN becomes the owner of the registered address and the address is bound to the ROVR value in the 6LR/6LBR registry.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
     This specification enables the 6LR to challenge the 6LN to verify its ownership of the binding by placing a Crypto-ID in the ROVR. The challenge can happen at any time at the discretion of the 6LR. The 6LR MUST challenge the 6LN when it creates a binding and when a new registration attempts to change a parameter of the binding that identifies the 6LN, for instance its Source Link-Layer Address. The verification protects against a rogue that would steal an address and attract its traffic, or use it as source address.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
        The challenge can also triggered by the 6LBR, e.g., to enforce a global policy. In that case, the 6LBR returns a status of "Validation Requested" in the DAR/DAC exchange, which is echoed by the 6LR in the NA (EARO) back to the registering node.
        A valid registration in the 6LR or the 6LBR MUST NOT be altered until the challenge is complete.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
     A node may use more than one IPv6 address at the same time. The separation of the address and the cryptographic material avoids the need for the constrained device to compute multiple keys for multiple addresses. The 6LN MAY use the same Crypto-ID to prove the ownership of multiple IPv6 addresses. The 6LN MAY also derive multiple Crypto-IDs from a same key.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="first">
<section id="section-6.1">
        <h3 id="name-first-exchange-with-a-6lr">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-first-exchange-with-a-6lr" class="section-name selfRef">First Exchange with a 6LR</a>
        </h3>
<p id="section-6.1-1">
     A 6LN registers to a 6LR that is one hop away from it with the "C" flag set in the EARO, indicating that the ROVR field contains a Crypto-ID. The Target Address in the NS message indicates the IPv6 address that the 6LN is trying to register <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. The on-link (local) protocol interactions are shown in <a href="#Dynamic-fig" class="xref">Figure 5</a>. If the 6LR does not have a state with the 6LN that is consistent with the NS(EARO), then it replies with a challenge NA (EARO, status=Validation Requested) that contains a Nonce Option (shown as NonceLR in <a href="#Dynamic-fig" class="xref">Figure 5</a>).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
        The Nonce option contains a nonce value that, to the extent possible for the implementation, was never employed in association with the key pair used to generate the Crypto-ID.
        This specification inherits from <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> that simply indicates that the nonce is a random value. Ideally, an implementation uses an unpredictable cryptographically random value <span>[<a href="#RFC4086" class="xref">BCP 106</a>]</span>. But that may be impractical in some LLN scenarios where the devices do not have a guaranteed sense of time and for which computing complex hashes is detrimental to the battery lifetime. Alternatively,
        the device may use an always-incrementing value saved in the same stable storage as the key, so they are lost together, and starting at a best effort random value, either as the nonce value or as a component to its computation.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
     The 6LN replies to the challenge with an NS(EARO) that includes a new Nonce option (shown as NonceLN in <a href="#Dynamic-fig" class="xref">Figure 5</a>), the CIPO (<a href="#cryptoidopt" class="xref">Section 4.3</a>), and the NDPSO containing the signature. Both Nonces are included in the signed material.
        This provides a "contributory behavior", so that either party that knows it generates a good quality nonce knows that the protocol will be secure.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
        The 6LR MUST store the information associated to a Crypto-ID on the first NS exchange where it appears in a fashion that the CIPO parameters can be retrieved from the Crypto-ID alone.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<span id="name-on-link-protocol-operation"></span><div id="Dynamic-fig">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-6.1-5.1">
<pre>
    6LN                                                     6LR
     |                                                       |
     |&lt;------------------------- RA -------------------------|
     |                                                       | ^
     |---------------- NS with EARO (Crypto-ID) ------------&gt;| |
     |                                                       | option
     |&lt;- NA with EARO (status=Validation Requested), NonceLR-| |
     |                                                       | v
     |------- NS with EARO, CIPO, NonceLN and NDPSO --------&gt;|
     |                                                       |
     |&lt;------------------- NA with EARO ---------------------|
     |                                                       |
                               ...
     |                                                       |
     |--------------- NS with EARO (Crypto-ID) -------------&gt;|
     |                                                       |
     |&lt;------------------- NA with EARO ---------------------|
     |                                                       |
                               ...
     |                                                       |
     |--------------- NS with EARO (Crypto-ID) -------------&gt;|
     |                                                       |
     |&lt;------------------- NA with EARO ---------------------|
     |                                                       |
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-on-link-protocol-operation" class="selfRef">On-link Protocol Operation</a>
          </figcaption></figure>
</div>
<p id="section-6.1-6">The steps for the registration to the 6LR are as follows:<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.1-7.1">
            Upon the first exchange with a 6LR, a 6LN will be challenged to prove ownership of the Crypto-ID and the Target Address being registered in the Neighbor Solicitation message. When a 6LR receives a NS(EARO) registration with a new Crypto-ID as a ROVR, and unless the registration is rejected for another reason, it MUST challenge by responding with a NA(EARO) with a status of "Validation Requested".<a href="#section-6.1-7.1" class="pilcrow">¶</a>
</li>
<li id="section-6.1-7.2">
            Upon receiving a first NA(EARO) with a status of "Validation Requested" from a 6LR, the registering node SHOULD retry its registration with a Crypto-ID Parameters Option (CIPO) (<a href="#cryptoidopt" class="xref">Section 4.3</a>) that contains all the necessary material for building the Crypto-ID, the NonceLN that it generated, and the NDP signature (<a href="#ndpso" class="xref">Section 4.4</a>) option that proves its ownership of the Crypto-ID and intent of registering the Target Address. In subsequent revalidation with the same 6LR, the 6LN MAY try to omit the CIPO to save bandwidth, with the expectation that the 6LR saved it. If the validation fails and it gets challenged again, then it SHOULD add the CIPO again.<a href="#section-6.1-7.2" class="pilcrow">¶</a>
</li>
<li id="section-6.1-7.3">
            In order to validate the ownership, the 6LR performs the same steps as the 6LN and rebuilds the Crypto-ID based on the parameters in the CIPO. If the rebuilt Crypto-ID matches the ROVR, the 6LN also verifies the signature contained in the NDPSO option. If at that point the signature in the NDPSO option can be verified, then the validation succeeds. Otherwise the validation fails.<a href="#section-6.1-7.3" class="pilcrow">¶</a>
</li>
<li id="section-6.1-7.4">
            If the 6LR fails to validate the signed NS(EARO), it responds with a status of "Validation Failed". After receiving a NA(EARO) with a status of "Validation Failed", the registering node SHOULD try to register an alternate target address in the NS message.<a href="#section-6.1-7.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-6.1-8"><a href="#section-6.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ndpso-generation">
<section id="section-6.2">
        <h3 id="name-ndpso-generation-and-verifi">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-ndpso-generation-and-verifi" class="section-name selfRef">NDPSO generation and verification</a>
        </h3>
<p id="section-6.2-1">
      The signature generated by the 6LN to provide proof-of-ownership of the
  private-key is carried in the NDP Signature Option (NDPSO).
  It is generated by the 6LN in a fashion that depends on the Crypto-Type
  (see <a href="#cryptotypetable" class="xref">Table 2</a> in
  <a href="#cryptotypereg" class="xref">Section 8.3</a>) chosen by the 6LN as follows:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">Concatenate the following in the order listed:<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.2-2.1.2">
              <li id="section-6.2-2.1.2.1">The 128-bit Message Type tag <span>[<a href="#RFC3972" class="xref">RFC3972</a>]</span> (in network byte order). For this specification the tag is 0x8701 55c8 0cca dd32 6ab7 e415 f148 84d0.  (The tag value has been generated by the editor of this specification on random.org).<a href="#section-6.2-2.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-6.2-2.1.2.2">JWK-encoded public key<a href="#section-6.2-2.1.2.2" class="pilcrow">¶</a>
</li>
<li id="section-6.2-2.1.2.3">the 16-byte Target Address (in network byte order) sent in the Neighbor Solicitation (NS) message. It is the address which the 6LN is registering with the 6LR and 6LBR.<a href="#section-6.2-2.1.2.3" class="pilcrow">¶</a>
</li>
<li id="section-6.2-2.1.2.4">NonceLR received from the 6LR (in network byte order) in the Neighbor Advertisement (NA) message. The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-2.1.2.4" class="pilcrow">¶</a>
</li>
<li id="section-6.2-2.1.2.5">NonceLN sent from the 6LN (in network byte order). The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-2.1.2.5" class="pilcrow">¶</a>
</li>
<li id="section-6.2-2.1.2.6">1-byte Option Length of the EARO containing the Crypto-ID.<a href="#section-6.2-2.1.2.6" class="pilcrow">¶</a>
</li>
<li id="section-6.2-2.1.2.7">1-byte Crypto-Type value sent in the CIPO.<a href="#section-6.2-2.1.2.7" class="pilcrow">¶</a>
</li>
</ol>
</li>
<li id="section-6.2-2.2">Apply the hash function (if any) specified by the Crypto-Type to the concatenated data, e.g., hash the resulting data using SHA-256.<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
<li id="section-6.2-2.3">
          Apply the signature algorithm specified by the Crypto-Type, e.g., sign the hash output with ECDSA (if curve P-256 is used) or sign the hash with EdDSA (if curve Ed25519 (PureEdDSA)).<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-6.2-3">
      The 6LR on receiving the NDPSO and CIPO options first checks that the EARO Length in the CIPO matches the length of the EARO. If so it regenerates the Crypto-ID based on the CIPO to make sure that the leftmost bits up to the size of the ROVR match.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">
         If and only if the check is successful, it tries to verify the signature in the NDPSO option using the following:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.2-5.1">
            <p id="section-6.2-5.1.1">Concatenate the following in the order listed:<a href="#section-6.2-5.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.2-5.1.2">
              <li id="section-6.2-5.1.2.1">128-bit type tag (in network byte order)<a href="#section-6.2-5.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.1.2.2">JWK-encoded public key received in the CIPO<a href="#section-6.2-5.1.2.2" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.1.2.3">the 16-byte Target Address (in network byte order) received in the Neighbor Solicitation (NS) message. It is the address which the 6LN is registering with the 6LR and 6LBR.<a href="#section-6.2-5.1.2.3" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.1.2.4">NonceLR sent in the Neighbor Advertisement (NA) message. The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-5.1.2.4" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.1.2.5">NonceLN received from the 6LN (in network byte order) in the NS message. The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-5.1.2.5" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.1.2.6">1-byte EARO Length received in the CIPO.<a href="#section-6.2-5.1.2.6" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.1.2.7">1-byte Crypto-Type value received in the CIPO.<a href="#section-6.2-5.1.2.7" class="pilcrow">¶</a>
</li>
</ol>
</li>
<li id="section-6.2-5.2">
          Apply the hash function (if any) specified by the Crypto-Type indicated by the 6LN in the CIPO to the concatenated data.<a href="#section-6.2-5.2" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.3">
          Verify the signature with the public-key in the CIPO and the locally computed values using the signature algorithm specified by the Crypto-Type. If the verification succeeds, the 6LR propagates the information to the 6LBR using a EDAR/EDAC flow.<a href="#section-6.2-5.3" class="pilcrow">¶</a>
</li>
<li id="section-6.2-5.4">
          Due to the first-come/first-serve nature of the registration, if the address is not registered to the 6LBR, then flow succeeds and both the 6LR and 6LBR add the state information about the Crypto-ID and Target Address being registered to their respective abstract database.<a href="#section-6.2-5.4" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="mhopo">
<section id="section-6.3">
        <h3 id="name-multihop-operation">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-multihop-operation" class="section-name selfRef">Multihop Operation</a>
        </h3>
<p id="section-6.3-1">
     A new 6LN that joins the network auto-configures an address and performs an initial registration to a neighboring 6LR with an NS message that carries an Address Registration Option (EARO) <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">
     In a multihop 6LoWPAN, the registration with Crypto-ID is propagated to 6LBR as shown in <a href="#figReg" class="xref">Figure 6</a>, which illustrates the
     registration flow all the way to a 6LowPAN Backbone Router (6BBR)
    <span>[<a href="#I-D.ietf-6lo-backbone-router" class="xref">BACKBONE-ROUTER</a>]</span>.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">
     The 6LR and the 6LBR communicate using ICMPv6 Extended Duplicate Address Request (EDAR) and Extended Duplicate Address Confirmation (EDAC) messages <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> as shown in <a href="#figReg" class="xref">Figure 6</a>.
     This specification extends EDAR/EDAC messages to carry cryptographically generated ROVR.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">
     The assumption is that the 6LR and the 6LBR maintain a security association to authenticate and protect the integrity of the EDAR and EDAC messages, so there is no need to propagate the proof of ownership to the 6LBR. The 6LBR implicitly trusts that the 6LR performs the verification when the 6LBR requires it, and if there is no further exchange from the 6LR to remove the state, that the verification succeeded.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<span id="name-re-registration-flow"></span><div id="figReg">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-6.3-5.1">
<pre>

     6LN              6LR             6LBR            6BBR
      |                |               |                |
      |   NS(EARO)     |               |                |
      |---------------&gt;|               |                |
      |                | Extended DAR  |                |
      |                |--------------&gt;|                |
      |                |               |                |
      |                |               | proxy NS(EARO) |
      |                |               |---------------&gt;|
      |                |               |                | NS(DAD)
      |                |               |                | ------&gt;
      |                |               |                |
      |                |               |                | &lt;wait&gt;
      |                |               |                |
      |                |               | proxy NA(EARO) |
      |                |               |&lt;---------------|
      |                | Extended DAC  |                |
      |                |&lt;--------------|                |
      |   NA(EARO)     |               |                |
      |&lt;---------------|               |                |
      |                |               |                |
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-re-registration-flow" class="selfRef">(Re-)Registration Flow</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-inheriting-from-rfc-3971">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-inheriting-from-rfc-3971" class="section-name selfRef">Inheriting from RFC 3971</a>
        </h3>
<p id="section-7.1-1">
        Observations regarding the following threats to the local network in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> also apply to this specification.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-7.1-2">
          <dt id="section-7.1-2.1">Neighbor Solicitation/Advertisement Spoofing:</dt>
<dd id="section-7.1-2.2">
         Threats in section  9.2.1 of RFC3971 apply. AP-ND counters the threats on NS(EARO) messages by requiring that the NDP Signature and CIPO options be present in these solicitations.<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-7.1-2.3">Duplicate Address Detection DoS Attack:</dt>
<dd id="section-7.1-2.4">
        Inside the LLN, Duplicate Addresses are sorted out using the ROVR, which differentiates it from a movement. A different ROVR for the same Registered address entails a rejection of the second registration <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.
        DAD coming from the backbone are not forwarded over the LLN, which provides some protection against DoS attacks inside the resource-constrained part of the network. Over the backbone, the EARO option is present in NS/NA messages. This protects against misinterpreting a movement for a duplication, and enables the backbone routers to determine which one has the freshest registration <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and is thus the best candidate to validate the registration for the device attached to it <span>[<a href="#I-D.ietf-6lo-backbone-router" class="xref">BACKBONE-ROUTER</a>]</span>. But this specification does not guarantee that the backbone router claiming an address over the backbone is not an attacker.<a href="#section-7.1-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-7.1-2.5">Router Solicitation and Advertisement Attacks:</dt>
<dd id="section-7.1-2.6">
         This specification does not change the protection of RS and RA which can still be protected by SEND.<a href="#section-7.1-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-7.1-2.7">Replay Attacks</dt>
<dd id="section-7.1-2.8">
         A nonce should never repeat for a single key, but nonces do not need to be unpredictable for secure operation. Using nonces (NonceLR and NonceLN) generated by both the 6LR and 6LN ensure a contributory behavior that provides an efficient protection against replay attacks of the challenge/response flow. The quality of the protection by a random nonce depends on the random number generator and its parameters (e.g., sense of time).<a href="#section-7.1-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-7.1-2.9">Neighbor Discovery DoS Attack:</dt>
<dd id="section-7.1-2.10">
         A rogue node that managed to access the L2 network may form many addresses and register them using AP-ND. The perimeter of the attack is all the 6LRs in range of the attacker. The 6LR MUST protect itself against overflows and reject excessive registration with a status 2 "Neighbor Cache Full". This effectively blocks another (honest) 6LN from registering to the same 6LR, but the 6LN may register to other 6LRs that are in its range but not in that of the rogue.<a href="#section-7.1-2.10" class="pilcrow">¶</a>
</dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-related-to-6lowpan-nd">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-related-to-6lowpan-nd" class="section-name selfRef">Related to 6LoWPAN ND</a>
        </h3>
<p id="section-7.2-1">
     The threats and mediations discussed in 6LoWPAN ND <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> also apply here, in particular denial-of-service attacks against the registry at the 6LR or 6LBR.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">
            Secure ND <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> forces the IPv6 address to be cryptographic since it integrates the CGA as the IID in the IPv6 address. In contrast, this specification saves about 1Kbyte in every NS/NA message. Also, this specification separates the cryptographic identifier from the registered IPv6 address so that a node can have more than one IPv6 address protected by the same cryptographic identifier.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">
            With this specification the 6LN can freely form its IPv6 address(es) in any fashion, thereby enabling either 6LoWPAN compression for IPv6 addresses that are derived from Layer-2 addresses, or temporary addresses, e.g., formed pseudo-randomly and released in relatively short cycles for privacy reasons <span>[<a href="#RFC8064" class="xref">RFC8064</a>]</span><span>[<a href="#RFC8065" class="xref">RFC8065</a>]</span>, that cannot be compressed.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">
            This specification provides added protection for addresses that are obtained following due procedure <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>  but does not constrain the way the addresses are formed or the number of addresses that are used in parallel by a same entity. A rogue may still perform denial-of-service attack against the registry at the 6LR or 6LBR, or attempt to deplete the pool of available addresses at Layer-2 or Layer-3.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
<div id="sec-col">
<section id="section-7.3">
        <h3 id="name-rovr-collisions">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-rovr-collisions" class="section-name selfRef">ROVR Collisions</a>
        </h3>
<p id="section-7.3-1">
     A collision of Registration Ownership Verifiers (ROVR) (i.e., the Crypto-ID in this specification) is possible, but it is a rare event.
        Assuming in the calculations/discussion below that the hash used for calculating the Crypto-ID is a well-behaved cryptographic hash and thus
        that random collisions are the only ones possible, the formula (birthday paradox) for calculating the probability of a collision is 1 - e^{-k^2/(2n)} where n is the maximum population size (2^64 here, 1.84E19) and k is the actual population (number of nodes, assuming one Crypto-ID per node).<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">
        If the Crypto-ID is 64-bits (the least possible size allowed), the chance of a collision is 0.01% for network of 66 million nodes. Moreover, the collision is only relevant when this happens within one stub network (6LBR). In the case of such a collision, a third party node would be able to claim the registered address of an another legitimate node, provided that it wishes to use the same address.
        To prevent address disclosure and avoid the chances of collision on both the ROVR and the address, it is RECOMMENDED that nodes do not derive the address being registered from the ROVR.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7.4">
        <h3 id="name-implementation-attacks">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-implementation-attacks" class="section-name selfRef">Implementation Attacks</a>
        </h3>
<p id="section-7.4-1"> The signature schemes referenced in this specification comply with NIST <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> or Crypto Forum Research Group (CFRG) standards
 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> and offer strong algorithmic security at roughly 128-bit security level. These signature schemes use elliptic curves that were either
 specifically designed with exception-free and constant-time arithmetic in mind <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> or where one has extensive implementation experience of resistance
 to timing attacks <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>. However, careless implementations of the signing operations could nevertheless leak information on private keys. For example,
 there are micro-architectural side channel attacks that implementors should be aware of <span>[<a href="#breaking-ed25519" class="xref">breaking-ed25519</a>]</span>. Implementors should be particularly aware that
 a secure implementation of Ed25519 requires a protected implementation of the hash function SHA-512, whereas this is not required with implementations of SHA-256 used with
 ECDSA.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-7.5">
        <h3 id="name-cross-algorithm-and-cross-p">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-cross-algorithm-and-cross-p" class="section-name selfRef">Cross-Algorithm and Cross-Protocol Attacks</a>
        </h3>
<p id="section-7.5-1">
        The keypair used in this specification can be self-generated and the public key does not need to be exchanged, e.g., through certificates, with a third party before it is used. New keypairs can be formed for new registration as the node desires.
        On the other hand, it is safer to allocate a keypair that is used only for the address protection and only for one instantiation of the signature scheme (which includes
 choice of elliptic curve domain parameters, used hash function, and applicable representation conventions).
        The same private key MUST NOT be reused with more than one instantiation of the signature scheme in this specification. The same private key MUST NOT be used for anything other than computing NDPSO signatures per this specification.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-7.6">
        <h3 id="name-compromised-6lr">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-compromised-6lr" class="section-name selfRef">Compromised 6LR</a>
        </h3>
<p id="section-7.6-1">
        This specification distributes the challenge and its validation at the edge of the network, between the 6LN and its 6LR. This protects against DOS attacks targeted at that central 6LBR. This also saves back and forth exchanges across a potentially large and constrained network.
        The downside is that the 6LBR needs to trust the 6LR for performing the checking adequately, and the communication between the 6LR and the 6LBR must be protected to avoid tempering with the result of the test. If a 6LR is compromised, and provided that it knows the ROVR field used by the real owner of the address, the 6LR may pretend that the owner has moved, is now attached to it and has successfully passed the Crpto-ID validation. The 6LR may then attract and inject traffic at will on behalf of that address or let a rogue take ownership of the address.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
<section id="section-7.7">
        <h3 id="name-correlating-registrations">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-correlating-registrations" class="section-name selfRef">Correlating Registrations</a>
        </h3>
<p id="section-7.7-1">
          The ROVR field in the EARO introduced in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> extends the EUI-64 field of the ARO defined in <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>. One of the drawbacks of using an EUI-64 as ROVR is that an attacker that is aware of the registrations can correlate traffic for a same 6LN across multiple addresses. Section 3 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> indicates that the ROVR and the address being registered are decoupled. A 6LN may use a same ROVR for multiple registrations or a different ROVR per registration, and the IID must not derive from the ROVR. In theory different 6LNs could use a same ROVR as long as they do not attempt to register the same address.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">
          The Modifier used in the computation of the Crypto-ID enables a 6LN to build different Crypto-IDs for different addresses with a same keypair. Using that facility improves the privacy of the 6LN as the expense of storage in the 6LR, which will need to store multiple CIPOs that contain the same public key. Note that if the attacker is the 6LR, then the Modifier alone does not provide a protection, and the 6LN would need to use different keys and MAC addresses in an attempt to obfuscate its multiple ownership.<a href="#section-7.7-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA considerations</a>
      </h2>
<div id="cgam">
<section id="section-8.1">
        <h3 id="name-cga-message-type">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cga-message-type" class="section-name selfRef">CGA Message Type</a>
        </h3>
<p id="section-8.1-1">
    This document defines a new 128-bit value under the CGA Message Type <span>[<a href="#RFC3972" class="xref">RFC3972</a>]</span> name space: 0x8701 55c8 0cca dd32 6ab7 e415 f148 84d0.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ndopt">
<section id="section-8.2">
        <h3 id="name-ipv6-nd-option-types">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-ipv6-nd-option-types" class="section-name selfRef">IPv6 ND option types</a>
        </h3>
<p id="section-8.2-1">
    This document registers two new ND option types under the subregistry "IPv6 Neighbor Discovery Option Formats":<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-new-nd-options"></span><div id="nexndopt">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-new-nd-options" class="selfRef">New ND options</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Option Name</th>
              <th class="text-center" rowspan="1" colspan="1">Suggested Value</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">NDP Signature Option (NDPSO)</td>
              <td class="text-center" rowspan="1" colspan="1">38</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">Crypto-ID Parameters Option (CIPO)</td>
              <td class="text-center" rowspan="1" colspan="1">39</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="cryptotypereg">
<section id="section-8.3">
        <h3 id="name-crypto-type-subregistry">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-crypto-type-subregistry" class="section-name selfRef">Crypto-Type Subregistry</a>
        </h3>
<p id="section-8.3-1">
 IANA is requested to create a new subregistry "Crypto-Type Subregistry" in the "Internet Control Message Protocol version 6 (ICMPv6) Parameters".  The registry is indexed by
 an integer in the interval 0..255 and contains an Elliptic Curve, a Hash Function, a Signature Algorithm, and Representation Conventions, as shown in
 <a href="#cryptotypetable" class="xref">Table 2</a>, which together specify a signature scheme. The following Crypto-Type values are defined in this document:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<span id="name-crypto-types"></span><div id="cryptotypetable">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-crypto-types" class="selfRef">Crypto-Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Crypto-Type value</th>
              <th class="text-center" rowspan="1" colspan="1"> 0 (ECDSA256) </th>
              <th class="text-center" rowspan="1" colspan="1"> 1 (Ed25519) </th>
              <th class="text-center" rowspan="1" colspan="1"> 2 (ECDSA25519) </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Elliptic curve</td>
              <td class="text-center" rowspan="1" colspan="1"> NIST P-256 <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1"> Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1"> Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Hash function</td>
              <td class="text-center" rowspan="1" colspan="1"> SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1"> SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1"> SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Signature algorithm</td>
              <td class="text-center" rowspan="1" colspan="1"> ECDSA <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1"> Ed25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1"> ECDSA <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Representation conventions</td>
              <td class="text-center" rowspan="1" colspan="1"> Weierstrass, uncompressed, MSB/msb first </td>
              <td class="text-center" rowspan="1" colspan="1"> Edwards,     compressed, LSB/lsb first </td>
              <td class="text-center" rowspan="1" colspan="1"> Weierstrass, compressed, MSB/msb first </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Defining specification</td>
              <td class="text-center" rowspan="1" colspan="1">This document</td>
              <td class="text-center" rowspan="1" colspan="1">This document</td>
              <td class="text-center" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.3-3">
 New Crypto-Type values providing similar or better security may be defined in the future.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">
    Assignment of new values for new Crypto-Type MUST be done through IANA with
 either "Specification Required" or "IESG Approval" as defined in BCP 26
 <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">
    The "Defining specification" column indicates the document that defines the length and computation of the digital signature, which could be this for values defined through "IESG Approval".<a href="#section-8.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jwke">
<section id="section-8.4">
        <h3 id="name-new-codepoints-associated-t">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-new-codepoints-associated-t" class="section-name selfRef">New Codepoints Associated to JWK Encoding</a>
        </h3>
<p id="section-8.4-1"> Code points are requested for curve Wei25519 and its use with ECDSA, using the representation conventions of this document.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<section id="section-8.4.1">
          <h4 id="name-cose-elliptic-curves-regist">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-cose-elliptic-curves-regist" class="section-name selfRef">COSE Elliptic Curves Registration</a>
          </h4>
<p id="section-8.4.1-1"> This section registers the following value in the IANA "COSE Elliptic Curves" registry <span>[<a href="#IANA.COSE.Curves" class="xref">IANA.COSE.Curves</a>]</span>.<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-8.4.1-2">
            <dt id="section-8.4.1-2.1">Name:</dt>
<dd id="section-8.4.1-2.2"> Wei25519<a href="#section-8.4.1-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.1-2.3">Value:</dt>
<dd id="section-8.4.1-2.4"> TBD (Requested value: -1)<a href="#section-8.4.1-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.1-2.5">Key Type:</dt>
<dd id="section-8.4.1-2.6"> EC2 or OKP (where OKP uses the MSB/msb representation of this specification)<a href="#section-8.4.1-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.1-2.7">Description:</dt>
<dd id="section-8.4.1-2.8"> short-Weierstrass curve Wei25519<a href="#section-8.4.1-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.1-2.9">Change Controller:</dt>
<dd id="section-8.4.1-2.10"> IESG<a href="#section-8.4.1-2.10" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.1-2.11">Reference:</dt>
<dd id="section-8.4.1-2.12"> Appendix E.3 of <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPRESENTATIONS</a>]</span><a href="#section-8.4.1-2.12" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.1-2.13">Recommended:</dt>
<dd id="section-8.4.1-2.14"> Yes.<a href="#section-8.4.1-2.14" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-8.4.1-3">(Note that The "kty" value for Wei25519 may be "OKP" or "EC2".)<a href="#section-8.4.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-8.4.2">
          <h4 id="name-cose-algorithms-registratio">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-cose-algorithms-registratio" class="section-name selfRef">COSE Algorithms Registration</a>
          </h4>
<p id="section-8.4.2-1"> This section registers the following value in the IANA "COSE Algorithms" registry <span>[<a href="#IANA.COSE.Algorithms" class="xref">IANA.COSE.Algorithms</a>]</span>.<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-8.4.2-2">
            <dt id="section-8.4.2-2.1">Name:</dt>
<dd id="section-8.4.2-2.2"> ECDSA25519<a href="#section-8.4.2-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.2-2.3">Value:</dt>
<dd id="section-8.4.2-2.4"> TBD (Requested value: -1)<a href="#section-8.4.2-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.2-2.5">Description:</dt>
<dd id="section-8.4.2-2.6"> ECDSA using SHA-256 and curve Wei25519<a href="#section-8.4.2-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.2-2.7">Change Controller:</dt>
<dd id="section-8.4.2-2.8"> IESG<a href="#section-8.4.2-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.2-2.9">Reference:</dt>
<dd id="section-8.4.2-2.10">  Section 4.3 of <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPRESENTATIONS</a>]</span><a href="#section-8.4.2-2.10" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.2-2.11">Recommended:</dt>
<dd id="section-8.4.2-2.12"> Yes.<a href="#section-8.4.2-2.12" class="pilcrow">¶</a>
</dd>
</dl>
</section>
<section id="section-8.4.3">
          <h4 id="name-jose-elliptic-curves-regist">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-jose-elliptic-curves-regist" class="section-name selfRef">JOSE Elliptic Curves Registration</a>
          </h4>
<p id="section-8.4.3-1"> This section registers the following value in the IANA "JSON Web Key Elliptic Curve" registry <span>[<a href="#IANA.JOSE.Curves" class="xref">IANA.JOSE.Curves</a>]</span>.<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-8.4.3-2">
            <dt id="section-8.4.3-2.1">Curve Name:</dt>
<dd id="section-8.4.3-2.2"> Wei25519<a href="#section-8.4.3-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.3-2.3">Curve Description:</dt>
<dd id="section-8.4.3-2.4"> short-Weierstrass curve Wei25519<a href="#section-8.4.3-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.3-2.5">JOSE Implementation Requirements:</dt>
<dd id="section-8.4.3-2.6"> Optional<a href="#section-8.4.3-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.3-2.7">Change Controller:</dt>
<dd id="section-8.4.3-2.8"> IESG<a href="#section-8.4.3-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.3-2.9">Reference:</dt>
<dd id="section-8.4.3-2.10"> Appendix E.3 of <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPRESENTATIONS</a>]</span><a href="#section-8.4.3-2.10" class="pilcrow">¶</a>
</dd>
</dl>
</section>
<section id="section-8.4.4">
          <h4 id="name-jose-algorithms-registratio">
<a href="#section-8.4.4" class="section-number selfRef">8.4.4. </a><a href="#name-jose-algorithms-registratio" class="section-name selfRef">JOSE Algorithms Registration</a>
          </h4>
<p id="section-8.4.4-1"> This section registers the following value in the IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JOSE.Algorithms" class="xref">IANA.JOSE.Algorithms</a>]</span>.<a href="#section-8.4.4-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-8.4.4-2">
            <dt id="section-8.4.4-2.1">Algorithm Name:</dt>
<dd id="section-8.4.4-2.2"> ECDSA25519<a href="#section-8.4.4-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.4-2.3">Algorithm Description:</dt>
<dd id="section-8.4.4-2.4"> ECDSA using SHA-256 and curve Wei25519<a href="#section-8.4.4-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.4-2.5">Algorithm Usage Locations:</dt>
<dd id="section-8.4.4-2.6"> alg<a href="#section-8.4.4-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.4-2.7">JOSE Implementation Requirements:</dt>
<dd id="section-8.4.4-2.8"> Optional<a href="#section-8.4.4-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.4-2.9">Change Controller:</dt>
<dd id="section-8.4.4-2.10"> IESG<a href="#section-8.4.4-2.10" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.4-2.11">Reference:</dt>
<dd id="section-8.4.4-2.12"> Section 4.3 of <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPRESENTATIONS</a>]</span><a href="#section-8.4.4-2.12" class="pilcrow">¶</a>
</dd>
<dt id="section-8.4.4-2.13">Algorithm Analysis Document(s):</dt>
<dd id="section-8.4.4-2.14"> Section 4.3 of <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPRESENTATIONS</a>]</span><a href="#section-8.4.4-2.14" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</section>
</div>
</section>
<section id="section-9">
      <h2 id="name-acknowledgments">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-9-1">
     Many thanks to Charlie Perkins for his in-depth review and constructive
     suggestions. The authors are also especially grateful to Robert Moskowitz
     and Benjamin Kaduk for their comments and discussions that led to many improvements.
     The authors wish to also thank Roman Danyliw, Alissa Cooper, Mirja Kuhlewind, Eric Vyncke, Vijay Gurbani, Al Morton and Adam Montville for their constructive reviews during the IESG process.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC6775">[RFC6775]</dt>
<dd>
<span class="refAuthor">Shelby, Z., Ed.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time datetime="2012-11">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dt id="RFC7517">[RFC7517]</dt>
<dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC3971">[RFC3971]</dt>
<dd>
<span class="refAuthor">Arkko, J., Ed.</span><span class="refAuthor">, Kempf, J.</span><span class="refAuthor">, Zill, B.</span><span class="refAuthor">, and P. Nikander</span>, <span class="refTitle">"SEcure Neighbor Discovery (SEND)"</span>, <span class="seriesInfo">RFC 3971</span>, <span class="seriesInfo">DOI 10.17487/RFC3971</span>, <time datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3971">https://www.rfc-editor.org/info/rfc3971</a>&gt;</span>. </dd>
<dt id="RFC7748">[RFC7748]</dt>
<dd>
<span class="refAuthor">Langley, A.</span><span class="refAuthor">, Hamburg, M.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dt id="RFC8032">[RFC8032]</dt>
<dd>
<span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dt id="RFC8505">[RFC8505]</dt>
<dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, and C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dt id="RFC6234">[RFC6234]</dt>
<dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dt id="FIPS186-4">[FIPS186-4]</dt>
<dd>
<span class="refAuthor">FIPS 186-4</span>, <span class="refTitle">"Digital Signature Standard (DSS), Federal Information Processing Standards Publication 186-4"</span>, <span class="seriesInfo">US Department of Commerce/National Institute of Standards and Technology </span>, <time datetime="2013-07">July 2013</time>. </dd>
<dt id="SEC1">[SEC1]</dt>
<dd>
<span class="refAuthor">SEC1</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography, Version 2.0"</span>, <span class="seriesInfo">Standards for Efficient Cryptography </span>, <time datetime="2009-06">June 2009</time>. </dd>
</dl>
</section>
<section id="section-11">
      <h2 id="name-informative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-references" class="section-name selfRef">Informative references</a>
      </h2>
<dl class="references">
<dt id="IANA.COSE.Algorithms">[IANA.COSE.Algorithms]</dt>
<dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span class="seriesInfo">IANA, https://www.iana.org/assignments/cose/cose.xhtml#algorithms</span>, <time></time>. </dd>
<dt id="IANA.COSE.Curves">[IANA.COSE.Curves]</dt>
<dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Elliptic Curves"</span>, <span class="seriesInfo">IANA, https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves</span>, <time></time>. </dd>
<dt id="IANA.JOSE.Algorithms">[IANA.JOSE.Algorithms]</dt>
<dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Signature and Encryption Algorithms"</span>, <span class="seriesInfo">IANA, https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms</span>, <time></time>. </dd>
<dt id="IANA.JOSE.Curves">[IANA.JOSE.Curves]</dt>
<dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Key Elliptic Curve"</span>, <span class="seriesInfo">IANA, https://www.iana.org/assignments/jose/jose.xhtml#web-key-elliptic-curve</span>, <time></time>. </dd>
<dt id="RFC3972">[RFC3972]</dt>
<dd>
<span class="refAuthor">Aura, T.</span>, <span class="refTitle">"Cryptographically Generated Addresses (CGA)"</span>, <span class="seriesInfo">RFC 3972</span>, <span class="seriesInfo">DOI 10.17487/RFC3972</span>, <time datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3972">https://www.rfc-editor.org/info/rfc3972</a>&gt;</span>. </dd>
<dt id="RFC4861">[RFC4861]</dt>
<dd>
<span class="refAuthor">Narten, T.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Simpson, W.</span><span class="refAuthor">, and H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dt id="RFC4862">[RFC4862]</dt>
<dd>
<span class="refAuthor">Thomson, S.</span><span class="refAuthor">, Narten, T.</span><span class="refAuthor">, and T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dt id="RFC4944">[RFC4944]</dt>
<dd>
<span class="refAuthor">Montenegro, G.</span><span class="refAuthor">, Kushalnagar, N.</span><span class="refAuthor">, Hui, J.</span><span class="refAuthor">, and D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4944">https://www.rfc-editor.org/info/rfc4944</a>&gt;</span>. </dd>
<dt id="RFC6282">[RFC6282]</dt>
<dd>
<span class="refAuthor">Hui, J., Ed.</span><span class="refAuthor"> and P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dt id="RFC4919">[RFC4919]</dt>
<dd>
<span class="refAuthor">Kushalnagar, N.</span><span class="refAuthor">, Montenegro, G.</span><span class="refAuthor">, and C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
<dt id="RFC4086">[BCP 106]</dt>
<dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dt id="RFC8126">[RFC8126]</dt>
<dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dt id="RFC7039">[RFC7039]</dt>
<dd>
<span class="refAuthor">Wu, J.</span><span class="refAuthor">, Bi, J.</span><span class="refAuthor">, Bagnulo, M.</span><span class="refAuthor">, Baker, F.</span><span class="refAuthor">, and C. Vogt, Ed.</span>, <span class="refTitle">"Source Address Validation Improvement (SAVI) Framework"</span>, <span class="seriesInfo">RFC 7039</span>, <span class="seriesInfo">DOI 10.17487/RFC7039</span>, <time datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7039">https://www.rfc-editor.org/info/rfc7039</a>&gt;</span>. </dd>
<dt id="RFC7217">[RFC7217]</dt>
<dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"</span>, <span class="seriesInfo">RFC 7217</span>, <span class="seriesInfo">DOI 10.17487/RFC7217</span>, <time datetime="2014-04">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7217">https://www.rfc-editor.org/info/rfc7217</a>&gt;</span>. </dd>
<dt id="RFC7696">[BCP 201]</dt>
<dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms"</span>, <span class="seriesInfo">BCP 201</span>, <span class="seriesInfo">RFC 7696</span>, <span class="seriesInfo">DOI 10.17487/RFC7696</span>, <time datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7696">https://www.rfc-editor.org/info/rfc7696</a>&gt;</span>. </dd>
<dt id="RFC8064">[RFC8064]</dt>
<dd>
<span class="refAuthor">Gont, F.</span><span class="refAuthor">, Cooper, A.</span><span class="refAuthor">, Thaler, D.</span><span class="refAuthor">, and W. Liu</span>, <span class="refTitle">"Recommendation on Stable IPv6 Interface Identifiers"</span>, <span class="seriesInfo">RFC 8064</span>, <span class="seriesInfo">DOI 10.17487/RFC8064</span>, <time datetime="2017-02">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8064">https://www.rfc-editor.org/info/rfc8064</a>&gt;</span>. </dd>
<dt id="RFC8065">[RFC8065]</dt>
<dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refTitle">"Privacy Considerations for IPv6 Adaptation-Layer Mechanisms"</span>, <span class="seriesInfo">RFC 8065</span>, <span class="seriesInfo">DOI 10.17487/RFC8065</span>, <time datetime="2017-02">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8065">https://www.rfc-editor.org/info/rfc8065</a>&gt;</span>. </dd>
<dt id="I-D.ietf-6lo-backbone-router">[BACKBONE-ROUTER]</dt>
<dd>
<span class="refAuthor">Thubert, P.</span><span class="refAuthor">, Perkins, C.</span><span class="refAuthor">, and E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6lo-backbone-router-19</span>, <time datetime="2020-03-03">3 March 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-6lo-backbone-router-19">https://tools.ietf.org/html/draft-ietf-6lo-backbone-router-19</a>&gt;</span>. </dd>
<dt id="I-D.ietf-lwig-curve-representations">[CURVE-REPRESENTATIONS]</dt>
<dd>
<span class="refAuthor">Struik, R.</span>, <span class="refTitle">"Alternative Elliptic Curve Representations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lwig-curve-representations-08</span>, <time datetime="2019-07-24">24 July 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-08">https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-08</a>&gt;</span>. </dd>
<dt id="breaking-ed25519">[breaking-ed25519]</dt>
<dd>
<span class="refAuthor">Samwel, N.</span><span class="refAuthor">, Batina, L.</span><span class="refAuthor">, Bertoni, G.</span><span class="refAuthor">, Daemen, J.</span><span class="refAuthor">, and R. Susella</span>, <span class="refTitle">"Breaking Ed25519 in WolfSSL"</span>, <span class="seriesInfo">Cryptographers' Track at the RSA Conference </span>, <time datetime="2018">2018</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-319-76953-0_1">https://link.springer.com/chapter/10.1007/978-3-319-76953-0_1</a>&gt;</span>. </dd>
</dl>
</section>
<div id="ps">
<section id="section-appendix.a">
      <h2 id="name-requirements-addressed-in-t">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-requirements-addressed-in-t" class="section-name selfRef">Requirements Addressed in this Document</a>
      </h2>
<p id="section-appendix.a-1">
      In this section we state requirements of a secure neighbor discovery protocol for low-power and lossy networks.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.a-2.1">
       The protocol MUST be based on the Neighbor Discovery Optimization for Low-power and Lossy Networks protocol defined in <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>. RFC6775 utilizes optimizations such as host-initiated interactions for sleeping resource-constrained hosts and elimination of multicast address resolution.<a href="#section-appendix.a-2.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.2">
        New options to be added to Neighbor Solicitation messages MUST lead to small packet sizes, especially compared with existing protocols such as SEcure Neighbor Discovery (SEND). Smaller packet sizes facilitate low-power transmission by resource-constrained nodes on lossy links.<a href="#section-appendix.a-2.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.3">
        The support for this registration mechanism SHOULD be extensible to more LLN links than IEEE 802.15.4 only. Support for at least the LLN links for which a 6lo "IPv6 over foo" specification exists, as well as Low-Power Wi-Fi SHOULD be possible.<a href="#section-appendix.a-2.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.4">
        As part of this extension, a mechanism to compute a unique Identifier should be provided with the capability to form a Link Local Address that SHOULD be unique at least within the LLN connected to a 6LBR.<a href="#section-appendix.a-2.4" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.5">
        The Address Registration Option used in the ND registration SHOULD be extended to carry the relevant forms of
        Unique Interface Identifier.<a href="#section-appendix.a-2.5" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.6">
        The Neighbor Discovery should specify the formation of a site-local address that follows the security recommendations from <span>[<a href="#RFC7217" class="xref">RFC7217</a>]</span>.<a href="#section-appendix.a-2.6" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-appendix.a-3"><a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reprconv">
<section id="section-appendix.b">
      <h2 id="name-representation-conventions">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-representation-conventions" class="section-name selfRef">Representation Conventions</a>
      </h2>
<section id="section-b.1">
        <h2 id="name-signature-schemes">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-signature-schemes" class="section-name selfRef">Signature Schemes</a>
        </h2>
<p id="section-b.1-1"> The signature scheme ECDSA256 corresponding to Crypto-Type 0 is ECDSA, as specified in <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, instantiated with the NIST prime curve P-256,
 as specified in Appendix B of <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, and the hash function SHA-256, as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, where points of this NIST curve are
 represented as points of a short-Weierstrass curve (see <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>) and are encoded as octet strings in most-significant-bit first (msb) and
 most-significant-byte first (MSB) order. The signature itself consists of two integers (r and s), which are each encoded as fixed-size octet strings in most-significant-bit
 first and most-significant-byte first order. For details on ECDSA, see <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>; for details on the integer encoding, see
 <a href="#bitrepr" class="xref">Appendix B.2</a>.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<p id="section-b.1-2"> The signature scheme Ed25519 corresponding to Crypto-Type 1 is EdDSA, as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, instantiated with the Montgomery curve Curve25519, as
 specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, and the hash function SHA-512, as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, where points of this Montgomery curve are
 represented as points of the corresponding twisted Edwards curve (see <a href="#curves" class="xref">Appendix B.3</a>) and are encoded as octet strings in least-significant-bit first (lsb)
 and least-significant-byte first (LSB) order. The signature itself consists of a bit string that encodes a point of this twisted Edwards curve, in compressed format, and an
 integer encoded in least-significant-bit first and least-significant-byte first order. For details on EdDSA and on the encoding conversions, see the specification
 of pure Ed25519 in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-b.1-2" class="pilcrow">¶</a></p>
<p id="section-b.1-3"> The signature scheme ECDSA25519 corresponding to Crypto-Type 2 is ECDSA, as specified in <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, instantiated with the Montgomery curve
 Curve25519, as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, and the hash function SHA-256, as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, where points of this Montgomery
 curve are represented as points of a corresponding curve in short-Weierstrass form (see <a href="#curves" class="xref">Appendix B.3</a>) and are encoded as octet strings in
 most-significant-bit first and most-significant-byte first order. The signature itself consists of a bit string that encodes two integers, each encoded as fixed-size
 octet strings in most-significant-bit first and most-significant-byte first order. For details on ECDSA, see <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>; for details on the integer
 encoding, see <a href="#bitrepr" class="xref">Appendix B.2</a><a href="#section-b.1-3" class="pilcrow">¶</a></p>
</section>
<div id="bitrepr">
<section id="section-b.2">
        <h2 id="name-integer-representation-for-">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-integer-representation-for-" class="section-name selfRef">Integer Representation for ECDSA signatures</a>
        </h2>
<p id="section-b.2-1"> With ECDSA, each signature is an ordered pair (r, s) of integers <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>. Each integer is encoded as a fixed-size 256-bit bit string, where each
 integer is represented according to the Field Element to Octet String and Octet String to Bit String conversion rules in <span>[<a href="#SEC1" class="xref">SEC1</a>]</span> and where the
 ordered pair of integers is represented as the rightconcatenation of the resulting representation values. The inverse operation follows
 the corresponding Bit String to Octet String and Octet String to Field Element conversion rules of <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="curves">
<section id="section-b.3">
        <h2 id="name-alternative-representations">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-alternative-representations" class="section-name selfRef">Alternative Representations of Curve25519</a>
        </h2>
<p id="section-b.3-1"> The elliptic curve Curve25519, as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, is a so-called Montgomery curve. Each point of this curve can also be represented as a point
 of a twisted Edwards curve or as a point of an elliptic curve in short-Weierstrass form, via a coordinate transformation (a so-called isomorphic mapping). The parameters of the
 Montgomery curve and the corresponding isomorphic curves in twisted Edwards curve and short-Weierstrass form are as indicated below. Here, the domain parameters of the Montgomery
 curve Curve25519 and of the twisted Edwards curve Edwards25519 are as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>; the domain parameters of the elliptic curve Wei25519 in
 short-Weierstrass curve comply with Section 6.1.1 of <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>. For details of the coordinate transformations referenced above, see
 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> and <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPRESENTATIONS</a>]</span>.<a href="#section-b.3-1" class="pilcrow">¶</a></p>
<p id="section-b.3-2"> General parameters (for all curve models):<a href="#section-b.3-2" class="pilcrow">¶</a></p>
<dl class="dlParallel dlCompact" id="section-b.3-3">
          <dt id="section-b.3-3.1">p</dt>
<dd id="section-b.3-3.2"> 2^{255}-19<a href="#section-b.3-3.2" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-3.3"></dt>
<dd id="section-b.3-3.4"> (=0x7fffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffed)<a href="#section-b.3-3.4" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-3.5">h</dt>
<dd id="section-b.3-3.6"> 8<a href="#section-b.3-3.6" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-3.7">n</dt>
<dd id="section-b.3-3.8"> 7237005577332262213973186563042994240857116359379907606001950938285454250989<a href="#section-b.3-3.8" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-3.9"></dt>
<dd id="section-b.3-3.10"> (=2^{252} +  0x14def9de a2f79cd6 5812631a 5cf5d3ed)<a href="#section-b.3-3.10" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-b.3-4"><a href="#section-b.3-4" class="pilcrow">¶</a></p>
<p id="section-b.3-5"> Montgomery curve-specific parameters (for Curve25519):<a href="#section-b.3-5" class="pilcrow">¶</a></p>
<dl class="dlParallel dlCompact" id="section-b.3-6">
          <dt id="section-b.3-6.1">A</dt>
<dd id="section-b.3-6.2"> 486662<a href="#section-b.3-6.2" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-6.3">B</dt>
<dd id="section-b.3-6.4"> 1<a href="#section-b.3-6.4" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-6.5">Gu</dt>
<dd id="section-b.3-6.6"> 9 (=0x9)<a href="#section-b.3-6.6" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-6.7">Gv</dt>
<dd id="section-b.3-6.8"> 14781619447589544791020593568409986887264606134616475288964881837755586237401<a href="#section-b.3-6.8" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-6.9"></dt>
<dd id="section-b.3-6.10"> (=0x20ae19a1 b8a086b4 e01edd2c 7748d14c 923d4d7e 6d7c61b2 29e9c5a2 7eced3d9)<a href="#section-b.3-6.10" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-b.3-7"><a href="#section-b.3-7" class="pilcrow">¶</a></p>
<p id="section-b.3-8"> Twisted Edwards curve-specific parameters (for Edwards25519):<a href="#section-b.3-8" class="pilcrow">¶</a></p>
<dl class="dlParallel dlCompact" id="section-b.3-9">
          <dt id="section-b.3-9.1">a</dt>
<dd id="section-b.3-9.2"> -1 (-0x01)<a href="#section-b.3-9.2" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.3">d</dt>
<dd id="section-b.3-9.4"> -121665/121666<a href="#section-b.3-9.4" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.5"></dt>
<dd id="section-b.3-9.6"> (=37095705934669439343138083508754565189542113879843219016388785533085940283555)<a href="#section-b.3-9.6" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.7"></dt>
<dd id="section-b.3-9.8"> (=0x52036cee 2b6ffe73 8cc74079 7779e898 00700a4d 4141d8ab 75eb4dca 135978a3)<a href="#section-b.3-9.8" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.9">Gx</dt>
<dd id="section-b.3-9.10"> 15112221349535400772501151409588531511454012693041857206046113283949847762202<a href="#section-b.3-9.10" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.11"></dt>
<dd id="section-b.3-9.12"> (=0x216936d3 cd6e53fe c0a4e231 fdd6dc5c 692cc760 9525a7b2 c9562d60 8f25d51a)<a href="#section-b.3-9.12" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.13">Gy</dt>
<dd id="section-b.3-9.14"> 4/5<a href="#section-b.3-9.14" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.15"></dt>
<dd id="section-b.3-9.16"> (=46316835694926478169428394003475163141307993866256225615783033603165251855960)<a href="#section-b.3-9.16" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-9.17"></dt>
<dd id="section-b.3-9.18">(=0x66666666 66666666 66666666 66666666 66666666 66666666 66666666 66666658)<a href="#section-b.3-9.18" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-b.3-10"><a href="#section-b.3-10" class="pilcrow">¶</a></p>
<p id="section-b.3-11"> Weierstrass curve-specific parameters (for Wei25519):<a href="#section-b.3-11" class="pilcrow">¶</a></p>
<dl class="dlParallel dlCompact" id="section-b.3-12">
          <dt id="section-b.3-12.1">a</dt>
<dd id="section-b.3-12.2"> 19298681539552699237261830834781317975544997444273427339909597334573241639236<a href="#section-b.3-12.2" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-12.3"></dt>
<dd id="section-b.3-12.4"> (=0x2aaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaa98 4914a144)<a href="#section-b.3-12.4" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-12.5">b</dt>
<dd id="section-b.3-12.6"> 55751746669818908907645289078257140818241103727901012315294400837956729358436<a href="#section-b.3-12.6" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-12.7"></dt>
<dd id="section-b.3-12.8"> (=0x7b425ed0 97b425ed 097b425e d097b425 ed097b42 5ed097b4 260b5e9c 7710c864)<a href="#section-b.3-12.8" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-12.9">GX</dt>
<dd id="section-b.3-12.10"> 19298681539552699237261830834781317975544997444273427339909597334652188435546<a href="#section-b.3-12.10" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-12.11"></dt>
<dd id="section-b.3-12.12"> (=0x2aaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaad245a)<a href="#section-b.3-12.12" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-12.13">GY</dt>
<dd id="section-b.3-12.14"> 14781619447589544791020593568409986887264606134616475288964881837755586237401<a href="#section-b.3-12.14" class="pilcrow">¶</a>
</dd>
<dt id="section-b.3-12.15"></dt>
<dd id="section-b.3-12.16"> (=0x20ae19a1 b8a086b4 e01edd2c 7748d14c 923d4d7e 6d7c61b2 29e9c5a2 7eced3d9)<a href="#section-b.3-12.16" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-b.3-13"><a href="#section-b.3-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pascal Thubert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc</span></div>
<div dir="auto" class="left"><span class="street-address">Building D<br>45 Allee des Ormes - BP1200</span></div>
<div dir="auto" class="left">
<span class="postal-code">06254</span> <span class="locality">MOUGINS - Sophia Antipolis</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+33%20497%2023%2026%2034" class="tel">+33 497 23 26 34</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:pthubert@cisco.com" class="email">pthubert@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Behcet Sarikaya</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sarikaya@ieee.org" class="email">sarikaya@ieee.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mohit Sethi</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">
<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div dir="auto" class="left"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mohit@piuha.net" class="email">mohit@piuha.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rene Struik</span></div>
<div dir="auto" class="left"><span class="org">Struik Security Consultancy</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rstruik.ext@gmail.com" class="email">rstruik.ext@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
