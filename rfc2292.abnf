proto = getprotobyname("icmp");

s = socket(AF_INET, SOCK_RAW, proto->p_proto);

fd = socket(PF_INET6, SOCK_RAW, IPPROTO_ICMPV6);

cmsgptr = CMSG_NXTHDR(&msg, cmsgptr)) {
ptr = CMSG_DATA(cmsgptr);
ptr = CMSG_DATA(cmsgptr);
x == -1:       use kernel default
typep = inet6_option_alloc(cmsgptr, IP6_X_OPT_LEN,
                           IP6_X_OPT_MULTX, IP6_X_OPT_OFFSETY);
optXp = (struct ip6_X_opt *) (typep - IP6_X_OPT_OFFSETY);
typep = inet6_option_alloc(cmsgptr, IP6_Y_OPT_LEN,
                           IP6_Y_OPT_MULTX, IP6_Y_OPT_OFFSETY);
optYp = (struct ip6_Y_opt *) (typep - IP6_Y_OPT_OFFSETY);
cmsgptr = CMSG_NXTHDR(&msg, cmsgptr)) {
optXp = (struct ip6_X_opt *) (tptr - IP6_X_OPT_OFFSETY);
optYp = (struct ip6_Y_opt *) (tptr - IP6_Y_OPT_OFFSETY);
ptr = malloc(inet6_rthdr_space(IPV6_RTHDR_TYPE_0, 3));
cmsgptr = inet6_rthdr_init(ptr, IPV6_RTHDR_TYPE_0);

