<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Metalink/HTTP: Mirrors and Cryptographic Hashes in HTTP Header Fields</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Examples Metalink Server Response">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Notational Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 Requirements">
<link href="#rfc.section.3" rel="Chapter" title="3 Mirrors / Multiple Download Locations">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Mirror Priority">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Mirror Geographical Location">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Coordinated Mirror Policies">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Mirror Depth">
<link href="#rfc.section.4" rel="Chapter" title="4 Peer-to-Peer / Metainfo">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Metalink/XML Files">
<link href="#rfc.section.5" rel="Chapter" title="5 Signatures">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 OpenPGP Signatures">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 S/MIME Signatures">
<link href="#rfc.section.6" rel="Chapter" title="6 Cryptographic Hashes of Whole Documents">
<link href="#rfc.section.7" rel="Chapter" title="7 Client / Server Multi-source Download Interaction">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Error Prevention, Detection, and Correction">
<link href="#rfc.section.7.1.1" rel="Chapter" title="7.1.1 Error Prevention (Early File Mismatch Detection)">
<link href="#rfc.section.7.1.2" rel="Chapter" title="7.1.2 Error Correction">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 URIs and IRIs">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Spoofing">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Cryptographic Hashes">
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Signing">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Acknowledgements and Contributors">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Comparisons to Similar Options">
<link href="#rfc.appendix.Appendix%20C" rel="Chapter" title="Appendix C Document History">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document specifies Metalink/HTTP: Mirrors and Cryptographic Hashes in HTTP header fields, a different way to get information that is usually contained in the Metalink XML-based download description format.  Metalink/HTTP describes multiple download locations (mirrors), Peer-to-Peer, cryptographic hashes, digital signatures, and other information using existing standards for HTTP header fields. Clients can use this information to make file transfers more robust and reliable." />
  <meta name="description" content="This document specifies Metalink/HTTP: Mirrors and Cryptographic Hashes in HTTP header fields, a different way to get information that is usually contained in the Metalink XML-based download description format.  Metalink/HTTP describes multiple download locations (mirrors), Peer-to-Peer, cryptographic hashes, digital signatures, and other information using existing standards for HTTP header fields. Clients can use this information to make file transfers more robust and reliable." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">A. Bryan</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">N. McNab</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">T. Tsujikawa</td>
</tr>
<tr>
<td class="left">Expires: August 31, 2011</td>
<td class="right">P. Poeml</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">MirrorBrain</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">H. Nordstrom</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">February 27, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Metalink/HTTP: Mirrors and Cryptographic Hashes in HTTP Header Fields<br />
  <span class="filename">draft-bryan-metalinkhttp-21</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document specifies Metalink/HTTP: Mirrors and Cryptographic Hashes in HTTP header fields, a different way to get information that is usually contained in the Metalink XML-based download description format.  Metalink/HTTP describes multiple download locations (mirrors), Peer-to-Peer, cryptographic hashes, digital signatures, and other information using existing standards for HTTP header fields. Clients can use this information to make file transfers more robust and reliable.</p>
<h1><a>Editorial Note (To be removed by RFC Editor)</a></h1>
<p>Discussion of this draft should take place on the HTTPBIS working group mailing list (ietf-http-wg@w3.org), although this draft is not a WG item.  </p>
<p>The changes in this draft are summarized in <a href="#dochistory">Appendix Appendix C</a>.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 31, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Examples Metalink Server Response</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Notational Conventions</a>
</li>
<li>2.   <a href="#rfc.section.2">Requirements</a>
</li>
<li>3.   <a href="#rfc.section.3">Mirrors / Multiple Download Locations</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Mirror Priority</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Mirror Geographical Location</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Coordinated Mirror Policies</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Mirror Depth</a>
</li>
<li>4.   <a href="#rfc.section.4">Peer-to-Peer / Metainfo</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Metalink/XML Files</a>
</li>
<li>5.   <a href="#rfc.section.5">Signatures</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">OpenPGP Signatures</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">S/MIME Signatures</a>
</li>
<li>6.   <a href="#rfc.section.6">Cryptographic Hashes of Whole Documents</a>
</li>
<li>7.   <a href="#rfc.section.7">Client / Server Multi-source Download Interaction</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Error Prevention, Detection, and Correction</a>
</li>
<li>7.1.1.   <a href="#rfc.section.7.1.1">Error Prevention (Early File Mismatch Detection)</a>
</li>
<li>7.1.2.   <a href="#rfc.section.7.1.2">Error Correction</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">URIs and IRIs</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Spoofing</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">Cryptographic Hashes</a>
</li>
<li>9.4.   <a href="#rfc.section.9.4">Signing</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Acknowledgements and Contributors</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Comparisons to Similar Options</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.Appendix%20C">Document History</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">Metalink/HTTP is an alternative and complementary representation of Metalink information, which is usually presented as an XML-based document format <a href="#RFC5854">[RFC5854]</a>.  Metalink/HTTP attempts to provide as much functionality as the Metalink/XML format by using existing standards such as Web Linking <a href="#RFC5988">[RFC5988]</a>, Instance Digests in HTTP <a href="#RFC3230">[RFC3230]</a>, and Entity Tags (also known as ETags) <a href="#RFC2616">[RFC2616]</a>. Metalink/HTTP is used to list information about a file to be downloaded. This can include lists of multiple URIs (mirrors), Peer-to-Peer information, cryptographic hashes, and digital signatures.</p>
<p id="rfc.section.1.p.2">Identical copies of a file are frequently accessible in multiple locations on the Internet over a variety of protocols (such as FTP, HTTP, and Peer-to-Peer).  In some cases, users are shown a list of these multiple download locations (mirrors) and must manually select a single one on the basis of geographical location, priority, or bandwidth.  This distributes the load across multiple servers, and should also increase throughput and resilience. At times, however, individual servers can be slow, outdated, or unreachable, but this can not be determined until the download has been initiated. Users will rarely have sufficient information to choose the most appropriate server, and will often choose the first in a list which might not be optimal for their needs, and will lead to a particular server getting a disproportionate share of load.  The use of suboptimal mirrors can lead to the user canceling and restarting the download to try to manually find a better source. During downloads, errors in transmission can corrupt the file.  There are no easy ways to repair these files. For large downloads this can be extremely troublesome.  Any of the number of problems that can occur during a download lead to frustration on the part of users.</p>
<p id="rfc.section.1.p.3">Some popular sites automate the process of selecting mirrors using DNS load balancing, both to approximately balance load between servers, and to direct clients to nearby servers with the hope that this improves throughput.  Indeed, DNS load balancing can balance long-term server load fairly effectively, but it is less effective at delivering the best throughput to users when the bottleneck is not the server but the network.</p>
<p id="rfc.section.1.p.4">This document describes a mechanism by which the benefit of mirrors can be automatically and more effectively realized. All the information about a download, including mirrors, cryptographic hashes, digital signatures, and more can be transferred in coordinated HTTP header fields hereafter referred to as a Metalink.  This Metalink transfers the knowledge of the download server (and mirror database) to the client. Clients can fallback to other mirrors if the current one has an issue. With this knowledge, the client is enabled to work its way to a successful download even under adverse circumstances.  All this can be done without complicated user interaction and the download can be much more reliable and efficient.  In contrast, a traditional HTTP redirect to a mirror conveys only extremely minimal information - one link to one server, and there is no provision in the HTTP protocol to handle failures.  Furthermore, in order to provide better load distribution across servers and potentially faster downloads to users, Metalink/HTTP facilitates multi-source downloads, where portions of a file are downloaded from multiple mirrors (and optionally, Peer-to-Peer) simultaneously.</p>
<p id="rfc.section.1.p.5">Upon connection to a Metalink/HTTP server, a client will receive information about other sources of the same resource and a cryptographic hash of the whole resource. The client will then be able to request chunks of the file from the various sources, scheduling appropriately in order to maximize the download rate.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Examples Metalink Server Response</h1>
<div id="#rfc.figure.1"></div>
<p></p>

<p>This example shows a brief Metalink server response with ETag, mirrors, .meta4, OpenPGP signature, and a cryptographic hash of the whole file:</p>
<pre>
Etag: "thvDyvhfIqlvFe+A9MYgxAfm1q5="
Link: &lt;http://www2.example.com/example.ext&gt;; rel=duplicate
Link: &lt;ftp://ftp.example.com/example.ext&gt;; rel=duplicate
Link: &lt;http://example.com/example.ext.torrent&gt;; rel=describedby;
type="application/x-bittorrent"
Link: &lt;http://example.com/example.ext.meta4&gt;; rel=describedby;
type="application/metalink4+xml"
Link: &lt;http://example.com/example.ext.asc&gt;; rel=describedby;
type="application/pgp-signature"
Digest: SHA-256=MWVkMWQxYTRiMzk5MDQ0MzI3NGU5NDEyZTk5OWY1ZGFmNzgyZTJlO
DYzYjRjYzFhOTlmNTQwYzI2M2QwM2U2MQ==
</pre>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Notational Conventions</h1>
<p id="rfc.section.1.2.p.1">This specification describes conformance of Metalink/HTTP.</p>
<p id="rfc.section.1.2.p.2">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14, <a href="#RFC2119">[RFC2119]</a>, as scoped to those conformance targets.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#req" id="req">Requirements</a>
</h1>
<p id="rfc.section.2.p.1">In this context, "Metalink" refers to Metalink/HTTP which consists of mirrors and cryptographic hashes in HTTP header fields as described in this document. "Metalink/XML" refers to the XML format described in <a href="#RFC5854">[RFC5854]</a>.</p>
<p id="rfc.section.2.p.2">Metalink resources include Link header fields <a href="#RFC5988">[RFC5988]</a> to present a list of mirrors in the response to a client request for the resource. Metalink servers MUST include the cryptographic hash of a resource via Instance Digests in HTTP <a href="#RFC3230">[RFC3230]</a>.  Algorithms used in the Instance Digest field are registered in the IANA registry named "Hypertext Transfer Protocol (HTTP) Digest Algorithm Values" at &lt;http://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml&gt;. This document restricts the use of these algorithms.  SHA-256 and SHA-512 were added to the registry by <a href="#RFC5843">[RFC5843]</a>. If a Metalink contains whole file hashes as described in <a href="#wholehashes">Section 6</a>, it SHOULD include SHA-256, as specified in <a href="#FIPS-180-3">[FIPS-180-3]</a>, or stronger. It MAY also include other hashes.</p>
<p id="rfc.section.2.p.3">Metalink servers are HTTP servers with one or more Metalink resources. Metalink servers MUST support the Link header fields for listing mirrors and MUST support Instance Digests in HTTP <a href="#RFC3230">[RFC3230]</a>. Metalink servers MUST return the same Link header fields and Instance Digests on HEAD requests.  Metalink servers and their associated mirror servers SHOULD all share the same ETag policy. It is up to the administrator of the Metalink server to communicate the details of the shared ETag policy to the administrators of the mirror servers so that the mirror servers can be configured with the same ETag policy. To have the same ETag policy means that ETags are synchronized across servers for resources that are mirrored, i.e. byte-for-byte identical files will have the same ETag on mirrors that they have on the Metalink server.   For example, it would be better to derive an ETag from a cryptographic hash of the file contents than on server-unique filesystem metadata. Metalink servers SHOULD offer Metalink/XML documents that contain cryptographic hashes of parts of the file (and other information) if error recovery is desirable.</p>
<p id="rfc.section.2.p.4">Mirror servers are typically FTP or HTTP servers that "mirror" another server. That is, they provide identical copies of (at least some) files that are also on the mirrored server.  Mirror servers SHOULD support serving partial content. HTTP mirror servers SHOULD share the same ETag policy as the originating Metalink server. HTTP Mirror servers SHOULD support Instance Digests in HTTP <a href="#RFC3230">[RFC3230]</a> using the same algorithm as the Metalink server.  Optimally, mirror servers will share the same ETag policy and support Instance Digests in HTTP.  Mirror servers that share the same ETag policy and/or support Instance Digests in HTTP using the same algorithm as a Metalink server are known as preferred mirror servers.</p>
<p id="rfc.section.2.p.5">Metalink clients use the mirrors provided by a Metalink server in Link header fields <a href="#RFC5988">[RFC5988]</a> but it is restricted to the initial Metalink server they contacted. If Metalink clients find Link header fields <a href="#RFC5988">[RFC5988]</a> for listing mirrors from mirrors, they MUST discard such Link header fields <a href="#RFC5988">[RFC5988]</a> to prevent a possible infinite loop. Metalink clients MUST support HTTP and SHOULD support FTP <a href="#RFC0959">[RFC0959]</a>. Metalink clients MAY support BitTorrent <a href="#BITTORRENT">[BITTORRENT]</a>, or other download methods. Metalink clients SHOULD switch downloads from one mirror to another if a mirror becomes unreachable. Metalink clients MAY support multi-source, or parallel, downloads, where portions of a file can be downloaded from multiple mirrors simultaneously (and optionally, from Peer-to-Peer sources). Metalink clients MUST support Instance Digests in HTTP <a href="#RFC3230">[RFC3230]</a> by requesting and verifying cryptographic hashes. Metalink clients SHOULD support error recovery by using the cryptographic hashes of parts of the file listed in Metalink/XML files. Metalink clients SHOULD support checking digital signatures.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#mirrors" id="mirrors">Mirrors / Multiple Download Locations</a>
</h1>
<p id="rfc.section.3.p.1">Mirrors are specified with the Link header fields <a href="#RFC5988">[RFC5988]</a> and a relation type of "duplicate" as defined in <a href="#IANA">Section 8</a>.</p>
<p id="rfc.section.3.p.2">The following OPTIONAL attributes are defined: </p>

<ul>
<li>"depth" : mirror depth in <a href="#depth">Section 3.4</a>.</li>
<li>"geo"   : mirror geographical location in <a href="#geo">Section 3.2</a>.</li>
<li>"pref"  : a preferred mirror server in <a href="#coordinatedpolicies">Section 3.3</a>.</li>
<li>"pri"   : mirror priority in <a href="#priority">Section 3.1</a>.</li>
</ul>
<div id="#rfc.figure.2"></div>
<p></p>

<p>This example shows a brief Metalink server response with two mirrors only:</p>
<pre>
Link: &lt;http://www2.example.com/example.ext&gt;; rel=duplicate; 
pri=1; pref
Link: &lt;ftp://ftp.example.com/example.ext&gt;; rel=duplicate; 
pri=2; geo=gb; depth=1
</pre>
<p id="rfc.section.3.p.4">As some organizations can have many mirrors, it is up to the organization to configure the amount of Link header fields the Metalink server will provide. Such a decision could be a random selection or a hard-coded limit based on network proximity, file size, server load, or other factors.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#priority" id="priority">Mirror Priority</a>
</h1>
<p id="rfc.section.3.1.p.1">Entries for mirror servers are listed in order of priority (from most preferred to least) or have a "pri" value, where mirrors with lower values are used first.</p>
<p id="rfc.section.3.1.p.2">This is purely an expression of the server's preferences; it is up to the client what it does with this information, particularly with reference to how many servers to use at any one time.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#geo" id="geo">Mirror Geographical Location</a>
</h1>
<p id="rfc.section.3.2.p.1">Entries for a mirror server MAY have a "geo" value, which is a <a href="#ISO3166-1">[ISO3166-1]</a> alpha-2 two letter country code for the geographical location of the physical server the URI is used to access. A client MAY use this information to select a mirror, or set of mirrors, that are geographically near (if the client has access to such information), with the aim of reducing network load at inter-country bottlenecks.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#coordinatedpolicies" id="coordinatedpolicies">Coordinated Mirror Policies</a>
</h1>
<p id="rfc.section.3.3.p.1">There are two types of mirror servers: preferred and normal. Preferred mirror servers are HTTP mirror servers that MUST share the same ETag policy as the originating Metalink server and/or MUST provide Instance Digests using the same algorithm as the Metalink server.  Preferred mirrors make it possible for Metalink clients to detect early on, before data is transferred, if the file requested matches the desired file. This early file mismatch detection is described in <a href="#earlyfilemismatchdetection">Section 7.1.1</a>.  Entries for preferred HTTP mirror servers have a "pref" value. By default, if unspecified then mirrors are considered "normal" and do not necessarily share the same ETag policy or support Instance Digests using the same algorithm as the Metalink server.  FTP mirrors are considered "normal", as they do not emit ETags or support Instance Digests.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#depth" id="depth">Mirror Depth</a>
</h1>
<p id="rfc.section.3.4.p.1">Some mirrors can mirror single files, whole directories, or multiple directories.</p>
<p id="rfc.section.3.4.p.2">Entries for mirror servers can have a "depth" value, where "depth=0" is the default. A value of 0 means only that file is mirrored and that other URI path segments are not. A value of 1 means that file and all other files and URI path segments contained in the rightmost URI path segment are mirrored. For values of N, N-1 URI path segments closer to the Host are mirrored. A value of 2 means one URI path segment closer to the Host is mirrored, and all files and URI path segments contained are mirrored.  For each higher value, another URI path segment closer to the Host is mirrored.</p>
<div id="#rfc.figure.3"></div>
<p></p>

<p>This example shows a mirror with a depth value of 4:</p>
<pre>
Link: &lt;http://www2.example.com/dir1/dir2/dir3/dir4/dir5/example.ext&gt;; 
rel=duplicate; pri=1; pref; depth=4
</pre>
<p id="rfc.section.3.4.p.4">In the above example, 4 URI path segments closer to the Host are mirrored, from /dir2/ and all files and directories included.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#p2p" id="p2p">Peer-to-Peer / Metainfo</a>
</h1>
<p id="rfc.section.4.p.1">Entries for metainfo files, which describe ways to download a file over Peer-to-Peer networks or otherwise, are specified with the Link header fields <a href="#RFC5988">[RFC5988]</a> and a relation type of "describedby" and a type parameter that indicates the MIME type of the metadata available at the URI. Since metainfo files can sometimes describe multiple files, or the filename MAY not be the same on the Metalink server and in the metainfo file but still have the same content, an OPTIONAL "name" attribute can be used.</p>
<p id="rfc.section.4.p.2">The following OPTIONAL attribute is defined: </p>

<ul><li>"name" : a file described within the metainfo file.</li></ul>
<div id="#rfc.figure.4"></div>
<p></p>

<p>This example shows a brief Metalink server response with .torrent and .meta4:</p>
<pre>
Link: &lt;http://example.com/example.ext.torrent&gt;; rel=describedby;
type="application/x-bittorrent"; name="differentname.ext"
Link: &lt;http://example.com/example.ext.meta4&gt;; rel=describedby;
type="application/metalink4+xml"
</pre>
<p id="rfc.section.4.p.4">Metalink clients MAY support the use of metainfo files for downloading files.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#metalinkxml" id="metalinkxml">Metalink/XML Files</a>
</h1>
<p id="rfc.section.4.1.p.1">Metalink/XML files for a given resource MAY be provided in a Link header field as shown in the example in <a href="#p2p">Section 4</a>.  Metalink/XML files are specified in <a href="#RFC5854">[RFC5854]</a> and they are particularly useful for providing metadata such as cryptographic hashes of parts of a file, allowing a client to recover from errors (see <a href="#errorcorrection">Section 7.1.2</a>). Metalink servers SHOULD provide Metalink/XML files with partial file hashes in Link header fields and Metalink clients SHOULD use them for error recovery.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#signatures" id="signatures">Signatures</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#openpgp" id="openpgp">OpenPGP Signatures</a>
</h1>
<p id="rfc.section.5.1.p.1">OpenPGP signatures <a href="#RFC3156">[RFC3156]</a> of requested files are specified with the Link header fields <a href="#RFC5988">[RFC5988]</a> and a relation type of "describedby" and a type parameter of "application/pgp-signature".</p>
<div id="#rfc.figure.5"></div>
<p></p>

<p>This example shows a brief Metalink server response with OpenPGP signature only:</p>
<pre>
Link: &lt;http://example.com/example.ext.asc&gt;; rel=describedby;
type="application/pgp-signature"
</pre>
<p id="rfc.section.5.1.p.3">Metalink clients SHOULD support the use of OpenPGP signatures.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> S/MIME Signatures</h1>
<p id="rfc.section.5.2.p.1">S/MIME signatures <a href="#RFC5751">[RFC5751]</a> of requested files are specified with the Link header fields <a href="#RFC5988">[RFC5988]</a> and a relation type of "describedby" and a type parameter of "application/pkcs7-mime".</p>
<div id="#rfc.figure.6"></div>
<p></p>

<p>This example shows a brief Metalink server response with S/MIME signature only:</p>
<pre>
Link: &lt;http://example.com/example.ext.p7m&gt;; rel=describedby;
type="application/pkcs7-mime"
</pre>
<p id="rfc.section.5.2.p.3">Metalink clients SHOULD support the use of S/MIME signatures.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#wholehashes" id="wholehashes">Cryptographic Hashes of Whole Documents</a>
</h1>
<p id="rfc.section.6.p.1">If Instance Digests are not provided by the Metalink servers, the Link header fields pertaining to this specification MUST be ignored.</p>
<div id="#rfc.figure.7"></div>
<p></p>

<p>This example shows a brief Metalink server response with ETag, mirror, and cryptographic hash:</p>
<pre>
Etag: "thvDyvhfIqlvFe+A9MYgxAfm1q5="
Link: &lt;http://www2.example.com/example.ext&gt;; rel=duplicate
Digest: SHA-256=MWVkMWQxYTRiMzk5MDQ0MzI3NGU5NDEyZTk5OWY1ZGFmNzgyZTJlO
DYzYjRjYzFhOTlmNTQwYzI2M2QwM2U2MQ==
</pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#clientserver" id="clientserver">Client / Server Multi-source Download Interaction</a>
</h1>
<p id="rfc.section.7.p.1">Metalink clients begin a download with a standard HTTP <a href="#RFC2616">[RFC2616]</a> GET request to the Metalink server. Metalink clients MAY use a Range limit if desired.</p>
<div id="#rfc.figure.8"></div>
<pre>
GET /distribution/example.ext HTTP/1.1
Host: www.example.com
</pre>
<p></p>
<div id="#rfc.figure.9"></div>
<pre>
HTTP/1.1 200 OK
Accept-Ranges: bytes
Content-Length: 14867603
Content-Type: application/x-cd-image
Etag: "thvDyvhfIqlvFe+A9MYgxAfm1q5="
Link: &lt;http://www2.example.com/example.ext&gt;; rel=duplicate; pref
Link: &lt;ftp://ftp.example.com/example.ext&gt;; rel=duplicate
Link: &lt;http://example.com/example.ext.torrent&gt;; rel=describedby;
type="application/x-bittorrent"
Link: &lt;http://example.com/example.ext.meta4&gt;; rel=describedby;
type="application/metalink4+xml"
Link: &lt;http://example.com/example.ext.asc&gt;; rel=describedby;
type="application/pgp-signature"
Digest: SHA-256=MWVkMWQxYTRiMzk5MDQ0MzI3NGU5NDEyZTk5OWY1ZGFmNzgyZTJlO
DYzYjRjYzFhOTlmNTQwYzI2M2QwM2U2MQ==
</pre>
<p id="rfc.section.7.p.3">The Metalink server responds with the data and these header fields: </p>
<p id="rfc.section.7.p.4">Alternatively, Metalink clients can begin with a HEAD request to the Metalink server to discover mirrors via Link header fields, and then skip to making the following decisions on every available mirror server found via the Link header fields.</p>
<p id="rfc.section.7.p.5">After that, the client follows with a GET request to the desired mirrors.</p>
<p id="rfc.section.7.p.6">From the Metalink server response the client learns some or all of the following metadata about the requested object, in addition to also starting to receive the object:</p>
<p></p>

<ul>
<li>Mirror profile link, which can describe the mirror's priority, whether it shares the ETag policy of the originating Metalink server, geographical location, and mirror depth.</li>
<li>Instance Digest, which is the whole file cryptographic hash.</li>
<li>ETag.</li>
<li>Object size from the Content-Length header field.</li>
<li>Metalink/XML, which can include partial file cryptographic hashes to repair a file.</li>
<li>Peer-to-peer information.</li>
<li>Digital signature.</li>
</ul>
<div id="#rfc.figure.10"></div>
<pre>
GET /example.ext HTTP/1.1
Host: www2.example.com
Range: bytes=7433802-
If-Match: "thvDyvhfIqlvFe+A9MYgxAfm1q5="
Referer: http://www.example.com/distribution/example.ext
</pre>
<p id="rfc.section.7.p.8">Next, the Metalink client requests a Range of the object from a preferred mirror server, so it can use If-Match conditions: </p>
<p id="rfc.section.7.p.9">Metalink clients SHOULD use preferred mirrors, if possible, as they allow early file mismatch detection as described in <a href="#earlyfilemismatchdetection">Section 7.1.1</a>.  Preferred mirrors have coordinated ETags, as described in <a href="#coordinatedpolicies">Section 3.3</a>, and Metalink clients SHOULD use If-Match conditions based on the ETag to quickly detect out-of-date mirrors by using the ETag from the Metalink server response. Metalink clients SHOULD use partial file cryptographic hashes as described in <a href="#errorcorrection">Section 7.1.2</a>, if available, to detect if the mirror server returned the correct data.</p>
<p id="rfc.section.7.p.10">Optimally, the mirror server also will include an Instance Digest in the mirror response to the client GET request, which the client can also use to detect a mismatch early.  Metalink clients MUST reject individual downloads from mirrors that support Instance Digests if the Instance Digest from the mirror does not match the Instance Digest as reported by the Metalink server and the same algorithm is used.  If normal mirrors are used, then a mismatch can not be detected until the completed object is verified. Errors in transmission and substitutions of incorrect data on mirrors, whether deliberate or accidental, can be detected with error correction as described in <a href="#errorcorrection">Section 7.1.2</a>.</p>
<div id="#rfc.figure.11"></div>
<pre>
HTTP/1.1 206 Partial Content
Accept-Ranges: bytes
Content-Length: 7433801
Content-Range: bytes 7433802-14867602/14867603
Etag: "thvDyvhfIqlvFe+A9MYgxAfm1q5="
Digest: SHA-256=MWVkMWQxYTRiMzk5MDQ0MzI3NGU5NDEyZTk5OWY1ZGFmNzgyZTJlO
DYzYjRjYzFhOTlmNTQwYzI2M2QwM2U2MQ==
</pre>
<p id="rfc.section.7.p.11">Here, the preferred mirror server has the correct file (the If-Match conditions match) and responds with a 206 Partial Content HTTP status code and appropriate "Content-Length", "Content Range", ETag, and Instance Digest header fields. In this example, the mirror server responds, with data, to the above request: </p>
<p id="rfc.section.7.p.12">If the object is large and gets delivered slower than expected, then the Metalink client MAY start a number of parallel ranged downloads (one per selected mirror server other than the first) using mirrors provided by the Link header fields with "duplicate" relation type. Metalink clients MUST limit the number of parallel connections to mirror servers, ideally based on observing how the aggregate throughput changes as connections are opened. It would be pointless to blindly open connections once the path bottleneck is filled.  Metalink clients SHOULD use the location of the original GET request in the "Referer" header field for these ranged requests.</p>
<p id="rfc.section.7.p.13">The Metalink client can determine the size and number of ranges requested from each server, based upon the type and number of mirrors and performance observed from each mirror.  Note that Range requests impose an overhead on servers and clients need to be aware of that and not abuse them. Metalink clients SHOULD NOT make more than one concurrent Range request to each mirror server that it downloads from.</p>
<p id="rfc.section.7.p.14">Metalink clients SHOULD close all but the fastest connection if any Ranged requests generated after the first request end up with a complete response, instead of a partial response (as some mirrors might not support HTTP ranges), if the goal is the fastest transfer. Metalink clients MAY monitor mirror conditions and dynamically switch between mirrors to achieve the fastest download possible. Similarly, Metalink clients SHOULD abort extremely slow or stalled range requests and finish the request on other mirrors. If all ranges have finished except for the final one, the Metalink client can split the final range into multiple range requests to other mirrors so the transfer finishes faster.</p>
<p id="rfc.section.7.p.15">If the first request was GET and no Range header field was sent and the client determines later that it will issue a Range request, then the client SHOULD close the first connection when it catches up with the other parallel ranged downloads of the same object. This means the first connection was sacrificed. Metalink clients can use a HEAD request first, if possible, so that the client can find out if there are any Link header fields, and then Range-based requests are undertaken to the mirror servers without sacrificing a first connection.</p>
<p id="rfc.section.7.p.16">Metalink clients MUST reject individual downloads from mirrors where the file size does not match the file size as reported by the Metalink server.</p>
<p id="rfc.section.7.p.17">If a Metalink client does not support certain download methods (such as FTP or BitTorrent) that a file is available from, and there are no available download methods that the client supports, then the download will have no way to complete.</p>
<p id="rfc.section.7.p.18">Metalink clients MUST verify the cryptographic hash of the file once the download has completed. If the cryptographic hash offered by the Metalink server with Instance Digests does not match the cryptographic hash of the downloaded file, see <a href="#errorcorrection">Section 7.1.2</a> for a possible way to repair errors.</p>
<p id="rfc.section.7.p.19">If the download can not be repaired, it is considered corrupt. The client can attempt to re-download the file.</p>
<p id="rfc.section.7.p.20">Metalink clients that support verifying digital signatures MUST verify digital signatures of requested files if they are included.  Digital signatures MUST validate back to a trust anchor as described in the validation rules in <a href="#RFC3156">[RFC3156]</a> and <a href="#RFC5280">[RFC5280]</a>.</p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> Error Prevention, Detection, and Correction</h1>
<p id="rfc.section.7.1.p.1">Error prevention, or early file mismatch detection, is possible before file transfers with the use of file sizes, ETags, and Instance Digests provided by Metalink servers. Error detection requires Instance Digests to detect errors in transfer after the transfers have completed. Error correction, or download repair, is possible with partial file cryptographic hashes.</p>
<p id="rfc.section.7.1.p.2">Note that cryptographic hashes obtained from Instance Digests are in base64 encoding, while those from Metalink/XML are in hexadecimal.</p>
<h1 id="rfc.section.7.1.1">
<a href="#rfc.section.7.1.1">7.1.1.</a> <a href="#earlyfilemismatchdetection" id="earlyfilemismatchdetection">Error Prevention (Early File Mismatch Detection)</a>
</h1>
<p id="rfc.section.7.1.1.p.1">In HTTP terms, the merging of ranges from multiple responses SHOULD be verified with a strong validator, which in this context is either an Instance Digest or a shared ETag from that Metalink server that matches with the same provided by a preferred mirror server.  In most cases, it is sufficient that the Metalink server provides mirrors and Instance Digest information, but operation will be more robust and efficient if the mirror servers do implement a shared ETag policy or Instance Digests as well. There is no need to specify how the ETag is generated, just that it needs to be shared between the Metalink server and the mirror servers.  The benefit of having mirror servers return an Instance Digest is that the client then can detect mismatches early even if ETags are not used. Mirrors that support both a shared ETag and Instance Digests do provide value, but just one is sufficient for early detection of mismatches. If the mirror server provides neither shared ETag nor Instance Digest, then early detection of mismatches is not possible unless file length also differs. Finally, errors are still detectable after the download has completed, when the cryptographic hash of the merged response is verified.</p>
<p id="rfc.section.7.1.1.p.2">ETags can not be used for verifying the integrity of the received content. If the ETag given by the mirror server matches the ETag given by the Metalink server, then the Metalink client assumes the responses are valid for that object.</p>
<p id="rfc.section.7.1.1.p.3">This guarantees that a mismatch will be detected by using only the shared ETag from a Metalink server and mirror server.  Mirror servers will respond with an error if ETags do not match, which will prevent accidental merges of ranges from different versions of files with the same name.</p>
<p id="rfc.section.7.1.1.p.4">A shared ETag or Instance Digest can not strictly protect against malicious attacks or server or network errors replacing content.  An attacker can make a mirror server seemingly respond with the expected Instance Digest or ETags even if the file contents have been modified. The same goes for various system failures which would also cause bad data (i.e. corrupted files) to be returned. The Metalink client has to rely on the Instance Digest returned by the Metalink server in the first response for the verification of the downloaded object as a whole. To verify the individual ranges, which might have been requested from different sources, see <a href="#errorcorrection">Section 7.1.2</a>.</p>
<h1 id="rfc.section.7.1.2">
<a href="#rfc.section.7.1.2">7.1.2.</a> <a href="#errorcorrection" id="errorcorrection">Error Correction</a>
</h1>
<p id="rfc.section.7.1.2.p.1">Partial file cryptographic hashes can be used to detect errors during the download. Metalink servers SHOULD provide Metalink/XML files with partial file hashes in Link header fields as specified in <a href="#metalinkxml">Section 4.1</a>, and Metalink clients SHOULD use them for error correction.</p>
<p id="rfc.section.7.1.2.p.2">An error in transfer or a substitution attack will be detected by a cryptographic hash of the object not matching the Instance Digest from the Metalink server.  If the cryptographic hash of the object does not match the Instance Digest from the Metalink server, then the client SHOULD fetch the Metalink/XML (if available).  This may contain partial file cryptographic hashes which will allow detection of which mirror server returned incorrect data.  Metalink clients SHOULD use the Metalink/XML data to figure out what ranges of the downloaded data can be recovered and what needs to be fetched again.  </p>
<p id="rfc.section.7.1.2.p.3">Other methods can be used for error correction. For example, some other metainfo files also include partial file hashes that can be used to check for errors.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">Accordingly, IANA will make the following registration to the Link Relation Type registry at &lt;http://www.iana.org/assignments/link-relations/link-relations.xhtml&gt;.</p>
<p id="rfc.section.8.p.2">o  Relation Name: duplicate</p>
<p id="rfc.section.8.p.3">o  Description: Refers to a resource whose available representations are byte-for-byte identical with the corresponding representations of the context IRI.</p>
<p id="rfc.section.8.p.4">o  Reference: This specification.</p>
<p id="rfc.section.8.p.5">o  Notes: This relation is for static resources. That is, an HTTP GET request on any duplicate will return the same representation. It does not make sense for dynamic or POSTable resources and should not be used for them.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> URIs and IRIs</h1>
<p id="rfc.section.9.1.p.1">Metalink clients handle URIs and IRIs. See Section 7 of <a href="#RFC3986">[RFC3986]</a> and Section 8 of <a href="#RFC3987">[RFC3987]</a> for security considerations related to their handling and use.</p>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> Spoofing</h1>
<p id="rfc.section.9.2.p.1">There is potential for spoofing attacks where the attacker publishes Metalinks with false information.  In that case, this could deceive unaware downloaders into downloading a malicious or worthless file. As with all downloads, users should only download from trusted sources. Also, malicious publishers could attempt a distributed denial of service attack by inserting unrelated URIs into Metalinks.  <a href="#RFC4732">[RFC4732]</a> contains information on amplification attacks and denial of service attacks.</p>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> Cryptographic Hashes</h1>
<p id="rfc.section.9.3.p.1">Currently, some of the digest values defined in Instance Digests in HTTP <a href="#RFC3230">[RFC3230]</a> are considered insecure.  These include the whole Message Digest family of algorithms which are not suitable for cryptographically strong verification. Malicious people could provide files that appear to be identical to another file because of a collision, i.e. the weak cryptographic hashes of the intended file and a substituted malicious file could match.</p>
<h1 id="rfc.section.9.4">
<a href="#rfc.section.9.4">9.4.</a> Signing</h1>
<p id="rfc.section.9.4.p.1">Metalinks SHOULD include digital signatures, as described in <a href="#signatures">Section 5</a>.</p>
<p id="rfc.section.9.4.p.2">Digital signatures provide authentication, message integrity, and enable non-repudiation with proof of origin.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="BITTORRENT">[BITTORRENT]</b></td>
<td class="top">
<a>Cohen, B</a>, "<a>The BitTorrent Protocol Specification</a>", BITTORRENT 11031, February 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC0959">[RFC0959]</b></td>
<td class="top">
<a>Postel, J.</a> and <a>J. Reynolds</a>, "<a href="http://tools.ietf.org/html/rfc0959">File Transfer Protocol</a>", STD 9, RFC 0959, October 1985.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a>Fielding, R.</a>, <a>Gettys, J.</a>, <a>Mogul, J.</a>, <a>Frystyk, H.</a>, <a>Masinter, L.</a>, <a>Leach, P.</a> and <a>T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3156">[RFC3156]</b></td>
<td class="top">
<a>Elkins, M.</a>, <a>Del Torto, D.</a>, <a>Levien, R.</a> and <a>T. Roessler</a>, "<a href="http://tools.ietf.org/html/rfc3156">MIME Security with OpenPGP</a>", RFC 3156, August 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3230">[RFC3230]</b></td>
<td class="top">
<a>Mogul, J.</a> and <a>A. Van Hoff</a>, "<a href="http://tools.ietf.org/html/rfc3230">Instance Digests in HTTP</a>", RFC 3230, January 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3987">[RFC3987]</b></td>
<td class="top">
<a>Duerst, M.</a> and <a>M. Suignard</a>, "<a href="http://tools.ietf.org/html/rfc3987">Internationalized Resource Identifiers (IRIs)</a>", RFC 3987, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5988">[RFC5988]</b></td>
<td class="top">
<a href="mailto:mnot@mnot.net">Nottingham, M.</a>, "<a href="http://tools.ietf.org/html/rfc5988">Web Linking</a>", RFC 5988, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="FIPS-180-3">[FIPS-180-3]</b></td>
<td class="top">
<a>National Institute of Standards and Technology (NIST)</a>, "<a>Secure Hash Standard (SHS)</a>", FIPS PUB 180-3, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5751">[RFC5751]</b></td>
<td class="top">
<a>Ramsdell, B.</a> and <a>S. Turner</a>, "<a href="http://tools.ietf.org/html/rfc5751">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification</a>", RFC 5751, January 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5854">[RFC5854]</b></td>
<td class="top">
<a href="mailto:anthonybryan@gmail.com" title="Metalinker Project">Bryan, A.</a>, <a href="mailto:tatsuhiro.t@gmail.com" title="Metalinker Project">Tsujikawa, T.</a>, <a href="mailto:neil@nabber.org" title="Metalinker Project">McNab, N.</a> and <a href="mailto:peter@poeml.de" title="MirrorBrain">P. Poeml</a>, "<a href="http://tools.ietf.org/html/rfc5854">The Metalink Download Description Format</a>", RFC 5854, June 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC4732">[RFC4732]</b></td>
<td class="top">
<a>Handley, M.</a>, <a>Rescorla, E.</a>, <a>IAB</a>, "<a href="http://tools.ietf.org/html/rfc4732">Internet Denial-of-Service Considerations</a>", RFC 4732, December 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5843">[RFC5843]</b></td>
<td class="top">
<a>Bryan, A.</a>, "<a href="http://tools.ietf.org/html/rfc5843">Additional Hash Algorithms for HTTP Instance Digests</a>", RFC 5843, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="ISO3166-1">[ISO3166-1]</b></td>
<td class="top">
<a>International Organization for Standardization</a>, "<a>ISO 3166-1:2006.  Codes for the representation of names of countries and their subdivisions -- Part 1: Country codes</a>", November 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Acknowledgements and Contributors</h1>
<p id="rfc.section.Appendix A.p.1">Thanks to the Metalink community, Alexey Melnikov, Julian Reschke, Mark Nottingham, Daniel Stenberg, Matt Domsch, Micah Cowan, David Morris, Yves Lafon, Juergen Schoenwaelder, Ben Campbell, Lars Eggert, Sean Turner, Robert Sparks, and the HTTPBIS Working Group.</p>
<p id="rfc.section.Appendix A.p.2">Thanks to Alan Ford and Mark Handley for spurring us on to publish this document.</p>
<p id="rfc.section.Appendix A.p.3">This document is dedicated to Zimmy Bryan and Juanita Anthony.</p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> Comparisons to Similar Options</h1>
<p id="rfc.section.Appendix B.p.1">[[ to be removed by the RFC editor before publication as an RFC. ]]</p>
<p id="rfc.section.Appendix B.p.2">This draft, compared to the Metalink/XML format <a href="#RFC5854">[RFC5854]</a> :</p>
<p></p>

<ul>
<li>(+) Reuses existing HTTP standards without much new besides a Link Relation Type. It's more of a collection/coordinated feature set.</li>
<li>(?) The existing standards don't seem to be widely implemented.</li>
<li>(+) No XML dependency, except for Metalink/XML for partial file cryptographic hashes.</li>
<li>(+) Existing Metalink/XML clients can be easily converted to support this as well.</li>
<li>(+) Coordination of mirror servers is preferred, but not required. Coordination could be difficult or impossible unless one group is in control of all servers on the mirror network.</li>
<li>(-) Requires software or configuration changes to originating server.</li>
<li>(-?) Tied to HTTP, not as generic. FTP/P2P clients won't be using it unless they also support HTTP, unlike Metalink/XML.</li>
<li>(-) Requires server-side support. Metalink/XML can be created by user (or server, but server component/changes not required).</li>
<li>(-) Also, Metalink/XML files are easily mirrored on all servers. Even if usage in that case is not as transparent, this method still gives access to all download information (with no changes needed to servers) from all mirrors (FTP included).</li>
<li>(-) Not portable/archivable/emailable. Metalink/XML is used to import/export transfer queues. Not as easy for search engines to index?</li>
<li>(-) Not as rich metadata.</li>
<li>(-) Not able to add multiple files to a download queue or create directory structure.</li>
</ul>
<h1 id="rfc.appendix.Appendix C">
<a href="#rfc.appendix.Appendix%20C">Appendix C.</a> <a href="#dochistory" id="dochistory">Document History</a>
</h1>
<p id="rfc.section.Appendix C.p.1">[[ to be removed by the RFC editor before publication as an RFC. ]]</p>
<p id="rfc.section.Appendix C.p.2">Known issues concerning this draft: </p>

<ul><li>None.</li></ul>
<p id="rfc.section.Appendix C.p.3">-21 : February 27, 2011.  </p>

<ul><li>IESG review.</li></ul>
<p id="rfc.section.Appendix C.p.4">-20 : February 14, 2011.  </p>

<ul><li>Yves Lafon's apps-team review, Juergen Schoenwaelder's secdir review, Ben Campbell's Gen-ART review.</li></ul>
<p id="rfc.section.Appendix C.p.5">-19 : January 20, 2011.  </p>

<ul><li>Julian Reschke's review.</li></ul>
<p id="rfc.section.Appendix C.p.6">-18 : January 1, 2010.  </p>

<ul><li>AD review by Alexey Melnikov.</li></ul>
<p id="rfc.section.Appendix C.p.7">-17 : September 13, 2010.  </p>

<ul><li>RFC 5854 Metalink/XML.</li></ul>
<p id="rfc.section.Appendix C.p.8">-16 : April 16, 2010.  </p>

<ul><li>Add draft-ietf-ftpext2-hash reference and FTP mirror coordination.</li></ul>
<p id="rfc.section.Appendix C.p.9">-15 : February 20, 2010.  </p>

<ul><li>Update references and terminology.</li></ul>
<p id="rfc.section.Appendix C.p.10">-14 : December 31, 2009.  </p>

<ul><li>Baseline file hash: SHA-256.</li></ul>
<p id="rfc.section.Appendix C.p.11">-13 : November 22, 2009.  </p>

<ul><li>Metalink/XML for partial file cryptographic hashes.</li></ul>
<p id="rfc.section.Appendix C.p.12">-12 : November 11, 2009.  </p>

<ul><li>Clarifications.</li></ul>
<p id="rfc.section.Appendix C.p.13">-11 : October 23, 2009.  </p>

<ul><li>Mirror changes.</li></ul>
<p id="rfc.section.Appendix C.p.14">-10 : October 15, 2009.  </p>

<ul><li>Mirror coordination changes.</li></ul>
<p id="rfc.section.Appendix C.p.15">-09 : October 13, 2009.  </p>

<ul>
<li>Mirror location, coordination, and depth.</li>
<li>Split HTTP Digest Algorithm Values Registration into draft-bryan-http-digest-algorithm-values-update.</li>
</ul>
<p id="rfc.section.Appendix C.p.16">-08 : October 4, 2009.  </p>

<ul><li>Clarifications.</li></ul>
<p id="rfc.section.Appendix C.p.17">-07 : September 29, 2009.  </p>

<ul><li>Preferred mirror servers.</li></ul>
<p id="rfc.section.Appendix C.p.18">-06 : September 24, 2009.  </p>

<ul>
<li>Add Mismatch Detection, Error Recovery, and Digest Algorithm values.</li>
<li>Remove Content-MD5 and Want-Digest.</li>
</ul>
<p id="rfc.section.Appendix C.p.19">-05 : September 19, 2009.  </p>

<ul><li>ETags, preferably matching the Instance Digests.</li></ul>
<p id="rfc.section.Appendix C.p.20">-04 : September 17, 2009.  </p>

<ul><li>Temporarily remove .torrent.</li></ul>
<p id="rfc.section.Appendix C.p.21">-03 : September 16, 2009.  </p>

<ul><li>Mention HEAD request, negotiate mirrors if Want-Digest is used.</li></ul>
<p id="rfc.section.Appendix C.p.22">-02 : September 7, 2009.  </p>

<ul><li>Content-MD5 for partial file cryptographic hashes.</li></ul>
<p id="rfc.section.Appendix C.p.23">-01 : September 1, 2009.  </p>

<ul><li>Link Relation Type Registration: "duplicate"</li></ul>
<p id="rfc.section.Appendix C.p.24">-00 : August 24, 2009.  </p>

<ul><li>Initial draft.</li></ul>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Anthony Bryan</span> 
	  <span class="n hidden">
		<span class="family-name">Bryan</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Pompano Beach</span>,  
		<span class="region">FL</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:anthonybryan@gmail.com">anthonybryan@gmail.com</a></span>

<span class="vcardline">URI: <a href="http://www.metalinker.org">http://www.metalinker.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Neil McNab</span> 
	  <span class="n hidden">
		<span class="family-name">McNab</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:neil@nabber.org">neil@nabber.org</a></span>

<span class="vcardline">URI: <a href="http://www.nabber.org">http://www.nabber.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tatsuhiro Tsujikawa</span> 
	  <span class="n hidden">
		<span class="family-name">Tsujikawa</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region">Shiga</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tatsuhiro.t@gmail.com">tatsuhiro.t@gmail.com</a></span>

<span class="vcardline">URI: <a href="http://aria2.sourceforge.net">http://aria2.sourceforge.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dr. med. Peter Poeml</span> 
	  <span class="n hidden">
		<span class="family-name">Poeml</span>
	  </span>
	</span>
	<span class="org vcardline">MirrorBrain</span>
	<span class="adr">
	  <span>Venloer Str. 317</span>

	  <span class="vcardline">
		<span class="locality">Koeln</span>,  
		<span class="region"></span>
		<span class="code">50823</span>
	  </span>
	  <span class="country-name vcardline">DE</span>
	</span>
	<span class="vcardline">Phone: +49 221 6778 333 8</span>

<span class="vcardline">EMail: <a href="mailto:peter@poeml.de">peter@poeml.de</a></span>

<span class="vcardline">URI: <a href="http://mirrorbrain.org/~poeml/">http://mirrorbrain.org/~poeml/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Henrik Nordstrom</span> 
	  <span class="n hidden">
		<span class="family-name">Nordstrom</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:henrik@henriknordstrom.net">henrik@henriknordstrom.net</a></span>

<span class="vcardline">URI: <a href="http://www.henriknordstrom.net/">http://www.henriknordstrom.net/</a></span>

  </address>
</div>

</body>
</html>