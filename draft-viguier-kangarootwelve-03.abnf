x-=y  denotes x takes the value x - y.

offset = 0
state = `00`^200

state = KP(state)
LastBlockLength = |input| - offset
state = KP(state)

output = `00`^0
output = output || state[0:168]
state = KP(state)

output = output || state[0:outputByteLen]

S = M || C || length_encode( |C| )

S = S_0 || .. || S_n-1
               |S_0| = .. = |S_n-2| = 8192 bytes
               |S_n-1| <= 8192 bytes

CV_i    = F( S_i||`0B`, 32 )
FinalNode = S_0 || `03 00 00 00 00 00 00 00`
FinalNode = FinalNode || CV_1
                   ..
FinalNode = FinalNode || CV_n-1
FinalNode = FinalNode || length_encode(n-1)
FinalNode = FinalNode || `FF FF`

x = sum from i=0..n-1 of 256**i * x_i

S = `00`^0

S = x mod 256 || S
x = x / 256

S = S || length(S)

current = lanes[x][y]
state = `00`^0
state = state || lanes[x][y]

S = inputMessage || customString
S = S || length_encode( |customString| )

FinalNode = S[0:8192] || `03` || `00`^7
offset = 8192
numBlock = 0
blockSize = min( |S| - offset, 8192)
CV = F(S[offset : offset + blockSize] || `0B`, 32)
FinalNode = FinalNode || CV
FinalNode = FinalNode || length_encode( numBlock ) || `FF FF`

