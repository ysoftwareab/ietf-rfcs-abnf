sigs = hash(call-id | to-tag | from-tag)

srtps = hash(SRTP master key | SRTP master salt)

pvi = g^svi mod p

hvi=hash(pvi | hashr1-5 | cipherr1-5 | pktr1-5 | sasr1-5)

pvr = g^svr mod p

rs1IDr = HMAC(rs1, "Responder")

rs2IDr = HMAC(rs2, "Responder")

sigsIDr = HMAC(sigs, "Responder")

srtpsIDr = HMAC(srtps, "Responder")

other_secretIDr = HMAC(other_secret, "Responder")

DHResult = pvi^svr mod p

DHSS = hash(DHResult)

rs1IDi = HMAC(rs1, "Initiator")

rs2IDi = HMAC(rs2, "Initiator")
sigsIDi = HMAC(sigs, "Initiator")

srtpsIDi = HMAC(srtps, "Initiator")

other_secretIDi = HMAC(other_secret, "Initiator")

s0 = hash(DHSS | s1 | s2 | s3 | s4 | s5)

rs1IDi = HMAC(rs1, "Initiator")

rs2IDi = HMAC(rs2, "Initiator")

sigsIDi = HMAC(sigs, "Initiator")
srtpsIDi = HMAC(srtps, "Initiator")

other_secretIDi = HMAC(other_secret, "Initiator")

DHResult = pvr^svi mod p

DHSS = hash(DHResult)

rs1IDr = HMAC(rs1, "Responder")

rs2IDr = HMAC(rs2, "Responder")

sigsIDr = HMAC(sigs, "Responder")

srtpsIDr = HMAC(srtps, "Responder")

other_secretIDr = HMAC(other_secret, "Responder")

s0 = hash(DHSS | s1 | s2 | s3 | s4 | s5)
srtpkeyi = HMAC(s0,"Initiator SRTP master key")

srtpsalti = HMAC(s0,"Initiator SRTP master salt")

srtpkeyr = HMAC(s0,"Responder SRTP master key")

srtpsaltr = HMAC(s0,"Responder SRTP master salt")

hmackey = HMAC(s0,"HMAC key")

rs1 = HMAC (s0, "retained secret")

hmac = HMAC(hmackey, "known plaintext" | sasflagoctet )

clear_hmac = HMAC(hmackey, "GoClear")

sasvalue = hash(pvi | pvr | "Short Authentication String")

