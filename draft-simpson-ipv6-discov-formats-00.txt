
Network Working Group                                        W A Simpson
Internet Draft                                                Daydreamer
expires in six months                                     September 1994


            IPv6 Neighbor Discovery -- ICMP Message Formats
              draft-simpson-ipv6-discov-formats-00.txt



Status of this Memo

   This document is a submission to the IPng Working Group of the
   Internet Engineering Task Force (IETF).  Comments should be submitted
   to the ipng@sunroof.eng.sun.com mailing list.

   Distribution of this memo is unlimited.

   This document is an Internet-Draft.  Internet Drafts are working
   documents of the Internet Engineering Task Force (IETF), its Areas,
   and its Working Groups.  Note that other groups may also distribute
   working documents as Internet Drafts.

   Internet Drafts are draft documents valid for a maximum of six
   months, and may be updated, replaced, or obsoleted by other documents
   at any time.  It is not appropriate to use Internet Drafts as
   reference material, or to cite them other than as a ``working draft''
   or ``work in progress.''

   To learn the current status of any Internet-Draft, please check the
   ``1id-abstracts.txt'' listing contained in the internet-drafts Shadow
   Directories on ds.internic.net (US East Coast), nic.nordu.net
   (Europe), ftp.isi.edu (US West Coast), or munnari.oz.au (Pacific
   Rim).


Abstract

   This document specifies ICMP messages for the identification and
   location of adjacent IPv6 nodes.











Simpson                  expires in six months                  [Page i]
DRAFT                    IPv6 Discovery Formats           September 1994


1.  Additional ICMP Packets

   The Packet format and basic facilities are already defined for ICMP
   as modified for IPv6 [IPv6-ICMP].

   Up-to-date values of the ICMP Type field are specified in the most
   recent "Assigned Numbers" [RFC-1310].  This document concerns the
   following values:

       33  Solicitation
       34  Advertisement
       35  Mobile Registration Request
       36  Mobile Registration Reply






































Simpson                  expires in six months                  [Page 1]
DRAFT                    IPv6 Discovery Formats           September 1994


1.1.  Solicitation

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions ...
   +-+-+-+-+-+-+-+-+-+-+-+-


   Type              33

   Code             Up-to-date values are specified in the most recent
                    "Assigned Numbers" [RFC-1310].  Current values are
                    assigned as follows:

                      0     RESERVED
                      1     General
                      2     Router
                      3     Service


   Checksum         The ICMP Checksum.

   Extensions       This field is variable in length and contains zero
                    or more Extensions.  These Extensions are described
                    in a later section.

   The contents of the Reserved field MUST be zero on transmission, and
   MUST be ignored on receipt.  Future backward-compatible changes to
   the protocol may specify the contents of the Reserved field or of
   additional octets at the end of the message.


















Simpson                  expires in six months                  [Page 2]
DRAFT                    IPv6 Discovery Formats           September 1994


1.1.1.  General Solicitation

   The General Solicitation MUST contain at least the following values:

   IPv6 Header:

      Destination      an IPv6 Address of the target.  It MUST NOT
                       contain a multicast address.

      Source           any IPv6 Address associated with the sending
                       node.  It MUST NOT contain the Unspecified
                       Address.

   ICMP fields:

      Code             1 for General Solicitation.

   Extensions:

      Media-Access     for interfaces which are not point-to-point
                       links.

      System-Heard     for each Router Advertisement that has been
                       heard, in order of preference.

      In the unlikely event that not all extensions fit in a single
      solicitation, as constrained by the MTU of the link, the remaining
      extensions are removed.























Simpson                  expires in six months                  [Page 3]
DRAFT                    IPv6 Discovery Formats           September 1994


1.1.2.  Router Solicitation

   The Router Solicitation MUST contain at least the following values:

   IPv6 Header:

      Destination      the all-routers multicast.  The scope is set to
                       intra-link.

      Source           any IPv6 Address associated with the sending
                       node.  It MAY contain the Unspecified Address,
                       when the node has not yet determined an IPv6
                       Address.

   ICMP fields:

      Code             2 for Router Solicitation.

   There are no required extensions.
































Simpson                  expires in six months                  [Page 4]
DRAFT                    IPv6 Discovery Formats           September 1994


1.1.3.  Service Solicitation

   The Service Solicitation MUST contain at least the following values:

   IPv6 Header:

      Destination      the multicast group associated with the service.
                       The scope is set to intra-site.

      Source           any IPv6 Address associated with the sending
                       node.  It MUST NOT contain the Unspecified
                       Address.

   ICMP fields:

      Code             3 for Service Solicitation.

   Extensions:

      Service-Information
                       One or more qualifiers, in order of importance.

      In the unlikely event that not all extensions fit in a single
      solicitation, as constrained by the MTU of the link, the remaining
      extensions are removed.


























Simpson                  expires in six months                  [Page 5]
DRAFT                    IPv6 Discovery Formats           September 1994


1.2.  Advertisement

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Sequence Number        |          LifeTime             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions ...
   +-+-+-+-+-+-+-+-+-+-+-+-


   Type              34

   Code             Up-to-date values are specified in the most recent
                    "Assigned Numbers" [RFC-1310].  Current values are
                    assigned as follows:

                      0     RESERVED
                      1     General
                      2     Router
                      3     Service
                      4     Local Redirect
                      5     Remote Redirect


   Checksum         The ICMP Checksum.

   Sequence Number  Contains the number of Advertisement messages sent
                    since the node was initialized.  This number MUST
                    include this advertisement.  That is, the first
                    Advertisement contains the value one, and the value
                    zero indicates that the number has rolled over.

   LifeTime         Indicates the seconds remaining before the
                    advertised information is considered expired.  The
                    maximum time is approximately 18.2 hours.

   Extensions       This field is variable in length and contains zero
                    or more Extensions.  These Extensions are described
                    in a later section.











Simpson                  expires in six months                  [Page 6]
DRAFT                    IPv6 Discovery Formats           September 1994


1.2.1.  General Advertisement

   The General Advertisement MUST contain at least the following values:

   IPv6 Header:

      Destination      the Source specified in the solicitation.

      Source           the Destination specified in the solicitation.

   ICMP fields:

      Code             1 for General Advertisement.

      Lifetime         the interface's configured AdvertisementLifetime.

   Extensions:

      Media-Access     for interfaces which are not point-to-point
                       links.

      Other-Identifier for each of that node's known IPv6 Addresses
                       other than the IPv6 Address specified in the IPv6
                       Source field.  The prefix size is set to zero.

      System-Heard     for each Router Advertisement that has been
                       heard, in order of preference.

      In the unlikely event that not all extensions fit in a single
      advertisement, as constrained by the MTU of the link, the
      remaining extensions are removed.




















Simpson                  expires in six months                  [Page 7]
DRAFT                    IPv6 Discovery Formats           September 1994


1.2.2.  Router Advertisement

   The Router Advertisement MUST contain at least the following values:

   IPv6 Header:

      Destination      the all-nodes multicast.  The scope is set to
                       intra-link.

      Source           the primary IPv6 Address of the node.

                       The same IPv6 Address is used for all interfaces.
                       When a router has more than one interface on the
                       same link, or a multi-homed host can hear the
                       same router on more than one link, it is
                       necessary to unambiguously know which router sent
                       this advertisement.  The individual routing
                       prefixes for the links are distinguished in the
                       Routing Information extension.

   ICMP fields:

      Code             2 for Router Advertisement.

      Lifetime         the interface's configured AdvertisementLifetime.

   Extensions:

      Media-Access     for interfaces which are not point-to-point
                       links.

      Routing-Information
                       for each of that interface's associated IPv6
                       Addresses whose Advertise flags are TRUE.

      Change-Identifier for each of that interface's recently changed
                       IPv6 Addresses.

      Other-Identifier for each of that node's other IPv6 Addresses
                       which have not already been included through
                       prefix subsumption.

      System-Heard     for each Router Advertisement that has been
                       heard, in order of preference.

      In the unlikely event that not all extensions fit in a single
      advertisement, as constrained by the MTU of the link, multiple
      advertisements are sent, with each except the last containing as



Simpson                  expires in six months                  [Page 8]
DRAFT                    IPv6 Discovery Formats           September 1994


      many extensions as can fit.


















































Simpson                  expires in six months                  [Page 9]
DRAFT                    IPv6 Discovery Formats           September 1994


1.2.3.  Service Advertisement

   The Service Advertisement MUST contain at least the following values:

   IPv6 Header:

      Destination      the all-nodes multicast.  The scope is set by
                       administrative policy.

      Source           any IPv6 Address associated with the sending
                       node.

   ICMP fields:

      Code             3 for Service Advertisement.

      Lifetime         the interface's configured AdvertisementLifetime.

   Extensions:

      Media-Access     for interfaces which are not point-to-point
                       links.

      Other-Identifier for each of that node's known IPv6 Addresses
                       other than the IPv6 Address specified in the IPv6
                       Source field.  The prefix size is set to zero.

      Service-Information
                       One or more qualifiers, in order of importance.

      System-Heard     for each Router Advertisement that has been
                       heard, in order of preference.

      In the unlikely event that not all extensions fit in a single
      advertisement, as constrained by the MTU of the link, multiple
      advertisements are sent, with each except the last containing as
      many extensions as can fit.














Simpson                  expires in six months                 [Page 10]
DRAFT                    IPv6 Discovery Formats           September 1994


1.2.4.  Local Redirect

   The Local Redirect MUST contain at least the following values:

   IPv6 Header:

      Destination      the Source specified in the packet being
                       redirected.

      Source           the primary IPv6 Address associated with the
                       sending node.

   ICMP fields:

      Code             4 for Local Redirect.

      Sequence         the last Sequence from the target node
                       Advertisement.

      Lifetime         the remaining Lifetime from the target node
                       Advertisement.

   Extensions:

      Media-Access     for interfaces which are not point-to-point
                       links, the Media-Access extension from the target
                       node Advertisement.

      Other-Identifier for each IPv6 Address associated with the target
                       node.  The metric is set to zero.

                       When the redirect applies to an entire cluster,
                       the prefix size is set to the size of the cluster
                       prefix.

      Transit-Information
                       one or more, when the redirect is limited to a
                       specific Quality of Service.  The metric is set
                       to zero.

      Redirected-Header The target header.

      In the unlikely event that not all extensions fit in a single
      redirect, as constrained by the MTU of the link, the remaining
      extensions are removed.  Only a single redirect is sent.

   The Local Redirect is used by a router to redirect a host to another
   router, or to another host on the same link.  These uses are



Simpson                  expires in six months                 [Page 11]
DRAFT                    IPv6 Discovery Formats           September 1994


   indistinguishable.


















































Simpson                  expires in six months                 [Page 12]
DRAFT                    IPv6 Discovery Formats           September 1994


1.2.5.  Remote Redirect

   The Remote Redirect MUST contain at least the following values:

   IPv6 Header:

      Destination      the Source specified in the packet being
                       redirected.

      Source           the primary IPv6 Address associated with the
                       sending node.

   An Authentication Header is required.

   ICMP fields:

      Code             5 for Remote Redirect.

      Sequence         the last Sequence from the target node
                       Advertisement.

      Lifetime         the remaining Lifetime from the target node
                       Advertisement.

   Extensions:

      Change-Identifier when the IPv6 Destination of the redirected
                       packet is changing.  The Prefix Size is set to
                       zero.

      Other-Identifier for each IPv6 Address associated with the target
                       node.  The metric is set to zero, and the prefix
                       size is set to zero.

      Redirected-Header The target header.

      In the unlikely event that not all extensions fit in a single
      redirect, as constrained by the MTU of the link, the remaining
      extensions are removed.  Only a single redirect is sent.

   The Remote Redirect is primarily used to support Mobility.










Simpson                  expires in six months                 [Page 13]
DRAFT                    IPv6 Discovery Formats           September 1994


1.3.  Mobile Registration Request

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             unused            |          LifeTime             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                         Identification                        +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                           Home Agent                          ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                        Care-Of-Address                        ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions ...
   +-+-+-+-+-+-+-+-+-+-+-+-

   IPv6 Header:

      Destination      The IPv6 Address of the Agent, when known.

                       When the IPv6 Address is unknown (the agent was
                       discovered via a link-layer protocol), the "all
                       Mobile Agents" multicast address.  The link-layer
                       unicast address is used to deliver the datagram
                       to the correct Agent.

      Source           An IPv6 Address belonging to the interface on
                       which this message is sent.

                       A Mobile Node MUST use the transient Care-Of-
                       Address when assigned; otherwise, the Home-
                       Address is used.

   ICMP fields:

      Type              35 <TBD>

      Code             Bitmask of optional capabilities:

                         1 - retain prior registrations
                         2 - registering through Foreign Agent




Simpson                  expires in six months                 [Page 14]
DRAFT                    IPv6 Discovery Formats           September 1994


      LifeTime         The seconds remaining before the registration is
                       considered expired.  A value of zero indicates a
                       request for de-registration.  A value of all ones
                       indicates infinity.

      Home Agent       The IPv6 Address of a Home Agent.

      Care-Of-Address  The IPv6 Address for the decapsulation end of a
                       tunnel.

      Identification   A sequence number assigned by the Mobile Node.
                       This is used to assist in matching Requests with
                       Replies.

                       A Network Time Protocol [RFC-1305] formatted
                       value is preferred.  The low-order 32 bits of the
                       NTP format represent fractional seconds, and
                       those bits which are not available from a time
                       source SHOULD be generated from a good source of
                       randomness.

                       A battery-backed clock is the usual source of
                       this value.  In more robust implementations,
                       Global Positioning System or authenticated NTP
                       values MAY be used.  The elapsed time since
                       system startup or another such monotonically
                       increasing counter MAY be used, but is considered
                       less secure, as it could repeat each time the
                       machine is restarted, or when a poor source of
                       randomness is used for the low-order bits.  See
                       [Eastlake, et alia] for a discussion of sources
                       of randomness.

                          It is possible to use an entirely random
                          "nonce" in this field, or to generate nonces
                          from previous registration exchanges.  We have
                          not standardized this procedure because of
                          intellectual property concerns.  It is also
                          incompatible with the expected venue of the
                          protocol, and presents difficulties with
                          interoperability and security validation.

                       The value MUST NOT be the same as an immediately
                       preceeding request, and SHOULD NOT repeat during
                       the lifetime of the Mobility Security Association
                       between the Mobile Node and the Home Agent.

   Extensions:



Simpson                  expires in six months                 [Page 15]
DRAFT                    IPv6 Discovery Formats           September 1994


      Other-Identifier required.  Contains the Home-Address of the
                       Mobile Node.  The metric is set to zero.

      Mobile-Home Authentication
                       required.  Immediately follows all non-
                       authentication extensions.

   When forwarded by a Foreign Agent, extensions which are specific to
   the Foreign Agent are removed.  All others are copied without
   modification.









































Simpson                  expires in six months                 [Page 16]
DRAFT                    IPv6 Discovery Formats           September 1994


1.4.  Mobile Registration Reply

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             unused            |          LifeTime             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                         Identification                        +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions ...
   +-+-+-+-+-+-+-+-+-+-+-+-

   IPv6 Header:

      The Source and Destination of the Request message are swapped for
      the Reply message.

      Note that the Source of the original Mobile Registration Request
      must be saved in order for a Foreign Agent to return the reply to
      the correct Mobile Node.

   ICMP fields:

      Type              36 <TBD>

      Code             One of the following codes:

                         0  service will be provided.

                       denied by Foreign Agent,
                        16  reason unspecified.
                        17  administratively prohibited.
                        18  insufficient resources.
                        19  Mobile Node failed authentication.
                        20  Home Agent failed authentication.
                        21  Request LifeTime too long.

                       denied by Home Agent,
                        32  reason unspecified.
                        33  administratively prohibited.
                        34  insufficient resources.
                        35  Mobile Node failed authentication.
                        36  Foreign Agent failed authentication.

                       Up-to-date values of the Code field are specified
                       in the most recent "Assigned Numbers" [RFC-1310].



Simpson                  expires in six months                 [Page 17]
DRAFT                    IPv6 Discovery Formats           September 1994


      LifeTime         The seconds remaining before the registration is
                       considered expired.  A value of zero confirms a
                       request for de-registration.  A value of all ones
                       indicates infinity.

      Identification   Copied from the Request message.

   Extensions:

      Other-Identifier required.  Contains the Home-Address of the
                       Mobile Node.  The metric is set to zero.

      Mobile-Home Authentication
                       required.  Immediately follows all non-
                       authentication extensions.

                       Note that the Care-Of-Address and Home Agent are
                       not present in the message.  This provides a
                       separate calculation value for mutual
                       authentication.

   When forwarded by a Foreign Agent, extensions which are specific to
   the Foreign Agent are removed.  All others are copied without
   modification.



























Simpson                  expires in six months                 [Page 18]
DRAFT                    IPv6 Discovery Formats           September 1994


2.  Extensions

   Extensions allow variable amounts of information to be carried within
   each Solicitation or Advertisement packet.  Some extensions are
   common to both packet types.

   The end of the list of Extensions is indicated by the Payload Length
   of the IPv6 packet.

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |   Extension   |    Length     |    Data ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-


   Extension        This document concerns the following values:

                      0     Single Pad (no length field)
                      1     Multiple Pads (with length field)
                      2     Change-Identifier
                      3     Other-Identifier
                      4     System-Heard
                      5     Routing-Information
                      6     Service-Information
                      7     Transit-Information
                      8     Redirected-Header
                     14     Maximum-Receive-Unit
                     15     Media-Access
                     16     Mobility (obsolete)
                     17     Home-Address (obsolete)
                     32     Mobile-Home Authentication
                     64     Minimal Encapsulation
                     65     GRE Encapsulation

                    Up-to-date values are specified in the most recent
                    "Assigned Numbers" [RFC-1310].

   Length           Indicates the length of the Data field which has
                    been used.  The Length does not include the
                    Extension and Length octets.  The Single Pad
                    (extension 0) is a special case, which has no Length
                    field.

   Data             This field is zero or more octets and contains the
                    value(s) for this Extension.  The format and length
                    of the Data field is determined by the Extension and
                    Length fields.

   When an extension is encountered which is not recognized, it is



Simpson                  expires in six months                 [Page 19]
DRAFT                    IPv6 Discovery Formats           September 1994


   ignored.  The length field is used to skip the data field in
   searching for the next extension.

   Every extension is aligned such that internal fields fall on natural
   boundaries, except that fields larger than 64-bits need only be
   aligned to 64-bit boundaries.

   Any unused portion of the datagram between such Extensions is padded
   as appropriate.  The final Extension in a datagram does not require
   trailing padding.



2.1.  Single Pad

   +-+-+-+-+-+-+-+-+
   |   Extension   |
   +-+-+-+-+-+-+-+-+


   Extension        0



2.2.  Multiple Pads

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |   Extension   |    Length     |    Data ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-


   Extension        1

   Length           Indicates the length of the Data field.

   Data             This field is zero or more bytes of zeroes.















Simpson                  expires in six months                 [Page 20]
DRAFT                    IPv6 Discovery Formats           September 1994


2.3.  Change-Identifier

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |     unused      | Prefix Size |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             unused                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                       Old IPv6 Address                        ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                       New IPv6 Address                        ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        2

   Length           22

   Prefix Size      Indicates the number of bits in both IPv6 Addresses
                    which define the cluster prefix width for the link.
                    The value ranges from 0 to 126.

   Old IPv6 Address Depending on the Prefix Size, it may indicate a
                    cluster, or a single IPv6 Address.

   New IPv6 Address Depending on the Prefix Size, it may indicate a
                    cluster, or a single IPv6 Address.

   For advertisements, this allows changing a prefix for every node on a
   router's interface.

   For redirects, this allows changing a single target IPv6 Address.
















Simpson                  expires in six months                 [Page 21]
DRAFT                    IPv6 Discovery Formats           September 1994


2.4.  Other-Identifier

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |                 | Prefix Size |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Metric                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                         IPv6 Address                          ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        3

   Length           14

   Prefix Size      Indicates the number of bits in the IPv6 Address
                    which define the cluster prefix width for the link.
                    The value ranges from 0 to 126.

                    If the IPv6 Address does not indicate a valid
                    prefix, the value is zero.

                    Non-routers MUST set this field to zero.

   Metric           Indicates the preference level for use of this node
                    to forward packets to the IPv6 Address.  Lower
                    values indicate greater preference.

                    Non-routers MUST set this field to zero.

   IPv6 Address     Contains one of the IPv6 Addresses for this node.
                    This may be another IPv6 Address for the same
                    interface that sent the message, or may identify
                    another interface on the same node which sent the
                    message.

   This supports multiple IPv6 Addresses per interface, as well as
   multi-homed nodes.

   When a number of interfaces, such as point-to-point interfaces, may
   be aggregated with the same prefix, only one extension need be
   included.

   For advertisements, this enables the recipient node to determine the
   best next-hop without sending a Solicitation when the next-hop is on
   another interface attached to the same advertising node.



Simpson                  expires in six months                 [Page 22]
DRAFT                    IPv6 Discovery Formats           September 1994


   For redirects, this enables the recipient node to determine the best
   next-hop without multiple redirects for each cluster.



2.5.  System-Heard

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |                 | Prefix Size |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Sequence Number        |      Remaining LifeTime       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                         IPv6 Address                          ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              MRU              |               |     Speed     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Quality                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Advertisement Count                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Error Count                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        4

   Length           30

   Prefix Size      Indicates the number of bits in the IPv6 Address
                    which define the cluster prefix width for the link.
                    The value ranges from 0 to 126.

                    If the IPv6 Address does not indicate a valid
                    prefix, the value is zero.

   Sequence Number  Contains the last heard sequence number from the
                    node.

   Remaining LifeTime
                    Indicates the seconds remaining before the entry is
                    considered expired.

   IPv6 Address     Contains the primary IPv6 Address for the node,
                    taken from the Source field of the Advertisement
                    heard.




Simpson                  expires in six months                 [Page 23]
DRAFT                    IPv6 Discovery Formats           September 1994


   MRU              Indicates the maximum size packet that the node will
                    receive over the link.

   Speed            Indicates the speed of the link over which the
                    advertisement or solicitation was heard.  Higher
                    values indicate greater speed.  The speed value is
                    related to int( 10 * ln( speed / 100 ) ) in bits per
                    second.

                      0      link is down
                      1 - 9  reserved
                     10      300 or less
                     24    1,200             96      1,544,000 T1
                     31    2,400             99      2,048,000 E1
                     38    4,800            106      4,000,000 Token Ring
                     42    7,200            110      6,312,000 T2
                     45    9,600            115     10,000,000 Ethernet
                     49   14,400            119     16,000,000 Token Ring
                     52   19,200
                     56   28,800            130     44,736,000 T3
                     59   38,400            142    155,520,000 STS-3,STM-1
                     63   57,600            202    622,080,000 STS-12,STM-4
                     64   64,000            216  2,488,320,000 STS-48,STM-16
                     71  128,000
                     73  153,600
                     78  256,000


   Quality          Contains an indication of the signal quality
                    received from this node.  Higher values indicate
                    greater quality.

   Advertisement Count
                    Indicates the number of advertisements that have
                    been heard from the identified node.

   Error Count      Indicates the number of errors which have been
                    detected on the link with the identified node.

   This extension is included in the Advertisement message to indicate a
   node which has been heard.

   The MRU, Speed, Quality, Advertisement Count, and Error Count are
   primarily used for selecting among multiple paths in a wireless
   environment.






Simpson                  expires in six months                 [Page 24]
DRAFT                    IPv6 Discovery Formats           September 1994


2.6.  Routing-Information

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |C|F|             | Prefix Size |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                               |  Preference   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                         IPv6 Address                          ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        5

   Length           14

   C                Cluster bit.  When this bit is set to 1, the IPv6
                    Cluster is entirely confined to the link.  When
                    forwarding, a node MAY use the prefix to determine
                    whether a target node is on the link.

   F                Foreign Agent bit.  When this bit is set to 1,
                    Mobile Registration through the Foreign Agent is
                    required, even when the Mobile Node has acquired a
                    transient Care-Of-Address.

   Prefix Size      Indicates the number of bits in the IPv6 Address
                    which define the cluster prefix width for the link.
                    The value ranges from 0 to 126.

                    If the IPv6 Address does not indicate a valid
                    prefix, the value is zero.

   Preference       Indicates the preference level for use of this node
                    to forward packets to the IPv6 Address.  Higher
                    values indicate greater preference.

   IPv6 Address     Contains one of the IPv6 Addresses for this
                    interface.

   This extension is sent only by Routers.









Simpson                  expires in six months                 [Page 25]
DRAFT                    IPv6 Discovery Formats           September 1994


2.7.  Service-Information

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |           Service             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Data ...
   +-+-+-+-+-+-+-+-+-+-+-+-


   Extension        6

   Length           >= 2

   Service          The value of this field is usually the same as the
                    well-known port number.  Up-to-date values are
                    specified in the most recent "Assigned Numbers"
                    [RFC-1310].

   Data             This field is variable in length and contains
                    Attribute information specific to the service.































Simpson                  expires in six months                 [Page 26]
DRAFT                    IPv6 Discovery Formats           September 1994


2.8.  Transit-Information

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |               |      QoS      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             Metric                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        7

   Length           6

   QoS              Indicates a quality of service for which transit
                    will be accepted.

   Metric           Indicates the preference level for use of this link
                    to forward packets of the indicated Quality of
                    Service.  Lower values indicate greater preference.

   For advertisements, this indicates that a router will accept transit
   traffic for the service.  If this extension is not included, other
   routers will treat the link as a stub cluster.

   For redirects, this indicates that the redirect is limited to only
   the particular service.  If this extension is not included, the
   redirect includes all services.
























Simpson                  expires in six months                 [Page 27]
DRAFT                    IPv6 Discovery Formats           September 1994


2.9.  Redirected-Header

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |     IPv6 Header ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        8

   Length           54

   IPv6 Header      48 octets.

   This extension is included in the Local or Remote Redirect to verify
   the traffic that is being redirected.




































Simpson                  expires in six months                 [Page 28]
DRAFT                    IPv6 Discovery Formats           September 1994


2.10.  Maximum-Receive-Unit

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |             MRU               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        14

   Length           2

   MRU              Indicates the maximum size packet that the node will
                    receive over the link.

   The Maximum-Receive-Unit extension MUST be included in those messages
   sent from an interface for which there is no dependable MTU, such as
   Frame-Relay or Asynchronous Transfer Mode.

   It MUST NOT be included in messages such as the Remote Redirect which
   pass through intermediate nodes.































Simpson                  expires in six months                 [Page 29]
DRAFT                    IPv6 Discovery Formats           September 1994


2.11.  Media-Access

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |           Media Type          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Media Address ...
   +-+-+-+-+-+-+-+-+-+-+-+-


   Extension        15

   Length           >= 2

   Media Type       The value of this field is the same as the Hardware
                    Type used in ARP.  Up-to-date values are specified
                    in the most recent "Assigned Numbers" [RFC-1310].

   Media Address    This field is variable in length and contains the
                    media address which is used to access this node.

                    The Media Address is always specified in Canonical
                    order.

   The Media-Access extension MUST be included in those messages sent
   from an interface on a multi-access media.

   It MUST NOT be included in a message sent from a point-to-point
   interface, or in messages such as the Remote Redirect which pass
   through intermediate nodes.






















Simpson                  expires in six months                 [Page 30]
DRAFT                    IPv6 Discovery Formats           September 1994


2.12.  Mobile-Home Authentication Extension

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |        Authenticator ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        32

   Length           The number of data bytes in the Extension (16 when
                    MD5 is used).

   Authenticator    Variable length (128 bits for MD5).

                    A hash value taken over a stream of bytes consisting
                    of the shared secret, followed by (concatenated
                    with) the fields in the Mobile Registration message
                    beginning with the Type field, including all prior
                    extensions, and the Type and Length of this
                    extension, but not including the Authenticator field
                    itself.

   This Authentication Extension is found in all Mobile Registration
   Requests and Replies.

   The value differs depending on the direction the message is sent,
   since the Mobile Registration Request and Reply have different
   fields.























Simpson                  expires in six months                 [Page 31]
DRAFT                    IPv6 Discovery Formats           September 1994


2.13.  Minimal Encapsulation Extension

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extension   |    Length     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Extension        64

   Length           0

   The Minimal Encapsulation Extension is found in Router Advertisements
   and Mobile Registration Requests.






































Simpson                  expires in six months                 [Page 32]
DRAFT                    IPv6 Discovery Formats           September 1994


Security Considerations




References

   [Eastlake]

   [IPv6-ICMP]

   [RFC-1305]

   [RFC-1310]



Acknowledgements

   Extensive review by Alex Conta (DEC), and Dan McDonald (NRL).



Author's Address

   Questions about this memo can also be directed to:

      William Allen Simpson
      Daydreamer
      Computer Systems Consulting Services
      1384 Fontaine
      Madison Heights, Michigan  48071

      Bill.Simpson@um.cc.umich.edu
          bsimpson@MorningStar.com
















Simpson                  expires in six months                 [Page 33]
DRAFT                    IPv6 Discovery Formats           September 1994


                           Table of Contents


     1.     Additional ICMP Packets ...............................    1
        1.1       Solicitation ....................................    2
           1.1.1  General Solicitation ............................    3
           1.1.2  Router Solicitation .............................    4
           1.1.3  Service Solicitation ............................    5
        1.2       Advertisement ...................................    6
           1.2.1  General Advertisement ...........................    7
           1.2.2  Router Advertisement ............................    8
           1.2.3  Service Advertisement ...........................   10
           1.2.4  Local Redirect ..................................   11
           1.2.5  Remote Redirect .................................   13
        1.3       Mobile Registration Request .....................   14
        1.4       Mobile Registration Reply .......................   17

     2.     Extensions ............................................   19
        2.1       Single Pad ......................................   20
        2.2       Multiple Pads ...................................   20
        2.3       Change-Identifier ...............................   21
        2.4       Other-Identifier ................................   22
        2.5       System-Heard ....................................   23
        2.6       Routing-Information .............................   25
        2.7       Service-Information .............................   26
        2.8       Transit-Information .............................   27
        2.9       Redirected-Header ...............................   28
        2.10      Maximum-Receive-Unit ............................   29
        2.11      Media-Access ....................................   30
        2.12      Mobile-Home Authentication Extension ............   31
        2.13      Minimal Encapsulation Extension .................   32

     SECURITY CONSIDERATIONS ......................................   33

     REFERENCES ...................................................   33

     ACKNOWLEDGEMENTS .............................................   33

     AUTHOR'S ADDRESS .............................................   33









