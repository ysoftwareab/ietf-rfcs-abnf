Network Working Group                Acee Lindem    (Redback Networks)
Internet Draft                       Naiming Shen   (Redback Networks)
Expiration Date: August 2004         Rahul Aggarwal (Juniper Networks)
                                     Scott Shaffer  (Genuity, Inc.)


                  Extensions to IS-IS for Advertising Optional
                              Router Capabilities

                       draft-raggarwa-isis-cap-01.txt


1. Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026, except that the right to
   produce derivative works is not granted.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as ``work in progress.''

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


2. Abstract

   It is useful for routers in an IS-IS domain to know of the capabilities
   of their neighbors, and/or of other routers in the domain. This
   draft proposes extensions to IS-IS for advertising optional router
   capabilities. In particular it defines an optional Router Capability
   TLV for IS-IS.










draft-raggarwa-isis-cap-01.txt                                 [Page 1]





Internet Draft    draft-raggarwa-isis-cap-01.txt           February 2004


3. Motivation

   It is useful for routers in a domain to know of the capabilities
   of their IS-IS neighbors, and/or of other routers in the domain. This
   can be useful for various purposes:
   o In MPLS Traffic Engineering (TE) as a TE discovery mechanism
     [10] to announce a LSR's TE capabilities like Path Computation
     Server capability (Capability of a LSR to be a Path Computation
     Server for TE LSP path computation) or the intention of a LSR to be
     part of a particular MPLS TE mesh group.
   o For network management and troubleshooting. It gives operators a
     network wide view of IS-IS capabilities on different routers in the
     network. The presence of a capability on a given router implies
     that the software version supports the capability and the router is
     configured to support it. On the other hand the absence of an
     expected capability on a particular router can imply either
     mis-configuration or an incorrect software version. Hence this
     capability information can be used to track problems resulting from
     mis-configuration or an incorrect software version.

   There is no existing mechanism in IS-IS to advertise optional router
   capabilities. We propose extensions to IS-IS for advertising these
   optional capabilities. For current IS-IS capabilities this
   advertisement will be used primarily for MPLS TE and informational
   purposes. Conceivably, future capability advertisements could be
   used for other purposes.

4. IS-IS Router Capability TLV

   IS-IS [1] routers may optionally advertise their router
   capabilities in the TLV with code type 242. This TLV specifies
   the router ID of the router that originates the TLV, defines the
   flooding scope of the TLV, specifies the router capability bits in
   the first sub-TLV and certain capability related information in other
   sub-TLVs. This draft does not specify how an application may use the
   Router Capability TLV and such specification is outside the scope of
   this draft.

   The router ID is a 32 bit unsigned integer to represent the router
   that originated this capability TLV. This is needed since this TLV
   can be flooded over the entire domain, hence the router ID of the
   originating router must be kept.

   The capability bits are defined in a mandatory sub-TLV with
   code 1. It starts as a 32 bits flag, where each bit can represent
   a router capability. This flag can be expanded as needed to
   include more capabilities.




draft-raggarwa-isis-cap-01.txt                                 [Page 2]





Internet Draft    draft-raggarwa-isis-cap-01.txt           February 2004


   Some of the router capabilities may require more information
   than a single bit. The extra capability information can be encoded
   as sub-TLVs under this router capability TLV. The definition
   of these sub-TLVs is outside the scope of this draft.

   If a router does not advertise this TLV, it does not imply that
   the router does not support one or more of the defined capabilities.
   If this TLV is included in the LSP, the router SHOULD set all
   the defined bits corresponding to the capabilities which the
   software supports, unless they are explicitly configured off.

4.1 Flooding Scope of the Router Capability TLV

   There are three bits currently defined for this TLV in the
   information flag to control the flooding scope of the TLV. The
   Flooding bit, the Transit bit and the Down bit.

   There are two flooding types defined for this router capability
   TLV's flooding scope. One is the domain wide flooding scope and
   the other is the intra-area flooding scope. The F bit if set
   indicates this TLV has the domain wide flooding scope.

   The Transit bit can be used to signal the routers on the edge
   of the IGP routing domain to redistribute this TLV information
   into another routing process. How this is done is an application
   specific issue and is outside the scope of this document.

   The L1/L2 routers MUST observe the Down bit to avoid TLV leak
   looping.  This Down bit is not set when the router first originates
   this TLV and it MUST be set when leaking into a lower level or into
   another area of the same level. When the Down bit is set, this TLV
   can no longer be leaked to a higher level or into another area
   of the same level. This capability TLV MUST be preserved at the
   level boundary during TLV leaking. The L1/L2 router SHOULD
   NOT leak the TLV back into the same area which originated
   this TLV. It MAY be able to alter certain capability contents
   during TLV leaking when specified by applications.

4.2 Encoding of the Router Capability TLV

   The following figure depicts the structure of this IS-IS Router
   Capability TLV.

    x  CODE - 242
    x  LENGTH - total length of the value field in this TLV
    x  VALUE - 4-octet information flag, 4-octet router ID,
               1-octet sub-tlv length, the mandatory sub-TLV code 1
               for capability flags, and optional sub-TLVs for extra
               capability information, structured as follows:


draft-raggarwa-isis-cap-01.txt                                 [Page 3]





Internet Draft    draft-raggarwa-isis-cap-01.txt           February 2004


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |F|T|D|                 Reserved Information Flag               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  Router ID                                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |sub-TLV Length |Sub-TLV Type(1)|  Length       | N x 32bits... |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              Other optional Sub-TLVs..                        |


                  Figure 1. IS-IS Router Capability TLV

   The first field is the 4-octet information flag, which consists
   of the F, T and D bits, the reserved information bits.

   Bit F represents the Flooding scope of the TLV. If set, this TLV
   SHOULD be flooded to entire IGP domain. Otherwise, it SHOULD NOT
   be leaked into the other level or another area in the same level.

   Bit T determines the Transit behavior into other routing domains.
   For example, if this bit is set, a router can leak this capability
   information into another routing protocol.

   Bit D represents Down/Up behavior during the TLV leaking. When the
   capability is leaked from level 2 into level 1 or it is leaked into
   another area of the same level, this D bit MUST be set. Otherwise
   this bit MUST be cleared.

   Router ID is an unsigned 32 bit number representing the router
   that originates this router capability TLV.

   The next octet of the TLV is the total sub-TLV length of this
   router capability TLV. This sub-TLV length includes the first
   mandatory sub-TLV. The minimum value of this field is 6.

   The first sub-TLV with code 1 is a mandatory sub-TLV, the router
   capability flag sub-TLV. The length is the length of this sub-TLV.
   Its set to N x 4 octets. N starts from 1 and can be increased when
   there is a need. Each 4 octets are referred to as a capability flag.
   For each capability flag the bits are indexed from the most
   significant to the least significant, where each bit represents one
   router capability.

   There can be other sub-TLVs after the first sub-TLV to include
   extra information describing certain router capabilities. The
   description of those sub-TLVs is outside the scope of this draft.



draft-raggarwa-isis-cap-01.txt                                 [Page 4]





Internet Draft    draft-raggarwa-isis-cap-01.txt           February 2004


   The above data structure can be replicated within this TLV, but
   can not exceed the maximum length of 255 octets.  If no other
   sub-TLVs are used and the capability flag is the minimum 4 octets,
   this encoding can contain up to 17 router capability TLVs where
   each have a minimum of 15 octets of data(4 byte information flag,
   4 byte router-id, 1 byte total sub-tlv length, 6 byte capability
   flag).

4.3 Reserved IS-IS Router Capability Bits

   We have assigned some pre-determined bits to the first capability
   flag.

   Bit           Capabilities

   0-3           Reserved
   4             IS-IS graceful restart capable [4]
   5             IS-IS and BGP blackhole avoidance capable [6]
   6             IS-IS wide metric processing capable [3]
   7             IS-IS short metric processing capable [1]
   8             IS-IS hmac-md5 authentication capable [5]
   9             IS-IS Traffic Engineering support [3]
   10            IS-IS point-to-point over LAN [7]
   11            IS-IS Path Computation Server discovery [10]
   12            M-ISIS capable [8]
   13            IS-IS IPv6 capable [9]
   14-31         For future assignments

6. Security Consideration

   This document does not introduce new security issues. The security
   considerations pertaining to the original IS-IS protocol remain
   relevant.

7. Acknowledgments

   The idea for this work grew out of a conversation with Andrew Partan
   and we would like to thank him for his contribution.

8. References

    [1]  Callon, R., "OSI IS-IS for IP and Dual Environment," RFC 1195,
         December 1990.

    [2]  ISO, "Intermediate system to Intermediate system routeing
         information exchange protocol for use in conjunction with the
         Protocol for providing the Connectionless-mode Network
         Service (ISO 8473)," ISO/IEC 10589:1992.



draft-raggarwa-isis-cap-01.txt                                 [Page 5]





Internet Draft    draft-raggarwa-isis-cap-01.txt           February 2004


    [3]  Li, T. et al, "IS-IS Extensions for Traffic Engineering",
         Internet Draft, work in Progress.

    [4]  Shand, M., "Restart Signaling for IS-IS", Internet Draft, work
         in Progress.

    [5]  Li, T., "IS-IS Cryptographic Authentication", Internet Draft,
         work in progress.

    [6]  McPherson, D., "IS-IS Transient Blackhole Avoidance", Internet
         Draft, work in progress.

    [7]  N. Shen, et al, "Point-to-point operation over LAN in
         link-state-routing protocols", Internet Draft, work in
         progress.

    [8]  T. Przygienda, N. Shen, N. Sheth, "M-ISIS: Multi Topology (MT)
         Routing in IS-IS", Internet Draft, work in progress.

    [9]  C. Hopps, "Routing IPv6 with IS-IS", Internet Draft, work
         in progress.

    [10] Vasseur et al, "RSVP Path computation request and reply
         " messages", draft-vasseur-mpls-computation-rsvp-te-03.txt,
         work in progress

9. Author Information

Acee Lindem
Redback Networks
350 Holger Way
San Jose, CA 95134
e-mail: acee@redback.com

Naiming Shen
Redback Networks
350 Holger Way
San Jose, CA 95134
e-mail: naiming@redback.com

Rahul Aggarwal
Juniper Networks
1194 N. Mathilda Avenue
San Jose, CA 94089
e-mail: rahul@juniper.net






draft-raggarwa-isis-cap-01.txt                                 [Page 6]





Internet Draft    draft-raggarwa-isis-cap-01.txt           February 2004


Scott Shaffer
Genuity, Inc.
3 Van de Graaff Drive
PO Box 3073
Burlington, MA 01803
e-mail: sshaffer@genuity.com













































draft-raggarwa-isis-cap-01.txt                                 [Page 7]
