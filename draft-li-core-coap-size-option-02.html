<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>CoAP Option Extension : Size </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Justification">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Size Option Extension">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Size Option Definition">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Using the Size Option">
<link href="#rfc.section.3" rel="Chapter" title="3 Interaction with Block option">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Usage in POST/PUT Request">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Usage in GET Response">
<link href="#rfc.section.4" rel="Chapter" title="4 How to merge into Block draft">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 The Size option">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Using the Size option">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Example">
<link href="#rfc.section.5" rel="Chapter" title="5 Examples">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines an extension to the Constrained Application Protocol (CoAP) to add a new option Size, which is used to indicate the resource size in a PUT/POST request or in a GET response.  " />
  <meta name="description" content="This document defines an extension to the Constrained Application Protocol (CoAP) to add a new option Size, which is used to indicate the resource size in a PUT/POST request or in a GET response.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">core</td>
<td class="right">K. Li</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">L. Tian</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">B. Leiba</td>
</tr>
<tr>
<td class="left">Expires: April 23, 2012</td>
<td class="right">Huawei Technologies</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 21, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">CoAP Option Extension : Size <br />
  <span class="filename">draft-li-core-coap-size-option-02</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines an extension to the Constrained Application Protocol (CoAP) to add a new option Size, which is used to indicate the resource size in a PUT/POST request or in a GET response.  </p>
<h1><a>Note</a></h1>
<p>Discussion and suggestions for improvement are requested, and should be sent to core@ietf.org.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 23, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Justification</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">Size Option Extension</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Size Option Definition</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Using the Size Option</a>
</li>
<li>3.   <a href="#rfc.section.3">Interaction with Block option</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Usage in POST/PUT Request</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Usage in GET Response</a>
</li>
<li>4.   <a href="#rfc.section.4">How to merge into Block draft</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">The Size option</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Using the Size option</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Example</a>
</li>
<li>5.   <a href="#rfc.section.5">Examples</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Acknowledgements</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This specification adds a new option Size to the Constrained Application Protocol (CoAP).  The main purpose is to indicate the resource size in a PUT/POST request, or in a GET response.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#just" id="just">Justification</a>
</h1>
<p id="rfc.section.1.1.p.1">If the requester wants to retrieve large resource data using a GET request, it is better to know in advance the size of the resource data.  Currently in the Link Format <a href="#I-D.ietf-core-link-format">[I-D.ietf-core-link-format]</a> specification, the maximum size estimate attribute "sz" is defined to give an indication of the estimated maximum size of the resource data.  By using this, the requester is able to know whether it is capable to accept the resource data. However it is not possible for the requester to know exactly how many blocks will be transmitted, therefore, concurrent GET can't be supported.  </p>
<p id="rfc.section.1.1.p.2">Also in a POST/PUT request (for example, a firmware update), it is not possible for the recipient to know in advance what is the size of the data to be transmitted. According to the current CoAP <a href="#I-D.ietf-core-coap">[I-D.ietf-core-coap]</a> specification, when transmitting large data, the recipient will return an error code 4.13 (Request Entity Too Large) to the requester when the data size is too big to be accepted by the recipient.  In this case the whole transmission has failed, and the previous received data will be useless. This is a waste of transmission resources.  </p>
<p id="rfc.section.1.1.p.3">This document adds the new Size Option to provide the capability to indicate the accurate size in a GET response or in a POST/PUT request.  </p>
<p id="rfc.section.1.1.p.4">By using the Size Option in a GET response, the CoAP Server can let the requester know the actual size of the resource in advance.  This is especially useful for large resources, and can facilitate the requester to allocate enough buffer space before transmission.  Also, using the block size, the requester can calculate the total number of blocks and can use concurrent GET requests to retrieve resource data using the Block Option.  Finally, the recipient can check the resource size after the data transmission has been completed.  </p>
<p id="rfc.section.1.1.p.5">By using the Size Option in a PUT/POST request, the requester can indicate the resource size in the first Block Option message, to let the recipient know the resource data size in advance. If the recipient is not able to receive the data with the indicated size, the recipient can tell the requester in a response code, avoiding the cost of the actual data transmission.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#terms" id="terms">Terminology</a>
</h1>
<p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#Size" id="Size">Size Option Extension</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#Definition" id="Definition">Size Option Definition</a>
</h1>
<div id="#rfc.figure.1"></div>
<pre>
        +------+-----+-------+-----------+--------+---------------+
        | Type | C/E | Name  | Data type | Length | Default       |
        +------+-----+-------+-----------+--------+---------------+
        |  18  |  E  | Size  | uint      | 0-4 B  |               |
        +------+-----+-------+-----------+--------+---------------+
         </pre>
<p></p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#Usage" id="Usage">Using the Size Option</a>
</h1>
<p id="rfc.section.2.2.p.1">The Size Option is used to indicate the size of the resource data measured in bytes.  </p>
<p id="rfc.section.2.2.p.2">The GET request including Size=0 is treated as a request to get the size of the resource representation (but not the resource payload).  </p>
<p id="rfc.section.2.2.p.3">The GET request including an empty Size option is treated as a request to get the size of the resource representation with the resource payload.  </p>
<p id="rfc.section.2.2.p.4">The Size option MUST be included in the GET response, if the Size option is present in the request.  </p>
<p id="rfc.section.2.2.p.5">Also it SHOULD be used in a POST/PUT request in the first Block Option message.  </p>
<p id="rfc.section.2.2.p.6">The Size option SHOULD be included for resources larger than a single PDU, if the Size information is available. And it MAY be included for resources smaller than a single MTU.  </p>
<p id="rfc.section.2.2.p.7">In the absence of the option, the size of the resource data is calculated after the data has been transmitted to the recipient, either from the CoAP payload length or based on number of blocks and block size.  </p>
<p id="rfc.section.2.2.p.8">If the Size option is specified it SHOULD be accurate at that time, and SHOULD NOT be an estimate.  </p>
<p id="rfc.section.2.2.p.9">But due to the dynamic change of the resource data, the Size may not be accurate.  If the value of Size option is not the same as the actual transmitted data, the recipient MUST take the size of the actual transmitted data as accurate, and ignore the Size option. In case that the recipient gets all the data but it is still smaller than the announced Size, the recipient SHOULD stop the transmission.  If the recipient finds out the transmitted data reaches the Size limit, and there's more data left, the recipient SHOULD continue to transmit the remaining data.  </p>
<p id="rfc.section.2.2.p.10">This option is "Elective".  It MUST NOT occur more than once.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#Interaction" id="Interaction">Interaction with Block option</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#Request" id="Request">Usage in POST/PUT Request</a>
</h1>
<p id="rfc.section.3.1.p.1">In a PUT/POST request for large resource data, the requester SHOULD use the Size option to indicate the size of the resource.  If the recipient is not capable to receive the data with the indicated size, the recipient MUST return a 4.13 (Request Entity Too Large) response code to the requester, and the data transmission is avoided, so that the cost of the actual data transmission is saved.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#Response" id="Response">Usage in GET Response</a>
</h1>
<p id="rfc.section.3.2.p.1">In a GET response for large resource data, the CoAP Server SHOULD use the Size option to indicate the resource size and return the first block data. The requester can calculate the number of blocks to be transferred based on the block size and the resource size, and use concurrent GET requests to retrieve resource data.  Also, when the client determines it cannot process data of this Size, it MAY choose to abort and not to send subsequent GETs.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#Block" id="Block">How to merge into Block draft</a>
</h1>
<p id="rfc.section.4.p.1">This section introduces how to merge the Size option draft into Block draft with the minimum functionalities.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> The Size option</h1>
<p id="rfc.section.4.1.p.1">This section will work as section 2.3 in Block draft.  </p>
<div id="#rfc.figure.2"></div>
<pre>
        +------+-----+-------+-----------+--------+---------------+
        | Type | C/E | Name  | Data type | Length | Default       |
        +------+-----+-------+-----------+--------+---------------+
        |  18  |  E  | Size  | uint      | 1-4 B  |               |
        +------+-----+-------+-----------+--------+---------------+
           </pre>
<p></p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Using the Size option</h1>
<p id="rfc.section.4.2.p.1">This section will work as section 2.4 in Block draft.  </p>
<p id="rfc.section.4.2.p.2">The Size Option is used to indicate the size of the resource data measured in bytes.  </p>
<p id="rfc.section.4.2.p.3">The Size option SHOULD be used in a POST/PUT request in the first Block Option message.  If the recipient is not capable to receive the data with the indicated size, the recipient MUST return a 4.13 (Request Entity Too Large) response code to the requester, and the data transmission is avoided, so that the cost of the actual data transmission is saved.  </p>
<p id="rfc.section.4.2.p.4">For a GET request, if it includes an empty Size option, the Size option MUST be included in the response. If the GET request includes a Block option, the Size option SHOULD be included in the first Block response.  In other cases the GET response MAY contain a Size option.  </p>
<p id="rfc.section.4.2.p.5">If the Size option is specified, it SHOULD be accurate at that time, and SHOULD NOT be an estimate.  </p>
<p id="rfc.section.4.2.p.6">The option is "Elective".  It MUST NOT occur more than once.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Example</h1>
<p id="rfc.section.4.3.p.1">Example as indicated as Figure 2 in this draft can be added in section 3 in the Block draft.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#example" id="example">Examples</a>
</h1>
<p id="rfc.section.5.p.1">This section gives a number of short examples with message flows to illustrate the use of Size option in a GET response, or in a PUT/POST request.  </p>
<p id="rfc.section.5.p.2">The first example (Figure 1) shows that the requester does not know the resource data size, and sends the GET request, the recipient can send back the resource size using the Size option and the first block. In the subsequent GET request, the requester can calculate the number of blocks and use concurrent GET requests to retrieve the resource data.  </p>
<div id="#rfc.figure.3"></div>
<pre> 
   CLIENT                                                     SERVER
     |                                                          |
     | CON [MID=1234], GET, /status                     ------&gt; |
     |                                                          |
     | &lt;------   ACK [MID=1234], 2.00 OK, 0/1/128, Size: 5000   |
     |                                                          |
     | CON [MID=1235], GET, /status, 1/0/128            ------&gt; |
     |                                                          |
     | &lt;------   ACK [MID=1235], 2.00 OK, 1/1/128               |
     |                                                          |
     |                  ... ...                                 |  
     |                                                          |   
     | CON [MID=1280], GET, /status, 40/0/128           ------&gt; |
     |                                                          |
     | &lt;------   ACK [MID=1280], 2.00 OK, 40/0/128              |
     |                                                          |

                      Figure 1: Size Option in a GET response
         </pre>
<p id="rfc.section.5.p.3">The second example (Figure 2) shows the requester sending a PUT request with the Size option to indicate the resource data size, and since the recipient determines that the resource data is too large to be accepted, it sends back a 4.13 (Request Entity Too Large) response code.  </p>
<div id="#rfc.figure.4"></div>
<pre> 
   CLIENT                                                     SERVER
     |                                                          |
     | CON [MID=1234], PUT, /options, 1/0/128, Size: 5000 ----&gt; |
     |                                                          |
     | &lt;------   ACK [MID=1234], 4.13 Request Entity Too Large  |
     |                                                          |  

                      Figure 2: Size Option in a PUT request
          </pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">As the size option is used to determine whether or not the reciepient will accept the data, lying about it can cause the recipient to make a wrong decision. For example, an attacker might reduce the reported size such that the recipient will accept, even when it cannot process the complete data.  </p>
<p id="rfc.section.6.p.2">Related is another attack, where the attacker changes the reported size to a higher value, leading to the recipient rejecting even when it has the capability to receive.  </p>
<p id="rfc.section.6.p.3">The latter attack is similar to an attack where the attacker blocks the packets altogether; although it is more efficient since the attacker only needs to modify one message. The former attack needs serious consideration at implementation level, especially concerning possible buffer overflows that might lead to data leaking into the code.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The IANA is requested to add the following Option Number entry.  </p>
<div id="#rfc.figure.5"></div>
<pre>
                +--------+---------------+----------------+
                | Number | Name          | Reference      |
                +--------+---------------+----------------+
                |  18    | Size          | Section 2      |
                +--------+---------------+----------------+
         </pre>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#acknowledgement" id="acknowledgement">Acknowledgements</a>
</h1>
<p id="rfc.section.8.p.1">The authors of this draft would like to thank the participants of the email discussion on this issue.  Thanks to Bert Greevenbosch, Charles Palmer and Carsten Bormann for the detailed reviews and suggestions.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-coap">[I-D.ietf-core-coap]</b></td>
<td class="top">
<a>Shelby, Z</a>, <a>Hartke, K</a>, <a>Bormann, C</a> and <a>B Frank</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-coap-08">Constrained Application Protocol (CoAP)</a>", Internet-Draft draft-ietf-core-coap-08, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-block">[I-D.ietf-core-block]</b></td>
<td class="top">
<a>Bormann, C</a> and <a>Z Shelby</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-block-04">Blockwise transfers in CoAP</a>", Internet-Draft draft-ietf-core-block-04, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-link-format">[I-D.ietf-core-link-format]</b></td>
<td class="top">
<a>Shelby, Z</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-link-format-09">CoRE Link Format</a>", Internet-Draft draft-ietf-core-link-format-09, November 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kepeng Li</span> 
	  <span class="n hidden">
		<span class="family-name">Li</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  <span>Huawei Base, Bantian, Longgang District</span>

	  <span class="vcardline">
		<span class="locality">Shenzhen</span>,  
		<span class="region">Guangdong</span> 
		<span class="code">518129</span>
	  </span>
	  <span class="country-name vcardline">P. R. China</span>
	</span>
	<span class="vcardline">Phone: +86-755-28974289</span>

<span class="vcardline">EMail: <a href="mailto:likepeng@huawei.com">likepeng@huawei.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Linyi Tian</span> 
	  <span class="n hidden">
		<span class="family-name">Tian</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  <span>Huawei Base, Bantian, Longgang District</span>

	  <span class="vcardline">
		<span class="locality">Shenzhen</span>,  
		<span class="region">Guangdong</span> 
		<span class="code">518129</span>
	  </span>
	  <span class="country-name vcardline">P. R. China</span>
	</span>
	<span class="vcardline">Phone: +86-755-28978078</span>

<span class="vcardline">EMail: <a href="mailto:tianlinyi@huawei.com">tianlinyi@huawei.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Barry Leiba</span> 
	  <span class="n hidden">
		<span class="family-name">Leiba</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">Phone: +1 646 827 0648</span>

<span class="vcardline">EMail: <a href="mailto:barryleiba@computer.org">barryleiba@computer.org</a></span>

<span class="vcardline">URI: <a href="http://internetmessagingtechnology.org/">http://internetmessagingtechnology.org/</a></span>

  </address>
</div>

</body>
</html>