



Network Working Group                                           P. Jones
Internet-Draft                                               S. Dhesikan
Intended status: Standards Track                             C. Jennings
Expires: November 21, 2016                                 Cisco Systems
                                                                D. Druta
                                                                    AT&T
                                                            May 20, 2016


                  DSCP Packet Markings for WebRTC QoS
                     draft-ietf-tsvwg-rtcweb-qos-17

Abstract

   Many networks, such as service provider and enterprise networks, can
   provide different forwarding treatments for individual packets based
   on Differentiated Services Code Point (DSCP) values on a per-hop
   basis.  This document provides the recommended DSCP values for web
   browsers to use for various classes of WebRTC traffic.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 21, 2016.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must



Jones, et al.           Expires November 21, 2016               [Page 1]

Internet-Draft                 WebRTC QoS                       May 2016


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Relation to Other Specifications  . . . . . . . . . . . . . .   3
   4.  Inputs  . . . . . . . . . . . . . . . . . . . . . . . . . . .   4
   5.  DSCP Mappings . . . . . . . . . . . . . . . . . . . . . . . .   5
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   8.  Downward References . . . . . . . . . . . . . . . . . . . . .   8
   9.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   8
   10. Dedication  . . . . . . . . . . . . . . . . . . . . . . . . .   8
   11. Document History  . . . . . . . . . . . . . . . . . . . . . .   9
   12. References  . . . . . . . . . . . . . . . . . . . . . . . . .   9
     12.1.  Normative References . . . . . . . . . . . . . . . . . .   9
     12.2.  Informative References . . . . . . . . . . . . . . . . .  10
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  11

1.  Introduction

   Differentiated Services Code Point (DSCP) [RFC2474] packet marking
   can help provide QoS in some environments.  This specification
   provides default packet marking for browsers that support WebRTC
   applications, but does not change any advice or requirements in other
   IETF RFCs.  The contents of this specification are intended to be a
   simple set of implementation recommendations based on the previous
   RFCs.

   Networks where these DSCP markings are beneficial (likely to improve
   QoS for WebRTC traffic) include:

   1.  Private, wide-area networks.  Network administrators have control
       over remarking packets and treatment of packets.

   2.  Residential Networks.  If the congested link is the broadband
       uplink in a cable or DSL scenario, often residential routers/NAT
       support preferential treatment based on DSCP.

   3.  Wireless Networks.  If the congested link is a local wireless
       network, marking may help.

   There are cases where these DSCP markings do not help, but, aside
   from possible priority inversion for "less than best effort traffic"




Jones, et al.           Expires November 21, 2016               [Page 2]

Internet-Draft                 WebRTC QoS                       May 2016


   (see Section 5), they seldom make things worse if packets are marked
   appropriately.

   DSCP values are in principle site specific, with each site selecting
   its own code points for controlling per-hop-behavior to influence the
   QoS for transport-layer flows.  However in the WebRTC use cases, the
   browsers need to set them to something when there is no site specific
   information.  This document describes a subset of DSCP code point
   values drawn from existing RFCs and common usage for use with WebRTC
   applications.  These code points are intended to be the default
   values used by a WebRTC application.  While other values could be
   used, using a non-default value may result in unexpected per-hop
   behavior.  It is RECOMMENDED that WebRTC applications use non-default
   values only in private networks that are configured to use different
   values.

   This specification defines inputs that are provided by the WebRTC
   application hosted in the browser that aid the browser in determining
   how to set the various packet markings.  The specification also
   defines the mapping from abstract QoS policies (flow type, priority
   level) to those packet markings.

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   The terms "browser" and "non-browser" are defined in [RFC7742] and
   carry the same meaning in this document.

3.  Relation to Other Specifications

   This document is a complement to [RFC7657], which describes the
   interaction between DSCP and real-time communications.  That RFC
   covers the implications of using various DSCP values, particularly
   focusing on Real-time Transport Protocol (RTP) [RFC3550] streams that
   are multiplexed onto a single transport-layer flow.

   There are a number of guidelines specified in [RFC7657] that apply to
   marking traffic sent by WebRTC applications, as it is common for
   multiple RTP streams to be multiplexed on the same transport-layer
   flow.  Generally, the RTP streams would be marked with a value as
   appropriate from Table 1.  A WebRTC application might also multiplex
   data channel [I-D.ietf-rtcweb-data-channel] traffic over the same
   5-tuple as RTP streams, which would also be marked as per that table.
   The guidance in [RFC7657] says that all data channel traffic would be
   marked with a single value that is typically different than the



Jones, et al.           Expires November 21, 2016               [Page 3]

Internet-Draft                 WebRTC QoS                       May 2016


   value(s) used for RTP streams multiplexed with the data channel
   traffic over the same 5-tuple, assuming RTP streams are marked with a
   value other than default forwarding (DF).  This is expanded upon
   further in the next section.

   This specification does not change or override the advice in any
   other IETF RFCs about setting packet markings.  Rather, it simply
   selects a subset of DSCP values that is relevant in the WebRTC
   context.

   The DSCP value set by the endpoint is not trusted by the network.  In
   addition, the DSCP value may be remarked at any place in the network
   for a variety of reasons to any other DSCP value, including default
   forwarding (DF) value to provide basic best effort service.  Even so,
   there is benefit in marking traffic even if it only benefits the
   first few hops.  The implications are discussed in Secton 3.2 of
   [RFC7657].  Further, a mitigation for such action is through an
   authorization mechanism.  Such an authorization mechanism is outside
   the scope of this document.

4.  Inputs

   WebRTC applications send and receive two types of flows of
   significance to this document:

   o  media flows which are RTP streams [I-D.ietf-rtcweb-rtp-usage]

   o  data flows which are data channels [I-D.ietf-rtcweb-data-channel]

   Each of the RTP streams and distinct data channels consists of all of
   the packets associated with an independent media entity, so an RTP
   stream or distinct data channel is not always equivalent to a
   transport-layer flow defined by a 5-tuple (source address,
   destination address, source port, destination port, and protocol).
   There may be multiple RTP streams and data channels multiplexed over
   the same 5-tuple, with each having a different level of importance to
   the application and, therefore, potentially marked using different
   DSCP values than another RTP stream or data channel within the same
   transport-layer flow.  (Note that there are restrictions with respect
   to marking different data channels carried within the same SCTP
   association as outlined in Section 5.)

   The following are the inputs provided by the WebRTC application to
   the browser:

   o  Flow Type: The application provides this input because it knows if
      the flow is audio, interactive video [RFC4594] [G.1010] with or
      without audio, or data.



Jones, et al.           Expires November 21, 2016               [Page 4]

Internet-Draft                 WebRTC QoS                       May 2016


   o  Application Priority: Another input is the relative importance of
      an RTP stream or data channel.  Many applications have multiple
      flows of the same Flow Type and often some flows are more
      important than others.  For example, in a video conference where
      there are usually audio and video flows, the audio flow may be
      more important than the video flow.  JavaScript applications can
      tell the browser whether a particular flow is high, medium, low or
      very low importance to the application.

   [I-D.ietf-rtcweb-transports] defines in more detail what an
   individual flow is within the WebRTC context and priorities for media
   and data flows.

   Currently in WebRTC, media sent over RTP is assumed to be interactive
   [I-D.ietf-rtcweb-transports] and browser APIs do not exist to allow
   an application to to differentiate between interactive and non-
   interactive video.

5.  DSCP Mappings

   The DSCP values for each flow type of interest to WebRTC based on
   application priority are shown in the following table.  These values
   are based on the framework and recommended values in [RFC4594].  A
   web browser SHOULD use these values to mark the appropriate media
   packets.  More information on EF can be found in [RFC3246].  More
   information on AF can be found in [RFC2597].  DF is default
   forwarding which provides the basic best effort service [RFC2474].

   +------------------------+-------+------+-------------+-------------+
   |       Flow Type        |  Very | Low  |    Medium   |     High    |
   |                        |  Low  |      |             |             |
   +------------------------+-------+------+-------------+-------------+
   |         Audio          |  CS1  |  DF  |   EF (46)   |   EF (46)   |
   |                        |  (8)  | (0)  |             |             |
   |                        |       |      |             |             |
   | Interactive Video with |  CS1  |  DF  |  AF42, AF43 |  AF41, AF42 |
   |    or without Audio    |  (8)  | (0)  |   (36, 38)  |   (34, 36)  |
   |                        |       |      |             |             |
   | Non-Interactive Video  |  CS1  |  DF  |  AF32, AF33 |  AF31, AF32 |
   | with or without Audio  |  (8)  | (0)  |   (28, 30)  |   (26, 28)  |
   |                        |       |      |             |             |
   |          Data          |  CS1  |  DF  |     AF11    |     AF21    |
   |                        |  (8)  | (0)  |             |             |
   +------------------------+-------+------+-------------+-------------+

         Table 1: Recommended DSCP Values for WebRTC Applications





Jones, et al.           Expires November 21, 2016               [Page 5]

Internet-Draft                 WebRTC QoS                       May 2016


   The application priority, indicated by the columns "very low", "low",
   "Medium", and "high", signifies the relative importance of the flow
   within the application.  It is an input that the browser receives to
   assist in selecting the DSCP value and adjusting the network
   transport behavior.

   The above table assumes that packets marked with CS1 are treated as
   "less than best effort", such as the LE behavior described in
   [RFC3662].  However, the treatment of CS1 is implementation
   dependent.  If an implementation treats CS1 as other than "less than
   best effort", then the actual priority (or, more precisely, the per-
   hop-behavior) of the packets may be changed from what is intended.
   It is common for CS1 to be treated the same as DF, so applications
   and browsers using CS1 cannot assume that CS1 will be treated
   differently than DF [RFC7657].  However, it is also possible per
   [RFC2474] for CS1 traffic to be given better treatment than DF, thus
   caution should be exercised when electing to use CS1.  This is one of
   the cases where marking packets using these recommendations can make
   things worse.

   Implementers should also note that excess EF traffic is dropped.
   This could mean that a packet marked as EF may not get through,
   although the same packet marked with a different DSCP value would
   have gotten through.  This is not a flaw, but how excess EF traffic
   is intended to be treated.

   The browser SHOULD first select the flow type of the flow.  Within
   the flow type, the relative importance of the flow SHOULD be used to
   select the appropriate DSCP value.

   Currently, all WebRTC video is assumed to be interactive
   [I-D.ietf-rtcweb-transports], for which the Interactive Video DSCP
   values in Table 1 SHOULD be used.  Browsers MUST NOT use the AF3x
   DSCP values (for Non-Interactive Video in Table 1) for WebRTC
   applications.  Non-browser implementations of WebRTC MAY use the AF3x
   DSCP values for video that is known not to be interactive, e.g., all
   video in a WebRTC video playback application that is not implemented
   in a browser.

   The combination of flow type and application priority provides
   specificity and helps in selecting the right DSCP value for the flow.
   All packets within a flow SHOULD have the same application priority.
   In some cases, the selected application priority cell may have
   multiple DSCP values, such as AF41 and AF42.  These offer different
   drop precedences.  The different drop precedence values provides
   additional granularity in classifying packets within a flow.  For
   example, in a video conference the video flow may have medium
   application priority, thus either AF42 or AF43 may be selected.  More



Jones, et al.           Expires November 21, 2016               [Page 6]

Internet-Draft                 WebRTC QoS                       May 2016


   important video packets (e.g., a video picture or frame encoded
   without any dependency on any prior pictures or frames) might be
   marked with AF42 and less important packets (e.g., a video picture or
   frame encoded based on the content of one or more prior pictures or
   frames) might be marked with AF43 (e.g., receipt of the more
   important packets enables a video renderer to continue after one or
   more packets are lost).

   It is worth noting that the application priority is utilized by the
   coupled congestion control mechanism for media flows per
   [I-D.ietf-rmcat-coupled-cc] and the SCTP scheduler for data channel
   traffic per [I-D.ietf-rtcweb-data-channel].

   For reasons discussed in Section 6 of [RFC7657], if multiple flows
   are multiplexed using a reliable transport (e.g., TCP) then all of
   the packets for all flows multiplexed over that transport-layer flow
   MUST be marked using the same DSCP value.  Likewise, all WebRTC data
   channel packets transmitted over an SCTP association MUST be marked
   using the same DSCP value, regardless of how many data channels
   (streams) exist or what kind of traffic is carried over the various
   SCTP streams.  In the event that the browser wishes to change the
   DSCP value in use for an SCTP association, it MUST reset the SCTP
   congestion controller after changing values.  Frequent changes in the
   DSCP value used for an SCTP association are discouraged, though, as
   this would defeat any attempts at effectively managing congestion.
   It should also be noted that any change in DSCP value that results in
   a reset of the congestion controller puts the SCTP association back
   into slow start, which may have undesirable effects on application
   performance.

   For the data channel traffic multiplexed over an SCTP association, it
   is RECOMMENDED that the DSCP value selected be the one associated
   with the highest priority requested for all data channels multiplexed
   over the SCTP association.  Likewise, when multiplexing multiple
   flows over a TCP connection, the DCSP value selected should be the
   one associated with the highest priority requested for all
   multiplexed flows.

   If a packet enters a network that has no support for a flow type-
   application priority combination specified in Table 1 (above), then
   the network node at the edge will remark the DSCP value based on
   policies.  This could result in the flow not getting the network
   treatment it expects based on the original DSCP value in the packet.
   Subsequently, if the packet enters a network that supports a larger
   number of these combinations, there may not be sufficient information
   in the packet to restore the original markings.  Mechanisms for
   restoring such original DSCP is outside the scope of this document.




Jones, et al.           Expires November 21, 2016               [Page 7]

Internet-Draft                 WebRTC QoS                       May 2016


   In summary, DSCP marking provides neither guarantees nor promised
   levels of service.  However, DSCP marking is expected to provide a
   statistical improvement in real-time service as a whole.  The service
   provided to a packet is dependent upon the network design along the
   path, as well as the network conditions at every hop.

6.  Security Considerations

   Since the JavaScript application specifies the flow type and
   application priority that determine the media flow DSCP values used
   by the browser, the browser could consider application use of a large
   number of higher priority flows to be suspicious.  If the server
   hosting the JavaScript application is compromised, many browsers
   within the network might simultaneously transmit flows with the same
   DSCP marking.  The DiffServ architecture requires ingress traffic
   conditioning for reasons that include protecting the network from
   this sort of attack.

   Otherwise, this specification does not add any additional security
   implications beyond those addressed in the following DSCP-related
   specifications.  For security implications on use of DSCP, please
   refer to Section 7 of [RFC7657] and Section 6 of [RFC4594].  Please
   also see [I-D.ietf-rtcweb-security] as an additional reference.

7.  IANA Considerations

   This specification does not require any actions from IANA.

8.  Downward References

   This specification contains a downwards reference to [RFC4594] and
   [RFC7657].  However, the parts of the former RFC used by this
   specification are sufficiently stable for this downward reference.
   The guidance in the latter RFC is necessary to understand the
   Diffserv technology used in this document and the motivation for the
   recommended DSCP values and procedures.

9.  Acknowledgements

   Thanks to David Black, Magnus Westerlund, Paolo Severini, Jim
   Hasselbrook, Joe Marcus, Erik Nordmark, Michael Tuexen, and Brian
   Carpenter for their invaluable input.

10.  Dedication

   This document is dedicated to the memory of James Polk, a long-time
   friend and colleague.  James made important contributions to this
   specification, including serving initially as one of the primary



Jones, et al.           Expires November 21, 2016               [Page 8]

Internet-Draft                 WebRTC QoS                       May 2016


   authors.  The IETF global community mourns his loss and he will be
   missed dearly.

11.  Document History

   Note to RFC Editor: Please remove this section.

   This document was originally an individual submission in RTCWeb WG.
   The RTCWeb working group selected it to be become a WG document.
   Later the transport ADs requested that this be moved to the TSVWG WG
   as that seemed to be a better match.

12.  References

12.1.  Normative References

   [I-D.ietf-rtcweb-data-channel]
              Jesup, R., Loreto, S., and M. Tuexen, "WebRTC Data
              Channels", draft-ietf-rtcweb-data-channel-13 (work in
              progress), January 2015.

   [I-D.ietf-rtcweb-rtp-usage]
              Perkins, C., Westerlund, M., and J. Ott, "Web Real-Time
              Communication (WebRTC): Media Transport and Use of RTP",
              draft-ietf-rtcweb-rtp-usage-26 (work in progress), March
              2016.

   [I-D.ietf-rtcweb-security]
              Rescorla, E., "Security Considerations for WebRTC", draft-
              ietf-rtcweb-security-08 (work in progress), February 2015.

   [I-D.ietf-rtcweb-transports]
              Alvestrand, H., "Transports for WebRTC", draft-ietf-
              rtcweb-transports-12 (work in progress), March 2016.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/
              RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC4594]  Babiarz, J., Chan, K., and F. Baker, "Configuration
              Guidelines for DiffServ Service Classes", RFC 4594, DOI
              10.17487/RFC4594, August 2006,
              <http://www.rfc-editor.org/info/rfc4594>.







Jones, et al.           Expires November 21, 2016               [Page 9]

Internet-Draft                 WebRTC QoS                       May 2016


   [RFC7657]  Black, D., Ed. and P. Jones, "Differentiated Services
              (Diffserv) and Real-Time Communication", RFC 7657, DOI
              10.17487/RFC7657, November 2015,
              <http://www.rfc-editor.org/info/rfc7657>.

   [RFC7742]  Roach, A., "WebRTC Video Processing and Codec
              Requirements", RFC 7742, DOI 10.17487/RFC7742, March 2016,
              <http://www.rfc-editor.org/info/rfc7742>.

12.2.  Informative References

   [G.1010]   International Telecommunications Union, "End-user
              multimedia QoS categories", Recommendation ITU-T G.1010,
              November 2001.

   [I-D.ietf-rmcat-coupled-cc]
              Islam, S., Welzl, M., and S. Gjessing, "Coupled congestion
              control for RTP media", draft-ietf-rmcat-coupled-cc-02
              (work in progress), April 2016.

   [RFC2474]  Nichols, K., Blake, S., Baker, F., and D. Black,
              "Definition of the Differentiated Services Field (DS
              Field) in the IPv4 and IPv6 Headers", RFC 2474, DOI
              10.17487/RFC2474, December 1998,
              <http://www.rfc-editor.org/info/rfc2474>.

   [RFC2597]  Heinanen, J., Baker, F., Weiss, W., and J. Wroclawski,
              "Assured Forwarding PHB Group", RFC 2597, DOI 10.17487/
              RFC2597, June 1999,
              <http://www.rfc-editor.org/info/rfc2597>.

   [RFC3246]  Davie, B., Charny, A., Bennet, J., Benson, K., Le Boudec,
              J., Courtney, W., Davari, S., Firoiu, V., and D.
              Stiliadis, "An Expedited Forwarding PHB (Per-Hop
              Behavior)", RFC 3246, DOI 10.17487/RFC3246, March 2002,
              <http://www.rfc-editor.org/info/rfc3246>.

   [RFC3550]  Schulzrinne, H., Casner, S., Frederick, R., and V.
              Jacobson, "RTP: A Transport Protocol for Real-Time
              Applications", STD 64, RFC 3550, DOI 10.17487/RFC3550,
              July 2003, <http://www.rfc-editor.org/info/rfc3550>.

   [RFC3662]  Bless, R., Nichols, K., and K. Wehrle, "A Lower Effort
              Per-Domain Behavior (PDB) for Differentiated Services",
              RFC 3662, DOI 10.17487/RFC3662, December 2003,
              <http://www.rfc-editor.org/info/rfc3662>.





Jones, et al.           Expires November 21, 2016              [Page 10]

Internet-Draft                 WebRTC QoS                       May 2016


Authors' Addresses

   Paul E. Jones
   Cisco Systems

   Email: paulej@packetizer.com


   Subha Dhesikan
   Cisco Systems

   Email: sdhesika@cisco.com


   Cullen Jennings
   Cisco Systems

   Email: fluffy@cisco.com


   Dan Druta
   AT&T

   Email: dd5826@att.com



























Jones, et al.           Expires November 21, 2016              [Page 11]
