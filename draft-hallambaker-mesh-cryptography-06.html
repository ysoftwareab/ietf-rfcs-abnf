<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Mathematical Mesh 3.0 Part VIII: Cryptographic Algorithms</title>
<meta content="Phillip Hallam-Baker" name="author">
<meta content="
       The Mathematical Mesh 'The Mesh' is an infrastructure that facilitates the exchange of configuration and credential data between multiple user devices and provides end-to-end security. This document describes the cryptographic algorithm suites used in the Mesh and the implementation of Multi-Party Encryption and Multi-Party Key Generation used in the Mesh. 
       [Note to Readers] 
       Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh. 
       This document is also available online at  . 
    " name="description">
<meta content="xml2rfc 2.47.0" name="generator">
<meta content="draft-hallambaker-mesh-cryptography-06" name="ietf.draft">
<link href="/tmp/draft-hallambaker-mesh-cryptography-06-wact3vhq.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Mesh Cryptographic Algorithms</td>
<td class="right">July 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hallam-Baker</td>
<td class="center">Expires 28 January 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hallambaker-mesh-cryptography</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-07-27" class="published">27 July 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-01-28">28 January 2021</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. M. Hallam-Baker</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Mathematical Mesh 3.0 Part VIII: Cryptographic Algorithms</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Mathematical Mesh 'The Mesh' is an infrastructure that facilitates the exchange of configuration and credential data between multiple user devices and provides end-to-end security. This document describes the cryptographic algorithm suites used in the Mesh and the implementation of Multi-Party Encryption and Multi-Party Key Generation used in the Mesh.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">[Note to Readers]<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This document is also available online at <span><a href="http://mathmesh.com/Documents/draft-hallambaker-mesh-cryptography.html">http://mathmesh.com/Documents/draft-hallambaker-mesh-cryptography.html</a></span>.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 January 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-defined-terms" class="xref">Defined Terms</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-related-specifications" class="xref">Related Specifications</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-recommended-and-required-al" class="xref">Recommended and Required Algorithms</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-mesh-device" class="xref">Mesh Device</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-constrained-device" class="xref">Constrained Device</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-multi-party-cryptography" class="xref">Multi-Party Cryptography</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-application-to-diffie-hellm" class="xref">Application to Diffie Hellman (not normative)</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-multi-party-key-generation" class="xref">Multi-Party Key Generation</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-multi-party-decryption" class="xref">Multi-Party Decryption</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-mutually-authenticated-key-" class="xref">Mutually Authenticated Key Exchange.</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-implementation" class="xref">Implementation</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="xref">4.5.1</a>.  <a href="#name-implementation-for-ed25519-" class="xref">Implementation for Ed25519 and Ed448</a><a href="#section-toc.1-1.4.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="xref">4.5.2</a>.  <a href="#name-implementation-for-x25519-a" class="xref">Implementation for X25519 and X448</a><a href="#section-toc.1-1.4.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-multi-party-key-generation-2" class="xref">Multi-Party Key Generation</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-example-provisioning-the-co" class="xref">Example: Provisioning the Confirmation Service</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-multi-party-decryption-2" class="xref">Multi-Party Decryption</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-mechanism" class="xref">Mechanism</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-implementation-2" class="xref">Implementation</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-group-creation" class="xref">Group Creation</a><a href="#section-toc.1-1.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-provisioning-a-member" class="xref">Provisioning a Member</a><a href="#section-toc.1-1.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-message-encryption-and-decr" class="xref">Message Encryption and Decryption</a><a href="#section-toc.1-1.6.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-example-messaging-group" class="xref">Example: Messaging group</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-mutually-authenticated-key-a" class="xref">Mutually Authenticated Key Agreement</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-key-combination" class="xref">Key Combination</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-11.1.1" class="xref">11.1.1</a>.  <a href="#name-ed25519" class="xref">Ed25519</a><a href="#section-toc.1-1.11.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a href="#section-11.1.2" class="xref">11.1.2</a>.  <a href="#name-ed448" class="xref">Ed448</a><a href="#section-toc.1-1.11.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1.2.3">
                    <p id="section-toc.1-1.11.2.1.2.3.1"><a href="#section-11.1.3" class="xref">11.1.3</a>.  <a href="#name-x25519" class="xref">X25519</a><a href="#section-toc.1-1.11.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1.2.4">
                    <p id="section-toc.1-1.11.2.1.2.4.1"><a href="#section-11.1.4" class="xref">11.1.4</a>.  <a href="#name-x448" class="xref">X448</a><a href="#section-toc.1-1.11.2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-group-encryption" class="xref">Group Encryption</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-11.2.1" class="xref">11.2.1</a>.  <a href="#name-x25519-2" class="xref">X25519</a><a href="#section-toc.1-1.11.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#section-11.2.2" class="xref">11.2.2</a>.  <a href="#name-x448-2" class="xref">X448</a><a href="#section-toc.1-1.11.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="n-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes the cryptographic algorithm suites used in the Mesh and the implementation of Multi-Party Encryption and Multi-Party Key Generation used in the Mesh.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">To allow use of Mesh capabilities on the least capable computing devices currently in use, separate schedules of recommended and required algorithms are specified for Standard Devices and Constrained Devices.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The Constrained device class may be considered to include most 8-bit CPUs equipped with sufficient memory to support the necessary operations. For example an Ardunino Mega 2560 which can perform ECDH key agreement and signature operations in times ranging from 3 to 8 seconds. While such a device is clearly not suited to perform such operations routinely, a one-time connection process that takes several minutes to complete need not be of major concern.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The Standard device class may be considered to include the vast majority of general purpose and personal computing devices manufactured since 2010. Even a Raspberry Pi Zero which currently retails at $5 is capable of performing the cryptographic functions required to implement the Mesh with negligible impact on the user.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-definitions">
<section id="section-2">
      <h2 id="name-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
      </h2>
<p id="section-2-1">This section presents the related specifications and standard, the terms that are used as terms of art within the documents and the terms used as requirements language.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="n-requirements-language">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-defined-terms">
<section id="section-2.2">
        <h3 id="name-defined-terms">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-defined-terms" class="section-name selfRef">Defined Terms</a>
        </h3>
<p id="section-2.2-1">The terms of art used in this document are described in the <em>Mesh Architecture Guide</em> <span>[<a href="#draft-hallambaker-mesh-architecture" class="xref">draft-hallambaker-mesh-architecture</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-related-specifications">
<section id="section-2.3">
        <h3 id="name-related-specifications">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-related-specifications" class="section-name selfRef">Related Specifications</a>
        </h3>
<p id="section-2.3-1">The architecture of the Mathematical Mesh is described in the <em>Mesh Architecture Guide</em> <span>[<a href="#draft-hallambaker-mesh-architecture" class="xref">draft-hallambaker-mesh-architecture</a>]</span>. The Mesh documentation set and related specifications are described in this document.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-implementation-status">
<section id="section-2.4">
        <h3 id="name-implementation-status">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
        </h3>
<p id="section-2.4-1">The implementation status of the reference code base is described in the companion document <span>[<a href="#draft-hallambaker-mesh-developer" class="xref">draft-hallambaker-mesh-developer</a>]</span>.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-recommended-and-required-algorithms">
<section id="section-3">
      <h2 id="name-recommended-and-required-al">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-recommended-and-required-al" class="section-name selfRef">Recommended and Required Algorithms</a>
      </h2>
<p id="section-3-1">To allow implementation of Mesh capabilities on the widest possible range of devices, separate algorithm requirements and recommendations are specified for four classes of device:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">Administration Device</dt>
        <dd id="section-3-2.2">
          <p id="section-3-2.2.1">A general-purpose computing device that is used for Mesh administration functions.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">Mesh Device</dt>
        <dd id="section-3-2.4">
          <p id="section-3-2.4.1">A general-purpose computing device that is not used for Mesh administration functions with sufficient memory and processing power to perform public key cryptography operations without paying particular attention to the impact on performance.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">Constrained Device</dt>
        <dd id="section-3-2.6">
          <p id="section-3-2.6.1">An embedded computing device with limited memory and computing power that offers sufficient processing capabilities to perform occasional public key operations (e.g. during device initialization) but is not suited to repeated operations.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.7">Bridge Device</dt>
        <dd id="section-3-2.8">
          <p id="section-3-2.8.1">A trusted device that enables Mesh Devices to interoperate with Constrained devices.<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-3">Since Administration Devices and Mesh Devices <span class="bcp14">MUST</span> support communication with Mesh Devices and Constrained devices, they <span class="bcp14">MUST</span> meet all the <span class="bcp14">REQUIRED</span> algorithms for both types of device.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="n-mesh-device">
<section id="section-3.1">
        <h3 id="name-mesh-device">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-mesh-device" class="section-name selfRef">Mesh Device</a>
        </h3>
<p id="section-3.1-1">Support for the following algorithms is <span class="bcp14">REQUIRED</span>:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">SHA-2-512 <span>[<a href="#SHA-2" class="xref">SHA-2</a>]</span><a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">HMAC-SHA-2-512 <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span><a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">HMAC-based Extract-and-Expand Key Derivation Function <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span><a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.4">AES-CBC-256 Encryption <span>[<a href="#FIPS197" class="xref">FIPS197</a>]</span><a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.5">Advanced Encryption Standard (AES) Key Wrap Algorithm <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span><a href="#section-3.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.6">Montgomery Curve Diffie-Hellman Key Agreement X25519 and X448 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span><a href="#section-3.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.7">Edwards-Curve Digital Signature Algorithm Ed25519 and Ed448 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-3.1-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">Support for the following algorithms is <span class="bcp14">RECOMMENDED</span>:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">AES-GCM-256 Encryption <span>[<a href="#AES-GCM" class="xref">AES-GCM</a>]</span><a href="#section-3.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.2">SHA-3-512 <span>[<a href="#SHA-3" class="xref">SHA-3</a>]</span><a href="#section-3.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.3">KMAC SHA-3-512 <span>[<a href="#SHA-3-Derived" class="xref">SHA-3-Derived</a>]</span><a href="#section-3.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-5">While the use of GCM is generally preferred over CBC mode in IETF security protocols, this mode is not currently supported by the reference implementation platform.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-constrained-device">
<section id="section-3.2">
        <h3 id="name-constrained-device">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-constrained-device" class="section-name selfRef">Constrained Device</a>
        </h3>
<p id="section-3.2-1">Support for the following algorithms is <span class="bcp14">REQUIRED</span>:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">SHA-2-512 <span>[<a href="#SHA-2" class="xref">SHA-2</a>]</span><a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.2">HMAC-SHA-2-512 <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span><a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.3">HMAC-based Extract-and-Expand Key Derivation Function <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span><a href="#section-3.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.4">Poly1035 Authenticated Encryption <span>[<a href="#RFC8439" class="xref">RFC8439</a>]</span><a href="#section-3.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.5">ChaCha20 Encryption <span>[<a href="#RFC8439" class="xref">RFC8439</a>]</span><a href="#section-3.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.6">Advanced Encryption Standard (AES) Key Wrap Algorithm <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span><a href="#section-3.2-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.7">Edwards-Curve Digital Signature Algorithm Ed25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-3.2-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.8">Edwards-Curve Diffie-Hellman Key Agreement Ed25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-3.2-2.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-3">Use of the Edwards Curves for Signature and Key Agreement allows both functions to be supported by a single library with no reduction in security.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-multiparty-cryptography">
<section id="section-4">
      <h2 id="name-multi-party-cryptography">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-multi-party-cryptography" class="section-name selfRef">Multi-Party Cryptography</a>
      </h2>
<p id="section-4-1">The multi-party key generation and multi-party decryption mechanisms used in the Mesh protocols are made possible by the fact that Diffie Hellman key agreement and elliptic curve variants thereof support properties we call the Key Combination Law and the Result Combination Law.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Let {<em>X</em>, <em>x</em>}, {<em>Y</em>, <em>y</em>}, {<em>E</em>, <em>e</em>} be {public, private} key pairs.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The Key Combination law states that we can define an operator ? such that there is a keypair {<em>Z</em>, <em>z</em>} such that:<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4"><em>Z</em> = <em>X</em> ? <em>Y</em> and <em>z</em> = (<em>x</em> + <em>y</em>) mod <em>o</em> (where <em>o</em> is the order of the group)<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The Result Combination Law states that we can define an operator ? such that:<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">(<em>x</em> ? <em>E</em>) ? (<em>y</em> ? <em>E</em>) = (<em>z</em> ? <em>E</em>) = (<em>e</em> ? <em>Z</em>).<a href="#section-4-6" class="pilcrow">¶</a></p>
<div id="n-application-to-diffie-hellman-not-normative">
<section id="section-4.1">
        <h3 id="name-application-to-diffie-hellm">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-application-to-diffie-hellm" class="section-name selfRef">Application to Diffie Hellman (not normative)</a>
        </h3>
<p id="section-4.1-1">For the Diffie Hellman system in a modular field p, o = p-1 and <em>a </em>? <em>b</em> = <em>a </em>? <em>b</em> = <em>a</em>.<em>b </em>mod <em>p</em>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2"><em>Proof:</em><a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">By definition, X = e<sup>x</sup> mod p, Y = e<sup>y</sup> mod p, and Z = e<sup>z </sup>mod p.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Therefore,<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">Z = e<sup>z</sup> mod p = e<sup>x+y</sup> mod p = (e<sup>x</sup>e<sup>y</sup>) mod p = e<sup>x </sup>mod p.e<sup>y</sup> mod p = X.Y<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">A similar proof may be constructed for the operator ?.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-multiparty-key-generation">
<section id="section-4.2">
        <h3 id="name-multi-party-key-generation">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-multi-party-key-generation" class="section-name selfRef">Multi-Party Key Generation</a>
        </h3>
<p id="section-4.2-1">The Key Combination Law provides the basis for the Key Co-Generation technique used to ensure that the cryptographic keys used in devices connected to a Mesh profile are sufficiently random and have not been compromised by malware or other 'backdoor' compromise to the machine during or after manufacture.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">For the Diffie Hellman system, the Key Combination law provides all the mechanism needed to implement a Key Co-Generation mechanism. If the Device key is {<em>X</em>, <em>x</em>},  the administration device can generate a Co-Generation Key Pair {<em>Y</em>, <em>y</em>} and generate a Device Connection Assertion for the final public key E calculated from knowledge of X and Y alone. Passing the value <em>y</em> to the device (using a secure channel) allows it to calculate the corresponding private key <em>e</em> required to make use of the Device Connection Assertion.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">This approach ensures that a party with knowledge of either <em>x</em> or <em>y</em> but not both obtains no knowledge of <em>e</em>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Section  REF _Ref5309729 \w \h 5 describes the implementation of these schemes in the Mesh<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-multiparty-decryption">
<section id="section-4.3">
        <h3 id="name-multi-party-decryption">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-multi-party-decryption" class="section-name selfRef">Multi-Party Decryption</a>
        </h3>
<p id="section-4.3-1">The Key Combination Law and Result Combination Law provide the basis for the Multi-Party Decryption technique used to support Mesh Encryption Groups.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Section  REF _Ref5309538 \w \h 6 describes the application of this technique in the Mesh<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-mutually-authenticated-key-exchange">
<section id="section-4.4">
        <h3 id="name-mutually-authenticated-key-">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-mutually-authenticated-key-" class="section-name selfRef">Mutually Authenticated Key Exchange.</a>
        </h3>
<p id="section-4.4-1">The Result Combination Law is used to provide a Key Exchange mechanism that provides mutual authentication of the parties while preserving forward secrecy.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-implementation">
<section id="section-4.5">
        <h3 id="name-implementation">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-implementation" class="section-name selfRef">Implementation</a>
        </h3>
<p id="section-4.5-1">For elliptic curve cryptosystems, the operators ? and ? are point addition.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">Implementing a robust Key Co-Generation for the Elliptic Curve Cryptography schemes described in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> and <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> requires some additional considerations to be addressed.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-3.1">The secret scalar used in the EdDSA algorithm is calculated from the private key using a digest function. It is therefore necessary to specify the Key Co-Generation mechanism by reference to operations on the secret scalar values rather than operations on the private keys.<a href="#section-4.5-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-3.2">The Montgomery Ladder traditionally used to perform X25519 and X448 point multiplication does not require implementation of a function to add two arbitrary points. While the steps required to create such a function are fully constrained by the specification, the means of satisfying the constraints is not.<a href="#section-4.5-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="n-implementation-for-ed25519-and-ed448">
<section id="section-4.5.1">
          <h4 id="name-implementation-for-ed25519-">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-implementation-for-ed25519-" class="section-name selfRef">Implementation for Ed25519 and Ed448</a>
          </h4>
<p id="section-4.5.1-1">The data structures used to implement co-generation of public keys are defined in the main Mesh Reference Guide. This document describes only the additional implementation details.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">Note that the 'private key' described in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> is in fact a seed used to generate a 'secret scalar' value that is the value that has the function of being the private key in the ECDH algorithm.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.1-3">To provision a new public key to a device, the provisioning device:<a href="#section-4.5.1-3" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-4.5.1-4">
            <li id="section-4.5.1-4.1">Obtains the device profile of the device(s) to be provisioned to determine the type of key to perform co-generation for. Let the device {public, private} key be {D, d}.<a href="#section-4.5.1-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.1-4.2">Generates a private key <em>m</em> with the specified number of bytes (32 or 57].<a href="#section-4.5.1-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.1-4.3">Calculates the corresponding public key <em>M</em>.<a href="#section-4.5.1-4.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.1-4.4">Calculates the Application public key A = D+M where + is point addition.<a href="#section-4.5.1-4.4" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.1-4.5">Constructs the application device entry containing the private key value m and encrypts under the device encryption key d.<a href="#section-4.5.1-4.5" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.5.1-5">On receipt, the device may at its option use its knowledge of the secret scalar corresponding to d and m to calculate the application secret scalar a or alternatively maintain the two secrets separately and make use of the result combination law to perform private key operations.<a href="#section-4.5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-implementation-for-x25519-and-x448">
<section id="section-4.5.2">
          <h4 id="name-implementation-for-x25519-a">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-implementation-for-x25519-a" class="section-name selfRef">Implementation for X25519 and X448</a>
          </h4>
<p id="section-4.5.2-1">While the point addition function can be defined for any elliptic curve system, it is not necessary to implement point addition to support ECDH key agreement.<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2-2">In particular, point multiplication using the Montgomery ladder technique over Montgomery curves only operate on the x co-ordinate and only require point doubling operations.<a href="#section-4.5.2-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2-3">For expediency, the current implementation of the Mesh reference code uses the Edwards curves for both signature and encryption pending announcement of platform support for both algorithms.<a href="#section-4.5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-multiparty-key-generation-0">
<section id="section-5">
      <h2 id="name-multi-party-key-generation-2">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-multi-party-key-generation-2" class="section-name selfRef">Multi-Party Key Generation</a>
      </h2>
<p id="section-5-1">Multi-Party Key Generation is a capability that is used in the Mesh to enable provisioning of application specific private key pairs to connected devices without revealing any information concerning the application private key of the device.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">For example, Alice provisions the confirmation service to her watch. The provisioning device could generate a signature key for the device and encrypt it under the encryption key of the device. But this means that we cannot attribute signatures to the watch with absolute certainty as the provisioning device has had knowledge of the watch signature key. Nor do we wish to use the device signature key for the confirmation service.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Multi-Party Key Generation allows an administration device to provision a connected device with an application specific private key that is specific to that application and no other such that the application can determine the public key of the device but has no knowledge of the private key.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Provisioning an application private key to a device requires the administration device to:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">Generate a new application public key for the device.<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.2">Construct and publish whatever application specific credentials the device requires to use the application.<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.3">Providing the information required to make use of the private key to the device.<a href="#section-5-5.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-6">Note that while the administration device needs to know the device application public key, it does not require knowledge of the device application private key.<a href="#section-5-6" class="pilcrow">¶</a></p>
<div id="n-example-provisioning-the-confirmation-service-">
<section id="section-5.1">
        <h3 id="name-example-provisioning-the-co">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-example-provisioning-the-co" class="section-name selfRef">Example: Provisioning the Confirmation Service</a>
        </h3>
<p id="section-5.1-1">For example, Alice provisions the confirmation service to her watch. The device profile of the watch specifies an Ed25519 signature key. Note that for production use, Ed448 is almost certainly prefered but Ed25519 has the advantage of more compact presentation.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="section-5.1-2">
<pre class="sourcecode">Device Key

UDF Seed:       ZAAA-G4F5-G34W-HHLC-24AP-SZKI-VGO7-UHI
Private Key:
  B7 48 FF 8A  1B D2 04 BC  BA 53 70 80  91 66 08 8E
  26 15 B5 52  ED C9 C4 CE  80 D7 75 A6  BD A9 4A 1C
Secret Scalar:
561256512376003542287986996396194037798558214965969766613823935719031
    34631504
Public Key:
  2B B3 8F D1  93 16 E1 5E  24 44 BA 82  9F 4A D3 7D
  F6 7F B5 A0  92 65 A1 7B  F4 8C B6 51  6D F3 9F DC
Fingerprint:    MANZ-N7DM-BYZH-EQIO-E7YL-C6SX-GONP</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">The provisioning device could generate a signature key for the device and encrypt it under the encryption key of the device. But this means that we cannot attribute signatures to the watch with absolute certainty as the provisioning device has had knowledge of the  watch signature key. Nor do we wish to use the device signature key for the confirmation service.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Instead, the provisioning device generates an overlay keypair:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div id="section-5.1-5">
<pre class="sourcecode">Device Key

UDF Seed:       ZAAA-HIGJ-GGBY-NTBF-YS2T-ABNO-4WT2-SIY
Private Key:
  F9 44 69 38  A7 E2 52 A1  F6 1D 9D 9B  29 D1 5D 52
  77 23 26 0C  AF F3 14 A6  4E 95 CB 76  5B 24 B1 67
Secret Scalar:
494374318308300050435542868433885510572653196058722477545726317545719
    97461496
Public Key:
  C7 EF 8B 19  BE D9 E7 F7  45 17 73 8E  B3 92 6E 86
  C2 0F A4 06  84 58 BF 3B  FE EE 87 A5  B8 EB 62 0A
Fingerprint:    MBQO-UETO-EL5H-EQBI-PM4Y-QOE7-E6PH</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1-6">The provisioning device can calculate the public key of the composite keypair by adding the public keys of the device profile and the companion public key:<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div id="section-5.1-7">
<pre class="sourcecode">Composite public key = Device + Overlay:
  0A FD 34 5B  D7 49 47 BF  C3 CC 2E 4B  AB A6 BF FE
  E1 7A B1 3C  74 C6 49 EE  04 9C FF C0  4B D3 05 F6
Fingerprint:    MBAK-3KK5-F3AN-E6AJ-EIIT-IIL6-7KTP</pre><a href="#section-5.1-7" class="pilcrow">¶</a>
</div>
<p id="section-5.1-8">The provisioning device encrypts the private key of the comanion keypair (or the seed from which it was generated) under the encryption key of the device.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">The provisioning device calculates the private key of the composite keypair by  adding the two private key values modulo the order of the group and verifies that scalar  multiplication of the base point returns the composite public key value.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<div id="section-5.1-10">
<pre class="sourcecode">Composite Secret Scalar = Device + Overlay:
369621881521677524799960083359389394685489760249533923273552306952445
    5498173
Fingerprint:    MBAK-3KK5-F3AN-E6AJ-EIIT-IIL6-7KTP</pre><a href="#section-5.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="n-multiparty-decryption-0">
<section id="section-6">
      <h2 id="name-multi-party-decryption-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-multi-party-decryption-2" class="section-name selfRef">Multi-Party Decryption</a>
      </h2>
<p id="section-6-1">A key limitation of most deployed messaging systems is that true end-to-end confidentiality is only achieved for a limited set of communication patterns. Specifically, bilateral communications (Alice sends a message to Bob) or broadcast communications to a known set of recipients (Alice sends a message to Bob, Carol and Doug). These capabilities do not support communication patterns where the set of recipients changes over time or is confidential. Yet such requirements commonly occur in situations such as sending a message to a mailing list whose membership isn't known to the sender, or creating a spreadsheet whose readership is to be limited to authorized members of the 'accounting' team.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The mathematical approach that makes key co-generation possible may be applied to support a public key encryption mode in which encryption is performed as usual but decryption requires the use of multiple keys. This approach is variously described in the literature as distributed key generation and proxy re-encryption <span>[<a href="#Blaze98" class="xref">Blaze98</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The approach specified in this document borrows aspects of both these techniques. This combined approach is called 'recryption'. Using recryption allows a sender to send a message to a group of users whose membership is not known to the sender at the time the message is sent and can change at any time.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Proxy re-encryption provides a technical capability that meets the needs of such communication patterns. Conventional symmetric key cryptography uses a single key to encrypt and decrypt data. Public key cryptography uses two keys, the key used to encrypt data is separate from the key used to decrypt. Proxy re-encryption introduces a third key (the recryption key) that allows a party to permit an encrypted data packet to be decrypted using a different key without permitting the data to be decrypted.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">The introduction of a recryption key permits end-to-end confidentiality to be preserved when a communication pattern requires that some part of the communication be supported by a service.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">The introduction of a third type of key, the recryption key permits two new roles to be established, that of an administrator and recryption service. There are thus four parties:<a href="#section-6-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-7">
        <dt id="section-6-7.1">Administrator </dt>
        <dd id="section-6-7.2">
          <p id="section-6-7.2.1">Holder of Decryption Key, Creator of Recryption Keys<a href="#section-6-7.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-7.3">Sender </dt>
        <dd id="section-6-7.4">
          <p id="section-6-7.4.1">Holder of Encryption Key<a href="#section-6-7.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-7.5">Recryption Service </dt>
        <dd id="section-6-7.6">
          <p id="section-6-7.6.1">Holder of Recryption keys<a href="#section-6-7.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-7.7">Receiver </dt>
        <dd id="section-6-7.8">
          <p id="section-6-7.8.1">Holder of personal decryption key<a href="#section-6-7.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-8">The information stored at the recryption service is necessary but not sufficient to decrypt the message. Thus, no disclosure of the message plaintext occurs even in the event that an attacker gains full knowledge of all the information stored by the recryption service.<a href="#section-6-8" class="pilcrow">¶</a></p>
<div id="n-mechanism">
<section id="section-6.1">
        <h3 id="name-mechanism">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-mechanism" class="section-name selfRef">Mechanism</a>
        </h3>
<p id="section-6.1-1">The mechanism used to support recryption is the same as the mechanism used to support key co-generation except that this time, instead of combining two keys to create one, the private component of a decryption key (i.e. the private key) is split into two parts, a recryption key and a decryption key.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Recall that the key combination law for Diffie Hellman crypto-systems states that we can add two private keys to get a third. It follows that we can split the private key portion of a keypair {<em>G</em>, <em>g</em>} into two parts by choosing a random number that is less than the order of the Diffie-Hellman group to be our first key <em>x</em>. Our second key is <em>y</em> = <em>g</em> - <em>r</em> mod <em>o</em>, where <em>o</em> is the order of the group.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Having generated <em>x</em>, <em>y</em>, we can use these to perform private key agreement operations on a public key <em>E</em> and then use the result combination law to obtain the same result that we would have obtained using <em>g</em>.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">One means of applying this mechanism to recryption would be to generate a different random value x for each member of the group and store it at the recryption service and communicate the value y to the member via a secure channel. Applying this approach, we can clearly see that the recryption service gains no information about the value of the private key since the only information it holds is a random number which could have been generated without any knowledge of the group private key.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5"><span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> requires that implementations derive the scalar secret by taking a cryptographic digest of the private key. This means that either the client or the service must use a non-compliant implementation. Given this choice, it is preferable to require that the non-standard implementation be required at the service rather than the client. This limits the scope of the non-conformant key derivation approach to the specialist recryption service and ensures that the client enforce the requirement to generate the private key component by means of a digest.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-implementation-0">
<section id="section-6.2">
        <h3 id="name-implementation-2">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-implementation-2" class="section-name selfRef">Implementation</a>
        </h3>
<p id="section-6.2-1">Implementation of recryption in the Mesh has four parts:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">Creation and management of the recryption group.<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.2">Provisioning of members to a recryption group.<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.3">Message encryption.<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.4">Message decryption.<a href="#section-6.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-3">These operations are all performed using the same catalog and messaging infrastructure provided by the Mesh for other purposes.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Each recryption group has its own independent Mesh account. This has many advantages:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-5.1">Administration of the recryption group may be spread across multiple Mesh users or transferred from one user to another without requiring specification of a separate management protocol to support these operations.<a href="#section-6.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-5.2">The recryption account address can be used by Mesh applications such as group messaging, conferencing, etc. as a contact address.<a href="#section-6.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-5.3">The contact request service can be used to notify members that they have been granted membership in the group.<a href="#section-6.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<div id="n-group-creation">
<section id="section-6.2.1">
          <h4 id="name-group-creation">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-group-creation" class="section-name selfRef">Group Creation</a>
          </h4>
<p id="section-6.2.1-1">Creation of a Recryption group requires the steps of:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-2.1">Generating the recryption group key pair<a href="#section-6.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-2.2">Creating the recryption group account<a href="#section-6.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-2.3">Generating administrator record for each administrator.<a href="#section-6.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-2.4">Publishing the administrator records to the recryption catalog.<a href="#section-6.2.1-2.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-3">Note that in principle, we could make use of the key combination law to enable separation of duties controls on administrators so that provisioning of members required multiple administrators to participate in the process. This is left to future versions.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-provisioning-a-member">
<section id="section-6.2.2">
          <h4 id="name-provisioning-a-member">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-provisioning-a-member" class="section-name selfRef">Provisioning a Member</a>
          </h4>
<p id="section-6.2.2-1">To provision a user as a member of the recryption group, the administrator requires their current recryption profile. The administrator <span class="bcp14">MAY</span> obtain this by means of a contact service request. As with any contact service request, this request is subject to access control and <span class="bcp14">MAY</span> require authorization by the intended user before the provisioning can proceed.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">Having obtained the user's recryption profile, the administration tool generates a decryption private key for the user and encrypts it under the member's key to create the encrypted decryption key entry.<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2.2-3">The administration tool then computes the secret scalar from the private key and uses this together with the secret scalar of the recryption group to compute the recryption key for the member. This value and the encrypted decryption key entry are combined to form the recryption group membership record which is published to the catalog.<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-message-encryption-and-decryption">
<section id="section-6.2.3">
          <h4 id="name-message-encryption-and-decr">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-message-encryption-and-decr" class="section-name selfRef">Message Encryption and Decryption</a>
          </h4>
<p id="section-6.2.3-1">Encryption of a messages makes use of DARE Message in exactly the same manner as any other encryption. The sole difference being that the recipient entry for the recryption operation <span class="bcp14">MUST</span> specify the recryption group address an not just the key fingerprint. This allows the recipient to determine which recryption service to contact to perform the recryption operation.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2">To decrypt a message, the recipient makes an authenticated recryption request to the specified recryption service specifying:<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.3-3.1">The recipient entry to be used for decryption<a href="#section-6.2.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.3-3.2">The fingerprint of the decryption key(s) the device would like to make use of.<a href="#section-6.2.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.3-3.3">Whether or not the encrypted decryption key entry should be returned.<a href="#section-6.2.3-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.3-4">The recryption service searches the catalog for the corresponding recryption group to find a matching entry. If found and if the recipient and proposed decryption key are dully authorized for the purpose, the service performs the key agreement operation using the recryption key specified in the entry and returns the result to the recipient.<a href="#section-6.2.3-4" class="pilcrow">¶</a></p>
<p id="section-6.2.3-5">The recipient then decrypts the recryption data entry using its device decryption key and uses the group decryption key to calculate the other half of the result. The two halves of the result are then added to obtain the key agreement value that is then used to decrypt the message.<a href="#section-6.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-example-messaging-group-">
<section id="section-6.3">
        <h3 id="name-example-messaging-group">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-example-messaging-group" class="section-name selfRef">Example: Messaging group</a>
        </h3>
<p id="section-6.3-1">NB: The current code implements encryption in the Elliptic Curve Ed25519, not the Montgomery Curve X.25519 as it should. This will be lifted in the near future.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Alice creates an encryption keypair.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div id="section-6.3-3">
<pre class="sourcecode">Group Key:
  51 C5 D1 84  5F C3 31 97  D3 80 2A 25  CE 7F 82 AF
  F0 30 5B 7D  52 D0 B6 CE  3C 1C 95 A0  33 CB 89 98
Value:
322319593526028683147256399641007608894514778179691781946528967784218
    52742616</pre><a href="#section-6.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.3-4">To verify the proper function of the group, Alice creates a test message and  encrypts it under the group key.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<div id="section-6.3-5">
<pre class="sourcecode">Message = This is a test as UTF8:
  54 68 69 73  20 69 73 20  61 20 74 65  73 74

[{
    "enc": "A256CBC",
    "Salt": "KDsofrPkFsnlhRsVaxPvvA",
    "recipients": [{
        "kid": "MCGR-HO5N-2FPS-VUFQ-DEKF-7TRA-JHM6",
        "epk": {
          "PublicKeyECDH": {
            "crv": "Ed25519",
            "Public": "wKdpaMbC5sF8moAusBtJlZ9XRetMzOhfb3pnW0F_uIw"}}
                ,
        "wmk": "Z0JQvs1BtVDcRDow6hDV47wPiymwn0ybJEXkteYbaSNByhLxGKf3c
            A"}]},
  "SUXu-b3kAgMzly2_HQZjGg"]</pre><a href="#section-6.3-5" class="pilcrow">¶</a>
</div>
<p id="section-6.3-6">Alice decides to add Bob to the group. She creates an encryption key for Bob: The decryption key is specified in the same way as any other Ed25519 private key using the hash of a private key seed value:<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<div id="section-6.3-7">
<pre class="sourcecode">Bob's Member Key:
  C1 3D 09 F2  D0 46 2B ED  34 43 A2 06  EB C9 C5 6D
  68 92 08 3C  31 FC E7 35  EB 3D 65 82  82 66 92 1C
Value:
397652973877671772297984793967578734933293251919295536394239116455044
    36683984</pre><a href="#section-6.3-7" class="pilcrow">¶</a>
</div>
<p id="section-6.3-8">The the recryption key is the group secret scalar minus (mod p) the secret scalar of Bob's private key:<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<div id="section-6.3-9">
<pre class="sourcecode">Bob's Service Key:
   [Not specified as a digest input value]
Value:
694067311950021551287353369342887587783638534479943976723288700948832
    4560610</pre><a href="#section-6.3-9" class="pilcrow">¶</a>
</div>
<p id="section-6.3-10">To decrypt:<a href="#section-6.3-10" class="pilcrow">¶</a></p>
<div id="section-6.3-11">
<pre class="sourcecode">Member Agreement Value:
  B2 DB FC 97  A5 D9 14 FB  B9 47 85 A0  DF 74 44 31
  0B 28 64 EE  6C C3 97 BF  FA 6A 39 05  16 07 70 0F

Service Agreement Value:
  74 E2 28 0B  FF 65 50 5B  A9 10 87 14  0C C8 91 DB
  6B FE CF 82  CC C9 10 C0  0E 93 05 14  CD 81 28 39

Key Agreement IKM:
  2A 22 97 20  56 77 8D 13  F1 35 C9 5E  5A 5B 93 B0
  4A 18 D5 90  B2 C6 40 3F  9F 2A 9E 3D  9E D3 E4 49</pre><a href="#section-6.3-11" class="pilcrow">¶</a>
</div>
<p id="section-6.3-12">This value allows the test message to be decrypted.<a href="#section-6.3-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-mutually-authenticated-key-agreement">
<section id="section-7">
      <h2 id="name-mutually-authenticated-key-a">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-mutually-authenticated-key-a" class="section-name selfRef">Mutually Authenticated Key Agreement</a>
      </h2>
<p id="section-7-1">Diffie Hellman key agreement using the authenticated public keys of the principals provides mutual authentication of those principals.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">For example, if Alice's key pair is {<em>a</em>, <em>A</em>} and Bob's key pair is {<em>b</em>, <em>B</em>}, the Diffie Hellman key agreement value <em>DH</em> (<em>a</em>, <em>B</em>) = <em>DH</em> (<em>b</em>, <em>A</em>) can only be generated from the public information if <em>a</em> or <em>b</em> is known.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The chief disadvantage of this approach is that it only allows Alice and Bob to establish a single shared secret that will never vary and does not provide forward secrecy. To avoid this, cryptographic protocols usually perform the key agreement against an ephemeral key and either accept that the client key is not authenticated or perform multiple key agreements and combine the results.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Using the Result Combination Law allows a key agreement mechanism to combine the benefits of mutual authentication with the use of ephemeral keys without the need for multiple private key operations or additional round trips.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">In its simplest form, the key exchange has two parties which we refer to as the client and the server. The client being the party that initiates the protocol exchange and the server being the party that responds. Let the public key pair of the client be {<em>a</em>, <em>A</em>} and that of the server {<em>b</em>, <em>B</em>}.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">Two versions of the key agreement mechanism are specified:<a href="#section-7-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7-7">
        <dt id="section-7-7.1">Client ephemeral</dt>
        <dd id="section-7-7.2">
          <p id="section-7-7.2.1">The client contributes an ephemeral key pair {<em>n<sub>A</sub></em>, <em>N<sub>A</sub></em>}. The effective public key of the client is <em>A</em> ? <em>N<sub>A</sub></em>.<a href="#section-7-7.2.1" class="pilcrow">¶</a></p>
<p id="section-7-7.2.2">The server uses its public key <em>B</em>.<a href="#section-7-7.2.2" class="pilcrow">¶</a></p>
<p id="section-7-7.2.3">The key agreement value is <em>DH </em>(<em>a</em> + <em>n<sub>A</sub></em>, B) = <em>DH</em> (<em>b</em>, <em>A</em> ? <em>N<sub>A</sub></em>)<a href="#section-7-7.2.3" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-7-7.3">Dual ephemeral </dt>
        <dd id="section-7-7.4">
          <p id="section-7-7.4.1">The client contributes an ephemeral key pair {<em>n<sub>A</sub></em>, <em>N<sub>A</sub></em>}. The effective public key of the client is <em>A</em> ? <em>N<sub>A</sub></em>.<a href="#section-7-7.4.1" class="pilcrow">¶</a></p>
<p id="section-7-7.4.2">The server contributes an ephemeral key pair {<em>n<sub>B</sub></em>, <em>N<sub>B</sub></em>}. The effective public key of the client is <em>B</em> ? <em>N<sub>B</sub></em>.<a href="#section-7-7.4.2" class="pilcrow">¶</a></p>
<p id="section-7-7.4.3">The key agreement value is <em>DH </em>(<em>a</em> + <em>n<sub>A</sub></em>, <em>B</em> ? <em>N<sub>B</sub></em>) = <em>DH</em> (<em>b</em> + <em>n<sub>B</sub></em>, <em>A</em> ? <em>N<sub>A</sub></em>)<a href="#section-7-7.4.3" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-7-8">The function of the ephemeral key is effectively that of a nonce but it is shared with the counter-party as a public key value.<a href="#section-7-8" class="pilcrow">¶</a></p>
<p id="section-7-9">The dual ephemeral approach has the advantage that it limits the scope for side channel attacks as both sides have contributed unknown information to the key agreement value. The disadvantage of this approach is that the key agreement value can only be calculated after the server has provided its ephemeral.<a href="#section-7-9" class="pilcrow">¶</a></p>
<p id="section-7-10">Implementations <span class="bcp14">MAY</span> take advantage of the result combination law to enable private key operations involving the authenticated key (or a contribution to it) to be performed in trustworthy hardware.<a href="#section-7-10" class="pilcrow">¶</a></p>
<p id="section-7-11">An advantage of this key exchange mechanism over the traditional TLS key exchange approach is that no signature operation is involved, thus ensuring that either party can repudiate the exchange and thus the claim that they were in communication.<a href="#section-7-11" class="pilcrow">¶</a></p>
<p id="section-7-12">The master secret is calculated from the key agreement value in the usual fashion. For ECDH algorithms, this comprises the steps of converting the key agreement value to an octet string which forms the input to a Key Derivation Function.<a href="#section-7-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">The security considerations for use and implementation of Mesh services and applications are described in the Mesh Security Considerations guide <span>[<a href="#draft-hallambaker-mesh-security" class="xref">draft-hallambaker-mesh-security</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document requires no IANA actions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-acknowledgements">
<section id="section-10">
      <h2 id="name-acknowledgements">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-10-1">A list of people who have contributed to the design of the Mesh is presented in <span>[<a href="#draft-hallambaker-mesh-architecture" class="xref">draft-hallambaker-mesh-architecture</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-examples">
<section id="section-11">
      <h2 id="name-examples">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="n-key-combination">
<section id="section-11.1">
        <h3 id="name-key-combination">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-key-combination" class="section-name selfRef">Key Combination</a>
        </h3>
<div id="n-ed25519">
<section id="section-11.1.1">
          <h4 id="name-ed25519">
<a href="#section-11.1.1" class="section-number selfRef">11.1.1. </a><a href="#name-ed25519" class="section-name selfRef">Ed25519</a>
        </h4>
</section>
</div>
<div id="n-ed448">
<section id="section-11.1.2">
          <h4 id="name-ed448">
<a href="#section-11.1.2" class="section-number selfRef">11.1.2. </a><a href="#name-ed448" class="section-name selfRef">Ed448</a>
        </h4>
</section>
</div>
<div id="n-x25519">
<section id="section-11.1.3">
          <h4 id="name-x25519">
<a href="#section-11.1.3" class="section-number selfRef">11.1.3. </a><a href="#name-x25519" class="section-name selfRef">X25519</a>
        </h4>
</section>
</div>
<div id="n-x448">
<section id="section-11.1.4">
          <h4 id="name-x448">
<a href="#section-11.1.4" class="section-number selfRef">11.1.4. </a><a href="#name-x448" class="section-name selfRef">X448</a>
        </h4>
</section>
</div>
</section>
</div>
<div id="n-group-encryption">
<section id="section-11.2">
        <h3 id="name-group-encryption">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-group-encryption" class="section-name selfRef">Group Encryption</a>
        </h3>
<div id="n-x25519-0">
<section id="section-11.2.1">
          <h4 id="name-x25519-2">
<a href="#section-11.2.1" class="section-number selfRef">11.2.1. </a><a href="#name-x25519-2" class="section-name selfRef">X25519</a>
        </h4>
</section>
</div>
<div id="n-x448-0">
<section id="section-11.2.2">
          <h4 id="name-x448-2">
<a href="#section-11.2.2" class="section-number selfRef">11.2.2. </a><a href="#name-x448-2" class="section-name selfRef">X448</a>
        </h4>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-normative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="AES-GCM">[AES-GCM]</dt>
      <dd>
<span class="refAuthor">Dworkin, M. J.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <time datetime="2007-11" class="refDate">November 2007</time>. </dd>
<dd class="break"></dd>
<dt id="draft-hallambaker-mesh-architecture">[draft-hallambaker-mesh-architecture]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part I: Architecture Guide"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-architecture-13</span>, <time datetime="2020-03-09" class="refDate">9 March 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-architecture-13">https://tools.ietf.org/html/draft-hallambaker-mesh-architecture-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-hallambaker-mesh-security">[draft-hallambaker-mesh-security]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part VII: Security Considerations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-security-04</span>, <time datetime="2020-03-09" class="refDate">9 March 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-security-04">https://tools.ietf.org/html/draft-hallambaker-mesh-security-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS197">[FIPS197]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Advanced Encryption Standard (AES)"</span>, <time datetime="2001-11" class="refDate">November 2001</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
      <dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor">, Bellare, M.</span><span class="refAuthor">, and R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2104">https://www.rfc-editor.org/rfc/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3394">https://www.rfc-editor.org/rfc/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
      <dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor"> and P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
      <dd>
<span class="refAuthor">Langley, A.</span><span class="refAuthor">, Hamburg, M.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
      <dd>
<span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8439">[RFC8439]</dt>
      <dd>
<span class="refAuthor">Nir, Y.</span><span class="refAuthor"> and A. Langley</span>, <span class="refTitle">"ChaCha20 and Poly1305 for IETF Protocols"</span>, <span class="seriesInfo">RFC 8439</span>, <span class="seriesInfo">DOI 10.17487/RFC8439</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8439">https://www.rfc-editor.org/rfc/rfc8439</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA-2">[SHA-2]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard"</span>, <time datetime="2015-08" class="refDate">August 2015</time>. </dd>
<dd class="break"></dd>
<dt id="SHA-3">[SHA-3]</dt>
      <dd>
<span class="refAuthor">Dworkin, M. J.</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <time datetime="2015-08" class="refDate">August 2015</time>. </dd>
<dd class="break"></dd>
<dt id="SHA-3-Derived">[SHA-3-Derived]</dt>
    <dd>
<span class="refAuthor">Kelsey, J. M.</span><span class="refAuthor">, Chang, S. H.</span><span class="refAuthor">, and R. A. Perlner</span>, <span class="refTitle">"SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash SHARE"</span>, <time datetime="2016-12" class="refDate">December 2016</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13">
      <h2 id="name-informative-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="Blaze98">[Blaze98]</dt>
      <dd>
<span class="refTitle">"[Reference Not Found!]"</span>, <span></span>. </dd>
<dd class="break"></dd>
<dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
    <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh: Reference Implementation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-developer-09</span>, <time datetime="2019-10-23" class="refDate">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-developer-09">https://tools.ietf.org/html/draft-hallambaker-mesh-developer-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
