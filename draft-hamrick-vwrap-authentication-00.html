<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>VWRAP Trust Model and User
      Authentication</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="VWRAP Trust Model and User
      Authentication">
<meta name="keywords" content="virtual world, authentication, trust model">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Virtual World Region Agent</td><td class="header">T. Chu</td></tr>
<tr><td class="header">Protocol</td><td class="header">M. Hamrick</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">M. Lentczner</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Linden Research, Inc.</td></tr>
<tr><td class="header">Expires: August 9, 2010</td><td class="header">February 05, 2010</td></tr>
</table></td></tr></table>
<h1><br />VWRAP Trust Model and User
      Authentication<br />draft-hamrick-vwrap-authentication-00</h1>

<h3>Abstract</h3>

<p>Authentication in the Virtual World Region Agent Protocol
        establishes an         application layer association between a
        client application and         a remote service responsible for
        managing the end user's         identity. The objective of
        authentication is to verify the user         of a client
        application possesses appropriate credentials before
        granting capabilities sufficient to assert control over the
        user's agent and digital assets.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 9, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Language<br />
<a href="#anchor3">2.</a>&nbsp;
Agent Login (Resource Class)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.1.</a>&nbsp;
Account identifiers and Agent identifiers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.1.2.</a>&nbsp;
Flexible Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.2.</a>&nbsp;
Service Location<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.3.</a>&nbsp;
Inputs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.3.1.</a>&nbsp;
Agent Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.3.2.</a>&nbsp;
Account Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">2.3.3.</a>&nbsp;
Hashed Password Authenticator<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">2.3.4.</a>&nbsp;
Challenge-Response Authenticator<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">2.3.5.</a>&nbsp;
PKCS#5 PBKDF2 Authenticator<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">2.4.</a>&nbsp;
Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">2.4.1.</a>&nbsp;
Success<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">2.4.2.</a>&nbsp;
Maintenance Deferred Success<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">2.4.3.</a>&nbsp;
Authentication Non-Success<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">2.5.</a>&nbsp;
Errors and Exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">2.5.1.</a>&nbsp;
Authentication Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">2.5.2.</a>&nbsp;
Agent Selection Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">2.5.3.</a>&nbsp;
&#34;User Intervention Required&#34; Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">2.5.4.</a>&nbsp;
&#34;Non Specific&#34; Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">2.6.</a>&nbsp;
Preconditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">2.6.1.</a>&nbsp;
Client Preconditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">2.6.2.</a>&nbsp;
Agent Domain Preconditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">2.7.</a>&nbsp;
Postconditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">2.7.1.</a>&nbsp;
Client Postconditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">2.7.2.</a>&nbsp;
Agent Domain Postconditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">2.8.</a>&nbsp;
Side Effects<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">2.9.</a>&nbsp;
Sequence of Events<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">2.10.</a>&nbsp;
Interface (POST)<br />
<a href="#anchor32">3.</a>&nbsp;
Login-Time Maintenance (Resource Class)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">3.1.</a>&nbsp;
Service Location<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">3.2.</a>&nbsp;
Verb<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">3.3.</a>&nbsp;
Inputs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">3.4.</a>&nbsp;
Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">3.5.</a>&nbsp;
Interface (GET)<br />
<a href="#Security">4.</a>&nbsp;
Security Considerations<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">6.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">6.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">6.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Authentication is the first step in associating a client
        application with the agent domain (the remote service
        responsible for agent identity management.) Before a client
        application may interact with the agent domain or one or more
        hosts responsible for virtual world simulation, it must
        authenticate itself by presenting credentials demonstrating
        its right to control the agent. Authentication is the process
        of presenting an "Identifier" and an "Authenticator" to the
        agent domain and receiving a "Seed Capability" providing further
        access to system resources or an actionable error description.
        The protocol defines an identifier as an agent or account
        information, distinct from its related authenticator.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
          "OPTIONAL" in this document are to be interpreted as described
          in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Agent Login (Resource Class)</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Introduction</h3>

<p>Authentication begins by requesting the agent_login resource;
          that is, POSTing the "LLSD" description of an identifier and
          an authenticator to a well-known URL. <a class='info' href='#draft-hamrick-vwrap-type-system-00'>[draft&#8209;hamrick&#8209;vwrap&#8209;type&#8209;system&#8209;00]<span> (</span><span class='info'>Brashears, A., Hamrick, M., and M. Lentczner, &ldquo;Linden Lab Structured Data,&rdquo; 2010.</span><span>)</span></a>           The agent domain
          managing this resource then makes an access           control
          decision based on the verity of the credential and
          the state of the agent domain. The result of this
          authentication, whether success or failure, it is returned to
          the client application via a LLSD message. The content and
          form of these messages are provided below in "LLIDL
          format."
</p>
<p>The authentication process results in one of seven classes
          of response from the agent domain:
</p>
<p>
          </p>
<ul class="text">
<li>success
</li>
<li>deferred success due to maintenance
</li>
<li>authentication non-success due to missing secret
</li>
<li>authentication failure
</li>
<li>agent selection failure
</li>
<li>"user intervention required" failure, and
</li>
<li>"non-specified" failure.
</li>
</ul><p>
        
</p>
<p>Responses to authentication requests are successes,
          non-successes and failures.                A "success"
          indicates the client application should have enough
          information to progress                past the authentication
          phase and begin using the service. A "deferred success"
          implies                use of the system will continue after a
          "short" period. In either case, the agent domain
          does not expect the client application to re-submit the
          agent_login request.                Authentication
          "non-success" results from a client requesting per-agent or
          per-account                authentication parameters. After
          sending a "non-success", the agent domain expects the
          client to resubmit the agent_login request "shortly." Failures
          of all type indicate the                agent domain believes
          a condition exists requiring explicit user intervention. In
          the case                of an authentication failure, the user
          should either retry the authentication request or
          recover their password. A failure due to "user intervention
          required" indicates the agent                domain believes
          the user's account is in a state that required "out of band"
          recovery.                Reading and accepting the agent
          domain's Terms of Service or Critical Messages are
          examples of recovering from "user intervention required"
          failures. Non-Specified                failures indicate a
          non-recoverable problem that is not defined in this
          specification.
</p>
<p>The section below on Processing Expectations provides more
          guidance.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Account identifiers and Agent identifiers</h3>

<p>Client applications may authenticate using an "Account
            Identifier" or an "Agent Identifier". Either type of
            identifier may be used for authentication. An agent domain
            MUST support one of the two types of identifiers, and MAY
            support both. Client applications SHOULD support both
            identifier types.
</p>
<p>An "Account" is an administrative object holding one or
            more references to an "Agent." This is advantageous in
            situations where:
</p>
<p>
            </p>
<ol class="text">
<li>the agent domain does not wish to use an agent first
                name and last name to identify a user, but wishes to use
                another identifier (such as an email address or account
                number,) or
</li>
<li>the agent domain wishes to allow users with several
                agents to authenticate with the same authenticator,
                freeing them from the requirement of memorizing each
                individual agent authenticator.
</li>
</ol><p>
          
</p>
<p>Please note this spec does not imply a structure to the
            account identifier. Though an agent domain may use an email
            address as an account identifier, the protocol does not
            require it and treats the identifier simply as an opaque
            sequence of octets.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
Flexible Authentication</h3>

<p>This revision of the Virtual World Region Agent Protocol
            defines, but does not require the use of,
            three authentication schemes: hashed password,
            challenge-response and                   PKCS#5 Key
            Derivation 2.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Service Location</h3>

<p>Each Agent Domain MUST have a well known and published
          authentication URL.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Inputs</h3>

<p>LLIDL descriptions are provided below for both agent
          identifiers and account identifiers. Client applications may
          use either as the basis for authentication.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Agent Identifier</h3>

<p>An agent identifier contains the first and last name of an
            agent.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Account Identifier</h3>

<p>An account identifier must contain the account_name key.
            This is the opaque sequence of                   octets used
            by the agent domain to identify the user. If an account is
            associated with                   multiple agents, the
            client application SHOULD include the first_name and
            last_name of                   the agent the user wishes to
            use.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
Hashed Password Authenticator</h3>

<p>When a hashed password is used as an authenticator, the
            string '$1$' is prepended to                   the UTF-8
            encoding of the password and processed with the MD5
            cryptographic hash                   function. <a class='info' href='#RFC1321'>[RFC1321]<span> (</span><span class='info'>Rivest, R., &ldquo;The MD5 Message-Digest Algorithm,&rdquo; April&nbsp;1992.</span><span>)</span></a>                     This revision of
            the Virtual World Region Agent Protocol specification
            requires the use of MD5 with                     the hashed
            password authenticator. It also requires the presence of the
            algorithm                     key, and that the value of
            this key be the string 'md5'. Note that future versions
            of this specification may ALLOW or REQUIRE the use of other
            cryptographic hash                     functions.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.4"></a><h3>2.3.4.&nbsp;
Challenge-Response Authenticator</h3>

<p>The Challenge-Response scheme allows the agent domain to
            select a session specific "Salt" to be used in conjunction
            with the user's password to generate an authenticator. In
            this scheme the authenticator is the hash of the salt
            prepended to the hash of '$1$' prepended to the password.
            This revision of the Virtual World Region Agent Protocol
            specification requires the use of SHA256 with the
            challenge-response authenticator. <a class='info' href='#sha256'>[sha256]<span> (</span><span class='info'>, &ldquo;&quot;Federal Information Processing Standards Publication             180-2 (+ Change Notice to include SHA-224),&rdquo; .</span><span>)</span></a> It
            also requires the presence of the algorithm key, and that
            the value of this key be the string 'sha256'. Note that
            future versions of this specification may ALLOW or REQUIRE
            the use of other cryptographic hash functions.
</p>
<p>To retrieve a session specific salt for use with the
            Challenge-Response authentication scheme from the agent
            domain, the client application sends a login request with a
            Challenge-Response authenticator without the secret item. If
            the agent domain supports this authenticator, it MUST
            respond with a 'key' condition including a salt and MAY
            include a duration in the response. If the duration is
            present, it denotes the number of seconds for which the salt
            will be valid.
</p>
<p>
            </p>
<blockquote class="text">
<p>The Challenge-Response Authentication Scheme is not
                currently deployed on the Second Life Grid.
</p>
</blockquote><p>
          
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.5"></a><h3>2.3.5.&nbsp;
PKCS#5 PBKDF2 Authenticator</h3>

<p>The PKCS#5 PBKDF2 authenticator is an implementation of RSA
            Labs' Public Key Cryptographic Standards #5 v2.1 Password
            Based Key Derivation Function #2. <a class='info' href='#pkcs5'>[pkcs5]<span> (</span><span class='info'>Kaliski, B., &ldquo;PKCS #5: Password-Based Cryptography Specification             Version 2.0,&rdquo; .</span><span>)</span></a> In
            this scheme, the hash of the string '$1$' prepended to the
            password is used in conjunction with a salt, iteration count
            and hash function to generate an authenticator. This
            revision of the Virtual World Region Agent Protocol
            specification requires the use of SHA256 with the PKCS#5
            PBKDS2 authenticator. It also requires the presence of the
            algorithm key, and that the value of this key be the string
            'sha256'. Note that future versions of this specification
            may ALLOW or REQUIRE the use of other cryptographic hash
            functions.
</p>
<p>As with the Challenge-Response authenticator, the agent
            domain MUST include the salt and iteration count in its
            response to an authentication request that is made without a
            secret item. Conforming agent domains may include a duration
            in their response indicating the number of seconds for which
            the salt and iteration count will be valid.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Response</h3>

<p>The response to the agent login message is notice of one of
          seven "conditions":
</p>
<p>
          </p>
<ul class="text">
<li>authentication success
</li>
<li>maintenance deferred success
</li>
<li>authentication non-success
</li>
<li>authentication failure
</li>
<li>agent selection failure
</li>
<li>"user intervention required" failure, and
</li>
<li>"non-specific" failure.
</li>
</ul><p>
        
</p>
<p>The specification recognizes three "non-failure" responses:
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1"></a><h3>2.4.1.&nbsp;
Success</h3>

<p>Upon success, the agent domain will respond with a message
            containing the "Agent Seed Capability". Receipt of this
            capability indicates authentication was successful. This
            capability is then used for further interactions with the
            system.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.2"></a><h3>2.4.2.&nbsp;
Maintenance Deferred Success</h3>

<p>This condition indicates per-agent (or per-account)
            login-time maintenance is being performed. It is not an
            error. The response includes a maintenance cap the client
            application should use to get information about currently
            executing maintenance. For more information about
            maintenance, see the Maintenance section below.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.3"></a><h3>2.4.3.&nbsp;
Authentication Non-Success</h3>

<p>Authentication Non-Success is the response given when a
            client queries the agent domain for agent-specific or
            account-specific authentication parameters. In that it is
            the expected response to such a query, it is not an error or
            exception. But it is not an indication of successful
            authentication.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Errors and Exceptions</h3>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5.1"></a><h3>2.5.1.&nbsp;
Authentication Failure</h3>

<p>An authentication failure indicates the client application
            did not provide enough information to authenticate the
            account or the agent.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5.2"></a><h3>2.5.2.&nbsp;
Agent Selection Failure</h3>

<p>An agent selection failure occurs when an account
            authentication request is ambiguous. In other words, the
            account a user has attempted to use to log in is associated
            with more than one agent account and the client application
            did not specify which account to use. The response includes
            a list of first_name / last_name pairs. It is expected that
            the client application will present this list to the user
            and ask which agent to use.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5.3"></a><h3>2.5.3.&nbsp;
&#34;User Intervention Required&#34; Failure</h3>

<p>This error indicates that the agent domain cannot
            authenticate the user for non-technical reasons. The
            protocol does not attempt to describe why, or imply
            remediation for this error. But an agent domain that returns
            this response MUST provide a URL containing a message
            describing the condition leading to the error and
            remediation, if known.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5.4"></a><h3>2.5.4.&nbsp;
&#34;Non Specific&#34; Failure</h3>

<p>This error indicates some other error exists which does not
            fall into one of the previous six conditions.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Preconditions</h3>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6.1"></a><h3>2.6.1.&nbsp;
Client Preconditions</h3>

<p>It is generally assumed that before a user attempts to log
            into an agent domain, they will not be actively connected to
            that agent domain.
</p>
<p>It is also assumed that the user has registered their
            account and/or agent; user registration is outside the scope
            of this specification.
</p>
<p>The client application SHOULD present the agent domain's
            Terms of Service and Critical Messages and allow a user to
            accept or decline them prior to attempting to
          authenticate.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6.2"></a><h3>2.6.2.&nbsp;
Agent Domain Preconditions</h3>

<p>If the agent domain requires users to read and agree to the
            Terms of Service or acknowledge receipt of Critical Messages
            prior to authentication, it must maintain a record of which
            accounts and agents have accepted and acknowledged these
            items.
</p>
<p>Agent domains that support the concept of "suspension" or
            "disablement" should also maintain a record of which
            accounts and agents are suspended or disabled.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.7"></a><h3>2.7.&nbsp;
Postconditions</h3>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.7.1"></a><h3>2.7.1.&nbsp;
Client Postconditions</h3>

<p>Following successful authentication, the client application
            SHOULD note that the agent has been authenticated to the
            agent domain. The Virtual World Region Agent Protocol is NOT
            stateless.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.7.2"></a><h3>2.7.2.&nbsp;
Agent Domain Postconditions</h3>

<p>After an agent (or account) is authenticated, a seed
            capability is allocated for the agent. The agent domain
            SHOULD maintain the association between agent credentials
            (first_name and last_name) and the seed capability so it may
            be re-used if the client attempts to re-authenticate the
            user.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.8"></a><h3>2.8.&nbsp;
Side Effects</h3>

<p>The agent domain SHOULD maintain the "presence" state of an
          agent. This state should include the agent's seed capability.
          If a previously authenticated and "present" agent
          re-authenticates successfully, the agent domain MAY return the
          same seed capability.
</p>
<p>After successful authentication, it is expected that the
          client will issue another request against the seed capability.
          To defend against potential Denial of Service attacks against
          the agent domain, the agent domain MAY define a timeout period
          for the seed capability. If the timeout period expires without
          a request being made against the seed capability, that seed
          capability will expire. Successful authentication of an agent
          who is "not present" has the effect of starting this timer.
</p>
<p>The Challenge-Response Authenticator is intended to be used
          with a new, randomly generated salt for each authentication
          request. If the agent domain supports the Challenge-Response
          authentication scheme, it must maintain the "most recently
          generated salt" for some period of time (generally until the
          expiration of the duration period given in the authentication
          non-success response.)
</p>
<p>After the salt has "timed out" following an unsuccessful
          Challenge-Response authentication request, the agent domain
          MUST NOT allow the use of a previous or fixed salt value. That
          is, it is not correct, after the salt has expired, to use a
          null, fixed or previous salt. The agent domain MUST generate a
          new salt and return it to the client application. An
          unsuccessful authentication request with the
          Challenge-Response scheme also has the side effect of starting
          the salt duration timer. When this timer expires, the agent
          domain MUST NOT allow authentication with previously generated
          salts.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.9"></a><h3>2.9.&nbsp;
Sequence of Events</h3>

<p>It is possible for an authentication request to occur in
          conditions where multiple errors or exceptions COULD be
          returned. As the protocol does not support reporting multiple
          failure conditions, the following sequence is provided to
          determine the priority of failure conditions. This sequence of
          events is motivated by the following principles:
</p>
<p>
          </p>
<ul class="text">
<li>The agent domain should leak no account status
              information to an unauthenticated user.
</li>
<li>Maintenance should occur after successful authentication
              and before account status checking in case maintenance
              involves the representation of these states by the agent
              domain.
</li>
<li>The agent domain should check for "administrative issues"
              after maintenance is complete.
</li>
</ul><p>
        
</p>
<p>The sequence for authentication is as follows. At the first
          error, the system produces an appropriate error response.
</p>
<p>
          </p>
<ol class="text">
<li>If the authenticator provided is a Challenge-Response or
              PKCS#5 PBKDF2 type AND a secret is not included, the
              system returns an authentication non-success response.
</li>
<li>The secret and optional authentication parameters are
              used to verify the client is in possession of the shared
              secret. If authentication is unsuccessful, an
              authentication failure response is returned.
</li>
<li>If per-user login-time maintenance must be performed, the
              agent domain allocates a maintenance capability and
              returns it to the client application as a maintenance
              deferred success response.
</li>
<li>If an account credential was used for authentication and
              the account "contains" two or more agents and the client
              application did not provide the first_name and last_name
              of the agent to log in as, generate a list of all agents
              associated with this account and return an agent selection
              failure response.
</li>
<li>If an "administrative issue" exists such as the user is
              suspended, banned, must agree to the terms of service or
              read critical messages, the system returns a "user
              intervention required" response, providing a URL
              referencing a web resource explaining the administrative
              issue and describing remediation steps.
</li>
<li>Check to see if the authenticated agent is associated
              with an agent seed capability already. If so, return a
              success response referencing that seed capability.
</li>
<li>Start the seed capability timer. Allocate an agent seed
              capability and return it to the client application via a
              success response.
</li>
</ol><p>
        
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.10"></a><h3>2.10.&nbsp;
Interface (POST)</h3>

<p>The following text describes the LLIDL description of the
          agent_login messages.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>; authenticators

  ; hashed password authenticator

  &amp;authenticator = {
    type: 'hash',           ; identifies this as "hashed" type
    algorithm: 'md5',       ;
    secret: binary          ; hash of salt prepended to the password;
                            ;   s = h( '$1$' | pw )
  }

  ; challenge response style authenticator

  &amp;authenticator = {
    type: 'challenge',      ; identifies this as a "challenge response"
    algorithm: 'sha256',    ;
    salt: binary,           ; optional - default is ( 0x24, 0x31, 0x24 )
    secret: binary          ; hash of the salt prepended to the password
                            ;   s = h( salt | h( '$1$' | pw ) )
  }

  ; PKCS#5 PBKDF2 style authenticator

  &amp;authenticator = {
    type: 'pkcs5pbkdf2',    ; identifies authenticator as PKCS#5 PBKDF2
    algorithm: string,      ; identifier for hash ('md5' or 'sha256')
    salt: binary,           ; optional - default is ( 0x24, 0x31, 0x24 )
    count: int,             ; optional - 1 used if not present
    secret: binary          ; hash of the salt prepended to the password
                            ; s = pbkdf2( h('$1$' | pw),salt,count,128)
  }

; identifier types

  ; account identifier

  &amp;identifier = {
    type: 'account',        ; identifies this as an "account identifier"
    account_name: string,
    first_name: string,     ; optional - first_name and last_name
    last_name: string       ; identify agent to log in as for accounts
                            ; with more than one agent
  }

  ; agent identifier

  &amp;identifier = {
    type: 'agent',           ; identifies this as an "agent identifier"
    first_name: string,
    last_name: string
  }

; request

  &amp;credential = {
    identifier: &amp;identifier,       ; account or agent identifier
    authenticator: &amp;authenticator  ; 'hash', 'challenge'
                                       ;  or 'pkcs5pbkdf2'
  }

; response

  ; successful response

  &amp;response = {
    condition: 'success',
    agent_seed_capability: uri    ; URL of the agent seed cap
  }

  ; authentication failure

  &amp;response = {
    condition: 'key',
    salt: binary,            ; optional - salt for challenge and PKCS5
    count: int,              ; optional - iteration count for PKCS5
    duration: int            ; optional - the duration of the validity
                             ; period of salt and count values in
                             ; seconds
  }

  ; maintenance "non success"

  &amp;response = {
    condition: 'maintenance',
    maintenance_capability: uri,  ; URL of the maintenance cap
    completion: int               ; an estimate for maintenance duration
                                  ; (in seconds)
  }

  ; agent select failure

  &amp;response = {
    condition: 'select',
    agents: [ { first_name: string, last_name: string } , ... ]
  }

  ; administrative failure

  &amp;response = {
    condition: 'intervention',
    message: uri                 ; a URI with human-readable text
                                 ; explaining what the user must do to
                                 ; continue
  }

  ; non-specific error

  &amp;response = {
    condition: 'nonspecific',
    message: string              ; a string describing the failure

; resource definition

%% agent_login
-&gt;&amp;credential
&lt;-&amp;response</pre></div>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Login-Time Maintenance (Resource Class)</h3>

<p>An agent domain has the option of performing "per-user,
        login-time maintenance" as part of the authentication sequence.
        Performing maintenance after a user is authenticated and before
        an avatar is "rezzed" in a region has several advantages:
</p>
<p>
        </p>
<ul class="text">
<li>it reduces system-wide downtime
</li>
<li>it distributes maintenance across time, and
</li>
<li>it consumes computational resources only for those agents
            who use the system
</li>
</ul><p>
      
</p>
<p>The agent domain signals it is performing maintenance by
        returning a "Maintenance Capability" instead of a seed
        capability following successful authentication. The maintenance
        capability represents a finite sequence of transactions
        performed by the agent domain on the user's behalf. It is
        expected that maintenance is a task that will complete in a
        "tractable" amount of time.
</p>
<p>The maintenance capability may be queried to retrieve
        information about the transactions that are occuring, including:
</p>
<p>
        </p>
<ul class="text">
<li>a textual description of the maintenance being performed
</li>
<li>an estimate for how long the maintenance will take to
            complete
</li>
</ul><p>
      
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Service Location</h3>

<p>The agent domain may provide a maintenance capability to the
          client application in response to successful authentication.
          This capability is communicated as an URL to a web based
          service that accepts LLSD queries.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>'maintenance' capability from</pre></div>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Verb</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>GET</pre></div>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Inputs</h3>

<p>There are no parameters to a maintenance capability
        request.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Response</h3>

<p>There are three responses to a maintenance capability: a
          description of ongoing maintenance, a new maintenance
          capability describing another sequence of maintenance
          transactions, or a seed capability. These responses are
          identified with the condition items: 'ongoing', 'next' and
          'complete'.
</p>
<p>The 'ongoing' response to a maintenance capability request
          includes a simple textual description of the maintenance
          performed, an estimate for how long the maintenance is
          expected to take, and a validity duration for the capability.
          The estimate for how long maintenance will take is provided so
          client applications may provide feedback to the user. The
          validity duration gives the viewer a minimim time period the
          agent domain will maintain the maintenance capability.
</p>
<p>When the agent domain returns a 'next' response, it indicates
          that the current maintenance is complete, but a new
          maintenance must be performed before the agent may be placed
          into a region. The 'next' response includes the URL of the
          next maintenance capability as well as an integer describing
          the minimum time period the agent domain will maintain the
          maintenance capability.
</p>
<p>When an agent domain returns a 'complete' response, it
          indicates that all maintenance is complete. The response
          includes the agent seed capability that may be used to place
          the user's avatar in a region. It also includes an item
          describing the validity period for the current maintenance
          capability.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Interface (GET)</h3>

<p>The following text describes the LLIDL description of the
          agent_login messages.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>&amp;response = {
  condition: 'ongoing',
  description: string,
  duration: int,               ; seconds before maintenance is complete
  validity: int                ; seconds before this capability expires
}

&amp;response = {
  condition: 'next',
  description: string,
  maintenance_capability: uri, ; URL for the next maintenance capability
  validity: int                ; seconds before this capability expires
}

&amp;response = {
  condition: 'complete',
  agent_seed_capability: uri,  ; the agent's seed cap
  validity: integer            ; seconds before this capability expires
}

%% maintenance
&lt;&lt;response</pre></div>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p><a class='info' href='#RFC3552'>RFC 3552<span> (</span><span class='info'>Rescorla, E. and B. Korver, &ldquo;Guidelines for Writing RFC Text on Security Considerations,&rdquo; July&nbsp;2003.</span><span>)</span></a> [RFC3552] describes
        several aspects to use when evaluating the security of a
        specification or             implementation. We believe most
        common security concerns users of this specification
        will encounter are more appropriately considered as transport,
        network or link layer             issues. However, the following
        "application security" issues should be considered.
</p>
<p>The MD5 cryptographic hash functions has been deprecated
        and SHOULD be used only for compatibility with older
        applications.
</p>
<p>The use of the hashed password authenticator could result in a
        replay attack if not             used in conjunction with an
        appropriate confidentiality preserving transport.
        Implementations using the hashed password authenticator SHOULD
        utilize appropriate              encryption schemes such as
          <a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] or <a class='info' href='#RFC3851'>S/MIME<span> (</span><span class='info'>Ramsdell, B., &ldquo;Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification,&rdquo; July&nbsp;2004.</span><span>)</span></a> [RFC3851].
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1321">[RFC1321]</a></td>
<td class="author-text"><a href="mailto:rivest@theory.lcs.mit.edu">Rivest, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1321">The MD5 Message-Digest Algorithm</a>,&rdquo; RFC&nbsp;1321, April&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="draft-hamrick-vwrap-type-system-00">[draft-hamrick-vwrap-type-system-00]</a></td>
<td class="author-text">Brashears, A., Hamrick, M., and M. Lentczner, &ldquo;Linden Lab Structured Data,&rdquo; 2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="pkcs5">[pkcs5]</a></td>
<td class="author-text">Kaliski, B., &ldquo;PKCS #5: Password-Based Cryptography Specification
            Version 2.0.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="sha256">[sha256]</a></td>
<td class="author-text">&ldquo;"Federal Information Processing Standards Publication
            180-2 (+ Change Notice to include SHA-224).&rdquo;</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3552">[RFC3552]</a></td>
<td class="author-text">Rescorla, E. and B. Korver, &ldquo;<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>,&rdquo; BCP&nbsp;72, RFC&nbsp;3552, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3552.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3851">[RFC3851]</a></td>
<td class="author-text">Ramsdell, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3851">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</a>,&rdquo; RFC&nbsp;3851, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tess Chu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linden Research, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">945 Battery St.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Francisco, CA  94111</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 415 243 9000</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tess@lindenlab.com">tess@lindenlab.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Meadhbh Siobhan Hamrick</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linden Research, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">945 Battery St.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Francisco, CA  94111</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 650 283 0344</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:infinity@lindenlab.com">infinity@lindenlab.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mark Lentczner</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linden Research, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">945 Battery St.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Francisco, CA  94111</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 415 243 9000</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:zero@lindenlab.com">zero@lindenlab.com</a></td></tr>
</table>
</body></html>
