

Diameter Maintenance and                                J. Korhonen, Ed.
Extensions (DIME)                                            TeliaSonera
Internet-Draft                                           M. Arumaithurai
Intended status: Standards Track                University of Goettingen
Expires: August 30, 2007                                   H. Tschofenig
                                           Siemens Networks GmbH & Co KG
                                                       February 26, 2007


               Quality of Service Attributes for Diameter
               draft-korhonen-dime-qos-attributes-00.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on August 30, 2007.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This document extends the functionality of the Diameter Base protocol
   and Diameter NASREQ with respect to their ability to convey Quality
   of Service information as part of the QoSFilterRule Attribute Value
   Pair (AVP).




Korhonen, et al.         Expires August 30, 2007                [Page 1]

Internet-Draft         QoS attributes for Diameter         February 2007


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  3
   3.  Commands, AVPs and Advertising Application Support . . . . . .  3
     3.1.  Command Codes  . . . . . . . . . . . . . . . . . . . . . .  3
     3.2.  Diameter-EAP-Request (DER) . . . . . . . . . . . . . . . .  4
     3.3.  Diameter-EAP-Answer (DEA)  . . . . . . . . . . . . . . . .  4
     3.4.  Credit-Control-Request (CCR) . . . . . . . . . . . . . . .  5
     3.5.  Credit-Control-Answer (CCA)  . . . . . . . . . . . . . . .  6
     3.6.  AA-Request (AAR) . . . . . . . . . . . . . . . . . . . . .  7
     3.7.  AA-Answer (AAA)  . . . . . . . . . . . . . . . . . . . . .  8
   4.  Diameter QoS Defined AVPs  . . . . . . . . . . . . . . . . . .  9
   5.  Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
   6.  AVP Occurrence Tables  . . . . . . . . . . . . . . . . . . . . 10
     6.1.  DER and DEA Commands AVP Table . . . . . . . . . . . . . . 11
     6.2.  CCR and CCA Commands AVP Table . . . . . . . . . . . . . . 11
     6.3.  AAR and AAA Commands AVP Table . . . . . . . . . . . . . . 11
   7.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 12
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 12
   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 12
     9.1.  Normative References . . . . . . . . . . . . . . . . . . . 12
     9.2.  Informative References . . . . . . . . . . . . . . . . . . 13
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 13
   Intellectual Property and Copyright Statements . . . . . . . . . . 15


























Korhonen, et al.         Expires August 30, 2007                [Page 2]

Internet-Draft         QoS attributes for Diameter         February 2007


1.  Introduction

   This document extends the functionality of the Diameter Base
   protocol, Diameter Credit Control and Diameter NASREQ with respect to
   their ability to convey Quality of Service information as part of the
   QoS-Resources Attribute Value Pair (AVP) defined in
   [I-D.ietf-dime-diameter-qos].  It extends the functionality of the
   above-mentioned Diameter applications to enable it to have basic QoS
   support for environments where the usage of the Diameter QoS
   application is not applicable.


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].


3.  Commands, AVPs and Advertising Application Support

3.1.  Command Codes

   This document re-uses the Diameter Base protocol [RFC3588], NASREQ
   [RFC4072] and Diameter EAP commands [RFC4005].  The following
   commands are used to carry QoS related AVPs:



       Command-Name         Abbrev.   Code     Reference  Application

   Diameter-EAP-Request      DER       268      RFC 4072    QoS
   Diameter-EAP-Answer       DEA       268      RFC 4072    QoS

   Credit-Control-Request    CCR       272      RFC 4006    QoS
   Credit-Control-Answer     CCA       272      RFC 4006    QoS

   AA-Request                AAR       265      RFC 4005    QoS
   AA-Answer                 AAA       265      RFC 4005    QoS


            Figure 1: QoS Integrated Application Command Codes

   When the Re-Auth-Request (RAR), Re-Auth-Answer (RAA), Session-
   Termination-Request (STR), Session-Termination-Answer (STA), Abort-
   Session-Request (ASR), Abort-Session-Answer (ASA), Accounting-Request
   (ACR), and Accounting-Answer (ACA) commands are used together with
   the Diameter QoS Integrated application, they follow the rules in



Korhonen, et al.         Expires August 30, 2007                [Page 3]

Internet-Draft         QoS attributes for Diameter         February 2007


   NASREQ [RFC4005], EAP [RFC4072], Credit-Control [RFC4006] and BASE
   [RFC3588].  The accounting commands use Application Identifier value
   of 3 (Diameter Base Accounting); the others use 0 (Diameter Common
   Messages).

3.2.  Diameter-EAP-Request (DER)

   The Diameter-EAP-Request (DER) command [RFC4072], indicated by the
   Command-Code field set to 268 and the 'R' bit set in the Command
   Flags field, may be sent by the NAS to the Diameter server providing
   network access authentication and authorization services.  At the
   same time with the network access authentication and authorization
   the NAS MAY request the Diameter QoS server, to authorize for
   provision of QoS resources.  In that case the DER command MAY also
   carry the QoS-Resources AVPs.

   The message format is the same as defined in [RFC4072] with an
   addition of Diameter QoS specific AVPs.  Figure 2 shows the DER
   message used with the Diameter QoS AVPs:



     <Diameter-EAP-Request> ::= < Diameter Header: 268, REQ, PXY >
                                < Session-Id >
                                { Auth-Application-Id }
                                { Origin-Host }
                                { Origin-Realm }
                                { Destination-Realm }
                                { Auth-Request-Type }

                                [ Destination-Host ]
                                [ User-Name ]

                              * [ QoS-Resources ]

                                ...
                              * [ AVP ]

                  Figure 2: Diameter EAP Request Command

3.3.  Diameter-EAP-Answer (DEA)

   The Diameter-EAP-Answer (DEA) message defined in [RFC4072], indicated
   by the Command- Code field set to 268 and 'R' bit cleared in the
   Command Flags field is sent in response to the Diameter-EAP-Request
   message (DER).  If the QoS service is successfully authorized and the
   Diameter server was able to fulfill the QoS Authorization request (if
   needed) then the response MAY include the QoS-Resources AVPs.



Korhonen, et al.         Expires August 30, 2007                [Page 4]

Internet-Draft         QoS attributes for Diameter         February 2007


   The message format is the same as defined in [RFC4072] with an
   addition of Diameter QoS specific AVPs.  Figure 3 shows the DEA
   message used with the Diameter QoS AVPs:



     <Diameter-EAP-Answer> ::= < Diameter Header: 268, PXY >
                               < Session-Id >
                               { Auth-Application-Id }
                               { Auth-Request-Type }
                               { Result-Code }
                               { Origin-Host }
                               { Origin-Realm }

                             * [ QoS-Resources ]


                               [ Session-Timeout ]
                               [ Authz-Session-Lifetime ]
                               [ Authz-Grace-Period ]
                               [ User-Name ]
                               ...
                             * [ AVP ]

                   Figure 3: Diameter EAP Answer Command

3.4.  Credit-Control-Request (CCR)

   The Credit-Control-Request (CCR) command [RFC4006], indicated by the
   Command-Code field set to 272 and the 'R' bit set in the Command
   Flags field, may be sent by the NAS to the Diameter-QoS server to
   request QoS credit authorization for a given QoS provisioning
   request.  In that case the CCR command MAY also carry the QoS-
   Resources AVPs.

   The message format is the same as defined in [RFC4006] with an
   addition of Diameter QoS specific AVPs.  Figure 4 shows the CCR
   message used with the Diameter QoS AVPs:













Korhonen, et al.         Expires August 30, 2007                [Page 5]

Internet-Draft         QoS attributes for Diameter         February 2007


     <Credit-Control-Request> ::= < Diameter Header: 272, REQ, PXY >
                                < Session-Id >
                                { Auth-Application-Id }
                                { Origin-Host }
                                { Origin-Realm }
                                { Destination-Realm }
                                { Auth-Request-Type }
                                { Service-Context-Id }
                                { CC-Request-Type }
                                { CC-Request-Number }
                                [ Destination-Host ]
                                [ User-Name ]

                              * [ QoS-Resources ]

                                ...
                              * [ AVP ]

                 Figure 4: Credit Control Request Command

3.5.  Credit-Control-Answer (CCA)

   The Credit-Control-Answer (CCA) command [RFC4006], indicated by the
   Command-Code field set to 272 and the 'R' bit set in the Command
   Flags field is sent in response to the CC-Request (CCR) message to
   acknowledge a CC-Request command.  If the Diameter QoS server was
   able to fulfill the QoS request (if needed) then the response MAY
   include the QoS-Resources AVPs.

   The message format is the same as defined in [RFC4006] with an
   addition of Diameter QoS specific AVPs.  Figure 5 shows the CCA
   message used with the Diameter QoS AVPs:



















Korhonen, et al.         Expires August 30, 2007                [Page 6]

Internet-Draft         QoS attributes for Diameter         February 2007


     <Credit-Control-Answer> ::= < Diameter Header: 272, PXY >
                                < Session-Id >
                                { Result-Code }
                                { Origin-Host }
                                { Origin-Realm }
                                { Auth-Application-Id }
                                { CC-Request-Type }
                                { CC-Request-Number }
                                [ User-Name ]
                                [ CC-Session-Failover ]
                                [ CC-Sub-Session-Id ]
                                [ Acct-Multi-Session-Id ]
                                [ Origin-State-Id ]
                                [ Event-Timestamp ]


                              * [ QoS-Resources ]

                                ...
                              * [ AVP ]

                  Figure 5: Credit Control Answer Command

3.6.  AA-Request (AAR)

   The AA-Request (AAR) message, indicated by the Command-Code field set
   to 265 and 'R' bit set in the Command Flags field, may be sent by the
   NAS to the Diameter server providing network access configuration
   services.  At the same time with the network access configuration the
   NAS MAY request QoS Resources Authorization, to authorize for the
   provision of QoS.  In that case the AAR command MAY also carry the
   QoS-Resources AVPs.

   The message format is the same as defined in [RFC4005] with an
   addition of Diameter QoS specific AVPs.  Figure 6 shows the AAR
   message used with the Diameter QoS AVPs:















Korhonen, et al.         Expires August 30, 2007                [Page 7]

Internet-Draft         QoS attributes for Diameter         February 2007


     <AA-Request> ::= < Diameter Header: 265, REQ, PXY >
                      < Session-Id >
                      { Auth-Application-Id }
                      { Origin-Host }
                      { Origin-Realm }
                      { Destination-Realm }
                      { Auth-Request-Type }

                    * [ QoS-Resources ]

                      [ Destination-Host ]
                      ...
                    * [ AVP ]

                       Figure 6: AA Request Command

3.7.  AA-Answer (AAA)

   The AA-Answer (AAA) message, indicated by the Command-Code field set
   to 265 and 'R' bit cleared in the Command Flags field is sent in
   response to the AA-Request (AAR) message for confirmation of the
   result of QoS provisioning.  If the QoS service is successfully
   authorized and the Diameter server was able to fulfill the QoS
   provisioning request (if needed) then the response MAY include the
   QoS-Resources AVPs.

   The message format is the same as defined in [RFC4005] with an
   addition of Diameter QoS specific AVPs.  Figure 7 shows the AAA
   message used with the Diameter QoS AVPs:






















Korhonen, et al.         Expires August 30, 2007                [Page 8]

Internet-Draft         QoS attributes for Diameter         February 2007


     <AA-Answer> ::= < Diameter Header: 265, PXY >
                     < Session-Id >
                     { Auth-Application-Id }
                     { Auth-Request-Type }
                     { Result-Code }
                     { Origin-Host }
                     { Origin-Realm }

                   * [ QoS-Resources ]

                     [ Authz-Session-Lifetime ]
                     [ Authz-Grace-Period ]

                     [ User-Name ]
                     [ Session-Timeout ]
                     ...
                   * [ AVP ]

                        Figure 7: AA Answer Command


4.  Diameter QoS Defined AVPs

   The following table lists the Diameter AVPs used by this document,
   their AVP code values, types, possible flag values, and whether the
   AVP may be encrypted.


                                                  ---------------------
                                                  |    AVP Flag rules |
   +----------------------------------------------|----+---+----+-----+
   |                       AVP  Section           |    |   |SHLD| MUST|
   | Attribute Name        Code Defined Data Type |MUST|MAY| NOT|  NOT|
   +----------------------------------------------+----+---+----+-----+
   |QoS-Flow-State         TBD    7.4  Enumerated |    | P |    |  V  |
   |QSPEC                  TBD    7.4  OctetSTring|    | P |    |  V  |
   |QoS-ID                 TBD    7.4  Unsigned32 |    | P |    |  V  |
   |ExtendedQoSFilterRule  TBD    7.4  OctetString|    | P |    |  V  |
   |QoS-Resources          TBD    7.4  Grouped    |    | P |    |  V  |
   +----------------------------------------------+----+---+----+-----+
   |M - Mandatory bit. An AVP with "M" bit set and its value MUST be  |
   |    supported and recognized by a Diameter entity in order the    |
   |    message, which carries this AVP, to be accepted.              |
   |P - Indicates the need for encryption for end-to-end security.    |
   |V - Vendor specific bit that indicates whether the AVP belongs to |
   |    a address space.                                              |
   +------------------------------------------------------------------+




Korhonen, et al.         Expires August 30, 2007                [Page 9]

Internet-Draft         QoS attributes for Diameter         February 2007


   The above-mentioned attributes are defined in
   [I-D.ietf-dime-diameter-qos].


5.  Examples


User                             AAA Client                   AAA server
    |                                |                                |
    |        (initiate EAP)          |                                |
    |<------------------------------>|                                |
    |                                | Diameter-EAP-Request           |
    |                                | EAP-Payload(EAP Start)         |
    |                                |------------------------------->|
    |                                |                                |
    |                                |            Diameter-EAP-Answer |
    |                           Result-Code=DIAMETER_MULTI_ROUND_AUTH |
    |                                |    EAP-Payload(EAP Request #1) |
    |                                |<-------------------------------|
    |          EAP Request(Identity) |                                |
    |<-------------------------------|                                |
    |                                |                                |
    | EAP Response #N                |                                |
    |------------------------------->|                                |
    |                                | Diameter-EAP-Request           |
    |                                | EAP-Payload(EAP Response #N)   |
    |                                |------------------------------->|
    |                                |                                |
    |                                |            Diameter-EAP-Answer |
    |                                |   Result-Code=DIAMETER_SUCCESS |
    |                                |       EAP-Payload(EAP Success) |
    |                                |       [EAP-Master-Session-Key] |
    |                                |           (authorization AVPs) |
    |                                |                 QoS-Resources  |
    |                                |<-------------------------------|
    |                                |                                |
    |                    EAP Success |                                |
    |<-------------------------------|                                |

     Figure 9: Example of AAA Server providing QoS Information to AAA
                                  Client


6.  AVP Occurrence Tables







Korhonen, et al.         Expires August 30, 2007               [Page 10]

Internet-Draft         QoS attributes for Diameter         February 2007


6.1.  DER and DEA Commands AVP Table

   The following table lists the additional Diameter QoS specific AVPs
   that may be present in the DER and DEA Commands, as defined in this
   document and in [RFC4072].


                                        +---------------+
                                        |  Command-Code |
                                        |-------+-------+
         Attribute Name                 |  DER  |  DEA  |
         -------------------------------+-------+-------+
         QoS-Resources                  |   0+  |   0+  |
                                        +-------+-------+

                 Figure 10: DER and DEA Commands AVP table

6.2.  CCR and CCA Commands AVP Table

   The following table lists the additional Diameter QoS specific AVPs
   that may be present in the CCR and CCA Commands, as defined in this
   document and in [RFC4006].


                                        +---------------+
                                        |  Command-Code |
                                        |-------+-------+
         Attribute Name                 |  CCR  |  CCA  |
         -------------------------------+-------+-------+
         QoS-Resources                  |   0+  |   0+  |
                                        +-------+-------+





                 Figure 11: CCR and CCA Commands AVP table

6.3.  AAR and AAA Commands AVP Table

   The following table lists the additional Diameter QoS specific AVPs
   that may be present in the AAR and AAA Commands, as defined in this
   document and in [RFC4005].








Korhonen, et al.         Expires August 30, 2007               [Page 11]

Internet-Draft         QoS attributes for Diameter         February 2007


                                        +---------------+
                                        |  Command-Code |
                                        |-------+-------+
         Attribute Name                 |  AAR  |  AAA  |
         -------------------------------+-------+-------+
         QoS-Resources                  |   0+  |   0+  |
                                        +-------+-------+

                 Figure 12: AAR and AAA Commands AVP table


7.  IANA Considerations

   This document does not require actions by IANA.


8.  Security Considerations

   TBD


9.  References

9.1.  Normative References

   [I-D.ietf-dime-diameter-qos]
              Zorn, G., McCann, P., Tschofenig, H., Tsou, T., and A.
              Doria, "Diameter Quality of Service Application",
              draft-ietf-dime-diameter-qos-00.txt (work in progress),
              February 2006.

   [I-D.ietf-nsis-qspec]
              Ash, J., "QoS NSLP QSPEC Template",
              draft-ietf-nsis-qspec-15 (work in progress),
              February 2007.

   [I-D.korhonen-dime-qos-parameters]
              Korhonen, J. and H. Tschofenig, "Quality of Service
              Parameters for RADIUS and Diameter",
              draft-korhonen-dime-qos-parameters-00.txt (work in
              progress), February 2006.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2234]  Crocker, D., Ed. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", RFC 2234, November 1997.




Korhonen, et al.         Expires August 30, 2007               [Page 12]

Internet-Draft         QoS attributes for Diameter         February 2007


   [RFC3588]  Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J.
              Arkko, "Diameter Base Protocol", RFC 3588, September 2003.

   [RFC4005]  Calhoun, P., Zorn, G., Spence, D., and D. Mitton,
              "Diameter Network Access Server Application", RFC 4005,
              August 2005.

   [RFC4006]  Hakala, H., Mattila, L., Koskinen, J-P., Stura, M., and J.
              Loughney, "Diameter Credit-Control Application", RFC 4006,
              August 2005.

9.2.  Informative References

   [RFC2210]  Wroclawski, J., "The Use of RSVP with IETF Integrated
              Services", RFC 2210, September 1997.

   [RFC2327]  Handley, M. and V. Jacobson, "SDP: Session Description
              Protocol", RFC 2327, April 1998.

   [RFC2749]  Herzog, S., Boyle, J., Cohen, R., Durham, D., Rajan, R.,
              and A. Sastry, "COPS usage for RSVP", RFC 2749,
              January 2000.

   [RFC2753]  Yavatkar, R., Pendarakis, D., and R. Guerin, "A Framework
              for Policy-based Admission Control", RFC 2753,
              January 2000.

   [RFC2865]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              RFC 2865, June 2000.

   [RFC4027]  Josefsson, S., "Domain Name System Media Types", RFC 4027,
              April 2005.

   [RFC4072]  Eronen, P., Hiller, T., and G. Zorn, "Diameter Extensible
              Authentication Protocol (EAP) Application", RFC 4072,
              August 2005.














Korhonen, et al.         Expires August 30, 2007               [Page 13]

Internet-Draft         QoS attributes for Diameter         February 2007


Authors' Addresses

   Jouni Korhonen (editor)
   TeliaSonera
   Teollisuuskatu 13
   Sonera  FIN-00051
   Finland

   Email: jouni.korhonen@teliasonera.com


   Mayutan Arumaithurai
   University of Goettingen


   Email: mayutan.arumaithurai@gmail.com


   Hannes Tschofenig
   Siemens Networks GmbH & Co KG
   Otto-Hahn-Ring 6
   Munich, Bavaria  81739
   Germany

   Email: Hannes.Tschofenig@siemens.com
   URI:   http://www.tschofenig.com

























Korhonen, et al.         Expires August 30, 2007               [Page 14]

Internet-Draft         QoS attributes for Diameter         February 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Korhonen, et al.         Expires August 30, 2007               [Page 15]


