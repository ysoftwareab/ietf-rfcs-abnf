<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Integrity of In-situ OAM Data Fields</title>
<meta content="Frank Brockners" name="author">
<meta content="Shwetha Bhandari" name="author">
<meta content="Tal Mizrahi" name="author">
<meta content="Justin Iurman" name="author">
<meta content="
       In-situ Operations, Administration, and Maintenance (IOAM) records 
      operational and telemetry information in the packet while the packet
      traverses a path in the network. IETF protocols require features to
      ensure their security. This document describes the integrity protection
      of IOAM-Data-Fields. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="in-situ" name="keyword">
<meta content="Telemetry, Tracing" name="keyword">
<meta content="draft-ietf-ippm-ioam-data-integrity-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-ippm-ioam-data-integrity-71abuagm.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">IOAM-Data-Fields Integrity</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Brockners, et al.</td>
<td class="center">Expires 3 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ippm</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ippm-ioam-data-integrity-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-02" class="published">2 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-03">3 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Brockners</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Bhandari</div>
<div class="org">Thoughtspot</div>
</div>
<div class="author">
      <div class="author-name">T. Mizrahi</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">J. Iurman</div>
<div class="org">ULiege</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Integrity of In-situ OAM Data Fields</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">In-situ Operations, Administration, and Maintenance (IOAM) records 
      operational and telemetry information in the packet while the packet
      traverses a path in the network. IETF protocols require features to
      ensure their security. This document describes the integrity protection
      of IOAM-Data-Fields.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-threat-analysis" class="xref">Threat Analysis</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-modification-ioam-data-fiel" class="xref">Modification: IOAM-Data-Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-modification-ioam-option-ty" class="xref">Modification: IOAM Option-Type Headers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-injection-ioam-data-fields" class="xref">Injection: IOAM-Data-Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-injection-ioam-option-type-" class="xref">Injection: IOAM Option-Type Headers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-management-and-exporting" class="xref">Management and Exporting</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-delay" class="xref">Delay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-threat-summary" class="xref">Threat Summary</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-integrity-protected-option-" class="xref">Integrity Protected Option-Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-integrity-protected-trace-o" class="xref">Integrity Protected Trace Option-Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-integrity-protected-pot-opt" class="xref">Integrity Protected POT Option-Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-integrity-protected-e2e-opt" class="xref">Integrity Protected E2E Option-Type</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-methods-for-space-optimized" class="xref">Methods for space optimized integrity protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-symmetric-key-based-signatu" class="xref">Symmetric key based signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-asymmetric-key-based-signat" class="xref">Asymmetric key based signature</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-ioam-option-type-registry" class="xref">IOAM Option-Type Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-ioam-integrity-protection-a" class="xref">IOAM Integrity Protection Algorithm Suite Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-replay-protection" class="xref">Replay protection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">"In-situ" Operations, Administration, and Maintenance (IOAM) records 
      OAM information within the packet while the packet traverses a
      particular network domain. The term "in-situ" refers to the fact that
      the OAM data is added to the data packets rather than being sent
      within packets specifically dedicated to OAM. IOAM is to complement
      mechanisms such as Ping or Traceroute.
      In terms of "active" or "passive" OAM, "in-situ" OAM can be considered a
      hybrid OAM type. "In-situ" mechanisms do not require extra packets to be
      sent. IOAM adds information to the already available data packets and
      therefore cannot be considered passive. In terms of the classification
      given in <span>[<a href="#RFC7799" class="xref">RFC7799</a>]</span>, IOAM could be portrayed as Hybrid Type
      I. IOAM mechanisms can be leveraged where mechanisms using, e.g., ICMP do
      not apply or do not offer the desired results, such as proving that a
      certain traffic flow takes a pre-defined path, SLA verification for the
      data traffic, detailed statistics on traffic distribution paths in
      networks that distribute traffic across multiple paths, or scenarios in
      which probe traffic is potentially handled differently from regular data
      traffic by the network devices.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The current <span>[<a href="#I-D.ietf-ippm-ioam-data" class="xref">I-D.ietf-ippm-ioam-data</a>]</span> assumes that
      IOAM is deployed in limited domains, where an operator has
      means to select, monitor, and control the access to all the networking
      devices, making the domain a trusted network. As such, IOAM-Data-Fields
      are carried in clear within packets and there are no protections against
      any node or middlebox tampering with the data. 
      IOAM-Data-Fields collected in an untrusted or semi-trusted environment
      require integrity protection to support critical operational decisions.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The following considerations and
      requirements are to be taken into account in addition to addressing the
      problem of detectability of any integrity breach of the IOAM-Data-Fields
      collected:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-4">
<li id="section-1-4.1">IOAM data is processed by the data plane, hence viability
          of any method to prove integrity of the IOAM-Data-Fields must be
          feasible at data plane processing/forwarding rates (IOAM might
          be applied to all traffic a router forwards).<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
        <li id="section-1-4.2">IOAM data is carried within packets. Additional space
          required to prove integrity of the IOAM-Data-Fields needs to be optimal, i.e.
          should not exceed the MTU or have adverse effect on packet
          processing.<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
        <li id="section-1-4.3">Replay protection of older IOAM data should be possible.
          Without replay protection, a rogue node can present the old IOAM
          data, masking any ongoing network issues/activity and making the
          IOAM-Data-Fields collection useless.<a href="#section-1-4.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-1-5">This document defines the methods to protect the integrity of
       IOAM-Data-Fields, using the IOAM Option-Types
       specified in <span>[<a href="#I-D.ietf-ippm-ioam-data" class="xref">I-D.ietf-ippm-ioam-data</a>]</span>
       as an example. The methods similarly apply to
       other IOAM Option-Types which contain IOAM-Data-Fields.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
<div id="Conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Abbreviations used in this document:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">IOAM:</dt>
        <dd style="margin-left: 5.5em" id="section-2-3.2">In-situ Operations, Administration, and
          Maintenance<a href="#section-2-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">MTU:</dt>
        <dd style="margin-left: 5.5em" id="section-2-3.4">Maximum Transmit Unit<a href="#section-2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">OAM:</dt>
        <dd style="margin-left: 5.5em" id="section-2-3.6">Operations, Administration, and Maintenance<a href="#section-2-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">POT:</dt>
        <dd style="margin-left: 5.5em" id="section-2-3.8">Proof of Transit<a href="#section-2-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">E2E:</dt>
        <dd style="margin-left: 5.5em" id="section-2-3.10">Edge to Edge<a href="#section-2-3.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-3">
      <h2 id="name-threat-analysis">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-threat-analysis" class="section-name selfRef">Threat Analysis</a>
      </h2>
<p id="section-3-1">This section presents a threat analysis of integrity-related threats
      in the context of IOAM. The threats that are discussed are assumed to be
      independent of the lower layer protocols; it is assumed that threats at
      other layers are handled by security mechanisms that are deployed at
      these layers.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This document is focused on integrity protection for IOAM-Data-Fields.
      Thus the threat analysis includes threats that are related to or
      result from compromising the integrity of IOAM-Data-Fields. Other
      security aspects such as confidentiality are not within the scope of
      this document.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Throughout the analysis there is a distinction between on-path and
      off-path attackers. As discussed in <span>[<a href="#I-D.ietf-detnet-security" class="xref">I-D.ietf-detnet-security</a>]</span>, on-path attackers are located in a
      position that allows interception and modification of in-flight protocol
      packets, whereas off-path attackers can only attack by generating
      protocol packets.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The analysis also includes the impact of each of the threats.
      Generally speaking, the impact of a successful attack on an OAM protocol
      <span>[<a href="#RFC7276" class="xref">RFC7276</a>]</span> is a false illusion of nonexistent failures or
      preventing the detection of actual ones; in both cases, the attack may
      result in denial of service (DoS). Furthermore, creating the false
      illusion of a nonexistent issue may trigger unnecessary processing in
      some of the IOAM nodes along the path, and may cause more IOAM-related
      data to be exported to the management plane than is conventionally
      necessary. Beyond these general impacts, threat-specific impacts are
      discussed in each of the subsections below.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="ModifDataSec">
<section id="section-3.1">
        <h3 id="name-modification-ioam-data-fiel">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-modification-ioam-data-fiel" class="section-name selfRef">Modification: IOAM-Data-Fields</a>
        </h3>
<p id="section-3.1-1">Threat<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1-2.1">An attacker can maliciously modify the IOAM-Data-Fields of
            in-transit packets. The modification can either be applied to all
            packets or selectively applied to a subset of the en route
            packets. This threat is applicable to on-path attackers.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">Impact<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1-4.1">By systematically modifying the IOAM-Data-Fields of some or all
            of the in-transit packets, an attacker can create a false picture
            of the paths in the network, the existence of faulty nodes and
            their location, and the network performance.<a href="#section-3.1-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ModifHeaderSec">
<section id="section-3.2">
        <h3 id="name-modification-ioam-option-ty">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-modification-ioam-option-ty" class="section-name selfRef">Modification: IOAM Option-Type Headers</a>
        </h3>
<p id="section-3.2-1">Threat<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-2.1">An on-path attacker can modify the header in IOAM Option-Types
            in order to change or disrupt the
            behavior of nodes processing IOAM-Data-Fields along the path. This
            threat is not within the scope of this document.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-3">Impact<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-4.1">Changing the header of IOAM Option-Types may have several
            implications. An attacker can maliciously increase the processing
            overhead in nodes that process IOAM-Data-Fields and increase the
            on-the-wire overhead of IOAM-Data-Fields, for example by modifying
            the IOAM-Trace-Type field in the IOAM Trace Option-Type header. An
            attacker can also prevent some of the nodes that process
            IOAM-Data-Fields from incorporating IOAM-Data-Fields, by modifying
            the RemainingLen field in the IOAM Trace Option-Type header.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<section id="section-3.3">
        <h3 id="name-injection-ioam-data-fields">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-injection-ioam-data-fields" class="section-name selfRef">Injection: IOAM-Data-Fields</a>
        </h3>
<p id="section-3.3-1">Threat<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.3-2.1">An attacker can inject packets with IOAM Option-Types and
            IOAM-Data-Fields. This threat is applicable to both on-path and
            off-path attackers.<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-3">Impact<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.3-4.1">This attack and its impacts are similar to <a href="#ModifDataSec" class="xref">Section 3.1</a>.<a href="#section-3.3-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-3.4">
        <h3 id="name-injection-ioam-option-type-">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-injection-ioam-option-type-" class="section-name selfRef">Injection: IOAM Option-Type Headers</a>
        </h3>
<p id="section-3.4-1">Threat<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.4-2.1">An attacker can inject packets with IOAM Option-Type headers,
            thus manipulating other nodes that process IOAM-Data-Fields in the
            network. This threat is applicable to both on-path and off-path
            attackers. This threat is not within the scope of this document.<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-3">Impact<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.4-4.1">This attack and its impacts are similar to <a href="#ModifHeaderSec" class="xref">Section 3.2</a>.<a href="#section-3.4-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-3.5">
        <h3 id="name-management-and-exporting">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-management-and-exporting" class="section-name selfRef">Management and Exporting</a>
        </h3>
<p id="section-3.5-1">Threat<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.5-2.1">Attacks that compromise the integrity of IOAM-Data-Fields can
            be applied at the management plane, e.g., by manipulating network
            management packets. Furthermore, the integrity of IOAM-Data-Fields
            that are exported to a receiving entity can also be compromised.
            Management plane attacks are not within the scope of this
            document; the network management protocol is expected to include
            inherent security capabilities. The integrity of exported data is
            also not within the scope of this document. It is expected that
            the specification of the export format will discuss the relevant
            security aspects.<a href="#section-3.5-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.5-3">Impact<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.5-4.1">Malicious manipulation of the management protocol can cause
            nodes that process IOAM-Data-Fields to malfunction, to be
            overloaded, or to incorporate unnecessary IOAM-Data-Fields into
            user packets. The impact of compromising the integrity of exported
            IOAM-Data-Fields is similar to the impacts of previous threats
            that were described in this section.<a href="#section-3.5-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-3.6">
        <h3 id="name-delay">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-delay" class="section-name selfRef">Delay</a>
        </h3>
<p id="section-3.6-1">Threat<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.6-2.1">An on-path attacker may delay some or all of the in-transit
            packets that include IOAM-Data-Fields in order to create the false
            illusion of congestion. Delay attacks are well known in the
            context of deterministic networks <span>[<a href="#I-D.ietf-detnet-security" class="xref">I-D.ietf-detnet-security</a>]</span> and synchronization <span>[<a href="#RFC7384" class="xref">RFC7384</a>]</span>, and may be somewhat mitigated in these
            environments by using redundant paths in a way that is resilient
            to an attack along one of the paths. This approach does not
            address the threat in the context of IOAM, as it does not meet the
            requirement to measure a specific path or to detect a problem
            along the path. It is noted that this threat is not within the
            scope of the threats that are mitigated in this
            document.<a href="#section-3.6-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-3">Impact<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.6-4.1">Since IOAM can be applied to a fraction of the traffic, an
            attacker can detect and delay only the packets that include
            IOAM-Data-Fields, thus preventing the authenticity of delay and load
            measurements.<a href="#section-3.6-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-3.7">
        <h3 id="name-threat-summary">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-threat-summary" class="section-name selfRef">Threat Summary</a>
        </h3>
<span id="name-threat-analysis-summary"></span><div id="ThreatSummary">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-3.7-1.1">
<pre>

+-------------------------------------------+--------+------------+
| Threat                                    |In scope|Out of scope|
+-------------------------------------------+--------+------------+
|Modification: IOAM-Data-Fields             |   +    |            |
+-------------------------------------------+--------+------------+
|Modification: IOAM Option-Type Headers     |        |     +      |
+-------------------------------------------+--------+------------+
|Injection: IOAM-Data-Fields                |   +    |            |
+-------------------------------------------+--------+------------+
|Injection: IOAM Option-Type Headers        |        |     +      |
+-------------------------------------------+--------+------------+
|Management and Exporting                   |        |     +      |
+-------------------------------------------+--------+------------+
|Delay                                      |        |     +      |
+-------------------------------------------+--------+------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-threat-analysis-summary" class="selfRef">Threat Analysis Summary</a>
          </figcaption></figure>
</div>
</section>
</section>
<section id="section-4">
      <h2 id="name-integrity-protected-option-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-integrity-protected-option-" class="section-name selfRef">Integrity Protected Option-Types</a>
      </h2>
<p id="section-4-1">This section defines new IOAM Option-Types to be allocated in the IOAM
    Option-Type Registry. Their purpose is to carry IOAM-Data-Fields with
    integrity protection. Each of the IOAM Option-Types defined in <span>[<a href="#I-D.ietf-ippm-ioam-data" class="xref">I-D.ietf-ippm-ioam-data</a>]</span> is extended as follows:<a href="#section-4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-2">
        <dt id="section-4-2.1">64</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.2">IOAM Pre-allocated Trace Integrity Protected
            Option-Type: corresponds to the IOAM Pre-allocated Trace Option-Type
            with integrity protection.<a href="#section-4-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.3">65</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.4">IOAM Incremental Trace Integrity Protected
            Option-Type: corresponds to the IOAM Incremental Trace Option-Type
            with integrity protection.<a href="#section-4-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.5">66</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.6">IOAM POT Integrity Protected Option-Type:
            corresponds to the IOAM POT Option-Type with integrity protection.<a href="#section-4-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.7">67</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.8">IOAM E2E Integrity Protected Option-Type:
            corresponds to the IOAM E2E Option-Type with integrity protection.<a href="#section-4-2.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-3">The Integrity Protection subheader follows the IOAM Option-Type
      header when the IOAM Option-Type is an Integrity Protected Option-Type.
      It is defined as follows:<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-4">
<pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Signature-suite|  Nonce length |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Nonce                             ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Signature                           ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4-5">
        <dt id="section-4-5.1">Signature-suite:</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.2">8-bit unsigned integer. 
        This field defines the algorithms used to compute the digest 
        and the signature over the IOAM-Data-Fields.<a href="#section-4-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.3">Nonce length:</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.4">8-bit unsigned integer. This field
        specifies the length of the Nonce in octets.<a href="#section-4-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.5">Reserved:</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.6">16-bit Reserved field. MUST be set to zero
        upon transmission and ignored upon receipt.<a href="#section-4-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.7">Nonce:</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.8"> Variable length field with length specified
        in Nonce length.<a href="#section-4-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.9">Signature:</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.10"> Digital signature value generated
        by the method and algorithm specified by Signature-suite.<a href="#section-4-5.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<section id="section-4.1">
        <h3 id="name-integrity-protected-trace-o">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-integrity-protected-trace-o" class="section-name selfRef">Integrity Protected Trace Option-Types</a>
        </h3>
<p id="section-4.1-1">Both the IOAM Pre-allocated Trace Option-Type header and the IOAM
        Incremental Trace Option-Type header, as defined in <span>[<a href="#I-D.ietf-ippm-ioam-data" class="xref">I-D.ietf-ippm-ioam-data</a>]</span>, are followed by the Integrity
        Protection subheader when the IOAM Option-Type is respectively set to
        the IOAM Pre-allocated Trace Integrity Protected Option-Type or the IOAM
        Incremental Trace Integrity Protected Option-Type:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Namespace-ID          | NodeLen | Flags | RemainingLen|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                IOAM-Trace-Type                |   Reserved    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Signature-suite|  Nonce length |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Nonce                             ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Signature                           ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-4.2">
        <h3 id="name-integrity-protected-pot-opt">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-integrity-protected-pot-opt" class="section-name selfRef">Integrity Protected POT Option-Type</a>
        </h3>
<p id="section-4.2-1">The IOAM POT Option-Type header, as defined in <span>[<a href="#I-D.ietf-ippm-ioam-data" class="xref">I-D.ietf-ippm-ioam-data</a>]</span>, is followed by the Integrity
        Protection subheader when the IOAM Option-Type is set to the IOAM POT
        Integrity Protected Option-Type:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Namespace-ID          | IOAM-POT-Type | IOAM-POT-Flags|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Signature-suite|  Nonce length |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Nonce                             ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Signature                           ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-4.3">
        <h3 id="name-integrity-protected-e2e-opt">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-integrity-protected-e2e-opt" class="section-name selfRef">Integrity Protected E2E Option-Type</a>
        </h3>
<p id="section-4.3-1">The IOAM E2E Option-Type header, as defined in <span>[<a href="#I-D.ietf-ippm-ioam-data" class="xref">I-D.ietf-ippm-ioam-data</a>]</span>, is followed by the Integrity
        Protection subheader when the IOAM Option-Type is set to the IOAM E2E
        Integrity Protected Option-Type:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Namespace-ID          |         IOAM-E2E-Type         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Signature-suite|  Nonce length |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Nonce                             ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Signature                           ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
</section>
</section>
<section id="section-5">
      <h2 id="name-methods-for-space-optimized">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-methods-for-space-optimized" class="section-name selfRef">Methods for space optimized integrity protection</a>
      </h2>
<p id="section-5-1">Methods for space optimized integrity protection can leverage symmetric
      or asymmetric key based signatures, as described in the subsections below.
      The Signature consumes 32 octets and is carried only once for the entire
      packet. In case of performance concerns, such method can be applied to a
      subset of the traffic by using sampling of data to enable IOAM with
      integrity protection. Both symmetric and asymmetric signature methods work
      as follows:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-2">
<li id="section-5-2.1">The encapsulating node creates a nonce and stores it in the Nonce
          field of the Integrity Protection subheader. The signature is
          generated over the Nonce field and the hash of IOAM-Data-Fields it has
          inserted, i.e., sign(Nonce || hash(IOAM-Data-Fields)). IOAM-Data-Fields that
          will be updated in-place MUST be excluded from the signature (e.g.,
          the POT Cumulative field). The signature is stored in the Signature
          field of the Integrity Protection subheader. Important note: if all
          the inserted IOAM-Data-Fields are to be updated in-place, or if there is no
          IOAM-Data-Field at all, the encapsulating node MUST NOT use an Integrity
          Protected Option-Type.<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.2">A transit node generates a signature over the Signature field and
          the hash of IOAM-Data-Fields it has inserted, i.e.,
          sign(Signature || hash(IOAM-Data-Fields)). IOAM-Data-Fields that are updated
          in-place MUST be excluded from the signature (e.g., the POT Cumulative
          field). The signature is stored in the Signature field of the
          Integrity Protection subheader. Important note: if all the IOAM-Data-Fields
          involved are updated in-place, or if there is no IOAM-Data-Field involved,
          the transit node MUST NOT generate a signature and MUST NOT update the
          Signature field.<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.3">The decapsulating node behaves exactly the same as a transit node.
          The only difference is that the signature MAY NOT be required when the
          decapsulating node is also the Validator, for obvious performance
          reasons.<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.4">The Validator recreates the signature over IOAM-Data-Fields collected
          and checks the integrity against the Signature field. In order to
          recompute the signature, the Validator iteratively follows the same
          procedure as for the encapsulating, transit and decapsulating nodes,
          in that order. It is trivial in some cases (e.g., POT Type-0 or E2E),
          where only the encapsulating node generates a signature. For other
          cases where transit nodes also generate a signature (e.g., Trace
          Option-Types), node-ids MUST be recorded. Details on how the mapping
          between node-ids and keys is implemented are outside the scope of this
          document.<a href="#section-5-2.4" class="pilcrow">¶</a>
</li>
      </ol>
<section id="section-5.1">
        <h3 id="name-symmetric-key-based-signatu">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-symmetric-key-based-signatu" class="section-name selfRef">Symmetric key based signature</a>
        </h3>
<p id="section-5.1-1">This method assumes that symmetric keys have been distributed to
        the respective nodes as well as the Validator (the Validator receives
        all the keys). The details of the mechanisms responsible for key
        distribution are outside the scope of this document.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">This method MUST use an algorithm pair defined in <a href="#IOAM-IP-registry" class="xref">Section 6.2</a> and the approach MUST be symmetric.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-asymmetric-key-based-signat">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-asymmetric-key-based-signat" class="section-name selfRef">Asymmetric key based signature</a>
        </h3>
<p id="section-5.2-1">This method assumes that asymmetric keys have been generated per
        IOAM node and the respective nodes can access their keys (the
        Validator receives all the public keys). The details of the mechanisms
        responsible for key distribution are outside the scope of this
        document.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">This method MUST use an algorithm pair defined in <a href="#IOAM-IP-registry" class="xref">Section 6.2</a> and the approach MUST be asymmetric.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</section>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="IOAM-type-registry">
<section id="section-6.1">
        <h3 id="name-ioam-option-type-registry">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ioam-option-type-registry" class="section-name selfRef">IOAM Option-Type Registry</a>
        </h3>
<p id="section-6.1-1">This draft defines the following new code points in the IOAM
        Option-Type Registry:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-2">
          <dt id="section-6.1-2.1">64</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-2.2">IOAM Pre-allocated Trace Integrity Protected
            Option-Type<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-2.3">65</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-2.4">IOAM Incremental Trace Integrity Protected
            Option-Type<a href="#section-6.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-2.5">66</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-2.6">IOAM POT Integrity Protected Option-Type<a href="#section-6.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-2.7">67</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-2.8">IOAM E2E Integrity Protected Option-Type<a href="#section-6.1-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IOAM-IP-registry">
<section id="section-6.2">
        <h3 id="name-ioam-integrity-protection-a">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-ioam-integrity-protection-a" class="section-name selfRef">IOAM Integrity Protection Algorithm Suite Registry</a>
        </h3>
<p id="section-6.2-1">"IOAM Integrity Protection Algorithm Suite Registry" in the
        "In-Situ OAM (IOAM) Protocol Parameters" group. The one-octet "IOAM
        Integrity Protection Algorithm Suite Registry" identifiers assigned by
        IANA identify the digest algorithm and signature algorithm used in the
        Signature Suite Identifier field. IANA has registered the following
        algorithm suite identifiers for the digest algorithm and for the
        signature algorithm.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span id="name-ioam-integrity-protection-al"></span><figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre>
 Algorithm
 Suite        Digest        Signature    Specification
 Identifier   Algorithm     Algorithm    Pointer           Approach
+-----------+------------+-------------+----------------+------------+
| 0x00      | Reserved   | Reserved    | This document  |    None    |
+-----------+------------+-------------+----------------+------------+
| 0x01      | SHA-256    | ECDSA P-256 | [SHS] [DSS]    | Asymmetric |
|           |            |             | [RFC6090]      |            |
|           |            |             | This document  |            |
+-----------+------------+-------------+----------------+------------+
| 0x02      | SHA-256    | AES-256     | [AES]          | Symmetric  |
|           |            |             | [NIST.800-38D] |            |
|           |            |             | This document  |            |
+-----------+------------+-------------+----------------+------------+
| 0x03-0xFF | Unassigned | Unassigned  |                |            |
+-----------+------------+-------------+----------------+------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-ioam-integrity-protection-al" class="selfRef">IOAM Integrity Protection Algorithm         Suite Registry</a>
          </figcaption></figure>
<p id="section-6.2-3"> Future assignments are to be made using the Standards
        Action process defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Assignments
        consist of the one-octet algorithm suite identifier value and the
        associated digest algorithm name and signature algorithm name.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This section discusses additional security aspects.<a href="#section-7-1" class="pilcrow">¶</a></p>
<section id="section-7.1">
        <h3 id="name-replay-protection">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-replay-protection" class="section-name selfRef">Replay protection</a>
        </h3>
<p id="section-7.1-1">The nonce makes a signature chain unique but does not necessarily
        prevent replay attacks. To enable replay protection, both the encap node
        and the validator MUST synchronize on a unique nonce, e.g., based on a
        timestamp only valid for a short period of time.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">The authors would like to thank Santhosh N, Rakesh Kandula, Saiprasad
      Muchala, Al Morton, Greg Mirsky, Benjamin Kaduk and Martin Duke for their comments
      and advice.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AES">[AES]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Advanced Encryption Standard (AES)"</span>, <span class="seriesInfo"> FIPS PUB 197</span>, <time datetime="2001" class="refDate">2001</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DSS">[DSS]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo"> NIST FIPS Publication 186-4,               DOI 10.6028/NIST.FIPS.186-4</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-detnet-security">[I-D.ietf-detnet-security]</dt>
        <dd>
<span class="refAuthor">Grossman, E.</span>, <span class="refAuthor">Mizrahi, T.</span>, and <span class="refAuthor">A. J. Hacker</span>, <span class="refTitle">"Deterministic Networking (DetNet) Security Considerations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-detnet-security-16</span>, <time datetime="2021-03-02" class="refDate">2 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-detnet-security-16.txt">https://www.ietf.org/archive/id/draft-ietf-detnet-security-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ippm-ioam-data">[I-D.ietf-ippm-ioam-data]</dt>
        <dd>
<span class="refAuthor">Brockners, F.</span>, <span class="refAuthor">Bhandari, S.</span>, and <span class="refAuthor">T. Mizrahi</span>, <span class="refTitle">"Data Fields for In-situ OAM"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ippm-ioam-data-17</span>, <time datetime="2021-12-13" class="refDate">13 December 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ippm-ioam-data-17.txt">https://www.ietf.org/archive/id/draft-ietf-ippm-ioam-data-17.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.800-38D">[NIST.800-38D]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <span class="seriesInfo"> NIST Special Publication 800-38D</span>, <time datetime="2001" class="refDate">2001</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf">http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7276">[RFC7276]</dt>
        <dd>
<span class="refAuthor">Mizrahi, T.</span>, <span class="refAuthor">Sprecher, N.</span>, <span class="refAuthor">Bellagamba, E.</span>, and <span class="refAuthor">Y. Weingarten</span>, <span class="refTitle">"An Overview of Operations, Administration, and Maintenance (OAM) Tools"</span>, <span class="seriesInfo">RFC 7276</span>, <span class="seriesInfo">DOI 10.17487/RFC7276</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7276">https://www.rfc-editor.org/info/rfc7276</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7384">[RFC7384]</dt>
        <dd>
<span class="refAuthor">Mizrahi, T.</span>, <span class="refTitle">"Security Requirements of Time Protocols in Packet Switched Networks"</span>, <span class="seriesInfo">RFC 7384</span>, <span class="seriesInfo">DOI 10.17487/RFC7384</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7384">https://www.rfc-editor.org/info/rfc7384</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7799">[RFC7799]</dt>
        <dd>
<span class="refAuthor">Morton, A.</span>, <span class="refTitle">"Active and Passive Metrics and Methods (with Hybrid Types In-Between)"</span>, <span class="seriesInfo">RFC 7799</span>, <span class="seriesInfo">DOI 10.17487/RFC7799</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7799">https://www.rfc-editor.org/info/rfc7799</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
      <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo"> NIST FIPS Publication 180-4,               DOI 10.6028/NIST.FIPS.180-4</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Frank Brockners</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">Hansaallee 249, 3rd Floor</span></div>
<div dir="auto" class="left">
<span class="postal-code">40549</span> <span class="locality">DUESSELDORF</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fbrockne@cisco.com" class="email">fbrockne@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shwetha Bhandari</span></div>
<div dir="auto" class="left"><span class="org">Thoughtspot</span></div>
<div dir="auto" class="left"><span class="street-address">3rd Floor, Indiqube Orion, 24th Main Rd, Garden Layout, HSR Layout</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore, KARNATAKA 560 102</span> </div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shwetha.bhandari@thoughtspot.com" class="email">shwetha.bhandari@thoughtspot.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tal Mizrahi</span></div>
<div dir="auto" class="left"><span class="org">Huawei</span></div>
<div dir="auto" class="left"><span class="street-address">8-2 Matam</span></div>
<div dir="auto" class="left">
<span class="locality">Haifa</span> <span class="postal-code">3190501</span>
</div>
<div dir="auto" class="left"><span class="country-name">Israel</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tal.mizrahi.phd@gmail.com" class="email">tal.mizrahi.phd@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Justin Iurman</span></div>
<div dir="auto" class="left"><span class="org">Universite de Liege</span></div>
<div dir="auto" class="left"><span class="street-address">10, Allee de la decouverte (B28)</span></div>
<div dir="auto" class="left">
<span class="postal-code">4000</span> <span class="locality">Sart-Tilman</span>
</div>
<div dir="auto" class="left"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:justin.iurman@uliege.be" class="email">justin.iurman@uliege.be</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
