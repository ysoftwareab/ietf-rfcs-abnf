<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Support for Multiple Signature Algorithms in Cryptographically Generated 
				Addresses (CGAs)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Support for Multiple Signature Algorithms in Cryptographically Generated 
				Addresses (CGAs)">
<meta name="keywords" content="CGA, extension, ECDSA">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">CGA &amp; Send maintenance</td><td class="header">T. Cheneau</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">M. Maknavicius</td></tr>
<tr><td class="header">Expires: August 25, 2009</td><td class="header">TMSP</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Sean</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Huawei</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Vanderveen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Qualcomm</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 21, 2009</td></tr>
</table></td></tr></table>
<h1><br />Support for Multiple Signature Algorithms in Cryptographically Generated 
				Addresses (CGAs)<br />draft-cheneau-cga-pk-agility-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 25, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>  
				This document defines an extension field for the CGA Parameter data structure specified in RFC 3972.  This extension field carries a Public Key that is used in Cryptographically Generated Address (CGA) generation. This extension enables protocols using CGAs, such as SEND, to use multiple Public Key signing algorithms and/or multiple Public Keys.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#sec-PK_ext">2.</a>&nbsp;
Public Key extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">2.1.</a>&nbsp;
Public Key extension format<br />
<a href="#sec-cga-gen">3.</a>&nbsp;
CGA Generation Process<br />
<a href="#sec-consideration">4.</a>&nbsp;
Security Consideration<br />
<a href="#sec-iana">5.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">6.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">6.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">6.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>   	Cryptographically Generated Addresses (CGA) <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a> have been
			designed primarily for securing Neighbor Discovery <a class='info' href='#RFC3971'>[RFC3971]<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a>.
		                A digital signature algorithm is used to 
			provide authentication and integrity protection when CGA is used.  
			CGAs <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a> were defined to only use RSA as the associated signature algorithm. 
			Only one RSA public key is associated with a CGA and this public key  is carried in 
			the Public Key field of the CGA Parameter data structure. 
	
</p>
<p>	The secure neighbor discovery  usage scenarios have recently been extended 
			to include environments with mobile or nomadic nodes. These nodes can often be
			limited in power and memory capabilities, and thus may only be able to support
			lightweight public key cryptography; that is, RSA-based public keys and algorithm 
			support may not be feasible. 
</p>
<p>        Therefore, support for signature 	algorithm agility in CGA is desired. However, 
			since the CGA specification <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a> states that SEND "SHOULD" 
			use an RSA public/private key pair,  backward compatibility is preserved herein.   
		
</p>
<p>	A logical place for extending the CGA Parameter data structure to include other
			types of public keys is its "extension fields". Some guidance on the format of 
			these extensions is provided in <a class='info' href='#RFC4581'>[RFC4581]<span> (</span><span class='info'>Bagnulo, M. and J. Arkko, &ldquo;Cryptographically Generated Addresses (CGA) Extension Field Format,&rdquo; October&nbsp;2006.</span><span>)</span></a>.
			One type of CGA Parameter data structure extension is defined in 
			<a class='info' href='#sec-PK_ext'>Section&nbsp;2<span> (</span><span class='info'>Public Key extension</span><span>)</span></a> and this type of extension is able to carry public keys,
			in addition to the RSA public key defined in the Public Key field of CGA Parameters data structure.  
		
</p>
<p>
				These extensions allows new functionnalities on CGA based protocols, such as the Signature Algorithm Agility in SEND <a class='info' href='#cheneau-send-sig-agility'>[cheneau&#8209;send&#8209;sig&#8209;agility]<span> (</span><span class='info'>Cheneau, T., Laurent-Maknavicius, M., Shen, S., and M. Vanderveen, &ldquo;Signature Algorithm Agility in the Secure Neighbor Discovery (SEND) Protocol,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>.
			
</p>
<a name="sec-PK_ext"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Public Key extension</h3>

<p>This section describes an extension field that conforms to the guidelines of <a class='info' href='#RFC4581'>[RFC4581]<span> (</span><span class='info'>Bagnulo, M. and J. Arkko, &ldquo;Cryptographically Generated Addresses (CGA) Extension Field Format,&rdquo; October&nbsp;2006.</span><span>)</span></a>.
</p>
<p>This extension allows a CGA Parameters data structure to carry  public keys in addition to the key in the Public Key field. 
			This approach paves the way for one CGA to possibly be associated with multiple public keys.
</p>
<p>This extension allows a node to select a Public Key value that is different from the one in the Public Key field of the CGA Parameters data 
			structure option. This Public Key is placed in an extension embedded in the Extension field of the CGA Parameters data structure,
			described in <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Public Key extension format</h3>
<br /><hr class="insert" />
<a name="fig-PK_ext"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Extension Type        |      Extension Length         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                       Public Key                              ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Public Key extension format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
				</p>
<blockquote class="text"><dl>
<dt>Extension Type</dt>
<dd> <br />
TBA. (16-bit unsigned integer. See <a class='info' href='#sec-iana'>Section&nbsp;5<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.)
</dd>
<dt>Extension Length</dt>
<dd><br />
 The length of the Public Key field to follow, in octets.
						16-bit unsigned integer. 
</dd>
<dt>Public Key</dt>
<dd><br />
 
					
			This is a variable-length field containing the public key of the
			sender.  The public key MUST be formatted as a DER-encoded
			<a class='info' href='#ITU.X690.2002'>[ITU.X690.2002]<span> (</span><span class='info'>International Telecommunication Union, &ldquo;Information Technology - ASN.1 encoding rules: 						Specification of Basic Encoding Rules (BER), 						Canonical Encoding Rules (CER) and Distinguished 						Encoding Rules (DER),&rdquo; July&nbsp;2002.</span><span>)</span></a> ASN.1 structure of the type SubjectPublicKeyInfo,
			defined in the Internet X.509 certificate profile <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  
			
			When RSA is used, the algorithm identifier MUST be rsaEncryption, which is
			1.2.840.113549.1.1.1, and the RSA public key MUST be formatted by
			using the RSAPublicKey type as specified in Section 2.3.1 of  <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.  
			The RSA key length SHOULD be at least 384 bits.
						<br />
<br />
		
			When ECC is used, the algorithm identifier MUST be of type id-ecPublicKey (OID 1.2.840.10045.2.1), as defined in  
			<a class='info' href='#ID-pkix-ecc'>[ID&#8209;pkix&#8209;ecc]<span> (</span><span class='info'>Turner, S. and et. al, &ldquo;Elliptic Curve Cryptography Subject Public Key Information,&rdquo; December&nbsp;2008.</span><span>)</span></a>. ECC public key encoding is specified in this reference.
			
			      Note that the ECC key lengths are determined by the ECParameters field named namedCurves (curves implying key length).
			      
			      
					
						<br />
<br />

			
			
			
					
</dd>
</dl></blockquote><p>
		
</p>
<a name="sec-cga-gen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
CGA Generation Process</h3>

<p> When a node supports two or more types of signing algorithms, and is able to generate two or more corresponding public keys, 
				then it can derive a single CGA using all these keys. The  derivation is done exactly as in <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>; one key is
				placed in the CGA Parameters data structure "Public Key" field  while the rest of the keys are  placed in separate extension fields . This is illustrated in <a class='info' href='#multi-cga'>Figure&nbsp;2<span> (</span><span class='info'>CGA parameter structure with multiple keys</span><span>)</span></a>.
		
</p>
<p>It should be noted that the type of the public key (RSA, ECC, etc.) is already encoded into the 
			"Public Key" field itself, and thus there is no need to identify the public key type separately. This is due to the fact that the "Public Key" field, according to
			<a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a> is a DER-encoded ASN.1 structure of the type "SubjectPublicKeyInfo", and therefore
			includes a subfield called "AlgorithmIdentifier". 
		
</p><br /><hr class="insert" />
<a name="multi-cga"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  List of keys             CGA parameter Data structure

                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       |                             |
                       +         Modifier            |
                       |                             |
                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       |                             |
                       +      Subnet Prefix          +
                       |                             |
                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       |Col Count|                   |
+-+-+-+-+-+-+-+-+      +-+-+-+-+-+
|               |      |        Public Key           |
~  Public Key 1 ~ -&gt;   ~                             ~
|               |      |     (variable length)       |
+-+-+-+-+-+-+-+-+      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
+-+-+-+-+-+-+-+-+      |         Extension           |
|               |      ~       Public Key 2          ~
~  Public Key 2 ~ -&gt;   |     (variable length)       |
|               |      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
+-+-+-+-+-+-+-+-+      |                             |
                       ~           ...               ~
                       |                             |
+-+-+-+-+-+-+-+-+      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|               |      |         Extension           |
~  Public Key N ~ -&gt;   ~       Public Key N          ~
|               |      |     (variable length)       |
+-+-+-+-+-+-+-+-+      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       |      Extension Fields       |
                       ~                             ~
                       | (optional, variable length) |
                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: CGA parameter structure with multiple keys&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> The resulting CGA Parameters data structure is inserted into a CGA option as per <a class='info' href='#RFC3971'>[RFC3971]<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a>. 
				When sending a NDP packet, the node includes this CGA option and also one signature option of choice,
				computed with a private key whose corresponding Public Key is present in the CGA Parameters data structure.
				This signature option can be the RSA signature option as per <a class='info' href='#RFC3971'>[RFC3971]<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a>,
			or another signature option, e.g. the ECC signature option as per <a class='info' href='#ID-csi-ecc'>[ID&#8209;csi&#8209;ecc]<span> (</span><span class='info'>Shen, S. and M. Vanderveen, &ldquo;ECC Support for SEND/CGA,&rdquo; October&nbsp;2008.</span><span>)</span></a>,
			or any other signature defined. The signature option contains the hash of the key used to sign
				the message. 
		
</p>
<p>Note that an implementation should choose the number of simultaneous Public Key Extensions fields used so as the
			total length of the extension fields does not exceed a threshold that requires fragmentation support at the
			SEND or other upper-layer protocol layer.
			
</p>
<p>Support for RSA Public Keys and signature algorithm is only RECOMMENDED for backward compatibility. 
			This specification does not mandate support for any particular public key signature algorithm. 
			Therefore, nodes can be configured to choose/support only a single additional signature algorithm 
			besides RSA. However, a node is also free to not support RSA and still claim 
			compatibility with this specification. 
		
</p>
<p> Since <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>  mandates the use of RSA  keys in the Public Key field, a node compatible with
			<a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a> only will  extract the RSA public key from the Public Key field and ignore the extension fields.
			Therefore, in order to achieve backward compatibility, if a node uses a CGA associated with multiple public keys (through 
			the use of the Public Key extension), the following procedures are in place: if one of the public keys is of RSA type, 
			then that key SHOULD be placed in the Public Key field of the CGA Parameter data structure, while the other
			key(s) SHOULD  be placed in the Extension field(s).  
			
			
			
		
</p>
<a name="sec-consideration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Consideration</h3>

<p> The document specifies a CGA extension field format. No additional vulnerabilities 
			appear besides those  described in section 7 of  <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>
</p>
<p> However , it should be noted that the resulting security level of a multiple-key CGA is only that of the weakest key. 
			Therefore, the requirement remains that every key in use should have a security level matching or exceeding
			that of a 384-bit RSA key.
</p>
<p>	Whenever protocols negotiate signature algorithms, downgrade attacks are considered. 
			This document only provides the ability for CGA options to carry multiple public keys;
			negotiations of signature algorithms or public keys are out of the scope of this document.
		
</p>
<a name="sec-iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p> This document defines one new CGA Extension Type <a class='info' href='#RFC4581'>[RFC4581]<span> (</span><span class='info'>Bagnulo, M. and J. Arkko, &ldquo;Cryptographically Generated Addresses (CGA) Extension Field Format,&rdquo; October&nbsp;2006.</span><span>)</span></a> option, which must
			be assigned by IANA: </p>
<blockquote class="text">
<p>Name: Public Key Extension Type; 
</p>
<p> Value: TBA. 
</p>
<p> Description: see <a class='info' href='#sec-PK_ext'>Section&nbsp;2<span> (</span><span class='info'>Public Key extension</span><span>)</span></a>.
				
</p>
</blockquote><p>
		
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3972">[RFC3972]</a></td>
<td class="author-text">Aura, T., &ldquo;<a href="http://tools.ietf.org/html/rfc3972">Cryptographically Generated Addresses (CGA)</a>,&rdquo; RFC&nbsp;3972, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3972.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3971">[RFC3971]</a></td>
<td class="author-text">Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;<a href="http://tools.ietf.org/html/rfc3971">SEcure Neighbor Discovery (SEND)</a>,&rdquo; RFC&nbsp;3971, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3971.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4982">[RFC4982]</a></td>
<td class="author-text">Bagnulo, M. and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc4982">Support for Multiple Hash Algorithms in Cryptographically Generated Addresses (CGAs)</a>,&rdquo; RFC&nbsp;4982, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4982.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4861">[RFC4861]</a></td>
<td class="author-text">Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;<a href="http://tools.ietf.org/html/rfc4861">Neighbor Discovery for IP version 6 (IPv6)</a>,&rdquo; RFC&nbsp;4861, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4861.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4581">[RFC4581]</a></td>
<td class="author-text">Bagnulo, M. and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc4581">Cryptographically Generated Addresses (CGA) Extension Field Format</a>,&rdquo; RFC&nbsp;4581, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4581.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3279">[RFC3279]</a></td>
<td class="author-text">Bassham, L., Polk, W., and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3279, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3279.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4866">[RFC4866]</a></td>
<td class="author-text">Arkko, J., Vogt, C., and W. Haddad, &ldquo;<a href="http://tools.ietf.org/html/rfc4866">Enhanced Route Optimization for Mobile IPv6</a>,&rdquo; RFC&nbsp;4866, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4866.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="ITU.X690.2002">[ITU.X690.2002]</a></td>
<td class="author-text">International Telecommunication Union, &ldquo;Information Technology - ASN.1 encoding rules:
						Specification of Basic Encoding Rules (BER),
						Canonical Encoding Rules (CER) and Distinguished
						Encoding Rules (DER),&rdquo; ITU-T Recommandation&nbsp;X.690, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="ID-csi-ecc">[ID-csi-ecc]</a></td>
<td class="author-text">Shen, S. and M. Vanderveen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-shen-csi-ecc-01.txt">ECC Support for SEND/CGA</a>,&rdquo; draft-shen-csi-ecc-01 (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-shen-csi-ecc-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="ID-pkix-ecc">[ID-pkix-ecc]</a></td>
<td class="author-text">Turner, S. and et. al, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-ecc-subpubkeyinfo-11.txt">Elliptic Curve Cryptography Subject Public Key Information</a>,&rdquo; draft-ietf-pkix-ecc-subpubkeyinfo-11 (work in progress), December&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-ecc-subpubkeyinfo-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="cheneau-send-sig-agility">[cheneau-send-sig-agility]</a></td>
<td class="author-text">Cheneau, T., Laurent-Maknavicius, M., Shen, S., and M. Vanderveen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-cheneau-send-sig-agility-00.txt">Signature Algorithm Agility in the Secure Neighbor Discovery (SEND) Protocol</a>,&rdquo; draft-cheneau-send-sig-agility-00 (work in progress), Feb&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-cheneau-send-sig-agility-00.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tony Cheneau</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Institut TELECOM, TELECOM SudParis, CNRS SAMOVAR UMR 5157</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">9 rue Charles Fourier</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Evry  91011</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tony.cheneau@it-sudparis.eu">tony.cheneau@it-sudparis.eu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Maryline Laurent-Maknavicius</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Institut TELECOM, TELECOM SudParis, CNRS SAMOVAR UMR 5157</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">9 rue Charles Fourier</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Evry  91011</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:maryline.maknavicius@it-sudparis.eu">maryline.maknavicius@it-sudparis.eu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sean Shen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:sshen@huawei.com">sshen@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Michaela Vanderveen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mvandervn@gmail.com">mvandervn@gmail.com</a></td></tr>
</table>
</body></html>
