Internet Engineering Task Force                      Mike Kallas(Editor)
INTERNET DRAFT                                           Nortel Networks
<draft-ietf-megaco-otherpkgs-00.txt>           Zacharias Bilalis(Editor)
Category: Standards Track(?)                                     Siemens
Expires: July 20, 2000

Contributions from:
                                                 Klaus Hoffmann Siemens
                                                 Klaus Pulverer Siemens
                                      Peter Blatherwick Nortel Networks
                                                 Bob Bell Cisco Systems
                                                   Markku Korpi Siemens
                                           Nancy Greene Nortel Networks
                                             Tom Taylor Nortel Networks
                                           Richard Bach Nortel Networks
                                              Christian Ruppelt Siemens
                                               Gunnar Hellstrom Omnitor
                                   James Rafferty Brooktrout Technology
                                          Glenn Parsons Nortel Networks
                                                     Roy Spitzer Telogy
                                             Jinchi Chu Nortel Networks

        MEGACO Packages Not Included In MEGACO/H.248 White Draft


STATUS OF THIS MEMO

  This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.  Note that other
groups may also distribute working documents as Internet- Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet- Drafts as reference material
or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.







Bilias, Kallas                                                  [Page 1]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


ABSTRACT

   This document is work in progress. It gathers together all  packages
that have not yet been included in Annex E of Megaco/H.248 White Draft.
It proposes additional text for MEGACO/H.248. This document is expected
to be used at the Adelaide IETF meeting.

                           TABLE OF CONTENTS

        1       FAX/Textphone/Modem Tones Detection Package  .. .. .. .. ..  3
        2       Dynamic Tone definition package ..  .. .. .. .. .. .. .. ..  4
        3       NAS Package .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ..  6
        4       Announcement PACKAGE .. .. .. .. .. .. .. .. .. .. .. .. ..  9
        5       Signal Processing Network Equipment (SPNE) Package .. .. .. 10
        6       Display Package.. .. .. .. .. .. .. .. .. .. .. .. .. .. .. 13
        7       Key Package .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. 16
        8       Keypad Package .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. 17
        9       Label Key Package .. .. .. .. .. .. .. .. .. .. .. .. .. .. 18
        10      Function Key Package .. .. .. .. .. .. .. .. .. .. .. .. .. 19
        11      Indicator Package .. .. .. .. .. .. .. .. .. .. .. .. .. .. 21
        12      Soft Key Package  .. .. .. .. .. .. .. .. .. .. .. .. .. .. 22
        13      Ancillary Input Package .. .. .. .. .. .. .. .. .. .. .. .. 24
        14      Text Conversation package  .. .. .. .. .. .. .. .. .. .. .. 25
        15      Text Telephone package  .. .. .. .. .. .. .. .. .. .. .. .. 30
        16      Call Type Discrimination package .. .. .. .. .. .. .. .. .. 40
        17      Fax package .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. 49
        18      MoDem package ... .. .. .. .. .. .. .. .. .. .. .. .. .. .. 53
        19      References  .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. 57
        20      Author's Addresses.. .. .. .. .. .. .. .. .. .. .. .. .. .. 59






















Bilias, Kallas                                                  [Page 2]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


1 FAX/TEXTPHONE/MODEM TONES DETECTION PACKAGE

PackageID: ftmd, 0x0020
Version: 1
Extends: tonedet version 1


This package defines an event to detect the presence of data traffic
(fax, textphone or modem) on a line. The main intention of this event
may be used to effect the compression option on the line so that an
audio codec capable of transmitting modem signals can be invoked to han-
dle the connection when needed. This Package extends the possible values
of tone id in the "start tone detected" event.

Additional detectable tone id values:

dtfm, 0x0039

This tone id is generated when the following tones are detected.

For Fax:
        CNG;            a T.30 fax calling
        V21flag,        a V21 tone and flags for fax answering

For Text
        CIV18;  a V.8/V.18 CI
        XCI;            a V.18 XCI
        V18txp  a V.18 txp signal
        Belltone        a Bell 103 carrier, either the high or the low frequency
                        channel
        Baudot  a Baudot initial tone and character
        Edt             an EDT initial tone and character

For Data
        CIdata  a V.8/data CI

Common to Voice and Text
        Dtmf            a DTMF signal

Common to Text and Data
        CT              a V.25 calling tone
        V21tone a V.21 carrier either the high or the low frequency channel
        V23tone a V.23 carrier either the high or the low frequency channel

Common to Fax, Text and Data
        V8bis           a V.8 bis modem handshaking signal
        ANS or CED      V.25 ANS, equivalent to T.30 CED from answering terminal
        ANSAM   V.8 ANSAM



Bilias, Kallas                                                  [Page 3]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


2 DYNAMIC TONE DEFINITION PACKAGE

PackageID: dtd, 0x0021

Version: 1

Extends: None

This package defines a mechanism to redefine existing tones and create
new tones for playback. The existing tones are the ones described in
supported packages that extend the tonegen generic package.

2.1  Properties

Tone ID
  PropertyID: tid (0x0001)
  Description:
  Indicates the new or existing tone to be modified or who's tone string is
  to be read.
  Type: expanding enumeration
  Possible Values:
  Existing tone ids described in supported packages that extend tonegen or
  new tone ids to be added.
  Defined in: TerminationState.

If the termination is in a context. The changes to the tones apply only
to the termination in the context. When the termination leaves the con-
text. The changes are lost. If the termination is in the null context,
the changes apply to the termination from then on. If the termination is
root, the changes apply to the whole gateway.

Characteristics: both read and write.

Tone String
  PropertyID: tst (0x0002)
  Description: Tone description string. Described later
  Type: String
  Possible Values: grammar described later.
  Defined in: TerminationState.
  Characteristics: both read and write:

Note:

If you write to tid, you can then set tst to a new value or read the
current value in tst. If you read tid you get a list of the existing and
new tones.
To modify or create a new Tone:
1- set tid to an existing or new tone id



Bilias, Kallas                                                  [Page 4]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


2- set tst to the new tone description
if tst is null the id is decommissioned and removed. Only newly
defined tonids can be removed.

To read the list of tones defines:
1- read tid

To read an already defined tone string:
1- set tid
2- read tst
Some package-defined tones may not have a tone string in the
gateway. In that case the tst read will have the value "Not Available"

Tone String (tst) description:

The syntax for the tone definition string is recursive and uses
parenthesis as a delimiter of elements. DefToneString below is the tone
string(tst)
DefToneString = "(" DefToneElement ["*" RepeatCount ] ")" [","/"+"/"X"
DefToneString]

NOTE: a separator of ',' indicates that the next definition follows
sequentially in time; a separator of  '+' indicates that the following
tone is to be mixed with the previous tone and is simultaneous with it;
a separator of 'X' indicates that the first tone is modulated by the
second tone.

NOTE: All implementations must support sequential definitions (','
separator). Mixing ('+') and modulation ('X') support are optional, how-
ever the implementation must make a best effort and return no error in
these cases.

NOTE: Recursion is limited to a maximum of 32 Levels. All implementa-
tions must support at least 2 levels of recursion.
RepeatCount = %d1-32767 / %d0
        NOTE: repeatcount of 0 indicates infinite repeating.

DefToneElement = ToneName ["," ToneDuration [ "," ToneAmplitude ]]
ToneName = Tone id / "#"FreqValue / "&"AnnouncementParameterList
Tone id = 1*VCHAR; Unique tone identity string or value
FreqValue = %d0-4000; in Hertz
AnnouncementParameterList = AnnouncementID ["," SubstitutionString]
AnnouncementID = 1*VCHAR; Unique identifier for an audio announcement
SubstitutionString = """1*VCHAR"""; a TTS string to be inserted into an
announcement.
ToneDuration = %d1-32767 / %d0 ; In Milliseconds
NOTE: ToneDuration of 0 indicates infinite duration or duration defined
by the Tone id.



Bilias, Kallas                                                  [Page 5]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


ToneAmplitude = "-"%d32-1 / %d0; In dBm0

An examples of some tone definitions follows.

ReorderTone = ((((#480)+(#620)),250,-24),(sil,250))*0

SITTone = (#950,330,-24), (sil,30), (#1400,330,-24), (sil,30),
(#1800,330,-24), (sil,30)

NumberYouHaveDialed = (SITTone), (&NumberDialed,"555-1234")

        Note: above tone definitions are from SR-TSV-002275.

2.2  Events

None

2.3  Signals

None

2.4 Statistics

None

2.5 Procedures

None

3 NAS PACKAGE

PackageID: nas, 0x0022

Version: 1

Extends: none

This package supports the functionality of a Media Gateway as NAS (Net-
work Access Server). This encompasses the support of dial-in access to
the NAS, but not the contact to a AAA server for authentication, author-
ization, and the possible subsequent set-up of a layer 2 tunnel to a
remote NAS. Those are autonomous functions of a NAS and therefore out of
scope for the Megaco protocol  (see e.g. IETF RFC 2661 (L2TP) and RFC
1661 (PPP)).

3.1   Properties

VPN id



Bilias, Kallas                                                  [Page 6]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  PropertyId: vpnid (0x0001)
  Description: identifies VPN
  Type: integer
  Possible Values: vpnid
  Defined in: Termination State

3.2 Events

NAS Failure
  EventID: nasfail (0x0001)
  Description:
  Signals on the termination the detection of a failure due to
  external or internal (in the Media Gateway) reasons.

EventDescriptor Parameters:

streamid
  ParameterID: strid (0x0001)
  Description: ID of the stream being reported on.
  Type: integer
  Value: streamID

ObservedEventDescriptor Parameters:

Error code
  ParameterID: ec (0x0002)
  Description: describes the failure reason
  Type:   2 bytes
  Possible values: Default: 0000 (internal error)

Authorization succeeded
  EventID: authsucc (0x0002)
  Description:
  This event signals that authorization by the AAA server for the requested
  service was successful (see for example IETF RFC 2138 (RADIUS))

EventDescriptor Parameters:

streamid
  ParameterID: strid (0x0001)
  Description: ID of the stream being reported on.
  Type: integer
  Value: streamID

ObservedEventDescriptor Paramters:

none



Bilias, Kallas                                                  [Page 7]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


Authorization denied
  EventID: authden (0x0003)
  Description:
  This event signals that authorization by the AAA server for the requested
  service was denied (see for example IETF RFC 2138 (RADIUS)).

EventDescriptor Parameters:

streamid
  ParameterID: strid (0x0001)
  Description: ID of the stream being reported on.
  Type: integer
  Value: streamID

Call back Request
  EventID: cbr (0x0004)
  Description:
  The call back event is used to notify that a call-back has been
  requested by the AAA server during the initial phase of a data connec-
  tion (see IETF RFC 2138  (RADIUS)). The event report includes the iden-
  tification of the user to be called  back, e.g. E.164 number.

EventDescriptor Parameters:

ParameterName: streamid  (0x0001)
  ParameterID: strid
  Description: ID of the stream being reported on.
  Type: integer
  Value: streamID

Authentication Authorisation and Accounting (AAA) Failure
  EventID: aaafail (0x0005)
  Description: Used to signal failure of the AAA server.

EventDescriptor Parameters:

ParameterName: streamid
  ParameterID: strid (0x0001)
  Description: ID of the stream being reported on.
  Type: integer
  Value: streamID

3.3 Signals

None



Bilias, Kallas                                                  [Page 8]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


3.4 Statistics

None

3.5 Procedures

none

4 ANNOUNCEMENT PACKAGE

PackageID: an, 0x0023
Version: 1

Extends: None

That package supports announcement functionality at a Media Gateway

4.1 Properties

None

4.2 Events

Announcement completed

EventID: ac (0x0001)

Description: Indicates the completion of the announcement.

EventDescriptor parameters

None

ObservedEventDescriptor parameters

None

Announcement failure

EventID: af (0x0002)
Description: Indicates the failure of the announcement.

EventDescriptor parameters

None

ObservedEventDescriptor parameters




Bilias, Kallas                                                  [Page 9]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


None

4.3 Signals

Announcement play
  SignalID: ap (0x0003)
  Description: Initiates the play of an announcement

Parameters:

Signal type
  ParameterID: t (0x0001)
  Type: enumeration of announcements.
  Default is TO

Duration
  ParameterID: d (0x0002)
  type: integer.
  Duration is ignored

Specific numbers
  ParameterID: sn (0x0003)
  Type: integer
  Values: any
  Default is provisioned for every announcement.

4.4 Statistics

None

4.5 Procedures

None

5 SIGNAL PROCESSING NETWORK EQUIPMENT (SPNE) PACKAGE

PackageID:  spne, 0x0024

Description: This package contains parameters as defined in ITU Recom-
mendation Q.55, SIGNALLING BETWEEN SIGNAL PROCESSING NETWORK EQUIPMENT
(SPNE) AND INTERNATIONAL SWITCHING CENTRES  (ISC), that specifies con-
trol messages used between an International Switching Exchange and Sig-
nal Processing Network Equipment (SPNE).  SPNE's include echo control,
noise reduction, automatic level control, frequency equalization, and
A-law to Mu-law converters. SPNE functionality may be included in a MG
and should be controllable by the MGC.

Version: 1



Bilias, Kallas                                                 [Page 10]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


Extends: DS0 Package version 1

5.1 Properties

Non-Linear Processor
  PropertyID: nlp (0x000b)
  Description: non-linear processor property
  Type: enumeration
  Possible Values: "on", "off". The default is "off"
  Defined in: LocalControlDescriptor
  Characteristics: Read/Write

Comfort Noise Injection
  PropertyId: cn (0x000c)
  Description: The media gateway may inject comfort noise on the termination.
  Type: enumeration
  Possible Values: "on", "off". The default is off.
  Defined in: LocalControlDescriptor
  Characteristics: Read/Write

Automatic Level Control
  PropertyId: alc (0x0010)
  Description:
  The media gateway may perform automatic level control.  The ALC type is
  determined and configured by manufacturer and/or carrier and is outside
  the scope of this Recommendation.
  Type: enumeration
  Possible Values: "off", "type0", "type1", "type2", "type3". The default is
  "off."
  Defined in: LocalControlDescriptor
  Characteristics: Read/Write

Frequency Equalizer
  PropertyId: fe (0x0020)
  Description:
  The media gateway may perform frequency equalization.  The FE type is
  determined and configured by manufacturer and/or carrier and is outside
  the scope of this Recommendation.
  Type: enumeration
  Possible Values: "off", "type0", "type1", "type2", "type3". The default is
  "off."
  Defined in: LocalControlDescriptor
  Characteristics: Read/Write

Noise Reduction Device
  PropertyId: nrd (0x0030)
  Description:
  The media gateway may perform noise reduction on a call.  The NRD type is



Bilias, Kallas                                                 [Page 11]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  determined and configured by manufacturer and/or carrier and is outside the
  scope of this Recommendation.
  Type: enumeration
  Possible Values: "off", "type0", "type1", "type2", "type3".
  The default is "off."
  Defined in: LocalControlDescriptor
  Characteristics: Read/Write

A-Law to mu-Law Conversion
  PropertyId: amc (0x0040)
  Description:
  The media gateway may perform A-law to mu-law conversion.
  Type: enumeration
  Possible Values:
        "off"  : conversion not used
        "mutoa":  Indicates mu-law to A-law conversion
        "atomu":  Indicates A-law to mu-law conversion
        The default is "off."
  Defined in: LocalControlDescriptor
  Characteristics: Read/Write

5.2 Events
Disabling Tone
  EventID:  dt (0x0001)
  Description:
  This event is triggered when the echo canceller equipment detects in-band
  disabling tone.  This implies looking for both 2100 Hz and 2100 Hz with
  180 degree phase reversal.

EventsDescriptor Parameters:
None

ObservedEventDescriptor Parameters:
ParameterName: tone
  ParameterID: tone
  Type: enumeration
  Possible Values:
        "2100": Indicates a 2100Hz tone
        "2100rev":      Indicates a 2100 Hz tone with 180 degree phase reversal

5.3 Signals

None

5.4 Statistics

None




Bilias, Kallas                                                 [Page 12]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


5.5 Procedures

None

6 DISPLAY PACKAGE

PackageID: dis, 0x0025

Version: 1

Extends: None

This package defines properties and signals associated with text display
user interface elements.

6.1 Properties

Number of rows
  PropertyID: nrows (0x0001)
  Description: Maximum number of rows on the display
  Type: integer
  Defined in: TerminationState.
  Characteristics: read only:

Number of columns
  PropertyID: ncols (0x0002)
  Description: Maximum number of columns on the display
  Type: integer
  Defined in: TerminationState.
  Characteristics: read only:

Supported unicode code pages
  PropertyID: cdpgs (0x0003)
  Description: a list of supported unicode pages
  Type: list of enumerated type
  Defined in: TerminationState.
  Characteristics: read only:

Example: if the text display element supports U+2500 ->U+25ff, U+2600
->U+26ff and U+2700 -> U+277f, this property would return "250, 258,
260, 268, 270" in cdpgs.

Unicode page U+0000 -> U+00ff shall be supported in all implementations.

Cursor row position
  PropertyID: cr (0x0004)
  Type: integer
  Defined in: TerminationState.



Bilias, Kallas                                                 [Page 13]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  Characteristics: read and write:

Cursor column position
  PropertyID: cc (0x0005)
  Type: integer
  Defined in: TerminationState.
  Characteristics: read and write.

Note: row and column numbering begin at 0.  A display's origin is row 0,
column 0.  The origin is at the top left corner

6.2 Events

None

6.3 Signals

Display

  SignalID: di (0x0002)
  Description: Display text

Parameters

Row
  ParameterID: r (0x0001)
  Type: Integer
  Default is current cursor position

Column
  ParameterID: c (0x0002)
  Type: Integer
  Default is current cursor position

String
  ParameterID: st (0x0003)
  Type: String
  Default is empty

Attribute
  ParameterID: a (0x0004)
  Type: enumerated or list of enumerated
  Possible values: plain, blink, invert, underline
  Default Value: Plain


Note 1: Text will be inserted beginning at the row and column given in
the signal parameters, relative to 0,0.  If no row and column parameters



Bilias, Kallas                                                 [Page 14]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


are given, the text will be inserted starting at the current cursor
position.  The current cursor position will always be advanced to the
position immediately after the last character inserted.

Note 2: The attribute parameter will apply to all characters contained
in the signal. If no attribute is provided, plain text will be
displayed.  To turn on an attribute in the middle of a string, one would
send a signal with a beginning sub-string of plain text, follow by a
signal with the desired attribute(s) for the middle sub-string, and fin-
ishing with the signal containing the remaining sub-string of plain
text.

Note 3: A string will not word wrap to the next row.  If a string cannot
fit into the current row, it will be truncated without warning.

Clear Display

  SignalID: cld, 0x0002

  Description:
  This signal clears the entire display and resets the current cursor
  position to the origin (row 0, column 0).

Parameters:

None

6.4 Statistics

None

6.5 Procedures

Unicode is supported to provide for multiple languages.  The Unicode
Standard, Version 2.0 or ISO/IEC 10646-1:1993 [xxx] shall be the defini-
tive standard intended when the term Unicode is used within the context
of this document.  All text display elements shall at least support the
Unicode pages U+0000 -> U+00ff as the basic character set.  All text
strings shall be encoded using UTF-8 as defined in ISO/IEC 10646 AM1
[xxx].

In the Display signal, text will be inserted beginning at the row and
column given in the signal parameters, relative to 0,0.  If no row and
column parameters are given, the text will be inserted starting at the
current cursor position.  The current cursor position will always be
advanced to the position immediately after the last character inserted.

Carriage return <Unicode U+000D> is supported in-string, and moves the



Bilias, Kallas                                                 [Page 15]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


text input to the beginning of the next line, clearing the remainder (if
any) of the current line.

Text wrapping is not provided. A string will not word wrap to the next
row.  If a string cannot fit into the current row, it will be truncated
without warning.

The attribute parameter applies to all characters contained in the
current signal.  If no attribute is provided, plain text will be
displayed.  For example, to turn on an attribute in the middle of a
string, one would send a signal with a beginning sub-string of plain
text, follow by a signal with the desired attribute(s) for the middle
sub-string, and finishing with the signal containing the remaining sub-
string of plain text.


7 KEY PACKAGE

PackageID: key, 0x0026

Version: 1

Extends: none


This package defines the basic behavior of key user interface elements.
Specific key IDs are selected by name (keyid) from the list of keys.
This package does not specify parameter values for keys.

Intended to be extended by other packages which have key behavior.

7.1 Properties

None.

7.2 Events

keydown

  EventID: kd (0x0001)

  Detects dialpad key was pressed.

EventDescriptor parameters:

None.

ObservedEventDescriptor parameters:



Bilias, Kallas                                                 [Page 16]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


keyid (0x0001)
  Type: Enumeration
  Possible values: No values are specified in this package. Extensions to
  this package add possible values for keyid.

keyup

  EventID: ku (0x0002)
  Detects dialpad key up.

EventDescriptor parameters:

None.

ObservedEventDescriptor parameters:

Keyid (0x0001)
  Type: Enumeration
  Possible values: No possible values are specified in this package. Extensions
  to this package would add possible values for keyid.

Duration (0x0002)
  Type: integer
  Units: miliseconds
  Description: Key press duration (key down to key up).

7.3 Signals

None

7.4 Statistics

None

7.5 Procedures

None


8 KEYPAD PACKAGE

PackageID: kp, 0x0027

Version: 1

Extends: key version 1

This package defines the keypad user interface element.  The keypad



Bilias, Kallas                                                 [Page 17]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


package is used to represent a standard 10 digit key pad plus the '*',

Additional keyid values:

        Name                            Description

        k0                              Keypad digit 0
        k1                              Keypad digit 1
        k2                              Keypad digit 2
        k3                              Keypad digit 3
        k4                              Keypad digit 4
        k5                              Keypad digit 5
        k6                              Keypad digit 6
        k7                              Keypad digit 7
        k8                              Keypad digit 8
        k9                              Keypad digit 9
        k*                              Keypad digit *
        k#                              Keypad digit #
        kA                              Keypad digit A
        kB                              Keypad digit B
        kC                              Keypad digit C
        kD                              Keypad digit D

8.1 Additional Properties:

None


9 LABEL KEY PACKAGE

PackageID: labelkey, 0x0028

Version: 1

Extends: key version 1


This package defines the basic behavior of labeled key user interface
elements. Key labels may be used, for example, to provide information to
the MGC regarding pre-configured telephone key assignments, allowing
telephone moves and changes outside the initial administrative domain
without requiring re-configuration of keys.  May also be used to provide
static label information on the telephone user interface, identifying
key function to the user without the need for manual labeling.

Specific keys are addressed by name (keyid) from the list of keys.  This
package does not specify parameter values for keys.




Bilias, Kallas                                                 [Page 18]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


Intended to be extended by other packages which have key behavior.

9.1 Properties

Keylist (0x0001)
        Type: String, using the following format
                {{keyid, label, label_size}, ...}
                [[Editors note: Use ABNF definition]]

Description:
Keylist property allows auditing and setting of keyid/label mapping.  Label
size is also given. This package defines syntax only; no specific keys are
defined.  See derived packages for the actual lists.

9.2 Signals

[[ Note: this signal left from previous versions to show alternate Signals-
based approach to label update.  Now moved to properties section for
consistency.  Comment welcome on which approach is better.  ]]

setlabel

SignalID: sl (0x0001)

Parameters:

keyID   (0x0001)
  Type: Enumeration.
  Possible values: From keyid list above.

label   (0x0002)
  Type: String

  Description:
  Can be used to identify the intent of the function key, as assigned by the
  MGC or by provisioning.  The label may be used, for example, to implement
  self-labeling keys.

9.3 Procedures

None.


10 FUNCTION KEY PACKAGE

PackageID: kf, 0x0029

Version: 1



Bilias, Kallas                                                 [Page 19]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


Extends: labelkey version 1


Common telephone function keys are defined in this package.  This
allows, for example, line keys to be implemented without specific
knowledge of the physical layout of the telephone.

Function keys may have well known names (keyid) associated with func-
tion, for example "hookswitch", "hold", etc.  Function keys may also be
assigned a label identifier by the MGC.

Additional keyid values in keyup and keydown events:

        Name                            Description

        kh                              Hookswitch
        kl                              Hold
        kc                              Conference
        kt                              Transfer
        kl001 - kl999           Set of line keys
        kf001 - kf999           Assignable function keys

10.1 Procedures


Function keys may have well known names (keyid) associated with func-
tion, for example "hookswitch", "hold", etc.  These well know names
identify the purpose of the particular key on the actual device.  Func-
tion keys may also be assigned a label identifier by the MGC.  This
approach avoids assumptions and/or the requirement for application level
knowledge of device-specific configuration of the physical resources to
derive intended function of keys.

Function Keys can be co-related with physically associated Indicators
using Function Key keyid and Indicator indid.  If the IDs are identical,
the MGC application can safely assume that the key and indicator are
physically (or otherwise) associated on the actual device. Again, this
avoids assumptions and/or the requirement for application level
knowledge of device- specific layout of the physical resources.  See
also the Indicator package (ind).

NOTE: The key sense of hookswitch (keyid=kh) is a special case.  Key up
indicates the hookswitch is depressed (i.e. handset is nominally on
hook).  Key down indicates the hookswitch is lifted (i.e. handset is
nominally off hook).  This allows for sensible use of the duration
parameter in the keyup event which will normally give the duration the
handset was off-hook.




Bilias, Kallas                                                 [Page 20]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


11 INDICATOR PACKAGE

PackageID: ind, 0x002a

Version: 1

Extends: None

This package defines the basic behavior of indicator user interface ele-
ments. Specific indicators are addressed by name (indid) from the list
of indicators. Indicators may have well- known names (indid) associated
with function, for example "message waiting", "hold", "line active",
etc. This allows, for example, indicators to be implemented without
specific knowledge of the physical layout of the telephone.

Intended to be possible to extend by other packages which have indicator
behavior.

11.1 Properties

Indicatorlist (0x0001)
        Type: String, using the following format
                {{indid, label, label_size}, ...}
                [[Editors note: Use ABNF definition]]


11.2 Events

None

11.3 Signals

SetIndicator

  SignalID: is (0x0001)
  Set indicator state.

Parameters:

indid (0x0001)
  Type: Enumeration.
  Possible values:
        Name                            Description

        il                              Hold
        ic                              Conference
        il001 - il999           Set of line indicators
        if001 - if999           Assignable function indicators



Bilias, Kallas                                                 [Page 21]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


        ir                              Ringer/Alerter indication
        im                              Message waiting indicator

state (0x0002)
  Type: Enumeration.
  Possible values: On, off, blink, fast_blink, slow_blink. Default is off.

[[ Require separate audible alert package, to cover ringer and other
audible alerts. ]]

11.4 Statistics

None

11.5 Procedures


Indicators can be co-related with physically associated Function Keys
using Indicator indid and Function Key keyid.  If the IDs are identical,
the MGC application can safely assume that the key and indicator are
physically (or otherwise) associated on the actual device. This avoids
assumptions and/or the requirement for application level knowledge of
device- specific layout of the physical resources.

12 SOFT KEY PACKAGE

PackageID: ks, 0x002b

Version: 1

Extends: labelkey version 1

Softkeys are a combination of a function key and a display user inter-
face element, sharing some behavior of each.  Softkeys are intended to
be dynamically updated by the MGC, based on the current state and con-
text of the application controlling the MG.  Since the display aspect
and the key aspect are explicitely bound together, this avoids assump-
tions and/or the requirement for application level knowledge of device-
specific layout of the physical resources.

See Procedures for details.

12.1 Properties

Number of softkeys
  PropertyID: nskeys (0x0002)
  PropertyType: Integer
  haracteristics: read only



Bilias, Kallas                                                 [Page 22]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  Defined in: TerminationState
  Description: Maximum number of individual soft keys.

Display size
  PropertyID: sz (0x0003)
  Type: Integer
  Characteristics: read only
  Defined in: TerminationState
  Description: Maximum number of characters that can be displayed.

Supported unicode code pages
  PropertyID: cdpgs (0x0004)
  Description: a list of supported unicode pages
  Type: list of enumerated type
  Defined in: TerminationState.
  Characteristics: read only

12.2 Signals

SetDisplay

  SignalID: sd (0x0002)

  Description: Set softkey dynamic display content.

Parameters:

keyid (0x0001)
  ParameterID: k
  Type: Enumeration
  Possible values: sk1 - sk999

displayContent (0x0002)
  Parameter ID: d
  Type: String


12.3 Procedures

The display aspect is a subset of the Display (dis) package.  Unicode is
supported to provide for multiple languages [xxx], and all SoftKey ele-
ments shall at least support the Unicode pages U+0000 -> U+00ff as the
basic character set.  All text strings shall be encoded using UTF-8.  If
a string cannot fit into the display area, it will be truncated without
warning.

The key aspect, including Events and labeling, derives directly from
Label Key and Key packages. Softkey identifiers (keyid) are indexed



Bilias, Kallas                                                 [Page 23]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


1,2...N.  N (nskeys) is the maximum number of softkeys supported by the
MG implementation.  Refer to the Label Key (labelkey) and Key (key)
packages for further details.

13 ANCILLARY INPUT PACKAGE

PackageID: anci, 0x002c

Version: 1

Extends: none


The ancillary input package is used to enter user alphanumeric informa-
tion such as text input or scan data, which is forwarded to the MGC for
processing.  The information is presented as a Unicode character encoded
in UTF-8 format [33].

13.1 Properties

None.

13.2 Events

Character input

  EventID: ch (0x0001)

  Description: A character has been input.

EventDescriptor parameters

None

ObservedEventDescriptor parameters:

id (0x0001)
  Type: Character (UTF-8 character)

13.3 Signals

None.

13.4 Statistics

None.

13.5 Procedures



Bilias, Kallas                                                 [Page 24]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


None.


14 TEXT CONVERSATION PACKAGE

Package Name: Text Conversation
  PackageID: txc  (0x0037)
  Version: 1
  Extends: None
  Description:

The Text Conversation package is intended for enabling real time text
conversation between terminals in different networks or multimedia
environments. This package includes the mechanisms needed to transport
T.140 text conversation streams in multimedia environments. The tran-
sport mechanism will be different for each environment where the package
is used.

14.1 Properties

Text buffering time
  PropertyID:             bufftime  (0x0001)
  Type:                   Integer
  Possible values:        0-500
  Defined in:             LocalControl
  Characteristics:        Read/Write
  Description:

This property indicates the time in ms that T.140 data shall be col-
lected before transmission in order to keep overhead from text low. In
low bitrate IP networks, a value of 300 ms is recommended. In environ-
ments with low overhead or high bitrates this property should have the
value 0 enabling immediate transmission of entered characters.


Text termination connection state
  PropertyID:     connstate  (0x0002)
  Type:           Enumeration
  Possible values:
        Idle          for no connection efforts
        Prepare       for being known in the termination and ready 
                      to accept connections
        Initiating    for taking the initiative to establish a text connection
        Accepting     for accepting an incoming request for a session
        Denying       for denying an incoming connect request
        Connected     for completed connection
  Defined in:     TerminationState
  Characteristics: Read/Write



Bilias, Kallas                                                 [Page 25]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  Description:
  The connection state property is used to request a text connection, and
  reflect details of the achieved text connection.

Parameters

UserIdentity
  ParameterID:            userid  (0x0001)
  Type:                   String
  Possible value:         String of up to 64 characters in Unicode UTF-8.
  Description:
  This parameter holds the optional User Identity parameter of a T.140 text
  conversation session.

Transport
  ParameterID:            trpt  (0x0002)
  Type:                   Enumeration
  Possible values:
  H224            for H.224 Client ID=2 in H.320
  AL1             for AL1 in H.324
  TCP             for TCP as in H.323 Annex G [18]
  RTP/T140        for RTP with T140  [19] as in H323 Annex G  [18]
                  or IETF SIP
  RTP/RED/T140    for RTP with T140 and redundancy coding RED as in
                  H323 Annex G or IETF SIP
  T134            for T.134 in the T.120 environment [20]
  unassigned

  Description:
  The Transport parameter reflects the transport mechanism selected for
  the Text Conversation termination.

Text Protocol Version
  ParameterID:    proto (0x0003)
  Type:           Integer
  Possible values:  Any integer corresponding to a T.140 version number.
                    (currently 1)
  Description:    The version of the T.140 protocol used in the connection.

Redundancy Level
  ParameterID:    red (0x0004)
  Type:                   Integer
  Possible values:        0-6
        0=use default or automatic decision on redundancy level (default)
        1=Use no redundancy
        2-6=use specified number of generations of data.
  Description:
  The number of generations to use in RTP redundancy coding including



Bilias, Kallas                                                 [Page 26]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  the Primary.

14.2 Events

Connection State Change
  Event Id:               connchange  (0x0001)
ObservedEventDescriptorParameters
ParameterName:  Connection Change
  ParameterID:    connchng
  Type:           Enumeration
  Possible Value:         As property txc/connstate
  Description:
  This event will occur when the text connection state for the termination
  has changed. Its parameter is the new contents of the Connection State
  property.

14.3 Signals

None

14.4 Statistics
Characters Transferred
  StatisticsID:   chartrans  (0x0001)
  Units:          count
  Description:
  No of bytes of T140 data transferred through the termination.

Lost Packets
  StatisticsID:   packlost  (0x0002)
  Units:          count
  Description:
  Number of T140 packets lost as counted by the receiving T.140 termination.

14.5 Procedures

The following are standard transport mechanisms for text conversation in
different environments.

* In H.320:     H.224 with Client ID=2
* In H.324:     AL1 channel connected with H.245 procedures
* In T.120.     T.134 transport in T.125 communication channel environment.
* In H.323.     RTP/T140 or TCP as selected with H.245 messages.
* In IETF SIP:  RTP/T140 as initiated with SDP.

Note that the T140 text media is also used together with V.18 modems for text
telephony, specified in a separate package: Text_Telephone (txp).

The Text Conversation package is intended to be added to a multimedia
termination, handling appropriate multiplexing and control.



Bilias, Kallas                                                 [Page 27]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


Function
--------

A termination with Text Conversation adds capability declaration for a
text conversation channel in the call setup according to procedures
defined for each environment. When matching capabilities exist, a T140
channel is established according to the transport protocol used in the
current environment. T140 text stream contents received from one termi-
nation is transferred for transmission to other t140 capable termina-
tions in the context. The T140 contents may be buffered for a short
moment for possible collection of more text in the same transmission
according to the buffer time property.

Real time text conversation allows telecom users to carry out a written
conversation. The presentation and coding aspects of standardised text
conversation are defined in ITU-T T.140. Text is transmitted character
by character or in small blocks so that the users experience a direct
connection. The text and basic editing control is ISO 10 646-1, UTF-8
coded. Figure I/1 gives an example of how a text conversation can be
displayed to the user.


        |------------------------------------------------------|
        |              Anne     |         Eve                  |
        |------------------------------------------------------|
        |Hi, this is Anne.      |                              |
        |                       |Oh, hello Anne, I am glad you |
        |                       |are calling!                  |
        |Have you heard that I  |                              |
        |will come to Paris in  |No, that was new to me. What  |
        |November?              |brings you here?              |
        |------------------------------------------------------|
        Figure: Possible display of a one to one text conversation.


For each transport environment, a suitable transport protocol must  be
selected to carry the text. Currently defined and Recommended transport
environments for T.140 text media streams that can be supported by this
package are:

1.   Packet networks, where the procedures described in H.323 Annex G
     can be used to for setting up and conducting text conversation ses-
     sions, using TCP or RTP/T140 for the transport of T.140.

2.   Packet networks, where the IETF Session Initiation Protocol SIP can
     be used for setting up and conducting text conversation sessions
     using RTP/T140 for the transport of T.140.




Bilias, Kallas                                                 [Page 28]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


3.   The H.324 multimedia environment in PSTN, ISDN and Mobile networks,
     where an AL1 channel connected by H.245 procedures is used for
     T.140.

4.   The H.320 multimedia environment, where a H.224 channel with client
     ID=2 is specified for transport of T.140.

5.   The T.120 data conferencing environment, that can be used alone or
     in conjunction with any of the environments above, where T.134
     specifies the application entity and T.125 the data channel for
     T.140.

A separate Text Telephone package (txp) supports text telephony in the
PSTN using the ITU-T V.18 modem in native and legacy modes and T.140 for
communication with terminations using this package.

Interworking between these forms of Text Conversation can be achieved
through the use of gateways with packages defined here.

Total Conversation
------------------

Most text conversation transport environments are part of multimedia
communication systems. With the introduction of text, they enable
conversation in video, text and voice simultaneously, called Total
Conversation. The total set of communication modes that people tend to
use locally can be offered on a distance through Total Conversation.
Since the text part is built on the unified presentation level T.140,
the the task to arrange interoperability of Total Conversation in dif-
ferent network environments through a gateway is simplified.

Video is optional in the multimedia systems. Therefore compatible text-
and-voice conversation can also be established within the same frame-
work.

Descriptor to use for text conversation.
----------------------------------------

One descriptor value is of specific interest for the Text Conversation
and Text Telephone packages. That is the text conversation media stream.
It is described here for information.

Text conversation stream
------------------------

This descriptor is used for the text conversation stream, according to
ITU-T T.140. T.140 gives a general presentation level description for a
termination supporting real time text conversation. The text and basic



Bilias, Kallas                                                 [Page 29]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


editing control is UTF-8 coded. For each transport environment, a suit-
able transport protocol must  be selected to carry the text.

T140 is a registered MIME text stream name, that can be specified to be
used as it is or in RTP embedding.

Examples:

>From MGC to MG in an ADD command, the T140 stream could be specified as this
example shows:
Media { Stream = 4 { LocalControl {
                     Mode = ReceiveOnly,
                     g/NetworkType = RTP/IP4,
                     g/PreferredCodecs=T140}}}


The MG would return the SDP specification for the media stream:
Media { Stream = 4 {Local = SDP {
v=0
c=IN IP4 125.125.125.111
m=text 1111 RTP/AVP 98
a=rtpmap:96 red
a=fmtp: 98 96/96
a=rtpmap: 96 t140}}}


15 TEXT TELEPHONE PACKAGE

PackageID : txp (0x0038)
Version:        1
Extends:        None
Description:

The text telephone package is used on a line termination in a Media
Gateway, to handle text telephone calls. It includes V.18 text telephone
modem functionality that adapts to different legacy text telephone sys-
tems in the PSTN as well as it provides communication with V.18 equipped
text telephones. The text media stream is UTF-8 coded with a few editing
functions as specified in ITU-T T.140.

15.1 Properties

Conversation mode
  PropertyID: convmode  (0x0001)
  Type:   Enumeration
  Possible values:
  Text-only;    Basic text only mode, not possible to combine with voice.
  Alternating;  Text and voice may be alternating.



Bilias, Kallas                                                 [Page 30]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  Simultaneous; Simultaneous text and voice mode.
  Defined in:             Termination state
  Characteristics:        Read/Write
  Description:
  The behaviour of the termination is influenced by this property. By setting
  the property to a selection of the possible values, the number of ways that
  the conversation can be conducted can be defined. After connection the
  property contains the actual conversation mode used in the call.

  The basic text only mode shall always be supported.

  The alternating text and voice mode is most often used to enable one
  user to speak and read and the other to listen and type. It is used
  because there was no technology support for simultaneous voice and text
  when text telephony was introduced. It is only supported for compatibil-
  ity with the legacy mode text telephone habits.

  The simultaneous text and voice mode enables the users to communicate in
  any combination and order of the two media. No legacy mode terminals
  operate in this mode.

Communication Mode
  PropertyID: commode  (0x0002)
  Type:           Enumeration
  Possible values:
  V18-V21;      native V.18 mode for text only or text and voice
                alternatively.
  V18-V61;      native V.18 mode for text and voice simultaneously.
  V21Hi;        legacy V.21 mode transmitting on the high channel
  V21Lo         legacy V.21 mode transmitting on the low channel.
  DTMF;         DTMF text telephone mode.
  EDT ;         EDT ("European Deaf Telephone")
  Baudot 45;    Baudot 45.45 bits / s
  Baudot 47;    Baudot undetermined bitrate
  Baudot 50:    Baudot 50 bits/s
  V23Hi         V.23 modulation and Minitel coding transmitting on the 
                high channel
  V23Lo         V.23 modulation and Minitel coding, transmitting on the 
                low channel.
  BellHi;       Bell 103, transmitting on the high channel
  BellLo;       Bell 103, transmittion on the low channel
  None;         No mode achieved
  Defined in:             LocalControl
  Characteristics:        Read/Write
  Description:

  This property indicates what modulation and mode the V.18 modem is
  operating in, reflecting what type of text telephone it is in connection



Bilias, Kallas                                                 [Page 31]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  with. For an explanation of the different modes, see ITU-T V.18.

  If specific mode operation is wanted, this property is set before the
  text connection is made. (to be used with care since it disables all
  automoding compatibility opportunities embedded in the V.18 concept)

  When a legacy mode textphone signal is detected in automode monitor
  mode, the connection result is only reported, but V.18 does not transmit
  any signal until ordered to do so.

Connection Mode
  PropertyID: connmode  (0x0003)
  Type:   Enumeration
  Possible values:
  Idle:          no connection established and no efforts to connect
  Automodecalling: actively seeking text contact as a caller, sending V.8
                         CI and
                         V.18 XCI signals.
  Automodeanswer:  actively seeking text contact as an answering part,
                         sending probe signals in the different legacy modes.
  Automodemonitor: passively listening on the line for textphone signals
                         without transmitting any stimulating signals, and only
                         reporting observed textphone signals.
  Appendix3connect: automatically seeking between calling and answer modes
                         as needed when entering text mode from voice mode
                         during a call.
  Specificcalling; for direct request of the native or legacy mode
                         indicated in the Communication Mode property.
  Specificanswering: for direct request of the native or legacy mode
                         indicated in the Communication Mode property.
  Connected:       connection established in one of the communication modes
  Defined in:     Termination State.
  Characteristics:Read/Write
  Description:

  This property indicates in what connection phase mode the V.18 modem is
  operating. A connection effort is initiated by setting this property to
  the desired mode.

  A V.18 modem can be controlled to operate in one of a set of modes for
  seeking contact with a counterpart. The modes available are listed as
  values of this property

  Once connected, the termination operates in the selected mode until the
  text connection is lost or it is ordered to disconnect. If text connec-
  tion is lost for a certain time, the automoding procedure can be res-
  tarted or the modem can stay in the achieved mode trying to reconnect.




Bilias, Kallas                                                 [Page 32]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  The automode monitor mode may be used on a connected voice line to
  detect if the remote user want to enter text mode.  It must be noted
  that for some of the legacy modes (EDT, DTMF and Baudot), the user has
  to push some keys on the textphone to make the connection when V.18 is
  set in the automode monitor mode. This is slightly unusual for a text-
  phone user, who normally waits for the answering side to start the
  conversation. Therefore, the explicit automoding modes should be used
  when possible.

Probe message
  PropertyID:     probemsg  (0x0004)
  Type:           String
  Possible Value:         Any string, not more than 20 characters long.
  Defined in:             Termination State
  Characteristics:        Read/Write
  Description:

This property holds a short string that the termination transmits as a
stimulating probe message for the carrierless communication modes in the
answering modes. The far end user will see this message when it is
transmitted in the mode matching the counterpart's textphone, and type a
response back, enabling the V.18 modem to detect the type of carrierless
text telephone in the connection.

When issued, it is automatically followed by " GA" in Baudot probing,
and with "+" in EDT and DTMF probing to reflect the turntaking signal
habit in the different user communities. The string could be customised
to briefly inform the called user about what service that is reached.

Note that the string is not issued in the carrier modes.

Probe order
  PropertyID:     probeorder (0x0005)
  Type:                   Enumeration
  Possible values:      (for the corresponding orders, see V.18)
        AUS;            Optimised for Australia-Ireland;
        GER;            optimised for Germany-Switzerland-Italy-Spain;
        NL;             optimised for The Netherlands;
        SCAND;          optimised for Scandinavian Countries;
        UK;             optimised for UK ;
        US;             optimised for USA-Canada;
        FR;             optimised for France-Belgium.
        Any combination of none to six of the type indicators V21, DTMF, Baudot,
        EDT, MINITEL and BELL in the desired order;
  Defined in:             Termination state
  Characteristics:        Read/Write
  Description:




Bilias, Kallas                                                 [Page 33]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


This property holds an indication on the order the probes will be
transmitted. Probing is a time consuming procedure and it is important
that the most likely modes are probed first. For simplicity, V.18
enumerates a set of suitable probe- orders for different geographical
areas. For other areas the order to select depends on if any legacy mode
textphones are on the market in the area. An optimised order can be com-
posed by enumerating the desired specific type indicators. Note that
leaving out a type from probing may cause connection problems for text-
phones of that type.

Action at loss of connection
  PropertyID:     lossconnection  (0x0006)
  Type:                   Enumeration
  Possible values:
        Keep:           keep selected communication mode
        Return: return to automoding.
  Defined in:             Termination State
  Characteristics:        Read/Write
  Description:

This property tells how the V.18 modem handles loss of text connection.
When "Keep" is selected, the conversation is optimised for the alternat-
ing text - voice mode. When "Return" is selected, the communication is
optimised for call forwarding between different types of text tele-
phones.

V18 options
  PropertyID:     v18opt  (0x0007)
  Type:           Enumeration
  Possible values:        List of:
        V.61 capability:        indicates the ability to use V.61 modulation
        V.8 bis capability: indicates the ability to use V.8 bis handshaking
  Defined in:             Termination state
  Charateristics:         Read/Write
  Description:
  This property indicates what optional capabilities the V.18 modem
  implementation has and is allowed to use.

Character set
  PropertyID:     characterset (0x0008)
  Type:           String
  Possible values:        ISO registered name for a character set.
  Defined in:             Termination State
  Characteristics:        Read/Write
  Description:

The legacy modes have limited character sets. For all legacy modes,
appropriate character conversion, filtering and control interception is



Bilias, Kallas                                                 [Page 34]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


included in the package functionality, so that the communication with
other T140 text terminations in the context is equalized to a T140 text
stream.For a user friendly conversion of received national characters in
the limited character sets to ISO 10 646-1 used in T.140, there is a
need to specify what national translation table to use. This is valid
for EDT, DTMF, V.21 and Baudot modes. The Character set parameter is the
the registerd ISO code for the national variant of the ITU-T T.50 char-
acter set used. Default is:
* German for EDT,
* Danish for DTMF (suitable also for the Netherlands),
* Swedish/Finnish for V.21 (suitable also for UK),
* International Reference Version for Baudot.

An example: In Norway, the letter "" (A and E together) is used in the
same location of the 7-bit character table as used for letter "" (A
with umlaut) in Finland and Sweden. The international reference version
has the character "[" (left bracket) in the same position. In T140 these
characters have unique positions and the text telephone package must
make the proper translation of received national characters into a
unique ISO 10646 code depending on the target language.

Initial characters
  PropertyID:     initchars (0x0009)
  Type:           String
  Possible values:        Any string, maximum length 255 bytes.
  Defined in:             Termination State
  Characteristics:        Read/Write
  Description:

The initial characters property can be used to insert characters
received during detection and discrimination of call type with the Call
Type Discrimination package. If inserted before connection in a specific
mode is requested, the characters are returned first in the T140 text
stream. This operation is intended to cater for the carrierless text
telephone modes, where valid user data is consumed by the discrimination
process. After successful connection through automoding, the initial
characters are also available for reading in this property. The string
is cleared at disconnection.

15.2 Events

Connection mode changed
  EventID:        connchng   (0x0001)

ObservedEventDescriptorParameters
                Same as the property txp/commode
  Description:
  This event reports the change of communication mode, as result of a



Bilias, Kallas                                                 [Page 35]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  connection effort, or a disconnection.

15.3 Signals

None. (the procedures to issue tones and signals are internal to the
package and not available as named signals)

15.4 Statistics

Number of characters transferred
  StatisticsID:   chartrans (0x0001)
  Units:          count
  Description:
  Number  of bytes of T140 data transferred.


Number of alternating turns.
  StatisticsID:   altturns (0x0002)
  Units:          count
  Description:
  Number of alternating turns when using alternating conversation mode.

15.5 Procedures

Descriptors to use for text telephony:

Two descriptor values are of specific interest for the Text Telephone
package. That is the text conversation media stream and the V.18 modem.
The text conversation media stream is described in the Text Conversation
package. The V.18 modem descriptor is described here for information.

V.18 Modem
----------
Modem name V18.

This modem type is intended for communication with text telephones in
the PSTN. It is embedded in the textphone package. Some properties of
the text telephone package directly reflect parameters for control of
the V.18 modem. V.18 modem implementations may have different capabili-
ties reflected in the property values.

A V.18 modem may be operated in automode monitor mode, when it listens
on a voice line for text telephone signals. This mode can be used to
detect that the user wish to transit from voice to text during a voice
call.

Alternatively, a V.18 modem may be operated in modes where it actively
tries to establish a text telephone connection. The procedure includes



Bilias, Kallas                                                 [Page 36]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


transmission of text telephone specific signals on the line.

After successful connection in a text telephone mode, the text session
is conducted in the specific mode and the text stream is made available
in T.140 format for other text terminations in the context.

The text telephone package only contains the text connection and text
media aspects of the termination. It is supposed to be combined with
appropriate call control packages, line interface packages and voice
channel packages.

Text Telephony
--------------

Text Telephony offers a real time conversation in text between two par-
ties. It may be combined with voice conversation. Text telephony in PSTN
existed in at least 6 incompatible legacy modes before the automoding
modem Recommendation for text telephony V.18 was introduced by the ITU.
V.18 is suitable for use in PSTN text telephones, but also in gateways
for connection to the PSTN text telephones. When connected, it can
operate in one of its native V.18 modes, or in any of the 6 legacy modes
described in V.18 annexes. The legacy modes are Baudot, EDT, DTMF, V.21,
Minitel and Bell103. The mode detection and adjustment of the transmis-
sion to the selected mode is automatic.

The native modes use ITU-T T.140 for the text coding and control and
V.21 or optionally V.61 for the modulation. The legacy modes use dif-
ferent character coding schemes, but when used in a gateway, the text
stream to and from the textphone termination is T.140 coded for all
modes. The text telephone package described here includes character
conversion, filtering and other adaptation needed for conversation with
the legacy mode text telephones.

Carrier modes and carrier-less modes.
-------------------------------------

Three of the legacy textphone modes are carrier-less. This means that
they do not send any signal at all when there are no characters to
transmit. Three legacy modes and the native V.18 modes use a carrier
tone transmitted as long as the connection is maintained. If the carrier
stops, it is detected but the line is not disconnected, because this is
normal behaviour during call transfer and alternating voice and text
usage.

Text telephone package considerations above the V.18 modem level.
-----------------------------------------------------------------

V.18 only specifies an automoding modem and the requirement to use T.140



Bilias, Kallas                                                 [Page 37]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


when V.18 native mode is achieved in a connection. When used in a gate-
way, there are some general issues that must be handled above the V.18
level.

Character set:
--------------

The legacy modes have limited character sets. For all legacy modes,
appropriate character conversion, filtering and control interception is
included in the package functionality, so that the communication with
other T140 text terminations in the context is equalized to a T140 text
stream.

Embedded termination functionality
----------------------------------

There is no need to open all details of the use of V.18 and T.140 to be
accessible from the MGC in a gateway. V.18, T.140, character conversion
methods and other automated methods are therefore combined in the text
telephone package that can be added to suitable terminations of a gate-
way.

This figure describes the text telephone package components.

           Text stream              Control    Audio stream
                 |                      |           |
               ------                   |           |
            __|T.140 |___               |           |
           |   ------    |              |           |
       -----------   ----------------   |           |
      |Transparent| |T.140 conversion|  |           |
      | For native| | for legacy     |  |           |
      |   modes   | |   modes        |  |           |
       ------+----   ---------+------   |           |
             |----| |---------|         |           |
                  ----                  |           |
                 |V.18|                 |           |
                  ----                  |           |
                   +--------------------+-----------+
             Line Interface
                   |

Figure  : Text telephone package components


Basic operation
---------------




Bilias, Kallas                                                 [Page 38]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


After line connection, the termination where the Text Telephone package
is applied should be requested to try a text telephone connection using
the functionality of the Call Type Discrimination Package for the modem
signalling according to ITU-T V.18 in a selected mode. Once the connec-
tion is established, this package is used for the text communication in
the established mode.

After connection in text mode, the result is a gateway context with one
textphone termination  and one voice line termination connected to the
same line. In the same context, the normal case is to have IP connec-
tions with one audio RTP termination and one RTP/T140 text termination.

In the most simple text-only case, the audio streams are not used and
may be released.

Text received through the V.18 modem is converted if necessary to T.140.
It is embedded in the RTP/T140 format according to the rules in T.140
and RTP/T140. Text received from the IP side is transmitted through the
V.18 modem after extraction from the RTP packets. This process continues
until any end disconnects.

Operation with alternating text and voice mode
----------------------------------------------

If the involved gateways have the alternating text and voice capability,
the following procedure can be applied to give the users a possibility
to go back and forth between using text and voice. On the IP side, two
streams are members of the context during the call, the text stream and
the audio stream. The procedure is slightly dependent on the terminal
type as described in the following section.

Alternating text and voice mode with legacy, carrier-less textphones:
---------------------------------------------------------------------

 For the carrierless types Baudot, DTMF and EDT the following way to
operate should be used: When V.18 detects text, the textphone termina-
tion stops feeding the audio stream into the audio- RTP stream, and
instead inserts the detected and T140 converted characters into the
RTP-stream. This mode is continued as long as characters keep coming
from the PSTN textphone.

When no more characters arrive, and no textphone signal is received
within 2 seconds, the audio channel is again fed to the RTP-Audio chan-
nel. If new text comes from the V.18 side, the process is repeated.

It is important that the implementation of V.18 can retrieve characters
from the first detected text telephone signals after each mode shift.
The leading tones before the characters can be as short as 150 ms.



Bilias, Kallas                                                 [Page 39]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


If text is received from the remote end through the RTP-Text stream,
when V.18 is not active receiving text, the voice path is muted, and the
characters are sent to the V.18 modem for transmission. When all text is
transmitted and no more is received for two seconds, the audio channels
are enabled again.

Since the carrier-less systems are one way alternate transmission sys-
tems, transmission of characters is possible only in one direction at a
time. Once started, reception is given priority.

On the RTP side, two way simultaneous transmission is possible. There-
fore, characters received from the RTP side while V.18 is busy receiving
are buffered (up to a reasonable limit).

All these actions after the initial connections are automatic and are
handled within the textphone termination.

Alternating voice and text conversation in carrier mode:
--------------------------------------------------------

 After a carrier mode text connection is established,  loss of carrier
can be taken as the indication that the RTP-Audio channel shall be con-
nected with audio interface of the line. When the remote end is a V.21,
Bell or V.18 device, the text communication can be full duplex, so the
gateway can just let the text streams flow between the terminations.

Minitel does not support any voice interworking mode.

Simultaneous voice and text mode
--------------------------------

In case the simultaneous voice and text method is enabled, the handling
of the voice and text channels is trivial. Once connected, the text
stream can stay connected with the remote text stream all the time to
serve a two way simultaneous text conversation, and the audio channel
can be connected with the remote audio stream to support a two way
simultaneous audio channel. This mode can be supported by V.18 with V.61
modulation.

16 CALL TYPE DISCRIMINATION PACKAGE

PackageID : ctyp (0x0039)
Version:        1
Extends:        none
Description:

This package monitors the termination for signals indicating presence of
a T.30 telefax terminal [11], a V.18 or legacy mode text telephone [15]



Bilias, Kallas                                                 [Page 40]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


or data modem. In co- operation with the MGC and the remote MG or end-
point, it can perform exchange of signals until the call type is deter-
mined and an appropriate mode for the call can be established.

16.1 Properties
Initial characters
  PropertyID:     initchars (0x0001)
  Type:           String
  Possible values:        Any string, maximum length 256 bytes.
  Defined in:             Termination State
  Characteristics:        Read/Write
  Description:

The initial characters property can be used to retrieve characters
received from carrierless text telephones of the Baudot, EDT and DTMF
types.  The characters are received up to the first gap in the carrier
for Baudot and EDT, and the first DTMF tone for DTMF. They can be
inserted in the txp package for a seamless takeover of a connection.

Call Types
  PropertyID:     ctyp (0x0002)
  Type:           sub-list
  Possible values:
        FAX
        TEXT
        DATA
        VOICE
  Defined in:             Termination State
  Characteristics:        Read/Write
  Description:
  The Call Types property selects the types of calls for which the
  termination is monitored.

Text Call Types
  PropertyID:     ttyp (0x0003)
  Type:           Sub-list
  Possible values:
        V21
        DTMF
        Baudot45
        Baudot50
        Bell
        EDT
        Minitel
        V18
  Description:
  This parameter indicates for what text telephone modes the termination
  is monitored.



Bilias, Kallas                                                 [Page 41]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


V8bissupport
  PropertyID:     v8bsup (0x0004)
  Type            Boolean
  Possible values:        True    V.8 bis is supported by the package
                        False   V.8 bis is not supported by the package
  Defined in:             Termination State
  Characteristics:        Read
  Description:
  Support of the V.8 bis [14]modem negotiating procedure is optional.
  The V8bissupport property indicates if V.8 bis is supported.

16.2 Events

Discriminating tone detected
  EventID:        dtone  (0x0001)
  Description:

This event indicates that a signal valid for detection and discrimina-
tion of mode was detected. The signal name is given as a parameter.
Further logic is needed in some cases to discriminate the call type from
this information. The V.8 bis related parameters are returned only when
V.8 bis is supported.

EventsDescriptor parameters:
        None

ObservedEventDescriptor parameters:

Parameter: Signaltype
  ParameterID:    st (0x0001)
  Type:           Enumeration
  Possible values:

For Fax:
        CNG;            a T.30 fax calling
        V21flag,        a V21 tone and flags for fax answering

For Text
        XCI;            a V.18 XCI
        V18txp1 a V.18 txp signal in channel V.21(1)
        V18txp2 a V.18 txp signal in channel V.21(2)
        BellHi  a Bell 103 carrier on the high channel
        BellLo  a Bell 103 low channel
        Baudot45        a Baudot45 initial carrier and characters with
                        characters in signalvalue
        Baudot50        a Baudot50 initial carrier and characters
                        with characters in signalvalue
        Edt             an EDT initial tone and characters



Bilias, Kallas                                                 [Page 42]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


                        with characters in signalvalue

For Data
        ASig            Modulation signal from a mode only used for
                        data. E.g. not V.21, V.23 and Bell 103.

Common to Voice and Text:
        Dtmf            a DTMF signal with value in signalvalue

Common to Text and Data:
        CT              a V.25 calling tone
        V21hi           a V.21 carrier on the higher frequency channel
        V21lo           a V.21 carrier on the low frequency channel
        V23hi           a V.23 high carrier
        V23lo           a V.23 low carrier
        CI              a V.8  CI  with contents in signalvalue


Common to Fax, Text and Data:
        ANS or CED      V.25 ANS, equivalent to T.30 CED from answering
                        terminal
        ANSAM   V.8 ANSAM
        CM              V.8 CM with contents in signalvalue
        CJ              V.8 CJ
        JM              V.8 JM with contents in signalvalue
        ENDOFSIG        End of reported signal detected (reported for
                        continuous or repeated signals
        V8BIS           V.8bis signal, with signal type in parameter
                        V8bistype and value in signalvalue
        TIMEOUT A time for waiting for a signal elapsed

Parameter:      signalvalue
  ParameterID     svalue (0x0002)
  Type:           string
  Possible values:
                Information contained in the detected signal, coded as a
                string of octets.

Parameter:      valuelength
  ParameterID: vallen (0x0003)
  Type:   Integer
  Possible values 0-80
  Description:    Length in octets of the parameter signalvalue.

Parameter:      V8bistype
  ParameterID     v8bist (0x0004)
  Type    enumeration
  Possible values



Bilias, Kallas                                                 [Page 43]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


        ESi     V.8bis signal ESi
        ESr     V.8bis signal ESr
        MRe     V.8bis signal MRe
        MRd     V.8bis signal MRd
        CRe     V.8bis signal CRe
        CRd     V.8bis signal CRd
        MS      V.8 bis message MS with contents in signalvalue
        CL      V.8 bis message CL with contents in signalvalue
        CLR     V.8 bis message CLR with contents in signalvalue
        ACK     V.8 bis message ACK with contents in signalvalue
        NAK     V.8 bis message NAK with contents in signalvalue
  Description:    A detected V.8 bis signal

16.3 Signals

V8Signal
  SignalID:       v8sig (0x0001)
Parameters

V.8 Signal Type
  Parameter ID    v8styp (0x0001)
  Type            Enumeration
  Possible values
                CM
                CJ
                JM
                CI
                Default may be provisioned

V8SigCont
  Parameter ID    v8scont (0x0002)
  Type            string
  Possible values
                Allowed contents of the signals
                Default is empty
  Description     The V.8 [13] signals carry data for call type and modulation
modes. These parameters can be supplied through the v8cont parameter.

V18XCIEnable
  Parameter ID:   v18xcien (x0003)
  Type            Boolean
  Possible values
        True    XCI transmission enabled during V.18 CI transmission
        False   XCI transmission disabled
        Default is False
  Description: XCI can be sent intermixed with CI transmission as specified in
V.18 to stimulate plainMinitel terminals to respond as text telephones




Bilias, Kallas                                                 [Page 44]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


AnswerSignal
  SignalID:       ans (0x0002)
  Signal Type     TO
Parameters

AnsType
  ParameterID     AnsType (0x0001)
  Type:           Enumeration
  Possible values:
                ANS             V.25 ANS (equivalent to T.30 CED)
                ANSBAR          V.25 ANS with phase reversals
                ANSAM           V.8 ANSAM
                ANSAMBAR        V.8 ANSAM with phase reversals
                V21flag         a V21 tone and flags for fax answering
                V18txp1         a V.18 txp signal played in V.21 channel (1)
                V18txp2         a V.18 txp signal played in V.21 channel (2)
                Default may be provisioned

CallingSignal
  SignalID:       callsig (0x0003)
  SignalType      CN
Parameters

callSigname
  Parameter ID    cSn (0x0001)
  Type    Enumeration
  Possible values:
    CT              V.25 Calling Tone
    CNG             T.30 Calling
    Default may be provisioned

SignalName: V8bisSignal
  SignalID:       v8bs (0x0004)
  Signaltype      BR
Parameters

V8bisSigname
  ParameterID     V8bsn (0x0001)
  Type            Enumeration
  Possible values
                ESi     V.8bis signal ESi
                ESr     V.8bis signal ESr
                MRe     V.8bis signal MRe
                MRd     V.8bis signal MRd
                CRe     V.8bis signal CRe
                CRd     V.8bis signal CRd
                MS      V.8 bis message MS with contents in signalvalue
                CL      V.8 bis message CL with contents in signalvalue



Bilias, Kallas                                                 [Page 45]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


                CLR     V.8 bis message CLR with contents in signalvalue
                ACK     V.8 bis message ACK with contents in signalvalue
                NAK     V.8 bis message NAK with contents in signalvalue
                Default may be provisioned

V8bisSigContents
  ParameterID     V8bscont (0x0002)
  Type            string
  Possible values Valid contents for the V.8 bis signals
                  Default is empty
  Description:    Some of the V.8 bis signals are messages. Their contents
can be defined with theV8biscont parameter.

16.4 Statistics
none

16.5 Procedures

The Call Type Discrimination package is invoked for cases when the net-
work connection is complete and the call may enter one of the types of
voice, fax, text telephone and modem. The package contains functionality
to support the decision and connection processes. Once discriminated and
the modem handshaking completed, an appropriate specific call type pack-
age should be invoked to complete the connection establishment on the
modulationlevel and perform the session. If the desired call type is
known from the beginning, the call type discrimination package should be
invoked in order to  actively try to establish a connection by sending
out stimulating signals. By contrast this package is also used to pas-
sively monitor the line to detect signals which are to be relayed to the
Media Gateway Controller as input to a discrimination decision. Since
the Call Type Discrimination package can be invoked to initially only
monitor the line,  it can be invoked on lines where voice calls are the
most common mode of operation.   There may be situations where this pas-
sive way of working results in less efficient or less reliable connec-
tion in fax/text/data mode.

Operation
----------

The package is added to a termination of a line when an outgoing or
incoming call where fax, text or data mode may be wanted. The properties
are set to the enabled call types.

For incoming calls:

The call is answered, the destination is evaluated and the remote call
initiated using packages and gateway functions outside the scope of this
package.  The MGC may order stimulating signals defined in this package



Bilias, Kallas                                                 [Page 46]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


to be sent on the line.  The line is monitored for signals for the
selected modes as defined in the dtone" event descriptor.  The MGC is
expected to evaluate call type indications of all types; registered type
of the destination, offered capabilities of the endpoint, invoked con-
nection efforts of specific types from the endpoint and discriminating
events from a call type discriminating package active in setting up the
connection with the other endpoint.  As soon as the modem handshaking is
complete and a condition is reached that is valid for only one call
type,  a package for handling that call type should be invoked by the
MGC, thus placing the MG into the desired mode of operation.  The pack-
age contains components for conducting a negotiation procedure according
to the different connection procedures defined in recommendations V.25
[16], V.8 [13], V.8 bis [14], T.30 [11], T.38 [12] and V.18 [15]. (V.8
bis support is optional and its availability can be interrogated through
the property V8bissupport).

Operation for transit calls, coming from and going to the switched network.
---------------------------------------------------------------------------

If no fax/text/data indication is present in the incoming call, the out-
going call is placed in voice mode, with the Call Type Discrimination
package active.

If a valid tone is detected, it is reported to the MGC as an event, if
there  is not enough information for discrimination, it is signalled to
be replayed at the other end. The process continues according to the
rules of the connection procedures until the call type can be determined
and the mode of operation can be established.

Operation for calls having one endpoint in the packet network.
--------------------------------------------------------------

If no fax/text/data indication is present in the incoming call, the out-
going call in the packet network is placed in voice mode.  If a request
to open a text channel, a fax channel or a data channel is made, the
corresponding call type is tried on the switched network connection. If
a signal indicating presence of a fax, textphone or a modem is received
from the circuit switched network, and the call type can be evaluated, a
corresponding channel is requested to the remote endpoint. If that
request is acknowledged, the connection in the fax/text/data mode is
completed on the switched side.

 If the call type can not be evaluated, further signal exchange is per-
formed on the switched interface until the call type is determined, and
then the channel establishment continues on the packet side.

Cases when the call type can not be determined from the signals
---------------------------------------------------------------



Bilias, Kallas                                                 [Page 47]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


For cases when the call type can not be determined by the signal
exchange, a decision must be taken by other means, or a transparent
transport can be selected. The other means to make the decision may be a
number analysis and comparison to registered user preferences or network
defaults.

Cases when the decision is not possible by signal analysis but need to
be taken by external means:

V.21 Used both for text telephony and for credit card transactions. The
     decision is recommended to be based on regional preferences and
     registering preference for data per destination number in regions
     where the default preference is for text telephony.

V.23 Used both for Minitel-based text telephones and for the Minitel
     information Retrieval system. The conflict is only when an answer-
     ing endpoint transmits the v23hi signal. A tranparent data tran-
     sport is recommended for this case.



Scenarios and call flows
------------------------

Signal sequence scenarios can be derived from the different connection
protocols, with T.38 being the main protocol for fax, V.18 for text
telephony and V.8 / V.25 for data.

The typical fax scenario is discriminated when CNG is detected from the
calling end and a corresponding CED and V.21flags are detected at the
answering end. Alternatively, a V.8 CM or JM signal with a fax call type
may be  detected at either end.

The text telephone scenario is discriminated when a text telephone call
type is detected in V.8, a text telephone function is negotiated in V.8
bis, or a signal valid for text only is detected.

The data scenario is discriminated when a data call type is detected in
V.8, a data function is negotiated in V.8 bis, or a data mode (not text)
is entered by any part.

In all cases the Call Type discrimination package completes the
handshaking protocol before entering the selected data mode.

17 FAX PACKAGE

Package Name: Fax
PackageID: fax  (0x0040)



Bilias, Kallas                                                 [Page 48]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


Version: 1
Extends: None
Description:

The fax package is intended for enabling real time or store and forward
fax communication between terminals/applications in different networks
or messaging environments. This package includes the mechanisms needed
to transport T.30 fax sessions (signals and data) in a real time IP
environment.  The transport mechanism will be different for each
environment where the package is used.

17.1 Properties

Fax connection state
  PropertyID:     faxstate  (0x0001)
  Type:           Enumeration
  Possible values:
        Idle            for no connection efforts
        Prepare for being known in the termination and ready to accept
                        connections
        Negotiating     for taking the initiative to establish a fax connection
        Training        Fax Phase B training underway
        Connected       for completed connection
        EOP             Procedures Complete
        ProcInterrupt   Procedure Interrupt Processing

  Characteristics: Read/Write
  Defined in:     Termination State
  Description:
The connection state property is used to request a fax connection, and
reflect the state of  the achieved fax connection.

Parameters

Transport
  ParameterID:    trpt  (0x0001)
  Type:           Enumeration
  Possible values:
        T30             for T.30 PSTN sessions without V.8
        T.30V8          for T.30 PSTN sessions with V.8
        T38UDPTL        for T.38 using UDPTL
        T38TCP          for T.38 using TCP
        T37             for T.37
        RTP             for RTP (e.g., G.711)

  Characteristics: Read/Write
  Defined in:     Termination State
  Description:



Bilias, Kallas                                                 [Page 49]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


The Transport parameter reflects the transport mechanism selected for the
fax termination.

TransmissionSpeed
  ParameterID:    trspd  (0x0002)
  Type:           Integer
  Possible values:        1200-14400
  Description:
The Transport parameter reflects the transmission speed seen at the
analog interface for the fax relay or the transmission speed used by
the FAX termination (T.30 PSTN).

PSTN Inteface
  ParameterID:    pstnif  (0x0003)
  Type:           Enumeration
  Possible values:
        NA              not applicable
        V17
        V27TER
        V29
  Description:
The PSTN Interface parameter reflects the interface used to connect to
a physical FAX machine.

17.2 Events

Fax Connection State Change
  Event ID:               faxconnchange  (0x0001)

EventDescriptor Parameters:
None

ObservedEventDescriptorParameters

Fax Connection Change
  ParameterID:    faxconnchng (0x0001)
  Type:           Enumeration
  Possible Value:       EOF - end of fax session, call terminating
                        PI - Priority Interrupt ; Switch to Voice
  Description:
This event will occur when the fax connection state for the termination
has changed. Its parameter is the new contents of the Fax Connection
State property.

17.3 Signals
None

17.4 Statistics



Bilias, Kallas                                                 [Page 50]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


Pages Transferred
  StatisticsID:   pagestrans  (0x0001)
  Type:                   integer
  Description:
No of pages of fax image data transferred through the termination.

Train Downs
  StatisticsID:   traindowns (0x0002)
  Units:          count
  Description:
Number of ties FAX trained down during transmission.

17.5 Procedures
The following are standard transport mechanisms for fax in different
environments.

* In T.30:              Use T.30 procedures without V.8
* In T.30 Annex C/F:    Use T.30 procedures selected via V.8
* In T.38 Annex B:      UDPTL or TCP in T.125 communication channel
                        environment.
* In H.323 Annex D:     UDPTL or TCP as selected with H.245 messages.
* In T.38 Annex D (SIP):UDPTL or TCP as initiated with SDP
* In T.38 Annex E:      UDPTL or TCP
* In T.37:              SMTP (MIME) /TCP

Function
--------

A termination with Fax provides a method for transfer of fax pages pre-
ceded by negotiations in the call setup according to procedures defined
for each environment. When matching capabilities exist, the appropriate
sessions can be established in order to transfer pages of image or
binary data.

Real time fax allows telecom users to transfer fax pages in real time.
The procedural aspects of GSTN fax are defined in ITU-T T.30. [11].  The
compression methods used in transporting fax images are defined in T.4,
T.6, T.81, T.82, T.85 and T.44.   In traditional T.30 without error
correction, images are transferred in a stream one page at a time.   In
T.30 with error correction, images are transferred in blocks that are
also known as partial pages. Numerous examples of fax sessions are con-
tained in Appendix IV to T.30.

For each transport environment, a suitable transport protocol must  be
selected to carry the image. Currently defined and Recommended transport
environments for T.30 media streams that can be supported by this pack-
age are:




Bilias, Kallas                                                 [Page 51]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


1.   GSTN networks, where the procedures are defined in T.30, T.30 Annex
     A (for error correction), T.30 Annex C (duplex protocol) and Annex
     F (half duplex V.34 protocol).

2.   Packet networks, where the procedures described in T.38 Annex B
     [12] can be used to for setting up and conducting fax sessions,
     using TCP or UDPTL for the transport of T.30 signals and data.

3.   Packet networks, where the procedures described in H.323 Annex D
     can be used to for setting up and conducting fax and voice ses-
     sions, using TCP or UDPTL as negotiated via H.245.

4.   Packet networks, where the IETF Session Initiation Protocol SIIP
     can be used for setting up and conducting fax sessions as defined
     in T.38 Annex D using UDPTL or TCP for the transport of T.30 sig-
     nals and data.

5.   Packet networks, where H.248 can be used for setting up and con-
     ducting fax sessions as defined in T.38 Annex E using UDPTL or TCP
     for the transport of T.30 signals and data.

6.   Packet networks, where the packets of G.711 coded data (with T.30
     signals and data embedded) can be transported via RTP.

7.   The Extended Simple Mail Transport Protocol messaging environment
     over packet, that can be used alone or in conjunction with any of
     the environments above, where T.37, RFC 2301-2305 and RFCs 2530-
     2532 specify the methods for transporting image/tiff files using
     the same compression methods as specified for use in T.30.

Interworking between these forms of fax can be achieved through the use
of gateways with packages defined here.

Process of Adding Fax Capable Terminations
------------------------------------------

The MGs are responsible for detecting fax tones and relaying the related
events to the MGC.   The MGC should conduct Call Discrimination as
defined within the Call Type Discrimination Package in order to deter-
mine whether a fax or other mode is applicable.    The MGC may choose to
skip this if the MG is not capable of the Call Type Discrimination Pack-
age.  Once the MGC evaluates the tones and determines that the incoming
call is fax, the MGC shall execute appropriate ADD commands to specify
the desired mode of operation.

Process of Ending a Fax Call
----------------------------




Bilias, Kallas                                                 [Page 52]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


The MGs are responsible for detecting events that would cause the
interruption of a fax call.  The MGC is responsible for making the
determination if this switch can be made and instruct the MGs to switch.
It also responsible for switching it back to fax.

The MGC should receive indication that the fax call ends from the MG
before receiving typical call termination indications.

Examples:
---------

One possible instruction from an MGC to an MG to modify an existing con-
text to a T.38 media stream:

 MGC to MG:
 MEGACO/1.0 [123.123.123.4]:55555
 Transaction = 14 {
   Context = 2000 {
     Modify = RTP/1 {
       Media {
         Stream = 1 {
           Local {
 v=0
 c=IN IP4 124.124.124.222
 m=image 1111 udptl t38
 a=T38FaxRateManagement:transferredTCF
 a=T38UdpEC:t38UDPFEC
           }
         }
       }
     }
   }
 }


18 MODEM PACKAGE

Package Name: Modem
PackageID: mdm  (0x0040)
Version: 1
Extends: None
Description:
The modem package is intended for enabling modem termination and modem
relay functions when connecting to a PSTN.

18.1 Properties

Modem connection state



Bilias, Kallas                                                 [Page 53]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


  PropertyID:     modemstate  (0x0001)
  Type:           Enumeration
  Possible values:
        Idle            for no connection efforts
        Prepare         for being known in the termination and ready 
                        to accept connections
        Negotiating     for taking the initiative to establish a modem
                        connection
        Training        Modem training underway
        Connected       for completed connection
        FallFwd         Fall Forward - negotiate to high speed
        FallBwd         Fall Backward - negotiate to lower speed
        Retrain         Retrain to new speed
        ClrDown         Terminate connection

  Characteristics: Read/Only
  Description:
The connection state property is used to request a modem connection, and
reflect the state of  the achieved modem connection.

Parameters:

Transport
  ParameterID:    trpt  (0x0001)
  Type:           Enumeration
  Possible values:
        RTP             for RTP (e.g., G.711)

  Description:
The Transport parameter reflects the transport mechanism selected for the
modem termination. Currently only G.711 is defined. In the future other
codecs will be added.

TransmissionSpeed
  ParameterID:    trspd  (0x0002)
  Type:           Integer
  Possible values:        75-56000
  Description:
The Transport parameter reflects the transmission speed seen at the
analog interface for the modem relay or the transmission speed used by
the modem termination.

PSTN Interface
  ParameterID:    pstnif  (0x0003)
  Type:           Enumeration
  Possible values:
        V21
        V22



Bilias, Kallas                                                 [Page 54]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


        V22BIS
        V23
        V32
        V32BIS
        V34
        V90
        K56FLEX
  Description:
The PSTN Interface parameter reflects the modulation used in the session.

ReceiveSpeed
  ParameterID:    rxspd  (0x0004)
  Type:           Integer
  Possible values:        75-56000
  Description:
The Transport parameter reflects the transmission speed seen at the
analog interface for the modem relay or the receive speed used by the
modem termination.

Framing
  ParameterID:    framing  (0x0005)
  Type:           Enumeration
  Possible values:
        None
        MNP4
        V42
  Description:
This parameter reflects the reliability protocol used.

Compression
  ParameterID:    compress  (0x0006)
  Type:           Enumeration
  Possible values:
        None
        MNP5
        V42BIS
  Description:
This parameter reflects the compression algorithm used.

Encapsulation
  ParameterID:    encap  (0x0007)
  Type:           Enumeration
  Possible values:
        Raw
        PPP
        SLIP
  Description:
This parameter reflects the encapsulation used.



Bilias, Kallas                                                 [Page 55]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


18.2 Events

Modem Connection State Change
  Event ID:               modemconnchange  (0x0001)

ObservedEventDescriptorParameters

Modem Connection Change
  ParameterID:    modemconnchng (0x0001)
  Type:           Enumeration
  Possible Value:       EOM - end of session, call terminating
                        RETRAIN
  Description:
This event will occur when the modem connection state for the termination
has changed. Its parameter is the new contents of the Modem Connection
State property.

18.3 Signals
None

18.4 Statistics
Retrains
  StatisticsID:   retrain  (0x0001)
  Units:          count
  Description:
  No of retrain sequences seen by the termination.

Fall Forwards
  StatisticsID:   fallfwd  (0x0002)
  Units:          count
  Description:
  No of fall forward sequences seen by the termination.

Fall Backwards
  StatisticsID:   fallbwd  (0x0003)
  Units:          count
  Description:
  No of fall backwards sequences seen by the termination.

18.5 Procedures
None

19 REFERENCES


[1]  ITU-T Recommendation E.180/Q.35  Technical characteristics of tones
     for the telephone service (03/98)




Bilias, Kallas                                                 [Page 56]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


[2]  ITU-T Recommendation E.182 Application of tones and recorded
     announcements in telephone services (03/98)

[3]  CCITT Recommendation Q.724 (1988). Telephone User Part Signalling
     Procedures

[4]  CCITT Recommendation Q.764 (1988). Signalling System No.7 ISDN User
     Part Signalling Procedures

[5]  ITU-T Recommendation Q.115 (06/97) Logic for the control of echo
     control devices

[6]  CCITT Recommendations Q.400 to Q.490 (1988), Specifications of Sig-
     nalling System R2.

[7]  IETF RFC 1661: Simpson, W., The Point-to-Point Protocol (PPP), July
     1994

[8]  IETF RFC 1889: Schulzrinne, H., et al, RTP: A Transport Protocol
     for Real-Time Applications, January 1996

[9]  IETF RFC 2138: Rigney, C., et al, Remote Authentication Dial In
     Service (RADIUS), April 1997

[10] IETF RFC 2661: Townsley, W., et al, Layer Two Tunneling Protocol
     "L2TP", August 1999

[11] ITU-T Recommendation T.30 (7/96) Procedures for document facsimile
     transmission in the general switched telephone network.

[12] ITU-T Recommendation T.38 (6/98) Procedures for real-time Group 3
     facsimile communication over IP networks.

[13] ITU-T Recommendation V.8 Procedures for starting sessions of data
     transmission over the public switched telephone network

[14] ITU-T Recommendation V.8 bis Procedures for the identification and
     selection of common modes of operation between data circuit-
     termination equipments (DCEs)....

[15] ITU-T Recommendation V.18 Operational and interworking requirements
     for DCES operating in the text telephone mode

[16] ITU-T Recommendation V.25 Automatic answering equipment and/or
     parallel automatic calling equipment on the general switched tele-
     phone network.

[17] ITU-T Recommendation T.140 (1998) - Text conversation protocol for



Bilias, Kallas                                                 [Page 57]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


     multimedia

     application. With amendment 1999.

[18] ITU-T Recommendation H.323 Annex G Text Conversation and Text SET

[19] IETF G. Hellstrm, "RTP Payload for Text Conversation", Internet
     Engineering Task Force, RFC XXX

[20] ITU-T Recommendation T.134 Text Chat Application Entity

[21] ITU-T Recommendation V.17 (02/91) Recommendation V.17 (02/91) - A
     2-wire modem for facsimile applications with rates up to 14 400
     bit/s

[22] ITU-T Recommendation V.27 ter (11/88) - 4800/2400 bits per second
     modem standardized for use in the general switched telephone net-
     work

[23] ITU-T Recommendation V.21 (11/88) - 300 bits per second duplex
     modem standardized for use in the general switched telephone net-
     work

[24] ITU-T Recommendation V.22 (11/88) - 300 bits per second duplex
     modem standardized for use in the general switched telephone net-
     work

[25] ITU-T Recommendation V.22 bis (11/88) - 300 bits per second duplex
     modem standardized for use in the general switched telephone net-
     work

[26] ITU-T Recommendation V.23 (11/88) - 600/1200-baud modem standard-
     ized for use in the general switched telephone network

[27] ITU-T Recommendation V.32 (03/93) - A family of 2-wire, duplex
     modems operating at data signalling rates of up to 9600 bit/s for
     use on the general switched telephone network and on leased
     telephone-type circuits

[28] ITU-T Recommendation V.32 bis (02/91) - A duplex modem operating at
     data signalling rates of up to 14 400 bit/s for use on the general
     switched telephone network and on leased point- to-point 2-wire
     telephone-type circuit

[29] ITU-T Recommendation V.34 (02/91) - A duplex modem operating at
     data signalling rates of up to 14 400 bit/s for use on the general
     switched telephone network and on leased point-to-point 2-wire
     telephone-type circuit



Bilias, Kallas                                                 [Page 58]





Internet draft          Megaco/H.248 Other Pkgs          20 January 2000


[30] ITU-T Recommendation V.90 (09/98) - A digital modem and analogue
     modem pair for use on the Public Switched Telephone Network (PSTN)
     at data signalling rates of up to 56 000 bit/s downstream and up to
     33 600 bit/s upstream

[31] ITU-T Recommendation V.61 (08/96) - A simultaneous voice plus data
     modem, operating at a voice plus data signalling rate of 4800
     bit/s, with optional automatic switching to data-only signalling
     rates of up to 14 400 bit/s, for use on the General Switched ...

[32] ITU-T Recommendation T.37 (6/98) Procedures for the transfer of
     facsimile data via store and forward on the internet

[33] ISO/IEC 10646-1:1993 The Unicode Standard, http://www.unicode.org

20 AUTHOR'S ADDRESSES


           Mike Kallas
           Nortel Networks
           P.O. Box 833805
           Richardson, Texas 75083-3805
           USA
           Email: mike.kallas@nortelnetworks.com

           Zacharias Bilalis
           Siemens
           Schertlinstr. 8
           81379 Munich
           Germany
           Email:  zacharias.bilalis@icn.siemens.fi




















Bilias, Kallas                                                 [Page 59]


