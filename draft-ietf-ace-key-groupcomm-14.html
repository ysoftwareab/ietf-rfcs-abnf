<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Key Provisioning for Group Communication using ACE</title>
<meta content="Francesca Palombini" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="
       This document defines how to use the Authentication and Authorization for Constrained Environments (ACE) framework to distribute keying material and configuration parameters for secure group communication. Candidate group members acting as Clients and authorized to join a group can do so by interacting with a Key Distribution Center (KDC) acting as Resource Server, from which they obtain the keying material to communicate with other group members. While defining general message formats as well as the interface and operations available at the KDC, this document supports different approaches and protocols for secure group communication. Therefore, details are delegated to separate application profiles of this document, as specialized instances that target a particular group communication approach and define how communications in the group are protected. Compliance requirements for such application profiles are also specified. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="draft-ietf-ace-key-groupcomm-14" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-ace-key-groupcomm-14-3dnhevog.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Key Provisioning for Group Communication</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini &amp; Tiloca</td>
<td class="center">Expires 28 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-key-groupcomm-14</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-25" class="published">25 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-28">28 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Key Provisioning for Group Communication using ACE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines how to use the Authentication and Authorization for Constrained Environments (ACE) framework to distribute keying material and configuration parameters for secure group communication. Candidate group members acting as Clients and authorized to join a group can do so by interacting with a Key Distribution Center (KDC) acting as Resource Server, from which they obtain the keying material to communicate with other group members. While defining general message formats as well as the interface and operations available at the KDC, this document supports different approaches and protocols for secure group communication. Therefore, details are delegated to separate application profiles of this document, as specialized instances that target a particular group communication approach and define how communications in the group are protected. Compliance requirements for such application profiles are also specified.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/ace-wg/ace-key-groupcomm">https://github.com/ace-wg/ace-key-groupcomm</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview" class="xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-authorization-to-join-a-gro" class="xref">Authorization to Join a Group</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-authorization-request" class="xref">Authorization Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-authorization-response" class="xref">Authorization Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-token-transferring" class="xref">Token Transferring</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-sign_info-parameter" class="xref">'sign_info' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-kdcchallenge-parameter" class="xref">'kdcchallenge' Parameter</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-kdc-functionalities" class="xref">KDC Functionalities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-interface-at-the-kdc" class="xref">Interface at the KDC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-operations-supported-by-cli" class="xref">Operations Supported by Clients</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-error-handling" class="xref">Error Handling</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-ace-group" class="xref">/ace-group</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-fetch-handler" class="xref">FETCH Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.1">
                        <p id="section-toc.1-1.4.2.2.2.1.2.1.1"><a href="#section-4.2.1.1" class="xref">4.2.1.1</a>.  <a href="#name-retrieve-group-names" class="xref">Retrieve Group Names</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-ace-group-groupname" class="xref">/ace-group/GROUPNAME</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-post-handler" class="xref">POST Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1.2.1">
                        <p id="section-toc.1-1.4.2.3.2.1.2.1.1"><a href="#section-4.3.1.1" class="xref">4.3.1.1</a>.  <a href="#name-join-the-group" class="xref">Join the Group</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-get-handler" class="xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2.2.1">
                        <p id="section-toc.1-1.4.2.3.2.2.2.1.1"><a href="#section-4.3.2.1" class="xref">4.3.2.1</a>.  <a href="#name-retrieve-group-keying-mater" class="xref">Retrieve Group Keying Material</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-ace-group-groupname-pub-key" class="xref">/ace-group/GROUPNAME/pub-key</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-fetch-handler-2" class="xref">FETCH Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1.2.1">
                        <p id="section-toc.1-1.4.2.4.2.1.2.1.1"><a href="#section-4.4.1.1" class="xref">4.4.1.1</a>.  <a href="#name-retrieve-a-subset-of-public" class="xref">Retrieve a Subset of Public Keys in the Group</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-get-handler-2" class="xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2.2.1">
                        <p id="section-toc.1-1.4.2.4.2.2.2.1.1"><a href="#section-4.4.2.1" class="xref">4.4.2.1</a>.  <a href="#name-retrieve-all-public-keys-in" class="xref">Retrieve All Public Keys in the Group</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-ace-group-groupname-kdc-pub" class="xref">ace-group/GROUPNAME/kdc-pub-key</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="xref">4.5.1</a>.  <a href="#name-get-handler-3" class="xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1.2.1">
                        <p id="section-toc.1-1.4.2.5.2.1.2.1.1"><a href="#section-4.5.1.1" class="xref">4.5.1.1</a>.  <a href="#name-retrieve-the-kdcs-public-ke" class="xref">Retrieve the KDC's Public Key</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-ace-group-groupname-policie" class="xref">/ace-group/GROUPNAME/policies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="xref">4.6.1</a>.  <a href="#name-get-handler-4" class="xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1.2.1">
                        <p id="section-toc.1-1.4.2.6.2.1.2.1.1"><a href="#section-4.6.1.1" class="xref">4.6.1.1</a>.  <a href="#name-retrieve-the-group-policies" class="xref">Retrieve the Group Policies</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-ace-group-groupname-num" class="xref">/ace-group/GROUPNAME/num</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.1">
                    <p id="section-toc.1-1.4.2.7.2.1.1"><a href="#section-4.7.1" class="xref">4.7.1</a>.  <a href="#name-get-handler-5" class="xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.1.2.1">
                        <p id="section-toc.1-1.4.2.7.2.1.2.1.1"><a href="#section-4.7.1.1" class="xref">4.7.1.1</a>.  <a href="#name-retrieve-the-keying-materia" class="xref">Retrieve the Keying Material Version</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-ace-group-groupname-nodes-n" class="xref">/ace-group/GROUPNAME/nodes/NODENAME</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1">
                    <p id="section-toc.1-1.4.2.8.2.1.1"><a href="#section-4.8.1" class="xref">4.8.1</a>.  <a href="#name-get-handler-6" class="xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1.2.1">
                        <p id="section-toc.1-1.4.2.8.2.1.2.1.1"><a href="#section-4.8.1.1" class="xref">4.8.1.1</a>.  <a href="#name-retrieve-group-and-individu" class="xref">Retrieve Group and Individual Keying Material</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2">
                    <p id="section-toc.1-1.4.2.8.2.2.1"><a href="#section-4.8.2" class="xref">4.8.2</a>.  <a href="#name-put-handler" class="xref">PUT Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2.2.1">
                        <p id="section-toc.1-1.4.2.8.2.2.2.1.1"><a href="#section-4.8.2.1" class="xref">4.8.2.1</a>.  <a href="#name-request-to-change-individua" class="xref">Request to Change Individual Keying Material</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.3">
                    <p id="section-toc.1-1.4.2.8.2.3.1"><a href="#section-4.8.3" class="xref">4.8.3</a>.  <a href="#name-delete-handler" class="xref">DELETE Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.3.2.1">
                        <p id="section-toc.1-1.4.2.8.2.3.2.1.1"><a href="#section-4.8.3.1" class="xref">4.8.3.1</a>.  <a href="#name-leave-the-group" class="xref">Leave the Group</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-ace-group-groupname-nodes-no" class="xref">/ace-group/GROUPNAME/nodes/NODENAME/pub-key</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9.2.1">
                    <p id="section-toc.1-1.4.2.9.2.1.1"><a href="#section-4.9.1" class="xref">4.9.1</a>.  <a href="#name-post-handler-2" class="xref">POST Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9.2.1.2.1">
                        <p id="section-toc.1-1.4.2.9.2.1.2.1.1"><a href="#section-4.9.1.1" class="xref">4.9.1.1</a>.  <a href="#name-uploading-a-new-public-key" class="xref">Uploading a New Public Key</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-removal-of-a-group-member" class="xref">Removal of a Group Member</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-group-rekeying-process" class="xref">Group Rekeying Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-point-to-point-group-rekeyi" class="xref">Point-to-Point Group Rekeying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-one-to-many-group-rekeying" class="xref">One-to-Many Group Rekeying</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-protection-of-rekeying-mess" class="xref">Protection of Rekeying Messages</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-extended-scope-format" class="xref">Extended Scope Format</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-ace-groupcomm-parameters" class="xref">ACE Groupcomm Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-ace-groupcomm-error-identif" class="xref">ACE Groupcomm Error Identifiers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-secure-communication-in-the" class="xref">Secure Communication in the Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-update-of-group-keying-mate" class="xref">Update of Group Keying Material</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="xref">10.2.1</a>.  <a href="#name-misalignment-of-group-keyin" class="xref">Misalignment of Group Keying Material</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-block-wise-considerations" class="xref">Block-Wise Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-media-type-registrations" class="xref">Media Type Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-coap-content-formats" class="xref">CoAP Content-Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-oauth-parameters" class="xref">OAuth Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="xref">11.4</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="xref">OAuth Parameters CBOR Mappings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="xref">11.5</a>.  <a href="#name-interface-description-if-li" class="xref">Interface Description (if=) Link Target Attribute Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="xref">11.6</a>.  <a href="#name-cbor-tags" class="xref">CBOR Tags</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a href="#section-11.7" class="xref">11.7</a>.  <a href="#name-ace-groupcomm-parameters-3" class="xref">ACE Groupcomm Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.8">
                <p id="section-toc.1-1.11.2.8.1"><a href="#section-11.8" class="xref">11.8</a>.  <a href="#name-ace-groupcomm-key-types" class="xref">ACE Groupcomm Key Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.9">
                <p id="section-toc.1-1.11.2.9.1"><a href="#section-11.9" class="xref">11.9</a>.  <a href="#name-ace-groupcomm-profiles" class="xref">ACE Groupcomm Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.10">
                <p id="section-toc.1-1.11.2.10.1"><a href="#section-11.10" class="xref">11.10</a>. <a href="#name-ace-groupcomm-policies-2" class="xref">ACE Groupcomm Policies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.11">
                <p id="section-toc.1-1.11.2.11.1"><a href="#section-11.11" class="xref">11.11</a>. <a href="#name-sequence-number-synchroniza" class="xref">Sequence Number Synchronization Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.12">
                <p id="section-toc.1-1.11.2.12.1"><a href="#section-11.12" class="xref">11.12</a>. <a href="#name-ace-scope-semantics" class="xref">ACE Scope Semantics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.13">
                <p id="section-toc.1-1.11.2.13.1"><a href="#section-11.13" class="xref">11.13</a>. <a href="#name-ace-groupcomm-errors" class="xref">ACE Groupcomm Errors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.14">
                <p id="section-toc.1-1.11.2.14.1"><a href="#section-11.14" class="xref">11.14</a>. <a href="#name-ace-groupcomm-rekeying-schem" class="xref">ACE Groupcomm Rekeying Schemes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.15">
                <p id="section-toc.1-1.11.2.15.1"><a href="#section-11.15" class="xref">11.15</a>. <a href="#name-expert-review-instructions" class="xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-requirements-on-application" class="xref">Requirements on Application Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-mandatory-to-address-requir" class="xref">Mandatory-to-Address Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-optional-to-address-require" class="xref">Optional-to-Address Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-extensibility-for-future-co" class="xref">Extensibility for Future COSE Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-format-of-sign_info_entry" class="xref">Format of 'sign_info_entry'</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-document-updates" class="xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-version-13-to-14" class="xref">Version -13 to -14</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-version-05-to-13" class="xref">Version -05 to -13</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-version-04-to-05" class="xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-C.4" class="xref">C.4</a>.  <a href="#name-version-03-to-04" class="xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#appendix-C.5" class="xref">C.5</a>.  <a href="#name-version-02-to-03" class="xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#appendix-C.6" class="xref">C.6</a>.  <a href="#name-version-01-to-02" class="xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7">
                <p id="section-toc.1-1.15.2.7.1"><a href="#appendix-C.7" class="xref">C.7</a>.  <a href="#name-version-00-to-01" class="xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document builds on the Authentication and Authorization for Constrained Environments (ACE) framework and defines how to request, distribute and renew keying material and configuration parameters to protect message exchanges in a group communication environment.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Candidate group members acting as Clients and authorized to join a group can interact with the Key Distribution Center (KDC) acting as Resource Server and responsible for that group, in order to obtain the necessary keying material and parameters to communicate with other group members.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">In particular, this document defines the operations and interface available at the KDC, as well as general message formats for the interactions between Clients and KDC. At the same time, communications in the group can rely on different approaches, e.g., based on multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span> or on publish-subscribe messaging <span>[<a href="#I-D.ietf-core-coap-pubsub" class="xref">I-D.ietf-core-coap-pubsub</a>]</span>, and can be protected in different ways.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Therefore, this document delegates details on the communication and security approaches used in a group to separate application profiles. These are specialized instances of this document, targeting a particular group communication approach and defining how communications in the group are protected, as well as the specific keying material and configuration parameters provided to group members. In order to ensure consistency and aid the development of such application profiles, this document defines a number of related compliance requirements (see <a href="#req" class="xref">Appendix A</a>).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">If the application requires backward and forward security, new keying material is generated and distributed to the group upon membership changes (rekeying). A group rekeying scheme performs the actual distribution of the new keying material, by rekeying the current group members when a new Client joins the group, and the remaining group members when a Client leaves the group. This can rely on different approaches, including efficient group rekeying schemes such as <span>[<a href="#RFC2093" class="xref">RFC2093</a>]</span>, <span>[<a href="#RFC2094" class="xref">RFC2094</a>]</span> and <span>[<a href="#RFC2627" class="xref">RFC2627</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Consistently with what is recommeded in the ACE framework, this document uses CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span> for data encoding. However, using JSON <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span> instead of CBOR is possible, by relying on the conversion method specified in Sections <a href="https://rfc-editor.org/rfc/rfc8949#section-6.1" class="relref">6.1</a> and <a href="https://rfc-editor.org/rfc/rfc8949#section-6.2" class="relref">6.2</a> of <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">The terms and concepts described in the ACE framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and in the Authorization Information Format (AIF) <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span> to express authorization information. The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, this includes Client (C), Resource Server (RS), and Authorization Server (AS).<a href="#section-1.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.2">The terms and concepts described in CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. Unless otherwise indicated, the term "endpoint" is used here following its OAuth definition, aimed at denoting resources such as /token and /introspect at the AS, and /authz-info at the RS. This document does not use the CoAP definition of "endpoint", which is "An entity participating in the CoAP protocol".<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.3">The terms and concepts described in CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span> and COSE <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span><span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span><span>[<a href="#I-D.ietf-cose-countersign" class="xref">I-D.ietf-cose-countersign</a>]</span>.<a href="#section-1.1-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-4">A principal interested to participate in group communication as well as already participating as a group member is interchangeably denoted as "Client" or "node".<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Furthermore, this document uses "names" or "identifiers" for groups and nodes. Their different meanings are summarized below.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-6.1">
            <p id="section-1.1-6.1.1">Group: a set of nodes that share common keying material and security parameters used to protect their communications with one another. That is, the term refers to a "security group".<a href="#section-1.1-6.1.1" class="pilcrow">¶</a></p>
<p id="section-1.1-6.1.2">
This is not to be confused with an "application group", which has relevance at the application level and whose members share a common pool of resources or content. Examples of application groups are the set of all nodes deployed in a same physical room, or the set of nodes registered to a pub-sub topic.<a href="#section-1.1-6.1.2" class="pilcrow">¶</a></p>
<p id="section-1.1-6.1.3">
The same security group might be associated to multiple application groups. Also, the same application group can be associated to multiple security groups. Further details and considerations on the mapping between the two types of group are out of the scope of this document.<a href="#section-1.1-6.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-6.2">Key Distribution Center (KDC): the entity responsible for managing one or multiple groups, with particular reference to the group membership and the keying material to use for protecting group communications.<a href="#section-1.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.3">Group name: the invariant once established identifier of a group. It is used in the interactions between Client, AS and RS to identify a group. A group name is always unique among the group names of the existing groups under the same KDC.<a href="#section-1.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.4">GROUPNAME: the invariant once established text string used in URIs. GROUPNAME uniquely maps to the group name of a group, although they do not necessarily coincide.<a href="#section-1.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.5">Group identifier: the identifier of the group keying material used in a group. Unlike group name and GROUPNAME, this identifier changes over time, when the group keying material is updated.<a href="#section-1.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.6">Node name: the invariant once established identifier of a node. It is used in the interactions between Client and RS and to identify a member of a group. Within the same group, a node name is always unique among the node names of all the current members of that group.<a href="#section-1.1-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.7">NODENAME: the invariant once established text string used in URIs to identify a member a group. Its value coincides with the node name of the associated group member.<a href="#section-1.1-6.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-7">This document additionally uses the following terminology:<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-8.1">Transport profile, to indicate a profile of ACE as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.8.4.3" class="relref">Section 5.8.4.3</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. A transport profile specifies the communication protocol and communication security protocol between an ACE Client and Resource Server, as well as proof-of-possession methods, if it supports proof-of-possession access tokens, etc. Transport profiles of ACE include, for instance, <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>, <span>[<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span> and <span>[<a href="#I-D.ietf-ace-mqtt-tls-profile" class="xref">I-D.ietf-ace-mqtt-tls-profile</a>]</span>.<a href="#section-1.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.2">Application profile, that defines how applications enforce and use supporting security services they require. These services may include, for instance, provisioning, revocation and distribution of keying material. An application profile may define specific procedures and message formats.<a href="#section-1.1-8.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">The full procedure can be separated in two phases: the first one follows the ACE Framework, between Client, AS and KDC; the second one is the key distribution between Client and KDC. After the two phases are completed, the Client is able to participate in the group communication, via a Dispatcher entity.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span id="name-key-distribution-participan"></span><div id="fig-roles">
<figure id="figure-1">
        <div class="alignCenter art-text artwork" id="section-2-2.1">
<pre>
+------------+               +-----------+
|     AS     |               |    KDC    |
|            |        .-----&gt;|           |
+------------+       /       +-----------+
      ^             /
      |            /
      v           /                                 +-----------+
+------------+   /           +------------+         |+-----------+
|   Client   |&lt;-'            | Dispatcher |         ||+-----------+
|            |&lt;-------------&gt;|            |&lt;-------&gt;|||   Group   |
+------------+               +------------+         |||  members  |
                                                    +++-----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-key-distribution-participan" class="selfRef">Key Distribution Participants</a>
        </figcaption></figure>
</div>
<p id="section-2-3">The following participants (see <a href="#fig-roles" class="xref">Figure 1</a>) take part in the authorization and key distribution.<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">Client (C): node that wants to join a group and take part in group communication with other group memebrs. Within the group, the Client can have different roles.<a href="#section-2-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.2">Authorization Server (AS): as per the AS defined in the ACE Framework, it enforces access policies, and knows if a node is allowed to join a given group with write and/or read rights.<a href="#section-2-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.3">Key Distribution Center (KDC): maintains the keying material to protect group communications, and provides it to Clients authorized to join a given group. During the first part of the exchange (<a href="#sec-auth" class="xref">Section 3</a>), it takes the role of the RS in the ACE Framework. During the second part (<a href="#key-distr" class="xref">Section 4</a>), which is not based on the ACE Framework, it distributes the keying material. In addition, it provides the latest keying material to group members when requested or, if required by the application, when membership changes.<a href="#section-2-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.4">
          <p id="section-2-4.4.1">Dispatcher: entity through which the Clients communicate with the group, when sending a message intended to multiple group members. That is, the Dispatcher distributes such a one-to-many message to the group members as intended recipients. A single-recipient message intended to only one group member may be delivered by alternative means, with no assistance from the Dispatcher.<a href="#section-2-4.4.1" class="pilcrow">¶</a></p>
<p id="section-2-4.4.2">
Examples of a Dispatcher are: the Broker in a pub-sub setting; a relayer for group communication that delivers group messages as multiple unicast messages to all group members; an implicit entity as in a multicast communication setting, where messages are transmitted to a multicast IP address and delivered on the transport channel.<a href="#section-2-4.4.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-5">This document specifies a mechanism for:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-6.1">Authorizing a Client to join the group (<a href="#sec-auth" class="xref">Section 3</a>), and providing it with the group keying material to communicate with the other group members (<a href="#key-distr" class="xref">Section 4</a>).<a href="#section-2-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.2">Allowing a group member to retrieve group keying material (<a href="#update-keys" class="xref">Section 4.8.1.1</a> and <a href="#new-keys" class="xref">Section 4.8.2.1</a>).<a href="#section-2-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.3">Allowing a group member to retrieve public keys of other group members (<a href="#sec-key-retrieval" class="xref">Section 4.4.1.1</a>) and to provide an updated public key (<a href="#update-pub-key" class="xref">Section 4.9.1.1</a>).<a href="#section-2-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.4">Allowing a group member to leave the group (<a href="#sec-node-removal" class="xref">Section 5</a>).<a href="#section-2-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.5">Evicting a group member from the group (<a href="#sec-node-removal" class="xref">Section 5</a>).<a href="#section-2-6.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.6">Renewing and re-distributing the group keying material (rekeying) upon a membership change in the group (<a href="#ssec-group-leaving" class="xref">Section 4.8.3.1</a> and <a href="#sec-node-removal" class="xref">Section 5</a>).<a href="#section-2-6.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-7"><a href="#fig-flow" class="xref">Figure 2</a> provides a high level overview of the message flow for a node joining a group. The message flow can be expanded as follows.<a href="#section-2-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-8">
<li id="section-2-8.1">
          <p id="section-2-8.1.1">The joining node requests an access token from the AS, in order to access one or more group-membership resources at the KDC and hence join the associated groups.<a href="#section-2-8.1.1" class="pilcrow">¶</a></p>
<p id="section-2-8.1.2">
This exchange between Client and AS MUST be secured, as specified by the transport profile of ACE used between Client and KDC. Based on the response from the AS, the joining node will establish or continue using a secure communication association with the KDC.<a href="#section-2-8.1.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-8.2">
          <p id="section-2-8.2.1">The joining node transfers authentication and authorization information to the KDC, by transferring the obtained access token. This is typically achieved by including the access token in a request sent to the /authz-info endpoint at the KDC.<a href="#section-2-8.2.1" class="pilcrow">¶</a></p>
<p id="section-2-8.2.2">
Once this exchange is completed, the joining node MUST have a secure communication association established with the KDC, before joining a group under that KDC.<a href="#section-2-8.2.2" class="pilcrow">¶</a></p>
<p id="section-2-8.2.3">
This exchange and the following secure communications between the Client and the KDC MUST occur in accordance with the transport profile of ACE used between Client and KDC, such as the DTLS transport profile <span>[<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span> and OSCORE transport profile <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span> of ACE.<a href="#section-2-8.2.3" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-8.3">
          <p id="section-2-8.3.1">The joining node starts the joining process to become a member of the group, by sending a request to the related group-membership resource at the KDC. Based on the application requirements and policies, the KDC may perform a group rekeying, by generating new group keying material and distributing it to the current group members through the rekeying scheme used in the group.<a href="#section-2-8.3.1" class="pilcrow">¶</a></p>
<p id="section-2-8.3.2">
At the end of the joining process, the joining node has received from the KDC the parameters and group keying material to securely communicate with the other group members. Also, the KDC has stored the association between the authorization information from the access token and the secure session with the joining node.<a href="#section-2-8.3.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-8.4">The joining node and the KDC maintain the secure association, to support possible future communications. These especially include key management operations, such as retrieval of updated keying material or participation to a group rekeying process.<a href="#section-2-8.4" class="pilcrow">¶</a>
</li>
        <li id="section-2-8.5">The joining node can communicate securely with the other group members, using the keying material provided in step 3.<a href="#section-2-8.5" class="pilcrow">¶</a>
</li>
      </ol>
<span id="name-message-flow-upon-new-nodes"></span><div id="fig-flow">
<figure id="figure-2">
        <div class="alignCenter art-text artwork" id="section-2-9.1">
<pre>
        C                            AS  KDC                   Group
        |                             |   |                   Members
      / |                             |   |                      |
     |  |--- Authorization Request --&gt;|   |                      |
     |  |                             |   |                      |
     |  |&lt;-- Authorization Response --|   |                      |
(*) &lt;   |                             |   |                      |
     |  |                             |   |                      |
     |  |---  Token Transfer Request ----&gt;|                      |
     |  |                                 |                      |
     |  |&lt;--- Token Transfer Response-----|                      |
      \ |                             |   |                      |
        |                             |   |                      |
        |------ Joining Request ---------&gt;|                      |
        |                             |   |                      |
        |                             |   | -- Group rekeying --&gt;|
        |                             |   |      (optional)      |
        |&lt;----- Joining Response ---------|                      |
        |                             |   |                      |
        |                             |   |                      |
        |                             |   |       Dispatcher     |
        |                                             |          |
        |&lt;======= Secure group communication =========|=========&gt;|
        |                                             |          |

(*) Defined in the ACE framework
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-message-flow-upon-new-nodes" class="selfRef">Message Flow Upon New Node's Joining</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-auth">
<section id="section-3">
      <h2 id="name-authorization-to-join-a-gro">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-authorization-to-join-a-gro" class="section-name selfRef">Authorization to Join a Group</a>
      </h2>
<p id="section-3-1">This section describes in detail the format of messages exchanged by the participants when a node requests access to a given group. This exchange is based on ACE <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">As defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, the Client requests the AS for the authorization to join the group through the KDC (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>). If the request is approved and authorization is granted, the AS provides the Client with a proof-of-possession access token and parameters to securely communicate with the KDC (see <a href="#ssec-authorization-response" class="xref">Section 3.2</a>).<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Communications between the Client and the AS MUST be secured, according to what is defined by the used transport profile of ACE. The Content-Format used in the message also depends on the used transport profile of ACE. For example, it can be application/ace+cbor for the first two messages and application/cwt for the third message, which are defined in the ACE framework.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The transport profile of ACE also defines a number of details such as the communication and security protocols used with the KDC (see Appendix C of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5"><a href="#fig-group-member-registration" class="xref">Figure 3</a> gives an overview of the exchange described above.<a href="#section-3-5" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-join-author"></span><div id="fig-group-member-registration">
<figure id="figure-3">
        <div class="alignCenter art-text artwork" id="section-3-6.1">
<pre>
Client                                             AS    KDC
   |                                                |     |
   |---- Authorization Request: POST /token -------&gt;|     |
   |                                                |     |
   |&lt;--- Authorization Response: 2.01 (Created) ----|     |
   |                                                |     |
   |---- Token Transfer Request: POST /authz-info -------&gt;|
   |                                                |     |
   |&lt;--- Token Transfer Response: 2.01 (Created) --------&gt;|
   |                                                |     |
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-message-flow-of-join-author" class="selfRef">Message Flow of Join Authorization</a>
        </figcaption></figure>
</div>
<div id="ssec-authorization-request">
<section id="section-3.1">
        <h3 id="name-authorization-request">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-3.1-1">The Authorization Request sent from the Client to the AS is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and MAY contain the following parameters, which, if included, MUST have format and value as specified below.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">'scope', specifying the name of the groups that the Client requests to access, and optionally the roles that the Client requests to have in those groups.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.2">
This parameter is encoded as a CBOR byte string, which wraps a CBOR array of one or more scope entries. All the scope entries are specified according to a same format, i.e. either the AIF format or the textual format defined below.<a href="#section-3.1-2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1.3.1">
                <p id="section-3.1-2.1.3.1.1">If the AIF format is used, each scope entry is encoded as specified in <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span>. The object identifier "Toid" corresponds to the group name and MUST be encoded as a CBOR text string. The permission set "Tperm" indicates the roles that the Client wishes to take in the group.<a href="#section-3.1-2.1.3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.3.1.2">
The AIF format is the default format for application profiles of this specification, and is preferable for those that aim to a compact encoding of scope. This is desirable especially for application profiles defining several roles, with the Client possibly requesting for multiple roles combined.<a href="#section-3.1-2.1.3.1.2" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.3.1.3"><a href="#cddl-ex-0" class="xref">Figure 4</a> shows an example in CDDL notation <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> where scope uses the AIF format.<a href="#section-3.1-2.1.3.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.1.3.2">
                <p id="section-3.1-2.1.3.2.1">If the textual format is used, each scope entry is a CBOR array formatted as follows.<a href="#section-3.1-2.1.3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1.3.2.2.1">As first element, the group name, encoded as a CBOR text string.<a href="#section-3.1-2.1.3.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.1-2.1.3.2.2.2">Optionally, as second element, the role or CBOR array of roles that the Client wishes to take in the group. This element is optional since roles may have been pre-assigned to the Client, as associated to its verifiable identity credentials. Alternatively, the application may have defined a single, well-known role for the target resource(s) and audience(s).<a href="#section-3.1-2.1.3.2.2.2" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-3.1-2.1.3.2.3">
<a href="#cddl-ex" class="xref">Figure 5</a> shows an example in CDDL notation where scope uses the textual format, with group name and role identifiers encoded as CBOR text strings.<a href="#section-3.1-2.1.3.2.3" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.1-2.1.4">
It is REQUIRED of application profiles of this specificaton to specify the exact format and encoding of scope (REQ1). This includes defining the set of possible roles and their identifiers, as well as the corresponding encoding to use in the scope entries according to the used scope format.<a href="#section-3.1-2.1.4" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.5">
If the application profile uses the AIF format, it is also REQUIRED to register its specific instance of "Toid" and "Tperm", as well as the corresponding Media Type and Content-Format, as per the guidelines in <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span> (REQ2).<a href="#section-3.1-2.1.5" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.6">
If the application profile uses the textual format, it MAY additionally specify CBOR values to use for abbreviating the role identifiers (OPT1).<a href="#section-3.1-2.1.6" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">'audience', with an identifier of the KDC.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">As defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, other additional parameters can be included if necessary.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-example-of-scope-using-the-"></span><div id="cddl-ex-0">
<figure id="figure-4">
          <div id="section-3.1-4.1">
<pre class="lang-CDDL sourcecode">
gname = tstr

permissions = uint . bits roles

roles = &amp;(
   Requester: 1,
   Responder: 2,
   Monitor: 3,
   Verifier: 4
)

scope_entry = AIF_Generic&lt;gname, permissions&gt;

scope = &lt;&lt; [ + scope_entry ] &gt;&gt;
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-scope-using-the-" class="selfRef">Example of scope using the AIF format</a>
          </figcaption></figure>
</div>
<span id="name-example-of-scope-using-the-t"></span><div id="cddl-ex">
<figure id="figure-5">
          <div id="section-3.1-5.1">
<pre class="lang-CDDL sourcecode">
gname = tstr

role = tstr

scope_entry = [ gname , ? ( role / [ 2*role ] ) ]

scope = &lt;&lt; [ + scope_entry ] &gt;&gt;
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-scope-using-the-t" class="selfRef">Example of scope using the textual format, with the group name and role identifiers encoded as text strings</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="ssec-authorization-response">
<section id="section-3.2">
        <h3 id="name-authorization-response">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authorization-response" class="section-name selfRef">Authorization Response</a>
        </h3>
<p id="section-3.2-1">The AS processes the Authorization Request as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, especially verifying that the Client is authorized to access the specified groups with the requested roles, or possibly a subset of those.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In case of successful verification, the Authorization Response sent from the AS to the Client is also defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. Note that the parameter 'expires_in' MAY be omitted if the application defines how the expiration time is communicated to the Client via other means, or if it establishes a default value.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Additionally, when included, the following parameter MUST have the corresponding values:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">'scope' has the same format and encoding of 'scope' in the Authorization Request, defined in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>. If this parameter is not present, the granted scope is equal to the one requested in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-5">The proof-of-possession access token (in 'access_token' above) MUST contain the following parameters:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">a confirmation claim (see for example 'cnf' defined in <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span> for CWT);<a href="#section-3.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.2">an expiration time claim (see for example 'exp' defined in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-3.1.4" class="relref">Section 3.1.4</a> of [<a href="#RFC8392" class="xref">RFC8392</a>]</span> for CWT);<a href="#section-3.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.3">
            <p id="section-3.2-6.3.1">a scope claim (see for example 'scope' registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-8.14" class="relref">Section 8.14</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> for CWT).<a href="#section-3.2-6.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2-6.3.2">
This claim specifies the same access control information as in the 'scope' parameter of the Authorization Response, if the parameter is present in the message, or as in the 'scope' parameter of the Authorization Request otherwise.<a href="#section-3.2-6.3.2" class="pilcrow">¶</a></p>
<p id="section-3.2-6.3.3">
By default, this claim has the same encoding as the 'scope' parameter in the Authorization Request, defined in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>.<a href="#section-3.2-6.3.3" class="pilcrow">¶</a></p>
<p id="section-3.2-6.3.4">
Optionally, an alternative extended format of scope defined in <a href="#sec-extended-scope" class="xref">Section 7</a> can be used. This format explicitly signals the semantics used to express the actual access control information, and according to which this has to be parsed. This enables a Resource Server to correctly process a received access token, also in case:<a href="#section-3.2-6.3.4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.3.5.1">The Resource Server implements a KDC that supports multiple application profiles of this specification, using different scope semantics; and/or<a href="#section-3.2-6.3.5.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-6.3.5.2">The Resource Server implements further services beyond a KDC for group communication, using different scope semantics.<a href="#section-3.2-6.3.5.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-3.2-6.3.6">
If the Authorization Server is aware that this applies to the Resource Server for which the access token is issued, the Authorization Server SHOULD use the extended format of scope defined in <a href="#sec-extended-scope" class="xref">Section 7</a>.<a href="#section-3.2-6.3.6" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">The access token MAY additionally contain other claims that the transport profile of ACE requires, or other optional parameters.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">When receiving an Authorization Request from a Client that was previously authorized, and for which the AS still owns a valid non-expired access token, the AS MAY reply with that token. Note that it is up to application profiles of ACE to make sure that re-posting the same token does not cause re-use of keying material between nodes (for example, that is done with the use of random nonces in <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>).<a href="#section-3.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-post">
<section id="section-3.3">
        <h3 id="name-token-transferring">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-token-transferring" class="section-name selfRef">Token Transferring</a>
        </h3>
<p id="section-3.3-1">The Client sends a Token Transfer Request to the KDC, i.e., a CoAP POST request including the access token and targeting the authz-info endpoint (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Note that this request deviates from the one defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, since it allows to ask the KDC for additional information concerning the public keys used in the group to ensure source authentication, as well as for possible additional group parameters.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The joining node MAY ask for this information from the KDC through the same Token Transfer Request. In this case, the message MUST have Content-Format set to application/ace+cbor defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-8.16" class="relref">Section 8.16</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, and the message payload MUST be formatted as a CBOR map, which MUST include the access token. The CBOR map MAY additionally include the following parameter, which, if included, MUST have format and value as specified below.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">'sign_info' defined in <a href="#sign-info" class="xref">Section 3.3.1</a>, specifying the CBOR simple value 'null' (0xf6) to request information about the signature algorithm, signature algorithm parameters, signature key parameters and about the exact encoding of public keys used in the groups that the Client has been authorized to join.<a href="#section-3.3-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-5">Alternatively, such information may be pre-configured on the joining node, or may be retrieved by alternative means. For example, the joining node may have performed an early group discovery process and obtained the link to the associated group-membership resource at the KDC, together with attributes descriptive of the group configuration (see, e.g., <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span>).<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">After successful verification, the Client is authorized to receive the group keying material from the KDC and join the group. Hence, the KDC replies to the Client with a Token Transfer Response, i.e., a  CoAP 2.01 (Created) response.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">The Token Transfer Response MUST have Content-Format "application/ace+cbor", and its payload is a CBOR map. Note that this deviates from what is defined in the ACE framework, where the response from the authz-info endpoint is defined as conveying no payload (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">If the access token contains a role that requires the Client to send its own public key to the KDC when joining the group, the CBOR map MUST include the parameter 'kdcchallenge' defined in <a href="#kdcchallenge" class="xref">Section 3.3.2</a>, specifying a dedicated challenge N_S generated by the KDC.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">Later, when joining the group (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>), the Client uses the 'kdcchallenge' value and additional information to build a proof-of-possession (PoP) input. This is in turn used to compute a PoP evidence, which the Client also provides to the Group Manager in order to prove possession of its own private key (see the 'client_cred_verify' parameter in <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10">The KDC MUST store the 'kdcchallenge' value associated to the Client at least until it receives a Joining Request from it (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>), to be able to verify the PoP evidence provided during the join process, and thus that the Client possesses its own private key.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">The same 'kdcchallenge' value MAY be reused several times by the Client, to generate a new PoP evidence, e.g., in case the Client provides the Group Manager with a new public key while being a group member (see <a href="#update-pub-key" class="xref">Section 4.9.1.1</a>), or joins a different group where it intends to use a different public key. Therefore, it is RECOMMENDED that the KDC keeps storing the 'kdcchallenge' value after the first join is processed as well. If the KDC has already discarded the 'kdcchallenge' value, that will trigger an error response with a newly generated 'kdcchallenge' value that the Client can use to restart the join process, as specified in <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>.<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<p id="section-3.3-12">If 'sign_info' is included in the Token Transfer Request, the KDC SHOULD include the 'sign_info' parameter in the Token Transfer Response, as per the format defined in <a href="#sign-info" class="xref">Section 3.3.1</a>. Note that the field 'id' of each 'sign_info_entry' specifies the name, or array of group names, for which that 'sign_info_entry' applies to. As an exception, the KDC MAY NOT include the 'sign_info' parameter in the Token Transfer Response even if 'sign_info' is included in the Token Transfer Request, in case none of the groups that the Client is authorized to join uses signatures to achieve source authentication.<a href="#section-3.3-12" class="pilcrow">¶</a></p>
<p id="section-3.3-13">Note that the CBOR map specified as payload of the 2.01 (Created) response may include further parameters, e.g., according to the used transport profile of ACE. Application profiles of this specification MAY define additional parameters to use within this exchange (OPT2).<a href="#section-3.3-13" class="pilcrow">¶</a></p>
<p id="section-3.3-14">Application profiles of this specification MAY define alternative specific negotiations of parameter values for the signature algorithm and signature keys, if 'sign_info' is not used (OPT3).<a href="#section-3.3-14" class="pilcrow">¶</a></p>
<p id="section-3.3-15">If allowed by the used transport profile of ACE, the Client may provide the Access Token to the KDC by other means than the Token Transfer Request. An example is the DTLS transport profile of ACE, where the Client can provide the access token to the KDC during the secure session establishment (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-dtls-authorize-18#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span>).<a href="#section-3.3-15" class="pilcrow">¶</a></p>
<div id="sign-info">
<section id="section-3.3.1">
          <h4 id="name-sign_info-parameter">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-sign_info-parameter" class="section-name selfRef">'sign_info' Parameter</a>
          </h4>
<p id="section-3.3.1-1">The 'sign_info' parameter is an OPTIONAL parameter of the request and response messages exchanged between the Client and the authz-info endpoint at the RS (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.10.1." class="relref">Section 5.10.1.</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">This parameter allows the Client and the RS to exchange information about a signature algorithm and about public keys to accordingly use for signature verification. Its exact semantics and content are application specific.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">In this specification and in application profiles building on it, this parameter is used to exchange information about the signature algorithm and about public keys to be used with it, in the groups indicated by the transferred acces token as per its 'scope' claim (see <a href="#ssec-authorization-response" class="xref">Section 3.2</a>).<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">When used in the Token Transfer Request sent to the KDC (see <a href="#token-post" class="xref">Section 3.3</a>), the 'sign_info' parameter specifies the CBOR simple value 'null' (0xf6). This is done to ask for information about the signature algorithm and about the public keys used in the groups that the Client has been authorized to join - or to have a more restricted interaction as per its granted roles (e.g., the Client is an external signature verifier).<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">When used in the following Token Transfer Response from the KDC (see <a href="#token-post" class="xref">Section 3.3</a>), the 'sign_info' parameter is a CBOR array of one or more elements. The number of elements is at most the number of groups that the Client has been authorized to join - or to have a more restricted interaction (see above). Each element contains information about signing parameters and about public keys for one or more groups, and is formatted as follows.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-6.1">The first element 'id' is a group name or an array of group names, associated to groups for which the next four elements apply. In the following, each specified group name is referred to as 'gname'.<a href="#section-3.3.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.2">The second element 'sign_alg' is an integer or a text string if the POST request included the 'sign_info' parameter with value the CBOR simple value 'null' (0xf6), and indicates the signature algorithm used in the groups identified by the 'gname' values. It is REQUIRED of the application profiles to define specific values that this parameter can take (REQ3), selected from the set of signing algorithms of the COSE Algorithms registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-3.3.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.3">The third element 'sign_parameters' is a CBOR array indicating the parameters of the signature algorithm used in the groups identified by the 'gname' values. Its content depends on the value of 'sign_alg'. It is REQUIRED of the application profiles to define the possible values and structure for the elements of this parameter (REQ4).<a href="#section-3.3.1-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.4">The fourth element 'sign_key_parameters' is a CBOR array indicating the parameters of the key used with the signature algorithm, in the groups identified by the 'gname' values. Its content depends on the value of 'sign_alg'. It is REQUIRED of the application profiles to define the possible values and structure for the elements of this parameter (REQ5).<a href="#section-3.3.1-6.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.5">The fifth element 'pub_key_enc' parameter is either a CBOR integer indicating the encoding of public keys used in the groups identified by the 'gname' values, or has value the CBOR simple value 'null' (0xf6) indicating that the KDC does not act as repository of public keys for group members. Its acceptable integer values are taken from the 'Label' column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span>. It is REQUIRED of the application profiles to define specific values to use for this parameter, consistently with the acceptable formats of public keys (REQ6).<a href="#section-3.3.1-6.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.3.1-7">The CDDL notation <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> of the 'sign_info' parameter is given below.<a href="#section-3.3.1-7" class="pilcrow">¶</a></p>
<div id="section-3.3.1-8">
<pre class="lang-CDDL sourcecode">
sign_info = sign_info_req / sign_info_resp

sign_info_req  = nil                   ; in the Token Transfer
                                       ; Request to the KDC

sign_info_resp = [ + sign_info_entry ] ; in the Token Transfer
                                       ; Response from the KDC

sign_info_entry =
[
  id : gname / [ + gname ],
  sign_alg : int / tstr,
  sign_parameters : [ any ],
  sign_key_parameters : [ any ],
  pub_key_enc = int / nil
]

gname = tstr
</pre><a href="#section-3.3.1-8" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-9">This format is consistent with every signature algorithm currently defined in <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. <a href="#sec-future-cose-algs" class="xref">Appendix B</a> describes how the format of each 'sign_info_entry' can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-3.3.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kdcchallenge">
<section id="section-3.3.2">
          <h4 id="name-kdcchallenge-parameter">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-kdcchallenge-parameter" class="section-name selfRef">'kdcchallenge' Parameter</a>
          </h4>
<p id="section-3.3.2-1">The 'kdcchallenge' parameter is an OPTIONAL parameter of response message returned from the authz-info endpoint at the RS, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter contains a challenge generated by the RS and provided to the Client.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">In this specification and in application profiles building on it, the Client may use this challenge to prove possession of its own private key in the Joining Request (see the 'client_cred_verify' parameter in <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="key-distr">
<section id="section-4">
      <h2 id="name-kdc-functionalities">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-kdc-functionalities" class="section-name selfRef">KDC Functionalities</a>
      </h2>
<p id="section-4-1">This section describes the functionalities provided by the KDC, as related to the provisioning of the keying material as well as to the group membership management.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">In particular, this section defines the interface available at the KDC; specifies the handlers of each resource provided by the KDC interface; and describes how Clients interact with those resources to join a group and to perform additional operations as group members.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">As most important operation after trasferring the access token to the KDC, the Client can perform a "Joining" exchange with the KDC, by specifying the group it requests to join (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>). Then, the KDC verifies the access token and that the Client is authorized to join the specified group. If so, the KDC provides the Client with the keying material to securely communicate with the other members of the group.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Later on as a group member, the Client can also rely on the interface at the KDC to perform additional operations, consistently with the roles it has in the group.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="kdc-if">
<section id="section-4.1">
        <h3 id="name-interface-at-the-kdc">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-interface-at-the-kdc" class="section-name selfRef">Interface at the KDC</a>
        </h3>
<p id="section-4.1-1">The KDC provides its interface by hosting the following resources. Note that the root url-path "ace-group" used hereafter is a default name; implementations are not required to use this name, and can define their own instead. The Interface Description (if=) Link Target Attribute value "ace.group" is registered in <a href="#if-ace-group" class="xref">Section 11.5</a> and can be used to describe this interface.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">If request messages sent to the KDC as well as success response messages from the KDC include a payload and specify a Content-Format, those messages MUST have Content-Format set to application/ace-groupcomm+cbor, defined in <a href="#content-type" class="xref">Section 11.2</a>. CBOR labels for the message parameters are defined in <a href="#params" class="xref">Section 8</a>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">
            <p id="section-4.1-3.1.1">/ace-group : this resource is invariant once established, and indicates that this specification is used. If other applications run on a KDC implementing this specification and use this same resource, those applications will collide, and a mechanism will be needed to differentiate the endpoints.<a href="#section-4.1-3.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.1.2">
A Client can access this resource in order to retrieve a set of group names, each corresponding to one of the specified group identifiers. This operation is described in <a href="#retrieval-gnames" class="xref">Section 4.2.1.1</a>.<a href="#section-4.1-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.2">
            <p id="section-4.1-3.2.1">/ace-group/GROUPNAME : one such sub-resource to /ace-group is hosted for each group with name GROUPNAME that the KDC manages, and contains the symmetric group keying material for that group.<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.2">
A Client can access this resource in order to join the group with name GROUPNAME, or later as a group member to retrieve the current group keying material. These operations are described in <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a> and <a href="#ssec-key-material-retrieval" class="xref">Section 4.3.2.1</a>, respectively.<a href="#section-4.1-3.2.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.3">
If the value of the GROUPNAME URI path and the group name in the access token scope ('gname' in <a href="#ssec-authorization-response" class="xref">Section 3.2</a>) are not required to coincide, the KDC MUST implement a mechanism to map the GROUPNAME value in the URI to the group name, in order to refer to the correct group (REQ7).<a href="#section-4.1-3.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.3">
            <p id="section-4.1-3.3.1">/ace-group/GROUPNAME/pub-key : this resource is invariant once established, and contains the public keys of all the members of the group with name GROUPNAME.<a href="#section-4.1-3.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.2">
This resource is created only in case the KDC acts as repository of public keys for group members.<a href="#section-4.1-3.3.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.3">
A Client can access this resource in order to retrieve the public keys of other group members, in addition to when joining the group. That is, the Client can retrieve the public keys of all the current group members, or a subset of them by specifying filter criteria. These operations are described in <a href="#sec-key-retrieval-all" class="xref">Section 4.4.2.1</a> and <a href="#sec-key-retrieval" class="xref">Section 4.4.1.1</a>, respectively.<a href="#section-4.1-3.3.3" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.4">
Clients may be authorized to access this resource even without being group members, e.g., if authorized to be external signature verifiers for the group.<a href="#section-4.1-3.3.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.4">
            <p id="section-4.1-3.4.1">ace-group/GROUPNAME/kdc-pub-key : this resource is invariant once established, and contains the public key of the KDC for the group with name GROUPNAME.<a href="#section-4.1-3.4.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.4.2">
This resource is created only in case the KDC has an associated public key and this is required for the correct group operation. It is REQUIRED of application
 profiles to define whether the KDC has such an associated public key (REQ8).<a href="#section-4.1-3.4.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.4.3">
A Client can interact with this resource in order to retrieve the current public key of the KDC, in addition to when joining the group.<a href="#section-4.1-3.4.3" class="pilcrow">¶</a></p>
<p id="section-4.1-3.4.4">
Clients may be authorized to access this resource even without being group members, e.g., if authorized to be external signature verifiers for the group.<a href="#section-4.1-3.4.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.5">
            <p id="section-4.1-3.5.1">/ace-group/GROUPNAME/policies : this resource is invariant once established, and contains the group policies of the group with name GROUPNAME.<a href="#section-4.1-3.5.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.5.2">
A Client can access this resource as a group member in order to retrieve the group policies. This operation is described in <a href="#policies" class="xref">Section 4.6.1.1</a>.<a href="#section-4.1-3.5.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.6">
            <p id="section-4.1-3.6.1">/ace-group/GROUPNAME/num : this resource is invariant once established, and contains the current version number for the symmetric group keying material of the group with name GROUPNAME.<a href="#section-4.1-3.6.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.6.2">
A Client can access this resource as a group member in order to retrieve the version number of the keying material currently used in the group. This operation is described in <a href="#key-version" class="xref">Section 4.7.1.1</a>.<a href="#section-4.1-3.6.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.7">
            <p id="section-4.1-3.7.1">/ace-group/GROUPNAME/nodes/NODENAME : one such sub-resource of /ace-group/GROUPNAME is hosted for each group member of the group with name GROUPNAME. Each of such resources is identified by the node name NODENAME of the associated group member, and contains the group keying material and the individual keying material for that group member.<a href="#section-4.1-3.7.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.7.2">
A Client as a group member can access this resource in order to retrieve the current group keying material together with its the individual keying material; request new individual keying material to use in the group; and leave the group. These operations are described in <a href="#update-keys" class="xref">Section 4.8.1.1</a>, <a href="#new-keys" class="xref">Section 4.8.2.1</a>, and <a href="#ssec-group-leaving" class="xref">Section 4.8.3.1</a>, respectively.<a href="#section-4.1-3.7.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.8">
            <p id="section-4.1-3.8.1">/ace-group/GROUPNAME/nodes/NODENAME/pub-key : this resource is invariant once established, and contains the individual public keying material for the node with name NODENAME, as group member of the group with name GROUPNAME.<a href="#section-4.1-3.8.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.8.2">
A Client can access this resource in order to upload at the KDC a new public key to use in the group. This operation is described in <a href="#update-pub-key" class="xref">Section 4.9.1.1</a>.<a href="#section-4.1-3.8.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.8.3">
This resource is not created if the group member does not have individual public keying material to use in the group, or if the KDC does not store the public keys of group members.<a href="#section-4.1-3.8.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-4">The KDC is expected to fully provide the interface defined above. It is otherwise REQUIRED of the application profiles of this specification to indicate which resources are not hosted, i.e., which parts of the interface defined in this section are not supported by the KDC (REQ9). Application profiles of this specification MAY extend the KDC interface, by defining additional resources and their handlers.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">It is REQUIRED of the application profiles of this specification to register a Resource Type for the root url-path (REQ10). This Resource Type can be used to discover the correct url to access at the KDC. This Resource Type can also be used at the GROUPNAME sub-resource, to indicate different application profiles for different groups.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">It is REQUIRED of the application profiles of this specification to define what specific actions (e.g., CoAP methods) are allowed on each resource provided by the KDC interface, depending on whether the Client is a current group member; the roles that a Client is authorized to take as per the obtained access token (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>); and the roles that the Client has as current group member (REQ11).<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div id="client-operations">
<section id="section-4.1.1">
          <h4 id="name-operations-supported-by-cli">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-operations-supported-by-cli" class="section-name selfRef">Operations Supported by Clients</a>
          </h4>
<p id="section-4.1.1-1">It is expected that a Client minimally supports the following set of primary operations and corresponding interactions with the KDC.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-2.1">FETCH request to ace-group/ , in order to retrieve group names associated to group identifiers.<a href="#section-4.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.2">POST and GET requests to ace-group/GROUPNAME/ , in order to join a group (POST) and later retrieve the current group key material as a group member (GET).<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.3">GET and FETCH requests to ace-group/GROUPNAME/pub-key , in order to retrieve the public keys of all the other group members (GET) or only some of them by filtering (FETCH). While retrieving public keys remains possible by using GET requests, retrieval by filtering allows to greatly limit the size of exchanged messages.<a href="#section-4.1.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.4">GET request to ace-group/GROUPNAME/num , in order to retrieve the current version of the group key material as a group member.<a href="#section-4.1.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.5">DELETE request to ace-group/GROUPNAME/nodes/NODENAME , in order to leave the group.<a href="#section-4.1.1-2.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-3">In addition, some Clients may rather not support the following set of secondary operations and corresponding interactions with the KDC. This can be specified, for instance, in compliance documents defining minimalistic Clients and their capabilities in specific deployments. In turn, these might also have to consider the used application profile of this specification.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-4.1">GET request to ace-group/GROUPNAME/kdc-pub-key , in order to retrieve the current public key of the KDC, in addition to when joining the group. This is relevant only if the KDC has an associated public key and this is required
for the correct group operation.<a href="#section-4.1.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.2">GET request to ace-group/GROUPNAME/policies , in order to retrieve the current group policies as a group member, in addition to when joining the group.<a href="#section-4.1.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.3">GET request to ace-group/GROUPNAME/nodes/NODENAME, in order to retrieve the current group keying material and individual keying material. The former can also be retrieved through a GET request to ace-group/GROUPNAME/ (see above). The latter would not be possible to re-obtain as a group member.<a href="#section-4.1.1-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.4">PUT request to ace-group/GROUPNAME/nodes/NODENAME , in order to ask for new individual keying material. The Client would have to alternatively re-join the group through a POST request to ace-group/GROUPNAME/ (see above). Furthermore, depending on its roles in the group or on the application profile of this specification, the Client might simply not be associated to any individual keying material.<a href="#section-4.1.1-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.5">POST request to ace-group/GROUPNAME/nodes/NODENAME/pub-key , in order to provide the KDC with a new public key. The Client would have to alternatively re-join the group through a POST request to ace-group/GROUPNAME/ (see above). Furthermore, depending on its roles in the group, the Client might simply not have an associated public key to provide.<a href="#section-4.1.1-4.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-5">It is REQUIRED of application profiles of this specification to categorize possible newly defined operations for Clients into primary operations and secondary operations, and to provide accompanying considerations (REQ12).<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kdc-if-errors">
<section id="section-4.1.2">
          <h4 id="name-error-handling">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
          </h4>
<p id="section-4.1.2-1">Upon receiving a request from a Client, the KDC MUST check that it is storing a valid access token from that Client. If this is not the case, the KDC MUST reply with a 4.01 (Unauthorized) error response.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">Unless the request targets the /ace-group resource, the KDC MUST check that it is storing a valid access token from that Client such that:<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-3.1">The scope specified in the access token includes a scope entry related to the group name GROUPNAME associated to targeted resource; and<a href="#section-4.1.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.2-3.2">The set of roles specified in that scope entry allows the Client to perform the requested operation on the targeted resource (REQ11).<a href="#section-4.1.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.2-4">In case the KDC stores a valid access token but the verifications above fail, the KDC MUST reply with a 4.03 (Forbidden) error response. This response MAY be an AS Request Creation Hints, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.3" class="relref">Section 5.3</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, in which case the Content-Format MUST be set to application/ace+cbor.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">If the request is not formatted correctly (e.g., required fields are not present or are not encoded as expected), the handler MUST reply with a 4.00 (Bad Request) error response.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">If the request includes unknown or non-expected fields, the handler MUST silently ignore them and continue processing the request. Application profiles of this specification MAY define optional or mandatory payload formats for specific error cases (OPT4).<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2-7">Some error responses from the KDC can have Content-Format set to application/ace-groupcomm+cbor. In such a case, the paylod of the response MUST be a CBOR map, which includes the following fields.<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-8.1">'error', with value a CBOR integer specifying the error occurred at the KDC. The value is taken from the "Value" column of the "ACE Groupcomm Errors" registry defined in <a href="#iana-ace-groupcomm-errors" class="xref">Section 11.13</a> of this specification. This field MUST be present.<a href="#section-4.1.2-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.2-8.2">'error_description', with value a CBOR text string specifying a human-readable diagnostic description of the error occurred at the KDC, written in English. The diagnostic text is intended for software engineers as well as for device and network operators, in order to aid debugging and provide context for possible intervention. The diagnostic message SHOULD be logged by the KDC. This field MAY be present, and it is unlikely relevant in an unattended setup where human intervention is not expected.<a href="#section-4.1.2-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.2-9">The 'error' and 'error_description' fields are defined as OPTIONAL to support for Clients (see <a href="#params" class="xref">Section 8</a>). A Client supporting the 'error' parameter and able to understand the specified error may use that information to determine what actions to take next.<a href="#section-4.1.2-9" class="pilcrow">¶</a></p>
<p id="section-4.1.2-10"><a href="#error-types" class="xref">Section 9</a> of this specification defines an initial set of error identifiers, as possible values for the 'error' field. Application profiles of this specification inherit this initial set or error identifiers and MAY define additional value (OPT5).<a href="#section-4.1.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ace-group">
<section id="section-4.2">
        <h3 id="name-ace-group">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-ace-group" class="section-name selfRef">/ace-group</a>
        </h3>
<p id="section-4.2-1">This resource implements the FETCH handler.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="ace-group-fetch">
<section id="section-4.2.1">
          <h4 id="name-fetch-handler">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-fetch-handler" class="section-name selfRef">FETCH Handler</a>
          </h4>
<p id="section-4.2.1-1">The FETCH handler receives group identifiers and returns the corresponding group names and GROUPNAME URIs.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">The handler expects a request with payload formatted as a CBOR map, which MUST contain the following fields:<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-3.1">'gid', whose value is encoded as a CBOR array, containing one or more group identifiers. The exact encoding of group identifier MUST be specified by the application profile (REQ13). The Client indicates that it wishes to receive the group names and GROUPNAMEs of all groups having these identifiers.<a href="#section-4.2.1-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-4">The handler identifies the groups that are secured by the keying material identified by those group identifiers.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">If all verifications succeed, the handler replies with a 2.05 (Content) response, whose payload is formatted as a CBOR map that MUST contain the following fields:<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-6.1">'gid', whose value is encoded as a CBOR array, containing zero or more group identifiers. The handler indicates that those are the identifiers it is sending group names and GROUPNAMEs for. This CBOR array is a subset of the 'gid' array in the FETCH request.<a href="#section-4.2.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-6.2">'gname', whose value is encoded as a CBOR array, containing zero or more group names. The elements of this array are encoded as text strings. Each element of index i of this CBOR array corresponds to the element of group identifier i in the 'gid' array.<a href="#section-4.2.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-6.3">'guri', whose value is encoded as a CBOR array, containing zero or more URIs, each indicating a GROUPNAME resource.  The elements of this array are encoded as text strings. Each element of index i of this CBOR array corresponds to the element of group identifier i in the 'gid' array.<a href="#section-4.2.1-6.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-7">If the KDC does not find any group associated to the specified group identifiers, the handler returns a response with payload formatted as a CBOR byte string of zero length.<a href="#section-4.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-8">Note that the KDC only verifies that the node is authorized by the AS to access this resource. Nodes that are not members of the group but are authorized to do signature verification on the group messages may be allowed to access this resource, if the application needs it.<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
<div id="retrieval-gnames">
<section id="section-4.2.1.1">
            <h5 id="name-retrieve-group-names">
<a href="#section-4.2.1.1" class="section-number selfRef">4.2.1.1. </a><a href="#name-retrieve-group-names" class="section-name selfRef">Retrieve Group Names</a>
            </h5>
<p id="section-4.2.1.1-1">In case the joining node only knows the group identifier of the group it wishes to join or about which it wishes to get update information from the KDC, the node can contact the KDC to request the corresponding group name and joining resource URI. The node can request several group identifiers at once. It does so by sending a CoAP FETCH request to the /ace-group endpoint at the KDC formatted as defined in <a href="#ace-group-fetch" class="xref">Section 4.2.1</a>.<a href="#section-4.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.1-2"><a href="#fig-ace-group-fetch" class="xref">Figure 6</a> gives an overview of the exchanges described above, and <a href="#fig-ace-group-fetch-2" class="xref">Figure 7</a> shows an example.<a href="#section-4.2.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-group-name-"></span><div id="fig-ace-group-fetch">
<figure id="figure-6">
              <div class="alignCenter art-text artwork" id="section-4.2.1.1-3.1">
<pre>
Client                                                     KDC
   |                                                        |
   |-------- Group Name and URI Retrieval Request: --------&gt;|
   |                   FETCH /ace-group                     |
   |                                                        |
   |&lt;-Group Name and URI Retrieval Response: 2.05 (Content)-|
   |                                                        |
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-message-flow-of-group-name-" class="selfRef">Message Flow of Group Name and URI Retrieval Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-group-name-and-u"></span><div id="fig-ace-group-fetch-2">
<figure id="figure-7">
              <div class="alignLeft art-text artwork" id="section-4.2.1.1-4.1">
<pre>
Request:

Header: FETCH (Code=0.05)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation):
  { "gid": [01, 02] }

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation):
  { "gid": [01, 02], "gname": ["group1", "group2"],
    "guri": ["ace-group/g1", "ace-group/g2"] }
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-of-group-name-and-u" class="selfRef">Example of Group Name and URI Retrieval Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupname">
<section id="section-4.3">
        <h3 id="name-ace-group-groupname">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-ace-group-groupname" class="section-name selfRef">/ace-group/GROUPNAME</a>
        </h3>
<p id="section-4.3-1">This resource implements the POST and GET and handlers.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div id="gid-post">
<section id="section-4.3.1">
          <h4 id="name-post-handler">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-post-handler" class="section-name selfRef">POST Handler</a>
          </h4>
<p id="section-4.3.1-1">The POST handler processes the Joining Request sent by a Client to join a group, and returns a Joining Response as successful result of the joining process (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>). At a high level, the POST handler adds the Client to the list of current group members, adds the public key of the Client to the list of the group members' public keys, and returns the symmetric group keying material for the group identified by GROUPNAME.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">The handler expects a request with payload formatted as a CBOR map, which MAY contain the following fields, which, if included, MUST have format and value as specified below.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-3.1">'scope', with value the specific group that the Client is attempting to join, i.e., the group name, and the roles it wishes to have in the group. This value is a CBOR byte string wrapping one scope entry, as defined in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>.<a href="#section-4.3.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-3.2">
              <p id="section-4.3.1-3.2.1">'get_pub_keys', if the Client wishes to receive the public keys of the current group members from the KDC. This parameter may be included in the Joining Request if the KDC stores the public keys of the group members, while it is not useful to include it if the Client obtains those public keys through alternative means, e.g., from the AS. Note that including this parameter might result in a following Joining Response of large size, which can be inconvenient for resource-constrained devices.<a href="#section-4.3.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.2">
If the Client wishes to retrieve the public keys of all the current group members, the 'get_pub_keys' parameter MUST encode the CBOR simple value 'null' (0xf6). Otherwise, the 'get_pub_keys' parameter MUST encode a non-empty CBOR array, containing the following three elements formatted as defined below.<a href="#section-4.3.1-3.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-3.2.3.1">The first element, namely 'inclusion_flag', encodes the CBOR simple value True. That is, the Client indicates that it wishes to receive the public keys of all group members having their node identifier specified in the third element of the 'get_pub_keys' array, namely 'id_filter' (see below).<a href="#section-4.3.1-3.2.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-3.2.3.2">
                  <p id="section-4.3.1-3.2.3.2.1">The second element, namely 'role_filter', is a non-empty CBOR array. Each element of the array contains one role or a combination of roles for the group identified by GROUPNAME. That is, when the Joining Request includes a non-Null 'get_pub_keys' parameter, the Client filters public keys based on node identifiers.<a href="#section-4.3.1-3.2.3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.3.2.2">
In particular, the Client indicates that it wishes to retrieve the public keys of all the group members having any of the single roles, or at least all of the roles indicated in any combination of roles. For example, the array ["role1", "role2+role3"] indicates that the Client wishes to receive the public keys of all group members that have at least "role1" or at least both "role2" and "role3".<a href="#section-4.3.1-3.2.3.2.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1-3.2.3.3">
                  <p id="section-4.3.1-3.2.3.3.1">The third element, namely 'id_filter', is an empty CBOR array. That is, when the Joining Request includes a non-Null 'get_pub_keys' parameter, the Client does not filter public keys based on node identifiers.<a href="#section-4.3.1-3.2.3.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.3.3.2">
In fact, when first joining the group, the Client is not expected or capable to express a filter based on node identifiers of other group members. Instead, when already a group member and sending a Joining Request to re-join, the Client is not expected to include the 'get_pub_keys' parameter in the Joining Request altogether, since it can rather retrieve public keys associated to specific group identifiers as defined in <a href="#sec-key-retrieval" class="xref">Section 4.4.1.1</a>.<a href="#section-4.3.1-3.2.3.3.2" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.3.1-3.2.4">
The CDDL definition <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> of 'get_pub_keys' is given in <a href="#cddl-ex-getpubkeys" class="xref">Figure 8</a>, using as example encoding: node identifier encoded as a CBOR byte string; role identifier encoded as a CBOR text string, and combination of roles encoded as a CBOR array of roles.<a href="#section-4.3.1-3.2.4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.5">
Note that, for this handler, 'inclusion_flag' is always set to true, the array of roles 'role_filter' is always non-empty, while the array of node identifiers 'id_filter' is always empty. However, this is not necessarily the case for other handlers using the 'get_pub_keys' parameter.<a href="#section-4.3.1-3.2.5" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-cdll-definition-of-get_pub_"></span><div id="cddl-ex-getpubkeys">
<figure id="figure-8">
            <div id="section-4.3.1-4.1">
<pre class="lang-CDDL sourcecode">
inclusion_flag = bool

role = tstr
comb_role = [ 2*role ]
role_filter = [ *(role / comb_role) ]

id = bstr
id_filter = [ *id ]

get_pub_keys = null / [ inclusion_flag, role_filter, id_filter]
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-cdll-definition-of-get_pub_" class="selfRef">CDLL definition of get_pub_keys, using as example node identifier encoded as bstr and role as tstr</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-4.3.1-5.1">'client_cred', encoded as a CBOR byte string, with value the original binary representation of the Client's public key. This parameter is used if the KDC is managing (collecting from/distributing to the Client) the public keys of the group members, and if the Client's role in the group will require for it to send messages to one or more group members. It is REQUIRED of the application profiles to define the specific formats that are acceptable to use for encoding public keys in the group (REQ6).<a href="#section-4.3.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-5.2">'cnonce', encoded as a CBOR byte string, and including a dedicated nonce N_C generated by the Client. This parameter MUST be present if the 'client_cred' parameter is present.<a href="#section-4.3.1-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-5.3">
              <p id="section-4.3.1-5.3.1">'client_cred_verify', encoded as a CBOR byte string. This parameter MUST be present if the 'client_cred' parameter is present and no public key associated to the Client's token can be retrieved for that group.<a href="#section-4.3.1-5.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5.3.2">
This parameter contains a proof-of-possession (PoP) evidence computed by the Client over the following PoP input: the scope (encoded as CBOR byte string), concatenated with N_S (encoded as CBOR byte string) concatenated with N_C (encoded as CBOR byte string), where:<a href="#section-4.3.1-5.3.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-5.3.3.1">scope is the CBOR byte string either specified in the 'scope' parameter above, if present, or as a default scope that the handler is expected to understand, if omitted.<a href="#section-4.3.1-5.3.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-5.3.3.2">N_S is the challenge received from the KDC in the 'kdcchallenge' parameter of the 2.01 (Created) response to the Token Transfer Request (see <a href="#token-post" class="xref">Section 3.3</a>), encoded as a CBOR byte string.<a href="#section-4.3.1-5.3.3.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-5.3.3.3">N_C is the nonce generated by the Client and specified in the 'cnonce' parameter above, encoded as a CBOR byte string.<a href="#section-4.3.1-5.3.3.3" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-4.3.1-5.3.4">
An example of PoP input to compute 'client_cred_verify' using CBOR encoding is given in <a href="#fig-client-cred-input" class="xref">Figure 9</a>.<a href="#section-4.3.1-5.3.4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5.3.5">
A possible type of PoP evidence is a signature, that the Client computes by using its own private key, whose corresponding public key is specified in the 'client_cred' parameter. Application profiles of this specification MUST specify the exact approaches used to compute the PoP evidence to include in 'client_cred_verify', and MUST specify which of those approaches is used in which case (REQ14).<a href="#section-4.3.1-5.3.5" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5.3.6">
If the token was not provided to the KDC through a Token Transfer Request (e.g., it is used directly to validate TLS instead), it is REQUIRED of the specific application profile to define how the challenge N_S is generated (REQ15).<a href="#section-4.3.1-5.3.6" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-5.4">'pub_keys_repos', which can be present if the format of the Client's public key in the 'client_cred' parameter is a certificate. In such a case, this parameter has as value the URI of the certificate. This parameter is encoded as a CBOR text string. Alternative specific encodings of this parameter MAY be defined in applications of this specification (OPT6).<a href="#section-4.3.1-5.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-5.5">
              <p id="section-4.3.1-5.5.1">'control_uri', with value a full URI, encoded as a CBOR text string. A default url-path is /ace-group/GROUPNAME/node, although implementations can use different ones instead. The URI MUST NOT have url-path ace-group/GROUPNAME.<a href="#section-4.3.1-5.5.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5.5.2">
If 'control_uri' is specified in the Joining Request, the Client acts as a CoAP server and hosts a resource at this specific URI. The KDC MAY use this URI to send CoAP requests to the Client (acting as CoAP server in this exchange), for example for one-to-one provisioning of new group keying material when performing a group rekeying (see <a href="#update-keys" class="xref">Section 4.8.1.1</a>), or to inform the Client of its removal from the group <a href="#sec-node-removal" class="xref">Section 5</a>.<a href="#section-4.3.1-5.5.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5.5.3">
In particular, this resource is intended for communications concerning exclusively the group whose group name GROUPNAME is specified in the 'scope' parameter. If the KDC does not implement mechanisms using this resource for that group, it can ignore this parameter. Other additional functionalities of this resource MAY be defined in application profiles of this specifications (OPT7).<a href="#section-4.3.1-5.5.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-example-of-pop-input-to-com"></span><div id="fig-client-cred-input">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-4.3.1-6.1">
<pre>
scope, N_S, and N_C expressed in CBOR diagnostic notation:
  scope = h'826667726F7570316673656E646572'
  N_S   = h'018a278f7faab55a'
  N_C   = h'25a8991cd700ac01'


scope, N_S, and N_C as CBOR encoded byte strings:
  scope = 0x4f826667726F7570316673656E646572
  N_S   = 0x48018a278f7faab55a
  N_C   = 0x4825a8991cd700ac01

PoP input:
  0x4f 826667726F7570316673656E646572
    48 018a278f7faab55a 48 25a8991cd700ac01
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-example-of-pop-input-to-com" class="selfRef">Example of PoP input to compute 'client_cred_verify' using CBOR encoding</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-7">If the request does not include a 'scope' field, the KDC is expected to understand with what roles the Client is requesting to join the group. For example, as per the access token, the Client might have been granted access to the group with only one role. If the KDC cannot determine which exact scope should be considered for the Client, it MUST reply with a 4.00 (Bad Request) error response.<a href="#section-4.3.1-7" class="pilcrow">¶</a></p>
<p id="section-4.3.1-8">The handler considers the scope specified in the access token associated to the Client, and checks the scope entry related to the group with name GROUPNAME associated to the endpoint. In particular, the handler checks whether the set of roles specified in that scope entry includes all the roles that the Client wishes to have in the group as per the Joining Request. If this is not the case, the KDC MUST reply with a 4.03 (Forbidden) error response.<a href="#section-4.3.1-8" class="pilcrow">¶</a></p>
<p id="section-4.3.1-9">If the KDC manages the group members' public keys, the handler checks if one is included in the 'client_cred' field. If so, the KDC retrieves the public key and performs the following actions.<a href="#section-4.3.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-10.1">If the access token was provided through a Token Transfer Request (see <a href="#token-post" class="xref">Section 3.3</a>) but the KDC cannot retrieve the 'kdcchallenge' associated to this Client (see <a href="#token-post" class="xref">Section 3.3</a>), the KDC MUST reply with a 4.00 Bad Request error response, which MUST also have Content-Format application/ace-groupcomm+cbor. The payload of the error response is a CBOR map including a newly generated 'kdcchallenge' value. This is specified in the 'kdcchallenge' parameter.<a href="#section-4.3.1-10.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-10.2">
              <p id="section-4.3.1-10.2.1">The KDC checks the public key to be valid for the group identified by GROUPNAME. That is, it checks that the public key is encoded according to the format used in the group, is intended for the public key algorithm used in the group, and is aligned with the possible associated parameters used in the group.<a href="#section-4.3.1-10.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-10.2.2">
If this verification fails, the handler MUST reply with a 4.00 (Bad Request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 2 ("Public key incompatible with the group configuration").<a href="#section-4.3.1-10.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-10.3">
              <p id="section-4.3.1-10.3.1">The KDC verifies the PoP evidence contained in the 'client_cred_verify' field. Application profiles of this specification MUST specify the exact approaches used to verify the PoP evidence, and MUST specify which of those approaches is used in which case (REQ14).<a href="#section-4.3.1-10.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-10.3.2">
If the PoP evidence does not pass verification, the handler MUST reply with a 4.00 (Bad Request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 3 ("Invalid Proof-of-Possession evidence").<a href="#section-4.3.1-10.3.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.1-11">If no public key is included in the 'client_cred' field, the handler checks if a public key is already associated to the received access token  and to the group identified by GROUPNAME (see also <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>). Note that the same joining node may use different public keys in different groups, and all those public keys would be associate to the same access token.<a href="#section-4.3.1-11" class="pilcrow">¶</a></p>
<p id="section-4.3.1-12">If an eligible public key for the Client is neither present in the 'client_cred' field nor retrieved from the stored ones at the KDC, it is RECOMMENDED that the handler stops the processing and replies with a 4.00 (Bad Request) error response. Applications profiles MAY define alternatives (OPT8).<a href="#section-4.3.1-12" class="pilcrow">¶</a></p>
<p id="section-4.3.1-13">If, regardless the reason, the KDC replies with a 4.00 (Bad Request) error response, this response MAY have Content-Format set to application/ace-groupcomm+cbor and have a CBOR map as payload. For instance, the CBOR map can include a 'sign_info' parameter formatted as 'sign_info_res' defined in <a href="#sign-info" class="xref">Section 3.3.1</a>, with the 'pub_key_enc' element set to the CBOR simple value 'null' (0xf6) if the Client sent its own public key and the KDC is not set to store public keys of the group members.<a href="#section-4.3.1-13" class="pilcrow">¶</a></p>
<p id="section-4.3.1-14">If all the verifications above succeed, the KDC proceeds as follows.<a href="#section-4.3.1-14" class="pilcrow">¶</a></p>
<p id="section-4.3.1-15">First, only in case the Client is not already a group member, the handler performs the following actions:<a href="#section-4.3.1-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-16.1">The handler adds the Client to the list of current members of the group.<a href="#section-4.3.1-16.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-16.2">The handler assigns a name NODENAME to the Client, and creates a sub-resource to /ace-group/GROUPNAME at the KDC, i.e., "/ace-group/GROUPNAME/nodes/NODENAME".<a href="#section-4.3.1-16.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-16.3">The handler associates the node identifier NODENAME to the access token and the secure session for the Client.<a href="#section-4.3.1-16.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-17">Then, the handler performs the following actions.<a href="#section-4.3.1-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-18.1">
              <p id="section-4.3.1-18.1.1">If the KDC manages the group members' public keys:<a href="#section-4.3.1-18.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-18.1.2.1">The handler associates the retrieved Client's public key to the tuple composed of the node name NODENAME, the group name GROUPNAME and the received access token.<a href="#section-4.3.1-18.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-18.1.2.2">The handler adds the retrieved Client's public key to the stored list of public keys stored for the group identified by GROUPNAME. If such list already includes a public key for the Client, but a different public key is specified in the 'client_cred' field, then the handler MUST replace the old public key in the list with the one specified in the 'client_cred' field.<a href="#section-4.3.1-18.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.3.1-18.2">If the application requires backward security or if the used application profile prescribes so, the KDC MUST generate new group keying material and securely distribute it to the current group members (see <a href="#sec-group-rekeying" class="xref">Section 6</a>).<a href="#section-4.3.1-18.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-18.3">The handler returns a successful Joining Response as defined below, containing the symmetric group keying material; the group policies; and the public keys of the current members of the group, if the KDC manages those and the Client requested them.<a href="#section-4.3.1-18.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-19">The Joining Response MUST have response code 2.01 (Created) if the Client has been added to the list of group members in this joining exchange (see above), or 2.04 (Changed) otherwise, i.e., if the Client is re-joining the group without having left it.<a href="#section-4.3.1-19" class="pilcrow">¶</a></p>
<p id="section-4.3.1-20">The Joining Response message MUST include the Location-Path CoAP option, specifying the URI path to the sub-resource associated to the Client, i.e. "/ace-group/GROUPNAME/nodes/NODENAME".<a href="#section-4.3.1-20" class="pilcrow">¶</a></p>
<p id="section-4.3.1-21">The Joining Response message MUST have Content-Format application/ace-groupcomm+cbor. The payload of the response is formatted as a CBOR map, which MUST contain the following fields and values.<a href="#section-4.3.1-21" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-22.1">'gkty', identifying the key type of the 'key' parameter. The set of values can be found in the "Key Type" column of the "ACE Groupcomm Key Types" registry. Implementations MUST verify that the key type matches the application profile being used, if present, as registered in the "ACE Groupcomm Key Types" registry.<a href="#section-4.3.1-22.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-22.2">'key', containing the keying material for the group communication, or information required to derive it.<a href="#section-4.3.1-22.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-22.3">'num', containing the version number of the keying material for the group communication, formatted as an integer. This is a strictly monotonic increasing field. The application profile MUST define the initial version number (REQ16).<a href="#section-4.3.1-22.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-23">The exact format of the 'key' value MUST be defined in applications of this specification (REQ17), as well as values of 'gkty' accepted by the application (REQ18). Additionally, documents specifying the key format MUST register it in the "ACE Groupcomm Key Types" registry defined in <a href="#iana-key" class="xref">Section 11.8</a>, including its name, type and application profile to be used with.<a href="#section-4.3.1-23" class="pilcrow">¶</a></p>
<span id="name-key-type-values"></span><div id="gkty">
<figure id="figure-10">
            <div class="alignCenter art-text artwork" id="section-4.3.1-24.1">
<pre>
+----------+----------------+---------+-------------------------+
| Name     | Key Type Value | Profile | Description             |
+----------+----------------+---------+-------------------------+
| Reserved | 0              |         | This value is reserved  |
+----------+----------------+---------+-------------------------+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-key-type-values" class="selfRef">Key Type Values</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-25">The response SHOULD contain the following parameter:<a href="#section-4.3.1-25" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-26.1">'exp', with value the expiration time of the keying material for the group communication, encoded as a CBOR unsigned integer. This field contains a numeric value representing the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC date/time, ignoring leap seconds, analogous to what specified for NumericDate in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-2" class="relref">Section 2</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>. Group members MUST stop using the keying material to protect outgoing messages and retrieve new keying material at the time indicated in this field.<a href="#section-4.3.1-26.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-27">Optionally, the response MAY contain the following parameters, which, if included, MUST have format and value as specified below.<a href="#section-4.3.1-27" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-28.1">'ace-groupcomm-profile', with value a CBOR integer that MUST be used to uniquely identify the application profile for group communication. Applications of this specification MUST register an application profile identifier and the related value for this parameter in the "ACE Groupcomm Profiles" registry (REQ19).<a href="#section-4.3.1-28.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-28.2">'pub_keys', MUST be present if 'get_pub_keys' was present in the request, otherwise it MUST NOT be present. This parameter is a CBOR array specifying the public keys of the group members, i.e., of all of them or of the ones selected according to the 'get_pub_keys' parameter in the request. In particular, each element of the array is a CBOR byte string, with value the original binary representation of a group member's public key. It is REQUIRED of the application profiles to define the specific formats of public keys that are acceptable to use in the group (REQ6).<a href="#section-4.3.1-28.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-28.3">'peer_roles', MUST be present if 'pub_keys' is also present, otherwise it MUST NOT be present. This parameter is a CBOR array of n elements, with n the number of public keys included in the 'pub_keys' parameter (at most the number of members in the group). The i-th element of the array specifies the role (or CBOR array of roles) that the group member associated to the i-th public key in 'pub_keys' has in the group. In particular, each array element is encoded as the role element of a scope entry, as defined in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>.<a href="#section-4.3.1-28.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-28.4">'peer_identifiers', MUST be present if 'pub_keys' is also present, otherwise it MUST NOT be present. This parameter is a CBOR array of n elements, with n the number of public keys included in the 'pub_keys' parameter (at most the number of members in the group). The i-th element of the array specifies the node identifier that the group member associated to the i-th public key in 'pub_keys' has in the group. In particular, the i-th array element is encoded as a CBOR byte string, with value the node identifier of the group member.<a href="#section-4.3.1-28.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-28.5">'group_policies', with value a CBOR map, whose entries specify how the group handles specific management aspects. These include, for instance, approaches to achieve synchronization of sequence numbers among group members. The elements of this field are registered in the "ACE Groupcomm Policies" registry. This specification defines the three elements "Sequence Number Synchronization Methods", "Key Update Check Interval" and "Expiration Delta", which are summarized in <a href="#fig-ACE-Groupcomm-Policies" class="xref">Figure 11</a>. Application profiles that build on this document MUST specify the exact content format and default value of included map entries (REQ20).<a href="#section-4.3.1-28.5" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-ace-groupcomm-policies"></span><div id="fig-ACE-Groupcomm-Policies">
<figure id="figure-11">
            <div class="alignCenter art-text artwork" id="section-4.3.1-29.1">
<pre>
+--------------+-------+----------+----------------------+------------+
|     Name     | CBOR  |   CBOR   |     Description      | Reference  |
|              | label |   type   |                      |            |
+--------------+-------+----------+----------------------+------------+
| Sequence     | TBD   | tstr/int | Method for recipient | [[this     |
| Number       |       |          | group members to     | document]] |
| Synchroniza- |       |          | synchronize with     |            |
| tion Method  |       |          | sequence numbers of  |            |
|              |       |          | of sender group      |            |
|              |       |          | members. Its value   |            |
|              |       |          | is taken from the    |            |
|              |       |          | 'Value' column of    |            |
|              |       |          | the Sequence Number  |            |
|              |       |          | Synchronization      |            |
|              |       |          | Method registry      |            |
+--------------+-------+----------+----------------------+------------+
| Key Update   | TBD   | int      | Polling interval in  | [[this     |
| Check        |       |          | seconds, for  group  | document]] |
| Interval     |       |          | members to check at  |            |
|              |       |          | the KDC if the       |            |
|              |       |          | latest group keying  |            |
|              |       |          | material is the one  |            |
|              |       |          | that they own        |            |
+--------------+-------+----------+----------------------+------------+
| Expiration   | TBD   | uint     | Number of seconds    | [[this     |
| Delta        |       |          | from 'exp' until the | document]] |
|              |       |          | specified UTC        |            |
|              |       |          | date/time after      |            |
|              |       |          | which group members  |            |
|              |       |          | MUST stop using the  |            |
|              |       |          | group keying         |            |
|              |       |          | material they own to |            |
|              |       |          | verify incoming      |            |
|              |       |          | messages             |            |
+--------------+-------+----------|----------------------|------------+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-ace-groupcomm-policies" class="selfRef">ACE Groupcomm Policies</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-4.3.1-30.1">
              <p id="section-4.3.1-30.1.1">'kdc_cred', encoded as a CBOR byte string, with value the original binary representation of the KDC's public key. This parameter is used if the KDC has an associated public key and this is required for the correct group operation. It is REQUIRED of application profiles to define whether the KDC has a public key and if this has to be provided through the 'kdc_cred' parameter (REQ8).<a href="#section-4.3.1-30.1.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-30.1.2">
In such a case, the KDC's public key MUST have the same format used for the public keys of the group members. It is REQUIRED of the application profiles to define the specific formats that are acceptable to use for encoding public keys in the group (REQ6).<a href="#section-4.3.1-30.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-30.2">'kdc_nonce', encoded as a CBOR byte string, and including a dedicated nonce N_KDC generated by the KDC. This parameter MUST be present if the 'kdc_cred' parameter is present.<a href="#section-4.3.1-30.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-30.3">
              <p id="section-4.3.1-30.3.1">'kdc_cred_verify' parameter, encoded as a CBOR byte string. This parameter MUST be present if the 'kdc_cred' parameter is present.<a href="#section-4.3.1-30.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-30.3.2">
This parameter contains a proof-of-possession (PoP) evidence computed by the KDC over the nonce N_KDC, which is specified in the 'kdc_nonce' parameter and taken as PoP input.<a href="#section-4.3.1-30.3.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-30.3.3">
A possible type of PoP evidence is a signature, that the KDC computes by using its own private key, whose corresponding public key is specified in the 'kdc_cred' parameter. Application profiles of this specification MUST specify the exact approaches used by the KDC to compute the PoP evidence to include in 'kdc_cred_verify', and MUST specify which of those approaches is used in which case (REQ21).<a href="#section-4.3.1-30.3.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-30.4">'rekeying_scheme', identifying the rekeying scheme that the KDC uses to provide new group keying meterial to the group members. This parameter is encoded as a CBOR integer, whose value is taken from the "Value" column of the "ACE Groupcomm Rekeying Schemes" registry defined in <a href="#iana-ace-groupcomm-rekeying-schemes" class="xref">Section 11.14</a> of this specification.<a href="#section-4.3.1-30.4" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-ace-groupcomm-rekeying-sche"></span><div id="rekeying-scheme-0">
<figure id="figure-12">
            <div class="alignCenter art-text artwork" id="section-4.3.1-31.1">
<pre>
+-------+----------------+-------------------------------+-----------+
| Value |      Name      |          Description          | Reference |
+-------+----------------+-------------------------------+-----------+
|   0   | Point-to-Point | The KDC individually targets  | [this     |
|       |                | each node to rekey, using the | document] |
|       |                | pairwise secure communication |           |
|       |                | association with that node    |           |
+-------+----------------+-------------------------------+-----------+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-ace-groupcomm-rekeying-sche" class="selfRef">ACE Groupcomm Rekeying Schemes</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-32">Application profiles of this specification MAY define a default group rekeying scheme, to refer to in case the 'rekeying_scheme' parameter is not included in the Joining Response (OPT9).<a href="#section-4.3.1-32" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-33.1">
              <p id="section-4.3.1-33.1.1">'mgt_key_material', encoded as a CBOR byte string and containing the specific administrative keying material that the joining node requires in order to participate in the group rekeying process performed by the KDC. This parameter MUST NOT be present if the 'rekeying_scheme' parameter is not present and the application profile does not specify a default group rekeying scheme to use in the group. Some simple rekeying scheme may not require specific administrative keying material to be provided, e.g., the basic "Point-to-Point" group rekeying scheme (see <a href="#point-to-point-rekeying" class="xref">Section 6.1</a>).<a href="#section-4.3.1-33.1.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-33.1.2">
In more advanced group rekeying schemes, the administrative keying material can be composed of multiple keys organized, for instance, into a logical tree hierarchy, whose root key is the only administrative key shared by all the group members. In such a case, each group member is exclusively associated to one leaf key in the hierarchy, and owns only the administrative keys from the associated leaf key all the way up along the path to the root key. That is, different group members can be provided with a different subset of the overall administrative keying material.<a href="#section-4.3.1-33.1.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-33.1.3">
It is expected from separate documents to define how the advanced group rekeying scheme possibly indicated in the 'rekeying_scheme' parameter is used by an application profile of this specification. This includes defining the format of the administrative keying material to specify in 'mgt_key_material', consistently with the group rekeying scheme and the application profile in question.<a href="#section-4.3.1-33.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-33.2">
              <p id="section-4.3.1-33.2.1">'control_group_uri', with value a full URI, encoded as a CBOR text string. The URI MUST specify addressing information intended to reach all the members in the group. For example, this can be a multicast IP address, optionally together with a port number (which defaults to 5683 if omitted). The URI MUST include GROUPNAME in the url-path. A default url-path is /ace-group/GROUPNAME, although implementations can use different ones instead. The URI MUST NOT have url-path ace-group/GROUPNAME/node.<a href="#section-4.3.1-33.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-33.2.2">
If 'control_group_uri' is included in the Joining Response, the Clients supporting this parameter act as CoAP servers, host a resource at this specific URI, and listen to the specified addressing information.<a href="#section-4.3.1-33.2.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-33.2.3">
The KDC MAY use this URI to send one-to-many CoAP requests to the Client group members (acting as CoAP servers in this exchange), for example for one-to-many provisioning of new group keying material when performing a group rekeying (see <a href="#update-keys" class="xref">Section 4.8.1.1</a>), or to inform the Clients of their removal from the group <a href="#sec-node-removal" class="xref">Section 5</a>.<a href="#section-4.3.1-33.2.3" class="pilcrow">¶</a></p>
<p id="section-4.3.1-33.2.4">
In particular, this resource is intended for communications concerning exclusively the group whose group name GROUPNAME is specified in the 'scope' parameter. If the KDC does not implement mechanisms using this resource for that group, it can ignore this parameter. Other additional functionalities of this resource MAY be defined in application profiles of this specifications (OPT10).<a href="#section-4.3.1-33.2.4" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.1-34">If the Joining Response includes the 'kdc_cred_verify' parameter, the Client verifies the conveyed PoP evidence and considers the group joining unsuccessful in case of failed verification. Application profiles of this specification MUST specify the exact approaches used by the Client to verify the PoP evidence in 'kdc_cred_verify', and MUST specify which of those approaches is used in which case (REQ21).<a href="#section-4.3.1-34" class="pilcrow">¶</a></p>
<p id="section-4.3.1-35">Specific application profiles that build on this document MUST specify the communication protocol that members of the group use to communicate with each other (REQ22) and how exactly the keying material is used to protect the group communication (REQ23).<a href="#section-4.3.1-35" class="pilcrow">¶</a></p>
<div id="ssec-key-distribution-exchange">
<section id="section-4.3.1.1">
            <h5 id="name-join-the-group">
<a href="#section-4.3.1.1" class="section-number selfRef">4.3.1.1. </a><a href="#name-join-the-group" class="section-name selfRef">Join the Group</a>
            </h5>
<p id="section-4.3.1.1-1"><a href="#fig-key-distr-join" class="xref">Figure 13</a> gives an overview of the Joining exchange between Client and KDC, when the Client first joins a group, while <a href="#fig-key-distr-join-2" class="xref">Figure 14</a> shows an example.<a href="#section-4.3.1.1-1" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-the-joining"></span><div id="fig-key-distr-join">
<figure id="figure-13">
              <div class="alignCenter art-text artwork" id="section-4.3.1.1-2.1">
<pre>
Client                                                     KDC
   |                                                        |
   |----- Joining Request: POST /ace-group/GROUPNAME ------&gt;|
   |                                                        |
   |&lt;--------- Joining Response: 2.01 (Created) ----------- |
   | Location-Path = "/ace-group/GROUPNAME/nodes/NODENAME"  |
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-message-flow-of-the-joining" class="selfRef">Message Flow of the Joining Exchange</a>
              </figcaption></figure>
</div>
<span id="name-example-of-first-exchange-f"></span><div id="fig-key-distr-join-2">
<figure id="figure-14">
              <div class="alignCenter art-text artwork" id="section-4.3.1.1-3.1">
<pre>
Request:

Header: POST (Code=0.02)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation,
         with PUB_KEY and POP_EVIDENCE being CBOR byte strings):
  { "scope": &lt;&lt; [ "group1", ["sender", "receiver"] ] &gt;&gt; ,
    "get_pub_keys": [true, ["sender"], []], "client_cred": PUB_KEY,
    "cnonce": h'6df49c495409a9b5', "client_cred_verify": POP_EVIDENCE }

Response:

Header: Created (Code=2.01)
Content-Format: "application/ace-groupcomm+cbor"
Location-Path: "kdc.example.com"
Location-Path: "g1"
Location-Path: "nodes"
Location-Path: "c101"
Payload (in CBOR diagnostic notation,
         with KEY being a CBOR byte strings):
  { "gkty": 13, "key": KEY, "num": 12, "exp": 1609459200,
    "pub_keys": [ PUB_KEY1, PUB_KEY2 ],
    "peer_roles": ["sender", ["sender", "receiver"]],
    "peer_identifiers": [ ID1, ID2 ] }
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-example-of-first-exchange-f" class="selfRef">Example of First Exchange for Group Joining</a>
              </figcaption></figure>
</div>
<p id="section-4.3.1.1-4">If not previously established, the Client and the KDC MUST first establish a pairwise secure communication channel (REQ24). This can be achieved, for instance, by using a transport profile of ACE. The Joining exchange MUST occur over that secure channel. The Client and the KDC MAY use that same secure channel to protect further pairwise communications that must be secured.<a href="#section-4.3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-5">The secure communication protocol is REQUIRED to establish the secure channel between Client and KDC by using the proof-of-possession key bound to the access token. As a result, the proof-of-possession to bind the access token to the Client is performed by using the proof-of-possession key bound to the access token for establishing secure communication between the Client and the KDC.<a href="#section-4.3.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-6">To join the group, the Client sends a CoAP POST request to the /ace-group/GROUPNAME endpoint at the KDC, where GROUPNAME is the group name of the group to join, formatted as specified in <a href="#gid-post" class="xref">Section 4.3.1</a>. This group name is the same as in the scope entry corresponding to that group, specified in the 'scope' parameter of the Authorization Request/Response, or it can be retrieved from it. Note that, in case of successful joining, the Client will receive the URI to retrieve individual keying material and to leave the group in the Location-Path option of the response.<a href="#section-4.3.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-7">If the node is joining a group for the first time, and the KDC maintains the public keys of the group members, the Client is REQUIRED to send its own public key and proof-of-possession (PoP) evidence in the Joining Request (see the 'client_cred' and 'client_cred_verify' parameters in <a href="#gid-post" class="xref">Section 4.3.1</a>). The request is accepted only if both public key is provided and the PoP evidence is successfully verified.<a href="#section-4.3.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-8">If a node re-joins a group as authorized by the same access token and using the same public key, it can omit the public key and the PoP evidence, or just the PoP evidence, from the Joining Request. Then, the KDC will be able to retrieve the node's public key associated to the access token for that group. If the public key has been discarded, the KDC replies with 4.00 (Bad Request) error response, as specified in <a href="#gid-post" class="xref">Section 4.3.1</a>. If a node re-joins a group but wants to update its own public key, it needs to include both its public key and the PoP evidence in the Joining Request like when it joined the group for the first time.<a href="#section-4.3.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gid-get">
<section id="section-4.3.2">
          <h4 id="name-get-handler">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-get-handler" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.3.2-1">The GET handler returns the symmetric group keying material for the group identified by GROUPNAME.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">The handler expects a GET request.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">In addition to what is defined in <a href="#kdc-if-errors" class="xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 0 ("Operation permitted only to group members").<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2-4">If all verifications succeed, the handler replies with a 2.05 (Content) response containing the symmetric group keying material. The payload of the response is formatted as a CBOR map which MUST contain the parameters 'gkty', 'key' and 'num' specified in <a href="#gid-post" class="xref">Section 4.3.1</a>.<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2-5">Each of the following parameters specified in <a href="#gid-post" class="xref">Section 4.3.1</a> MUST also be included in the payload of the response, if they are included in the payload of the Joining Responses sent for the group: 'rekeying_scheme', 'mgt_key_material'.<a href="#section-4.3.2-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2-6">The payload MAY also include the parameters 'ace-groupcomm-profile' and 'exp' parameters specified in <a href="#gid-post" class="xref">Section 4.3.1</a>.<a href="#section-4.3.2-6" class="pilcrow">¶</a></p>
<div id="ssec-key-material-retrieval">
<section id="section-4.3.2.1">
            <h5 id="name-retrieve-group-keying-mater">
<a href="#section-4.3.2.1" class="section-number selfRef">4.3.2.1. </a><a href="#name-retrieve-group-keying-mater" class="section-name selfRef">Retrieve Group Keying Material</a>
            </h5>
<p id="section-4.3.2.1-1">A node in the group can contact the KDC to retrieve the current group keying material, by sending a CoAP GET request to the /ace-group/GROUPNAME endpoint at the KDC, where GROUPNAME is the group name.<a href="#section-4.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-2"><a href="#fig-retrieve-key-material" class="xref">Figure 15</a> gives an overview of the Joining exchange between Client and KDC, when the Client first joins a group, while <a href="#fig-retrieve-key-material-2" class="xref">Figure 16</a> shows an example.<a href="#section-4.3.2.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-distrib"></span><div id="fig-retrieve-key-material">
<figure id="figure-15">
              <div class="alignCenter art-text artwork" id="section-4.3.2.1-3.1">
<pre>
Client                                                              KDC
   |                                                                 |
   |----- Key Distribution Request: POST /ace-group/GROUPNAME ------&gt;|
   |                                                                 |
   |&lt;----------- Key Distribution Response: 2.05 (Content) --------- |
   |                                                                 |
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-message-flow-of-key-distrib" class="selfRef">Message Flow of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-key-distribution"></span><div id="fig-retrieve-key-material-2">
<figure id="figure-16">
              <div class="alignLeft art-text artwork" id="section-4.3.2.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Payload: -

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation,
         with KEY being a CBOR byte strings):
  { "gkty": 13, "key": KEY, "num": 12 }
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-example-of-key-distribution" class="selfRef">Example of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamepub-key">
<section id="section-4.4">
        <h3 id="name-ace-group-groupname-pub-key">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-ace-group-groupname-pub-key" class="section-name selfRef">/ace-group/GROUPNAME/pub-key</a>
        </h3>
<p id="section-4.4-1">This resource implements the GET and FETCH handlers.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div id="pubkey-fetch">
<section id="section-4.4.1">
          <h4 id="name-fetch-handler-2">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-fetch-handler-2" class="section-name selfRef">FETCH Handler</a>
          </h4>
<p id="section-4.4.1-1">The FETCH handler receives identifiers of group members for the group identified by GROUPNAME and returns the public keys of such group members.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">The handler expects a request with payload formatted as a CBOR map, that MUST contain the following field.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-3.1">
              <p id="section-4.4.1-3.1.1">'get_pub_keys', whose value is encoded as in <a href="#gid-post" class="xref">Section 4.3.1</a> with the following modifications.<a href="#section-4.4.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-3.1.2.1">
                  <p id="section-4.4.1-3.1.2.1.1">The arrays 'role_filter' and 'id_filter' MUST NOT both be empty, i.e., in CBOR diagnostic notation: [ bool, [ ], [ ] ]. If the 'get_pub_keys' parameter has such a format, the request MUST be considered malformed, and the KDC MUST reply with a 4.00 (Bad Request) error response.<a href="#section-4.4.1-3.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3.1.2.1.2">
Note that a group member can retrieve the public keys of all the current group members by sending a GET request to the same KDC resource instead (see <a href="#sec-key-retrieval-all" class="xref">Section 4.4.2.1</a>).<a href="#section-4.4.1-3.1.2.1.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.4.1-3.1.2.2">The element 'inclusion_flag' encodes the CBOR simple value True if the third element 'id_filter' specifies an empty CBOR array, or if the Client wishes to receive the public keys of the nodes having their node identifier specified in 'id_filter' (i.e, selection by inclusive filtering). Instead, this element encodes the CBOR simple value False if the Client wishes to receive the public keys of the nodes not having the node identifiers specified in the third element 'id_filter' (i.e., selection by exclusive filtering).<a href="#section-4.4.1-3.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.4.1-3.1.2.3">The array 'role_filter' can be empty, if the Client does not wish to filter the requested public keys based on the roles of the group members.<a href="#section-4.4.1-3.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.4.1-3.1.2.4">The array 'id_filter' contains zero or more node identifiers of group members, for the group identified by GROUPNAME. The Client indicates that it wishes to receive the public keys of the nodes having or not having these node identifiers, in case the 'inclusion_flag' element encodes the CBOR simple value True or False, respectively. The array 'id_filter' may be empty, if the Client does not wish to filter the requested public keys based on the node identifiers of the group members.<a href="#section-4.4.1-3.1.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.4.1-4">Note that, in case the 'role_filter' array and the 'id_filter' array are both non-empty:<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-5.1">If the 'inclusion_flag' encodes the CBOR simple value True, the handler returns the public keys of group members whose roles match with 'role_filter' and/or having their node identifier specified in 'id_filter'.<a href="#section-4.4.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-5.2">If the 'inclusion_flag' encodes the CBOR simple value False, the handler returns the public keys of group members whose roles match with 'role_filter' and, at the same time, not having their node identifier specified in 'id_filter'.<a href="#section-4.4.1-5.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-6">The specific format of public keys as well as identifiers, roles and combination of roles of group members MUST be specified by It is REQUIRED of application profiles of this specification (REQ1, REQ6, REQ25).<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.4.1-7">The handler identifies the public keys of the current group members for which either:<a href="#section-4.4.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-8.1">the role identifier matches with one of those indicated in the request; note that the request can contain a "combination of roles", where the handler select all group members who have all roles included in the combination.<a href="#section-4.4.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-8.2">the node identifier matches with one of those indicated in the request.<a href="#section-4.4.1-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-9">If all verifications succeed, the handler returns a 2.05 (Content) message response with payload formatted as a CBOR map, containing only the following parameters from <a href="#gid-post" class="xref">Section 4.3.1</a>.<a href="#section-4.4.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-10.1">'num', which encodes the version number of the current group keying material.<a href="#section-4.4.1-10.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-10.2">'pub_keys', which encodes the list of public keys of the selected group members.<a href="#section-4.4.1-10.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-10.3">'peer_roles', which encodes the role (or CBOR array of roles) that each of the selected group members has in the group.<a href="#section-4.4.1-10.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-10.4">'peer_identifiers', which encodes the node identifier that each of the selected group members has in the group.<a href="#section-4.4.1-10.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-11">The specific format of public keys as well as of node identifiers of group members is specified by the application profile (REQ6, REQ25).<a href="#section-4.4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.4.1-12">If the KDC does not store any public key associated to the specified node identifiers, the handler returns a response with payload formatted as a CBOR byte string of zero length.<a href="#section-4.4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.4.1-13">The handler MAY enforce one of the following policies, in order to handle possible node identifiers that are included in the 'id_filter' element of the 'get_pub_keys' parameter of the request but are not associated to any current group member. Such a policy MUST be specified by the application profile (REQ26).<a href="#section-4.4.1-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-14.1">The KDC silently ignores those node identifiers.<a href="#section-4.4.1-14.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-14.2">
              <p id="section-4.4.1-14.2.1">The KDC retains public keys of group members for a given amount of time after their leaving, before discarding them. As long as such public keys are retained, the KDC provides them to a requesting Client.<a href="#section-4.4.1-14.2.1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-14.2.2">
If the KDC adopts this policy, the application profile MUST also specify the amount of time during which the KDC retains the public key of a former group member after its leaving, possibly on a per-member basis.<a href="#section-4.4.1-14.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.4.1-15">Note that this resource handler only verifies that the node is authorized by the AS to access this resource. Nodes that are not members of the group but are authorized to do signature verifications on the group messages may be allowed to access this resource, if the application needs it.<a href="#section-4.4.1-15" class="pilcrow">¶</a></p>
<div id="sec-key-retrieval">
<section id="section-4.4.1.1">
            <h5 id="name-retrieve-a-subset-of-public">
<a href="#section-4.4.1.1" class="section-number selfRef">4.4.1.1. </a><a href="#name-retrieve-a-subset-of-public" class="section-name selfRef">Retrieve a Subset of Public Keys in the Group</a>
            </h5>
<p id="section-4.4.1.1-1">In case the KDC maintains the public keys of group members, a node in the group can contact the KDC to request the public keys, roles and node identifiers of a specified subset of group members, by sending a CoAP FETCH request to the /ace-group/GROUPNAME/pub-key endpoint at the KDC, where GROUPNAME is the group name, and formatted as defined in <a href="#pubkey-fetch" class="xref">Section 4.4.1</a>.<a href="#section-4.4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1.1-2"><a href="#fig-public-key-1" class="xref">Figure 17</a> gives an overview of the exchange mentioned above, while <a href="#fig-public-key-2" class="xref">Figure 18</a> shows an example of such an exchange.<a href="#section-4.4.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-public-key-"></span><div id="fig-public-key-1">
<figure id="figure-17">
              <div class="alignCenter art-text artwork" id="section-4.4.1.1-3.1">
<pre>
Client                                                      KDC
   |                                                         |
   |-Public Key Request: FETCH /ace-group/GROUPNAME/pub-key-&gt;|
   |                                                         |
   |&lt;--------- Public Key Response: 2.05 (Created) ----------|
   |                                                         |
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-message-flow-of-public-key-" class="selfRef">Message Flow of Public Key Exchange to Request the Public Keys of Specific Group Members</a>
              </figcaption></figure>
</div>
<span id="name-example-of-public-key-excha"></span><div id="fig-public-key-2">
<figure id="figure-18">
              <div class="alignLeft art-text artwork" id="section-4.4.1.1-4.1">
<pre>
Request:

Header: FETCH (Code=0.05)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "pub-key"
Content-Format: "application/ace-groupcomm+cbor"
Payload:
  { "get_pub_keys": [true, [], [ ID3 ]] }

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation):
  { "pub_keys": [ PUB_KEY3 ],
    "peer_roles": [ "receiver" ],
    "peer_identifiers": [ ID3 ] }
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-example-of-public-key-excha" class="selfRef">Example of Public Key Exchange to Request the Public Keys of Specific Group Members</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="pubkey-get">
<section id="section-4.4.2">
          <h4 id="name-get-handler-2">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-get-handler-2" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.4.2-1">The handler expects a GET request.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">If all verifications succeed, the KDC replies with a 2.05 (Content) response as in the FETCH handler in <a href="#pubkey-fetch" class="xref">Section 4.4.1</a>, but specifying in the payload the public keys of all the group members, together with their roles and node identifiers.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
<div id="sec-key-retrieval-all">
<section id="section-4.4.2.1">
            <h5 id="name-retrieve-all-public-keys-in">
<a href="#section-4.4.2.1" class="section-number selfRef">4.4.2.1. </a><a href="#name-retrieve-all-public-keys-in" class="section-name selfRef">Retrieve All Public Keys in the Group</a>
            </h5>
<p id="section-4.4.2.1-1">In case the KDC maintains the public keys of group members, a group or an external signature verifier can contact the KDC to request the public keys, roles and node identifiers of all the current group members, by sending a CoAP GET request to the /ace-group/GROUPNAME/pub-key endpoint at the KDC, where GROUPNAME is the group name.<a href="#section-4.4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1-2"><a href="#fig-public-key-3" class="xref">Figure 19</a> gives an overview of the message exchange, while <a href="#fig-public-key-4" class="xref">Figure 20</a> shows an example of such an exchange.<a href="#section-4.4.2.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-public-key-e"></span><div id="fig-public-key-3">
<figure id="figure-19">
              <div class="alignCenter art-text artwork" id="section-4.4.2.1-3.1">
<pre>
Client                                                     KDC
   |                                                        |
   |--Public Key Request: GET /ace-group/GROUPNAME/pub-key-&gt;|
   |                                                        |
   |&lt;--------- Public Key Response: 2.05 (Content) ---------|
   |                                                        |
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-message-flow-of-public-key-e" class="selfRef">Message Flow of Public Key Exchange to Request the Public Keys of all the Group Members</a>
              </figcaption></figure>
</div>
<span id="name-example-of-public-key-exchan"></span><div id="fig-public-key-4">
<figure id="figure-20">
              <div class="alignLeft art-text artwork" id="section-4.4.2.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "pub-key"
Payload: -

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation):
  { "num": 5,
    "pub_keys": [ PUB_KEY1, PUB_KEY2, PUB_KEY3 ],
    "peer_roles": ["sender", ["sender", "receiver"], "receiver"],
    "peer_identifiers": [ ID1, ID2, ID3 ] }
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-example-of-public-key-exchan" class="selfRef">Example of Public Key Exchange to Request the Public Keys of all the Group Members</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamekdc-pub-key">
<section id="section-4.5">
        <h3 id="name-ace-group-groupname-kdc-pub">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-ace-group-groupname-kdc-pub" class="section-name selfRef">ace-group/GROUPNAME/kdc-pub-key</a>
        </h3>
<p id="section-4.5-1">This resource implements a GET handler.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div id="kdc-pub-key-get">
<section id="section-4.5.1">
          <h4 id="name-get-handler-3">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-get-handler-3" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.5.1-1">The handler expects a GET request.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">If all verifications succeed, the handler returns a 2.05 (Content) message containing the KDC's public key together with a proof-of-possession (PoP) evidence. The response MUST have Content-Format set to application/ace-groupcomm+cbor. The payload of the response is a CBOR map, which includes the following fields.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.1-3.1">The 'kdc_cred' parameter, specifying the KDC's public key. This parameter is encoded like the 'kdc_cred' parameter in the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-4.5.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.5.1-3.2">The 'kdc_nonce' parameter, specifying a nonce generated by the KDC. This parameter is encoded like the 'kdc_nonce' parameter in the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-4.5.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.5.1-3.3">
              <p id="section-4.5.1-3.3.1">The 'kdc_cred_verify' parameter, specifying a PoP evidence computed by the KDC. This parameter is encoded like the 'kdc_cred_verify' parameter in the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-4.5.1-3.3.1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-3.3.2">
The PoP evidence is computed over the nonce specified in the 'kdc_nonce' parameter and taken as PoP input, by means of the same method used when preparing the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>). Application profiles of this specification MUST specify the exact approaches used by the KDC to compute the PoP evidence to include in 'kdc_cred_verify', and MUST specify which of those approaches is used in which case (REQ21).<a href="#section-4.5.1-3.3.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="kdc-pub-key">
<section id="section-4.5.1.1">
            <h5 id="name-retrieve-the-kdcs-public-ke">
<a href="#section-4.5.1.1" class="section-number selfRef">4.5.1.1. </a><a href="#name-retrieve-the-kdcs-public-ke" class="section-name selfRef">Retrieve the KDC's Public Key</a>
            </h5>
<p id="section-4.5.1.1-1">In case the KDC has an associated public key as required for the correct group operation, a group member or an external signature verifier can contact the KDC to request the KDC's public key, by sending a CoAP GET request to the /ace-group/GROUPNAME/kdc-pub-key endpoint at the KDC, where GROUPNAME is the group name.<a href="#section-4.5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-2">Upon receiving the 2.05 (Content) response, the Client retrieves the KDC's public key from the 'kdc_cred' parameter, and MUST verify the proof-of-possession (PoP) evidence specified in the 'kdc_cred_verify' parameter. In case of successful verification of the PoP evidence, the Client MUST store the obtained KDC's public key and replace the currently stored one.<a href="#section-4.5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-3">The PoP evidence is verified by means of the same method used when processing the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>). Application profiles of this specification MUST specify the exact approaches used by the Client to verify the PoP evidence in 'kdc_cred_verify', and MUST specify which of those approaches is used in which case (REQ21).<a href="#section-4.5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-4"><a href="#fig-kdc-pub-key-req-resp" class="xref">Figure 21</a> gives an overview of the exchange described above, while <a href="#fig-kdc-pub-key-req-resp-ex" class="xref">Figure 22</a> shows an example.<a href="#section-4.5.1.1-4" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-kdc-public-"></span><div id="fig-kdc-pub-key-req-resp">
<figure id="figure-21">
              <div class="alignCenter art-text artwork" id="section-4.5.1.1-5.1">
<pre>
Group
Member                                                         KDC
  |                                                             |
  |                    KDC Public Key Request                   |
  |------------------------------------------------------------&gt;|
  |              GET ace-group/GROUPNAME/gm-pub-key             |
  |                                                             |
  |&lt;--------- KDC Public Key Response: 2.05 (Content) ----------|
  |                                                             |
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-message-flow-of-kdc-public-" class="selfRef">Message Flow of KDC Public Key Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-kdc-public-key-r"></span><div id="fig-kdc-pub-key-req-resp-ex">
<figure id="figure-22">
              <div class="alignLeft art-text artwork" id="section-4.5.1.1-6.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "kdc-pub-key"
Payload: -

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation, with PUB_KEY_KDC
         and POP_EVIDENCE being CBOR byte strings):
  {
    "kdc_nonce": h'25a8991cd700ac01',
    "kdc_cred": PUB_KEY_KDC,
    "kdc_cred_verify": POP_EVIDENCE
  }
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-example-of-kdc-public-key-r" class="selfRef">Example of KDC Public Key Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamepolicies">
<section id="section-4.6">
        <h3 id="name-ace-group-groupname-policie">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-ace-group-groupname-policie" class="section-name selfRef">/ace-group/GROUPNAME/policies</a>
        </h3>
<p id="section-4.6-1">This resource implements the GET handler.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div id="policies-get">
<section id="section-4.6.1">
          <h4 id="name-get-handler-4">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-get-handler-4" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.6.1-1">The handler expects a GET request.<a href="#section-4.6.1-1" class="pilcrow">¶</a></p>
<p id="section-4.6.1-2">In addition to what is defined in <a href="#kdc-if-errors" class="xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 0 ("Operation permitted only to group members").<a href="#section-4.6.1-2" class="pilcrow">¶</a></p>
<p id="section-4.6.1-3">If all verifications succeed, the handler replies with a 2.05 (Content) response containing the list of policies for the group identified by GROUPNAME. The payload of the response is formatted as a CBOR map including only the parameter 'group_policies' defined in <a href="#gid-post" class="xref">Section 4.3.1</a> and specifying the current policies in the group. If the KDC does not store any policy, the payload is formatted as a zero-length CBOR byte string.<a href="#section-4.6.1-3" class="pilcrow">¶</a></p>
<p id="section-4.6.1-4">The specific format and meaning of group policies MUST be specified in the application profile (REQ20).<a href="#section-4.6.1-4" class="pilcrow">¶</a></p>
<div id="policies">
<section id="section-4.6.1.1">
            <h5 id="name-retrieve-the-group-policies">
<a href="#section-4.6.1.1" class="section-number selfRef">4.6.1.1. </a><a href="#name-retrieve-the-group-policies" class="section-name selfRef">Retrieve the Group Policies</a>
            </h5>
<p id="section-4.6.1.1-1">A node in the group can contact the KDC to retrieve the current group policies, by sending a CoAP GET request to the /ace-group/GROUPNAME/policies endpoint at the KDC, where GROUPNAME is the group name, and formatted as defined in <a href="#policies-get" class="xref">Section 4.6.1</a><a href="#section-4.6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.6.1.1-2"><a href="#fig-policies" class="xref">Figure 23</a> gives an overview of the exchange described above, while <a href="#fig-policies-2" class="xref">Figure 24</a> shows an example.<a href="#section-4.6.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-policies-re"></span><div id="fig-policies">
<figure id="figure-23">
              <div class="alignCenter art-text artwork" id="section-4.6.1.1-3.1">
<pre>
Client                                                   KDC
   |                                                      |
   |-Policies Request: GET ace-group/GROUPNAME/policies -&gt;|
   |                                                      |
   |&lt;--------- Policies Response: 2.05 (Content) ---------|
   |                                                      |
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-message-flow-of-policies-re" class="selfRef">Message Flow of Policies Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-policies-request"></span><div id="fig-policies-2">
<figure id="figure-24">
              <div class="alignLeft art-text artwork" id="section-4.6.1.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "policies"
Payload: -

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload(in CBOR diagnostic notation):
  { "group_policies": {"exp-delta": 120} }
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-example-of-policies-request" class="selfRef">Example of Policies Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamenum">
<section id="section-4.7">
        <h3 id="name-ace-group-groupname-num">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-ace-group-groupname-num" class="section-name selfRef">/ace-group/GROUPNAME/num</a>
        </h3>
<p id="section-4.7-1">This resource implements the GET handler.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<div id="num-get">
<section id="section-4.7.1">
          <h4 id="name-get-handler-5">
<a href="#section-4.7.1" class="section-number selfRef">4.7.1. </a><a href="#name-get-handler-5" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.7.1-1">The handler expects a GET request.<a href="#section-4.7.1-1" class="pilcrow">¶</a></p>
<p id="section-4.7.1-2">In addition to what is defined in <a href="#kdc-if-errors" class="xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 0 ("Operation permitted only to group members").<a href="#section-4.7.1-2" class="pilcrow">¶</a></p>
<p id="section-4.7.1-3">If all verifications succeed, the handler returns a 2.05 (Content) message containing an integer that represents the version number of the symmetric group keying material. This number is incremented on the KDC every time the KDC updates the symmetric group keying material, before the new keying material is distributed. This number is stored in persistent storage.<a href="#section-4.7.1-3" class="pilcrow">¶</a></p>
<p id="section-4.7.1-4">The payload of the response is formatted as a CBOR integer.<a href="#section-4.7.1-4" class="pilcrow">¶</a></p>
<div id="key-version">
<section id="section-4.7.1.1">
            <h5 id="name-retrieve-the-keying-materia">
<a href="#section-4.7.1.1" class="section-number selfRef">4.7.1.1. </a><a href="#name-retrieve-the-keying-materia" class="section-name selfRef">Retrieve the Keying Material Version</a>
            </h5>
<p id="section-4.7.1.1-1">A node in the group can contact the KDC to request information about the version number of the symmetric group keying material, by sending a CoAP GET request to the /ace-group/GROUPNAME/num endpoint at the KDC, where GROUPNAME is the group name, formatted as defined in <a href="#num-get" class="xref">Section 4.7.1</a>. In particular, the version is incremented by the KDC every time the group keying material is renewed, before it's distributed to the group members.<a href="#section-4.7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.7.1.1-2"><a href="#fig-version" class="xref">Figure 25</a> gives an overview of the exchange described above, while <a href="#fig-version-2" class="xref">Figure 26</a> shows an example.<a href="#section-4.7.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-version-req"></span><div id="fig-version">
<figure id="figure-25">
              <div class="alignCenter art-text artwork" id="section-4.7.1.1-3.1">
<pre>
Client                                                    KDC
   |                                                       |
   |---- Version Request: GET ace-group/GROUPNAME/num ----&gt;|
   |                                                       |
   |&lt;--------- Version Response: 2.05 (Content) -----------|
   |                                                       |
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-message-flow-of-version-req" class="selfRef">Message Flow of Version Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-version-request-"></span><div id="fig-version-2">
<figure id="figure-26">
              <div class="alignLeft art-text artwork" id="section-4.7.1.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "num"
Payload: -

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload(in CBOR diagnostic notation):
  13
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-example-of-version-request-" class="selfRef">Example of Version Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="node-subresource">
<section id="section-4.8">
        <h3 id="name-ace-group-groupname-nodes-n">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-ace-group-groupname-nodes-n" class="section-name selfRef">/ace-group/GROUPNAME/nodes/NODENAME</a>
        </h3>
<p id="section-4.8-1">This resource implements the GET, PUT and DELETE handlers.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">In addition to what is defined in <a href="#kdc-if-errors" class="xref">Section 4.1.2</a>, each of the handlers performs the following two verifications.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-3.1">The handler verifies that the Client is a current member of the group. If the verification fails, the KDC MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 0 ("Operation permitted only to group members").<a href="#section-4.8-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.8-3.2">The handler verifies that the node name of the Client is equal to NODENAME used in the url-path. If the verification fails, the handler replies with a 4.03 (Forbidden) error response.<a href="#section-4.8-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="node-get">
<section id="section-4.8.1">
          <h4 id="name-get-handler-6">
<a href="#section-4.8.1" class="section-number selfRef">4.8.1. </a><a href="#name-get-handler-6" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.8.1-1">The handler expects a GET request.<a href="#section-4.8.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.1-2">If all verifications succeed, the handler replies with a 2.05 (Content) response containing both the group keying material and the individual keying material for the Client, or information enabling the Client to derive it. The payload of the response is formatted as a CBOR map. The format for the group keying material is the same as defined in the response of <a href="#gid-get" class="xref">Section 4.3.2</a>. The specific format of individual keying material for group members, or of the information to derive it, and corresponding CBOR label, MUST be specified in the application profile (REQ27) and registered in <a href="#iana-reg" class="xref">Section 11.7</a>.<a href="#section-4.8.1-2" class="pilcrow">¶</a></p>
<p id="section-4.8.1-3">Optionally, the KDC can make the sub-resource at ace-group/GROUPNAME/nodes/NODENAME also Observable <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span> for the associated node. In case the KDC removes that node from the group without having been explicitly asked for it, this allows the KDC to send an unsolicited 4.04 (Not Found) response to the node as a notification of eviction from the group (see <a href="#sec-node-removal" class="xref">Section 5</a>).<a href="#section-4.8.1-3" class="pilcrow">¶</a></p>
<p id="section-4.8.1-4">Note that the node could have been observing also the resource at ace-group/GROUPNAME, in order to be informed of changes in the keying material. In such a case, this method would result in largely overlapping notifications received for the resource at ace-group/GROUPNAME and the sub-resource at ace-group/GROUPNAME/nodes/NODENAME.<a href="#section-4.8.1-4" class="pilcrow">¶</a></p>
<p id="section-4.8.1-5">In order to mitigate this, a node that supports the No-Response option <span>[<a href="#RFC7967" class="xref">RFC7967</a>]</span> can use it when starting the observation of the sub-resource at ace-group/GROUPNAME/nodes/NODENAME. In particular, the GET observation request can also include the No-Response option, with value set to 2 (Not interested in 2.xx responses).<a href="#section-4.8.1-5" class="pilcrow">¶</a></p>
<div id="update-keys">
<section id="section-4.8.1.1">
            <h5 id="name-retrieve-group-and-individu">
<a href="#section-4.8.1.1" class="section-number selfRef">4.8.1.1. </a><a href="#name-retrieve-group-and-individu" class="section-name selfRef">Retrieve Group and Individual Keying Material</a>
            </h5>
<p id="section-4.8.1.1-1">When any of the following happens, a node MUST stop using the owned group keying material to protect outgoing messages, and SHOULD stop using it to decrypt and verify incoming messages.<a href="#section-4.8.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8.1.1-2.1">Upon expiration of the keying material, according to what indicated by the KDC with the 'exp' parameter in a Joining Response, or to a pre-configured value.<a href="#section-4.8.1.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.8.1.1-2.2">Upon receiving a notification of revoked/renewed keying material from the KDC, possibly as part of an update of the keying material (rekeying) triggered by the KDC.<a href="#section-4.8.1.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.8.1.1-2.3">Upon receiving messages from other group members without being able to retrieve the keying material to correctly decrypt them. This may be due to rekeying messages previously sent by the KDC, that the Client was not able to receive or decrypt.<a href="#section-4.8.1.1-2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.8.1.1-3">In either case, if it wants to continue participating in the group communication, the node has to request the latest keying material from the KDC. To this end, the Client sends a CoAP GET request to the /ace-group/GROUPNAME/nodes/NODENAME endpoint at the KDC, formatted as specified in <a href="#node-get" class="xref">Section 4.8.1</a>.<a href="#section-4.8.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-4">Note that policies can be set up, so that the Client sends a Key Re-Distribution request to the KDC only after a given number of received messages could not be decrypted (because of failed decryption processing or inability to retrieve the necessary keying material).<a href="#section-4.8.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-5">It is application dependent and pertaining to the particular message exchange (e.g., <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>) to set up these policies for instructing Clients to retain incoming messages and for how long (OPT11). This allows Clients to possibly decrypt such messages after getting updated keying material, rather than just consider them non valid messages to discard right away.<a href="#section-4.8.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-6">The same Key Distribution Request could also be sent by the Client without being triggered by a failed decryption of a message, if the Client wants to be sure that it has the latest group keying material. If that is the case, the Client will receive from the KDC the same group keying material it already has in memory.<a href="#section-4.8.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-7"><a href="#fig-key-redistr-req-resp" class="xref">Figure 27</a> gives an overview of the exchange described above, while <a href="#fig-key-redistr-req-resp-2" class="xref">Figure 28</a> shows an example.<a href="#section-4.8.1.1-7" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-distribu"></span><div id="fig-key-redistr-req-resp">
<figure id="figure-27">
              <div class="alignCenter art-text artwork" id="section-4.8.1.1-8.1">
<pre>
Client                                                          KDC
   |                                                             |
   |------------------ Key Distribution Request: ---------------&gt;|
   |           GET ace-group/GROUPNAME/nodes/NODENAME            |
   |                                                             |
   |&lt;-------- Key Distribution Response: 2.05 (Content) ---------|
   |                                                             |
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-message-flow-of-key-distribu" class="selfRef">Message Flow of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-key-distribution-"></span><div id="fig-key-redistr-req-resp-2">
<figure id="figure-28">
              <div class="alignLeft art-text artwork" id="section-4.8.1.1-9.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "nodes"
Uri-Path: "c101"
Payload: -

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation,
         with KEY and IND_KEY being CBOR byte strings,
         and "ind-key" the profile-specified label
         for individual keying material):
  { "gkty": 13, "key": KEY, "num": 12, "ind-key": IND_KEY }
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-example-of-key-distribution-" class="selfRef">Example of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="node-put">
<section id="section-4.8.2">
          <h4 id="name-put-handler">
<a href="#section-4.8.2" class="section-number selfRef">4.8.2. </a><a href="#name-put-handler" class="section-name selfRef">PUT Handler</a>
          </h4>
<p id="section-4.8.2-1">The PUT handler processes requests from a Client that asks for new individual keying material, as required to process messages exchanged in the group.<a href="#section-4.8.2-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2-2">The handler expects a PUT request with empty payload.<a href="#section-4.8.2-2" class="pilcrow">¶</a></p>
<p id="section-4.8.2-3">In addition to what is defined in <a href="#kdc-if-errors" class="xref">Section 4.1.2</a> and at the beginning of <a href="#node-subresource" class="xref">Section 4.8</a>, the handler verifies that this operation is consistent with the set of roles that the Client has in the group (REQ11). If the verification fails, the KDC MUST reply with a 4.00 (Bad Request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 1 ("Request inconsistent with the current roles").<a href="#section-4.8.2-3" class="pilcrow">¶</a></p>
<p id="section-4.8.2-4">If the KDC is currently not able to serve this request, i.e., to generate new individual keying material for the requesting Client, the KDC MUST reply with a 5.03 (Service Unavailable) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 4 ("No available node identifiers").<a href="#section-4.8.2-4" class="pilcrow">¶</a></p>
<p id="section-4.8.2-5">If all verifications succeed, the handler reply with a 2.05 (Content) response containing newly generated, individual keying material for the Client. The payload of the response is formatted as a CBOR map. The specific format of newly-generated individual keying material for group members, or of the information to derive it, and corresponding CBOR label, MUST be specified in the application profile (REQ27) and registered in <a href="#iana-reg" class="xref">Section 11.7</a>.<a href="#section-4.8.2-5" class="pilcrow">¶</a></p>
<p id="section-4.8.2-6">The typical successful outcome consists in replying with newly generated, individual keying material for the Client, as defined above. However, application profiles of this specification MAY also extend this handler in order to achieve different akin outcomes (OPT12), for instance:<a href="#section-4.8.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8.2-7.1">Not providing the Client with newly generated, individual keying material, but rather rekeying the whole group, i.e., providing all the current group members with newly generated group keying material.<a href="#section-4.8.2-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.8.2-7.2">Both providing the Client with newly generated, individual keying material, as well as rekeying the whole group, i.e., providing all the current group members with newly generated group keying material.<a href="#section-4.8.2-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.8.2-8">In either case, the handler may specify the new group keying material as part of the 2.05 (Content) response.<a href="#section-4.8.2-8" class="pilcrow">¶</a></p>
<p id="section-4.8.2-9">Note that this handler is not intended to accommodate requests from a group member to trigger a group rekeying, whose scheduling and execution is an exclusive prerogative of the KDC.<a href="#section-4.8.2-9" class="pilcrow">¶</a></p>
<div id="new-keys">
<section id="section-4.8.2.1">
            <h5 id="name-request-to-change-individua">
<a href="#section-4.8.2.1" class="section-number selfRef">4.8.2.1. </a><a href="#name-request-to-change-individua" class="section-name selfRef">Request to Change Individual Keying Material</a>
            </h5>
<p id="section-4.8.2.1-1">A Client may ask the KDC for new, individual keying material. For instance, this can be due to the expiration of such individual keying material, or to the exhaustion of AEAD nonces, if an AEAD encryption algorithm is used for protecting communications in the group. An example of individual keying material can simply be an individual encryption key associated to the Client. Hence, the Client may ask for a new individual encryption key, or for new input material to derive it.<a href="#section-4.8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2.1-2">To this end, the Client performs a Key Renewal Request/Response exchange with the KDC, i.e., it sends a CoAP PUT request to the /ace-group/GROUPNAME/nodes/NODENAME endpoint at the KDC, where GROUPNAME is the group name and NODENAME is its node name, and formatted as defined in <a href="#node-get" class="xref">Section 4.8.1</a>.<a href="#section-4.8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.8.2.1-3"><a href="#fig-renewal-req-resp" class="xref">Figure 29</a> gives an overview of the exchange described above, while <a href="#fig-renewal-req-resp-2" class="xref">Figure 30</a> shows an example.<a href="#section-4.8.2.1-3" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-renewal"></span><div id="fig-renewal-req-resp">
<figure id="figure-29">
              <div class="alignCenter art-text artwork" id="section-4.8.2.1-4.1">
<pre>
Client                                                    KDC
   |                                                       |
   |------------------ Key Renewal Request: --------------&gt;|
   |           PUT ace-group/GROUPNAME/nodes/NODENAME      |
   |                                                       |
   |&lt;-------- Key Renewal Response: 2.05 (Content) --------|
   |                                                       |
</pre>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-message-flow-of-key-renewal" class="selfRef">Message Flow of Key Renewal Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-key-renewal-requ"></span><div id="fig-renewal-req-resp-2">
<figure id="figure-30">
              <div class="alignLeft art-text artwork" id="section-4.8.2.1-5.1">
<pre>
Request:

Header: PUT (Code=0.03)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "nodes"
Uri-Path: "c101"
Payload: -

Response:

Header: Content (Code=2.05)
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation, with IND_KEY being
         a CBOR byte string, and "ind-key" the profile-specified
         label for individual keying material):
  { "ind-key": IND_KEY }
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-example-of-key-renewal-requ" class="selfRef">Example of Key Renewal Request-Response</a>
              </figcaption></figure>
</div>
<p id="section-4.8.2.1-6">Note the difference between the Key Renewal Request in this section and the Key Distribution Request in <a href="#update-keys" class="xref">Section 4.8.1.1</a>. The former asks the KDC for new individual keying material, while the latters asks the KDC for the current group keying material together with the current individual keying material.<a href="#section-4.8.2.1-6" class="pilcrow">¶</a></p>
<p id="section-4.8.2.1-7">As discussed in <a href="#node-put" class="xref">Section 4.8.2</a>, application profiles of this specification may define alternative outcomes for the Key Renewal Request-Response exchange (OPT12), where the provisioning of new individual keying material is replaced by or combined with the execution of a whole group rekeying.<a href="#section-4.8.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="node-delete">
<section id="section-4.8.3">
          <h4 id="name-delete-handler">
<a href="#section-4.8.3" class="section-number selfRef">4.8.3. </a><a href="#name-delete-handler" class="section-name selfRef">DELETE Handler</a>
          </h4>
<p id="section-4.8.3-1">The DELETE handler removes the node identified by NODENAME from the group identified by GROUPNAME.<a href="#section-4.8.3-1" class="pilcrow">¶</a></p>
<p id="section-4.8.3-2">The handler expects a DELETE request with empty payload.<a href="#section-4.8.3-2" class="pilcrow">¶</a></p>
<p id="section-4.8.3-3">In addition to what is defined in <a href="#kdc-if-errors" class="xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC MUST reply with a 4.03 (Forbidden) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 0 ("Operation permitted only to group members").<a href="#section-4.8.3-3" class="pilcrow">¶</a></p>
<p id="section-4.8.3-4">If all verification succeeds, the handler performs the actions defined in <a href="#sec-node-removal" class="xref">Section 5</a> and replies with a 2.02 (Deleted) response with empty payload.<a href="#section-4.8.3-4" class="pilcrow">¶</a></p>
<div id="ssec-group-leaving">
<section id="section-4.8.3.1">
            <h5 id="name-leave-the-group">
<a href="#section-4.8.3.1" class="section-number selfRef">4.8.3.1. </a><a href="#name-leave-the-group" class="section-name selfRef">Leave the Group</a>
            </h5>
<p id="section-4.8.3.1-1">A Client can actively request to leave the group. In this case, the Client sends a CoAP DELETE request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the KDC, where GROUPNAME is the group name and NODENAME is its node name, formatted as defined in <a href="#node-delete" class="xref">Section 4.8.3</a><a href="#section-4.8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.3.1-2">Note that, after having left the group, the Client may wish to join it again. Then, as long as the Client is still authorized to join the group, i.e., the associated access token is still valid, the Client can request to re-join the group directly to the KDC (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>), without having to retrieve a new access token from the AS.<a href="#section-4.8.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamenodesnodenamepub-key">
<section id="section-4.9">
        <h3 id="name-ace-group-groupname-nodes-no">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-ace-group-groupname-nodes-no" class="section-name selfRef">/ace-group/GROUPNAME/nodes/NODENAME/pub-key</a>
        </h3>
<p id="section-4.9-1">This resource implements the POST handler.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<div id="node-pub-key-post">
<section id="section-4.9.1">
          <h4 id="name-post-handler-2">
<a href="#section-4.9.1" class="section-number selfRef">4.9.1. </a><a href="#name-post-handler-2" class="section-name selfRef">POST Handler</a>
          </h4>
<p id="section-4.9.1-1">The POST handler is used to replace the stored public key of this Client (identified by NODENAME) with the one specified in the request at the KDC, for the group identified by GROUPNAME.<a href="#section-4.9.1-1" class="pilcrow">¶</a></p>
<p id="section-4.9.1-2">The handler expects a POST request with payload as specified in <a href="#gid-post" class="xref">Section 4.3.1</a>, with the difference that it includes only the parameters 'client_cred', 'cnonce' and 'client_cred_verify'. In particular, the PoP evidence included in 'client_cred_verify' is computed in the same way considered in <a href="#gid-post" class="xref">Section 4.3.1</a> and defined by the specific application profile (REQ14), with a newly generated N_C nonce and the previously received N_S. It is REQUIRED of the application profiles to define the specific formats of public keys that are acceptable to use in the group (REQ6).<a href="#section-4.9.1-2" class="pilcrow">¶</a></p>
<p id="section-4.9.1-3">In addition to what is defined in <a href="#kdc-if-errors" class="xref">Section 4.1.2</a> and at the beginning of <a href="#node-subresource" class="xref">Section 4.8</a>, the handler verifies that this operation is consistent with the set of roles that the node has in the group. If the verification fails, the KDC MUST reply with a 4.00 (Bad Request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 1 ("Request inconsistent with the current roles").<a href="#section-4.9.1-3" class="pilcrow">¶</a></p>
<p id="section-4.9.1-4">If the KDC cannot retrieve the 'kdcchallenge' associated to this Client (see <a href="#token-post" class="xref">Section 3.3</a>), the KDC MUST reply with a 4.00 (Bad Request) error response, which MUST also have Content-Format application/ace-groupcomm+cbor. The payload of the error response is a CBOR map including a newly generated 'kdcchallenge' value. This is specified in the 'kdcchallenge' parameter. In such a case the KDC MUST store the newly generated value as the 'kdcchallenge' value associated to this Client, possibly replacing the currently stored value.<a href="#section-4.9.1-4" class="pilcrow">¶</a></p>
<p id="section-4.9.1-5">Otherwise, the handler checks that the public key specified in the 'client_cred' field is valid for the group identified by GROUPNAME. That is, the handler checks that the public key is encoded according to the format used in the group, is intended for the public key algorithm used in the group, and is aligned with the possible associated parameters used in the group. If that cannot be successfully verified, the handler MUST reply with a 4.00 (Bad Request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 2 ("Public key incompatible with the group configuration").<a href="#section-4.9.1-5" class="pilcrow">¶</a></p>
<p id="section-4.9.1-6">Otherwise, the handler verifies the PoP evidence contained in the 'client_cred_verify' field of the request, by using the public key specified in the 'client_cred' field, as well as the same way considered in <a href="#gid-post" class="xref">Section 4.3.1</a> and defined by the specific application profile (REQ14). If the PoP evidence does not pass verification, the handler MUST reply with a 4.00 (Bad Request) error response. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 3 ("Invalid Proof-of-Possession evidence").<a href="#section-4.9.1-6" class="pilcrow">¶</a></p>
<p id="section-4.9.1-7">If all verifications succeed, the handler performs the following actions.<a href="#section-4.9.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.9.1-8.1">The handler associates the public key from the 'client_cred' field of the request to the node identifier NODENAME and to the access token associated to the node identified by NODENAME.<a href="#section-4.9.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.9.1-8.2">In the stored list of group members' public keys for the group identified by GROUPNAME, the handler replaces the public key of the node identified by NODENAME with the public key specified in the 'client_cred' field of the request.<a href="#section-4.9.1-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.9.1-9">Then, the handler replies with a 2.04 (Changed) response, which does not include a payload.<a href="#section-4.9.1-9" class="pilcrow">¶</a></p>
<div id="update-pub-key">
<section id="section-4.9.1.1">
            <h5 id="name-uploading-a-new-public-key">
<a href="#section-4.9.1.1" class="section-number selfRef">4.9.1.1. </a><a href="#name-uploading-a-new-public-key" class="section-name selfRef">Uploading a New Public Key</a>
            </h5>
<p id="section-4.9.1.1-1">In case the KDC maintains the public keys of group members, a node in the group can contact the KDC to upload a new public key to use in the group, and replace the currently stored one.<a href="#section-4.9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.9.1.1-2">To this end, the Client performs a Public Key Update Request/Response exchange with the KDC, i.e., it sends a CoAP POST request to the /ace-group/GROUPNAME/nodes/NODENAME/pub-key endpoint at the KDC, where GROUPNAME is the group name and NODENAME is its node name.<a href="#section-4.9.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.9.1.1-3">The request is formatted as specified in <a href="#node-pub-key-post" class="xref">Section 4.9.1</a>.<a href="#section-4.9.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.9.1.1-4">Figure <a href="#fig-pub-key-update-req-resp" class="xref">Figure 31</a> gives an overview of the exchange described above, while <a href="#fig-pub-key-update-req-resp-2" class="xref">Figure 32</a> shows an example.<a href="#section-4.9.1.1-4" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-public-key-u"></span><div id="fig-pub-key-update-req-resp">
<figure id="figure-31">
              <div class="alignCenter art-text artwork" id="section-4.9.1.1-5.1">
<pre>
Client                                                           KDC
|                                                                 |
|-------------- Public Key Update Request: ----------------------&gt;|
|      POST ace-group/GROUPNAME/nodes/NODENAME/pub-key            |
|                                                                 |
|&lt;------- Public Key Update Response: 2.04 (Changed) -------------|
|                                                                 |
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-message-flow-of-public-key-u" class="selfRef">Message Flow of Public Key Update Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-public-key-updat"></span><div id="fig-pub-key-update-req-resp-2">
<figure id="figure-32">
              <div class="alignLeft art-text artwork" id="section-4.9.1.1-6.1">
<pre>
Request:

Header: POST (Code=0.02)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "nodes"
Uri-Path: "c101"
Uri-Path: "pub-key"
Content-Format: "application/ace-groupcomm+cbor"
Payload (in CBOR diagnostic notation, with PUB_KEY
         and POP_EVIDENCE being CBOR byte strings):
  { "client_cred": PUB_KEY, "cnonce": h'9ff7684414affcc8',
    "client_cred_verify": POP_EVIDENCE }

Response:

Header: Changed (Code=2.04)
Payload: -
</pre>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-example-of-public-key-updat" class="selfRef">Example of Public Key Update Request-Response</a>
              </figcaption></figure>
</div>
<p id="section-4.9.1.1-7">Additionally, after updating its own public key, a group member MAY send a number of requests including an identifier of the updated public key, to notify other group members that they have to retrieve it. How this is done depends on the group communication protocol used, and therefore is application profile specific (OPT13).<a href="#section-4.9.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-node-removal">
<section id="section-5">
      <h2 id="name-removal-of-a-group-member">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-removal-of-a-group-member" class="section-name selfRef">Removal of a Group Member</a>
      </h2>
<p id="section-5-1">A Client identified by NODENAME may be removed from a group identified by GROUPNAME where it is a member, due to the following reasons.<a href="#section-5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-2">
<li id="section-5-2.1">The Client explicitly asks to leave the group, as defined in <a href="#ssec-group-leaving" class="xref">Section 4.8.3.1</a>.<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.2">The node has been found compromised or is suspected so.<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.3">The Client's authorization to be a group member with the current roles is not valid anymore, i.e., the access token has expired or has been revoked. If the AS provides token introspection (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.9" class="relref">Section 5.9</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>), the KDC can optionally use it and check whether the Client is still authorized.<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-3">In either case, the KDC performs the following actions.<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">The KDC removes the Client from the list of current members or the group.<a href="#section-5-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.2">In case of forced eviction, i.e., for cases 2 and 3 above, the KDC deletes the public key of the removed Client, if it acts as repository of public keys for group members.<a href="#section-5-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.3">If the removed Client is registered as an observer of the group-membership resource at ace-group/GROUPNAME, the KDC removes the Client from the list of observers of that resource.<a href="#section-5-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.4">
          <p id="section-5-4.4.1">If the sub-resource nodes/NODENAME was created for the removed Client, the KDC deletes that sub-resource.<a href="#section-5-4.4.1" class="pilcrow">¶</a></p>
<p id="section-5-4.4.2">
In case of forced eviction, i.e., for cases 2 and 3 above, the KDC MAY explicitly inform the removed Client, by means of the following methods.<a href="#section-5-4.4.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.4.3.1">If the evicted Client implements the 'control_uri' resource specified in <a href="#gid-post" class="xref">Section 4.3.1</a>, the KDC sends a DELETE request, targeting the URI specified in the 'control_uri' parameter of the Joining Request (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-5-4.4.3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5-4.4.3.2">
              <p id="section-5-4.4.3.2.1">If the evicted Client is observing its associated sub-resource at ace-group/GROUPNAME/nodes/NODENAME (see <a href="#node-get" class="xref">Section 4.8.1</a>), the KDC sends an unsolicited 4.04 (Not Found) error response, which does not include the Observe option and indicates that the observed resource has been deleted (see <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>).<a href="#section-5-4.4.3.2.1" class="pilcrow">¶</a></p>
<p id="section-5-4.4.3.2.2">
The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 5 ("Group membership terminated").<a href="#section-5-4.4.3.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-5-4.5">If the application requires forward security or the used application profile requires so, the KDC MUST generate new group keying material and securely distribute it to all the current group members except the leaving node (see <a href="#sec-group-rekeying" class="xref">Section 6</a>).<a href="#section-5-4.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec-group-rekeying">
<section id="section-6">
      <h2 id="name-group-rekeying-process">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-group-rekeying-process" class="section-name selfRef">Group Rekeying Process</a>
      </h2>
<p id="section-6-1">A group rekeying is started and driven by the KDC. The KDC is not intended to accommodate explicit requests from group members to trigger a group rekeying. That is, the scheduling and execution of a group rekeying is an exclusive prerogative of the KDC. Reasons that can trigger a group rekeying are a change in the group membership, the current group keying material approaching its expiration time, or a regularly scheduled update of the group keying material.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The KDC MUST increment the version number NUM of the current keying material, before distributing the newly generated keying material with version number NUM+1 to the group. Once completed the group rekeying, the KDC MUST delete the old keying material and SHOULD store the newly distributed keying material in persistent storage.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Distributing the new group keying material requires the KDC to send multiple rekeying messages to the group members. Depending on the rekeying scheme used in the group and the reason that has triggered the rekeying process, each rekeying message can be intended to one or multiple group members, hereafter referred to as target group members. The KDC MUST support at least the "Point-to-Point" group rekeying scheme in <a href="#point-to-point-rekeying" class="xref">Section 6.1</a> and MAY support additional ones.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Each rekeying message MUST have Content-Format set to application/ace-groupcomm+cbor and its payload formatted as a CBOR map, which MUST include at least the information specified in the Key Distribution Response message (see <a href="#gid-get" class="xref">Section 4.3.2</a>), i.e., the parameters 'gkty', 'key' and 'num' defined in <a href="#gid-post" class="xref">Section 4.3.1</a>. The CBOR map MAY include the parameter 'exp', as well as the parameter 'mgt_key_material' specifying new administrative keying material for the target group members, if relevant for the used rekeying scheme.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">A rekeying message may include additional information, depending on the rekeying scheme used in the group, the reason that has triggered the rekeying process and the specific target group members. In particular, if the group rekeying is performed due to one or multiple Clients that have joined the group and the KDC acts as repository of public keys of the group members, then a rekeying message MAY also include the public keys that those Clients use in the group, together with the roles and node identifier that the corresponding Client has in the group. It is RECOMMENDED to specify this information by means of the parameters 'pub_keys', 'peer_roles' and 'peer_identifiers', like done in the Joining Response message (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">The complete format of a rekeying message, including the encoding and content of the 'mgt_key_material' parameter, has to be defined in separate specifications aimed at profiling the used rekeying scheme in the context of the used application profile of this specification. As a particular case, an application profile of this specification MAY define additional information to include in rekeying messages for the "Point-to-Point" group rekeying scheme in <a href="#point-to-point-rekeying" class="xref">Section 6.1</a> (OPT14).<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">Consistently with the used group rekeying scheme, the actual delivery of rekeying messages can occur through different approaches, as discussed in the following.<a href="#section-6-7" class="pilcrow">¶</a></p>
<div id="point-to-point-rekeying">
<section id="section-6.1">
        <h3 id="name-point-to-point-group-rekeyi">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-point-to-point-group-rekeyi" class="section-name selfRef">Point-to-Point Group Rekeying</a>
        </h3>
<p id="section-6.1-1">This approach consists in the KDC sending one individual rekeying message to each target group member. In particular, the rekeying message is protected by means of the security association between the KDC and the target group member in question, as per the used application profile of this specification and the used transport profile of ACE.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">This is the approach taken by the basic "Point-to-Point" group rekeying scheme, that the KDC can explicitly signal in the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>), through the 'rekeying_scheme' parameter specifying the value 0.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">When taking this approach in the group identified by GROUPNAME, the KDC can practically deliver the rekeying messages to the target group members in different, co-existing ways.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">The KDC SHOULD make the ace-group/GROUPNAME resource Observable <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>. Thus, upon performing a group rekeying, the KDC can distribute the new group keying material through individual notification responses sent to the target group members that are also observing that resource.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1-4.1.2">
In case the KDC deletes the group, this also allows the KDC to send an unsolicited 4.04 (Not Found) response to each observer group member, as a notification of group termination. The response MUST have Content-Format set to application/ace-groupcomm+cbor and is formatted as defined in <a href="#key-distr" class="xref">Section 4</a>. The value of the 'error' field MUST be set to 6 ("Group deleted").<a href="#section-6.1-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.2">
            <p id="section-6.1-4.2.1">If a target group member specified a URI in the 'control_uri' parameter of the Joining Request upon joining the group (see <a href="#gid-post" class="xref">Section 4.3.1</a>), the KDC can provide that group member with the new group keying material by sending a unicast POST request to that URI.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1-4.2.2">
A Client that does not plan to observe the ace-group/GROUPNAME resource at the KDC SHOULD provide a URI in the 'control_uri' parameter of the Joining Request upon joining the group.<a href="#section-6.1-4.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-5">If the KDC has to send a rekeying message to a target group member, but this did not include the 'control_uri' parameter in the Joining Request and is not a registered observer for the ace-group/GROUPNAME resource, then that target group member would not be able to participate to the group rekeying. Later on, after having repeatedly failed to successfully exchange secure messages in the group, that group member can retrieve the current group keying material from the KDC, by sending a GET request to ace-group/GROUPNAME or ace-group/GROUPNAME/nodes/NODENAME (see <a href="#gid-get" class="xref">Section 4.3.2</a> and <a href="#node-get" class="xref">Section 4.8.1</a>, respectively).<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="one-to-many-rekeying">
<section id="section-6.2">
        <h3 id="name-one-to-many-group-rekeying">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-one-to-many-group-rekeying" class="section-name selfRef">One-to-Many Group Rekeying</a>
        </h3>
<p id="section-6.2-1">This section provides high-level recommendations on how the KDC can rekey a group by means of a more efficient and scalable group rekeying scheme, e.g., <span>[<a href="#RFC2093" class="xref">RFC2093</a>]</span><span>[<a href="#RFC2094" class="xref">RFC2094</a>]</span><span>[<a href="#RFC2627" class="xref">RFC2627</a>]</span>. That is, each rekeying message might be, and likely is, intended to multiple target group members, and thus can be delivered to the whole group, although possible to decrypt only for the actual target group members.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">This yields an overall lower number of rekeying messages, thus potentially reducing the overall time required to rekey the group. On the other hand, it requires the KDC to provide and use additional administrative keying material to protect the rekeying messages, and to additionally sign them to ensure source authentication (see <a href="#one-to-many-rekeying-protection" class="xref">Section 6.2.1</a>). Typically, this pays off in large-scale groups, where the introduced performance overhead is less than what experienced by rekeying the group in a point-to-point fashion (see <a href="#point-to-point-rekeying" class="xref">Section 6.1</a>).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The exact set of rekeying messages to send, their content and format, the administrative keying material to use to protect them, as well as the set of target group members depend on the specific group rekeying scheme, and are typically affected by the reason that has triggered the group rekeying. Details about the data content and format of rekeying messages have to be defined by separate documents profiling the use of the group rekeying scheme, in the context of the used application profile of this specification.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">When one of these group rekeying schemes is used, the KDC provides a number of related information to a Client joining the group in the Joining Response message (see <a href="#gid-post" class="xref">Section 4.3.1</a>). In particular, 'rekeying_scheme' identifies the rekeying scheme used in the group (if no default can be assumed); 'control_group_uri', if present, specifies a URI with a multicast address where the KDC will send the rekeying messages for that group; 'mgt_key_material' specifies a subset of the administrative keying material intended for that particular joining Client to have, as used to protect the rekeying messages sent to the group when intended also to that joining Client.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Rekeying messages can be protected at the application layer, by using COSE and the administrative keying material as prescribed by the specific group rekeying scheme (see <a href="#one-to-many-rekeying-protection" class="xref">Section 6.2.1</a>). After that, the delivery of protected rekeying messages to the intended target group members can occur in different ways, such as the following ones.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-6.1">
            <p id="section-6.2-6.1.1">Over multicast - In this case, the KDC simply sends a rekeying message as a CoAP request addressed to the multicast URI specified in the 'control_group_uri' parameter of the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-6.2-6.1.1" class="pilcrow">¶</a></p>
<p id="section-6.2-6.1.2">
If a particular rekeying message is intended to a single target group member, the KDC may alternatively protect the message using the security association with that group member, and deliver the message like when using the "Point-to-Point" group rekeying scheme (see <a href="#point-to-point-rekeying" class="xref">Section 6.1</a>).<a href="#section-6.2-6.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-6.2">
            <p id="section-6.2-6.2.1">Through a pub-sub communication model - In this case, the KDC acts as publisher and publishes each rekeying message to a specific "rekeying topic", which is associated to the group and is hosted at a broker server. Following their group joining, the group members subscribe to the rekeying topic at the broker, thus receiving the group rekeying messages as they are published by the KDC.<a href="#section-6.2-6.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2-6.2.2">
In order to make such message delivery more efficient, the rekeying topic associated to a group can be further organized into subtopics. For instance, the KDC can use a particular subtopic to address a particular set of target group members during the rekeying process, as possibly aligned to a similar organization of the administrative keying material (e.g., a key hierarchy).<a href="#section-6.2-6.2.2" class="pilcrow">¶</a></p>
<p id="section-6.2-6.2.3">
The setup of rekeying topics at the broker as well as the discovery of the topics at the broker for group members are application specific. A possible way is for the KDC to provide such information in the Joining Response message (see <a href="#gid-post" class="xref">Section 4.3.1</a>), by means of a new parameter analogous to 'control_group_uri' and specifying the URI(s) of the rekeying topic(s) that a group member has to subscribe to at the broker.<a href="#section-6.2-6.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-7">Regardless the specifically used delivery method, the group rekeying scheme can perform a possible roll-over of the administrative keying material through the same sent rekeying messages. Actually, such a roll-over occurs every time a group rekeying is performed upon the leaving of group members, which have to be excluded from future communications in the group.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<p id="section-6.2-8">From a high level point of view, each group member owns only a subset of the overall administrative keying material, obtained upon joining the group. Then, when a group rekeying occurs:<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-9.1">Each rekeying message is protected by using a (most convenient) key from the administrative keying material such that: i) the used key is not owned by any node leaving the group, i.e. the key is safe to use and does not have to be renewed; and ii) the used key is owned by all the target group members, that indeed have to be provided with new group keying material to protect communications in the group.<a href="#section-6.2-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-9.2">Each rekeying message includes not only the new group keying material intended to all the rekeyed group members, but also any new administrative keys that: i) are pertaining to and supposed to be owned by the target group members; and ii) had to be updated since leaving group members own the previous version.<a href="#section-6.2-9.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-10">Further details depend on the specific rekeying scheme used in the group.<a href="#section-6.2-10" class="pilcrow">¶</a></p>
<div id="one-to-many-rekeying-protection">
<section id="section-6.2.1">
          <h4 id="name-protection-of-rekeying-mess">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-protection-of-rekeying-mess" class="section-name selfRef">Protection of Rekeying Messages</a>
          </h4>
<p id="section-6.2.1-1">When using a group rekeying scheme relying on one-to-many rekeying messages, the actual data content of each rekeying message is prepared according to what the rekeying scheme prescribes.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">Then, the KDC can protect the rekeying message as defined below. The used encryption algorithm which SHOULD be the same one used to protect communications in the group. The method defined below assumes that the following holds for the management keying material specified in the 'mgt_key_material' parameter of the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-3.1">The included symmetric encryption keys are accompanied by a corresponding and unique key identifier assigned by the KDC.<a href="#section-6.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-3.2">A Base IV is also included, with the same size of the AEAD nonce considered by the encryption algorithm to use.<a href="#section-6.2.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-4">First, the KDC computes a COSE_Encrypt0 object as follows.<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-5.1">The encryption key to use is selected from the administrative keying material, as defined by the rekeying scheme used in the group.<a href="#section-6.2.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-5.2">The plaintext is the actual data content of the rekeying message.<a href="#section-6.2.1-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-5.3">The Additional Authenticated Data (AAD) is empty, unless otherwise specified by separate documents profiling the use of the group rekeying scheme.<a href="#section-6.2.1-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-5.4">
              <p id="section-6.2.1-5.4.1">Since the KDC is the only sender of rekeying messages, the AEAD nonce can be computed as follows, where NONCE_SIZE is the size in bytes of the AEAD nonce. Separate documents profiling the use of the group rekeying scheme may define alternative ways to compute the AEAD nonce.<a href="#section-6.2.1-5.4.1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-5.4.2">
The KDC considers the following values.<a href="#section-6.2.1-5.4.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-5.4.3.1">COUNT, as a 1-byte unsigned integer associated to the used encryption key. Its value is set to 0 when starting to perform a new group rekeying instance, and is incremented after each use of the encryption key.<a href="#section-6.2.1-5.4.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.2.1-5.4.3.2">NEW_NUM, as the version number of the new group keying material to distribute in this rekeying instance, left-padded with zeroes to exactly NONCE_SIZE - 1.<a href="#section-6.2.1-5.4.3.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-6.2.1-5.4.4">
Then, the KDC computes a Partial IV as the byte string concatenation of COUNT and NEW_NUM, in this order. Finally, the AEAD nonce is computed as the XOR between the Base IV and the Partial IV.<a href="#section-6.2.1-5.4.4" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-5.5">
              <p id="section-6.2.1-5.5.1">The protected header of the COSE_Encrypt0 object MUST include the following parameters.<a href="#section-6.2.1-5.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-5.5.2.1">'alg', specifying the used encryption algorithm.<a href="#section-6.2.1-5.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.2.1-5.5.2.2">'kid', specifying the identifier of the encryption key from the administrative keying material used to protect this rekeying message.<a href="#section-6.2.1-5.5.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-6.2.1-5.6">The unprotected header of the COSE_Encrypt0 object MUST include the 'Partial IV' parameter, with value the Partial IV computed above.<a href="#section-6.2.1-5.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-6">In order to ensure source authentication, each rekeying message protected with the administrative keying material MUST be signed by the KDC. To this end, the KDC computes a countersignature of the COSE_Encrypt0 object, as described in Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-countersign-05#section-3.2" class="relref">3.2</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-countersign-05#section-3.3" class="relref">3.3</a> of <span>[<a href="#I-D.ietf-cose-countersign" class="xref">I-D.ietf-cose-countersign</a>]</span>. In particular, the following applies when computing the countersignature.<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-7.1">The Countersign_structure contains the context text string "CounterSignature0".<a href="#section-6.2.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-7.2">The private key of the KDC is used as signing key.<a href="#section-6.2.1-7.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-7.3">The payload is the ciphertext of the COSE_Encrypt0 object.<a href="#section-6.2.1-7.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-7.4">The Additional Authenticated Data (AAD) is empty, unless otherwise specified by separate documents profiling the use of a group rekeying scheme.<a href="#section-6.2.1-7.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-7.5">The protected header of the signing object MUST include the parameter 'alg', specifying the used signature algorithm.<a href="#section-6.2.1-7.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-8">If source authentication of messages exchanged in the group is also ensured by means of signatures, then rekeying messages MUST be signed using the same signature algorithm and related parameters. Also, the KDC's public key used for signature verification MUST me provided in the Joining Response through the 'kdc_cred' parameter, together with the corresponding proof-of-possession (PoP) evidence in the 'kdc_cred_verify' parameter.<a href="#section-6.2.1-8" class="pilcrow">¶</a></p>
<p id="section-6.2.1-9">If source authentication of messages exchanged in the group is not ensured by means of signatures, then the KDC MUST provide its public key together with a corresponding PoP evidence as part of the management keying material specified in the 'mgt_key_material' parameter of the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>). It is RECOMMENDED to specify this information by using the same format and encoding used for the parameters 'kdc_cred', 'kdc_nonce' and 'kdc_cred_verify' in the Joining Response. It is up to separate documents profiling the use of the group rekeying scheme to specify such details.<a href="#section-6.2.1-9" class="pilcrow">¶</a></p>
<p id="section-6.2.1-10">After that, the KDC specifies the computed countersignature in the 'COSE_Countersignature0' header parameter of the COSE_Encrypt0 object.<a href="#section-6.2.1-10" class="pilcrow">¶</a></p>
<p id="section-6.2.1-11">Finally, the KDC specifies the COSE_Encrypt0 object as payload of a CoAP request, which is sent to the target group members as per the used message delivery method.<a href="#section-6.2.1-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-extended-scope">
<section id="section-7">
      <h2 id="name-extended-scope-format">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-extended-scope-format" class="section-name selfRef">Extended Scope Format</a>
      </h2>
<p id="section-7-1">This section defines an extended format of binary encoded scope, which additionally specifies the semantics used to express the same access control information from the corresponding original scope.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">As also discussed in <a href="#ssec-authorization-response" class="xref">Section 3.2</a>, this enables a Resource Server to unambiguously process a received access token, also in case the Resource Server runs multiple applications or application profiles that involve different scope semantics.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The extended format is intended only for the 'scope' claim of access tokens, for the cases where the claim takes as value a CBOR byte string. That is, the extended format does not apply to the 'scope' parameter included in ACE messages, i.e., the Authorization Request and Authorization Response exchanged between the Client and the Authorization Server (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.8.1" class="relref">5.8.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.8.2" class="relref">5.8.2</a> of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>), the AS Request Creation Hints message from the Resource Server (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.3" class="relref">Section 5.3</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>), and the Introspection Response from the Authorization Server (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-5.9.2" class="relref">Section 5.9.2</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The value of the 'scope' claim following the extended format is composed as follows. Given the original scope using a semantics SEM and encoded as a CBOR byte string, the corresponding extended scope is encoded as a tagged CBOR byte string, wrapping a CBOR sequence <span>[<a href="#RFC8742" class="xref">RFC8742</a>]</span> of two elements. In particular:<a href="#section-7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-5.1">
          <p id="section-7-5.1.1">The first element of the sequence is a CBOR integer, and identifies the semantics SEM used for this scope. The value of this element has to be taken from the "Value" column of the "ACE Scope Semantics" registry defined in <a href="#iana-scope-semantics" class="xref">Section 11.12</a> of this specification.<a href="#section-7-5.1.1" class="pilcrow">¶</a></p>
<p id="section-7-5.1.2">
When defining a new semantics for a binary scope, it is up to the applications and application profiles to define and register the corresponding integer identifier (REQ28).<a href="#section-7-5.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.2">The second element of the sequence is the original scope using the semantics SEM, encoded as a CBOR byte string.<a href="#section-7-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-6">Finally, the CBOR byte string wrapping the CBOR sequence is tagged, and identified by the CBOR tag TBD_TAG "ACE Extended Scope Format", defined in <a href="#iana-cbor-tags" class="xref">Section 11.6</a> of this specification.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">The resulting tagged CBOR byte string is used as value of the 'scope' claim of the access token.<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">The usage of the extended scope format is not limited to application profiles of this specification or to applications based on group communication. Rather, it is generally applicable to any application and application profile where access control information in the access token is expressed as a binary encoded scope.<a href="#section-7-8" class="pilcrow">¶</a></p>
<p id="section-7-9"><a href="#cddl-ex-0-ext" class="xref">Figure 33</a> and <a href="#cddl-ex-ext" class="xref">Figure 34</a> build on the examples in <a href="#ssec-authorization-response" class="xref">Section 3.2</a>, and show the corresponding extended scopes.<a href="#section-7-9" class="pilcrow">¶</a></p>
<span id="name-example-cdll-definition-of-"></span><div id="cddl-ex-0-ext">
<figure id="figure-33">
        <div id="section-7-10.1">
<pre class="lang-CDDL sourcecode">
gname = tstr

permissions = uint . bits roles

roles = &amp;(
   Requester: 1,
   Responder: 2,
   Monitor: 3,
   Verifier: 4
)

scope_entry = AIF_Generic&lt;gname, permissions&gt;

scope = &lt;&lt; [ + scope_entry ] &gt;&gt;

semantics = int

; This defines an array, the elements
; of which are to be used in a CBOR Sequence:
sequence = [semantics, scope]

extended_scope = #6.TBD_TAG(&lt;&lt; sequence &gt;&gt;)
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-example-cdll-definition-of-" class="selfRef">Example CDLL definition of scope, using the default Authorization Information Format</a>
        </figcaption></figure>
</div>
<span id="name-cdll-definition-of-scope-us"></span><div id="cddl-ex-ext">
<figure id="figure-34">
        <div id="section-7-11.1">
<pre class="lang-CDDL sourcecode">
gname = tstr

role = tstr

scope_entry = [ gname , ? ( role / [ 2*role ] ) ]

scope = &lt;&lt; [ + scope_entry ] &gt;&gt;

semantics = int

; This defines an array, the elements
; of which are to be used in a CBOR Sequence:
sequence = [semantics, scope]

extended_scope = #6.TBD_TAG(&lt;&lt; sequence &gt;&gt;)
</pre>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-cdll-definition-of-scope-us" class="selfRef">CDLL definition of scope, using as example group name encoded as tstr and role as tstr</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="params">
<section id="section-8">
      <h2 id="name-ace-groupcomm-parameters">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-ace-groupcomm-parameters" class="section-name selfRef">ACE Groupcomm Parameters</a>
      </h2>
<p id="section-8-1">This specification defines a number of parameters used during the second part of the message exchange, after the exchange of Token Transfer Request and Response. The table below summarizes them, and specifies the CBOR key to use instead of the full descriptive name.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Note that the media type application/ace-groupcomm+cbor MUST be used when these parameters are transported in the respective message fields.<a href="#section-8-2" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-parameters-2"></span><div id="fig-ACE-Groupcomm-Parameters">
<figure id="figure-35">
        <div class="alignCenter art-text artwork" id="section-8-3.1">
<pre>
+-----------------------+------+-----------------+-----------------+
| Name                  | CBOR | CBOR Type       | Reference       |
|                       | Key  |                 |                 |
+-----------------------+------+-----------------+-----------------+
| error                 | TBD  | int             | [this document] |
+-----------------------+------+-----------------+-----------------+
| error_description     | TBD  | tstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| gid                   | TBD  | array           | [this document] |
+-----------------------+------+-----------------+-----------------+
| gname                 | TBD  | array of tstr   | [this document] |
+-----------------------+------+-----------------+-----------------+
| guri                  | TBD  | array of tstr   | [this document] |
+-----------------------+------+-----------------+-----------------+
| scope                 | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| get_pub_keys          | TBD  | array / nil     | [this document] |
+-----------------------+------+-----------------+-----------------+
| client_cred           | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| cnonce                | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| client_cred_verify    | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| pub_keys_repos        | TBD  | tstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| control_uri           | TBD  | tstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| gkty                  | TBD  | int / tstr      | [this document] |
+-----------------------+------+-----------------+-----------------+
| key                   | TBD  | See the "ACE    | [this document] |
|                       |      | Groupcomm Key   |                 |
|                       |      | Types" registry |                 |
+-----------------------+------+-----------------+-----------------+
| num                   | TBD  | int             | [this document] |
+-----------------------+------+-----------------+-----------------+
| ace-groupcomm-profile | TBD  | int             | [this document] |
+-----------------------+------+-----------------+-----------------+
| exp                   | TBD  | int             | [this document] |
+-----------------------+------+-----------------+-----------------+
| pub_keys              | TBD  | array           | [this document] |
+-----------------------+------+-----------------+-----------------+
| peer_roles            | TBD  | array           | [this document] |
+-----------------------+------+-----------------+-----------------+
| peer_identifiers      | TBD  | array           | [this document] |
+-----------------------+------+-----------------+-----------------+
| group_policies        | TBD  | map             | [this document] |
+-----------------------+------+-----------------+-----------------+
| kdc_cred              | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| kdc_nonce             | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| kdc_cred_verify       | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| rekeying_scheme       | TBD  | int             | [this document] |
+-----------------------+------+-----------------+-----------------+
| mgt_key_material      | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| control_group_uri     | TBD  | tstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
| sign_info             | TBD  | array           | [this document] |
+-----------------------+------+-----------------+-----------------+
| kdcchallenge          | TBD  | bstr            | [this document] |
+-----------------------+------+-----------------+-----------------+
</pre>
</div>
<figcaption><a href="#figure-35" class="selfRef">Figure 35</a>:
<a href="#name-ace-groupcomm-parameters-2" class="selfRef">ACE Groupcomm Parameters</a>
        </figcaption></figure>
</div>
<p id="section-8-4">The KDC is expected to support and understand all the parameters above. Instead, a Client can support and understand only a subset of such parameters, depending on the roles it expects to take in the joined groups or on other conditions defined in application profiles of this specification.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">In the following, the parameters are categorized according to the support expected by Clients. That is, a Client that supports a parameter is able to: i) use and specify it in a request message to the KDC; and ii) understand and process it if specified in a response message from the KDC. It is REQUIRED of application profiles of this specification to sort their newly defined parameters according to the same categorization (REQ29).<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">Note that the actual use of a parameter and its inclusion in a message depends on the specific exchange, the specific Client and group involved, as well as what is defined in the used application profile of this specification.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">A Client MUST support the following parameters.<a href="#section-8-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-8.1">'scope', 'gkty', 'key', 'num', 'exp', 'gid', 'gname', 'guri', 'pub_keys', 'peer_identifiers', 'ace_groupcomm_profile', 'control_uri', 'rekeying_scheme'.<a href="#section-8-8.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-9">A Client SHOULD support the following parameter.<a href="#section-8-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-10.1">'get_pub_keys'. That is, not supporting this parameter would yield the inconvenient and undesirable behavior where: i) the Client does not ask for the other group members' public keys upon joining the group (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>); and ii) later on as a group member, the Client only retrieves the public keys of all group members (see <a href="#sec-key-retrieval-all" class="xref">Section 4.4.2.1</a>).<a href="#section-8-10.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-11">A Client MAY support the following optional parameters. Application profiles of this specification MAY define that Clients must or should support these parameters instead (OPT15).<a href="#section-8-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-12.1">'error', 'error_description'.<a href="#section-8-12.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-13">The following conditional parameters are relevant only if specific conditions hold. It is REQUIRED of application profiles of this specification to define whether Clients must, should or may support these parameters, and under which circumstances (REQ30).<a href="#section-8-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-14.1">'client_cred', 'cnonce', 'client_cred_verify'. These parameters are relevant for a Client that has a public key to use in a joined group.<a href="#section-8-14.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-14.2">'kdcchallenge'. This parameter is relevant for a Client that has a public key to use in a joined group and that provides the access token to the KDC through a Token Transfer Request (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#section-8-14.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-14.3">'pub_keys'repo'. This parameter is relevant for a Client that has a public key to use in a joined group and that makes it available from a key repository different than the KDC.<a href="#section-8-14.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-14.4">'group_policies'. This parameter is relevant for a Client that is interested in the specific policies used in a group, but it does not know them or cannot become aware of them before joining that group.<a href="#section-8-14.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-14.5">'peer_roles'. This parameter is relevant for a Client that has to know about the roles of other group members, especially when retrieving and handling their corresponding public keys.<a href="#section-8-14.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-14.6">'kdc_nonce', 'kdc_cred', 'kdc_cred_verify'. These parameters are relevant for a Client that joins a group for which, as per the used application profile of this specification, the KDC has an associated public key and this is required
for the correct group operation.<a href="#section-8-14.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-14.7">'mgt_key_material'. This parameter is relevant for a Client that supports an advanced rekeying scheme possibly used in the group, such as based on one-to-many rekeying messages sent over IP multicast.<a href="#section-8-14.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-14.8">'control_group_uri'. This parameter is relevant for a Client that supports the hosting of local resources each associated to a group (hence acting as CoAP server) and the reception of one-to-many requests sent to those resources by the KDC (e.g., over IP multicast), targeting multiple members of the corresponding group. Examples of related management operations that the KDC can perform by this means are the eviction of group members and the execution of a group rekeying process through an advanced rekeying scheme, such as based on one-to-many rekeying messages.<a href="#section-8-14.8" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="error-types">
<section id="section-9">
      <h2 id="name-ace-groupcomm-error-identif">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-ace-groupcomm-error-identif" class="section-name selfRef">ACE Groupcomm Error Identifiers</a>
      </h2>
<p id="section-9-1">This specification defines a number of values that the KDC can include as error identifiers, in the 'error' field of an error response with Content-Format application/ace-groupcomm+cbor.<a href="#section-9-1" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-error-identifi"></span><div id="fig-ACE-Groupcomm-Error">
<figure id="figure-36">
        <div class="alignCenter art-text artwork" id="section-9-2.1">
<pre>
+-------+------------------------------------------------------+
| Value |                   Description                        |
+-------+------------------------------------------------------+
|   0   | Operation permitted only to group members            |
+-------+------------------------------------------------------+
|   1   | Request inconsistent with the current roles          |
+-------+------------------------------------------------------+
|   2   | Public key incompatible with the group configuration |
+-------+------------------------------------------------------+
|   3   | Invalid proof-of-possession evidence                 |
+-------+------------------------------------------------------+
|   4   | No available node identifiers                        |
+-------+------------------------------------------------------+
|   5   | Group membership terminated                          |
+-------+------------------------------------------------------+
|   6   | Group deleted                                        |
+-------+------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-36" class="selfRef">Figure 36</a>:
<a href="#name-ace-groupcomm-error-identifi" class="selfRef">ACE Groupcomm Error Identifiers</a>
        </figcaption></figure>
</div>
<p id="section-9-3">A Client supporting the 'error' parameter (see <a href="#kdc-if-errors" class="xref">Section 4.1.2</a> and <a href="#params" class="xref">Section 8</a>) and able to understand the specified error may use that information to determine what actions to take next. If it is included in the error response and supported by the Client, the 'error_description' parameter may provide additional context.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">In particular, the following guidelines apply, and application profiles of this specification can define more detailed actions for the Client to take when learning that a specific error has occurred.<a href="#section-9-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-5.1">In case of error 0, the Client should stop sending the request in question to the KDC. Rather, the Client should first join the targeted group. If it has not happened already, this first requires the Client to obtain an appropriate access token authorizing access to the group and provide it to the KDC.<a href="#section-9-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.2">In case of error 1, the Client as a group member should re-join the group with all the roles needed to perform the operation in question. This might require the Client to first obtain a new access token and provide it to the KDC, if the current access token does not authorize to take those roles in the group. For operations admitted to a Client which is not a group member (e.g., an external signature verifier), the Client should first obtain a new access token authorizing to also have the missing roles.<a href="#section-9-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.3">In case of error 2, the Client has to obtain or self-generate a different asymmetric key pair, as aligned to the publick key algorithms, parameters and encoding used in the targeted group. After that, the Client should provide its new consistent public key to the KDC.<a href="#section-9-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.4">In case of error 3, the Client should ensure to be computing its proof-of-possession evidence by correctly using the parameters and procedures defined in the used application profile of this specification. In an unattended setup, it might be not possible for a Client to autonomously diagnose the error and take an effective next action to address it.<a href="#section-9-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.5">In case of error 4, the Client should wait for a certain (pre-configured) amount of time, before trying re-sending its request to the KDC.<a href="#section-9-5.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.6">In case of error 5, the Client may try joining the group again. This might require the Client to first obtain a new access token and provide it to the KDC, e.g., if the current access token has expired.<a href="#section-9-5.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.7">In case of error 6, the Client should clean up its state regarding the group, just like if it has left the group with no intention to re-join it.<a href="#section-9-5.7" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec-cons">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">Security considerations are inherited from the ACE framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, and from the specific transport profile of ACE used between the Clients and the KDC, e.g., <span>[<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span> and <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Furthermore, the following security considerations apply.<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="sec-cons-communication">
<section id="section-10.1">
        <h3 id="name-secure-communication-in-the">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-secure-communication-in-the" class="section-name selfRef">Secure Communication in the Group</a>
        </h3>
<p id="section-10.1-1">When a group member receives a message from a certain sender for the first time since joining the group, it needs to have a mechanism in place to avoid replayed messages, e.g., <span><a href="https://rfc-editor.org/rfc/rfc8613#appendix-B.2" class="relref">Appendix B.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span> or <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-13#appendix-E" class="relref">Appendix E</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. Such a mechanism aids the recipient group member also in case it has rebooted and lost the security state used to protect previous group communications with that sender.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">By its nature, the KDC is invested with a large amount of trust, since it acts as generator and provider of the symmetric keying material used to protect communications in each of its groups. While details depend on the specific communication and security protocols used in the group, the KDC is in the position to decrypt messages exchanged in the group as if it was also a group member, as long as those are protected through commonly shared group keying material.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">A compromised KDC would thus put the attacker in the same position, which also means that:<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-4.1">The attacker can generate and control new group keying material, hence possibly rekeying the group and evicting certain group members as part of a broader attack.<a href="#section-10.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-4.2">The attacker can actively participate to communications in a group even without been authorized to join it, and can allow further unauthorized entities to do so.<a href="#section-10.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-4.3">The attacker can build erroneous associations between node identifiers and group members' public keys.<a href="#section-10.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.1-5">On the other hand, as long as the security protocol used in the group ensures source authentication of messages (e.g., by means of signatures), the KDC is not able to impersonate group members since it does now own their private keys.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1-6">Further security considerations are specific of the communication and security protocols used in the group, and thus have to be provided by those protocols and complemented by the application profiles of this specification using them.<a href="#section-10.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-rekeying">
<section id="section-10.2">
        <h3 id="name-update-of-group-keying-mate">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-update-of-group-keying-mate" class="section-name selfRef">Update of Group Keying Material</a>
        </h3>
<p id="section-10.2-1">Due to different reasons, the KDC can generate new group keying material and provide it to the group members (rekeying) through the rekeying scheme used in the group, as discussed in <a href="#sec-group-rekeying" class="xref">Section 6</a>.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">In particular, the KDC must renew the group keying material latest upon its expiration. Before then, the KDC may also renew the group keying material on a regular or periodical fashion.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">The KDC should renew the group keying material upon a group membership change. Since the minimum number of group members is one, the KDC should provide also a Client joining an empty group with new keying material never used before in that group. Similarly, the KDC should provide new group keying material also to a Client that remains the only member in the group after the leaving of other group members.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">Note that the considerations in <a href="#sec-cons-communication" class="xref">Section 10.1</a> about dealing with replayed messages still hold, even in case the KDC rekeys the group upon every single joining of a new group member. However, if the KDC has renewed the group keying material upon a group member's joining, and the time interval between the end of the rekeying process and that member's joining is sufficiently small, then that group member is also on the safe side, since it would not accept replayed messages protected with the old group keying material previous to its joining.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">The KDC may enforce a rekeying policy that takes into account the overall time required to rekey the group, as well as the expected rate of changes in the group membership. That is, the KDC may not rekey the group at each and every group membership change, for instance if members' joining and leaving occur frequently and performing a group rekeying takes too long. Instead, the KDC might rekey the group after a minimum number of group members have joined or left within a given time interval, or after a maximum amount of time since the last group rekeying was completed, or yet during predictable network inactivity periods.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<p id="section-10.2-6">However, this would result in the KDC not constantly preserving backward and forward security in the group. That is:<a href="#section-10.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-7.1">Newly joining group members would be able to access the keying material used before their joining, and thus they could access past group communications if they have recorded old exchanged messages. This might still be acceptable for some applications and in situations where the new group members are freshly deployed through strictly controlled procedures.<a href="#section-10.2-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-7.2">The leaving group members would remain able to access upcoming group communications, as protected with the current keying material that has not been updated. This is typically undesirable, especially if the leaving group member is compromised or suspected to be, and it might have an impact or compromise the security properties of the protocols used in the group to protect messages exchanged among the group member.<a href="#section-10.2-7.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.2-8">The KDC should renew the group keying material in case it has rebooted, even in case it stores the whole group keying material in persistent storage. This assumes that the secure associations with the current group members as well as any administrative keying material required to rekey the group are also stored in persistent storage.<a href="#section-10.2-8" class="pilcrow">¶</a></p>
<p id="section-10.2-9">However, if the KDC relies on Observe notifications to distribute the new group keying material, the KDC would have lost all the current ongoing Observations with the group members after rebooting, and the group members would continue using the old group keying material. Therefore, the KDC will rather rely on each group member asking for the new group keying material (see <a href="#ssec-key-material-retrieval" class="xref">Section 4.3.2.1</a> and <a href="#update-keys" class="xref">Section 4.8.1.1</a>), or rather perform a group rekeying by actively sending rekeying messages to group members as discussed in <a href="#sec-group-rekeying" class="xref">Section 6</a>.<a href="#section-10.2-9" class="pilcrow">¶</a></p>
<p id="section-10.2-10">The KDC needs to have a mechanism in place to detect DoS attacks from nodes repeatedly performing actions that might trigger a group rekeying. Such actions can include leaving and/or re-joining the group at high rates, or often asking the KDC for new indidivual keying material. Ultimately, the KDC can resort to removing these nodes from the group and (temperorarily) preventing them from joining the group again.<a href="#section-10.2-10" class="pilcrow">¶</a></p>
<p id="section-10.2-11">The KDC also needs to have a congestion control mechanism in place, in order to avoid network congestion upon distributing new group keying material. For example, CoAP and Observe give guidance on such mechanisms, see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.7" class="relref">Section 4.7</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc7641#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>.<a href="#section-10.2-11" class="pilcrow">¶</a></p>
<p id="section-10.2-12">A node that has left the group should not expect any of its outgoing messages to be successfully processed, if received by other nodes after its leaving, due to a possible group rekeying occurred before the message reception.<a href="#section-10.2-12" class="pilcrow">¶</a></p>
<div id="misalignment-of-group-keying-material">
<section id="section-10.2.1">
          <h4 id="name-misalignment-of-group-keyin">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-misalignment-of-group-keyin" class="section-name selfRef">Misalignment of Group Keying Material</a>
          </h4>
<p id="section-10.2.1-1">A group member can receive a message shortly after the group has been rekeyed, and new keying material has been distributed by the KDC (see <a href="#sec-group-rekeying" class="xref">Section 6</a>). In the following two cases, this may result in misaligned keying material between the group members.<a href="#section-10.2.1-1" class="pilcrow">¶</a></p>
<p id="section-10.2.1-2">In the first case, the sender protects a message using the old group keying material. However, the recipient receives the message after having received the new group keying material, hence not being able to correctly process it. A possible way to ameliorate this issue is to preserve the old, recent group keying material for a maximum amount of time defined by the application, during which it is used solely for processing incoming messages. By doing so, the recipient can still temporarily process received messages also by using the old, retained group keying material. Note that a former (compromised) group member can take advantage of this by sending messages protected with the old, retained group keying material. Therefore, a conservative application policy should not admit the storage of old group keying material. Eventually, the sender will have obtained the new group keying material too, and can possibly re-send the message protected with such keying material.<a href="#section-10.2.1-2" class="pilcrow">¶</a></p>
<p id="section-10.2.1-3">In the second case, the sender protects a message using the new group keying material, but the recipient receives that message before having received the new group keying material. Therefore, the recipient would not be able to correctly process the message and hence discards it. If the recipient receives the new group keying material shortly after that and the application at the sender endpoint performs retransmissions, the former will still be able to receive and correctly process the message. In any case, the recipient should actively ask the KDC for the latest group keying material according to an application-defined policy, for instance after a given number of unsuccessfully decrypted incoming messages.<a href="#section-10.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="block-wise-considerations">
<section id="section-10.3">
        <h3 id="name-block-wise-considerations">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-block-wise-considerations" class="section-name selfRef">Block-Wise Considerations</a>
        </h3>
<p id="section-10.3-1">If the Block-Wise CoAP options <span>[<a href="#RFC7959" class="xref">RFC7959</a>]</span> are used, and the keying material is updated in the middle of a Block-Wise transfer, the sender of the blocks just changes the group keying material to the updated one and continues the transfer. As long as both sides get the new group keying material, updating group the keying material in the middle of a transfer will not cause any issue. Otherwise, the sender will have to transmit the message again, when receiving an error message from the recipient.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">Compared to a scenario where the transfer does not use Block-Wise, depending on how fast the group keying material is changed, the group members might consume a larger amount of the network bandwidth by repeatedly resending the same blocks, which might be problematic.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">This document has the following actions for IANA.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="media-type">
<section id="section-11.1">
        <h3 id="name-media-type-registrations">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-media-type-registrations" class="section-name selfRef">Media Type Registrations</a>
        </h3>
<p id="section-11.1-1">This specification registers the 'application/ace-groupcomm+cbor' media type for messages of the protocols defined in this document following the ACE exchange and carrying parameters encoded in CBOR. This registration follows the procedures specified in <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">Type name: application<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">Subtype name: ace-groupcomm+cbor<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">Required parameters: N/A<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<p id="section-11.1-5">Optional parameters: N/A<a href="#section-11.1-5" class="pilcrow">¶</a></p>
<p id="section-11.1-6">Encoding considerations: Must be encoded as CBOR map containing the protocol parameters defined in [this document].<a href="#section-11.1-6" class="pilcrow">¶</a></p>
<p id="section-11.1-7">Security considerations: See <a href="#sec-cons" class="xref">Section 10</a> of this document.<a href="#section-11.1-7" class="pilcrow">¶</a></p>
<p id="section-11.1-8">Interoperability considerations: n/a<a href="#section-11.1-8" class="pilcrow">¶</a></p>
<p id="section-11.1-9">Published specification: [this document]<a href="#section-11.1-9" class="pilcrow">¶</a></p>
<p id="section-11.1-10">Applications that use this media type: The type is used by Authorization Servers, Clients and Resource Servers that support the ACE groupcomm framework as specified in [this document].<a href="#section-11.1-10" class="pilcrow">¶</a></p>
<p id="section-11.1-11">Fragment identifier considerations: N/A<a href="#section-11.1-11" class="pilcrow">¶</a></p>
<p id="section-11.1-12">Additional information: N/A<a href="#section-11.1-12" class="pilcrow">¶</a></p>
<p id="section-11.1-13">Person &amp; email address to contact for further information:
   <a href="mailto:iesg@ietf.org">iesg@ietf.org</a><a href="#section-11.1-13" class="pilcrow">¶</a></p>
<p id="section-11.1-14">Intended usage: COMMON<a href="#section-11.1-14" class="pilcrow">¶</a></p>
<p id="section-11.1-15">Restrictions on usage: None<a href="#section-11.1-15" class="pilcrow">¶</a></p>
<p id="section-11.1-16">Author: Francesca Palombini <a href="mailto:francesca.palombini@ericsson.com">francesca.palombini@ericsson.com</a><a href="#section-11.1-16" class="pilcrow">¶</a></p>
<p id="section-11.1-17">Change controller: IESG<a href="#section-11.1-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-type">
<section id="section-11.2">
        <h3 id="name-coap-content-formats">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-coap-content-formats" class="section-name selfRef">CoAP Content-Formats</a>
        </h3>
<p id="section-11.2-1">IANA is asked to register the following entry to the "CoAP Content-Formats" registry within the "CoRE Parameters" registry group.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">Media Type: application/ace-groupcomm+cbor<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2-3">Encoding: -<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2-4">ID: TBD<a href="#section-11.2-4" class="pilcrow">¶</a></p>
<p id="section-11.2-5">Reference: [this document]<a href="#section-11.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-kinfo">
<section id="section-11.3">
        <h3 id="name-oauth-parameters">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-oauth-parameters" class="section-name selfRef">OAuth Parameters</a>
        </h3>
<p id="section-11.3-1">IANA is asked to register the following entries in the "OAuth Parameters" registry following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-11.2" class="relref">Section 11.2</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-2.1">Parameter name: sign_info<a href="#section-11.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.3-2.2">Parameter usage location: client-rs request, rs-client response<a href="#section-11.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.3-2.3">Change Controller: IESG<a href="#section-11.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.3-2.4">Specification Document(s): [[This specification]]<a href="#section-11.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.3-3"></p>
<ul class="normal">
<li class="normal" id="section-11.3-4.1">Parameter name: kdcchallenge<a href="#section-11.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.3-4.2">Parameter usage location: rs-client response<a href="#section-11.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.3-4.3">Change Controller: IESG<a href="#section-11.3-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.3-4.4">Specification Document(s): [[This specification]]<a href="#section-11.3-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-kinfo-map">
<section id="section-11.4">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings</a>
        </h3>
<p id="section-11.4-1">IANA is asked to register the following entries in the "OAuth Parameters CBOR
Mappings" registry following the procedure specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-45#section-8.10" class="relref">Section 8.10</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.4-2.1">Name: sign_info<a href="#section-11.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.4-2.2">CBOR Key: TBD (range -256 to 255)<a href="#section-11.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.4-2.3">Value Type: Simple value null / array<a href="#section-11.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.4-2.4">Reference: [[This specification]]<a href="#section-11.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.4-3"></p>
<ul class="normal">
<li class="normal" id="section-11.4-4.1">Name: kdcchallenge<a href="#section-11.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.4-4.2">CBOR Key: TBD (range -256 to 255)<a href="#section-11.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.4-4.3">Value Type: Byte string<a href="#section-11.4-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.4-4.4">Reference: [[This specification]]<a href="#section-11.4-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="if-ace-group">
<section id="section-11.5">
        <h3 id="name-interface-description-if-li">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-interface-description-if-li" class="section-name selfRef">Interface Description (if=) Link Target Attribute Values</a>
        </h3>
<p id="section-11.5-1">IANA is asked to register the following entry in the "Interface Description (if=) Link Target Attribute Values" registry within the "CoRE Parameters" registry group.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-2.1">Attribute Value: ace.group<a href="#section-11.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.5-2.2">Description: The 'ace group' interface is used to provision keying material and related information and policies to members of a group using the Ace framework.<a href="#section-11.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.5-2.3">Reference: [This Document]<a href="#section-11.5-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-cbor-tags">
<section id="section-11.6">
        <h3 id="name-cbor-tags">
<a href="#section-11.6" class="section-number selfRef">11.6. </a><a href="#name-cbor-tags" class="section-name selfRef">CBOR Tags</a>
        </h3>
<p id="section-11.6-1">IANA is asked to register the following entry in the "CBOR Tags" registry.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.6-2.1">Tag : TBD_TAG<a href="#section-11.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.6-2.2">Data Item: byte string<a href="#section-11.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.6-2.3">Semantics: Extended ACE scope format, including the identifier of the used scope semantics.<a href="#section-11.6-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.6-2.4">Reference: [This Document]<a href="#section-11.6-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-reg">
<section id="section-11.7">
        <h3 id="name-ace-groupcomm-parameters-3">
<a href="#section-11.7" class="section-number selfRef">11.7. </a><a href="#name-ace-groupcomm-parameters-3" class="section-name selfRef">ACE Groupcomm Parameters</a>
        </h3>
<p id="section-11.7-1">This specification establishes the "ACE Groupcomm Parameters" IANA registry. The
registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>.<a href="#section-11.7-1" class="pilcrow">¶</a></p>
<p id="section-11.7-2">The columns of this registry are:<a href="#section-11.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.7-3.1">Name: This is a descriptive name that enables easier reference to
the item. The name MUST be unique. It is not used in the encoding.<a href="#section-11.7-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.7-3.2">CBOR Key: This is the value used as CBOR key of the item. These values MUST be unique. The value can be a positive integer, a negative integer, or a string.<a href="#section-11.7-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.7-3.3">CBOR Type: This contains the CBOR type of the item, or a pointer to the registry that defines its type, when that depends on another item.<a href="#section-11.7-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.7-3.4">Reference: This contains a pointer to the public specification for the item.<a href="#section-11.7-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.7-4">This registry has been initially populated by the values in <a href="#params" class="xref">Section 8</a>. The Reference column for all of these entries refers to sections of this document.<a href="#section-11.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-key">
<section id="section-11.8">
        <h3 id="name-ace-groupcomm-key-types">
<a href="#section-11.8" class="section-number selfRef">11.8. </a><a href="#name-ace-groupcomm-key-types" class="section-name selfRef">ACE Groupcomm Key Types</a>
        </h3>
<p id="section-11.8-1">This specification establishes the "ACE Groupcomm Key Types" IANA registry. The
registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>.<a href="#section-11.8-1" class="pilcrow">¶</a></p>
<p id="section-11.8-2">The columns of this registry are:<a href="#section-11.8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.8-3.1">Name: This is a descriptive name that enables easier reference to
the item. The name MUST be unique. It is not used in the encoding.<a href="#section-11.8-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.8-3.2">Key Type Value: This is the value used to identify the keying material. These values MUST be unique.  The value can be a positive integer, a negative integer, or a text string.<a href="#section-11.8-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.8-3.3">Profile: This field may contain one or more descriptive strings of application profiles to be used with this item. The values should be taken from the Name column of the "ACE Groupcomm Profiles" registry.<a href="#section-11.8-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.8-3.4">Description: This field contains a brief description of the keying material.<a href="#section-11.8-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.8-3.5">References: This contains a pointer to the public specification for the format of the keying material, if one exists.<a href="#section-11.8-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.8-4">This registry has been initially populated by the values in <a href="#gkty" class="xref">Figure 10</a>. The specification column for all of these entries will be this document.<a href="#section-11.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ace-groupcomm-profiles">
<section id="section-11.9">
        <h3 id="name-ace-groupcomm-profiles">
<a href="#section-11.9" class="section-number selfRef">11.9. </a><a href="#name-ace-groupcomm-profiles" class="section-name selfRef">ACE Groupcomm Profiles</a>
        </h3>
<p id="section-11.9-1">This specification establishes the "ACE Groupcomm Profiles" IANA registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>. It should be noted that, in addition to the expert review, some portions of the registry require a specification, potentially a Standards Track RFC, to be supplied as well.<a href="#section-11.9-1" class="pilcrow">¶</a></p>
<p id="section-11.9-2">The columns of this registry are:<a href="#section-11.9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.9-3.1">Name: The name of the application profile, to be used as value of the profile attribute.<a href="#section-11.9-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.9-3.2">Description: Text giving an overview of the application profile and the context it is developed for.<a href="#section-11.9-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.9-3.3">CBOR Value: CBOR abbreviation for the name of this application profile. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Integer values from -256 to 255 are designated as Standards Action. Integer values from -65536 to -257 and from 256 to 65535 are designated as Specification Required. Integer values greater than 65535 are designated as Expert Review. Integer values less than -65536 are marked as Private Use.<a href="#section-11.9-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.9-3.4">Reference: This contains a pointer to the public specification of the abbreviation for this application profile, if one exists.<a href="#section-11.9-3.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ace-groupcomm-policies">
<section id="section-11.10">
        <h3 id="name-ace-groupcomm-policies-2">
<a href="#section-11.10" class="section-number selfRef">11.10. </a><a href="#name-ace-groupcomm-policies-2" class="section-name selfRef">ACE Groupcomm Policies</a>
        </h3>
<p id="section-11.10-1">This specification establishes the "ACE Groupcomm Policies" IANA registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>. It should be noted that, in addition to the expert review, some portions of the registry require a specification, potentially a Standards Track RFC, to be supplied as well.<a href="#section-11.10-1" class="pilcrow">¶</a></p>
<p id="section-11.10-2">The columns of this registry are:<a href="#section-11.10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.10-3.1">Name: The name of the group communication policy.<a href="#section-11.10-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.10-3.2">CBOR label: The value to be used to identify this group communication policy.  Key map labels MUST be unique. The label can be a positive integer, a negative integer or a string.  Integer values between 0 and 255 and strings of length 1 are designated as Standards Track Document required. Integer values from 256 to 65535 and strings of length 2 are designated as Specification Required.  Integer values greater than 65535 and strings of length greater than 2 are designated as expert review.  Integer values less than -65536 are marked as private use.<a href="#section-11.10-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.10-3.3">CBOR type: the CBOR type used to encode the value of this group communication policy.<a href="#section-11.10-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.10-3.4">Description: This field contains a brief description for this group communication policy.<a href="#section-11.10-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.10-3.5">Reference: This field contains a pointer to the public specification providing the format of the group communication policy, if one exists.<a href="#section-11.10-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.10-4">This registry will be initially populated by the values in <a href="#fig-ACE-Groupcomm-Policies" class="xref">Figure 11</a>.<a href="#section-11.10-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sequence-number-synchronization-methods">
<section id="section-11.11">
        <h3 id="name-sequence-number-synchroniza">
<a href="#section-11.11" class="section-number selfRef">11.11. </a><a href="#name-sequence-number-synchroniza" class="section-name selfRef">Sequence Number Synchronization Methods</a>
        </h3>
<p id="section-11.11-1">This specification establishes the "Sequence Number Synchronization Methods" IANA registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>. It should be noted that, in addition to the expert review, some portions of the registry require a specification, potentially a Standards Track RFC, to be supplied as well.<a href="#section-11.11-1" class="pilcrow">¶</a></p>
<p id="section-11.11-2">The columns of this registry are:<a href="#section-11.11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.11-3.1">Name: The name of the sequence number synchronization method.<a href="#section-11.11-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.11-3.2">Value: The value to be used to identify this sequence number synchronization method.<a href="#section-11.11-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.11-3.3">Description: This field contains a brief description for this sequence number synchronization method.<a href="#section-11.11-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.11-3.4">Reference: This field contains a pointer to the public specification describing the sequence number synchronization method.<a href="#section-11.11-3.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-scope-semantics">
<section id="section-11.12">
        <h3 id="name-ace-scope-semantics">
<a href="#section-11.12" class="section-number selfRef">11.12. </a><a href="#name-ace-scope-semantics" class="section-name selfRef">ACE Scope Semantics</a>
        </h3>
<p id="section-11.12-1">This specification establishes the "ACE Scope Semantics" IANA registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>. It should be noted that, in addition to the expert review, some portions of the registry require a specification, potentially a Standards Track RFC, to be supplied as well.<a href="#section-11.12-1" class="pilcrow">¶</a></p>
<p id="section-11.12-2">The columns of this registry are:<a href="#section-11.12-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.12-3.1">Value: The value to be used to identify this scope semantics. The value MUST be unique. The value can be a positive integer or a negative integer. Integer values between 0 and 255 are designated as Standards Track Document required. Integer values from 256 to 65535 are designated as Specification Required. Integer values greater than 65535 are designated as expert review. Integer values less than -65536 are marked as private use.<a href="#section-11.12-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.12-3.2">Description: This field contains a brief description of the scope semantics.<a href="#section-11.12-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.12-3.3">Reference: This field contains a pointer to the public specification defining the scope semantics, if one exists.<a href="#section-11.12-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-ace-groupcomm-errors">
<section id="section-11.13">
        <h3 id="name-ace-groupcomm-errors">
<a href="#section-11.13" class="section-number selfRef">11.13. </a><a href="#name-ace-groupcomm-errors" class="section-name selfRef">ACE Groupcomm Errors</a>
        </h3>
<p id="section-11.13-1">This specification establishes the "ACE Groupcomm Errors" IANA registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>. It should be noted that, in addition to the expert review, some portions of the registry require a specification, potentially a Standards Track RFC, to be supplied as well.<a href="#section-11.13-1" class="pilcrow">¶</a></p>
<p id="section-11.13-2">The columns of this registry are:<a href="#section-11.13-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.13-3.1">Value: The value to be used to identify the error. The value MUST be unique. The value can be a positive integer or a negative integer. Integer values between 0 and 255 are designated as Standards Track Document required. Integer values from 256 to 65535 are designated as Specification Required. Integer values greater than 65535 are designated as expert review. Integer values less than -65536 are marked as private use.<a href="#section-11.13-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.13-3.2">Description: This field contains a brief description of the error.<a href="#section-11.13-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.13-3.3">Reference: This field contains a pointer to the public specification defining the error, if one exists.<a href="#section-11.13-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.13-4">This registry has been initially populated by the values in <a href="#error-types" class="xref">Section 9</a>. The Reference column for all of these entries refers to this document.<a href="#section-11.13-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-ace-groupcomm-rekeying-schemes">
<section id="section-11.14">
        <h3 id="name-ace-groupcomm-rekeying-schem">
<a href="#section-11.14" class="section-number selfRef">11.14. </a><a href="#name-ace-groupcomm-rekeying-schem" class="section-name selfRef">ACE Groupcomm Rekeying Schemes</a>
        </h3>
<p id="section-11.14-1">This specification establishes the "ACE Groupcomm Rekeying Schemes" IANA registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 11.15</a>. It should be noted that, in addition to the expert review, some portions of the registry require a specification, potentially a Standards Track RFC, to be supplied as well.<a href="#section-11.14-1" class="pilcrow">¶</a></p>
<p id="section-11.14-2">The columns of this registry are:<a href="#section-11.14-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.14-3.1">Value: The value to be used to identify the group rekeying scheme. The value MUST be unique. The value can be a positive integer or a negative integer. Integer values between 0 and 255 are designated as Standards Track Document required. Integer values from 256 to 65535 are designated as Specification Required. Integer values greater than 65535 are designated as expert review. Integer values less than -65536 are marked as private use.<a href="#section-11.14-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.14-3.2">Name: The name of the group rekeying scheme.<a href="#section-11.14-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.14-3.3">Description: This field contains a brief description of the group rekeying scheme.<a href="#section-11.14-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.14-3.4">Reference: This field contains a pointer to the public specification defining the group rekeying scheme, if one exists.<a href="#section-11.14-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.14-4">This registry has been initially populated by the value in <a href="#rekeying-scheme-0" class="xref">Figure 12</a>.<a href="#section-11.14-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="review">
<section id="section-11.15">
        <h3 id="name-expert-review-instructions">
<a href="#section-11.15" class="section-number selfRef">11.15. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-11.15-1">The IANA Registries established in this document are defined as expert review.
This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-11.15-1" class="pilcrow">¶</a></p>
<p id="section-11.15-2">Expert reviewers should take into consideration the following points:<a href="#section-11.15-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.15-3.1">Point squatting should be discouraged.
 Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments.
 The zones tagged as private use are intended for testing purposes and closed environments, code points in other ranges should not be assigned for testing.<a href="#section-11.15-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.15-3.2">Specifications are required for the standards track range of point assignment.
 Specifications should exist for specification required ranges, but early assignment before a specification is available is considered to be permissible.
 Specifications are needed for the first-come, first-serve range if they are expected to be used outside of closed environments in an interoperable way.
 When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-11.15-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.15-3.3">Experts should take into account the expected usage of fields when approving point assignment.
 The fact that there is a range for standards track documents does not mean that a standards track document cannot have points assigned outside of that range.
 The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-11.15-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-aif">[I-D.ietf-ace-aif]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"An Authorization Information Format (AIF) for ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-aif-03</span>, <time datetime="2021-06-24" class="refDate">24 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-aif-03.txt">https://www.ietf.org/archive/id/draft-ietf-ace-aif-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-45</span>, <time datetime="2021-08-29" class="refDate">29 August 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-45.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-45.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-13</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-13.txt">https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-countersign">[I-D.ietf-cose-countersign]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Countersignatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-countersign-05</span>, <time datetime="2021-06-23" class="refDate">23 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-countersign-05.txt">https://www.ietf.org/archive/id/draft-ietf-cose-countersign-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-algs">[I-D.ietf-cose-rfc8152bis-algs]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-algs-12</span>, <time datetime="2020-09-24" class="refDate">24 September 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-struct">[I-D.ietf-cose-rfc8152bis-struct]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-struct-15</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7967">[RFC7967]</dt>
        <dd>
<span class="refAuthor">Bhattacharyya, A.</span>, <span class="refAuthor">Bandyopadhyay, S.</span>, <span class="refAuthor">Pal, A.</span>, and <span class="refAuthor">T. Bose</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Option for No Server Response"</span>, <span class="seriesInfo">RFC 7967</span>, <span class="seriesInfo">DOI 10.17487/RFC7967</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7967">https://www.rfc-editor.org/info/rfc7967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8742">https://www.rfc-editor.org/info/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-dtls-authorize">[I-D.ietf-ace-dtls-authorize]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-dtls-authorize-18</span>, <time datetime="2021-06-04" class="refDate">4 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-dtls-authorize-18.txt">https://www.ietf.org/archive/id/draft-ietf-ace-dtls-authorize-18.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-mqtt-tls-profile">[I-D.ietf-ace-mqtt-tls-profile]</dt>
        <dd>
<span class="refAuthor">Sengul, C.</span> and <span class="refAuthor">A. Kirby</span>, <span class="refTitle">"Message Queuing Telemetry Transport (MQTT)-TLS profile of Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-mqtt-tls-profile-13</span>, <time datetime="2021-10-23" class="refDate">23 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-mqtt-tls-profile-13.txt">https://www.ietf.org/archive/id/draft-ietf-ace-mqtt-tls-profile-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-profile">[I-D.ietf-ace-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"OSCORE Profile of the Authentication and Authorization for Constrained Environments Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-profile-19</span>, <time datetime="2021-05-06" class="refDate">6 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
        <dd>
<span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Keranen, A.</span>, and <span class="refAuthor">J. Jimenez</span>, <span class="refTitle">"Publish-Subscribe Broker for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-09</span>, <time datetime="2019-09-30" class="refDate">30 September 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt">https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-05</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-05.txt">https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsuess, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-10</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-10.txt">https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2093">[RFC2093]</dt>
        <dd>
<span class="refAuthor">Harney, H.</span> and <span class="refAuthor">C. Muckenhirn</span>, <span class="refTitle">"Group Key Management Protocol (GKMP) Specification"</span>, <span class="seriesInfo">RFC 2093</span>, <span class="seriesInfo">DOI 10.17487/RFC2093</span>, <time datetime="1997-07" class="refDate">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2093">https://www.rfc-editor.org/info/rfc2093</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2094">[RFC2094]</dt>
        <dd>
<span class="refAuthor">Harney, H.</span> and <span class="refAuthor">C. Muckenhirn</span>, <span class="refTitle">"Group Key Management Protocol (GKMP) Architecture"</span>, <span class="seriesInfo">RFC 2094</span>, <span class="seriesInfo">DOI 10.17487/RFC2094</span>, <time datetime="1997-07" class="refDate">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2094">https://www.rfc-editor.org/info/rfc2094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2627">[RFC2627]</dt>
        <dd>
<span class="refAuthor">Wallner, D.</span>, <span class="refAuthor">Harder, E.</span>, and <span class="refAuthor">R. Agee</span>, <span class="refTitle">"Key Management for Multicast: Issues and Architectures"</span>, <span class="seriesInfo">RFC 2627</span>, <span class="seriesInfo">DOI 10.17487/RFC2627</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2627">https://www.rfc-editor.org/info/rfc2627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7641">https://www.rfc-editor.org/info/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="req">
<section id="appendix-A">
      <h2 id="name-requirements-on-application">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-requirements-on-application" class="section-name selfRef">Requirements on Application Profiles</a>
      </h2>
<p id="appendix-A-1">This section lists the requirements on application profiles of this specification, for the convenience of application profile designers.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="mandatory-to-address-requirements">
<section id="appendix-A.1">
        <h3 id="name-mandatory-to-address-requir">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-mandatory-to-address-requir" class="section-name selfRef">Mandatory-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">REQ1: Specify the format and encoding of 'scope'. This includes defining the set of possible roles and their identifiers, as well as the corresponding encoding to use in the scope entries according to the used scope format (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>).<a href="#appendix-A.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.2">REQ2: If the AIF format of 'scope' is used, register its specific instance of "Toid" and "Tperm", as well as the corresponding Media Type and Content-Format, as per the guidelines in <span>[<a href="#I-D.ietf-ace-aif" class="xref">I-D.ietf-ace-aif</a>]</span>.<a href="#appendix-A.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.3">REQ3: If used, specify the acceptable values for 'sign_alg' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#appendix-A.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.4">REQ4: If used, specify the acceptable values for 'sign_parameters' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#appendix-A.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.5">REQ5: If used, specify the acceptable values for 'sign_key_parameters' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#appendix-A.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.6">REQ6: Specify the acceptable formats for encoding public keys and, if used, the acceptable values for 'pub_key_enc' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#appendix-A.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.7">REQ7: If the value of the GROUPNAME URI path and the group name in the access token scope (gname in <a href="#ssec-authorization-response" class="xref">Section 3.2</a>) are not required to coincide, specify the mechanism to map the GROUPNAME value in the URI to the group name (see <a href="#kdc-if" class="xref">Section 4.1</a>).<a href="#appendix-A.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.8">REQ8: Define whether the KDC has a public key and if this has to be provided through the 'kdc_cred' parameter, see <a href="#gid-post" class="xref">Section 4.3.1</a>.<a href="#appendix-A.1-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.9">REQ9: Specify if any part of the KDC interface as defined in this document is not supported by the KDC (see <a href="#kdc-if" class="xref">Section 4.1</a>).<a href="#appendix-A.1-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.10">REQ10: Register a Resource Type for the root url-path, which is used to discover the correct url to access at the KDC (see <a href="#kdc-if" class="xref">Section 4.1</a>).<a href="#appendix-A.1-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.11">REQ11: Define what specific actions (e.g., CoAP methods) are allowed on each resource provided by the KDC interface, depending on whether the Client is a current group member; the roles that a Client is authorized to take as per the obtained access token (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>); and the roles that the Client has as current group member.<a href="#appendix-A.1-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.12">REQ12: Categorize possible newly defined operations for Clients into primary operations expected to be minimally supported and secondary operations, and provide accompanying considerations (see <a href="#client-operations" class="xref">Section 4.1.1</a>).<a href="#appendix-A.1-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.13">REQ13: Specify the encoding of group identifier (see <a href="#ace-group-fetch" class="xref">Section 4.2.1</a>).<a href="#appendix-A.1-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.14">REQ14: Specify the approaches used to compute and verify the PoP evidence to include in 'client_cred_verify', and which of those approaches is used in which case (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.15">REQ15: Specify how the nonce N_S is generated, if the token is not provided to the KDC through the Token Transfer Request to the authz-info endpoint (e.g., if it is used directly to validate TLS instead).<a href="#appendix-A.1-1.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.16">REQ16 Define the initial value of the 'num' parameter (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.16" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.17">REQ17: Specify the format of the 'key' parameter (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.17" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.18">REQ18: Specify the acceptable values of the 'gkty' parameter (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.18" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.19">REQ19: Specify and register the application profile identifier (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.19" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.20">REQ20: If used, specify the format and content of 'group_policies' and its entries. Specify the policies default values (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.20" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.21">REQ21: Specify the approaches used to compute and verify the PoP evidence to include in 'kdc_cred_verify', and which of those approaches is used in which case (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.21" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.22">REQ22: Specify the communication protocol the members of the group must use (e.g., multicast CoAP).<a href="#appendix-A.1-1.22" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.23">REQ23: Specify the security protocol the group members must use to protect their communication (e.g., group OSCORE). This must provide encryption, integrity and replay protection.<a href="#appendix-A.1-1.23" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.24">REQ24: Specify how the communication is secured between Client and KDC. Optionally, specify transport profile of ACE <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> to use between Client and KDC (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.3.1.1</a>.<a href="#appendix-A.1-1.24" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.25">REQ25: Specify the format of the identifiers of group members (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.1-1.25" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.26">REQ26: Specify policies at the KDC to handle ids that are not included in 'get_pub_keys' (see <a href="#pubkey-fetch" class="xref">Section 4.4.1</a>).<a href="#appendix-A.1-1.26" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.27">REQ27: Specify the format of newly-generated individual keying material for group members, or of the information to derive it, and corresponding CBOR label (see <a href="#node-get" class="xref">Section 4.8.1</a>).<a href="#appendix-A.1-1.27" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.28">REQ28: Specify and register the identifier of newly defined semantics for binary scopes (see <a href="#sec-extended-scope" class="xref">Section 7</a>).<a href="#appendix-A.1-1.28" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.29">REQ29: Categorize newly defined parameters according to the same criteria of <a href="#params" class="xref">Section 8</a>.<a href="#appendix-A.1-1.29" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.30">REQ30: Define whether Clients must, should or may support the conditional parameters defined in <a href="#params" class="xref">Section 8</a>, and under which circumstances.<a href="#appendix-A.1-1.30" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="optional-to-address-requirements">
<section id="appendix-A.2">
        <h3 id="name-optional-to-address-require">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-optional-to-address-require" class="section-name selfRef">Optional-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">OPT1: Optionally, if the textual format of 'scope' is used, specify CBOR values to use for abbreviating the role identifiers in the group (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>).<a href="#appendix-A.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.2">OPT2: Optionally, specify the additional parameters used in the exchange of Token Transfer Request and Response (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#appendix-A.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.3">OPT3: Optionally, specify the negotiation of parameter values for signature algorithm and signature keys, if 'sign_info' is not used (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#appendix-A.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.4">OPT4: Optionally, specify possible or required payload formats for specific error cases.<a href="#appendix-A.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.5">OPT5: Optionally, specify additional identifiers of error types, as values of the 'error' field in an error response from the KDC.<a href="#appendix-A.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.6">OPT6: Optionally, specify the encoding of 'pub_keys_repos' if the default is not used (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.7">OPT7: Optionally, specify the functionalities implemented at the 'control_uri' resource hosted at the Client, including message exchange encoding and other details (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.2-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.8">OPT8: Optionally, specify the behavior of the handler in case of failure to retrieve a public key for the specific node (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.2-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.9">OPT9: Optionally, define a default group rekeying scheme, to refer to in case the 'rekeying_scheme' parameter is not included in the Joining Response (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.2-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.10">OPT10: Optionally, specify the functionalities implemented at the 'control_group_uri' resource hosted at the Client, including message exchange encoding and other details (see <a href="#gid-post" class="xref">Section 4.3.1</a>).<a href="#appendix-A.2-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.11">OPT11: Optionally, specify policies that instruct Clients to retain messages and for how long, if they are unsuccessfully decrypted (see <a href="#update-keys" class="xref">Section 4.8.1.1</a>). This makes it possible to decrypt such messages after getting updated keying material.<a href="#appendix-A.2-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.12">OPT12: Optionally, specify for the KDC to perform group rekeying (together or instead of renewing individual keying material) when receiving a Key Renewal Request (see <a href="#new-keys" class="xref">Section 4.8.2.1</a>).<a href="#appendix-A.2-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.13">OPT13: Optionally, specify how the identifier of a group members's public key is included in requests sent to other group members (see <a href="#update-pub-key" class="xref">Section 4.9.1.1</a>).<a href="#appendix-A.2-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.14">OPT14: Optionally, specify additional information to include in rekeying messages for the "Point-to-Point" group rekeying scheme (see <a href="#sec-group-rekeying" class="xref">Section 6</a>).<a href="#appendix-A.2-1.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.15">OPT15: Optionally, specify if Clients must or should support any of the parameters defined as optional in this specification (see <a href="#params" class="xref">Section 8</a>).<a href="#appendix-A.2-1.15" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-future-cose-algs">
<section id="appendix-B">
      <h2 id="name-extensibility-for-future-co">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-extensibility-for-future-co" class="section-name selfRef">Extensibility for Future COSE Algorithms</a>
      </h2>
<p id="appendix-B-1">As defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-8.1" class="relref">Section 8.1</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>, future algorithms can be registered in the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span> as specifying none or multiple COSE capabilities.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">To enable the seamless use of such future registered algorithms, this section defines a general, agile format for each 'sign_info_entry' of the 'sign_info' parameter in the Token Transfer Response, see <a href="#sign-info" class="xref">Section 3.3.1</a>.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">If any of the currently registered COSE algorithms is considered, using this general format yields the same structure of 'sign_info_entry' defined in this document, thus ensuring retro-compatibility.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<div id="sec-future-cose-algs-sign-info-entry">
<section id="appendix-B.1">
        <h3 id="name-format-of-sign_info_entry">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-format-of-sign_info_entry" class="section-name selfRef">Format of 'sign_info_entry'</a>
        </h3>
<p id="appendix-B.1-1">The format of each 'sign_info_entry' (see <a href="#sign-info" class="xref">Section 3.3.1</a>) is generalized as follows. Given N the number of elements of the 'sign_parameters' array, i.e., the number of COSE capabilities of the signature algorithm, then:<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">'sign_key_parameters' is replaced by N elements 'sign_capab_i', each of which is a CBOR array.<a href="#appendix-B.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-2.2">The i-th array following 'sign_parameters', i.e., 'sign_capab_i' (i = 0, ..., N-1), is the array of COSE capabilities for the algorithm capability specified in 'sign_parameters'[i].<a href="#appendix-B.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-sign_info_entry-with-genera"></span><div id="fig-sign-info-entry-general">
<figure id="figure-37">
          <div id="appendix-B.1-3.1">
<pre class="lang-CDDL sourcecode">
sign_info_entry =
[
  id : gname / [ + gname ],
  sign_alg : int / tstr,
  sign_parameters : [ alg_capab_1 : any,
                      alg_capab_2 : any,
                      ...,
                      alg_capab_N : any],
  sign_capab_1 : [ any ],
  sign_capab_2 : [ any ],
  ...,
  sign_capab_N : [ any ],
  pub_key_enc = int / nil
]

gname = tstr
</pre>
</div>
<figcaption><a href="#figure-37" class="selfRef">Figure 37</a>:
<a href="#name-sign_info_entry-with-genera" class="selfRef">'sign_info_entry' with general format</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-C">
      <h2 id="name-document-updates">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-C-1">RFC EDITOR: PLEASE REMOVE THIS SECTION.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="sec-13-14">
<section id="appendix-C.1">
        <h3 id="name-version-13-to-14">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-version-13-to-14" class="section-name selfRef">Version -13 to -14</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">Clarified scope and goal of the document in abstract and introduction.<a href="#appendix-C.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.2">Overall clarifications on semantics of operations and parameters.<a href="#appendix-C.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.3">Major restructuring in the presentation of the KDC interface.<a href="#appendix-C.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.4">Revised error handling, also removing redundant text.<a href="#appendix-C.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.5">Imported parameters and KDC resource about the KDC's public key from draft-ietf-ace-key-groupcomm-oscore.<a href="#appendix-C.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.6">New parameters 'group_rekeying_scheme' and 'control_group_uri'.<a href="#appendix-C.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.7">Provided example of administrative keying material transported in 'mgt_key_material'.<a href="#appendix-C.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.8">Reasoned categorization of parameters, as expected support by ACE Clients.<a href="#appendix-C.1-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.9">Reasoned categorization of KDC functionalities, as minimally/optional to support for ACE Clients.<a href="#appendix-C.1-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.10">Guidelines on enhanced error responses using 'error' and 'error_description'.<a href="#appendix-C.1-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.11">New section on group rekeying, discussing at a high-level a basic one-to-one approach and possible one-to-many approaches.<a href="#appendix-C.1-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.12">Revised and expanded security considerations, also about the KDC.<a href="#appendix-C.1-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.13">Updated list of requirements for application profiles.<a href="#appendix-C.1-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.14">Several further clarifications and editorial improvements.<a href="#appendix-C.1-1.14" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-05-13">
<section id="appendix-C.2">
        <h3 id="name-version-05-to-13">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-version-05-to-13" class="section-name selfRef">Version -05 to -13</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">Incremental revision of the KDC interface.<a href="#appendix-C.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.2">Removed redundancy in parameters about signature algorithm and signature keys.<a href="#appendix-C.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.3">Node identifiers always indicated with 'peer_identifiers'.<a href="#appendix-C.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.4">Format of public keys changed from raw COSE Keys to be certificates, CWTs or CWT Claims Set (CCS). Adapted parameter 'pub_key_enc'.<a href="#appendix-C.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.5">Parameters and functionalities imported from draft-ietf-key-groupcomm-oscore where early defined.<a href="#appendix-C.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.6">Possible provisioning of the KDC's Diffie-Hellman public key in response to the Token transferring to /authz-info.<a href="#appendix-C.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.7">Generalized proof-of-possession evidence, to be not necessarily a signature.<a href="#appendix-C.2-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.8">Public keys of group members may be retrieved filtering by role and/or node identifier.<a href="#appendix-C.2-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.9">Enhanced error handling with error code and error description.<a href="#appendix-C.2-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.10">Extended "typed" format for the 'scope' claim, optional to use.<a href="#appendix-C.2-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.2-1.11">Editorial improvements.<a href="#appendix-C.2-1.11" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-04-05">
<section id="appendix-C.3">
        <h3 id="name-version-04-to-05">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">Updated uppercase/lowercase URI segments for KDC resources.<a href="#appendix-C.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.2">Supporting single Access Token for multiple groups/topics.<a href="#appendix-C.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.3">Added 'control_uri' parameter in the Joining Request.<a href="#appendix-C.3-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.4">Added 'peer_roles' parameter to support legal requesters/responders.<a href="#appendix-C.3-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.5">Clarification on stopping using owned keying material.<a href="#appendix-C.3-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.6">Clarification on different reasons for processing failures, related policies, and requirement OPT11.<a href="#appendix-C.3-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.7">Added a KDC sub-resource for group members to upload a new public key.<a href="#appendix-C.3-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.8">Possible group rekeying following an individual Key Renewal Request.<a href="#appendix-C.3-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.9">Clarified meaning of requirement REQ3; added requirement OPT12.<a href="#appendix-C.3-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.3-1.10">Editorial improvements.<a href="#appendix-C.3-1.10" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-C.4">
        <h3 id="name-version-03-to-04">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.4-1.1">Revised RESTful interface, as to methods and parameters.<a href="#appendix-C.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.2">Extended processing of joining request, as to check/retrieval of public keys.<a href="#appendix-C.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.3">Revised and extended profile requirements.<a href="#appendix-C.4-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.4">Clarified specific usage of parameters related to signature algorithms/keys.<a href="#appendix-C.4-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.5">Included general content previously in draft-ietf-ace-key-groupcomm-oscore<a href="#appendix-C.4-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.6">Registration of media type and content format application/ace-group+cbor<a href="#appendix-C.4-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.4-1.7">Editorial improvements.<a href="#appendix-C.4-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-C.5">
        <h3 id="name-version-02-to-03">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.5-1.1">Exchange of information on the signature algorithm and related parameters, during the Token POST (Section 3.3).<a href="#appendix-C.5-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.2">Restructured KDC interface, with new possible operations (Section 4).<a href="#appendix-C.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.3">Client PoP signature for the Joining Request upon joining (Section 4.1.2.1).<a href="#appendix-C.5-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.4">Revised text on group member removal (Section 5).<a href="#appendix-C.5-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.5-1.5">Added more profile requirements (Appendix A).<a href="#appendix-C.5-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-C.6">
        <h3 id="name-version-01-to-02">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.6-1.1">Editorial fixes.<a href="#appendix-C.6-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.2">Distinction between transport profile and application profile (Section 1.1).<a href="#appendix-C.6-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.3">New parameters 'sign_info' and 'pub_key_enc' to negotiate parameter values for signature algorithm and signature keys (Section 3.3).<a href="#appendix-C.6-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.4">New parameter 'type' to distinguish different Key Distribution Request messages (Section 4.1).<a href="#appendix-C.6-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.5">New parameter 'client_cred_verify' in the Key Distribution Request to convey a Client signature (Section 4.1).<a href="#appendix-C.6-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.6">Encoding of 'pub_keys_repos' (Section 4.1).<a href="#appendix-C.6-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.7">Encoding of 'mgt_key_material' (Section 4.1).<a href="#appendix-C.6-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.8">Improved description on retrieval of new or updated keying material (Section 6).<a href="#appendix-C.6-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.9">Encoding of 'get_pub_keys' in Public Key Request (Section 7.1).<a href="#appendix-C.6-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.10">Extended security considerations (Sections 10.1 and 10.2).<a href="#appendix-C.6-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.11">New "ACE Public Key Encoding" IANA registry (Section 11.2).<a href="#appendix-C.6-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.12">New "ACE Groupcomm Parameters" IANA registry (Section 11.3), populated with the entries in Section 8.<a href="#appendix-C.6-1.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.13">New "Ace Groupcomm Request Type" IANA registry (Section 11.4), populated with the values in Section 9.<a href="#appendix-C.6-1.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.14">New "ACE Groupcomm Policy" IANA registry (Section 11.7) populated with two entries "Sequence Number Synchronization Method" and "Key Update Check Interval" (Section 4.2).<a href="#appendix-C.6-1.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.6-1.15">Improved list of requirements for application profiles (Appendix A).<a href="#appendix-C.6-1.15" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-C.7">
        <h3 id="name-version-00-to-01">
<a href="#appendix-C.7" class="section-number selfRef">C.7. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.7-1.1">Changed name of 'req_aud' to 'audience' in the Authorization Request (Section 3.1).<a href="#appendix-C.7-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.2">Defined error handling on the KDC (Sections 4.2 and 6.2).<a href="#appendix-C.7-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.3">Updated format of the Key Distribution Response as a whole (Section 4.2).<a href="#appendix-C.7-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.4">Generalized format of 'pub_keys' in the Key Distribution Response (Section 4.2).<a href="#appendix-C.7-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.5">Defined format for the message to request leaving the group (Section 5.2).<a href="#appendix-C.7-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.6">Renewal of individual keying material and methods for group rekeying initiated by the KDC (Section 6).<a href="#appendix-C.7-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.7">CBOR type for node identifiers in 'get_pub_keys' (Section 7.1).<a href="#appendix-C.7-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.8">Added section on parameter identifiers and their CBOR keys (Section 8).<a href="#appendix-C.7-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.9">Added request types for requests to a Join Response (Section 9).<a href="#appendix-C.7-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.10">Extended security considerations (Section 10).<a href="#appendix-C.7-1.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.11">New IANA registries "ACE Groupcomm Key registry", "ACE Groupcomm Profile registry", "ACE Groupcomm Policy registry" and "Sequence Number Synchronization Method registry" (Section 11).<a href="#appendix-C.7-1.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.7-1.12">Added appendix about requirements for application profiles of ACE on group communication (Appendix A).<a href="#appendix-C.7-1.12" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">The following individuals were helpful in shaping this document: Christian Amsuess, Carsten Bormann, Rikard Hoeglund, Ben Kaduk, Watson Ladd, John Mattsson, Daniel Migault, Jim Schaad, Ludwig Seitz, Goeran Selander, Cigdem Sengul and Peter van der Stok.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; by the H2020 project SIFIS-Home (Grant agreement 952652); and by the EIT-Digital High Impact Initiative ACTIVE.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
