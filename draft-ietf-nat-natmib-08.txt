NAT Working Group                                       R. Raghunarayan
INTERNET-DRAFT                                                   N. Pai
Expires May 2004                                    Cisco Systems, Inc.
                                                               R. Rohit
                                                  Mascon Global Limited
                                                                C. Wang
                                                          Bank One Corp
                                                           P. Srisuresh
                                                   Caymas Systems, Inc.
                                                          November 2003


  Definitions of Managed Objects for Network Address Translators (NAT)

                     <draft-ietf-nat-natmib-08.txt>

Status of this Memo 

   This document is an Internet-Draft and is in full conformance with 
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups. Note that 
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six 
   months and may be updated, replaced, or obsoleted by other
   documents at any time. It is inappropriate to use Internet-Drafts
   as reference material or to cite them other than as "work in
   progress."

   The list of current Internet-Drafts can be accessed at 
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at 
   http://www.ietf.org/shadow.html.
   

Copyright Notice 

   Copyright (C), 2003, The Internet Society.  All Rights Reserved. 

Abstract 

   This memo defines an SMIv2 Management Information Base (MIB) for
   device implementing Network Address Translator (NAT) function. 
   This MIB may be used for configuration as well as monitoring of 
   a device capable of NAT function.



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 1]

INTERNET-DRAFT                 NAT MIB                  November 2003

   

Table of Contents 
                                                          
   1    Introduction ................................................2 
   2    The Internet-Standard Management Framework ..................2 
   3    Terminology .................................................3
   4    Overview ....................................................4
   4.1  natInterfaceTable............................................4
   4.2  natAddrMapTable..............................................4
   4.3  Default timeouts, Protocol table and other scalars...........5
   4.4  natAddrBindTable and natAddrPortBindTable....................5
   4.5  natSessionTable..............................................5
   4.6  Notifications................................................6
   4.7  Relation among tables........................................6
   4.8  Configuration via the MIB....................................6
   4.9  Relationship to Interface MIB................................7
   5    Definitions .................................................7
   6    Intellectual Property........................................53
   7    Change History...............................................54
   8    Acknowledgements ............................................54
   9    Security Considerations .....................................56
   10   References ..................................................57
   11   Author's Addresses ..........................................58
   12   Full Copyright Statement.....................................59
   

1.  Introduction 

   This memo defines an SMIv2 Management Information Base (MIB) for
   device implementing NAT function. This may be used 
   for configuration as well as monitoring of a device capable
   of NAT function. Section 2 provides references to the SNMP management
   framework which was used as the basis for the MIB definition. 
   Section 3 describes the terms used throughout the document. Section  
   4 provides an overview of the key objects, their inter-relationship 
   and how the MIB may be used to configure and monitor a NAT device. 
   Lastly, section 5 has the complete NAT MIB definition.

2.  The Internet-Standard Management Framework

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to section 7 of
   RFC 3410 [RFC3410].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).





Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 2]

INTERNET-DRAFT                 NAT MIB                  November 2003


   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI). This memo specifies a MIB
   module that is compliant to the SMIv2, which is described in STD 58,
   RFC 2578 [RFC2578], STD 58, RFC 2579 [RFC2579] and STD 58, RFC 2580
   [RFC2580].


3.  Terminology

   Definitions for majority of the terms used throughout the document 
   may be found in RFC 2663 [RFC2663]. Listed below are additional 
   terms used in the document.

   Symmetric NAT - Symmetric NAT is a variation of Network Address Port 
   Translator (NAPT) in that it does not retain a consistent port bind
   between (private IP address, private port) and (public IP address, 
   public port) across all sessions originating from the same host 
   using the same endpoint tuple of (private IP address, private Port). 
   Instead, it assigns a new public port to each new session, 
   irrespective whether the session uses the same end-point as before 
   or not. A detailed definition for the term "Symmetric NAT" may be 
   found in RFC 3489 [RFC3489].

   Bind - Several variations of the term 'bind' are used throughout 
   the document. Address-bind is a tuple of (Private IP address, 
   Public IP Address) used for translating an IP address end-point in 
   IP packets. Address-port-bind (or simply, Port-bind) is a tuple of 
   (transport protocol, Private IP address, Private port, Public IP
   Address, Public port) used for translating a port end-point tuple
   of (transport protocol, IP address, port). Bind is used to refer to 
   one of address-bind or port-bind. Bind-Mode identifies whether a 
   bind is address-bind or port-bind.
   
   NAT Session - A NAT session is an association between a session 
   as seen in the private realm and a session as seen in the public 
   realm, by virtue of NAT translation. If a session in the private 
   realm were to be represented as (PrivateSrcAddr, PrivateDstAddr,
   TransportProtocol, PrivateSrcPort, PrivateDstPort) and  the
   same session in the public realm were to be represented as
   (PublicSrcAddr, PublicDstAddr, TransportProtocol, PublicSrcPort,
   PublicDstPort), the NAT session will provide the translation
   glue between the two session representations.

   The terms public and private are used throughout the document in 
   the context of networks, while the terms local and global are used 
   when referring to addresses and ports.






Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 3]

INTERNET-DRAFT                 NAT MIB                  November 2003


4.  Overview 

   NAT MIB is configurable on per-interface basis and depends in 
   several parts on the IF-MIB [RFC2863].
   
   NAT MIB requires that an interface for which NAT is configured
   be connected to one of private or public realm. The realm association
   of the interface plays an important role in the definition of address
   maps for the interface. An address map entry identifies the 
   orientation of the session (inbound or outbound to the interface) for
   which the entry may be used for NAT translation. The address map 
   entry also identifies the end-point of the session which must to be
   subject to translation. An SNMP Textual-Convention 
   'NatTranslationEntity' is defined to capture this important 
   characteristic that combines session orientation and applicable
   session endpoint for translation.

   An address map may consist of static or dynamic entries. A static 
   address map entry has a direct one-to-one relationship with binds. 
   NAT will dynamically create binds from a dynamic address map entry.
   A Bind may be used for translation by multiple NAT-sessions using 
   the same end-point. The following subsections define the key objects
   used in NAT MIB, their inter-relationship and how to configure a NAT
   device using the MIB. An interface is connected to the private or 
   the public realm, and will generally have a different address maps 
   for each realm.


4.1.  natInterfaceTable

   The first step in configuring a NAT device is determining the
   interface for which NAT is to be configured. NAT translated packets
   traverse the NAT device by ingressing on a private interface and 
   egressing on a public interface or vice versa. NAT may be configured
   on either of these two interfaces. The next step is identifying the 
   type(s) of NAT service (traditional NAT, twice NAT or bidirectional
   NAT) desired for the interface. Zero or more of these services may 
   be provided on the same interface. natInterfaceTable is defined in 
   the MIB to configure interface specific realm type and the NAT 
   services enabled for the interface. natInterfaceTable is indexed by
   ifIndex and also includes interface specific NAT statistics.


4.2.  natAddrMapTable

   Address maps are key to NAT configuration. Each interface may have
   zero or more address map entries defined. NAT looks up address map
   entries in the order in which they are defined to determine the 
   translation parameters for the first packet of each new session
   traversing the interface. An address map may consist of static or


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 4]

INTERNET-DRAFT                 NAT MIB                  November 2003


   dynamic entries. A static address map entry has a direct one-to-one
   relationship with binds. NAT will dynamically create binds from a 
   dynamic address map entry. Address map entries and their session 
   translation attributes must be selected carefully based on the 
   interface, its realm-type and the type of NAT service desired. 
   Address map entries may be defined in this MIB using natAddrMapTable.
   natAddresMapTable is indexed by the tuple of 
   (ifIndex, natAddrMapIndex). Statistics for the address maps are also
   maintained in the same table.


4.3   Default timeouts, Protocol table and other scalars

   Protocol specific idle NAT session timeouts are defined in 
   DefTimeouts object in the NAT MIB. These are global to the 
   system and are not interface specific. Protocol specific statistics
   are maintained in natProtocolTable. natProtocolTable is indexed by 
   the protocol type.
   
   The scalars, natAddrBindNumberOfEntries and 
   natAddrPortBindNumberOfEntries, hold the number of entries that
   currently exist in the Address bind and the Address-Port bind 
   tables respectively.
     
4.4  natAddrBindTable and natAddrPortBindTable

   Two Bind tables, natAddrBindTable and natAddrPortBindTable, are 
   defined to hold the bind entries. natAddrBindTable contains 
   address-binds and natAddrPortBindTable contains address-port-binds.
   natAddrBindTable is indexed by the tuple of (ifIndex, LocalAddrType,
   LocalAddr). natAddrPortBindTable is indexed by the tuple of 
   (ifIndex, LocalAddrType, LocalAddr, LocalPort, Protocol). 
   These tables also maintain bind specific statistics.

 
4.5  natSessionTable

   NAT session provides the necessary translation glue between two
   session representations of the same end-to-end session. I.e., a
   session as seen in the private realm and the same session as seen
   in the public realm. Session orientation (inbound or outbound) is 
   determined from the orientation of the first packet traversing NAT
   interface. Address map entries and bind entries on the interface 
   determine whether or not a session is subject to NAT translation.
   One or both endpoints of a session may be subject to translation. 
   With the exception of symmetric NAT, all other NAT functions use 
   end-point specific bind to perform individual end-point 
   translations. Multiple NAT sessions would use the same bind so 
   long as they share the same endpoint. Symmetric NAT does not 
   retain a consistent port bind across multiple sessions using the


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 5]

INTERNET-DRAFT                 NAT MIB                  November 2003


   same endpoint. For this reason, the bind identifier for a NAT 
   session in symmetric NAT is set to zero. natSessionTable is indexed
   by the tuple of (ifIndex, natSessionIndex). Statistics for NAT 
   sessions are also maintained in the same table.
 
4.6   Notifications

   natPacketDiscard notifies the end user/manager of
   packets being discarded due to lack of address mappings.

4.7 Relation among tables

   The association between the various NAT tables can be represented
   as follows.


                        Address map
                             |
                             |
                             |
        ----------------------------------------------
       |                                              |
       |                                              |
       |                                              |
   Address Bind                                Address Port Bind
       |                                              |
       |                                              |
       |                                              |
        ----------------------------------------------
                             |
                             |
                             |
                         NAT Session

   All NAT functions, with the exception of symmetric NAT, 
   use bind(s) to provide the glue necessary for a NAT session.
   natSessionPrivateSrcEPBindId and natSessionPrivateDstEPBindId
   objects represent the endpoint binds used by NAT sessions.
  

4.8 Configuration via the MIB

   Entries in Address Bind and Address-Port Bind Tables are 
   derived from the address map table. Therefore, an address
   Bind or an Address-Port Bind Entry must not exist without
   an associated entry in the Address Map table.

   Likewise, NAT session entries are derived from NAT Binds and 
   a NAT session entry must not exist in the Session table 



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 6]

INTERNET-DRAFT                 NAT MIB                  November 2003


   (except in the case of Symmetric NAT) without a corresponding bind. 
   Before deleting a bind entry, all the session entries corresponding
   to the bind entry must be deleted.
  
   A Management station may use the following steps to configure 
   entries in the NAT-MIB:
   
   -  Create an entry in the natInterfaceTable specifying the
      the value of ifIndex as the interface index of the interface 
      on which NAT is being configured. 
      Specify appropriate values, as applicable, for the other 
      objects e.g. natInterfaceRealm, natInterfaceServiceType, in the 
      table.
 
   -  Create one or more address map entries sequentially in reduced
      order of priority in the natAddrMapTable specifying the value of
      ifIndex to be the same for all entries. The ifIndex specified
      would be the same as specified for the entry in the 
      natInterfaceTable.      

   -  To configure NAT for TCP, UDP and ICMP protocols, the 
      management station can set the protocol specific scalars.

   -  The Address Bind and Address-Port Bind Table will have the 
      entries created due to this NAT configuration. A Management 
      Station may also, if deemed necessary, create Address Bind 
      or a Address-Port Bind entry and link those entries to the 
      appropriate address map configured.

4.9  Relationship to Interface MIB 
     
   The natInterfaceTable specifies the NAT configuration attributes
   on each interface. The concept of "interface" is as defined by 
   InterfaceIndex/ifIndex of the IETF Interfaces MIB [IF-MIB].

5.  Definitions

NAT-MIB DEFINITIONS ::= BEGIN

IMPORTS
     MODULE-IDENTITY,
     OBJECT-TYPE,
     Unsigned32,
     Gauge32,
     Counter64,
     TimeTicks,
     mib-2,
     NOTIFICATION-TYPE
             FROM SNMPv2-SMI



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 7]

INTERNET-DRAFT                 NAT MIB                  November 2003


     TimeInterval,
     TEXTUAL-CONVENTION
             FROM SNMPv2-TC 
     MODULE-COMPLIANCE,
     NOTIFICATION-GROUP,
     OBJECT-GROUP
             FROM SNMPv2-CONF
     StorageType,
     RowStatus
             FROM SNMPv2-TC
     ifIndex
             FROM IF-MIB
     SnmpAdminString
             FROM SNMP-FRAMEWORK-MIB
     InetAddressType,
     InetAddress,
     InetPortNumber
             FROM INET-ADDRESS-MIB;

natMIB MODULE-IDENTITY
     LAST-UPDATED "200311060000Z"
     ORGANIZATION "IETF MIDCOM Working Group"
     CONTACT-INFO
              "WG charter:
                 http://www.ietf.org/html.charters/midcom-charter.html
               
               Mailing Lists:
                 General Discussion: midcom@ietf.org
                 To Subscribe: midcom-request@ietf.org 

               Rohit
               Mascon Global Limited
               #59/2 100 ft Ring Road 
               Banashankari II Stage 
               Bangalore 560 070 
               India
               Phone: +91 80 679 6227
               Email: rrohit74@hotmail.com

               Nalinaksh Pai
               Cisco Systems, Inc. 
               Prestige Waterford
               No. 9, Brunton Road
               Bangalore - 560 025
               India
               Phone: +91 80 532 1300 
               Email: npai@cisco.com





Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 8]

INTERNET-DRAFT                 NAT MIB                  November 2003


               Rajiv Raghunarayan 
               Cisco Systems Inc.
               170 West Tasman Drive
               San Jose, CA 95134
               Phone: +1 408 853 9612
               Email: raraghun@cisco.com

               Cliff Wang
               Information Security
               Bank One Corp
               1111 Polaris Pkwy
               Columbus, OH 43240
               Phone: +1 614 213 6117
               Email: cliffwang2000@yahoo.com

               P. Srisuresh
               Caymas Systems, Inc.
               1179-A North McDowell Blvd.
               Petaluma, CA 94954
               Tel: (707) 283-5063
               Email: srisuresh@yahoo.com

             "
     DESCRIPTION
             "This MIB module defines the generic managed objects
              for NAT.

              Copyright (C) The Internet Society (2003). This version
              of this MIB module is part of RFC yyyy;  see the RFC
              itself for full legal notices."
     -- RFC Ed.: replace yyyy with actual RFC number & remove this note
     REVISION     "200311060000Z"  -- 06th Nov. 2003  
     DESCRIPTION
             "Initial version, published as RFC yyyy."
     -- RFC Ed.: replace yyyy with actual RFC number & remove this note

     ::= { mib-2 XXX } -- RFC Ed.: replace XXX with IANA-assigned 
                       -- number & remove this note

natMIBObjects OBJECT IDENTIFIER ::= { natMIB 1 }

NatProtocolType ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION
               "A list of protocols that support the network 
                address translation. Inclusion of the values is
                not intended to imply that those protocols 
                need to be supported. Any change in this 
                TEXTUAL-CONVENTION should also be reflected in 
                the definition of NatProtocolMap which is a


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 9]

INTERNET-DRAFT                 NAT MIB                  November 2003


                BITS representation of this."
       SYNTAX   INTEGER {
                     none (1),  -- not specified
                     other (2), -- none of the following
                     icmp (3),
                     udp (4),
                     tcp (5)
                  }

NatProtocolMap ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION
               "A bitmap of protocol identifiers that support
                the network address translation. Any change
                in this TEXTUAL-CONVENTION should also be 
                reflected in the definition of NatProtocolType." 
       SYNTAX   BITS { 
                  other (0),
                  icmp (1), 
                  udp (2), 
                  tcp (3)
                } 

NatAddrMapId ::= TEXTUAL-CONVENTION
       DISPLAY-HINT "d"
       STATUS current
       DESCRIPTION
               "A unique id that is assigned to each address map 
                by a NAT enabled device."
       SYNTAX   Unsigned32 (1..4294967295)

NatBindIdOrZero ::= TEXTUAL-CONVENTION
       DISPLAY-HINT "d"
       STATUS current
       DESCRIPTION
               "A unique id that is assigned to each bind by
                a NAT enabled device. The bind id will be zero
                in case of a Symmetric NAT."
       SYNTAX   Unsigned32 (0..4294967295)

NatBindId ::= TEXTUAL-CONVENTION
       DISPLAY-HINT "d"
       STATUS current
       DESCRIPTION
               "A unique id that is assigned to each bind by
                a NAT enabled device."
       SYNTAX   Unsigned32 (1..4294967295)





Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 10]

INTERNET-DRAFT                 NAT MIB                  November 2003


NatSessionId ::= TEXTUAL-CONVENTION
       DISPLAY-HINT "d"
       STATUS current
       DESCRIPTION
               "A unique id that is assigned to each session by
                a NAT enabled device."
       SYNTAX   Unsigned32 (1..4294967295)

NatBindMode ::= TEXTUAL-CONVENTION
       STATUS current
       DESCRIPTION
               "An indication whether the bind is
                an address bind or an address-port bind."
       SYNTAX   INTEGER {
                     addressBind (1),
                     addressPortBind (2)
                }

NatAssociationType ::= TEXTUAL-CONVENTION
       STATUS current
       DESCRIPTION
               "An indication whether the association is
                static or dynamic."
       SYNTAX   INTEGER {
                     static (1),
                     dynamic (2)
                }

NatTranslationEntity ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION
               "An indication for the direction of a session for 
                which a) an address map entry, address bind or port
                bind is applicable, and b) the entity (source or
                destination) within the session that is subject to
                translation."
       SYNTAX   BITS {
                  inboundSrcEndPoint (0),
                  outboundDstEndPoint(1),
                  inboundDstEndPoint (2),
                  outboundSrcEndPoint(3)
                }

--
-- Default Values for the NAT Protocol Timers
--

natDefTimeouts OBJECT IDENTIFIER ::= { natMIBObjects 1 }




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 11]

INTERNET-DRAFT                 NAT MIB                  November 2003


--
-- UDP related NAT configuration
--

natUdpDefIdleTimeout OBJECT-TYPE
    SYNTAX     Unsigned32  (1..4294967295)
    UNITS      "seconds"
    MAX-ACCESS read-write
    STATUS     current
    DESCRIPTION
            "The default UDP idle timeout parameter."
    DEFVAL { 300 }
    ::= { natDefTimeouts 1 }
    
--
-- ICMP related NAT configuration
--

natIcmpDefIdleTimeout OBJECT-TYPE
    SYNTAX     Unsigned32  (1..4294967295)
    UNITS      "seconds"
    MAX-ACCESS read-write     
    STATUS     current
    DESCRIPTION
            "The default ICMP idle timeout parameter."
    DEFVAL { 300 }
    ::= { natDefTimeouts 2 }

--
-- Other protocol parameters
--

natOtherDefIdleTimeout OBJECT-TYPE
    SYNTAX     Unsigned32  (1..4294967295)
    UNITS      "seconds"
    MAX-ACCESS read-write
    STATUS     current
    DESCRIPTION
            "The default idle timeout parameter for protocols 
             represented by the value other (2) in 
             NatProtocolType."
    DEFVAL { 60 }
    ::= { natDefTimeouts 3 }
    
--
-- TCP related NAT Timers
--





Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 12]

INTERNET-DRAFT                 NAT MIB                  November 2003


natTcpDefIdleTimeout OBJECT-TYPE
    SYNTAX     Unsigned32  (1..4294967295)
    UNITS      "seconds"
    MAX-ACCESS read-write
    STATUS     current
    DESCRIPTION
            "The default time interval, a NAT session for an 
             established TCP connection is allowed to remain
             valid without any activity on the TCP connection."
    DEFVAL { 86400 }
    ::= { natDefTimeouts 4 }

natTcpDefNegTimeout OBJECT-TYPE
    SYNTAX     Unsigned32  (1..4294967295)
    UNITS      "seconds"    
    MAX-ACCESS read-write
    STATUS     current
    DESCRIPTION
            "The default time interval, a NAT session for a TCP 
             connection which is not in the established state
             is allowed to remain valid without any activity on 
             the TCP connection."
    DEFVAL { 60 }
    ::= { natDefTimeouts 5 }

--
-- The NAT Interface Table
--

natInterfaceTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF NatInterfaceEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
            "This table specifies the attributes for interfaces on a
             device supporting NAT function." 
    ::= { natMIBObjects 2 }
    

natInterfaceEntry OBJECT-TYPE
    SYNTAX      NatInterfaceEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
            "Each entry in the natInterfaceTable holds a set of
             parameters for an interface, instantiated by 
             ifIndex. Therefore, the interface index must have been 
             assigned, according to the procedures applicable to that, 
             before it can be meaningfully used.
             Generally, this means that the interface must exist.


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 13]

INTERNET-DRAFT                 NAT MIB                  November 2003


             When natStorageType is of type nonVolatile, however,
             this may reflect the configuration for an interface whose 
             ifIndex has been assigned but for which the supporting 
             implementation is not currently present."
    INDEX   { ifIndex }
    ::= { natInterfaceTable 1 }

NatInterfaceEntry ::= SEQUENCE {
    natInterfaceRealm            INTEGER,
    natInterfaceServiceType      BITS,
    natInterfaceInTranslates     Counter64,
    natInterfaceOutTranslates    Counter64,
    natInterfaceDiscards         Counter64,
    natInterfaceStorageType      StorageType,
    natInterfaceRowStatus        RowStatus
}

natInterfaceRealm OBJECT-TYPE
    SYNTAX     INTEGER {
                   private (1),
                   public (2)
               }
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object identifies whether this interface is
             connected to the private or the public realm."
    DEFVAL     { public }
    ::= { natInterfaceEntry 1 }

natInterfaceServiceType OBJECT-TYPE
    SYNTAX  BITS {
                basicNat (0),      
                napt (1),
                bidirectionalNat (2),
                twiceNat (3)
            }
    MAX-ACCESS  read-create
    STATUS      current             
    DESCRIPTION
            "An indication of the direction in which new sessions 
             are permitted and the extent of translation done within
             the IP and transport headers."
    ::= { natInterfaceEntry 2 }

natInterfaceInTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 14]

INTERNET-DRAFT                 NAT MIB                  November 2003


            "Number of packets received on this interface that 
             were translated."
    ::= { natInterfaceEntry 3 }

natInterfaceOutTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "Number of translated packets that were sent out this
             interface."
    ::= { natInterfaceEntry 4 }

natInterfaceDiscards OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "Number of packets that had to be rejected/dropped due to
             lack of resources for this interface."
     ::= { natInterfaceEntry 5 }

natInterfaceStorageType OBJECT-TYPE
    SYNTAX      StorageType
    MAX-ACCESS  read-create  
    STATUS      current
    DESCRIPTION
            "The storage type for this conceptual row.
             Conceptual rows having the value 'permanent' 
             need not allow write-access to any columnar objects 
             in the row."  
    REFERENCE
            "Textual Conventions for SMIv2, Section 2."
    DEFVAL { nonVolatile }
    ::= { natInterfaceEntry 6 }

natInterfaceRowStatus OBJECT-TYPE
    SYNTAX      RowStatus
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "The status of this conceptual row.

             Until instances of all corresponding columns are
             appropriately configured, the value of the
             corresponding instance of the natInterfaceRowStatus
             column is 'notReady'.

             In particular, a newly created row cannot be made
             active until the corresponding instance of


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 15]

INTERNET-DRAFT                 NAT MIB                  November 2003


             natInterfaceServiceType has been set.
             
             None of the objects in this row may be modified
             while the value of this object is active(1)."
    REFERENCE
            "Textual Conventions for SMIv2, Section 2."
    ::= { natInterfaceEntry 7 }

--
-- The Address Map Table
--

natAddrMapTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF NatAddrMapEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
            "This table lists address map parameters for NAT."
    ::= { natMIBObjects 3 }

natAddrMapEntry OBJECT-TYPE
    SYNTAX      NatAddrMapEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
            "This entry represents an address map to be used for 
             NAT, and contributes to the dynamic and/or static 
             address mapping tables of the NAT device."
    INDEX   { ifIndex, natAddrMapIndex }
    ::= { natAddrMapTable 1 }

NatAddrMapEntry ::= SEQUENCE {
    natAddrMapIndex                 NatAddrMapId,
    natAddrMapName                  SnmpAdminString,
    natAddrMapEntryType             NatAssociationType,
    natAddrMapTranslationEntity     NatTranslationEntity,
    natAddrMapLocalAddrType         InetAddressType,
    natAddrMapLocalAddrFrom         InetAddress,
    natAddrMapLocalAddrTo           InetAddress,
    natAddrMapLocalPortFrom         InetPortNumber,
    natAddrMapLocalPortTo           InetPortNumber,
    natAddrMapGlobalAddrType        InetAddressType,
    natAddrMapGlobalAddrFrom        InetAddress,
    natAddrMapGlobalAddrTo          InetAddress,
    natAddrMapGlobalPortFrom        InetPortNumber,
    natAddrMapGlobalPortTo          InetPortNumber,
    natAddrMapProtocol              NatProtocolMap,
    natAddrMapInTranslates          Counter64,
    natAddrMapOutTranslates         Counter64,
    natAddrMapDiscards              Counter64,


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 16]

INTERNET-DRAFT                 NAT MIB                  November 2003


    natAddrMapAddrUsed              Gauge32,
    natAddrMapStorageType           StorageType,
    natAddrMapRowStatus             RowStatus
}

natAddrMapIndex  OBJECT-TYPE
    SYNTAX      NatAddrMapId
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
            "Along with ifIndex, this object uniquely
             identifies an entry in the natAddrMapTable. 
             Address map entries are applied in the order 
             specified by natAddrMapIndex."
    ::= { natAddrMapEntry 1 }

natAddrMapName OBJECT-TYPE
    SYNTAX      SnmpAdminString (SIZE(1..32))
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "Name identifying all map entries in the table associated
             with the same interface. All map entries with the same 
             ifIndex will carry the same map name."
    ::= { natAddrMapEntry 2 }

natAddrMapEntryType OBJECT-TYPE
    SYNTAX      NatAssociationType
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This parameter can be used to set up static 
             or dynamic address maps."
    ::= { natAddrMapEntry 3 }

natAddrMapTranslationEntity OBJECT-TYPE
    SYNTAX      NatTranslationEntity
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "The end-point entity (source or destination) in 
             inbound or outbound sessions (i.e., first packets) that 
             may be translated by an address map entry.
             
             Session direction (inbound or outbound) is
             derived from the direction of the first packet
             of a session traversing a NAT interface.
             NAT address (and Transport-ID) maps may be defined
             to effect inbound or outbound sessions.



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 17]

INTERNET-DRAFT                 NAT MIB                  November 2003


             Traditionally, address map for Basic NAT and NAPT are
             configured on a public interface for outbound sessions,
             effecting translation of source end-point. The value of
             this object must be set to outboundSrcEndPoint for 
             those interfaces.

             Alternately, if address map for Basic NAT and NAPT were
             to be configured on a private interface, the desired
             value for this object for the map entries
             would be inboundSrcEndPoint. I.e., effecting translation 
             of source end-point for inbound sessions.

             If TwiceNAT were to be configured on a private interface,
             the desired value for this object for the map entries
             would be a bitmask of inboundSrcEndPoint and 
             inboundDstEndPoint."
    ::= { natAddrMapEntry 4 }

natAddrMapLocalAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION        
            "This object specifies the address type used for
             natAddrMapLocalAddrFrom and natAddrMapLocalAddrTo."
    ::= { natAddrMapEntry 5 }

natAddrMapLocalAddrFrom OBJECT-TYPE
    SYNTAX      InetAddress
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies the first IP address of the range
             of IP addresses mapped by this translation entry."
    ::= { natAddrMapEntry 6 }

natAddrMapLocalAddrTo OBJECT-TYPE
    SYNTAX      InetAddress
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies the last IP address of the range of
             IP addresses mapped by this translation entry. If only
             a single address is being mapped, the value of this object
             is equal to the value of natAddrMapLocalAddrFrom. For a
             static NAT, the number of addresses in the range defined
             by natAddrMapLocalAddrFrom and natAddrMapLocalAddrTo must 
             be equal to the number of addresses in the range defined by
             natAddrMapGlobalAddrFrom and natAddrMapGlobalAddrTo."
    ::= { natAddrMapEntry 7 }


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 18]

INTERNET-DRAFT                 NAT MIB                  November 2003


natAddrMapLocalPortFrom OBJECT-TYPE
    SYNTAX      InetPortNumber
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "If this conceptual row describes a Basic NAT address 
             mapping, then the value of this object must be 0. If 
             this conceptual row describes NAPT, then the value of 
             this object specifies the first port number in the range
             of ports being mapped.  

             If the translation specifies a single port, then
             the value of this object is equal to the value of
             natAddrMapLocalPortTo."
    ::= { natAddrMapEntry 8 }

natAddrMapLocalPortTo OBJECT-TYPE
    SYNTAX      InetPortNumber
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "If this conceptual row describes a Basic NAT address 
             mapping, then the value of this object must be 0. If 
             this conceptual row describes NAPT, then the value of 
             this object specifies the last port number in the range
             of ports being mapped.

             If the translation specifies a single port, then the
             value of this object is equal to the value of
             natAddrMapLocalPortFrom."
    ::= { natAddrMapEntry 9 }

natAddrMapGlobalAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies the address type used for
             natAddrMapGlobalAddrFrom and natAddrMapGlobalAddrTo."
    ::= { natAddrMapEntry 10 }

natAddrMapGlobalAddrFrom OBJECT-TYPE
    SYNTAX      InetAddress
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies the first IP address of the range of
             IP addresses being mapped to."
    ::= { natAddrMapEntry 11 }



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 19]

INTERNET-DRAFT                 NAT MIB                  November 2003


natAddrMapGlobalAddrTo OBJECT-TYPE
    SYNTAX      InetAddress
    MAX-ACCESS  read-create    
    STATUS      current
    DESCRIPTION
            "This object specifies the last IP address of the range of
             IP addresses being mapped to. If only a single address is
             being mapped to, the value of this object is equal to the
             value of natAddrMapGlobalAddrFrom. For a static NAT, the
             number of addresses in the range defined by
             natAddrMapGlobalAddrFrom and natAddrMapGlobalAddrTo must be
             equal to the number of addresses in the range defined by
             natAddrMapLocalAddrFrom and natAddrMapLocalAddrTo."
    ::= { natAddrMapEntry 12 }

natAddrMapGlobalPortFrom OBJECT-TYPE
    SYNTAX      InetPortNumber
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "If this conceptual row describes a Basic NAT address 
             mapping, then the value of this object must be 0. If 
             this conceptual row describes NAPT, then the value of 
             this object specifies the first port number in the range 
             of ports being mapped to. If the translation specifies a 
             single port, then the value of this object is equal to 
             the value natAddrMapGlobalPortTo."
    ::= { natAddrMapEntry 13 }

natAddrMapGlobalPortTo OBJECT-TYPE
    SYNTAX      InetPortNumber
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "If this conceptual row describes a Basic NAT address
             mapping, then the value of this object must be 0. If 
             this conceptual row describes NAPT, then the value of this 
             object specifies the last port number in the range of 
             ports being mapped to. If the translation specifies a 
             single port, then the value of this object is equal to 
             the value of natAddrMapGlobalPortFrom."
    ::= { natAddrMapEntry 14 }

natAddrMapProtocol OBJECT-TYPE
    SYNTAX      NatProtocolMap
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies a bitmap of protocol identifiers."
    ::= { natAddrMapEntry 15 }


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 20]

INTERNET-DRAFT                 NAT MIB                  November 2003


natAddrMapInTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of inbound packets, pertaining to this address
             map entry, that were translated."
    ::= { natAddrMapEntry 16 }

natAddrMapOutTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of outbound packets, pertaining to this
             address map entry, that were translated."
    ::= { natAddrMapEntry 17 }

natAddrMapDiscards OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of packets, pertaining to this address map
             entry, that were dropped due to lack of addresses in the
             address pool identified by this address map. The value of
             this object must always be zero in case of static
             address map."
    ::= { natAddrMapEntry 18 }

natAddrMapAddrUsed OBJECT-TYPE
    SYNTAX     Gauge32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of addresses, pertaining to this address map,
             that are currently being used from the NAT pool. 
             The value of this object must always be zero in case of 
             static address map." 
    ::= { natAddrMapEntry 19 }
    
natAddrMapStorageType OBJECT-TYPE
    SYNTAX      StorageType
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "The storage type for this conceptual row.
             Conceptual rows having the value 'permanent' 
             need not allow write-access to any columnar objects 
             in the row."


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 21]

INTERNET-DRAFT                 NAT MIB                  November 2003


    REFERENCE
            "Textual Conventions for SMIv2, Section 2."
    DEFVAL { nonVolatile }
    ::= { natAddrMapEntry 20 }

natAddrMapRowStatus OBJECT-TYPE
    SYNTAX      RowStatus
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "The status of this conceptual row.

             Until instances of all corresponding columns are
             appropriately configured, the value of the
             corresponding instance of the natAddrMapRowStatus
             column is 'notReady'.

             None of the objects in this row may be modified
             while the value of this object is active(1)." 
    REFERENCE
            "Textual Conventions for SMIv2, Section 2."
    ::= { natAddrMapEntry 21 }

--
-- Address Bind section
--

natAddrBindNumberOfEntries OBJECT-TYPE
    SYNTAX     Gauge32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "This object maintains a count of the number of entries
             that currently exist in the natAddrBindTable."
    ::= { natMIBObjects 4 }

--
-- The NAT Address BIND Table
--

natAddrBindTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF NatAddrBindEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "This table holds information about the currently
             active NAT BINDs."
    ::= { natMIBObjects 5 }




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 22]

INTERNET-DRAFT                 NAT MIB                  November 2003


natAddrBindEntry OBJECT-TYPE
    SYNTAX     NatAddrBindEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "Each entry in this table holds information about 
             an active address BIND. These entries are lost
             upon agent restart."
    INDEX   { ifIndex, natAddrBindLocalAddrType, natAddrBindLocalAddr }
    ::= { natAddrBindTable 1 }

NatAddrBindEntry ::= SEQUENCE {
    natAddrBindLocalAddrType        InetAddressType,
    natAddrBindLocalAddr            InetAddress,
    natAddrBindGlobalAddrType       InetAddressType,
    natAddrBindGlobalAddr           InetAddress,
    natAddrBindId                   NatBindId,
    natAddrBindTranslationEntity    NatTranslationEntity,
    natAddrBindType                 NatAssociationType,
    natAddrBindMapIndex             NatAddrMapId,
    natAddrBindSessions             Gauge32,
    natAddrBindMaxIdleTime          TimeInterval,
    natAddrBindCurrentIdleTime      TimeTicks,
    natAddrBindInTranslates         Counter64,
    natAddrBindOutTranslates        Counter64,
    natAddrBindRowStatus            RowStatus
}

natAddrBindLocalAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  not-accessible 
    STATUS      current
    DESCRIPTION
            "This object specifies the address type used for
             natAddrBindLocalAddr."
    ::= { natAddrBindEntry 1 }

natAddrBindLocalAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "This object represents the private-realm specific network
             layer address, which maps to the public-realm address
             represented by natAddrBindGlobalAddr." 
    ::= { natAddrBindEntry 2 }
    
natAddrBindGlobalAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  read-create


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 23]

INTERNET-DRAFT                 NAT MIB                  November 2003


    STATUS      current
    DESCRIPTION
            "This object specifies the address type used for
             natAddrBindGlobalAddr."
    ::= { natAddrBindEntry 3 }

natAddrBindGlobalAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object represents the public-realm network layer
             address that maps to the private-realm network layer
             address represented by natAddrBindLocalAddr." 
    ::= { natAddrBindEntry 4 }

natAddrBindId OBJECT-TYPE
    SYNTAX     NatBindId
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "This object represents a bind id that is dynamically
             assigned to each bind by a NAT enabled device. Each 
             bind is represented by a bind id that is
             unique across both, the natAddrBindTable and the 
             natAddrPortBindTable."
    ::= { natAddrBindEntry 5 }

natAddrBindTranslationEntity OBJECT-TYPE
    SYNTAX     NatTranslationEntity
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object represents the direction of sessions
             for which this bind is applicable and the endpoint entity
             (source or destination) within the sessions that is
             subject to translation using the BIND.

             Orientation of the bind can be a superset of
             translationEntity of the address map entry which
             forms the basis for this bind.

             For example, if the translationEntity of an
             address map entry is outboundSrcEndPoint, the
             translationEntity of a bind derived from this
             map entry may either be outboundSrcEndPoint or
             it may be bidirectional (a bitmask of 
             outboundSrcEndPoint and inboundDestEndPoint)."
    ::= { natAddrBindEntry 6 }



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 24]

INTERNET-DRAFT                 NAT MIB                  November 2003


natAddrBindType OBJECT-TYPE
    SYNTAX     NatAssociationType
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object indicates whether the bind is static or
             dynamic."
    ::= { natAddrBindEntry 7 }

natAddrBindMapIndex OBJECT-TYPE
    SYNTAX     NatAddrMapId
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object is a pointer to the natAddrMapTable entry
             (and the parameters of that entry) which was used in 
             creating this BIND. This object, in conjunction with the
             ifIndex (which identifies a unique addrMapName) points to 
             a unique entry in the natAddrMapTable. If the bind 
             is being created by the Management Station, then it 
             should set the value for this object to point to an 
             existing address map entry. An attempt to set this object
             to a nonexistent address map entry will result in an 
             inconsistentValue error." 
    ::= { natAddrBindEntry 8 }

natAddrBindSessions OBJECT-TYPE
    SYNTAX     Gauge32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "Number of sessions currently using this BIND."
    ::= { natAddrBindEntry 9 }
    
natAddrBindMaxIdleTime OBJECT-TYPE
    SYNTAX     TimeInterval
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object indicates the maximum time for 
             which this bind can be idle with no sessions
             attached to it.

             The value of this object is of relevance only for 
             dynamic NAT."
    ::= { natAddrBindEntry 10 }
    





Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 25]

INTERNET-DRAFT                 NAT MIB                  November 2003


natAddrBindCurrentIdleTime OBJECT-TYPE
    SYNTAX     TimeTicks
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "At any given instance of time, this object indicates the
             time that this bind has been idle with no sessions
             attached to it.

             The value of this object is of relevance only for 
             dynamic NAT."
    ::= { natAddrBindEntry 11 }
    
natAddrBindInTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of inbound packets that were successfully
             translated using this bind entry."
    ::= { natAddrBindEntry 12 }

natAddrBindOutTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of outbound packets that were successfully
             translated using this bind entry."
    ::= { natAddrBindEntry 13 }

natAddrBindRowStatus OBJECT-TYPE
    SYNTAX      RowStatus
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "The status of this conceptual row.

             Until instances of all corresponding columns are
             appropriately configured, the value of the
             corresponding instance of the natAddrBindRowStatus
             column is 'notReady'.

             None of the writable objects except 
             natAddrBindMaxIdleTime in this row may be modified 
             while the value of this object is active(1)."
    REFERENCE
            "Textual Conventions for SMIv2, Section 2."
    ::= { natAddrBindEntry 14 }



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 26]

INTERNET-DRAFT                 NAT MIB                  November 2003


--
-- Address-Port Bind section
--

natAddrPortBindNumberOfEntries OBJECT-TYPE
    SYNTAX     Gauge32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "This object maintains a count of the number of entries
             that currently exist in the natAddrPortBindTable."
    ::= { natMIBObjects 6 }

--
-- The NAT Address-Port Bind Table
--

natAddrPortBindTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF NatAddrPortBindEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "This table holds information about the currently
             active NAPT BINDs."
    ::= { natMIBObjects 7 }

natAddrPortBindEntry OBJECT-TYPE
    SYNTAX     NatAddrPortBindEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "Each entry in the this table holds information
             about a NAPT bind that is currently active.
             These entries are lost upon agent restart."
    INDEX   { ifIndex, natAddrPortBindLocalAddrType, 
              natAddrPortBindLocalAddr, natAddrPortBindLocalPort,
              natAddrPortBindProtocol }
    ::= { natAddrPortBindTable 1 }

NatAddrPortBindEntry ::= SEQUENCE {
    natAddrPortBindLocalAddrType        InetAddressType,
    natAddrPortBindLocalAddr            InetAddress,
    natAddrPortBindLocalPort            InetPortNumber,
    natAddrPortBindProtocol             NatProtocolType,
    natAddrPortBindGlobalAddrType       InetAddressType,
    natAddrPortBindGlobalAddr           InetAddress,
    natAddrPortBindGlobalPort           InetPortNumber,
    natAddrPortBindId                   NatBindId,
    natAddrPortBindTranslationEntity    NatTranslationEntity,



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 27]

INTERNET-DRAFT                 NAT MIB                  November 2003


    natAddrPortBindType                 NatAssociationType,
    natAddrPortBindMapIndex             NatAddrMapId,
    natAddrPortBindSessions             Gauge32,
    natAddrPortBindMaxIdleTime          TimeInterval,
    natAddrPortBindCurrentIdleTime      TimeTicks,
    natAddrPortBindInTranslates         Counter64,
    natAddrPortBindOutTranslates        Counter64,
    natAddrPortBindRowStatus            RowStatus
}

natAddrPortBindLocalAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
            "This object specifies the address type used for
             natAddrPortBindLocalAddr."
    ::= { natAddrPortBindEntry 1 }

natAddrPortBindLocalAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "This object represents the private-realm specific network
             layer address which, in conjunction with
             natAddrPortBindLocalPort, maps to the public-realm
             network layer address and transport id represented by
             natAddrPortBindGlobalAddr and natAddrPortBindGlobalPort
             respectively." 
    ::= { natAddrPortBindEntry 2 }

natAddrPortBindLocalPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "When the protocol is set to TCP or UDP, this object 
             represents the private-realm specific port number. 
             When the protocol is set to ICMP, a bind is created
             only for query/response type of ICMP messages such as
             ICMP echo, Timestamp and Information request messages,
             and the object represents the private-realm specific 
             identifier in the ICMP message, as defined in 
             RFC 792[RFC792] for ICMPv4 and RFC 2463 [RFC2463] for 
             ICMPv6. This object together with natAddrPortBindProtocol,
             natAddrPortBindLocalAddrType and natAddrPortBindLocalAddr
             constitutes a session endpoint in the private realm. A




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 28]

INTERNET-DRAFT                 NAT MIB                  November 2003


             bind entry binds a private realm specific endpoint to a
             public realm specific endpoint, as represented by the
             tuple of (natAddPortBindGlobalPort, 
             natAddrPortBindProtocol, natAddrPortBindGlobalAddrType
             and natAddrPortBindGlobalAddr)."
    ::= { natAddrPortBindEntry 3 }

natAddrPortBindProtocol OBJECT-TYPE
    SYNTAX      NatProtocolType
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
            "This object specifies a protocol identifier. If the
             value of this object is none(1), then this bind entry
             applies to all IP traffic. Any other value of this object
             specifies the class of IP traffic to which this BIND
             applies."
    ::= { natAddrPortBindEntry 4 }

natAddrPortBindGlobalAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies the address type used for
             natAddrPortBindGlobalAddr."
    ::= { natAddrPortBindEntry 5 }

natAddrPortBindGlobalAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object represents the public-realm specific network
             layer address that, in conjunction with
             natAddrPortBindGlobalPort, maps to the private-realm
             network layer address and transport id represented by
             natAddrPortBindLocalAddr and natAddrPortBindLocalPort
             respectively."
    ::= { natAddrPortBindEntry 6 }

natAddrPortBindGlobalPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "When the protocol is set to TCP or UDP, this object
             represents the public-realm specific port number. 




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 29]

INTERNET-DRAFT                 NAT MIB                  November 2003


             When the protocol is set to ICMP, a bind is created only
             for query/response type of ICMP messages such as ICMP 
             echo, Timestamp and Information request messages, and
             the object represents the public-realm specific identifier
             in the ICMP message, as defined in RFC 792[RFC792] 
             for ICMPv4 and RFC 2463[RFC2463] for ICMPv6. This object 
             together with natAddrPortBindProtocol, 
             natAddrPortBindGlobalAddrType and natAddrPortBindGlobalAddr
             constitutes a session endpoint in the public realm. A bind
             entry binds a public realm specific endpoint to a private
             realm specific endpoint, as represented by the tuple of
             ( natAddPortBindLocalPort, natAddrPortBindProtocol, 
               natAddrPortBindLocalAddrType and 
               natAddrPortBindLocalAddr)."
    ::= { natAddrPortBindEntry 7 }

natAddrPortBindId OBJECT-TYPE
    SYNTAX     NatBindId
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "This object represents a bind id that is dynamically
             assigned to each bind by a NAT enabled device. Each 
             bind is represented by a unique bind id across both, 
             the natAddrBindTable and the natAddrPortBindTable."
    ::= { natAddrPortBindEntry 8 }

natAddrPortBindTranslationEntity OBJECT-TYPE
    SYNTAX     NatTranslationEntity
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object represents the direction of sessions
             for which this bind is applicable and the entity
             (source or destination) within the sessions that is
             subject to translation using the BIND.

             Orientation of the bind can be a superset of
             translationEntity of the address map entry which
             forms the basis for this bind.

             For example, if the translationEntity of an
             address map entry is outboundSrcEndPoint, the
             translationEntity of a bind derived from this
             map entry may either be outboundSrcEndPoint or
             it may be bidirectional (a bitmask of 
             outboundSrcEndPoint and inboundDestEndPoint)."
    ::= { natAddrPortBindEntry 9 }




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 30]

INTERNET-DRAFT                 NAT MIB                  November 2003


natAddrPortBindType OBJECT-TYPE
    SYNTAX     NatAssociationType
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object indicates whether the bind is static or
             dynamic."
    ::= { natAddrPortBindEntry 10 }

natAddrPortBindMapIndex OBJECT-TYPE
    SYNTAX     NatAddrMapId
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object is a pointer to the natAddrMapTable entry
             (and the parameters of that entry) which was used in 
             creating this BIND. This object, in conjunction with the
             ifIndex (which identifies a unique addrMapName) points to 
             a unique entry in the natAddrMapTable. If the bind 
             is being created by the Management Station, then it 
             should set the value for this object to point to an 
             existing address map entry. An attempt to set this object
             to a nonexistent address map entry will result in an 
             inconsistentValue error."
    ::= { natAddrPortBindEntry 11 }

natAddrPortBindSessions OBJECT-TYPE
    SYNTAX     Gauge32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "Number of sessions currently using this BIND."
    ::= { natAddrPortBindEntry 12 }

natAddrPortBindMaxIdleTime OBJECT-TYPE
    SYNTAX     TimeInterval
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object indicates the maximum time for 
             which this bind can be idle with no sessions
             attached to it.              
             The value of this object is of relevance
             only for dynamic NAT."
    ::= { natAddrPortBindEntry 13 }
        
natAddrPortBindCurrentIdleTime OBJECT-TYPE
    SYNTAX     TimeTicks
    MAX-ACCESS read-only
    STATUS     current


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 31]

INTERNET-DRAFT                 NAT MIB                  November 2003


    DESCRIPTION
            "At any given instance of time, this object indicates the
             time that this bind has been idle with no sessions
             attached to it. 
              
             The value of this object is of relevance
             only for dynamic NAT."
    ::= { natAddrPortBindEntry 14 }

natAddrPortBindInTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of inbound packets that were translated as per
             this bind entry."
    ::= { natAddrPortBindEntry 15 }

natAddrPortBindOutTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of outbound packets that were translated as per
             this bind entry."
    ::= { natAddrPortBindEntry 16 }

natAddrPortBindRowStatus OBJECT-TYPE
    SYNTAX      RowStatus
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "The status of this conceptual row.

             Until instances of all corresponding columns are
             appropriately configured, the value of the
             corresponding instance of the natAddrBindRowStatus
             column is 'notReady'.

             None of the writable objects except 
             natAddrPortBindMaxIdleTime in this row may be 
             modified while the value of this object is active(1)."
    REFERENCE
            "Textual Conventions for SMIv2, Section 2."
    ::= { natAddrPortBindEntry 17 }







Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 32]

INTERNET-DRAFT                 NAT MIB                  November 2003


--
-- The Session Table
--

natSessionTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF NatSessionEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "The (conceptual) table containing one entry for each
             NAT session currently active on this NAT device."
    ::= { natMIBObjects 8 }

natSessionEntry OBJECT-TYPE
    SYNTAX     NatSessionEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "An entry (conceptual row) containing information
             about an active NAT session on this NAT device.
             These entries are lost upon agent restart."
    INDEX   { ifIndex, natSessionIndex }
    ::= { natSessionTable 1 }

NatSessionEntry ::= SEQUENCE {
    natSessionIndex                        NatSessionId,
    natSessionPrivateSrcEPBindId           NatBindIdOrZero,
    natSessionPrivateSrcEPBindMode         NatBindMode,
    natSessionPrivateDstEPBindId           NatBindId,
    natSessionPrivateDstEPBindMode         NatBindMode,  
    natSessionDirection                    INTEGER,
    natSessionUpTime                       TimeTicks,
    natSessionAddrMapIndex                 NatAddrMapId,
    natSessionProtocolType                 NatProtocolType,
    natSessionPrivateAddrType              InetAddressType,
    natSessionPrivateSrcAddr               InetAddress,
    natSessionPrivateSrcPort               InetPortNumber,
    natSessionPrivateDstAddr               InetAddress,
    natSessionPrivateDstPort               InetPortNumber,
    natSessionPublicAddrType               InetAddressType,
    natSessionPublicSrcAddr                InetAddress,
    natSessionPublicSrcPort                InetPortNumber,
    natSessionPublicDstAddr                InetAddress,
    natSessionPublicDstPort                InetPortNumber,
    natSessionMaxIdleTime                  TimeInterval,
    natSessionCurrentIdleTime              TimeTicks,
    natSessionInTranslates                 Counter64,
    natSessionOutTranslates                Counter64,
    natSessionRowStatus                    RowStatus
}


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 33]

INTERNET-DRAFT                 NAT MIB                  November 2003


natSessionIndex OBJECT-TYPE
    SYNTAX     NatSessionId
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "The session ID for this NAT session."
    ::= { natSessionEntry 1 }

natSessionPrivateSrcEPBindId OBJECT-TYPE
    SYNTAX     NatBindIdOrZero
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The bind id associated between private and public
             source end points. In the case of Symmetric-NAT, 
             this would be set to zero."
    ::= { natSessionEntry 2 }

natSessionPrivateSrcEPBindMode OBJECT-TYPE
    SYNTAX     NatBindMode
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object indicates whether the bind indicated
             by the object natSessionPrivateSrcEPBindId
             is an address bind or an address-port bind."
    ::= { natSessionEntry 3 }

natSessionPrivateDstEPBindId OBJECT-TYPE
    SYNTAX     NatBindId
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The bind id associated between private and public
             destination end points."
    ::= { natSessionEntry 4 }

natSessionPrivateDstEPBindMode OBJECT-TYPE
    SYNTAX     NatBindMode
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object indicates whether the bind indicated
             by the object natSessionPrivateDstEPBindId
             is an address bind or an address-port bind."
    ::= { natSessionEntry 5 }
    





Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 34]

INTERNET-DRAFT                 NAT MIB                  November 2003


natSessionDirection OBJECT-TYPE
    SYNTAX     INTEGER {
                   inbound (1),
                   outbound (2)
               }
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION    
            "The direction of this session with respect to the
             local network. 'inbound' indicates that this session
             was initiated from the public network into the private
             network. 'outbound' indicates that this session was
             initiated from the private network into the public
             network."    
    ::= { natSessionEntry 6 }

natSessionUpTime OBJECT-TYPE
    SYNTAX     TimeTicks
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The up time of this session in one-hundredths of a
             second."
    ::= { natSessionEntry 7 }

natSessionAddrMapIndex OBJECT-TYPE
    SYNTAX     NatAddrMapId
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "This object is a pointer to the natAddrMapTable entry
             (and the parameters of that entry) which was used in 
             creating this session. This object, in conjunction with
             the ifIndex (which identifies a unique addrMapName) points 
             to a unique entry in the natAddrMapTable. If the session 
             is being created by the Management Station, then it 
             should set the value for this object to point to an 
             existing address map entry. An attempt to set this object 
             to a nonexistent address map entry will result in an 
             inconsistentValue error."
    ::= { natSessionEntry 8 }

natSessionProtocolType OBJECT-TYPE
    SYNTAX     NatProtocolType 
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The protocol type of this session."
    ::= { natSessionEntry 9 }



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 35]

INTERNET-DRAFT                 NAT MIB                  November 2003


natSessionPrivateAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies the address type used for
             natSessionPrivateAddr."
    ::= { natSessionEntry 10 }

natSessionPrivateSrcAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The source IP address of the session endpoint that
             lies in the private network." 
    ::= { natSessionEntry 11 }

natSessionPrivateSrcPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "When the protocol is set to TCP or UDP, this object
             represents the source port in the first packet of session
             while in private-realm. When the protocol is set to ICMP, 
             a NAT session is created only for query/response type of
             ICMP messages such as ICMP echo, Timestamp and Information
             request messages, and this object represents the 
             private-realm specific identifier in the ICMP message,
             as defined in RFC 792[RFC792] for ICMPv4 and 
             RFC 2463[RFC2463] for ICMPv6.
            
             The value of this object must be 0 when ports are not 
             involved in the translation."
    ::= { natSessionEntry 12 }

natSessionPrivateDstAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The destination IP address of the session endpoint that
             lies in the private network."
    ::= { natSessionEntry 13 }
    






Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 36]

INTERNET-DRAFT                 NAT MIB                  November 2003


natSessionPrivateDstPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "When the protocol is set to TCP or UDP, this object 
             represents the destination port in the first packet
             of session while in private-realm. When the protocol
             is set to ICMP, this object is not relevant and should
             be set to zero."
    ::= { natSessionEntry 14 }    

natSessionPublicAddrType OBJECT-TYPE
    SYNTAX      InetAddressType
    MAX-ACCESS  read-create
    STATUS      current
    DESCRIPTION
            "This object specifies the address type used for
             natSessionPublicAddr."
    ::= { natSessionEntry 15 }

natSessionPublicSrcAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The source IP address of the session endpoint that
             lies in the public network." 
    ::= { natSessionEntry 16 }

natSessionPublicSrcPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "When the protocol is set to TCP or UDP, this object
             represents the source port in the first packet of 
             session while in public-realm. When the protocol is set 
             to ICMP, a NAT session is created only for query/response
             type of ICMP messages such as ICMP echo, Timestamp and 
             Information request messages, and this object represents
             the public-realm specific identifier in the ICMP message,
             as defined in RFC 792 [RFC792] for ICMPv4 and 
             RFC 2463[RFC2463] for ICMPv6. The value of this object
             must be 0 when ports are not involved in the translation."
    ::= { natSessionEntry 17 }






Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 37]

INTERNET-DRAFT                 NAT MIB                  November 2003


natSessionPublicDstAddr OBJECT-TYPE
    SYNTAX     InetAddress
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The destination IP address of the session endpoint that
             lies in the public network."
    ::= { natSessionEntry 18 }
    
natSessionPublicDstPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "When the protocol is set to TCP or UDP, this object 
             represents the destination port in the first packet of
             session while in public-realm. When the protocol is
             set to ICMP, this object is not relevant for translation
             and should be set to 0."
    ::= { natSessionEntry 19 }    

natSessionMaxIdleTime OBJECT-TYPE
    SYNTAX     TimeInterval
    MAX-ACCESS read-create
    STATUS     current
    DESCRIPTION
            "The max time for which this session can be idle 
             without detecting a packet." 
    ::= { natSessionEntry 20 }
    
natSessionCurrentIdleTime OBJECT-TYPE
    SYNTAX     TimeTicks
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The time since a packet belonging to this session was 
            last detected." 
    ::= { natSessionEntry 21 }

natSessionInTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of inbound packets that were translated for
             this session."
    ::= { natSessionEntry 22 }





Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 38]

INTERNET-DRAFT                 NAT MIB                  November 2003


natSessionOutTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of outbound packets that were translated for 
             this session."
    ::= { natSessionEntry 23 }

natSessionRowStatus OBJECT-TYPE
    SYNTAX       RowStatus
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION
            "The status of this conceptual row.

             Until instances of all corresponding columns are
             appropriately configured, the value of the
             corresponding instance of the natAddrMapRowStatus
             column is 'notReady'.
         
             None of the writable objects except 
             natSessionMaxIdleTime in this row may be modified 
             while the value of this object is active(1)."
    REFERENCE
            "Textual Conventions for SMIv2, Section 2."
    ::= { natSessionEntry 24 }


--
-- The Protocol table
--

natProtocolTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF NatProtocolEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "The (conceptual) table containing per protocol NAT
             parameters."
    ::= { natMIBObjects 9 }

natProtocolEntry OBJECT-TYPE
    SYNTAX     NatProtocolEntry
    MAX-ACCESS not-accessible
    STATUS     current






Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 39]

INTERNET-DRAFT                 NAT MIB                  November 2003


    DESCRIPTION
            "An entry (conceptual row) containing NAT parameters
             pertaining to a particular protocol."
    INDEX   { natProtocol }
    ::= { natProtocolTable 1 }

NatProtocolEntry ::= SEQUENCE {
    natProtocol                 NatProtocolType,
    natProtocolInTranslates     Counter64,
    natProtocolOutTranslates    Counter64,
    natProtocolDiscards         Counter64
}

natProtocol    OBJECT-TYPE
    SYNTAX     NatProtocolType
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
            "This object represents the protocol pertaining to which
             parameters are reported."
    ::= { natProtocolEntry 1 }

natProtocolInTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of inbound packets, pertaining to the protocol
             identified by natProtocol, that underwent NAT."
    ::= { natProtocolEntry 2 }

natProtocolOutTranslates OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
            "The number of outbound packets, pertaining to the protocol
             identified by natProtocol, that underwent NAT."
    ::= { natProtocolEntry 3 }

natProtocolDiscards OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current








Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 40]

INTERNET-DRAFT                 NAT MIB                  November 2003


    DESCRIPTION
            "The number of packets, pertaining to the protocol
             identified by natProtocol, that had to be
             rejected/dropped due to lack of resources. These
             rejections could be due to session timeout, resource
             unavailability, lack of address space etc."
     ::= { natProtocolEntry 4 }

--
-- Notifications section
-- 

natMIBNotifications OBJECT IDENTIFIER ::= { natMIB 0 }

--
-- Notifications
--

natPacketDiscard NOTIFICATION-TYPE
    OBJECTS { ifIndex }
    STATUS  current
    DESCRIPTION
            "This notification is generated whenever packets are
             discarded e.g. due to lack of mapping space when we run
             out of address/ports in case of Basic NAT/NAPT 
             respectively.

             An agent should not generate more than one
             natPacketDiscard 'notification-events' in a given time
             interval (five seconds is the suggested default). A
             'notification-event' is the transmission of a single 
             trap or inform PDU to a list of notification
             destinations.

             If additional NAT packets are discarded within the
             throttling period, then notification-events for these
             changes should be suppressed by the agent until the
             current throttling period expires.  At the end of a
             throttling period, one notification-event should be
             generated if any NAT packet was discarded since the
             start of the throttling period. In such a case, another
             throttling period is started right away."
    ::= { natMIBNotifications 1 }

--
-- Conformance information. 
-- 

natMIBConformance OBJECT IDENTIFIER ::= { natMIB 2 }  



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 41]

INTERNET-DRAFT                 NAT MIB                  November 2003


natMIBGroups      OBJECT IDENTIFIER ::= { natMIBConformance 1 }
natMIBCompliances OBJECT IDENTIFIER ::= { natMIBConformance 2 }

--
-- Units of conformance
--

natConfigGroup OBJECT-GROUP
    OBJECTS { natInterfaceRealm,
              natInterfaceServiceType,
              natInterfaceStorageType,
              natInterfaceRowStatus,
              natAddrMapName,
              natAddrMapEntryType,
              natAddrMapTranslationEntity,
              natAddrMapLocalAddrType,
              natAddrMapLocalAddrFrom,
              natAddrMapLocalAddrTo,
              natAddrMapLocalPortFrom,
              natAddrMapLocalPortTo,
              natAddrMapGlobalAddrType,
              natAddrMapGlobalAddrFrom,
              natAddrMapGlobalAddrTo,
              natAddrMapGlobalPortFrom,
              natAddrMapGlobalPortTo,
              natAddrMapProtocol,
              natAddrMapStorageType,
              natAddrMapRowStatus,
              natUdpDefIdleTimeout,
              natIcmpDefIdleTimeout,
              natOtherDefIdleTimeout,
              natTcpDefIdleTimeout,
              natTcpDefNegTimeout } 
    STATUS  current
    DESCRIPTION
            "A collection of configuration-related information
             required to support management of devices supporting
             NAT."
    ::= { natMIBGroups 1 }

natTranslationGroup OBJECT-GROUP
    OBJECTS { natAddrBindNumberOfEntries,
              natAddrBindGlobalAddrType,
              natAddrBindGlobalAddr,
              natAddrBindId,
              natAddrBindTranslationEntity,
              natAddrBindType,
              natAddrBindMapIndex,
              natAddrBindSessions,
              natAddrBindMaxIdleTime,


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 42]

INTERNET-DRAFT                 NAT MIB                  November 2003


              natAddrBindCurrentIdleTime,
              natAddrBindInTranslates,
              natAddrBindOutTranslates,
              natAddrBindRowStatus,
              natAddrPortBindNumberOfEntries,
              natAddrPortBindGlobalAddrType,
              natAddrPortBindGlobalAddr,
              natAddrPortBindGlobalPort,
              natAddrPortBindId,
              natAddrPortBindTranslationEntity,
              natAddrPortBindType,
              natAddrPortBindMapIndex,
              natAddrPortBindSessions,
              natAddrPortBindMaxIdleTime,
              natAddrPortBindCurrentIdleTime,
              natAddrPortBindInTranslates,
              natAddrPortBindOutTranslates,
              natAddrPortBindRowStatus,
              natSessionPrivateSrcEPBindId,
              natSessionPrivateSrcEPBindMode,
              natSessionPrivateDstEPBindId,
              natSessionPrivateDstEPBindMode,
              natSessionDirection,
              natSessionUpTime,
              natSessionAddrMapIndex,
              natSessionProtocolType,
              natSessionPrivateAddrType,
              natSessionPrivateSrcAddr,
              natSessionPrivateSrcPort,
              natSessionPrivateDstAddr,
              natSessionPrivateDstPort,
              natSessionPublicAddrType,
              natSessionPublicSrcAddr,
              natSessionPublicSrcPort,
              natSessionPublicDstAddr,
              natSessionPublicDstPort,
              natSessionMaxIdleTime,
              natSessionCurrentIdleTime,
              natSessionInTranslates,
              natSessionOutTranslates,
              natSessionRowStatus }
    STATUS  current
    DESCRIPTION
            "A collection of BIND-related objects required to support
             management of devices supporting NAT."
    ::= { natMIBGroups 2 }






Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 43]

INTERNET-DRAFT                 NAT MIB                  November 2003


natStatsInterfaceGroup OBJECT-GROUP
    OBJECTS { natInterfaceInTranslates,
              natInterfaceOutTranslates,
              natInterfaceDiscards }
    STATUS  current
    DESCRIPTION
            "A collection of NAT statistics associated with the 
             interface on which NAT is configured, to aid 
             troubleshooting/monitoring of the NAT operation."    
    ::= { natMIBGroups 3 }

natStatsProtocolGroup OBJECT-GROUP
    OBJECTS { natProtocolInTranslates,
              natProtocolOutTranslates,
              natProtocolDiscards }
    STATUS  current
    DESCRIPTION
            "A collection of protocol specific NAT statistics,
             to aid troubleshooting/monitoring of NAT operation."
    ::= { natMIBGroups 4 }

natStatsAddrMapGroup OBJECT-GROUP
    OBJECTS { natAddrMapInTranslates,
              natAddrMapOutTranslates,
              natAddrMapDiscards,
              natAddrMapAddrUsed }
    STATUS  current
    DESCRIPTION
            "A collection of address map specific NAT statistics,
             to aid troubleshooting/monitoring of NAT operation."
    ::= { natMIBGroups 5 }

natMIBNotificationGroup NOTIFICATION-GROUP
    NOTIFICATIONS { natPacketDiscard }
    STATUS        current
    DESCRIPTION
            "A collection of notifications which are generated by
            devices supporting this MIB."
    ::= { natMIBGroups 6 }
    
--
-- Compliance statements
--

natMIBFullCompliance MODULE-COMPLIANCE
    STATUS  current






Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 44]

INTERNET-DRAFT                 NAT MIB                  November 2003


    DESCRIPTION
            "When this MIB is implemented with support for 
             read-create, then such an implementation can claim 
             full compliance. Such devices can then be both 
             monitored and configured with this MIB."
    MODULE  -- this module
      MANDATORY-GROUPS { natConfigGroup, natTranslationGroup,
                         natStatsInterfaceGroup }  

      GROUP       natStatsProtocolGroup
      DESCRIPTION
               "This group is optional."
      GROUP       natStatsAddrMapGroup
      DESCRIPTION
               "This group is optional."
      GROUP       natMIBNotificationGroup
      DESCRIPTION
               "This group is optional."
      GROUP       natTranslationGroup
      DESCRIPTION
               "Write access to this group is not required."
               
      OBJECT      natInterfaceRealm
      MIN-ACCESS  read-only
      DESCRIPTION
              "Write access is not required." 
          
      OBJECT natInterfaceRowStatus
      SYNTAX RowStatus { active(1) }
      WRITE-SYNTAX RowStatus { createAndGo(4), destroy(6) }
      DESCRIPTION
              "Support for createAndWait and notInService is 
               not required." 
      
      OBJECT      natInterfaceStorageType
      MIN-ACCESS  read-only
      DESCRIPTION
              "Write Access is not required." 

      OBJECT  natAddrMapLocalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natAddrMapLocalAddrFrom
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."  



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 45]

INTERNET-DRAFT                 NAT MIB                  November 2003


      OBJECT  natAddrMapLocalAddrTo
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natAddrMapGlobalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natAddrMapGlobalAddrFrom
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."      

      OBJECT  natAddrMapGlobalAddrTo
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT natAddrMapRowStatus
      SYNTAX RowStatus { active(1) }
      WRITE-SYNTAX RowStatus { createAndGo(4), destroy(6) }
      DESCRIPTION
              "Support for createAndWait and notInService is 
               not required." 
               
      OBJECT      natAddrMapStorageType
      MIN-ACCESS  read-only
      DESCRIPTION
              "Write Access is not required."

      OBJECT  natAddrBindGlobalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."






Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 46]

INTERNET-DRAFT                 NAT MIB                  November 2003


      OBJECT  natAddrBindGlobalAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT natAddrBindRowStatus
      SYNTAX RowStatus { active(1) }
      WRITE-SYNTAX RowStatus { createAndGo(4), destroy(6) }
      DESCRIPTION
              "Support for createAndWait and notInService is 
               not required."  
    
      OBJECT  natAddrPortBindGlobalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natAddrPortBindGlobalAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."
              
      OBJECT natAddrPortBindRowStatus
      SYNTAX RowStatus { active(1) }
      WRITE-SYNTAX RowStatus { createAndGo(4), destroy(6) }
      DESCRIPTION
              "Support for createAndWait and notInService is 
               not required." 

      OBJECT  natSessionPrivateAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natSessionPrivateSrcAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 47]

INTERNET-DRAFT                 NAT MIB                  November 2003


      OBJECT  natSessionPrivateDstAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natSessionPublicAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natSessionPublicSrcAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT  natSessionPublicDstAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "An implementation is required to support global IPv4
               and/or IPv6 addresses depending upon its support
               for IPv4 and IPv6."

      OBJECT natSessionRowStatus
      SYNTAX RowStatus { active(1) }
      WRITE-SYNTAX RowStatus { createAndGo(4), destroy(6) }
      DESCRIPTION
              "Support for createAndWait and notInService is 
               not required."       
       
    ::= { natMIBCompliances 1 }

natMIBReadOnlyCompliance MODULE-COMPLIANCE
    STATUS  current
    DESCRIPTION
            "When this MIB is implemented without support for 
             read-create (i.e. in read-only mode), then such an 
             implementation can claim read-only compliance. 
             Such a device can then be monitored but can not be 
             configured with this MIB."

    MODULE  -- this module
      MANDATORY-GROUPS { natConfigGroup, natTranslationGroup,
                         natStatsInterfaceGroup }  
      GROUP       natStatsProtocolGroup
      DESCRIPTION
               "This group is optional."



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 48]

INTERNET-DRAFT                 NAT MIB                  November 2003


      GROUP       natStatsAddrMapGroup
      DESCRIPTION
               "This group is optional." 
      GROUP       natMIBNotificationGroup
      DESCRIPTION
               "This group is optional."
               
      OBJECT natInterfaceRowStatus
      SYNTAX RowStatus { active(1) }
      MIN-ACCESS   read-only
      DESCRIPTION
              "Write access is not required, and active is the only 
               status that needs to be supported." 
              
      OBJECT  natAddrMapLocalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natAddrMapLocalAddrFrom
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natAddrMapLocalAddrTo
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natAddrMapGlobalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natAddrMapGlobalAddrFrom
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 49]

INTERNET-DRAFT                 NAT MIB                  November 2003


      OBJECT  natAddrMapGlobalAddrTo
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT natAddrMapRowStatus
      SYNTAX RowStatus { active(1) }
      MIN-ACCESS   read-only
      DESCRIPTION
              "Write access is not required, and active is the only 
               status that needs to be supported." 
               
      OBJECT  natAddrBindGlobalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natAddrBindGlobalAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."
      
      OBJECT natAddrBindRowStatus
      SYNTAX RowStatus { active(1) }
      WRITE-SYNTAX RowStatus { createAndGo(4), destroy(6) }
      DESCRIPTION
              "Support for createAndWait and notInService is 
               not required."  

      OBJECT  natAddrPortBindGlobalAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natAddrPortBindGlobalAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."
              



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 50]

INTERNET-DRAFT                 NAT MIB                  November 2003


      OBJECT natAddrPortBindRowStatus
      SYNTAX RowStatus { active(1) }
      WRITE-SYNTAX RowStatus { createAndGo(4), destroy(6) }
      DESCRIPTION
              "Support for createAndWait and notInService is 
               not required."  

      OBJECT  natSessionPrivateAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natSessionPrivateSrcAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natSessionPrivateDstAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natSessionPublicAddrType
      SYNTAX  InetAddressType { ipv4(1), ipv6(2) }
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natSessionPublicSrcAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."

      OBJECT  natSessionPublicDstAddr
      SYNTAX  InetAddress (SIZE(4|16))
      DESCRIPTION
              "Write access is not required. An implementation is
               required to support global IPv4 and/or IPv6 addresses
               depending upon its support for IPv4 and IPv6."




Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 51]

INTERNET-DRAFT                 NAT MIB                  November 2003


      OBJECT natSessionRowStatus
      SYNTAX RowStatus { active(1) }
      MIN-ACCESS   read-only
      DESCRIPTION
              "Write access is not required, and active is the only 
               status that needs to be supported."
                   
    ::= { natMIBCompliances 2 }


END









































Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 52]

INTERNET-DRAFT                 NAT MIB                  November 2003


6. Intellectual Property 

   The IETF takes no position regarding the validity or scope of any 
   intellectual property or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
   might or might not be available; neither does it represent that it 
   has made any effort to identify any such rights.  Information on the 
   IETF's procedures with respect to rights in standards-track and 
   standards-related documentation can be found in BCP-11. 

   Copies of claims of rights made available for publication and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF Secretariat. 

   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to practice 
   this standard.  Please address the information to the IETF Executive 
   Director. 






























Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 53]

INTERNET-DRAFT                 NAT MIB                  November 2003


7. Change History

   A record of changes which will be removed before publication.

   10  September 2001

   o Added the following objects to support notifications:
     natAddrRiseThreshold, natAddrFallingThreshold,
     natAddrMapName and natPktDiscardReason.

   o Following notifications were added (there are still some 
     unclear parameters though):
     natAddressUseRising and natPacketDiscard.

   10  November 2001

   o Dynamic and Static Address Map tables are Merged.

   o Protocol Extensibility added.

   o Rearrangement of OIDs done to get things in proper sequence.


   07  February 2002

   o Config and Interface Specific tables are Merged.

   o MAX-ACCESS for the bind and session entry objects are 
     changed to be read-create.

   o natAddrMapType renamed to natAddrMapDirection.

   14 June 2002

   o Changed the syntax of natConfServiceType to BITS and renumbered
     the enumeration to start with 0.
    
   o Addressed the warning raised by smilint - all InetAddress values
     now restricted to the size range (0..20) i.e. valid InetAddress
     types are now ipv4, ipv6, ipv4z and ipv6z.

   o MIN-ACCESS for natConfInterfaceRealm restricted to read-only.

   o Changed the natConfIcmpDefIdleTimeout default value to be 300.

   o natConfProtConfigName made a part of the optional 
     natConfProtGroup.

   o RFC 3291 now referred to instead of RFC 2578



Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 54]

INTERNET-DRAFT                 NAT MIB                  November 2003


   2 Nov 2002

   o Added the Bind Origin Objects.

   o Updated the description of natSessionSecondBindId.

   o Interface specific statistics made mandatory.

   o New sections, 4.1, 4.2 and 4.3 added indicating relationship
     between tables and configuration guidelines.


   02 Sep 2003

   o Removed the protocol extensibility.

   o Incorporated other comments.


   21 Oct 2003

   o Rearranged notifications

   o Added new TEXTUAL-CONVENTIONs.

   o Incorporated other comments.


   27 Oct 2003

   o Updated MODULE IDENTITY according to the MIB guidelines.


8.  Acknowledgements 

   The authors of the document would like to thank Randy Turner,
   Ashwini S.T., Kevin Luehrs, Sam Sankoorikal, and Juergen Quittek
   for their valuable feedback.
   The authors would like to especially thank Juergen Schoenwaelder
   for his patient and fine-combed review and detailed comments as a
   MIB doctor. The NAT MIB is much clearer and flatter as a result of
   Juergen's suggestions.
  









Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 55]

INTERNET-DRAFT                 NAT MIB                  November 2003


9.  Security Considerations 
   
   It is clear that this MIB can be potentially useful for 
   configuration. Unauthorized access to the write-able objects could
   cause a denial of service, and/or widespread network disturbance. 
   Hence, the  support for SET operations in a non-secure
   environment without proper protection can have a negative effect on
   network operations.

   At this writing, no security holes have been identified beyond those
   that SNMP Security is itself intended to address. These relate
   primarily to controlled access to sensitive information and the
   ability to configure a device - or which might result from operator
   error, which is beyond the scope of any security architecture.
  
   There are a number of managed objects in this MIB that may contain
   information that may be sensitive from a business perspective, in
   that they may represent NAT bind and session information.
   The NAT bind and session objects reveal the identity of private
   hosts that are engaged in a session with external end nodes. A
   curious outsider could monitor these two objects to assess the
   number of private hosts being supported by the NAT device. Further,
   a disgruntled former employee of an enterprise could use the nat
   bind and session information to break into specific private hosts
   by intercepting the existing sessions or originate new
   sessions into the host. There are no objects which are sensitive in 
   their own right, such as passwords or monetary amounts.
   It may be important to even control GET access to these objects and
   possibly to even encrypt the values of these objects when sending
   them over the network via SNMP.  Not all versions of SNMP provide
   features for such a secure environment.

   SNMP versions prior to SNMPv3 did not include adequate security.  
   Even if the network itself is secure (for example by using IPSec), 
   even then, there is no control as to who on the secure network is
   allowed to access and GET/SET (read/change/create/delete) the 
   objects in this MIB. 

   It is recommended that the implementers consider the security 
   features as provided by the SNMPv3 framework (see [RFC3410], section 
   8), including full support for the SNMPv3 cryptographic mechanisms 
   (for authentication and privacy).  
      
   Further, deployment of SNMP versions prior to SNMPv3 is NOT 
   RECOMMENDED.  Instead, it is RECOMMENDED to deploy SNMPv3 and to 
   enable cryptographic security.  It is then a customer/operator 
   responsibility to ensure that the SNMP entity giving access to an 
   instance of this MIB module is properly configured to give access to 
   the objects only to those principals (users) that have legitimate 
   rights to indeed GET or SET (change/create/delete) them. 


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 56]

INTERNET-DRAFT                 NAT MIB                  November 2003


10.  References

   10.1. Normative References

   [RFC2578] McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
             Rose, M. and S. Waldbusser, "Structure of Management
             Information Version 2 (SMIv2)", STD 58, RFC 2578, April
             1999.

   [RFC2579] McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
             Rose, M. and S. Waldbusser, "Textual Conventions for
             SMIv2", STD 58, RFC 2579, April 1999.

   [RFC2580] McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
             Rose, M. and S. Waldbusser, "Conformance Statements for
             SMIv2", STD 58, RFC 2580, April 1999.

   [RFC3022] Srisuresh, P. and Egevang, K., "Traditional IP Network 
             Address Translator (Traditional NAT)", RFC 3022, 
             January 2001.

   [RFC2663] Srisuresh, P. and M. Holdrege, "NAT Terminology and
             Considerations", RFC 2663, August 1999.

   [RFC3291] Daniele, M., Haberman, B., Routhier, S., Schoenwaelder, 
             J., "Textual Conventions for Internet Network Addresses", 
             RFC 3291, May 2002.

   [RFC792]  J. Postel, "Internet Control Message Protocol - 
             DARPA Internet Program Protocol Specification", 
             RFC 792, September 1981.

   [RFC3489] J. Rosenberg, J. Weinberger, C. Huitema, and R. Mahy,
             "STUN - Simple Traversal of User Datagram Protocol (UDP)
             Through Network Address Translators (NATs)", RFC 3489,
             March 2003.

   [IF-MIB]  McCloghrie, K. and F. Kastenholz, "The Interfaces Group
             MIB using SMIv2", RFC 2863, June 2000.

   [RFC2463] Conta & Deering, "Internet Control Message Protocol 
             (ICMPv6) for the Internet Protocol Version 6 (IPv6)
             Specification", RFC 2653, December 1998


   10.2. Informative References

   [RFC3410] Case, J., Mundy, R., Partain, D. and B. Stewart,
             "Introduction and Applicability Statements for Internet-
             Standard Management Framework", RFC 3410, December 2002.


Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 57]

INTERNET-DRAFT                 NAT MIB                  November 2003


11.  Author's Addresses 

   R. Rohit
   Mascon Global Limted
   #59/2 100 ft Ring Road 
   Banashankari II Stage 
   Bangalore 560 070 
   India
   Phone: +91 80 679 6227
   Email: rrohit74@hotmail.com
   
   Nalinaksh Pai
   Cisco Systems, Inc.
   Prestige Waterford
   No. 9, Brunton Road
   Bangalore - 560 025
   India
   Phone: +91 80 532 1300 extn. 6354
   Email: npai@cisco.com

   Rajiv Raghunarayan 
   Cisco Systems Inc.
   170 West Tasman Drive
   San Jose, CA 95134
   Phone: +1 408 853 9612
   Email: raraghun@cisco.com

   Cliff Wang
   Information Security
   Bank One Corp
   1111 Polaris Pkwy
   Columbus, OH 43240
   Phone: +1 614 213 6117
   Email: cliffwang2000@yahoo.com

   P. Srisuresh
   Caymas Systems, Inc.
   1179-A North McDowell Blvd.
   Petaluma, CA 94954
   Tel: (707) 283-5063
   Email: srisuresh@yahoo.com
   










Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 58]

INTERNET-DRAFT                 NAT MIB                  November 2003


12. Full Copyright Statement 

   Copyright (C) The Internet Society (2003). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph
   are included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.
    
   The limited permissions granted above are perpetual and will not be 
   revoked by the Internet Society or its successors or assigns. 
    
   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

   Acknowledgement 

   Funding for the RFC Editor function is currently provided by the 
   Internet Society. 




















Rohit, Pai, Raghunarayan, Wang, Srisuresh                    [Page 59]
