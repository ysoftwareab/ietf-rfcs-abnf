<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Mathematical Mesh 3.0 Part III : Data At Rest Encryption (DARE)</title>
<meta content="Phillip Hallam-Baker" name="author">
<meta content="
       This document describes the Data At Rest Encryption (DARE) Envelope and Container syntax.  
       The DARE Envelope syntax is used to digitally sign, digest, authenticate, or encrypt arbitrary content data. 
       The DARE Container syntax describes an append-only sequence of entries, each containing a DARE Envelope. DARE Containers may support cryptographic integrity verification of the entire data container content by means of a Merkle tree.  
       [Note to Readers] 
       Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh. 
       This document is also available online at  . 
    " name="description">
<meta content="xml2rfc 2.37.3" name="generator">
<meta content="draft-hallambaker-mesh-dare-06" name="ietf.draft">
<link href="/tmp/fred-FKeAYR.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Mesh: Data At Rest Encryption</td>
<td class="right">January 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hallam-Baker</td>
<td class="center">Expires 19 July 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hallambaker-mesh-dare</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-01-16" class="published">16 January 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-07-19">19 July 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. M. Hallam-Baker</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Mathematical Mesh 3.0 Part III : Data At Rest Encryption (DARE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Data At Rest Encryption (DARE) Envelope and Container syntax.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The DARE Envelope syntax is used to digitally sign, digest, authenticate, or encrypt arbitrary content data.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">The DARE Container syntax describes an append-only sequence of entries, each containing a DARE Envelope. DARE Containers may support cryptographic integrity verification of the entire data container content by means of a Merkle tree.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">[Note to Readers]<a href="#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh.<a href="#section-abstract-5" class="pilcrow">¶</a></p>
<p id="section-abstract-6">This document is also available online at <span><a href="http://mathmesh.com/Documents/draft-hallambaker-mesh-dare.html">http://mathmesh.com/Documents/draft-hallambaker-mesh-dare.html</a></span>.<a href="#section-abstract-6" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 July 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (https://trustee.ietf.org/license-info) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-encryption-and-integrity" class="xref">Encryption and Integrity</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1"><a href="#section-1.1.1" class="xref">1.1.1</a>.  <a href="#name-key-exchange" class="xref">Key Exchange</a><a href="#section-toc.1-1.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1"><a href="#section-1.1.2" class="xref">1.1.2</a>.  <a href="#name-data-erasure" class="xref">Data Erasure</a><a href="#section-toc.1-1.1.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-signature" class="xref">Signature</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1"><a href="#section-1.2.1" class="xref">1.2.1</a>.  <a href="#name-signing-individual-plaintex" class="xref">Signing Individual Plaintext Envelopes</a><a href="#section-toc.1-1.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1"><a href="#section-1.2.2" class="xref">1.2.2</a>.  <a href="#name-signing-individual-encrypte" class="xref">Signing Individual Encrypted Envelopes</a><a href="#section-toc.1-1.1.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2.2.3">
                    <p id="section-toc.1-1.1.2.2.2.3.1"><a href="#section-1.2.3" class="xref">1.2.3</a>.  <a href="#name-signing-sequences-of-envelo" class="xref">Signing sequences of envelopes</a><a href="#section-toc.1-1.1.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-container" class="xref">Container</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3.2.1">
                    <p id="section-toc.1-1.1.2.3.2.1.1"><a href="#section-1.3.1" class="xref">1.3.1</a>.  <a href="#name-container-format" class="xref">Container Format</a><a href="#section-toc.1-1.1.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3.2.2">
                    <p id="section-toc.1-1.1.2.3.2.2.1"><a href="#section-1.3.2" class="xref">1.3.2</a>.  <a href="#name-write" class="xref">Write</a><a href="#section-toc.1-1.1.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3.2.3">
                    <p id="section-toc.1-1.1.2.3.2.3.1"><a href="#section-1.3.3" class="xref">1.3.3</a>.  <a href="#name-encryption-and-authenticati" class="xref">Encryption and Authentication</a><a href="#section-toc.1-1.1.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3.2.4">
                    <p id="section-toc.1-1.1.2.3.2.4.1"><a href="#section-1.3.4" class="xref">1.3.4</a>.  <a href="#name-integrity-and-signature" class="xref">Integrity and Signature</a><a href="#section-toc.1-1.1.2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3.2.5">
                    <p id="section-toc.1-1.1.2.3.2.5.1"><a href="#section-1.3.5" class="xref">1.3.5</a>.  <a href="#name-redaction" class="xref">Redaction</a><a href="#section-toc.1-1.1.2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3.2.6">
                    <p id="section-toc.1-1.1.2.3.2.6.1"><a href="#section-1.3.6" class="xref">1.3.6</a>.  <a href="#name-alternative-approaches" class="xref">Alternative approaches</a><a href="#section-toc.1-1.1.2.3.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.3.2.7">
                    <p id="section-toc.1-1.1.2.3.2.7.1"><a href="#section-1.3.7" class="xref">1.3.7</a>.  <a href="#name-efficiency" class="xref">Efficiency</a><a href="#section-toc.1-1.1.2.3.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-related-specifications" class="xref">Related Specifications</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-defined-terms" class="xref">Defined terms</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-dare-envelope-architecture" class="xref">DARE Envelope Architecture</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-processing-considerations" class="xref">Processing Considerations</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-content-metadata-and-annota" class="xref">Content Metadata and Annotations</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-encoded-data-sequence" class="xref">Encoded Data Sequence</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-encryption-and-integrity-2" class="xref">Encryption and Integrity</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-key-exchange-2" class="xref">Key Exchange</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-key-identifiers" class="xref">Key Identifiers</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-salt-derivation" class="xref">Salt Derivation</a><a href="#section-toc.1-1.3.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="xref">3.4.4</a>.  <a href="#name-key-derivation" class="xref">Key Derivation</a><a href="#section-toc.1-1.3.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-signature-2" class="xref">Signature</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-algorithms" class="xref">Algorithms</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-field-kwd" class="xref">Field: kwd</a><a href="#section-toc.1-1.3.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-dare-container-architecture" class="xref">DARE Container Architecture</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-container-navigation" class="xref">Container Navigation</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-tree" class="xref">Tree</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-position-index" class="xref">Position Index</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-metadata-index" class="xref">Metadata Index</a><a href="#section-toc.1-1.4.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-integrity-mechanisms" class="xref">Integrity Mechanisms</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-digest-chain-calculation" class="xref">Digest Chain calculation</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-binary-merkle-tree-calculat" class="xref">Binary Merkle tree calculation</a><a href="#section-toc.1-1.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-signature-3" class="xref">Signature</a><a href="#section-toc.1-1.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-dare-schema" class="xref">DARE Schema</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-message-classes" class="xref">Message Classes</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-structure-dareenvelopeseque" class="xref">Structure: DareEnvelopeSequence</a><a href="#section-toc.1-1.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-header-and-trailer-classes" class="xref">Header and Trailer Classes</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-structure-daretrailer" class="xref">Structure: DareTrailer</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-structure-dareheader" class="xref">Structure: DareHeader</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-structure-contentmeta" class="xref">Structure: ContentMeta</a><a href="#section-toc.1-1.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-cryptographic-data" class="xref">Cryptographic Data</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-structure-daresigner" class="xref">Structure: DareSigner</a><a href="#section-toc.1-1.5.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-structure-x509certificate" class="xref">Structure: X509Certificate</a><a href="#section-toc.1-1.5.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="xref">5.3.3</a>.  <a href="#name-structure-daresignature" class="xref">Structure: DareSignature</a><a href="#section-toc.1-1.5.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="xref">5.3.4</a>.  <a href="#name-structure-darerecipient" class="xref">Structure: DareRecipient</a><a href="#section-toc.1-1.5.2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-dare-container-schema" class="xref">DARE Container Schema</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-container-headers" class="xref">Container Headers</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-structure-containerinfo" class="xref">Structure: ContainerInfo</a><a href="#section-toc.1-1.6.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-index-structures" class="xref">Index Structures</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-structure-containerindex" class="xref">Structure: ContainerIndex</a><a href="#section-toc.1-1.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-structure-indexposition" class="xref">Structure: IndexPosition</a><a href="#section-toc.1-1.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-structure-keyvalue" class="xref">Structure: KeyValue</a><a href="#section-toc.1-1.6.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="xref">6.2.4</a>.  <a href="#name-structure-indexmeta" class="xref">Structure: IndexMeta</a><a href="#section-toc.1-1.6.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-dare-container-applications" class="xref">Dare Container Applications</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-catalog" class="xref">Catalog</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-spool" class="xref">Spool</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-archive" class="xref">Archive</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-future-work" class="xref">Future Work</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-terminal-integrity-check" class="xref">Terminal integrity check</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-terminal-index-record" class="xref">Terminal index record</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-deferred-indexing" class="xref">Deferred indexing</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-encryption-signature-nestin" class="xref">Encryption/Signature nesting</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-side-channel" class="xref">Side channel</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-salt-reuse" class="xref">Salt reuse</a><a href="#section-toc.1-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-appendix-a-dare-envelope-ex" class="xref">Appendix A: DARE Envelope Examples and Test Vectors</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-test-examples" class="xref">Test Examples</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-plaintext-message" class="xref">Plaintext Message</a><a href="#section-toc.1-1.13.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-plaintext-message-with-eds" class="xref">Plaintext Message with EDS</a><a href="#section-toc.1-1.13.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="xref">13.3</a>.  <a href="#name-encrypted-message" class="xref">Encrypted Message</a><a href="#section-toc.1-1.13.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="xref">13.4</a>.  <a href="#name-signed-message" class="xref">Signed Message</a><a href="#section-toc.1-1.13.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="xref">13.5</a>.  <a href="#name-signed-and-encrypted-messag" class="xref">Signed and Encrypted Message</a><a href="#section-toc.1-1.13.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-appendix-b-dare-container-e" class="xref">Appendix B: DARE Container Examples and Test Vectors</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-simple-container" class="xref">Simple container</a><a href="#section-toc.1-1.14.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-payload-and-chain-digests" class="xref">Payload and chain digests</a><a href="#section-toc.1-1.14.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="xref">14.3</a>.  <a href="#name-merkle-tree" class="xref">Merkle Tree</a><a href="#section-toc.1-1.14.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="xref">14.4</a>.  <a href="#name-signed-container" class="xref">Signed container</a><a href="#section-toc.1-1.14.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="xref">14.5</a>.  <a href="#name-encrypted-container" class="xref">Encrypted container</a><a href="#section-toc.1-1.14.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-appendix-c-previous-frame-f" class="xref">Appendix C: Previous Frame Function</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-appendix-d-outstanding-issu" class="xref">Appendix D: Outstanding Issues</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.18.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="n-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes the Data At Rest Encryption (DARE) Envelope and Container Syntax. The DARE Envelope syntax is used to digitally sign, digest, authenticate, or encrypt arbitrary message content. The DARE Container syntax describes an append-only sequence of data frames, each containing a DARE Envelope that supports efficient incremental signature and encryption.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The DARE Envelope Syntax is based on a subset of the JSON Web Signature <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> and JSON Web Encryption <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span> standards and shares many fields and semantics. The processing model and data structures have been streamlined to remove alternative means of specifying the same content and to enable multiple data sequences to be signed and encrypted under a single master encryption key without compromise to security.<a href="#section-1-2" class="pilcrow">¶</a></p>
<figure id="figure-1">
        <div class="artwork art-svg alignLeft" id="section-1-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.82292in" height="3.84722in" viewBox="0 0 419.25 277" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
            <defs>
              <g>
                <path d="M 3 1 L 0 0 L 3 -1 L 3 1"></path>
              </g>
            </defs>
            <g>
              <title>Page-1</title>
              <g transform="translate(-78.277,-71.8529) rotate(-33.6901)">
                <title>Sheet.7</title>
                <path d="M0 277 L129.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(0.75,-0.75)">
                <title>Sheet.26</title>
                <desc>0000</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0000</text>
              </g>
              <g transform="translate(54.75,-0.75)">
                <title>Sheet.27</title>
                <desc>0001</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0001</text>
              </g>
              <g transform="translate(108.75,-0.75)">
                <title>Sheet.28</title>
                <desc>0010</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0010</text>
              </g>
              <g transform="translate(162.75,-0.75)">
                <title>Sheet.29</title>
                <desc>0011</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0011</text>
              </g>
              <g transform="translate(217.25,-0.75)">
                <title>Sheet.30</title>
                <desc>0100</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0100</text>
              </g>
              <g transform="translate(271.25,-0.75)">
                <title>Sheet.31</title>
                <desc>0101</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0101</text>
              </g>
              <g transform="translate(330.75,-0.75)">
                <title>Sheet.32</title>
                <desc>0110</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0110</text>
              </g>
              <g transform="translate(377.75,-0.75)">
                <title>Sheet.33</title>
                <desc>0111</desc>
                <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0111</text>
              </g>
              <g transform="translate(94.1079,-175.597) rotate(-18.7999)">
                <title>Sheet.1</title>
                <path d="M0 277 L223.42 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-199.747,63.2489) rotate(-52.9227)">
                <title>Sheet.4</title>
                <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-91.6219,63.6239) rotate(-52.9227)">
                <title>Sheet.2</title>
                <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(15.2531,63.2489) rotate(-52.9227)">
                <title>Sheet.5</title>
                <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(125.128,63.2489) rotate(-52.9227)">
                <title>Sheet.6</title>
                <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(137.348,-72.2279) rotate(-33.6901)">
                <title>Sheet.15</title>
                <path d="M0 277 L129.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-201.5,231.478) rotate(-90.099)">
                <title>Sheet.16</title>
                <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-93.3746,231.853) rotate(-90.099)">
                <title>Sheet.17</title>
                <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(13.5004,231.478) rotate(-90.099)">
                <title>Sheet.18</title>
                <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-93.4996,159.478) rotate(-90.099)">
                <title>Sheet.54</title>
                <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(122.25,231.478) rotate(-90.099)">
                <title>Sheet.55</title>
                <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(122.125,159.103) rotate(-90.099)">
                <title>Sheet.56</title>
                <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(122,86.7284) rotate(-90.099)">
                <title>Sheet.57</title>
                <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-199.747,63.2489) rotate(-52.9227)">
                <title>Sheet.61</title>
                <path d="M0 277 L41.59 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-78.277,-71.8529) rotate(-33.6901)">
                <title>Sheet.62</title>
                <path d="M0 277 L56.16 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(94.1079,-175.597) rotate(-18.7999)">
                <title>Sheet.63</title>
                <path d="M0 277 L98.55 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(15.2531,63.2489) rotate(-52.9227)">
                <title>Sheet.64</title>
                <path d="M0 277 L39.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-91.6219,63.6239) rotate(-52.9227)">
                <title>Sheet.65</title>
                <path d="M0 277 L39.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(125.128,63.2489) rotate(-52.9227)">
                <title>Sheet.66</title>
                <path d="M0 277 L39.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(137.348,-72.2279) rotate(-33.6901)">
                <title>Sheet.67</title>
                <path d="M0 277 L56.16 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-201.5,231.478) rotate(-90.099)">
                <title>Sheet.69</title>
                <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-93.3746,231.853) rotate(-90.099)">
                <title>Sheet.70</title>
                <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(13.5004,231.478) rotate(-90.099)">
                <title>Sheet.71</title>
                <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(122.25,231.478) rotate(-90.099)">
                <title>Sheet.72</title>
                <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(445.027,-71.8529) rotate(33.6901) scale(-1,1)">
                <title>Sheet.77</title>
                <path d="M0 277 L129.8 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(445.027,-71.8529) rotate(33.6901) scale(-1,1)">
                <title>Sheet.78</title>
                <path d="M0 277 L56.16 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(129.5,-46.75) scale(-1,1)">
                <title>Sheet.81</title>
                <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                  <title>Sheet.79</title>
                  <path d="M0 277 L89.78 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                  <title>Sheet.80</title>
                  <path d="M0 277 L41.59 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
              <g transform="translate(237.5,-46.375) scale(-1,1)">
                <title>Sheet.82</title>
                <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                  <title>Sheet.83</title>
                  <path d="M0 277 L89.78 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                  <title>Sheet.84</title>
                  <path d="M0 277 L41.59 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
              <g transform="translate(345.5,-46.375) scale(-1,1)">
                <title>Sheet.85</title>
                <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                  <title>Sheet.86</title>
                  <path d="M0 277 L89.78 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                  <title>Sheet.87</title>
                  <path d="M0 277 L41.59 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
              <g transform="translate(7.75,-33.25)">
                <title>Sheet.68</title>
                <g transform="translate(376.875,-216)">
                  <title>Sheet.3</title>
                  <desc>7</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                </g>
                <g>
                  <title>Sheet.8</title>
                  <desc>0</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">0</text>
                </g>
                <g transform="translate(53.875,0)">
                  <title>Sheet.9</title>
                  <desc>1</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">1</text>
                </g>
                <g transform="translate(108,0)">
                  <title>Sheet.10</title>
                  <desc>2</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">2</text>
                </g>
                <g transform="translate(161.875,0)">
                  <title>Sheet.11</title>
                  <desc>3</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">3</text>
                </g>
                <g transform="translate(53.875,-72)">
                  <title>Sheet.12</title>
                  <desc>1</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">1</text>
                </g>
                <g transform="translate(161.875,-72)">
                  <title>Sheet.13</title>
                  <desc>3</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">3</text>
                </g>
                <g transform="translate(161.875,-144)">
                  <title>Sheet.14</title>
                  <desc>3</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">3</text>
                </g>
                <g transform="translate(216.5,0)">
                  <title>Sheet.19</title>
                  <desc>4</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">4</text>
                </g>
                <g transform="translate(270.375,0)">
                  <title>Sheet.20</title>
                  <desc>5</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">5</text>
                </g>
                <g transform="translate(324.125,0)">
                  <title>Sheet.21</title>
                  <desc>6</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">6</text>
                </g>
                <g transform="translate(376.875,0)">
                  <title>Sheet.22</title>
                  <desc>7</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                </g>
                <g transform="translate(270.375,-72)">
                  <title>Sheet.23</title>
                  <desc>5</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">5</text>
                </g>
                <g transform="translate(376.875,-72)">
                  <title>Sheet.24</title>
                  <desc>7</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                </g>
                <g transform="translate(376.875,-144)">
                  <title>Sheet.25</title>
                  <desc>7</desc>
                  <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                  <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                </g>
              </g>
            </g>
          </svg>
        </div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
<p id="section-1-4">A DARE Envelope consists of a <em>Header</em>, <em>Payload</em> and an optional <em>Trailer</em>. To enable single pass encoding and decoding, the Header contains all the information required to perform cryptographic processing of the Payload and authentication data (digest, MAC, signature values) <span class="bcp14">MAY</span> be deferred to the Trailer section.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">A DARE Container is an append-only log format consisting of a sequence of frames. Cryptographic enhancements (signature, encryption) may be applied to individual frames or to sets of frames. Thus, a single key exchange may be used to provide a master key to encrypt multiple frames and a single signature may be used to authenticate all the frames in the container up to and including the frame in which the signature is presented.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The DARE Envelope syntax may be used either as a standalone cryptographic message syntax or as a means of presenting a single DARE Container frame together with the complete cryptographic context required to verify the contents and decrypt them.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="n-encryption-and-integrity">
<section id="section-1.1">
        <h3 id="name-encryption-and-integrity">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-encryption-and-integrity" class="section-name selfRef">Encryption and Integrity</a>
        </h3>
<p id="section-1.1-1">A key innovation in the DARE Envelope Syntax is the separation of key exchange and data encryption operations so that a Master Key (MK) established in a single exchange to be applied to multiple data sequences. This means that a single public key operation <span class="bcp14">MAY</span> be used to encrypt and/or authenticate multiple parts of the same DARE Envelope or multiple frames in a DARE Container.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">To avoid reuse of the key and to avoid the need to communicate separate IVs, each octet sequence is encrypted under a different encryption key (and IV if required) derived from the Master Key by means of a salt that is unique for each octet sequence that is encrypted. The same approach is used to generate keys for calculating a MAC over the octet sequence if required. This approach allows encryption and integrity protections to be applied to the envelope payload, to header or trailer fields or to application defined Enhanced Data Sequences in the header or trailer.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<div id="n-key-exchange">
<section id="section-1.1.1">
          <h4 id="name-key-exchange">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-key-exchange" class="section-name selfRef">Key Exchange</a>
          </h4>
<p id="section-1.1.1-1">Traditional cryptographic containers describe the application of a single key exchange to encryption of a single octet sequence. Examples include PCKS#7/CMS <span>[<a href="#RFC2315" class="xref">RFC2315</a>]</span>, OpenPGP <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span> and JSON Web Encryption <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span>.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1.1-2">To encrypt data using RSA, the encoder first generates a random encryption key and initialization vector (IV). The encryption key is encrypted under the public key of each recipient to create a per-recipient decryption entry. The encryption key, plaintext and IV are used to generate the ciphertext (figure 1).<a href="#section-1.1.1-2" class="pilcrow">¶</a></p>
<figure id="figure-2">
            <div class="artwork art-svg alignLeft" id="section-1.1.1-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.41224in" height="3.78724in" viewBox="0 0 389.681 272.681" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 3 1 L 0 0 L 3 -1 L 3 1"></path>
                  </g>
                </defs>
                <g>
                  <title>Page-1</title>
                  <g transform="translate(163.341,-145.341)">
                    <title>Sheet.26</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(158.841,-149.841)">
                    <title>Sheet.27</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(307.341,-217.341)">
                    <title>Sheet.22</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(302.841,-221.841)">
                    <title>Sheet.23</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(307.341,-145.341)">
                    <title>Sheet.24</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(302.841,-149.841)">
                    <title>Sheet.25</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(19.3406,-217.341)">
                    <title>Sheet.21</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(14.8406,-221.841)">
                    <title>Sheet.20</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 272.68 L72 272.68 L72 236.68 L0 236.68 L0 272.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(10.3406,-82.3406)">
                    <title>Sheet.1</title>
                    <desc>Plaintext</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.52" y="258.28" fill="#000000" font-family="sans-serif" font-size="1.00001em">Plaintext</text>
                  </g>
                  <g transform="translate(298.341,-82.3406)">
                    <title>Sheet.2</title>
                    <desc>Ciphertext</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="10.44" y="258.28" fill="#000000" font-family="sans-serif" font-size="1.00001em">Ciphertext</text>
                  </g>
                  <g transform="translate(154.341,-154.341)">
                    <title>Sheet.3</title>
                    <desc>Key Exchange</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="27.18" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Key <tspan x="12.95" y="265.480144" font-size="1em">Exchange</tspan>
                    </text>
                  </g>
                  <g transform="translate(109.341,-91.3406)">
                    <title>Summing junction</title>
                    <path d="M0 263.68 A9 9 0 0 1 18 263.68 A9 9 0 1 1 0 263.68 Z" fill="#ffffff"></path>
                    <path d="M2.64 257.32 L15.36 270.05" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.24"></path>
                    <path d="M2.64 270.05 L15.36 257.32" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.24"></path>
                    <path d="M0 263.68 A9 9 0 0 1 18 263.68 A9 9 0 1 1 0 263.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.24"></path>
                  </g>
                  <g transform="translate(82.3406,-100.341)">
                    <title>Sheet.5</title>
                    <path d="M0 272.68 L17.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(127.341,-100.341)">
                    <title>Sheet.6</title>
                    <path d="M0 272.68 L161.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(226.341,-172.341)">
                    <title>Sheet.8</title>
                    <path d="M0 272.68 L62.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(298.341,-154.341)">
                    <title>Sheet.9</title>
                    <desc>Recipient Information</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.17" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Recipient <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(82.3406,-172.341)">
                    <title>Sheet.11</title>
                    <path d="M0 272.68 L62.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(10.3406,-154.341)">
                    <title>Sheet.7</title>
                    <desc>Encryption Key</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.72" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Encryption <tspan x="27.18" y="265.480144" font-size="1em">Key</tspan>
                    </text>
                  </g>
                  <g transform="translate(391.022,100.341) rotate(90)">
                    <title>Sheet.10</title>
                    <path d="M0 272.68 L53.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(10.3406,-10.3406)">
                    <title>Sheet.12</title>
                    <desc>IV</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="31.08" y="258.28" fill="#000000" font-family="sans-serif" font-size="1.00001em">IV</text>
                  </g>
                  <g transform="translate(-154.341,244.341) rotate(-90)">
                    <title>Sheet.13</title>
                    <path d="M0 272.68 L53.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(82.3406,-28.3406)">
                    <title>Sheet.14</title>
                    <path d="M0 272.68 L206.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(298.341,-10.3406)">
                    <title>Sheet.15</title>
                    <desc>IV</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="31.08" y="258.28" fill="#000000" font-family="sans-serif" font-size="1.00001em">IV</text>
                  </g>
                  <g transform="translate(298.341,-226.341)">
                    <title>Sheet.17</title>
                    <desc>Public Key Identifier</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="13.53" y="265.480144" font-size="1em">Identifier</tspan>
                    </text>
                  </g>
                  <g transform="translate(10.3406,-226.341)">
                    <title>Sheet.16</title>
                    <desc>Public Key Information</desc>
                    <rect x="0" y="236.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="11.13" y="251.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="265.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(82.3406,-244.341)">
                    <title>Sheet.18</title>
                    <path d="M0 272.68 L206.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(463.022,28.3406) rotate(90)">
                    <title>Sheet.19</title>
                    <path d="M0 272.68 L44.19 272.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
<p id="section-1.1.1-4">This approach is adequate for the task of encrypting a single octet stream. It is less than satisfactory when encrypting multiple octet streams or very long streams for which a rekeying operation is desirable.<a href="#section-1.1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1.1-5">In the DARE approach, key exchange and key derivation are separate operations and keys <span class="bcp14">MAY</span> be derived for encryption or integrity purposes or both. A single key exchange <span class="bcp14">MAY</span> be used to derive keys to apply encryption and integrity enhancements to multiple data sequences.<a href="#section-1.1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1.1-6">The DARE key exchange begins with the same key exchange used to produce the CEK in JWE but instead of using the CEK to encipher data directly, it is used as one of the inputs to a Key Derivation Function (KDF) that is used to derive parameters for each block of data to be encrypted. To avoid the need to introduce additional terminology, the term 'CEK' is still used to describe the output of the key agreement algorithm (including key unwrapping if required) but it is more appropriately described as a Master Key (figure 2).<a href="#section-1.1.1-6" class="pilcrow">¶</a></p>
<figure id="figure-3">
            <div class="artwork art-svg alignLeft" id="section-1.1.1-7.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.41224in" height="3.03724in" viewBox="0 0 389.681 218.681" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 3 1 L 0 0 L 3 -1 L 3 1"></path>
                  </g>
                </defs>
                <g>
                  <title>Page-1</title>
                  <g transform="translate(163.341,-91.3406)">
                    <title>Sheet.1</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(158.841,-95.8406)">
                    <title>Sheet.2</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(307.341,-163.341)">
                    <title>Sheet.3</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(302.841,-167.841)">
                    <title>Sheet.4</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(307.341,-91.3406)">
                    <title>Sheet.5</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(302.841,-95.8406)">
                    <title>Sheet.6</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(19.3406,-163.341)">
                    <title>Sheet.7</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(14.8406,-167.841)">
                    <title>Sheet.8</title>
                    <desc>Public Key Information</desc>
                    <path d="M0 218.68 L72 218.68 L72 182.68 L0 182.68 L0 218.68 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(154.341,-100.341)">
                    <title>Sheet.11</title>
                    <desc>Key Exchange</desc>
                    <rect x="0" y="182.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="27.18" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Key <tspan x="12.95" y="211.480144" font-size="1em">Exchange</tspan>
                    </text>
                  </g>
                  <g transform="translate(226.341,-118.341)">
                    <title>Sheet.15</title>
                    <path d="M0 218.68 L62.19 218.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(298.341,-100.341)">
                    <title>Sheet.16</title>
                    <desc>Recipient Information</desc>
                    <rect x="0" y="182.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.17" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Recipient <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(154.341,-10.3406)">
                    <title>Sheet.18</title>
                    <desc>Master Key</desc>
                    <rect x="0" y="182.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.39" y="204.28" fill="#000000" font-family="sans-serif" font-size="1.00001em">Master Key</text>
                  </g>
                  <g transform="translate(298.341,-172.341)">
                    <title>Sheet.24</title>
                    <desc>Public Key Identifier</desc>
                    <rect x="0" y="182.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="13.53" y="211.480144" font-size="1em">Identifier</tspan>
                    </text>
                  </g>
                  <g transform="translate(10.3406,-172.341)">
                    <title>Sheet.25</title>
                    <desc>Public Key Information</desc>
                    <rect x="0" y="182.681" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="11.13" y="197.08" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Key <tspan x="6.88" y="211.480144" font-size="1em">Information</tspan>
                    </text>
                  </g>
                  <g transform="translate(82.3406,-190.341)">
                    <title>Sheet.26</title>
                    <path d="M0 218.68 L206.19 218.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(409.022,28.3406) rotate(90)">
                    <title>Sheet.27</title>
                    <path d="M0 218.68 L44.19 218.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(409.022,118.341) rotate(90)">
                    <title>Sheet.9</title>
                    <path d="M0 218.68 L44.19 218.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a></figcaption></figure>
<p id="section-1.1.1-8">A Master Key may be used to encrypt any number of data items. Each data item is encrypted under a different encryption key and IV (if required). This data is derived from the Master Key using the HKDF function <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> using a different salt for each data item and separate info tags for each cryptographic function (figure 3).<a href="#section-1.1.1-8" class="pilcrow">¶</a></p>
<figure id="figure-4">
            <div class="artwork art-svg alignLeft" id="section-1.1.1-9.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.29167in" height="4.28945in" viewBox="0 0 381 308.841" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 3 1 L 0 0 L 3 -1 L 3 1"></path>
                  </g>
                </defs>
                <g>
                  <title>Page-1</title>
                  <g transform="translate(286.875,-0.75)">
                    <title>Sheet.22</title>
                    <desc>Sequence Output</desc>
                    <path d="M0 308.84 L93.37 308.84 L93.37 74.84 L0 74.84 L0 308.84 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="5.25,3.75,0,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="4.17" y="89.64" fill="#000000" font-family="sans-serif" font-size="1.00001em">Sequence Output</text>
                  </g>
                  <g transform="translate(0.75,-1.5)">
                    <title>Sheet.21</title>
                    <desc>Sequence Input</desc>
                    <path d="M0 308.84 L108 308.84 L108 74.84 L0 74.84 L0 308.84 Z" fill="#ffffff" stroke="#000000" stroke-dasharray="5.25,3.75,0,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="15.96" y="89.64" fill="#000000" font-family="sans-serif" font-size="1.00001em">Sequence Input</text>
                  </g>
                  <g transform="translate(18.75,-19.5)">
                    <title>Sheet.1</title>
                    <desc>Plaintext</desc>
                    <rect x="0" y="272.841" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.52" y="294.44" fill="#000000" font-family="sans-serif" font-size="1.00001em">Plaintext</text>
                  </g>
                  <g transform="translate(297.75,-19.5)">
                    <title>Sheet.2</title>
                    <desc>Ciphertext</desc>
                    <rect x="0" y="272.841" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="10.44" y="294.44" fill="#000000" font-family="sans-serif" font-size="1.00001em">Ciphertext</text>
                  </g>
                  <g transform="translate(189.75,-28.5)">
                    <title>Summing junction</title>
                    <path d="M0 299.84 A9 9 0 0 1 18 299.84 A9 9 0 1 1 0 299.84 Z" fill="#ffffff"></path>
                    <path d="M2.64 293.48 L15.36 306.2" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.24"></path>
                    <path d="M2.64 306.2 L15.36 293.48" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.24"></path>
                    <path d="M0 299.84 A9 9 0 0 1 18 299.84 A9 9 0 1 1 0 299.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.24"></path>
                  </g>
                  <g transform="translate(507.591,46.3406) rotate(90)">
                    <title>Sheet.5</title>
                    <path d="M0 308.84 L44.19 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(117.75,-91.5)">
                    <title>Sheet.6</title>
                    <desc>Encryption Key</desc>
                    <rect x="0" y="272.841" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.72" y="287.24" fill="#000000" font-family="sans-serif" font-size="1.00001em">Encryption <tspan x="27.18" y="301.640144" font-size="1em">Key</tspan>
                    </text>
                  </g>
                  <g transform="translate(162.75,-262.5)">
                    <title>Sheet.10</title>
                    <desc>Master Key</desc>
                    <rect x="0" y="272.841" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.39" y="294.44" fill="#000000" font-family="sans-serif" font-size="1.00001em">Master Key</text>
                  </g>
                  <g transform="translate(18.75,-172.5)">
                    <title>Sheet.11</title>
                    <desc>Salt</desc>
                    <rect x="0" y="272.841" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="26.98" y="294.44" fill="#000000" font-family="sans-serif" font-size="1.00001em">Salt</text>
                  </g>
                  <g transform="translate(207.75,-91.5)">
                    <title>Sheet.12</title>
                    <desc>IV</desc>
                    <rect x="0" y="272.841" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="31.08" y="294.44" fill="#000000" font-family="sans-serif" font-size="1.00001em">IV</text>
                  </g>
                  <g transform="translate(162.75,-172.5)">
                    <title>Sheet.13</title>
                    <desc>HKDF</desc>
                    <rect x="0" y="272.841" width="72" height="36" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="22.7" y="294.44" fill="#000000" font-family="sans-serif" font-size="1.00001em">HKDF</text>
                  </g>
                  <g transform="translate(90.75,-191.4)">
                    <title>Sheet.14</title>
                    <path d="M0 308.84 L62.19 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(207.75,-37.5)">
                    <title>Sheet.8</title>
                    <path d="M0 308.84 L80.19 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(90.75,-37.5)">
                    <title>Sheet.17</title>
                    <path d="M0 308.84 L89.19 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(500.814,231.318) rotate(89.2537)">
                    <title>Sheet.7</title>
                    <path d="M0 308.84 L19.83 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(552.591,154.341) rotate(90)">
                    <title>Sheet.15</title>
                    <path d="M0 308.84 L17.19 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(462.591,154.341) rotate(90)">
                    <title>Sheet.16</title>
                    <path d="M0 308.84 L17.19 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(153.75,-154.5)">
                    <title>Sheet.4</title>
                    <path d="M36 290.84 L36 308.84 L0 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(207.75,-154.5)">
                    <title>Sheet.9</title>
                    <path d="M0 290.84 L0 308.84 L36 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(205.5,-73.5)">
                    <title>Sheet.18</title>
                    <path d="M38.25 290.84 L38.25 308.84 L0 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(153.75,-73.5)">
                    <title>Sheet.19</title>
                    <path d="M0 290.84 L0 308.84 L38.25 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(514.314,239.363) rotate(90.7463)">
                    <title>Sheet.20</title>
                    <path d="M0 308.84 L19.83 308.84" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a></figcaption></figure>
<p id="section-1.1.1-10">This approach to encryption offers considerably greater flexibility allowing the same format for data item encryption to be applied at the transport, message or field level.<a href="#section-1.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-data-erasure">
<section id="section-1.1.2">
          <h4 id="name-data-erasure">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-data-erasure" class="section-name selfRef">Data Erasure</a>
          </h4>
<p id="section-1.1.2-1">Each encrypted DARE Envelope specifies a unique Master Salt value of at least 128 bits which is used to derive the salt values used to derive cryptographic keys for the envelope payload and annotations.<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.1.2-2">Erasure of the Master Salt value <span class="bcp14">MAY</span> be used to effectively render the envelope payload and annotations undecipherable without altering the envelope payload data. The work factor for decryption will be O(2^128) even if the decryption key is compromised.<a href="#section-1.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-signature">
<section id="section-1.2">
        <h3 id="name-signature">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-signature" class="section-name selfRef">Signature</a>
        </h3>
<p id="section-1.2-1">As with encryption, DARE Envelope signatures <span class="bcp14">MAY</span> be applied to an individual envelope or a sequence of envelope.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<div id="n-signing-individual-plaintext-envelopes">
<section id="section-1.2.1">
          <h4 id="name-signing-individual-plaintex">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-signing-individual-plaintex" class="section-name selfRef">Signing Individual Plaintext Envelopes</a>
          </h4>
<p id="section-1.2.1-1">When an individual plaintext envelope is signed, the digest value used to create the signature is calculated over the binary value of the payload data. That is, the value of the payload before the encoding (Base-64, JSON-B) is applied.<a href="#section-1.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-signing-individual-encrypted-envelopes">
<section id="section-1.2.2">
          <h4 id="name-signing-individual-encrypte">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-signing-individual-encrypte" class="section-name selfRef">Signing Individual Encrypted Envelopes</a>
          </h4>
<p id="section-1.2.2-1">When an individual plaintext envelope is signed, the digest value used to create the signature is calculated over the binary value of the payload data. That is, the value of the payload after encryption but before the encoding (Base-64, JSON-B) is applied.<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2.2-2">Use of signing and encryption in combination presents the risk of subtle attacks depending on the order in which signing and encryption take place <span>[<a href="#Davis2001" class="xref">Davis2001</a>]</span>.<a href="#section-1.2.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2.2-3">Na?ve approaches in which an envelope is encrypted and then signed present the possibility of a surreptitious forwarding attack. For example, Alice signs an envelope and sends it to Mallet who then strips off Alice's signature and sends the envelope to Bob.<a href="#section-1.2.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2.2-4">Na?ve approaches in which an envelope is signed and then encrypted present the possibility of an attacker claiming authorship of a ciphertext. For example, Alice encrypts a ciphertext for Bob and then signs it. Mallet then intercepts the envelope and sends it to Bob.<a href="#section-1.2.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2.2-5">While neither attack is a concern in all applications, both attacks pose potential hazards for the unwary and require close inspection of application protocol design to avoid exploitation.<a href="#section-1.2.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2.2-6">To prevent these attacks, each signature on an envelope that is signed and encrypted <span class="bcp14">MUST</span> include a witness value that is calculated by applying a MAC function to the signature value as described in section XXX.<a href="#section-1.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-signing-sequences-of-envelopes">
<section id="section-1.2.3">
          <h4 id="name-signing-sequences-of-envelo">
<a href="#section-1.2.3" class="section-number selfRef">1.2.3. </a><a href="#name-signing-sequences-of-envelo" class="section-name selfRef">Signing sequences of envelopes</a>
          </h4>
<p id="section-1.2.3-1">To sign multiple envelopes with a single signature, we first construct a Merkle tree of the envelope payload digest values and then sign the root of the Merkle tree.<a href="#section-1.2.3-1" class="pilcrow">¶</a></p>
<p id="section-1.2.3-2">[This is not yet implemented but will be soon.]<a href="#section-1.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-container">
<section id="section-1.3">
        <h3 id="name-container">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-container" class="section-name selfRef">Container</a>
        </h3>
<p id="section-1.3-1">DARE Container is a message and file syntax that allows a sequence of data frames to be represented with cryptographic integrity, signature, and encryption enhancements to be constructed in an append only format.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">The format is designed to meet the requirements of a wide range of use cases including:<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.3-3.1">Recording transactions in persistent storage.<a href="#section-1.3-3.1" class="pilcrow">¶</a>
</li>
<li id="section-1.3-3.2">Synchronizing transaction logs between hosts.<a href="#section-1.3-3.2" class="pilcrow">¶</a>
</li>
<li id="section-1.3-3.3">File archive.<a href="#section-1.3-3.3" class="pilcrow">¶</a>
</li>
<li id="section-1.3-3.4">Message spool.<a href="#section-1.3-3.4" class="pilcrow">¶</a>
</li>
<li id="section-1.3-3.5">Signing and encrypting single data items.<a href="#section-1.3-3.5" class="pilcrow">¶</a>
</li>
<li id="section-1.3-3.6">Incremental encryption and authentication of server logs.<a href="#section-1.3-3.6" class="pilcrow">¶</a>
</li>
</ul>
<div id="n-container-format">
<section id="section-1.3.1">
          <h4 id="name-container-format">
<a href="#section-1.3.1" class="section-number selfRef">1.3.1. </a><a href="#name-container-format" class="section-name selfRef">Container Format</a>
          </h4>
<p id="section-1.3.1-1">A Container consists of a sequence of variable length Frames. Each frame consists of a forward length indicator, the framed data and a reverse length indicator. The reverse length indicator is written out backwards allowing the length and thus the frame to be read in the reverse direction:<a href="#section-1.3.1-1" class="pilcrow">¶</a></p>
<figure id="figure-5">
            <div class="artwork art-svg alignLeft" id="section-1.3.1-2.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.02083in" height="0.770833in" viewBox="0 0 361.5 55.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <g>
                  <title>Page-2</title>
                  <g transform="translate(18.75,-18.75)">
                    <title>Sheet.1</title>
                    <g>
                      <title>Sheet.2</title>
                      <desc>F5</desc>
                      <rect x="0" y="37.5" width="36" height="18" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="12.2" y="50.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">F5</text>
                    </g>
                    <g transform="translate(36,0)">
                      <title>Sheet.3</title>
                      <desc>01</desc>
                      <rect x="0" y="37.5" width="36" height="18" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="11.92" y="50.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">01</text>
                    </g>
                    <g transform="translate(72,0)">
                      <title>Sheet.4</title>
                      <desc>2C</desc>
                      <rect x="0" y="37.5" width="36" height="18" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="11.76" y="50.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">2C</text>
                    </g>
                    <g transform="translate(108,0)">
                      <title>Sheet.5</title>
                      <desc>&amp;lt;300 Bytes&amp;gt;</desc>
                      <rect x="0" y="37.5" width="108" height="18" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="24.22" y="50.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">&amp;lt;300 Bytes&amp;gt;</text>
                    </g>
                    <g transform="translate(288,0)">
                      <title>Sheet.6</title>
                      <desc>F5</desc>
                      <rect x="0" y="37.5" width="36" height="18" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="12.2" y="50.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">F5</text>
                    </g>
                    <g transform="translate(252,0)">
                      <title>Sheet.7</title>
                      <desc>01</desc>
                      <rect x="0" y="37.5" width="36" height="18" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="11.92" y="50.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">01</text>
                    </g>
                    <g transform="translate(216,0)">
                      <title>Sheet.8</title>
                      <desc>2C</desc>
                      <rect x="0" y="37.5" width="36" height="18" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="11.76" y="50.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">2C</text>
                    </g>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a></figcaption></figure>
<p id="section-1.3.1-3">Each frame contains a single DARE Envelope consisting of a Header, Payload and Trailer (if required). The first frame in a container describes the container format options and defaults. These include the range of encoding options for frame metadata supported and the container profiles to which the container conforms.<a href="#section-1.3.1-3" class="pilcrow">¶</a></p>
<p id="section-1.3.1-4">All internal data formats support use of pointers of up to 64 bits allowing containers of up to 18 exabytes to be written.<a href="#section-1.3.1-4" class="pilcrow">¶</a></p>
<p id="section-1.3.1-5">Five container types are currently specified:<a href="#section-1.3.1-5" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1.3.1-6">
            <dt id="section-1.3.1-6.1">Simple</dt>
<dd id="section-1.3.1-6.2">
              <p id="section-1.3.1-6.2.1">The container does not provide any index or content integrity checks.<a href="#section-1.3.1-6.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.3.1-6.3">Tree</dt>
<dd id="section-1.3.1-6.4">
              <p id="section-1.3.1-6.4.1">Frame headers contain entries that specify the start position of previous frames at the apex of the immediately enclosing binary tree. This enables efficient random access to any frame in the file.<a href="#section-1.3.1-6.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.3.1-6.5">Digest</dt>
<dd id="section-1.3.1-6.6">
              <p id="section-1.3.1-6.6.1">Each frame trailer contains a <code>PayloadDigest</code> field. Modification of the payload will cause verification of the <code>PayloadDigest</code> value to fail on that frame.<a href="#section-1.3.1-6.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.3.1-6.7">Chain</dt>
<dd id="section-1.3.1-6.8">
              <p id="section-1.3.1-6.8.1">Each frame trailer contains <code>PayloadDigest</code> and <code>ChainDigest</code> fields allowing modifications to the payload data to be detected. Modification of the payload will cause verification of the <code>PayloadDigest</code> value to fail on that frame and verification of the <code>ChainDigest</code> value to fail on all subsequent frames.<a href="#section-1.3.1-6.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.3.1-6.9">Merkle Tree</dt>
<dd id="section-1.3.1-6.10">
              <p id="section-1.3.1-6.10.1">Frame headers contain entries that specify the start position of previous frames at the apex of the immediately enclosing binary tree. Frame Trailers contain TreeDigestPartial and TreeDigestFinal entries forming a Merkle digest tree.<a href="#section-1.3.1-6.10.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-write">
<section id="section-1.3.2">
          <h4 id="name-write">
<a href="#section-1.3.2" class="section-number selfRef">1.3.2. </a><a href="#name-write" class="section-name selfRef">Write</a>
          </h4>
<p id="section-1.3.2-1">In normal circumstances, Containers are written as an append only log. As with Envelopes, integrity information (payload digest, signatures) is written to the entry trailer. Thus, large payloads may be written without the need to buffer the payload data <em>provided that</em> the content length is known in advance.<a href="#section-1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-1.3.2-2">Should exceptional circumstances require, Container entries <span class="bcp14">MAY</span> be erased by overwriting the Payload and/or parts of the Header content without compromising the ability to verify other entries in the container. If the entry Payload is encrypted, it is sufficient to erase the container salt value to render the container entry effectively inaccessible (though recovery might still be possible if the original salt value can be recovered from the storage media.<a href="#section-1.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-encryption-and-authentication">
<section id="section-1.3.3">
          <h4 id="name-encryption-and-authenticati">
<a href="#section-1.3.3" class="section-number selfRef">1.3.3. </a><a href="#name-encryption-and-authenticati" class="section-name selfRef">Encryption and Authentication</a>
          </h4>
<p id="section-1.3.3-1">Frame payloads and associated attributes <span class="bcp14">MAY</span> be encrypted and/or authenticated in the same manner as Envelopes.<a href="#section-1.3.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3.3-2"><em>Incremental encryption</em> is supported allowing encryption parameters from a single public key exchange operation to be applied to encrypt multiple frames. The public key exchange information is specified in the first encrypted frame and subsequent frames encrypted under those parameters specify the location at which the key exchange information is to be found by means of the ExchangePosition field which <span class="bcp14">MUST</span> specify a location that is earlier in the file.<a href="#section-1.3.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3.3-3">To avoid cryptographic vulnerabilities resulting from key re-use, the DARE key exchange requires that each encrypted sequence use an encryption key and initialization vector derived from the master key established in the public key exchange by means of a unique salt.<a href="#section-1.3.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3.3-4">Each Envelope and by extension, each Container frame <span class="bcp14">MUST</span> specify a unique salt value of at least 128 bits. Since the encryption key is derived from the salt value by means of a Key Derivation Function, erasure of the salt <span class="bcp14">MAY</span> be used as a means of rendering the payload plaintext value inaccessible without changing the payload value.<a href="#section-1.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-integrity-and-signature">
<section id="section-1.3.4">
          <h4 id="name-integrity-and-signature">
<a href="#section-1.3.4" class="section-number selfRef">1.3.4. </a><a href="#name-integrity-and-signature" class="section-name selfRef">Integrity and Signature</a>
          </h4>
<p id="section-1.3.4-1">Signatures <span class="bcp14">MAY</span> be applied to a payload digest, the final digest in a chain or tree. The chain and tree digest modes allow a single signature to be used to authenticate all frame payloads in a container.<a href="#section-1.3.4-1" class="pilcrow">¶</a></p>
<p id="section-1.3.4-2">The tree signature mode is particularly suited to applications such as file archives as it allows files to be verified individually without requiring the signer to sign each individually. Furthermore, in applications such as code signing, it allows a single signature to be used to verify both the integrity of the code and its membership of the distribution.<a href="#section-1.3.4-2" class="pilcrow">¶</a></p>
<p id="section-1.3.4-3">As with DARE Envelope, the signature mechanism does not specify the interpretation of the signature semantics. The presence of a signature demonstrates that the holder of the private key applied it to the specified digest value but not their motive for doing so. Describing such semantics is beyond the scope of this document and is deferred to future work.<a href="#section-1.3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-redaction">
<section id="section-1.3.5">
          <h4 id="name-redaction">
<a href="#section-1.3.5" class="section-number selfRef">1.3.5. </a><a href="#name-redaction" class="section-name selfRef">Redaction</a>
          </h4>
<p id="section-1.3.5-1">The chief disadvantage of using an append-only format is that containers only increase in size. In many applications, much of the data in the container becomes redundant or obsolete and a process analogous to garbage collection is required. This process is called <em>redaction</em>.<a href="#section-1.3.5-1" class="pilcrow">¶</a></p>
<p id="section-1.3.5-2">The simplest method of redaction is to create a new container and sequentially copy each entry from the old container to the new, discarding redundant frames and obsolete header information.<a href="#section-1.3.5-2" class="pilcrow">¶</a></p>
<p id="section-1.3.5-3">For example, partial index records may be consolidated into a single index record placed in the last frame of the container. Unnecessary signature and integrity data may be discarded and so on.<a href="#section-1.3.5-3" class="pilcrow">¶</a></p>
<p id="section-1.3.5-4">While redaction could in principle be effected by moving data in-place in the existing container, supporting this approach in a robust fashion is considerably more complex as it requires backward references in subsequent frames to be overridden as each frame is moved.<a href="#section-1.3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-alternative-approaches">
<section id="section-1.3.6">
          <h4 id="name-alternative-approaches">
<a href="#section-1.3.6" class="section-number selfRef">1.3.6. </a><a href="#name-alternative-approaches" class="section-name selfRef">Alternative approaches</a>
          </h4>
<p id="section-1.3.6-1">Many file proprietary formats are in use that support some or all of these capabilities but only a handful have public, let alone open, standards. DARE Container is designed to provide a superset of the capabilities of existing message and file syntaxes, including:<a href="#section-1.3.6-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.3.6-2.1">Cryptographic Message Syntax <span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span> defines a syntax used to digitally sign, digest, authenticate, or encrypt arbitrary message content.<a href="#section-1.3.6-2.1" class="pilcrow">¶</a>
</li>
<li id="section-1.3.6-2.2">The.ZIP File Format specification <span>[<a href="#ZIPFILE" class="xref">ZIPFILE</a>]</span> developed by Phil Katz.<a href="#section-1.3.6-2.2" class="pilcrow">¶</a>
</li>
<li id="section-1.3.6-2.3">The BitCoin Block chain <span>[<a href="#BLOCKCHAIN" class="xref">BLOCKCHAIN</a>]</span>.<a href="#section-1.3.6-2.3" class="pilcrow">¶</a>
</li>
<li id="section-1.3.6-2.4">JSON Web Encryption and JSON Web Signature<a href="#section-1.3.6-2.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-1.3.6-3">Attempting to make use of these specifications in a layered fashion would require at least three separate encoders and introduce unnecessary complexity. Furthermore, there is considerable overlap between the specifications providing multiple means of achieving the same ends, all of which must be supported if decoders are to work reliably.<a href="#section-1.3.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-efficiency">
<section id="section-1.3.7">
          <h4 id="name-efficiency">
<a href="#section-1.3.7" class="section-number selfRef">1.3.7. </a><a href="#name-efficiency" class="section-name selfRef">Efficiency</a>
          </h4>
<p id="section-1.3.7-1">Every data format represents a compromise between different concerns, in particular:<a href="#section-1.3.7-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1.3.7-2">
            <dt id="section-1.3.7-2.1">Compactness</dt>
<dd id="section-1.3.7-2.2">
              <p id="section-1.3.7-2.2.1">The space required to record data in the encoding.<a href="#section-1.3.7-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.3.7-2.3">Memory Overhead</dt>
<dd id="section-1.3.7-2.4">
              <p id="section-1.3.7-2.4.1">The additional volatile storage (RAM) required to maintain indexes etc. to support efficient retrieval operations.<a href="#section-1.3.7-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.3.7-2.5">Number of Operations</dt>
<dd id="section-1.3.7-2.6">
              <p id="section-1.3.7-2.6.1">The number of operations required to retrieve data from or append data to an existing encoded sequence.<a href="#section-1.3.7-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.3.7-2.7">Number of Disk Seek Operations</dt>
<dd id="section-1.3.7-2.8">
              <p id="section-1.3.7-2.8.1">Optimizing the response time of magnetic storage media to random access read requests has traditionally been one of the central concerns of database design. The DARE Container format is designed to the assumption that this will cease to be a concern as solid state media replaces magnetic.<a href="#section-1.3.7-2.8.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-1.3.7-3">While the cost of storage of all types has declined rapidly over the past decades, so has the amount of data to be stored. DARE Container represents a pragmatic balance of these considerations for current technology. In particular, since payload volumes are likely to be very large, memory and operational efficiency are considered higher priorities than compactness.<a href="#section-1.3.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-definitions">
<section id="section-2">
      <h2 id="name-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
      </h2>
<div id="n-related-specifications">
<section id="section-2.1">
        <h3 id="name-related-specifications">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-related-specifications" class="section-name selfRef">Related Specifications</a>
        </h3>
<p id="section-2.1-1">The DARE Envelope and Container formats are based on the following existing standards and specifications.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">Object serialization</dt>
<dd id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">The JSON-B <span>[<a href="#draft-hallambaker-jsonbcd" class="xref">draft-hallambaker-jsonbcd</a>]</span> encoding is used for object serialization. This encoding is an extension of the JavaScript Object Notation (JSON) <span>[<a href="#RFC7159" class="xref">RFC7159</a>]</span>.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.1-2.3">Message syntax</dt>
<dd id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">The cryptographic processing model is based on JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>, JSON Web Encryption (JWE) <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span> and JSON Web Key (JWK) <span>[<a href="#RFC7517" class="xref">RFC7517</a>]</span>.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.1-2.5">Cryptographic primitives.</dt>
<dd id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">The HMAC-based Extract-and-Expand Key Derivation Function <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> and Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span> are used.<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.6.2">The Uniform Data Fingerprint method of presenting data digests is used for key identifiers and other purposes <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span>.<a href="#section-2.1-2.6.2" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.1-2.7">Cryptographic algorithms</dt>
<dd id="section-2.1-2.8">
            <p id="section-2.1-2.8.1">The cryptographic algorithms and identifiers described in JSON Web Algorithms (JWA) <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span> are used together with additional algorithms as defined in the JSON Object Signing and Encryption IANA registry <span>[<a href="#IANAJOSE" class="xref">IANAJOSE</a>]</span>.<a href="#section-2.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-requirements-language">
<section id="section-2.2">
        <h3 id="name-requirements-language">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-defined-terms">
<section id="section-2.3">
        <h3 id="name-defined-terms">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-defined-terms" class="section-name selfRef">Defined terms</a>
        </h3>
<p id="section-2.3-1">The terms "Authentication Tag", "Content Encryption Key", "Key Management Mode", "Key Encryption", "Direct Key Agreement", "Key Agreement with Key Wrapping" and "Direct Encryption" are defined in the JWE specification <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The terms "Authentication", "Ciphertext", "Digital Signature", "Encryption", "Initialization Vector (IV)", "Message Authentication Code (MAC)", "Plaintext" and "Salt" are defined by the Internet Security Glossary, Version 2 <span>[<a href="#RFC4949" class="xref">RFC4949</a>]</span>.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2.3-3">
          <dt id="section-2.3-3.1">Annotated Envelope</dt>
<dd id="section-2.3-3.2">
            <p id="section-2.3-3.2.1">A DARE Envelope that contains an <code>Annotations</code> field with at least one entry.<a href="#section-2.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.3">Authentication Data</dt>
<dd id="section-2.3-3.4">
            <p id="section-2.3-3.4.1">A Message Authentication Code or authentication tag.<a href="#section-2.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.5">Complete Envelope</dt>
<dd id="section-2.3-3.6">
            <p id="section-2.3-3.6.1">A DARE envelope that contains the key exchange information necessary for the intended recipient(s) to decrypt it.<a href="#section-2.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.7">Detached Envelope</dt>
<dd id="section-2.3-3.8">
            <p id="section-2.3-3.8.1">A DARE envelope that does not contain the key exchange information necessary for the intended recipient(s) to decrypt it.<a href="#section-2.3-3.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.9">Encryption Context</dt>
<dd id="section-2.3-3.10">
            <p id="section-2.3-3.10.1">The master key, encryption algorithms and associated parameters used to generate a set of one or more enhanced data sequences.<a href="#section-2.3-3.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.11">Encoded data sequence (EDS)</dt>
<dd id="section-2.3-3.12">
            <p id="section-2.3-3.12.1">A sequence consisting of a salt, content data and authentication data (if required by the encryption context).<a href="#section-2.3-3.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.13">Enhancement</dt>
<dd id="section-2.3-3.14">
            <p id="section-2.3-3.14.1">Applying a cryptographic operation to a data sequence. This includes encryption, authentication and both at the same time.<a href="#section-2.3-3.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.15">Generator</dt>
<dd id="section-2.3-3.16">
            <p id="section-2.3-3.16.1">The party that generates a DARE envelope.<a href="#section-2.3-3.16.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.17">Group Encryption Key</dt>
<dd id="section-2.3-3.18">
            <p id="section-2.3-3.18.1">A key used to encrypt data to be read by a group of users. This is typically achieved by means of some form of proxy re-encryption or distributed key generation.<a href="#section-2.3-3.18.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.19">Group Encryption Key Identifier</dt>
<dd id="section-2.3-3.20">
            <p id="section-2.3-3.20.1">A key identifier for a group encryption key.<a href="#section-2.3-3.20.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.21">Master Key (MK)</dt>
<dd id="section-2.3-3.22">
            <p id="section-2.3-3.22.1">The master secret from which keys are derived for authenticating enhanced data sequences.<a href="#section-2.3-3.22.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.23">Recipient</dt>
<dd id="section-2.3-3.24">
            <p id="section-2.3-3.24.1">Any party that receives and processes at least some part of a DARE envelope.<a href="#section-2.3-3.24.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.25">Related Envelope</dt>
<dd id="section-2.3-3.26">
            <p id="section-2.3-3.26.1">A set of DARE envelopes that share the same key exchange information and hence the same Master Key.<a href="#section-2.3-3.26.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.3-3.27">Uniform Data Fingerprint (UDF)</dt>
<dd id="section-2.3-3.28">
            <p id="section-2.3-3.28.1">The means of presenting the result of a cryptographic digest function over a data sequence and content type identifier specified in the Uniform Data Fingerprint specification <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span><a href="#section-2.3-3.28.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="n-dare-envelope-architecture">
<section id="section-3">
      <h2 id="name-dare-envelope-architecture">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dare-envelope-architecture" class="section-name selfRef">DARE Envelope Architecture</a>
      </h2>
<p id="section-3-1">A DARE Envelope is a sequence of three parts:<a href="#section-3-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">Header</dt>
<dd id="section-3-2.2">
          <p id="section-3-2.2.1">A JSON object containing information a reader requires to begin processing the envelope.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3-2.3">Payload</dt>
<dd id="section-3-2.4">
          <p id="section-3-2.4.1">An array of octets.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3-2.5">Trailer</dt>
<dd id="section-3-2.6">
          <p id="section-3-2.6.1">A JSON object containing information calculated from the envelope payload.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3-3">For example, the following sequence is a JSON encoded Envelope with an empty header, a payload of zero length and an empty trailer:<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="section-3-4">
<pre class="sourcecode">[ {}, "", {} ]</pre><a href="#section-3-4" class="pilcrow">¶</a>
</div>
<p id="section-3-5">DARE Envelopes <span class="bcp14">MAY</span> be encoded using JSON serialization or a binary serialization for greater efficiency.<a href="#section-3-5" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3-6">
        <dt id="section-3-6.1">JSON <span>[<a href="#RFC7159" class="xref">RFC7159</a>]</span>
</dt>
<dd id="section-3-6.2">
          <p id="section-3-6.2.1">Offers compatibility with applications and libraries that support JSON. Payload data is encoded using Base64 incurring a 33% overhead.<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3-6.3">JSON-B <span>[<a href="#draft-hallambaker-jsonbcd" class="xref">draft-hallambaker-jsonbcd</a>]</span>
</dt>
<dd id="section-3-6.4">
          <p id="section-3-6.4.1">A superset of JSON encoding that permits binary data to be encoded as a sequence of length-data segments. This avoids the Base64 overhead incurred by JSON encoding. Since JSON-B is a superset of JSON encoding, an application can use a single decoder for either format.<a href="#section-3-6.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3-6.5">JSON-C <span>[<a href="#draft-hallambaker-jsonbcd" class="xref">draft-hallambaker-jsonbcd</a>]</span>
</dt>
<dd id="section-3-6.6">
          <p id="section-3-6.6.1">A superset of JSON-C which provides additional efficiency by allowing field tags and other repeated string data to be encoded by reference to a dictionary. Since JSON-C is a superset of JSON and JSON-B encodings, an application can use a single decoder for all three formats.<a href="#section-3-6.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3-7">DARE Envelope processors <span class="bcp14">MUST</span> support JSON serialization and <span class="bcp14">SHOULD</span> support JSON-B serialization.<a href="#section-3-7" class="pilcrow">¶</a></p>
<div id="n-processing-considerations">
<section id="section-3.1">
        <h3 id="name-processing-considerations">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-processing-considerations" class="section-name selfRef">Processing Considerations</a>
        </h3>
<p id="section-3.1-1">The DARE Envelope Syntax supports single pass encoding and decoding without buffering of data. All the information required to begin processing a DARE envelope (key agreement information, digest algorithms), is provided in the envelope header. All the information that is derived from envelope processing (authentication codes, digest values, signatures) is presented in the envelope trailer.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The choice of envelope encoding does not affect the semantics of envelope processing. A DARE Envelope <span class="bcp14">MAY</span> be reserialized under the same serialization or converted from any of the specified serialization to any other serialization without changing the semantics or integrity properties of the envelope.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-content-metadata-and-annotations">
<section id="section-3.2">
        <h3 id="name-content-metadata-and-annota">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-content-metadata-and-annota" class="section-name selfRef">Content Metadata and Annotations</a>
        </h3>
<p id="section-3.2-1">A header <span class="bcp14">MAY</span> contain header fields describing the payload content. These include:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.2-2">
          <dt id="section-3.2-2.1">ContentType</dt>
<dd id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">Specifies the IANA Media Type <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2-2.3">Annotations</dt>
<dd id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">A list of Encoded Data Sequences that provide application specific annotations to the envelope.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3.2-3">For example, consider the following mail message:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div id="section-3.2-4">
<pre class="sourcecode">From: Alice@example.com
To: bob@example.com
Subject: TOP-SECRET Product Launch Today!

The CEO told me the product launch is today. Tell no-one!</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2-5">Existing encryption approaches require that header fields such as the subject line be encrypted  with the body of the message or not encrypted at all. Neither approach is satisfactory. In this example, the subject line gives away important information that the sender probably assumed would be encrypted. But if the subject line is encrypted together with the message body, a mail client must retrieve at least part of the message body to provide a  'folder' view.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">The plaintext form of the equivalent DARE Message encoding is:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<div id="section-3.2-7">
<pre class="sourcecode">[{
    "Annotations":["iAEBiBdGcm9tOiBBbGljZUBleGFtcGxlLmNvbYgA",
      "iAECiBNUbzogYm9iQGV4YW1wbGUuY29tiAA",
      "iAEDiClTdWJqZWN0OiBUT1AtU0VDUkVUIFByb2R1Y3QgTGF1bmNoIFRvZGF5
  IYgA"
      ],
    "ContentMetaData":"ewogICJjdHkiOiAiYXBwbGljYXRpb24vZXhhbXBsZS1t
  YWlsIn0"},
  "VGhlIENFTyB0b2xkIG1lIHRoZSBwcm9kdWN0IGxhdW5jaCBpcyB0b2RheS4gVGVs
  bCBuby1vbmUh"
  ]</pre><a href="#section-3.2-7" class="pilcrow">¶</a>
</div>
<p id="section-3.2-8">This contains the same information as before but the mail message headers are  now presented as a list of Encoded Data Sequences.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-encoded-data-sequence">
<section id="section-3.3">
        <h3 id="name-encoded-data-sequence">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-encoded-data-sequence" class="section-name selfRef">Encoded Data Sequence</a>
        </h3>
<p id="section-3.3-1">An encoded data sequence (EDS) is a sequence of octets that encodes a data sequence according to cryptographic enhancements specified in the context in which it is presented. An EDS <span class="bcp14">MAY</span> be encrypted and <span class="bcp14">MAY</span> be authenticated by means of a MAC. The keys and other cryptographic parameters used to apply these enhancements are derived from the cryptographic context and a Salt prefix specified in the EDS itself.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">An EDS sequence contains exactly three binary fields encoded in JSON-B serialization as follows:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.3-3">
          <dt id="section-3.3-3.1">Salt Prefix</dt>
<dd id="section-3.3-3.2">
            <p id="section-3.3-3.2.1">A sequence of octets used to derive the encryption key, Initialization Vector and MAC key as required.<a href="#section-3.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.3-3.3">Body</dt>
<dd id="section-3.3-3.4">
            <p id="section-3.3-3.4.1">The plaintext or encrypted content.<a href="#section-3.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.3-3.5">Authentication Tag</dt>
<dd id="section-3.3-3.6">
            <p id="section-3.3-3.6.1">The authentication code value in the case that the cryptographic context specifies use of authenticated encryption or a MAC, otherwise is a zero-length field.<a href="#section-3.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3.3-4">Requiring all three fields to be present, even in cases where they are unnecessary simplifies processing at the cost of up to six additional data bytes.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">The encoding of the 'From' header of the previous example as a plaintext EDS is as follows:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<div id="section-3.3-6">
<pre class="sourcecode">88 01
  01
88 17
  46 72 6f 6d 3a 20 41 6c   69 63 65 40 65 78 61 6d
  70 6c 65 2e 63 6f 6d
88 00

</pre><a href="#section-3.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-encryption-and-integrity-0">
<section id="section-3.4">
        <h3 id="name-encryption-and-integrity-2">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-encryption-and-integrity-2" class="section-name selfRef">Encryption and Integrity</a>
        </h3>
<p id="section-3.4-1">Encryption and integrity protections <span class="bcp14">MAY</span> be applied to any DARE Envelope Payload and Annotations.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">The following is an encrypted version of the message shown earlier.  The payload and annotations have both increased in size as a result of the block cipher padding. The header now includes Recipients and Salt fields to enable the content to be decoded.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<div id="section-3.4-3">
<pre class="sourcecode">[{
    "enc":"A256CBC",
    "Salt":"-Xf8VWwwviL9kGw_R9HZvg",
    "Annotations":["iAEBiCBjUwS_tAjj03k0D35IcJ-H2LV7_JRoUhGiIVUmH6Ng
  9Q",
      "iAECiCBMfcp7ZgfQ5XvvyOA_mkP38vHlL7JEPQBad1sdLY0qJA",
      "iAEDiDCjd4_oDTtGluViAPb9RLg80TZA10Ld3WWCiEdGiVK14Cm_qweeQpL-
  Ur7Vq3Ay9FU"
      ],
    "recipients":[{
        "kid":"MDW4-OC5J-T6AW-BXGT-YCAZ-3VFB-B7MG",
        "epk":{
          "PublicKeyECDH":{
            "crv":"Ed25519",
            "Public":"AFFO7udHlhaV-LMpJ4B-1ETJksN1RGm5qlARDYGGA6g"}},
        "wmk":"XqWXnwInu5g3a0MWjIubre4oJfGm069LGBETbUiVLK88GQvOlgej
  Yg"}
      ],
    "ContentMetaData":"ewogICJjdHkiOiAiYXBwbGljYXRpb24vZXhhbXBsZS1t
  YWlsIn0"},
  "olOsbrzB4-mRMf_LJlPk9GemBwKpq3h02-9BL0viQp3EIqLPGYNyMn11xvqLYdBv
  1GRHEPVj_j7QuD3kauhrIQ"
  ]</pre><a href="#section-3.4-3" class="pilcrow">¶</a>
</div>
<div id="n-key-exchange-0">
<section id="section-3.4.1">
          <h4 id="name-key-exchange-2">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-key-exchange-2" class="section-name selfRef">Key Exchange</a>
          </h4>
<p id="section-3.4.1-1">The DARE key exchange is based on the JWE key exchange except that encryption modes are intentionally limited and the output of the key exchange is the DARE Master Key rather than the Content Encryption Key.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">A DARE Key Exchange <span class="bcp14">MAY</span> contain any number of Recipient entries, each providing a means of decrypting the Master Key using a different private key.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-3">If the Key Exchange mechanism supports message recovery, Direct Key Agreement is used, in all other cases, Key Wrapping is used.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
<p id="section-3.4.1-4">This approach allows envelopes with one intended recipient to be handled in the exact same fashion as envelopes with multiple recipients. While this does require an additional key wrapping operation, that could be avoided if an envelope has exactly one intended recipient, this is offset by the reduction in code complexity.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<p id="section-3.4.1-5">If the key exchange algorithm does not support message recovery (e.g. Diffie Hellman and Elliptic Curve Diffie-Hellman), the HKDF Extract-and-Expand Key Derivation Function is used to derive a master key using the following info tag:<a href="#section-3.4.1-5" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.4.1-6">
            <dt id="section-3.4.1-6.1">"dare-master" [64 61 72 65 2d 6d 61 73 74 65 72]</dt>
<dd id="section-3.4.1-6.2">
              <p id="section-3.4.1-6.2.1">Key derivation info field used when deriving a master key from the output of a key exchange.<a href="#section-3.4.1-6.2.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3.4.1-7">The master key length is the maximum of the key size of the encryption algorithm specified by the key exchange header, the key size of the MAC algorithm specified by the key exchange header (if used) and 256.<a href="#section-3.4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-key-identifiers">
<section id="section-3.4.2">
          <h4 id="name-key-identifiers">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-key-identifiers" class="section-name selfRef">Key Identifiers</a>
          </h4>
<p id="section-3.4.2-1">The JWE/JWS specifications define a kid field for use as a key identifier but not how the identifier itself is constructed. All DARE key identifiers are either UDF key fingerprints <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span> or Mesh/Recrypt Group Key Identifiers.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">A UDF fingerprint is formed as the digest of an IANA content type and the digested data. A UDF key fingerprint is formed with the content type <code>application/pkix-keyinfo</code> and the digested data is the ASN.1 DER encoded PKIX certificate <code>keyInfo</code> sequence for the corresponding public key.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
<p id="section-3.4.2-3">A Group Key Identifier has the form &lt;fingerprint&gt;@&lt;domain&gt;. Where &lt;fingerprint&gt; is a UDF key fingerprint and &lt;domain&gt; is the DNS address of a service that provides the encryption service to support decryption by group members.<a href="#section-3.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-salt-derivation">
<section id="section-3.4.3">
          <h4 id="name-salt-derivation">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-salt-derivation" class="section-name selfRef">Salt Derivation</a>
          </h4>
<p id="section-3.4.3-1">A Master Salt is a sequence of 16 or more octets that is specified in the Salt field of the header.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">The Master Salt is used to derive salt values for the envelope payload and associated encoded data sequences as follows.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.4.3-3">
            <dt id="section-3.4.3-3.1">Payload</dt>
<dd id="section-3.4.3-3.2">
              <p id="section-3.4.3-3.2.1">Salt = Master Salt<a href="#section-3.4.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.4.3-3.3">EDS</dt>
<dd id="section-3.4.3-3.4">
              <p id="section-3.4.3-3.4.1">Salt = Concatenate (Payload Salt Prefix,  Master Salt)<a href="#section-3.4.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3.4.3-4">Encoders <span class="bcp14">SHOULD NOT</span> generate salt values that exceed 1024 octets.<a href="#section-3.4.3-4" class="pilcrow">¶</a></p>
<p id="section-3.4.3-5">The salt value is opaque to the DARE encoding but <span class="bcp14">MAY</span> be used to encode application specific semantics including:<a href="#section-3.4.3-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4.3-6.1">Frame number to allow reassembly of a data sequence split over a sequence of envelopes which may be delivered out of order.<a href="#section-3.4.3-6.1" class="pilcrow">¶</a>
</li>
<li id="section-3.4.3-6.2">Transmit the Master Key in the manner of a Kerberos ticket.<a href="#section-3.4.3-6.2" class="pilcrow">¶</a>
</li>
<li id="section-3.4.3-6.3">Identify the Master Key under which the Enhanced Data Sequence was generated.<a href="#section-3.4.3-6.3" class="pilcrow">¶</a>
</li>
<li id="section-3.4.3-6.4">Enable access to the plaintext to be eliminated by erasure of the encryption key.<a href="#section-3.4.3-6.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.4.3-7">For data erasure to be effective, the salt <span class="bcp14">MUST</span> be constructed so that the difficulty of recovering the key is sufficiently high that it is infeasible. For most purposes, a salt with 128 bits of appropriately random data is sufficient.<a href="#section-3.4.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-key-derivation">
<section id="section-3.4.4">
          <h4 id="name-key-derivation">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-key-derivation" class="section-name selfRef">Key Derivation</a>
          </h4>
<p id="section-3.4.4-1">Encryption and/or authentication keys are derived from the Master Key using a Extract-and-Expand Key Derivation Function as follows:<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal" id="section-3.4.4-2">
            <li id="section-3.4.4-2.1">The Master Key and salt value are used to extract the PRK (pseudorandom key)<a href="#section-3.4.4-2.1" class="pilcrow">¶</a>
</li>
<li id="section-3.4.4-2.2">The PRK is used to derive the algorithm keys using the application specific information input for that key type.<a href="#section-3.4.4-2.2" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-3.4.4-3">The application specific information inputs are:<a href="#section-3.4.4-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.4.4-4">
            <dt id="section-3.4.4-4.1">"dare-encrypt" [64 61 72 65 2d 65 6e 63 72 79 70 74]</dt>
<dd id="section-3.4.4-4.2">
              <p id="section-3.4.4-4.2.1">To generate an encryption or encryption with authentication key.<a href="#section-3.4.4-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.4.4-4.3">"dare-iv" [64 61 72 65 2d 65 6e 63 72 79 70 74]</dt>
<dd id="section-3.4.4-4.4">
              <p id="section-3.4.4-4.4.1">To generate an initialization vector.<a href="#section-3.4.4-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.4.4-4.5">"dare-mac" [dare-mac]</dt>
<dd id="section-3.4.4-4.6">
              <p id="section-3.4.4-4.6.1">To generate a Message Authentication Code key.<a href="#section-3.4.4-4.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="n-signature-0">
<section id="section-3.5">
        <h3 id="name-signature-2">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-signature-2" class="section-name selfRef">Signature</a>
        </h3>
<p id="section-3.5-1">While encryption and integrity enhancements can be applied to any part of a DARE Envelope, signatures are only applied to payload digest values calculated over one or more envelope payloads.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The payload digest value for an envelope is calculated over the binary payload data. That is, after any encryption enhancement has been applied but before the envelope encoding is applied. This allows envelopes to be converted from one encoding to another without affecting signature verification.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.5-3">
          <dt id="section-3.5-3.1">Single Payload</dt>
<dd id="section-3.5-3.2">
            <p id="section-3.5-3.2.1">The signed value is the payload digest of the envelope payload.<a href="#section-3.5-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.5-3.3">Multiple Payload.</dt>
<dd id="section-3.5-3.4">
            <p id="section-3.5-3.4.1">The signed value is the root of a Merkle Tree in which the payload digest of the envelope is one of the leaves.<a href="#section-3.5-3.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3.5-4">Verification of a multiple payload signature naturally requires the additional digest values required to construct the Merkle Tree. These are provided in the Trailer in a format that permits multiple signers to reference the same tree data.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-algorithms">
<section id="section-3.6">
        <h3 id="name-algorithms">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-algorithms" class="section-name selfRef">Algorithms</a>
        </h3>
<div id="n-field-kwd">
<section id="section-3.6.1">
          <h4 id="name-field-kwd">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-field-kwd" class="section-name selfRef">Field: kwd</a>
          </h4>
<p id="section-3.6.1-1">The key wrapping and derivation algorithms.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">Since the means of public key exchange is determined by the key identifier of the recipient key, it is only necessary to specify the algorithms used for key wrapping and derivation.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">The default (and so far only) algorithm is kwd-aes-sha2-256-256.<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
<p id="section-3.6.1-4">Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span> is used to wrap the Master Exchange Key. AES 256 is used.<a href="#section-3.6.1-4" class="pilcrow">¶</a></p>
<p id="section-3.6.1-5">HMAC-based Extract-and-Expand Key Derivation Function <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> is used for key derivation. SHA-2-256 is used for the hash function.<a href="#section-3.6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-dare-container-architecture">
<section id="section-4">
      <h2 id="name-dare-container-architecture">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-dare-container-architecture" class="section-name selfRef">DARE Container Architecture</a>
      </h2>
<div id="n-container-navigation">
<section id="section-4.1">
        <h3 id="name-container-navigation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-container-navigation" class="section-name selfRef">Container Navigation</a>
        </h3>
<p id="section-4.1-1">Three means of locating frames in a container are supported:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.1-2">
          <dt id="section-4.1-2.1">Sequential</dt>
<dd id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">Access frames sequentially starting from the start or the end of the container.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.1-2.3">Binary search</dt>
<dd id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">Access any container frame by frame number in O(log<sub>2</sub>(n)) time by means of a binary tree constructed while the container is written.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.1-2.5">Index</dt>
<dd id="section-4.1-2.6">
            <p id="section-4.1-2.6.1">Access and container frame by frame number or by key by means of an index record.<a href="#section-4.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-4.1-3">All DARE Containers support sequential access. Only tree and Merkle tree containers support binary search access. An index frame <span class="bcp14">MAY</span> be written appended to any container and provides O(1) access to any frame listed in the index.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Two modes of compilation are considered:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.1-5">
          <dt id="section-4.1-5.1">Monolithic</dt>
<dd id="section-4.1-5.2">
            <p id="section-4.1-5.2.1">Frames are added to the container in a single operation, e.g. file archives,<a href="#section-4.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.1-5.3">Incremental</dt>
<dd id="section-4.1-5.4">
            <p id="section-4.1-5.4.1">Additional frames are written to the container at various intervals after it was originally created, e.g. server logs, message spools.<a href="#section-4.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-4.1-6">In the monolithic mode, navigation requirements are best met by writing an index frame to the end of the container when it is complete. It is not necessary to construct a binary search tree unless a Merkle tree integrity check is required.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">In the incremental mode, Binary search provides an efficient means of locating frames by frame number but not by key. Writing a complete index to the container every <em>m</em> write operations provides <em>O(m)</em> search access but requires O(n<sup>2</sup>) storage.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">Use of partial indexes provides a better compromise between speed and efficiency. A partial index is written out every <em>m</em> frames where <em>m</em> is a power of two. A complete index is written every time a binary tree apex record is written. This approach provides for O(log<sub>2</sub>(n)) search with incremental compilation with approximately double the overhead of the monolithic case.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<div id="n-tree">
<section id="section-4.1.1">
          <h4 id="name-tree">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-tree" class="section-name selfRef">Tree</a>
          </h4>
<p id="section-4.1.1-1">Binary search is supported by means of the <code>TreePosition</code> parameter specified in the FrameHeader. This parameter specifies the value of the immediately preceding apex.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">Calculation of the immediately preceding apex is most easily described by representing the array index in binary with base of 1 (rather than 0). An array index that is a power of 2 (2, 4, 8, 16, etc.) will be the apex of a complete tree. Every other array index has the value of the sum of a set of powers of 2 and the immediately preceding apex will be the value of the next smallest power of 2 in the sum.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">For example, to find the immediately preceding apex for frame 5, we add 1 to get 6. 6 = 4 + 2, so we ignore the 2 and the preceding frame is 4.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">The values of Tree Position are shown for the first 8 frames in figure xx below:<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<figure id="figure-6">
            <div class="artwork art-svg alignLeft" id="section-4.1.1-5.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.82292in" height="3.84722in" viewBox="0 0 419.25 277" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 3 1 L 0 0 L 3 -1 L 3 1"></path>
                  </g>
                </defs>
                <g>
                  <title>Page-1</title>
                  <g transform="translate(-78.277,-71.8529) rotate(-33.6901)">
                    <title>Sheet.7</title>
                    <path d="M0 277 L129.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(0.75,-0.75)">
                    <title>Sheet.26</title>
                    <desc>0000</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0000</text>
                  </g>
                  <g transform="translate(54.75,-0.75)">
                    <title>Sheet.27</title>
                    <desc>0001</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0001</text>
                  </g>
                  <g transform="translate(108.75,-0.75)">
                    <title>Sheet.28</title>
                    <desc>0010</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0010</text>
                  </g>
                  <g transform="translate(162.75,-0.75)">
                    <title>Sheet.29</title>
                    <desc>0011</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0011</text>
                  </g>
                  <g transform="translate(217.25,-0.75)">
                    <title>Sheet.30</title>
                    <desc>0100</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0100</text>
                  </g>
                  <g transform="translate(271.25,-0.75)">
                    <title>Sheet.31</title>
                    <desc>0101</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0101</text>
                  </g>
                  <g transform="translate(330.75,-0.75)">
                    <title>Sheet.32</title>
                    <desc>0110</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0110</text>
                  </g>
                  <g transform="translate(377.75,-0.75)">
                    <title>Sheet.33</title>
                    <desc>0111</desc>
                    <rect x="0" y="257" width="40.75" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.21" y="270.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0111</text>
                  </g>
                  <g transform="translate(94.1079,-175.597) rotate(-18.7999)">
                    <title>Sheet.1</title>
                    <path d="M0 277 L223.42 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-199.747,63.2489) rotate(-52.9227)">
                    <title>Sheet.4</title>
                    <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-91.6219,63.6239) rotate(-52.9227)">
                    <title>Sheet.2</title>
                    <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(15.2531,63.2489) rotate(-52.9227)">
                    <title>Sheet.5</title>
                    <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(125.128,63.2489) rotate(-52.9227)">
                    <title>Sheet.6</title>
                    <path d="M0 277 L89.78 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(137.348,-72.2279) rotate(-33.6901)">
                    <title>Sheet.15</title>
                    <path d="M0 277 L129.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-201.5,231.478) rotate(-90.099)">
                    <title>Sheet.16</title>
                    <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-93.3746,231.853) rotate(-90.099)">
                    <title>Sheet.17</title>
                    <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(13.5004,231.478) rotate(-90.099)">
                    <title>Sheet.18</title>
                    <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-93.4996,159.478) rotate(-90.099)">
                    <title>Sheet.54</title>
                    <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(122.25,231.478) rotate(-90.099)">
                    <title>Sheet.55</title>
                    <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(122.125,159.103) rotate(-90.099)">
                    <title>Sheet.56</title>
                    <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(122,86.7284) rotate(-90.099)">
                    <title>Sheet.57</title>
                    <path d="M0 277 L72.38 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-199.747,63.2489) rotate(-52.9227)">
                    <title>Sheet.61</title>
                    <path d="M0 277 L41.59 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-78.277,-71.8529) rotate(-33.6901)">
                    <title>Sheet.62</title>
                    <path d="M0 277 L56.16 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(94.1079,-175.597) rotate(-18.7999)">
                    <title>Sheet.63</title>
                    <path d="M0 277 L98.55 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(15.2531,63.2489) rotate(-52.9227)">
                    <title>Sheet.64</title>
                    <path d="M0 277 L39.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-91.6219,63.6239) rotate(-52.9227)">
                    <title>Sheet.65</title>
                    <path d="M0 277 L39.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(125.128,63.2489) rotate(-52.9227)">
                    <title>Sheet.66</title>
                    <path d="M0 277 L39.8 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(137.348,-72.2279) rotate(-33.6901)">
                    <title>Sheet.67</title>
                    <path d="M0 277 L56.16 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-201.5,231.478) rotate(-90.099)">
                    <title>Sheet.69</title>
                    <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(-93.3746,231.853) rotate(-90.099)">
                    <title>Sheet.70</title>
                    <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(13.5004,231.478) rotate(-90.099)">
                    <title>Sheet.71</title>
                    <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(122.25,231.478) rotate(-90.099)">
                    <title>Sheet.72</title>
                    <path d="M0 277 L33 277" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(445.027,-71.8529) rotate(33.6901) scale(-1,1)">
                    <title>Sheet.77</title>
                    <path d="M0 277 L129.8 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(445.027,-71.8529) rotate(33.6901) scale(-1,1)">
                    <title>Sheet.78</title>
                    <path d="M0 277 L56.16 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(129.5,-46.75) scale(-1,1)">
                    <title>Sheet.81</title>
                    <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                      <title>Sheet.79</title>
                      <path d="M0 277 L89.78 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    </g>
                    <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                      <title>Sheet.80</title>
                      <path d="M0 277 L41.59 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    </g>
                  </g>
                  <g transform="translate(237.5,-46.375) scale(-1,1)">
                    <title>Sheet.82</title>
                    <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                      <title>Sheet.83</title>
                      <path d="M0 277 L89.78 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    </g>
                    <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                      <title>Sheet.84</title>
                      <path d="M0 277 L41.59 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    </g>
                  </g>
                  <g transform="translate(345.5,-46.375) scale(-1,1)">
                    <title>Sheet.85</title>
                    <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                      <title>Sheet.86</title>
                      <path d="M0 277 L89.78 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    </g>
                    <g transform="translate(-220.997,109.999) rotate(-52.9227)">
                      <title>Sheet.87</title>
                      <path d="M0 277 L41.59 277" stroke="#000000" stroke-dasharray="0.75,1.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    </g>
                  </g>
                  <g transform="translate(7.75,-33.25)">
                    <title>Sheet.68</title>
                    <g transform="translate(376.875,-216)">
                      <title>Sheet.3</title>
                      <desc>7</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                    </g>
                    <g>
                      <title>Sheet.8</title>
                      <desc>0</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">0</text>
                    </g>
                    <g transform="translate(53.875,0)">
                      <title>Sheet.9</title>
                      <desc>1</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">1</text>
                    </g>
                    <g transform="translate(108,0)">
                      <title>Sheet.10</title>
                      <desc>2</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">2</text>
                    </g>
                    <g transform="translate(161.875,0)">
                      <title>Sheet.11</title>
                      <desc>3</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">3</text>
                    </g>
                    <g transform="translate(53.875,-72)">
                      <title>Sheet.12</title>
                      <desc>1</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">1</text>
                    </g>
                    <g transform="translate(161.875,-72)">
                      <title>Sheet.13</title>
                      <desc>3</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">3</text>
                    </g>
                    <g transform="translate(161.875,-144)">
                      <title>Sheet.14</title>
                      <desc>3</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">3</text>
                    </g>
                    <g transform="translate(216.5,0)">
                      <title>Sheet.19</title>
                      <desc>4</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">4</text>
                    </g>
                    <g transform="translate(270.375,0)">
                      <title>Sheet.20</title>
                      <desc>5</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">5</text>
                    </g>
                    <g transform="translate(324.125,0)">
                      <title>Sheet.21</title>
                      <desc>6</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">6</text>
                    </g>
                    <g transform="translate(376.875,0)">
                      <title>Sheet.22</title>
                      <desc>7</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                    </g>
                    <g transform="translate(270.375,-72)">
                      <title>Sheet.23</title>
                      <desc>5</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">5</text>
                    </g>
                    <g transform="translate(376.875,-72)">
                      <title>Sheet.24</title>
                      <desc>7</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                    </g>
                    <g transform="translate(376.875,-144)">
                      <title>Sheet.25</title>
                      <desc>7</desc>
                      <ellipse cx="13.5" cy="263.5" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                      <text x="10.46" y="267.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                    </g>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a></figcaption></figure>
<p id="section-4.1.1-6">An algorithm for efficiently calculating the immediately preceding apex is provided in Appendix C.<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-position-index">
<section id="section-4.1.2">
          <h4 id="name-position-index">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-position-index" class="section-name selfRef">Position Index</a>
          </h4>
<p id="section-4.1.2-1">Contains a table of frame number, position pairs pointing to prior locations in the file.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-metadata-index">
<section id="section-4.1.3">
          <h4 id="name-metadata-index">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-metadata-index" class="section-name selfRef">Metadata Index</a>
          </h4>
<p id="section-4.1.3-1">Contains a list of IndexMeta entries. Each entry contains a metadata description and a list of frame indexes (not positions) of frames that match the description.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-integrity-mechanisms">
<section id="section-4.2">
        <h3 id="name-integrity-mechanisms">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-integrity-mechanisms" class="section-name selfRef">Integrity Mechanisms</a>
        </h3>
<p id="section-4.2-1">Frame sequences in a DARE container <span class="bcp14">MAY</span> be protected against a frame insertion attack by means of a digest chain, a binary Merkle tree or both.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="n-digest-chain-calculation">
<section id="section-4.2.1">
          <h4 id="name-digest-chain-calculation">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-digest-chain-calculation" class="section-name selfRef">Digest Chain calculation</a>
          </h4>
<p id="section-4.2.1-1">A digest chain is simple to implement but can only be verified if the full chain of values is known. Appending a frame to the chain has <em>O(1)</em> complexity but verification has <em>O(n)</em> complexity:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<figure id="figure-7">
            <div class="artwork art-svg alignLeft" id="section-4.2.1-2.1">
<svg xmlns="http://www.w3.org/2000/svg" width="6.66927in" height="0.895833in" viewBox="0 0 480.188 64.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 3 1 L 0 0 L 3 -1 L 3 1"></path>
                  </g>
                </defs>
                <g>
                  <title>Page-4</title>
                  <g transform="translate(42.9375,-32.25)">
                    <title>Sheet.21</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(31.6875,-32.25)">
                    <title>Sheet.22</title>
                    <path d="M0 64.5 L54 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(94.6875,-32.25)">
                    <title>Sheet.23</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(83.4375,-32.25)">
                    <title>Sheet.24</title>
                    <path d="M0 64.5 L54 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(150.938,-32.25)">
                    <title>Sheet.25</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(139.687,-32.25)">
                    <title>Sheet.26</title>
                    <path d="M0 64.5 L54 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(202.687,-32.25)">
                    <title>Sheet.27</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(191.437,-32.25)">
                    <title>Sheet.28</title>
                    <path d="M0 64.5 L54 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(261.188,-32.25)">
                    <title>Sheet.29</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(249.937,-32.25)">
                    <title>Sheet.30</title>
                    <path d="M0 64.5 L54 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(312.937,-32.25)">
                    <title>Sheet.31</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(301.687,-32.25)">
                    <title>Sheet.32</title>
                    <path d="M0 64.5 L54 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(372.562,-32.25)">
                    <title>Sheet.33</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(361.313,-32.25)">
                    <title>Sheet.34</title>
                    <path d="M0 64.5 L54 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(424.313,-32.25)">
                    <title>Sheet.35</title>
                    <path d="M0 64.5 L12.83 64.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(413.062,-32.25)">
                    <title>Sheet.36</title>
                    <path d="M0 64.5 L48.37 64.5" stroke="#000000" stroke-dasharray="5.25,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(18.75,-18.75)">
                    <title>Sheet.1</title>
                    <desc>0</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">0</text>
                  </g>
                  <g transform="translate(72.625,-18.75)">
                    <title>Sheet.2</title>
                    <desc>1</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">1</text>
                  </g>
                  <g transform="translate(126.75,-18.75)">
                    <title>Sheet.3</title>
                    <desc>2</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">2</text>
                  </g>
                  <g transform="translate(180.625,-18.75)">
                    <title>Sheet.4</title>
                    <desc>3</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">3</text>
                  </g>
                  <g transform="translate(235,-18.75)">
                    <title>Sheet.5</title>
                    <desc>4</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">4</text>
                  </g>
                  <g transform="translate(288.875,-18.75)">
                    <title>Sheet.6</title>
                    <desc>5</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">5</text>
                  </g>
                  <g transform="translate(342.625,-18.75)">
                    <title>Sheet.7</title>
                    <desc>6</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">6</text>
                  </g>
                  <g transform="translate(395.375,-18.75)">
                    <title>Sheet.8</title>
                    <desc>7</desc>
                    <ellipse cx="13.5" cy="51" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></ellipse>
                    <text x="10.46" y="54.6" fill="#000000" font-family="sans-serif" font-size="1.00001em">7</text>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a></figcaption></figure>
<p id="section-4.2.1-3">The value of the chain digest for the first frame (frame 0) is <em>H(H(null)+H(Payload<sub>0</sub>)), where null is a zero length octet sequence and payloadn is the sequence of payload data bytes for frame n</em><a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">The value of the chain digest for frame <em>n is H(H(Payload<sub>n-1</sub> +H(Payloadn)), where A+B stands for concatenation of the byte sequences A and B.</em><a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-binary-merkle-tree-calculation">
<section id="section-4.2.2">
          <h4 id="name-binary-merkle-tree-calculat">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-binary-merkle-tree-calculat" class="section-name selfRef">Binary Merkle tree calculation</a>
          </h4>
<p id="section-4.2.2-1">The tree index mechanism describe earlier may be used to implement a binary Merkle tree. The value TreeDigest specifies the apex value of the tree for that node.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">Appending a frame to the chain has O(log<sub>2</sub> (n)) complexity provided that the container format supports at least the binary tree index. Verifying a chain has O(log<sub>2</sub> (n)) complexity, provided that the set of necessary digest inputs is known.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">To calculate the value of the tree digest for a node, we first calculate the values of all the sub trees that have their apex at that node and then calculate the digest of that value and the immediately preceding local apex.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-signature-1">
<section id="section-4.2.3">
          <h4 id="name-signature-3">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-signature-3" class="section-name selfRef">Signature</a>
          </h4>
<p id="section-4.2.3-1">Payload data <span class="bcp14">MAY</span> be signed using a JWS <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> as applied in the Envelope.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">Signatures are specified by the <code>Signatures</code> parameter in the content header. The data that the signature is calculated over is defined by the typ parameter of the Signature as follows.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.2.3-3">
            <dt id="section-4.2.3-3.1"><code>Payload</code></dt>
<dd id="section-4.2.3-3.2">
              <p id="section-4.2.3-3.2.1">The value of the <code>PayloadDigest</code> parameter<a href="#section-4.2.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.2.3-3.3"><code>Chain</code></dt>
<dd id="section-4.2.3-3.4">
              <p id="section-4.2.3-3.4.1">The value of the <code>ChainDigest</code> parameter<a href="#section-4.2.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.2.3-3.5"><code>Tree</code></dt>
<dd id="section-4.2.3-3.6">
              <p id="section-4.2.3-3.6.1">The value of the <code>TreeDigestFinal</code> parameter<a href="#section-4.2.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-4.2.3-4">If the <code>typ</code> parameter is absent, the value Payload is implied.<a href="#section-4.2.3-4" class="pilcrow">¶</a></p>
<p id="section-4.2.3-5">A frame <span class="bcp14">MAY</span> contain multiple signatures created with the same signing key and different typ values.<a href="#section-4.2.3-5" class="pilcrow">¶</a></p>
<p id="section-4.2.3-6">The use of signatures over chain and tree digest values permit multiple frames to be validated using a single signature verification operation.<a href="#section-4.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-dare-schema-">
<section id="section-5">
      <h2 id="name-dare-schema">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dare-schema" class="section-name selfRef">DARE Schema</a>
      </h2>
<p id="section-5-1">A DARE Envelope consists of a Header, an Enhanced Data Sequence (EDS) and  an optional trailer. This section describes the JSON data fields used to  construct headers, trailers and complete messages.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Wherever possible, fields from JWE, JWS and JWK have been used. In these cases, the fields have the exact same semantics. Note however that the classes in  which these fields are presented have different structure and nesting.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="n-message-classes-">
<section id="section-5.1">
        <h3 id="name-message-classes">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-message-classes" class="section-name selfRef">Message Classes</a>
        </h3>
<p id="section-5.1-1">A DARE Message contains a single DAREMessageSequence in either the JSON or  Compact serialization as directed by the protocol in which it is applied.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="n-structure-dareenvelopesequence-">
<section id="section-5.1.1">
          <h4 id="name-structure-dareenvelopeseque">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-structure-dareenvelopeseque" class="section-name selfRef">Structure: DareEnvelopeSequence</a>
          </h4>
<p id="section-5.1.1-1">A DARE Message containing Header, EDS and Trailer in JSON object encoding. Since a DAREMessage is almost invariably presented in JSON sequence or compact encoding, use of the DAREMessage subclass is preferred.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">Although a DARE Message is functionally an object, it is serialized as  an ordered sequence. This ensures that the message header field will always precede the body in a serialization, this allowing processing of the header information to be performed before the entire body has been received.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.1.1-3">
            <dt id="section-5.1.1-3.1">Header: DareHeader (Optional) </dt>
<dd id="section-5.1.1-3.2">
              <p id="section-5.1.1-3.2.1">The message header. May specify the key exchange data, pre-signature  or signature data, cloaked headers and/or encrypted data sequences.<a href="#section-5.1.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.1.1-3.3">Body: Binary (Optional) </dt>
<dd id="section-5.1.1-3.4">
              <p id="section-5.1.1-3.4.1">The message body<a href="#section-5.1.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.1.1-3.5">Trailer: DareTrailer (Optional) </dt>
<dd id="section-5.1.1-3.6">
              <p id="section-5.1.1-3.6.1">The message trailer. If present, this contains the signature.<a href="#section-5.1.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="n-header-and-trailer-classes-">
<section id="section-5.2">
        <h3 id="name-header-and-trailer-classes">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-header-and-trailer-classes" class="section-name selfRef">Header and Trailer Classes</a>
        </h3>
<p id="section-5.2-1">A DARE Message sequence MUST contain a (possibly empty) DAREHeader and MAY contain a DARETrailer.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="n-structure-daretrailer-">
<section id="section-5.2.1">
          <h4 id="name-structure-daretrailer">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-structure-daretrailer" class="section-name selfRef">Structure: DareTrailer</a>
          </h4>
<p id="section-5.2.1-1">A DARE Message Trailer<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.2.1-2">
            <dt id="section-5.2.1-2.1">Signatures: DareSignature [0..Many] </dt>
<dd id="section-5.2.1-2.2">
              <p id="section-5.2.1-2.2.1">A list of signatures. A message trailer MUST NOT contain a signatures field if the header contains  a signatures field.<a href="#section-5.2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.1-2.3">SignedData: Binary (Optional) </dt>
<dd id="section-5.2.1-2.4">
              <p id="section-5.2.1-2.4.1">Contains a DAREHeader object<a href="#section-5.2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.1-2.5">PayloadDigest: Binary (Optional) </dt>
<dd id="section-5.2.1-2.6">
              <p id="section-5.2.1-2.6.1">If present, contains the digest of the Payload.<a href="#section-5.2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.1-2.7">ChainDigest: Binary (Optional) </dt>
<dd id="section-5.2.1-2.8">
              <p id="section-5.2.1-2.8.1">If present, contains the digest of the PayloadDigest values of this frame and the frame immediately preceding.<a href="#section-5.2.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.1-2.9">TreeDigest: Binary (Optional) </dt>
<dd id="section-5.2.1-2.10">
              <p id="section-5.2.1-2.10.1">If present, contains the Binary Merkle Tree digest value.<a href="#section-5.2.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-dareheader-">
<section id="section-5.2.2">
          <h4 id="name-structure-dareheader">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-structure-dareheader" class="section-name selfRef">Structure: DareHeader</a>
          </h4>
<dl class="dlParallel" id="section-5.2.2-1">
            <dt id="section-5.2.2-1.1">Inherits: DareTrailer  </dt>
<dd id="section-5.2.2-1.2"><a href="#section-5.2.2-1.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-5.2.2-2">A DARE Message Header. Since any field that is present in a trailer MAY be  placed in a header instead, the message header inherits from the trailer.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.2.2-3">
            <dt id="section-5.2.2-3.1">EnvelopeID: String (Optional) </dt>
<dd id="section-5.2.2-3.2">
              <p id="section-5.2.2-3.2.1">Unique identifier<a href="#section-5.2.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.3">EncryptionAlgorithm: String (Optional) </dt>
<dd id="section-5.2.2-3.4">
              <p id="section-5.2.2-3.4.1">The encryption algorithm as specified in JWE<a href="#section-5.2.2-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.5">DigestAlgorithm: String (Optional) </dt>
<dd id="section-5.2.2-3.6">
              <p id="section-5.2.2-3.6.1">Digest Algorithm. If specified, tells decoder that the digest algorithm is used to construct a signature over the message payload.<a href="#section-5.2.2-3.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.7">Salt: Binary (Optional) </dt>
<dd id="section-5.2.2-3.8">
              <p id="section-5.2.2-3.8.1">Salt value used to derrive cryptographic parameters for the content data.<a href="#section-5.2.2-3.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.9">Malt: Binary (Optional) </dt>
<dd id="section-5.2.2-3.10">
              <p id="section-5.2.2-3.10.1">Hash of the Salt value used to derrive cryptographic parameters for the content data. This field SHOULD NOT be present if the Salt field is present. It is used to allow the salt value to be erased (thus rendering the payload content irrecoverable) without affecting the ability to calculate the payload digest value.<a href="#section-5.2.2-3.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.11">Cloaked: Binary (Optional) </dt>
<dd id="section-5.2.2-3.12">
              <p id="section-5.2.2-3.12.1">If present in a header or trailer, specifies an encrypted data block  containing additional header fields whose values override those specified  in the message and context headers.<a href="#section-5.2.2-3.12.1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3.12.2">When specified in a header, a cloaked field MAY be used to conceal metadata  (content type, compression) and/or to specify an additional layer of key exchange.  That applies to both the Message body and to headers specified within the cloaked  header.<a href="#section-5.2.2-3.12.2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3.12.3">Processing of cloaked data is described in...<a href="#section-5.2.2-3.12.3" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.13">EDSS: Binary [0..Many] </dt>
<dd id="section-5.2.2-3.14">
              <p id="section-5.2.2-3.14.1">If present, the Annotations field contains a sequence of Encrypted Data  Segments encrypted under the message Master Key. The interpretation of these fields  is application specific.<a href="#section-5.2.2-3.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.15">Signers: DareSigner [0..Many] </dt>
<dd id="section-5.2.2-3.16">
              <p id="section-5.2.2-3.16.1">A list of 'presignature'<a href="#section-5.2.2-3.16.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.17">Recipients: DareRecipient [0..Many] </dt>
<dd id="section-5.2.2-3.18">
              <p id="section-5.2.2-3.18.1">A list of recipient key exchange information blocks.<a href="#section-5.2.2-3.18.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.19">ContentMetaData: Binary (Optional) </dt>
<dd id="section-5.2.2-3.20">
              <p id="section-5.2.2-3.20.1">If present contains a JSON encoded ContentInfo structure which specifies plaintext content metadata and forms one of the inputs to the envelope digest value.<a href="#section-5.2.2-3.20.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.21">ContainerInfo: ContainerInfo (Optional) </dt>
<dd id="section-5.2.2-3.22">
              <p id="section-5.2.2-3.22.1">Information that describes container information<a href="#section-5.2.2-3.22.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.2-3.23">ContainerIndex: ContainerIndex (Optional) </dt>
<dd id="section-5.2.2-3.24">
              <p id="section-5.2.2-3.24.1">An index of records in the current container up to but not including this one.<a href="#section-5.2.2-3.24.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-contentmeta-">
<section id="section-5.2.3">
          <h4 id="name-structure-contentmeta">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-structure-contentmeta" class="section-name selfRef">Structure: ContentMeta</a>
          </h4>
<dl class="dlParallel" id="section-5.2.3-1">
            <dt id="section-5.2.3-1.1">UniqueID: String (Optional) </dt>
<dd id="section-5.2.3-1.2">
              <p id="section-5.2.3-1.2.1">Unique object identifier<a href="#section-5.2.3-1.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.3">Labels: String [0..Many] </dt>
<dd id="section-5.2.3-1.4">
              <p id="section-5.2.3-1.4.1">List of labels that are applied to the payload of the frame.<a href="#section-5.2.3-1.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.5">KeyValues: KeyValue [0..Many] </dt>
<dd id="section-5.2.3-1.6">
              <p id="section-5.2.3-1.6.1">List of key/value pairs describing the payload of the frame.<a href="#section-5.2.3-1.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.7">MessageType: String (Optional) </dt>
<dd id="section-5.2.3-1.8">
              <p id="section-5.2.3-1.8.1">The mesh message type<a href="#section-5.2.3-1.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.9">ContentType: String (Optional) </dt>
<dd id="section-5.2.3-1.10">
              <p id="section-5.2.3-1.10.1">The content type field as specified in JWE<a href="#section-5.2.3-1.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.11">Paths: String [0..Many] </dt>
<dd id="section-5.2.3-1.12">
              <p id="section-5.2.3-1.12.1">List of filename paths for the payload of the frame.<a href="#section-5.2.3-1.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.13">Filename: String (Optional) </dt>
<dd id="section-5.2.3-1.14">
              <p id="section-5.2.3-1.14.1">The original filename under which the data was stored.<a href="#section-5.2.3-1.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.15">Event: String (Optional) </dt>
<dd id="section-5.2.3-1.16">
              <p id="section-5.2.3-1.16.1">Operation on the header<a href="#section-5.2.3-1.16.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.17">Created: DateTime (Optional) </dt>
<dd id="section-5.2.3-1.18">
              <p id="section-5.2.3-1.18.1">Initial creation date.<a href="#section-5.2.3-1.18.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.19">Modified: DateTime (Optional) </dt>
<dd id="section-5.2.3-1.20">
              <p id="section-5.2.3-1.20.1">Date of last modification.<a href="#section-5.2.3-1.20.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.21">First: Integer (Optional) </dt>
<dd id="section-5.2.3-1.22">
              <p id="section-5.2.3-1.22.1">Frame number of the first object instance value.<a href="#section-5.2.3-1.22.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.2.3-1.23">Previous: Integer (Optional) </dt>
<dd id="section-5.2.3-1.24">
              <p id="section-5.2.3-1.24.1">Frame number of the immediately prior object instance value<a href="#section-5.2.3-1.24.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="n-cryptographic-data-">
<section id="section-5.3">
        <h3 id="name-cryptographic-data">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-cryptographic-data" class="section-name selfRef">Cryptographic Data</a>
        </h3>
<p id="section-5.3-1">DARE Message uses the same fields as JWE and JWS but with different structure. In particular, DARE messages MAY have multiple recipients and multiple signers.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="n-structure-daresigner-">
<section id="section-5.3.1">
          <h4 id="name-structure-daresigner">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-structure-daresigner" class="section-name selfRef">Structure: DareSigner</a>
          </h4>
<p id="section-5.3.1-1">The signature value<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.3.1-2">
            <dt id="section-5.3.1-2.1">Dig: String (Optional) </dt>
<dd id="section-5.3.1-2.2">
              <p id="section-5.3.1-2.2.1">Digest algorithm hint. Specifying the digest algorithm to be applied to the message body allows the body to be processed in streaming mode.<a href="#section-5.3.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.1-2.3">Alg: String (Optional) </dt>
<dd id="section-5.3.1-2.4">
              <p id="section-5.3.1-2.4.1">Key exchange algorithm<a href="#section-5.3.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.1-2.5">KeyIdentifier: String (Optional) </dt>
<dd id="section-5.3.1-2.6">
              <p id="section-5.3.1-2.6.1">Key identifier of the signature key.<a href="#section-5.3.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.1-2.7">Certificate: X509Certificate (Optional) </dt>
<dd id="section-5.3.1-2.8">
              <p id="section-5.3.1-2.8.1">PKIX certificate of signer.<a href="#section-5.3.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.1-2.9">Path: X509Certificate (Optional) </dt>
<dd id="section-5.3.1-2.10">
              <p id="section-5.3.1-2.10.1">PKIX certificates that establish a trust path for the signer.<a href="#section-5.3.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-x509certificate-">
<section id="section-5.3.2">
          <h4 id="name-structure-x509certificate">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-structure-x509certificate" class="section-name selfRef">Structure: X509Certificate</a>
          </h4>
<dl class="dlParallel" id="section-5.3.2-1">
            <dt id="section-5.3.2-1.1">X5u: String (Optional) </dt>
<dd id="section-5.3.2-1.2">
              <p id="section-5.3.2-1.2.1">URL identifying an X.509 public key certificate<a href="#section-5.3.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.2-1.3">X5: Binary (Optional) </dt>
<dd id="section-5.3.2-1.4">
              <p id="section-5.3.2-1.4.1">An X.509 public key certificate<a href="#section-5.3.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-daresignature-">
<section id="section-5.3.3">
          <h4 id="name-structure-daresignature">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-structure-daresignature" class="section-name selfRef">Structure: DareSignature</a>
          </h4>
<dl class="dlParallel" id="section-5.3.3-1">
            <dt id="section-5.3.3-1.1">Inherits: DareSigner  </dt>
<dd id="section-5.3.3-1.2"><a href="#section-5.3.3-1.2" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-5.3.3-2">The signature value<a href="#section-5.3.3-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.3.3-3">
            <dt id="section-5.3.3-3.1">Manifest: Binary (Optional) </dt>
<dd id="section-5.3.3-3.2">
              <p id="section-5.3.3-3.2.1">The data description that was signed.<a href="#section-5.3.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.3-3.3">SignatureValue: Binary (Optional) </dt>
<dd id="section-5.3.3-3.4">
              <p id="section-5.3.3-3.4.1">The signature value as an Enhanced Data Sequence under the message Master Key.<a href="#section-5.3.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.3-3.5">WitnessValue: Binary (Optional) </dt>
<dd id="section-5.3.3-3.6">
              <p id="section-5.3.3-3.6.1">The signature witness value used on an encrypted message to demonstrate that  the signature was authorized by a party with actual knowledge of the encryption  key used to encrypt the message.<a href="#section-5.3.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-darerecipient-">
<section id="section-5.3.4">
          <h4 id="name-structure-darerecipient">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-structure-darerecipient" class="section-name selfRef">Structure: DareRecipient</a>
          </h4>
<p id="section-5.3.4-1">Recipient information<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.3.4-2">
            <dt id="section-5.3.4-2.1">KeyIdentifier: String (Optional) </dt>
<dd id="section-5.3.4-2.2">
              <p id="section-5.3.4-2.2.1">Key identifier for the encryption key.<a href="#section-5.3.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.3.4-2.2.2">The Key identifier MUST be either a UDF fingerprint of a key or a Group Key Identifier<a href="#section-5.3.4-2.2.2" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.4-2.3">KeyWrapDerivation: String (Optional) </dt>
<dd id="section-5.3.4-2.4">
              <p id="section-5.3.4-2.4.1">The key wrapping and derivation algorithms.<a href="#section-5.3.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.4-2.5">WrappedMasterKey: Binary (Optional) </dt>
<dd id="section-5.3.4-2.6">
              <p id="section-5.3.4-2.6.1">The wrapped master key. The master key is encrypted under the result of the key exchange.<a href="#section-5.3.4-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-5.3.4-2.7">RecipientKeyData: String (Optional) </dt>
<dd id="section-5.3.4-2.8">
              <p id="section-5.3.4-2.8.1">The per-recipient key exchange data.<a href="#section-5.3.4-2.8.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-dare-container-schema-">
<section id="section-6">
      <h2 id="name-dare-container-schema">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-dare-container-schema" class="section-name selfRef">DARE Container Schema</a>
      </h2>
<p id="section-6-1">TBS stuff<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="n-container-headers-">
<section id="section-6.1">
        <h3 id="name-container-headers">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-container-headers" class="section-name selfRef">Container Headers</a>
        </h3>
<p id="section-6.1-1">TBS stuff<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="n-structure-containerinfo-">
<section id="section-6.1.1">
          <h4 id="name-structure-containerinfo">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-structure-containerinfo" class="section-name selfRef">Structure: ContainerInfo</a>
          </h4>
<dl class="dlParallel" id="section-6.1.1-1">
            <dt id="section-6.1.1-1.1">DataEncoding: String (Optional) </dt>
<dd id="section-6.1.1-1.2">
              <p id="section-6.1.1-1.2.1">Specifies the data encoding for the header section of for the following frames. This value is ONLY valid in Frame 0 which MUST have a header encoded in JSON. Information that describes container information<a href="#section-6.1.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.1.1-1.3">Index: Integer (Optional) </dt>
<dd id="section-6.1.1-1.4">
              <p id="section-6.1.1-1.4.1">The record index within the file. This MUST be unique and  satisfy any additional requirements determined by the ContainerType.<a href="#section-6.1.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.1.1-1.5">ContainerType: String (Optional) </dt>
<dd id="section-6.1.1-1.6">
              <p id="section-6.1.1-1.6.1">Specifies the container type for the following records.<a href="#section-6.1.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.1.1-1.7">IsMeta: Boolean (Optional) </dt>
<dd id="section-6.1.1-1.8">
              <p id="section-6.1.1-1.8.1">If true, the current frame is a meta frame and does not contain a payload.<a href="#section-6.1.1-1.8.1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-1.8.2">Note: Meta frames MAY be present in any container. Applications MUST accept containers that contain meta frames at any position in the file. Applications MUST NOT interpret a meta frame as a data frame with an enpty payload.<a href="#section-6.1.1-1.8.2" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.1.1-1.9">Default: Boolean (Optional) </dt>
<dd id="section-6.1.1-1.10">
              <p id="section-6.1.1-1.10.1">If set true in a persistent container, specifies that this record contains the default object for the container.<a href="#section-6.1.1-1.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.1.1-1.11">TreePosition: Integer (Optional) </dt>
<dd id="section-6.1.1-1.12">
              <p id="section-6.1.1-1.12.1">Position of the frame containing the apex of the preceding sub-tree.<a href="#section-6.1.1-1.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.1.1-1.13">IndexPosition: Integer (Optional) </dt>
<dd id="section-6.1.1-1.14">
              <p id="section-6.1.1-1.14.1">Specifies the position in the file at which the last index entry is to be found<a href="#section-6.1.1-1.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.1.1-1.15">ExchangePosition: Integer (Optional) </dt>
<dd id="section-6.1.1-1.16">
              <p id="section-6.1.1-1.16.1">Specifies the position in the file at which the key exchange data is to be found<a href="#section-6.1.1-1.16.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="n-index-structures-">
<section id="section-6.2">
        <h3 id="name-index-structures">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-index-structures" class="section-name selfRef">Index Structures</a>
        </h3>
<p id="section-6.2-1">TBS stuff<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="n-structure-containerindex-">
<section id="section-6.2.1">
          <h4 id="name-structure-containerindex">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-structure-containerindex" class="section-name selfRef">Structure: ContainerIndex</a>
          </h4>
<p id="section-6.2.1-1">A container index<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-6.2.1-2">
            <dt id="section-6.2.1-2.1">Full: Boolean (Optional) </dt>
<dd id="section-6.2.1-2.2">
              <p id="section-6.2.1-2.2.1">If true, the index is complete and contains position entries for all the  frames in the file. If absent or false, the index is incremental and only contains position entries for records added since the last  frame containing a ContainerIndex.<a href="#section-6.2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.2.1-2.3">Positions: IndexPosition [0..Many] </dt>
<dd id="section-6.2.1-2.4">
              <p id="section-6.2.1-2.4.1">List of container position entries<a href="#section-6.2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.2.1-2.5">Metas: IndexMeta [0..Many] </dt>
<dd id="section-6.2.1-2.6">
              <p id="section-6.2.1-2.6.1">List of container position entries<a href="#section-6.2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-indexposition-">
<section id="section-6.2.2">
          <h4 id="name-structure-indexposition">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-structure-indexposition" class="section-name selfRef">Structure: IndexPosition</a>
          </h4>
<p id="section-6.2.2-1">Specifies the position in a file at which a specified record index is found<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-6.2.2-2">
            <dt id="section-6.2.2-2.1">Index: Integer (Optional) </dt>
<dd id="section-6.2.2-2.2">
              <p id="section-6.2.2-2.2.1">The record index within the file.<a href="#section-6.2.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.2.2-2.3">Position: Integer (Optional) </dt>
<dd id="section-6.2.2-2.4">
              <p id="section-6.2.2-2.4.1">The record position within the file relative to the index base.<a href="#section-6.2.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-keyvalue-">
<section id="section-6.2.3">
          <h4 id="name-structure-keyvalue">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-structure-keyvalue" class="section-name selfRef">Structure: KeyValue</a>
          </h4>
<p id="section-6.2.3-1">Specifies a key/value entry<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-6.2.3-2">
            <dt id="section-6.2.3-2.1">Key: String (Optional) </dt>
<dd id="section-6.2.3-2.2">
              <p id="section-6.2.3-2.2.1">The key<a href="#section-6.2.3-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.2.3-2.3">Value: String (Optional) </dt>
<dd id="section-6.2.3-2.4">
              <p id="section-6.2.3-2.4.1">The value corresponding to the key<a href="#section-6.2.3-2.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-structure-indexmeta-">
<section id="section-6.2.4">
          <h4 id="name-structure-indexmeta">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-structure-indexmeta" class="section-name selfRef">Structure: IndexMeta</a>
          </h4>
<p id="section-6.2.4-1">Specifies the list of index entries at which a record with the specified metadata occurrs.<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-6.2.4-2">
            <dt id="section-6.2.4-2.1">Index: Integer [0..Many] </dt>
<dd id="section-6.2.4-2.2">
              <p id="section-6.2.4-2.2.1">List of record indicies within the file where frames matching the specified  criteria are found.<a href="#section-6.2.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.2.4-2.3">ContentType: String (Optional) </dt>
<dd id="section-6.2.4-2.4">
              <p id="section-6.2.4-2.4.1">Content type parameter<a href="#section-6.2.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.2.4-2.5">Paths: String [0..Many] </dt>
<dd id="section-6.2.4-2.6">
              <p id="section-6.2.4-2.6.1">List of filename paths for the current frame.<a href="#section-6.2.4-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-6.2.4-2.7">Labels: String [0..Many] </dt>
<dd id="section-6.2.4-2.8">
              <p id="section-6.2.4-2.8.1">List of labels that are applied to the current frame.<a href="#section-6.2.4-2.8.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-dare-container-applications">
<section id="section-7">
      <h2 id="name-dare-container-applications">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-dare-container-applications" class="section-name selfRef">Dare Container Applications</a>
      </h2>
<p id="section-7-1">DARE Containers are used to implement two forms of persistence store to support Mesh operations:<a href="#section-7-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-7-2">
        <dt id="section-7-2.1">Catalogs</dt>
<dd id="section-7-2.2">
          <p id="section-7-2.2.1">A set of related items which <span class="bcp14">MAY</span> be added, modified or deleted at any time.<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-7-2.3">Spools</dt>
<dd id="section-7-2.4">
          <p id="section-7-2.4.1">A list of related items whose status <span class="bcp14">MAY</span> be changed at any time but which are immutable once added.<a href="#section-7-2.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-7-3">Since DARE Containers are an append only log format, entries can only be modified or deleted by adding items to the log to change the status of previous entries. It is always possible to undo any operation on a catalog or spool unless the underlying container is purged or the individual entries modified.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="n-catalog">
<section id="section-7.1">
        <h3 id="name-catalog">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-catalog" class="section-name selfRef">Catalog</a>
        </h3>
<p id="section-7.1-1">Catalogs contain a set of entries, each of which is distinguished by a unique identifier.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Three operations are supported:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-7.1-3">
          <dt id="section-7.1-3.1">Add</dt>
<dd id="section-7.1-3.2">
            <p id="section-7.1-3.2.1">Addition of the entry to the catalog<a href="#section-7.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-7.1-3.3">Update</dt>
<dd id="section-7.1-3.4">
            <p id="section-7.1-3.4.1">Modification of the data associated with the entry excluding the identifier<a href="#section-7.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-7.1-3.5">Delete</dt>
<dd id="section-7.1-3.6">
            <p id="section-7.1-3.6.1">Removal of the entry from the catalog<a href="#section-7.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-7.1-4">The set of valid state transitions is defined by the Finite State machine:<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">(Add-Update*-Delete)*<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">Catalogs are used to represent sets of persistent objects associated with a Mesh Service Account. The user's set of contacts for example. Each contact entry may be modified many times over time but refers to the same subject for its entire lifetime.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">SchemaCatalog<a href="#section-7.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-spool">
<section id="section-7.2">
        <h3 id="name-spool">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-spool" class="section-name selfRef">Spool</a>
        </h3>
<p id="section-7.2-1">Spools contain lists of entries, each of which is distinguished by a unique identifier.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">Four operations are supported:<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-7.2-3">
          <dt id="section-7.2-3.1">Post</dt>
<dd id="section-7.2-3.2">
            <p id="section-7.2-3.2.1">Addition of the entry to the spool<a href="#section-7.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-7.2-3.3">Processed</dt>
<dd id="section-7.2-3.4">
            <p id="section-7.2-3.4.1">Marks the entry as having been processed.<a href="#section-7.2-3.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-7.2-3.5">Unprocessed</dt>
<dd id="section-7.2-3.6">
            <p id="section-7.2-3.6.1">Returns the entry to the unread state.<a href="#section-7.2-3.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-7.2-3.7">Delete</dt>
<dd id="section-7.2-3.8">
            <p id="section-7.2-3.8.1">Mark the entry as deleted allowing recovery of associated storage in a subsequent purge operation.<a href="#section-7.2-3.8.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-7.2-4">The set of valid state transitions is defined by the Finite State machine:<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">Post-(Processed| Unprocessed| Delete *)<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">Spools are used to represent time sequence ordered entries such as lists of messages being sent or received, task queues and transaction logs.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">SchemaCatalog<a href="#section-7.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-archive">
<section id="section-7.3">
        <h3 id="name-archive">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-archive" class="section-name selfRef">Archive</a>
        </h3>
<p id="section-7.3-1">A DARE Archive is a DARE Container whose entries contain files. This affords the same functionality as a traditional ZIP or tar archive but with the added cryptographic capabilities provided by the DARE format.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-future-work">
<section id="section-8">
      <h2 id="name-future-work">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-future-work" class="section-name selfRef">Future Work</a>
      </h2>
<p id="section-8-1">The current specification describes an approach in which containers are written according to a strict append-only policy. Greater flexibility may be achieved by loosening this requirement allowing record(s) at the end of the container to be overwritten.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="n-terminal-integrity-check">
<section id="section-8.1">
        <h3 id="name-terminal-integrity-check">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-terminal-integrity-check" class="section-name selfRef">Terminal integrity check</a>
        </h3>
<p id="section-8.1-1">A major concern when operating a critical service is the possibility of a hardware or power failure occurring during a write operation causing the file update to be incomplete. While most modern operating systems have effective mechanisms in place to prevent corruption of the file system itself in such circumstances, this does not provide sufficient protection at the application level.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Appending a null record containing a container-specific magic number provides an effective means of detecting this circumstance that can be quickly verified.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">If a container specifies a terminal integrity check value in the header of frame zero, the container is considered to be in an incomplete write state if the final frame is not a null record specifying the magic number.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">When appending new records to such containers, the old terminal integrity check record is overwritten by the data being added and a new integrity check record appended to the end.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-terminal-index-record">
<section id="section-8.2">
        <h3 id="name-terminal-index-record">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-terminal-index-record" class="section-name selfRef">Terminal index record</a>
        </h3>
<p id="section-8.2-1">A writer can maintain a complete (or partial) index of the container in its final record without additional space overhead by overwriting the prior index on each update.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-deferred-indexing">
<section id="section-8.3">
        <h3 id="name-deferred-indexing">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-deferred-indexing" class="section-name selfRef">Deferred indexing</a>
        </h3>
<p id="section-8.3-1">The task of updating terminal indexes may be deferred to a time when the machine is not busy. This improves responsiveness and may avoid the need to re-index containers receiving a sequence of updates.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">This approach may be supported by appending new entries to the end of the container in the usual fashion and maintaining a record of containers to be updated as a separate task.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">When updating the index on a container that has been updated in this fashion, the writer must ensure that no data is lost even if the process is interrupted. The use of guard records and other precautions against loss of state is advised.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">This section describes security considerations arising from the use of DARE in general applications.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Additional security considerations for use of DARE in Mesh services and applications are described in the Mesh Security Considerations guide <span>[<a href="#draft-hallambaker-mesh-security" class="xref">draft-hallambaker-mesh-security</a>]</span>.<a href="#section-9-2" class="pilcrow">¶</a></p>
<div id="n-encryptionsignature-nesting">
<section id="section-9.1">
        <h3 id="name-encryption-signature-nestin">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-encryption-signature-nestin" class="section-name selfRef">Encryption/Signature nesting</a>
      </h3>
</section>
</div>
<div id="n-side-channel">
<section id="section-9.2">
        <h3 id="name-side-channel">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-side-channel" class="section-name selfRef">Side channel</a>
      </h3>
</section>
</div>
<div id="n-salt-reuse">
<section id="section-9.3">
        <h3 id="name-salt-reuse">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-salt-reuse" class="section-name selfRef">Salt reuse</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="n-iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
    </h2>
</section>
</div>
<div id="n-acknowledgements">
<section id="section-11">
      <h2 id="name-acknowledgements">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-11-1">A list of people who have contributed to the design of the Mesh is presented in <span>[<a href="#draft-hallambaker-mesh-architecture" class="xref">draft-hallambaker-mesh-architecture</a>]</span>.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">The name Data At Rest Encryption was proposed by Melhi Abdulhayo?lu.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-appendix-a-dare-envelope-examples-and-test-vectors">
<section id="section-12">
      <h2 id="name-appendix-a-dare-envelope-ex">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-appendix-a-dare-envelope-ex" class="section-name selfRef">Appendix A: DARE Envelope Examples and Test Vectors</a>
    </h2>
</section>
</div>
<div id="n-test-examples-">
<section id="section-13">
      <h2 id="name-test-examples">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-test-examples" class="section-name selfRef">Test Examples</a>
      </h2>
<p id="section-13-1">In the following examples, Alice's encryption private key parameters are:<a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="section-13-2">
<pre class="sourcecode">{
  "PrivateKeyECDH":{
    "crv":"Ed25519",
    "Private":"YgyvWwNuk34RqSHZvwmn6qgOvZlhIdoyzVNceex7k5w"}}</pre><a href="#section-13-2" class="pilcrow">¶</a>
</div>
<p id="section-13-3">Alice's signature private key parameters are:<a href="#section-13-3" class="pilcrow">¶</a></p>
<div id="section-13-4">
<pre class="sourcecode">{
  "PrivateKeyECDH":{
    "crv":"Ed25519",
    "Private":"JWm8_i4mFf8R6cx6pUfVnuMuGab0ZlkAOtQaYmlTdRk"}}</pre><a href="#section-13-4" class="pilcrow">¶</a>
</div>
<p id="section-13-5">The body of the test message is the UTF8 representation of the following string:<a href="#section-13-5" class="pilcrow">¶</a></p>
<div id="section-13-6">
<pre class="sourcecode">"This is a test long enough to require multiple blocks"</pre><a href="#section-13-6" class="pilcrow">¶</a>
</div>
<p id="section-13-7">The EDS sequences, are the UTF8 representation of the following strings:<a href="#section-13-7" class="pilcrow">¶</a></p>
<div id="section-13-8">
<pre class="sourcecode">"Subject: Message metadata should be encrypted"
"2018-02-01"</pre><a href="#section-13-8" class="pilcrow">¶</a>
</div>
<div id="n--plaintext-message-">
<section id="section-13.1">
        <h3 id="name-plaintext-message">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-plaintext-message" class="section-name selfRef">Plaintext Message</a>
        </h3>
<p id="section-13.1-1">A plaintext message without associated EDS sequences is an empty header followed by the message body:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<div id="section-13.1-2">
<pre class="sourcecode">{
  "DareEnvelope":[{},
    "VGhpcyBpcyBhIHRlc3QgbG9uZyBlbm91Z2ggdG8gcmVxdWlyZSBtdWx0aXBsZS
  BibG9ja3M"
    ]}</pre><a href="#section-13.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--plaintext-message-with-eds-">
<section id="section-13.2">
        <h3 id="name-plaintext-message-with-eds">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-plaintext-message-with-eds" class="section-name selfRef">Plaintext Message with EDS</a>
        </h3>
<p id="section-13.2-1">If a plaintext message contains EDS sequences, these are also in plaintext:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<div id="section-13.2-2">
<pre class="sourcecode">{
  "DareEnvelope":[{
      "Annotations":["iAEBiC1TdWJqZWN0OiBNZXNzYWdlIG1ldGFkYXRhIHNob3
  VsZCBiZSBlbmNyeXB0ZWSIAA",
        "iAECiAoyMDE4LTAyLTAxiAA"
        ]},
    "VGhpcyBpcyBhIHRlc3QgbG9uZyBlbm91Z2ggdG8gcmVxdWlyZSBtdWx0aXBsZS
  BibG9ja3M"
    ]}</pre><a href="#section-13.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--encrypted-message-">
<section id="section-13.3">
        <h3 id="name-encrypted-message">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-encrypted-message" class="section-name selfRef">Encrypted Message</a>
        </h3>
<p id="section-13.3-1">The creator generates a master session key:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<div id="section-13.3-2">
<pre class="sourcecode">
  93 53 09 94  F4 C5 D1 17  B3 E1 3E 86  C8 17 FE 3C
  7C 5E A1 BC  12 9B 36 96  2B A3 99 F2  47 6C 74 86</pre><a href="#section-13.3-2" class="pilcrow">¶</a>
</div>
<p id="section-13.3-3">For each recipient of the message:<a href="#section-13.3-3" class="pilcrow">¶</a></p>
<p id="section-13.3-4">The creator generates an ephemeral key:<a href="#section-13.3-4" class="pilcrow">¶</a></p>
<div id="section-13.3-5">
<pre class="sourcecode">{
  "PrivateKeyECDH":{
    "crv":"Ed25519",
    "Private":"oxs52uB94a1ooE3oNsQXWd3Wuk9l7CqZrf-e5MfgYS8"}}</pre><a href="#section-13.3-5" class="pilcrow">¶</a>
</div>
<p id="section-13.3-6">The key agreement value is calculated:<a href="#section-13.3-6" class="pilcrow">¶</a></p>
<div id="section-13.3-7">
<pre class="sourcecode">
  7C 6D D6 B6  33 BB D9 CD  CB C2 EA ED  0D 0D FA 57
  C2 AE 8F 60  C4 6E 5F 18  F4 97 7A 28  12 47 FA F7</pre><a href="#section-13.3-7" class="pilcrow">¶</a>
</div>
<p id="section-13.3-8">The key agreement value is used as the input to a HKDF key derivation function with the info parameter  master to create the key used to wrap the master key:<a href="#section-13.3-8" class="pilcrow">¶</a></p>
<div id="section-13.3-9">
<pre class="sourcecode">
  81 A3 17 09  D3 DB 11 55  EA C5 6F DA  21 86 EA 98
  E0 36 85 5B  54 FE 78 56  0D 9A 5F 2B  80 96 3D A3</pre><a href="#section-13.3-9" class="pilcrow">¶</a>
</div>
<p id="section-13.3-10">The wrapped master key is:<a href="#section-13.3-10" class="pilcrow">¶</a></p>
<div id="section-13.3-11">
<pre class="sourcecode">
  BE 0A EF B8  8A 38 9A A9  56 3F 67 FD  3F CC AC E0
  A6 E8 98 49  57 99 7D 5D  E2 E6 86 3B  CA 12 65 90
  DA 1F 41 42  3E B5 84 2F</pre><a href="#section-13.3-11" class="pilcrow">¶</a>
</div>
<p id="section-13.3-12">This information is used to calculate the Recipient information shown in the example below.<a href="#section-13.3-12" class="pilcrow">¶</a></p>
<p id="section-13.3-13">To encrypt a message, we first generate a unique salt value:<a href="#section-13.3-13" class="pilcrow">¶</a></p>
<div id="section-13.3-14">
<pre class="sourcecode">
  36 41 DD 2F  7D 47 70 75  C6 EB 6C 45  76 04 11 6E</pre><a href="#section-13.3-14" class="pilcrow">¶</a>
</div>
<p id="section-13.3-15">The salt value and master key are used to generate the payload encryption key:<a href="#section-13.3-15" class="pilcrow">¶</a></p>
<div id="section-13.3-16">
<pre class="sourcecode">
  DB D5 2E 6D  0E 4F D6 21  3D 50 40 97  C1 35 70 3A
  14 91 15 AB  72 6C 5F 74  45 0D 14 14  25 29 62 2D</pre><a href="#section-13.3-16" class="pilcrow">¶</a>
</div>
<p id="section-13.3-17">Since AES is a block cipher, we also require an initializarion vector:<a href="#section-13.3-17" class="pilcrow">¶</a></p>
<div id="section-13.3-18">
<pre class="sourcecode">
  66 A4 0B 97  4C 37 DA C0  76 E6 C8 A5  B5 25 F8 55</pre><a href="#section-13.3-18" class="pilcrow">¶</a>
</div>
<p id="section-13.3-19">The output sequence is the encrypted bytes:<a href="#section-13.3-19" class="pilcrow">¶</a></p>
<div id="section-13.3-20">
<pre class="sourcecode">
  96 3B 33 49  E4 40 89 45  59 1C 81 FF  A4 B2 88 58
  B3 08 32 6E  1B CD A6 7A  05 FE 1A ED  64 29 0E 51
  55 03 FE B9  90 BF 36 A5  74 63 19 AD  76 C3 39 47
  69 F3 A5 D9  11 EB 33 28  EF A8 83 A5  25 CD 1D 58</pre><a href="#section-13.3-20" class="pilcrow">¶</a>
</div>
<p id="section-13.3-21">Since the message is not signed, there is no need for a trailer. The completed message is:<a href="#section-13.3-21" class="pilcrow">¶</a></p>
<div id="section-13.3-22">
<pre class="sourcecode">{
  "DareEnvelope":[{
      "enc":"A256CBC",
      "Salt":"NkHdL31HcHXG62xFdgQRbg",
      "recipients":[{
          "kid":"MDW4-OC5J-T6AW-BXGT-YCAZ-3VFB-B7MG",
          "epk":{
            "PublicKeyECDH":{
              "crv":"Ed25519",
              "Public":"5dMMgpgHv7vsdwT1Q9fLDpjQTsG0WhEaJPNtyl-6HmM"}
                  },
          "wmk":"vgrvuIo4mqlWP2f9P8ys4KbomElXmX1d4uaGO8oSZZDaH0FCPr
  WELw"}
        ]},
    "ljszSeRAiUVZHIH_pLKIWLMIMm4bzaZ6Bf4a7WQpDlFVA_65kL82pXRjGa12wz
  lHafOl2RHrMyjvqIOlJc0dWA"
    ]}</pre><a href="#section-13.3-22" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--signed-message-">
<section id="section-13.4">
        <h3 id="name-signed-message">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-signed-message" class="section-name selfRef">Signed Message</a>
        </h3>
<p id="section-13.4-1">Signed messages specify the digest algorithm to be used in the header and the signature value in the trailer. Note that the digest algorithm is not optional since it serves as notice that a decoder should digest the payload value  to enable signature verification.<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<div id="section-13.4-2">
<pre class="sourcecode">{
  "DareEnvelope":[{
      "dig":"SHA2"},
    "VGhpcyBpcyBhIHRlc3QgbG9uZyBlbm91Z2ggdG8gcmVxdWlyZSBtdWx0aXBsZS
  BibG9ja3M",
    {
      "signatures":[{
          "alg":"SHA2",
          "kid":"MC7T-C6CR-THZN-35QU-7GLC-GILJ-ZV7K",
          "signature":"f8fj6eOwbrLaSDgAmzW-qj95Z7DUkMkvrTEFlRXDbRgG
  BMjuVktELASgUlcD-_kdLEDMMOKKTuuJ2-sIiY06BA"}
        ],
      "PayloadDigest":"raim8SV5adPbWWn8FMM4mrRAQCO9A2jZ0NZAnFXWlG0x
  F6sWGJbnKSdtIJMmMU_hjarlIPEoY3vy9UdVlH5KAg"}
    ]}</pre><a href="#section-13.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--signed-and-encrypted-message-">
<section id="section-13.5">
        <h3 id="name-signed-and-encrypted-messag">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-signed-and-encrypted-messag" class="section-name selfRef">Signed and Encrypted Message</a>
        </h3>
<p id="section-13.5-1">A signed and encrypted message is encrypted and then signed. The signer proves knowledge of the payload plaintext by providing the plaintext witness value.<a href="#section-13.5-1" class="pilcrow">¶</a></p>
<div id="section-13.5-2">
<pre class="sourcecode">{
  "DareEnvelope":[{
      "enc":"A256CBC",
      "dig":"SHA2",
      "Salt":"kZlrg_NXLMIneamI7NIq0A",
      "recipients":[{
          "kid":"MDW4-OC5J-T6AW-BXGT-YCAZ-3VFB-B7MG",
          "epk":{
            "PublicKeyECDH":{
              "crv":"Ed25519",
              "Public":"BtzafehndD3P0hXtZrDyulloJouPL-aAaejtVQoK4FY"}
                  },
          "wmk":"Ai5gfoA6l7fIDIQ9An5nfq87khaGs0dfvHxn2QqejqZb79iLKb
  3z3w"}
        ]},
    "XjZFDcwG3N7M55BbU675s0gV32rraZKjz5khZDRPHROAgxmiP5YJzxArKgXOih
  iW90exJlH1QcDr4AKghm-hYA",
    {
      "signatures":[{
          "alg":"SHA2",
          "kid":"MC7T-C6CR-THZN-35QU-7GLC-GILJ-ZV7K",
          "signature":"MqWR5bDbZ8_N01LlItVJ54UyIyaFcVu9Nh8OBX0cWq8O
  KSunykIWrPbYjCTNC7s1dcD2RoT_psx6PmL-EfAGDA",
          "witness":"euia295oDy60QLNrb3UVCB57R25J3OcCd9jZxM11B8Y"}
        ],
      "PayloadDigest":"obHGC-2CsriBsWNGrJNLt0zzQcY6GMrUah8K7xSXnnOC
  UfGv8GDtJQrhbxcaL3TELz6takJvnAAzmvAyFfovhQ"}
    ]}</pre><a href="#section-13.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="n-appendix-b-dare-container-examples-and-test-vectors">
<section id="section-14">
      <h2 id="name-appendix-b-dare-container-e">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-appendix-b-dare-container-e" class="section-name selfRef">Appendix B: DARE Container Examples and Test Vectors</a>
      </h2>
<p id="section-14-1">The data payloads in all the following examples are identical, only the authentication and/or encryption is different.<a href="#section-14-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-14-2.1"> Frame 1..n consists of 300 bytes being the byte sequence 00, 01, 02, etc.  repeating after 256 bytes.<a href="#section-14-2.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-14-3">For conciseness, the raw data format is omitted for examples after the first, except where the data payload has been transformed, (i.e. encrypted).<a href="#section-14-3" class="pilcrow">¶</a></p>
<div id="n-simple-container-">
<section id="section-14.1">
        <h3 id="name-simple-container">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-simple-container" class="section-name selfRef">Simple container</a>
        </h3>
<p id="section-14.1-1">the following example shows a simple container with first frame and a single data frame:<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<div id="section-14.1-2">
<pre class="sourcecode">f4 82
f0 7c
f0 00
f0 00
82 f4
f5 01 74
f0 43
f1 01 2c
74 01 f5</pre><a href="#section-14.1-2" class="pilcrow">¶</a>
</div>
<p id="section-14.1-3">Since there is no integrity check, there is no need for trailer entries. The header values are:<a href="#section-14.1-3" class="pilcrow">¶</a></p>
<p id="section-14.1-4">Frame 0<a href="#section-14.1-4" class="pilcrow">¶</a></p>
<div id="section-14.1-5">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "DataEncoding": "JSON",
    "Index": 0,
    "ContainerType": "List"}}

[Empty trailer]</pre><a href="#section-14.1-5" class="pilcrow">¶</a>
</div>
<p id="section-14.1-6">Frame 1<a href="#section-14.1-6" class="pilcrow">¶</a></p>
<div id="section-14.1-7">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 1}}

[Empty trailer]</pre><a href="#section-14.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-payload-and-chain-digests-">
<section id="section-14.2">
        <h3 id="name-payload-and-chain-digests">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-payload-and-chain-digests" class="section-name selfRef">Payload and chain digests</a>
        </h3>
<p id="section-14.2-1">The following example shows a chain container with a first frame and three  data frames. The headers of these frames is the same as before but the frames now have trailers specifying the PayloadDigest and ChainDigest values:<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">Frame 0<a href="#section-14.2-2" class="pilcrow">¶</a></p>
<div id="section-14.2-3">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "DataEncoding": "JSON",
    "Index": 0,
    "ContainerType": "Chain"}}

[Empty trailer]</pre><a href="#section-14.2-3" class="pilcrow">¶</a>
</div>
<p id="section-14.2-4">Frame 1<a href="#section-14.2-4" class="pilcrow">¶</a></p>
<div id="section-14.2-5">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 1}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "ChainDigest": "T7S1FcrgY3AaWD4L-t5W1K-3XYkPTcOdGEGyjglTD6yMYVR
  Vz9tn_KQc6GdA-P4VSRigBygV65OEd2Vv3YDhww"}</pre><a href="#section-14.2-5" class="pilcrow">¶</a>
</div>
<p id="section-14.2-6">Frame 2<a href="#section-14.2-6" class="pilcrow">¶</a></p>
<div id="section-14.2-7">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 2}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "ChainDigest": "T7S1FcrgY3AaWD4L-t5W1K-3XYkPTcOdGEGyjglTD6yMYVR
  Vz9tn_KQc6GdA-P4VSRigBygV65OEd2Vv3YDhww"}</pre><a href="#section-14.2-7" class="pilcrow">¶</a>
</div>
<p id="section-14.2-8">Frame 3<a href="#section-14.2-8" class="pilcrow">¶</a></p>
<div id="section-14.2-9">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 3}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "ChainDigest": "T7S1FcrgY3AaWD4L-t5W1K-3XYkPTcOdGEGyjglTD6yMYVR
  Vz9tn_KQc6GdA-P4VSRigBygV65OEd2Vv3YDhww"}</pre><a href="#section-14.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-merkle-tree-">
<section id="section-14.3">
        <h3 id="name-merkle-tree">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-merkle-tree" class="section-name selfRef">Merkle Tree</a>
        </h3>
<p id="section-14.3-1">The following example shows a chain container with a first frame and six  data frames. The trailers now contain the TreePosition and TreeDigest values:<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<p id="section-14.3-2">Frame 0<a href="#section-14.3-2" class="pilcrow">¶</a></p>
<div id="section-14.3-3">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "DataEncoding": "JSON",
    "Index": 0,
    "ContainerType": "Merkle"}}

[Empty trailer]</pre><a href="#section-14.3-3" class="pilcrow">¶</a>
</div>
<p id="section-14.3-4">Frame 1<a href="#section-14.3-4" class="pilcrow">¶</a></p>
<div id="section-14.3-5">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 1,
    "TreePosition": 0}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "T7S1FcrgY3AaWD4L-t5W1K-3XYkPTcOdGEGyjglTD6yMYVRV
  z9tn_KQc6GdA-P4VSRigBygV65OEd2Vv3YDhww"}</pre><a href="#section-14.3-5" class="pilcrow">¶</a>
</div>
<p id="section-14.3-6">Frame 2<a href="#section-14.3-6" class="pilcrow">¶</a></p>
<div id="section-14.3-7">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 2,
    "TreePosition": 360}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "7fHmkEIsPkN6sDYAOLvpIJn5Dg3PxDDAaq-ll2kh8722kokk
  FnZQcYtjuVC71aHNXI18q-lPnfRkmwryG-bhqQ"}</pre><a href="#section-14.3-7" class="pilcrow">¶</a>
</div>
<p id="section-14.3-8">Frame 3<a href="#section-14.3-8" class="pilcrow">¶</a></p>
<div id="section-14.3-9">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 3,
    "TreePosition": 360}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "T7S1FcrgY3AaWD4L-t5W1K-3XYkPTcOdGEGyjglTD6yMYVRV
  z9tn_KQc6GdA-P4VSRigBygV65OEd2Vv3YDhww"}</pre><a href="#section-14.3-9" class="pilcrow">¶</a>
</div>
<p id="section-14.3-10">Frame 4<a href="#section-14.3-10" class="pilcrow">¶</a></p>
<div id="section-14.3-11">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 4,
    "TreePosition": 1612}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "vJ6ngNATvZcXSMALi5IUqzl1GBxBnTNVcC87VL_BhMRCbAvK
  Sj8gs0VFgxxLkZ2myrtaDIwhHoswiTiBMLNWug"}</pre><a href="#section-14.3-11" class="pilcrow">¶</a>
</div>
<p id="section-14.3-12">Frame 5<a href="#section-14.3-12" class="pilcrow">¶</a></p>
<div id="section-14.3-13">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 5,
    "TreePosition": 1612}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "T7S1FcrgY3AaWD4L-t5W1K-3XYkPTcOdGEGyjglTD6yMYVRV
  z9tn_KQc6GdA-P4VSRigBygV65OEd2Vv3YDhww"}</pre><a href="#section-14.3-13" class="pilcrow">¶</a>
</div>
<p id="section-14.3-14">Frame 6<a href="#section-14.3-14" class="pilcrow">¶</a></p>
<div id="section-14.3-15">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 6,
    "TreePosition": 2867}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "WgHlz3EHczVPqgtpc39Arv7CFIsCbFVsk8wg0j2qLlEfur9S
  Z0mdr65Ka-HF0Qx8gg_DAoiJwUrwADDXyxVJOg"}</pre><a href="#section-14.3-15" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-signed-container-">
<section id="section-14.4">
        <h3 id="name-signed-container">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-signed-container" class="section-name selfRef">Signed container</a>
        </h3>
<p id="section-14.4-1">The following example shows a tree container with a signature in the final record. The signing key parameters are:<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<div id="section-14.4-2">
<pre class="sourcecode">{
  "PrivateKeyECDH":{
    "crv":"Ed25519",
    "Private":"JWm8_i4mFf8R6cx6pUfVnuMuGab0ZlkAOtQaYmlTdRk"}}</pre><a href="#section-14.4-2" class="pilcrow">¶</a>
</div>
<p id="section-14.4-3">The container headers and trailers are:<a href="#section-14.4-3" class="pilcrow">¶</a></p>
<p id="section-14.4-4">Frame 0<a href="#section-14.4-4" class="pilcrow">¶</a></p>
<div id="section-14.4-5">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "DataEncoding": "JSON",
    "Index": 0,
    "ContainerType": "Merkle"}}

[Empty trailer]</pre><a href="#section-14.4-5" class="pilcrow">¶</a>
</div>
<p id="section-14.4-6">Frame 1<a href="#section-14.4-6" class="pilcrow">¶</a></p>
<div id="section-14.4-7">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 1,
    "TreePosition": 0}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "T7S1FcrgY3AaWD4L-t5W1K-3XYkPTcOdGEGyjglTD6yMYVRV
  z9tn_KQc6GdA-P4VSRigBygV65OEd2Vv3YDhww"}</pre><a href="#section-14.4-7" class="pilcrow">¶</a>
</div>
<p id="section-14.4-8">Frame 2<a href="#section-14.4-8" class="pilcrow">¶</a></p>
<div id="section-14.4-9">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 2,
    "TreePosition": 360}}

{
  "PayloadDigest": "8dyi62d7MDJlsLm6_w4GEgKBjzXBRwppu6qbtmAl6UjZD
  lZeaWQlBsYhOu88-ekpNXpZ2iY96zTRI229zaJ5sw",
  "TreeDigest": "7fHmkEIsPkN6sDYAOLvpIJn5Dg3PxDDAaq-ll2kh8722kokk
  FnZQcYtjuVC71aHNXI18q-lPnfRkmwryG-bhqQ"}</pre><a href="#section-14.4-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-encrypted-container-">
<section id="section-14.5">
        <h3 id="name-encrypted-container">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-encrypted-container" class="section-name selfRef">Encrypted container</a>
        </h3>
<p id="section-14.5-1">The following example shows a container in which all the frame payloads are encrypted  under the same master secret established in a key agreement specified in the first frame.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<p id="section-14.5-2">Frame 0<a href="#section-14.5-2" class="pilcrow">¶</a></p>
<div id="section-14.5-3">
<pre class="sourcecode">{
  "enc": "A256CBC",
  "Salt": "R1Y3DxdC5H9efFRQdvGMSA",
  "recipients": [{
      "kid": "MDW4-OC5J-T6AW-BXGT-YCAZ-3VFB-B7MG",
      "epk": {
        "PublicKeyECDH": {
          "crv": "Ed25519",
          "Public": "3PR_wusc8XRV44YD2-jXqrpYLXQp79a6-iLQWto2HOs"}},
      "wmk": "KfF8MMItf9HmdtZU3t5bZUCc_5h5wT_pdSV3dVQg5UvoN8EuYNOXkg"
          }],
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "DataEncoding": "JSON",
    "Index": 0,
    "ContainerType": "List"}}

[Empty trailer]</pre><a href="#section-14.5-3" class="pilcrow">¶</a>
</div>
<p id="section-14.5-4">Frame 1<a href="#section-14.5-4" class="pilcrow">¶</a></p>
<div id="section-14.5-5">
<pre class="sourcecode">{
  "enc": "A256CBC",
  "Salt": "BJih1YYYl-NA1tLYuVhbDQ",
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 1}}

[Empty trailer]</pre><a href="#section-14.5-5" class="pilcrow">¶</a>
</div>
<p id="section-14.5-6">Frame 2<a href="#section-14.5-6" class="pilcrow">¶</a></p>
<div id="section-14.5-7">
<pre class="sourcecode">{
  "enc": "A256CBC",
  "Salt": "ikAqoKLde7dWZnYC5m8dbg",
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 2}}

[Empty trailer]</pre><a href="#section-14.5-7" class="pilcrow">¶</a>
</div>
<p id="section-14.5-8">Here are the container bytes. Note that the content is now encrypted and has expanded by 25 bytes. These are the salt (16 bytes), the AES padding (4 bytes) and the  JSON-B framing (5 bytes).<a href="#section-14.5-8" class="pilcrow">¶</a></p>
<div id="section-14.5-9">
<pre class="sourcecode">f5 01 e5
f1 01 ce
f0 10
f0 00
e5 01 f5
f5 01 b0
f0 7b
f1 01 30
b0 01 f5
f5 01 b0
f0 7b
f1 01 30
b0 01 f5

</pre><a href="#section-14.5-9" class="pilcrow">¶</a>
</div>
<p id="section-14.5-10">The following example shows a container in which all the frame payloads are encrypted  under separate key agreements specified in the payload frames.<a href="#section-14.5-10" class="pilcrow">¶</a></p>
<p id="section-14.5-11">Frame 0<a href="#section-14.5-11" class="pilcrow">¶</a></p>
<div id="section-14.5-12">
<pre class="sourcecode">{
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "DataEncoding": "JSON",
    "Index": 0,
    "ContainerType": "List"}}

[Empty trailer]</pre><a href="#section-14.5-12" class="pilcrow">¶</a>
</div>
<p id="section-14.5-13">Frame 1<a href="#section-14.5-13" class="pilcrow">¶</a></p>
<div id="section-14.5-14">
<pre class="sourcecode">{
  "enc": "A256CBC",
  "Salt": "R2EXKJQEtN_afGwOWR22gw",
  "recipients": [{
      "kid": "MDW4-OC5J-T6AW-BXGT-YCAZ-3VFB-B7MG",
      "epk": {
        "PublicKeyECDH": {
          "crv": "Ed25519",
          "Public": "s09EZ1rXTEumntSe3iuPLmzNsAD6Hg0B1Blch9c05HQ"}},
      "wmk": "KHaQEptXjmk9A-sQeY0Rahc5SfPDCj_AFBWQCzApPI1Wt6zy3VTUCw"
          }],
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 1}}

[Empty trailer]</pre><a href="#section-14.5-14" class="pilcrow">¶</a>
</div>
<p id="section-14.5-15">Frame 2<a href="#section-14.5-15" class="pilcrow">¶</a></p>
<div id="section-14.5-16">
<pre class="sourcecode">{
  "enc": "A256CBC",
  "Salt": "b0Cl1MCCpc2ZSMu4U1C3GA",
  "recipients": [{
      "kid": "MDW4-OC5J-T6AW-BXGT-YCAZ-3VFB-B7MG",
      "epk": {
        "PublicKeyECDH": {
          "crv": "Ed25519",
          "Public": "NH799YFaKDv8UrYNwNs0NMreuX4R3ylcU5-8iZ0LorI"}},
      "wmk": "JGyrAmtTgeQ4WGz-E04Ru7etlmZ7m7BMsXOckCVJobCKJojNfbnrOA"
          }],
  "ContentMetaData": "e30",
  "ContainerInfo": {
    "Index": 2}}

[Empty trailer]</pre><a href="#section-14.5-16" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="n-appendix-c-previous-frame-function-">
<section id="section-15">
      <h2 id="name-appendix-c-previous-frame-f">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-appendix-c-previous-frame-f" class="section-name selfRef">Appendix C: Previous Frame Function</a>
      </h2>
<div id="section-15-1">
<pre class="sourcecode">public long PreviousFrame (long Frame) {
    long x2 = Frame + 1;
    long d = 1;

    while (x2 &gt; 0) {
        if ((x2 &amp; 1) == 1) {
            return x2 == 1 ? (d / 2) - 1 : Frame - d;
            }
        d = d * 2;
        x2 = x2 / 2;
        }
    return 0;
    }</pre><a href="#section-15-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-appendix-d-outstanding-issues">
<section id="section-16">
      <h2 id="name-appendix-d-outstanding-issu">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-appendix-d-outstanding-issu" class="section-name selfRef">Appendix D: Outstanding Issues</a>
      </h2>
<p id="section-16-1">The following issues need to be addressed.<a href="#section-16-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">
Issue</th>
            <th class="text-left" rowspan="1" colspan="1">
Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
X25519</td>
            <td class="text-left" rowspan="1" colspan="1">
The examples currently use Edwards Curve25519 for encryption. This should be Curve X25519</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
Indexing</td>
            <td class="text-left" rowspan="1" colspan="1">
No examples are given of indexing a container</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
Archive</td>
            <td class="text-left" rowspan="1" colspan="1">
Should include a file archive example</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
File Path</td>
            <td class="text-left" rowspan="1" colspan="1">
Mention the file path security issue in the security considerations</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
Security Considerations</td>
            <td class="text-left" rowspan="1" colspan="1">
Write Security considerations</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
AES-GCM</td>
            <td class="text-left" rowspan="1" colspan="1">
Switch to using AES GCM in the examples </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
Witness</td>
            <td class="text-left" rowspan="1" colspan="1">
Complete handling of witness values.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
Schema</td>
            <td class="text-left" rowspan="1" colspan="1">
Complete the schema documentation</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
Container Redo</td>
            <td class="text-left" rowspan="1" colspan="1">
Rework the container/header objects so that these are separate classes and Header is an entry in the Container header.</td>
          </tr>
        </tbody>
      </table>
<p id="section-16-3"><a href="#section-16-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-17">
      <h2 id="name-normative-references">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="draft-hallambaker-jsonbcd">[draft-hallambaker-jsonbcd]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Binary Encodings for JavaScript Object Notation: JSON-B, JSON-C, JSON-D"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-jsonbcd-15</span>, <time datetime="2019-10-23">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-jsonbcd-15">https://tools.ietf.org/html/draft-hallambaker-jsonbcd-15</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-architecture">[draft-hallambaker-mesh-architecture]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part I: Architecture Guide"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-architecture-12</span>, <time datetime="2020-01-16">16 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-architecture-12">https://tools.ietf.org/html/draft-hallambaker-mesh-architecture-12</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-security">[draft-hallambaker-mesh-security]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part VII: Security Considerations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-security-02</span>, <time datetime="2019-10-23">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-security-02">https://tools.ietf.org/html/draft-hallambaker-mesh-security-02</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-udf">[draft-hallambaker-mesh-udf]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part II: Uniform Data Fingerprint."</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-udf-08</span>, <time datetime="2020-01-06">6 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-udf-08">https://tools.ietf.org/html/draft-hallambaker-mesh-udf-08</a>&gt;</span>. </dd>
<dt id="IANAJOSE">[IANAJOSE]</dt>
<dd>
<span class="refTitle">"[Reference Not Found!]"</span>, <time></time>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC2315">[RFC2315]</dt>
<dd>
<span class="refAuthor">Kaliski, B.</span>, <span class="refTitle">"PKCS #7: Cryptographic Message Syntax Version 1.5"</span>, <span class="seriesInfo">RFC 2315</span>, <span class="seriesInfo">DOI 10.17487/RFC2315</span>, <time datetime="1998-03">March 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2315">https://www.rfc-editor.org/rfc/rfc2315</a>&gt;</span>. </dd>
<dt id="RFC3394">[RFC3394]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3394">https://www.rfc-editor.org/rfc/rfc3394</a>&gt;</span>. </dd>
<dt id="RFC4880">[RFC4880]</dt>
<dd>
<span class="refAuthor">Callas, J.</span><span class="refAuthor">, Donnerhacke, L.</span><span class="refAuthor">, Finney, H.</span><span class="refAuthor">, Shaw, D.</span><span class="refAuthor">, and R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 4880</span>, <span class="seriesInfo">DOI 10.17487/RFC4880</span>, <time datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4880">https://www.rfc-editor.org/rfc/rfc4880</a>&gt;</span>. </dd>
<dt id="RFC4949">[RFC4949]</dt>
<dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dt id="RFC5869">[RFC5869]</dt>
<dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor"> and P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dt id="RFC6838">[RFC6838]</dt>
<dd>
<span class="refAuthor">Freed, N.</span><span class="refAuthor">, Klensin, J.</span><span class="refAuthor">, and T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>&gt;</span>. </dd>
<dt id="RFC7159">[RFC7159]</dt>
<dd>
<span class="refAuthor">Bray, T.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7159">https://www.rfc-editor.org/rfc/rfc7159</a>&gt;</span>. </dd>
<dt id="RFC7515">[RFC7515]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dt id="RFC7516">[RFC7516]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
<dt id="RFC7517">[RFC7517]</dt>
<dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dt id="RFC7518">[RFC7518]</dt>
<dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-18">
      <h2 id="name-informative-references">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="BLOCKCHAIN">[BLOCKCHAIN]</dt>
<dd>
<span class="refAuthor">Chain.com</span>, <span class="refTitle">"Blockchain Specification"</span>, <time></time>. </dd>
<dt id="Davis2001">[Davis2001]</dt>
<dd>
<span class="refAuthor">Davis, D.</span>, <span class="refTitle">"Defective Sign &amp; Encrypt in S/MIME, PKCS#7, MOSS, PEM, PGP, and XML"</span>, <time datetime="2001-05">May 2001</time>. </dd>
<dt id="RFC5652">[RFC5652]</dt>
<dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dt id="ZIPFILE">[ZIPFILE]</dt>
<dd>
<span class="refAuthor">PKWARE Inc</span>, <span class="refTitle">"APPNOTE.TXT - .ZIP File Format Specification"</span>, <time datetime="2014-10">October 2014</time>. </dd>
</dl>
</section>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
