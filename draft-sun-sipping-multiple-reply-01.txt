


Network Working Group                                             Q. Sun
Internet-Draft                                                   L. Tian
Expires: April 14, 2008                                           D. Ren
                                                     Huawei Technologies
                                                        October 12, 2007


 Multiple Reply to MESSAGE requests in the Session Initiation Protocol
                                 (SIP)
                  draft-sun-sipping-multiple-reply-01

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 14, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2007).












Sun, et al.              Expires April 14, 2008                 [Page 1]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


Abstract

   This document defines a multiple target address extension to the
   Reply-To header field for the SIP MESSAGE method.  The extension
   includes the use of a pointer to a Uniform Resource Identifier (URI)-
   list in the Reply-To header field.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  5
   3.  URI-List Document Format . . . . . . . . . . . . . . . . . . .  6
   4.  Procedures at the Reply-Issuer . . . . . . . . . . . . . . . .  8
   5.  Procedures at the Reply-Recipient  . . . . . . . . . . . . . .  9
   6.  Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
     6.1.  Reply-Recipient uses MESSAGE URI-List service to send
           reply MESSAGE requests . . . . . . . . . . . . . . . . . . 10
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . . 13
   8.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 14
   9.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 15
   10. References . . . . . . . . . . . . . . . . . . . . . . . . . . 16
     10.1. Normative References . . . . . . . . . . . . . . . . . . . 16
     10.2. Informative References . . . . . . . . . . . . . . . . . . 16
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 17
   Intellectual Property and Copyright Statements . . . . . . . . . . 18

























Sun, et al.              Expires April 14, 2008                 [Page 2]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


1.  Introduction

   RFC 3261 [2] defines a Reply-To header field containing a logical
   return URI that may be different from the From header field.  For
   example, the URI MAY be used to return missed calls or unestablished
   sessions.

   RFC 3428 [3] further defines the Reply-To as an optional header field
   that can be used and present in MESSAGE requests and responses.  This
   allows a Reply-Issuer to provide the Reply-Recipient with one User
   Agent (UA) as the target of a reply MESSAGE request.

   However, in some scenarios, the Reply-Issuer may want the Reply-
   Recipient to send reply MESSAGE requests to a list of UAs, as opposed
   to just one UA.  For example, a manager sends a message to request a
   secretary to prepare meeting arrangements.  In the message, the
   manager provides a list of meeting attendees.  When the secretary
   schedules the meeting, the secretary sends the meeting information in
   a reply MESSAGE to the list of attendees.  Another use case may be
   for an application to send a notification to a user to respond with
   certain information, such as a project report, to a list of users.
   As with the previous example, the original message itself is not
   meaningful for the intended recipients.

   At present, there is no mechanism to convey a list of users to which
   a UAC can respond.  This specification extends the Reply-To mechanism
   to fulfill the requirement by defining the use of a URI-List in the
   Reply-to header.  With this specification, the Reply-Issuer sends to
   a Reply-Recipient a MESSAGE request with a Reply-To header pointing
   to a Uniform Resource List (URI-list) containing the targets of a
   reply MESSAGE request.  Another possible solution is to define a new
   SIP header field e.g.  "Addtional-Reply-To" which is able to carry
   mutiple reply targets.  This seems much simpler, but can not indicate
   more elaborate intention e.g. "bcc".

   The Reply-Recipient can create a reply MESSAGE request for each entry
   in the URI-List and send them respectively, or can send a reply
   MESSAGE to a MESSAGE URI-list service [9] to distribute the reply
   MESSAGE requests.  The Reply-Recipient may modify the provided list
   to add or remove recipients.

   The requirements to support Multiple Reply to MESSAGE requests may be
   summarized as follows:








Sun, et al.              Expires April 14, 2008                 [Page 3]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


      REQ-1: It MUST be possible for a Reply-Issuer to specify multiple
      reply targets in a MESSAGE request, where the identities of the
      reply targets are carried in the request itself.
















































Sun, et al.              Expires April 14, 2008                 [Page 4]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [1].

   This document defines the following new terms:

      Reply-Issuer: the user agent issuing the SIP request with Reply-To
      header field.

      Reply-Recipient: the user agent receiving the SIP request with
      Reply-To header field.






































Sun, et al.              Expires April 14, 2008                 [Page 5]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


3.  URI-List Document Format

   As described in the Framework and Security Considerations for SIP
   URI-List Services [4] , specifications of individual URI-list
   services, need to specify a default format for 'recipient-list'
   bodies used within the particular service.

   The default format for 'recipient-list' bodies for multiple reply is
   XML Resource Lists [7] extended with Copy Control Attribute [8] .
   Reply-Issuer and Reply-Recipient MUST support both these formats and
   MAY support other formats.

   As described in Copy Control Attribute [8] , each URI can be tagged
   with a 'copyControl' attribute set to either "to", "cc", or "bcc",
   indicating the role in which the recipient will receive the reply
   MESSAGE request.  Additionally, URIs can be tagged with the
   'anonymize' attribute to prevent that the Reply-Recipient (UAS) from
   disclosing the target URI in a URI-list.

   In addition, the XML Resource Lists [7] defines a 'recipient-list-
   history' body that contains the list of recipients.  The default
   format for 'recipient-list-history' bodies for UAs is also the XML
   Resource Lists [7] extended with the Copy Control Attribute [8] .  If
   the Reply-Recipient sends reply MESSAGE requests to each entry in the
   URI-List, it may provide a 'recipient-list-history' body in the reply
   MESSAGE requests.  In this case the Reply-Recipient MAY support these
   formats and MAY support others.  If the Reply-Recipient sends a reply
   MESSAGE request to a MESSAGE URI-list service [9] , it does not need
   to support these formats.  UAs able to understand 'recipient-list-
   history' MUST support these formats and MAY support others.

   The XML Resource Lists [7] provides features, such as hierarchical
   lists and the ability to include entries by reference relative to the
   XCAP root URI or by external reference; however, these are not needed
   by the reply mechanism defined in this specification.  The reply
   mechanism defined herein only needs to transfer a flat list of URIs
   between the Reply-Issuer and the Reply-Recipient.  Therefore, when
   using the default resource list document, UAs SHOULD use flat lists
   (i.e., no hierarchical lists) and SHOULD NOT use references.  A
   Reply-Recipient receiving a URI-list with more information than what
   has just been described MAY discard the additional information.

   Figure 1 shows an example of a flat URI-List that follows XML
   Resource Lists [7] extended with Copy Control Attribute [8] ).







Sun, et al.              Expires April 14, 2008                 [Page 6]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


      <?xml version="1.0" encoding="UTF-8"?>
      <resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists"
                xmlns:cp="urn:ietf:params:xml:ns:copycontrol">
        <list>
          <entry uri="sip:bill@example.com" cp:copyControl="to"  />
          <entry uri="sip:joe@example.org" cp:copyControl="cc" />
          <entry uri="sip:ted@example.net" cp:copyControl="bcc" />
        </list>
      </resource-lists>

             Figure 1: Example for XML Resource List Document








































Sun, et al.              Expires April 14, 2008                 [Page 7]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


4.  Procedures at the Reply-Issuer

   A Reply-Issuer that wants to specify multiple reply addresses MUST
   use formatting according to Section 4 of RFC 3428 [3] .  The Reply-
   Issuer populates the Request-URI of the MESSAGE request with the SIP
   or SIPS URI of the Reply-Recipient.  In addition to the regular
   MESSAGE request body, the Reply-Issuer adds a recipient-list body
   whose Content-Disposition type is 'recipient-list' as defined in
   Framework and Security Considerations for SIP URI-List Services [4] .
   This body contains a URI-list with the recipients of the reply
   MESSAGE request from the Reply-Recipient.  Target URIs in this body
   MAY also be tagged with the 'copyControl' and 'anonymize' attributes
   specified in the Copy Control Attribute [8] .  The Reply-Issuer MUST
   provide an appropriate Content-ID for the recipient-list body and
   populates the Reply-To with the value of Content-ID that identifies
   the list of intended recipient of the reply MESSAGE requests.

   The Reply-Issuer MAY use the "?" mechanism described in Section
   19.1.1 of RFC 3261 [2] to encode extra information in any URI of the
   list.  The following is an example of a URI that uses the "?"
   mechanism:
   sip:bob@example.com?Accept-Contact=*%3bmobility%3d%22mobile%22

   The previous URI requests the Reply-Recipient to add the following
   header field to a reply MESSAGE request to be sent to
   bob@example.com: Accept-Contact: *;mobility="mobile"

























Sun, et al.              Expires April 14, 2008                 [Page 8]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


5.  Procedures at the Reply-Recipient

   A Reply-Recipient that receives a MESSAGE request with a Reply-To
   header field and 'recipient-list' body processes it and responds
   following the procedure in section 7 of RFC 3428 [3]

   There are two possibilities for a Reply-Recipient to send reply
   MESSAGE requests to intended recipients:

   o  The Reply-Recipient creates a reply MESSAGE request for each entry
      in the URI-List and sends them respectively.  If it supports the
      'recipient-list-history' Content-Disposition type, it MAY provide
      a 'recipient-list-history' body in the reply MESSAGE requests for
      each intended recipient following the procedure defined in Copy
      Control Attribute [8] .

   o  The Reply-Recipient sends a reply MESSAGE request that includes
      the payload along with the URI-list to a MESSAGE URI-list service
      [9] to distribute simliar reply MESSAGE requests to each of the
      URIs included in the list.  The Reply-Recipient MAY modify the
      URI-list from the Reply-Issuer so as to add or remove recipients.






























Sun, et al.              Expires April 14, 2008                 [Page 9]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


6.  Examples

6.1.  Reply-Recipient uses MESSAGE URI-List service to send reply
      MESSAGE requests

   Figure 1 shows an example flow where a Reply-Issuer sends a MESSAGE
   request with Reply-To header field pointing to a URI list to a Reply-
   Recipient.  The Reply-Recipient sends a reply MESSAGE with the URI
   list to MESSAGE URI-list service.


   +--------+    +--------+     +---------+        +--------+ +--------+
   | Reply- |    | Reply- |     | MESSAGE |        | reply  | | reply  |
   | Issuer |    | Recip. |     | URI-List|        | target | | target |
   |        |    |        |     | server  |        |   1    | |   2    |
   +--------+    +--------+     +---------+        +--------+ +--------+
        |             |               |                 |          |
        | F1:MESSAGE with Reply-To pointing to a URI-List          |
        |------------>|               |                 |          |
        | F2:200 OK   |               |                 |          |
        |<------------|               |                 |          |
        |             |  F3:MESSAGE   |                 |          |
        |             |-------------->|                 |          |
        |             |  F4:202 Accepted                |          |
        |             |<--------------|                 |          |
        |             |               |  F5:MESSAGE     |          |
        |             |               | --------------->|          |
        |             |               |  F6:MESSAGE     |          |
        |             |               | -------------------------->|
        |             |               |  F8:200 OK      |          |
        |             |               |<--------------- |          |
        |             |               |  F9:200 OK      |          |
        |             |               |<-------------------------- |
        |             |               |                 |          |

    Figure 1: Example flow for Reply-To pointing to multiple addresses

   Figure 2 shows an example of the MESSAGE request F1, which carries a
   'multipart/mixed' body composed of two other bodies:

   o  'text/plain' body: contains the instant message payload;

   o  'application/resource-lists+xml' body: contains the intended
      recipients receiving the reply MESSAGE request from Reply-
      Recipient.

   The Reply-To header field has the same value of Content-ID pointing
   to the URI-List which contains the intended recipients.



Sun, et al.              Expires April 14, 2008                [Page 10]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


   MESSAGE sip:tom@example.com SIP/2.0
   Via: SIP/2.0/TCP uac1.example.com
       ;branch=z9hG4bKhjhs8as34sc
   Max-Forwards: 70
   To: <sip:tom@example.com>
   From: Alice <sip:alice@example.com>;tag=210342
   Call-ID: 39s02sdsl20d9sj2l
   CSeq: 1 MESSAGE
   Reply-To: <cid:cn35t8jf02@example.com>
   Content-Type: multipart/mixed;boundary="boundary1"
   Content-Length: xxx

   --boundary1
   Content-Type: text/plain

   Please reply the team with the deadline!

   --boundary1
   Content-Type: application/resource-lists+xml
   Content-Disposition: recipient-list
   Content-ID: <cn35t8jf02@example.com>

   <?xml version="1.0" encoding="UTF-8"?>
   <resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists"
             xmlns:cp="urn:ietf:params:xml:ns:copycontrol">
     <list>
       <entry uri="sip:bill@example.com" cp:copyControl="to" />
       <entry uri="sip:randy@example.net" cp:copyControl="to"
                                          cp:anonymize="true"/>
       <entry uri="sip:eddy@example.com" cp:copyControl="to"
                                         cp:anonymize="true"/>
       <entry uri="sip:joe@example.org" cp:copyControl="cc" />
       <entry uri="sip:carol@example.net" cp:copyControl="cc"
                                          cp:anonymize="true"/>
       <entry uri="sip:ted@example.net" cp:copyControl="bcc" />
       <entry uri="sip:andy@example.com" cp:copyControl="bcc" />
     </list>
   </resource-lists>
   --boundary1--

    Figure 2: MESSAGE with Reply-To header field pointing to a URI list

   Figure 3 shows an example of the MESSAGE request F3, which carries a
   'multipart/mixed' body composed of two other bodies:

   o  'text/plain' body: contains the instant message payload;





Sun, et al.              Expires April 14, 2008                [Page 11]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


   o  'application/resource-lists+xml' body: contains the list of
      recipients.  This list is the same with F1.


   MESSAGE sip:list-service.example.com SIP/2.0
   Via: SIP/2.0/TCP uac1.example.com
       ;branch=z9hG4bKhjhs8as34sc
   Max-Forwards: 70
   To: MESSAGE URI-list Service <sip:list-service.example.com>
   From: Alice <sip:alice@example.com>;tag=32331
   Call-ID: d432fa84b4c76e66710
   CSeq: 1 MESSAGE
   Content-Type: multipart/mixed;boundary="boundary1"
   Content-Length: xxx

   --boundary1
   Content-Type: text/plain

   The deadline is 14:00 GMT October 10, 2007.

   --boundary1
   Content-Type: application/resource-lists+xml
   Content-Disposition: recipient-list

   <?xml version="1.0" encoding="UTF-8"?>
   <resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists"
             xmlns:cp="urn:ietf:params:xml:ns:copycontrol">
     <list>
       <entry uri="sip:bill@example.com" cp:copyControl="to" />
       <entry uri="sip:randy@example.net" cp:copyControl="to"
                                          cp:anonymize="true"/>
       <entry uri="sip:eddy@example.com" cp:copyControl="to"
                                         cp:anonymize="true"/>
       <entry uri="sip:joe@example.org" cp:copyControl="cc" />
       <entry uri="sip:carol@example.net" cp:copyControl="cc"
                                          cp:anonymize="true"/>
       <entry uri="sip:ted@example.net" cp:copyControl="bcc" />
       <entry uri="sip:andy@example.com" cp:copyControl="bcc" />
     </list>
   </resource-lists>
   --boundary1--

     Figure 3: MESSAGE request received at the MESSAGE URI-list server








Sun, et al.              Expires April 14, 2008                [Page 12]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


7.  Security Considerations

   URI-lists may contain private information, such as SIP URIs.  It is,
   therefore, not desirable that these URI-lists are known by third
   parties.  Eavesdroppers are able to watch URI-lists contained in SIP
   MESSAGE requests unless the MESSAGE requests are sent over a secured
   channel, by using any of the available SIP mechanisms, such as
   Transport Layer Security (TLS) [5] , or unless the URI-list body
   itself is encrypted with, e.g., S/MIME [6] .  Therefore, it is
   RECOMMENDED that URI-list bodies are encrypted with S/MIME [6] or
   that the SIP request is encrypted with TLS [5] or any other suitable
   encryption mechanism.







































Sun, et al.              Expires April 14, 2008                [Page 13]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


8.  IANA Considerations

   There are no IANA considerations.
















































Sun, et al.              Expires April 14, 2008                [Page 14]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


9.  Acknowledgements

   The authors would like to thank Tom Hiller, Henning Schulzrinne,
   Jonathan Rosenberg and Spencer Dawkins for their valuable comments
   and contributions.














































Sun, et al.              Expires April 14, 2008                [Page 15]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


10.  References

10.1.  Normative References

   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", RFC 2119, March 1997.

   [2]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
        Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP:
        Session Initiation Protocol", RFC 3261, June 2002.

   [3]  Campbell, B., Rosenberg, J., Schulzrinne, H., Huitema, C., and
        D. Gurle, "Session Initiation Protocol (SIP) Extension for
        Instant Messaging", RFC 3428, December 2002.

   [4]  Camarillo, G. and A. Roach, "Framework and Security
        Considerations for Session Initiation Protocol (SIP) Uniform
        Resource Identifier (URI)-List Services",
         draft-ietf-sipping-uri-services-06.txt (work in progress),
        September 2006.

   [5]  Dierks, T. and E. Rescorla, "The Transport Layer Security (TLS)
        Protocol Version 1.1", RFC 4346, April 2006.

   [6]  Ramsdell, B., "Secure/Multipurpose Internet Mail Extensions
        (S/MIME) Version 3.1 Message Specification", RFC 4346, January
         1999.

   [7]  Rosenberg, J., "Extensible Markup Language (XML) Formats for
        Representing Resource Lists", RFC 4826, May 2007.

   [8]  Garcia-Martin, M. and G. Camarillo, "Extensible Markup Language
        (XML) Format Extension for Representing Copy Control Attributes
        in Resource Lists",
         draft-ietf-sipping-capacity-attribute-04.txt (work in
        progress), March 2007.

10.2.  Informative References

   [9]  Garcia-Martin, M. and G. Camarillo, "Multiple-Recipient MESSAGE
        Requests in the Session Initiation Protocol (SIP)",
         draft-ietf-sip-uri-list-message-01.txt (work in progress),
        January 2007.








Sun, et al.              Expires April 14, 2008                [Page 16]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


Authors' Addresses

   Qian Sun
   Huawei Technologies
   Bantian Longgang
   Shenzhen, Guandong  518129
   P.R China

   Phone: +86 755 28780808
   Email: sunqian@huawei.com


   Linyi Tian
   Huawei Technologies
   Bantian Longgang
   Shenzhen, Guandong  518129
   P.R China

   Phone: +86 755 28780808
   Email: tianlinyi@huawei.com


   Daqi Ren
   Huawei Technologies
   Bantian Longgang
   Shenzhen, Guandong  518129
   P.R China

   Phone: +86 755 28780808
   Email: dren@huawei.com





















Sun, et al.              Expires April 14, 2008                [Page 17]

Internet-Draft     Multiple Reply to MESSAGE requests       October 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Sun, et al.              Expires April 14, 2008                [Page 18]

