<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DNS Extended Service Discovery (ESRV) Record.</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Definitions">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.2" rel="Chapter" title="2 Extended Service Discription">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Use of DNS Prefixing">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Interaction with Extended Service Discovery">
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 Abstract Services">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Resolution Mechanism">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Incremental Mode">
<link href="#rfc.section.2.2.1.1" rel="Chapter" title="2.2.1.1 Domain Resolution">
<link href="#rfc.section.2.2.1.2" rel="Chapter" title="2.2.1.2 Service Resolution">
<link href="#rfc.section.2.2.1.2.1" rel="Chapter" title="2.2.1.2.1 Prefetching of Protocol Records">
<link href="#rfc.section.2.2.1.3" rel="Chapter" title="2.2.1.3 Instance Resolution">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 Optimized Mode">
<link href="#rfc.section.2.2.2.1" rel="Chapter" title="2.2.2.1 EDNS0 Meta-Query Extension">
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 Interactive HTTP Properties">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Syntax">
<link href="#rfc.section.2.3.1" rel="Chapter" title="2.3.1 Presentation Format">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 ESRV Processing Rules">
<link href="#rfc.section.2.4.1" rel="Chapter" title="2.4.1 Service Discovery">
<link href="#rfc.section.2.4.2" rel="Chapter" title="2.4.2 Abstract Service Discovery">
<link href="#rfc.section.3" rel="Chapter" title="3 Properties">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Property Values">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Processing Properties">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Discovery Properties">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Security Properties">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 tls_specifier Attributes">
<link href="#rfc.section.4" rel="Chapter" title="4 Relation to Existing Work">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Non-Normative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="General Service Description (GSRV) and Extended Service Description records are DNS Resource Records that provide information to applications attempting to establish a network connection.  When authenticated using an appropriate means GSRV and ESRV records may be used to prevent a downgrade attack in cases where use of security enhancements with an application protocol are optional.  " />
  <meta name="description" content="General Service Description (GSRV) and Extended Service Description records are DNS Resource Records that provide information to applications attempting to establish a network connection.  When authenticated using an appropriate means GSRV and ESRV records may be used to prevent a downgrade attack in cases where use of security enhancements with an application protocol are optional.  " />
  <meta name="keywords" content="DNS" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">P. M. Hallam-Baker</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">B. Smith</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">Comodo Inc.</td>
</tr>
<tr>
<td class="left">Expires: September 10, 2011</td>
<td class="right">March 09, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DNS Extended Service Discovery (ESRV) Record.<br />
  <span class="filename">draft-hallambaker-esrv-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>General Service Description (GSRV) and Extended Service Description records are DNS Resource Records that provide information to applications attempting to establish a network connection.  When authenticated using an appropriate means GSRV and ESRV records may be used to prevent a downgrade attack in cases where use of security enhancements with an application protocol are optional.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 10, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may not be modified, and derivative works of it may not be created, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Definitions</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>2.   <a href="#rfc.section.2">Extended Service Discription</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Use of DNS Prefixing</a>
</li>
<li>2.1.1.   <a href="#rfc.section.2.1.1">Interaction with Extended Service Discovery</a>
</li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">Abstract Services</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Resolution Mechanism</a>
</li>
<li>2.2.1.   <a href="#rfc.section.2.2.1">Incremental Mode</a>
</li>
<li>2.2.1.1.   <a href="#rfc.section.2.2.1.1">Domain Resolution</a>
</li>
<li>2.2.1.2.   <a href="#rfc.section.2.2.1.2">Service Resolution</a>
</li>
<li>2.2.1.2.1.   <a href="#rfc.section.2.2.1.2.1">Prefetching of Protocol Records</a>
</li>
<li>2.2.1.3.   <a href="#rfc.section.2.2.1.3">Instance Resolution</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">Optimized Mode</a>
</li>
<li>2.2.2.1.   <a href="#rfc.section.2.2.2.1">EDNS0 Meta-Query Extension</a>
</li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">Interactive HTTP Properties</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Syntax</a>
</li>
<li>2.3.1.   <a href="#rfc.section.2.3.1">Presentation Format</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">ESRV Processing Rules</a>
</li>
<li>2.4.1.   <a href="#rfc.section.2.4.1">Service Discovery</a>
</li>
<li>2.4.2.   <a href="#rfc.section.2.4.2">Abstract Service Discovery</a>
</li>
<li>3.   <a href="#rfc.section.3">Properties</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Property Values</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Processing Properties</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Discovery Properties</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Security Properties</a>
</li>
<li>3.4.1.   <a href="#rfc.section.3.4.1">tls_specifier Attributes</a>
</li>
<li>4.   <a href="#rfc.section.4">Relation to Existing Work</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Non-Normative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Definitions</h1>
<p id="rfc.section.1.p.1">The following definitions are used in this document:</p>
<p></p>

<dl>
<dt>Abstract Syntax Notation One (ASN.1)</dt>
<dd style="margin-left: 8">A notation for describing abstract types and values, as specified in <a href="#X.680">X.680</a> <cite title="NONE">[X.680]</cite>.  </dd>
<dt>Authorization Entry</dt>
<dd style="margin-left: 8">An authorization assertion that grants or denies a specific set of permissions to a specific group of entities.  </dd>
<dt>Canonical Domain Name</dt>
<dd style="margin-left: 8">A Domain Name that is not an alias.  </dd>
<dt>Canonical Domain Name Value</dt>
<dd style="margin-left: 8">The value of a Canonical Domain Name. The value resulting from applying alias transformations to a Domain Name that is not canonical.  </dd>
<dt>Certificate</dt>
<dd style="margin-left: 8">An X.509 Certificate, as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite>.  </dd>
<dt>Certification Policy (CP)</dt>
<dd style="margin-left: 8">Specifies the criteria that a Certification Authority undertakes to meet in its issue of certificates.  </dd>
<dt>Certification Practices Statement (CPS)</dt>
<dd style="margin-left: 8">Specifies the means by which the criteria of the Certification Policy are met. In most cases this will be the document against which the operations of the Certification Authority are audited.  </dd>
<dt>Certification Authority (CA)</dt>
<dd style="margin-left: 8">An entity that issues Certificates in accordance with a specified Certification Policy.  </dd>
<dt>Distinguished Encoding Rules (DER)</dt>
<dd style="margin-left: 8">A set of rules for encoding ASN.1 objects, as specified in <a href="#X.690">X.690</a> <cite title="NONE">[X.690]</cite>.  </dd>
<dt>Domain</dt>
<dd style="margin-left: 8">The set of resources associated with a DNS Domain Name.  </dd>
<dt>Domain Name</dt>
<dd style="margin-left: 8">A DNS Domain name as specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>Domain Name System (DNS)</dt>
<dd style="margin-left: 8">The Internet naming system specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>DNS Security (DNSSEC)</dt>
<dd style="margin-left: 8">Extensions to the DNS that provide authentication services as specified in <a href="#RFC4033">RFC 4033</a> <cite title="NONE">[RFC4033]</cite> and revisions.  </dd>
<dt>Public Delegation Point</dt>
<dd style="margin-left: 8">A Domain Name that is obtained from a public DNS registry as defined by a Certification Policy.  </dd>
<dt>Public Key Infrastructure X.509 (PKIX)</dt>
<dd style="margin-left: 8">Standards and specifications issued by the IETF that apply the <a href="#X.509">X.509</a> <cite title="NONE">[X.509]</cite> certificate standards specified by the ITU to Internet applications as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite> and related documents.  </dd>
<dt>Resource Record (RR)</dt>
<dd style="margin-left: 8">A set of attributes bound to a Domain Name.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Extended Service Discription</h1>
<p id="rfc.section.2.p.1">General Service Description (GSRV) and Extended Service Discrpition (ESRV) DNS Resource Records provide a mechanism for specifying properties relating to Internet services associated with a DNS name.  </p>
<p id="rfc.section.2.p.2">GSRV and ESRV records are intended to serve the same function at different levels of generality.  GSRV records specify properties that apply to all Internet services provided in the Domain. ESRV records are used to specify properties that apply to finer levels of detail.  </p>
<p id="rfc.section.2.p.3">Extended Service Description allows properties to be expressed at three levels of granularity: </p>
<p></p>

<dl>
<dt>Domain</dt>
<dd style="margin-left: 8">Properties that apply to all services offered at the corresponding domain name. Domain level properties do not take prefixes and are published using the GSRV Resource Record.  </dd>
<dt></dt>
<dd style="margin-left: 8">For example, a site might declare that all services offered at a domain name support use of SRV service discovery.  </dd>
<dt>Service</dt>
<dd style="margin-left: 8">Properties that apply to all instances of a service offered at the corresponding domain name. Service level properties always take a service specific prefix and are published using the ESRV Resource Record.  </dd>
<dt></dt>
<dd style="margin-left: 8">For example, a site might specify that the SMTP service always supports use of the TLS security protocol (via the STARTTLS mechanism) while use of the TLS security protocol is required for IMAP, POP and HTTP connections.  </dd>
<dt>Instance</dt>
<dd style="margin-left: 8">Properties that apply to a specific instance of a service on a specific host listening on a specific port. Instance level properties always take a service specific prefix and a port specific prefix and are published using the ESRV Resource Record.  </dd>
<dt></dt>
<dd style="margin-left: 8">Declaration of Instance specific properties is only possible when a DNS service discovery protocol such as MX, SRV, NAPTR or DDDS is in use.  </dd>
<dt></dt>
<dd style="margin-left: 8">For example a site with two servers offering SMTP email service might advertise different TLS certificates for each service instance.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Use of DNS Prefixing</h1>
<p id="rfc.section.2.1.p.1">GRSV/ESRV records make use of the service prefixing mechanism introduced in SRV and employed in later advanced service discovery mechanisms such as NAPTR and URI.  </p>
<p id="rfc.section.2.1.p.2">The need for separate DNS Resource Record types to express properties at different levels of granularity arises from the need to support use of wildcards and DNS aliases such as CNAME and DNAME records when specifying properties that apply to a whole domain and the need to use prefix labels to specify properties at finer granularity.  </p>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> Interaction with Extended Service Discovery</h1>
<p id="rfc.section.2.1.1.p.1">The GSRV/ESRV discovery mechanism is designed for use by itself or in combination with service discovery mechanisms such as SRV, NAPTR and URI.  </p>
<p id="rfc.section.2.1.1.p.2">One of the main limitations of service discovery schemes such as SRV, NAPTR and URI is that they can only be used if a client knows to look for them.  </p>
<p id="rfc.section.2.1.1.p.3">Without provision for meta-service discovery, the service discovery mechanisms supported by a protocol are limited to those which exist at the time the protocol is developed and that the protocol designer decides to support. In most cases however, it is the site administrator rather than the protocol designer who is best placed to know which form of extended discovery is most applicable to their service.  </p>
<p id="rfc.section.2.1.1.p.4">GSRV records may be used to inform clients that a service discovery mechanism is supported for specific protocols or for all protocols.  In the following example clients are advised to attempt service discovery using the SRV mechanism for the HTTP protocol and to attempt URI service discovery for all others: </p>
<div id="#rfc.figure.1"></div>
<pre>
                            
    example.com   GSRV 0   srv  "_http._tcp"
    example.com   GSRV 0   uri "*"
                        </pre>
<h1 id="rfc.section.2.1.2">
<a href="#rfc.section.2.1.2">2.1.2.</a> Abstract Services</h1>
<p id="rfc.section.2.1.2.p.1">Publication of ESRV properties for abstract services allows a site to enable clients to perform protocol negotiation by specifying the range of services offered that support a specific purpose.  </p>
<p id="rfc.section.2.1.2.p.2">For example, the SMTP, POP3 and IMAP4 protocols are all used for exchange of mail. An abstract service for the mail protocol with the prefix '_mail._as' allows clients to discover the full range of mail related protocols in a single query.  </p>
<div id="#rfc.figure.2"></div>
<pre>
                            
example.com             GSRV 0  service "_mail._as"
_mail._as.example.com   ESRV 0  prot "_smtp._tcp"
_mail._as.example.com   ESRV 0  prot "_pop._tcp"
_mail._as.example.com   ESRV 0  prot "_imap._tcp"
                        </pre>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Resolution Mechanism</h1>
<p id="rfc.section.2.2.p.1">Extended Service description records MAY be resolved in an Incremental mode or an Optimized mode. Incremental mode allows records to be advertised and resolved by existing DNS servers, optimized mode allows for improved performance when </p>
<p id="rfc.section.2.2.p.2">Implementations MUST support the Incremental mode and MAY support the Optimized mode.  </p>
<h1 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> Incremental Mode</h1>
<p id="rfc.section.2.2.1.p.1">The incremental mode allows extended service discovery to be used in conjunction with DNS resolvers that do not support the Optimized mode.  </p>
<h1 id="rfc.section.2.2.1.1">
<a href="#rfc.section.2.2.1.1">2.2.1.1.</a> Domain Resolution</h1>
<p id="rfc.section.2.2.1.1.p.1">In the incremental mode the DNS client attempting service discovery begins by querying for Domain level properties.  </p>
<p id="rfc.section.2.2.1.1.p.2">For example, a client attempting to perform extended service discovery for the HTTP protocol server at www.example.com would begin by querying for the GSRV record at www.example.com.  </p>
<p id="rfc.section.2.2.1.1.p.3">Domain properties MAY include property entries for the service property type. The service property entry indicates that additional property entries are specified at the service level for either a specific serviceby means of the protocol prefix or for all services by means of the wildcard entry "*".  </p>
<h1 id="rfc.section.2.2.1.2">
<a href="#rfc.section.2.2.1.2">2.2.1.2.</a> Service Resolution</h1>
<p id="rfc.section.2.2.1.2.p.1">If the domain resolution indicates that property entries are declared for the service prefix being resolved or for the wildcard prefix type, service level resolution is performed.  </p>
<p id="rfc.section.2.2.1.2.p.2">There are three possible outcomes in which the query is successful and returns a GSRV record: </p>
<p></p>

<ul class="empty">
<li>The queried domain name is canonical and a GSRV record is returned for that domain name.  </li>
<li>The queried domain name is not canonical and an alias is returned (e.g. CNAME) together with the GSRV record for the canonical name.  </li>
<li>The queried domain name does not exist but is in the scope of a wildcard record.  </li>
</ul>

<p> </p>
<p id="rfc.section.2.2.1.2.p.4">In the last case we require that the GSRV record set returned contain a canonical property entry specifying a canonical name. We are thus assured that </p>
<p id="rfc.section.2.2.1.2.p.5">prefix the canonical name to perform the service lookup </p>
<p id="rfc.section.2.2.1.2.p.6">In the following example a query for the _prefix protocol at domain names canonical.example.com, cname.example.com or wildcard.example.com will all result in the resolution process continuing with a query for an ESRV record for _prefix.canonical.example.com.  </p>
<div id="#rfc.figure.3"></div>
<pre>
                                
$ORIGIN example.com
canonical          GSRV 0  service "*"
cname.example.com  CNAME canonical.example.com
*.example.com      GSRV 0  canonical "canonical.example.com"
*.example.com      GSRV 0  service "*"
                            </pre>
<p id="rfc.section.2.2.1.2.p.7">If use of a service discovery mechanism is indicated a site MAY choose to advertise properties specific to a particular service instance through use of the instance property type.  </p>
<h1 id="rfc.section.2.2.1.2.1">
<a href="#rfc.section.2.2.1.2.1">2.2.1.2.1.</a> Prefetching of Protocol Records</h1>
<p id="rfc.section.2.2.1.2.1.p.1">Client implementations MAY attempt to optimize incremental mode discovery by initiating service resolution in parallel with domain resolution by applying the protocol prefix to the query domain.  </p>
<p id="rfc.section.2.2.1.2.1.p.2">If the response to the domain resolution query indicates that the query domain is not-canonical, any answer returned to the pre-fetched query is ignored and a new query made if inidcated by the answer returned to the domain resolution query.  </p>
<h1 id="rfc.section.2.2.1.3">
<a href="#rfc.section.2.2.1.3">2.2.1.3.</a> Instance Resolution</h1>
<p id="rfc.section.2.2.1.3.p.1">If the service level resolution indicates that instance level property entries MAY exist, these are resolved by querying for the chosen host name prefixed by the service prefix and a second prefix formed from the decimal port identifier.  </p>
<p id="rfc.section.2.2.1.3.p.2">For example a the www.example.com HTTP server is supported by two separate service instances (host1, host2). TLS security is always offered on host1 instance but not on host2: </p>
<div id="#rfc.figure.4"></div>
<pre>
                                
$ORIGIN example.com
www                    GSRV 0 service "*"
www                    GSRV 0 srv "_http._tcp"
_http._tcp.www         ESRV 0 instance ""
_http._tcp.www         SRV 1 1 80 host1.example.com
_http._tcp.www         SRV 1 1 80 host2.example.com
_http._tcp._80.host1   ESRV 0 tls "required" 
                            </pre>
<h1 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> Optimized Mode</h1>
<p id="rfc.section.2.2.2.p.1">DNS servers MAY advertise support for the optimized mode query by means of the EDNS0 meta-query extension.  </p>
<p id="rfc.section.2.2.2.p.2">When optimized mode queries are supported, the client MAY present a meta-query consisting of the protocol prefix concatenated to an iteration count concatenated to the query domain. The server receiving the query then performs the GSRV/ESRV discovery process on the client's behalf and returns the whole result chain in a single response.  </p>
<p id="rfc.section.2.2.2.p.3">For example, a query for the HTTP service at example.com would be made as: </p>
<div id="#rfc.figure.5"></div>
<pre>
                            
METASRV ? _http._tcp._0.www.example.com
                        </pre>
<p id="rfc.section.2.2.2.p.4">Since the two hosts have the same weighting, there is a 50% probability that the response  to this query would be: </p>
<div id="#rfc.figure.6"></div>
<pre>
                            
_http._tcp._0.www.example.com METASRV 2                            
www.example.com               GSRV 0 service "*"
www.example.com               GSRV 0 srv "_http._tcp"
_http._tcp.www.example.com    ESRV 0  instance ""
_http._tcp.www.example.com    SRV 1 1 80 host2.example.com
_http._tcp._80.host1          ESRV 0  tls "required"                            
                            
                        </pre>
<p id="rfc.section.2.2.2.p.5">Should the attempt to connect to host1.example.com fail, the client MAY make a second attempt: </p>
<div id="#rfc.figure.7"></div>
<pre>
                            
METASRV ? _http._tcp._1.www.example.com
                        </pre>
<p id="rfc.section.2.2.2.p.6">Since there is now only one service instance remaining, the response would be: </p>
<div id="#rfc.figure.8"></div>
<pre>
                            
_http._tcp._1.www.example.com METASRV 2 
www.example.com               GSRV 0  service "*"
www.example.com               GSRV 0  srv "_http._tcp"
_http._tcp.www.example.com    ESRV 0  instance ""
_http._tcp.www.example.com    SRV 1 1 80 host1.example.com
_http._tcp._80.host1          ESRV 0  tls "required"                            
                            
                        </pre>
<p id="rfc.section.2.2.2.p.7">[TBS: work out how to allow the server to calculate the random number deterministically on the query, may need to add a state parameter here.] </p>
<h1 id="rfc.section.2.2.2.1">
<a href="#rfc.section.2.2.2.1">2.2.2.1.</a> EDNS0 Meta-Query Extension</h1>
<p id="rfc.section.2.2.2.1.p.1">The EDNS0 Meta-Query extension has code TBS and is used to advertise support for one or more meta-queries.  </p>
<p id="rfc.section.2.2.2.1.p.2">The parameter data for the Meta-Query Extension consists of a list of DNS query numbers for the supported meta queries.  </p>
<h1 id="rfc.section.2.2.3">
<a href="#rfc.section.2.2.3">2.2.3.</a> Interactive HTTP Properties</h1>
<p id="rfc.section.2.2.3.p.1">Interactive HTTP Attributes are properties specific to the HTTP protocol that are declared as Domain Properties rather than service properties. Specifying the properties for HTTP as interactive HTTP properties allows clients using resolvers that do not support the optimized resolution mode to resolve HTTP properties in a single round trip rather than two.  </p>
<p id="rfc.section.2.2.3.p.2">For example, the following configuration specifies that tls is always offered for the application protocols HTTP and POP.  </p>
<div id="#rfc.figure.9"></div>
<pre>
                            
$ORIGIN example.com
.                      GSRV 0  service "*"
.                      GSRV 0  http_tls "required"
_pop._tcp              ESRV 0  tls "offered"

                        </pre>
<p id="rfc.section.2.2.3.p.3">The above example is functionally equivalent to specifying the HTTP properties as instance properties: </p>
<div id="#rfc.figure.10"></div>
<pre>
                            
$ORIGIN example.com
.                      GSRV 0  service "*"
_http._tcp             ESRV 0  tls "required"
_pop._tcp              ESRV 0  tls "offered"

                        </pre>
<p id="rfc.section.2.2.3.p.4">Special provision is justified in this instance by the widespread use of HTTP and the effect that service discovery latency has on the Web Browser user experience.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Syntax</h1>
<p id="rfc.section.2.3.p.1">The GSRV and ESRV have the same record syntax which is the same as the syntax of the CAA record.  A GSRV or ESRV RR contains a single property entry consisting of a tag value pair.  Each tag represents a property of the CAA record. The value of a property entry  is that specified in the corresponding value field.  </p>
<p id="rfc.section.2.3.p.2">A domain name MAY have multiple GSRV or ESRV RRs associated with it and a given property MAY be specified more than once. Where multiple properties are specified they are additive. That is if SRV and URI records are advertised for a service then both mechanisms for advanced discovery are offered.  </p>
<p id="rfc.section.2.3.p.3">The GSRV/ESRV data field consists of a sequence of at least one property entry. Each property entry consists of a sequence of: </p>
<p></p>

<dl>
<dt>Flags</dt>
<dd style="margin-left: 8">One octet containing the following field: <dl>
<dt>Bit 0: Critical Flag</dt>
<dd style="margin-left: 8">If the value is set (1), the critical flag is asserted and the property MUST be understood if the record is to be correctly processed.  </dd>
</dl>
<p> </p>
</dd>
<dt></dt>
<dd style="margin-left: 8">Note that according to the conventions set out in  <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> Bit 0 is the Most Significant Bit and Bit 7 is the Least Significant.  Thus a flags value of 0x51 indicates a tag length of 5 octets and that the property entry is not critical and is not to be used for relying party processing.  </dd>
<dt>Tag Length</dt>
<dd style="margin-left: 8">A single octet containing an unsigned integer specifying the tag length in octets. The tag length MUST be at least 1 and SHOULD be no more than 15.  </dd>
<dt>Tag</dt>
<dd style="margin-left: 8">The property identifier, a sequence of ASCII characters.</dd>
<dt></dt>
<dd style="margin-left: 8">Tag values MAY contain ASCII characters a through z and the numbers 0 through 9. Tag values MUST NOT contain any other characters. Matching of tag values is case insensitive.  </dd>
<dt>Value</dt>
<dd style="margin-left: 8">A sequence of octets representing the property value. Property values are encoded as binary values and MAY employ sub-formats.  </dd>
<dt></dt>
<dd style="margin-left: 8">The length of the value field is specified implicitly as the remaining length of the enclosing Resource Record data field.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.3.1">
<a href="#rfc.section.2.3.1">2.3.1.</a> <a href="#zoneformat" id="zoneformat">Presentation Format</a>
</h1>
<p id="rfc.section.2.3.1.p.1">The presentation format of the GSRV and ESRV resource records is as follows: </p>
<p id="rfc.section.2.3.1.p.2">GSRV &lt;flags&gt; &lt;tag&gt; &lt;data&gt; </p>
<p id="rfc.section.2.3.1.p.3">ESRV &lt;flags&gt; &lt;tag&gt; &lt;data&gt; </p>
<p id="rfc.section.2.3.1.p.4">Where: </p>
<p></p>

<dl>
<dt>flags</dt>
<dd style="margin-left: 8">Is an unsigned integer between 0 and 15.</dd>
<dt>tag</dt>
<dd style="margin-left: 8">Is a non-zero sequence of ASCII letter and numbers in lower case.  </dd>
<dt>data</dt>
<dd style="margin-left: 8">The parameter data for the property specified as either a quoted text string or an unquoted Base64 Encoding <a href="#RFC4648">[RFC4648]</a> of the value.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> ESRV Processing Rules</h1>
<p id="rfc.section.2.4.p.1">The purpose of extended service discovery is to refine an abstract specification of a DNS host name and protocol prefix to a concrete specification for the name of a specific network host, a specific network port number and a specific network protocol and associated protocol parameters.  </p>
<h1 id="rfc.section.2.4.1">
<a href="#rfc.section.2.4.1">2.4.1.</a> Service Discovery</h1>
<p id="rfc.section.2.4.1.p.1">The GSRV and ESRV Resource Record is used in combination with service discovery records (e.g. SRV, URI NAPTR) to perform extended service discovery. An API call for extended service discovery has the following signature: </p>
<p></p>

<dl>
<dt>name (input/output)</dt>
<dd style="margin-left: 8">The DNS name of the service.  </dd>
<dt>protocol (input/output)</dt>
<dd style="margin-left: 8">The DNS prefix of the protocol.  </dd>
<dt>port (output)</dt>
<dd style="margin-left: 8">The IP port number to conect to at the host </dd>
<dt>uri (output)</dt>
<dd style="margin-left: 8">The canonical uri of the service to connect to </dd>
<dt>properties (output)</dt>
<dd style="margin-left: 8">A list of attribute value pairs that specify characteristics of the connection to the service.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.4.2">
<a href="#rfc.section.2.4.2">2.4.2.</a> Abstract Service Discovery</h1>
<p id="rfc.section.2.4.2.p.1">The GSRV and ESRV Resource Records may be used to perform abstract service discovery providing a list of supported protocols that implement the abstract service. An API call for abstract service discovery has the following signature: </p>
<p></p>

<dl>
<dt>name (input/output)</dt>
<dd style="margin-left: 8">The DNS name of the service.  </dd>
<dt>protocol (input)</dt>
<dd style="margin-left: 8">The DNS prefix of the abstract protocol.  </dd>
<dt>implementations (output)</dt>
<dd style="margin-left: 8">A list of DNS prefixes for the protocols implementing the specified protocol that are supported at the specified domain.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Properties</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Property Values</h1>
<p id="rfc.section.3.1.p.1">GSRV/ESRV properties take different parameter values according to the specific label.  </p>
<p></p>

<dl>
<dt>[domain_name]</dt>
<dd style="margin-left: 8">A DNS domain name.  </dd>
<dt>[protocol_specifier]</dt>
<dd style="margin-left: 8">An ASCII string containing a protocol prefix string or the wildcard character '*'.  </dd>
<dt>[tls_specifier]</dt>
<dd style="margin-left: 8">A sequence of one or more TLS attributes or attribute value pairs.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Processing Properties</h1>
<p id="rfc.section.3.2.p.1">Processing properties direct the process of property resolution.  Since a processing property is used to direct the resolution process, they only have effect when encountered at a relevant stage of resolution. A service property that directs a client to resolve for service properties has no effect.  </p>
<p id="rfc.section.3.2.p.2">Three processing properties are defined.  </p>
<p></p>

<dl>
<dt>canonical [domain_name]</dt>
<dd style="margin-left: 8">The canonical property directs the client to use the specified property value as the canonical domain name to be used in service resolution.  </dd>
<dt></dt>
<dd style="margin-left: 8">The canonical property only has effect if declared as a domain property.  </dd>
<dt>service [protocol_specifier]</dt>
<dd style="margin-left: 8">The service property directs the client to perform service resolution if the property value matches the query protocol.  </dd>
<dt></dt>
<dd style="margin-left: 8">The service property only has effect if declared as a domain property.  </dd>
<dt>instance [protocol_specifier]</dt>
<dd style="margin-left: 8">The service property directs the client to perform instance resolution if the property value matches the query protocol.  </dd>
<dt></dt>
<dd style="margin-left: 8">The instance property only has effect if declared as a domain property or as a service property.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Discovery Properties</h1>
<p id="rfc.section.3.3.p.1">Discovery Properties specify the resolution mechanism(s) to be used for service resolution. Discovery properties only have effect when encountered in the Domain resolution phase and always take a protocol_specifier as the property type.  </p>
<p id="rfc.section.3.3.p.2">If multiple discovery properties are specified, the most specific property or properties are to be used.  </p>
<p id="rfc.section.3.3.p.3">If no discovery property is specified, 'a' record service discovery (i.e. IPv4) is indicated.  </p>
<p></p>

<dl>
<dt>a [protocol_specifier]</dt>
<dd style="margin-left: 8">Specifies discovery by means of A record lookup; the traditional means of service resolution for IPv4.  </dd>
<dt></dt>
<dd style="margin-left: 8">Since A record lookup is the default, this property is most likely to be used to specify a protocol specific exception to a wildcard discovery property.  </dd>
<dt>aaaa [protocol_specifier]</dt>
<dd style="margin-left: 8">Specifies discovery by means of AAAA record lookup; the traditional means of service resolution for IPv6.  </dd>
<dt>srv [protocol_specifier]</dt>
<dd style="margin-left: 8">Specifies discovery using the SRV service discovery mechanism.  </dd>
<dt>uri [protocol_specifier]</dt>
<dd style="margin-left: 8">Specifies discovery using the URI service discovery mechanism.  </dd>
<dt>naptr [protocol_specifier]</dt>
<dd style="margin-left: 8">Reserved for specifying discovery using the URI service discovery mechanism.  </dd>
<dt></dt>
<dd style="margin-left: 8">Since NAPTR records are designed to support URN resolution rather than service resolution, the manner of using NAPTR records within the GSRV/ESRV framework is left unspecified in this version of the specification.  </dd>
<dt>prot [protocol_specifier]</dt>
<dd style="margin-left: 8">Specifies that the specified protocol MAY be resolved to discover a protocol related to the specified protocol.  </dd>
<dt></dt>
<dd style="margin-left: 8">The prot Discovery Property is used to support abstract service resolution and alternative service resolution.  When encountered in the domain resolution phase, the prot property advises the resolver that an alternative to the requested protocol is available.  </dd>
<dt></dt>
<dd style="margin-left: 8">In the case of an abstract protocol such as a prefix representing 'email', there is no concrete service to resolve and the only discovery properties that are valid are prot discovery properties.  </dd>
<dt></dt>
<dd style="margin-left: 8">In the case of a concrete protocol such as _http._tcp, a prot specifier MAY be used to advise the resolver that use of an alternative protocol is available (e.g. _httpng._tcp).  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Security Properties</h1>
<p id="rfc.section.3.4.p.1">Security properties allow a service provider to describe the security critieria for a service. When an ESRV record is secured using an appropriate means (e.g. DNSSEC), the security properties MAY be used to prevent a downgrade attack on the security enhancements offered.  </p>
<p></p>

<dl>
<dt>tls [tls_specifier]</dt>
<dd style="margin-left: 8">Specifies the use of tls. Valid property values are refused, optional and required.  </dd>
<dt></dt>
<dd style="margin-left: 8">If the property value refused is specified, the corresponding service does not support use of the TLS security enhancement.  </dd>
<dt></dt>
<dd style="margin-left: 8">If the property value optional is specified, the corresponding service always offers use of the TLS security enhancement.  </dd>
<dt></dt>
<dd style="margin-left: 8">If the property value optional is specified, the corresponding service requires of use of the TLS security enhancement.  </dd>
<dt>http-tls [tls_specifier]</dt>
<dd style="margin-left: 8">Specifies the use of tls with HTTP. Valid values are refused, optional and required with the same semantics as for the tis property.  </dd>
<dt></dt>
<dd style="margin-left: 8">The http-tls property allows security properties to be declared for the http protocol as domain properties, thus allowing the properties to be resolved in a single round trip.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.4.p.3">It is anticipated that the list of tags will be expanded at a future date to support other Internet security protocols such as IPSEC and WS-Security.  </p>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> tls_specifier Attributes</h1>
<p id="rfc.section.3.4.1.p.1">A tls_specifier property value consists of a sequence of case insensitive atributes or attribute-value pairs separated by spaces as follows: </p>
<p id="rfc.section.3.4.1.p.2">[EBNF To Be Specified] </p>
<p></p>

<dl>
<dt>refused</dt>
<dd style="margin-left: 8">The specified service or service instance does not support TLS.  </dd>
<dt>optional[=&lt;port]&gt;</dt>
<dd style="margin-left: 8">The specified service or service instance always offered on an alternative IP port but does not require use of TLS.  </dd>
<dt></dt>
<dd style="margin-left: 8">If the port parameter is specified, it speficies the port number for the TLS service in decimal.  </dd>
<dt></dt>
<dd style="margin-left: 8">If no port number is specified the TLS service is provided on the default port for using TLS with the specified protocol.  </dd>
<dt>required[=&lt;port]&gt;</dt>
<dd style="margin-left: 8">The specified service or service instance requires use of TLS.  </dd>
<dt></dt>
<dd style="margin-left: 8">If the port parameter is specified, it speficies the port number for the TLS service in decimal.  </dd>
<dt></dt>
<dd style="margin-left: 8">If no port number is specified the TLS service is provided on the default port for using TLS with the specified protocol.  </dd>
<dt>upgrade</dt>
<dd style="margin-left: 8">The specified service or service instance always accepts a client request to upgrade the connection to use TLS.  </dd>
</dl>

<p> </p>
<p></p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Relation to Existing Work</h1>
<p id="rfc.section.4.p.1">Extended Service Discrpition (ESRV) DNS Resource Records extend the principles of named service discovery first proposed in SRV <a href="#RFC2782">RFC 2782</a> <cite title="NONE">[RFC2782]</cite> and later extended in NAPTR <a href="#RFC3403">RFC 3403</a> <cite title="NONE">[RFC3403]</cite> and related specifications. The ESRV record provides an extensible container that MAY be used to provide a description of an abstract Internet service bound to a domain name or a specific instance of that Internet Service on a specific host.  </p>
<p id="rfc.section.4.p.2">Existing SRV records provide a means of allowing a client to discover a host and port number for a specific Internet protocol. ESRV records allow a further layer of abstraction in which the discovery is of an Internet Service and the service provider MAY declare a range of supported protocol options.  </p>
<p id="rfc.section.4.p.3">For example, POP <a href="#RFC1939">RFC 1939</a> <cite title="NONE">[RFC1939]</cite> and IMAP <a href="#RFC2060">RFC 2060</a> <cite title="NONE">[RFC2060]</cite> both provide means by which a mail client can access mail messages but the only means by which a client might discover that both protocols are supported is to attempt to connect to each in turn.  </p>
<p id="rfc.section.4.p.4">Although discovery by polling is practical when there are only two options, it is impractical in application areas such as federated authentication (also known as 'identity') where the number of protocols that might be employed is very large (e.g. Kerberos, SAML, OpenID, etc.) and the number of ways in which those protocols might be employed is even larger still.  Not only is polling inefficient in such circumstances, a client that fails to find a means of connection has no way to know how it might have succeeded.  </p>
<p id="rfc.section.4.p.5">ESRV records provide a means by which Internet clients and Servers can negotiate choice of protocols and protocol properties. In particular, when publication of the ESRV record is appropriately secure (e.g. through a use of DNSSEC <a href="#RFC4033">RFC 4033</a> <cite title="NONE">[RFC4033]</cite>), the ESRV record provides a means of securely negotiating critical security properties.  </p>
<p id="rfc.section.4.p.6">Today use of Internet security is the exception rather than the rule.  As a result, an attacker can frequently bypass security enhancements by persuading the parties that they do not exist.  </p>
<p id="rfc.section.4.p.7">This form of attack is a downgrade attack. While protocols such as SSL <a href="#RFC5246">RFC 5246</a> <cite title="NONE">[RFC5246]</cite> and S/MIME have measures that are intended to prevent downgrade attacks in which weaker algorithms are substituted for strong, there is currently no in-band mechanism for specifying that these enhancements are available or that they should or must be used.  </p>
<p id="rfc.section.4.p.8">While it is possible to infer such information from existing DNS records such as the port number specification in an SRV record, such approaches represent heuristics and as such are not appropriate as a means of achieving an essential security objective.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Security Considerations</h1>
<p id="rfc.section.5.p.1">TBS </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<p id="rfc.section.6.p.1">TBS </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3403">[RFC3403]</b></td>
<td class="top">
<a>Mealling, M.</a>, "<a href="http://tools.ietf.org/html/rfc3403">Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database</a>", RFC 3403, October 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2782">[RFC2782]</b></td>
<td class="top">
<a href="mailto:arnt@troll.no" title="Troll Tech">Gulbrandsen, A.</a>, <a title="Internet Software Consortium">Vixie, P.</a> and <a href="mailto:levone@microsoft.com" title="Microsoft Corporation">L. Esibov</a>, "<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, February 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4871">[RFC4871]</b></td>
<td class="top">
<a>Allman, E.</a>, <a>Callas, J.</a>, <a>Delany, M.</a>, <a>Libbey, M.</a>, <a>Fenton, J.</a> and <a>M. Thomas</a>, "<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>", RFC 4871, May 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.509">[X.509]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.509 (11/2008): Information technology - Open systems interconnection - The Directory: Public-key and attribute certificate frameworks </a>", ITU-T Recommendation X.509, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.680">[X.680]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.680 (11/2008): Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation </a>", ITU-T Recommendation X.680, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.690">[X.690]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.690 (11/2008): Information technology - Abstract Syntax Notation One (ASN.1): Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER) </a>", ITU-T Recommendation X.690, November 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Non-Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2905">[RFC2905]</b></td>
<td class="top">
<a>Vollbrecht, J.</a>, <a>Calhoun, P.</a>, <a>Farrell, S.</a>, <a>Gommans, L.</a>, <a>Gross, G.</a>, <a>de Bruijn, B.</a>, <a>de Laat, C.</a>, <a>Holdrege, M.</a> and <a>D. Spence</a>, "<a href="http://tools.ietf.org/html/rfc2905">AAA Authorization Application Examples</a>", RFC 2905, August 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1939">[RFC1939]</b></td>
<td class="top">
<a href="mailto:jgm+@cmu.edu" title="Carnegie-Mellon University">Myers, J.G.</a> and <a href="mailto:mrose@dbc.mtview.ca.us" title="Dover Beach Consulting, Inc.">M.T. Rose</a>, "<a href="http://tools.ietf.org/html/rfc1939">Post Office Protocol - Version 3</a>", STD 53, RFC 1939, May 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2060">[RFC2060]</b></td>
<td class="top">
<a href="mailto:MRC@CAC.Washington.EDU" title="University of Washington, Networks and Distributed Computing">Crispin, M.</a>, "<a href="http://tools.ietf.org/html/rfc2060">Internet Message Access Protocol - Version 4rev1</a>", RFC 2060, December 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3851">[RFC3851]</b></td>
<td class="top">
<a>Ramsdell, B.</a>, "<a href="http://tools.ietf.org/html/rfc3851">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</a>", RFC 3851, July 2004.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phillip Hallam-Baker</span> 
	  <span class="n hidden">
		<span class="family-name">Hallam-Baker</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:philliph@comodo.com">philliph@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Brian Smith</span> 
	  <span class="n hidden">
		<span class="family-name">Smith</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:brian@dns.com">brian@dns.com</a></span>

  </address>
</div>

</body>
</html>