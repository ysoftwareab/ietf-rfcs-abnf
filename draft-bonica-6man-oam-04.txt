



6man Working Group                                             R. Bonica
Internet-Draft                                          Juniper Networks
Intended status: Standards Track                               Y. Kamite
Expires: March 19, 2020                   NTT Communications Corporation
                                                                   N. So
                                                                   F. Xu
                                                            Reliance Jio
                                                                 G. Chen
                                                                   Baidu
                                                                  Y. Zhu
                                                                 G. Yang
                                                           China Telecom
                                                                 Y. Zhou
                                                               ByteDance
                                                      September 16, 2019


                       OAM Capabilities for IPv6
                        draft-bonica-6man-oam-04

Abstract

   This document defines new IPv6 Operations and Management (OAM)
   capabilities.  In order to support these new capabilities, this
   document defines an IPv6 OAM Option and an ICMPv6 OAM message.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on March 19, 2020.

Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.




Bonica, et al.           Expires March 19, 2020                 [Page 1]

Internet-Draft                  IPv6 OAM                  September 2019


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Problem Statement . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Requirements Language . . . . . . . . . . . . . . . . . . . .   2
   3.  The OAM Option  . . . . . . . . . . . . . . . . . . . . . . .   2
     3.1.  Processing  . . . . . . . . . . . . . . . . . . . . . . .   4
   4.  The ICMPv6 OAM Message  . . . . . . . . . . . . . . . . . . .   4
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   6
   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   6
   8.  Normative References  . . . . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7

1.  Problem Statement

   This document defines new IPv6 [RFC8200] Operations and Management
   (OAM) capabilities.  In order to support these new capabilities, this
   document defines an IPv6 OAM Option and an ICMPv6 [RFC4443] OAM
   message.

2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  The OAM Option

   IPv6 source nodes use the OAM option to invoke one or more OAM
   actions on downstream devices.  The OAM option can be included in any
   of the following:

   o  A Hop-by-hop header.

   o  A Destination Options header that precedes a Routing header.




Bonica, et al.           Expires March 19, 2020                 [Page 2]

Internet-Draft                  IPv6 OAM                  September 2019


   o  A Destination Options header that precedes an upper-layer header.

   If a Hop-by-hop header includes an OAM option, OAM actions MAY be
   invoked on every node along the path to the destination, including
   the destination.  If a Destination Options header that precedes a
   Routing header includes an OAM option, OAM actions are invoked by the
   first node that appears in the IPv6 Destination Address field plus
   subsequent nodes listed in the Routing header.  If a Destination
   Options header that precedes an upper-layer header includes an OAM
   option, OAM actions are invoked on the destination node only.

   The OAM option includes the following fields:

   o  Option Type (8 bits): OAM.  Value TBD by IANA.  See Note 1 and
      Note 2.

   o  Opt Data Len (8 bits): Length of Option Data, in bytes.  Value
      MUST be equal to 2.

   o  Option Data (16 bits): A bit mask indicating which OAM actions are
      to be invoked.

   +------+-----------+------------------------------------------------+
   | Bit  | Action    | Notes                                          |
   +------+-----------+------------------------------------------------+
   | 0    | Log the   | The processing node creates a log entry. The   |
   |      | packet    | log entry reflects the time at which it was    |
   |      |           | created. It also reflects the time at which    |
   |      |           | the packet arrived.                            |
   |      |           |                                                |
   | 1    | Count the | The processing node increments a counter.      |
   |      | packet    |                                                |
   |      |           |                                                |
   | 2    | Send an   | The processing node sends an ICMP OAM message  |
   |      | ICMPv6    | to the packet's source. The OAM message        |
   |      | OAM       | indicates the time at which the packet         |
   |      |           | arrived.                                       |
   |      |           |                                                |
   | 3    | Send      | The processing node sends telemetry to a       |
   |      | telemetry | monitoring station.  Telemetry includes the    |
   |      |           | packet and the time at which the packet        |
   |      |           | arrived.                                       |
   |      |           |                                                |
   | 4-15 | Reserved  |                                                |
   +------+-----------+------------------------------------------------+

              Table 1: Option Data Bits Mapped to OAM Actions




Bonica, et al.           Expires March 19, 2020                 [Page 3]

Internet-Draft                  IPv6 OAM                  September 2019


   Table 1 maps Option Data bits to OAM actions.

   NOTE 1: As per [RFC8200], the highest-order two bits of the Option
   Type (i.e., the "act" bits) specify the action taken by a processing
   node that does not recognize Option Type.  The required action is
   skip over this option and continue processing the header.  Therefore,
   IANA is requested to assign this Option Type with "act" bits "00".

   NOTE 2: As per [RFC8200], the third-highest-order bit (i.e., the
   "chg" bit) of the Option Type specifies whether Option Data can
   change on route to the packet's destination.  Because option data
   MUST NOT be changed, IANA is requested to assign this Option Type
   with "chg" bit "0".

3.1.  Processing

   The processing of OAM actions is optional.  If a node does not
   support particular OAM action, it can ignore the corresponding bit in
   Option Data.

   Having processed an OAM option, the processing node should continue
   to process the packet.  If possible, the OAM action should be
   executed in parallel with the processing of the rest of the packet.

   The processing node SHOULD execute the OAM action, even if it can not
   process the packet further.  For example, assume the following:

   o  A node receives a packet.

   o  The packet contains a Hop-by-hop Options header and the Hop-by-hop
      Options header includes the OAM option.

   o  The node does not maintain a route to the packet's Destination
      Address

   In this case, the node SHOULD execute the requested OAM action.
   Because the node does not maintain a route to the packet's
   Destination Address, it should also send an ICMPv6 Destination
   Unreachable message to the source node and discard the packet.

4.  The ICMPv6 OAM Message










Bonica, et al.           Expires March 19, 2020                 [Page 4]

Internet-Draft                  IPv6 OAM                  September 2019


           0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Type      |     Code      |          Checksum             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    Length     |                Reserved                       |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Timestamp (seconds)                       |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Timestamp (fraction)                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       +                        Original Datagram                      +
       |                                                               |

                                 Figure 1

   Figure 1 depicts the ICMPv6 OAM message.  The ICMPv6 OAM message
   contains the following fields:

   o  Type - OAM.  Value TBD by IANA.

   o  Code - MUST be set to (0) No Error.

   o  Checksum - See [RFC4443]

   o  Reserved - MUST be set to 0 and MUST be ignored upon receipt.

   o  Length - Represents the length of the padded "original datagram"
      field, measured in 32-bit words.

   o  Timestamp (seconds) - Represents the time at which the original
      packet arrived in Network Time Protocol (NTP) [RFC5905] format.

   o  Timestamp (fraction) - Represents the time at which the original
      packet arrived in NTP [RFC5905] format.

   o  Original Datagram - As much of invoking packet as possible without
      the ICMPv6 packet exceeding the minimum IPv6 MTU (1280 bytes).
      The original datagram MUST be zero padded to the nearest 32-bit
      boundary.

   ICMPv6 OAM messages SHOULD be rate limited by the sender.

   The Timestamp fields SHOULD be as accurate as possible.  They SHOULD
   reflect the time at which the original packet arrived, not the time
   at which the ICMPv6 OAM message was sent.




Bonica, et al.           Expires March 19, 2020                 [Page 5]

Internet-Draft                  IPv6 OAM                  September 2019


5.  IANA Considerations

   IANA is requested to perform the following actions:

   o  Allocate a codepoint from the Destination Options and Hop-by-hop
      Options registry (https://www.iana.org/assignments/ipv6-
      parameters/ipv6-parameters.xhtml#ipv6-parameters-2).  This option
      is called "OAM".  The "act" bits are 00 and the "chg" bit is 0.

   o  Create a subregistry in the Destination Options and Hop-by-hop
      Options registry (https://www.iana.org/assignments/ipv6-
      parameters/ipv6-parameters.xhtml#ipv6-parameters-2).  This
      subregistry is called OAM Option Data Bit Mask.  Its contents are
      defined in Table 1 of this document.

   o  Allocate a codepoint from the "ICMPv6 'type' Numbers" registry
      (https://www.iana.org/assignments/icmpv6-parameters/
      icmpv6-parameters.xml).  This type is called "OAM".  As it
      represents an informational message, its value should be greater
      than 128.

   o  Create a "Type x - OAM" subregistry in the "ICMPv6 'type' Numbers"
      registry (https://www.iana.org/assignments/icmpv6-parameters/
      icmpv6-parameters.xml) registry.  This subregistry contains the
      Code entry (0) No Error.

6.  Security Considerations

   The OAM option can also be used in denial of service attacks.
   Network devices SHOULD protect themselves against such attacks by
   limiting the number of OAM options that they process per unit time.
   If the rate limit is exceeded, the network device MAY either discard
   the packet or continue to process the packet, ignoring the OAM
   option.

7.  Acknowledgements

   The authors acknowledge Fred Baker, Shizhang Bi, Ross Callon, Brian
   Carpenter and Tom Herbert for their helpful comments.

8.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.





Bonica, et al.           Expires March 19, 2020                 [Page 6]

Internet-Draft                  IPv6 OAM                  September 2019


   [RFC4443]  Conta, A., Deering, S., and M. Gupta, Ed., "Internet
              Control Message Protocol (ICMPv6) for the Internet
              Protocol Version 6 (IPv6) Specification", STD 89,
              RFC 4443, DOI 10.17487/RFC4443, March 2006,
              <https://www.rfc-editor.org/info/rfc4443>.

   [RFC5905]  Mills, D., Martin, J., Ed., Burbank, J., and W. Kasch,
              "Network Time Protocol Version 4: Protocol and Algorithms
              Specification", RFC 5905, DOI 10.17487/RFC5905, June 2010,
              <https://www.rfc-editor.org/info/rfc5905>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8200]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", STD 86, RFC 8200,
              DOI 10.17487/RFC8200, July 2017,
              <https://www.rfc-editor.org/info/rfc8200>.

Authors' Addresses

   Ron Bonica
   Juniper Networks
   Herndon, Virginia  20171
   USA

   Email: rbonica@juniper.net


   Yuji Kamite
   NTT Communications Corporation
   3-4-1 Shibaura, Minato-ku
   Tokyo  108-8118
   Japan

   Email: : y.kamite@ntt.com


   Ning So
   Reliance Jio
   3010 Gaylord PKWY, Suite 150
   Frisco, Texas  75034
   USA

   Email: Ning.So@ril.com





Bonica, et al.           Expires March 19, 2020                 [Page 7]

Internet-Draft                  IPv6 OAM                  September 2019


   Fengman Xu
   Reliance Jio
   3010 Gaylord PKWY, Suite 150
   Frisco, Texas  75034
   USA

   Email: Fengman.Xu@ril.com


   Gang Chen
   Baidu
   No.10 Xibeiwang East Road Haidian District
   Beijing  100193
   P.R. China

   Email: phdgang@gmail.com


   Yongqing Zhu
   China Telecom
   109 West Zhongshan Ave, Tianhe District
   Guangzhou
   P.R. China

   Email: zhuyq.gd@chinatelecom.cn


   Guangming Yang
   China Telecom
   109 West Zhongshan Ave, Tianhe District
   Guangzhou
   P.R. China

   Email: yanggm.gd@chinatelecom.cn


   Yifeng Zhou
   ByteDance
   Building 1, AVIC Plaza, 43 N 3rd Ring W Rd Haidian District
   Beijing  100000
   P.R. China

   Email: yifeng.zhou@bytedance.com








Bonica, et al.           Expires March 19, 2020                 [Page 8]
