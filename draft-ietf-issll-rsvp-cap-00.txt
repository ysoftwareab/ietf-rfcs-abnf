					  draft-ietf-issll-rsvp-cap-00.txt


Internet Draft                                                Syed, Hamid,
draft-ietf-issll-rsvp-cap-00.txt			   Nortel Networks

                                			   September, 2000

		   
		Capability Negotiation: The RSVP CAP Object

Status of this Memo

   This document is an Internet-Draft and is in full conformance with all
   provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering Task
   Force (IETF), its areas, and its working groups.  Note that other groups
   may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet- Drafts as reference material
   or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
       http://www.ietf.org/ietf/1id-abstracts.txt 
   The list of Internet-Draft Shadow Directories can be accessed at 
       http://www.ietf.org/shadow.html.

   Distribution of this memo is unlimited.

Copyright Notice 

   Copyright (C) The Internet Society (2000). All Rights Reserved.


1. Abstract
   
   The DCLASS object is proposed in [DCLASS] to represent and carry 
   Differentiated Services Code Points (DSCPs) within RSVP messages. The
   principle use of the DCLASS object is to carry DSCP information
   between a DS network and upstream nodes that may wish to mark packets
   with DSCP values. A network element in the DS network determines the
   value for DSCP which is further carried as a DCLASS object in RSVP 
   RESV message to the sender host. 
   
   There may be situations where the sender host is not capable or may 
   not wish to mark the packets. Currently, there is no way for the 
   host or network devices to specify their capabilities to the upstream 
   nodes.

   This draft proposes a capability object (CAP object) in the RSVP PATH
   message that can be used to convey end host/downstream node 
   capabilities to the upstream network. It also defines one bit in the 
   CAP field of the CAP object to convey the host/downstream node's 

   Hamid			Expires March, 2001	         [Page 1]
   draft-ietf-issll-rsvp-cap-00.txt	                  September, 2000
  
   marking capability/willingness for accepting a DCLASS object from the
   upstream network and marking the upstream packets. 
   

2. Introduction

   The mechanics of using RSVP [RSVP] signalling and the DCLASS object 
   for requesting and applying the QoS in a differentiated services [DS] 
   network is described fully in [INTDIFF]. It assumes an architecture 
   with RSVP senders and receivers and a differentiated services network 
   somewhere between the sender and the receiver. At least one RSVP aware
   network element resides in the diff-serv network. This network element 
   interacts with RSVP messages arriving from outside the DS network. 

   The principle use of the DCLASS object is to carry DSCP information
   between a DS network and upstream nodes that may wish to mark packets
   with DSCP values. A network element in the DS network determines the
   value for DSCP which is further carried as a DCLASS object in RSVP 
   RESV message to the sender host. If the network element determines 
   that the request represented by the PATH and RESV messages is 
   admissible to the diff-serv network, a desision is made to mark the 
   arriving data packets for this traffic using MF classification, or 
   to request upstream marking of packets with the appropriate DSCPs. 
   If the network element decides the packets to be marked at the sender
   host for the data traffic, it adds a DCLASS object in the RSVP RESV 
   message to the host. The use and format of DCLASS object is fully 
   specified in [DCLASS].

   There may be situations where the sender host is not capable or may
   not wish to mark the packets. In the current definition of DCLASS 
   object, the network edge device inserts the DCLASS object in the RSVP
   RESV message without having any prior knowledge of the host capability
   whether or not the host can make use of this object. This is one 
   example where the network element needs to know the host capabilities
   before making a policy decision. Moreover, the definition of DCLASS
   object allows any DS domain to supply DCLASS object on a flow to the 
   downstream DS domains. A prior knowledge of the downstream DS domain's 
   marking capability could be useful for the upstream DS domain. There
   could be other scenerios where an advance knowledge of the host or a 
   downstream node's capability  may help the network to provide better
   policy decisions to the end host. Currently, there is no way for the
   host or network devices to specify their capabilities.

   The decision where the data packets should be marked can be made at the 
   DS network nodes assuming that the network edge devices have a prior
   knowledge of the marking capability of the downstream domains. 
   Section 3 of this draft describes two scenarios to explain the use of 
   CAP object in RSVP PATH message.
     
3. Capability Negotiation
 
   The capability object called 'CAP' object can be used as a mechanism
   for conveying node capabilities or willingness in RSVP messages. As an
   example, we will focus on the marking capability of nodes throughout 
   this document and define a single bit for host marking information to
   be carried in the CAP field inside the CAP object of RSVP PATH message.

   Hamid			Expires March, 2001	         [Page 2]
   draft-ietf-issll-rsvp-cap-00.txt	                  September, 2000
  
   However, the CAP is a generic object that can be used to carry any other
   meaningful capability information in the RSVP PATH message. To explain 
   the use of CAP object in RSVP PATH message, we will describe two 
   scenarios
 
       - Host-Edge router interaction 
       - Border Router-Border Router interaction 

   It should be noted that how and when the packets will be marked is a 
   decision governed by the network policies. The network policy domain
   may or may not trust the end host marking. Hence, even though the network
   may have supplied the DCLASS object to the end host on request (via CAP)
   it may overwrite the marking based on the domain policy.  


3.1 Host-Edge Router Capbility Negotiation

   The advance knowledge of the end host's capabilities may help the
   network edge devices to make policy decisions on end host's requests. 
   These capabilities can be indicated in the RSVP PATH message to the 
   upstream edge devices. 
 
   The end hosts can be classiffied in two categories: Those capable of 
   marking upstream packets and decide to do so. The other category of 
   hosts either do not have the capability to mark packets or they decide 
   not to mark packets. In either case, the network element needs to know 
   the host packet marking capability/willingness. This information can 
   help the network element to decide whether or not a DCLASS object must
   be added in a RSVP message for the flow. One way to convey the host
   capability/willingness to the network is to use the RSVP PATH message.
   We give examples here to explain the scenarios.

   If the sender host is ready to mark the upstream traffic (based on the 
   DCLASS provided by the network element), it sets the marking bit of the
   CAP field inside the CAP object of the RSVP PATH message. On receiving 
   the RSVP message, the network element at the DS edge records the host 
   marking capability as the PATH state. It then resets the marking bit and
   sends the RSVP message to the upstream nodes. The treatment of the CAP 
   object at the upstream nodes will be explained in next section. For now,
   consider the RESV message comes back to the edge device, it performs the
   necessary admission control. If the network element determines that the 
   request represented by the PATH and RESV messages is admissible to the 
   diff-serv network, it adds a DCLASS object after consulting the recorded 
   state. It may decide to overwrite any DCLASS object inserted by the 
   an upstream node/domain based on its own domain policies. This is exactly
   how the DCLASS object is defined. 

   Another example could be the end host that is not capable of upstream 
   packet marking. This either will not include a CAP object or the host 
   will reset the marking bit of the CAP object as an indication of his
   unwillingness of packet marking. The network edge router will then know
   that the downstream node/end host does not require a DCLASS object. The
   edge router, in this case, would be responsible for marking the upstream 
   packets from the end host.

   Hamid			Expires March, 2001	         [Page 3]
   draft-ietf-issll-rsvp-cap-00.txt	                  September, 2000
   
3.2 Boundry router-Boundry Router Interaction
    
   The CAP object could be carried in the PATH message end-to-end. The RSVP
   PATH message is generated by the end host. The network edge router 'A'
   of the DS domain processes the message, resets the marking bit of the 
   CAP object (if it comes as set from the host) and passes the PATH message
   to the next RSVP Hop. For a DS domain, the boundray router 'B' of the 
   access/stub network receives the RSVP PATH message as next RSVP enabled
   node (Figure 1). It may set the marking bit again to advertise the marking 
   capability of its own domain. The decision must be governed by the domain
   policy. The ingress boundary router 'C' of the upstream domain receives
   the CAP object with the marking bit set providing an indication of the 
   marking capability of the downstream node/domain. It again stores this
   information as the PATH state, resets the marking bit and passes it to 
   the upstream RSVP enabled network element. The boundary router 'D' of 
   this domain may decide to set the marking bit again based on the domain
   policy. The PATH message may pass through more domains like this until
   it is received by the host. The RSVP RESV message is then generated and
   passed through the same route. The RSVP message arrives at the the 
   router 'C' and it may contain a DCLASS object provided by an upstream 
   node/domain. The PATH state of router 'C' indicates that the downstream 
   node/domain is capable of packet marking and a DCLASS object is to be 
   passed back. The domain policy/admission control decisions of router 'C'
   may not allow the router to use the same DCLASS value as it received 
   from the upstream. So it may decide to overwrite the DCLASS value. The
   edge router 'A' may also decide to remark the DCLASS value in the RESV 
   message following its admission control outcome and knowing the end 
   host's willingness for packet marking. Finally, the end host receives
   the DCLASS value in RESV message and it may start marking the upstream 
   packets with the appropriate DSCP. 

   Once again, It should be noted that how and when the packets will be 
   marked is a decision governed by the network policies. The network 
   policy domain may or may not trust the end host marking. Hence, even 
   though the network may have supplied the DCLASS object to the end host
   on request (via CAP) it may overwrite the marking based on the domain 
   policy.
               
                 +----------+         +-----------+
                 |DS domain |         |DS domain  |
                 |     1    |         |     2     |
    +----+     +----+     +----+    +----+      +----+         +----+
    |Host|-----| A  |     | B  |----| C  |      | D  |---''''''|Host|    
    +----+     +----+     +----+    +----+      +----+         +----+
                 |          |         |           |
                 |          |         |           |
                 +----------+         +-----------+

			      Figure 1

4. Format of CAP Object
    
   The CAP object has the following format:

              0       |       1       |       2       |       3
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      Length                   |   C-Num (226) |      C-Type=1 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                 	CAP field		              | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Hamid			Expires March, 2001	         [Page 4]
   draft-ietf-issll-rsvp-cap-00.txt	                  September, 2000

   CAP field:

	0x01: D_MARK 
		The host marking capability/willingness identifier.
		If D_MARK bit is reset, the sender host/downstream node 
                is not able to mark packets
		If D_MARK bit is set, the sender host/Downstream node is 
                able/willing to mark packets

   Note: D_MARK is a bit in the CAP (capbility) field.

5. Deployment Scenarios

   There are a number of hosts today which do have the marking capability 
   and they even do not depend on a DCLASS object from the network. The
   marking is based on a default mapping from requested service type to 
   the DSCP. In this section, we will briefly address the deployment 
   scenarios for such hosts which do mark without signaling network
   about their marking capability.
   
   If a host does not provide an CAP object, then the network edge must
   be provisioned (or be given policies) as to how it should react. This
   may be one of:
    - send a DCLASS object.
    - install a filter to mark the appropriate flow at the edge.
    - do both.
   The problem here is ensuring that the mapping configured in the host
   matches the allowed mappings configured in the edge router. If there
   is a mismatch, the edge router will, at best, remark the packets to
   match its policies (possibly resulting in a treatment different from
   that expected by the host) or, at worst, mark packets as non-conforming
   and discard them. The policy may be for a specific host address, for 
   a specific interface, for a specific edge router or for the entire 
   domain. The bottom line is that manual provisioning would be required
   in the interim until hosts support the CAP option. Once hosts support
   the CAP option, manual provisioning would no longer be required.
   
   In a multi-domain scenario, the boundary router 'B' could be the first
   and the only router in the first DS domain who is dealing with the 
   CAP/DCLASS objects (maintaining the state information and deciding for
   a DSCP for the downstream end host). This will allow only one router
   in a domain with the knowledge of the host's capability and will be 
   the one responsible for deciding/providing a DCLASS object in a RSVP 
   RESV message. In this scenario, the boundary router 'B' becomes the DS
   edge for the end host.

  6. References

   [INTDIFF], Bernet, Y., Yavatkar, R., Ford, P., Baker, F., Zhang, L.,
   Speer, M., Braden, R., Davie, B., Wroclawski, J., "Integrated Services
   Operation over Diffserv Networks", Internet Draft, June 1999

   [DS] An Architecture for Differentiated Services.  S. Blake, D. Black,
   M. Carlson, E. Davies, Z. Wang, W. Weiss, RFC 2475, December 1998.


   Hamid			Expires March, 2001	         [Page 5]
   draft-ietf-issll-rsvp-cap-00.txt	                  September, 2000

   [RSVP] Braden, R. ed., "Resource ReSerVation Protocol (RSVP) -
   Functional Specification.", IETF RFC 2205, Sep.  1997.

   [DCLASS] Bernet, Y., "Format of the RSVP DCLASS Object", 
   IETF <draft-ietf-isll-dclass-01.txt>, Oct., 1999.

6. Acknowledgments

   Thanks to Bill Gage, Yoram Bernet, Goran Janevski, Gary Kenward, 
   kwok Ho chan, Muhammad Jaseemuddin and Louis-Nicolas Hamer for 
   reviewing this draft and providing useful input. 

7. Author's Address

   Syed, Hamid
   Nortel Networks
   100 - Constellation Crescent, 
   Nepean, ON K2G 6J8
   Phone: (613) 763-6553
   Email: hmsyed@nortelnetworks.com 
  
8. Full Copyright Statement

   "Copyright (C) The Internet Society (date). All Rights Reserved.
   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph
   are included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organisations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT
   NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN
   WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
  









   Hamid			Expires March, 2001	         [Page 6]
   draft-ietf-issll-rsvp-cap-00.txt	                  September, 2000
