





Internet Engineering Task Force                                 E. Chen
Internet Draft                                       Palo Alto Networks
Updates: 4271 (if approved)                                 S. Olofsson
Intended Status: Standards Track                         Graphiant Inc.
Expiration Date: April 19, 2022                        October 18, 2021


           Relax the AS Loop Detection for Aggregates in BGP
                   draft-chen-idr-asloop-aggr-00.txt

Abstract

   Currently an BGP aggregate may be denied or excluded by the AS loop
   detection mechanism when a more specific, contributing route contains
   the local AS number.  To help enhance network robustness and simplify
   network operations, in this document we propose that the AS loop
   detection be relaxed for aggregates with an AS_SET path segment.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 19, 2022.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as



Chen & Olofsson                                                 [Page 1]





Internet Draft      draft-chen-idr-asloop-aggr-00.txt       October 2021


   described in the Simplified BSD License.


1. Introduction

   As described in Section 5.1.6 of the BGP specification [RFC4271], the
   AS_SET path segment is formed when aggregating several routes, and it
   normally includes the set of ASes from which the aggregate was
   formed.  The aggregate, being less specific than the contributing
   routes, is different from any of the more specific, contributing
   routes, and is a new route for all practical purposes.

   When an aggregate is propagated through the routing system, it may
   land in a network that has contributed with a more specific route to
   the aggregate and thus has its AS number present in the AS_SET path
   segment of the AS_PATH attribute.  The aggregate may be denied, or be
   excluded in BGP route selection due to the AS loop detection
   mechanism specified in Section 9.1.2 [RFC4271]:

      If the AS_PATH attribute of a BGP route contains an AS loop, the
      BGP route should be excluded from the Phase 2 decision function.
      AS loop detection is done by scanning the full AS path (as
      specified in the AS_PATH attribute), and checking that the
      autonomous system number of the local system does not appear in
      the AS path.  Operations of a BGP speaker that is configured to
      accept routes with its own autonomous system number in the AS path
      are outside the scope of this document.

   By dropping the aggregate, or excluding it in BGP route selection
   when the local AS is contained in the AS_SET, one can lose
   reachability, in particular when only the aggregate is advertised and
   the more specific contributing routes are suppressed.

   Although BCP 172 [RFC6472] makes a recommendation for not using the
   AS_SET path segment in BGP, the AS_SET path segment may remain in use
   for a long time.

   To help enhance network robustness and simplify network operations,
   in this document we propose that the AS loop detection be relaxed for
   aggregates with an AS_SET path segment.











Chen & Olofsson                                                 [Page 2]





Internet Draft      draft-chen-idr-asloop-aggr-00.txt       October 2021


2. Revision to AS Loop Detection

   The AS loop detection specified in Section 9.1.2. of [RFC4271] is
   revised as follows:

      Old text:

         AS loop detection is done by scanning the full AS path (as
         specified in the AS_PATH attribute), and checking that the
         autonomous system number of the local system does not appear
         in the AS path.

      New text:

         AS loop detection is done by scanning the full AS path (as
         specified in the AS_PATH attribute) but excluding the AS path
         segments with the AS_SET segment type, and checking that the
         autonomous system number of the local system does not appear
         in the AS path.


3. IANA Considerations

   This document makes no request to IANA.


4. Security Considerations

   The revision proposed in this document does not change the underlying
   security or confidentiality issues inherent in the existing BGP
   [RFC4271].


5. Acknowledgments

   TBD.















Chen & Olofsson                                                 [Page 3]





Internet Draft      draft-chen-idr-asloop-aggr-00.txt       October 2021


6. References

6.1. Normative References

   [RFC4271]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A
              Border Gateway Protocol 4 (BGP-4)", RFC 4271,
              DOI 10.17487/RFC4271, January 2006,
              <http://www.rfc-editor.org/info/rfc4271>.


6.2. Informative References

   [RFC6472]  Kumari, W. and K. Sriram, "Recommendation for Not Using
              AS_SET and AS_CONFED_SET in BGP", BCP 172, RFC 6472,
              DOI 10.17487/RFC6472, December 2011,
              <https://www.rfc-editor.org/info/rfc6472>.


7. Authors' Addresses

   Enke Chen
   Palo Alto Networks, Inc.

   Email: enchen@paloaltonetworks.com

   Stefan Olofsson
   Graphiant Inc.

   Email: stefan@Graphiant.com






















Chen & Olofsson                                                 [Page 4]


