<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>TLS Transport Mapping for Syslog</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TLS Transport Mapping for Syslog">
<meta name="keywords" content="RFC, Request for Comments, Syslog TLS Transport Security, Internet-Draft, XML, Extensible Markup Language">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Syslog Working Group</td><td class="header">F. Miao, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Y. Ma, Ed.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Huawei Technologies</td></tr>
<tr><td class="header">Expires: April 4, 2009</td><td class="header">J. Salowey, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 01, 2008</td></tr>
</table></td></tr></table>
<h1><br />TLS Transport Mapping for Syslog<br />draft-ietf-syslog-transport-tls-14.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 4, 2009.</p>

<h3>Abstract</h3>

<p>This document describes the use of Transport Layer Security (TLS) to
      provide a secure connection for the transport of syslog messages. This
      document describes the security threats to syslog and how TLS can be
      used to counter such threats.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
<a href="#reqs">2.</a>&nbsp;
Security Requirements for Syslog<br />
<a href="#anchor3">3.</a>&nbsp;
Using TLS to Secure Syslog<br />
<a href="#anchor4">4.</a>&nbsp;
Protocol Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Port Assignment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Initiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certauth">4.2.1.</a>&nbsp;
Certificate-Based Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#finger">4.2.2.</a>&nbsp;
Certificate Fingerprints<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.3.</a>&nbsp;
Cryptographic Level<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.3.</a>&nbsp;
Sending data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.3.1.</a>&nbsp;
Message Length<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.4.</a>&nbsp;
Closure<br />
<a href="#secpol">5.</a>&nbsp;
Security Policies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#eeauth">5.1.</a>&nbsp;
End-Entity Certificate Based Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#recpol">5.2.</a>&nbsp;
Subject Name Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.3.</a>&nbsp;
Unauthenticated Transport Sender<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.4.</a>&nbsp;
Unauthenticated Transport Receiver<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.5.</a>&nbsp;
Unauthenticated Transport Receiver and Sender<br />
<a href="#anchor14">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">6.1.</a>&nbsp;
Authentication and Authorization Policies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">6.2.</a>&nbsp;
Name Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">6.3.</a>&nbsp;
Reliability<br />
<a href="#anchor18">7.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">7.1.</a>&nbsp;
Port Number<br />
<a href="#anchor20">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#anchor23">Appendix&nbsp;A.</a>&nbsp;
Changes from -12<br />
<a href="#anchor24">Appendix&nbsp;B.</a>&nbsp;
Changes from -13<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes the use of Transport Layer Security (<a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246]) to provide a secure connection for the
      transport of <a class='info' href='#I-D.ietf-syslog-protocol'>syslog<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;syslog&#8209;protocol]
      messages. This document describes the security threats to syslog and how
      TLS can be used to counter such threats.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>The following definitions are used in this document: </p>
<ul class="text">
<li>An "originator" generates syslog content to be carried in a
            message.
</li>
<li>A "collector" gathers syslog content for further analysis.
</li>
<li>A "relay" forwards messages, accepting messages from
            originators or other relays, and sending them to collectors or
            other relays.
</li>
<li>A "transport sender" passes syslog messages to a specific
            transport protocol.
</li>
<li>A "transport receiver" takes syslog messages from a specific
            transport protocol.
</li>
<li>A "TLS client" is an application that can initiate a TLS
      connection by sending a Client Hello to a server.
</li>
<li>A "TLS server" is an application that can receive a Client Hello
      from a client and reply with a Server Hello.
</li>
</ul>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Security Requirements for Syslog</h3>

<p>Syslog messages may transit several hops to arrive at the intended
      collector. Some intermediary networks may not be trusted by the
      originator, relay, or receiver because the network is in a
      different security domain or at a different security level from the
      originator, relay, or collector. Another security concern is that the
      originator, relay, or receiver itself is in an insecure network.
</p>
<p>There are several threats to be addressed for syslog security. The
      primary threats are: </p>
<ul class="text">
<li>Masquerade. An unauthorized transport sender may send messages to
          a legitimate transport receiver, or an unauthorized transport
          receiver tries to deceive a legitimate transport sender into sending
          syslog messages to it.
</li>
<li>Modification. An attacker between the transport sender and the
          transport receiver may modify an in-transit syslog message and then
          forward the message to the transport receiver. Such modification may
          make the transport receiver misunderstand the message or cause it to
          behave in undesirable ways.
</li>
<li>Disclosure. An unauthorized entity may examine the contents of
          the syslog messages, gaining unauthorized access to the information.
          Some data in syslog messages is sensitive and may be useful to an
          attacker, such as the password of an authorized administrator or
          user.
</li>
</ul>

<p>The secondary threat is: </p>
<ul class="text">
<li>Message stream modification. An attacker may delete one or more
          syslog message from a series of messages, replay a message, or alter
          the delivery sequence. The syslog protocol itself is not based on
          message order, but an event in a syslog message may relate
          semantically to events in other messages, so message ordering may be
          important to understanding a sequence of events.
</li>
</ul>

<p>The following threats are deemed to be of lesser importance for
      syslog, and are not addressed in this document: </p>
<ul class="text">
<li>Denial of Service
</li>
<li>Traffic Analysis
</li>
</ul>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Using TLS to Secure Syslog</h3>

<p>TLS can be used as a secure transport to counter all the primary
      threats to syslog described above: </p>
<ul class="text">
<li>Confidentiality to counter disclosure of the message
          contents;
</li>
<li>Integrity checking to counter modifications to a message on a
          hop-by-hop basis;
</li>
<li>Server or mutual authentication to counter masquerade.
</li>
</ul><p>Note: This secure transport (i.e., TLS) only secures syslog
   transport in a hop-by-hop manner, and is not concerned with the
   contents of syslog messages.  In particular, the authenticated
   identity of the transport sender (e.g., subject name in the 
   certificate) is not necessarily related to the HOSTNAME field 
   of the syslog message. When authentication of syslog
   message origin is required, <a class='info' href='#I-D.ietf-syslog-sign'>[I&#8209;D.ietf&#8209;syslog&#8209;sign]<span> (</span><span class='info'>Kelsey, J., Callas, J., and A. Clemm, &ldquo;Signed syslog Messages,&rdquo; December&nbsp;2009.</span><span>)</span></a> can be used.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Elements</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Port Assignment</h3>

<p>A syslog transport sender is always a TLS client and a transport
        receiver is always a TLS server.
</p>
<p>The TCP port NNN has been allocated as the default port for syslog
        over TLS, as defined in this document.
</p>
<p>Note to RFC Editor: please replace NNN with the IANA-assigned
        value, and remove this note.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Initiation</h3>

<p>The transport sender should initiate a connection to the transport
        receiver and then send the TLS Client Hello to begin the TLS
        handshake. When the TLS handshake has finished the transport sender
        MAY then send the first syslog message.
</p>
<p>TLS typically uses <a class='info' href='#RFC5280'>certificates<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5280] to authenticate
        peers.  Implementations MUST support
  <a class='info' href='#RFC5246'>TLS 1.2<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] and are REQUIRED to support the mandatory to implement cipher suite, which is TLS_RSA_WITH_AES_128_CBC_SHA. This document is assumed to apply to future versions of TLS, in which case the mandatory to implement cipher suite for the implemented version MUST be supported.
</p>
<a name="certauth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Certificate-Based Authentication</h3>

<p>Both syslog transport sender (TLS Client) and syslog transport receiver (TLS server) MUST implement certificate-based authentication. This consists of validating the certificate and verifying that the peer has the corresponding private key. The latter part is performed by TLS. To ensure interoperability between clients and servers, the following methods for certificate validation SHALL be implemented:
</p>
<ul class="text">
<li>Certification path validation: The TLS peer is configured with one
   or more trust anchors (typically root CA certificates), 
   which allow it to verify a binding between
   the subject name and the public key. Additional policy controls
   needed for authorizing the syslog transport sender and receiver
   (i.e., verifying that the subject name represents an authorized
   party) are described in <a class='info' href='#secpol'>Section&nbsp;5<span> (</span><span class='info'>Security Policies</span><span>)</span></a>. Certificate path 
   validation is performed as defined in 
   <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  This method is 
   useful where there is a PKI deployment.
</li>
<li>End-entity certificate matching: The transport sender or receiver
   is configured with information necessary to identify the valid end-entity
   certificates of its authorized peers. The end-entity certificates
   can be self-signed, and no certification path validation is needed.
   Implementations MUST support certificate fingerprints in <a class='info' href='#finger'>Section&nbsp;4.2.2<span> (</span><span class='info'>Certificate Fingerprints</span><span>)</span></a> 
   and MAY allow other formats for end-entity certificates such as a DER 
   encoded certificate.  This method provides an alternative to a PKI 
   that is simple to deploy and still maintains a reasonable level of security. 
</li>
</ul>
<p>Both transport receiver and transport sender implementations MUST provide a means to generate a key pair and self-signed certificate in the case that a key pair and certificate are not available through another mechanism.
</p>
<p> The transport receiver and transport sender SHOULD provide mechanisms to record the end-entity certificate for the purpose of correlating it with the sent or received data.
</p>
<a name="finger"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Certificate Fingerprints</h3>

<p>Both client and server implementations MUST make the certificate
    fingerprints for their certificate available through a management
    interface.  The labels for the algorithms are taken from the textual
    names of the hash functions as defined in the IANA registry "Hash
    Function Textual Names" allocated in <a class='info' href='#RFC4572'>[RFC4572]<span> (</span><span class='info'>Lennox, J., &ldquo;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP),&rdquo; July&nbsp;2006.</span><span>)</span></a>.  
</p>
<p>The mechanism to generate a fingerprint is to take the hash of the
    DER-encoded certificate using a cryptographically strong algorithm
    and convert the result into colon separated, hexadecimal bytes, each
    represented by 2 uppercase ASCII characters.  When a fingerprint
    value is displayed or configured the fingerprint is prepended with an
    ASCII label identifying the hash function followed by a colon.
    Implementations MUST support SHA-1 as the hash algorithm and use the
    ASCII label "sha-1" to identify the SHA-1 algorithm.  The length of a
    SHA-1 hash is 20 bytes and the length of the corresponding
    fingerprint string is 65 characters.  An example certificate
    fingerprint is:

</p>
<blockquote class="text">
<p>sha-1:E1:2D:53:2B:7C:6B:8A:29:A2:76:C8:64:36:0B:08:4B:7A:F1:9E:9D
</p>
</blockquote>
<p>During validation the hash is extracted from the fingerprint and compared against the hash calculated over the received certificate.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Cryptographic Level</h3>

<p>Syslog applications SHOULD be implemented in a manner that
          permits administrators, as a matter of local policy, to select the
          cryptographic level and authentication options they desire.
</p>
<p>TLS permits the resumption of an earlier TLS session or the use
          of another active session when a new session is requested, in order
          to save the expense of another full TLS handshake. The security
          parameters of the resumed session are reused for the requested
          session. The security parameters SHOULD be checked against the
          security requirement of the requested session to make sure that the
          resumed session provides proper security.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Sending data</h3>

<p>All syslog messages MUST be sent as TLS "application data". It is
        possible that multiple syslog messages be contained in one TLS record,
        or that a syslog message be transferred in multiple TLS records. The
        application data is defined with the following <a class='info' href='#RFC5234'>ABNF<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5234] expression:
</p>
<p>APPLICATION-DATA = 1*SYSLOG-FRAME
</p>
<p>SYSLOG-FRAME = MSG-LEN SP SYSLOG-MSG
</p>
<p>MSG-LEN = NONZERO-DIGIT *DIGIT
</p>
<p>SP = %d32
</p>
<p>NONZERO-DIGIT = %d49-57
</p>
<p>DIGIT = %d48 / NONZERO-DIGIT
</p>
<p>SYSLOG-MSG is defined in <a class='info' href='#I-D.ietf-syslog-protocol'>syslog<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;syslog&#8209;protocol] protocol.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Message Length</h3>

<p>The message length is the octet count of the SYSLOG-MSG in the
          SYSLOG-FRAME. A transport receiver MUST use the message length to
          delimit a syslog message. There is no upper limit for a message
          length per se. However, in order to establish a baseline for
          interoperability, this specification requires that a transport
          receiver MUST be able to process messages with a length up to and
          including 2048 octets. Transport receiver SHOULD be able to process
          messages with lengths up to and including 8192 octets.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Closure</h3>

<p> A transport sender MUST close the associated TLS connection if
      the connection is not expected to deliver any syslog messages
      later.  It MUST send a TLS close_notify alert before closing the
      connection.  A transport sender (TLS client) MAY choose to not
      wait for the transport receiver's close_notify alert and simply
      close the connection, thus generating an incomplete close on the
      transport receiver (TLS server) side.  Once the transport
      receiver gets a close_notify from the transport sender, it MUST
      reply with a close_notify unless it becomes aware that the
      connection has already been closed by the transport sender
      (e.g., the closure was indicated by TCP).
</p>
<p>When no data is received from a connection for a long time
      (where the application decides what "long" means), a transport
      receiver MAY close the connection.  The transport receiver (TLS
      server) MUST attempt to initiate an exchange of close_notify
      alerts with the transport sender before closing the connection.
      Transport receivers that are unprepared to receive any more data
      MAY close the connection after sending the close_notify alert,
      thus generating an incomplete close on the transport sender
      side. 
</p>
<a name="secpol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Policies</h3>

<p>Different environments have different security requirements and therefore would deploy different security policies.  This section discusses some of the security policies that may be implemented by syslog transport receivers and syslog transport senders.  The security policies describe the requirements for authentication and authorization.  The list of policies in this section is not exhaustive and other policies MAY be implemented.  
</p>
<p>If the peer does not meet the requirements of the security
      policy, the TLS handshake MUST be aborted with an appropriate
      TLS alert.
</p>
<a name="eeauth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
End-Entity Certificate Based Authorization</h3>

<p>In the simplest case, the transport sender and receiver are
   configured with information necessary to identity the valid
   end-entity certificates of its authorized peers.
</p>
<p>   Implementations MUST support specifying the authorized peers using
   certificate fingerprints, as described in <a class='info' href='#certauth'>Section&nbsp;4.2.1<span> (</span><span class='info'>Certificate-Based Authentication</span><span>)</span></a> and <a class='info' href='#finger'>Section&nbsp;4.2.2<span> (</span><span class='info'>Certificate Fingerprints</span><span>)</span></a>.
</p>
<a name="recpol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Subject Name Authorization</h3>

<p>Implementations MUST support certification path validation <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
    In addition they MUST support specifying the authorized peers using
    locally configured host names and matching the name against the
    certificate as follows.
</p>
<ul class="text">
<li>Implementations MUST support matching the locally configured host
      name against a dNSName in the subjectAltName extension field and
      SHOULD support checking the name against the common name portion of
      the subject distinguished name.
</li>
<li>The '*' (ASCII 42) wildcard character is allowed in the dNSName of
      the subjectAltName extension (and in common name, if used to store
      the host name), and then only as the left-most (least significant)
      DNS label in that value.  This wildcard matches any left-most DNS
      label in the server name.  That is, the subject *.example.com matches
      the server names a.example.com and b.example.com, but does not match
      example.com or a.b.example.com.  Implementations MUST support
      wildcards in certificates as specified above, but MAY provide a
      configuration option to disable them.
</li>
<li>Locally configured names MAY contain the wildcard character to match
      a range of values.  The types of wildcards supported MAY be more
      flexible than that which is allowed in subject names to make it
      possible to support various policies for different environments.  For
      example, a policy could allow for a trust-root-based authorization
      where all credentials issued by a particular CA trust root are
      authorized.
</li>
<li>If the locally configured name is an internationalized domain name,
      conforming implementations MUST convert it to the ASCII Compatible
      Encoding (ACE) format for performing comparisons as specified in
      Section 7 of <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</li>
<li>Implementations MAY support matching a locally configured IP address
      against an iPAddress stored in the subjectAltName extension.  In this
      case, the locally configured IP address is converted to an octet
      string as specified in <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>, Section 4.2.1.6.  A match occurs if
      this octet string is equal to the value of iPAddress in the
      subjectAltName extension.
</li>
</ul>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Unauthenticated Transport Sender</h3>

<p>
In some environments, the authenticity of syslog data is not important or it is verifiable by other means, so transport receivers may accept data from any transport sender.  To achieve this, the transport receiver can skip transport sender authentication (by not requesting client authentication in TLS, or accepting any certificate).   In this case, the transport receiver is authenticated and authorized, however this policy does not protect against the threat of transport sender masquerade described in <a class='info' href='#reqs'>Section&nbsp;2<span> (</span><span class='info'>Security Requirements for Syslog</span><span>)</span></a>.  The use of this policy is generally NOT RECOMMENDED for this reason. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Unauthenticated Transport Receiver</h3>

<p>In some environments the confidentiality of syslog data is not important so messages are sent to any transport receiver.  To achieve this, the transport sender can skip transport receiver authentication (by accepting any certificate).   While this policy does authenticate and authorize the transport sender, it does not protect against the threat of transport receiver masquerade described in <a class='info' href='#reqs'>Section&nbsp;2<span> (</span><span class='info'>Security Requirements for Syslog</span><span>)</span></a>, leaving the data sent vulnerable to disclosure and modification.  The use of this policy is generally NOT RECOMMENDED for this reason.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Unauthenticated Transport Receiver and Sender</h3>

<p>In environments where security is not a concern at all, both the transport receiver and transport sender can skip authentication (as described in Sections 5.3 and 5.4).  This policy does not protect against any of the threats described in <a class='info' href='#reqs'>Section&nbsp;2<span> (</span><span class='info'>Security Requirements for Syslog</span><span>)</span></a> and is therefore NOT RECOMMENDED.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>This section describes security considerations in addition to those in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>. 
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Authentication and Authorization Policies</h3>

<p>
<a class='info' href='#secpol'>Section&nbsp;5<span> (</span><span class='info'>Security Policies</span><span>)</span></a> discusses various security policies that may be deployed.  The threats in <a class='info' href='#reqs'>Section&nbsp;2<span> (</span><span class='info'>Security Requirements for Syslog</span><span>)</span></a> are mitigated only if both the transport sender and transport receiver are properly authenticated and authorized, as described in <a class='info' href='#eeauth'>Section&nbsp;5.1<span> (</span><span class='info'>End-Entity Certificate Based Authorization</span><span>)</span></a> and <a class='info' href='#recpol'>Section&nbsp;5.2<span> (</span><span class='info'>Subject Name Authorization</span><span>)</span></a>.  These are the RECOMMENDED configurations for a default policy.
</p>
<p>
If the transport receiver does not authenticate the transport sender it may accept data from an attacker.  Unless it has another way of authenticating the source of the data, the data should not be trusted.  This is especially important if the syslog data is going to be used to detect and react to security incidents.  The transport receiver may also increase its vulnerability to denial of service, resource consumption and other attacks if it does not authenticate the transport sender.  Because of the increased vulnerability to attack, this type of configuration is NOT RECOMMENDED. 
</p>
<p>
If the transport sender does not authenticate the syslog transport receiver then it may send data to an attacker.  This may disclose sensitive data within the log information that is useful to an attacker resulting in further compromises within the system.  If a transport sender is operated in this mode, the data sent SHOULD be limited to data that is not valuable to an attacker.  In practice this is very difficult to achieve, so this type of configuration is NOT RECOMMENDED.
</p>
<p>
Forgoing authentication and authorization on both sides allows for man-in-the-middle, masquerade and other types of attacks that can completely compromise integrity and confidentiality of the data.  This type of configuration is NOT RECOMMENDED.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Name Validation</h3>

<p>The subject name authorization policy authorizes the subject in the certificate against a locally configured name.  It is generally not appropriate to obtain this name through some other means such as DNS lookup since this introduces additional security vulnerabilities. 
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Reliability</h3>

<p>  It should be noted that the syslog transport specified in this
  document does not use application-layer acknowledgments.  TCP uses
  retransmissions to provide protection against some forms of data
  loss. However, if the TCP connection (or TLS session) is broken for
  some reason (or closed by the transport receiver), the syslog
  transport sender cannot always know what messages were successfully
  delivered to the syslog application at the other end. 
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Port Number</h3>

<p>IANA is requested to assign a TCP port number in the "Registered
      Port Numbers" range with the name "syslog-tls". This port will
      be the default port for syslog over TLS, as defined in this
      document.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>Authors appreciate Eric Rescorla, Rainer Gerhards, Tom Petch, Anton
      Okmianski, Balazs Scheidler, Bert Wijnen, Martin Schuette, Chris Lonvick 
      and members of the syslog working group for their
      effort on issues resolving discussion. Authors would also like to
      appreciate Balazs Scheidler, Tom Petch and other persons for their input
      on security threats of syslog. The authors would like to acknowledge
      David Harrington for his detailed reviews of the content and grammar of
      the document and Pasi Eronen for his contributions to certificate 
      authentication and authorization sections.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-syslog-protocol">[I-D.ietf-syslog-protocol]</a></td>
<td class="author-text">Gerhards, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-protocol-23.txt">The syslog Protocol</a>,&rdquo; draft-ietf-syslog-protocol-23 (work in progress), September&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-protocol-23.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-syslog-sign">[I-D.ietf-syslog-sign]</a></td>
<td class="author-text">Kelsey, J., Callas, J., and A. Clemm, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-sign-29.txt">Signed syslog Messages</a>,&rdquo; draft-ietf-syslog-sign-29 (work in progress), December&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-sign-29.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4572">[RFC4572]</a></td>
<td class="author-text">Lennox, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4572">Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;4572, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4572.txt">TXT</a>).</td></tr>
</table>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Changes from -12</h3>

<p>Please remove in published RFC.
</p>
<blockquote class="text">
<p>Section 3: Expanded note to include reference to Syslog Sign.
</p>
<p>Section 4.2: Included mandatory to implement ciphersuites that track future versions of the TLS
</p>
<p>Section 4.2.1: Revised to certificate based authentication mechanisms. authorization policy is covered in section 5.
</p>
<p>Section 4.2.2: added to describe fingerprint format
</p>
<p>Section 5: new security policies section 
</p>
<p>Security Considerations: added reference to TLS security considerations, removed cipher suite section which was redundant with TLS
</p>
<p>Added redundancy and name validation to security considerations section
</p>
</blockquote>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Changes from -13</h3>

<p>Please remove in published RFC.
</p>
<blockquote class="text">
<p>Section 1.1: Cleaned up definition of TLS client and TLS server
</p>
<p>Section 4.2.2: Changed certificate fingerprint section to reference hash registry (changed "SHA-1" to "sha-1"
</p>
<p>Section 4.4: Clarified transport receiver and transport sender language. Removed last sentence on sending pending data after close.
</p>
<p>Section 5: changed SHOULD be aborted to MUST be aborted
</p>
<p>Section 5.2: replaced text with bullets enumerating requirements
</p>
<p>Section 5.5: Fixed section references
</p>
<p>Section 7.1: change IANA assignment to registered port
</p>
<p>Section 8: Fixed the spelling of Martin's name
</p>
</blockquote>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fuyou Miao (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No. 3, Xinxi Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shangdi Information Industry Base</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haidian District, Beijing  100085</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P. R. China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 10 8288 2008</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:miaofy@huawei.com">miaofy@huawei.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.huawei.com">www.huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yuzhi Ma (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No. 3, Xinxi Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shangdi Information Industry Base</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haidian District, Beijing  100085</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P. R. China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 10 8288 2008</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:myz@huawei.com">myz@huawei.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.huawei.com">www.huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd. Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
