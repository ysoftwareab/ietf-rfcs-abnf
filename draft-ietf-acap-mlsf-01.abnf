MLSF-ALT           = [[MLSF-LANG-TAG] MLSF-COMPONENT
                           *(MLSF-ALTERNATE MLSF-COMPONENT)]

MLSF-ALT-QUOTED    = <"> [[MLSF-LANG-TAG] MLSF-COMPONENT-Q
                           *(MLSF-ALTERNATE MLSF-COMPONENT-Q)] <">

MLSF-ALTERNATE     = %xFE MLSF-LANG-TAG

MLSF-COMPONENT     = UTF8-NON-NUL *([MLSF-LANG-TAG] UTF8-NON-NUL)

MLSF-COMPONENT-Q   = UTF8-QUOTED *([MLSF-LANG-TAG] UTF8-QUOTED)

MLSF-LANG-TAG      = *MLSF-LANG-5 (MLSF-LANG-1 / MLSF-LANG-2 /
                          MLSF-LANG-3 / MLSF-LANG-4 / MLSF-LANG-5)
                          ;; Encoded version of Language-Tag from RFC 1766
                          ;; characters converted to uppercase, with
                          ;; A0 added and broken into MLSF-LANG components

MLSF-LANG-CONT     = %xCD / %xE1..FA

MLSF-LANG-1        = %xC0 MLSF-LANG-CONT

MLSF-LANG-2        = %xE0 2MLSF-LANG-CONT

MLSF-LANG-3        = %xF0 3MLSF-LANG-CONT

MLSF-LANG-4        = %xF8 4MLSF-LANG-CONT

MLSF-LANG-5        = %xFC 5MLSF-LANG-CONT

MLSF-SIMPLE        = [[MLSF-LANG-TAG] MLSF-COMPONENT]

MLSF-SIMPLE-QUOTED = <"> [[MLSF-LANG-TAG] MLSF-COMPONENT-Q] <">

QUOTED             = "\" QUOTED-SPECIAL

QUOTED-SPECIAL     = "\" / <">

US-ASCII-SAFE      = %x01..09 / %x0B..0C / %x0E..21
                          / %x23..5B / %x5D..7F
                         ;; US-ASCII except QUOTED-SPECIALs, CR, LF, NUL

UTF8-NON-NUL       = UTF8-SAFE / CR / LF / QUOTED-SPECIAL
UTF8-QUOTED        = UTF8-SAFE / QUOTED

UTF8-SAFE          = US-ASCII-SAFE / UTF8-1 / UTF8-2 / UTF8-3
                          / UTF8-4 / UTF8-5

UTF8-CONT          = %x80..BF

UTF8-1             = %xC0..DF UTF8-CONT

UTF8-2             = %xE0..EF 2UTF8-CONT

UTF8-3             = %xF0..F7 3UTF8-CONT

UTF8-4             = %xF8..FB 4UTF8-CONT

UTF8-5             = %xFC..FD 5UTF8-CONT


len = utlen[*src];
len = utlen[*src];
result = -1;
complen = len;
complen = 5;
best = str;
bestlen = 0;

match1 = ltag;
match2 = tag;
mlen = 0;
mlen = match1 - ltag;
best = str;
best = str;
bestlen = mlen;
