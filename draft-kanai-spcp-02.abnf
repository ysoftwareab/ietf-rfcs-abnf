OCTET           = <any 8-bit sequence of data>
CHAR            = <any US-ASCII character (octets 0 - 127)>
UPALPHA         = <any US-ASCII uppercase letter "A"-"Z">
LOALPHA         = <any US-ASCII lowercase letter "a"-"z">
ALPHA           = UPALPHA | LOALPHA
DIGIT           = <any US-ASCII digit "0"-"9">
HEXDIGIT        = "A" | "B" | "C" | "D" | "E" | "F"
                   | "a" | "b" | "c" | "d" | "e" | "f" | DIGIT
CTL             = <any US-ASCII control character (octets 0 - 31)
                      and DEL (127)>
CR              = <US-ASCII CR, carriage return (13)>
LF              = <US-ASCII LF, linefeed (10)>
CRLF            = CR LF
SP              = <US-ASCII SP, space (32)>
HTAB            = <US-ASCII HT, horizontal-tab (9)>
WSP             = 1*<SP | HTAB>
DELIMITER       = ":" WSP
PCHAR           = <any CHAR except SP or <">>
STRING          = 1*PCHAR | <">*<PCHAR|WSP><">
PHRASE          = *<STRING|WSP>


SPCP-MESSAGE    = SPCP-REQUST           ; Request
                   / SPCP-RESPONSE         ; Response
                   / SPCP-NOTIFICATION     ; Notification


SPCP-REQUEST    = REQUEST-LINE  ; Request command line
                     *INFORMATION  ; Information
                     CRLF

REQUEST-LINE    = REQUEST *(WSP PARAM) CRLF

REQUEST         = "logon"       ; authentication
                   / "exit"        ; release a session
                   / "call"        ; make a call
                   / "dial"        ; send dialed digits
                   / "answer"      ; answer an incoming call
                   / "drop"        ; hung up a call
                   / "hold"        ; hold a call
                   / "park"        ; park a call
                   / "transfer"    ; transfer a call
                   / "forward"     ; forward an incoming call
                   / "callreject"  ; reject an incoming call
                   / "conference"  ; establish a conference call
                   / "data"        ; send/receive data
                   / "indicate"    ; inquire notification
                   / "qoscontrol"  ; control QoS
                   / "param"       ; set/get parameter
                   / "do"          ; order function
                   / "name"        ; inquire product name
                   / "nop"         ; check presence
                   / "selftest"    ; self-test
                   / "X-" 1*PCHAR  ; (extensible command)

PARAM           = STRING

SPCP-RESPONSE   = RESPONSE-LINE ; Response command line
                     *INFORMATION  ; Information
                     CRLF

RESPONSE-LINE   = RESPONSE DELIMITER [COMMENT] CRLF

RESPONSE        = ("2" DIGIT DIGIT)
                                   ; success
                   / ("3" DIGIT DIGIT)
                                   ; success (needs additional command)
                   / ("4" DIGIT DIGIT)
                                   ; error
                   / ("5" DIGIT DIGIT)
                                   ; error (fatal)
                   / ("9" DIGIT DIGIT)
                                   ; (extensible response)

COMMENT = PHRASE

NOTICE-LINE     = NOTICE DELIMITER [COMMENT] CRLF

NOTICE          = "opened"      ; session established
                   / "calling"     ; calling a recipient
                   / "connect"     ; recipient answered
                   / "offering"    ; incoming call received
                   / "busy"        ; recipient is busy
                   / "disconnect"  ; call disconnected
                   / "indicate-info"
                                   ; information notice
                   / "done"        ; key/lamp data notice
                   / "progress"    ; progress of process notice
                   / "X-" 1*PCHAR  ; (extensible notice method)

COMMENT         = PHRASE

INFORMATION     = *ATTRIBUTE-LINE
                                   ; Attribute line
                     ":" CRLF
                     *DATA         ; Data

ATTRIBUTE-LINE  = ATTR-TYPE DELIMITER ATTR-VALUE CRLF
ATTR-TYPE       = "media-type"  ; media type
                   / "spcp-version"; SPCP version
                   / "length"      ; data length
                   / "timeout"     ; time limit
                   / "auth-code"   ; challenge code for authentication
                   / "cp-addr"     ; calling party address
                   / "call-reference"
                                   ; call reference number
                   / "command"     ; current process information
                   / "flag"        ; repeat indicator (start/stop)
                   / "name-type"   ; product name
                   / "function-detect"
                                   ; key/lamp information
                   / "X-" 1*PCHAR  ; (extensible attribute type)


USER-NAME       = STRING        ; Character string indicating
                                     user name
AUTH-RESPONSE   = 1*HEXDIG      ; Response to CHALLENGE CODE
                                     (See Chapter 5.)

DEST-ADDR       = STRING        ; calling party address
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

DIAL-NO         = 1*PCHAR       ; dialed digits
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

CALL-REFERENCE  = 1*HEXDIT      ; call reference number

CALL-REFERENCE  = 1*HEXDIT      ; call reference number
HOLD-SET        = "on"          ; hold a call
                   / "off"         ; retrieve a held call
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

PARK-SET        = "set"         ; park a call
                   / "answer"      ; retrieve a parked call
PARK-REFERENCE  = 1*DIGIT       ; call park reference number
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

CALL-REFERENCE1 = 1*HEXDIT      ; call reference number
CALL-REFERENCE2 = 1*HEXDIT      ; call reference number

FWR-ADDR        = STRING        ; destination address
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

CALL-REFERENCE  = 1*HEXDIT      ; call reference number

CONF-SET        = "add"         ; add somebody to a conference call
                   / "delete"      ; remove somebody from a conference call
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

DIRECTION       = "get"         ; send data
                   / "put"         ; receive data
KIND            = STRING        ; data (file) name
MEDIA-TYPE      = STRING        ; media type of data
MANAGE          = STRING        ; operation method
LENGTH          = STRING        ; data length
FLAG            = STRING        ; repeat indicator
DATA            = DATA          ; data

INDICATE-SET    = "on"          ; start sending data
                   / "off"         ; stop sending data
CALL-REFERENCE  = 1*HEXDIT      ; call reference number
INDICATE-CLASS  = STRING        ; requesting data class

VALUE           = 1*DIGIT       ; bandwidth
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

DIRECTION       = "get"         ; retrieve information
                   / "put"         ; set information
PARAM-MODE      = "key-data"    ; key data
                   / "lamp-data"   ; lamp data
                   / "system-data" ; system configuration
                   / "other"       ; other data
MEDIA-TYPE      = STRING        ; media type of data
LENGTH          = 1*DIGIT       ; data length
DATA            = DATA          ; data

FUNCTION        = STRING        ; function name
OPERATION       = STRING        ; description of operation

COMMENT         = PHRASE        ; description of the session
SPCP-VERSION    = "SPCP/1.0"    ; version information of SPCP
AUTH-CODE       = STRING        ; a challenge code for authentication

COMMENT         = PHRASE        ; description of the session
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

COMMENT         = PHRASE        ; description of the session
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

COMMENT         = PHRASE        ; description of the session
CP-ADDR         = STRING        ; calling party  information
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

COMMENT         = PHRASE        ; description of the session
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

COMMENT         = PHRASE        ; description of the session
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

COMMENT         = PHRASE        ; description of the session
INDICATE-CLASS  = STRING        ; event type
CALL-REFERENCE  = 1*HEXDIT      ; call reference number
MEDIA-TYPE      = STRING        ; data attribute
LENGTH          = 1*DIGIT       ; data length
FLAG            = STRING        ; indicates top/tail of data
DATA            = DATA          ; data


FUNCTION        = 1*DIGIT       ; key/lamp name
STATUS          = STRING        ; event


COMMENT         = PHRASE        ; description of the session
COMMAND-CLASS   = STRING        ; command type
MEDIA-TYPE      = STRING        ; data attribute
LENGTH          = 1*DIGIT       ; data length
DATA            = DATA          ; data


COMMENT         = PHRASE        ; description of the session
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

COMMENT         = PHRASE        ; description of the session
CALL-REFERENCE  = 1*HEXDIT      ; call reference number

COMMENT         = PHRASE        ; description of the session

COMMENT         = PHRASE        ; description of the session

COMMENT         = PHRASE        ; description of the session


INFORMATION     = *ATTRIBUTE-LINE
                                   ; Attribute line
                     ":" CRLF
                     *DATA         ; Data

ATTRIBUTE-LINE  = ATTR-TYPE DELIMITER ATTR-VALUE CRLF

ATTR-TYPE       = "media-type"  ; media type
                   / "spcp-version"; SPCP version
                   / "length"      ; data length
                   / "timeout"     ; time limit
                   / "auth-code"   ; challenge code for authentication
                   / "cp-addr"     ; calling party address
                   / "call-reference"
                                   ; call reference number
                   / "command"     ; current process information
                   / "flag"        ; repeat indicator
                   / "name-type"   ; product name
                   / "function-detect"
                                   ; key/lamp information
                   / "X-" 1*PCHAR  ; (extensible attribute type)


ATTRIBUTE-LINE  = "media-type" "/" MEDIA-TYPE-ATTR-VALUE
     CRLF

ATTRIBUTE-LINE  = "spcp-version" "/" SPCP-VERSION-ATTR-VALUE
                     CRLF

ATTRIBUTE-LINE  = "length" "/" LENGTH-ATTR-VALUE
                     CRLF

ATTRIBUTE-LINE  = "timeout" "/" TIMEOUT-ATTR-VALUE
                     CRLF

ATTRIBUTE-LINE  = "auth-code" "/" AUTH-CODE-ATTR-VALUE
                     CRLF

ATTRIBUTE-LINE  = "cp-addr" "/" CP-ADDR-ATTR-VALUE
                     CRLF

ATTRIBUTE-LINE  = "call-reference" "/" CALL-REFERENCE-ATTR-VALUE
                     CRLF

ATTRIBUTE-LINE  = "flag" "/" FLAG-ATTR-VALUE
                     CRLF

FLAG-ATTR-VALUE = 1*HEXDIG      ; repeat indicator


ATTRIBUTE-LINE  = "name-type" "/" NAME-TYPE-ATTR-VALUE
                     CRLF

PRODUCT         = STRING        ; manufacturer
MACHINE         = STRING        ; product type
MANUFA-NO       = 1*DIGIT       ; serial number


ATTRIBUTE-LINE  = "function-detect" "/" FUNCTION-DETECT-ATTR-VALUE
                     CRLF

FUNCTION-ID     = 1*DIGIT       ; key/lamp number
STATUS          = STRING        ; key/lamp status


AUTH-RES = MD5((PASSWORD_OPAD XOR opad),
                   MD5((PASSWORD_OPAD XOR ipad),AUTH-CODE))

AUTH-CODE = "<123.4567@labs.fujitsu.co.jp>"
USER-NAME = "1111"
PASSWORD  = "12345678"

           Server: "opened: session is now available.
                    spcp-version: SPCP/1.0
                    auth-code: <123.4567@labs.fujitsu.co.jp>
                   "
           Client: "logon 1111 a8d4d2f0ac4a370fb3d3385df61ed62f
                   "
           Server: "200: OK(authentication is successful.)
                   "


