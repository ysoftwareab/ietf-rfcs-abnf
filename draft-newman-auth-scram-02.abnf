client-msg-1     = [authorize-id] NUL authenticate-id NUL nonce

server-msg-1     = salt security-info service-id NUL nonce

client-msg-2     = security-info client-proof

server-msg-2     = server-proof

passphrase       = *UTF8-SAFE
                        ;; At least 64 octets MUST be supported
authorize-id     = *UTF8-PRINT
                        ;; No more than 255 octets

authenticate-id  = *UTF8-PRINT
                        ;; No more than 255 octets

security-info    = secbits bufsize

bufsize          = 3OCTET
                        ;; in network byte order (big-endian)

secbits          = OCTET
                        ;; bit 0 = no protection, bit 1 = integrity,
                        ;; other bits set to 0 and reserved

service-id       = service-name "@" server-domain

service-name     = *VCHAR
                        ;; a SASL/GSSAPI service name

server-domain    = *VCHAR
                        ;; an internet domain name

nonce            = 8*OCTET

salt             = 8OCTET

client-proof     = 16OCTET

server-proof     = 16OCTET

NUL              = %x00  ;; US-ASCII NUL character

UTF8-SAFE        = %x01-09 / %x0B-0C / %x0E-7F / UTF8-MULTI
                        ;; Any character except CR, LF, NUL

UTF8-PRINT       = %x20-7E / UTF8-MULTI
                       ;; Any character except CTLs

UTF8-MULTI       = UTF8-2 / UTF8-3 / UTF8-4 / UTF8-5 / UTF8-6
                        ;; UTF-8 Multi-octet characters

UTF8-1          = %x80-BF

UTF8-2          = %xC0-DF UTF8-1

UTF8-3          = %xE0-EF 2UTF8-1
UTF8-4          = %xF0-F7 3UTF8-1

UTF8-5          = %xF8-FB 4UTF8-1

UTF8-6          = %xFC-FD 5UTF8-1


client-msg-1     = AZ + AU + Uc
server-msg-1     = salt + ssecinfo + service + Us
salted-pass      = MAC(salt, pass)
client-key       = H(salted-pass)
client-verifier  = H(client-key)
shared-key       = MAC(server-msg-1 + client-msg-1 + csecinfo,
                            client-verifier)
client-proof     = client-key XOR shared-key
server-key       = MAC(salt, salted-pass)
server-proof     = MAC(client-msg-1 + server-msg-1 + csecinfo,
                            server-key)
integrity-key    = MAC(server-msg-1 + client-msg-1 + csecinfo,
                            client-key)

key = k_pad;
key_len = HMAC_MD5_SIZE;
vptr = (SCRAM_MD5_VRFY *) secret;
vptr = &verifier;
result = -1;
