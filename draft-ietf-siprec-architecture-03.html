<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>An Architecture for Media Recording using the Session Initiation Protocol</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Definitions">
<link href="#rfc.section.3" rel="Chapter" title="3 Session Recording Architecture">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Location of the Session Recording Client">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 B2BUA acts as a Session Recording Client">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Endpoint acts as Session Recording Client">
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 A SIP Proxy cannot be a Session Recording Client">
<link href="#rfc.section.3.1.4" rel="Chapter" title="3.1.4 Interaction with MEDIACTRL">
<link href="#rfc.section.3.1.5" rel="Chapter" title="3.1.5 Interaction with Conference Focus">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Establishing the Recording Session">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Session Recording Client Initiated Recording">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Session Recording Server Initiated Recording">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Pause/Resume Recording Session">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 Media Stream Mixing">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 Media Transcoding">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Media Recording Metadata">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Contents of recording metadata">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Mechanisms for delivery of metadata to Session Recording Server">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Notifications to the Recorded User Agents">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Preventing the recording of a SIP session">
<link href="#rfc.section.4" rel="Chapter" title="4 IANA considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 Security considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Session recording is a critical requirement in many communications environments such as call centers and financial trading.  In some of these environments, all calls must be recorded for regulatory, compliance, and consumer protection reasons.  Recording of a session is typically performed by sending a copy of a media stream to a recording device. This document describes architectures for deploying session recording solutions in an environment which is based on the Session Initiation Protocol (SIP).  " />
  <meta name="description" content="Session recording is a critical requirement in many communications environments such as call centers and financial trading.  In some of these environments, all calls must be recorded for regulatory, compliance, and consumer protection reasons.  Recording of a session is typically performed by sending a copy of a media stream to a recording device. This document describes architectures for deploying session recording solutions in an environment which is based on the Session Initiation Protocol (SIP).  " />
  <meta name="keywords" content="I-D, Internet-Draft, SIP" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">SIPREC</td>
<td class="right">A. Hutton, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Siemens Enterprise Communications</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">L. Portman, Ed.</td>
</tr>
<tr>
<td class="left">Expires: April 05, 2012</td>
<td class="right">Nice Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">R. Jain</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">IPC Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">K. Rehor</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco Systems, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 03, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">An Architecture for Media Recording using the Session Initiation Protocol<br />
  <span class="filename">draft-ietf-siprec-architecture-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Session recording is a critical requirement in many communications environments such as call centers and financial trading.  In some of these environments, all calls must be recorded for regulatory, compliance, and consumer protection reasons.  Recording of a session is typically performed by sending a copy of a media stream to a recording device. This document describes architectures for deploying session recording solutions in an environment which is based on the Session Initiation Protocol (SIP).  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 05, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Definitions</a>
</li>
<li>3.   <a href="#rfc.section.3">Session Recording Architecture</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Location of the Session Recording Client</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">B2BUA acts as a Session Recording Client</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Endpoint acts as Session Recording Client</a>
</li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">A SIP Proxy cannot be a Session Recording Client</a>
</li>
<li>3.1.4.   <a href="#rfc.section.3.1.4">Interaction with MEDIACTRL</a>
</li>
<li>3.1.5.   <a href="#rfc.section.3.1.5">Interaction with Conference Focus</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Establishing the Recording Session</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Session Recording Client Initiated Recording</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Session Recording Server Initiated Recording</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Pause/Resume Recording Session</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">Media Stream Mixing</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">Media Transcoding</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Media Recording Metadata</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Contents of recording metadata</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Mechanisms for delivery of metadata to Session Recording Server</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Notifications to the Recorded User Agents</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Preventing the recording of a SIP session</a>
</li>
<li>4.   <a href="#rfc.section.4">IANA considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">Security considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgements</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">Session recording is a critical requirement in many communications environments such as call centers and financial trading.  In some of these environments, all calls must be recorded for regulatory, compliance, and consumer protection reasons.  Recording of a session is typically performed by sending a copy of a media stream to a recording device. This document describes architectures for deploying session recording solutions in an environment which is based on the Session Initiation Protocol (SIP) the requirements for which are described in <a href="#RFC6341">[RFC6341]</a>.  </p>
<p id="rfc.section.1.p.2">This document focuses on how sessions are established between a Session Recording Client (SRC) and the Session Recording Server (SRS) for the purpose of conveying the Replicated Media and Media Recording Metadata (e.g. Identity of parties involved) relating to the Communication Session.  </p>
<p id="rfc.section.1.p.3">Once the Replicated Media and Media Recording Metadata have been received by the Session Recording Server they will typically be archived for retrieval at a later time. The procedures relating to the archiving and retrieval of this information in outside the scope of this document.  </p>
<p id="rfc.section.1.p.4">This document only considers active recording, where the Session Recording Client purposefully streams media to a Session Recording Server.  Passive recording, where a recording device detects media directly from the network (E.g. using port mirroring techniques), is outside the scope of this document.  In addition, lawful intercept is outside the scope of this document which takes account of the IETF policy on wiretapping <a href="#RFC2804">[RFC2804]</a>.  </p>
<p id="rfc.section.1.p.5">The Recording Session that is established between the Session Recording Client and the Session Recording Server uses the normal procedures for establishing INVITE initiated dialogs as specified in <a href="#RFC3261">[RFC3261]</a> and uses SDP for describing the media to be used during the session as specified in <a href="#RFC4566">[RFC4566]</a>. However it is intended that some extensions to SIP (E.g. Headers, Option Tags, Etc.) will be defined to support the requirements for media recording. The Replicated Media is required to be sent in real-time to the Session Recording Server and is not buffered by the Session Recording Client to allow for real-time analysis of the media by the Session Recording Server.  <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Definitions</h1>
<p id="rfc.section.2.p.1">Session Recording Server (SRS): A Session Recording Server (SRS) is a SIP User Agent (UA) that acts as the sink of the recorded media. An SRS is a logical function that typically archives media for extended durations of time and provides interfaces for search and retrieval of the archived media. An SRS is typically implemented as a multi-port device that is capable of receiving media from several sources simultaneously. An SRS is the sink of the recorded session metadata. Note that the term "Server" does not imply the SRS is the server side of a signaling protocol as the SRS may be the initiator of recording requests.  </p>
<p id="rfc.section.2.p.2">Session Recording Client (SRC): A Session Recording Client (SRC) is a SIP User Agent (UA) that acts as the source of the recorded media, sending it to the Session Recording Server.  A Session Recording Client is a logical function.  Its capabilities may be implemented across one or more physical devices.  In practice, a Session Recording Client could be a personal device (such as a SIP phone), a SIP Media Gateway (MG), a Session Border Controller (SBC), Media Server, or an Application Server. The Session Recording Client is also the source of the recorded session metadata.  </p>
<p id="rfc.section.2.p.3">Communication Session (CS): A SIP session created between two or more UA's for the purpose of communication which may be recorded.  </p>
<p id="rfc.section.2.p.4">Recording Session (RS): The session created between an Session Recording Client and Session Recording Server for the purpose of recording a Communication Session.  </p>
<p id="rfc.section.2.p.5">Recording aware UA: A SIP User Agent that is aware of SIP extensions associated with the Communication Session. Such extensions may be used to notify the SIP UA that a session is being recorded or to all the SIP UA to express preferences as to whether a recording should be started, paused, resumed or stopped.  </p>
<p id="rfc.section.2.p.6">Media Recording Metadata (MRM): The metadata describing the communication session that is required by the Session Recording Server. This will include for example the identity of users that participate in the Communication Session and dialog state. Typically this metadata is archived with the replicated media at the Session Recording Server. The media recording metadata is delivered in real-time to the Session Recording Server.  </p>
<p id="rfc.section.2.p.7">Replicated Media: A copy of the media associated with the Communication Session created by the Session Recording Client and sent to the Session Recording Server. It may contain all the media associated with the communication session (E.g. Audio and Video) or just a subset (E.g. Audio).  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Session Recording Architecture</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Location of the Session Recording Client</h1>
<p id="rfc.section.3.1.p.1">This section contains some example session recording architectures showing how the Session Recording Client is a logical function that can be located in or split between various physical components.  </p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> B2BUA acts as a Session Recording Client</h1>
<p id="rfc.section.3.1.1.p.1">A SIP B2BUA which has access to the media that is to be recorded may act as a Session Recording Client. The B2BUA may already be aware that a session needs to be recorded before the initial establishment of the communication session or the decision to record the session may occur after the session has been established.</p>
<p id="rfc.section.3.1.1.p.2">If the B2BUA/SRC makes the decision to initiate the Recording Session (RS) then it will initiate the establishment of a SIP Session by sending an INVITE to the Session Recording Server.  </p>
<p id="rfc.section.3.1.1.p.3">If the Session Recording Server makes the decision to initiate the recording session then it will initiate the establishment of a SIP Session by sending an INVITE to the B2BUA/Session Recording Client.  </p>
<p id="rfc.section.3.1.1.p.4">The RS INVITE will need to contain information which identifies the session as being established for the purposes of recording and prevents the session from being accidently rerouted to a UA which is not a SRS.  </p>
<p id="rfc.section.3.1.1.p.5">The B2BUA/SRC is responsible for notifying the UA's involved in the communication session that the session is being recorded.  </p>
<p id="rfc.section.3.1.1.p.6">The B2BUA/SRC is responsible for honoring any indication from recording aware UA's or through some configured policies that the communication session must not be recorded.  </p>
<div id="#rfc.figure.1"></div>
<pre>

                                           +-----------+
                       (Recording Session) |  Session  |
                          +------SIP------&gt;| Recording |
                          |                |  Server   |
                          |  +--RTP/RTCP--&gt;|  (SRS)    |
                          |  |             +-----------+
                          V  |                   ^
                     +-------------+             |
                     |             |             |
                     |             |-- MetaData -+
                     |             |
                     |    B2BUA    |
                     |             |
                     |   Session   |
  +--------+         |  Recording  |         +---------+
  |        |&lt;- SIP -&gt;|   Client    |&lt;- SIP -&gt;|         |
  |  UA-A  |         |   (SRC)     |         |  UA-B   |
  |        |&lt;- RTP -&gt;|             |&lt;- RTP -&gt;|         |
  +--------+         |             |         +---------+
                     +-------------+
  |____________________________________________________|
                 (Communication Session)

       Figure 1: B2BUA Acts as the Session Recording Client.
   
    </pre>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> Endpoint acts as Session Recording Client</h1>
<p id="rfc.section.3.1.2.p.1">A SIP Endpoint / User Agent may act as a Session Recording Client in which case the endpoint sends the Replicated Media to the Session Recording Server </p>
<p id="rfc.section.3.1.2.p.2">If the endpoint makes the decision to initiate the Recording Session then it will initiate the establishment of a SIP Session by sending an INVITE to the Session Recording Server.  </p>
<p id="rfc.section.3.1.2.p.3">If the Session Recording Server makes the decision to initiate the Recording Session then it will initiate the establishment of a SIP Session by sending an INVITE to the endpoint.  </p>
<div id="#rfc.figure.2"></div>
<pre> 
   

       (Recording Session) +-----------+
      +----------SIP------&gt;|           |
      |  +----RTP/RTCP----&gt;|  Session  |
      |  |                 | Recording |
      |  |                 |  Server   |
      |  | +-- Metadata --&gt;|   (SRS)   |
      |  | |               |           |
      |  | |               +-----------+
      |  | |
      |  | |
      |  | |
      |  | |
      V  | |  (Communication Session)
   +--+------+                     +---------+
   |         |&lt;-------SIP---------&gt;|         |
   |  UA-A   |                     |  UA-B   |
   |  (SRC)  |&lt;-----RTP/RTCP------&gt;|         |
   +---------+                     +---------+


   Figure 2: SIP Endpoint acts as the Session Recording Client


    </pre>
<h1 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> A SIP Proxy cannot be a Session Recording Client</h1>
<p id="rfc.section.3.1.3.p.1">A SIP Proxy is unable to act as an SRC because it does not have access to the media and therefore has no way of enabling the delivery of the replicated media to the SRS</p>
<h1 id="rfc.section.3.1.4">
<a href="#rfc.section.3.1.4">3.1.4.</a> Interaction with MEDIACTRL</h1>
<p id="rfc.section.3.1.4.p.1">The mediactrl architecture <a href="#RFC5567">[RFC5567]</a> describes an architecure in which an application server (AS) controls a Media Server (MS) which may be used for purposes such as conferencing and recording media streams. In the <a href="#RFC5567">[RFC5567]</a> architecure the AS typically uses SIP Third Party Call Control (3PCC) to instruct the SIP UA's to direct their media to the Media Server.  </p>
<p id="rfc.section.3.1.4.p.2">The Session Recording Client and Session Recording Server described in this document may act as an application server as described in <a href="#RFC5567">[RFC5567]</a> and therefore may when further decomposed be made up of an application server which uses a mediactrl interface to control a media server for the purpose of recording the media streams however this interface is considered outside the scope of this document.  </p>
<p id="rfc.section.3.1.4.p.3">In addition, any appropriate control protocols such as RTC-Web can be used for such decomposition.  </p>
<div id="#rfc.figure.3"></div>
<pre> 

                                  Session Recording Server (SRS)
                           +----------------------------------------+
                           |                                        |
       (Recording Session) |  +-----------+          +------------+ |
       +------------SIP----|-&gt;|           |          |            | |
       |                   |  | MediaCtrl |MEDIACTRL |   Media    | |
       |                   |  |Application|&lt;--------&gt;|   Server   | |
       |    +-----Metadata---&gt;|  Server   |          |  (Recorder)| |
       |    |              |  |           |          |            | |
       |    |              |  +-----------+          +------------+ |
       |    |              |                              ^         |
       |    |              +------------------------------|---------+
       |    |  +--------------- RTP/RTCP -----------------+
       |    |  |
       V    |  V
     +---+------+                          +---------+
     |          |&lt;-------SIP--------------&gt;|         |
     |   UA-A   | (Communication Session)  |  UA-B   |
     |   (SRC)  |&lt;-------RTP/RTCP---------&gt;|         |
     +----------+                          +---------+

        Figure 3: Example of Session Recording Server using MEDIACTRL

 	</pre>
<div id="#rfc.figure.4"></div>
<pre> 
                                     
                                                 +----------+
              (Recording Session)                | Session  |
        +-----------SIP-------------------------&gt;|Recording |
        |                                        |  Server  |
        |                                        |   (SRS)  |
        |  UA-A Session Recording Client (SRC)   +----------+
 +----------------------------------------+         |
 |                                        |         |
 |  +-----------+          +------------+ |         |
 |  |           | Control  |            |&lt;----RTP---+    +---------+
 |  |    UA     | Protocol |   Media    | |              |         |
 |  |Application|&lt;--------&gt;|  Server    | |&lt;----SIP-----&gt;|  UA-B   |
 |  |  Server   |          |            |&lt;-----RTP------&gt;|         |
 |  |           |          |            | |              +---------+
 |  +-----------+          +------------+ |
 |                                        |
 +----------------------------------------+
        Figure 4: Example of Session Recording Client decomposition

 	</pre>
<h1 id="rfc.section.3.1.5">
<a href="#rfc.section.3.1.5">3.1.5.</a> Interaction with Conference Focus</h1>
<p id="rfc.section.3.1.5.p.1">In the case of a centralised conference a combination of the conference focus and mixer <a href="#RFC4353">[RFC4353]</a> may act as a SRC and therefore provide the SRS with the replicated media and associated media recording metadata. In this arrangement the SRC is able to provide media and metadata relating to each of the participants, including, for example, any side conversations where the media passes through the mixer </p>
<p id="rfc.section.3.1.5.p.2">The conference focus may also act as a Recording Aware UA in the case when one of the participants acts as a SRC.  </p>
<p id="rfc.section.3.1.5.p.3">In an alternative arrangement a SIP endpoint which is a conference participant can act as an SRC. The SRC will in this case have access to the media and metadata relating to that particular participant and may be able to obtain additional metadata from the conference focus. The SRC may for example use the conference event package as described in <a href="#RFC4575">[RFC4575]</a> to obtain information about other participants which it provides to the SRS within the media recording metadata.  </p>
<p id="rfc.section.3.1.5.p.4">The SRC may be involved in the conference from the very beginning or may join at some later point of time.  </p>
<div id="#rfc.figure.5"></div>
<pre> 

                             User 1
                         +-----------+
                         |           |
                         |           |
                         |Participant|
                         |     1     |
                         |           |
                         +-----------+
                               |SIP
                               |Dialog
                               |1
    User 2                     |        Recording
 +-----------+           +-----------+  Session     *************
 |           |           |           |--------------*           *
 |           |           |           |----RTP 1 ---&gt;*           *
 |Participant|-----------| Focus/SRC |----RTP 2 ---&gt;*    SRS    *
 |     2     |  SIP      |           |----RTP 3 ---&gt;*           *
 |           |  Dialog   |           |              *           *
 +-----------+  2        +-----------+              *************
                               |
                               |SIP
                               |Dialog
                               |3
                               |
                         +-----------+
                         |           |
                         |           |
                         |Participant|
                         |    3      |
                         |           |
                         +-----------+
                            User 3

        Figure 5: Conference Focus acting as an SRC.

 	</pre>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Establishing the Recording Session</h1>
<p id="rfc.section.3.2.p.1">The Session Recording Client or the Session Recording Server may initiate the Recording Session. </p>
<p id="rfc.section.3.2.p.2">It should be noted that the Recording Session is independent from the Communication Session that is being recorded at both the SIP dialog level and at the session level.  </p>
<p id="rfc.section.3.2.p.3">Concerning media negotiation, regular SIP/SDP capabilities should be used, and existing transcoding capabilities should not be precluded </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Session Recording Client Initiated Recording</h1>
<p id="rfc.section.3.2.1.p.1">When the Session Recording Client initiates the Recording Session  for the purpose of conveying media to the Session Recording Server it performs the following actions.  </p>
<p></p>

<ul>
<li>The SRC is provisioned with a URI for the SRS, which is resolved through normal <a href="#RFC3263">[RFC3263]</a> procedures.</li>
<li>Initiates the dialog by sending an INVITE request to the Session Recording Server. The dialog is established according to the normal procedures for establishing an INVITE initiated dialog as specified in <a href="#RFC3261">[RFC3261]</a>.</li>
<li>Include in the INVITE an indication that the session is established for the purpose of recording the associated media. Possible mechanisms for this include using the Require header and/or a new media feature tag similar to the use of "isfocus" as defined in <a href="#RFC3840">[RFC3840]</a>
</li>
<li>If the Replicated Media is to be started immediately then the Session Recording Client will include an SDP attribute of "a=sendonly" for each media line or "a=inactive" if it is not ready to transmit the media.</li>
<li>The Recording Session may replicate all media associated with the Communication Session or only a subset.</li>
<li>Replicate the media streams that are to be recorded and transmit the media to the Session Recording Server.</li>
</ul>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> Session Recording Server Initiated Recording</h1>
<p id="rfc.section.3.2.2.p.1">When the Session Recording Server initiates the media recording session with the Session Recording Client it performs the following actions.</p>
<p></p>

<ul>
<li>Send an INVITE request to the Session Recording Client</li>
<li>Include in the INVITE an indication that the session is established for the purpose of recording the associated media. Possible mechanisms for this include using the Require header or a media feature tag similar to the use of "isfocus" as defined in <a href="#RFC3840">[RFC3840]</a>
</li>
<li>Identify the session that is to be recorded - Possibly using the Join header <a href="#RFC3911">[RFC3911]</a>
</li>
<li>If the Recording Session is to be started immediately then the Session Recording Client will include an SDP attribute of "a=recvonly" for each media line or "a=inactive" if it is not ready to receive the media </li>
</ul>
<p id="rfc.section.3.2.2.p.3">If the Session Recording Server does not have prior knowledge of what media streams are available to be recorded it can make use of an offerless INVITE which allows the Session Recording Client to make the initial SDP offer.</p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> Pause/Resume Recording Session</h1>
<p id="rfc.section.3.2.3.p.1">The Session Recording Server or the Session Recording Client may pause the recording by changing the SDP direction attribute to "inactive" and resume the recording by changing the direction back to "recvonly" or "sendonly".</p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> Media Stream Mixing</h1>
<p id="rfc.section.3.2.4.p.1">In a basic session involving only audio there are typically two audio/RTP streams between the two UA's involved transporting media in each direction. When recording this media the two streams may be mixed at the SRC before being transmitted to the SRS or it may be a requirement of the recording server that the media streams are not mixed and are sent to the SRS as two separate streams. The case when media is mixed at the SRC is simple as only a single media stream is required to be sent to the SRS. However in the case when the media streams are not mixed then the SDP offer sent to the SRS must describe two separate media streams.  </p>
<h1 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> Media Transcoding</h1>
<p id="rfc.section.3.2.5.p.1">The communication session (CS) and the recording session (RS) are negotiated separately using a standard SDP offer/answer exchange which may result in the SRC having to perform media transcoding between the two sessions. If the SRC is not capable of performing  media transcoding it may limit the media formats in the offer to the SRS depending on what media is negotiated on the CS or may limit what it includes in the offer on the CS if it has prior knowledge of the media formats supported by the SRS. However typically the SRS will be the more capable device which can provide a wide range of media format options to the SRC and may also be able to make use of a media transcoder as detailed in <a href="#RFC5369">[RFC5369]</a>.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Media Recording Metadata</h1>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Contents of recording metadata</h1>
<p id="rfc.section.3.3.1.p.1">The metadata model is defined in  <a href="#I-D.ietf-siprec-metadata">[I-D.ietf-siprec-metadata]</a>.	</p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> Mechanisms for delivery of metadata to Session Recording Server</h1>
<p id="rfc.section.3.3.2.p.1">The SRS obtains session recording metadata from the SRC. The metadata is transported via SIP based mechanisms as specified in <a href="#I-D.ietf-siprec-protocol">[I-D.ietf-siprec-protocol]</a> </p>
<p id="rfc.section.3.3.2.p.2">It is also possible that metadata is transported via non SIP based mechanisms but these are considered out of scope.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Notifications to the Recorded User Agents</h1>
<p id="rfc.section.3.4.p.1">Typically a user that is involved in a session that is to be recorded is notified by an announcement at the beginning of the session or may receive some warning tones within the media. However the standardization of media recording protocols when using SIP enable an indication that the call is being recorded to be included in the SIP requests and responses associated with that communication session.  </p>
<p id="rfc.section.3.4.p.2">It is the Session Recording Client that provides the notification to all SIP UA's for which it is replicating received media for the purpose of recording including the local user if the Session Recording Client is a SIP endpoint.  </p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> Preventing the recording of a SIP session</h1>
<p id="rfc.section.3.5.p.1">A Recording Aware UA may during the initial session establishment or during an established session provide an indication of their preference with regard to recording the media in the communication session. The mechanism for this are specified in <a href="#I-D.ietf-siprec-protocol">[I-D.ietf-siprec-protocol]</a> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> IANA considerations</h1>
<p id="rfc.section.4.p.1">None.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#section-security" id="section-security">Security considerations</a>
</h1>
<p id="rfc.section.5.p.1">The Recording Session is fundamentally a standard SIP dialog and media session and therefore make use of existing SIP security mechanisms for securing the Recording Session and Media Recording Metadata.  </p>
<p id="rfc.section.5.p.2">The intended use of this architecture is only for the case where the users are aware of that they are being recorded and the architecture provides the means for the Session Recording Client to notify users that they are being recorded.  </p>
<p id="rfc.section.5.p.3">This architectural solution is not intended to support lawful intercept which in contrast requires that users are not informed.  </p>
<p id="rfc.section.5.p.4">It is the responsibility of the Session Recording Server to protect the Replicated Media and Media Recording Metadata once it has been received and archived.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Acknowledgements</h1>
<p id="rfc.section.6.p.1">Thanks to John Elwell, Alan Johnson, Cullen Jennings, Hadriel Kaplan, Henry Lum, Paul Kyzivat, Parthasarathi R, Ram Mohan R, and Charles Eckel for their significant contributions and assistance with this document and Working Group, and to all the members of the SIPREC WG mailing list for providing valuable input to this work.</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3261">[RFC3261]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a>, <a>Camarillo, G.</a>, <a>Johnston, A.</a>, <a>Peterson, J.</a>, <a>Sparks, R.</a>, <a>Handley, M.</a> and <a>E. Schooler</a>, "<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>", RFC 3261, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3263">[RFC3263]</b></td>
<td class="top">
<a>Rosenberg, J.</a> and <a>H. Schulzrinne</a>, "<a href="http://tools.ietf.org/html/rfc3263">Session Initiation Protocol (SIP): Locating SIP Servers</a>", RFC 3263, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4566">[RFC4566]</b></td>
<td class="top">
<a>Handley, M.</a>, <a>Jacobson, V.</a> and <a>C. Perkins</a>, "<a href="http://tools.ietf.org/html/rfc4566">SDP: Session Description Protocol</a>", RFC 4566, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3911">[RFC3911]</b></td>
<td class="top">
<a>Mahy, R.</a> and <a>D. Petrie</a>, "<a href="http://tools.ietf.org/html/rfc3911">The Session Initiation Protocol (SIP) "Join" Header</a>", RFC 3911, October 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6341">[RFC6341]</b></td>
<td class="top">
<a>Rehor, K.</a>, <a>Portman, L.</a>, <a>Hutton, A.</a> and <a>R. Jain</a>, "<a href="http://tools.ietf.org/html/rfc6341">Use Cases and Requirements for SIP-Based Media Recording (SIPREC)</a>", RFC 6341, August 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-siprec-metadata">[I-D.ietf-siprec-metadata]</b></td>
<td class="top">
<a>R, R</a>, <a>Ravindran, P</a> and <a>P Kyzivat</a>, "<a href="http://tools.ietf.org/html/draft-ietf-siprec-metadata-04">Session Initiation Protocol (SIP) Recording Metadata</a>", Internet-Draft draft-ietf-siprec-metadata-04, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-siprec-protocol">[I-D.ietf-siprec-protocol]</b></td>
<td class="top">
<a>Portman, L</a>, <a>Lum, H</a>, <a>Johnston, A</a> and <a>A Hutton</a>, "<a href="http://tools.ietf.org/html/draft-ietf-siprec-protocol-00">Session Recording Protocol</a>", Internet-Draft draft-ietf-siprec-protocol-00, August 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3265">[RFC3265]</b></td>
<td class="top">
<a>Roach, A.B.</a>, "<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>", RFC 3265, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3840">[RFC3840]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a> and <a>P. Kyzivat</a>, "<a href="http://tools.ietf.org/html/rfc3840">Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)</a>", RFC 3840, August 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4353">[RFC4353]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, "<a href="http://tools.ietf.org/html/rfc4353">A Framework for Conferencing with the Session Initiation Protocol (SIP)</a>", RFC 4353, February 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4575">[RFC4575]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a> and <a>O. Levin</a>, "<a href="http://tools.ietf.org/html/rfc4575">A Session Initiation Protocol (SIP) Event Package for Conference State</a>", RFC 4575, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5567">[RFC5567]</b></td>
<td class="top">
<a>Melanchuk, T.</a>, "<a href="http://tools.ietf.org/html/rfc5567">An Architectural Framework for Media Server Control</a>", RFC 5567, June 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5369">[RFC5369]</b></td>
<td class="top">
<a>Camarillo, G.</a>, "<a href="http://tools.ietf.org/html/rfc5369">Framework for Transcoding with the Session Initiation Protocol (SIP)</a>", RFC 5369, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2804">[RFC2804]</b></td>
<td class="top">
<a>IAB</a><a>IESG</a>, "<a href="http://tools.ietf.org/html/rfc2804">IETF Policy on Wiretapping</a>", RFC 2804, May 2000.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andrew Hutton</span> editor
	  <span class="n hidden">
		<span class="family-name">Hutton</span>
	  </span>
	</span>
	<span class="org vcardline">Siemens Enterprise Communications</span>
	<span class="adr">
	  <span>Hofmannstrasse 51</span>

	  <span class="vcardline">
		<span class="locality">Munich D-81379</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:andrew.hutton@siemens-enterprise.com">andrew.hutton@siemens-enterprise.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Leon Portman</span> editor
	  <span class="n hidden">
		<span class="family-name">Portman</span>
	  </span>
	</span>
	<span class="org vcardline">Nice Systems</span>
	<span class="adr">
	  <span>8 Hapnina</span>

	  <span class="vcardline">
		<span class="locality">Ra'anana  43017</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Israel</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:leon.portman@nice.com">leon.portman@nice.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rajnish Jain</span> 
	  <span class="n hidden">
		<span class="family-name">Jain</span>
	  </span>
	</span>
	<span class="org vcardline">IPC Systems</span>
	<span class="adr">
	  <span>777 Commerce Drive</span>

	  <span class="vcardline">
		<span class="locality">Fairfield, CT  06825</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rajnish.jain@ipc.com">rajnish.jain@ipc.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ken Rehor</span> 
	  <span class="n hidden">
		<span class="family-name">Rehor</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose, CA  95134-1706</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:krehor@cisco.com">krehor@cisco.com</a></span>

  </address>
</div>

</body>
</html>