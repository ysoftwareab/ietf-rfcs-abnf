<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>S/MIME Capabilities for Public Key
Definitions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="S/MIME Capabilities for Public Key
Definitions">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Schaad</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Soaring Hawk Consulting</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">December 12, 2010</td></tr>
<tr><td class="header">Expires: June 15, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />S/MIME Capabilities for Public Key
Definitions<br />draft-ietf-pkix-pubkey-caps-01</h1>

<h3>Abstract</h3>

<p>
        This document defines a set of S/MIME Capability types for ASN.1
        encoding for the current set of public keys define in the PKIX
        working group.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on June 15, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
ASN.1 Notation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Requirements Terminology<br />
<a href="#anchor4">2.</a>&nbsp;
RSA Public Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
Generic RSA Public Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.</a>&nbsp;
RSASSA-PSS Signature Public Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.3.</a>&nbsp;
RSA ES-OAEP Key Transport Public Keys<br />
<a href="#anchor8">3.</a>&nbsp;
Diffie-Hellman Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.1.</a>&nbsp;
DSA Signature Public Key<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.2.</a>&nbsp;
DH Key Agreement Keys<br />
<a href="#anchor11">4.</a>&nbsp;
Elliptical Curve Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.1.</a>&nbsp;
Generic Elliptical Curve Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.</a>&nbsp;
Elliptical Curve DH Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.3.</a>&nbsp;
Elliptical Curve MQV Keys<br />
<a href="#anchor15">5.</a>&nbsp;
RSASSA-PSS Signature Algorithm Capability<br />
<a href="#anchor16">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor17">7.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#ASN.2008">Appendix&nbsp;A.</a>&nbsp;
2008 ASN.1 Module<br />
<a href="#anchor20">Appendix&nbsp;B.</a>&nbsp;
Future Work<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In the process of dealing with the OCSP agility issues in <a class='info' href='#I-D.ietf-pkix-ocspagility'>[I&#8209;D.ietf&#8209;pkix&#8209;ocspagility]<span> (</span><span class='info'>Hallam-Baker, P. and S. Santesson, &ldquo;OCSP Algorithm Agility,&rdquo; March&nbsp;2010.</span><span>)</span></a> it was noted that we really wanted to
describe information to be used in selecting a public key, but we did
not currently have any way of doing so at the current time.  This document
fills that hole by defining a set of S/MIME Capability types for a small set
of public key representations. 
</p>
<p>S/MIME Capabilities where originally defined in <a class='info' href='#SMIMEv3-MSG'>[SMIMEv3&#8209;MSG]<span> (</span><span class='info'>Ramsdell, B., &ldquo;S/MIME Version 3 Message Specification,&rdquo; June&nbsp;1999.</span><span>)</span></a> as a way for the sender of an S/MIME message to tell the recipient of the message the set of encryption algorithms that were supported by the senders system.  In the beginning, the focus was primarily on communicating the set of encryption algorithms that were supported.  Over time it was expanded to allow for an S/MIME client to say that it supported the compression data type and binary contents.  As originally defined it was targeted towards supporting items with a small number of possible parameters.  For the RC2 encryption algorithm only two values from the entire range of values were ever use.  The object of restricting the set of values was so that a client could do a simple binary comparison without having to decode the S/MIME capability.  This was especially easy since most just consisted of the object identifier for the algorithm.
</p>
<p>Given that we are assigning different data types to the algorithm descriptors here, and many of the algorithm descriptors are the same as are used in signature, key transport or key agreement algorithms, the public key versions of these structures MUST NOT be placed in the same locations as the other versions.  It is expected that  the places where one needs S/MIME capabilities for public keys is going to be vastly different than for the other values.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
ASN.1 Notation</h3>

<p>The main body of the text is written using snippets of ASN.1 that
are extracted from the ASN.1 2008 module in <a class='info' href='#ASN.2008'>Appendix&nbsp;A<span> (</span><span class='info'>2008 ASN.1 Module</span><span>)</span></a>.  This
is because I am a strong advocate of moving to the current versions of ASN.1 as
they can contain meta-data which is not representable in the 1988 version of
ASN.1.  In keeping with the current policy of the PKIX working group, the
1988 module is still to be considered the normative module in the event of a
conflict between the contents of the two modules.
</p>
<p>When reading this document, it is assumed that you will have a
degree of familiarity with the basic object module that is presented in
section 3 of RFC 5912 (<a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>).  We use the SMIME-CAPS
object in this document, it associates two fields together in a single
object.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SMIME-CAPS ::= CLASS {
    &amp;id         OBJECT IDENTIFIER UNIQUE,
    &amp;Type       OPTIONAL
}
WITH SYNTAX { [TYPE &amp;Type] IDENTIFIED BY &amp;id }
</pre></div><p>


  These fields are:
          </p>
<blockquote class="text"><dl>
<dt>&amp;id</dt>
<dd> contains an object identifier.  When
placed in an object set, this element is tagged so that no two elements can
be placed in the set that have the same value in the &amp;id field.  Note that this is not a restriction which says that only a single object can exist with a single object identifier.
</dd>
<dt>&amp;Type</dt>
<dd> optionally contains an ASN.1 type
identifier.  If the field &amp;Type is not defined then the optional
parameters field of the AlgorithmIdentifier type would be omitted.
</dd>
</dl></blockquote><p>
        
</p>
<p>The class also has a specialized syntax for how to define an
object in this class.  The all upper case words TYPE IDENTIFIER and BY are
syntactic sugar to make it easier to read.  The square brackets defined optional pieces of the syntax.
</p>
<p>One of the things that can be done is to reference the fields of
an object while defining other objects.  This means that if an object called
foo has a field named &amp;value, the value can be directly referenced
as foo.&amp;value.  This means that we automatically get any updates
to values or types and we do not need to do any replication of the data.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Requirements Terminology</h3>

<p>When capitalized the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
RSA Public Keys</h3>

<p>There are currently three different public key object identifiers
for RSA public keys.  These are RSA, RSA ES-OCSP and RSA SSA-PSS.
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Generic RSA Public Keys</h3>

<p>Almost all RSA keys that are contained in certificates today use
the generic RSA public key format and identifier.  This allows for the
public key to be used both for key transport and for signature validation
(assuming it is compatible with the bits in the key usage extension).  The
only reason for using one of more specific public key identifiers is if the
user wants to restrict the usage of the RSA public key with a specific
algorithm.
</p>
<p>For the generic RSA public key, the S/MIME capability that is
advertised is a request for a specific key size to be used.  This would
normally be used for dealing with a request on the key to be used for a
signature that the client would then verify.  In general the user would
provide a specific key when a key transport algorithm is being
considered.
</p>
<p>The ASN.1 that is used for the generic RSA public key is defined
as below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-rsa SMIME-CAPS ::= {
     TYPE RSAKeyCapabilities
     IDENTIFIED BY pk-rsa.&amp;id
   }

   RSAKeyCapabilities ::= SEQUENCE {
      minKeySize        RSAKeySize,
      maxKeySize        RSAKeySize OPTIONAL
   }

   RSAKeySize ::= INTEGER (1024 | 2048 | 3072 | 7680 | 15360 |
                           4096 | 8192, ...)

</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-pk-rsa</dt>
<dd> is a new SMIME-CAP object.  This object associates the existing object identifier (rsaEncryption) used for the public key in certificates  (defined in <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with a new type defined in this document.
</dd>
<dt>RSAKeyCapabilities</dt>
<dd> carries the set of desired capabilities for an RSA key.  The fields of this type are:
              
<blockquote class="text"><dl>
<dt>minKeySize</dt>
<dd> contains the minimum length of the RSA modulus to be used.  This field SHOULD NOT contain a value less than 1024.
</dd>
<dt>maxKeySize</dt>
<dd> contains the maximum length of the RSA modules that should be used.  If this field is absent then no maximum length is requested/expected.  This value is normally selected so as not to cause the current code to run unacceptably long when processing signatures.
</dd>
</dl></blockquote>
            
</dd>
<dt>RSAKeySize</dt>
<dd> provides a set of suggested values to be used.  The values 1024, 2048, 3072, 7680 and 15360 are from the NIST guide on signature sizes <a class='info' href='#NIST-SIZES'>[NIST&#8209;SIZES]<span> (</span><span class='info'>Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;Recommendation for Key Management -- Part 1: General,&rdquo; March&nbsp;2007.</span><span>)</span></a> while the others are common powers of two that would be used.  The list is not closed and other values can be used.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
RSASSA-PSS Signature Public Keys</h3>

<p>While most of the time one will use the generic RSA public key
identifier in a certificate, the RSA SSA-PSS identifier can be used if the
owner of the key desires to restrict the usage of the key to just this
algorithm.  This algorithm does have the ability to place a set of algorithm parameters in the public key info structure, they have not been included in this location s as the same information should be carried in the signature S/MIME capabilities instead.
</p>
<p>The ASN.1 that is used for the RSA SSA-PSS public key is defined
below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-rsaSSA-PSS SMIME-CAPS ::= {
     TYPE RSAKeyCapabilities
     IDENTIFIED BY pk-rsaSSA-PSS.&amp;id
   }
</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-pk-rsaSSA-PSS</dt>
<dd> is a new SMIME-CAP object.  This object associates the existing object identifier (id-RSASSA-PSS) used for the public key certificates (defined in <a class='info' href='#RFC4055'>[RFC4055]<span> (</span><span class='info'>Schaad, J., Kaliski, B., and R. Housley, &ldquo;Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; June&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with type RSAKeyCapabilities.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
RSA ES-OAEP Key Transport Public Keys</h3>

<p>While most of the time one will use the generic RSA public key
identifier in a certificate, the RSA ES-OAEP identifier can be used if the
owner of the key desires to restrict the usage of the key to just this
algorithm.  This algorithm does have the ability to place a set of algorithm parameters in the public key info structure, they have not been included in this location s as the same information should be carried in the key transport S/MIME capabilities instead.
</p>
<p>The ASN.1 that is used for the RSA ES-OAEP public key is defined
below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-rsaES-OAEP SMIME-CAPS ::= {
     TYPE RSAKeyCapabilities
     IDENTIFIED BY pk-rsaES-OAEP.&amp;id
   }
</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-pk-rsaES-OAEP</dt>
<dd> is a new SMIME-CAP object.  This object associates the existing object identifier (id-RSAES-OAEP) used for the public key certificates (defined in <a class='info' href='#RFC4055'>[RFC4055]<span> (</span><span class='info'>Schaad, J., Kaliski, B., and R. Housley, &ldquo;Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; June&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with type RSAKeyCapabilities.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Diffie-Hellman Keys</h3>

<p>There is current two Diffie-Hellman public key object identifiers.
These are DH key agreement and DSA.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
DSA Signature Public Key</h3>

<p>This public key type is used for the validation of DSA signatures.
</p>
<p>The ASN.1 that is used for DSA keys is defined below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-dsa SMIME-CAPS ::= {
     TYPE DSAKeyCapabilities
     IDENTIFIED BY pk-dsa.&amp;id
   }

   DSAKeyCapabilities ::= CHOICE {
       keySizes         [0] SEQUENCE {
          minKeySize            DSAKeySize,
          maxKeySize            DSAKeySize OPTIONAL
       },
       keyParams        [1] pk-dsa.&amp;Params
   }

   DSAKeySize ::= INTEGER (1024 | 2048 | 3072 | 7680 | 15360 )
</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-pk-dsa</dt>
<dd> is a new SMIME-CAP object.  This object associated the existing object identifier (id-dsa) used for the public key in certificates (defined in <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with a new type defined here, DSAKeyCapabilities.
</dd>
<dt>DSAKeyCapabilities</dt>
<dd> carries the desired set of capabilities for the DSA key.  The fields of this type are:
              
<blockquote class="text"><dl>
<dt>keySizes</dt>
<dd> is used when only a key size is needed to be specified and not a specific group.  It is expected that this would be the most commonly used of the two options.  In key sizes the fields are used as follows:
                  
<blockquote class="text"><dl>
<dt>minKeySize</dt>
<dd> contains the minimum length of the DSA modulus to be used.
</dd>
<dt>maxKeySize</dt>
<dd> contains the maximum length of the DSA modules that should be used.  If this field is absent then no maximum length
                      is requested/expected.
</dd>
</dl></blockquote>
                
</dd>
<dt>keyParams</dt>
<dd> contains the exact set of DSA for the key used to sign the message.
</dd>
</dl></blockquote>
            
</dd>
</dl></blockquote><p>
        
</p>
<p>NOTE: In the original discussions the option keyParams would not have existed in this structure, and they may not exist in a future version of the structure.  The issue is that we really only need to have the key size fields, but there seems to be a mis-match between this structure and that used for ECC where we don't specify anything about key sizes, but do specify the exact group to be used.  We should probably have a discussion about rationalizing these together.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
DH Key Agreement Keys</h3>

<p>This public key type is used with the Diffie-Hellman key agreement algorithm.
</p>
<p>The ASN.1 that is used for DH keys is defined below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-dh SMIME-CAPS ::= {
     TYPE INTEGER
     IDENTIFIED BY pk-dh.&amp;id
   }
</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-pk-dh</dt>
<dd> is a new SMIME-CAP object.  This object associates the existing object identifier (id-dh) used for the public key algorithm in the certificates (defined in <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with a new type defined above, DSAKeyCapabilities.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Elliptical Curve Keys</h3>

<p>There are currently three Elliptical Curve public key object
identifiers.  These are EC, EC-DH and EC-MQV
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Generic Elliptical Curve Keys</h3>

<p>All most all ECC keys  that are contained in certificates today use the generic ECC public key format and identifier.  This allows for the public key to be used both for key agreement and for signature validation (assuming the appropriate bits are in the certificate).  The only reason for using one of the more specific public key identifier is if the user wants to restrict the usage of the ECC public key with a specific algorithm.
</p>
<p>For the generic ECC public key, the S/MIME capability that is advertised is a request for a specific group to be used. 
</p>
<p>The ASN.1 that is used for the generic ECC public key is defined as below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-ec SMIME-CAPS ::= {
      TYPE pk-ec.&amp;Type
      IDENTIFIED BY pk-ec.&amp;id
   }
</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-pk-ec</dt>
<dd> is a new SMIME-CAP object.  This object associated the existing object identifier (id-ecPublicKey) used for the public key algorithm in the certificates (defined in <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with the same type used for the public key (ECPoint).
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Elliptical Curve DH Keys</h3>

<p>This public key type is used with the Elliptical Curve Diffie-Hellman key agreement algorithm.
</p>
<p>The ASN.1 that is used for EC-DH keys is defined below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-ecDH SMIME-CAPS ::= {
     TYPE pk-ecDH.&amp;Type
     IDENTIFIED BY pk-ecDH.&amp;id
   }
</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-ec-dh</dt>
<dd> is a new SMIME-CAP object.  This object associated the existing object identifier (id-??) used for the public key algorithm in the certificate (defined in <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with the same type structure used for public keys.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Elliptical Curve MQV Keys</h3>

<p>This public key type is used with the Elliptical Curve MQV key agreement algorithm.
</p>
<p>The ASN.1 that is used for EC-MQV keys is defined below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-pk-ecMQV SMIME-CAPS ::= {
     TYPE pk-ecMQV.&amp;Type
     IDENTIFIED BY pk-ecMQV.&amp;id
   }
</pre></div>
<p>In the above ASN.1 we have defined the following:
          </p>
<blockquote class="text"><dl>
<dt>scap-ec-MQV</dt>
<dd> is a new SMIME-CAP object.  This object associated the existing object identifier (id-??) used for the public key algorithm in the certificate (defined in <a class='info' href='#RFC3279'>[RFC3279]<span> (</span><span class='info'>Bassham, L., Polk, W., and R. Housley, &ldquo;Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with the same type structure used for public keys.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
RSASSA-PSS Signature Algorithm Capability</h3>

<p>This document defines a new S/MIME Capability for the RSA-SSA-PSS signature algorithm.  There already exists one in <a class='info' href='#RFC4055'>[RFC4055]<span> (</span><span class='info'>Schaad, J., Kaliski, B., and R. Housley, &ldquo;Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; June&nbsp;2005.</span><span>)</span></a> where the parameters field is not used.
</p>
<p>When the S/MIME group defined a S/MIME Capability for the RSA-SSA-PSS signature algorithm, it was done so in the context of how S/MIME defines and uses S/MIME Capabilities.  When placed in an S/MIME message <a class='info' href='#RFC3851'>[RFC3851]<span> (</span><span class='info'>Ramsdell, B., &ldquo;Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification,&rdquo; July&nbsp;2004.</span><span>)</span></a> or in a certificate <a class='info' href='#RFC4262'>[RFC4262]<span> (</span><span class='info'>Santesson, S., &ldquo;X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities,&rdquo; December&nbsp;2005.</span><span>)</span></a> it is always placed in a sequence of capabilities.  This meant that one can place the identifier for RSA-SSA-PSS in the sequence along with the identifier for MD5, SHA-1 and SHA-256.  The assumption was then made that one could compute the matrix of all answers and the publisher would support all elements in the matrix.  This has the possibility that the publisher could accidently publish a point in the matrix that is not supported.
</p>
<p>In this situation, there is only a single item that is published.  This means that we need to publish all of the associated information along with the identifier for the signature algorithm in a single entity.  For this reason we now define a new parameter type to be used as the S/MIME capability type which contains a hash identifier and a mask identifier.  The ASN.1 used for this is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   scap-sa-rsaSSA-PSS SMIME-CAPS ::= {
      TYPE RsaSsa-Pss-sig-caps
      IDENTIFIED BY sa-rsaSSA-PSS.&amp;id
   }

   RsaSsa-Pss-sig-caps ::= SEQUENCE {
      hashAlg  SMIMECapability{{ HashAlgorithms }},
      maskAlg  SMIMECapability{{ MaskAlgorithmSet }} OPTIONAL,
      trailerField INTEGER DEFAULT 1
   }

   scap-mf-mgf1 SMIME-CAPS ::= {
      TYPE SMIMECapability{{ HashAlgorithms }}
      IDENTIFIED BY id-mgf1
   }

   MaskAlgorithmSet SMIME-CAPS ::= {scap-mf-mgf1, ...}
</pre></div>
<p>In the above ASN.1 we have defined the following:
        </p>
<blockquote class="text"><dl>
<dt>scap-sa-rsaSSA-PSS</dt>
<dd> is a new SMIME-CAP object.  This object associates the existing object identifier (id-RSASSA-PSS) used for the signature algorithm (defined in <a class='info' href='#RFC4055'>[RFC4055]<span> (</span><span class='info'>Schaad, J., Kaliski, B., and R. Housley, &ldquo;Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; June&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a>) with the new type RsaSsa-Pss-sig-caps.
</dd>
<dt>RsaSsa-Pss-sig-caps</dt>
<dd> carries the desired set of capabilities for the RSA SSA-PSS signature algorithm.  The fields of this type are:
            
<blockquote class="text"><dl>
<dt>hashAlg</dt>
<dd> contains the S/MIME capability for the hash algorithm we are declaring we support with the RSA-SSA-PSS signature algorithm.
</dd>
<dt>maskAlg</dt>
<dd> contains the S/MIME capability for the mask algorithm we are declaring we support with the RSA-SSA-PSS signature algorithm.
</dd>
<dt>trailerField</dt>
<dd> specifies which trailer field algorithm is being supported.  This MUST be the value 1.
</dd>
</dl></blockquote>
          
</dd>
</dl></blockquote><p>
      
</p>
<p>NOTE:  In at least one iteration of the design we used a sequence of hash identifiers and a sequence of masking functions and again made the assumption that entire matrix would be supported.  This has been removed at this point since the original intent of S/MIME capabilities is that one should be able to do a binary comparison of the DER encoding of the field and determine a specific capability was published.   We could return back to using the sequence if we wanted to lose the ability to do a binary compare but needed to shorten the encodings.  This does not currently appear to be an issue at this point.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>This document provides new fields that can be placed in an S/MIME capabilities sequence.  There are number of considerations that need to be taking into account when doing this.
</p>
<p>As mentioned above, there are a small number of cases where the same object identifier may be used to identify a public key and an algorithm.  This is the case for many years with the OID rsaEncryption where it identifies both a public key and the RSA v1.5 key transport algorithm.  This means that when an S/MIME capabilities sequence is defined care needs to be taken to specify the types of algorithms and/or public keys that are to be specified in that sequence.  In general, it is expected that algorithms and public keys will be segregated.
</p>
<p>The more detailed the information that is communicated, the better the end results are going to be.  If you can state you do RSA v1.5, EC-DSA, SHA-1 and SHA-256, then it would imply that all four values are supported.  It may be however that EC-DSA with SHA-1 is not supported.  Not including the SHA-1 hash algorithm could lead to problems as RSA with SHA-1 could be the only point of intersection, but including it means that a result may be returned that cannot be processed.
</p>
<p>The more information passed the better.  The more choices that are passed, the better the odds that both parties will be able to agree on a common algorithm.
</p>
<p>The less information passed the better.  Passing too much information can lead to computational issues in trying to deal with the possibilities.  This becomes acute when a negotiation over algorithms is going on between multiple parties (such as sending an encrypted S/MIME message) where the amount of memory and processing time can be greatly expanded if there are a large number of choices for each recipient.
</p>
<p>Ordering of preference of algorithms is not always supported by all places where S/MIME capabilities are used.  The addition of preference ordering greatly complicates the decisions to be used, especially as it is expected that not all parties will agree on the same ordering.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document has no IANA considerations.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3279">[RFC3279]</a></td>
<td class="author-text">Bassham, L., Polk, W., and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3279, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3279.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4055">[RFC4055]</a></td>
<td class="author-text">Schaad, J., Kaliski, B., and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;4055, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4055.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5912">[RFC5912]</a></td>
<td class="author-text">Hoffman, P. and J. Schaad, &ldquo;<a href="http://tools.ietf.org/html/rfc5912">New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)</a>,&rdquo; RFC&nbsp;5912, June&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5912.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pkix-ocspagility">[I-D.ietf-pkix-ocspagility]</a></td>
<td class="author-text">Hallam-Baker, P. and S. Santesson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-ocspagility-08.txt">OCSP Algorithm Agility</a>,&rdquo; draft-ietf-pkix-ocspagility-08 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-ocspagility-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3851">[RFC3851]</a></td>
<td class="author-text">Ramsdell, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3851">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</a>,&rdquo; RFC&nbsp;3851, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4262">[RFC4262]</a></td>
<td class="author-text">Santesson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4262">X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities</a>,&rdquo; RFC&nbsp;4262, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4262.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMIMEv3-MSG">[SMIMEv3-MSG]</a></td>
<td class="author-text"><a href="mailto:blaker@deming.com">Ramsdell, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2633">S/MIME Version 3 Message Specification</a>,&rdquo; RFC&nbsp;2633, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2633.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST-SIZES">[NIST-SIZES]</a></td>
<td class="author-text">Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;<a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf">Recommendation for Key Management -- Part 1: General</a>,&rdquo; NIST Special Publication&nbsp;800-57, March&nbsp;2007.</td></tr>
</table>

<a name="ASN.2008"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
2008 ASN.1 Module</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
PUBLIC-KEY-SMIME-CAPIBLITIES
   { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) id-mod(0) TBD5 }
DEFINITIONS ::=
BEGIN
   IMPORTS
   SMIME-CAPS, PUBLIC-KEY, SMIMECapability
   FROM AlgoritrithmInformation-2009
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-algorithmInformation-02(58)}

   pk-rsa, pk-dsa, pk-dh, pk-ec, pk-ecDH, pk-ecMQV
   FROM PKIXAlgs-2009
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-pkix1-algorithms2008-02(56) }

   pk-rsaSSA-PSS, pk-rsaES-OAEP, sa-rsaSSA-PSS,
   HashAlgorithms, id-mgf1
   FROM PKIX1-PSS-OAEP-Algorithms-2009
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-pkix1-rsa-pkalgs-02(54)}
   ;

   --
   --  Define a set containing all of the S/MIME capabilties defined
   --  by this document
   --

   SMimeCaps SMIME-CAPS ::= {
      PubKeys-SMimeCaps |
      scap-sa-rsaSSA-PSS
   }

   PubKeys-SMimeCaps SMIME-CAPS ::= {
      scap-pk-rsa | scap-pk-rsaSSA-PSS |
      scap-pk-dsa |
      scap-pk-ec | scap-pk-ecDH
   }

   --
   --  We defined RSA keys from the modules RFC3279 and RFC4055
   --

   scap-pk-rsa SMIME-CAPS ::= {
     TYPE RSAKeyCapabilities
     IDENTIFIED BY pk-rsa.&amp;id
   }

   RSAKeyCapabilities ::= SEQUENCE {
      minKeySize        RSAKeySize,
      maxKeySize        RSAKeySize OPTIONAL
   }

   RSAKeySize ::= INTEGER (1024 | 2048 | 3072 | 7680 | 15360 |
                           4096 | 8192, ...)


   scap-pk-rsaES-OAEP SMIME-CAPS ::= {
     TYPE RSAKeyCapabilities
     IDENTIFIED BY pk-rsaES-OAEP.&amp;id
   }

   scap-pk-rsaSSA-PSS SMIME-CAPS ::= {
     TYPE RSAKeyCapabilities
     IDENTIFIED BY pk-rsaSSA-PSS.&amp;id
   }

   scap-sa-rsaSSA-PSS SMIME-CAPS ::= {
      TYPE RsaSsa-Pss-sig-caps
      IDENTIFIED BY sa-rsaSSA-PSS.&amp;id
   }

   RsaSsa-Pss-sig-caps ::= SEQUENCE {
      hashAlg  SMIMECapability{{ HashAlgorithms }},
      maskAlg  SMIMECapability{{ MaskAlgorithmSet }} OPTIONAL,
      trailerField INTEGER DEFAULT 1
   }

   scap-mf-mgf1 SMIME-CAPS ::= {
      TYPE SMIMECapability{{ HashAlgorithms }}
      IDENTIFIED BY id-mgf1
   }

   MaskAlgorithmSet SMIME-CAPS ::= {scap-mf-mgf1, ...}

   --
   --  we define DH/DSA keys from the module RFC3279
   --

   scap-pk-dsa SMIME-CAPS ::= {
     TYPE DSAKeyCapabilities
     IDENTIFIED BY pk-dsa.&amp;id
   }

   DSAKeyCapabilities ::= CHOICE {
       keySizes         [0] SEQUENCE {
          minKeySize            DSAKeySize,
          maxKeySize            DSAKeySize OPTIONAL
       },
       keyParams        [1] pk-dsa.&amp;Params
   }

   DSAKeySize ::= INTEGER (1024 | 2048 | 3072 | 7680 | 15360 )

   scap-pk-dh SMIME-CAPS ::= {
     TYPE INTEGER
     IDENTIFIED BY pk-dh.&amp;id
   }

   --
   --  we define Eliptical Curve keys from the module RFC3279
   --

   scap-pk-ec SMIME-CAPS ::= {
      TYPE pk-ec.&amp;Type
      IDENTIFIED BY pk-ec.&amp;id
   }

   scap-pk-ecDH SMIME-CAPS ::= {
     TYPE pk-ecDH.&amp;Type
     IDENTIFIED BY pk-ecDH.&amp;id
   }

   scap-pk-ecMQV SMIME-CAPS ::= {
     TYPE pk-ecMQV.&amp;Type
     IDENTIFIED BY pk-ecMQV.&amp;id
   }

END
</pre></div>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Future Work</h3>

<p>A future revision of <a class='info' href='#RFC5912'>[RFC5912]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX),&rdquo; June&nbsp;2010.</span><span>)</span></a> should be done at
some point which expands the definition of the PUBLIC-KEY class and allows
for an S/MIME Capability to be included in the class definition.  This would
encourage people to think about this as an issue when defining new public
key structures in the future.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jim Schaad</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Soaring Hawk Consulting</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jimsch@augustcellars.com">jimsch@augustcellars.com</a></td></tr>
</table>
</body></html>
