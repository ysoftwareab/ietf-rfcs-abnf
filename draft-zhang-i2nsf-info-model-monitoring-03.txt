



Network Working Group                                             L. Xia
Internet-Draft                                                  D. Zhang
Intended status: Experimental                                     Huawei
Expires: September 14, 2017                                        Y. Wu
                                                          Aliababa Group
                                                                R. Kumar
                                                               A. Lohiya
                                                        Juniper Networks
                                                             H. Birkholz
                                                          Fraunhofer SIT
                                                          March 13, 2017


 An Information Model for the Monitoring of Network Security Functions
                                 (NSF)
               draft-zhang-i2nsf-info-model-monitoring-03

Abstract

   The Network Security Functions (NSF) NSF-facing interface exists
   between the Service Provider's management system (or Security
   Controller) and the NSFs to enforce the security policy provisioning
   and network security status monitoring . This document focuses on the
   monitoring part of it and proposes the information model for it.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 14, 2017.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.





Xia, et al.            Expires September 14, 2017               [Page 1]

Internet-Draft            IM for NSF Monitoring               March 2017


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.1.  Key Words . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.2.  Definition of Terms . . . . . . . . . . . . . . . . . . .   4
   3.  Use cases for NSF Monitoring Data . . . . . . . . . . . . . .   4
   4.  Classification of NSF Monitoring Data . . . . . . . . . . . .   4
   5.  Exporting NSF Monitoring Data . . . . . . . . . . . . . . . .   6
   6.  Basic Information Model for All Monitoring Data . . . . . . .   7
   7.  Extended Information Model for Monitoring Data  . . . . . . .   8
     7.1.  System Alarm  . . . . . . . . . . . . . . . . . . . . . .   8
       7.1.1.  Memory Alarm  . . . . . . . . . . . . . . . . . . . .   8
       7.1.2.  CPU Alarm . . . . . . . . . . . . . . . . . . . . . .   9
       7.1.3.  Disk Alarm  . . . . . . . . . . . . . . . . . . . . .   9
       7.1.4.  Hardware Alarm  . . . . . . . . . . . . . . . . . . .   9
       7.1.5.  Interface Alarm . . . . . . . . . . . . . . . . . . .  10
     7.2.  System Events . . . . . . . . . . . . . . . . . . . . . .  10
       7.2.1.  Access Violation  . . . . . . . . . . . . . . . . . .  10
       7.2.2.  Configuration Change  . . . . . . . . . . . . . . . .  10
     7.3.  System Log  . . . . . . . . . . . . . . . . . . . . . . .  11
       7.3.1.  Access Logs . . . . . . . . . . . . . . . . . . . . .  11
       7.3.2.  Resource Utilization Logs . . . . . . . . . . . . . .  11
       7.3.3.  User Activity Logs  . . . . . . . . . . . . . . . . .  12
     7.4.  System Counters . . . . . . . . . . . . . . . . . . . . .  12
       7.4.1.  Interface counters  . . . . . . . . . . . . . . . . .  12
     7.5.  NSF Events  . . . . . . . . . . . . . . . . . . . . . . .  13
       7.5.1.  DDoS Event  . . . . . . . . . . . . . . . . . . . . .  13
       7.5.2.  Session Table Event . . . . . . . . . . . . . . . . .  14
       7.5.3.  Virus Event . . . . . . . . . . . . . . . . . . . . .  14
       7.5.4.  Intrusion Event . . . . . . . . . . . . . . . . . . .  15
       7.5.5.  Botnet Event  . . . . . . . . . . . . . . . . . . . .  16
       7.5.6.  Web Attack Event  . . . . . . . . . . . . . . . . . .  17
     7.6.  NSF Logs  . . . . . . . . . . . . . . . . . . . . . . . .  18
       7.6.1.  DDoS Logs . . . . . . . . . . . . . . . . . . . . . .  18
       7.6.2.  Virus Logs  . . . . . . . . . . . . . . . . . . . . .  18
       7.6.3.  Intrusion Logs  . . . . . . . . . . . . . . . . . . .  19
       7.6.4.  Botnet Logs . . . . . . . . . . . . . . . . . . . . .  19



Xia, et al.            Expires September 14, 2017               [Page 2]

Internet-Draft            IM for NSF Monitoring               March 2017


       7.6.5.  DPI Logs  . . . . . . . . . . . . . . . . . . . . . .  19
       7.6.6.  Vulnerabillity Scanning Logs  . . . . . . . . . . . .  20
       7.6.7.  Web Attack Logs . . . . . . . . . . . . . . . . . . .  21
     7.7.  NSF Counters  . . . . . . . . . . . . . . . . . . . . . .  21
       7.7.1.  Firewall counters . . . . . . . . . . . . . . . . . .  21
       7.7.2.  Policy Hit Counters . . . . . . . . . . . . . . . . .  22
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  23
   9.  Security Considerations . . . . . . . . . . . . . . . . . . .  23
   10. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  24
   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .  24
     11.1.  Normative References . . . . . . . . . . . . . . . . . .  24
     11.2.  Informative References . . . . . . . . . . . . . . . . .  24
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  24

1.  Introduction

   According to [I-D.ietf-i2nsf-framework], the interface provided by a
   NSF (e.g., FW, IPS, Anti-DDOS, or Anti-Virus) to administrative
   entities (e.g., NMS, security controller) for configuring security
   function in the NSF and monitoring the NSF is referred to as a 'I2NSF
   customer-facing interface'.  The monitoring part of it is meant to
   monitor the NSF e.g. events, alerts, alarms, logs, counters.  The
   monitoring of the NSF plays a very important role in the overall
   security framework if done in a timely and comprehensive way.  The
   monitoring information generated by a NSF could very well be an early
   indication of malicious activity, or anomalous behavior, or a
   potential sign of denial of service attacks.

   This draft proposes a comprehensive NSF monitoring information model
   that provide visibility into NSFs.  This document will not go into
   the design details of NSF-facing interface.  Instead, this draft is
   focused on specifying the information that a NSF needs to provide in
   the monitoring part of the NSF-facing interface, as well as its
   information model.  Besides, [I-D.draft-xibassnez-i2nsf-capability ]
   specifies the information model for the security policy provisioning
   part of the NSF-facing interface.

2.  Terminology

2.1.  Key Words

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].







Xia, et al.            Expires September 14, 2017               [Page 3]

Internet-Draft            IM for NSF Monitoring               March 2017


2.2.  Definition of Terms

   This document uses the terms defined in [I-D.draft-ietf-i2nsf-
   terminology].

3.  Use cases for NSF Monitoring Data

   As mentioned earlier, monitoring plays a very critical role in the
   overall security framework.  The monitoring of the NSF provides very
   valuable information to the security controller in maintaining the
   provisioned security posture.  Besides this, there are various other
   reasons to monitor the NSFs as listed below:

   o  The security administrator could configure a policy that is
      triggered on a specific event happened in the NSF or the network.
      The security controller would monitor for the specified event and
      once it happens, it configures additional security functions as
      per the policy.

   o  The events triggered by NSFs as a result of security policy
      violation could be used by SIEM to detect any suspicious activity.

   o  The events and activity logs from NSFs could be used to build
      advanced analytics such as behavior and predictive to improve the
      security posture.

   o  The security controller could use events from the NSF for
      achieving high availability.  It could take corrective actions
      such as restarting a failed NSF, horizontally scaling the NSF etc.

   o  The events and activity logs from the NSF could aid in debugging
      and root cause analysis of an operational issue.

   o  The activity logs from the NSF could be used to build historical
      data for operational and business reasons.

4.  Classification of NSF Monitoring Data

   In order to maintain a strong security posture, it is not only
   necessary to configure NSF security policies but also to continuously
   monitor NSF by consuming acquirable monitoring data.  This enables
   security admins to assess what is happening in the network timely.
   It is not possible to block all the internal and external threats
   based on static security posture but requires a very dynamic posture
   with constant visibility.  This draft defines a set of information
   elements (and their scope) that can be acquired from NSF and can be
   used as monitoring data.  In essence, these types of monitoring data
   can be leveraged to support constant visibility on multiple levels of



Xia, et al.            Expires September 14, 2017               [Page 4]

Internet-Draft            IM for NSF Monitoring               March 2017


   granularity and can be consumed by corresponding functions.  The
   types of monitoring data as ordered below increase in expressiveness
   by incorporating more information to the semantics of the monitoring
   data.  There are two categories of monitoring data.  Information that
   is produced and emitted by an NSF automatically (published data) and
   information that is produced and retained by the NSF and has to be
   collected in intervals (retained data):

   Published Data:

   o  Events: the most generic type of monitoring data that can be
      emitted by an NSF.  An event is defined in [RFC3877] as "something
      that happens which may be of interest.  A fault, a change in
      status, crossing a threshold, or an external input to the system,
      for example.  In the context of the I2NSF IMM, an event is a
      representation of a change of state, configuration, or composition
      of an NSF or an entity (e.g. an endpoint) or an activity (e.g. a
      PDU flow) that can be observed by the NSF and can be interpreted
      as a change of state or behavior by the NSF.  An event can be
      created without the use of an I2NSF Condition (declarative
      guidance) available to the NSF.  In the context of I2NSF, in some
      cases an event can trigger low level I2NSF actions (which
      constitutes an implicit escalation to alert via primate
      assessment).

   o  Alert: an event that is annotated with a criticality assessment
      due to non-compliance with I2NSF conditions (declarative guidance)
      available to an I2NSF Consumer via I2NSF Actions.  The Intrusion
      Detection Message Exchange Format [RFC4765] defines a
      representation that "systems can use to report alerts about events
      that they deem suspicious" and also associates a severity ("an
      estimate of the relative severity of the event") with the
      corresponding alert.  In the context of the I2NSF IMM, an alert is
      derived from events that express changes indicating not to conform
      with declarative guidance (e.g. an exceeded threshold of a value
      or a pattern or signature found in a PDU stream - typically an
      I2NSF condition) or due to imperative guidance (e.g. correlation
      rules applied to streams of multiple events over time or a black-
      list content of an event matches - typically an I2NSF Policy
      Rule).  An alert is created by an I2NSF Producer with respect to
      I2NSF conditions (declarative guidance) or imperative guidance
      available to the I2NSF Producer.  An alert does not indicate an
      immediate impact on operations and are not time-sensitive (but can
      be escalated to an alarm nevertheless due to persistence via an
      I2NSF Policy Rule).

   o  Alarms: an alarm that is annotated with the assertion of: 1.)
      having immediate impact on operations, or 2.) a persistence that



Xia, et al.            Expires September 14, 2017               [Page 5]

Internet-Draft            IM for NSF Monitoring               March 2017


      in non-compliant in respect to I2NSF conditions (declarative
      guidance), or 3.) a correlation result produced by a I2NSF Service
      in respect to the result of I2NSF Policy Rules that process
      alerts.  Alarms are time-sensitive and must be reported to the
      security admin as soon as possible.  By processing alarms, the
      administrator can rapidly locate the root-cause of faults and
      rapidly deal with the faults to ensure normal operation of the
      NSFs and avoid NSFs going into unknown state or potentially
      exposing security vulnerabilities.  An analyst can manage the NSF
      with via I2NSF Policy Rules.  The intend of alarms is to highlight
      only critical information and to avoid continuous combing through
      large amount alerts (or even events) by analysts.

   Retained Data:

   o  Logs: Logs are information generated by NSF about its operational
      and informational data, or various events such as user activities,
      network/traffic status and network activity, etc.  Logs are
      important for debugging, auditing and security forensic.  Unlike
      events, logs do not require an immediate attention from an analyst
      but may be useful for visibility and retroactive cyber forensic.
      Hence, logs usually include less structures but potentially more
      detailed information in regard to events.  For example, the NSF
      could generate a log when due to an I2NSF Policy Rule.  Logs can
      be continuously processed by I2NSF Agent that act as I2NSF
      Producer and emit events via function specifically tailored to a
      type of log.

   o  Counters: A specific representation of identical state changes
      that potentially occur in high frequency.  Examples include
      network interface counters (packets, bytes), drop, error counters
      etc.  Counters are useful in debugging and visibility into
      operational behavior of the NSF.  An I2NSF Agent that observes the
      progress of counters can act as an I2NSF Producer and emit Events
      in respect to I2NSF Policy Rules.

5.  Exporting NSF Monitoring Data

   As per the use cases of NSF monitoring data, the data need to be sent
   to various consumers based on the needs and requirements.  There are
   multiple things to be considered for exporting this data to needed
   parties as listed below:

   o  Pull-Push model: A set of data could be pushed by a NSF to the
      needed party or pulled by the needed party from a NSF.  A specific
      data might need both the models at the same time if there are
      multiple consumers with varying requirements.  It really depends
      upon the need and its usages to the consumer.  In general, any



Xia, et al.            Expires September 14, 2017               [Page 6]

Internet-Draft            IM for NSF Monitoring               March 2017


      alarm is considered to be of great importance and must be sent
      immediately for any meaningful action so it should be sent using
      push model but logs are not as critical so could be pulled by the
      consumer.  The I2NSF does not mandate a specific scheme for each
      data set, it is up to each implementation.

   o  Export frequency: The monitoring data could be sent immediately
      upon generation by a NSF to interested parties or pushed
      periodically.  The frequency of exporting the data depends upon
      its size and timely usefulness.  It is out of the scope of I2NSF
      and left to each NSF implementation.

   o  Authentication: There may be a need for authentication between
      monitoring data producer (NSF) and consumer to ensure that
      critical information does not fall into wrong hands.  This may be
      necessary if the NSF directly export data to the consumer outside
      its admin boundary.  The I2NSF does not mandate when and how
      specific authentication must be done.

   o  Subscription method: In order for the consumer to pull the data
      from NSF or for NSF to push the data to a consumer, there must be
      a mechanism for consumer to subscribe to the NSF data it is
      interested in.  There are few open source method available and it
      is up to each implementation to decide the right one.

   o  Data transfer mode: The data could be pushed by NSF using a
      connection-less model that does require a persistent connection or
      streamed over a persistent connection.  It depends upon the
      requirement of the consumer and the nature of data.  A particular
      set of data can use either or both the mode based on
      implementation.

   o  Transport method: There are lot of transport mechanism such as IP,
      UDP, TCP.  There are also open source implementations for specific
      set of data such as systems counter.  The I2NSF does not mandate
      any specific method for a given data set, it is up to each
      implementation.

6.  Basic Information Model for All Monitoring Data

   As explained in the above section, there is a wealth of data
   available from the NSF that can be monitored.  Firstly, there must be
   some general information with each monitoring message sent from an
   NSF that helps consumer in identifying meta data with that message,
   which are listed as below:

   o  message_version: Indicate the version of the data format and is a
      two-digit decimal numeral starting from 01



Xia, et al.            Expires September 14, 2017               [Page 7]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  message_type: Event, Alert, Alarm, Log, Counter, etc

   o  time_stamp: Indicate the time when the message is generated

   o  vendor_name: The name of the NSF vendor

   o  NSF_name: The name (or IP) of the NSF generating the message

   o  Module_name: The module name outputting the message

   o  Severity: Indicates the level of the logs.  There are total eight
      levels, from 0 to 7.  The smaller the numeral is, the higher the
      severity is.

7.  Extended Information Model for Monitoring Data

   This section covers the additional information associated with the
   system messages.  The extended information model is only for the
   structured data such as alarm.  Any unstructured data is specified
   with basic information model only.

   [Editors' note]: This section remains the same as -02 version,
   although the classification of the monitoring data has been changed
   from -02 version.  The new inconsistency will be addressed in next
   verion.

7.1.  System Alarm

7.1.1.  Memory Alarm

   The following information should be included in a Memory Alarm:

   o  event_name: 'MEM_USAGE_ALARM'

   o  module_name: Indicate the NSF module responsible for generating
      this alarm

   o  usage: specifies the amount of memory used

   o  threshold: The threshold triggering the alarm

   o  severity: The severity of the alarm such as critical, high,
      medium, low

   o  message: 'The memory usage exceeded the threshold'






Xia, et al.            Expires September 14, 2017               [Page 8]

Internet-Draft            IM for NSF Monitoring               March 2017


7.1.2.  CPU Alarm

   The following information should be included in a CPU Alarm:

   o  event_name: 'CPU_USAGE_ALARM'

   o  usage: Specifies the amount of CPU used

   o  threshold: The threshold triggering the event

   o  severity: The severity of the alarm such as critical, high,
      medium, low

   o  message: 'The CPU usage exceeded the threshold'

7.1.3.  Disk Alarm

   The following information should be included in a Disk Alarm:

   o  event_name: 'DISK_USAGE_ALARM'

   o  usage: Specifies the amount of disk space used

   o  threshold: The threshold triggering the event

   o  severity: The severity of the alarm such as critical, high,
      medium, low

   o  message: 'The disk usage exceeded the threshold'

7.1.4.  Hardware Alarm

   The following information should be included in a Hardware Alarm:

   o  event_name: 'HW_FAILURE_ALARM'

   o  component_name: Indicate the HW component responsible for
      generating this alarm

   o  threshold: The threshold triggering the alarm

   o  severity: The severity of the alarm such as critical, high,
      medium, low

   o  message: 'The HW component has failed or degraded'






Xia, et al.            Expires September 14, 2017               [Page 9]

Internet-Draft            IM for NSF Monitoring               March 2017


7.1.5.  Interface Alarm

   The following information should be included in a Interface Alarm:

   o  event_name: 'IFNET_STATE_ALARM'

   o  interface_Name: The name of interface

   o  interface_state: 'UP', 'DOWN', 'CONGESTED'

   o  threshold: The threshold triggering the event

   o  severity: The severity of the alarm such as critical, high,
      medium, low

   o  message: 'Current interface state'

7.2.  System Events

7.2.1.  Access Violation

   The following information should be included in this event:

   o  event_name: 'ACCESS_DENIED'

   o  user: Name of a user

   o  group: Group to which a user belongs

   o  login_ip_address: Login IP address of a user

   o  authentication_mode: User authentication mode. e.g., Local
      Authentication, Third-Party Server Authentication, Authentication
      Exemption, SSO Authentication

   o  message: 'access denied'

7.2.2.  Configuration Change

   The following information should be included in this event:

   o  event_name: 'CONFIG_CHANGE'

   o  user: Name of a user

   o  group: Group to which a user belongs

   o  login_ip_address: Login IP address of a user



Xia, et al.            Expires September 14, 2017              [Page 10]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  authentication_mode: User authentication mode. e.g., Local
      Authentication, Third-Party Server Authentication, Authentication
      Exemption, SSO Authentication

   o  message: 'Configuration modified'

7.3.  System Log

7.3.1.  Access Logs

   Access logs record administrators' login, logout, and operations on
   the device.  By analyzing them, security vulnerabilities can be
   identified.  The following information should be included in
   operation report:

   o  Administrator: Administrator that operates on the device

   o  login_ip_address: IP address used by an administrator to log in

   o  login_mode: Specifies the administrator logs in mode e.g.  root,
      user

   o  operation_type: The operation type that the administrator execute,
      e.g., login, logout, configuration, etc

   o  result: Command execution result

   o  content: Operation performed by an administrator after login.

7.3.2.  Resource Utilization Logs

   Running reports record the device system's running status, which is
   useful for device monitoring.  The following information should be
   included in running report:

   o  system_status: The current system's running status

   o  CPU_usage: Specifies the CPU usage

   o  memory_usage: Specifies the memory usage

   o  disk_usage: Specifies the disk usage

   o  disk_left: Specifies the available disk space left

   o  session_number: Specifies total concurrent sessions

   o  process_number: Specifies total number of system processes



Xia, et al.            Expires September 14, 2017              [Page 11]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  in_traffic_rate: The total inbound traffic rate in pps

   o  out_traffic_rate: The total outbound traffic rate in pps

   o  in_traffic_speed: The total inbound traffic speed in bps

   o  out_traffic_speed: The total outbound traffic speed in bps

7.3.3.  User Activity Logs

   User activity logs provide visibility into users' online records
   (such as login time, online/lockout duration, and login IP addresses)
   and the actions users perform.  User activity reports are helpful to
   identify exceptions during user login and network access activities.

   o  user: Name of a user

   o  group: Group to which a user belongs

   o  login_ip_address: Login IP address of a user

   o  authentication_mode: User authentication mode. e.g., Local
      Authentication, Third-Party Server Authentication, Authentication
      Exemption, SSO Authentication

   o  access_mode: User access mode. e.g., PPP, SVN, LOCAL

   o  online_duration: Online duration

   o  lockout_duration: Lockout duration

   o  type: User activities. e.g., Successful User Login, Failed Login
      attempts, User Logout, Successful User Password Change, Failed
      User Password Change, User Lockout, User Unlocking, Unknown

   o  cause: Cause of a failed user activity

7.4.  System Counters

7.4.1.  Interface counters

   Interface counters provide visibility into traffic into and out of
   NSF, bandwidth usage.

   o  interface_name: Network interface name configured in NSF

   o  in_total_traffic_pkts: Total inbound packets




Xia, et al.            Expires September 14, 2017              [Page 12]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  out_total_traffic_pkts: Total outbound packets

   o  in_total_traffic_bytes: Total inbound bytes

   o  out_total_traffic_bytes: Total outbound bytes

   o  in_drop_traffic_pkts: Total inbound drop packets

   o  out_drop_traffic_pkts: Total outbound drop packets

   o  in_drop_traffic_bytes: Total inbound drop bytes

   o  out_drop_traffic_bytes: Total outbound drop bytes

   o  in_traffic_ave_rate: Inbound traffic average rate in pps

   o  in_traffic_peak_rate: Inbound traffic peak rate in pps

   o  in_traffic_ave_speed: Inbound traffic average speed in bps

   o  in_traffic_peak_speed: Inbound traffic peak speed in bps

   o  out_traffic_ave_rate: Outbound traffic average rate in pps

   o  out_traffic_peak_rate: Outbound traffic peak rate in pps

   o  out_traffic_ave_speed: Outbound traffic average speed in bps

   o  out_traffic_peak_speed: Outbound traffic peak speed in bps.

7.5.  NSF Events

7.5.1.  DDoS Event

   The following information should be included in a DDoS Event:

   o  event_name: 'SEC_EVENT_DDoS'

   o  sub_attack_type: Any one of Syn flood, ACK flood, SYN-ACK flood,
      FIN/RST flood, TCP Connection flood, UDP flood, Icmp flood, HTTPS
      flood, HTTP flood, DNS query flood, DNS reply flood, SIP flood,
      and etc.

   o  dst_ip: The IP address of a victum under attack

   o  dst_port: The port numbers that the attrack traffic aims at.

   o  start_time: The time stamp indicating when the attack started



Xia, et al.            Expires September 14, 2017              [Page 13]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  end_time: The time stamp indicating when the attack ended.  If the
      attack is still undergoing when sending out the alarm, this field
      can be empty.

   o  attack_rate: The PPS of attack traffic

   o  attack_speed: the bps of attack traffic

   o  rule_id: The ID of the rule being triggered

   o  rule_name: The name of the rule being triggered

   o  profile: Security profile that traffic matches.

7.5.2.  Session Table Event

   The following information should be included in a Session
   Table Event:

   o  event_name: 'SESSION_USAGE_HIGH'

   o  current: The number of concurrent sessions

   o  max: The maximum number of sessions that the session table can
      support

   o  threshold: The threshold triggering the event

   o  message: 'The number of session table exceeded the threshold'

7.5.3.  Virus Event

   The following information should be included in a Virus Event:

   o  event_Name: 'SEC_EVENT_VIRUS'

   o  virus_type: Type of the virus, e.g., trojan, worm, macro Virus
      type

   o  virus_name

   o  dst_ip: The destination IP address of the packet where the virus
      is found

   o  src_ip: The source IP address of the packet where the virus is
      found

   o  src_port: The source port of the packet where the virus is found



Xia, et al.            Expires September 14, 2017              [Page 14]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  dst_port: The destination port of the packet where the virus is
      found

   o  src_zone: The source security zone of the packet where the virus
      is found

   o  dst_zone: The destination security zone of the packet where the
      virus is found

   o  file_type: The type of the file where the virus is hided within

   o  file_name: The name of the file where the virus is hided within

   o  virus_info: The brief introduction of virus

   o  raw_info: The information describing the packet triggering the
      event.

   o  rule_id: The ID of the rule being triggered

   o  rule_name: The name of the rule being triggered

   o  profile: Security profile that traffic matches.

7.5.4.  Intrusion Event

   The following information should be included in a Intrustion Event:

   o  event_name: The name of event: 'SEC_EVENT_Intrusion'

   o  sub_attack_type: Attack type, e.g., brutal force, buffer overflow

   o  src_ip: The source IP address of the packet

   o  dst_ip: The destination IP address of the packet

   o  src_port:The source port number of the packet

   o  dst_port: The destination port number of the packet

   o  src_zone: The source security zone of the packet

   o  dst_zone: The destination security zone of the packet

   o  protocol: The employed transport layer protocol, e.g.,TCP, UDP

   o  app: The employed application layer protocol, e.g.,HTTP, FTP




Xia, et al.            Expires September 14, 2017              [Page 15]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  rule_id: The ID of the rule being triggered

   o  rule_name: The name of the rule being triggered

   o  profile: Security profile that traffic matches

   o  intrusion_info: Simple description of intrusion

   o  raw_info: The information describing the packet triggering the
      event.

7.5.5.  Botnet Event

   The following information should be included in a Botnet Event:

   o  event_name: the name of event: 'SEC_EVENT_Botnet'

   o  botnet_name: The name of the detected botnet

   o  src_ip: The source IP address of the packet

   o  dst_ip: The destination IP address of the packet

   o  src_port: The source port number of the packet

   o  dst_port: The destination port number of the packet

   o  src_zone: The source security zone of the packet

   o  dst_zone: The destination security zone of the packet

   o  protocol: The employed transport layer protocol, e.g.,TCP, UDP

   o  app: The employed application layer protocol, e.g.,HTTP, FTP

   o  role: The role of the communicating parties within the botnet:

      1.  the packet from zombie host to the attacker

      2.  The packet from the attacker to the zombie host

      3.  The packet from the IRC/WEB server to the zombie host

      4.  The packet from the zombie host to the IRC/WEB server

      5.  The packet from the attacker to the IRC/WEB server

      6.  The packet from the IRC/WEB server to the attacker



Xia, et al.            Expires September 14, 2017              [Page 16]

Internet-Draft            IM for NSF Monitoring               March 2017


      7.  The packet from the zombie host to the victim

   o  botnet_info: Simple description of Botnet

   o  rule_id: The ID of the rule being triggered

   o  rule_name: The name of the rule being triggered

   o  profile: Security profile that traffic matches

   o  raw_info: The information describing the packet triggering the
      event.

7.5.6.  Web Attack Event

   The following information should be included in a Web Attack Alarm:

   o  event_name: the name of event: 'SEC_EVENT_WebAttack'

   o  sub_attack_type: Concret web attack type, e.g., sql injection,
      command injection, XSS, CSRF

   o  src_ip: The source IP address of the packet

   o  dst_ip: The destination IP address of the packet

   o  src_port: The source port number of the packet

   o  dst_port: The destination port number of the packet

   o  src_zone: The source security zone of the packet

   o  dst_zone: The destination security zone of the packet

   o  req_method: The method of requirement.  For instance, 'PUT' or
      'GET' in HTTP

   o  req_url: Requested URL

   o  url_category: Matched URL category

   o  filtering_type: URL filtering type, e.g., Blacklist, Whitelist,
      User-Defined, Predefined, Malicious Category, Unknown

   o  rule_id: The ID of the rule being triggered

   o  rule_name: The name of the rule being triggered




Xia, et al.            Expires September 14, 2017              [Page 17]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  profile: Security profile that traffic matches.

7.6.  NSF Logs

7.6.1.  DDoS Logs

   Besides the fields in an DDoS Alarm, the following information should
   be included in a DDoS Logs:

   o  attack_type: DDoS

   o  attack_ave_rate: The average pps of the attack traffic within the
      recorded time

   o  attack_ave_speed: The average bps of the attack traffic within the
      recorded time

   o  attack_pkt_num: The number attack packets within the recorded time

   o  attack_src_ip: The source IP addresses of attack traffics.  If
      there are a large amount of IP addresses, then pick a certain
      number of resources according to different rules.

   o  action: Actions against DDoS attacks, e.g., Allow, Alert, Block,
      Discard, Declare, Block-ip, Block-service.

7.6.2.  Virus Logs

   Besides the fields in an Virus Alarm, the following information
   should be included in a Virus Logs:

   o  attack_type: Virus

   o  protocol: The transport layer protocol

   o  app: The name of the application layer protocol

   o  times: The time of detecting the virus

   o  action: The actions dealing with the virus, e.g., alert, block

   o  os: The OS that the virus will affect, e.g., all, android, ios,
      unix, windows








Xia, et al.            Expires September 14, 2017              [Page 18]

Internet-Draft            IM for NSF Monitoring               March 2017


7.6.3.  Intrusion Logs

   Besides the fields in an Intrusion Alarm, the following information
   should be included in a Intrusion Logs:

   o  attack_type: Intrusion

   o  times: The times of intrusions happened in the recorded time

   o  os: The OS that the intrusion will affect, e.g., all, android,
      ios, unix, windows

   o  action: The actions dealing with the intrusions, e.g., e.g.,
      Allow, Alert, Block, Discard, Declare, Block-ip, Block-service

   o  attack_rate: NUM the pps of attack traffic

   o  attack_speed: NUM the bps of attack traffic

7.6.4.  Botnet Logs

   Besides the fields in an Botnet Alarm, the following information
   should be included in a Botnet Logs:

   o  attack_type: Botnet

   o  botnet_pkt_num:The number of the packets sent to or from the
      detected botnet

   o  action: The actions dealing with the detected packets, e.g.,
      Allow, Alert, Block, Discard, Declare, Block-ip, Block-service,
      etc

   o  os: The OS that the attack aiming at, e.g., all, android, ios,
      unix, windows, etc.

7.6.5.  DPI Logs

   DPI Logs provide statistics on uploaded and downloaded files and
   data, sent and received emails, and alert and block records on
   websites.  It's helpful to learn risky user behaviors and why access
   to some URLs is blocked or allowed with an alert record.

   o  type: DPI action types. e.g., File Blocking, Data Filtering,
      Application Behavior Control

   o  file_name: The file name




Xia, et al.            Expires September 14, 2017              [Page 19]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  file_type: The file type

   o  src_zone: Source security zone of traffic

   o  dst_zone: Destination security zone of traffic

   o  src_region: Source region of the traffic

   o  dst_region: Destination region of the traffic

   o  src_ip: Source IP address of traffic

   o  src_user: User who generates traffic

   o  dst_ip: Destination IP address of traffic

   o  src_port: Source port of traffic

   o  dst_port: Destination port of traffic

   o  protocol: Protocol type of traffic

   o  app: Application type of traffic

   o  policy_id: Security policy id that traffic matches

   o  policy_name: Security policy name that traffic matches

   o  action: Action defined in the file blocking rule, data filtering
      rule, or application behavior control rule that traffic matches.

7.6.6.  Vulnerabillity Scanning Logs

   Vulnerability scanning logs record the victim host and its related
   vulnerability information that should to be fixed. the following
   information should be included in the report:

   o  victim_ip: IP address of the victim host which has vulnerabilities

   o  vulnerability_id: The vulnerability id

   o  vulnerability_level: The vulnerability level. e.g., high, middle,
      low

   o  OS: The operating system of the victim host

   o  service: The service which has vulnerabillity in the victim host




Xia, et al.            Expires September 14, 2017              [Page 20]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  protocol: The protocol type. e.g., TCP, UDP

   o  port: The port number

   o  vulnerability_info: The information about the vulnerability

   o  fix_suggestion: The fix suggestion to the vulnerability.

7.6.7.  Web Attack Logs

   Besides the fields in an Web Attack Alarm, the following information
   should be included in a Web Attack Report:

   o  attack_type: Web Attack

   o  rsp_code: Response code

   o  req_clientapp: The client application

   o  req_cookies: Cookies

   o  req_host: The domain name of the requested host

   o  raw_info: The information describing the packet triggering the
      event.

7.7.  NSF Counters

7.7.1.  Firewall counters

   Firewall counters provide visibility into traffic signatures,
   bandwidth usage, and how the configured security and bandwidth
   policies have been applied.

   o  src_zone: Source security zone of traffic

   o  dst_zone: Destination security zone of traffic

   o  src_region: Source region of the traffic

   o  dst_region: Destination region of the traffic

   o  src_ip: Source IP address of traffic

   o  src_user: User who generates traffic

   o  dst_ip: Destination IP address of traffic




Xia, et al.            Expires September 14, 2017              [Page 21]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  src_port: Source port of traffic

   o  dst_port: Destination port of traffic

   o  protocol: Protocol type of traffic

   o  app: Application type of traffic

   o  policy_id: Security policy id that traffic matches

   o  policy_name: Security policy name that traffic matches

   o  in_interface: Inbound interface of traffic

   o  out_interface: Outbound interface of traffic

   o  total_traffic: Total traffic volume

   o  in_traffic_ave_rate: Inbound traffic average rate in pps

   o  in_traffic_peak_rate: Inbound traffic peak rate in pps

   o  in_traffic_ave_speed: Inbound traffic average speed in bps

   o  in_traffic_peak_speed: Inbound traffic peak speed in bps

   o  out_traffic_ave_rate: Outbound traffic average rate in pps

   o  out_traffic_peak_rate: Outbound traffic peak rate in pps

   o  out_traffic_ave_speed: Outbound traffic average speed in bps

   o  out_traffic_peak_speed: Outbound traffic peak speed in bps.

7.7.2.  Policy Hit Counters

   Policy Hit Counters record the security policy that traffic matches
   and its hit count.  It can check if policy configurations are
   correct.

   o  src_zone: Source security zone of traffic

   o  dst_zone: Destination security zone of traffic

   o  src_region: Source region of the traffic

   o  dst_region: Destination region of the traffic




Xia, et al.            Expires September 14, 2017              [Page 22]

Internet-Draft            IM for NSF Monitoring               March 2017


   o  src_ip: Source IP address of traffic

   o  src_user: User who generates traffic

   o  dst_ip: Destination IP address of traffic

   o  src_port: Source port of traffic

   o  dst_port: Destination port of traffic

   o  protocol: Protocol type of traffic

   o  app: Application type of traffic

   o  policy_id: Security policy id that traffic matches

   o  policy_name: Security policy name that traffic matches

   o  hit_times: The hit times that the security policy matches the
      specified traffic.

8.  IANA Considerations

   This document makes no request of IANA.

   Note to RFC Editor: this section may be removed on publication as an
   RFC.

9.  Security Considerations

   The monitoring information of NSF should be protected by the secure
   communication channel, to ensure its confidentiality and integrity.
   In another side, the NSF and security controller can all be faked,
   which lead to undesireable results, i.e., leakage of NSF's important
   operational information, faked NSF sending false information to
   mislead security controller.  The mutual authentication is essential
   to protected against this kind of attack.  The current mainstream
   security technologies (i.e., TLS, DTLS, IPSEC, X.509 PKI) can be
   employed approriately to provide the above security functions.

   In addition, to defend against the DDoS attack caused by a lot of
   NSFs sending massive monitoring information to the security
   controller, the rate limiting or similar mechanisms should be
   considered in NSF and security controller, whether in advance or just
   in the process of DDoS attack.






Xia, et al.            Expires September 14, 2017              [Page 23]

Internet-Draft            IM for NSF Monitoring               March 2017


10.  Acknowledgements

11.  References

11.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC3877]  Chisholm, S. and D. Romascanu, "Alarm Management
              Information Base (MIB)", RFC 3877, DOI 10.17487/RFC3877,
              September 2004, <http://www.rfc-editor.org/info/rfc3877>.

   [RFC4765]  Debar, H., Curry, D., and B. Feinstein, "The Intrusion
              Detection Message Exchange Format (IDMEF)", RFC 4765,
              DOI 10.17487/RFC4765, March 2007,
              <http://www.rfc-editor.org/info/rfc4765>.

11.2.  Informative References

   [I-D.ietf-i2nsf-framework]
              Lopez, D., Lopez, E., Dunbar, L., Strassner, J., and R.
              Kumar, "Framework for Interface to Network Security
              Functions", draft-ietf-i2nsf-framework-04 (work in
              progress), October 2016.

   [I-D.xia-i2nsf-capability-interface-im]
              Xia, L., Strassner, J., Li, K., Zhang, D., Lopez, E.,
              Bouthors, N., and L. Fang, "Information Model of Interface
              to Network Security Functions Capability Interface",
              draft-xia-i2nsf-capability-interface-im-06 (work in
              progress), July 2016.

Authors' Addresses

   Liang Xia
   Huawei

   Email: frank.xialiang@huawei.com


   Dacheng Zhang
   Huawei

   Email: dacheng.zhang@huawei.com




Xia, et al.            Expires September 14, 2017              [Page 24]

Internet-Draft            IM for NSF Monitoring               March 2017


   Yi Wu
   Aliababa Group

   Email: anren.wy@alibaba-inc.com


   Rakesh Kumar
   Juniper Networks

   Email: rkkumar@juniper.net


   Anil Lohiya
   Juniper Networks

   Email: alohiya@juniper.net


   Henk Birkholz
   Fraunhofer SIT

   Email: henk.birkholz@sit.fraunhofer.de





























Xia, et al.            Expires September 14, 2017              [Page 25]
