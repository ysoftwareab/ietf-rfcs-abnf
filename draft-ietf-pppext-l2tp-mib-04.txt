PPP Working Group                                              Evan Caves
INTERNET DRAFT                                                   Ericsson
Category: Internet Draft                                   Pat R. Calhoun
Title: draft-ietf-pppext-l2tp-mib-04.txt                 Sun Microsystems
Date: June 1999                                              Ross Wheeler
                                                               RouterWare

                  Layer Two Tunneling Protocol "L2TP"
                      Management Information Base
                  <draft-ietf-pppext-l2tp-mib-04.txt>

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   Copyright Notice

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

Abstract

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in TCP/IP-based internets.
   In particular, it defines objects for managing networks using Layer 2
   Tunneling Protocol.

   This memo specifies a MIB module in a manner that is both compliant

expires November 1999                                           [Page 1]

Internet Draft                                                 June 1999

   to the SNMPv2 SMI, and semantically identical to the peer SNMPv1
   definitions.

Table of Contents

      1.0  Introduction   .........................................  2
      1.1  Change Log .............................................  2

      2.0  The SNMP Management Framework ..........................  4

      3.0  Overview ...............................................  5
      3.1  Relationship to the Interface MIB ......................  6
      3.1.1  Layering Model .......................................  6
      3.1.2  Interface MIB Objects ................................  9
      3.1.2.1  L2TP Tunnel Interfaces .............................  9
      3.2  Relationship to other MIBs ............................. 11
      3.2.1  Relationship to the IP Tunnel MIB .................... 11
      3.3  L2TP Tunnel Creation ................................... 11

      4.0  L2TP Object Definitions ................................ 12

      5.0  Security Considerations ................................ 62

      6.0  Acknowledgements ....................................... 62

      7.0  Authors' Addresses ..................................... 62

      8.0  References ............................................. 63

      9.0  Full Copyright Statement ............................... 65

1.0 Introduction

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet Community.
   In particular, it describes managed objects used for managing L2TP
   devices.

1.1 Change Log

   This section tracks changes made to the revisions of the Internet
   Drafts of this document.  It will be *deleted* when the document is
   published as an RFC.

expires November 1999                                           [Page 2]

Internet Draft                                                 June 1999

   3 November 1997

   The following changes were made for the version of the document dated
   3 November 1997. These changes were made at the request of the L2TP
   working group.

   (1)  Removed L2TP protocol stack instancing.

   (2)  Tunnel and Session table now extensions of ifTable.

   (3)  Added IP/UDP transport tables.

   (4)  Several objects were removed and a number of new
        objects added.

   (5)  Sections 1.1, 2.1, 3.0, 5.0 and 6.0 added.

   (6)  Module Compliance information added.

   27 July 1998

   The following changes were made for the version of the document dated
   27 July 1998. These changes were made as a result of the L2TP MIB
   presentation during the forty-first IETF in Los Angeles.

   (1) Added Tunnel Domain configuration and stats tables.

   (2) Moved most of the scalar configuration and stats objects
       into the Tunnel Domain tables.

   (3) Redundant objects removed.

   (4) Some re-organization and object naming clarifications.

   (5) Updated section 2.0

   (6) Introduction of L2TP notifications

   (7) Removed l2tpUdpConfigTable in favour of the tunnelConfigTable

   (8) Updated section 3.0

   3 November 1998

   The following changes were made for the version of the document dated
   3 Novemer 1998. These changes were made as a result of the L2TP MIB
   presentation during the forty-second IETF in Chicago.

expires November 1999                                           [Page 3]

Internet Draft                                                 June 1999

   1) A PPP session within a tunnel is no longer represented as a
      seperate interface that is visible in the ifTable.

   2) The Layering Model in section 3.1.1 has been updated to
      reflect that sessions are not seperate interfaces.

   3) Section 3.1.2.2 'L2TP Session Interfaces' has been removed.

   4) Tunnel authentication shared secret objects have been added
      to the l2tpDomainConfigTable and l2tpTunnelConfigTable.

   5) The l2tpSessionStatsTable indexing has changed to reflect
      that sessions are not seperate interfaces.

   6) A mapping table has been added to assist management
      applications in quickly locating session statistics.

   7) The objects l2tpUdpStatsAddressChanges and
      l2tpUdpStatsPortChanges have been removed.

   8) The l2tpUdpAddressingChange notification has been
      removed.

   9) Updated tunnel/session Bearer and Framing capability
      object enumerations.

   25 June 1999

   The following changes were made for the version of the document dated
   25 June 1999. These changes were made as a result of the changes made
   to the base L2TP protocol which commenced from draft-ietf-pppext-
   l2tp-13.txt and onwards.

   1) Updated 'Status of this Memo' to conform to latest text.

   2) Added Copyright Notice and Statement.

   3) Updated 'The SNMP Management Framework' section.

   4) Removed objects related to payload flow control.

2.0 The SNMP Management Framework

   The SNMP Management Framework presently consists of five major
   components:

   o    An overall architecture, described in RFC 2271 [1].

expires November 1999                                           [Page 4]

Internet Draft                                                 June 1999

   o    Mechanisms for describing and naming objects and
        events for the purpose of management.  The first
        version of this Structure of Management Information
        (SMI) is called SMIv1 and described in RFC 1155 [2],
        RFC 1212 [3] and RFC 1215 [4].  The second version,
        called SMIv2, is described in RFC 2578 [5],
        RFC 2579 [6] and RFC 2580 [7].

   o    Message protocols for transferring management
        information.  The first version of the SNMP
        message protocol is called SNMPv1 and described in
        RFC 1157 [8].  A second version of the SNMP message
        protocol, which is not an Internet standards track
        protocol, is called SNMPv2c and described in
        RFC 1901 [9] and RFC 1905 [13].  The third version
        of the message protocol is called SNMPv3 and
        described in RFC 1906 [10], RFC 2572 [11] and
        RFC 2574 [12].

   o    Protocol operations for accessing management
        information.  The first set of protocol operations
        and associated PDU formats is described in
        RFC 1157 [8].  A second set of protocol operations
        and associated PDU formats is described in
        RFC 1905 [13].

   o    A set of fundamental applications described in
        RFC 2573 [14] and the view-based access control
        mechanism described in RFC 2575 [15].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  Objects in the MIB are
   defined using the mechanisms defined in the SMI.

   This memo specifies a MIB module that is compliant to the SMIv2.  A
   MIB conforming to the SMIv1 can be produced through the appropriate
   translations.  The resulting translated MIB must be semantically
   equivalent, except where objects or events are omitted because no
   translation is possible (e.g., use of Counter64).  Some machine
   readable information in SMIv2 will be converted into textual
   descriptions in SMIv1 during the translation process.  However, this
   loss of machine readable information is not considered to change the
   semantics of the MIB.

3.0 Overview

   The objects defined in this MIB are to be used when describing Layer

expires November 1999                                           [Page 5]

Internet Draft                                                 June 1999

   Two Tunneling Protocol (L2TP) tunnels. The L2TP protocol is defined
   in [16]. This MIB consists of four groups briefly described below:

   l2tpConfigGroup
   l2tpStatsGroup
      These two groups of objects provide information on the
      configuration, state and statistics of the L2TP protocol, its
      tunnels and sessions.  These groups are mandatory for implementors
      of this MIB.

   l2tpDomainGroup
      This optional group of objects provides configuration, state and
      statistical information for L2TP tunnel endpoint domains. A L2TP
      tunnel endpoint domain is considered to be a  collection of L2TP
      devices typically belonging to a common administrative domain or
      geographic location.

   l2tpMappingGroup
      This optional group contains mapping tables to assist management
      applications to map between protocol identifiers and table
      indeces.

   l2tpIpUdpGroup
      This group provides the state and statistics information for L2TP
      tunnels which are being transported by IP/UDP. This group is
      mandatory for L2TP implementations that support L2TP over IP/UDP.

3.1 Relationship to the Interface MIB

   This section clarifies the relationship of this MIB to the Interfaces
   MIB [17]. Several areas of correlation are addressed in the following
   subsections.  The implementor is referred to the Interfaces MIB
   document in order to understand the general intent of these areas.

3.1.1  Layering Model

   This MIB contains several tables which are extensions to the IP
   Tunnel MIB described in [18] which itself defines extensions to the
   Interface MIB [17]. A L2TP tunnel is represented as a separate
   identifiable logical interface sub-layer. The tunnel interface appear
   in the ifStackTable at different sub-layers depending on the
   functionality the tunnel endpoint is providing.

   At the LAC end of a tunnel endpoint the tunnel interface appears
   above the session interfaces. At the LNS end of a tunnel endpoint the
   tunnel interface appears below the session interfaces.

expires November 1999                                           [Page 6]

Internet Draft                                                 June 1999

   In the example diagram below, the interface layering is shown as it
   appears at the LNS. Note that the L2TP tunnel interface is at the
   bottom of the interface stack when the transport layer for L2TP is
   IP/UDP. This is because tunneled traffic is forwarded to its
   destination based on routing policy. However L2TP over transports
   other than IP/UDP may define further sub-layer interfaces below the
   tunnel interface.

       +-------------------------------------------------+
       |             Network Layer Protocol              |
       +-------------+-------------+--------+------------+
                     |             |        |
                   +-+--+          |        |
                   |MPPP|          |        |      <=== PPP Multilink I/F
                   ++--++          |        |
                    |  |           |        |
                 +--+  +--+        |        |
                 |        |        |        |
               +-+-+    +-+-+    +-+-+    +-+-+
               |PPP|    |PPP|    |PPP|    |PPP|    <=== PPP I/F
               +-+-+    +-+-+    +-+-+    +-+-+
                 |        |        |        |
       +---------+--------+--------+--------+------------+
       |                L2TP Tunnel I/F                  |
       +-------------------------------------------------+

   The ifStackTable is used to describe the layering of the interface
   sub-layers.  For the example given above the ifTable and ifStackTable
   may appear as follows:

   ifIndex ifType        Tunnel MIB tables       Description

      1    tunnel(131)   tunnelIfTable           Tunnel interface
                         l2tpTunnelConfigTable
                         l2tpTunnelStatsTable
      2    ppp(23)                               PPP interface #1
      3    ppp(23)                               PPP interface #2
      4    ppp(23)                               PPP interface #3
      5    ppp(23)                               PPP interface #4
      6    mlppp(108)                            MLPPP interface

   The corresponding ifStack table entries would then be:

           ifStackTable Entries

           HigherLayer  LowerLayer
           0            4

expires November 1999                                           [Page 7]

Internet Draft                                                 June 1999

           0            5
           0            6
           1            0
           2            1
           3            1
           4            1
           5            1
           6            2
           6            3

   The following example diagram illustrates the interface layering as
   it might occur at the LAC. In this case the tunnel interface is at
   the top of the interface stack for L2TP over IP/UDP.

       +-------------------------------------------------+
       |                L2TP Tunnel I/F                  |
       +---------+--------+--------+--------+------------+
                 |        |        |        |
               +-+-+    +-+-+    +-+-+    +-+-+
               |ds0|    |ds0|    |ds0|    |ds0|    <=== B channels I/F
               +-+-+    +-+-+    +-+-+    +-+-+
                 |        |        |        |
       +---------+--------+--------+--------+------------+
       |                      ds1                        |
       +-------------------------------------------------+

   For the example given above the ifTable and ifStackTable may appear
   as follows:

   ifIndex ifType       Tunnel MIB tables       Description

      1    ds1(18)                              Primary Rate physical
interface
      2    ds0(81)                              B channel #1
      3    ds0(81)                              B channel #2
      4    ds0(81)                              B channel #3
      5    ds0(81)                              B channel #4
      6    tunnel(131)  tunnelIfTable           Tunnel Interface
                        l2tpTunnelConfigTable
                        l2tpTunnelStatsTable

   The corresponding ifStack table entries would then be:

           ifStackTable Entries

           HigherLayer  LowerLayer
           0            6

expires November 1999                                           [Page 8]

Internet Draft                                                 June 1999

           1            0
           2            1
           3            1
           4            1
           5            1
           6            2
           6            3
           6            4
           6            5

3.1.2  Interface MIB Objects

   Except where noted in the tables below, all objects MUST be supported
   from the ifGeneralInformationGroup and one of the following three groups:

      o ifPacketGroup OR
      o ifHCPacketGroup OR
      o ifVHCPacketGroup

   depending on the particular implementation.

   The following tables describe how objects from the
ifGeneralInformationGroup
   and ifPacketGroup (similar support should be provided for the high and
very
   high capacity packet groups) are to be interpreted and supported for L2TP
   tunnel interfaces.

3.1.2.1  L2TP Tunnel Interfaces

   All Interface MIB objects not listed in the above groups for L2TP tunnel
   interfaces MUST be supported as described in [17].

      Interface MIB Object    Support Description
      ====================    =======================================
      ifTable.ifDescr         Refer to the Interface MIB.

      ifTable.ifType          tunnel(131)

      ifTable.ifMtu           Dependant on the tunnel transport layer.
                              For IP/UDP transports the MTU should
                              be 65467 (65535-60(IP)-8(UDP))

      ifTable.ifSpeed         Return zero.

      ifTable.ifPhyAddress    The assigned tunnel identifier.

      ifTable.ifAdminStatus   All enumerated values supported as per

expires November 1999                                           [Page 9]

Internet Draft                                                 June 1999

                              DESCRIPTION clause in the Interfaces MIB.

      ifTable.ifOperStatus    All status events supported. Refer to the
                              Interfaces MIB.

      ifTable.ifInOctets      The total number of octets received on the
                              tunnel including control and payload
                              octets.

      ifTable.ifInUcastPkts   The total number of packets received on
                              the tunnel including control and payload
                              packets.

      ifTable.ifInDiscards    The total number of received packets that
                              were discarded on both control and payload
                              channels.

      ifTable.ifInErrors      The total number of packets received in
                              error including control and payload
                              packets.

      ifTable.ifInUnknownProtos
                              Return zero.

      ifTable.ifOutOctets     The total number of octets transmitted from
                              the tunnel including control and payload
                              octets.

      ifTable.ifOutUcastPkts  The total number of packets transmitted from
                              the tunnel including control and payload
                              packets.

      ifTable.ifOutDiscards   The total number of discarded packets that
                              were requested to be transmitted including
                              control and payload packets.

      ifTable.ifOutErrors     The total number of packets that were
requested
                              to be transmitted that were in error including
                              control and payload packets.

      ifXTable.ifName         Refer to the Interface MIB.

      ifXTable.ifInMulticastPkts
                              Return zero.

      ifXTable.ifInBroadcastPkts
                              Return zero.

expires November 1999                                          [Page 10]

Internet Draft                                                 June 1999

      ifXTable.ifOutMulticastPkts
                              Return zero.

      ifXTable.ifOutBroadcastPkts
                              Return zero.

      ifXTable.ifOutBroadcastPkts
                              Return zero.

      ifXTable.ifLinkUpDownTrapEnable
                              Default set to enabled(1).

      ifXTable.ifHighSpeed    Return zero.

      ifXTable.ifPromiscuousMode
                              Set to false(2).

      ifXTable.ifConnectorPresent
                              Set to false(2).

3.2  Relationship to other MIBs

3.2.1  Relationship to the IP Tunnel MIB

   The IP Tunnel MIB [18] describes tunnel interfaces that have an ifType
   of tunnel(131). The IP Tunnel MIB is considered to contain a collection
of
   objects common to all IP tunneling protocols, including L2TP. In addition
   to the IP Tunnel MIB, tunnel encapsulation specific MIBs (like this MIB)
   extend the IP Tunnel MIB to further describe encapsulation specific
   information. Implementation of the IP Tunnel MIB is required for L2TP
   tunnels over IP.

3.3  L2TP Tunnel Creation

   Tunnel creation is detailed for IP tunnels in the IP Tunnel MIB. The
   creation of a tunnelIfEntry in [18] will have the side affect of
   creating entries in the l2tpTunnelConfigTable, l2tpTunnelStatsTable
   and the l2tpUdpStatsTable's.

   The creation of L2TP tunnel interfaces over transports other than IP
   is expected to be defined in the MIB definition for that specific
   L2TP tunnel transport.

expires November 1999                                          [Page 11]

Internet Draft                                                 June 1999

4.0 L2TP Object Definitions

   L2TP-MIB DEFINITIONS ::= BEGIN

   IMPORTS
           Integer32, Counter32, experimental, Gauge32,
           MODULE-IDENTITY, OBJECT-TYPE, NOTIFICATION-TYPE
               FROM SNMPv2-SMI
           TEXTUAL-CONVENTION, DisplayString, RowStatus, TruthValue
               FROM SNMPv2-TC
           OBJECT-GROUP, MODULE-COMPLIANCE
               FROM SNMPv2-CONF
           InterfaceIndex
               FROM IF-MIB;

   l2tp    MODULE-IDENTITY
           LAST-UPDATED    "9906211800Z"
           ORGANIZATION    "IETF L2TP Working Group"
           CONTACT-INFO
             "Evan Caves
              Postal: Ericsson
                      340 Storke Road
                      Santa Barbara, CA, 93117
              Tel:    +1 805685 4455
              Email:  evan@acc.com

              Pat R. Calhoun
              Postal: Sun Microsystems, Inc.
                      15 Network Circle
                      Menlo Park, CA, 94025
              Tel:    +1 650786 7733
              Email:  pcalhoun@eng.sun.com

              Ross Wheeler
              Postal: RouterWare
                      3961 MacArthur Blvd, Suite 212
                      Newport Beach, CA, 92660
              Tel:    +1 714442 0770
              Email:  ross@routerware.com"
           DESCRIPTION
              "The MIB module that describes managed objects of
               general use by the Layer Two Transport Protocol."
           ::= { experimental 9999 1 }

expires November 1999                                          [Page 12]

Internet Draft                                                 June 1999

   --
   --      Textual Conventions
   --

   MilliSeconds ::=  TEXTUAL-CONVENTION
           DISPLAY-HINT    "d-3"
           STATUS          current
           DESCRIPTION
              "A period of time measured in units of .001 of seconds
               when used in conjunction with the DISPLAY-HINT will
               show seconds and fractions of second with a resolution
               of .001 of a second."
           SYNTAX          Integer32 (0..2147483646)

expires November 1999                                          [Page 13]

Internet Draft                                                 June 1999

   --
   --      Definitions of significant branches
   --
   l2tpObjects         OBJECT IDENTIFIER  ::= { l2tp 1 }
   l2tpTraps           OBJECT IDENTIFIER  ::= { l2tp 2 }
   l2tpTransports      OBJECT IDENTIFIER  ::= { l2tp 3 }
   l2tpConformance     OBJECT IDENTIFIER  ::= { l2tp 4 }

   --
   --      Definitions of significant branches under l2tpObjects
   --
   l2tpScalar          OBJECT IDENTIFIER  ::= { l2tpObjects 1 }
   l2tpConfig          OBJECT IDENTIFIER  ::= { l2tpScalar 1 }
   l2tpStats           OBJECT IDENTIFIER  ::= { l2tpScalar 2 }

   --
   --      Definitions of significant branches under l2tpTransports
   --
   l2tpTransportIpUdp  OBJECT IDENTIFIER  ::= { l2tpTransports 1 }
   l2tpIpUdpObjects    OBJECT IDENTIFIER  ::= { l2tpTransportIpUdp 1 }
   l2tpIpUdpTraps      OBJECT IDENTIFIER  ::= { l2tpTransportIpUdp 2 }

expires November 1999                                          [Page 14]

Internet Draft                                                 June 1999

   --
   --      The L2TP Scalar Configuration Group
   --
   --      This group of objects is used to manage configuration
   --      of the L2TP protocol environment.

   l2pAdminState           OBJECT-TYPE
           SYNTAX          INTEGER {
                               enabled(1),
                               disabled(2),
                               drain(3)
                           }
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines the administrative state of
               this L2TP tunnel domain. Setting this object to
               'disabled' causes all tunnels to be immediately
               disconnected and no further tunnels to be either
               initiated or accepted. Setting this object to
               'drain' will prevent any new tunnels and/or
               sessions to be either initiated or accepted but
               does NOT disconnect any active tunnels/sessions."
           DEFVAL { enabled }
           ::= { l2tpConfig 1 }

expires November 1999                                          [Page 15]

Internet Draft                                                 June 1999

   --
   --      The L2TP Scalar Status and Statistics Group
   --
   --      This group of objects describe the current state and
   --      statistics of L2TP.

   l2tpProtocolVersion     OBJECT-TYPE
           SYNTAX          OCTET STRING (SIZE(2..256))
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
               "Vector of supported L2TP protocol version and
                revision numbers. Supported versions are identified
                via a two octet pairing where the first octet indicates
                the version and the second octet contains the revision."
           ::= { l2tpStats 1 }

   l2tpVendorName          OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the Vendor name of the L2TP
               protocol stack."
           ::= { l2tpStats 2 }

   l2tpFirmwareRev         OBJECT-TYPE
           SYNTAX          Integer32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object defines the firmware revision for the
               L2TP protocol stack."
           ::= { l2tpStats 3 }

expires November 1999                                          [Page 16]

Internet Draft                                                 June 1999

   --
   --      The L2TP Domain Configuration Table
   --
   --      This table contains objects that can be used to
   --      configure the operational characteristics of a tunnel
   --      domain.

   l2tpDomainConfigTable   OBJECT-TYPE
           SYNTAX          SEQUENCE OF L2tpDomainConfigEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "The L2TP Domain configuration table."
           ::= { l2tpObjects 2 }

   l2tpDomainConfigEntry   OBJECT-TYPE
           SYNTAX          L2tpDomainConfigEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "An L2TP Domain configuration entry. An entry in this
               table may correspond to a single endpoint or a group
               of tunnel endpoints."
           INDEX { IMPLIED l2tpDomainConfigIdentifier }
           ::= { l2tpDomainConfigTable 1 }

   L2tpDomainConfigEntry ::=
           SEQUENCE {
               l2tpDomainConfigIdentifier
                   DisplayString,
               l2pDomainConfigAdminState
                   INTEGER,
               l2tpDomainConfigAuthentication
                   INTEGER,
               l2tpDomainConfigSecret
                   OCTET STRING,
               l2tpDomainConfigTunnelSecurity
                   INTEGER,
               l2tpDomainConfigTunnelHelloInterval
                   Integer32,
               l2tpDomainConfigTunnelIdleTimeout
                   Integer32,
               l2tpDomainConfigControlRWS
                   Integer32,
               l2tpDomainConfigControlRetransmissions
                   Integer32,
               l2tpDomainConfigPayloadSequencing
                   INTEGER,

expires November 1999                                          [Page 17]

Internet Draft                                                 June 1999

               l2tpDomainConfigReassemblyTimeout
                   MilliSeconds,
               l2tpDomainConfigStatus
                   RowStatus
           }

   l2tpDomainConfigIdentifier  OBJECT-TYPE
           SYNTAX          DisplayString (SIZE (1..255))
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "The identifier, usually in the form of a Domain
               Name (full or partial), describing a single tunnel
               endpoint or a domain of tunnel endpoints. This is
               typically used as a 'handle' to identify the
               tunnel configuration requirements for both incoming
               and outgoing tunnel connection attempts. Both the
               LAC and  LNS could use information provided in the
               Host Name AVP however the tunnel initiator could use
               other means not specified to identify the domains
               tunnel configuration requirements."
           ::= { l2tpDomainConfigEntry 1 }

   l2pDomainConfigAdminState  OBJECT-TYPE
           SYNTAX          INTEGER {
                               enabled(1),
                               disabled(2),
                               drain(3)
                           }
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object defines the administrative state of this
               tunnel domain. Setting this object to disabled(2)
               causes all tunnels to be immediately disconnected
               and no further tunnels to be either initiated or
               accepted. Setting this object to drain(3) will prevent
               any new tunnels and/or sessions to be either initiated
               or accepted but does NOT forcibly disconnect any
               active tunnels and/or sessions."
           DEFVAL { enabled }
           ::= { l2tpDomainConfigEntry 2 }

   l2tpDomainConfigAuthentication  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               simple(2),
                               challenge(3)

expires November 1999                                          [Page 18]

Internet Draft                                                 June 1999

                           }
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object describes how tunnel peers belonging
               to this domain are to be authenticated. The value
               simple(2) indicates that peers are authenticated simply
               by their host name as described in the Host Name AVP.
               The value challenge(3) indicates that all peers are
               challenged to prove their identification. This mechanism
               is described in the L2TP protocol."
           DEFVAL { none }
           ::= { l2tpDomainConfigEntry 3 }

   l2tpDomainConfigSecret  OBJECT-TYPE
           SYNTAX          OCTET STRING (SIZE (0..255))
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object is used to configure the shared secret
               used during the tunnel authentication phase of
               tunnel establishment. NOTE that this object should
               not be visible if the proper SNMPv3 security
               mechanisms are in place."
           ::= { l2tpDomainConfigEntry 4 }

   l2tpDomainConfigTunnelSecurity  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               other(2),
                               ipSec(3)
                           }
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object defines whether this tunnel domain
               requires that all tunnels are to be secured. The
               value of ipsec(3) indicates that all tunnel packets,
               control and session, have IP Security headers. The
               type of IP Security headers (AH, ESP etc) and how
               they are further described is outside the scope of
               this document."
           DEFVAL { none }
           ::= { l2tpDomainConfigEntry 5 }

   l2tpDomainConfigTunnelHelloInterval  OBJECT-TYPE
           SYNTAX          Integer32 (0..3600)
           MAX-ACCESS      read-create

expires November 1999                                          [Page 19]

Internet Draft                                                 June 1999

           STATUS          current
           DESCRIPTION
              "This object defines the interval (in seconds) in
               which Hello (or keep-alive) packets are to be sent
               by local peers belonging to this tunnel domain."
           DEFVAL { 60 }
           ::= { l2tpDomainConfigEntry 6 }

   l2tpDomainConfigTunnelIdleTimeout  OBJECT-TYPE
           SYNTAX          Integer32 (0..86400)
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object defines the period of time (in seconds)
               that an established tunnel belonging to this tunnel
               domain with no active sessions will wait before
               disconnecting the tunnel. A value of zero indicates
               that the tunnel will disconnect immediately after the
               last session disconnects."
           DEFVAL { 0 }
           ::= { l2tpDomainConfigEntry 7 }

   l2tpDomainConfigControlRWS  OBJECT-TYPE
           SYNTAX          Integer32 (1..64)
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object defines the control channel receive
               window size for tunnels belonging to this domain. It
               specifies the maximum number of packets the tunnel
               peer belonging to this domain can send without waiting
               for an acknowledgement from this peer."
           DEFVAL { 4 }
           ::= { l2tpDomainConfigEntry 8 }

   l2tpDomainConfigControlRetransmissions  OBJECT-TYPE
           SYNTAX          Integer32 (0..32)
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object defines the number of retransmission's
               which the L2TP stack will attempt for tunnels belonging
               to this domain before assuming that the peer is no
               longer responding."
           DEFVAL { 4 }
           ::= { l2tpDomainConfigEntry 9 }

   l2tpDomainConfigPayloadSequencing  OBJECT-TYPE

expires November 1999                                          [Page 20]

Internet Draft                                                 June 1999

           SYNTAX          INTEGER {
                               onDemand(1),
                               never(2),
                               always(3)
                           }
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object determines whether or not session payload
               packets will be requested to be sent with sequence
               numbers from tunnel peer's belonging to this domain."
           DEFVAL { onDemand }
           ::= { l2tpDomainConfigEntry 10 }

   l2tpDomainConfigReassemblyTimeout  OBJECT-TYPE
           SYNTAX          MilliSeconds
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "This object defines the number of milliseconds that
               local peer's of this tunnel domain will wait before
               processing packets that were received out of sequence
               (which are waiting for the packet(s) to put them in
               sequence).  A low value increases the chance of delayed
               packets to be discarded (which MAY causes the PPP
               decompression engine to reset) while a high value may
               cause more queueing and possibly degrade throughput if
               packets are truly lost. The default value for this
               object is zero which will result in all delayed packets
               being lost."
           DEFVAL { 0 }
           ::= { l2tpDomainConfigEntry 11 }

   l2tpDomainConfigStatus  OBJECT-TYPE
           SYNTAX          RowStatus
           MAX-ACCESS      read-create
           STATUS          current
           DESCRIPTION
              "The status of this Domain entry."
           ::= { l2tpDomainConfigEntry 12 }

expires November 1999                                          [Page 21]

Internet Draft                                                 June 1999

   --
   --      The L2TP Domain Status and Statistics Table
   --
   --      This table contains objects that can be used to desribe
   --      the current status and statistics of a tunnel domain.

   l2tpDomainStatsTable OBJECT-TYPE
           SYNTAX          SEQUENCE OF L2tpDomainStatsEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "The L2TP Domain Status and Statistics table."
           ::= { l2tpObjects 3 }

   l2tpDomainStatsEntry OBJECT-TYPE
           SYNTAX          L2tpDomainStatsEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "An L2TP Domain Stats entry. An entry in this table
               may correspond to a single endpoint or a group of
               tunnel endpoints."
           INDEX { IMPLIED l2tpDomainStatsIdentifier }
           ::= { l2tpDomainStatsTable 1 }

   L2tpDomainStatsEntry ::=
           SEQUENCE {
               l2tpDomainStatsIdentifier
                   DisplayString,
               l2tpDomainStatsTotalTunnels
                   Counter32,
               l2tpDomainStatsFailedTunnels
                   Counter32,
               l2tpDomainStatsFailedAuthentications
                   Counter32,
               l2tpDomainStatsActiveTunnels
                   Gauge32,
               l2tpDomainStatsTotalSessions
                   Counter32,
               l2tpDomainStatsFailedSessions
                   Counter32,
               l2tpDomainStatsActiveSessions
                   Gauge32,
               l2tpDomainStatsControlRecvOctets
                   Counter32,
               l2tpDomainStatsControlRecvPackets
                   Counter32,
               l2tpDomainStatsControlSendOctets

expires November 1999                                          [Page 22]

Internet Draft                                                 June 1999

                   Counter32,
               l2tpDomainStatsControlSendPackets
                   Counter32,
               l2tpDomainStatsPayloadRecvOctets
                   Counter32,
               l2tpDomainStatsPayloadRecvPackets
                   Counter32,
               l2tpDomainStatsPayloadRecvDiscards
                   Counter32,
               l2tpDomainStatsPayloadSendOctets
                   Counter32,
               l2tpDomainStatsPayloadSendPackets
                   Counter32
           }

   l2tpDomainStatsIdentifier  OBJECT-TYPE
           SYNTAX          DisplayString (SIZE (1..255))
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "The identifier, usually in the form of a Domain
               Name (full or partial), describing a single tunnel
               endpoint or a domain of tunnel endpoints."
           ::= { l2tpDomainStatsEntry 1 }

   l2tpDomainStatsTotalTunnels  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the total number of tunnels
               that have successfully reached the established
               state for this tunnel domain."
           ::= { l2tpDomainStatsEntry 2 }

   l2tpDomainStatsFailedTunnels  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of tunnels that
               failed to reach the established state for this
               tunnel domain."
           ::= { l2tpDomainStatsEntry 3 }

   l2tpDomainStatsFailedAuthentications OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only

expires November 1999                                          [Page 23]

Internet Draft                                                 June 1999

           STATUS          current
           DESCRIPTION
              "This object returns the number of failed tunnel
               connection attempts for this domain because the
               tunnel peer failed authentication."
           ::= { l2tpDomainStatsEntry 4 }

   l2tpDomainStatsActiveTunnels  OBJECT-TYPE
           SYNTAX          Gauge32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of tunnels that
               are currently active for this domain."
           ::= { l2tpDomainStatsEntry 5 }

   l2tpDomainStatsTotalSessions  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the total number of sessions
               that have successfully reached the established state
               for this tunnel domain."
           ::= { l2tpDomainStatsEntry 6 }

   l2tpDomainStatsFailedSessions  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of sessions that
               failed to reach the established state for this
               tunnel domain."
           ::= { l2tpDomainStatsEntry 7 }

   l2tpDomainStatsActiveSessions  OBJECT-TYPE
           SYNTAX          Gauge32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of sessions that
               are currently active for this domain."
           ::= { l2tpDomainStatsEntry 8 }

   l2tpDomainStatsControlRecvOctets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only

expires November 1999                                          [Page 24]

Internet Draft                                                 June 1999

           STATUS          current
           DESCRIPTION
              "This object returns the number of control channel
               octets received for this tunnel domain."
           ::= { l2tpDomainStatsEntry 9 }

   l2tpDomainStatsControlRecvPackets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of control packets
               received for this tunnel domain."
           ::= { l2tpDomainStatsEntry 10 }

   l2tpDomainStatsControlSendOctets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of control channel
               octets that were transmitted to tunnel endpoints
               for this domain."
           ::= { l2tpDomainStatsEntry 11 }

   l2tpDomainStatsControlSendPackets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of control packets
               that were transmitted to tunnel endpoints for
               this domain."
           ::= { l2tpDomainStatsEntry 12 }

   l2tpDomainStatsPayloadRecvOctets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of payload channel
               octets that were received for this tunnel domain."
           ::= { l2tpDomainStatsEntry 13 }

   l2tpDomainStatsPayloadRecvPackets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current

expires November 1999                                          [Page 25]

Internet Draft                                                 June 1999

           DESCRIPTION
              "This object returns the number of payload packets
               that were received for this tunnel domain."
           ::= { l2tpDomainStatsEntry 14 }

   l2tpDomainStatsPayloadRecvDiscards  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of received payload
               packets that were discarded by this this tunnel
               domain."
           ::= { l2tpDomainStatsEntry 15 }

   l2tpDomainStatsPayloadSendOctets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of payload channel
               octets that were transmitted to tunnel peers
               within this tunnel domain."
           ::= { l2tpDomainStatsEntry 16 }

   l2tpDomainStatsPayloadSendPackets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of payload packets
               that were transmitted to tunnel peers within
               this tunnel domain."
           ::= { l2tpDomainStatsEntry 17 }

expires November 1999                                          [Page 26]

Internet Draft                                                 June 1999

   --
   --      The L2TP Tunnel Configuration Table
   --
   --      This table contains objects that can be used to
   --      (re)configure the operational characteristics of a
   --      single L2TP tunnel.

   l2tpTunnelConfigTable   OBJECT-TYPE
           SYNTAX          SEQUENCE OF L2tpTunnelConfigEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "The L2TP tunnel configuration table."
           ::= { l2tpObjects 4 }

   l2tpTunnelConfigEntry   OBJECT-TYPE
           SYNTAX          L2tpTunnelConfigEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "A L2TP tunnel interface configuration entry."
           INDEX { l2tpTunnelConfigIfIndex }
           ::= { l2tpTunnelConfigTable 1 }

   L2tpTunnelConfigEntry ::=
           SEQUENCE {
               l2tpTunnelConfigIfIndex
                   InterfaceIndex,
               l2tpTunnelConfigAuthentication
                   INTEGER,
               l2tpTunnelConfigSecret
                   OCTET STRING,
               l2tpTunnelConfigSecurity
                   INTEGER,
               l2tpTunnelConfigHelloInterval
                   Integer32,
               l2tpTunnelConfigIdleTimeout
                   Integer32,
               l2tpTunnelConfigControlRWS
                   Integer32,
               l2tpTunnelConfigControlRetransmissions
                   Integer32,
               l2tpTunnelConfigPayloadSequencing
                   INTEGER,
               l2tpTunnelConfigReassemblyTimeout
                   MilliSeconds,
               l2tpTunnelConfigTransport
                   INTEGER

expires November 1999                                          [Page 27]

Internet Draft                                                 June 1999

           }

   l2tpTunnelConfigIfIndex OBJECT-TYPE
           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This value for this object is equal to the value
               of ifIndex of the Interfaces MIB for tunnel
               interfaces of type L2TP."
           ::= { l2tpTunnelConfigEntry 1 }

   l2tpTunnelConfigAuthentication  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               simple(2),
                               challenge(3)
                           }
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object describes how L2TP tunnel peers are
               to be authenticated. The value 'simple' indicates
               that peers are authenticated simply by their host
               name as described in the Host Name AVP. The value
               'challenge' indicates that all peers are challenged
               to prove their identification. This mechanism is
               described in the L2TP protocol."
           DEFVAL { none }
           ::= { l2tpTunnelConfigEntry 2 }

   l2tpTunnelConfigSecret  OBJECT-TYPE
           SYNTAX          OCTET STRING (SIZE (0..255))
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object is used to configure the shared secret
               used during the tunnel authentication phase of
               tunnel establishment. NOTE that this object should
               not be visible if the proper SNMPv3 security
               mechanisms are in place."
           ::= { l2tpTunnelConfigEntry 3 }

   l2tpTunnelConfigSecurity  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               other(2),
                               ipsec(3)

expires November 1999                                          [Page 28]

Internet Draft                                                 June 1999

                           }
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines whether this tunnel is to be
               secured. The value of 'ipSec' indicates that all
               tunnel packets, control and session, have IP
               Security headers. The type of IP Security headers
               (AH, ESP etc) and how they are further described
               is outside the scope of this document."
           DEFVAL { none }
           ::= { l2tpTunnelConfigEntry 4 }

   l2tpTunnelConfigHelloInterval  OBJECT-TYPE
           SYNTAX          Integer32  (0..3600)
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines the interval (in seconds) in
               which Hello (or keep-alive) packets are to be sent
               to the tunnel peer."
           DEFVAL { 60 }
           ::= { l2tpTunnelConfigEntry 5 }

   l2tpTunnelConfigIdleTimeout  OBJECT-TYPE
           SYNTAX          Integer32 (0..86400)
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines the period of time (in seconds)
               that an established tunnel with no sessions will
               wait before disconnecting the tunnel. A value of
               zero indicates that the tunnel will disconnect
               immediately after the last session disconnects."
           DEFVAL { 0 }
           ::= { l2tpTunnelConfigEntry 6 }

   l2tpTunnelConfigControlRWS  OBJECT-TYPE
           SYNTAX          Integer32 (1..64)
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines the control channel receive
               window size. It specifies the maximum number of
               packets the tunnel peer can send without waiting
               for an acknowledgement from this peer."
           DEFVAL { 4 }
           ::= { l2tpTunnelConfigEntry 7 }

expires November 1999                                          [Page 29]

Internet Draft                                                 June 1999

   l2tpTunnelConfigControlRetransmissions  OBJECT-TYPE
           SYNTAX          Integer32 (0..32)
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines the number of retransmission's
               which the tunnel will attempt before assuming that
               the peer is no longer responding. A value of zero
               indicates that this peer will not attempt to
               retransmit an unacknowledged control packet."
           DEFVAL { 4 }
           ::= { l2tpTunnelConfigEntry 8 }

   l2tpTunnelConfigPayloadSequencing  OBJECT-TYPE
           SYNTAX          INTEGER {
                               onDemand(1),
                               never(2),
                               always(3)
                           }
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object determines whether or not session payload
               packets will be requested to be sent with sequence
               numbers from the tunnel peer."
           DEFVAL { onDemand }
           ::= { l2tpTunnelConfigEntry 9 }

   l2tpTunnelConfigReassemblyTimeout  OBJECT-TYPE
           SYNTAX          MilliSeconds
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines the number of milliseconds that
               this tunnel will wait before processing packets that
               were received out of sequence (which are waiting for
               the packet(s) to put them in sequence).  A low value
               increases the chance of delayed packets to be discarded
               (which MAY causes the PPP decompression engine to
               reset) while a high value may cause more queueing and
               possibly degrade throughput if packets are truly lost.
               The default value for this object is zero which will
               result in all delayed packets being lost."
           DEFVAL { 0 }
           ::= { l2tpTunnelConfigEntry 10 }

   l2tpTunnelConfigTransport  OBJECT-TYPE
           SYNTAX          INTEGER {

expires November 1999                                          [Page 30]

Internet Draft                                                 June 1999

                              other(1),
                              none(2),
                              ipUdp(3),
                              frameRelay(4)
                           }
           MAX-ACCESS      read-write
           STATUS          current
           DESCRIPTION
              "This object defines the underlying transport media
               that is in use for this tunnel entry. Different tunnel
               transports may define MIB extensions to the L2TP tunnel
               table to realize the transport layer. For example if the
               value of this object is 'ipUdp' then the value of ifIndex
               for this table may be used to determine state from the
               l2tpUdpStatsTable."
           ::= { l2tpTunnelConfigEntry 11 }

expires November 1999                                          [Page 31]

Internet Draft                                                 June 1999

   --
   --      The L2TP Tunnel Status and Statisticss Table
   --
   --      This table contains objects that can be used to describe
   --      the current status and statistics of a single L2TP tunnel.

   l2tpTunnelStatsTable    OBJECT-TYPE
           SYNTAX          SEQUENCE OF L2tpTunnelStatsEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "The L2TP tunnel status and statistics table."
           ::= { l2tpObjects 5 }

   l2tpTunnelStatsEntry    OBJECT-TYPE
           SYNTAX          L2tpTunnelStatsEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "An L2TP tunnel interface stats entry."
           INDEX { l2tpTunnelStatsIfIndex }
           ::= { l2tpTunnelStatsTable 1 }

   L2tpTunnelStatsEntry ::=
           SEQUENCE {
               l2tpTunnelStatsIfIndex
                   InterfaceIndex,
               l2tpTunnelStatsLocalTID
                   Integer32,
               l2tpTunnelStatsRemoteTID
                   Integer32,
               l2tpTunnelStatsState
                   INTEGER,
               l2tpTunnelStatsInitiated
                   INTEGER,
               l2tpTunnelStatsRemoteHostName
                   DisplayString,
               l2tpTunnelStatsRemoteVendorName
                   DisplayString,
               l2tpTunnelStatsRemoteFirmwareRevision
                   Integer32,
               l2tpTunnelStatsRemoteProtocolVersion
                   OCTET STRING,
               l2tpTunnelStatsInitialRemoteRWS
                   Integer32,
               l2tpTunnelStatsBearerCapabilities
                   INTEGER,

expires November 1999                                          [Page 32]

Internet Draft                                                 June 1999

               l2tpTunnelStatsFramingCapabilities
                   INTEGER,
               l2tpTunnelStatsControlRecvPackets
                   Counter32,
               l2tpTunnelStatsControlRecvZLB
                   Counter32,
               l2tpTunnelStatsControlOutOfSequence
                   Counter32,
               l2tpTunnelStatsControlOutOfWindow
                   Counter32,
               l2tpTunnelStatsControlSendPackets
                   Counter32,
               l2tpTunnelStatsControlSendZLB
                   Counter32,
               l2tpTunnelStatsControlAckTimeouts
                   Counter32,
               l2tpTunnelStatsCurrentRemoteRWS
                   Gauge32,
               l2tpTunnelStatsSendSeq
                   Integer32,
               l2tpTunnelStatsSendSeqAck
                   Integer32,
               l2tpTunnelStatsRecvSeq
                   Integer32,
               l2tpTunnelStatsRecvSeqAck
                   Integer32,
               l2tpTunnelStatsTotalSessions
                   Counter32,
               l2tpTunnelStatsFailedSessions
                   Counter32,
               l2tpTunnelStatsActiveSessions
                   Gauge32,
               l2tpTunnelStatsLastResultCode
                   Integer32,
               l2tpTunnelStatsLastErrorCode
                   Integer32,
               l2tpTunnelStatsLastErrorMessage
                   DisplayString
           }

   l2tpTunnelStatsIfIndex  OBJECT-TYPE
           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This value for this object is equal to the value
               of ifIndex of the Interfaces MIB for tunnel
               interfaces of type L2TP."

expires November 1999                                          [Page 33]

Internet Draft                                                 June 1999

           ::= { l2tpTunnelStatsEntry 1 }

   l2tpTunnelStatsLocalTID OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the local tunnel Identifier."
           ::= { l2tpTunnelStatsEntry 2 }

   l2tpTunnelStatsRemoteTID OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the remote tunnel Identifier."
           ::= { l2tpTunnelStatsEntry 3 }

   l2tpTunnelStatsState    OBJECT-TYPE
           SYNTAX          INTEGER {
                               tunnelIdle(1),
                               tunnelConnecting(2),
                               tunnelEstablished(3),
                               tunnelDisconnecting(4)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This field contains the current state of the control
               tunnel."
           ::= { l2tpTunnelStatsEntry 4 }

   l2tpTunnelStatsInitiated  OBJECT-TYPE
           SYNTAX          INTEGER {
                               locally(1),
                               remotely(2)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object indicates whether the tunnel was
               initiated locally or by the remote tunnel peer."
           ::= { l2tpTunnelStatsEntry 5 }

   l2tpTunnelStatsRemoteHostName  OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current

expires November 1999                                          [Page 34]

Internet Draft                                                 June 1999

           DESCRIPTION
              "This object contains the host name as discovered
               during the tunnel establishment phase (via the Host
               Name AVP) of the L2TP peer. If the tunnel is idle
               this object should maintain its value from the last
               time it was connected."
           ::= { l2tpTunnelStatsEntry 6 }

   l2tpTunnelStatsRemoteVendorName  OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the vendor name of the peer's
               L2TP implementation. If the tunnel is idle this
               object should maintain its value from the last time
               it was connected."
           ::= { l2tpTunnelStatsEntry 7 }

   l2tpTunnelStatsRemoteFirmwareRevision  OBJECT-TYPE
           SYNTAX          Integer32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the tunnel peer's firmware
               revision number. If the tunnel is idle this object
               should maintain its value from the last time it
               was connected."
           ::= { l2tpTunnelStatsEntry 8 }

   l2tpTunnelStatsRemoteProtocolVersion  OBJECT-TYPE
           SYNTAX          OCTET STRING (SIZE(2))
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object describes the protocol version and
               revision of the tunnel peers implementation. The
               first octet contains the protocol version. The
               second octet contains the protocol revision."
           ::= { l2tpTunnelStatsEntry 9 }

   l2tpTunnelStatsInitialRemoteRWS  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the initial remote peers
               receive window size as indicated by the tunnel peer

expires November 1999                                          [Page 35]

Internet Draft                                                 June 1999

               (in the RWS AVP) during the tunnel establishment
               phase. If the tunnel is idle this object should
               maintain its value from the last time it was
               connected."
           ::= { l2tpTunnelStatsEntry 10 }

   l2tpTunnelStatsBearerCapabilities  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               digital(2),
                               analog(3),
                               digitalAnalog(4)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object describes the Bearer Capabilities of
               the tunnel peer. If the tunnel is idle this object
               should maintain its value from the last time it was
               connected."
           ::= { l2tpTunnelStatsEntry 11 }

   l2tpTunnelStatsFramingCapabilities  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               sync(2),
                               async(3),
                               syncAsync(4)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object describes the Framing Capabilities of
               the tunnel peer. If the tunnel is idle this object
               should maintain its value from the last time it was
               connected."
           ::= { l2tpTunnelStatsEntry 12 }

   l2tpTunnelStatsControlRecvPackets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the number of control packets
               received on the tunnel."
           ::= { l2tpTunnelStatsEntry 13 }

   l2tpTunnelStatsControlRecvZLB  OBJECT-TYPE

expires November 1999                                          [Page 36]

Internet Draft                                                 June 1999

           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns a count of the number of Zero
               Length Body control packet acknowledgement packets
               that were received."
           ::= { l2tpTunnelStatsEntry 14 }

   l2tpTunnelStatsControlOutOfSequence  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns a count of the number of
               control packets that were not received in the
               correct order (as per the sequence number) on
               this tunnel."
           ::= { l2tpTunnelStatsEntry 15 }

   l2tpTunnelStatsControlOutOfWindow  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the number of control
               packets that were received outside of the
               offered receive window. It is implementation
               specific as to whether these packets are queued
               or discarded."
           ::= { l2tpTunnelStatsEntry 16 }

   l2tpTunnelStatsControlSendPackets  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the number of control
               packets that were transmitted to the tunnel
               peer."
           ::= { l2tpTunnelStatsEntry 17 }

   l2tpTunnelStatsControlSendZLB  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the number of Zero Length

expires November 1999                                          [Page 37]

Internet Draft                                                 June 1999

               Body control packets transmitted transitted to
               the tunnel peer."
           ::= { l2tpTunnelStatsEntry 18 }

   l2tpTunnelStatsControlAckTimeouts  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns a count of the number of
               control packet timeouts due to the lack of a
               timely acknowledgement from the tunnel peer."
           ::= { l2tpTunnelStatsEntry 19 }

   l2tpTunnelStatsCurrentRemoteRWS  OBJECT-TYPE
           SYNTAX          Gauge32 (0..64)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the current remote receive
               window size as determined by the local flow
               control mechanism employed."
           ::= { l2tpTunnelStatsEntry 20 }

   l2tpTunnelStatsSendSeq  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the next send sequence number
               for the control channel."
           ::= { l2tpTunnelStatsEntry 21 }

   l2tpTunnelStatsSendSeqAck  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the send sequence number that
               the tunnel peer has acknowledged for the control
               channel. The flow control state can be determined
               by subtracting the l2tpTunnelStatsSendSeq from
               l2tpTunnelStatsSendSeqAck and comparing this value
               to l2tpTunnelStatsCurrentRemoteRWS."
           ::= { l2tpTunnelStatsEntry 22 }

   l2tpTunnelStatsRecvSeq  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)

expires November 1999                                          [Page 38]

Internet Draft                                                 June 1999

           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the next receive sequence
               number expected to be received on this control
               channel."
           ::= { l2tpTunnelStatsEntry 23 }

   l2tpTunnelStatsRecvSeqAck  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the last receive sequence
               number that was acknowledged back to the tunnel
               peer for the control channel."
           ::= { l2tpTunnelStatsEntry 24 }

   l2tpTunnelStatsTotalSessions  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the total number of sessions
               that this tunnel has successfully connected through
               to its tunnel peer since this tunnel was created."
           ::= { l2tpTunnelStatsEntry 25 }

   l2tpTunnelStatsFailedSessions  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the total number of sessions
               that were initiated but failed to reach the
               established phase."
           ::= { l2tpTunnelStatsEntry 26 }

   l2tpTunnelStatsActiveSessions  OBJECT-TYPE
           SYNTAX          Gauge32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the total number of sessions
               in the established state for this tunnel."
           ::= { l2tpTunnelStatsEntry 27 }

   l2tpTunnelStatsLastResultCode  OBJECT-TYPE

expires November 1999                                          [Page 39]

Internet Draft                                                 June 1999

           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the last value of the result
               code as described in the Result Code AVP which
               caused the tunnel to disconnect."
           ::= { l2tpTunnelStatsEntry 28 }

   l2tpTunnelStatsLastErrorCode  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the last value of the error
               code as described in the Result Code AVP which
               caused the tunnel to disconnect."
           ::= { l2tpTunnelStatsEntry 29 }

   l2tpTunnelStatsLastErrorMessage  OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the last value of the optional
               message as described in the Result Code AVP which
               caused the tunnel to disconnect."
           ::= { l2tpTunnelStatsEntry 30 }

expires November 1999                                          [Page 40]

Internet Draft                                                 June 1999

   --
   --      { l2tpObjects 6 } reserved for future use
   --

expires November 1999                                          [Page 41]

Internet Draft                                                 June 1999

   --
   --      The L2TP Session Status and Statistics Table
   --
   --      This table contains the objects that can be used to
   --      describe the current status and statistics of a single
   --      L2TP tunneled session.

   l2tpSessionStatsTable   OBJECT-TYPE
           SYNTAX          SEQUENCE OF L2tpSessionStatsEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "The L2TP session status and statistics table."
           ::= { l2tpObjects 7 }

   l2tpSessionStatsEntry   OBJECT-TYPE
           SYNTAX          L2tpSessionStatsEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "An L2TP session interface stats entry."
           INDEX { l2tpSessionStatsTunnelIfIndex, l2tpSessionStatsLocalCID }
           ::= { l2tpSessionStatsTable 1 }

   L2tpSessionStatsEntry ::=
           SEQUENCE {
               l2tpSessionStatsTunnelIfIndex
                   InterfaceIndex,
               l2tpSessionStatsHLIfIndex
                   InterfaceIndex,
               l2tpSessionStatsLocalCID
                   Integer32,
               l2tpSessionStatsRemoteCID
                   Integer32,
               l2tpSessionStatsUserName
                   DisplayString,
               l2tpSessionStatsState
                   INTEGER,
               l2tpSessionStatsCallType
                   INTEGER,
               l2tpSessionStatsCallSerialNumber
                   Integer32,
               l2tpSessionStatsTxConnectSpeed
                   Integer32,
               l2tpSessionStatsRxConnectSpeed
                   Integer32,
               l2tpSessionStatsCallBearerType

expires November 1999                                          [Page 42]

Internet Draft                                                 June 1999

                   INTEGER,
               l2tpSessionStatsFramingType
                   INTEGER,
               l2tpSessionStatsPhysChanId
                   Integer32,
               l2tpSessionStatsDNIS
                   DisplayString,
               l2tpSessionStatsCLID
                   DisplayString,
               l2tpSessionStatsSubAddress
                   DisplayString,
               l2tpSessionStatsPrivateGroupID
                   DisplayString,
               l2tpSessionStatsProxyLcp
                   TruthValue,
               l2tpSessionStatsAuthMethod
                   INTEGER,
               l2tpSessionStatsSequencingState
                   INTEGER,
               l2tpSessionStatsOutSequence
                   Counter32,
               l2tpSessionStatsReassemblyTimeouts
                   Counter32,
               l2tpSessionStatsSendSeq
                   Integer32
           }

   l2tpSessionStatsTunnelIfIndex OBJECT-TYPE
           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the sessions associated
               L2TP tunnel ifIndex value."
           ::= { l2tpSessionStatsEntry 1 }

   l2tpSessionStatsHLIfIndex OBJECT-TYPE
           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the ifIndex value of the
               interface that is either below (Lower) the tunnel
               (if this tunnel endpoint is a LAC) or above
               (Higher) the tunnel (if this tunnel endpoint is a
               LNS). For example this could be a DS0 ifIndex on a
               LAC or it would be the PPP ifIndex on the LNS."
           ::= { l2tpSessionStatsEntry 2 }

expires November 1999                                          [Page 43]

Internet Draft                                                 June 1999

   l2tpSessionStatsLocalCID  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the local call identifier
               for the session."
           ::= { l2tpSessionStatsEntry 3 }

   l2tpSessionStatsRemoteCID  OBJECT-TYPE
           SYNTAX          Integer32  (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the remote call identifier
               for the session."
           ::= { l2tpSessionStatsEntry 4 }

   l2tpSessionStatsUserName  OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the peer session name on
               this interface. This is typically the login name
               of the remote user. If the user name is unknown to
               the local tunnel peer then this object will contain
               a null string."
           ::= { l2tpSessionStatsEntry 5 }

   l2tpSessionStatsState   OBJECT-TYPE
           SYNTAX          INTEGER {
                               sessionIdle(1),
                               sessionConnecting(2),
                               sessionEstablished(3),
                               sessionDisconnecting(4)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the current state of the
               session."
           ::= { l2tpSessionStatsEntry 6 }

   l2tpSessionStatsCallType  OBJECT-TYPE
           SYNTAX          INTEGER {
                               lacIncoming(1),
                               lnsIncoming(2),

expires November 1999                                          [Page 44]

Internet Draft                                                 June 1999

                               lacOutgoing(3),
                               lnsOutgoing(4)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object indicates the type of call and the
               role this tunnel peer is providing for this
               session. For example, lacIncoming(1) indicates
               that this tunnel peer is acting as a LAC and
               generated a Incoming-Call-Request to the tunnel
               peer (the LNS). Note that tunnel peers can be
               both LAC and LNS simultaneously."
           ::= { l2tpSessionStatsEntry 7 }

   l2tpSessionStatsCallSerialNumber  OBJECT-TYPE
           SYNTAX          Integer32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the serial number that has
               been assigned to this  session."
           ::= { l2tpSessionStatsEntry 8 }

   l2tpSessionStatsTxConnectSpeed  OBJECT-TYPE
           SYNTAX          Integer32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the last known transmit
               baud rate for this session."
           ::= { l2tpSessionStatsEntry 9 }

   l2tpSessionStatsRxConnectSpeed  OBJECT-TYPE
           SYNTAX          Integer32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the last known receive
               baud rate for this session established."
           ::= { l2tpSessionStatsEntry 10 }

   l2tpSessionStatsCallBearerType    OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               digital(2),
                               analog(3)
                           }

expires November 1999                                          [Page 45]

Internet Draft                                                 June 1999

           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object describes the bearer type of this
               session."
           ::= { l2tpSessionStatsEntry 11 }

   l2tpSessionStatsFramingType  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               sync(2),
                               async(3)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object describes the framing type of this
               session."
           ::= { l2tpSessionStatsEntry 12 }

   l2tpSessionStatsPhysChanId   OBJECT-TYPE
           SYNTAX          Integer32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the physical channel
               identifier for the session."
           ::= { l2tpSessionStatsEntry 13 }

   l2tpSessionStatsDNIS    OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the Dialed Number
               Information String that the LAC obtained from
               the network for the session. If no DNIS was
               provided then a null string will be returned."
           ::= { l2tpSessionStatsEntry 14 }

   l2tpSessionStatsCLID    OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the Calling Line ID
               that the LAC obtained from the network for
               the session. If no CLID was provided then a

expires November 1999                                          [Page 46]

Internet Draft                                                 June 1999

               null string will be returned."
           ::= { l2tpSessionStatsEntry 15 }

   l2tpSessionStatsSubAddress  OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the Sub Address that
               the LAC obtained from the network for the
               session. If no Sub Address was provided then
               a null string will be returned."
           ::= { l2tpSessionStatsEntry 16 }

   l2tpSessionStatsPrivateGroupID  OBJECT-TYPE
           SYNTAX          DisplayString
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the Private Group
               Identifier used for this tunneled session.
               If no Private Group Identifier was provided
               then a null string will be returned."
           ::= { l2tpSessionStatsEntry 17 }

   l2tpSessionStatsProxyLcp  OBJECT-TYPE
           SYNTAX          TruthValue
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "Indicates whether the LAC performed proxy LCP
               for this session."
           ::= { l2tpSessionStatsEntry 18 }

   l2tpSessionStatsAuthMethod  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               text(2),
                               pppChap(3),
                               pppPap(4),
                               pppEap(5)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the proxy authentication
               method employed by the LAC for the session. If
               l2tpSessionProxyLcp is false(2) this object should

expires November 1999                                          [Page 47]

Internet Draft                                                 June 1999

               not be interpreted."
           ::= { l2tpSessionStatsEntry 19 }

   l2tpSessionStatsSequencingState  OBJECT-TYPE
           SYNTAX          INTEGER {
                               none(1),
                               remote(2),
                               local(3),
                               both(4)
                           }
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object defines which tunnel peers have
               requested payload sequencing. The value of
               both(4) indicates that both peers have requested
               payload sequencing."
           ::= { l2tpSessionStatsEntry 20 }

   l2tpSessionStatsOutSequence  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the total number of packets
               received for this session which were received out
               of sequence."
           ::= { l2tpSessionStatsEntry 21 }

   l2tpSessionStatsReassemblyTimeouts  OBJECT-TYPE
           SYNTAX          Counter32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object returns the number of reassembly
               timeouts that have occured for this session."
           ::= { l2tpSessionStatsEntry 22 }

   l2tpSessionStatsSendSeq OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the next send sequence number
               for for this session."
           ::= { l2tpSessionStatsEntry 23 }

expires November 1999                                          [Page 48]

Internet Draft                                                 June 1999

   --
   --      The L2TP Tunnel Mapping Table
   --
   --      This table is intended to assist management
   --      applications to quickly determine what the ifIndex
   --      value is for a given local tunnel identifier.

   l2tpTunnelMapTable OBJECT-TYPE
           SYNTAX    SEQUENCE OF L2tpTunnelMapEntry
           MAX-ACCESS not-accessible
           STATUS current
           DESCRIPTION
              "The L2TP Tunnel index mapping table."
           ::= { l2tpObjects 8 }

   l2tpTunnelMapEntry OBJECT-TYPE
           SYNTAX          L2tpTunnelMapEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "An L2TP tunnel index map entry."
           INDEX { l2tpTunnelMapLocalTID }
           ::= { l2tpTunnelMapTable 1 }

   L2tpTunnelMapEntry ::=
           SEQUENCE {
               l2tpTunnelMapLocalTID
                   Integer32,
               l2tpTunnelMapIfIndex
                   InterfaceIndex
           }

   l2tpTunnelMapLocalTID OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the local tunnel Identifier."
           ::= { l2tpTunnelMapEntry 1 }

   l2tpTunnelMapIfIndex  OBJECT-TYPE
           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This value for this object is equal to the value
               of ifIndex of the Interfaces MIB for tunnel
               interfaces of type L2TP."

expires November 1999                                          [Page 49]

Internet Draft                                                 June 1999

           ::= { l2tpTunnelMapEntry 2 }

expires November 1999                                          [Page 50]

Internet Draft                                                 June 1999

   --
   --      The L2TP Session Mapping Table
   --
   --      This table is intended to assist management
   --      applications to quickly determine what the instance
   --      value is for a given upper or lower ifIndex.

   l2tpSessionMapTable OBJECT-TYPE
           SYNTAX    SEQUENCE OF L2tpSessionMapEntry
           MAX-ACCESS not-accessible
           STATUS current
           DESCRIPTION
              "The L2TP Session index mapping table."
           ::= { l2tpObjects 9 }

   l2tpSessionMapEntry OBJECT-TYPE
           SYNTAX          L2tpSessionMapEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "An L2TP Session index map entry."
           INDEX { l2tpSessionMapHLifIndex }
           ::= { l2tpSessionMapTable 1 }

   L2tpSessionMapEntry ::=
           SEQUENCE {
               l2tpSessionMapHLifIndex
                   InterfaceIndex,
               l2tpSessionMapTunnelIfIndex
                   InterfaceIndex,
               l2tpSessionMapLocalCID
                   Integer32
           }

   l2tpSessionMapHLifIndex OBJECT-TYPE
           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the ifIndex value of the
               interface that is either below (Lower) the tunnel
               (if this tunnel endpoint is a LAC) or above
               (Higher) the tunnel (if this tunnel endpoint is a
               LNS). For example this could be a DS0 ifIndex on a
               LAC or it would be the PPP ifIndex on the LNS."
           ::= { l2tpSessionMapEntry 1 }

   l2tpSessionMapTunnelIfIndex OBJECT-TYPE

expires November 1999                                          [Page 51]

Internet Draft                                                 June 1999

           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object identifies the sessions associated
               L2TP tunnel ifIndex value."
           ::= { l2tpSessionMapEntry 2 }

   l2tpSessionMapLocalCID  OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object contains the local call identifier
               for the session."
           ::= { l2tpSessionMapEntry 3 }

expires November 1999                                          [Page 52]

Internet Draft                                                 June 1999

   --
   --      { l2tpIpUdpObjects 1 } reserved for future use

expires November 1999                                          [Page 53]

Internet Draft                                                 June 1999

   --
   --      The L2TP IP/UDP Transport Status and Statistics Table
   --
   --      This table contains objects that can be used to
   --      describe the current status and statistics of the
   --      IP/UDP L2TP tunnel transport.

   l2tpUdpStatsTable OBJECT-TYPE
           SYNTAX    SEQUENCE OF L2tpUdpStatsEntry
           MAX-ACCESS not-accessible
           STATUS current
           DESCRIPTION
              "The L2TP IP/UDP transport stats table."
           ::= { l2tpIpUdpObjects 2 }

   l2tpUdpStatsEntry OBJECT-TYPE
           SYNTAX          L2tpUdpStatsEntry
           MAX-ACCESS      not-accessible
           STATUS          current
           DESCRIPTION
              "An L2TP IP/UDP transport stats entry."
           INDEX { l2tpUdpStatsIfIndex }
           ::= { l2tpUdpStatsTable 1 }

   L2tpUdpStatsEntry ::=
           SEQUENCE {
               l2tpUdpStatsIfIndex
                   InterfaceIndex,
               l2tpUdpStatsPeerPort
                   Integer32,
               l2tpUdpStatsLocalPort
                   Integer32
           }

   l2tpUdpStatsIfIndex     OBJECT-TYPE
           SYNTAX          InterfaceIndex
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This value for this object is equal to the
               value of ifIndex of the Interfaces MIB for
               tunnel interfaces of type L2TP and which have
               a L2TP transport of IP/UDP."
           ::= { l2tpUdpStatsEntry 1 }

   l2tpUdpStatsPeerPort    OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)

expires November 1999                                          [Page 54]

Internet Draft                                                 June 1999

           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object reflects the peer's UDP port number
               of the last packet received."
           ::= { l2tpUdpStatsEntry 2 }

   l2tpUdpStatsLocalPort   OBJECT-TYPE
           SYNTAX          Integer32 (0..65535)
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
              "This object reflects the local UDP port number
               that this tunnel is bound to."
           ::= { l2tpUdpStatsEntry 3 }

expires November 1999                                          [Page 55]

Internet Draft                                                 June 1999

   --
   --      Definition of generic L2TP traps
   --

   l2tpTunnelAuthFailure NOTIFICATION-TYPE
           OBJECTS         {
                           l2tpTunnelStatsIfIndex,
                           l2tpTunnelStatsInitiated,
                           l2tpTunnelStatsRemoteHostName
                           }
           STATUS          current
           DESCRIPTION
              "A l2tpTunnelAuthFailure trap signifies that an
               attempt to establish a tunnel to a remote peer
               has failed authentication."
           ::= { l2tpTraps 1 }

expires November 1999                                          [Page 56]

Internet Draft                                                 June 1999

   --
   --      conformance information
   --

   l2tpGroups      OBJECT IDENTIFIER ::= { l2tpConformance 1 }
   l2tpCompliances OBJECT IDENTIFIER ::= { l2tpConformance 2 }

   --
   --      compliance statements
   --

   l2tpCompliance MODULE-COMPLIANCE
           STATUS          current
           DESCRIPTION
              "The compliance statement for SNMPv2 entities
               which implement the L2TP MIB."

           MODULE          -- this module

        -- unconditionally mandatory groups
           MANDATORY-GROUPS {
                               l2tpConfigGroup,
                               l2tpStatsGroup
                            }

        -- conditionally mandatory groups
           GROUP           l2tpIpUdpGroup
           DESCRIPTION
              "This group is mandatory for implementations that
               support L2TP over IP/UDP."

        -- optional groups
           GROUP           l2tpDomainGroup
           DESCRIPTION
              "This group is optional for L2TP devices that desire
               to group tunnel endpoints into tunnel domains."

           GROUP           l2tpMappingGroup
           DESCRIPTION
              "This group is optional for L2TP devices that wish
               to provide index mapping."

           ::= { l2tpCompliances 1 }

   -- units of conformance

   l2tpConfigGroup OBJECT-GROUP

expires November 1999                                          [Page 57]

Internet Draft                                                 June 1999

           OBJECTS {
               l2pAdminState,
               l2tpTunnelConfigIfIndex,
               l2tpTunnelConfigAuthentication,
               l2tpTunnelConfigSecret,
               l2tpTunnelConfigSecurity,
               l2tpTunnelConfigHelloInterval,
               l2tpTunnelConfigIdleTimeout,
               l2tpTunnelConfigControlRWS,
               l2tpTunnelConfigControlRetransmissions,
               l2tpTunnelConfigPayloadSequencing,
               l2tpTunnelConfigReassemblyTimeout,
               l2tpTunnelConfigTransport
           }
           STATUS          current
           DESCRIPTION
              "A collection of objects providing configuration
               information of the L2TP protocol, tunnels and sessions."
           ::= { l2tpGroups 1 }

   l2tpStatsGroup OBJECT-GROUP
           OBJECTS {
               l2tpProtocolVersion,
               l2tpVendorName,
               l2tpFirmwareRev,
               l2tpTunnelStatsIfIndex,
               l2tpTunnelStatsLocalTID,
               l2tpTunnelStatsRemoteTID,
               l2tpTunnelStatsState,
               l2tpTunnelStatsInitiated,
               l2tpTunnelStatsRemoteHostName,
               l2tpTunnelStatsRemoteVendorName,
               l2tpTunnelStatsRemoteFirmwareRevision,
               l2tpTunnelStatsRemoteProtocolVersion,
               l2tpTunnelStatsInitialRemoteRWS,
               l2tpTunnelStatsBearerCapabilities,
               l2tpTunnelStatsFramingCapabilities,
               l2tpTunnelStatsControlRecvPackets,
               l2tpTunnelStatsControlRecvZLB,
               l2tpTunnelStatsControlOutOfSequence,
               l2tpTunnelStatsControlOutOfWindow,
               l2tpTunnelStatsControlSendPackets,
               l2tpTunnelStatsControlSendZLB,
               l2tpTunnelStatsControlAckTimeouts,
               l2tpTunnelStatsCurrentRemoteRWS,
               l2tpTunnelStatsSendSeq,
               l2tpTunnelStatsSendSeqAck,
               l2tpTunnelStatsRecvSeq,

expires November 1999                                          [Page 58]

Internet Draft                                                 June 1999

               l2tpTunnelStatsRecvSeqAck,
               l2tpTunnelStatsTotalSessions,
               l2tpTunnelStatsFailedSessions,
               l2tpTunnelStatsActiveSessions,
               l2tpTunnelStatsLastResultCode,
               l2tpTunnelStatsLastErrorCode,
               l2tpTunnelStatsLastErrorMessage,
               l2tpSessionStatsTunnelIfIndex,
               l2tpSessionStatsHLIfIndex,
               l2tpSessionStatsLocalCID,
               l2tpSessionStatsRemoteCID,
               l2tpSessionStatsUserName,
               l2tpSessionStatsState,
               l2tpSessionStatsCallType,
               l2tpSessionStatsCallSerialNumber,
               l2tpSessionStatsTxConnectSpeed,
               l2tpSessionStatsRxConnectSpeed,
               l2tpSessionStatsCallBearerType,
               l2tpSessionStatsFramingType,
               l2tpSessionStatsPhysChanId,
               l2tpSessionStatsDNIS,
               l2tpSessionStatsCLID,
               l2tpSessionStatsSubAddress,
               l2tpSessionStatsPrivateGroupID,
               l2tpSessionStatsProxyLcp,
               l2tpSessionStatsAuthMethod,
               l2tpSessionStatsSequencingState,
               l2tpSessionStatsOutSequence,
               l2tpSessionStatsReassemblyTimeouts,
               l2tpSessionStatsSendSeq
           }
           STATUS          current
           DESCRIPTION
              "A collection of objects providing status and
               statistics of the L2TP protocol, tunnels and
               sessions."
           ::= { l2tpGroups 2 }

   l2tpIpUdpGroup OBJECT-GROUP
           OBJECTS {
               l2tpUdpStatsIfIndex,
               l2tpUdpStatsPeerPort,
               l2tpUdpStatsLocalPort
           }
           STATUS          current
           DESCRIPTION
              "A collection of objects providing status and
               statistics of the L2TP IP/UDP transport layer."

expires November 1999                                          [Page 59]

Internet Draft                                                 June 1999

           ::= { l2tpGroups 3 }

   l2tpDomainGroup OBJECT-GROUP
           OBJECTS {
               l2pDomainConfigAdminState,
               l2tpDomainConfigAuthentication,
               l2tpDomainConfigSecret,
               l2tpDomainConfigTunnelSecurity,
               l2tpDomainConfigTunnelHelloInterval,
               l2tpDomainConfigTunnelIdleTimeout,
               l2tpDomainConfigControlRWS,
               l2tpDomainConfigControlRetransmissions,
               l2tpDomainConfigPayloadSequencing,
               l2tpDomainConfigReassemblyTimeout,
               l2tpDomainConfigStatus,
               l2tpDomainStatsTotalTunnels,
               l2tpDomainStatsFailedTunnels,
               l2tpDomainStatsFailedAuthentications,
               l2tpDomainStatsActiveTunnels,
               l2tpDomainStatsTotalSessions,
               l2tpDomainStatsFailedSessions,
               l2tpDomainStatsActiveSessions,
               l2tpDomainStatsControlRecvOctets,
               l2tpDomainStatsControlRecvPackets,
               l2tpDomainStatsControlSendOctets,
               l2tpDomainStatsControlSendPackets,
               l2tpDomainStatsPayloadRecvOctets,
               l2tpDomainStatsPayloadRecvPackets,
               l2tpDomainStatsPayloadRecvDiscards,
               l2tpDomainStatsPayloadSendOctets,
               l2tpDomainStatsPayloadSendPackets
           }
           STATUS          current
           DESCRIPTION
              "A collection of objects providing configuration,
               status and statistics of L2TP tunnel domains."
           ::= { l2tpGroups 4 }

   l2tpMappingGroup OBJECT-GROUP
           OBJECTS {
               l2tpTunnelMapLocalTID,
               l2tpTunnelMapIfIndex,
               l2tpSessionMapHLifIndex,
               l2tpSessionMapTunnelIfIndex,
               l2tpSessionMapLocalCID
           }
           STATUS          current
           DESCRIPTION

expires November 1999                                          [Page 60]

Internet Draft                                                 June 1999

              "A collection of objects providing index mapping."
           ::= { l2tpGroups 5 }

   END

expires November 1999                                          [Page 61]

Internet Draft                                                 June 1999

5.0 Security Considerations

   This MIB contains readable objects whose values provide information
   related to L2TP tunnel interfaces.  There are also a number of objects
   that have a MAX-ACCESS clause of read-write and/or read-create, such as
   those which allow an administrator to dynamically configure tunnels.

   While unauthorized access to the readable objects is relatively
   innocuous, unauthorized access to the write-able objects could cause a
   denial of service, or could cause unauthorized creation and/or
   manipulation of tunnels. Hence, the support for SET operations in a
   non-secure environment without proper protection can have a negative
   effect on network operations.

   SNMPv1 by itself is such an insecure environment.  Even if the network
   itself is secure (for example by using IPSec [24]), even then, there is
   no control as to who on the secure network is allowed to access and SET
   (change/create/delete) the objects in this MIB.

   It is recommended that the implementers consider the security features
   as provided by the SNMPv3 framework.  Specifically, the use of the
   User-based Security Model RFC 2574 [12] and the View-based Access
   Control Model RFC 2575 [15] is recommended.

   It is then a customer/user responsibility to ensure that the SNMP entity
   giving access to this MIB, is properly configured to give access to
   those objects only to those principals (users) that have legitimate
   rights to access them.

6.0 Acknowledgements

   Special thanks go to John Shriver (Shiva) for providing continued
feedback
   throughout the development of this MIB.

7.0 Authors' Addresses

   Evan Caves
   Ericsson
   340 Storke Road
   Santa Barbara, CA 93117
   evan@acc.com

   Pat Calhoun
   Sun MicroComputer Corp.
   15 Network Circle
   Menlo Park, CA, 94025
   Pat.Calhoun@Eng.Sun.Com

expires November 1999                                          [Page 62]

Internet Draft                                                 June 1999

   Ross Wheeler
   RouterWare
   3961 MacArthur Blvd, Suite 212
   Newport Beach, CA 92660
   ross@routerware.com

8.0 References

   [1]  Harrington, D., Presuhn, R., and B. Wijnen, "An Architecture for
        Describing SNMP Management Frameworks", RFC 2271, Cabletron
        Systems, Inc., BMC Software, Inc., IBM T. J. Watson Research,
        January 1998

   [2]  Rose, M., and K. McCloghrie, "Structure and Identification of
        Management Information for TCP/IP-based Internets", RFC 1155,
        Performance Systems International, Hughes LAN Systems, May 1990

   [3]  Rose, M., and K. McCloghrie, "Concise MIB Definitions", RFC
   1212,
        Performance Systems International, Hughes LAN Systems, March
   1991

   [4]  M. Rose, "A Convention for Defining Traps for use with the
   SNMP",
        RFC 1215, Performance Systems International, March 1991

   [5]  McCloghrie, K., Perkins, D., and J. Schoenwaelder, "Structure of
        Management Information Version 2 (SMIv2)", STD 58, RFC 2578,
   April
        1999.

   [6]  McCloghrie, K., Perkins, D., and J. Schoenwaelder, "Textual
        Conventions for SMIv2", STD 58, RFC 2579, April 1999.

   [7]  McCloghrie, K., Perkins, D., and J. Schoenwaelder, "Conformance
        Statements for SMIv2", STD 58, RFC 2580, April 1999.

   [8]  Case, J., Fedor, M., Schoffstall, M., and J. Davin, "Simple
   Network
        Management Protocol", RFC 1157, SNMP Research, Performance
   Systems
        International, Performance Systems International, MIT Laboratory
        for Computer Science, May 1990.

   [9]  SNMPv2 Working Group, Case, J., McCloghrie, K., Rose, M., and S.
        Waldbusser, "Introduction to Community-based SNMPv2", RFC 1901,
        SNMP Research, Inc., Cisco Systems, Inc., Dover Beach
   Consulting,

expires November 1999                                          [Page 63]

Internet Draft                                                 June 1999

        Inc., International Network Services, January 1996.

   [10] SNMPv2 Working Group, Case, J., McCloghrie, K., Rose, M., and S.
        Waldbusser, "Transport Mappings for Version 2 of the Simple
   Network
        Management Protocol (SNMPv2)", RFC 1906, SNMP Research, Inc.,
   Cisco
        Systems, Inc., Dover Beach Consulting, Inc., International
   Network
        Services, January 1996.

   [11] Case, J., Harrington D., Presuhn R., and B. Wijnen, "Message
        Processing and Dispatching for the Simple Network Management
        Protocol (SNMP)", RFC 2572, SNMP Research, Inc., Cabletron
   Systems,
        Inc., BMC Software, Inc., IBM T. J. Watson Research, April 1999.

   [12] Blumenthal, U., and B. Wijnen, "User-based Security Model (USM)
   for
        version 3 of the Simple Network Management Protocol (SNMPv3)",
   RFC
        2574, IBM T. J. Watson Research, April 1999.

   [13] SNMPv2 Working Group, Case, J., McCloghrie, K., Rose, M., and S.
        Waldbusser, "Protocol Operations for Version 2 of the Simple
        Network Management Protocol (SNMPv2)", RFC 1905, SNMP Research,
        Inc., Cisco Systems, Inc., Dover Beach Consulting, Inc.,
        International Network Services, January 1996.

   [14] Levi, D., Meyer, P., and B. Stewart, "SNMPv3 Applications", RFC
        2573, SNMP Research, Inc., Secure Computing Corporation, Cisco
        Systems, April 1999.

   [15] Wijnen, B., Presuhn, R., and K. McCloghrie, "View-based Access
        Control Model (VACM) for the Simple Network Management Protocol
        (SNMP)", RFC 2575, IBM T. J. Watson Research, BMC Software,
   Inc.,
        Cisco Systems, Inc., April 1999.

   [16] Valencia et al., "Layer Two Tunneling Protocol - L2TP",
        Work In Progress, Cisco Systems, Ascend Communications,
   Microsoft
        Corporation, Redback Networks, June 1999.

   [17] McCloghrie, K. and F. Kastenholz, "The Interfaces Group MIB",
        Work In Progress, Cisco Systems, Argon Networks,
        July 1998.

expires November 1999                                          [Page 64]

Internet Draft                                                 June 1999

   [18] Thaler, D., "IP Tunnel MIB" , Work In Progress, Microsoft, June
   1999.

9.0 Full Copyright Statement

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implmentation may be prepared, copied, published and
   distributed, in whole or in part, without restriction of any kind,
   provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."

expires November 1999                                          [Page 65]
