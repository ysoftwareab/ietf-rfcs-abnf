
Internet Draft                                        Gerald R. Ash
                                                      Young Lee
                                                      AT&T Labs
                                                      November 1998
Expires: May 1999


        Routing of Multimedia Connections when Interworking with
                      PSTN, ATM, and IP Networks

                  <draft-ash-itu-sg2-qos-routing-00.txt>

Status of this Memo 
   
   This  document  is  an  Internet-Draft.  Internet-Drafts  are working
   documents of the Internet Engineering Task Force (IETF),  its  areas,
   and its  working  groups.  Note that other groups may also distribute
   working documents as Internet-Drafts.  
   
   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at  any
   time.   It  is  inappropriate  to  use  Internet- Drafts as reference
   material or to cite them other than as ``work in progress.'' 
   
   To learn the current status of any Internet-Draft, please  check  the
   ``1id-abstracts.txt'' listing contained in the Internet-Drafts Shadow 
   Directories   on   ftp.is.co.za   (Africa),  nic.nordu.net  (Europe),
   munnari.oz.au (Pacific Rim),  ftp.ietf.org  (US  East  Coast),  or
   ftp.isi.edu (US West Coast).  
   
   This memo provides information for the Internet community.  This memo 
   does not  specify  an Internet standard of any kind.  Distribution of
   this memo is unlimited.  

Copyright Notice

   Copyright (C) The Internet Society (1998).  All Rights Reserved.

Abstract 

This contribution presents the ongoing work in ITU-T SG2 Question
2/2 on Draft Recommendation E.MM 'Routing of Multimedia Connections When
Interworking with PSTN, ATM, and IP Networks.'  As an outcome of the
November 1998 ITU-T SG2 meeting in Geneva, it was agreed to send a Liaison
Statement with Draft Recommendation E.MM attached to the ATM Forum and IETF.
The objectives of the liaison are to a) bring this ITU-T routing work to the
attention of these other standards organizations, b) communicate ITU-T's
understanding of the routing interworking issues involved between network
types, such as path selection and quality of service resource management, c)
gain information on the views of the other fora on these issues and identify
any additional issues, and d) collaborate on developing the work and provide
cross-communication as the work is progressed in each organization.  
In the contribution, the most effective routing functionalities employed
within each network type are recommended for application across network
types, to enable and ease interworking and include the following: a) the
E.164/NSAP based numbering/addressing method applied successfully in PSTN
and ATM networks, b) the automatic generation of routing tables based on
network topology and status applied successfully in PSTN, ATM, and IP


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 1]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


networks, c) the dynamic path selection methods applied successfully in
PSTNs, d) the routing table design information exchange messaging applied
successfully in PSTNs, e) the QoS resource management methods applied
successfully in PSTNs, f) the automatic update and synchronization of
topology database methods applied successfully in ATM and IP networks, g)
the topology update information exchange messaging methods applied
successfully in ATM and IP networks, and h) the connection control signaling
methods applied successfully in ATM networks.  The latter includes
originating switch controlled (source) routing, specification of via and
terminating switches in a designated transit list (DTL) parameter in the
setup message, and return of control to the originating switch with a
crankback parameter in the release message.  Adapting these capabilities, or
their equivalents, for use within each network type and for interworking
between network types builds on these well studied, documented, deployed,
and proven methods.  It also increases the likelihood of backward
compatibility to existing capabilities as new interworking standards are
adopted and implemented.



Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 2]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


Table of Contents

Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.0 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2.0 Scope  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
3.0 Definitions  . . . . . . . . . . . . . . . . . . . . . . . . . . 6
4.0 Intranetwork Routing Methods . . . . . . . . . . . . . . . . . . 6
 4.1 PSTN Routing Methods  . . . . . . . . . . . . . . . . . . . . . 6
  4.1.1 PSTN Numbering . . . . . . . . . . . . . . . . . . . . . . . 7
  4.1.2 PSTN Path Selection  . . . . . . . . . . . . . . . . . . . . 7
   4.1.2.1 Fixed Routing (FR)  . . . . . . . . . . . . . . . . . . . 7
   4.1.2.2 Time-Dependent Routing (TDR)  . . . . . . . . . . . . . . 8
   4.1.2.3 State-Dependent Routing (SDR) . . . . . . . . . . . . . . 9
   4.1.2.4 Event-Dependent Routing (EDR) . . . . . . . . . . . . .  10
  4.1.3  PSTN QoS Resource Management  . . . . . . . . . . . . . .  11
   4.1.3.1 Determination of QoS Resource Management Parameters . .  11
   4.1.3.2 Bandwidth Management and Priority Queuing . . . . . . .  13
   4.1.3.3 Link Capability Selection . . . . . . . . . . . . . . .  16
  4.1.4  PSTN Signaling and Information Exchange Messaging . . . .  16
   4.1.4.1 Connection Control Information  . . . . . . . . . . . .  17
   4.1.4.2 Routing Table Design Information  . . . . . . . . . . .  17
   4.1.4.3 Topology Update Information . . . . . . . . . . . . . .  18
   4.1.4.4 Examples of Information Exchange  . . . . . . . . . . .  18
 4.2 ATM/PNNI Routing Methods  . . . . . . . . . . . . . . . . . .  19
  4.2.1 ATM Numbering  . . . . . . . . . . . . . . . . . . . . . .  20
  4.2.2 ATM Path Selection . . . . . . . . . . . . . . . . . . . .  20
  4.2.3 ATM QoS Resource Management  . . . . . . . . . . . . . . .  21
  4.2.4 ATM Signaling and Information Exchange Messaging . . . . .  21
 4.3  IP Routing/Switching Methods . . . . . . . . . . . . . . . .  21
  4.3.1 IP Numbering . . . . . . . . . . . . . . . . . . . . . . .  23
  4.3.2 IP Path Selection  . . . . . . . . . . . . . . . . . . . .  23
  4.3.3 IP QoS Resource Management . . . . . . . . . . . . . . . .  24
  4.3.4 IP Signaling and Information Exchange Messaging  . . . . .  24
5.0 Internetwork Routing Methods . . . . . . . . . . . . . . . . .  24
 5.1 Internetwork Numbering  . . . . . . . . . . . . . . . . . . .  25
 5.2 Internetwork Path Selection . . . . . . . . . . . . . . . . .  25
 5.3 Internetwork QoS Resource Management  . . . . . . . . . . . .  25
 5.4 Internetwork Signaling and Information Exchange Messaging . .  26
 5.5 Examples of Internetwork Routing  . . . . . . . . . . . . . .  26
  5.5.1 Internetwork E Uses a Mixed Path Selection Method  . . . .  27
  5.5.2 Internetwork E Uses a Single Path Selection Method . . . .  29
6.0 References . . . . . . . . . . . . . . . . . . . . . . . . . .  29
7.0 Abbreviations  . . . . . . . . . . . . . . . . . . . . . . . .  32
8.0 Authors' Addresses . . . . . . . . . . . . . . . . . . . . . .  34


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 3]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


1.0 Introduction

There are many network operators who have implemented multiple networks
using different protocols, which include Public Switched Telephone Networks
(PSTNs), Asynchronous Transfer Mode (ATM) networks, and Internet Protocol
(IP) networks.  The very rapid growth of data services driven primarily by
multimedia internet services has led in turn to the rapid growth of ATM and
IP networks.  Also there is interest in carrying traditional PSTN voice
services over ATM and IP networks, leading to the convergence in many
instances of voice and data services onto a common network.  However there
is also a growing need to address the interworking of voice and data
services over PSTN, ATM, and IP networks, as all these network types will
continue to exist and grow.  This Recommendation addresses the routing
aspects of interworking between these networks, and includes considerations
of a) numbering, b) path selection, c) quality-of-service (QoS) resource
management, and d) signaling and information exchange messaging.

Various routing protocols are used in PSTN, ATM, and IP networks.  In PSTN
networks, for example, Recommendation E.DYN describes fixed and dynamic
routing methods for use in PSTNs.  In ATM networks, for example, the Private
Network-to-Network Interface (PNNI) standard adopted by the ATM Forum
[ATM96a] provides for a) exchange of switch and link status information, b)
automatic update and synchronization of topology databases, c) fixed and/or
dynamic path selection based on topology and status information, and d)
signaling and information exchange standards.  In IP networks, for example,
the open shortest path first (OSPF) and other standards adopted by the
Internet Engineering Task Force [M98, S95] provide for many of the same
features as PNNI, but in a connectionless IP-based packet network.  OSPF
provides for a) exchange of switch and link status information, b) automatic
update and synchronization of topology databases, and c) fixed and/or
dynamic path selection based on topology and status information.  This
Recommendation addresses the interworking of these routing protocols across
these network types for all services including multimedia services.

There is interest in interworking fixed and dynamic routing methods across
PSTN, ATM, and IP networks to include fixed routing (FR), time-dependent
routing (TDR), state-dependent routing (SDR), and event-dependent routing
(EDR) methods, applied primarily in nonhierarchical networks.   A multimedia
connection will often traverse more than one network type, and hence may be
routed end-to-end using more than one fixed or dynamic routing method.  This
Recommendation covers the interworking of different types of fixed and
dynamic routing protocols across various network types, in order to complete
a connection originating in one switch and terminating in another, where the
originating, via, and terminating switches may operate different routing
protocols.

Substantial improvements in network cost efficiency and robustness result
from the introduction of efficient routing.  A framework is needed to
support interworking of different routing methods across various PSTN, ATM,
and IP network types, perhaps implemented on different vendor equipment, for
routing between network operators, national as well as international.
Standardization of information flows is needed, so that switching equipment
from different vendors can interwork across various network types to
implement routing strategies in a coordinated fashion.  Routing interworking
standards are needed for application to interworking between multivendor
networks of various types.  This includes the international network among


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 4]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


many network operators who use different vendor equipment and networking
protocols, including PSTN, ATM, and IP-based protocols. 

The most effective routing functionalities employed within each network type
are recommended for application across network types, to enable and ease
interworking.  In particular, the following principles are discussed in the
Recommendation:

a)	the E.164/NSAP based numbering/addressing method applied
successfully in PSTN and ATM networks over the past two decades,
b)	the automatic generation of routing tables based on network topology
and status applied successfully in PSTN, ATM, and IP networks over the past
two decades,
c)	the dynamic path  selection methods applied successfully in PSTNs
over the past two decades, which include TDR, SDR, and EDR methods,
d)	the routing table design information exchange messaging applied
successfully in PSTNs over the past two decades,
e)	the QoS resource management methods applied successfully in PSTNs
over the past decade,
f)	the automatic update and synchronization of topology database
methods applied successfully in ATM and IP networks over the past two
decades,
g)	the topology update information exchange messaging methods applied
successfully in ATM and IP networks over the past two decades, and
h)	the connection control signaling methods applied successfully in ATM
networks over the past two decades.  

The latter includes originating switch (OS) controlled (source) routing to
enhance interworking of different path selection methods, which is
accomplished by specification of via switches (VSs) and terminating switches
(TSs) in a designated transit list (DTL) parameter in the SETUP/IAM message,
and return of control to the OS with a crankback parameter in the RELEASE
message.  Adapting each of the above capabilities, or their equivalents, for
use within each network type and for interworking between network types
builds on these well studied, documented, deployed, and proven methods.  It
also increases the likelihood of backward compatibility to existing
capabilities as new interworking standards are adopted and implemented.

2.0 Scope

This Recommendation gives a framework for routing interworking across
networks of various types, including PSTN, ATM, and IP-based networks.  It
covers the establishment of connections for narrowband, wideband, and
broadband multimedia services within multiservice networks and between
multiservice networks.  These services include constant bit rate (CBR),
variable bit rate (VBR), unassigned bit rate (UBR), and available bit rate
(ABR) traffic classes.  The Recommendation illustrates the functionality for
setting up a connection from an OS in one network to a destination switch in
another network, using one or more routing methods across networks of
various types, as illustrated in Figure 1:

 <<Figure 1. Example of Multimedia Connection across PSTN/ISDN & IP Networks>> 

The Figure illustrates a multimedia connection between two PCs which carries
traffic for a combination of voice, video, and image applications.  For this
purpose a logical point-to-point connection is established from the PC


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 5]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


served by switch a1 to the PC served by switch c2.  The connection could be
a CBR ISDN connection across PSDN/ISDN network A and PSTN/ISDN network C,
and might be a VBR connection across IP network B.  Gateway switch/routers
a3, b1, b4, and c1 provide the interworking capabilities between the
PSDN/ISDN and IP networks.  The actual multimedia connection might be
routed, for example, on a path consisting of switch/routers
a1-a2-a3-b1-b4-c1-c2, or possibly on a different path through different
gateway switches.  In the Recommendation we do not address multipoint
connections, which are left for further study.  

In the Recommendation the most effective routing functionalities employed
within each network type are recommended for application across network
types by the gateway switch/routers, to enable and ease interworking.  The
Recommendation also describes several examples of interworking between
different routing methods across different network types, and the
information flows required for routing interworking among different routing
methods across different network types.

3.0 Definitions

Link:			a bandwidth transmission medium between switches
			that is engineered as a unit;
Destination switch:	terminating point within a given network;
Switch:			a switching center or aggregation of switching
			centers representing a network;
O-D pair:		an originating switch to destination switch pair for 
			a given connection request;
Originating switch:	originating point within a given network;
Path:			a concatenation of links providing a connection
			between an O-D pair;
Route:			a set of paths connecting the same O-D pair;
Routing table:		describes the route choices and selection rules to 
			select one path  out of the set for a connection 
			request
Traffic stream:		a class of connections with the same traffic
			characteristics;
Via switch:		a via point within a given dynamic routing network;

4.0 Intranetwork Routing Methods

In the following Sections we address the routing aspects of intranetwork
routing within PSTN, ATM, and IP networks, and includes considerations of a)
numbering, b) path selection, c) quality-of-service resource management, and
d) signaling and information exchange messaging.  In Section 4.1 we discuss
PSTN networks, in Section 4.2 we discuss ATM networks, and in Section 4.3 we
discuss IP networks.

4.1 PSTN Routing Methods

PSTN routing methods described in this Section include E.164/NSAP
numbering/addressing methods, automatic routing table generation methods,
dynamic path selection methods, and QoS resource management methods, all of
which have been deployed over the past two decades in PSTNs.  This
Recommendation suggests that compatible path selection and QoS resource
management methods be extended to ATM and IP networks and to interworking
between PSTN, ATM, and IP networks.


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 6]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


4.1.1 PSTN Numbering

Recommendation E.164 identifies the numbering plan currently used for PSTNs.
Recommendation E.191 specifies the B-ISDN address structure, which has a
20-byte format as shown in Figure 2 below. 

 <<Figure 2. NSAP Address Structure>> 

The IDP is the initial domain part and the DSP is the domain specific part.
The IDP is further subdivided into the AFI and IDI.  The IDI is the initial
domain identifier and can contain the 15-digit E.164 address if the AFI is
set to 45. AFI is the authority and format identifier and determines what
kind of addressing method is followed, and based on the 1 octet AFI value,
the length of the IDI and DSP fields can change.  The E.164/network service
access point (NSAP) address is used to determine the route to the
destination endpoint.  E.164/NSAP addressing for B-ISDN services is
supported in ATM networks using PNNI, through use of the above NSAP or ATM
end system address (AESA) format.  In this case the E.164 part of the NSAP
address occupies the 8 octet IDI, and the 11 octet DSP can be used at the
discretion of the network operator (perhaps for sub-addresses).  The above
NSAP structure also supports AESA DCC (data country code) and AESA ICD
(international code designator) addressing formats.

4.1.2 PSTN Path Selection

A specific traffic routing method is characterized by the routing table used
in the method.  The routing table consists of a route and rules to select
one path from the route for a given connection request.  When a connection
request arrives at its OS, the OS implementing the routing method executes
the path selection rules associated with the routing table for the
connection to determine a path among the paths in the route for the
connection request.  In a particular routing method, the set of routes
assignable to the connection request may be altered according to a certain
route alteration rule.  

A network is operated with progressive connection control, originating
connection control, or a mix of the two control methods.  In a network with
progressive connection control, a switch selects a path or a link to an
appropriate next switch.  In a network with originating connection control,
the OS maintains control of the connection.  If crankback (or automatic
rerouting (ARR)) is used, for example, at a via switch (VS), the preceding
switch maintains control of the connection even if the connections are
blocked on all the links outgoing from the VS.  When networks with
progressive connection control and originating connection control are
interworked, the network operates with a mix of both control methods.

In ITU-T Recommendations E.170, E.177, and E.DYN, traffic routing methods
are categorized into the following four types based on their routing
pattern: fixed routing (FR), time-dependent routing (TDR), state-dependent
routing (SDR), and event-dependent routing (EDR).  We discuss each of these
methods in the following paragraphs.

4.1.2.1 Fixed Routing (FR)

In a fixed routing (FR) method, a routing pattern is fixed for a connection
request.  A typical example of fixed routing is a conventional hierarchical


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 7]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


alternate routing where the route and route selection sequence are
determined on a preplanned basis and maintained over a long period of time.
FR is more efficiently applied when the network is nonhierarchical, or flat,
as compared to the hierarchical structure [A98]. 

4.1.2.2 Time-Dependent Routing (TDR)

Time-dependent routing (TDR) methods are a type of dynamic routing in which
the routing tables are altered at a fixed point in time during the day or
week.  TDR routing tables are determined on a preplanned basis and are
implemented consistently over a time period.  The TDR routing tables are
determined considering the time variation of traffic load in the network.
Typically, the TDR routing tables used in the network are coordinated by
taking advantage of noncoincidence of busy hours among the traffic loads.
Dynamic Nonhierarchical Routing (DNHR) is an example of  TDR, which is
illustrated in Recommendation E.DYN.

In TDR, the routing tables are preplanned and designed off-line using a
centralized design system, which employs the TDR network design model. The
off-line computation determines the optimal routes from a very large number
of possible alternatives, in order to minimize the network cost.  The
designed routing tables are loaded and stored in the various switches in the
TDR network, and periodically recomputed and updated (e.g., every week) by
the off-line system.  In this way an OS does not require additional network
information to construct TDR routing tables, once the routing tables have
been loaded.  This is in contrast to the design of routing tables in real
time, such as in the state dependent routing and event dependent routing
methods described below.  Routes in the TDR routing table may consist of
time varying routing choices and use a subset of the available paths.
Routes used in various time periods need not be the same.   Several TDR time
periods are used to divide up the hours on an average business day and
weekend into contiguous routing intervals, sometimes called load set
periods.  

Route selection rules employed in TDR routing tables, for example, may
consist of simple sequential routing.  In the sequential method all traffic
in a given time period is offered to a single path, and lets the first path
in the route overflow to the second path which overflows to the third path,
and so on.  Thus, traffic is routed sequentially from path to path, and the
route is allowed to change from hour to hour to achieve the preplanned
dynamic, or time varying, nature of the TDR method.  Other TDR route
selection rules can employ probabilistic techniques to select each path in
the route and thus influence the realized flows [A98].  

Paths in the TDR routing table may consist of the direct link, a two-link
path through a single VS, or a multiple-link path through multiple VSs.
Paths in the routing table are subject to depth-of-search (DoS)
restrictions, as described in the next Section 4.1.3.  DoS requires that the
bandwidth capacity available on each link in the path be sufficient to meet
a DoS bandwidth threshold level, which is passed to each switch in the path
in the setup message.  DoS restrictions prevent connections that route on
the first choice (shortest) OS-DS path, for example,  from being swamped by
alternate routed multiple-link connections.

A TDR connection set-up example is now given.  The first step is for the
switch to identify the DS and routing table information to the DS.  The OS


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 8]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


then tests for spare capacity on the first or shortest path, and in doing
this supplies the VSs and TS on this path, along with the DoS parameter, to
all switches in the path.  Each VS tests the available bandwidth capacity on
each link in the path against the DoS threshold.  If there is sufficient
capacity, the VS forwards the connection setup to the next switch, which
performs a similar function.  If there is insufficient capacity, the VS
sends a release message with crankback parameter back to the OS, at which
point the OS tries the next path in the route as determined by the routing
table rules.  As described above, the TDR routes are preplanned, loaded, and
stored in each OS

4.1.2.3 State-Dependent Routing (SDR)

In state-dependent routing (SDR), the routing tables are altered
automatically according to the state of the network.  For a given SDR
method, the routing table rules are implemented to determine the route
choices in response to changing network status, and are used over a
relatively short time period.  Information on network status may be
collected at a central processor or distributed to switches in the network.
The information exchange may be performed on a periodic or on-demand basis.
SDR methods use the principle of routing connections on the best available
path on the basis of network state information.  For example, in the least
loaded routing (LLR) method, the residual capacity of candidate paths is
calculated, and the path having the largest residual capacity is selected
for the connection.  In general, SDR methods calculate a path cost for each
connection request based on various factors such as the load-state or
congestion state of the links in the network.  dynamically controlled
routing (DCR), worldwide intelligent network (WIN) routing, and real-time
network routing (RTNR) are examples of SDR, which are illustrated in
Recommendation E.DYN.

In SDR, the routing tables are designed on-line by the OS or a central
routing processor (RP) through the use of network status and topology
information obtained through information exchange with other switches and/or
a centralized RP.  There are various implementations of SDR distinguished by


a)   whether the computation of the routing tables is distributed among
the network switches or centralized and done in a centralized RP, and
b)   whether the computation of the routing tables is done periodically
or connection by connection.

This leads to three different implementations of SDR:

a)   centralized periodic SDR -- here the centralized RP obtains link status
and traffic status information from the various switches on a periodic basis
(e.g., every 10 seconds) and performs a computation of the optimal routing
table on a periodic basis.  To determine the optimal routing table, the RP
executes a particular routing table optimization procedure such as LLR and
transmits the routing tables to the network switches on a periodic basis
(e.g., every 10 seconds).  DCR is an example of centralized periodic SDR, as
illustrated in E.DYN.

b)   distributed periodic SDR -- here each switch in the SDR network obtains
link status and traffic status information from all the other switches on a
periodic basis (e.g., every 5 minutes) and performs a computation of the


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 9]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


optimal routing table on a periodic basis (e.g., every 5 minutes).  To
determine the optimal routing table, the OS executes a particular routing
table optimization procedure such as LLR.  WIN is an example of distributed
periodic SDR, as illustrated in E.DYN.

c)   distributed call-by-call SDR -- here an OS in the SDR network obtains
link status and traffic status information from the DS, and perhaps from
selected VSs, on a connection by connection basis and performs a computation
of the optimal routing table for each connection.  To determine the optimal
routing table, the OS executes a particular routing table optimization
procedure such as LLR.  RTNR is an example of distributed
connection-by-connection SDR, as illustrated in E.DYN.

Paths in the SDR routing table may consist of the direct link, a two-link
path through a single VS, or a multiple-link path through multiple VSs.
Paths in the routing table are subject to DoS restrictions on each link, and
the connection setup mechanisms are similar to the example given in Section
4.1.2.2.  

4.1.2.4 Event-Dependent Routing (EDR)

In event-dependent routing (EDR), the routing tables are updated locally on
the basis of whether connections succeed or fail on a given path choice.  In
EDR, a connection is routed first to the shortest path, if it has sufficient
available bandwidth.  Otherwise, overflow from the shortest path is offered
to a currently selected alternate path.  If a connection is blocked on the
current alternate path choice, another alternate path is selected from a set
of available alternate paths for the connection request according to the
given EDR routing table rules.  For example, the current alternate path
choice can be updated randomly, cyclically, or by some other means, and may
be maintained as long as a connection can be established successfully on the
path.  Note that for either SDR or EDR, as in TDR, the alternate path for a
connection request may be changed in a time-dependent manner considering the
time-variation of the traffic load.  Dynamic alternate routing (DAR),
distributed adaptive dynamic routing (DADR), optimized dynamic routing
(ODR), and state- and time-dependent routing (STR) are examples of
event-dependent routing, which are illustrated in Recommendation E.DYN.

In EDR, the routing tables are designed by the OS using network information
obtained during the connection setup function.  Typically the OS first
selects the shortest path, and if that has insufficient bandwidth for the
connection then the current successful via path is tried.  If the current
successful via path has insufficient bandwidth, this condition is indicated
by a busy OS-VS link as determined by the OS or a busy VS-VS link or VS-DS
link as indicated by a release message sent from the VS to the OS.  At that
point the OS selects a new via path using the given EDR routing table design
rules.  Hence the routing table is constructed with the information
determined during connection setup, and no additional information is
required by the OS.  

Paths in the EDR routing table may consist of the direct link, a two-link
path through a single VS, or a multiple-link path through multiple VSs.
Paths in the routing table are subject to DoS restrictions on each link, and
the connection setup mechanisms are similar to the example given in Section
4.1.2.2.  



Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 10]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


4.1.3  PSTN QoS Resource Management

Efficient QoS resource management is needed for a host of existing and
ever-increasing new services.  For service performance, flexibility, and
reduced cost it is preferable to provide integration of these services on a
shared network.  Such integration and sharing is facilitated by dynamic path
selection methods and QoS resource management techniques.  Many
classes-of-service already exist and/or are being introduced, such as

a)   CBR services including voice, 64-, 384-, and 1,536-kbps N-ISDN
switched digital data, international switched transit, priority defense
communication, virtual private network, 800/free-phone, fiber preferred, and
other services.
b)   Real-time VBR services including IP-telephony, compressed video, and
other services.
c)   Non-real-time VBR services including WWW file transfer, credit card
check, and other services.
d)   UBR voice mail, email, file transfer, and other services.

These needs have led to a plan used in PSTNs to provide QoS resource
management to standardize service classification, bandwidth allocation and
protection, and priority routing treatment to all network services.  We now
illustrate some of the principles of QoS resource management [A98], which
are extended here to include B-ISDN traffic classes.

Through the use of bandwidth allocation, reservation, and congestion control
techniques, QoS resource management can provide good network performance
under normal and abnormal operating conditions for all services sharing the
integrated network.  Briefly, each connection request is classified by its
service identity (SI).  In the multi-service, QoS resource management
network, bandwidth is allocated to individual virtual networks, (VNs)  which
is protected as needed but otherwise shared.  A connection request for an
individual service is allocated an equivalent bandwidth equal to rj for
service j and routed on a particular VN.  For CBR services the equivalent
bandwidth rj is equal to the average or sustained bit rate.  For VBR
services the equivalent bandwidth rj is a function of the sustained bit
rate, peak bit rate, and perhaps other parameters.  For example, rj equals
64 kbps of bandwidth for CBR voice connections, 64 kbps of bandwidth for CBR
ISDN switched digital 64-kbps connections, and 384-kbps of bandwidth for CBR
ISDN switched digital 384-kbps connections.

Under normal non-blocking network conditions, all services fully share all
available bandwidth.  When blocking occurs for VN i, bandwidth reservation
acts to prohibit alternate-routed traffic and traffic from other VNs from
seizing the allocated capacity for VN i. Example mechanisms to allocate and
reserve bandwidth are now described.  Analogous mechanisms have been used in
practice and have been the subject of extensive studies [A98].  

4.1.3.1 Determination of QoS Resource Management Parameters

QoS resource management consists of the following steps:

1. At the OS, the TS and QoS resource management information are determined
through the digit translation database and other service information
available at the OS.


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 11]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


2. The TS and QoS resource management information are used to access the
appropriate VN and routing table between the OS and TS.
3. The connection request is set up over the first available path in the
routing table with the required transmission resource selected based on the
QoS resource management data.

In the first step, the OS translates the dialed digits to determine the
address of the TS.  If multiple ingress/egress routing is used, multiple
destination switch addresses are derived for the connection request.  Other
data derived from connection request information, such as link
characteristics, Q.931 message information elements, information interchange
(II) digits, and service control point (SCP) routing information, are used
to derive the QoS resource management parameters, which include service
identity (SI), virtual network (VN), and link capability (LC).  SI describes
the actual service associated with the connection request, VN describes the
bandwidth allocation and routing table parameters to be used by the
connection request, and the LC describes the link characteristics such as
fiber, radio, satellite, and voice compression, that the connection request
should require, prefer, or avoid.  

SI derivation can be derived based on the type of origin, type of
destination, signaling service type, and dialed number service type. The
type of origin can be derived normally from the type of incoming link,
connecting either to a directly connected customer equipment location, a
switched access local exchange carrier location, a national carrier
location, or an international carrier location. Similarly, based on the
numbering plan, the type of destination is derived and can be a directly
connected customer location if a private numbering plan is used (for
example, within a virtual private network), a switched access customer
location if a national numbering plan is used (such as the North American
Numbering Plan (NANP)), or an international customer location if the
international E.164 numbering plan is used.  Signaling service type is
derived based on bearer capability within signaling messages, information
interchange digits in dialed digit codes, numbering plan, or other signaling
information and can indicate long-distance service, virtual private network
service, ISDN switched digital service, and other service types.  Finally,
dialed number service type is derived based on special dialed number codes
such as 800 numbers or 900 numbers and can indicate 800 service, 900
service, and other service types. Type of origin, type of destination,
signaling service type, and dialed number service type can then be used to
derive the SI value from an SI mapping table.  This table is designed to be
updated administratively, in which new service information can be defined
without switch software modifications. 

>From the SI value, an SI-to-VN mapping table is used to derive the VN.
Associated with each VN are average bandwidth (BWavg) and maximum bandwidth
(BWmax) parameters to govern bandwidth allocation and protection, which are
discussed further in the next Section.  LC selection allows connection
requests to be routed on specific transmission links that have the
particular characteristics required by a connection requests.  A connection
request can require, prefer, or avoid a set of transmission characteristics
such as fiber transmission, radio transmission, satellite transmission, or
compressed voice transmission.  LC requirements for the connection request
can be determined from the SI or by other information derived from the
signaling message or dialed number.  The routing table logic allows the
connection request to skip those transmission paths that have links that


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 12]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


have undesired characteristics and to seek a best match for the requirements
of the connection request.

4.1.3.2 Bandwidth Management and Priority Queuing

The VN routing table determines which network capacity is allowed to be
selected for each connection request.  In using the VN routing table to
select network capacity, the OS selects a first choice path based on the
routing table selection rules.  Whether or not bandwidth can allocated to
the connection request on the first choice path is determined by the QoS
resource management rules given below.  If a first choice path cannot be
accessed, the OS may then try alternate paths determined by FR, TDR, SDR, or
EDR path selection rules outlined in Section 4.1.2.  Whether or not
bandwidth can be allocated to the connection request on the alternate path
again is determined by the QoS resource management rules now described.  

In the QoS resource management method, the call admission control for each
link in the path is performed based on the status of the link. The OS may
select any path for which the first link is allowed according to QoS
resource management criteria.  If a subsequent link is not allowed, then a
release with crankback is used to return to the OS and select an alternate
path.  The release with crankback is an alternative to flooding of
frequently changing link state parameters such as available-bandwidth
capacity, and the reduction in the frequency of such dynamic parameter
flooding allows for larger peer group sizes.  The use of crankback is then
an alternative to the use of a generic call admission control (GCAC)
algorithm at the OS to predict which subsequent links in the path will be
allowed.  Also the QoS resource management strategy is a per-VN strategy as
opposed to a per-virtual-circuit (per-VC) strategy.

Determination of the link load states is necessary for QoS resource
management to select network capacity on either the first choice path or
alternate paths.  Four link load states are distinguished: lightly loaded
(LL), heavily loaded (HL), reserved (R), and busy (B).  QoS resource
management implements a bandwidth reservation logic to favor connections
routed on the first choice path in situations of link congestion.  If link
blocking is detected, bandwidth reservation is immediately triggered and the
reservation level N is set for the link according to the level of link
congestion.  In this manner traffic attempting to alternate-route over a
congested link is subject to bandwidth reservation, and traffic on the first
choice path is favored for that link.  At the same time, the LL and HL link
state thresholds are raised accordingly in order to accommodate the reserved
bandwidth capacity for the VN.  Illustrations are given in [A98] of the
robustness of dynamic bandwidth reservation in protecting the preferred
traffic across wide variations in traffic conditions.

As stated above, there is a reservation level N calculated for each link k
based on the link blocking level and the estimated link traffic.  The link
blocking level is equal to the equivalent bandwidth overflow count divided
by the equivalent bandwidth peg count over the last periodic update
interval, which is typically three minutes.  That is



Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 13]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


	BWOVk		= 	equivalent bandwidth overflow count on link
				k
	BWPCk		= 	equivalent bandwidth peg count on link k
	LBLk		=	link blocking level on link k
			=	BWOVk/BWPCk

If LBLk exceeds a threshold value, the reservation level N is calculated,
for example, at one of four levels.  The reserved bandwidth and link states
are calculated based on the following quantities:

	TBWk		=	the total bandwidth required on link k to
				meet the blocking 
				probability grade-of-service objective for
				connection requests
				on their first path choice.  

TBWk is computed on-line, for example every 1-minute interval, and
approximated as follows:

	TBWk(n)		=	.5 x  TBWk(n-1) + .5 x [ 1.1 x  TBWIPk(n) +
				TBWOVk(n) ]
	TBWIPk		=	sum of the bandwidth in progress (BWIPi) for
				all VNs i
				for connections on their first choice path
				over link k
	TBWOVk		=	sum of bandwidth overflow (BWOVi) for all VNs i
				for connections on their first choice path
				over link k

Illustrative values of the thresholds to determine link load states are as
follows:


	Table 1.  Determination of Link Load State

	---------------------------------------------
	Name of State		Condition
	---------------------------------------------
	Busy  B			ILBWk *  rj
	Reserved  R		ILBWk * Rthrk
	Heavily Loaded	HL	Rthrk < ILBWk * HLthrk
	Lightly Loaded	LL	HLthrk < ILBWk

where

	ILBWk		=	idle link bandwidth on link k
	rj		=	equivalent bandwidth for service j
	Rthrk		=	reservation bandwidth threshold for link k
			=	N x .05 x TBWk 
	N		=	bandwidth reservation level
	HLthrk		=	heavily loaded bandwidth threshold for link
				k
			=	Rthrk + .05 x TBWk



Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 14]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


Therefore the reservation level and load state boundary thresholds are
proportional to the estimated offered bandwidth traffic load, which means
that the bandwidth reserved and the bandwidth required to constitute a
lightly loaded link rise and fall with the traffic load, as, intuitively,
they should.

Selection of path capacity uses the link state model and path selection
depth-of-search (DoS) model to determine if a connection request can be
routed on a given path.  The path selection DoS model provides that there is
a minimum guaranteed bandwidth BWavgi  for each VN i.  The DoS model
involves the following parameters:

	BWIPavgi	=	average bandwidth-in-progress on VN i
	BWavgi 		= 	minimum guaranteed bandwidth required for VN
				i to carry the average 
				offered bandwidth load
	BWmaxi 		= 	the bandwidth required for VN i to meet the 
				blocking probability grade-of-service 
				objective
	       		= 	1.1 x BWavgi

The quantities BWavgi are computed periodically, such as every week, and can
be exponentially averaged over a several week period, as follows:

	BWavgi(n)	=	.5 x  BWavgi(n-1) + .5 x [ BWIPavgi(n) +
				BWOVavgi(n) ]

where BWavg and BWIP have been defined above, n denotes week n, and 

	BWOVavgi	=	average bandwidth overflow for VN i for 
				connections on their first choice route over
				link k

Typically, the BWavgi thresholds for a VN are determined weekly based on
these exponentially smoothed estimates of BWIPi and BWOVi averaged across
various load set periods, such as morning, afternoon, and evening averages
for weekday, Saturday, and Sunday.

In setting up the connection request, the OS encodes the DoS load state
threshold allowed on each link in the setup message.  If a link is
encountered at a VS in which the ILBWk and link load state are below the DoS
load state threshold, then the VS sends a crankback message to the OS, which
can then route the connection request to an alternate path choice.  The DoS
load state threshold is given as follows:




Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 15]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


Table 2.  Determination of Depth-of-Search (DoS) Load State Threshold

------------------------------------------------------------------------------
Load State  Key Service	             Normal Service		Best Effort 
Allowed                    ----------------------------------   Service
                 	   First Choice Path	Alternate Path	
------------------------------------------------------------------------------
R	    if BWIPi <=    if BWIPi <= BWavgi	Not Allowed	Not Allowed
            2 * BWmaxi	
HL	    if BWIPi <=    if BWIPi <= BWmaxi	if BWIPi <=     Not Allowed
            2 * BWmaxi	                        BWavgi
LL	    All BWIPi	   All BWIPi	        All BWIPi	All BWIPi

Note that the QoS resource management method provides for key service and
best effort service, which are based on a per-VN priority method as opposed
to a per-VC priority method.  Key services are given higher priority routing
treatment by allowing greater path selection DoS than normal services.  Best
effort services are given lower priority routing treatment by allowing
lesser path selection DoS than normal.
In addition to the QoS bandwidth management procedure at the time of
connection request set-up, a QoS priority of service (PoS) queuing
capability is used during the time the connection is established.  At each
link, a queuing discipline is maintained such that the packets or cells
being served are given priority in the following order: CBR -key service,
VBR - real-time key service, VBR - non-real-time key service, CBR - normal
service, VBR - real-time normal service, VBR - non-real-time normal service,
and UBR - best effort service.  This PoS priority queuing method is
therefore a per-VN method as opposed to a per-VC method. 

4.1.3.3 Link Capability Selection

Link capability (LC) selection allows connection requests to be routed on
specific transmission media that have the particular characteristics
required by these connection requests.  In general, a connection request can
require, prefer, or avoid a set of transmission characteristics such as
fiber optic or radio transmission, satellite or terrestrial transmission, or
compressed or uncompressed transmission.  The routing table logic allows the
connection request to skip links that have undesired characteristics and to
seek a best match for the requirements of the connection request.  For any
SI, a set of LC selection preferences may be specified for the connection
request. LC selection preferences can override the normal order of selection
of paths.  If a LC characteristic is required, then any path with a link
that does not have that characteristic is skipped.  If a characteristic is
preferred, paths having all links with that characteristic are used first.
Paths having links without the preferred characteristic will be used next.
A LC preference may be set for the presence or absence of a characteristic.
For example, if fiberoptic transmission is required, then only paths with
links having Fiberoptic=Yes are used.  If we prefer the presence of
fiberoptic transmission, then paths having all links with Fiberoptic=Yes are
used first, then paths having some links with Fiberoptic=No.

4.1.4  PSTN Signaling and Information Exchange Messaging

PSTN network signaling protocols are described for example in Recommendation
Q.2761 that describes the Broadband ISDN Used Part (B-ISUP) signaling
protocol.  We also summarize here the information exchange required between
network elements to implement the PSTN path selection methods, which include


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 16]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


connection control information required for connection set up, routing table
design information required for routing table generation, and topology
update information required for the automatic update and synchronization of
topology databases.

4.1.4.1 Connection Control Information

Connection control information is used in connection set up to seize
bandwidth in links, to release bandwidth in links, and for purposes of
advancing path choices in the routing table.   Existing connection setup and
release messages, as described in Recommendations Q.71 and Q.2761, can be
used with additional parameters to control path selection, DoS on a link, or
crankback to an OS for further alternate routing.  Actual selection of a
path is determined from the routing table, and connection control
information is used to establish the path choice.  Forward information
exchange is used in connection set up, and includes for example the
following parameters:

1.	SETUP-DTL:  The designated transit list (DTL) parameter specifying
each VS and the TS in the path, and used by each VS to determine the next
switch in the path.
2.	SETUP-DOS:  The DoS parameter used by each VS to compare the load
state on the link to the allowed DoS to determine if the connection request
is admitted or blocked on that link.

In B-ISUP these parameters could be carried in the initial address message
(IAM).  In PNNI signaling, these parameters would be carried in the SETUP
message.

Backward information exchange is used to release a connection on a link such
as from a DS to a VS or from a  VS to an OS, and includes for example the
following parameter:

1.	RELEASE-CB:  The crankback parameter in the release message sent
from the VS to OS or DS to OS, and allows for possible further alternate
routing at the OS.

In B-ISUP signaling this parameter could be carried in the RELEASE message,
and in PNNI signaling the parameter is already defined.

4.1.4.2 Routing Table Design Information.  

Routing table design information is used for purposes of applying the
routing table design rules for determining path choices in the routing
table.  This information is exchanged between one switch and another switch,
such as between the OS and DS, for example, or between a switch and a
network element such as a routing processor (RP).  This information is used
to generate the routing table, and then the routing table is used to
determine the path choices used in the selection of a path.  The following
messages can be considered for this function:


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 17]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


1.	QUERY:  Provides for an OS to DS or OS to RP link and/or switch
status request.
2.	STATUS:  Provides OS/VS/DS to RP or DS to OS link and/or switch
status information.
3.	RECOM: Provides for an RP to OS/VS/DS routing recommendation.

These information exchange messages are already deployed in non-standard
implementations, and need to be extended to standard PSTN (as well as ATM
and IP) environments. 

4.1.4.3 Topology Update Information.

In order to achieve automatic update and synchronization of the topology
database, which is essential for routing table design, PSTNs need to
interpret at the gateway switches the Hello protocol mechanisms of PNNI and
IP networks to identify links in the network, as discussed in Section 4.2
for ATM networks.  Also needed for topology database synchronization is a
mechanism analogous to the PNNI topology state element (PTSE) exchange, as
discussed in Section 4.2, which automatically provisions switches, links,
and reachable addresses in the topology database.  In this case PTSE might
stand for PSTN topology state element.

1.	HELLO: Provides for the identification of links between switches in
the network.
2.	PTSE: Provides for the automatic updating of switches, links, and
reachable addresses in the topology database.

4.1.4.4 Examples of Information Exchange

In this Section we illustrate the use of information exchange in setting up
a connection for the routing methods discussed in Section 4.1.2.  Here we
show the use of the forward and backward information exchange used for
connection control and routing table design purposes. 

A connection set-up example is now given, which applies to FR, TDR, SDR, and
EDR path selection.  The first step is for the OS to identify the DS and the
routing table information for routing a connection to the DS.  The OS then
tests for spare capacity on the first or shortest path, and in doing this
supplies the VSs and TS on this path in the SETUP-DTL parameter of the SETUP
message, along with the DoS threshold in the SETUP-DOS parameter, to all
switches in the path.  Each VS tests the available bandwidth capacity on
each link in the path against the SETUP-DOS DoS threshold.  If there is
sufficient bandwidth capacity, the VS forwards the connection setup to the
next switch specified in the SETUP-DTL parameter, and the next switch then
performs a similar function.  If there is insufficient bandwidth capacity,
the VS sends a release message with crankback parameter RELEASE-CB back to
the OS, at which point the OS tries the next path in the route as determined
by the routing table rules. 

Routing table design information flow examples are now discussed for the
three cases of SDR, as described in Section 4.1.2.3.  In centralized
periodic SDR, for example, each switch periodically (say every 10 seconds)
sends forward STATUS information to the routing processor (RP), which
communicates the necessary load and traffic status information to the RP.
In return the RP sends routing recommendation RECOM information to each
switch periodically (say every 10 seconds), which contain alternate path


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 18]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


information for each OS-DS switch pair.  In distributed periodic SDR, for
example, each switch periodically (say every 5 minutes) sends forward STATUS
information to every other switch, which communicates the necessary load and
traffic status information.  In distributed call-by-by SDR, for example,
following a first step in which the OS tries and fails to set up a
connection on the first choice direct path, the OS then sends a forward
status QUERY request to the DS.  The DS responds to the OS with backward
STATUS information, which contains the load and traffic status information.
In each of these examples, the status information is used by the OS or RP
for routing table design, as discussed in Section 4.1.2.3.  

4.2 ATM/PNNI Routing Methods

In ATM networks the private network-to-network interface (PNNI) standard
adopted by the ATM Forum [ATM96a] provides for a) exchange of switch and
link status information, b) automatic update and synchronization of topology
databases, c) fixed and/or dynamic path selection based on topology and
status information, and d) signaling and information exchange messaging
standards.  

PNNI is a standardized signaling and dynamic routing strategy for ATM
networks adopted by the ATM Forum in 1996 [ATM96].  PNNI provides
interoperability among different vendor equipment and scaling to very large
networks.  Scaling is provided by a hierarchical peer group structure that
allows the details of topology of a peer group to be flexibly hidden or
revealed at various levels within the hierarchical structure.  Peer group
leaders represent the switches within a peer group for purposes of routing
protocol exchanges at the next higher level.  Border switches handle
inter-level interactions at call setup.  PNNI routing involves two
components: a topology distribution protocol and the path selection and
crankback procedures.  The topology distribution protocol floods information
within a peer group.  The peer group leader abstracts the information from
within the peer group and floods the abstracted topology information to the
next higher level in the hierarchy, including aggregated reachable address
information.  As the peer group leader learns information at the next higher
level, it floods it to the lower level in the hierarchy, as appropriate.  In
this fashion, all switches learn of network-wide reachability and topology.

Automatic update and synchronization of topology database methods,
information exchange messaging methods, and connection control signaling
methods have been deployed over the past two decades in ATM networks, and
this Recommendation suggests that compatible topology database
synchronization, information exchange messaging, and connection control
signaling methods be extended to PSTN and IP networks and to interworking
between PSTN, ATM, and IP networks.  For topology database synchronization,
each switch in an ATM/PNNI network exchanges HELLO packets with its
immediate neighbors and thereby determines its local state information. This
state information includes the identity and peer group membership of the
switch's immediate neighbors, and the status of its links to the neighbors.
Each switch then bundles its state information in PNNI topology state
elements (PTSEs), which are reliably flooded throughout the peer group.  The
PTSEs are used to flood switch information, link state information, and
reachability information.

Some of the topology state information is static and some is dynamic. For
example, static information may consist of the existence of a link, and


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 19]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


dynamic information may refer to the available bandwidth on a link.
Depending on how the dynamic topology state information is used, the maximum
peer group size, as measured by the number of switches and links may be
limited if PTSEs swamp the ability of the switches to process connection
requests.  In order to allow larger peer group sizes, a network can use PNNI
in such a way so as to minimize the amount of dynamic topology state
information flooding by setting thresholds such as the AvCR_PM (average cell
rate proportional multiplier) to 99 instead of the default value of 50, and
AvCR_mT (average cell rate minimum threshold) to 99 instead of the default
value of 3. Reachability information is exchanged between all switches. To
provision a new E.164 number, the switch serving that E.164 number is
provisioned. The reachability information is then flooded to all the
switches in the network using the PNNI PTSE flooding mechanism.  A peer
group in PNNI is defined at a given hierarchical level.  Multiple
hierarchical levels are permitted within an ATM/PNNI network, and multiple
peer groups can be defined at each level

4.2.1 ATM Numbering

ITU-T Recommendation E.191 specifies the ATM network numbering, and as
discussed in Section 4.1.1 provides for the embedded E.164/NSAP formats,
which are desirable for use in B-ISDN.

4.2.2 ATM Path Selection

PNNI path selection is source-based in which the OS determines the
high-level path through the network.  The OS performs number translation,
screening, service processing, and all steps necessary to determine the
routing table for the connection request across the ATM network. The switch
places the selected path in the DTL and passes the DTL to the next switch in
the SETUP message. The next switch does not need to perform number
translation on the called party number but just follows the path specified
in the DTL.  When a connection request is blocked due to network congestion,
a PNNI crankback is sent to the first ATM switch in the peer group.  The
first ATM switch may then use the PNNI  alternate routing after crankback
capability to select another route for the connection request.

If the network is flat, that is, all switches have the same peer group
level, the OS controls the edge-to-edge path.  If the network has more than
one level of hierarchy, as the call progresses from one peer group into
another, the border switch at the new peer group selects a path through that
peer group to the next peer group downstream, as determined by the OS.  This
occurs recursively through the levels of hierarchy.  If at any point the
call is blocked, for example when the selected path bandwidth is not
available, then the call is cranked back to the border switch or OS for that
level of the hierarchy and an alternate path is selected.  The path
selection algorithm is not stipulated in the PNNI specification, and each OS
implementation can make its own path selection decision unilaterally.  Since
path selection is done at an OS, each OS makes path selection decisions
based on its local topology database and specific algorithm.  This means
that different path selection algorithms from different vendors can
interwork with each other.
 
In the PNNI routing example illustrated in Figure 3, an OS S1 determines a
list of shortest paths by using, for example, Dijsktra's algorithm.  This
path list could be determined based on administrative weights of each link


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 20]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


which are communicated to all switches within the peer group through the
PTSE flooding mechanism.  These administrative weights may be set, for
example, to 1 + epsilon x distance, where epsilon is a factor giving a
relatively smaller weight to the distance in comparison to the hop count.
The OS then selects a path from the list based on any of the methods
described in Section 4.1, that is FR, TDR, SDR, and EDR.  For example, in
using the first choice path, the OS S1 sends a PNNI setup message to VS S2,
which in turn forwards the PNNI setup message to VS S3, and finally to TS
S4.  The VSs S2 and S3 and TS S4 are passed in the DTL parameter contained
in the PNNI setup message.  Each switch in the path reads the DTL
information, and passes the PNNI setup message to the next switch listed in
the DTL.  

 <<Figure 3. PNNI Routing Example>> 

Figure 3. PNNI Routing Example

If the first path is blocked at any of the links in the path, or overflows
or is excessively delayed at any of the queues in the path, a crankback
message is returned to the OS which can then attempt the next path.  If FR
is used, then this path is the next path in the shortest path list, for
example path S1-S6-S7-S8-S4.  If TDR is used, then the next path is the next
path in the routing table for the current time period.  If SDR is used, PNNI
implements a distributed method of flooding link status information, which
is triggered either periodically and/or by crossing load state threshold
values.  As described in the beginning of this Section, this flooding method
of distributing link status information can be resource intensive and indeed
may not be any more efficient than simpler path selection methods such as
EDR.  If EDR is used, then the next path is the last successful path, and if
that path is unsuccessful another alternate path is searched out according
to the EDR path selection method.

4.2.3 ATM QoS Resource Management

The methods described in Section 4.1.3 are applicable to ATM networks since
they have been generalized for the ATM B-ISDN protocols.  As discussed in
Section 4.1.4.1, the DoS parameter is carried in the CCS IAM or PNNI SETUP
message, so that each VS can compare the load state on the link to the
allowed DoS threshold to determine if the connection request is admitted or
blocked on that link.

4.2.4 ATM Signaling and Information Exchange Messaging

PNNI incorporates standard signaling and messaging directly applicable to
routing implementation, which includes the DTL, crankback, HELLO, and PTSE
capabilities.  Additional requirements needed to support QoS resource
management include the DoS parameter in the PNNI SETUP message, as discussed
in Section 4.1.3.

4.3  IP Routing/Switching Methods

In IP networks the open shortest path first (OSPF) standard [M98, S95] for
intra-domain routing, the border gateway protocol (BGP) [S95] for
inter-domain routing, and other routing protocols [S95], have been adopted
by the Internet Engineering Task Force (IETF).  These protocols provide for
a) exchange of switch/router and link status information, b) automatic


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 21]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


update and synchronization of topology databases, and c) fixed and/or
dynamic path selection based on topology and status information.  Automatic
update and synchronization of topology database methods have been deployed
over the past two decades in IP networks, and this Recommendation suggests
that compatible topology database synchronization methods be extended to
PSTN networks and to interworking between PSTN, ATM, and IP networks.  For
topology database synchronization, each switch/router in an IP/OSPF/BGP
network exchanges HELLO packets with its immediate neighbors and thereby
determines its local state information. This state information includes the
identity and group membership of the switch/router's immediate neighbors,
and the status of its links to the neighbors. Each switch/router then
bundles its state information in link state advertisements (LSAs), which are
reliably flooded throughout the autonomous system (AS), or group of
switch/routers exchanging routing information and using a common routing
protocol, which is analogous to the PNNI peer group.  The LSAs are used to
flood switch information, link state information, and reachability
information.  As in PNNI, some of the topology state information is static
and some is dynamic.  In order to allow larger AS group sizes, a network can
use OSPF in such a way so as to minimize the amount of dynamic topology
state information flooding by setting thresholds to values that inhibit
frequent updates.
 
IP routing of connection requests and QoS support are in the process of
standardization primarily within the MPLS and differentiated services
(diffserv) [ST98] activities in the IETF.  Therefore we make several
assumptions regarding IP routing needs:

a)	Path selection in the IP network is assumed to employ multiprotocol
label switching (MPLS) with a label distribution protocol (LDP) [ADFFt98,
GWA97, KON97] or a resource reservation protocol (RSVP) [BZBHJ97] for
"connection establishment" that functions efficiently on a per-connection
basis.  
b)	It is assumed that the LDP "signaling protocol" interworks with the
B-ISUP and PNNI signaling protocols to accommodate setup and release of
connection requests.
c)	The LDP "setup message" is assumed to carry the DTL parameter
specifying the VSs/routers and TS/router in the selected routing path (such
as provided in the diffserv bandwidth broker [ST98] or analogous
mechanisms), and the DoS parameter specifying the allowed bandwidth
selection threshold on a link (the DoS parameter may be carried in the IP
type-of-service TOS parameter).
d)	The LDP "release message" is assumed to carry the crankback
parameter specifying return of control of the connection request to the
OS/router, for possible further alternate routing.
e)	Connectionless IP traffic which is detected as an "IP Flow", or a
stream of like IP packets between the same OS and DS, is assumed to be
routed as a connection request within the MPLS/LDP protocol.
f)	Connectionless IP traffic not classified as an IP flow is assumed to
use the best-effort UBR traffic class.

An IP device control (IPDC) protocol [D.xxx, E.98] is currently being
defined which includes call control signaling transport and connection
control ,and the LDP setup and release messages for MPLS routing would be
coordinated with the IPDC call control signaling protocol for connection
setup and release with the DTL, DoS, and crankback parameters defined above.



Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 22]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


Given these assumptions, the following functions are performed within a
given AS switch/router group:

1.	Reachability information is exchanged between all switches/routers.
To provision a new IP address, the switch/router serving that IP address is
provisioned. The reachability information is then flooded to all the
switches/routers in the network using the OSPF LSA flooding mechanism.
2.	The OS/router performs destination address translation, screening,
service processing, and all steps necessary to determine the routing table
for the connection request across the IP network. The OS/router places the
selected path in the DTL parameter and passes the DTL parameter to the next
switch/router in the LDP connection request setup message. The next
switch/router does not need to perform destination address translation but
just follows the path specified in the DTL parameter.
3.	When a connection request is blocked due to network congestion, an
LDP release message with the crankback parameter is sent to the originating
IP switch/router in the AS group. The originating IP switch/router may then
perform alternate routing after crankback to select another route for the
connection request.

4.3.1 IP Numbering

IP networks employ an IP addressing method to identify switch/router
endpoints [S94].  A mechanism is needed to translate E.164 NSAPs to IP
addresses in an efficient manner.  Work is underway in the TIPHON
(telecommunications and internet protocol harmonization over networks)
effort [ETSIa, ETSIb, ETSIc, ETSId, ETSIe], and in the IPDC (internet
protocol device control) effort [D.xxx, E98] to interwork between IP
addressing and E.164 numbering/addressing.  TIPHON is proposing a
translation database to convert E.164 addresses to IP addresses.  With such
a capability, IP switches/routers could make this translation of E.164 NSAPs
directly, and thereby provide interworking with PSTN and ATM networks based
on E.164 numbering and addressing.  If this is the case, then E.164 NSAPs
could become a standard addressing method for interworking across PSTN, ATM
and IP networks.

4.3.2 IP Path Selection

As stated above, path selection in the IP network is assumed to employ MPLS
with the LDP protocol that functions efficiently on a per-connection basis.
In OSPF-based layer 3 routing, similar to the example shown in Figure 3, an
OS/router S1 determines a list of shortest paths by using, for example,
Dijsktra's algorithm.  This path list could be determined based on
administrative weights of each link, which are communicated to all
switches/routers within the AS group.  These administrative weights may be
set, for example, to 1 + epsilon x distance, where epsilon is a factor
giving a relatively smaller weight to the distance in comparison to the hop
count.   The OS/router selects a path from the list based on, for example,
FR, TDR, SDR, or EDR path selection.  For example, in using the first path,
the OS/router S1 sends an LDP setup message to VS/router S2, which in turn
forwards the LDP setup message to VS/router S3, and finally to TS/router S4.
The VSs/routers S2 and S3 and TS/router S4 are passed in the DTL parameter
contained in the LDP setup message.  Each switch/router in the path reads
the DTL information, and passes the LDP setup message to the next
switch/router listed in the DTL.  If the first path is blocked at any of the
links in the path, or overflows or is excessively delayed at any queues in


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 23]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


the path, an LDP release message with crankback parameter is returned to the
OS/router which can then attempt the next path.  If FR is used, then this
path is the next path in the shortest path list, for example path
S1-S6-S7-S8-S4.  If TDR is used, then the next path is the next path in the
routing table for the current time period.  If SDR is used, OSPF implements
a distributed method of flooding link status information, which is triggered
either periodically and/or by crossing load state threshold values.  As
described in the beginning of this Section, this method of distributing link
status information can be resource intensive and indeed may not be any more
efficient than simpler path selection methods such as EDR.  If EDR is used,
then the next path is the last successful path, and if that path is
unsuccessful another alternate path is searched out according to the EDR
path selection method.

4.3.3 IP QoS Resource Management

The methods described in Section 4.1.3 need to be extended to IP networks to
interwork with PSTN and ATM networks.  As in the QoS resource management
method discussed in Section 4.1.4.1, the DoS parameter is carried in the LDP
setup message, so that each VS can compare the load state on the link to the
allowed DoS threshold to determine if the connection request is admitted or
blocked on that link.  In the IP network, the LDP setup message would need
to carry the allowed DoS parameter as well.

4.3.4 IP Signaling and Information Exchange Messaging

As discussed above, the LDP setup and release protocol for connection
requests and detected IP flows needs to include the DTL parameter and DoS
parameter in the LDP setup message, as well as the LDP crankback parameter
in the LDP release message.  The IPDC protocol [D.xxx, E98] currently being
defined, which includes call control signaling transport and connection
control, needs to be coordinated with the LDP setup and release messages for
MPLS routing with the DTL, DoS, and crankback parameters defined above. 

Following the MPLS connection setup and the application of QoS resource
management rules, the PoS (priority of service) parameter and label
parameter need to be sent in each IP packet, as illustrated in Figure 4.  

 <<Figure 4. Packet Structure Under MPLS Switching>> 

The PoS parameter can be included in the type of service (TOS)/diffserv
parameter already in the IP packet header, and the label parameter,
corresponding to the "virtual circuit" and "virtual path" used in ATM, is
contained in the MPLS label or "shim" appended to the IP packet.  From the
PoS parameter, the IP switch/router can determine the QoS treatment based on
the QoS resource management (priority queuing) rules discussed in Section
4.1.  From the label parameter, the IP switch/router can determine the next
switch/router to route the IP packet to as defined by the MPLS protocol.  In
this way, the backbone switches/routers can have a very simple per-packet
processing implementation to implement QoS and MPLS routing..

5.0 Internetwork Routing Methods

In this Section, the most effective routing functionalities employed within
each network type  discussed in Section 4 are recommended for application
across network types, to enable and ease interworking. Adapting these


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 24]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


capabilities, or their equivalents, for use within each network type and for
interworking between network types builds on these well studied, documented,
deployed, and proven methods.  It also increase the likelihood of backward
compatibility to existing capabilities as new interworking standards are
adopted and implemented.

5.1 Internetwork Numbering

The E.164/NSAP based numbering and addressing method discussed in Section
4.1.1 and applied successfully in PSTN and ATM networks over the past two
decades,  is recommended for internetwork routing.  Therefore this
numbering/addressing method needs to be extended to IP networks, and as
discussed in Section 4.3.1, work is underway in the TIPHON effort [ETSIa,
ETSIb, ETSIc, ETSId, ETSIe] and in the IPDC effort [D.xxx, E98] to interwork
between IP addressing and E.164 numbering/addressing.  TIPHON is proposing a
translation database to convert E.164 addresses to IP addresses.  With such
a capability, IP switches/routers could make this translation of E.164 NSAPs
directly, and thereby provide interworking with PSTN and ATM networks based
on E.164 numbering and addressing.  If this is the case, then E.164 NSAPs
could become a standard addressing method for interworking across PSTN, ATM
and IP networks.

5.2 Internetwork Path Selection

The automatic generation of routing tables based on network topology and
status, which has been applied successfully in PSTN, ATM, and IP networks
over the past two decades, is recommended for internetwork routing.  In
particular, originating switch or source routing is recommended to avoid
looping and to allow interworking of different path selection methods.
Source routing can be implemented through the use of connection control
signaling methods employing the DTL parameter in the SETUP/IAM message and
the crankback parameter in the RELEASE message.  The DTL parameter specifies
all VSs and TS in a path, as determined by the OS, and the crankback
parameter allows a VS to return control of the connection request to the OS
for further alternate routing.  Path selection methods should allow the use
of FR, TDR, SDR, and EDR path selection, as discussed in Section 4.1, and
the use of multilink shortest paths in a sparse network topology.  Use of a
single peer group with nonhierarchical routing is also recommended, and as
discussed in Sections 4.2 and 4.3, is best achieved by minimizing the use of
PTSE flooding for dynamic topology state information.

5.3 Internetwork QoS Resource Management  

The QoS resource management methods discussed in Section 4.1.3 and applied
successfully in PSTNs over the past decade, are recommended for internetwork
routing. Therefore these methods need to be extended to ATM and IP networks,
as discussed in Sections 4.2.3 and 4.3.3.  In the QoS resource management
method, the call admission control for each link in the path is performed
based on the status of the link. The OS may select any path for which the
first link is allowed according to QoS resource management criteria.  If a
subsequent link is not allowed, then a release with crankback is used to
return to the OS and select an alternate path.  The release with crankback
is an alternative to flooding of frequently changing link state parameters
such as available-bandwidth capacity, and the reduction in the frequency of
such parameter flooding allows for larger peer group sizes.  The use of
crankback is then an alternative to the use of a GCAC algorithm at the OS to


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 25]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


predict which subsequent links in the path will be allowed.

QoS resource management entails determining QoS resource management
parameters including SI, VN, BWavg, and BWmax. The VN routing table
determines which network capacity can be selected for each connection
request.  In using the VN routing table to select network capacity, the OS
selects a first choice path based on the routing table selection rules, and
sends the DTL parameter in the SETUP/IAM message to each VS and the TS in
the selected path.  Whether or not bandwidth can allocated to the connection
request on the first choice path is determined by the QoS resource
management rules, which entail determining link state and comparing the link
load state to a DoS parameter sent in the SETUP/IAM message.  The allowed
DoS, as given in Table 2, is based on the bandwidth-in-progress, link load
state, routing priority, and whether the path is a first choice path or
alternate path.  If the first choice path cannot be accessed, a VS or TS
returns control to the OS through the use of a crankback parameter in the
RELEASE message, and at that point the OS may then try alternate paths
determined by FR, TDR, SDR, or EDR path selection rules outlined in Section
4.1.2.  Whether or not bandwidth can be allocated to the connection request
on the alternate path again is determined by the use of the DoS parameter
compared to the link load state.  Priority queuing is used during the time
the connection is established, and at each link the queuing discipline is
maintained such that the packets or cells are given priority according to
the traffic class and routing priority, as described in Section 4.1.3.2.  

5.4 Internetwork Signaling and Information Exchange Messaging

The connection control signaling methods discussed in Section 4.2 and
applied successfully in ATM networks over the past two decades, are
recommended for internetwork routing.  These signaling methods include OS
controlled (source) routing, specification of VSs and TSs in a DTL parameter
in the SETUP/IAM message, and return of control to the OS with a crankback
parameter in the RELEASE message.  These methods need to be extended to PSTN
and IP networks, as discussed in Sections 4.1 and 4.3.  The DoS parameter
needs be extended to the SETUP/IAM messages in PSTN, ATM, and IP networks,
as discussed in Sections 4.1, 4.2, and 4.3.  As discussed in Section 4.3,
the LDP SETUP and RELEASE protocol for connection requests and detected IP
flows needs to include the DTL parameter and DoS parameter in the LDP setup
message, as well as the LDP crankback parameter in the LDP release message.
The IPDC protocol [D.xxx, E98] currently being defined, which includes call
control signaling transport and connection control, needs to be coordinated
with the LDP setup and release messages for MPLS routing such that these
messages include the DTL, DoS, and crankback parameters.

As discussed in Section 4.3, following MPLS connection setup and application
of QoS resource management rules, the PoS parameter and label parameter need
to be sent in each IP packet, as illustrated in Figure 3.  The PoS parameter
can be included in the type of service (TOS)/diffserv parameter already in
the IP packet header, and the label parameter is contained in the label or
shim appended to the IP packet.  From the PoS parameter, the IP
switch/router can determine the QoS treatment based on the QoS resource
management (priority queuing) rules discussed in Section 4.1.  From the
label parameter, the IP switch/router determines the next switch/router to
route the IP packet to as defined by the MPLS protocol.  In this way, the
backbone switches/routers can have very simple per-packet processing
implementation to implement QoS and MPLS routing.


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 26]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


The routing table design information exchange messaging methods discussed in
Section 4.1 and applied successfully in PSTNs over the past two decades, are
recommended for internetwork routing.  The QUERY, STATUS, and RECOM methods
for routing table design need to be extended as standard messages to PSTN,
ATM and IP networks, as discussed in Sections 4.1, 4.2, and 4.3.  

The topology update information exchange messaging methods discussed in
Sections 4.2 and 4.3 and applied successfully in ATM and IP networks over
the past two decades, are recommended for internetwork routing.   The HELLO
and PTSE methods for automatic updating and synchronization of topology
databases need be extended to PSTNs, as discussed in Section 4.1.

5.5 Examples of Internetwork Routing

A network consisting of various subnetworks using different routing
protocols is considered in this Recommendation.  For example, as illustrated
in Figure 4, consider a network with four subnetworks denoted as networks A,
B, C, and D, where each network uses a different routing protocol.  In this
example, network A is an ATM network which uses PNNI EDR path selection,
network B is a PSTN network which uses centralized periodic SDR path
selection, network C is an IP network which uses MPLS EDR path selection,
and network D is a PSTN network which uses TDR path selection.  Internetwork
E is defined by the shaded switches in Figure 5 and is a virtual network
where the interworking between networks A, B, C, and D is actually taking
place.

 <<Figure 5. Examples of Internetwork Routing>> 
RPb denotes a routing  processor in network B for a centralized periodic SDR
method. The set of shaded switches can be seen as a virtual network E for
routing of connections between networks A, B, C, and D.

5.5.1 Internetwork E Uses a Mixed Path Selection Method

Internetwork E can use various path selection methods in delivering
connections between the subnetworks A, B, C, and D.  For example,
internetwork E can implement a mixed path selection method in which each
switch in internetwork E uses the path selection method used in its home
subnetwork.  Consider a connection from switch a1 in network A to switch b4
in network B.  Switch a1 first routes the connection to either switch a3 or
a4 in network A and in doing so uses EDR path selection.  In that regard
switch a1 first tries to route the connection on the direct link a1-a4, and
assuming that link a1-a4 bandwidth is unavailable then selects the current
successful path a1-a3-a4 and routes the connection to switch a4 VS a3.  In
so doing switch a1 and switch a3 put the DTL parameter (identifying OS a1,
VS a3, and DS a4) and DoS parameter in the connection SETUP message.  

Switch a4 now proceeds to route the connection to switch b1 in subnetwork B
using EDR path selection. In that regard switch a4 first tries to route the
connection on the direct link a4-b1, and assuming that link a4-b1 bandwidth
is unavailable then selects the current successful path a4-c2-b1 and routes
the connection to switch b1 VS c2.  In so doing switch a4 and switch c2 put
the DTL parameter (identifying OS a4, VS c2, and DS b1) and DoS parameter in
the connection SETUP message.  

If switch/router c2 finds that link c2-b1 does not have sufficient available
bandwidth, it returns control of the connection to switch a4 through use of


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 27]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


a crankback parameter in the RELEASE message.  If now switch a4 finds that
link d4-b1 has sufficient idle bandwidth capacity based on the status
response message from switch b1, then switch a4 could next try path
a4-d3-d4-b1 to switch b1.  In that case switch a4 routes the connection
request to switch d3 on link a4-d3, and switch d3 is sent the DTL parameter
(identifying OS a4, VS d3, VS d4, and DS b1) and the DoS parameter in the
SETUP message.  In that case switch d3 tries to seize idle bandwidth on link
d3-d4, and assuming that there is sufficient idle bandwidth routes the
connection request to switch d4 with the DTL parameter (identifying OS a4,
VS d3, VS d4, and DS b1) and the DoS parameter in the SETUP message.  Switch
d4 then routes the connection request on link d4-b1 to switch b1, which has
already been determined to have sufficient idle bandwidth capacity.  If on
the other hand there is insufficient idle d4-b1 bandwidth available, then
switch d3 returns control of the call to switch a4 through use of a
crankback parameter in the RELEASE message.  At that point switch a4 may try
another multilink path, such as a4-a3-b3-b1, using the same procedure as for
the a4-d3-d4-b1 path.

Switch b1 now proceeds to route the connection to switch b4 in network B
using centralized periodic SDR path selection. In that regard switch b1
first tries to route the connection on the direct link b1-b4, and assuming
that link b1-b4 bandwidth is unavailable then selects a two-link path
b1-b2-b4 which is the currently recommended alternate path from the routing
processor (RPb) for network B.  RPb bases its alternate routing
recommendations on periodic (say every 10 seconds) link and traffic status
information received from each switch in network B.  Based on the status
information, RPb then selects the two-link path b1-b2-b4 and sends this
alternate path recommendation to switch b1 on a periodic basis (say every 10
seconds).  Switch b1 then routes the connection to switch b4 VS b2.  In so
doing switch b1 and switch b2 put the DTL parameter (identifying OS b1, VS
b2, and DS b4) and DoS parameter in the connection SETUP message.

A connection from switch b4 in network B to switch a1 in network A would
mostly be the same as the connection from a1 to b4, except with all the
above steps in reverse order.  The difference would be in routing the
connection from switch b1 in network B to switch a4 in network A.  In this
case, based on the mixed path selection assumption in virtual network E, the
b1 to a4 connection would use centralized periodic SDR path selection, since
switch b1 is in network B, which uses centralized periodic SDR.  In that
regard switch b1 first tries to route the connection on the direct link
b1-a4, and assuming that link b1-a4 bandwidth is unavailable then selects a
two-link path b1-c2-a4 which is the currently recommended alternate path
from the routing processor (RPb) for virtual network E.  RPb bases its
alternate routing recommendations on periodic (say every 10 seconds) link
and traffic status information received from each switch in virtual
subnetwork E.  Based on the status information, RPb then selects the
two-link path b1-c2-a4 and sends this alternate path recommendation to
switch b1 on a periodic basis (say every 10 seconds).  Switch b1 then routes
the connection to switch a4 VS c2.  In so doing switch b1 and switch c2 put
the DTL parameter (identifying OS b1, VS c2, and DS a4) and DoS parameter in
the connection SETUP message.

If switch/router c2 finds that link c2-a4 does not have sufficient available
bandwidth, it returns control of the connection to switch b1 through use of
a crankback parameter in the RELEASE message.  If now switch b1 finds that
path b1-d4-d3-a4 has sufficient idle bandwidth capacity based on the status


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 28]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


messages to RPb, then switch b1 could next try path b1-d4-d3-a4 to switch
a4.  In that case switch b1 routes the connection request to switch d4 on
link b1-d4, and switch d4 is sent the DTL parameter (identifying OS b1, VS
d4, VS d3, and DS a4) and the DoS parameter in the SETUP message.  In that
case switch d4 tries to seize idle bandwidth on link d4-d3, and assuming
that there is sufficient idle bandwidth routes the connection request to
switch d3 with the DTL parameter (identifying OS b1, VS d4, VS d3, and DS
a4) and the DoS parameter in the SETUP message.  Switch d3 then routes the
connection request on link d3-a4 to switch a4, which is expected based on
status information to have sufficient idle bandwidth capacity.  If on the
other hand there is insufficient idle d3-a4 bandwidth available, then switch
d3 returns control of the call to switch b1 through use of a crankback
parameter in the RELEASE message.  At that point switch b1 may try another
multilink path, such as b1-b3-a3-a4, using the same procedure as for the
b1-d4-d3-a4 path.

5.5.2 Internetwork E Uses a Single Path Selection Method

Internetwork E may also use a single path selection method in delivering
connections between the networks A, B, C, and D.  For example, internetwork
E can implement a path selection method in which each switch in internetwork
E uses EDR.  In this case the example connection from switch a1 in network A
to switch b4 in network B would be the same as described above.  A
connection from switch b4 in network B to switch a1 in network A would be
the same as the connection from a1 to b4, except with all the above steps in
reverse order.  In this case the routing of the connection from switch b1 in
network B to switch a4 in network A would also use EDR in a similar manner
to the a1 to b4 connection described above.  

6.0 References

[A98]  Ash, G. R., Dynamic Routing in Telecommunications Networks,
McGraw-Hill, 1998.

[ADFFT98]  Anderson, L., Doolan, P., Feldman, N., Fredette, A., Thomas, B.,
LDP Specification, IETF Draft, draft-ietf-mpls-ldp-01.txt, August 1998.

[AMAOM98]  Awduche, D. O., Malcolm, J. Agogbua, J., O'Dell, M., McManus, J.,
Requirements for Traffic Engineering Over MPLS, IETF Draft,
draft-ietf-mpls-traffic-eng-00.txt, October 1998.

[ADEHP98]  Arango, M., Dugan, A., Elliott, I., Huitema, C., Pickett, S.,
Media Gateway Control Protocol (MGCP), Version 0.1 draft, IETF Draft,
draft-huitema-MGCP-v0r1-00.txt, October 1998.

[ATM95]  ATM Forum Technical Committee, B-ISDN Inter Carrier Interface
(B-ICI) Specification Version 2.0 (Integrated), af-bici-0013.003, December
1995. 

[ATM96a]  ATM Forum Technical Committee, Private Network-Network Interface
Specification Version 1.0 (PNNI 1.0), af-pnni-0055.000, March 1996.

[ATM96b]  ATM Forum Technical Committee, Traffic Management Specification
Version 4.0, af-tm0056.000, April 1996.


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 29]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


[ATM96]  ATM Forum Technical Committee, ATM User-Network Interface (UNI)
Signalling Specification Version 4.0, af-sig-0061.000, July 1996.

[ATM98]  ATM Forum Technical Committee, Specification of the ATM
Inter-Network Interface (AINI) (Draft), ATM Forum/BTD-CS-AINI-01.03, July
1998.

[BYFBZNS98]  Bernet, Y., Yavatkar, R., Ford, P., Baker, F., Zhang, L.,
Nichols, K., Speer, M., A Framework for Use of RSVP with Diffserv Networks,
IETF Draft, draft-ietf-diffserv-rsvp-00.txt, June 1998.

[BZBHJ97]  Bradem. R., Zhang, L., Berson, S., Herzog, S., Jamin, S.,
Resource ReSerVation Protocol (RSVP) - Version 1 Functional Specification,
IETF Network Working Group RFC 2205, September 1997.

[CDFSV97]  Callon, R., Doolan, P., Feldman, N., Fredette, A., Swallow, G.,
Viswanathan, A., IETF Network Working Group Draft, A Framework for
Multiprotocol Label Switching, draft-ietf-mpls-framework-02.txt, November
1997.

[CNRS98]  Crawley, E., Nair, R., Rajagopalan, B., Sandick, H., A Framework
for QoS-based Routing in the Internet, IETF RFC 2386, August 1998.

[COM 2-39-E], ANNEX, Draft New Recommendation E.ip, Report of Joint Meeting
of Questions 1/2 and 10/2, Torino, Italy, July 1998.
 
[D.xxx]  ITU-T Delayed Contribution, IPDC Base Protocol, Geneva, September
1998.

[E98]  Elliott, I. K., IETF Draft, IPDC Media Control Protocol,
draft-elliott-ipdc-media-00.txt, August 1998.

[E.DYN]  ITU-T Draft Recommendation, Dynamic Routing Interworking.

[E.164]  ITU-T Recommendation, The International Telecommunications
Numbering Plan.

[E.170]  ITU-T Recommendation, Traffic Routing.

[E.177]  ITU-T Recommendation, B-ISDN Routing.

[E.191]  ITU-T Recommendation, B-ISDN Numbering and Addressing, October
1996.

[E.412]  ITU-T Recommendation, Network Management Controls.

[ETSIa]  ETSI Secretariat, Telecommunications and Internet Protocol
Harmonization over Networks (TIPHON); Naming and Addressing; Scenario 2,
DTS/TIPHON-04002 v1.1.64, 1998

[ETSIb]  ETSI STF, Request for Information (RFI): Requirements for Very
Large Scale E.164 -> IP Database, TD35, ETSI EP TIPHON 9, Portland,
September 1998.


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 30]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


[ETSIc]  TCR98, Taylor, P. T., Calhoun, P. R., Rubens, A. C., IPDC Base
Protocol, IETF Draft, draft-taylor-ipdc-00.txt, July 1998.

[ETSId]  TD290, ETSI Working Party Numbering and Routing, Proposal to Study
IP Numbering, Addressing, and Routing Issues, Sophia, September 1998.

[ETSIe]  TD27, TIPHON 10 Draft, H.323 Annex E: Call Signaling over UDP,
Tel-Aviv, Israel, October 1998.

[GWA97]  Gray, E., Wang, Z., Armitage, G., Generic Label Distribution
Protocol Specification, IETF Draft, draft-gray-mpls-generic-ldp-spec-00.txt,
November 1997.

[G.723.1]  ITU-T Recommendation, Dual Rate Speech Coder for Multimedia
Communications Transmitting at 5.3 and 6.3 kbit/s, March 1996.

[H.225.0] ITU-T Recommendation, Media Stream Packetization and
Synchronization on Non-Guaranteed Quality of Service LANs, November 1996.

[H.245]  ITU-T Recommendation, Control Protocol for Multimedia
Communication, March 1996.

[H.246]  Draft ITU-T Recommendation, Interworking of H.Series Multimedia
Terminals with H.Series Multimedia Terminals and Voice/Voiceband Terminals
on GSTN and ISDN, September 1997.

[H.323]  ITU-T Recommendation, Visual Telephone Systems and Equipment for
Local Area Networks which Provide a Non-Guaranteed Quality of Service,
November 1996.

[I.211] ITU-T Recommendation, B-ISDN Service Aspects, March 1993.

[I.324]  ITU-T Recommendation, ISDN Network Architecture, 1991.

[I.327]  ITU-T Recommendation, B-ISDN Functional Architecture, March 1993.

[KON97]  Katsube, Y., Ohba, Y., Nagami, K., Two Modes of MPLS Explicit Label
Distribution Protocol, IETF Draft, draft-katsube-mpls-two-ldp-00.txt,
September 1997.

[LKPCD98]  Luciani, J., Katz, D., Piscitello, D., Cole, B., Doraswamy, N.,
NBMA Next Hop Resolution Protocol (NHRP), IETF RFC 2332, April 1998.

[LR98]  Li, T., Rekhter, Y., A Provider Architecture for Differentiated
Services and Traffic Engineering (PASTE), IETF RFC 2430,  October 1998. 

[M98]  Moy, J, OSPF Version 2, IETF RFC 2328, April 1998.

[Q.71]  ITU-T Recommendation, ISDN Circuit Mode Switched Bearer Services.

[Q.2761]  ITU-T Recommendation, Broadband Integrated Services Digital
Network (B-ISDN) Functional Description of the B-ISDN User Part (B-ISUP) of
Signaling System Number 7.


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 31]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


[Q.2931]  ITU-T Recommendation, Broadband Integrated Services Digital
Network (B-ISDN) - Digital Subscriber Signalling System No. 2 (DSS 2) -
User-Network Interface (UNI) Layer 3 Specification for Basic Call/Connection
Control, February 1995.

[RVC98]  Rosen, E., Viswanathan, A., Callon, R., Multiprotocol Label
Switching Architecture, IETF Network Working Group Draft,
draft-ietf-mpls-arch-01.txt, March 1998.

[SCFJ96]  Schulzrinne, H., Casner, S., Frederick, R., Jacobson, V., RTP: A
Transport Protocol for Real-Time Applications, IETF RFC 1889, January 1996.

[S94]  Stevens, W. R., TCP/IP Illustrated, Volume 1, The Protocols,
Addison-Wesley, 1994.

[S95]  Steenstrup, M., Editor, Routing in Communications Networks,
Prentice-Hall, 1995.

[ST98]  Sikora, J., Teitelbaum, B., Differentiated Services for Internet2,
Internet2: Joint Applications/Engineering QoS Workshop, Santa Clara, CA, May
1998.

[TC98]  Taylor, T. P., Calhoun, P. R., IPDC Base Protocol, IETF Draft,
draft-taylor-ipdc-00.txt, July 1998.

[ZSSC97]  Zhang, Sanchez, Salkewicz, Crawley, Quality of Service Extensions
to OSPF or Quality of Service Path First Routing (QOSPF), IETF Draft,
draft-shang-qos-ospf-01.txt, September 1997.

7.0 Abbreviations

AAR			Automatic Alternate Routing
ABR			Available Bit Rate
AESA			ATM End System Address
AFI			Authority and Format Identifier
ARR			Automatic Rerouting
AS			Autonomous System
ATM			Asynchronous Transfer Mode
B-ISDN			Broadband Integrated Services Digital Network
B			Busy
BGP			Border Gateway Protocol
BW			Bandwidth
BWIP			Bandwidth in Progress
BWOV			Bandwidth Overflow
BWPC			Bandwidth Peg Count
CAC			Call Admission Control
CBR			Constant Bit Rate
CCS			Common Channel Signaling
DADR			Distributed Adaptive Dynamic Routing
DAR			Dynamic Alternate Routing
DCC			Data Country Code
DCR			Dynamically Controlled Routing
DIFFSERV		Differentiated Services
DoS			Depth-of-Search
DSP			Domain Specific Part
DTL			Designated Transit List


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 32]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


DS			Destination Switch
DNHR			Dynamic Nonhierarchical Routing
EDR			Event Dependent Routing
FR			Fixed Routing
GCAC			Generic Call Admission Control
GOS			Grade of Service
HL			Heavily Loaded
IAM			Initial Address Message
ICD			International Code Designator
IDI			Initial Domain Identifier
IETF			Internet Engineering Task Force
II			Information Interchange
ILBW			Idle Link Bandwidth
IP			Internet Protocol
IPDC			Internet Protocol Device Control
LBL			Link Blocking Level 
LC			Link capability
LDP			Label Distribution Protocol
LL			Lightly Loader
LLR			Least Loaded Routing
LSA			Link State Advertisement
MPLS			Multiprotocol Label Switching
NANP			North American Numbering Plan
N-ISDN			Narrowband Integrated Services Digital Network
NSAP			Network Service Access Point
ODR			Optimized Dynamic Routing
OS			Originating Switch
OSPF			Open Shortest Path First
PNNI			Private Network-to-Network Interface
PSTN			Public Switched Telephone Network
PTSE			PNNI Topology State Elements
PoS			Priority of  Service
QoS			Quality of Service
R			Reserved
RP			Routing Processor
RSVP			Resource Reservation Protocol
RTNR			Real-Time Network Routing
SCP			Service Control Point
SDR			State-Dependent Routing
SI			Service Identity
STR			State- and Time-Dependent Routing
TBW			Total Bandwidth
TBWIP			Total Bandwidth In Progress
TDR			Time-Dependent Routing
TOS			Type of Service
TIPHON			Telecommunications and Internet Protocol 
			Harmonization Over Networks
TR			Trunk Reservation
VS			Via Switch
UBR			Unassigned Bit Rate
VBR			Variable Bit Rate
VC			Virtual Circuit
VCI			Virtual Circuit Identifier
VN			Virtual Network
VPI			Virtual Path Identifier
WIN			Worldwide Intelligent Network (Routing)


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 33]

Internet Draft  Routing Interworking of PSTN, ATM & IP Networks   Nov 98


8.0 Authors' Addresses

Gerald R. Ash
AT&T
Room HO 3C-509
101 Crawfords Corner Road
Holmdel, NJ  07733
Phone: 732-949-1054
Fax:   732-949-8040
Email: gash@att.com

Young Lee
AT&T
Room HO 3C-508A
101 Crawfords Corner Road
Holmdel, NJ  07733
Phone: 732-949-4794
Fax:   732-949-8040
Email: younglee@att.com


Ash, Lee          <draft-itu-sg2-qos-routing-00.txt>            [Page 34]
