<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Extensible Messaging and Presence Protocol (XMPP) End-to-End Encryption Using Transport Layer Security ("XTLS")</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Extensible Messaging and Presence Protocol (XMPP) End-to-End Encryption Using Transport Layer Security (&quot;XTLS&quot;)">
<meta name="keywords" content="Extensible Messaging and Presence Protocol, XMPP, Jabber, encryption">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Meyer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Universitaet Bremen TZI</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">P. Saint-Andre</td></tr>
<tr><td class="header">Expires: September 10, 2009</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 09, 2009</td></tr>
</table></td></tr></table>
<h1><br />Extensible Messaging and Presence Protocol (XMPP) End-to-End Encryption Using Transport Layer Security ("XTLS")<br />draft-meyer-xmpp-e2e-encryption-01</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 10, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document specifies "XTLS", a protocol for end-to-end encryption of Extensible Messaging and Presence Protocol (XMPP) traffic via an application-level usage of Transport Layer Security (TLS).  XTLS treats the end-to-end exchange of XML stanzas as a virtual transport and uses TLS to secure that transport, thus enabling XMPP entities to communicate in a way that is designed to prevent eavesdropping, tampering, and forgery of XML stanzas.  The protocol can be used for secure end-to-end messaging as well as any others application such as file transfer.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#scope">2.</a>&nbsp;
Scope<br />
<a href="#threat">3.</a>&nbsp;
Threat Analysis<br />
<a href="#reqs">4.</a>&nbsp;
Requirements<br />
<a href="#approach">5.</a>&nbsp;
Approach<br />
<a href="#proto">6.</a>&nbsp;
XTLS Protocol Flow<br />
<a href="#streamproto">7.</a>&nbsp;
End-to-End Streams over XTLS Protocol Flow<br />
<a href="#bootstrapping">8.</a>&nbsp;
Bootstrapping Trust on First Communication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#exchange">8.1.</a>&nbsp;
Exchanging Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#bootstrap-bot">8.2.</a>&nbsp;
Verification of Non-Human Parties<br />
<a href="#terminate">9.</a>&nbsp;
Session Termination<br />
<a href="#support">10.</a>&nbsp;
Determining Support<br />
<a href="#security">11.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-mti">11.1.</a>&nbsp;
Mandatory-to-Implement Technologies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-certs">11.2.</a>&nbsp;
Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-dos">11.3.</a>&nbsp;
Denial of Service<br />
<a href="#iana">12.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#schema">Appendix&nbsp;A.</a>&nbsp;
XML Schema<br />
<a href="#copying">Appendix&nbsp;B.</a>&nbsp;
Copying Conditions<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>End-to-end encryption of traffic sent over the Extensible Messaging and Presence Protocol (XMPP) is a desirable goal.  Since 1999, the Jabber/XMPP developer community has experimented with several such technologies, including OpenPGP <a class='info' href='#XEP-0027'>[XEP&#8209;0027]<span> (</span><span class='info'>Muldowney, T., &ldquo;Current Jabber OpenPGP Usage,&rdquo; November&nbsp;2006.</span><span>)</span></a>, S/MIME <a class='info' href='#RFC3923'>[RFC3923]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;End-to-End Signing and Object Encryption for the Extensible Messaging and Presence Protocol (XMPP),&rdquo; October&nbsp;2004.</span><span>)</span></a>, and encrypted sessions or "ESessions" <a class='info' href='#XEP-0218'>[XEP&#8209;0218]<span> (</span><span class='info'>Saint-Andre, P. and I. Paterson, &ldquo;Bootstrapping Implementation of Encrypted Sessions,&rdquo; May&nbsp;2007.</span><span>)</span></a>.  For various reasons, these technologies have not been widely implemented and deployed.  When the XMPP Standards Foundation asked various Internet security experts to complete a security review of encrypted sessions, it was recommended to explore the possibility of instead using the Transport Layer Security <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> as the base technology for XMPP.  That possibility is explored in this document.
</p>
<p>TLS is the most widely implemented protocol for securing network traffic.  In addition to applications in the email infrastructure, the World Wide Web <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, and datagram transport for multimedia session negotiation <a class='info' href='#DTLS'>[DTLS]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a>, TLS is used in XMPP to secure TCP connections from client to server and from server to server, as specified in <a class='info' href='#rfc3920bis'>[rfc3920bis]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; March&nbsp;2009.</span><span>)</span></a>.  Therefore TLS is already familiar to XMPP developers.
</p>
<p>This specification, called "XTLS", defines a method whereby any XMPP entity that supports the XMPP Jingle negotiation framework <a class='info' href='#XEP-0166'>[XEP&#8209;0166]<span> (</span><span class='info'>Ludwig, S., Beda, J., Saint-Andre, P., McQueen, R., Egan, S., and J. Hildebrand, &ldquo;Jingle,&rdquo; December&nbsp;2008.</span><span>)</span></a> can use TLS semantics for end-to-end encryption, whether the application data is sent over a streaming transport (like TCP) or a datagram transport (like UDP).  The basic use case is to tunnel XMPP stanzas between two IM users for end-to-end secure chat using end-to-end XML streams.  However, XTLS is not limited to encryption of one-to-one text chat, since it can be used between two XMPP clients for encryption of any XMPP payloads, between an XMPP client and a remote XMPP service (i.e., a service with which a client does not have a direct XML stream, such as a <a class='info' href='#XEP-0045'>[XEP&#8209;0045]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Multi-User Chat,&rdquo; July&nbsp;2008.</span><span>)</span></a> chatroom), or between two remote XMPP services.  Furthermore, XTLS can be used for encrypted file transfer using <a class='info' href='#XEP-0234'>[XEP&#8209;0234]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Jingle File Transfer,&rdquo; February&nbsp;2009.</span><span>)</span></a>, for encrypted voice or video sessions using <a class='info' href='#XEP-0167'>[XEP&#8209;0167]<span> (</span><span class='info'>Ludwig, S., Saint-Andre, P., Egan, S., McQueen, R., and D. Cionoiu, &ldquo;Jingle RTP Sessions,&rdquo; December&nbsp;2008.</span><span>)</span></a> and <a class='info' href='#DTLS-SRTP'>[DTLS&#8209;SRTP]<span> (</span><span class='info'>McGrew, D. and E. Rescorla, &ldquo;Datagram Transport Layer Security (DTLS) Extension to Establish Keys for  Secure Real-time Transport Protocol (SRTP),&rdquo; February&nbsp;2009.</span><span>)</span></a>, and other applications.
</p>
<p>Note: The following capitalized keywords are to be interpreted as described in <a class='info' href='#TERMS'>[TERMS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".
</p>
<a name="scope"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Scope</h3>

<p>The XMPP communication exchanges of interest here exist in the context of a one-to-one communication "session" between two entities, where the information exchanged takes the form of XMPP stanzas. However, several other kinds of XMPP exchanges exist outside the context of one-to-one communication sessions:
</p>
<p>
        </p>
<ul class="text">
<li>Many-to-many sessions, such as a text conference in a chatroom as specified in <a class='info' href='#XEP-0045'>[XEP&#8209;0045]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Multi-User Chat,&rdquo; July&nbsp;2008.</span><span>)</span></a>.
</li>
<li>One-to-many broadcast of information, such as undirected presence stanzas sent from one user to many contacts as described in <a class='info' href='#rfc3921bis'>[rfc3921bis]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and  Presence,&rdquo; October&nbsp;2008.</span><span>)</span></a> and data syndication implemented using the XMPP publish-subsribe technology described in <a class='info' href='#XEP-0060'>[XEP&#8209;0060]<span> (</span><span class='info'>Millard, P., Saint-Andre, P., and R. Meijer, &ldquo;Publish-Subscribe,&rdquo; September&nbsp;2008.</span><span>)</span></a>.
</li>
<li>One-to-one communications that are stored for later delivery rather than delivered immediately, such as the so-called "offline messages" described in <a class='info' href='#XEP-0160'>[XEP&#8209;0160]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Best Practices for Handling Offline Messages,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
</li>
</ul><p>
      
</p>
<p>Ideally, any technology for end-to-end encryption in XMPP could be extended to cover all the scenarios above as well as one-to-one communication sessions. However, many-to-many sessions, one-to-many broadcast, and offline messages are out of scope for this specification.
</p>
<a name="threat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Threat Analysis</h3>

<p>XMPP technologies are typically deployed using a client-server architecture.  As a result, XMPP endpoints (often but not always controlled by human users) need to communicate through one or more servers.  For example, the user juliet@capulet.lit connects to the capulet.lit server and the user romeo@montague.lit connects to the montague.lit server, but in order for Juliet to send a message to Romeo the message will be routed over her client-to-server connection with capulet.lit, over a server-to-server connection between capulet.lit and montague.lit, and over Romeo's client-to-server connection with montague.lit.  Although <a class='info' href='#rfc3920bis'>[rfc3920bis]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; March&nbsp;2009.</span><span>)</span></a> requires support for Transport Layer Security <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> to make it possible to encrypt all of these connections, when XMPP is deployed any of these connections might be unencrypted.  Furthermore, even if the server-to-server connection is encrypted and both of the client-to-server connections are encrypted, the message would still be in the clear while processed by both the capulet.lit and montague.lit servers.
</p>
<p>In this specification we primarily address communications security ("commsec") between two parties, especially confidentiality, data integrity, and peer entity authentication.  Communications security can be subject to a variety of attacks, which <a class='info' href='#RFC3552'>[RFC3552]<span> (</span><span class='info'>Rescorla, E. and B. Korver, &ldquo;Guidelines for Writing RFC Text on Security Considerations,&rdquo; July&nbsp;2003.</span><span>)</span></a> divides attacks into passive and active categories.  In a passive attack, information is leaked (e.g., a passive attacker could read all of the messages that Juliet sends to Romeo).  In an active attack, the attacker can add, modify, or delete messages between the parties, thus disrupting communications.
</p>
<p>Traditionally, it seems that XMPP users have been concerned more about passive attacks (such as eavesdropping) than about active attacks (such as man-in-the-middle), perhaps because they have thought that their communications are "just chat", because they have had no expectation that endpoints could be authenticated, or because they have believed that hijacked communications would be detected socially (e.g., because the other party did not have an authentic "voice" in a text conversation).  However, both forms of attack are of concern in this protocol.
</p>
<p>In particular, we consider the following types of attacks and attackers:
</p>
<p>
        </p>
<ul class="text">
<li>One type of passive attack might involve monitoring all the conversations of a given party.  To help prevent this, it is helpful for the party to ensure that its connection with its server is protected using TLS.  However, in this case the eavesdropper could monitor outbound traffic from the party's server, either to other connected clients or to other servers, since that traffic might be unencrypted.  In addition, the eavesdropper could attack the party's server so that it gains access to all traffic within the server, or masquerade as the party's server so that the party is fooled into connecting to the attacker rather than directly to the party's server.
</li>
<li>Another type of passive attack might involve monitoring of a single conversation between two particular parties.  In this case the eavesdropper could monitor communications over the server-to-server connection between the parties' servers, or over the client-to-server connection between either party and that party's server.
</li>
<li>One type of active attack would involve modification of the XML stanzas used to advertise support for the protocol "building blocks" that make it possible to negotiate a secure session; as a result, other parties would be led to believe that the party does not have the ability to negotate a secure session and therefore would not attempt such a negotiation.
</li>
<li>Another type of active attack would involve modification or outright deletion of the XML stanzas used to negotiate a secure session (such as those described in this document), with the result that the parties would think the negotiation has failed for legitimate reasons such as incompatibilities between the parties' clients.
</li>
<li>A more sophisticated active attack would involve a cryptanalytic attack on the keying material or other credentials used to establish trust between the parties, such as an ephemeral password exchanged during an initial certificate exchange if Secure Remote Password <a class='info' href='#TLS-SRP'>[TLS&#8209;SRP]<span> (</span><span class='info'>Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;Using the Secure Remote Password (SRP) Protocol for TLS Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> is used.
</li>
</ul><p>
      
</p>
<p>Other attacks are possible, and the foregoing list is best considered incomplete at this time.
</p>
<a name="reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Requirements</h3>

<p>(This section borrows some text from <a class='info' href='#XEP-0210'>[XEP&#8209;0210]<span> (</span><span class='info'>Paterson, I., &ldquo;Requirements for Encrypted Sessions,&rdquo; May&nbsp;2007.</span><span>)</span></a>.)
</p>
<p>This document stipulates the following requirements for end-to-end encryption of XMPP communications.  It is possible that some of those requirements can be met only with particular TLS cipher suites, or cannot be met at all without defining extensions to TLS itself; a full gap analysis has not yet been completed.
</p>
<p>
        </p>
<ul class="text">
<li>Confidentiality.  The one-to-one XML stanzas exchanged between two entities must not be understandable to any other entity that might intercept the communications. The encrypted stanzas are to be understood by an intermediate server only to the extent required to route them.
</li>
<li>Integrity.  The two parties to an encrypted communication session must be sure that no other entity is able to change the content of the XML stanzas they exchange, or remove or insert stanzas into the session undetected.
</li>
<li>Replay protection.  The two parties to an encrypted communication session must be able to identify and reject any communications that are copies of their previous communications resent by another entity.
</li>
<li>Perfect forward secrecy.  The content of an encrypted communication should not be revealed even if long-lived keys are compromised in the future (e.g., if one of the parties loses their device). For long-lived sessions it should be possible to periodically change the decryption keys.
</li>
<li>PKI independence.  The protocol must not rely on any public key infrastructure (PKI), certification authority, web of trust, or any other trust model that is external to the trust established between the two parties. However, if external authentication or trust models are available then the two parteis must be able to use them as a way of enhancing any trust that exists between them.
</li>
<li>Authentication.  Each party to a conversation must know that the other party is who they want to communicate with.
</li>
<li>Generality.  The solution must be generally applicable to the full content of any XML stanza type sent between two entities (i.e., message, presence, and IQ stanzas).
</li>
<li>Implementability.  The only good security technology is an implemented security technology. The solution must be one that XMPP client developers can implement in a relatively straightforward and interoperable fashion, preferably by re-using existing building blocks such as Transport Layer Security XML streams, Jingle <a class='info' href='#XEP-0166'>[XEP&#8209;0166]<span> (</span><span class='info'>Ludwig, S., Beda, J., Saint-Andre, P., McQueen, R., Egan, S., and J. Hildebrand, &ldquo;Jingle,&rdquo; December&nbsp;2008.</span><span>)</span></a>, and in-band bytestreams <a class='info' href='#XEP-0047'>[XEP&#8209;0047]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; November&nbsp;2006.</span><span>)</span></a>.
</li>
<li>Usability.  The requirement of usability takes implementability one step further by stipulating that the solution must be one that organizations may deploy and humans may use with 100% transparency (with the ease-of-use of secure web browsing via HTTPS). Experience has shown that solutions requiring a full public key infrastructure do not get widely deployed and solutions requiring any user action are not widely used. If, however, the parties are prepared to verify the integrity of their copies of each other's keys (thus enabling them to discover targeted active attacks), then the actions necessary for them to verify key integrity must be minimal (requiring no more effort than a one-time out-of-band verification of a string of up to 6 alphanumeric characters).
</li>
<li>Efficiency.  Cryptographic operations are highly CPU intensive, particularly public key and Diffie-Hellman operations. Cryptographic data structures can be relatively large, especially public keys and certificates. Network round trips can introduce unacceptable delays, especially over high-latency wireless connections. The solution must perform efficiently even when CPU and network bandwidth are constrained. The number of round trips required to set up an encrypted session should be minimized.
</li>
<li>Flexibility.  The solution must be compatible with a variety of existing and future cryptographic algorithms and identity certification schemes, including X.509 and PGP.
</li>
</ul><p>
      
</p>
<a name="approach"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Approach</h3>

<p>In broad outline, XTLS takes the following approach to end-to-end encryption of XMPP traffic:
</p>
<p>
        </p>
<ol class="text">
<li>We assume that all XMPP entities will have X.509 certificates; realistically these certificates are likely to be self-signed and automatically generated by an XMPP client, however CA-issued certificates are encouraged to overcome problems with self-signed certificates.
</li>
<li>We use the XMPP Jingle extensions as the negotiation framework (see <a class='info' href='#XEP-0166'>[XEP&#8209;0166]<span> (</span><span class='info'>Ludwig, S., Beda, J., Saint-Andre, P., McQueen, R., Egan, S., and J. Hildebrand, &ldquo;Jingle,&rdquo; December&nbsp;2008.</span><span>)</span></a>).
</li>
<li>We define a &lt;security/&gt; element that can be included in any Jingle negotiation, and a new "security-info" Jingle action for sending security-related information.
</li>
<li>When an entity wishes to encrypt its communications with a second entity, it sends a Jingle session-initiate request that specifies the desired application type, a possible transport, the sender's X.509 fingerprint, and optionally hints about the sender's supported TLS methods.
</li>
<li>If both parties support XTLS, the first data sent over the negotiated transport is TLS handshake data, not application data.  Once the TLS handshake has finished, the parties can then send application data over the now-encrypted transport.
</li>
<li>The simplest scenario is end-to-end encryption of traditional XMPP text chat using end-to-end XML streams, in-band bytestreams (see <a class='info' href='#XEP-0047'>[XEP&#8209;0047]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; November&nbsp;2006.</span><span>)</span></a>), and previously-accepted X.509 certificates.
</li>
<li>On first use of end-to-end encryption between two entities, it is encouraged to use secure remote passwords rather than leap-of-faith to bootstrap the subsequent use of the client-generated X.509 certificates.
</li>
<li>More complex scenarios are theoretically supported (e.g., encrypted file transfer using SOCKS5 bytestreams and encrypted voice chat using DTLS-SRTP) but have not yet been fully defined.
</li>
<li>XTLS theoretically can be used to establish a TLS-encrypted streaming transport or a DTLS-encrypted datagram transport, but integration with DTLS <a class='info' href='#DTLS'>[DTLS]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a> has not yet been prototyped so use with streaming transports is the more stable scenario.
</li>
</ol><p>
      
</p>
<p>We expand on this approach in the following section.
</p>
<a name="proto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
XTLS Protocol Flow</h3>

<p>The basic flow for an XTLS session is as follows, where traffic represented by single dashes (---) is sent over the XMPP signalling channel and traffic represented by double lines (===) is sent over the negotiated transport.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Initiator                   Responder
  |                            |
  |  session-initiate          |
  |  (with security info)      |
  |---------------------------&gt;|
  |  ack                       |
  |&lt;---------------------------|
  |  session-accept            |
  |&lt;---------------------------|
  |  ack                       |
  |---------------------------&gt;|
  |  open transport            |
  |&lt;==========================&gt;|
  |  TLS ClientHello           |
  |===========================&gt;|
  |  TLS ServerHello, [...]    |
  |&lt;===========================|
  |  TLS [...], Finished       |
  |===========================&gt;|
  |  TLS [...], Finished       |
  |&lt;===========================|
  |  application data          |
  |&lt;==========================&gt;|
  |  session-terminate         |
  |&lt;---------------------------|
  |  ack                       |
  |---------------------------&gt;|
  |                            |
</pre></div>
<p>To simplify the description we assume here that the parties already trust each other's certificates.  See discussion under <a class='info' href='#bootstrapping'>Section&nbsp;8<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a> for information about bootstrapping of certificate trust on the first communication.
</p>
<p>First the initiator sends a Jingle session-initiate request (here the simple case of an end-to-end text chat session using in-band bytestreams <a class='info' href='#XEP-0047'>[XEP&#8209;0047]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; November&nbsp;2006.</span><span>)</span></a>.  This request includes a &lt;security/&gt; element that contains the fingerprint of the certificate that the initiator will use during the TLS negotiation and a list of TLS methods the initiator supports (here X.509 certificate based authentication and TLS-SRP).  Note that this information is exchanged over the insecure server based connection.  The purpose of the exchange is to gather information what TLS method should be used in the TLS handshake, e.g. if a client can not verify the fingerprint of the peer it MAY omit the X.509 method.  If both clients can verify the fingerprint of the other, it is likely that X.509 certificate based authentication will succeed (unless the data is altered); if one client can not verify the fingerprint the client MAY prompt the user for a password for TLS-SRP based authentication (see <a class='info' href='#bootstrapping'>Section&nbsp;8<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a> for details).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='xn28s7gk'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:0'&gt;
          action='session-initiate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='xmlstream'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:xmlstream:0'/&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:ibb:0'
                 block-size='4096'
                 sid='ch3d9s71'/&gt;
      &lt;security xmlns='urn:xmpp:jingle:security:xtls:0'&gt;
        &lt;fingerprint algo='sha1'&gt;RomeoX509CertSHA1Hash&lt;/fingerprint&gt;
        &lt;method name='x509'/&gt;
        &lt;method name='srp'/&gt;
      &lt;/security&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder immediately acknowledges receipt of the session-initiate by sending an IQ stanza of type "result" (not shown here).
</p>
<p>Depending on the application type, a user agent controlled by a human user might need to wait for the user to affirm a desire to proceed with the session before continuing.  When the user agent has received such affirmation (or if the user agent can automatically proceed for any reason, e.g.  because no human intervention is expected or because a human user has configured the user agent to automatically accept sessions with a given entity), it returns a Jingle session-accept message.  This message will typically contain the offered application type, transport method, and a &lt;security/&gt; element that includes the fingerprint of the responder's X.509 certificate as well as the responder's supported TLS methods.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hf64hl'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:0'&gt;
          action='session-accept'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='xmlstream'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:xmlstream:0'/&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:ibb:0'
                 block-size='4096'
                 sid='ch3d9s71'/&gt;
      &lt;security xmlns='urn:xmpp:jingle:security:xtls:0'/&gt;
        &lt;fingerprint algo='sha1'&gt;JulietX509CertSHA1Hash&lt;/fingerprint&gt;
        &lt;method name='x509'/&gt;
        &lt;method name='srp'/&gt;
      &lt;/security&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The following rules apply to the responder's handling of the session-initiate message:
</p>
<p>
        </p>
<ol class="text">
<li>If the responder does not support Jingle-XTLS it will silently ignore the &lt;security/&gt; element in the offer and therefore will return a session-accept message without a &lt;security/&gt; element.
</li>
<li>If the responder supports Jingle-XTLS it SHOULD return a session-accept message that contains a &lt;security/&gt; element.
</li>
<li>If the responder thinks it will be able to verify the initiator's certificate, it MUST include the fingerprint for the responder's certificate in the &lt;security/&gt; element of the session-accept message.  This is the "happy path" and will occur when the parties have already verified each other's certificates.
</li>
<li>If the responder thinks it will not be able to verify the initiator's certificate, it MAY omit the fingerprint for the responder's certificate in the &lt;security/&gt; element of the session-accept message.  This indicates that certificate-based authentication is not possible.  In this case the responder SHOULD signal that it wishes to use some other authentication method, such as secure remote passwords (see discussion under <a class='info' href='#bootstrapping'>Section&nbsp;8<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a>).
</li>
<li>If the responding client cannot verify the initiator's certificate, it SHOULD ask the responding user if a password was exchanged between the parties that can be used for TLS-SRP.  If this is not the case, setting up a mutually-authenticated link will fail and the responder MAY terminate the session.  Alternatively it could send its own fingerprint knowing it cannot authenticate the initiator, in which case the responder has to trust that there is no man-in-the-middle (see discussion under <a class='info' href='#bootstrapping'>Section&nbsp;8<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a>).
</li>
</ol><p>
      
</p>
<p>When the responder sends the session-accept message, the initiator acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The following rules apply to the initiator's handling of the session-accept message:
</p>
<p>
        </p>
<ol class="text">
<li>If the initiator receives a session-accept without a &lt;security/&gt; element, setting up a secure transport layer has failed.  The initiator MAY terminate the session at this point or instead proceed without securing the transport.  The client SHOULD ask the initiating user how to processed.  This depends on the Jingle application and the initiator's preferences: it makes no sense to use end-to-end XML streams without encryption, but the initiator might continue a file transfer without encryption.
</li>
<li>If the initiating client cannot verify the responder's certificate it SHOULD ask the initiating user if a password was exchanged between the parties that can be used for TLS-SRP.  If this is not the case, setting up a mutually-authenticated link will fail and the responder MAY terminate the session or proceed with leap-of-faith (see discussion under <a class='info' href='#bootstrapping'>Section&nbsp;8<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a>).
</li>
</ol><p>
      
</p>
<p>The initiator can now determine if X.509 certificate based authentication will work or if TLS-SRP will be used.  It sends an additional security-info message to the responder to signal its choice.  This step is not really necessary because the responder will see the initiator's choice in the first message of the TLS handshake, but it can help an implementation to set up its TLS library properly.  Because in this section we assume that the parties already have validated each other's certificates, the security method signalled here is "x509".
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='hf749j'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:0'&gt;
          action='security-info'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='xmlstream'&gt;
      &lt;security xmlns='urn:xmpp:jingle:security:xtls:0'&gt;
        &lt;method name='x509'/&gt;
      &lt;/security&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>Parallel to the security-info exchange, the clients negotiate a transport for the Jingle session (here the transport is an in-band bytestream as defined in <a class='info' href='#XEP-0047'>[XEP&#8209;0047]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; November&nbsp;2006.</span><span>)</span></a>, for which the Jingle negotiation process is specified in <a class='info' href='#XEP-0261'>[XEP&#8209;0261]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Jingle In-Band Bytestreams Transport,&rdquo; February&nbsp;2009.</span><span>)</span></a>; however other transports could be used, for example SOCKS5 bytestreams as defined in <a class='info' href='#XEP-0065'>[XEP&#8209;0065]<span> (</span><span class='info'>Smith, D., Miller, M., and P. Saint-Andre, &ldquo;SOCKS5 Bytestreams,&rdquo; May&nbsp;2007.</span><span>)</span></a> and negotiated for Jingle as specified in <a class='info' href='#XEP-0260'>[XEP&#8209;0260]<span> (</span><span class='info'>Saint-Andre, P. and D. Meyer, &ldquo;Jingle SOCKS5 Bytestreams Transport Method,&rdquo; February&nbsp;2009.</span><span>)</span></a>).  Because the parties wish to establish end-to-end encryption, they do not send application data over the transport until the transport has been secured.  Therefore the first data that they exchange over the transport consists of the standard four-way TLS handshake, encoded in accordance with the negotiated transport method.
</p>
<p></p>
<blockquote class="text">
<p>Note: Each transport MUST define a specific time when both clients know that the transport is secured.  When XTLS is not used, the Jingle implementation would signal to the using application that the transport is open when the session-accept is sent or received, or when connectivity checks determine media can flow over one of the transport candidates.  When XTLS is used, the Jingle implementation starts a TLS handshake on the transport and signals to the using application that the transport is open only after the TLS handshake has finished successfully.
</p>
</blockquote>

<p>During the TLS handshake, the responder MUST take the role of the TLS server and the initiator MUST take the role of the TLS client.  Because the transport is an in-band bytestream, the TLS handshake data is prepared as described in <a class='info' href='#XEP-0047'>[XEP&#8209;0047]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; November&nbsp;2006.</span><span>)</span></a> (i.e., Base64-encoded).  First the initiator (acting as the TLS client) constructs a TLS ClientHello, encodes it according to IBB, and sends it to the responder.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='vh38s618'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='0'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder (acting as the TLS server) then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder then constructs an appropriate TLS message or messages, such as a ServerHello and a CertificateRequest.
</p>
<p></p>
<blockquote class="text">
<p>Note: The responder MUST send a CertificateRequest to the initiator.
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='xyw516d0'
    from='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='0'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>(Because in-band bytestreams are bidirectional and this data is sent from the responder to the initiator, the IBB 'seq' attribute has a value of zero, not 1.)
</p>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>After some number of TLS messages, the initiator eventually sends a TLS Finished message to the responder.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='s91vd527'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='3'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder then also sends a TLS Finished message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='z71gs73t'
    from='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='3'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>If the TLS negotiation has finished successfully, then the Jingle implementation shall signal to the using application that the transport has been secured and is ready to be used.  The parties can then begin to exchange application data over the encrypted transport.
</p>
<a name="streamproto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
End-to-End Streams over XTLS Protocol Flow</h3>

<p>For end-to-end encryption of XMPP traffic, the application data is an end-to-end XML stream. After the XTLS session is set up, the peers open an XML stream to excahnge messages. The XML streams are sent though the XTLS connection. In this example the streams are sent over TLS over IBB.
</p>
<p>First the initiator constructs an initial stream header.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;stream:stream
        xmlns='jabber:client'
        xmlns:stream='http://etherx.jabber.org/streams'
        from='romeo@montague.lit/orchard'
        to='juliet@capulet.lit/balcony'
        version='1.0'&gt;
</pre></div>
<p>Note: In accordance with <a class='info' href='#rfc3920bis'>[rfc3920bis]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; March&nbsp;2009.</span><span>)</span></a>, the initial stream header SHOULD include the 'to' and 'from' attributes, which SHOULD specify the full JIDs of the clients. The initiator SHOULD include the version='1.0' flag as shown in the previous example.
</p>
<p>The initiator then sends the stream header through the TLS stream and encodes the TLS data in IBB and sends it to the responder.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='ur73n153'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='4'
        sid='vj3hs98y'&gt;
    Base64-TLS-data-of-the-stream-header
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder then constructs a response stream header back to the initiator.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;stream:stream
        xmlns='jabber:client'
        xmlns:stream='http://etherx.jabber.org/streams'
        from='juliet@capulet.lit/balcony'
        id='hs91gh1836d8s717'
        to='romeo@montague.lit/orchard'
        version='1.0'&gt;
</pre></div>
<p>The responder then sends the response stream header over the TLS link it to the initiator.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='pd61g397'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='4'
        sid='vj3hs98y'&gt;
    Base64-TLS-data-of-the-responce-stream-header
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>Once the streams are established over the bytestreams, either entity then can send XMPP message, presence, and IQ stanzas, with or without 'to' and 'from' addresses.
</p>
<p>For example, the initiator could construct an XMPP message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message from='romeo@montague.lit/orchard'
         to='juliet@capulet.lit/balcony'&gt;
  &lt;body&gt;
    M&amp;apos;lady, I would be pleased to make your acquaintance.
  &lt;/body&gt;
&lt;/message&gt;
</pre></div>
<p>The initiator then sends the message over the XTLS connection to the responder.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='iq7dh294'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='5'
        sid='vj3hs98y'&gt;
    Base64-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder could then construct a reply.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message from='juliet@capulet.lit/balcony'
         to='romeo@montague.lit/orchard'&gt;
  &lt;body&gt;Art thou not Romeo, and a Montague?&lt;/body&gt;
&lt;/message&gt;
</pre></div>
<p>The responder then sends the reply over the XTLS connection to the initiator.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hr91hd63'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='5'
        sid='vj3hs98y'&gt;
    Base64-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>To close the end-to-end XML stream, either party (here the responder) constructs a closing &lt;/stream:stream&gt; element.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;/stream:stream&gt;
</pre></div>
<p>The client sends the closing element to the peer over the XTLS connection.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='kr91n475'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='6'
        sid='vj3hs98y'&gt;
    Base64-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The peer then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>However, even after the application-level XML stream is terminated, the negotiated Jingle transport (here in-band bytestream) continues and could be re-used. To completely terminate the Jingle session, the terminating party would then also send a Jingle session-terminate message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='psy617r4'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:0'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='851ba2'/&gt;
&lt;/iq&gt;
</pre></div>
<p>The other party then acknowledges the Jingle session-terminate by sending an IQ stanza of type "result" (not shown here).
</p>
<a name="bootstrapping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Bootstrapping Trust on First Communication</h3>

<p>When two parties first attempt to use XTLS, their certificates might not be accepted (e.g., because they are self-signed or issued by unknown certification authorities).  Therefore each party needs to accept the other's certificate for use in future communication sessions.  There are several ways to do so:
</p>
<p>
        </p>
<ul class="text">
<li>Leap of faith.  The recipient can hope that there is no man-in-the-middle during the first communication session.  If the certificate does not change in future sessions, the recipient at least knows that it is talking with the same entity it talked with during the first session.  However, that entity might be a man-in-the-middle rather than the assumed communication partner.  Therefore, leap of faith is discouraged.
</li>
<li>Check fingerprints.  The parties could validate the certificate fingerprints via some trusted means outside the XMPP band, such as in person, via encrypted email, or over the phone.  This is not user-friendly because certificate fingerprints consist of long strings of letters and numbers.  As a result, few humans routinely check certificate fingerprints in protocols such as Secure Shell (ssh).
</li>
<li>One-time password.  The parties can exchange a user-friendly password known only to themselves and verify it out of band before the TLS handshake finishes.  For this purpose, it is REQUIRED for implementations to support at least one TLS cipher that uses Secure Remote Password (SRP) as defined in <a class='info' href='#TLS-SRP'>[TLS&#8209;SRP]<span> (</span><span class='info'>Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;Using the Secure Remote Password (SRP) Protocol for TLS Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</li>
<li>Channel binding.  It is possible that a future version will describe how to use an appropriate Simple Authentication and Security Layer (SASL) mechanism, such as <a class='info' href='#SCRAM'>[SCRAM]<span> (</span><span class='info'>Menon-Sen, A., Melnikov, A., and C. Newman, &ldquo;Salted Challenge Response (SCRAM) SASL Mechanism,&rdquo; February&nbsp;2009.</span><span>)</span></a>, to authenticate the XTLS channel after the TLS handshake finishes using the concept of channel bindings (see <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>).
</li>
</ul><p>
      
</p>
<p>If the parties use a password or SASL channel binding to bootstrap trust, the process needs to be completed only once.  After the clients have authenticated with the shared secret, they can exchange their certificates for future communication.
</p>
<a name="exchange"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Exchanging Certificates</h3>

<p>To retrieve the certificate of the peer for future communications, a client SHOULD request the certificate according to <a class='info' href='#XEP-0189'>[XEP&#8209;0189]<span> (</span><span class='info'>Paterson, I., Saint-Andre, P., and D. Meyer, &ldquo;Public Key Publishing,&rdquo; March&nbsp;2009.</span><span>)</span></a> over the secure connection.  This works only if XTLS was used to set up an end-to-end secure XML stream; exchanging certificates if XTLS was used for other purposes like file transfer is not possible.  A client MUST NOT request the certificate over the insecure stream based on the connection to the XMPP server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='hf7634k4'
    to='juliet@capulet.lit/balcony'
    type='get'&gt;
  &lt;pubkeys xmlns='urn:xmpp:tmp:pubkey'/&gt;
&lt;/iq&gt;
</pre></div>
<p>The peer MUST return its own client certificate.  If the user has different clients with different client certificates and one user certificate, the user certificate SHOULD also be returned.  The user certificate allows it to verify other client certificates using public key retrieval described in <a class='info' href='#XEP-0189'>[XEP&#8209;0189]<span> (</span><span class='info'>Paterson, I., Saint-Andre, P., and D. Meyer, &ldquo;Public Key Publishing,&rdquo; March&nbsp;2009.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hf7634k4'
    to='romeo@montague.lit/orchard'
    type='result'&gt;
  &lt;pubkeys xmlns='urn:xmpp:tmp:pubkey'&gt;
    &lt;keyinfo&gt;
      &lt;x509cert&gt;
MIICCTCCAXKgAwIBAgIJALhU0Id6xxwQMA0GCSqGSIb3DQEBBQUAMA4xDDAKBgNV
BAMTA2ZvbzAeFw0wNzEyMjgyMDA1MTRaFw0wODEyMjcyMDA1MTRaMA4xDDAKBgNV
BAMTA2ZvbzCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0DPcfeJzKWLGE22p
RMINLKr+CxqozF14DqkXkLUwGzTqYRi49yK6aebZ9ssFspTTjqa2uNpw1U32748t
qU6bpACWHbcC+eZ/hm5KymXBhL3Vjfb/dW0xrtxjI9JRFgrgWAyxndlNZUpN2s3D
hKDfVgpPSx/Zp8d/ubbARxqZZZkCAwEAAaNvMG0wHQYDVR0OBBYEFJWwFqmSRGcx
YXmQfdF+XBWkeML4MD4GA1UdIwQ3MDWAFJWwFqmSRGcxYXmQfdF+XBWkeML4oRKk
EDAOMQwwCgYDVQQDEwNmb2+CCQC4VNCHesccEDAMBgNVHRMEBTADAQH/MA0GCSqG
SIb3DQEBBQUAA4GBAIhlUeGZ0d0msNVxYWAXg2lRsJt9INHJQTCJMmoUeTtaRjyp
ffJtuopguNNBDn+MjrEp2/+zLNMahDYLXaTVmBf6zvY0hzB9Ih0kNTh23Fb5j+yK
QChPXQUo0EGCaODWhfhKRNdseUozfNWOz9iTgMGw8eYNLllQRL//iAOfOr/8
      &lt;/x509cert&gt;
    &lt;/keyinfo&gt;
  &lt;/pubkeys&gt;
&lt;/iq&gt;
</pre></div>
<a name="bootstrap-bot"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Verification of Non-Human Parties</h3>

<p>If one of the parties is a "bot" (e.g., an automated service or a device such as a set-top box), the password exchange is a bit more complicated.  It is similar to Bluetooth peering if the user has access to both clients at the same time.  One of the following scenarios might apply:
</p>
<p>
          </p>
<ul class="text">
<li>The bot can be controlled via a remote control input device.  The human user can enter the same password or "PIN" on both the bot and the XMPP client.
</li>
<li>If the bot has no user input but does have a small display, it could display a random password.  The human user can then enter the provided password on the XMPP client.
</li>
<li>The bot might have not enough buttons for input and has no output device.  In that case the password is fixed.  Similar to Bluetooth peering with simple devices such as a headset, the password will be written in the manual or printed on the device.  For security reasons the device SHOULD NOT use password-based authentication without any user input.  Many Bluetooth devices have at least one button to set the device into peering mode.
</li>
<li>A bot may be associated with a web service and could display a random password when the user has logged in to the web site using HTTPS.  This assumes that an attacker does not have control over the web server and can perform a man-in-the-middle attack on XMPP level at the same time.  If the web service knows the GPG-key of the user (e.g.  launchpad) it could send an encrypted email.
</li>
</ul><p>
        
</p>
<p>A user might have different X.509 certificates for each device.  <a class='info' href='#XEP-0189'>[XEP&#8209;0189]<span> (</span><span class='info'>Paterson, I., Saint-Andre, P., and D. Meyer, &ldquo;Public Key Publishing,&rdquo; March&nbsp;2009.</span><span>)</span></a> can be used to manage the user's certificates.  A client SHOULD check the peer's PubSub node for certificates.  This makes it possible to use the password method only once between two users even if one or both users switch clients.  A user can also communicate with a friend's bots:  they first open a secure link between two chat clients with a password and exchange the user certificates.  After that each device of a user can verify all devices of the other without the need of a password.
</p>
<p>The retrieved certificate from the PubSub node may be signed by a CA the client can verify.  In that case the client MAY skip the password authentication and rely on the X.509 certificate chain.  The client SHOULD ask the user if the certificate should be accepted or if a password exchange is desired.
</p>
<a name="terminate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Session Termination</h3>

<p>If either client cannot verify the certificate of the peer or receives an invalid message on the TLS layer, it MUST terminate the Jingle session immediately by sending a Jingle session-terminate message that includes a Jingle reason of &lt;security-error/&gt;.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='hz81vf48'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:0'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;&lt;security-error/&gt;&lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The other party then acknowledges the session-terminate by sending an IQ stanza of type "result" (not shown here), and the Jingle session is finished.
</p>
<a name="support"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Determining Support</h3>

<p>If an entity wishes to request the use of XTLS, it SHOULD first determine whether the intended responder supports the protocol.  This can be done directly via <a class='info' href='#XEP-0030'>[XEP&#8209;0030]<span> (</span><span class='info'>Hildebrand, J., Millard, P., Eatmon, R., and P. Saint-Andre, &ldquo;Service Discovery,&rdquo; June&nbsp;2008.</span><span>)</span></a> or indirectly via <a class='info' href='#XEP-0115'>[XEP&#8209;0115]<span> (</span><span class='info'>Hildebrand, J., Saint-Andre, P., Tron&#xE7;on, R., and J. Konieczny, &ldquo;Entity Capabilities,&rdquo; February&nbsp;2008.</span><span>)</span></a>.
</p>
<p>If an entity supports XTLS, it MUST report that by including a service discovery feature of "urn:xmpp:jingle:security:xtls:0" in response to disco#info requests.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='disco1'
    to='juliet@capulet.lit/chamber'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.lit/chamber'
    id='disco1'
    to='romeo@montague.lit/orchard'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;feature var='urn:xmpp:jingle:security:xtls:0'/&gt;
    &lt;feature var='urn:xmpp:jingle:apps:xmlstream:0'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
</pre></div>
<p>Both service discovery and entity capabilities information could be corrupted or intercepted; for details, see under <a class='info' href='#security-dos'>Section&nbsp;11.3<span> (</span><span class='info'>Denial of Service</span><span>)</span></a>.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>This entire document addresses security.  Particular security-related issues are discussed in the following sections.
</p>
<a name="security-mti"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Mandatory-to-Implement Technologies</h3>

<p>An implementation MUST at a minimum support the "srp" and "x509" methods.  A future version of this specification will document mandatory-to-implement TLS ciphers.
</p>
<a name="security-certs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2"></a><h3>11.2.&nbsp;
Certificates</h3>

<p>As noted, XTLS can be used between XMPP clients, between an XMPP client and a remote XMPP service (i.e., a service with which a client does not have a direct XML stream), or between remote XMPP services.  Therefore, a party to an XTLS bytestream will present either a client certificate or a server certificate as appropriate.  Such certificates MUST be generated and validated in accordance with the certificate guidelines guidelines provided in <a class='info' href='#rfc3920bis'>[rfc3920bis]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; March&nbsp;2009.</span><span>)</span></a>.
</p>
<p>A future version of this specification might provide additional guidelines regarding certificate validation in the context of client-to-client encryption.
</p>
<a name="security-dos"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3"></a><h3>11.3.&nbsp;
Denial of Service</h3>

<p>Currently XMPP stanzas such as Jingle negotiation messages and service discovery exchanges are not encrypted or signed. As a result, it is possible for an attacker to intercept these stanzas and modify them, thus convincing one party that the other party does not support XTLS and therefore denying the parties an opportunity to use XTLS.
</p>
<p>This is a more general problem with XMPP technologies and needs to be addressed at the core XMPP layer.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>It might be helpful to create a registry of TLS methods that can be used in the context of XTLS (e.g., "openpgp" for use of <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>, "srp" for use of <a class='info' href='#TLS-SRP'>[TLS&#8209;SRP]<span> (</span><span class='info'>Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;Using the Secure Remote Password (SRP) Protocol for TLS Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>, and "x509" for use of <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> with certificates). The registry could be maintained by the IANA or by the XMPP Registrar. A future version of this specification will provide more detailed information about the registration requirements.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="rfc3920bis">[rfc3920bis]</a></td>
<td class="author-text">Saint-Andre, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-saintandre-rfc3920bis-09.txt">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; draft-saintandre-rfc3920bis-09 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-saintandre-rfc3920bis-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TERMS">[TERMS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS">[TLS]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0047">[XEP-0047]</a></td>
<td class="author-text"><a href="mailto:justin@affinix.com">Karneges, J.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0047.html">In-Band Bytestreams (IBB)</a>,&rdquo; XSF XEP&nbsp;0047, November&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0166">[XEP-0166]</a></td>
<td class="author-text"><a href="mailto:scottlu@google.com">Ludwig, S.</a>, <a href="mailto:jbeda@google.com">Beda, J.</a>, <a href="mailto:">Saint-Andre, P.</a>, <a href="mailto:robert.mcqueen@collabora.co.uk">McQueen, R.</a>, <a href="mailto:seanegan@google.com">Egan, S.</a>, and <a href="mailto:jhildebrand@jabber.com">J. Hildebrand</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0166.html">Jingle</a>,&rdquo; XSF XEP&nbsp;0166, December&nbsp;2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DTLS">[DTLS]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://tools.ietf.org/html/rfc4347">Datagram Transport Layer Security</a>,&rdquo; RFC&nbsp;4347, April&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4347.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DTLS-SRTP">[DTLS-SRTP]</a></td>
<td class="author-text">McGrew, D. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-avt-dtls-srtp-07.txt">Datagram Transport Layer Security (DTLS) Extension to Establish Keys for  Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; draft-ietf-avt-dtls-srtp-07 (work in progress), February&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-avt-dtls-srtp-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTP-TLS">[HTTP-TLS]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3552">[RFC3552]</a></td>
<td class="author-text">Rescorla, E. and B. Korver, &ldquo;<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>,&rdquo; BCP&nbsp;72, RFC&nbsp;3552, July&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3552.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="rfc3921bis">[rfc3921bis]</a></td>
<td class="author-text">Saint-Andre, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-saintandre-rfc3921bis-07.txt">Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and  Presence</a>,&rdquo; draft-saintandre-rfc3921bis-07 (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-saintandre-rfc3921bis-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3923">[RFC3923]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3923">End-to-End Signing and Object Encryption for the Extensible Messaging and Presence Protocol (XMPP)</a>,&rdquo; RFC&nbsp;3923, October&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3923.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3923.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3923.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5081">[RFC5081]</a></td>
<td class="author-text">Mavrogiannopoulos, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5081">Using OpenPGP Keys for Transport Layer Security (TLS) Authentication</a>,&rdquo; RFC&nbsp;5081, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5081.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS-SRP">[TLS-SRP]</a></td>
<td class="author-text">Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;<a href="http://tools.ietf.org/html/rfc5054">Using the Secure Remote Password (SRP) Protocol for TLS Authentication</a>,&rdquo; RFC&nbsp;5054, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5054.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SCRAM">[SCRAM]</a></td>
<td class="author-text">Menon-Sen, A., Melnikov, A., and C. Newman, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-newman-auth-scram-10.txt">Salted Challenge Response (SCRAM) SASL Mechanism</a>,&rdquo; draft-newman-auth-scram-10 (work in progress), February&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-newman-auth-scram-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0027">[XEP-0027]</a></td>
<td class="author-text"><a href="mailto:temas@jabber.org">Muldowney, T.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0027.html">Current Jabber OpenPGP Usage</a>,&rdquo; XSF XEP&nbsp;0027, November&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0030">[XEP-0030]</a></td>
<td class="author-text"><a href="mailto:jhildebrand@jabber.com">Hildebrand, J.</a>, <a href="mailto:">Millard, P.</a>, <a href="mailto:reatmon@jabber.org">Eatmon, R.</a>, and <a href="mailto:">P. Saint-Andre</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0030.html">Service Discovery</a>,&rdquo; XSF XEP&nbsp;0030, June&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0045">[XEP-0045]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0045.html">Multi-User Chat</a>,&rdquo; XSF XEP&nbsp;0045, July&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0060">[XEP-0060]</a></td>
<td class="author-text"><a href="mailto:">Millard, P.</a>, <a href="mailto:">Saint-Andre, P.</a>, and <a href="mailto:ralphm@ik.nu">R. Meijer</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0060.html">Publish-Subscribe</a>,&rdquo; XSF XEP&nbsp;0060, September&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0065">[XEP-0065]</a></td>
<td class="author-text"><a href="mailto:dizzyd@jabber.org">Smith, D.</a>, <a href="mailto:linuxwolf@outer-planes.net">Miller, M.</a>, and <a href="mailto:">P. Saint-Andre</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0065.html">SOCKS5 Bytestreams</a>,&rdquo; XSF XEP&nbsp;0065, May&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0115">[XEP-0115]</a></td>
<td class="author-text"><a href="mailto:jhildebrand@jabber.com">Hildebrand, J.</a>, <a href="mailto:">Saint-Andre, P.</a>, <a href="mailto:">Tron&#xE7;on, R.</a>, and <a href="mailto:jajcus@jajcus.net">J. Konieczny</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0115.html">Entity Capabilities</a>,&rdquo; XSF XEP&nbsp;0115, February&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0160">[XEP-0160]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0160.html">Best Practices for Handling Offline Messages</a>,&rdquo; XSF XEP&nbsp;0160, January&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0167">[XEP-0167]</a></td>
<td class="author-text"><a href="mailto:scottlu@google.com">Ludwig, S.</a>, <a href="mailto:">Saint-Andre, P.</a>, <a href="mailto:seanegan@google.com">Egan, S.</a>, <a href="mailto:robert.mcqueen@collabora.co.uk">McQueen, R.</a>, and <a href="mailto:diana@null.ro">D. Cionoiu</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0167.html">Jingle RTP Sessions</a>,&rdquo; XSF XEP&nbsp;0167, December&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0189">[XEP-0189]</a></td>
<td class="author-text"><a href="mailto:ian.paterson@clientside.co.uk">Paterson, I.</a>, <a href="mailto:">Saint-Andre, P.</a>, and <a href="mailto:dmeyer@tzi.de">D. Meyer</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0189.html">Public Key Publishing</a>,&rdquo; XSF XEP&nbsp;0189, March&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0210">[XEP-0210]</a></td>
<td class="author-text"><a href="mailto:ian.paterson@clientside.co.uk">Paterson, I.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0210.html">Requirements for Encrypted Sessions</a>,&rdquo; XSF XEP&nbsp;0210, May&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0218">[XEP-0218]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a> and <a href="mailto:ian.paterson@clientside.co.uk">I. Paterson</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0218.html">Bootstrapping Implementation of Encrypted Sessions</a>,&rdquo; XSF XEP&nbsp;0218, May&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0234">[XEP-0234]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0234.html">Jingle File Transfer</a>,&rdquo; XSF XEP&nbsp;0234, February&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0260">[XEP-0260]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a> and <a href="mailto:dmeyer@tzi.de">D. Meyer</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0260.html">Jingle SOCKS5 Bytestreams Transport Method</a>,&rdquo; XSF XEP&nbsp;0260, February&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0261">[XEP-0261]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0261.html">Jingle In-Band Bytestreams Transport</a>,&rdquo; XSF XEP&nbsp;0261, February&nbsp;2009.</td></tr>
</table>

<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
XML Schema</h3>

<p>The XML schema will be provided in a later version of this document.
</p>
<a name="copying"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Copying Conditions</h3>

<p>Regarding this entire document or any portion of it, the authors make no guarantees and are not responsible for any damage resulting from its use.  The authors grant irrevocable permission to anyone to use, modify, and distribute it in any way that does not diminish the rights of anyone else to use, modify, and distribute it, provided that redistributed derivative works do not contain misleading author or version information.  Derivative works need not be licensed under similar terms.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dirk Meyer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Universitaet Bremen TZI</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dmeyer@tzi.de">dmeyer@tzi.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Peter Saint-Andre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:psaintan@cisco.com">psaintan@cisco.com</a></td></tr>
</table>
</body></html>
