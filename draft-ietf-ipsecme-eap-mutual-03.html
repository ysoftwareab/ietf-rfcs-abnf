<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>An Extension for EAP-Only Authentication in IKEv2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="An Extension for EAP-Only Authentication in IKEv2">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">P. Eronen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Nokia</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Expires: December 3, 2010</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Y. Sheffer</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Independent</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 1, 2010</td></tr>
</table></td></tr></table>
<h1><br />An Extension for EAP-Only Authentication in IKEv2<br />draft-ietf-ipsecme-eap-mutual-03.txt</h1>

<h3>Abstract</h3>

<p>IKEv2 specifies that EAP authentication must be used together
  with public key signature based responder authentication. This
  is necessary with old EAP methods that provide only unilateral
  authentication using, e.g., one-time passwords or token cards.
</p>
<p>This document specifies how EAP methods that provide mutual
  authentication and key agreement can be used to provide extensible
  responder authentication for IKEv2 based on methods other than
  public key signatures.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on December 3, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>

<a name="introduction"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Extensible Authentication Protocol (EAP), defined in <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, is an authentication framework which
  supports multiple authentication mechanisms. Today, EAP has been
  implemented at end hosts and routers that connect via switched
  circuits or dial-up lines using PPP <a class='info' href='#RFC1661'>[RFC1661]<span> (</span><span class='info'>Simpson, W., &ldquo;The Point-to-Point Protocol (PPP),&rdquo; July&nbsp;1994.</span><span>)</span></a>, IEEE
  802 wired switches <a class='info' href='#IEEE8021X'>[IEEE8021X]<span> (</span><span class='info'>Institute of Electrical and Electronics Engineers, &ldquo;Local and Metropolitan Area Networks: Port-Based Network Access Control,&rdquo; 2001.</span><span>)</span></a>, and IEEE 802.11
  wireless access points <a class='info' href='#IEEE80211i'>[IEEE80211i]<span> (</span><span class='info'>Institute of Electrical and Electronics Engineers, &ldquo;IEEE Standard for Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11: Wireless Medium Access Control (MAC) and Physical Layer (PHY) specifications: Amendment 6: Medium Access Control (MAC) Security Enhancements,&rdquo; July&nbsp;2004.</span><span>)</span></a>.
</p>
<p>One of the advantages of the EAP architecture is its
  flexibility. EAP is used to select a specific authentication
  mechanism, typically after the authenticator requests more
  information in order to determine the specific authentication method
  to be used. Rather than requiring the authenticator (e.g., wireless
  LAN access point) to be updated to support each new authentication
  method, EAP permits the use of a backend authentication server which
  may implement some or all authentication methods.
</p>
<p>IKEv2 (<a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-ipsecme-ikev2bis'>[I&#8209;D.ietf&#8209;ipsecme&#8209;ikev2bis]<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol: IKEv2,&rdquo; May&nbsp;2010.</span><span>)</span></a>)
  is a component of
  IPsec used for performing mutual authentication and establishing and
  maintaining security associations for IPsec ESP and AH. In addition
  to supporting authentication using public key signatures and shared
  secrets, IKEv2 also supports EAP authentication.
</p>
<p>IKEv2 provides EAP authentication since it was recognized that
  public key signatures and shared secrets are not flexible enough to
  meet the requirements of many deployment scenarios.  By using EAP,
  IKEv2 can leverage existing authentication infrastructure and
  credential databases, since EAP allows users to choose a method
  suitable for existing credentials, and also makes separation of the
  IKEv2 responder (VPN gateway) from the EAP authentication endpoint
  (backend AAA server) easier.
</p>
<p>Some older EAP methods are designed for unilateral authentication
  only (that is, EAP peer to EAP server). These methods are used in
  conjunction with IKEv2 public key based authentication of the
  responder to the initiator. It is expected that this approach is
  especially useful for "road warrior" VPN gateways that use, for
  instance, one-time passwords or token cards to authenticate the
  clients.
</p>
<p>However, most newer EAP methods, such as those typically used
  with IEEE 802.11i wireless LANs, provide mutual authentication and
  key agreement. Currently, IKEv2 specifies that these EAP
  methods must also be used together with public key signature based
  responder authentication.
</p>
<p> In order for the public key signature authentication of the gateway to be
    effective, a deployment of PKI is required, which has to include
    management of trust anchors on all supplicants. In many environments,
    this is not realistic, and the security of the gateway public key is
    the same as the security of a self-signed certificate. Mutually authenticating EAP methods alone can
  provide a sufficient level of security in many circumstances, and
  in fact in some deployments, IEEE 802.11i uses EAP without any PKI for authenticating
  the WLAN access points.
</p>
<p>This document specifies how EAP methods that offer mutual
  authentication and key agreement can be used to provide responder
  authentication in IKEv2 completely based on EAP.
</p>
<a name="terminology"></a><br /><hr />
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
  NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
  in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="scenarios"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Scenarios</h3>

<p>In this section we describe two scenarios for extensible
  authentication within IKEv2. These scenarios are intended to be
  illustrative examples rather than specifying how things should be
  done.
</p>
<p><a class='info' href='#co-located'>Figure&nbsp;1<span> (</span><span class='info'>EAP and IKEv2 endpoints are co-located</span><span>)</span></a> shows a configuration where the EAP
  and the IKEv2 endpoints are co-located. Authenticating the IKEv2
  responder using both EAP and public key signatures is redundant.
  Offering EAP based authentication has the advantage that multiple
  different authentication and key exchange protocols are available
  with EAP with different security properties (such as strong password
  based protocols, protocols offering user identity confidentiality
  and many more). 
</p><br /><hr class="insert" />
<a name="co-located"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       +------+-----+                            +------------+
  O    |   IKEv2    |                            |   IKEv2    |
 /|\   | Initiator  |&lt;---////////////////////---&gt;| Responder  |
 / \   +------------+          IKEv2             +------------+
 User  |  EAP Peer  |          Exchange          | EAP Server |
       +------------+                            +------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: EAP and IKEv2 endpoints are co-located&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p><a class='info' href='#corporate-network'>Figure&nbsp;2<span> (</span><span class='info'>Corporate Network Access</span><span>)</span></a> shows a typical corporate
  network access scenario. The initiator (client) interacts with the
  responder (VPN gateway) in the corporate network. The EAP exchange
  within IKE runs between the client and the home AAA server. As a
  result of a successful EAP authentication protocol run, session keys
  are established and sent from the AAA server to the VPN gateway, and
  then used to authenticate the IKEv2 SA with AUTH payloads.
</p>
<p>The protocol used between the VPN gateway and AAA server could
  be, for instance, Diameter <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> or
  RADIUS <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a>. See <a class='info' href='#security'>Section&nbsp;6<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>
  for related security considerations.
</p><br /><hr class="insert" />
<a name="corporate-network"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                             +-------------------------------+
                             |       Corporate network       |
                             |                               |
                        +-----------+            +--------+  |
                        |   IKEv2   |     AAA    |  Home  |  |
  IKEv2      +////-----&gt;+ Responder +&lt;----------&gt;+  AAA   |  |
  Exchange   /          | (VPN GW)  |  (RADIUS/  | Server |  |
             /          +-----------+  Diameter) +--------+  |
             /               |        carrying EAP           |
             |               |                               |
             |               +-------------------------------+
             v
      +------+-----+
  o   |   IKEv2    |
 /|\  | Initiator  |
 / \  | VPN client |
User  +------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Corporate Network Access&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="solution"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Solution</h3>

<p>IKEv2 specifies that when the EAP method establishes a shared
  secret key, that key is used by both the initiator and responder to
  generate an AUTH payload (thus authenticating the IKEv2 SA set up by
  messages 1 and 2).
</p>
<p>When used together with public key responder authentication, the
  responder is in effect authenticated using two different methods:
  the public key signature AUTH payload in message 4, and the
  EAP-based AUTH payload later.
</p>
<p>If the initiator does not wish to use public key based responder
  authentication, it includes an EAP_ONLY_AUTHENTICATION notification
  payload (type TBD-BY-IANA) in message 3. The Protocol ID and SPI size fields are
  set to zero, and there is no additional data associated with
  this notification.
</p>
<p>If the responder supports this notification and chooses to use it, it omits the
  public key based AUTH payload and CERT payloads from message 4.
</p>
<p>If the responder does not support the EAP_ONLY_AUTHENTICATION
  notification or does not wish to use it, it ignores the notification payload, and includes the
  AUTH payload in message 4. In this case the initiator MUST verify
  that payload and any associated certificates,
  as per <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
</p>
<p>When receiving message 4, the initiator MUST verify that the proposed
EAP method is allowed by this specification, and MUST abort the protocol
immediately otherwise.
</p>
<p>Both the initiator and responder MUST verify that the EAP method
  actually used provided mutual authentication and established a
  shared secret key. The AUTH payloads sent after EAP Success MUST use
  the EAP-generated key, and MUST NOT use SK_pi or SK_pr.
</p>
<p>An IKEv2 message exchange with this modification is shown below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   Initiator                   Responder
  -----------                 -----------
   HDR, SAi1, KEi, Ni,
        [N(NAT_DETECTION_SOURCE_IP),
         N(NAT_DETECTION_DESTINATION_IP)]  --&gt;

                         &lt;--   HDR, SAr1, KEr, Nr, [CERTREQ],
                                    [N(NAT_DETECTION_SOURCE_IP),
                                     N(NAT_DETECTION_DESTINATION_IP)]

   HDR, SK { IDi, [IDr], SAi2, TSi, TSr,
             N(EAP_ONLY_AUTHENTICATION),
             [CP(CFG_REQUEST)] }  --&gt;

                         &lt;--   HDR, SK { IDr, EAP(Request) }

   HDR, SK { EAP(Response) }  --&gt;

                         &lt;--   HDR, SK { EAP(Request) }

   HDR, SK { EAP(Response) }  --&gt;

                         &lt;--   HDR, SK { EAP(Success) }

   HDR, SK { AUTH }  --&gt;

                         &lt;--   HDR, SK { AUTH, SAr2, TSi, TSr,
                                         [CP(CFG_REPLY] }

</pre></div>
<p>The NAT detection and Configuration payloads are shown for
   informative purposes only; they do not change how EAP
   authentication works.
</p>
<a name="safe-methods"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Safe EAP Methods</h3>

<p>EAP methods to be used with this extension MUST have the following properties:
</p>
<p>
</p>
<ol class="text">
<li>The method provides mutual authentication of the peers.
</li>
<li>The method is key-generating.
</li>
<li>The method is resistant to dictionary attack.
</li>
</ol><p>

</p>
<p>The following EAP methods are believed to be secure when used with the current extension.
In addition, there are likely other
safe methods which have not been listed here.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Method Name</th><th align="left">Allows Channel Binding?</th><th align="left">Reference</th></tr>
<tr>
<td align="left">EAP-SIM</td>
<td align="left">No</td>
<td align="left"><a class='info' href='#RFC4186'>[RFC4186]<span> (</span><span class='info'>Haverinen, H. and J. Salowey, &ldquo;Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM),&rdquo; January&nbsp;2006.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-AKA</td>
<td align="left">Yes</td>
<td align="left"><a class='info' href='#RFC4187'>[RFC4187]<span> (</span><span class='info'>Arkko, J. and H. Haverinen, &ldquo;Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA),&rdquo; January&nbsp;2006.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-AKA'</td>
<td align="left">Yes</td>
<td align="left"><a class='info' href='#RFC5448'>[RFC5448]<span> (</span><span class='info'>Arkko, J., Lehtovirta, V., and P. Eronen, &ldquo;Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA'),&rdquo; May&nbsp;2009.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-GPSK</td>
<td align="left">Yes</td>
<td align="left"><a class='info' href='#RFC5433'>[RFC5433]<span> (</span><span class='info'>Clancy, T. and H. Tschofenig, &ldquo;Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method,&rdquo; February&nbsp;2009.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-pwd</td>
<td align="left">No</td>
<td align="left"><a class='info' href='#I-D.harkins-emu-eap-pwd'>[I&#8209;D.harkins&#8209;emu&#8209;eap&#8209;pwd]<span> (</span><span class='info'>Harkins, D. and G. Zorn, &ldquo;EAP Authentication Using Only A Password,&rdquo; April&nbsp;2010.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-EKE</td>
<td align="left">Yes</td>
<td align="left"><a class='info' href='#I-D.sheffer-emu-eap-eke'>[I&#8209;D.sheffer&#8209;emu&#8209;eap&#8209;eke]<span> (</span><span class='info'>Sheffer, Y., Zorn, G., Tschofenig, H., and S. Fluhrer, &ldquo;An EAP Authentication Method Based on the EKE Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-PAX</td>
<td align="left">Yes</td>
<td align="left"><a class='info' href='#RFC4746'>[RFC4746]<span> (</span><span class='info'>Clancy, T. and W. Arbaugh, &ldquo;Extensible Authentication Protocol (EAP) Password Authenticated Exchange,&rdquo; November&nbsp;2006.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-SAKE</td>
<td align="left">No</td>
<td align="left"><a class='info' href='#RFC4763'>[RFC4763]<span> (</span><span class='info'>Vanderveen, M. and H. Soliman, &ldquo;Extensible Authentication Protocol Method for Shared-secret Authentication and Key Establishment (EAP-SAKE),&rdquo; November&nbsp;2006.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-SRP</td>
<td align="left">No</td>
<td align="left"><a class='info' href='#I-D.ietf-pppext-eap-srp-03'>[I&#8209;D.ietf&#8209;pppext&#8209;eap&#8209;srp&#8209;03]<span> (</span><span class='info'>Carlson, J., Aboba, B., and H. Haverinen, &ldquo;EAP SRP-SHA1 Authentication Protocol,&rdquo; July&nbsp;2001.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-POTP (mutual authentication variant)</td>
<td align="left">Yes</td>
<td align="left"><a class='info' href='#RFC4793'>[RFC4793]<span> (</span><span class='info'>Nystroem, M., &ldquo;The EAP Protected One-Time Password Protocol (EAP-POTP),&rdquo; February&nbsp;2007.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-TLS</td>
<td align="left">No</td>
<td align="left"><a class='info' href='#RFC5216'>[RFC5216]<span> (</span><span class='info'>Simon, D., Aboba, B., and R. Hurst, &ldquo;The EAP-TLS Authentication Protocol,&rdquo; March&nbsp;2008.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-FAST</td>
<td align="left">No</td>
<td align="left"><a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">EAP-TTLS</td>
<td align="left">No</td>
<td align="left"><a class='info' href='#RFC5281'>[RFC5281]<span> (</span><span class='info'>Funk, P. and S. Blake-Wilson, &ldquo;Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0),&rdquo; August&nbsp;2008.</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />

<p>The "Allows channel binding?" column denotes protocols where protected identity
information may be sent between the EAP endpoints. This third, optional property of the method provides protection against
certain types of attacks (see <a class='info' href='#channel-binding'>Section&nbsp;6.2<span> (</span><span class='info'>Authentication with separated IKEv2 responder/EAP server</span><span>)</span></a>), and therefore in some scenarios,
methods that allow for channel binding are to be preferred.
It is noted that at the time of
writing, even when such capabilities are provided, they are not fully specified
in an interoperable manner. In particular, no RFC specifies what identities should be sent under the protection of
the channel binding mechanism, or what policy is to be used to correlate identities at the different layers.
</p>
<a name="iana"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA considerations</h3>

<p>This document defines a new IKEv2 Notification Payload type,
  EAP_ONLY_AUTHENTICATION, described in <a class='info' href='#solution'>Section&nbsp;3<span> (</span><span class='info'>Solution</span><span>)</span></a>.
  This payload must be assigned a new type number from the
  "status types" range.
</p>
<a name="security"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>Security considerations applicable to all EAP methods are
  discussed in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>. The EAP Key
  Management Framework <a class='info' href='#RFC5247'>[RFC5247]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; August&nbsp;2008.</span><span>)</span></a> deals with
  issues that arise when EAP is used as a part of a larger system.
</p>
<a name="anchor1"></a><br /><hr />
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Authentication of IKEv2 SA</h3>

<p>It is important to note that the IKEv2 SA is not authenticated by
  just running an EAP conversation: the crucial step is the AUTH
  payload based on the EAP-generated key. Thus, EAP methods that do
  not provide mutual authentication or establish a shared secret key
  MUST NOT be used with the modifications presented in this
  document.
</p>
<a name="channel-binding"></a><br /><hr />
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Authentication with separated IKEv2 responder/EAP server</h3>

<p>As described in <a class='info' href='#scenarios'>Section&nbsp;2<span> (</span><span class='info'>Scenarios</span><span>)</span></a>, the EAP conversation
  can terminate either at the IKEv2 responder or at a backend AAA
  server.
</p>
<p>If the EAP method is terminated at the IKEv2 responder then no key
  transport via the AAA infrastructure is required. Pre-shared secret
  and public key based authentication offered by IKEv2 is then
  replaced by a wider range of authentication and key exchange
  methods.
</p>
<p>However, typically EAP will be used with a backend AAA server.
  See <a class='info' href='#RFC5247'>[RFC5247]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; August&nbsp;2008.</span><span>)</span></a> for a more complete
  discussion of the related security issues; here we provide only a
  short summary.
</p>
<p>When a backend server is used, there are actually two
  authentication exchanges: the EAP method between the client and the
  AAA server, and another authentication between the AAA server and
  IKEv2 gateway. The AAA server authenticates the client using the selected EAP method,
  and they establish a session key. The AAA server then sends
  this key to the IKEv2 gateway over a connection authenticated using,
  e.g., IPsec or TLS.
</p>
<p>Some EAP methods do not have any concept of pass-through
  authenticator (e.g., NAS or IKEv2 gateway) identity, and these two
  authentications remain quite independent of each other. That is,
  after the client has verified the AUTH payload sent by the IKEv2
  gateway, it knows that it is talking to SOME gateway trusted by the
  home AAA server, but not which one. The situation is somewhat
  similar if a single cryptographic hardware accelerator, containing a
  single private key, would be shared between multiple IKEv2 gateways
  (perhaps in some kind of cluster configuration). In particular, if
  one of the gateways is compromised, it can impersonate any of the
  other gateways towards the user (until the compromise is discovered
  and access rights revoked).
</p>
<p>In some environments it is not desirable to trust the IKEv2
  gateways this much (also known as the "Lying NAS Problem").  EAP
  methods that provide what is called "connection binding" or "channel
  binding" transport some identity or identities of the gateway (or
  WLAN access point/NAS) inside the EAP method.  Then the AAA server
  can check that it is indeed sending the key to the gateway expected
  by the client. A potential solution is described in <a class='info' href='#I-D.arkko-eap-service-identity-auth'>[I&#8209;D.arkko&#8209;eap&#8209;service&#8209;identity&#8209;auth]<span> (</span><span class='info'>Arkko, J. and P. Eronen, &ldquo;Authenticated Service Information for the Extensible Authentication Protocol  (EAP),&rdquo; October&nbsp;2005.</span><span>)</span></a>, and see also
  <a class='info' href='#I-D.clancy-emu-aaapay'>[I&#8209;D.clancy&#8209;emu&#8209;aaapay]<span> (</span><span class='info'>Clancy, C., Lior, A., Zorn, G., and K. Hoeper, &ldquo;EAP Method Support for Transporting AAA Payloads,&rdquo; May&nbsp;2010.</span><span>)</span></a>.
</p>
<p>In some deployment configurations, AAA proxies may be present
  between the IKEv2 gateway and the backend AAA server. These AAA
  proxies MUST be trusted for secure operation, and therefore SHOULD
  be avoided when possible; see <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> and
  <a class='info' href='#RFC5247'>[RFC5247]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; August&nbsp;2008.</span><span>)</span></a> for more discussion.
</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Protection of EAP payloads</h3>

<p>Although the EAP payloads are encrypted and integrity protected
  with SK_e/SK_a, this does not provide any protection against
  active attackers. Until the AUTH payload has been received
  and verified, a man-in-the-middle can change the KEi/KEr payloads
  and eavesdrop or modify the EAP payloads.
</p>
<p>In IEEE 802.11i wireless LANs, the EAP payloads are neither encrypted nor
  integrity protected (by the link layer), so EAP methods are
  typically designed to take that into account.
</p>
<p>In particular, EAP methods that are vulnerable to dictionary
  attacks when used in WLANs are still vulnerable (to active
  attackers) when run inside IKEv2.
</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Identities and Authenticated Identities</h3>

<p>When using this protocol, each of the peers sends two identity values:
</p>
<ol class="text">
<li>An identity contained in the IKE ID payload.
</li>
<li>An identity transferred within the specific EAP method's messages.
</li>
</ol><p>
(The EAP Identity request/response pair is omitted, as usual in IKEv2.) The first identity value can be used
by the recipient to route AAA messages and/or to select
authentication and EAP types. But it is only the second identity that is directly authenticated by the EAP method.
The reader is referred to Sec. 2.16 of <a class='info' href='#I-D.ietf-ipsecme-ikev2bis'>[I&#8209;D.ietf&#8209;ipsecme&#8209;ikev2bis]<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol: IKEv2,&rdquo; May&nbsp;2010.</span><span>)</span></a> regarding the need to base IPsec policy
decisions on the authenticated identity. In the context of the extension described here, this
guidance applies both to the authentication of the client by the gateway and vice versa.

</p>
<a name="anchor4"></a><br /><hr />
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
User identity confidentiality</h3>

<p>IKEv2 provides confidentiality for the initiator identity against
  passive eavesdroppers, but not against active attackers. The
  initiator announces its identity first (in message #3), before the
  responder has been authenticated. The usage of EAP in IKEv2 does not
  change this situation, since the ID payload in message #3 is used
  instead of the EAP Identity Request/Response exchange. This is
  somewhat unfortunate since when EAP is used with public key
  authentication of the responder, it would be possible to provide
  active user identity confidentiality for the initiator. 
</p>
<p>IKEv2 protects the responder's identity even against active
  attacks. This property cannot be provided when using EAP. If public
  key responder authentication is used in addition to EAP, the
  responder reveals its identity before authenticating the
  initiator. If only EAP is used (as proposed in this document), the
  situation depends on the EAP method used (in some EAP methods, the
  server reveals its identity first).
</p>
<p>Hence, if active user identity confidentiality for the initiator
  is required then EAP methods that offer this functionality have to
  be used (see <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>, Section
  7.3).
</p>
<a name="anchor5"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgments</h3>

<p>This document borrows some text from <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>,
  and <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. We would also like to thank Hugo Krawczyk
  for interesting discussions about this topic, and Dan Harkins for his comments.
</p>
<a name="rfc.references"></a><br /><hr />
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipsecme-ikev2bis">[I-D.ietf-ipsecme-ikev2bis]</a></td>
<td class="author-text">Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-ikev2bis-11.txt">Internet Key Exchange Protocol: IKEv2</a>,&rdquo; draft-ietf-ipsecme-ikev2bis-11 (work in progress), May&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-ikev2bis-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4072">[RFC4072]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.aboba-pppext-eapgss">[I-D.aboba-pppext-eapgss]</a></td>
<td class="author-text">Aboba, B. and D. Simon, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-aboba-pppext-eapgss-12.txt">EAP GSS Authentication Protocol</a>,&rdquo; draft-aboba-pppext-eapgss-12 (work in progress), April&nbsp;2002 (<a href="http://www.ietf.org/internet-drafts/draft-aboba-pppext-eapgss-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.arkko-eap-service-identity-auth">[I-D.arkko-eap-service-identity-auth]</a></td>
<td class="author-text">Arkko, J. and P. Eronen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-arkko-eap-service-identity-auth-04.txt">Authenticated Service Information for the Extensible Authentication Protocol  (EAP)</a>,&rdquo; draft-arkko-eap-service-identity-auth-04 (work in progress), October&nbsp;2005 (<a href="http://www.ietf.org/internet-drafts/draft-arkko-eap-service-identity-auth-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.clancy-emu-aaapay">[I-D.clancy-emu-aaapay]</a></td>
<td class="author-text">Clancy, C., Lior, A., Zorn, G., and K. Hoeper, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-clancy-emu-aaapay-04.txt">EAP Method Support for Transporting AAA Payloads</a>,&rdquo; draft-clancy-emu-aaapay-04 (work in progress), May&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-clancy-emu-aaapay-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.harkins-emu-eap-pwd">[I-D.harkins-emu-eap-pwd]</a></td>
<td class="author-text">Harkins, D. and G. Zorn, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-harkins-emu-eap-pwd-14.txt">EAP Authentication Using Only A Password</a>,&rdquo; draft-harkins-emu-eap-pwd-14 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-harkins-emu-eap-pwd-14.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pppext-eap-srp-03">[I-D.ietf-pppext-eap-srp-03]</a></td>
<td class="author-text">Carlson, J., Aboba, B., and H. Haverinen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pppext-eap-srp-03.txt">EAP SRP-SHA1 Authentication Protocol</a>,&rdquo; draft-ietf-pppext-eap-srp-03 (work in progress), July&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.sheffer-emu-eap-eke">[I-D.sheffer-emu-eap-eke]</a></td>
<td class="author-text">Sheffer, Y., Zorn, G., Tschofenig, H., and S. Fluhrer, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-sheffer-emu-eap-eke-06.txt">An EAP Authentication Method Based on the EKE Protocol</a>,&rdquo; draft-sheffer-emu-eap-eke-06 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-sheffer-emu-eap-eke-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IEEE80211">[IEEE80211]</a></td>
<td class="author-text">Institute of Electrical and Electronics Engineers, &ldquo;Information technology - Telecommunications and information exchange
  between systems - Local and metropolitan area networks - Specific
  Requirements Part 11: Wireless LAN Medium Access Control (MAC) and Physical
  Layer (PHY) Specifications,&rdquo; IEEE Standard&nbsp;802.11-1999, 1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="IEEE80211i">[IEEE80211i]</a></td>
<td class="author-text">Institute of Electrical and Electronics Engineers, &ldquo;IEEE Standard for Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11: Wireless Medium Access Control (MAC) and Physical Layer (PHY) specifications: Amendment 6: Medium Access Control (MAC) Security Enhancements,&rdquo; IEEE Standard&nbsp;802.11i-2004, July&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="IEEE8021X">[IEEE8021X]</a></td>
<td class="author-text">Institute of Electrical and Electronics Engineers, &ldquo;Local and Metropolitan Area Networks: Port-Based Network Access Control,&rdquo; IEEE Standard&nbsp;802.1X-2001, 2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1661">[RFC1661]</a></td>
<td class="author-text"><a href="mailto:Bill.Simpson@um.cc.umich.edu">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>,&rdquo; STD&nbsp;51, RFC&nbsp;1661, July&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3579">[RFC3579]</a></td>
<td class="author-text">Aboba, B. and P. Calhoun, &ldquo;<a href="http://tools.ietf.org/html/rfc3579">RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3579, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4186">[RFC4186]</a></td>
<td class="author-text">Haverinen, H. and J. Salowey, &ldquo;<a href="http://tools.ietf.org/html/rfc4186">Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)</a>,&rdquo; RFC&nbsp;4186, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4186.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4187">[RFC4187]</a></td>
<td class="author-text">Arkko, J. and H. Haverinen, &ldquo;<a href="http://tools.ietf.org/html/rfc4187">Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)</a>,&rdquo; RFC&nbsp;4187, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4187.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4430">[RFC4430]</a></td>
<td class="author-text">Sakane, S., Kamada, K., Thomas, M., and J. Vilhuber, &ldquo;<a href="http://tools.ietf.org/html/rfc4430">Kerberized Internet Negotiation of Keys (KINK)</a>,&rdquo; RFC&nbsp;4430, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4430.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4746">[RFC4746]</a></td>
<td class="author-text">Clancy, T. and W. Arbaugh, &ldquo;<a href="http://tools.ietf.org/html/rfc4746">Extensible Authentication Protocol (EAP) Password Authenticated Exchange</a>,&rdquo; RFC&nbsp;4746, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4746.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4763">[RFC4763]</a></td>
<td class="author-text">Vanderveen, M. and H. Soliman, &ldquo;<a href="http://tools.ietf.org/html/rfc4763">Extensible Authentication Protocol Method for Shared-secret Authentication and Key Establishment (EAP-SAKE)</a>,&rdquo; RFC&nbsp;4763, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4763.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4793">[RFC4793]</a></td>
<td class="author-text">Nystroem, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4793">The EAP Protected One-Time Password Protocol (EAP-POTP)</a>,&rdquo; RFC&nbsp;4793, February&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4851">[RFC4851]</a></td>
<td class="author-text">Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;<a href="http://tools.ietf.org/html/rfc4851">The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)</a>,&rdquo; RFC&nbsp;4851, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5216">[RFC5216]</a></td>
<td class="author-text">Simon, D., Aboba, B., and R. Hurst, &ldquo;<a href="http://tools.ietf.org/html/rfc5216">The EAP-TLS Authentication Protocol</a>,&rdquo; RFC&nbsp;5216, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5216.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5247">[RFC5247]</a></td>
<td class="author-text">Aboba, B., Simon, D., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc5247">Extensible Authentication Protocol (EAP) Key Management Framework</a>,&rdquo; RFC&nbsp;5247, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5247.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5281">[RFC5281]</a></td>
<td class="author-text">Funk, P. and S. Blake-Wilson, &ldquo;<a href="http://tools.ietf.org/html/rfc5281">Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)</a>,&rdquo; RFC&nbsp;5281, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5281.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5433">[RFC5433]</a></td>
<td class="author-text">Clancy, T. and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5433">Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method</a>,&rdquo; RFC&nbsp;5433, February&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5433.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5448">[RFC5448]</a></td>
<td class="author-text">Arkko, J., Lehtovirta, V., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc5448">Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')</a>,&rdquo; RFC&nbsp;5448, May&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5448.txt">TXT</a>).</td></tr>
</table>

<a name="anchor8"></a><br /><hr />
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<p>Note to RFC Editor: please remove this section prior to publication.
</p>
<a name="anchor9"></a><br /><hr />
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
-03</h3>

<p>Implemented IETF LC comments from Dan Harkins and Tero Kivinen.
</p>
<a name="anchor10"></a><br /><hr />
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
-02</h3>

<p>Implemented several WGLC comments. EAP methods are required to be resistant to dictionary attacks to be used here.
</p>
<a name="anchor11"></a><br /><hr />
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
-01</h3>

<p>List of proposed EAP methods is now informative, not normative. 
</p>
<a name="anchor12"></a><br /><hr />
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
draft-ietf-ipsecme-mutual-auth-00</h3>

<p>Initial WG draft, based on draft-eronen-ipsec-ikev2-eap-auth-07, with the following changes: if the responder does not support this mechanism, the initiator reverts to normal RFC 4306 behavior; the initiator must abort immediately if it doesn't like
	the proposed EAP method; allowed EAP methods are explicitly listed.
</p>
<a name="alternatives"></a><br /><hr />
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Alternative Approaches</h3>

<p>In this section we list alternatives which have been considered during the work on this document. We concluded that the solution presented in <a class='info' href='#solution'>Section&nbsp;3<span> (</span><span class='info'>Solution</span><span>)</span></a> seems to fit better into IKEv2.
</p>
<a name="ignore"></a><br /><hr />
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Ignore AUTH payload at the initiator</h3>

<p>With this approach, the initiator simply ignores the AUTH
  payload in message #4 (but obviously must check the second AUTH
  payload later!).  The main advantage of this approach is that no
  protocol modifications are required and no signature verification
  is required.
</p>
<p>The initiator could signal to the responder
  (using a notification payload) that it did not verify the first
  AUTH payload.
</p>
<a name="unauth"></a><br /><hr />
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
Unauthenticated public keys in AUTH payload (message 4)</h3>

<p>Another solution approach suggests the use of unauthenticated
  public keys in the public key signature AUTH payload (for message
  4).
</p>
<p>That is, the initiator verifies the signature in the AUTH
  payload, but does not verify that the public key indeed belongs to
  the intended party (using certificates)--since it doesn't have a PKI
  that would allow this. This could be used with X.509 certificates
  (the initiator ignores all other fields of the certificate except
  the public key), or "Raw RSA Key" CERT payloads.
</p>
<p>This approach has the advantage that initiators that wish to
  perform certificate-based responder authentication (in addition to
  EAP) may do so, without requiring the responder to handle these
  cases separately.
</p>
<p>If using RSA, the overhead of signature verification is quite
  small, compared to g^xy calculation.
</p>
<a name="anchor13"></a><br /><hr />
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
Using EAP derived session keys for IKEv2</h3>

<p>It has been proposed that when using an EAP method that provides
  mutual authentication and key agreement, the IKEv2 Diffie-Hellman
  exchange could also be omitted. This would mean that the session
  keys for IPsec SAs established later would rely only on EAP-provided
  keys.
</p>
<p>It seems the only benefit of this approach is saving some
  computation time (g^xy calculation). This approach
  requires designing a completely new protocol (which would not
  resemble IKEv2 anymore) we do not believe that it should be
  considered. Nevertheless, we include it for completeness.
</p>
<a name="rfc.authors"></a><br /><hr />
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Pasi Eronen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Research Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.O. Box 407</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">FIN-00045 Nokia Group</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pasi.eronen@nokia.com">pasi.eronen@nokia.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaron Sheffer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Independent</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaronf.ietf@gmail.com">yaronf.ietf@gmail.com</a></td></tr>
</table>
</body></html>
