


RADIUS Extensions Working Group                                S. Winter
Internet-Draft                                                   RESTENA
Intended status: Experimental                                M. McCauley
Expires: August 31, 2009                                             OSC
                                                       February 27, 2009


     NAI-based Dynamic Peer Discovery for RADIUS over TLS and DTLS
                   draft-winter-dynamic-discovery-00

Status of This Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.  This document may contain material
   from IETF Documents or IETF Contributions published or made publicly
   available before November 10, 2008.  The person(s) controlling the
   copyright in some of this material may not have granted the IETF
   Trust the right to allow modifications of such material outside the
   IETF Standards Process.  Without obtaining an adequate license from
   the person(s) controlling the copyright in such materials, this
   document may not be modified outside the IETF Standards Process, and
   derivative works of it may not be created outside the IETF Standards
   Process, except to format it for publication as an RFC or to
   translate it into languages other than English.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on August 31, 2009.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.




Winter & McCauley        Expires August 31, 2009                [Page 1]

Internet-Draft            RADIUS Peer Discovery            February 2009


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (http://trustee.ietf.org/license-info).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   This document specifies a means to find authoritative AAA servers for
   a given NAI realm.  It can be used in conjunction with RADIUS over
   TLS and RADIUS over DTLS.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . . . 3
     1.2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.  DNS-based NAPTR/SRV Peer Discovery  . . . . . . . . . . . . . . 3
     2.1.  DNS RR definition . . . . . . . . . . . . . . . . . . . . . 3
     2.2.  Realm to AAA server resolution algorithm  . . . . . . . . . 4
   3.  Security Considerations . . . . . . . . . . . . . . . . . . . . 5
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 6
   5.  Normative References  . . . . . . . . . . . . . . . . . . . . . 6




























Winter & McCauley        Expires August 31, 2009                [Page 2]

Internet-Draft            RADIUS Peer Discovery            February 2009


1.  Introduction

1.1.  Requirements Language

   In this document, several words are used to signify the requirements
   of the specification.  The key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" in this document are to be interpreted as described in
   RFC 2119.  [RFC2119]

1.2.  Terminology

   RadSec node: a RadSec client or server

   RadSec Client: a RadSec instance which initiates a new connection.

   RadSec Server: a RadSec instance which listens on a RadSec port and
   accepts new connections

2.  DNS-based NAPTR/SRV Peer Discovery

2.1.  DNS RR definition

   DNS definitions of RadSec servers can be either NAPTR records or SRV
   records.  When both are defined, the resolution algorithm prefers
   NAPTR results (see section Section 2.2 below).  The NAPTR service
   field used is "AAA+RADSECT".  The SRV prefix used is "_radsec._tcp".
   It is expected that in most cases, the label used for the records is
   the DNS representation (punycode) of the literal realm name for which
   the server is the AAA server.

   However, arbitrary other labels may be used if, for example, a
   roaming consortium uses realm names which are not associated to DNS
   names or special-purpose consortia where a globally valid discovery
   is not a use case.  Such other labels require a consortium-wide
   agreement about the transformation from realm name to lookup label.

   Examples:

   a.  A general-purpose AAA server for realm example.com might have DNS
       entries as follows:

          example.com.  IN NAPTR 50 50 "s" "AAAS+RADSECT" ""
          _radsec._tcp.foobar.example.com.

          _radsec._tcp.example.com.  IN SRV 0 10 2083
          radsec.example.com.




Winter & McCauley        Expires August 31, 2009                [Page 3]

Internet-Draft            RADIUS Peer Discovery            February 2009


   b.  Consortium "foo" provides roaming services for banks.  The realms
       used are of the form enterprise-name.foobankroam.  The consortium
       operates a special purpose DNS server for the (private) TLD
       "foobankroam" which all AAA servers use to resolve realm names.
       "Rupt, Inc." is part of the consortium.  On the consortium's DNS
       server, realm bank-rupt.foobankroam might have the following DNS
       entries:

          bank-rupt.foobankroam IN NAPTR 50 50 "a" "AAAS+RADSECT" ""
          "triple-a.bank-rupt.com"

          _radsec._tcp.bank-rupt.foobankroam IN SRV 0 10 2083 triple-a-
          backup.bank-rupt.com"

   c.  the eduroam consortium uses realms based on DNS, but provides its
       services to a closed community only.  However, a AAA domain
       participating in eduroam may also want to expose AAA services to
       other, general-purpose, applications (on the same or other AAA
       servers).  Due to that, the eduroam consortium uses labels
       prefixed with "eduroam." and eduroam AAA servers use these labels
       to look up servers.  An eduroam participant which also provides
       general-purpose AAA on a different server might have the
       following DNS entries:

          eduroam.restena.lu.  IN NAPTR 50 50 "a" "AAAS+RADSECT" "" aaa-
          eduroam.restena.lu

          restena.lu.  IN NAPTR 50 50 "a" "AAAS+RADSECT" "" aaa-
          default.restena.lu

          _radsec._tcp.eduroam.restena.lu.  IN SRV 0 10 2083 aaa-
          eduroam.restena.lu.

          _radsec._tcp.restena.lu.  IN SRV 0 10 2083 aaa-
          default.restena.lu.

2.2.  Realm to AAA server resolution algorithm

   For a given NAI-based input realm, the following algorithm is used to
   determine the AAA server to contact:

   1.   Transform input realm into punycode.

   2.   Optional: modify result from previous step according to agreed
        consortium procedures

   3.   Perform NAPTR query for service "AAAS+RADSECT" with result of
        step 1 (or 2) as label



Winter & McCauley        Expires August 31, 2009                [Page 4]

Internet-Draft            RADIUS Peer Discovery            February 2009


   4.   If no result, continue at step 7.

   5.   Evaluate NAPTR result, perform subsequent lookup steps until
        lookup yields one or more hostnames.  Memorize Order/Preference
        fields for all hostnames.

   6.   Continue at step 9.

   7.   Prefix result of step 1 (or 2) with "_radsec._tcp."

   8.   Perform SRV lookup with result of step 7 as label.  This yields
        one or more hostname.  Memorize Order/Preference fields for all
        hostnames.

   9.   Order hostnames according to the Order/Preference fields.

   10.  Perform A/AAAA RR lookup for all hosts in descending order of
        preference until one of the RRs results in a successful
        connection.

   For example, if the User-Name realm was 'example.com', and DNS
   contained the following records, the following subsequent lookups
   would be performed:

      example.com.  IN NAPTR 50 50 "s" "AAAS+RADSECT" ""
      _radsec._tcp.example.com.

      _radsec._tcp.example.com.  IN SRV 0 10 2083 radsec.example.com.

      radsec.example.com.  IN AAAA 2001:0DB8::202:44ff:fe0a:f704

   Then the target selected would be a RadSec server on port 2083 at
   IPv6 address 2001:0DB8::202:44ff:fe0a:f704.  If no connection to this
   IPv6 address can be established, the algorithm continues to query a A
   record.

3.  Security Considerations

   When using DNS without security, the replies to NAPTR, SRV and A/AAAA
   requests as described in section Section 2 can not be trusted.
   RADIUS transports have an out-of-DNS-band means to verify that the
   discovery attempt led to the intended target (TLD/DTLS: ceritifcate
   verification or TLS shared secret ciphers; UDP/TCP: the RADIUS shared
   secret) and are safe from DNS-based redirection attacks.  [Note:
   assuming here that a hypothetical RADIUS/UDP SRV discovery will NOT
   deliver the shared secret in the DNS response!]

   The discovery process is always susceptible to bidding down attacks



Winter & McCauley        Expires August 31, 2009                [Page 5]

Internet-Draft            RADIUS Peer Discovery            February 2009


   if a realm has SRV records for RADIUS/UDP and/or RADIUS/TCP as well
   as for RADIUS/TLS and/or RADIUS/DTLS.  While the SRV query will
   expose both transports, an attacker in the routing path might
   suppress the subsequent A/AAAA results for the TLS or DTLS peer and
   trick the inititating peer into using the weakly protected UDP or TCP
   transports.  The use of DNSSEC can not fully mitigate this attack,
   since it does not provide a means to detect packet suppression.  The
   only way to disable such bidding down attacks is by intiating
   connections only to the peer(s) which match or exceed a configured
   minimum security level.  An implementation SHOULD provide a means to
   configure the administratively desired minimum security level.

4.  IANA Considerations

   This document contains no actions for IANA.  Maybe.  Not sure about
   the labels "AAAS+RADSECT" and "_radsec._tcp.".

5.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

Authors' Addresses

   Stefan Winter
   Fondation RESTENA
   6, rue Richard Coudenhove-Kalergi
   Luxembourg  1359
   LUXEMBOURG

   Phone: +352 424409 1
   Fax:   +352 422473
   EMail: stefan.winter@restena.lu
   URI:   http://www.restena.lu.


   Mike McCauley
   Open Systems Consultants
   9 Bulbul Place
   Currumbin Waters  QLD 4223
   AUSTRALIA

   Phone: +61 7 5598 7474
   Fax:   +61 7 5598 7070
   EMail: mikem@open.com.au
   URI:   http://www.open.com.au.





Winter & McCauley        Expires August 31, 2009                [Page 6]

