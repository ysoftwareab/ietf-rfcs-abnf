beta1_key = CMAC(key = prf_key, message = pad_16(nonce) ||
                          pad_16(AAD) || pad_16(nonce_length ||
                          AAD_length || plaintext_length))
beta2_key = x * beta1_key
m_i = msg[i], for i = 0 to N-1,
m_N = msg[N+] padded up to 16 bytes with a 0x01 byte
            followed by 0x00 bytes.  When msg_length is a multiple of
            16, m_N is composed entirely of padding, i.e. 0x0100...00.

p = 0^16
out_msg = (m_0 + R, ..., m_{N-2} + R, R, m_N) +
                     (xb, x^2b, ..., x^{N-1}b, b, 0)
            where m_i = msg[i] for i = 0 to N-1,
m_N = msg[N+],
R = out_msg of poly_hash,
b = beta_key,
R = poly_hash(msg, tau_key)
e = beta_key * x
e = e * x
R = msg[N-1] + beta_key
e = beta_key * x
e = e * x
R_without_constant_term = poly_hash(out_msg, tau_key)
out_msg = HEH_hash(msg, beta1_key, tau_key)
out_msg = CTS_2ECB_encrypt(out_msg, blk_key)
out_msg = HEH_hash_inv(out_msg, beta2_key, tau_key)
out_msg = HEH_hash(msg, beta2_key, tau_key)
out_msg = CTS_2ECB_decrypt(out_msg, blk_key)
out_msg = HEH_hash_inv(out_msg, beta1_key, tau_key)
padded_msg = msg || 0^16
out_msg = HEH_DECRYPT(prf_key, blk_key, tau_key, nonce, AAD,
                               msg)

unpadded_out_msg = out_msg[0:(out_msg_length - 16)]
aes_key =    00000000000000000000000000000000
tau_key =    00000000000000000000000000000000
prf_key =    00000000000000000000000000000000
nonce =      EMPTY
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
ciphertext = 310f55672a44bf35b3320895e90d3f30

aes_key =    000102030405060708090A0B0C0D0E0F
tau_key =    000102030405060708090A0B0C0D0E0F
prf_key =    000102030405060708090A0B0C0D0E0F
nonce =      EMPTY
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000000
                000000000000000000000000000000
ciphertext = 6e20347c7a0609d04cda4fd26ff3b7d0
                3a2e48b13369671c763c24a010d34bd9
                2e2707fce73d89a92ad6f191d9cc38cc
                c9d8e526885730b4835d6d18c3c55d

aes_key =    000102030405060708090A0B0C0D0E0F
tau_key =    000102030405060708090A0B0C0D0E0F
prf_key =    000102030405060708090A0B0C0D0E0F
nonce =      EMPTY
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000001
                000000000000000000000000000000
ciphertext = 77a09f9af01bf2341c8550734e771abc
                a41398130c7658d83c075492ece8981d
                d5ee21816802cbff60e87fb9ab2cb771
                d44fabfbf59dacdf46931e49d632c1
aes_key =    000102030405060708090A0B0C0D0E0F
tau_key =    000102030405060708090A0B0C0D0E0F
prf_key =    000102030405060708090A0B0C0D0E0F
nonce =      00000000000000000000000000000000
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000000
                000000000000000000000000000000
ciphertext = fb309047c54eccfdc490a29f7c0363c3
                cbaf2eee6218eb206297e49bf28bf33f
                763baaabf01954dbb4af2ed9a7e09204
                5ae481fc58f2dabf5dc9b147d508b1

aes_key =    000102030405060708090A0B0C0D0E0F
tau_key =    000102030405060708090A0B0C0D0E0F
prf_key =    000102030405060708090A0B0C0D0E0F
nonce =      00000000000000000000000000000000
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000001
                000000000000000000000000000000
ciphertext = 9cdfa55083e0a3b50d3583346e6e40d6
                0f81c81a9c4081fbb36eb4bffccac950
                cd33fdb34311e632023d3ec6496ecf58
                3e14156d392a589983afdd223e7f6c

aes_key =    a8da249b5efa13c2c194bf32ba38a377
tau_key =    68f82787dc3033fd655b8e512e02ff9d
prf_key =    21281e64cd9c3388f62c438ff56ff58f
nonce =      4d4761372b4786f0d647b5c2e8cf8527
AAD =        EMPTY
plaintext =  b8ee29e4a5d1e755d0fde722637636e2
                f80cf8fe6576e7cac142f5ca5aa8ac2a
                d6a67479105440abdc90b166416ce3cb
                6119FA19AA99F0265850BD29C49E2436
                4d47
ciphertext = 9726afc277e930f3912c976c779927e0
                a9b80ee83db1881300c3752a54f07c1e
                66f89d556bda0d2dc318536e1a34e6b7
                ab7576469349ea9927cd15429e25d050
                9f9a
aes_key =    000102030405060708090A0B0C0D0E0F
tau_key =    000102030405060708090A0B0C0D0E0F
prf_key =    000102030405060708090A0B0C0D0E0F
nonce =      000102030405060708090A0B0C0D0E0F
AAD =        000102030405060708090A0B0C0D0E0F
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
ciphertext = 7f5eac36f1fee71cc79e4046c1d11f94
                cd9219968157de2b3c23c139ff671914

aes_key =    000102030405060708090A0B0C0D0E0F
tau_key =    000102030405060708090A0B0C0D0E0F
prf_key =    000102030405060708090A0B0C0D0E0F
nonce =      000102030405060708090A0B0C0D0E0F
                000102030405
AAD =        0102030405060708090A0B0C0D0E0F00
                010203
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
ciphertext = a4f3f950f6f07b892248655a9bc88262
                87f7f81312a2a6408d0ad2bed078202a

aes_key =    36DAF975AAE45061AF88079422E5E6A9
tau_key =    D0A8C8E6B3FDC335C4E98C9BBB1310E4
prf_key =    AA2610D3A619A8F8A222D3DBFB082D17
nonce =      4164A1FFAEEF4B23324C47279AFB02E8
AAD =        948F6D03EA0BDE71A0233AC87753F10E
plaintext =  6A2EDA8E07C10918507F0B5E4F32053C
                335D179A8F476ED1D08A458C00726F63
                6365BF26A7003F43C0270BBB44EC780E
                6119FA19AA99F0265850BD29C49E2436
                A9
ciphertext = a962d37c10b43303a522aac165230d67
                2cabebfa385d2c7b21468d0af9cab3a7
                5bb5c1c332e1afd77b1b98697672c36b
                bd05ab6b0f47c759f464689831d3ce9e
                93
aes_key =    880D8B115BA55842FF4505C5E45F78F6
tau_key =    F83B77EE7445C4190B326489ECA17CF8
prf_key =    9F8BF70E528CC1344300AE428506A937
nonce =      131D6E569B5CCB6E563D2CED8616E6AC
AAD =        01BD52F7065A35A07EE70D9A881EDDB4
plaintext =  00000000000000000000000000000000
                B1E0CC8A07264432823C68B2EF59E592
                D271271029F6364CEEE577D9FDA8E5C4
                131D6E569B5CCB6E563D2CED8616E6AC
                C6
ciphertext = a8da249b5efa13c2c194bf32ba38a377
                21281e64cd9c3388f62c438ff56ff58f
                68f82787dc3033fd655b8e512e02ff9d
                c4fb5c2937d3c85c5cb1196c3b0e99af
                42

aes_key =    880D8B115BA55842FF4505C5E45F78F6
tau_key =    F83B77EE7445C4190B326489ECA17CF8
prf_key =    9F8BF70E528CC1344300AE428506A937
nonce =      131D6E569B5CCB6E563D2CED8616E6AC
AAD =        01BD52F7065A35A07EE70D9A881EDDB4
plaintext =  01000000000000000000000000000000
                B1E0CC8A07264432823C68B2EF59E592
                D271271029F6364CEEE577D9FDA8E5C4
                131D6E569B5CCB6E563D2CED8616E6AC
                C6
ciphertext = b8ee29e4a5d1e755d0fde722637636e2
                f80cf8fe6576e7cac142f5ca5aa8ac2a
                d6a67479105440abdc90b166416ce3cb
                4d4761372b4786f0d647b5c2e8cf8527
                4b

