



opsawg                                                        Z. Li, Ed.
Internet-Draft                                                R. Gu, Ed.
Intended status: Standards Track                            China Mobile
Expires: May 1, 2017                                             J. Dong
                                                     Huawei Technologies
                                                        October 28, 2016


 Export BGP community information in IP Flow Information Export (IPFIX)
                 draft-li-opsawg-ipfix-bgp-community-01

Abstract

   This draft specifies an extension to the IPFIX information model
   defined in [RFC7012] to export the BGP community information.  Three
   information elements, bgpCommunity, bgpSourceCommunityList and
   bgpDestinationCommunityList, are introduced in this document to carry
   the community information for the source IP and destination IP
   respectively.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 1, 2017.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must



Li, et al.                 Expires May 1, 2017                  [Page 1]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  BGP Community Information Elements  . . . . . . . . . . . . .   3
     3.1.  bgpCommunity  . . . . . . . . . . . . . . . . . . . . . .   4
     3.2.  bgpSourceCommunityList  . . . . . . . . . . . . . . . . .   4
     3.3.  bgpDestinationCommunityList . . . . . . . . . . . . . . .   4
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   5
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   5
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   5
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   6
   Appendix A.  Application Example  . . . . . . . . . . . . . . . .   7
     A.1.  Template Record . . . . . . . . . . . . . . . . . . . . .   7
     A.2.  Data Set  . . . . . . . . . . . . . . . . . . . . . . . .   8
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   IP Flow Information Export (IPFIX) [RFC7011] provides network
   administrators with traffic flow information using the information
   elements (IEs) defined in [IANA-IPFIX] registries.  Based on the
   traffic flow information, network administrators know the amount and
   direction of the traffic in their network, then they can optimize
   their network when needed.  For example, they can steer some flows
   from the congested links to the low utilised links.

   [IANA-IPFIX] has already defined the following IEs for traffic flow
   information exporting in different grain: sourceIPv4Address,
   sourceIPv4Prefix, destinationIPv4Address, destinationIPv4Prefix,
   bgpSourceAsNumber, bgpDestinationAsNumber, bgpNextHopIPv4Address,
   etc.  In some circumstances, however, especially when traffic
   engineering and optimazation are used in the Tier 1 or Tier 2
   operators' backbone networks, traffic flow information based on these
   IEs is not suitable.  Flow information based on IP address or IP
   prefix is much more mediculous.  On the contrary, flow information
   based on AS number is too coarse.  BGP community [RFC1997], which
   describes a group of routes sharing some common properties, is
   preferablely used for fine granularity traffic engineering
   [Community-TE] [RFC4384].  Unfortunately, [IANA-IPFIX] has no IE
   defined for BGP community information, yet.




Li, et al.                 Expires May 1, 2017                  [Page 2]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


   Flow information based on BGP community can be collected by a
   mediator defined in [RFC6183].  Mediator is responsible for the
   correlation between flow information and BGP community.  However no
   IEs are defined in [RFC6183] for exporting BGP community information
   in IPFIX.  Furthermore, to correlate the BGP community with the flow
   information, mediator needs to learn BGP routes and lookup in the BGP
   routing table to get the matching entry for the specific flow.
   Neither BGP route learning nor routing table lookup is trivial for a
   mediator.  Mediator is mainly introduced to release the performance
   requirement for the exporter [RFC5982].  In fact, to obtain the BGP
   related IEs that have already been defined, such as
   bgpSourceAsNumber, bgpDestinationAsNumber, bgpNextHopIPv4Address,
   etc, exporter has to hold the up-to-date BGP routing table and look
   up in the BGP routing table.  The exporter can get the community
   information in the same procedure.  So, getting BGP community
   information adds no more requirement for exporter.  Some vendors have
   implemented this feture in their exporters using private IEs.  So,
   exporter is RECOMMENDED to export the BGP community information in
   IPFIX directly, other than the mediator.

   This draft specifies an extension to the IPFIX information model
   defined in [RFC7012] to export the BGP community information.  Two
   IEs, bgpSourceCommunityList and bgpDestinationCommunityList, are
   introduced to complete this task.  BgpSourceCommunityList is for the
   source IP address, and bgpDestinationCommunityList is for the
   destination IP address. bgpSourceCommunityList and
   bgpDestinationCommunityList IEs are applicable for both IPv4 and IPv6
   traffic.  Both exporter and mediator can use these two IEs to export
   BGP community informaiton in IPFIX.

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

3.  BGP Community Information Elements

   In order to export BGP community information along with other flow
   information defined by IPFIX, we need to introduce three new IEs.
   One is bgpCommunity.  It is used to identify that the value in this
   IE is BGP community [RFC1997].  The other two are
   bgpSourceCommunityList and bgpDestinationCommunityList.  They both
   are basicList [RFC6313] of bgpCommunity.  bgpSourceCommunityList and
   bgpDestinationCommunityList are used to export BGP community
   information corresponding to a specific flow's source IP and
   destination IP respectively.  Flow information based on BGP community




Li, et al.                 Expires May 1, 2017                  [Page 3]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


   can then be accumulated and analysed by the collector or other
   applications.

   The details of these three new introduced IEs are illustrated below,
   including name, ID, type, semantics, description and units.

3.1.  bgpCommunity

  ----------------------------------------------------------------------
  |      ElementID      |  to be assigned by IANA, 458 is suggested    |
  ----------------------------------------------------------------------
  |         Name        |                 bgpCommunity                 |
  |---------------------------------------------------------------------
  |      Data Type      |                  unsigned32                  |
  |---------------------------------------------------------------------
  | Data Type Semantics |                  identifier                  |
  ----------------------------------------------------------------------
  |      Description    |    BGP community as defined in [RFC1997]     |
  ----------------------------------------------------------------------
  |         Units       |                     none                     |
  |---------------------------------------------------------------------

                          Figure 1: bgpCommunity

3.2.  bgpSourceCommunityList

  ----------------------------------------------------------------------
  |      ElementID      |  to be assigned by IANA, 459 is suggested    |
  ----------------------------------------------------------------------
  |         Name        |           bgpSourceCommunityList             |
  |---------------------------------------------------------------------
  |      Data Type      |      basicList, as specifed in [RFC6313]     |
  |---------------------------------------------------------------------
  | Data Type Semantics |                       list                   |
  ----------------------------------------------------------------------
  |      Description    | zero or more BGP communities corresponding   |
  |                     | with source IP address of a specific flow    |
  ----------------------------------------------------------------------
  |         Units       |                     none                     |
  |---------------------------------------------------------------------

                     Figure 2: bgpSourceCommunityList

3.3.  bgpDestinationCommunityList







Li, et al.                 Expires May 1, 2017                  [Page 4]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


  ----------------------------------------------------------------------
  |      ElementID      |  to be assigned by IANA, 460 is suggested    |
  ----------------------------------------------------------------------
  |         Name        |          bgpDestinationCommunityList         |
  |---------------------------------------------------------------------
  |      Data Type      |      basicList, as specifed in [RFC6313]     |
  |---------------------------------------------------------------------
  | Data Type Semantics |                       list                   |
  ----------------------------------------------------------------------
  |      Description    | zero or more BGP communities corresponding   |
  |                     |with destination IP address of a specific flow|
  ----------------------------------------------------------------------
  |         Units       |                     none                     |
  |---------------------------------------------------------------------

                   Figure 3: bgpDestinationCommunityList

4.  Security Considerations

   This document only defines three new IEs for IPFIX.  So, this
   document itself does not directly introduce security issues.  The
   same security considerations as for the IPFIX Protocol Specification
   [RFC7011] and Information Model [RFC7012] apply.

5.  IANA Considerations

   This draft specifies three new IPFIX IEs, bgpCommunity,
   bgpSourceCommunityList and bgpDestinationCommunityList, to export BGP
   community information along with other flow information.

   The Element IDs for these three IEs are solicited to be assigned by
   IANA.  Number 458, 459 and 460 are suggested for bgpCommunity,
   bgpSourceCommunityList and bgpDestinationCommunityList, respectively.

6.  Acknowledgements

   The authors would like to thank Benoit Claise and Paul Aitken for
   discussion and suggestions to promote this document.

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.




Li, et al.                 Expires May 1, 2017                  [Page 5]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


   [RFC6313]  Claise, B., Dhandapani, G., Aitken, P., and S. Yates,
              "Export of Structured Data in IP Flow Information Export
              (IPFIX)", RFC 6313, DOI 10.17487/RFC6313, July 2011,
              <http://www.rfc-editor.org/info/rfc6313>.

   [RFC7011]  Claise, B., Ed., Trammell, B., Ed., and P. Aitken,
              "Specification of the IP Flow Information Export (IPFIX)
              Protocol for the Exchange of Flow Information", STD 77,
              RFC 7011, DOI 10.17487/RFC7011, September 2013,
              <http://www.rfc-editor.org/info/rfc7011>.

   [RFC7012]  Claise, B., Ed. and B. Trammell, Ed., "Information Model
              for IP Flow Information Export (IPFIX)", RFC 7012,
              DOI 10.17487/RFC7012, September 2013,
              <http://www.rfc-editor.org/info/rfc7012>.

7.2.  Informative References

   [Community-TE]
              Shao, W., Devienne, F., Iannone, L., and JL. Rougier, "On
              the use of BGP communities for fine-grained inbound
              traffic engineering", Computer Science 27392(1):476-487,
              November 2015.

   [IANA-IPFIX]
              "IP Flow Information Export (IPFIX) Entities",
              <http://www.iana.org/assignments/ipfix/>.

   [RFC1997]  Chandra, R., Traina, P., and T. Li, "BGP Communities
              Attribute", RFC 1997, DOI 10.17487/RFC1997, August 1996,
              <http://www.rfc-editor.org/info/rfc1997>.

   [RFC4384]  Meyer, D., "BGP Communities for Data Collection", BCP 114,
              RFC 4384, DOI 10.17487/RFC4384, February 2006,
              <http://www.rfc-editor.org/info/rfc4384>.

   [RFC5982]  Kobayashi, A., Ed. and B. Claise, Ed., "IP Flow
              Information Export (IPFIX) Mediation: Problem Statement",
              RFC 5982, DOI 10.17487/RFC5982, August 2010,
              <http://www.rfc-editor.org/info/rfc5982>.

   [RFC6183]  Kobayashi, A., Claise, B., Muenz, G., and K. Ishibashi,
              "IP Flow Information Export (IPFIX) Mediation: Framework",
              RFC 6183, DOI 10.17487/RFC6183, April 2011,
              <http://www.rfc-editor.org/info/rfc6183>.






Li, et al.                 Expires May 1, 2017                  [Page 6]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


Appendix A.  Application Example

   In this section, we give an example to show the encoding format for
   the three new introduced IEs.

   Flow information including BGP communities is shown in the below
   table.  Suppose we want all the fields to be reported by IPFIX.

--------------------------------------------------------------------------
|Source ip|Destination ip |Source BGP community|Destination BGP community|
--------------------------------------------------------------------------
| 1.1.1.1 |   2.2.2.2     |1:1001,1:1002,8:1001|     2:1002,8:1001       |
--------------------------------------------------------------------------
| 3.3.3.3 |   4.4.4.4     |3:1001,3:1002,8:1001|     4:1001,8:1001       |
--------------------------------------------------------------------------

           Figure 4: Flow information including BGP communities

A.1.  Template Record

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          SET ID = 2           |       Length = 24             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Template ID = 256        |        Field Count = 4        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0|    SourceIPv4Address = 8    |        Field length = 4       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0| DestinationIPv4Address = 12 |        Field length = 4       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0| bgpSourceCommunityList = 459|      Field length = 0xFFFF    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0| bgpDestinationCommunityList |      Field length = 0xFFFF    |
   | |         = 460               |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                 Figure 5: Template Record Encoding Format

   In this example, the Template ID is 256, which will be used in the
   data record.  The field length for bgpSourceCommunityList and
   bgpDestinationCommunityList is 0xFFFF, which means the length of this
   IE is variable, the actual length of this IE is indicated by the list
   length field in the basic list format as per [RFC6313].







Li, et al.                 Expires May 1, 2017                  [Page 7]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


A.2.  Data Set

   The data set is represented as follows:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         SET ID = 256          |           Length = 92         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  SourceIPv4Address = 1.1.1.1                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               DestinationIPv4Address = 2.2.2.2                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      255      |        List length = 17       |semantic=allof |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      bgpCommunity = 458       |          Field Len = 4        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        BGP Source Community Value 1 = 1:1001                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        BGP Source Community Value 2 = 1:1002                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        BGP Source Community Value 3 = 8:1001                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     255       |        List length = 13       |semantic =allof|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      bgpCommunity = 458       |          Field Len = 4        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         BGP Destination Community Value 1 = 2:1002            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         BGP Destination Community Value 2 = 8:1001            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  SourceIPv4Address = 3.3.3.3                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               DestinationIPv4Address = 4.4.4.4                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     255       |        List length = 17       |semantic =allof|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      bgpCommunity = 458       |          Field Len = 4        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        BGP Source Community Value 1  = 3:1001                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        BGP Source Community Value 2  = 3:1002                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        BGP Source Community Value 3  = 8:1001                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     255       |        List length = 13       |semantic =allof|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      bgpCommunity = 458       |          Field Len = 4        |



Li, et al.                 Expires May 1, 2017                  [Page 8]

Internet-Draft       Export BGP Communicty in IPFIX         October 2016


   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         BGP Destination Community Value 1 = 4:1001            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         BGP Destination Community Value 2 = 8:1001            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Figure 6: Data Set Encoding Format

Authors' Addresses

   Zhenqiang Li (editor)
   China Mobile
   32 Xuanwumen West Ave, Xicheng District
   Beijing  100053
   China

   Email: lizhenqiang@chinamobile.com


   Rong Gu (editor)
   China Mobile
   32 Xuanwumen West Ave, Xicheng District
   Beijing  100053
   China

   Email: gurong_cmcc@outlook.com


   Jie Dong
   Huawei Technologies
   Huawei Campus, No. 156 Beiqing Rd.
   Beijing  100095
   China

   Email: jie.dong@huawei.com
















Li, et al.                 Expires May 1, 2017                  [Page 9]
