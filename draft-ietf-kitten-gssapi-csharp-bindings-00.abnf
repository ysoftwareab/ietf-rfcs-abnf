inTok = readToken();

inTok = readToken();

is = recvToken();

is = recvToken();

clientCred = mgr.createCredential(null /*default princ*/,
                 GSSConstants.INDEFINITE_LIFETIME /* max lifetime */,
                 mech /* mechanism to use */,
                 GSSCredentialUsage.INITIATE_ONLY /* init context */);

context = mgr.createContext(
                          peer,
                          mech,
                          gssCred,
                          GSSConstants.INDEFINITE_LIFETIME/*lifetime*/);

outToken = context.initSecContext(inToken,
                                                 0,
                                                 inToken.length);

inToken = readGSSToken();
buffer = readFromFile();

outToken = context.wrap(buffer,
                                    0,
                                    buffer.length,
                                    messgInfo);

inToken = readGSSToken();
buffer = context.unwrap(inToken,
                                    0,
                                    inToken.length,
                                    messgInfo);
mgr = GSSManager.getInstance();

name = mgr.createName(serviceName,
                               GSSNameTypes.NT_HOSTBASED_SERVICE);

cred = mgr.createCredential(name,
                                     GSSConstants.INDEFINITE_LIFETIME,
                                     null,
                                     GSSCredentialUsage.ACCEPT_ONLY);
inToken = readGSSToken();

outToken = context.acceptSecContext(inToken,
                                                      0,
                                                      inToken.length);

inToken = readGSSToken();

buffer = context.unwrap(inToken,
                                       0,
                                       inToken.length,
                                       supplInfo);

buffer = serverProcess(buffer);

outToken = context.wrap(buffer,
                                       0,
                                       buffer.length,
                                       supplInfo);
