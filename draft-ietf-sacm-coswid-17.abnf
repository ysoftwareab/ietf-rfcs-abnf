start = coswid

concise-swid-tag = {
tag-id => text / bstr .size 16,
tag-version => integer,
software-name => text,
entity => one-or-more<entity-entry>,
tag-id = 0
software-name = 1
entity = 2
evidence = 3
link = 4
software-meta = 5
payload = 6
corpus = 8
patch = 9
media = 10
supplemental = 11
tag-version = 12
software-version = 13
version-scheme = 14

multipartnumeric = 1
multipartnumeric-suffix = 2
alphanumeric = 3
decimal = 4
semver = 16384
global-attributes = (
     ? lang => text,
     * any-attribute,
any-attribute = (
label => one-or-more<text> / one-or-more<int>
label = text / int

entity-entry = {
entity-name => text,
role => one-or-more<$role>,
entity-name = 31
reg-id = 32
role = 33
thumbprint = 34

tag-creator=1
software-creator=2
aggregator=3
distributor=4
licensor=5
maintainer=6

link-entry = {
     ? artifact => text,
href => any-uri,
rel => $rel,
media = 10
artifact = 37
href = 38
ownership = 39
rel = 40
media-type = 41
use = 42

shared=1
private=2
abandon=3

ancestor=1
component=2
feature=3
installationmedia=4
packageinstaller=5
parent=6
patches=7
requires=8
see-also=9
supersedes=10
supplemental=11

optional=1
required=2
recommended=3

software-meta-entry = {
     ? activation-status => text,
     ? channel-type => text,
     ? colloquial-version => text,
     ? description => text,
     ? edition => text,
     ? entitlement-data-required => bool,
     ? entitlement-key => text,
     ? generator => text,
     ? persistent-id => text,
     ? product => text,
     ? product-family => text,
     ? revision => text,
     ? summary => text,
     ? unspsc-code => text,
     ? unspsc-version => text,
     * $$software-meta-extension,
     global-attributes,
activation-status = 43
channel-type = 44
colloquial-version = 45
description = 46
edition = 47
entitlement-data-required = 48
entitlement-key = 49
generator = 50
persistent-id = 51
product = 52
product-family = 53
revision = 54
summary = 55
unspsc-code = 56
unspsc-version = 57

hash-entry = [
     hash-alg-id: int,
     hash-value: bytes,
path-elements-group = ( ? directory => one-or-more<directory-entry>,
                           ? file => one-or-more<file-entry>,
                         )

resource-collection = (
     path-elements-group,
     ? process => one-or-more<process-entry>,
     ? resource => one-or-more<resource-entry>,
     * $$resource-collection-extension,
filesystem-item = (
     ? key => bool,
     ? location => text,
fs-name => text,
file-entry = {
     filesystem-item,
     ? size => uint,
     ? file-version => text,
     ? hash => hash-entry,
     * $$file-extension,
     global-attributes,
directory-entry = {
     filesystem-item,
     ? path-elements => { path-elements-group },
     * $$directory-extension,
     global-attributes,
process-entry = {
process-name => text,
resource-entry = {
type => text,
directory = 16
file = 17
process = 18
resource = 19
size = 20
file-version = 21
key = 22
location = 23
fs-name = 24
root = 25
path-elements = 26
process-name = 27
pid = 28
type = 29

payload-entry = {
     resource-collection,
     * $$payload-extension,
     global-attributes,
evidence-entry = {
     resource-collection,
     ? date => integer-time,
     ? device-id => text,
     * $$evidence-extension,
     global-attributes,
date = 35
device-id = 36

concise-swid-tag = {
tag-id => text / bstr .size 16,
tag-version => integer,
software-name => text,
entity => one-or-more<entity-entry>,
any-uri = uri
label = text / int

any-attribute = (
label => one-or-more<text> / one-or-more<int>
global-attributes = (
     ? lang => text,
     * any-attribute,
hash-entry = [
     hash-alg-id: int,
     hash-value: bytes,
entity-entry = {
entity-name => text,
role => one-or-more<$role>,
link-entry = {
     ? artifact => text,
href => any-uri,
rel => $rel,
software-meta-entry = {
     ? activation-status => text,
     ? channel-type => text,
     ? colloquial-version => text,
     ? description => text,
     ? edition => text,
     ? entitlement-data-required => bool,
     ? entitlement-key => text,
     ? generator => text,
     ? persistent-id => text,
     ? product => text,
     ? product-family => text,
     ? revision => text,
     ? summary => text,
     ? unspsc-code => text,
     ? unspsc-version => text,
     * $$software-meta-extension,
     global-attributes,
path-elements-group = ( ? directory => one-or-more<directory-entry>,
                           ? file => one-or-more<file-entry>,
                         )

resource-collection = (
     path-elements-group,
     ? process => one-or-more<process-entry>,
     ? resource => one-or-more<resource-entry>,
     * $$resource-collection-extension,
file-entry = {
     filesystem-item,
     ? size => uint,
     ? file-version => text,
     ? hash => hash-entry,
     * $$file-extension,
     global-attributes,
directory-entry = {
     filesystem-item,
     ? path-elements => { path-elements-group },
     * $$directory-extension,
     global-attributes,
process-entry = {
process-name => text,
resource-entry = {
type => text,
filesystem-item = (
     ? key => bool,
     ? location => text,
fs-name => text,
payload-entry = {
     resource-collection,
     * $$payload-extension,
     global-attributes,
evidence-entry = {
     resource-collection,
     ? date => integer-time,
     ? device-id => text,
     * $$evidence-extension,
     global-attributes,
integer-time = #6.1(int)

tag-id = 0
software-name = 1
entity = 2
evidence = 3
link = 4
software-meta = 5
payload = 6
hash = 7
corpus = 8
patch = 9
media = 10
supplemental = 11
tag-version = 12
software-version = 13
version-scheme = 14
lang = 15
directory = 16
file = 17
process = 18
resource = 19
size = 20
file-version = 21
key = 22
location = 23
fs-name = 24
root = 25
path-elements = 26
process-name = 27
pid = 28
type = 29
entity-name = 31
reg-id = 32
role = 33
thumbprint = 34
date = 35
device-id = 36
artifact = 37
href = 38
ownership = 39
rel = 40
media-type = 41
use = 42
activation-status = 43
channel-type = 44
colloquial-version = 45
description = 46
edition = 47
entitlement-data-required = 48
entitlement-key = 49
generator = 50
persistent-id = 51
product = 52
product-family = 53
revision = 54
summary = 55
unspsc-code = 56
unspsc-version = 57

multipartnumeric = 1
multipartnumeric-suffix = 2
alphanumeric = 3
decimal = 4
semver = 16384

tag-creator=1
software-creator=2
aggregator=3
distributor=4
licensor=5
maintainer=6

shared=1
private=2
abandon=3

ancestor=1
component=2
feature=3
installationmedia=4
packageinstaller=5
parent=6
patches=7
requires=8
see-also=9
supersedes=10
optional=1
required=2
recommended=3

cose-label = int / tstr
cose-values = any

protected-signed-coswid-header = {
       1 => int,                      ; algorithm identifier
       3 => "application/swid+cbor",
       4 => bstr,                     ; key identifier
       * cose-label => cose-values,
unprotected-signed-coswid-header = {
       * cose-label => cose-values,
protected-signed-coswid-header1 = {
       3 => "application/swid+cbor",
       * cose-label => cose-values,
protected-signature-coswid-header = {
       1 => int,                      ; algorithm identifier
       4 => bstr,                     ; key identifier
       * cose-label => cose-values,
unprotected-sign-coswid-header = {
       * cose-label => cose-values,
COSE_Signature =  [
       protected: bstr .cbor protected-signature-coswid-header,
       unprotected: unprotected-sign-coswid-header,
       signature : bstr
coswid = unsigned-coswid / signed-coswid
unsigned-coswid = concise-swid-tag / tagged-coswid<concise-swid-tag>
signed-coswid1 = signed-coswid-for<unsigned-coswid>
signed-coswid = signed-coswid1 / tagged-coswid<signed-coswid1>

