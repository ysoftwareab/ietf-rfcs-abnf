<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>HTTP Message Signatures</title>
<meta content="Annabelle Backman" name="author">
<meta content="Justin Richer" name="author">
<meta content="Manu Sporny" name="author">
<meta content="
       This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message.  This mechanism supports use cases where the full HTTP message may not be known to the signer, and where the message may be transformed (e.g., by intermediaries) before reaching the verifier.
This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="PKI" name="keyword">
<meta content="draft-ietf-httpbis-message-signatures-08" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-httpbis-message-signatures-08-abyzuvuk.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">HTTP Message Signatures</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Backman, et al.</td>
<td class="center">Expires 1 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">HTTP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-httpbis-message-signatures-08</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01-28" class="published">28 January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-01">1 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Backman, <span class="editor">Ed.</span>
</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">J. Richer</div>
<div class="org">Bespoke Engineering</div>
</div>
<div class="author">
      <div class="author-name">M. Sporny</div>
<div class="org">Digital Bazaar</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">HTTP Message Signatures</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message.  This mechanism supports use cases where the full HTTP message may not be known to the signer, and where the message may be transformed (e.g., by intermediaries) before reaching the verifier.
This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures/">https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        HTTP Working Group mailing list (<span><a href="mailto:ietf-http-wg@w3.org">mailto:ietf-http-wg@w3.org</a></span>),
        which is archived at <span><a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a></span>.
        Working Group information can be found at <span><a href="https://httpwg.org/">https://httpwg.org/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/httpwg/http-extensions/labels/signatures">https://github.com/httpwg/http-extensions/labels/signatures</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-discussion" class="xref">Requirements Discussion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-http-message-transformation" class="xref">HTTP Message Transformations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-safe-transformations" class="xref">Safe Transformations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-application-of-http-message" class="xref">Application of HTTP Message Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-http-message-components" class="xref">HTTP Message Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-http-fields" class="xref">HTTP Fields</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-canonicalized-structured-ht" class="xref">Canonicalized Structured HTTP Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-dictionary-structured-field" class="xref">Dictionary Structured Field Members</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-derived-components" class="xref">Derived Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-signature-parameters" class="xref">Signature Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-method" class="xref">Method</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="xref">2.2.3</a>.  <a href="#name-target-uri" class="xref">Target URI</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="xref">2.2.4</a>.  <a href="#name-authority" class="xref">Authority</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5">
                    <p id="section-toc.1-1.2.2.2.2.5.1"><a href="#section-2.2.5" class="xref">2.2.5</a>.  <a href="#name-scheme" class="xref">Scheme</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.6">
                    <p id="section-toc.1-1.2.2.2.2.6.1"><a href="#section-2.2.6" class="xref">2.2.6</a>.  <a href="#name-request-target" class="xref">Request Target</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.7">
                    <p id="section-toc.1-1.2.2.2.2.7.1"><a href="#section-2.2.7" class="xref">2.2.7</a>.  <a href="#name-path" class="xref">Path</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.8">
                    <p id="section-toc.1-1.2.2.2.2.8.1"><a href="#section-2.2.8" class="xref">2.2.8</a>.  <a href="#name-query" class="xref">Query</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.9">
                    <p id="section-toc.1-1.2.2.2.2.9.1"><a href="#section-2.2.9" class="xref">2.2.9</a>.  <a href="#name-query-parameters" class="xref">Query Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.10">
                    <p id="section-toc.1-1.2.2.2.2.10.1"><a href="#section-2.2.10" class="xref">2.2.10</a>. <a href="#name-status-code" class="xref">Status Code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.11">
                    <p id="section-toc.1-1.2.2.2.2.11.1"><a href="#section-2.2.11" class="xref">2.2.11</a>. <a href="#name-request-response-signature-" class="xref">Request-Response Signature Binding</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-creating-the-signature-inpu" class="xref">Creating the Signature Input String</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-http-message-signatures" class="xref">HTTP Message Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-creating-a-signature" class="xref">Creating a Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-verifying-a-signature" class="xref">Verifying a Signature</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-enforcing-application-requi" class="xref">Enforcing Application Requirements</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-signature-algorithm-methods" class="xref">Signature Algorithm Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-rsassa-pss-using-sha-512" class="xref">RSASSA-PSS using SHA-512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-rsassa-pkcs1-v1_5-using-sha" class="xref">RSASSA-PKCS1-v1_5 using SHA-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="xref">3.3.3</a>.  <a href="#name-hmac-using-sha-256" class="xref">HMAC using SHA-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="xref">3.3.4</a>.  <a href="#name-ecdsa-using-curve-p-256-dss" class="xref">ECDSA using curve P-256 DSS and SHA-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="xref">3.3.5</a>.  <a href="#name-eddsa-using-curve-edwards25" class="xref">EdDSA using curve edwards25519</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.6">
                    <p id="section-toc.1-1.3.2.3.2.6.1"><a href="#section-3.3.6" class="xref">3.3.6</a>.  <a href="#name-json-web-signature-jws-algo" class="xref">JSON Web Signature (JWS) algorithms</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-including-a-message-signatu" class="xref">Including a Message Signature in a Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-the-signature-input-http-fi" class="xref">The 'Signature-Input' HTTP Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-the-signature-http-field" class="xref">The 'Signature' HTTP Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-multiple-signatures" class="xref">Multiple Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-requesting-signatures" class="xref">Requesting Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-the-accept-signature-field" class="xref">The Accept-Signature Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-processing-an-accept-signat" class="xref">Processing an Accept-Signature</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-http-signature-algorithms-r" class="xref">HTTP Signature Algorithms Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-registration-template" class="xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-initial-contents" class="xref">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-http-signature-metadata-par" class="xref">HTTP Signature Metadata Parameters Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-registration-template-2" class="xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-initial-contents-2" class="xref">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-http-signature-derived-comp" class="xref">HTTP Signature Derived Component Identifiers Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-registration-template-3" class="xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.  <a href="#name-initial-contents-3" class="xref">Initial Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-signature-verification-skip" class="xref">Signature Verification Skipping</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-use-of-tls" class="xref">Use of TLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-signature-replay" class="xref">Signature Replay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-insufficient-coverage" class="xref">Insufficient Coverage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-cryptography-and-signature-" class="xref">Cryptography and Signature Collision</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-key-theft" class="xref">Key Theft</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-modification-of-required-me" class="xref">Modification of Required Message Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-mismatch-of-signature-param" class="xref">Mismatch of Signature Parameters from Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="xref">7.9</a>.  <a href="#name-multiple-signature-confusio" class="xref">Multiple Signature Confusion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="xref">7.10</a>. <a href="#name-signature-labels" class="xref">Signature Labels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11">
                <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="xref">7.11</a>. <a href="#name-symmetric-cryptography" class="xref">Symmetric Cryptography</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12">
                <p id="section-toc.1-1.7.2.12.1"><a href="#section-7.12" class="xref">7.12</a>. <a href="#name-canonicalization-attacks" class="xref">Canonicalization Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.13">
                <p id="section-toc.1-1.7.2.13.1"><a href="#section-7.13" class="xref">7.13</a>. <a href="#name-key-specification-mix-up" class="xref">Key Specification Mix-Up</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.14">
                <p id="section-toc.1-1.7.2.14.1"><a href="#section-7.14" class="xref">7.14</a>. <a href="#name-http-versions-and-component" class="xref">HTTP Versions and Component Ambiguity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.15">
                <p id="section-toc.1-1.7.2.15.1"><a href="#section-7.15" class="xref">7.15</a>. <a href="#name-key-and-algorithm-specifica" class="xref">Key and Algorithm Specification Downgrades</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.16">
                <p id="section-toc.1-1.7.2.16.1"><a href="#section-7.16" class="xref">7.16</a>. <a href="#name-parsing-structured-field-va" class="xref">Parsing Structured Field Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.17">
                <p id="section-toc.1-1.7.2.17.1"><a href="#section-7.17" class="xref">7.17</a>. <a href="#name-choosing-message-components" class="xref">Choosing Message Components</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.18">
                <p id="section-toc.1-1.7.2.18.1"><a href="#section-7.18" class="xref">7.18</a>. <a href="#name-confusing-http-field-names-" class="xref">Confusing HTTP Field Names for Derived Component Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.19">
                <p id="section-toc.1-1.7.2.19.1"><a href="#section-7.19" class="xref">7.19</a>. <a href="#name-non-deterministic-signature" class="xref">Non-deterministic Signature Primitives</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-identification-through-keys" class="xref">Identification through Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-signatures-do-not-provide-c" class="xref">Signatures do not provide confidentiality</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-oracles" class="xref">Oracles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-required-content" class="xref">Required Content</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-detecting-http-message-sign" class="xref">Detecting HTTP Message Signatures</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-examples" class="xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-example-keys" class="xref">Example Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#appendix-B.1.1" class="xref">B.1.1</a>.  <a href="#name-example-key-rsa-test" class="xref">Example Key RSA test</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a href="#appendix-B.1.2" class="xref">B.1.2</a>.  <a href="#name-example-rsa-pss-key" class="xref">Example RSA PSS Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.3">
                    <p id="section-toc.1-1.11.2.1.2.3.1"><a href="#appendix-B.1.3" class="xref">B.1.3</a>.  <a href="#name-example-ecc-p-256-test-key" class="xref">Example ECC P-256 Test Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.4">
                    <p id="section-toc.1-1.11.2.1.2.4.1"><a href="#appendix-B.1.4" class="xref">B.1.4</a>.  <a href="#name-example-shared-secret" class="xref">Example Shared Secret</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.5">
                    <p id="section-toc.1-1.11.2.1.2.5.1"><a href="#appendix-B.1.5" class="xref">B.1.5</a>.  <a href="#name-example-ed25519-test-key" class="xref">Example Ed25519 Test Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-test-cases" class="xref">Test Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#appendix-B.2.1" class="xref">B.2.1</a>.  <a href="#name-minimal-signature-using-rsa" class="xref">Minimal Signature Using rsa-pss-sha512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#appendix-B.2.2" class="xref">B.2.2</a>.  <a href="#name-selective-covered-component" class="xref">Selective Covered Components using rsa-pss-sha512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a href="#appendix-B.2.3" class="xref">B.2.3</a>.  <a href="#name-full-coverage-using-rsa-pss" class="xref">Full Coverage using rsa-pss-sha512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.4">
                    <p id="section-toc.1-1.11.2.2.2.4.1"><a href="#appendix-B.2.4" class="xref">B.2.4</a>.  <a href="#name-signing-a-response-using-ec" class="xref">Signing a Response using ecdsa-p256-sha256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.5">
                    <p id="section-toc.1-1.11.2.2.2.5.1"><a href="#appendix-B.2.5" class="xref">B.2.5</a>.  <a href="#name-signing-a-request-using-hma" class="xref">Signing a Request using hmac-sha256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.6">
                    <p id="section-toc.1-1.11.2.2.2.6.1"><a href="#appendix-B.2.6" class="xref">B.2.6</a>.  <a href="#name-signing-a-request-using-ed2" class="xref">Signing a Request using ed25519</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="xref">B.3</a>.  <a href="#name-tls-terminating-proxies" class="xref">TLS-Terminating Proxies</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="xref"></a><a href="#name-document-history" class="xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Message integrity and authenticity are important security properties that are critical to the secure operation of many HTTP applications.
Application developers typically rely on the transport layer to provide these properties, by operating their application over <span>[<a href="#TLS" class="xref">TLS</a>]</span>.  However, TLS only guarantees these properties over a single TLS connection, and the path between client and application may be composed of multiple independent TLS connections (for example, if the application is hosted behind a TLS-terminating gateway or if the client is behind a TLS Inspection appliance).  In such cases, TLS cannot guarantee end-to-end message integrity or authenticity between the client and application.  Additionally, some operating environments present obstacles that make it impractical to use TLS, or to use features necessary to provide message authenticity.  Furthermore, some applications require the binding of an application-level key to the HTTP message, separate from any TLS certificates in use. Consequently, while TLS can meet message integrity and authenticity needs for many HTTP-based applications, it is not a universal solution.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document defines a mechanism for providing end-to-end integrity and authenticity for components of an HTTP message.  The mechanism allows applications to create digital signatures or message authentication codes (MACs) over only the components of the message that are meaningful and appropriate for the application.  Strict canonicalization rules ensure that the verifier can verify the signature even if the message has been transformed in any of the many ways permitted by HTTP.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The signing mechanism described in this document consists of three parts:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">A common nomenclature and canonicalization rule set for the different protocol elements and other components of HTTP messages, used to create a signature input.<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.2">Algorithms for generating and verifying signatures over HTTP message components using this signature input through application of cryptographic primitives.<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.3">A mechanism for attaching a signature and related metadata to an HTTP message, and for parsing attached signatures and metadata from HTTP messages.<a href="#section-1-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-5">This document also provides a mechanism for a potential verifier to signal to a potential signer that a signature is desired in one or more subsequent messages. This optional negotiation mechanism can be used along with opportunistic or application-driven message signatures by either party.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="requirements-discussion">
<section id="section-1.1">
        <h3 id="name-requirements-discussion">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-discussion" class="section-name selfRef">Requirements Discussion</a>
        </h3>
<p id="section-1.1-1">HTTP permits and sometimes requires intermediaries to transform messages in a variety of ways.  This may result in a recipient receiving a message that is not bitwise equivalent to the message that was originally sent.  In such a case, the recipient will be unable to verify a signature over the raw bytes of the sender's HTTP message, as verifying digital signatures or MACs requires both signer and verifier to have the exact same signature input.  Since the exact raw bytes of the message cannot be relied upon as a reliable source of signature input, the signer and verifier must derive the signature input from their respective versions of the message, via a mechanism that is resilient to safe changes that do not alter the meaning of the message.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">For a variety of reasons, it is impractical to strictly define what constitutes a safe change versus an unsafe one.  Applications use HTTP in a wide variety of ways, and may disagree on whether a particular piece of information in a message (e.g., the body, or the <code>Date</code> header field) is relevant.  Thus a general purpose solution must provide signers with some degree of control over which message components are signed.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">HTTP applications may be running in environments that do not provide complete access to or control over HTTP messages (such as a web browser's JavaScript environment), or may be using libraries that abstract away the details of the protocol (such as <a href="https://openjdk.java.net/groups/net/httpclient/intro.html">the Java HTTPClient library</a>).  These applications need to be able to generate and verify signatures despite incomplete knowledge of the HTTP message.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transforms">
<section id="section-1.2">
        <h3 id="name-http-message-transformation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-http-message-transformation" class="section-name selfRef">HTTP Message Transformations</a>
        </h3>
<p id="section-1.2-1">As mentioned earlier, HTTP explicitly permits and in some cases requires implementations to transform messages in a variety of ways.  Implementations are required to tolerate many of these transformations.  What follows is a non-normative and non-exhaustive list of transformations that may occur under HTTP, provided as context:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">Re-ordering of header fields with different header field names (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>).<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">Combination of header fields with the same field name (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>).<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">Removal of header fields listed in the <code>Connection</code> header field (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-6.1" class="relref">Section 6.1</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>).<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.4">Addition of header fields that indicate control options (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-6.1" class="relref">Section 6.1</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>).<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.5">Addition or removal of a transfer coding (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-5.7.2" class="relref">Section 5.7.2</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>).<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.6">Addition of header fields such as <code>Via</code> (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-5.7.1" class="relref">Section 5.7.1</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>) and <code>Forwarded</code> (<span><a href="https://rfc-editor.org/rfc/rfc7239#section-4" class="relref">Section 4</a> of [<a href="#RFC7239" class="xref">RFC7239</a>]</span>).<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="safe-transformations">
<section id="section-1.3">
        <h3 id="name-safe-transformations">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-safe-transformations" class="section-name selfRef">Safe Transformations</a>
        </h3>
<p id="section-1.3-1">Based on the definition of HTTP and the requirements described above, we can identify certain types of transformations that should not prevent signature verification, even when performed on message components covered by the signature.  The following list describes those transformations:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">Combination of header fields with the same field name.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">Reordering of header fields with different names.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">Conversion between different versions of the HTTP protocol (e.g., HTTP/1.x to HTTP/2, or vice-versa).<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">Changes in casing (e.g., "Origin" to "origin") of any case-insensitive components such as header field names, request URI scheme, or host.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.5">Addition or removal of leading or trailing whitespace to a header field value.<a href="#section-1.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.6">Addition or removal of <code>obs-folds</code>.<a href="#section-1.3-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.7">Changes to the <code>request-target</code> and <code>Host</code> header field that when applied together do not
result in a change to the message's effective request URI, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-5.5" class="relref">Section 5.5</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>.<a href="#section-1.3-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.3-3">Additionally, all changes to components not covered by the signature are considered safe.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-1.4">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.4-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">The terms "HTTP message", "HTTP request", "HTTP response",
<code>absolute-form</code>, <code>absolute-path</code>, "effective request URI",
"gateway", "header field", "intermediary", <code>request-target</code>,
"sender", and "recipient" are used as defined in <span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">The term "method" is to be interpreted as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-4" class="relref">Section 4</a> of [<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">For brevity, the term "signature" on its own is used in this document to refer to both digital signatures (which use asymmetric cryptography) and keyed MACs (which use symmetric cryptography). Similarly, the verb "sign" refers to the generation of either a digital signature or keyed MAC over a given input string. The qualified term "digital signature" refers specifically to the output of an asymmetric cryptographic signing operation.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">In addition to those listed above, this document uses the following terms:<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.4-6">
          <dt id="section-1.4-6.1">
HTTP Message Signature:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.2">
            <p id="section-1.4-6.2.1">A digital signature or keyed MAC that covers one or more portions of an HTTP message. Note that a given HTTP Message can contain multiple HTTP Message Signatures.<a href="#section-1.4-6.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.3">
Signer:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.4">
            <p id="section-1.4-6.4.1">The entity that is generating or has generated an HTTP Message Signature. Note that multiple entities can act as signers and apply separate HTTP Message Signatures to a given HTTP Message.<a href="#section-1.4-6.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.5">
Verifier:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.6">
            <p id="section-1.4-6.6.1">An entity that is verifying or has verified an HTTP Message Signature against an HTTP Message.  Note that an HTTP Message Signature may be verified multiple times, potentially by different entities.<a href="#section-1.4-6.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.7">
HTTP Message Component:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.8">
            <p id="section-1.4-6.8.1">A portion of an HTTP message that is capable of being covered by an HTTP Message Signature.<a href="#section-1.4-6.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.9">
HTTP Message Component Identifier:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.10">
            <p id="section-1.4-6.10.1">A value that uniquely identifies a specific HTTP Message Component in respect to a particular HTTP Message Signature and the HTTP Message it applies to.<a href="#section-1.4-6.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.11">
HTTP Message Component Value:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.12">
            <p id="section-1.4-6.12.1">The value associated with a given component identifier within the context of a particular HTTP Message. Component values are derived from the HTTP Message and are usually subject to a canonicalization process.<a href="#section-1.4-6.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.13">
Covered Components:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.14">
            <p id="section-1.4-6.14.1">An ordered set of HTTP message component identifiers for fields (<a href="#http-header" class="xref">Section 2.1</a>) and derived components (<a href="#derived-components" class="xref">Section 2.2</a>) that indicates the set of message components covered by the signature, never including the <code>@signature-params</code> identifier itself. The order of this set is preserved and communicated between the signer and verifier to facilitate reconstruction of the signature input.<a href="#section-1.4-6.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.15">
Signature Input:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.16">
            <p id="section-1.4-6.16.1">The sequence of bytes processed by the cryptographic algorithm to produce or verify the HTTP Message Signature. The signature input is generated by the signer and verifier using the covered components set and the HTTP Message.<a href="#section-1.4-6.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.17">
HTTP Message Signature Algorithm:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.18">
            <p id="section-1.4-6.18.1">A cryptographic algorithm that describes the signing and verification process for the signature, defined in terms of the <code>HTTP_SIGN</code> and <code>HTTP_VERIFY</code> primitives described in <a href="#signature-methods" class="xref">Section 3.3</a>.<a href="#section-1.4-6.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.19">
Key Material:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.20">
            <p id="section-1.4-6.20.1">The key material required to create or verify the signature. The key material is often identified with an explicit key identifier, allowing the signer to indicate to the verifier which key was used.<a href="#section-1.4-6.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.21">
Creation Time:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.22">
            <p id="section-1.4-6.22.1">A timestamp representing the point in time that the signature was generated, as asserted by the signer.<a href="#section-1.4-6.22.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.23">
Expiration Time:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.24">
            <p id="section-1.4-6.24.1">A timestamp representing the point in time after which the signature should no longer be accepted by the verifier, as asserted by the signer.<a href="#section-1.4-6.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.4-7">The term "Unix time" is defined by <span>[<a href="#POSIX.1" class="xref">POSIX.1</a>]</span>, <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_16">Section 4.16</a>.<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<p id="section-1.4-8">This document contains non-normative examples of partial and complete HTTP messages. Some examples use a single trailing backslash '' to indicate line wrapping for long values, as per <span>[<a href="#RFC8792" class="xref">RFC8792</a>]</span>. The <code>\</code> character and leading spaces on wrapped lines are not part of the value.<a href="#section-1.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application">
<section id="section-1.5">
        <h3 id="name-application-of-http-message">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-application-of-http-message" class="section-name selfRef">Application of HTTP Message Signatures</a>
        </h3>
<p id="section-1.5-1">HTTP Message Signatures are designed to be a general-purpose security mechanism applicable in a wide variety of circumstances and applications. In order to properly and safely apply HTTP Message Signatures, an application or profile of this specification <span class="bcp14">MUST</span> specify all of the following items:<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.1">The set of <span><a href="#covered-content" class="xref">component identifiers</a> (<a href="#covered-content" class="xref">Section 2</a>)</span> that are expected and required. For example, an authorization protocol could mandate that the <code>Authorization</code> header be covered to protect the authorization credentials and mandate the signature parameters contain a <code>created</code> parameter, while an API expecting HTTP message bodies could require the <code>Digest</code> header to be present and covered.<a href="#section-1.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-2.2">A means of retrieving the key material used to verify the signature. An application will usually use the <code>keyid</code> parameter of the signature parameters (<a href="#signature-params" class="xref">Section 2.2.1</a>) and define rules for resolving a key from there, though the appropriate key could be known from other means.<a href="#section-1.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-2.3">A means of determining the signature algorithm used to verify the signature is appropriate for the key material. For example, the process could use the <code>alg</code> parameter of the signature parameters (<a href="#signature-params" class="xref">Section 2.2.1</a>) to state the algorithm explicitly, derive the algorithm from the key material, or use some pre-configured algorithm agreed upon by the signer and verifier.<a href="#section-1.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-2.4">A means of determining that a given key and algorithm presented in the request are appropriate for the request being made. For example, a server expecting only ECDSA signatures should know to reject any RSA signatures, or a server expecting asymmetric cryptography should know to reject any symmetric cryptography.<a href="#section-1.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.5-3">An application using signatures also has to ensure that the verifier will have access to all required information to re-create the signature input string. For example, a server behind a reverse proxy would need to know the original request URI to make use of identifiers like <code>@target-uri</code>. Additionally, an application using signatures in responses would need to ensure that clients receiving signed responses have access to all the signed portions, including any portions of the request that were signed by the server.<a href="#section-1.5-3" class="pilcrow">¶</a></p>
<p id="section-1.5-4">The details of this kind of profiling are the purview of the application and outside the scope of this specification, however some additional considerations are discussed in <a href="#security" class="xref">Section 7</a>.<a href="#section-1.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="covered-content">
<section id="section-2">
      <h2 id="name-http-message-components">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-http-message-components" class="section-name selfRef">HTTP Message Components</a>
      </h2>
<p id="section-2-1">In order to allow signers and verifiers to establish which components are covered by a signature, this document defines component identifiers for components covered by an HTTP Message Signature, a set of rules for deriving and canonicalizing the values associated with these component identifiers from the HTTP Message, and the means for combining these canonicalized values into a signature input string. The values for these items <span class="bcp14">MUST</span> be accessible to both the signer and the verifier of the message, which means these are usually derived from aspects of the HTTP message or signature itself.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Some HTTP message components can undergo transformations that change the bitwise value without altering meaning of the component's value (for example, the merging together of header fields with the same name).  Message component values must therefore be canonicalized before it is signed, to ensure that a signature can be verified despite such intermediary transformations. This document defines rules for each component identifier that transform the identifier's associated component value into such a canonical form.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Component identifiers are serialized using the production grammar defined by <span>[<a href="#RFC8941" class="xref">RFC8941</a>], <a href="https://rfc-editor.org/rfc/rfc8941#section-4" class="relref">Section 4</a></span>.
The component identifier itself is an <code>sf-string</code> value and <span class="bcp14">MAY</span> define parameters which are included using the <code>parameters</code> rule.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="section-2-4">
<pre class="lang-abnf sourcecode">
component-identifier = sf-string parameters
</pre><a href="#section-2-4" class="pilcrow">¶</a>
</div>
<p id="section-2-5">Note that this means the serialization of the component identifier itself is encased in double quotes, with parameters following as a semicolon-separated list, such as <code>"cache-control"</code>, <code>"date"</code>, or <code>"@signature-params"</code>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">Component identifiers, including component identifiers with parameters, <span class="bcp14">MUST NOT</span> be repeated within a single list of covered components. Component identifiers with different parameter values <span class="bcp14">MAY</span> be repeated within a single list of covered components.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">The component value associated with a component identifier is defined by the identifier itself. Component values <span class="bcp14">MUST NOT</span> contain newline (<code>\n</code>) characters.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">The following sections define component identifier types, their parameters, their associated values, and the canonicalization rules for their values. The method for combining component identifiers into the signature input is defined in <a href="#create-sig-input" class="xref">Section 2.3</a>.<a href="#section-2-8" class="pilcrow">¶</a></p>
<div id="http-header">
<section id="section-2.1">
        <h3 id="name-http-fields">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-http-fields" class="section-name selfRef">HTTP Fields</a>
        </h3>
<p id="section-2.1-1">The component identifier for an HTTP field is the lowercased form of its field name. While HTTP field names are case-insensitive, implementations <span class="bcp14">MUST</span> use lowercased field names (e.g., <code>content-type</code>, <code>date</code>, <code>etag</code>) when using them as component identifiers.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Unless overridden by additional parameters and rules, the HTTP field value <span class="bcp14">MUST</span> be canonicalized as a single combined value as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-5.2" class="relref">Section 5.2</a> of [<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">If the combined value is not available for a given header, the following algorithm will produce canonicalized results for an implementation:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-4">
<li id="section-2.1-4.1">Create an ordered list of the field values of each instance of the field in the message, in the order that they occur (or will occur) in the message.<a href="#section-2.1-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-4.2">Strip leading and trailing whitespace from each item in the list. Note that since HTTP field values are not allowed to contain leading and trailing whitespace, this will be a no-op in a compliant implementation.<a href="#section-2.1-4.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-4.3">Remove any obsolete line-folding within the line and replace it with a single space (<code></code>), as discussed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19#section-5.2" class="relref">Section 5.2</a> of [<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>. Note that this behavior is specific to <span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span> and does not apply to other versions of the HTTP specification.<a href="#section-2.1-4.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-4.4">Concatenate the list of values together with a single comma (<code>,</code>) and a single space (<code></code>) between each item.<a href="#section-2.1-4.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.1-5">The resulting string is the canonicalized component value.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Following are non-normative examples of canonicalized values for header fields, given the following example HTTP message fragment:<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<div id="section-2.1-7">
<pre class="lang-http-message sourcecode">
Host: www.example.com
Date: Tue, 20 Apr 2021 02:07:56 GMT
X-OWS-Header:   Leading and trailing whitespace.
X-Obs-Fold-Header: Obsolete
    line folding.
Cache-Control: max-age=60
Cache-Control:    must-revalidate
Example-Dictionary:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a href="#section-2.1-7" class="pilcrow">¶</a>
</div>
<p id="section-2.1-8">The following example shows canonicalized values for these example header fields, presented using the signature input string format discussed in <a href="#create-sig-input" class="xref">Section 2.3</a>:<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-9">
<pre>
"host": www.example.com
"date": Tue, 20 Apr 2021 02:07:56 GMT
"x-ows-header": Leading and trailing whitespace.
"x-obs-fold-header": Obsolete line folding.
"cache-control": max-age=60, must-revalidate
"Example-dictionary": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a href="#section-2.1-9" class="pilcrow">¶</a>
</div>
<p id="section-2.1-10">Since empty HTTP header fields are allowed, they are also able to be signed when present in a message. The canonicalized value is the empty string. This means that the following empty header:<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<div id="section-2.1-11">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

X-Empty-Header: \

</pre><a href="#section-2.1-11" class="pilcrow">¶</a>
</div>
<p id="section-2.1-12">Is serialized by the <span><a href="#create-sig-input" class="xref">signature input generation algorithm</a> (<a href="#create-sig-input" class="xref">Section 2.3</a>)</span> with an empty string value following the colon and space added after the content identifier.<a href="#section-2.1-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-13">
<pre>
NOTE: '\' line wrapping per RFC 8792

"x-empty-header": \

</pre><a href="#section-2.1-13" class="pilcrow">¶</a>
</div>
<p id="section-2.1-14">Note: these are shown here using the line wrapping algorithm in <span>[<a href="#RFC8792" class="xref">RFC8792</a>]</span> due to limitations in the document format that strips trailing spaces from diagrams.<a href="#section-2.1-14" class="pilcrow">¶</a></p>
<div id="http-header-structured">
<section id="section-2.1.1">
          <h4 id="name-canonicalized-structured-ht">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-canonicalized-structured-ht" class="section-name selfRef">Canonicalized Structured HTTP Fields</a>
          </h4>
<p id="section-2.1.1-1">If value of the the HTTP field in question is a structured field (<span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span>), the component identifier <span class="bcp14">MAY</span> include the <code>sf</code> parameter to indicate it is a known structured field. If this
parameter is included with a component identifier, the HTTP field value <span class="bcp14">MUST</span> be serialized using the rules specified in <span><a href="https://rfc-editor.org/rfc/rfc8941#section-4" class="relref">Section 4</a> of [<a href="#RFC8941" class="xref">RFC8941</a>]</span> applicable to the type of the HTTP field. Note that this process
will replace any optional internal whitespace with a single space character, among other potential transformations of the value.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">For example, the following dictionary field is a valid serialization:<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<div id="section-2.1.1-3">
<pre class="lang-http-message sourcecode">
Example-Dictionary:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a href="#section-2.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1-4">If included in the input string as-is, it would be:<a href="#section-2.1.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-5">
<pre>
"example-dictionary": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a href="#section-2.1.1-5" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1-6">However, if the <code>sf</code> parameter is added, the value is re-serialized as follows:<a href="#section-2.1.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-7">
<pre>
"example-dictionary";sf: a=1, b=2;x=1;y=2, c=(a b c)
</pre><a href="#section-2.1.1-7" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1-8">The resulting string is used as the component value in <a href="#http-header" class="xref">Section 2.1</a>.<a href="#section-2.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-header-dictionary">
<section id="section-2.1.2">
          <h4 id="name-dictionary-structured-field">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-dictionary-structured-field" class="section-name selfRef">Dictionary Structured Field Members</a>
          </h4>
<p id="section-2.1.2-1">An individual member in the value of a Dictionary Structured Field is identified by using the parameter <code>key</code> to indicate the member key as an <code>sf-string</code> value.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">An individual member in the value of a Dictionary Structured Field is canonicalized by applying the serialization algorithm described in <span><a href="https://rfc-editor.org/rfc/rfc8941#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC8941" class="xref">RFC8941</a>]</span> on the member value and its parameters, without the dictionary key.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">Each parameterized key for a given field <span class="bcp14">MUST NOT</span> appear more than once in the signature input. Parameterized keys <span class="bcp14">MAY</span> appear in any order.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2-4">Following are non-normative examples of canonicalized values for Dictionary Structured Field Members given the following example header field, whose value is known to be a Dictionary:<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
<div id="section-2.1.2-5">
<pre class="lang-http-message sourcecode">
Example-Dictionary:  a=1, b=2;x=1;y=2, c=(a   b    c)
</pre><a href="#section-2.1.2-5" class="pilcrow">¶</a>
</div>
<p id="section-2.1.2-6">The following example shows canonicalized values for different component identifiers of this field, presented using the signature input string format discussed in <a href="#create-sig-input" class="xref">Section 2.3</a>:<a href="#section-2.1.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.2-7">
<pre>
"example-dictionary";key="a": 1
"example-dictionary";key="b": 2;x=1;y=2
"example-dictionary";key="c": (a b c)
</pre><a href="#section-2.1.2-7" class="pilcrow">¶</a>
</div>
<p id="section-2.1.2-8">Note that the value for <code>key="c"</code> has been re-serialized.<a href="#section-2.1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="derived-components">
<section id="section-2.2">
        <h3 id="name-derived-components">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-derived-components" class="section-name selfRef">Derived Components</a>
        </h3>
<p id="section-2.2-1">In addition to HTTP fields, there are a number of different components that can be derived from the control data, processing context, or other aspects of the HTTP message being signed. Such derived components can be included in the signature input by defining a component identifier and the derivation method for its component value.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Derived component identifiers <span class="bcp14">MUST</span> start with the "at" <code>@</code> character. This differentiates derived component identifiers from HTTP field names, which cannot contain the <code>@</code> character as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-5.1" class="relref">Section 5.1</a> of [<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>. Processors of HTTP Message Signatures <span class="bcp14">MUST</span> treat derived component identifiers separately from field names, as discussed in <a href="#security-lazy-header-parser" class="xref">Section 7.18</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">This specification defines the following derived component identifiers:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-4">
          <dt id="section-2.2-4.1">
@signature-params  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.2">
            <p id="section-2.2-4.2.1">The signature metadata parameters for this signature. (<a href="#signature-params" class="xref">Section 2.2.1</a>)<a href="#section-2.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.3">
@method  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.4">
            <p id="section-2.2-4.4.1">The method used for a request. (<a href="#content-request-method" class="xref">Section 2.2.2</a>)<a href="#section-2.2-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.5">
@target-uri  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.6">
            <p id="section-2.2-4.6.1">The full target URI for a request. (<a href="#content-target-uri" class="xref">Section 2.2.3</a>)<a href="#section-2.2-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.7">
@authority  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.8">
            <p id="section-2.2-4.8.1">The authority of the target URI for a request. (<a href="#content-request-authority" class="xref">Section 2.2.4</a>)<a href="#section-2.2-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.9">
@scheme  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.10">
            <p id="section-2.2-4.10.1">The scheme of the target URI for a request. (<a href="#content-request-scheme" class="xref">Section 2.2.5</a>)<a href="#section-2.2-4.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.11">
@request-target  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.12">
            <p id="section-2.2-4.12.1">The request target. (<a href="#content-request-target" class="xref">Section 2.2.6</a>)<a href="#section-2.2-4.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.13">
@path  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.14">
            <p id="section-2.2-4.14.1">The absolute path portion of the target URI for a request. (<a href="#content-request-path" class="xref">Section 2.2.7</a>)<a href="#section-2.2-4.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.15">
@query  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.16">
            <p id="section-2.2-4.16.1">The query portion of the target URI for a request. (<a href="#content-request-query" class="xref">Section 2.2.8</a>)<a href="#section-2.2-4.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.17">
@query-params  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.18">
            <p id="section-2.2-4.18.1">The parsed query parameters of the target URI for a request. (<a href="#content-request-query-params" class="xref">Section 2.2.9</a>)<a href="#section-2.2-4.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.19">
@status  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.20">
            <p id="section-2.2-4.20.1">The status code for a response. (<a href="#content-status-code" class="xref">Section 2.2.10</a>).<a href="#section-2.2-4.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.21">
@request-response  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-4.22">
            <p id="section-2.2-4.22.1">A signature from a request message that resulted in this response message. (<a href="#content-request-response" class="xref">Section 2.2.11</a>)<a href="#section-2.2-4.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-5">Additional derived component identifiers <span class="bcp14">MAY</span> be defined and registered in the HTTP Signatures Derived Component Identifier Registry. (<a href="#content-registry" class="xref">Section 6.3</a>)<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">Derived components can be applied in one or more of three targets:<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-7">
          <dt id="section-2.2-7.1">
request:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-7.2">
            <p id="section-2.2-7.2.1">Values derived from and results applied to an HTTP request message as described in {{Section 3.4 of SEMANTICS.<a href="#section-2.2-7.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-7.3">
response:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-7.4">
            <p id="section-2.2-7.4.1">Values derived from and results applied to an HTTP response message as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-3.4" class="relref">Section 3.4</a> of [<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>.<a href="#section-2.2-7.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-7.5">
related-response:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-7.6">
            <p id="section-2.2-7.6.1">Values derived from an HTTP request message and results applied to the HTTP response message that is responding to that specific request.<a href="#section-2.2-7.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-8">A component identifier definition <span class="bcp14">MUST</span> define all targets to which it can be applied.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2-9">The component value <span class="bcp14">MUST</span> be derived from the HTTP message being signed or the context in which the derivation occurs. The derived component value <span class="bcp14">MUST</span> be of the following form:<a href="#section-2.2-9" class="pilcrow">¶</a></p>
<div id="section-2.2-10">
<pre class="lang-abnf sourcecode">
derived-component-value = *VCHAR
</pre><a href="#section-2.2-10" class="pilcrow">¶</a>
</div>
<div id="signature-params">
<section id="section-2.2.1">
          <h4 id="name-signature-parameters">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-signature-parameters" class="section-name selfRef">Signature Parameters</a>
          </h4>
<p id="section-2.2.1-1">HTTP Message Signatures have metadata properties that provide information regarding the signature's generation and verification, such as the set of covered components, a timestamp, identifiers for verification key material, and other utilities.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">The signature parameters component identifier is <code>@signature-params</code>. This message component's value is <span class="bcp14">REQUIRED</span> as part of the <span><a href="#create-sig-input" class="xref">signature input string</a> (<a href="#create-sig-input" class="xref">Section 2.3</a>)</span> but the component identifier <span class="bcp14">MUST NOT</span> be enumerated within the set of covered components itself.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1-3">The signature parameters component value is the serialization of the signature parameters for this signature, including the covered components set with all associated parameters. These parameters include any of the following:<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-4.1">
              <code>created</code>: Creation time as an <code>sf-integer</code> UNIX timestamp value. Sub-second precision is not supported. Inclusion of this parameter is <span class="bcp14">RECOMMENDED</span>.<a href="#section-2.2.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-4.2">
              <code>expires</code>: Expiration time as an <code>sf-integer</code> UNIX timestamp value. Sub-second precision is not supported.<a href="#section-2.2.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-4.3">
              <code>nonce</code>: A random unique value generated for this signature as an <code>sf-string</code> value.<a href="#section-2.2.1-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-4.4">
              <code>alg</code>: The HTTP message signature algorithm from the HTTP Message Signature Algorithm Registry, as an <code>sf-string</code> value.<a href="#section-2.2.1-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.1-4.5">
              <code>keyid</code>: The identifier for the key material as an <code>sf-string</code> value.<a href="#section-2.2.1-4.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.2.1-5">Additional parameters can be defined in the <span><a href="#iana-param-contents" class="xref">HTTP Signature Parameters Registry</a> (<a href="#iana-param-contents" class="xref">Section 6.2.2</a>)</span>.<a href="#section-2.2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.2.1-6">The signature parameters component value is serialized as a parameterized inner list using the rules in <span><a href="https://rfc-editor.org/rfc/rfc8941#section-4" class="relref">Section 4</a> of [<a href="#RFC8941" class="xref">RFC8941</a>]</span> as follows:<a href="#section-2.2.1-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.1-7">
<li id="section-2.2.1-7.1">Let the output be an empty string.<a href="#section-2.2.1-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-7.2">Determine an order for the component identifiers of the covered components, not including the <code>@signature-params</code> component identifier itself. Once this order is chosen, it cannot be changed. This order <span class="bcp14">MUST</span> be the same order as used in creating the signature input (<a href="#create-sig-input" class="xref">Section 2.3</a>).<a href="#section-2.2.1-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-7.3">Serialize the component identifiers of the covered components, including all parameters, as an ordered <code>inner-list</code> according to <span><a href="https://rfc-editor.org/rfc/rfc8941#section-4.1.1.1" class="relref">Section 4.1.1.1</a> of [<a href="#RFC8941" class="xref">RFC8941</a>]</span> and append this to the output.<a href="#section-2.2.1-7.3" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-7.4">Determine an order for any signature parameters. Once this order is chosen, it cannot be changed.<a href="#section-2.2.1-7.4" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-7.5">Append the parameters to the <code>inner-list</code> in the chosen order according to <span><a href="https://rfc-editor.org/rfc/rfc8941#section-4.1.1.2" class="relref">Section 4.1.1.2</a> of [<a href="#RFC8941" class="xref">RFC8941</a>]</span>,
 skipping parameters that are not available or not used for this message signature.<a href="#section-2.2.1-7.5" class="pilcrow">¶</a>
</li>
            <li id="section-2.2.1-7.6">The output contains the signature parameters component value.<a href="#section-2.2.1-7.6" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-2.2.1-8">Note that the <code>inner-list</code> serialization is used for the covered component value instead of the <code>sf-list</code> serialization
in order to facilitate this value's inclusion in message fields such as the <code>Signature-Input</code> field's dictionary,
as discussed in <a href="#signature-input-header" class="xref">Section 4.1</a>.<a href="#section-2.2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.2.1-9">This example shows a canonicalized value for the parameters of a given signature:<a href="#section-2.2.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-10">
<pre>
NOTE: '\' line wrapping per RFC 8792

("@target-uri" "@authority" "date" "cache-control")\
  ;keyid="test-key-rsa-pss";alg="rsa-pss-sha512";\
  created=1618884475;expires=1618884775
</pre><a href="#section-2.2.1-10" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-11">Note that an HTTP message could contain <span><a href="#signature-multiple" class="xref">multiple signatures</a> (<a href="#signature-multiple" class="xref">Section 4.3</a>)</span>, but only the signature parameters used for a single signature are included in an entry.<a href="#section-2.2.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-method">
<section id="section-2.2.2">
          <h4 id="name-method">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-method" class="section-name selfRef">Method</a>
          </h4>
<p id="section-2.2.2-1">The <code>@method</code> component identifier refers to the HTTP method of a request message. The component value of is canonicalized by taking the value of the method as a string. Note that the method name is case-sensitive as per <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-9.1" class="relref">Section 9.1</a></span>, and conventionally standardized method names are uppercase US-ASCII.
If used, the <code>@method</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">For example, the following request message:<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<div id="section-2.2.2-3">
<pre class="lang-http-message sourcecode">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-4">Would result in the following <code>@method</code> value:<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-5">
<pre>
"@method": POST
</pre><a href="#section-2.2.2-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-6">If used in a related-response, the <code>@method</code> component identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-target-uri">
<section id="section-2.2.3">
          <h4 id="name-target-uri">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-target-uri" class="section-name selfRef">Target URI</a>
          </h4>
<p id="section-2.2.3-1">The <code>@target-uri</code> component identifier refers to the target URI of a request message. The component value is the full absolute target URI of the request, potentially assembled from all available parts including the authority and request target as described in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-7.1" class="relref">Section 7.1</a></span>.
If used, the <code>@target-uri</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.2.3-2">For example, the following message sent over HTTPS:<a href="#section-2.2.3-2" class="pilcrow">¶</a></p>
<div id="section-2.2.3-3">
<pre class="lang-http-message sourcecode">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.3-4">Would result in the following <code>@target-uri</code> value:<a href="#section-2.2.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.3-5">
<pre>
"@target-uri": https://www.example.com/path?param=value
</pre><a href="#section-2.2.3-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.3-6">If used in a related-response, the <code>@target-uri</code> component identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-authority">
<section id="section-2.2.4">
          <h4 id="name-authority">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-authority" class="section-name selfRef">Authority</a>
          </h4>
<p id="section-2.2.4-1">The <code>@authority</code> component identifier refers to the authority component of the target URI of the HTTP request message, as defined in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-7.2" class="relref">Section 7.2</a></span>. In HTTP 1.1, this is usually conveyed using the <code>Host</code> header, while in HTTP 2 and HTTP 3 it is conveyed using the <code>:authority</code> pseudo-header. The value is the fully-qualified authority component of the request, comprised of the host and, optionally, port of the request target, as a string.
The component value <span class="bcp14">MUST</span> be normalized according to the rules in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-4.2.3" class="relref">Section 4.2.3</a></span>. Namely, the host name is normalized to lowercase and the default port is omitted.
If used, the <code>@authority</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.2.4-2">For example, the following request message:<a href="#section-2.2.4-2" class="pilcrow">¶</a></p>
<div id="section-2.2.4-3">
<pre class="lang-http-message sourcecode">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.4-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.4-4">Would result in the following <code>@authority</code> component value:<a href="#section-2.2.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.4-5">
<pre>
"@authority": www.example.com
</pre><a href="#section-2.2.4-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.4-6">If used in a related-response, the <code>@authority</code> component identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-scheme">
<section id="section-2.2.5">
          <h4 id="name-scheme">
<a href="#section-2.2.5" class="section-number selfRef">2.2.5. </a><a href="#name-scheme" class="section-name selfRef">Scheme</a>
          </h4>
<p id="section-2.2.5-1">The <code>@scheme</code> component identifier refers to the scheme of the target URL of the HTTP request message. The component value is the scheme as a string as defined in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-4.2" class="relref">Section 4.2</a></span>.
While the scheme itself is case-insensitive, it <span class="bcp14">MUST</span> be normalized to lowercase for
inclusion in the signature input string.
If used, the <code>@scheme</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.2.5-2">For example, the following request message requested over plain HTTP:<a href="#section-2.2.5-2" class="pilcrow">¶</a></p>
<div id="section-2.2.5-3">
<pre class="lang-http-message sourcecode">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.5-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.5-4">Would result in the following <code>@scheme</code> value:<a href="#section-2.2.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-5">
<pre>
"@scheme": http
</pre><a href="#section-2.2.5-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.5-6">If used in a related-response, the <code>@scheme</code> component identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-target">
<section id="section-2.2.6">
          <h4 id="name-request-target">
<a href="#section-2.2.6" class="section-number selfRef">2.2.6. </a><a href="#name-request-target" class="section-name selfRef">Request Target</a>
          </h4>
<p id="section-2.2.6-1">The <code>@request-target</code> component identifier refers to the full request target of the HTTP request message,
as defined in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-7.1" class="relref">Section 7.1</a></span>. The component value of the request target can take different forms,
depending on the type of request, as described below.
If used, the <code>@request-target</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.2.6-2">For HTTP 1.1, the component value is equivalent to the request target
portion of the request line. However, this value is more difficult to reliably construct in
other versions of HTTP. Therefore, it is <span class="bcp14">NOT RECOMMENDED</span> that this identifier be used
when versions of HTTP other than 1.1 might be in use.<a href="#section-2.2.6-2" class="pilcrow">¶</a></p>
<p id="section-2.2.6-3">The origin form value is combination of the absolute path and query components of the request URL. For example, the following request message:<a href="#section-2.2.6-3" class="pilcrow">¶</a></p>
<div id="section-2.2.6-4">
<pre class="lang-http-message sourcecode">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.6-4" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-5">Would result in the following <code>@request-target</code> component value:<a href="#section-2.2.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.6-6">
<pre>
"@request-target": /path?param=value
</pre><a href="#section-2.2.6-6" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-7">The following request to an HTTP proxy with the absolute-form value, containing the fully qualified target URI:<a href="#section-2.2.6-7" class="pilcrow">¶</a></p>
<div id="section-2.2.6-8">
<pre class="lang-http-message sourcecode">
GET https://www.example.com/path?param=value HTTP/1.1
</pre><a href="#section-2.2.6-8" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-9">Would result in the following <code>@request-target</code> component value:<a href="#section-2.2.6-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.6-10">
<pre>
"@request-target": https://www.example.com/path?param=value
</pre><a href="#section-2.2.6-10" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-11">The following CONNECT request with an authority-form value, containing the host and port of the target:<a href="#section-2.2.6-11" class="pilcrow">¶</a></p>
<div id="section-2.2.6-12">
<pre class="lang-http-message sourcecode">
CONNECT www.example.com:80 HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.6-12" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-13">Would result in the following <code>@request-target</code> component value:<a href="#section-2.2.6-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.6-14">
<pre>
"@request-target": www.example.com:80
</pre><a href="#section-2.2.6-14" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-15">The following OPTIONS request message with the asterisk-form value, containing a single asterisk <code>*</code> character:<a href="#section-2.2.6-15" class="pilcrow">¶</a></p>
<div id="section-2.2.6-16">
<pre class="lang-http-message sourcecode">
OPTIONS * HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.6-16" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-17">Would result in the following <code>@request-target</code> component value:<a href="#section-2.2.6-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.6-18">
<pre>
"@request-target": *
</pre><a href="#section-2.2.6-18" class="pilcrow">¶</a>
</div>
<p id="section-2.2.6-19">If used in a related-response, the <code>@request-target</code> component identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.6-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-path">
<section id="section-2.2.7">
          <h4 id="name-path">
<a href="#section-2.2.7" class="section-number selfRef">2.2.7. </a><a href="#name-path" class="section-name selfRef">Path</a>
          </h4>
<p id="section-2.2.7-1">The <code>@path</code> component identifier refers to the target path of the HTTP request message. The component value is the absolute path of the request target defined by <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>, with no query component and no trailing <code>?</code> character. The value is normalized according to the rules in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-4.2.3" class="relref">Section 4.2.3</a></span>. Namely, an empty path string is normalized as a single slash <code>/</code> character, and path components are represented by their values after decoding any percent-encoded octets.
If used, the <code>@path</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.7-1" class="pilcrow">¶</a></p>
<p id="section-2.2.7-2">For example, the following request message:<a href="#section-2.2.7-2" class="pilcrow">¶</a></p>
<div id="section-2.2.7-3">
<pre class="lang-http-message sourcecode">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.7-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.7-4">Would result in the following <code>@path</code> value:<a href="#section-2.2.7-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.7-5">
<pre>
"@path": /path
</pre><a href="#section-2.2.7-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.7-6">If used in a related-response, the <code>@path</code> identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-query">
<section id="section-2.2.8">
          <h4 id="name-query">
<a href="#section-2.2.8" class="section-number selfRef">2.2.8. </a><a href="#name-query" class="section-name selfRef">Query</a>
          </h4>
<p id="section-2.2.8-1">The <code>@query</code> component identifier refers to the query component of the HTTP request message. The component value is the entire normalized query string defined by <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>, including the leading <code>?</code> character. The value is normalized according to the rules in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-4.2.3" class="relref">Section 4.2.3</a></span>. Namely, percent-encoded octets are decoded.
If used, the <code>@query</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.8-1" class="pilcrow">¶</a></p>
<p id="section-2.2.8-2">For example, the following request message:<a href="#section-2.2.8-2" class="pilcrow">¶</a></p>
<div id="section-2.2.8-3">
<pre class="lang-http-message sourcecode">
POST /path?param=value&amp;foo=bar&amp;baz=batman HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.8-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.8-4">Would result in the following <code>@query</code> value:<a href="#section-2.2.8-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.8-5">
<pre>
"@query": ?param=value&amp;foo=bar&amp;baz=batman
</pre><a href="#section-2.2.8-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.8-6">The following request message:<a href="#section-2.2.8-6" class="pilcrow">¶</a></p>
<div id="section-2.2.8-7">
<pre class="lang-http-message sourcecode">
POST /path?queryString HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.8-7" class="pilcrow">¶</a>
</div>
<p id="section-2.2.8-8">Would result in the following <code>@query</code> value:<a href="#section-2.2.8-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.8-9">
<pre>
"@query": ?queryString
</pre><a href="#section-2.2.8-9" class="pilcrow">¶</a>
</div>
<p id="section-2.2.8-10">If used in a related-response, the <code>@query</code> component identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.8-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-query-params">
<section id="section-2.2.9">
          <h4 id="name-query-parameters">
<a href="#section-2.2.9" class="section-number selfRef">2.2.9. </a><a href="#name-query-parameters" class="section-name selfRef">Query Parameters</a>
          </h4>
<p id="section-2.2.9-1">If a request target URI uses HTML form parameters in the query string as defined in <span><a href="#HTMLURL" class="xref">HTMLURL, Section 5</a> [<a href="#HTMLURL" class="xref">HTMLURL</a>]</span>,
the <code>@query-params</code> component identifier allows addressing of individual query parameters. The query parameters <span class="bcp14">MUST</span> be parsed according to <span><a href="#HTMLURL" class="xref">HTMLURL, Section 5.1</a> [<a href="#HTMLURL" class="xref">HTMLURL</a>]</span>, resulting in a list of (<code>nameString</code>, <code>valueString</code>) tuples.
The <span class="bcp14">REQUIRED</span> <code>name</code> parameter of each input identifier contains the <code>nameString</code> of a single query parameter as an <code>sf-string</code> value.
Several different named query parameters <span class="bcp14">MAY</span> be included in the covered components.
Single named parameters <span class="bcp14">MAY</span> occur in any order in the covered components.<a href="#section-2.2.9-1" class="pilcrow">¶</a></p>
<p id="section-2.2.9-2">The component value of a single named parameter is the the <code>valueString</code> of the named query parameter defined by <span><a href="#HTMLURL" class="xref">HTMLURL, Section 5.1</a> [<a href="#HTMLURL" class="xref">HTMLURL</a>]</span>, which is the value after percent-encoded octets are decoded.
Note that this value does not include any leading <code>?</code> characters, equals sign <code>=</code>, or separating <code>&amp;</code> characters.
Named query parameters with an empty <code>valueString</code> are included with an empty string as the component value.<a href="#section-2.2.9-2" class="pilcrow">¶</a></p>
<p id="section-2.2.9-3">If a parameter name occurs multiple times in a request, all parameter values of that name <span class="bcp14">MUST</span> be included
in separate signature input lines in the order in which the parameters occur in the target URI.<a href="#section-2.2.9-3" class="pilcrow">¶</a></p>
<p id="section-2.2.9-4">For example for the following request:<a href="#section-2.2.9-4" class="pilcrow">¶</a></p>
<div id="section-2.2.9-5">
<pre class="lang-http-message sourcecode">
POST /path?param=value&amp;foo=bar&amp;baz=batman&amp;qux= HTTP/1.1
Host: www.example.com
</pre><a href="#section-2.2.9-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.9-6">Indicating the <code>baz</code>, <code>qux</code> and <code>param</code> named query parameters in would result in the following <code>@query-param</code> value:<a href="#section-2.2.9-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.9-7">
<pre>
"@query-params";name="baz": batman
"@query-params";name="qux":
"@query-params";name="param": value
</pre><a href="#section-2.2.9-7" class="pilcrow">¶</a>
</div>
<p id="section-2.2.9-8">If used in a related-response, the <code>@query-params</code> component identifier refers to the associated component value of the request that triggered the response message being signed.<a href="#section-2.2.9-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-status-code">
<section id="section-2.2.10">
          <h4 id="name-status-code">
<a href="#section-2.2.10" class="section-number selfRef">2.2.10. </a><a href="#name-status-code" class="section-name selfRef">Status Code</a>
          </h4>
<p id="section-2.2.10-1">The <code>@status</code> component identifier refers to the three-digit numeric HTTP status code of a response message as defined in <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19#section-15" class="relref">Section 15</a></span>. The component value is the serialized three-digit integer of the HTTP response code, with no descriptive text.
If used, the <code>@status</code> component identifier <span class="bcp14">MUST</span> occur only once in the covered components.<a href="#section-2.2.10-1" class="pilcrow">¶</a></p>
<p id="section-2.2.10-2">For example, the following response message:<a href="#section-2.2.10-2" class="pilcrow">¶</a></p>
<div id="section-2.2.10-3">
<pre class="lang-http-message sourcecode">
HTTP/1.1 200 OK
Date: Fri, 26 Mar 2010 00:05:00 GMT
</pre><a href="#section-2.2.10-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.10-4">Would result in the following <code>@status</code> value:<a href="#section-2.2.10-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.10-5">
<pre>
"@status": 200
</pre><a href="#section-2.2.10-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.10-6">The <code>@status</code> component identifier <span class="bcp14">MUST NOT</span> be used in a request message.<a href="#section-2.2.10-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-request-response">
<section id="section-2.2.11">
          <h4 id="name-request-response-signature-">
<a href="#section-2.2.11" class="section-number selfRef">2.2.11. </a><a href="#name-request-response-signature-" class="section-name selfRef">Request-Response Signature Binding</a>
          </h4>
<p id="section-2.2.11-1">When a signed request message results in a signed response message, the <code>@request-response</code> component identifier can be used to cryptographically link the request and the response to each other by including the identified request signature value in the response's signature input without copying the value of the request's signature to the response directly. This component identifier has a single <span class="bcp14">REQUIRED</span> parameter:<a href="#section-2.2.11-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2.11-2">
            <dt id="section-2.2.11-2.1">
<code>key</code>  </dt>
            <dd style="margin-left: 1.5em" id="section-2.2.11-2.2">
              <p id="section-2.2.11-2.2.1">Identifies which signature from the response to sign.<a href="#section-2.2.11-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-2.2.11-3">The component value is the <code>sf-binary</code> representation of the signature value of the referenced request identified by the <code>key</code> parameter.<a href="#section-2.2.11-3" class="pilcrow">¶</a></p>
<p id="section-2.2.11-4">For example, when serving this signed request:<a href="#section-2.2.11-4" class="pilcrow">¶</a></p>
<div id="section-2.2.11-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884475;keyid="test-key-rsa-pss"
Signature:  sig1=:LAH8BjcfcOcLojiuOBFWn0P5keD3xAOuJRGziCLuD8r5MW9S0\
  RoXXLzLSRfGY/3SF8kVIkHjE13SEFdTo4Af/fJ/Pu9wheqoLVdwXyY/UkBIS1M8Br\
  c8IODsn5DFIrG0IrburbLi0uCc+E2ZIIb6HbUJ+o+jP58JelMTe0QE3IpWINTEzpx\
  jqDf5/Df+InHCAkQCTuKsamjWXUpyOT1Wkxi7YPVNOjW4MfNuTZ9HdbD2Tr65+BXe\
  TG9ZS/9SWuXAc+BZ8WyPz0QRz//ec3uWXd7bYYODSjRAxHqX+S1ag3LZElYyUKaAI\
  jZ8MGOt4gXEwCSLDv/zqxZeWLj/PDkn6w==:

{"hello": "world"}
</pre><a href="#section-2.2.11-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.11-6">This would result in the following unsigned response message:<a href="#section-2.2.11-6" class="pilcrow">¶</a></p>
<div id="section-2.2.11-7">
<pre class="lang-http-message sourcecode">
HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62

{"busy": true, "message": "Your call is very important to us"}
</pre><a href="#section-2.2.11-7" class="pilcrow">¶</a>
</div>
<p id="section-2.2.11-8">To cryptographically link the response to the request, the server signs the response with its own key and includes the signature of <code>sig1</code> from the request in the covered components of the response. The signature input string for this example is:<a href="#section-2.2.11-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.11-9">
<pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 503
"content-length": 62
"content-type": application/json
"@request-response";key="sig1": :LAH8BjcfcOcLojiuOBFWn0P5keD3xAOuJR\
  GziCLuD8r5MW9S0RoXXLzLSRfGY/3SF8kVIkHjE13SEFdTo4Af/fJ/Pu9wheqoLVd\
  wXyY/UkBIS1M8Brc8IODsn5DFIrG0IrburbLi0uCc+E2ZIIb6HbUJ+o+jP58JelMT\
  e0QE3IpWINTEzpxjqDf5/Df+InHCAkQCTuKsamjWXUpyOT1Wkxi7YPVNOjW4MfNuT\
  Z9HdbD2Tr65+BXeTG9ZS/9SWuXAc+BZ8WyPz0QRz//ec3uWXd7bYYODSjRAxHqX+S\
  1ag3LZElYyUKaAIjZ8MGOt4gXEwCSLDv/zqxZeWLj/PDkn6w==:
"@signature-params": ("@status" "content-length" "content-type" \
  "@request-response";key="sig1");created=1618884479\
  ;keyid="test-key-ecc-p256"
</pre><a href="#section-2.2.11-9" class="pilcrow">¶</a>
</div>
<p id="section-2.2.11-10">The signed response message is:<a href="#section-2.2.11-10" class="pilcrow">¶</a></p>
<div id="section-2.2.11-11">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Signature-Input: reqres=("@status" "content-length" "content-type" \
  "@request-response";key="sig1");created=1618884479\
  ;keyid="test-key-ecc-p256"
Signature: reqres=:JqzXLIjNd6VWVg/M7enbjWkOgsPmIK9vcoFQEkLD0SXNbFjR\
  6d+olsof1dv7xC7ygF1q0YKjVrbV2QlCpDxrHg==:

{"busy": true, "message": "Your call is very important to us"}
</pre><a href="#section-2.2.11-11" class="pilcrow">¶</a>
</div>
<p id="section-2.2.11-12">Since the request's signature value itself is not repeated in the response, the requester <span class="bcp14">MUST</span> keep the original signature value around long enough to validate the signature of the response that uses this component identifier.<a href="#section-2.2.11-12" class="pilcrow">¶</a></p>
<p id="section-2.2.11-13">Note that the ECDSA algorithm in use here is non-deterministic, meaning a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly-generated signature values are not expected to match the example. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#section-2.2.11-13" class="pilcrow">¶</a></p>
<p id="section-2.2.11-14">The <code>@request-response</code> component identifier <span class="bcp14">MUST NOT</span> be used in a request message.<a href="#section-2.2.11-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="create-sig-input">
<section id="section-2.3">
        <h3 id="name-creating-the-signature-inpu">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-creating-the-signature-inpu" class="section-name selfRef">Creating the Signature Input String</a>
        </h3>
<p id="section-2.3-1">The signature input is a US-ASCII string containing the canonicalized HTTP message components covered by the signature. The input to the signature input creation algorithm is the list of covered component identifiers and their associated values, along with any additional signature parameters. The output is the signature input string, which has the following form:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="section-2.3-2">
<pre class="lang-abnf sourcecode">
signature-input = *( signature-input-line LF ) signature-params-line
signature-input-line = component-identifier ":" SP ( derived-component-value / field-value )
signature-params-line = DQUOTE "@signature-params" DQUOTE ":" SP inner-list
</pre><a href="#section-2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3-3">To create the signature input string, the signer or verifier concatenates together entries for each identifier in the signature's covered components (including their parameters) using the following algorithm:<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-4">
<li id="section-2.3-4.1">Let the output be an empty string.<a href="#section-2.3-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-4.2">
            <p id="section-2.3-4.2.1">For each message component item in the covered components set (in order):<a href="#section-2.3-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-4.2.2">
<li id="section-2.3-4.2.2.1">Append the component identifier for the covered component serialized according to the <code>component-identifier</code> rule. Note that this serialization places the component identifier in double quotes and appends any parameters outside of the quotes.<a href="#section-2.3-4.2.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-4.2.2.2">Append a single colon <code>:</code><a href="#section-2.3-4.2.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-4.2.2.3">Append a single space " "<a href="#section-2.3-4.2.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-4.2.2.4">
                <p id="section-2.3-4.2.2.4.1">Determine the component value for the component identifier.<a href="#section-2.3-4.2.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-4.2.2.4.2.1">If the component identifier starts with an "at" character (<code>@</code>), derive the component's value from the message according to the specific rules defined for the derived component identifier, as in <a href="#derived-components" class="xref">Section 2.2</a>. If the derived component identifier is unknown or the value cannot be derived, produce an error.<a href="#section-2.3-4.2.2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.3-4.2.2.4.2.2">If the component identifier does not start with an "at" character (<code>@</code>), canonicalize the HTTP field value as described in <a href="#http-header" class="xref">Section 2.1</a>. If the value cannot be calculated, produce an error.<a href="#section-2.3-4.2.2.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li id="section-2.3-4.2.2.5">Append the covered component's canonicalized component value.<a href="#section-2.3-4.2.2.5" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-4.2.2.6">Append a single newline <code>\n</code><a href="#section-2.3-4.2.2.6" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-2.3-4.3">
            <p id="section-2.3-4.3.1">Append the signature parameters component (<a href="#signature-params" class="xref">Section 2.2.1</a>) as follows:<a href="#section-2.3-4.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-4.3.2">
<li id="section-2.3-4.3.2.1">Append the component identifier for the signature parameters serialized according to the <code>component-identifier</code> rule, i.e. <code>"@signature-params"</code><a href="#section-2.3-4.3.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-4.3.2.2">Append a single colon <code>:</code><a href="#section-2.3-4.3.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-4.3.2.3">Append a single space " "<a href="#section-2.3-4.3.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-2.3-4.3.2.4">Append the signature parameters' canonicalized component value as defined in <a href="#signature-params" class="xref">Section 2.2.1</a><a href="#section-2.3-4.3.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-2.3-4.4">Return the output string.<a href="#section-2.3-4.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.3-5">If covered components reference a component identifier that cannot be resolved to a component value in the message, the implementation <span class="bcp14">MUST</span> produce an error and not create an input string. Such situations are included but not limited to:<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-6.1">The signer or verifier does not understand the derived component identifier.<a href="#section-2.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-6.2">The component identifier identifies a field that is not present in the message or whose value is malformed.<a href="#section-2.3-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-6.3">The component identifier indicates that a structured field serialization is used (via the <code>sf</code> parameter), but the field in question is known to not be a structured field or the type of structured field is not known to the implementation.<a href="#section-2.3-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-6.4">The component identifier is a dictionary member identifier that references a field that is not present in the message, is not a Dictionary Structured Field, or whose value is malformed.<a href="#section-2.3-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-6.5">The component identifier is a dictionary member identifier or a named query parameter identifier that references a member that is not present in the component value, or whose value is malformed. E.g., the identifier is <code>"example-dictionary";key="c"</code> and the value of the <code>Example-Dictionary</code> header field is <code>a=1, b=2</code>, which does not have the <code>c</code> value.<a href="#section-2.3-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-7">In the following non-normative example, the HTTP message being signed is the following request:<a href="#section-2.3-7" class="pilcrow">¶</a></p>
<div id="section-2.3-8">
<pre class="lang-http-message sourcecode">
POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre><a href="#section-2.3-8" class="pilcrow">¶</a>
</div>
<p id="section-2.3-9">The covered components consist of the <code>@method</code>, <code>@path</code>, and <code>@authority</code> derived component identifiers followed by the <code>Content-Digest</code>, <code>Content-Length</code>, and <code>Content-Type</code> HTTP header fields, in order. The signature parameters consist of a creation timestamp of <code>1618884473</code> and a key identifier of <code>test-key-rsa-pss</code>. Note that no explicit <code>alg</code> parameter is given here since the verifier is assumed by the application to correctly use the RSA PSS algorithm based on the identified key. The signature input string for this message with these parameters is:<a href="#section-2.3-9" class="pilcrow">¶</a></p>
<span id="name-non-normative-example-signa"></span><div id="example-sig-input">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.3-10.1">
<pre>
NOTE: '\' line wrapping per RFC 8792

"@method": POST
"@authority": example.com
"@path": /foo
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"content-type": application/json
"@signature-params": ("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-non-normative-example-signa" class="selfRef">Non-normative example Signature Input</a>
          </figcaption></figure>
</div>
<p id="section-2.3-11">Note that the example signature input here, or anywhere else within this specification, does not include the final newline that ends the example.<a href="#section-2.3-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message-signatures">
<section id="section-3">
      <h2 id="name-http-message-signatures">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-http-message-signatures" class="section-name selfRef">HTTP Message Signatures</a>
      </h2>
<p id="section-3-1">An HTTP Message Signature is a signature over a string generated from a subset of the components of an HTTP message in addition to metadata about the signature itself. When successfully verified against an HTTP message, an HTTP Message Signature provides cryptographic proof that the message is semantically equivalent to the message for which the signature was generated, with respect to the subset of message components that was signed.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sign">
<section id="section-3.1">
        <h3 id="name-creating-a-signature">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-creating-a-signature" class="section-name selfRef">Creating a Signature</a>
        </h3>
<p id="section-3.1-1">Creation of an HTTP message signature is a process that takes as its input the message and the requirements for the application. The output is a signature value and set of signature parameters that can be applied to the message.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">In order to create a signature, a signer <span class="bcp14">MUST</span> follow the following algorithm:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-3">
<li id="section-3.1-3.1">The signer chooses an HTTP signature algorithm and key material for signing. The signer <span class="bcp14">MUST</span> choose key material that is appropriate
 for the signature's algorithm, and that conforms to any requirements defined by the algorithm, such as key size or format. The
 mechanism by which the signer chooses the algorithm and key material is out of scope for this document.<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.2">The signer sets the signature's creation time to the current time.<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.3">If applicable, the signer sets the signature's expiration time property to the time at which the signature is to expire. The expiration is a hint to the verifier, expressing the time at which the signer is no longer willing to vouch for the safety of the signature.<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.4">
            <p id="section-3.1-3.4.1">The signer creates an ordered set of component identifiers representing the message components to be covered by the signature, and attaches signature metadata parameters to this set. The serialized value of this is later used as the value of the <code>Signature-Input</code> field as described in <a href="#signature-input-header" class="xref">Section 4.1</a>.<a href="#section-3.1-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.4.2.1">Once an order of covered components is chosen, the order <span class="bcp14">MUST NOT</span> change for the life of the signature.<a href="#section-3.1-3.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.2">Each covered component identifier <span class="bcp14">MUST</span> be either an HTTP field in the message <a href="#http-header" class="xref">Section 2.1</a> or a derived component identifier listed in <a href="#derived-components" class="xref">Section 2.2</a> or its associated registry.<a href="#section-3.1-3.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.3">Signers of a request <span class="bcp14">SHOULD</span> include some or all of the message control data in the covered components, such as the <code>@method</code>, <code>@authority</code>, <code>@target-uri</code>, or some combination thereof.<a href="#section-3.1-3.4.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.4">Signers <span class="bcp14">SHOULD</span> include the <code>created</code> signature metadata parameter to indicate when the signature was created.<a href="#section-3.1-3.4.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.5">The <code>@signature-params</code> derived component identifier is not explicitly listed in the list of covered component identifiers, because it is required to always be present as the last line in the signature input. This ensures that a signature always covers its own metadata.<a href="#section-3.1-3.4.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.6">Further guidance on what to include in this set and in what order is out of scope for this document.<a href="#section-3.1-3.4.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.1-3.5">The signer creates the signature input string based on these signature parameters. (<a href="#create-sig-input" class="xref">Section 2.3</a>)<a href="#section-3.1-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.6">The signer uses the <code>HTTP_SIGN</code> function to sign the signature input with the chosen signing algorithm using the key material chosen by the signer. The <code>HTTP_SIGN</code> primitive and several concrete signing algorithms are defined in in <a href="#signature-methods" class="xref">Section 3.3</a>.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.7">The byte array output of the signature function is the HTTP message signature output value to be included in the <code>Signature</code> field as defined in <a href="#signature-header" class="xref">Section 4.2</a>.<a href="#section-3.1-3.7" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.1-4">For example, given the HTTP message and signature parameters in the example in <a href="#create-sig-input" class="xref">Section 2.3</a>, the example signature input string is signed with the <code>test-key-rsa-pss</code> key in <a href="#example-key-rsa-pss-test" class="xref">Appendix B.1.2</a> and the RSA PSS algorithm described in <a href="#method-rsa-pss-sha512" class="xref">Section 3.3.1</a>, giving the following message signature output value, encoded in Base64:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<span id="name-non-normative-example-signat"></span><div id="example-sig-value">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.1-5.1">
<pre>
NOTE: '\' line wrapping per RFC 8792

HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrlFrCGUDih47vAxi4L2\
YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxHLMCy8uqK488o+9jrptQ\
+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSfSvzPuBCh+ARHBmWuNo1Uz\
VVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y9TP5FsZYzHvDqbInkTNigBc\
E9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7aXq6Am6sfOrpIC49yXjj3ae6H\
RalVc/g==
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-non-normative-example-signat" class="selfRef">Non-normative example signature value</a>
          </figcaption></figure>
</div>
<p id="section-3.1-6">Note that the RSA PSS algorithm in use here is non-deterministic, meaning a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly-generated signature values are not expected to match the example. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-3.2">
        <h3 id="name-verifying-a-signature">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-verifying-a-signature" class="section-name selfRef">Verifying a Signature</a>
        </h3>
<p id="section-3.2-1">Verification of an HTTP message signature is a process that takes as its input the message (including <code>Signature</code> and <code>Signature-Input</code> fields) and the requirements for the application. The output of the verification is either a positive verification or an error.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In order to verify a signature, a verifier <span class="bcp14">MUST</span> follow the following algorithm:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3">
<li id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">Parse the <code>Signature</code> and <code>Signature-Input</code> fields as described in <a href="#signature-input-header" class="xref">Section 4.1</a> and <a href="#signature-header" class="xref">Section 4.2</a>, and extract the signatures to be verified.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3.1.2">
<li id="section-3.2-3.1.2.1">If there is more than one signature value present, determine which signature should be processed
 for this message based on the policy and configuration of the verifier. If an applicable signature is not found, produce an error.<a href="#section-3.2-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.1.2.2">If the chosen <code>Signature</code> value does not have a corresponding <code>Signature-Input</code> value,
 produce an error.<a href="#section-3.2-3.1.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-3.2-3.2">Parse the values of the chosen <code>Signature-Input</code> field as a parameterized structured field inner list item (<code>inner-list</code>) to get the signature parameters for the
 signature to be verified.<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.3">Parse the value of the corresponding <code>Signature</code> field to get the byte array value of the signature
 to be verified.<a href="#section-3.2-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.4">Examine the signature parameters to confirm that the signature meets the requirements described
 in this document, as well as any additional requirements defined by the application such as which
 message components are required to be covered by the signature. (<a href="#verify-requirements" class="xref">Section 3.2.1</a>)<a href="#section-3.2-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.5">Determine the verification key material for this signature. If the key material is known through external
 means such as static configuration or external protocol negotiation, the verifier will use that. If the key is
 identified in the signature parameters, the verifier will dereference this to appropriate key material to use
 with the signature. The verifier has to determine the trustworthiness of the key material for the context
 in which the signature is presented. If a key is identified that the verifier does not know, does
 not trust for this request, or does not match something preconfigured, the verification <span class="bcp14">MUST</span> fail.<a href="#section-3.2-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">Determine the algorithm to apply for verification:<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3.6.2">
<li id="section-3.2-3.6.2.1">If the algorithm is known through external means such as static configuration or external protocol
 negotiation, the verifier will use this algorithm.<a href="#section-3.2-3.6.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.6.2.2">If the algorithm is explicitly stated in the signature parameters using a value from the
 HTTP Message Signatures registry, the verifier will use the referenced algorithm.<a href="#section-3.2-3.6.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.6.2.3">If the algorithm can be determined from the keying material, such as through an algorithm field
 on the key value itself, the verifier will use this algorithm.<a href="#section-3.2-3.6.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.6.2.4">If the algorithm is specified in more that one location, such as through static configuration
 and the algorithm signature parameter, or the algorithm signature parameter and from
 the key material itself, the resolved algorithms <span class="bcp14">MUST</span> be the same. If the algorithms are
 not the same, the verifier <span class="bcp14">MUST</span> vail the verification.<a href="#section-3.2-3.6.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-3.2-3.7">Use the received HTTP message and the signature's metadata to recreate the signature input, using
 the process described in <a href="#create-sig-input" class="xref">Section 2.3</a>. The value of the <code>@signature-params</code> input is
 the value of the <code>Signature-Input</code> field for this signature serialized according to the rules described
 in <a href="#signature-params" class="xref">Section 2.2.1</a>, not including the signature's label from the <code>Signature-Input</code> field.<a href="#section-3.2-3.7" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.8">If the key material is appropriate for the algorithm, apply the appropriate <code>HTTP_VERIFY</code> cryptographic verification algorithm to the signature,
 recalculated signature input, key material, signature value. The <code>HTTP_VERIFY</code> primitive and several concrete algorithms are defined in
 <a href="#signature-methods" class="xref">Section 3.3</a>.<a href="#section-3.2-3.8" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.9">The results of the verification algorithm function are the final results of the cryptographic verification function.<a href="#section-3.2-3.9" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.2-4">If any of the above steps fail or produce an error, the signature validation fails.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">For example, verifying the signature with the key <code>sig1</code> of the following message with the <code>test-key-rsa-pss</code> key in <a href="#example-key-rsa-pss-test" class="xref">Appendix B.1.2</a> and the RSA PSS algorithm described in <a href="#method-rsa-pss-sha512" class="xref">Section 3.3.1</a>:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<div id="section-3.2-6">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig1=:HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrl\
  FrCGUDih47vAxi4L2YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxH\
  LMCy8uqK488o+9jrptQ+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSf\
  SvzPuBCh+ARHBmWuNo1UzVVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y\
  9TP5FsZYzHvDqbInkTNigBcE9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7\
  aXq6Am6sfOrpIC49yXjj3ae6HRalVc/g==:

{"hello": "world"}
</pre><a href="#section-3.2-6" class="pilcrow">¶</a>
</div>
<p id="section-3.2-7">With the additional requirements that at least the method, path, authority, and cache-control be signed, and that the signature creation timestamp is recent enough at the time of verification, the verification passes.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div id="verify-requirements">
<section id="section-3.2.1">
          <h4 id="name-enforcing-application-requi">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-enforcing-application-requi" class="section-name selfRef">Enforcing Application Requirements</a>
          </h4>
<p id="section-3.2.1-1">The verification requirements specified in this document are intended as a baseline set of restrictions that are generally applicable to all use cases.  Applications using HTTP Message Signatures <span class="bcp14">MAY</span> impose requirements above and beyond those specified by this document, as appropriate for their use case.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">Some non-normative examples of additional requirements an application might define are:<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">Requiring a specific set of header fields to be signed (e.g., <code>Authorization</code>, <code>Digest</code>).<a href="#section-3.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.2">Enforcing a maximum signature age from the time of the <code>created</code> time stamp.<a href="#section-3.2.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.3">Rejection of signatures past the expiration time in the <code>expires</code> time stamp. Note that the expiration time is a hint from the signer and that a verifier can always reject a signature ahead of its expiration time.<a href="#section-3.2.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.4">Prohibition of certain signature metadata parameters, such as runtime algorithm signaling with the <code>alg</code> parameter when the algorithm is determined from the key information.<a href="#section-3.2.1-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.5">Ensuring successful dereferencing of the <code>keyid</code> parameter to valid and appropriate key material.<a href="#section-3.2.1-3.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.6">Prohibiting the use of certain algorithms, or mandating the use of a specific algorithm.<a href="#section-3.2.1-3.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.7">Requiring keys to be of a certain size (e.g., 2048 bits vs. 1024 bits).<a href="#section-3.2.1-3.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.8">Enforcing uniqueness of a <code>nonce</code> value.<a href="#section-3.2.1-3.8" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.1-4">Application-specific requirements are expected and encouraged.  When an application defines additional requirements, it <span class="bcp14">MUST</span> enforce them during the signature verification process, and signature verification <span class="bcp14">MUST</span> fail if the signature does not conform to the application's requirements.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1-5">Applications <span class="bcp14">MUST</span> enforce the requirements defined in this document.  Regardless of use case, applications <span class="bcp14">MUST NOT</span> accept signatures that do not conform to these requirements.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-methods">
<section id="section-3.3">
        <h3 id="name-signature-algorithm-methods">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-signature-algorithm-methods" class="section-name selfRef">Signature Algorithm Methods</a>
        </h3>
<p id="section-3.3-1">HTTP Message signatures <span class="bcp14">MAY</span> use any cryptographic digital signature or MAC method that is appropriate for the key material,
environment, and needs of the signer and verifier.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Each signature algorithm method takes as its input the signature input string defined in <a href="#create-sig-input" class="xref">Section 2.3</a> as a byte array (<code>M</code>), the signing key material
(<code>Ks</code>), and outputs the signature output as a byte array (<code>S</code>):<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-3">
<pre>
HTTP_SIGN (M, Ks)  -&gt;  S
</pre><a href="#section-3.3-3" class="pilcrow">¶</a>
</div>
<p id="section-3.3-4">Each verification algorithm method takes as its input the recalculated signature input string defined in <a href="#create-sig-input" class="xref">Section 2.3</a> as a byte array (<code>M</code>), the verification key
material (<code>Kv</code>), and the presented signature to be verified as a byte array (<code>S</code>) and outputs the verification result (<code>V</code>) as a boolean:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-5">
<pre>
HTTP_VERIFY (M, Kv, S) -&gt; V
</pre><a href="#section-3.3-5" class="pilcrow">¶</a>
</div>
<p id="section-3.3-6">This section contains several common algorithm methods. The method to use can be communicated through the algorithm signature parameter
defined in <a href="#signature-params" class="xref">Section 2.2.1</a>, by reference to the key material, or through mutual agreement between the signer and verifier.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<div id="method-rsa-pss-sha512">
<section id="section-3.3.1">
          <h4 id="name-rsassa-pss-using-sha-512">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-rsassa-pss-using-sha-512" class="section-name selfRef">RSASSA-PSS using SHA-512</a>
          </h4>
<p id="section-3.3.1-1">To sign using this algorithm, the signer applies the <code>RSASSA-PSS-SIGN (K, M)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with the signer's private signing key (<code>K</code>) and
the signature input string (<code>M</code>) (<a href="#create-sig-input" class="xref">Section 2.3</a>).
The mask generation function is <code>MGF1</code> as specified in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with a hash function of SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>.
The salt length (<code>sLen</code>) is 64 bytes.
The hash function (<code>Hash</code>) SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create
the digest content to which the digital signature is applied.
The resulting signed content byte array (<code>S</code>) is the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">To verify using this algorithm, the verifier applies the <code>RSASSA-PSS-VERIFY ((n, e), M, S)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using the public key portion of the verification key material (<code>(n, e)</code>) and the signature input string (<code>M</code>) re-created as described in <a href="#verify" class="xref">Section 3.2</a>.
The mask generation function is <code>MGF1</code> as specified in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with a hash function of SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>.
The salt length (<code>sLen</code>) is 64 bytes.
The hash function (<code>Hash</code>) SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the verification function is applied.
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>.
The results of the verification function indicate if the signature presented is valid.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">Note that the output of RSA PSS algorithms are non-deterministic, and therefore it is not correct to re-calculate a new signature on the signature input and compare the results to an existing signature. Instead, the verification algorithm defined here needs to be used. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">Use of this algorithm can be indicated at runtime using the <code>rsa-pss-sha512</code> value for the <code>alg</code> signature parameter.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-rsa-v1_5-sha256">
<section id="section-3.3.2">
          <h4 id="name-rsassa-pkcs1-v1_5-using-sha">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-rsassa-pkcs1-v1_5-using-sha" class="section-name selfRef">RSASSA-PKCS1-v1_5 using SHA-256</a>
          </h4>
<p id="section-3.3.2-1">To sign using this algorithm, the signer applies the <code>RSASSA-PKCS1-V1_5-SIGN (K, M)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with the signer's private signing key (<code>K</code>) and
the signature input string (<code>M</code>) (<a href="#create-sig-input" class="xref">Section 2.3</a>).
The hash SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create
the digest content to which the digital signature is applied.
The resulting signed content byte array (<code>S</code>) is the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">To verify using this algorithm, the verifier applies the <code>RSASSA-PKCS1-V1_5-VERIFY ((n, e), M, S)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using the public key portion of the verification key material (<code>(n, e)</code>) and the signature input string (<code>M</code>) re-created as described in <a href="#verify" class="xref">Section 3.2</a>.
The hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the verification function is applied.
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>.
The results of the verification function are compared to the http message signature to determine if the signature presented is valid.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.2-3">Use of this algorithm can be indicated at runtime using the <code>rsa-v1_5-sha256</code> value for the <code>alg</code> signature parameter.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-hmac-sha256">
<section id="section-3.3.3">
          <h4 id="name-hmac-using-sha-256">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-hmac-using-sha-256" class="section-name selfRef">HMAC using SHA-256</a>
          </h4>
<p id="section-3.3.3-1">To sign and verify using this algorithm, the signer applies the <code>HMAC</code> function <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span> with the shared signing key (<code>K</code>) and
the signature input string (<code>text</code>) (<a href="#create-sig-input" class="xref">Section 2.3</a>).
The hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the HMAC is applied, giving the signature result.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">For signing, the resulting value is the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3.3-3">For verification, the verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>.
The output of the HMAC function is compared to the value of the HTTP message signature, and the results of the comparison determine the validity of the signature presented.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3.3-4">Use of this algorithm can be indicated at runtime using the <code>hmac-sha256</code> value for the <code>alg</code> signature parameter.<a href="#section-3.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-ecdsa-p256-sha256">
<section id="section-3.3.4">
          <h4 id="name-ecdsa-using-curve-p-256-dss">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-ecdsa-using-curve-p-256-dss" class="section-name selfRef">ECDSA using curve P-256 DSS and SHA-256</a>
          </h4>
<p id="section-3.3.4-1">To sign using this algorithm, the signer applies the <code>ECDSA</code> algorithm <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> using curve P-256 with the signer's private signing key and
the signature input string (<a href="#create-sig-input" class="xref">Section 2.3</a>).
The hash SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create
the digest content to which the digital signature is applied, (<code>M</code>).
The signature algorithm returns two integer values, <code>r</code> and <code>s</code>. These are both encoded in big-endian unsigned integers, zero-padded to 32-octets each. These encoded values are concatenated into a single 64-octet array consisting of the encoded value of <code>r</code> followed by the encoded value of <code>s</code>. The resulting concatenation of <code>(r, s)</code> is byte array of the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4-2">To verify using this algorithm, the verifier applies the <code>ECDSA</code> algorithm <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>  using the public key portion of the verification key material and the signature input string re-created as described in <a href="#verify" class="xref">Section 3.2</a>.
The hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the signature verification function is applied, (<code>M</code>).
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>. This value is a 64-octet array consisting of the encoded values of <code>r</code> and <code>s</code> concatenated in order. These are both encoded in big-endian unsigned integers, zero-padded to 32-octets each. The resulting signature value <code>(r, s)</code> is used as input to the signature verification function.
The results of the verification function indicate if the signature presented is valid.<a href="#section-3.3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.3.4-3">Note that the output of ECDSA algorithms are non-deterministic, and therefore it is not correct to re-calculate a new signature on the signature input and compare the results to an existing signature. Instead, the verification algorithm defined here needs to be used. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#section-3.3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.3.4-4">Use of this algorithm can be indicated at runtime using the <code>ecdsa-p256-sha256</code> value for the <code>alg</code> signature parameter.<a href="#section-3.3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-ed25519">
<section id="section-3.3.5">
          <h4 id="name-eddsa-using-curve-edwards25">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-eddsa-using-curve-edwards25" class="section-name selfRef">EdDSA using curve edwards25519</a>
          </h4>
<p id="section-3.3.5-1">To sign using this algorithm, the signer applies the <code>Ed25519</code> algorithm <span><a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.6" class="relref">Section 5.1.6</a> of [<a href="#RFC8032" class="xref">RFC8032</a>]</span> with the signer's private signing key and
the signature input string (<a href="#create-sig-input" class="xref">Section 2.3</a>).
The signature input string is taken as the input message (<code>M</code>) with no pre-hash function.
The signature is a 64-octet concatenation of <code>R</code> and <code>S</code> as specified in <span><a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.6" class="relref">Section 5.1.6</a> of [<a href="#RFC8032" class="xref">RFC8032</a>]</span>, and this is taken as a byte array for the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.5-2">To verify using this algorithm, the signer applies the <code>Ed25519</code> algorithm <span><a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.7" class="relref">Section 5.1.7</a> of [<a href="#RFC8032" class="xref">RFC8032</a>]</span> using the public key portion of the verification key material (<code>A</code>) and the signature input string re-created as described in <a href="#verify" class="xref">Section 3.2</a>.
The signature input string is taken as the input message (<code>M</code>) with no pre-hash function.
The signature to be verified is processed as the 64-octet concatenation of <code>R</code> and <code>S</code> as specified in <span><a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.7" class="relref">Section 5.1.7</a> of [<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
The results of the verification function indicate if the signature presented is valid.<a href="#section-3.3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.3.5-3">Use of this algorithm can be indicated at runtime using the <code>ed25519</code> value for the <code>alg</code> signature parameter.<a href="#section-3.3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-jose">
<section id="section-3.3.6">
          <h4 id="name-json-web-signature-jws-algo">
<a href="#section-3.3.6" class="section-number selfRef">3.3.6. </a><a href="#name-json-web-signature-jws-algo" class="section-name selfRef">JSON Web Signature (JWS) algorithms</a>
          </h4>
<p id="section-3.3.6-1">If the signing algorithm is a JOSE signing algorithm from the JSON Web Signature and Encryption Algorithms Registry established by <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span>, the
JWS algorithm definition determines the signature and hashing algorithms to apply for both signing and verification.<a href="#section-3.3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.3.6-2">For both signing and verification, the HTTP messages signature input string (<a href="#create-sig-input" class="xref">Section 2.3</a>) is used as the entire "JWS Signing Input".
The JOSE Header defined in <span>[<a href="#RFC7517" class="xref">RFC7517</a>]</span> is not used, and the signature input string is not first encoded in Base64 before applying the algorithm.
The output of the JWS signature is taken as a byte array prior to the Base64url encoding used in JOSE.<a href="#section-3.3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.3.6-3">The JWS algorithm <span class="bcp14">MUST NOT</span> be <code>none</code> and <span class="bcp14">MUST NOT</span> be any algorithm with a JOSE Implementation Requirement of <code>Prohibited</code>.<a href="#section-3.3.6-3" class="pilcrow">¶</a></p>
<p id="section-3.3.6-4">There is no use of the explicit <code>alg</code> signature parameter when using JOSE signing algorithms, as they can be signaled using JSON Web Keys or other mechanisms.<a href="#section-3.3.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="including-a-message-signature-in-a-message">
<section id="section-4">
      <h2 id="name-including-a-message-signatu">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-including-a-message-signatu" class="section-name selfRef">Including a Message Signature in a Message</a>
      </h2>
<p id="section-4-1">Message signatures can be included within an HTTP message via the <code>Signature-Input</code> and <code>Signature</code> HTTP fields, both defined within this specification. When attached to a message, an HTTP message signature is identified by a label. This label <span class="bcp14">MUST</span> be unique within a given HTTP message and <span class="bcp14">MUST</span> be used in both the <code>Signature-Input</code> and <code>Signature</code>. The label is chosen by the signer, except where a specific label is dictated by protocol negotiations.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">An HTTP message signature <span class="bcp14">MUST</span> use both fields containing the same labels:
the <code>Signature</code> HTTP field contains the signature value, while the <code>Signature-Input</code> HTTP field identifies the covered components and parameters that describe how the signature was generated. Each field contains labeled values and <span class="bcp14">MAY</span> contain multiple labeled values, where the labels determine the correlation between the <code>Signature</code> and <code>Signature-Input</code> fields.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="signature-input-header">
<section id="section-4.1">
        <h3 id="name-the-signature-input-http-fi">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-the-signature-input-http-fi" class="section-name selfRef">The 'Signature-Input' HTTP Field</a>
        </h3>
<p id="section-4.1-1">The <code>Signature-Input</code> HTTP field is a Dictionary Structured Field <span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span> containing the metadata for one or more message signatures generated from components within the HTTP message. Each member describes a single message signature. The member's name is an identifier that uniquely identifies the message signature within the context of the HTTP message. The member's value is the serialization of the covered components including all signature metadata parameters, using the serialization process defined in <a href="#signature-params" class="xref">Section 2.2.1</a>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="section-4.1-2">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig1=("@method" "@target-uri" "host" "date" \
  "cache-control");created=1618884475\
  ;keyid="test-key-rsa-pss"
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">To facilitate signature validation, the <code>Signature-Input</code> field value <span class="bcp14">MUST</span> contain the same serialized value used
in generating the signature input string's <code>@signature-params</code> value.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">The signer <span class="bcp14">MAY</span> include the <code>Signature-Input</code> field as a trailer to facilitate signing a message after its content has been processed by the signer. However, since intermediaries are allowed to drop trailers as per <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>, it is <span class="bcp14">RECOMMENDED</span> that the <code>Signature-Input</code> HTTP field be included only as a header to avoid signatures being inadvertently stripped from a message.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">Multiple <code>Signature-Input</code> fields <span class="bcp14">MAY</span> be included in a single HTTP message. The signature labels <span class="bcp14">MUST</span> be unique across all field values.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-header">
<section id="section-4.2">
        <h3 id="name-the-signature-http-field">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-the-signature-http-field" class="section-name selfRef">The 'Signature' HTTP Field</a>
        </h3>
<p id="section-4.2-1">The <code>Signature</code> HTTP field is a Dictionary Structured field <span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span> containing one or more message signatures generated from components within the HTTP message. Each member's name is a signature identifier that is present as a member name in the <code>Signature-Input</code> Structured field within the HTTP message. Each member's value is a Byte Sequence containing the signature value for the message signature identified by the member name. Any member in the <code>Signature</code> HTTP field that does not have a corresponding member in the HTTP message's <code>Signature-Input</code> HTTP field <span class="bcp14">MUST</span> be ignored.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="section-4.2-2">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature: sig1=:P0wLUszWQjoi54udOtydf9IWTfNhy+r53jGFj9XZuP4uKwxyJo\
  1RSHi+oEF1FuX6O29d+lbxwwBao1BAgadijW+7O/PyezlTnqAOVPWx9GlyntiCiHz\
  C87qmSQjvu1CFyFuWSjdGa3qLYYlNm7pVaJFalQiKWnUaqfT4LyttaXyoyZW84jS8\
  gyarxAiWI97mPXU+OVM64+HVBHmnEsS+lTeIsEQo36T3NFf2CujWARPQg53r58Rmp\
  Z+J9eKR2CD6IJQvacn5A4Ix5BUAVGqlyp8JYm+S/CWJi31PNUjRRCusCVRj05NrxA\
  BNFv3r5S9IXf2fYJK+eyW4AiGVMvMcOg==:
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">The signer <span class="bcp14">MAY</span> include the <code>Signature</code> field as a trailer to facilitate signing a message after its content has been processed by the signer. However, since intermediaries are allowed to drop trailers as per <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>, it is <span class="bcp14">RECOMMENDED</span> that the <code>Signature-Input</code> HTTP field be included only as a header to avoid signatures being inadvertently stripped from a message.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Multiple <code>Signature</code> fields <span class="bcp14">MAY</span> be included in a single HTTP message. The signature labels <span class="bcp14">MUST</span> be unique across all field values.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-multiple">
<section id="section-4.3">
        <h3 id="name-multiple-signatures">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-multiple-signatures" class="section-name selfRef">Multiple Signatures</a>
        </h3>
<p id="section-4.3-1">Multiple distinct signatures <span class="bcp14">MAY</span> be included in a single message. Each distinct signature <span class="bcp14">MUST</span> have a unique label. Since <code>Signature-Input</code> and <code>Signature</code> are both defined as Dictionary Structured fields, they can be used to include multiple signatures within the same HTTP message by using distinct signature labels. These multiple signatures could be added all by the same signer or could come from several different signers. For example, a signer may include multiple signatures signing the same message components with different keys or algorithms to support verifiers with different capabilities, or a reverse proxy may include information about the client in fields when forwarding the request to a service host, including a signature over the client's original signature values.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The following is a non-normative example starts with a signed request from the client. The proxy takes this request validates the client's signature.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div id="section-4.3-3">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884475;keyid="test-key-rsa-pss"
Signature:  sig1=:LAH8BjcfcOcLojiuOBFWn0P5keD3xAOuJRGziCLuD8r5MW9S0\
  RoXXLzLSRfGY/3SF8kVIkHjE13SEFdTo4Af/fJ/Pu9wheqoLVdwXyY/UkBIS1M8Br\
  c8IODsn5DFIrG0IrburbLi0uCc+E2ZIIb6HbUJ+o+jP58JelMTe0QE3IpWINTEzpx\
  jqDf5/Df+InHCAkQCTuKsamjWXUpyOT1Wkxi7YPVNOjW4MfNuTZ9HdbD2Tr65+BXe\
  TG9ZS/9SWuXAc+BZ8WyPz0QRz//ec3uWXd7bYYODSjRAxHqX+S1ag3LZElYyUKaAI\
  jZ8MGOt4gXEwCSLDv/zqxZeWLj/PDkn6w==:

{"hello": "world"}
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">The proxy then alters the message before forwarding it on to the origin server, changing the target host and adding the <code>Forwarded</code> header defined in <span>[<a href="#RFC7239" class="xref">RFC7239</a>]</span>.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div id="section-4.3-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Forwarded: for=192.0.2.123
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884475;keyid="test-key-rsa-pss"
Signature:  sig1=:LAH8BjcfcOcLojiuOBFWn0P5keD3xAOuJRGziCLuD8r5MW9S0\
  RoXXLzLSRfGY/3SF8kVIkHjE13SEFdTo4Af/fJ/Pu9wheqoLVdwXyY/UkBIS1M8Br\
  c8IODsn5DFIrG0IrburbLi0uCc+E2ZIIb6HbUJ+o+jP58JelMTe0QE3IpWINTEzpx\
  jqDf5/Df+InHCAkQCTuKsamjWXUpyOT1Wkxi7YPVNOjW4MfNuTZ9HdbD2Tr65+BXe\
  TG9ZS/9SWuXAc+BZ8WyPz0QRz//ec3uWXd7bYYODSjRAxHqX+S1ag3LZElYyUKaAI\
  jZ8MGOt4gXEwCSLDv/zqxZeWLj/PDkn6w==:

{"hello": "world"}
</pre><a href="#section-4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-4.3-6">The proxy includes the client's signature value under the label <code>sig1</code>, which the proxy signs in addition to the <code>Forwarded</code> header. Note that since the client's signature already covers the client's <code>Signature-Input</code> value for <code>sig1</code>, this value is transitively covered by the proxy's signature and need not be added explicitly. The proxy identifies its own key and algorithm and, in this example, includes an expiration for the signature to indicate to downstream systems that the proxy will not vouch for this signed message past this short time window. This results in a signature input string of:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-7">
<pre>
NOTE: '\' line wrapping per RFC 8792

"signature";key="sig1": :LAH8BjcfcOcLojiuOBFWn0P5keD3xAOuJRGziCLuD8\
  r5MW9S0RoXXLzLSRfGY/3SF8kVIkHjE13SEFdTo4Af/fJ/Pu9wheqoLVdwXyY/UkB\
  IS1M8Brc8IODsn5DFIrG0IrburbLi0uCc+E2ZIIb6HbUJ+o+jP58JelMTe0QE3IpW\
  INTEzpxjqDf5/Df+InHCAkQCTuKsamjWXUpyOT1Wkxi7YPVNOjW4MfNuTZ9HdbD2T\
  r65+BXeTG9ZS/9SWuXAc+BZ8WyPz0QRz//ec3uWXd7bYYODSjRAxHqX+S1ag3LZEl\
  YyUKaAIjZ8MGOt4gXEwCSLDv/zqxZeWLj/PDkn6w==:
"forwarded": for=192.0.2.123
"@signature-params": ("signature";key="sig1" "forwarded")\
  ;created=1618884480;expires=1618884540;keyid="test-key-rsa"\
  ;alg="rsa-v1_5-sha256"
</pre><a href="#section-4.3-7" class="pilcrow">¶</a>
</div>
<p id="section-4.3-8">And a signature output value of:<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-9">
<pre>
NOTE: '\' line wrapping per RFC 8792

G1WLTL4/9PGSKEQbSAMypZNk+I2dpLJ6qvl2JISahlP31OO/QEUd8/HdO2O7vYLi5k3\
JIiAK3UPK4U+kvJZyIUidsiXlzRI+Y2se3SGo0D8dLfhG95bKr6ukYXl60QHpsGRTfS\
iwdtvYKXGpKNrMlISJYd+oGrGRyI9gbCy0aFhc6I/okIMLeK4g9PgzpC3YTwhUQ98KI\
BNLWHgREfBgJxjPbxFlsgJ9ykPviLj8GKJ81HwsK3XM9P7WaS7fMGOt8h1kSqgkZQB9\
YqiIo+WhHvJa7iPy8QrYFKzx9BBEY6AwfStZAsXXz3LobZseyxsYcLJLs8rY0wVA9NP\
sxKrHGA==
</pre><a href="#section-4.3-9" class="pilcrow">¶</a>
</div>
<p id="section-4.3-10">These values are added to the HTTP request message by the proxy. The original signature is included under the identifier <code>sig1</code>, and the reverse proxy's signature is included under the label <code>proxy_sig</code>. The proxy uses the key <code>test-key-rsa</code> to create its signature using the <code>rsa-v1_5-sha256</code> signature algorithm, while the client's original signature was made using the key id of <code>test-key-rsa-pss</code> and an RSA PSS signature algorithm.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<div id="section-4.3-11">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Forwarded: for=192.0.2.123
Signature-Input: sig1=("@method" "@authority" "@path" \
    "content-digest" "content-length" "content-type")\
    ;created=1618884475;keyid="test-key-rsa-pss", \
  proxy_sig=("signature";key="sig1" "forwarded")\
    ;created=1618884480;expires=1618884540;keyid="test-key-rsa"\
    ;alg="rsa-v1_5-sha256"
Signature:  sig1=:LAH8BjcfcOcLojiuOBFWn0P5keD3xAOuJRGziCLuD8r5MW9S0\
    RoXXLzLSRfGY/3SF8kVIkHjE13SEFdTo4Af/fJ/Pu9wheqoLVdwXyY/UkBIS1M8\
    Brc8IODsn5DFIrG0IrburbLi0uCc+E2ZIIb6HbUJ+o+jP58JelMTe0QE3IpWINT\
    EzpxjqDf5/Df+InHCAkQCTuKsamjWXUpyOT1Wkxi7YPVNOjW4MfNuTZ9HdbD2Tr\
    65+BXeTG9ZS/9SWuXAc+BZ8WyPz0QRz//ec3uWXd7bYYODSjRAxHqX+S1ag3LZE\
    lYyUKaAIjZ8MGOt4gXEwCSLDv/zqxZeWLj/PDkn6w==:, \
  proxy_sig=:G1WLTL4/9PGSKEQbSAMypZNk+I2dpLJ6qvl2JISahlP31OO/QEUd8/\
    HdO2O7vYLi5k3JIiAK3UPK4U+kvJZyIUidsiXlzRI+Y2se3SGo0D8dLfhG95bKr\
    6ukYXl60QHpsGRTfSiwdtvYKXGpKNrMlISJYd+oGrGRyI9gbCy0aFhc6I/okIML\
    eK4g9PgzpC3YTwhUQ98KIBNLWHgREfBgJxjPbxFlsgJ9ykPviLj8GKJ81HwsK3X\
    M9P7WaS7fMGOt8h1kSqgkZQB9YqiIo+WhHvJa7iPy8QrYFKzx9BBEY6AwfStZAs\
    XXz3LobZseyxsYcLJLs8rY0wVA9NPsxKrHGA==:

{"hello": "world"}
</pre><a href="#section-4.3-11" class="pilcrow">¶</a>
</div>
<p id="section-4.3-12">The proxy's signature and the client's original signature can be verified independently for the same message, based on the needs of the application. Since the proxy's signature covers the client signature, the backend service fronted by the proxy can trust that the proxy has validated the incoming signature.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="requesting-signatures">
<section id="section-5">
      <h2 id="name-requesting-signatures">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-requesting-signatures" class="section-name selfRef">Requesting Signatures</a>
      </h2>
<p id="section-5-1">While a signer is free to attach a signature to a request or response without prompting, it is often desirable for a potential verifier to signal that it expects a signature from a potential signer using the <code>Accept-Signature</code> field.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The message to which the requested signature is applied is known as the "target message". When the <code>Accept-Signature</code> field is sent in an HTTP Request message, the field indicates that the client desires the server to sign the response using the identified parameters and the target message is the response to this request. All responses from resources that support such signature negotiation <span class="bcp14">SHOULD</span> either be uncacheable or contain a <code>Vary</code> header field that lists <code>Accept-Signature</code>, in order to prevent a cache from returning a response with a signature intended for a different request.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">When the <code>Accept-Signature</code> field is used in an HTTP Response message, the field indicates that the server desires the client to sign its next request to the server with the identified parameters, and the target message is the client's next request. The client can choose to also continue signing future requests to the same server in the same way.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The target message of an <code>Accept-Signature</code> field <span class="bcp14">MUST</span> include all labeled signatures indicated in the <code>Accept-Header</code> signature, each covering the same identified components of the <code>Accept-Signature</code> field.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The sender of an <code>Accept-Signature</code> field <span class="bcp14">MUST</span> include identifiers that are appropriate for the type of the target message. For example, if the target message is a response, the identifiers can not include the <code>@status</code> identifier.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="accept-signature-header">
<section id="section-5.1">
        <h3 id="name-the-accept-signature-field">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-the-accept-signature-field" class="section-name selfRef">The Accept-Signature Field</a>
        </h3>
<p id="section-5.1-1">The <code>Accept-Signature</code> HTTP header field is a Dictionary Structured field <span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span> containing the metadata for one or more requested message signatures to be generated from message components of the target HTTP message. Each member describes a single message signature. The member's name is an identifier that uniquely identifies the requested message signature within the context of the target HTTP message. The member's value is the serialization of the desired covered components of the target message, including any allowed signature metadata parameters, using the serialization process defined in <a href="#signature-params" class="xref">Section 2.2.1</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="section-5.1-2">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Accept-Signature: sig1=("@method" "@target-uri" "host" "date" \
  "cache-control")\
  ;keyid="test-key-rsa-pss"
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">The requested signature <span class="bcp14">MAY</span> include parameters, such as a desired algorithm or key identifier. These parameters <span class="bcp14">MUST NOT</span> include parameters that the signer is expected to generate, including the <code>created</code> and <code>nonce</code> parameters.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-an-accept-signature">
<section id="section-5.2">
        <h3 id="name-processing-an-accept-signat">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-processing-an-accept-signat" class="section-name selfRef">Processing an Accept-Signature</a>
        </h3>
<p id="section-5.2-1">The receiver of an <code>Accept-Signature</code> field fulfills that header as follows:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-2">
<li id="section-5.2-2.1">Parse the field value as a Dictionary<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">For each member of the dictionary:<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-2.2.2">
<li id="section-5.2-2.2.2.1">The name of the member is the label of the output signature as specified in <a href="#signature-input-header" class="xref">Section 4.1</a><a href="#section-5.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.2-2.2.2.2">Parse the value of the member to obtain the set of covered component identifiers<a href="#section-5.2-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-5.2-2.2.2.3">Process the requested parameters, such as the signing algorithm and key material. If any requested parameters cannot be fulfilled, or if the requested parameters conflict with those deemed appropriate to the target message, the process fails and returns an error.<a href="#section-5.2-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-5.2-2.2.2.4">Select any additional parameters necessary for completing the signature<a href="#section-5.2-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li id="section-5.2-2.2.2.5">Create the <code>Signature-Input</code> and <code>Signature</code> header values and associate them with the label<a href="#section-5.2-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.2-2.3">Optionally create any additional <code>Signature-Input</code> and <code>Signature</code> values, with unique labels not found in the <code>Accept-Signature</code> field<a href="#section-5.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.4">Combine all labeled <code>Signature-Input</code> and <code>Signature</code> values and attach both headers to the target message<a href="#section-5.2-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.2-3">Note that by this process, a signature applied to a target message <span class="bcp14">MUST</span> have the same label, <span class="bcp14">MUST</span> have the same set of covered component, and <span class="bcp14">MAY</span> have additional parameters. Also note that the target message <span class="bcp14">MAY</span> include additional signatures not specified by the <code>Accept-Signature</code> field.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">IANA is requested to create three registries and to populate those registries with initial values as described in this section.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="hsa-registry">
<section id="section-6.1">
        <h3 id="name-http-signature-algorithms-r">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-http-signature-algorithms-r" class="section-name selfRef">HTTP Signature Algorithms Registry</a>
        </h3>
<p id="section-6.1-1">This document defines HTTP Signature Algorithms, for which IANA is asked to create and maintain a new registry titled "HTTP Signature Algorithms".  Initial values for this registry are given in <a href="#iana-hsa-contents" class="xref">Section 6.1.2</a>.  Future assignments and modifications to existing assignment are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-hsa-template" class="xref">Section 6.1.1</a>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Algorithms referenced by algorithm identifiers have to be fully defined with all parameters fixed. Algorithm identifiers in this registry are to be interpreted as whole string values and not as a combination of parts. That is to say, it is expected that implementors understand <code>rsa-pss-sha512</code> as referring to one specific algorithm with its hash, mask, and salt values set as defined here. Implementors do not parse out the <code>rsa</code>, <code>pss</code>, and <code>sha512</code> portions of the identifier to determine parameters of the signing algorithm from the string.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Algorithms added to this registry <span class="bcp14">MUST NOT</span> be aliases for other entries in the registry.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div id="iana-hsa-template">
<section id="section-6.1.1">
          <h4 id="name-registration-template">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.1.1-1">
            <dt id="section-6.1.1-1.1">
Algorithm Name:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.2">
              <p id="section-6.1.1-1.2.1">An identifier for the HTTP Signature Algorithm. The name <span class="bcp14">MUST</span> be an ASCII string consisting only of lower-case characters (<code>"a"</code> - <code>"z"</code>), digits (<code>"0"</code> - <code>"9"</code>), and hyphens (<code>"-"</code>), and <span class="bcp14">SHOULD NOT</span> exceed 20 characters in length.  The identifier <span class="bcp14">MUST</span> be unique within the context of the registry.<a href="#section-6.1.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.3">
Status:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.4">
              <p id="section-6.1.1-1.4.1">A brief text description of the status of the algorithm.  The description <span class="bcp14">MUST</span> begin with one of "Active" or "Deprecated", and <span class="bcp14">MAY</span> provide further context or explanation as to the reason for the status.<a href="#section-6.1.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.5">
Description:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.6">
              <p id="section-6.1.1-1.6.1">A brief description of the algorithm used to sign the signature input string.<a href="#section-6.1.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.7">
Specification document(s):  </dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.8">
              <p id="section-6.1.1-1.8.1">Reference to the document(s) that specify the token endpoint
  authorization method, preferably including a URI that can be used
  to retrieve a copy of the document(s).  An indication of the
  relevant sections may also be included but is not required.<a href="#section-6.1.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-hsa-contents">
<section id="section-6.1.2">
          <h4 id="name-initial-contents">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-initial-contents" class="section-name selfRef">Initial Contents</a>
          </h4>
<table class="center" id="table-1">
            <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Algorithm Name</th>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
                <th class="text-left" rowspan="1" colspan="1">Specification document(s)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>rsa-pss-sha512</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">RSASSA-PSS using SHA-512</td>
                <td class="text-left" rowspan="1" colspan="1">[[This document]], <a href="#method-rsa-pss-sha512" class="xref">Section 3.3.1</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>rsa-v1_5-sha256</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">RSASSA-PKCS1-v1_5 using SHA-256</td>
                <td class="text-left" rowspan="1" colspan="1">[[This document]], <a href="#method-rsa-v1_5-sha256" class="xref">Section 3.3.2</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>hmac-sha256</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">HMAC using SHA-256</td>
                <td class="text-left" rowspan="1" colspan="1">[[This document]], <a href="#method-hmac-sha256" class="xref">Section 3.3.3</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ecdsa-p256-sha256</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">ECDSA using curve P-256 DSS and SHA-256</td>
                <td class="text-left" rowspan="1" colspan="1">[[This document]], <a href="#method-ecdsa-p256-sha256" class="xref">Section 3.3.4</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ed25519</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Edwards Curve DSA using curve edwards25519</td>
                <td class="text-left" rowspan="1" colspan="1">[[This document]], <a href="#method-ed25519" class="xref">Section 3.3.5</a>
</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="param-registry">
<section id="section-6.2">
        <h3 id="name-http-signature-metadata-par">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-http-signature-metadata-par" class="section-name selfRef">HTTP Signature Metadata Parameters Registry</a>
        </h3>
<p id="section-6.2-1">This document defines the signature parameters structure, the values of which may have parameters containing metadata about a message signature. IANA is asked to create and maintain a new registry titled "HTTP Signature Metadata Parameters" to record and maintain the set of parameters defined for use with member values in the signature parameters structure. Initial values for this registry are given in <a href="#iana-param-contents" class="xref">Section 6.2.2</a>.  Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-param-template" class="xref">Section 6.2.1</a>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="iana-param-template">
<section id="section-6.2.1">
          <h4 id="name-registration-template-2">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-registration-template-2" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.2.1-1">
            <dt id="section-6.2.1-1.1">
Name:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-1.2">
              <p id="section-6.2.1-1.2.1">An identifier for the HTTP signature metadata parameter. The name <span class="bcp14">MUST</span> be an ASCII string consisting only of lower-case characters (<code>"a"</code> - <code>"z"</code>), digits (<code>"0"</code> - <code>"9"</code>), and hyphens (<code>"-"</code>), and <span class="bcp14">SHOULD NOT</span> exceed 20 characters in length.  The identifier <span class="bcp14">MUST</span> be unique within the context of the registry.<a href="#section-6.2.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-1.3">
Description:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-1.4">
              <p id="section-6.2.1-1.4.1">A brief description of the metadata parameter and what it represents.<a href="#section-6.2.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-1.5">
Specification document(s):  </dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-1.6">
              <p id="section-6.2.1-1.6.1">Reference to the document(s) that specify the token endpoint
  authorization method, preferably including a URI that can be used
  to retrieve a copy of the document(s).  An indication of the
  relevant sections may also be included but is not required.<a href="#section-6.2.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-param-contents">
<section id="section-6.2.2">
          <h4 id="name-initial-contents-2">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-initial-contents-2" class="section-name selfRef">Initial Contents</a>
          </h4>
<p id="section-6.2.2-1">The table below contains the initial contents of the HTTP Signature Metadata Parameters Registry.  Each row in the table represents a distinct entry in the registry.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-htt"></span><table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-initial-contents-of-the-htt" class="selfRef">Initial contents of the HTTP Signature Metadata Parameters Registry.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
                <th class="text-left" rowspan="1" colspan="1">Specification document(s)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>alg</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Explicitly declared signature algorithm</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.2.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>created</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Timestamp of signature creation</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.2.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>expires</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Timestamp of proposed signature expiration</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.2.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>keyid</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Key identifier for the signing and verification keys used to create this signature</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.2.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>nonce</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">A single-use nonce value</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.2.1</a> of this document</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="content-registry">
<section id="section-6.3">
        <h3 id="name-http-signature-derived-comp">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-http-signature-derived-comp" class="section-name selfRef">HTTP Signature Derived Component Identifiers Registry</a>
        </h3>
<p id="section-6.3-1">This document defines a method for canonicalizing HTTP message components, including components that can be derived from the context of the HTTP message outside of the HTTP fields. These components are identified by a unique string, known as the component identifier. Component identifiers for derived components always start with the "@" (at) symbol to distinguish them from HTTP header fields. IANA is asked to create and maintain a new registry typed "HTTP Signature Derived Component Identifiers" to record and maintain the set of non-field component identifiers and the methods to produce their associated component values. Initial values for this registry are given in <a href="#iana-content-contents" class="xref">Section 6.3.2</a>.  Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-content-template" class="xref">Section 6.3.1</a>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="iana-content-template">
<section id="section-6.3.1">
          <h4 id="name-registration-template-3">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-registration-template-3" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.3.1-1">
            <dt id="section-6.3.1-1.1">
Identifier:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.3.1-1.2">
              <p id="section-6.3.1-1.2.1">An identifier for the HTTP derived component identifier. The name <span class="bcp14">MUST</span> begin with the <code>"@"</code> character followed by an ASCII string consisting only of lower-case characters (<code>"a"</code> - <code>"z"</code>), digits (<code>"0"</code> - <code>"9"</code>), and hyphens (<code>"-"</code>), and <span class="bcp14">SHOULD NOT</span> exceed 20 characters in length.  The identifier <span class="bcp14">MUST</span> be unique within the context of the registry.<a href="#section-6.3.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-1.3">
Status:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.3.1-1.4">
              <p id="section-6.3.1-1.4.1">A brief text description of the status of the algorithm.  The description <span class="bcp14">MUST</span> begin with one of "Active" or "Deprecated", and <span class="bcp14">MAY</span> provide further context or explanation as to the reason for the status.<a href="#section-6.3.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-1.5">
Target:  </dt>
            <dd style="margin-left: 1.5em" id="section-6.3.1-1.6">
              <p id="section-6.3.1-1.6.1">The valid message targets for the derived parameter. <span class="bcp14">MUST</span> be one of the values "Request", "Request, Response", "Request, Related-Response", or "Related-Response". The semantics of these are defined in <a href="#derived-components" class="xref">Section 2.2</a>.<a href="#section-6.3.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-1.7">
Specification document(s):  </dt>
            <dd style="margin-left: 1.5em" id="section-6.3.1-1.8">
              <p id="section-6.3.1-1.8.1">Reference to the document(s) that specify the token endpoint
  authorization method, preferably including a URI that can be used
  to retrieve a copy of the document(s).  An indication of the
  relevant sections may also be included but is not required.<a href="#section-6.3.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-content-contents">
<section id="section-6.3.2">
          <h4 id="name-initial-contents-3">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-initial-contents-3" class="section-name selfRef">Initial Contents</a>
          </h4>
<p id="section-6.3.2-1">The table below contains the initial contents of the HTTP Signature Derived Component Identifiers Registry.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-http"></span><table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-initial-contents-of-the-http" class="selfRef">Initial contents of the HTTP Signature Derived Component Identifiers Registry.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Identifier</th>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Target</th>
                <th class="text-left" rowspan="1" colspan="1">Specification document(s)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@signature-params</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.2.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@method</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-method" class="xref">Section 2.2.2</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-authority" class="xref">Section 2.2.4</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@scheme</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-scheme" class="xref">Section 2.2.5</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@target-uri</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-target-uri" class="xref">Section 2.2.3</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@request-target</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-target" class="xref">Section 2.2.6</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@path</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-path" class="xref">Section 2.2.7</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@query</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-query" class="xref">Section 2.2.8</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@query-params</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Request, Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-query-params" class="xref">Section 2.2.9</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@status</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-status-code" class="xref">Section 2.2.10</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@request-response</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Related-Response</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-response" class="xref">Section 2.2.11</a> of this document</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">In order for an HTTP message to be considered covered by a signature, all of the following conditions have to be true:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">a signature is expected or allowed on the message by the verifier<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">the signature exists on the message<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.3">the signature is verified against the identified key material and algorithm<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.4">the key material and algorithm are appropriate for the context of the message<a href="#section-7-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.5">the signature is within expected time boundaries<a href="#section-7-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.6">the signature covers the expected content, including any critical components<a href="#section-7-2.6" class="pilcrow">¶</a>
</li>
      </ul>
<div id="security-ignore">
<section id="section-7.1">
        <h3 id="name-signature-verification-skip">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-signature-verification-skip" class="section-name selfRef">Signature Verification Skipping</a>
        </h3>
<p id="section-7.1-1">HTTP Message Signatures only provide security if the signature is verified by the verifier. Since the message to which the signature is attached remains a valid HTTP message without the signature fields, it is possible for a verifier to ignore the output of the verification function and still process the message. Common reasons for this could be relaxed requirements in a development environment or a temporary suspension of enforcing verification during debugging an overall system. Such temporary suspensions are difficult to detect under positive-example testing since a good signature will always trigger a valid response whether or not it has been checked.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">To detect this, verifiers should be tested using both valid and invalid signatures, ensuring that the invalid signature fails as expected.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-tls">
<section id="section-7.2">
        <h3 id="name-use-of-tls">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-use-of-tls" class="section-name selfRef">Use of TLS</a>
        </h3>
<p id="section-7.2-1">The use of HTTP Message Signatures does not negate the need for TLS or its equivalent to protect information in transit. Message signatures provide message integrity over the covered message components but do not provide any confidentiality for the communication between parties.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">TLS provides such confidentiality between the TLS endpoints. As part of this, TLS also protects the signature data itself from being captured by an attacker, which is an important step in preventing <span><a href="#security-replay" class="xref">signature replay</a> (<a href="#security-replay" class="xref">Section 7.3</a>)</span>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">When TLS is used, it needs to be deployed according to the recommendations in <span>[<a href="#BCP195" class="xref">BCP195</a>]</span>.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-replay">
<section id="section-7.3">
        <h3 id="name-signature-replay">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-signature-replay" class="section-name selfRef">Signature Replay</a>
        </h3>
<p id="section-7.3-1">Since HTTP Message Signatures allows sub-portions of the HTTP message to be signed, it is possible for two different HTTP messages to validate against the same signature. The most extreme form of this would be a signature over no message components. If such a signature were intercepted, it could be replayed at will by an attacker, attached to any HTTP message. Even with sufficient component coverage, a given signature could be applied to two similar HTTP messages, allowing a message to be replayed by an attacker with the signature intact.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">To counteract these kinds of attacks, it's first important for the signer to cover sufficient portions of the message to differentiate it from other messages. In addition, the signature can use the <code>nonce</code> signature parameter to provide a per-message unique value to allow the verifier to detect replay of the signature itself if a nonce value is repeated. Furthermore, the signer can provide a timestamp for when the signature was created and a time at which the signer considers the signature to be invalid, limiting the utility of a captured signature value.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">If a verifier wants to trigger a new signature from a signer, it can send the <code>Accept-Signature</code> header field with a new <code>nonce</code> parameter. An attacker that is simply replaying a signature would not be able to generate a new signature with the chosen nonce value.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-coverage">
<section id="section-7.4">
        <h3 id="name-insufficient-coverage">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-insufficient-coverage" class="section-name selfRef">Insufficient Coverage</a>
        </h3>
<p id="section-7.4-1">Any portions of the message not covered by the signature are susceptible to modification by an attacker without affecting the signature. An attacker can take advantage of this by introducing a header field or other message component that will change the processing of the message but will not be covered by the signature. Such an altered message would still pass signature verification, but when the verifier processes the message as a whole, the unsigned content injected by the attacker would subvert the trust conveyed by the valid signature and change the outcome of processing the message.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">To combat this, an application of this specification should require as much of the message as possible to be signed, within the limits of the application and deployment. The verifier should only trust message components that have been signed. Verifiers could also strip out any sensitive unsigned portions of the message before processing of the message continues.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-collision">
<section id="section-7.5">
        <h3 id="name-cryptography-and-signature-">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-cryptography-and-signature-" class="section-name selfRef">Cryptography and Signature Collision</a>
        </h3>
<p id="section-7.5-1">The HTTP Message Signatures specification does not define any of its own cryptographic primitives, and instead relies on other specifications to define such elements. If the signature algorithm or key used to process the signature input string is vulnerable to any attacks, the resulting signature will also be susceptible to these same attacks.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">A common attack against signature systems is to force a signature collision, where the same signature value successfully verifies against multiple different inputs. Since this specification relies on reconstruction of the input string based on an HTTP message, and the list of components signed is fixed in the signature, it is difficult but not impossible for an attacker to effect such a collision. An attacker would need to manipulate the HTTP message and its covered message components in order to make the collision effective.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">To counter this, only vetted keys and signature algorithms should be used to sign HTTP messages. The HTTP Message Signatures Algorithm Registry is one source of potential trusted algorithms.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4">While it is possible for an attacker to substitute the signature parameters value or the signature value separately, the <span><a href="#create-sig-input" class="xref">signature input generation algorithm</a> (<a href="#create-sig-input" class="xref">Section 2.3</a>)</span> always covers the signature parameters as the final value in the input string using a deterministic serialization method. This step strongly binds the signature input with the signature value in a way that makes it much more difficult for an attacker to perform a partial substitution on the signature inputs.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-keys">
<section id="section-7.6">
        <h3 id="name-key-theft">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-key-theft" class="section-name selfRef">Key Theft</a>
        </h3>
<p id="section-7.6-1">A foundational assumption of signature-based cryptographic systems is that the signing key is not compromised by an attacker. If the keys used to sign the message are exfiltrated or stolen, the attacker will be able to generate their own signatures using those keys. As a consequence, signers have to protect any signing key material from exfiltration, capture, and use by an attacker.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">To combat this, signers can rotate keys over time to limit the amount of time stolen keys are useful. Signers can also use key escrow and storage systems to limit the attack surface against keys. Furthermore, the use of asymmetric signing algorithms exposes key material less than the use of <span><a href="#security-symmetric" class="xref">symmetric signing algorithms</a> (<a href="#security-symmetric" class="xref">Section 7.11</a>)</span>.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-modify">
<section id="section-7.7">
        <h3 id="name-modification-of-required-me">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-modification-of-required-me" class="section-name selfRef">Modification of Required Message Parameters</a>
        </h3>
<p id="section-7.7-1">An attacker could effectively deny a service by modifying an otherwise benign signature parameter or signed message component. While rejecting a modified message is the desired behavior, consistently failing signatures could lead to the verifier turning off signature checking in order to make systems work again (see <a href="#security-ignore" class="xref">Section 7.1</a>).<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">If such failures are common within an application, the signer and verifier should compare their generated signature input strings with each other to determine which part of the message is being modified. However, the signer and verifier should not remove the requirement to sign the modified component when it is suspected an attacker is modifying the component.<a href="#section-7.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-mismatch">
<section id="section-7.8">
        <h3 id="name-mismatch-of-signature-param">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-mismatch-of-signature-param" class="section-name selfRef">Mismatch of Signature Parameters from Message</a>
        </h3>
<p id="section-7.8-1">The verifier needs to make sure that the signed message components match those in the message itself. This specification encourages this by requiring the verifier to derive these values from the message, but lazy cacheing or conveyance of the signature input string to a processing system could lead to downstream verifiers accepting a message that does not match the presented signature.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-multiple">
<section id="section-7.9">
        <h3 id="name-multiple-signature-confusio">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-multiple-signature-confusio" class="section-name selfRef">Multiple Signature Confusion</a>
        </h3>
<p id="section-7.9-1">Since <span><a href="#signature-multiple" class="xref">multiple signatures can be applied to one message</a> (<a href="#signature-multiple" class="xref">Section 4.3</a>)</span>, it is possible for an attacker to attach their own signature to a captured message without modifying existing signatures. This new signature could be completely valid based on the attacker's key, or it could be an invalid signature for any number of reasons. Each of these situations need to be accounted for.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
<p id="section-7.9-2">A verifier processing a set of valid signatures needs to account for all of the signers, identified by the signing keys. Only signatures from expected signers should be accepted, regardless of the cryptographic validity of the signature itself.<a href="#section-7.9-2" class="pilcrow">¶</a></p>
<p id="section-7.9-3">A verifier processing a set of signatures on a message also needs to determine what to do when one or more of the signatures are not valid. If a message is accepted when at least one signature is valid, then a verifier could drop all invalid signatures from the request before processing the message further. Alternatively, if the verifier rejects a message for a single invalid signature, an attacker could use this to deny service to otherwise valid messages by injecting invalid signatures alongside the valid ones.<a href="#section-7.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-labels">
<section id="section-7.10">
        <h3 id="name-signature-labels">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-signature-labels" class="section-name selfRef">Signature Labels</a>
        </h3>
<p id="section-7.10-1">HTTP Message Signature values are identified in the <code>Signature</code> and <code>Signature-Input</code> field values by unique labels. These labels are chosen only when attaching the signature values to the message and are not accounted for in the signing process. An intermediary adding its own signature is allowed to re-label an existing signature when processing the message.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
<p id="section-7.10-2">Therefore, applications should not rely on specific labels being present, and applications should not put semantic meaning on the labels themselves. Instead, additional signature parmeters can be used to convey whatever additional meaning is required to be attached to and covered by the signature.<a href="#section-7.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-symmetric">
<section id="section-7.11">
        <h3 id="name-symmetric-cryptography">
<a href="#section-7.11" class="section-number selfRef">7.11. </a><a href="#name-symmetric-cryptography" class="section-name selfRef">Symmetric Cryptography</a>
        </h3>
<p id="section-7.11-1">The HTTP Message Signatures specification allows for both asymmetric and symmetric cryptography to be applied to HTTP messages. By its nature, symmetric cryptographic methods require the same key material to be known by both the signer and verifier. This effectively means that a verifier is capable of generating a valid signature, since they have access to the same key material. An attacker that is able to compromise a verifier would be able to then impersonate a signer.<a href="#section-7.11-1" class="pilcrow">¶</a></p>
<p id="section-7.11-2">Where possible, asymmetric methods or secure key agreement mechanisms should be used in order to avoid this type of attack. When symmetric methods are used, distribution of the key material needs to be protected by the overall system. One technique for this is the use of separate cryptographic modules that separate the verification process (and therefore the key material) from other code, minimizing the vulnerable attack surface. Another technique is the use of key derivation functions that allow the signer and verifier to agree on unique keys for each message without having to share the key values directly.<a href="#section-7.11-2" class="pilcrow">¶</a></p>
<p id="section-7.11-3">Additionally, if symmetric algorithms are allowed within a system, special care must be taken to avoid <span><a href="#security-keydowngrade" class="xref">key downgrade attacks</a> (<a href="#security-keydowngrade" class="xref">Section 7.15</a>)</span>.<a href="#section-7.11-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-canonicalization">
<section id="section-7.12">
        <h3 id="name-canonicalization-attacks">
<a href="#section-7.12" class="section-number selfRef">7.12. </a><a href="#name-canonicalization-attacks" class="section-name selfRef">Canonicalization Attacks</a>
        </h3>
<p id="section-7.12-1">Any ambiguity in the generation of the signature input string could provide an attacker with leverage to substitute or break a signature on a message. Some message component values, particularly HTTP field values, are potentially susceptible to broken implementations that could lead to unexpected and insecure behavior. Naive implementations of this specification might implement HTTP field processing by taking the single value of a field and using it as the direct component value without processing it appropriately.<a href="#section-7.12-1" class="pilcrow">¶</a></p>
<p id="section-7.12-2">For example, if the handling of <code>obs-fold</code> field values does not remove the internal line folding and whitespace, additional newlines could be introduced into the signature input string by the signer, providing a potential place for an attacker to mount a <span><a href="#security-collision" class="xref">signature collision</a> (<a href="#security-collision" class="xref">Section 7.5</a>)</span> attack. Alternatively, if header fields that appear multiple times are not joined into a single string value, as is required by this specification, similar attacks can be mounted as a signed component value would show up in the input string more than once and could be substituted or otherwise attacked in this way.<a href="#section-7.12-2" class="pilcrow">¶</a></p>
<p id="section-7.12-3">To counter this, the entire field processing algorithm needs to be implemented by all implementations of signers and verifiers.<a href="#section-7.12-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-keymixup">
<section id="section-7.13">
        <h3 id="name-key-specification-mix-up">
<a href="#section-7.13" class="section-number selfRef">7.13. </a><a href="#name-key-specification-mix-up" class="section-name selfRef">Key Specification Mix-Up</a>
        </h3>
<p id="section-7.13-1">The existence of a valid signature on an HTTP message is not sufficient to prove that the message has been signed by the appropriate party. It is up to the verifier to ensure that a given key and algorithm are appropriate for the message in question. If the verifier does not perform such a step, an attacker could substitute their own signature using their own key on a message and force a verifier to accept and process it. To combat this, the verifier needs to ensure that not only does the signature validate for a message, but that the key and algorithm used are appropriate.<a href="#section-7.13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-versions">
<section id="section-7.14">
        <h3 id="name-http-versions-and-component">
<a href="#section-7.14" class="section-number selfRef">7.14. </a><a href="#name-http-versions-and-component" class="section-name selfRef">HTTP Versions and Component Ambiguity</a>
        </h3>
<p id="section-7.14-1">Some message components are expressed in different ways across HTTP versions. For example, the authority of the request target is sent using the <code>Host</code> header field in HTTP 1.1 but with the <code>:authority</code> pseudo-header in HTTP 2. If a signer sends an HTTP 1.1 message and signs the <code>Host</code> field, but the message is translated to HTTP 2 before it reaches the verifier, the signature will not validate as the <code>Host</code> header field could be dropped.<a href="#section-7.14-1" class="pilcrow">¶</a></p>
<p id="section-7.14-2">It is for this reason that HTTP Message Signatures defines a set of derived components that define a single way to get value in question, such as the <code>@authority</code> derived component identifier (<a href="#content-request-authority" class="xref">Section 2.2.4</a>) in lieu of the <code>Host</code> header field. Applications should therefore prefer derived component identifiers for such options where possible.<a href="#section-7.14-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-keydowngrade">
<section id="section-7.15">
        <h3 id="name-key-and-algorithm-specifica">
<a href="#section-7.15" class="section-number selfRef">7.15. </a><a href="#name-key-and-algorithm-specifica" class="section-name selfRef">Key and Algorithm Specification Downgrades</a>
        </h3>
<p id="section-7.15-1">Applications of this specification need to protect against key specification downgrade attacks. For example, the same RSA key can be used for both RSA-PSS and RSA v1.5 signatures. If an application expects a key to only be used with RSA-PSS, it needs to reject signatures for that key using the weaker RSA 1.5 specification.<a href="#section-7.15-1" class="pilcrow">¶</a></p>
<p id="section-7.15-2">Another example of a downgrade attack occurs when an asymmetric algorithm is expected, such as RSA-PSS, but an attacker substitutes a signature using symmetric algorithm, such as HMAC. A naive verifier implementation could use the value of the public RSA key as the input to the HMAC verification function. Since the public key is known to the attacker, this would allow the attacker to create a valid HMAC signature against this known key. To prevent this, the verifier needs to ensure that both the key material and the algorithm are appropriate for the usage in question. Additionally, while this specification does allow runtime specification of the algorithm using the <code>alg</code> signature parameter, applications are encouraged to use other mechanisms such as static configuration or higher protocol-level algorithm specification instead.<a href="#section-7.15-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-structured">
<section id="section-7.16">
        <h3 id="name-parsing-structured-field-va">
<a href="#section-7.16" class="section-number selfRef">7.16. </a><a href="#name-parsing-structured-field-va" class="section-name selfRef">Parsing Structured Field Values</a>
        </h3>
<p id="section-7.16-1">Several parts of this specification rely on the parsing of structured field values <span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span>. In particular, <span><a href="#http-header-structured" class="xref">normalization of HTTP structured field values</a> (<a href="#http-header-structured" class="xref">Section 2.1.1</a>)</span>, <span><a href="#http-header-dictionary" class="xref">referencing members of a dictionary structured field</a> (<a href="#http-header-dictionary" class="xref">Section 2.1.2</a>)</span>, and processing the <code>@signature-input</code> value when <span><a href="#verify" class="xref">verifying a signature</a> (<a href="#verify" class="xref">Section 3.2</a>)</span>. While structured field values are designed to be relatively simple to parse, a naive or broken implementation of such a parser could lead to subtle attack surfaces being exposed in the implementation.<a href="#section-7.16-1" class="pilcrow">¶</a></p>
<p id="section-7.16-2">For example, if a buggy parser of the <code>@signature-input</code> value does not enforce proper closing of quotes around string values within the list of component identifiers, an attacker could take advantage of this and inject additional content into the signature input string through manipulating the <code>Signature-Input</code> field value on a message.<a href="#section-7.16-2" class="pilcrow">¶</a></p>
<p id="section-7.16-3">To counteract this, implementations should use fully compliant and trusted parsers for all structured field processing, both on the signer and verifier side.<a href="#section-7.16-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-components">
<section id="section-7.17">
        <h3 id="name-choosing-message-components">
<a href="#section-7.17" class="section-number selfRef">7.17. </a><a href="#name-choosing-message-components" class="section-name selfRef">Choosing Message Components</a>
        </h3>
<p id="section-7.17-1">Applications of HTTP Message Signatures need to decide which message components will be covered by the signature. Depending on the application, some components could be expected to be changed by intermediaries prior to the signature's verification. If these components are covered, such changes would, by design, break the signature.<a href="#section-7.17-1" class="pilcrow">¶</a></p>
<p id="section-7.17-2">However, the HTTP Message Signature standard allows for flexibility in determining which components are signed precisely so that a given application can choose the appropriate portions of the message that need to be signed, avoiding problematic components. For example, a web application framework that relies on rewriting query parameters might avoid use of the <code>@query</code> content identifier in favor of sub-indexing the query value using <code>@query-params</code> content identifier instead.<a href="#section-7.17-2" class="pilcrow">¶</a></p>
<p id="section-7.17-3">Some components are expected to be changed by intermediaries and ought not to be signed under most circumstance. The <code>Via</code> and <code>Forwarded</code> header fields, for example, are expected to be manipulated by proxies and other middle-boxes, including replacing or entirely dropping existing values. These fields should not be covered by the signature except in very limited and tightly-coupled scenarios.<a href="#section-7.17-3" class="pilcrow">¶</a></p>
<p id="section-7.17-4">Additional considerations for choosing signature aspects are discussed in <a href="#application" class="xref">Section 1.5</a>.<a href="#section-7.17-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-lazy-header-parser">
<section id="section-7.18">
        <h3 id="name-confusing-http-field-names-">
<a href="#section-7.18" class="section-number selfRef">7.18. </a><a href="#name-confusing-http-field-names-" class="section-name selfRef">Confusing HTTP Field Names for Derived Component Identifiers</a>
        </h3>
<p id="section-7.18-1">The definition of HTTP field names does not allow for the use of the <code>@</code> character anywhere in the name. As such, since all derived component identifiers start with the <code>@</code> character, these namespaces should be completely separate. However, some HTTP implementations are not sufficiently strict about the characters accepted in HTTP headers. In such implementations, a sender (or attacker) could inject a header field starting with an <code>@</code> character and have it passed through to the application code. These invalid header fields could be used to override a portion of the derived message content and substitute an arbitrary value, providing a potential place for an attacker to mount a <span><a href="#security-collision" class="xref">signature collision</a> (<a href="#security-collision" class="xref">Section 7.5</a>)</span> attack.<a href="#section-7.18-1" class="pilcrow">¶</a></p>
<p id="section-7.18-2">To combat this, when selecting values for a message component, if the component identifier starts with the <code>@</code> character, it needs to be processed as a derived component and never taken as a fields. Only if the component identifier does not start with the <code>@</code> character can it be taken from the fields of the message. The algorithm discussed in <a href="#create-sig-input" class="xref">Section 2.3</a> provides a safe order of operations.<a href="#section-7.18-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-nondeterministic">
<section id="section-7.19">
        <h3 id="name-non-deterministic-signature">
<a href="#section-7.19" class="section-number selfRef">7.19. </a><a href="#name-non-deterministic-signature" class="section-name selfRef">Non-deterministic Signature Primitives</a>
        </h3>
<p id="section-7.19-1">Some cryptographic primitives such as RSA PSS and ECDSA have non-deterministic outputs, which include some amount of entropy within the algorithm. For such algorithms, multiple signatures generated in succession will not match. A lazy implementation of a verifier could ignore this distinction and simply check for the same value being created by re-signing the signature input. Such an implementation would work for deterministic algorithms such as HMAC and EdDSA but fail to verify valid signatures made using non-deterministic algorithms. It is therefore important that a verifier always use the correctly-defined verification function for the algorithm in question and not do a simple comparison.<a href="#section-7.19-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<div id="privacy-identify-keys">
<section id="section-8.1">
        <h3 id="name-identification-through-keys">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-identification-through-keys" class="section-name selfRef">Identification through Keys</a>
        </h3>
<p id="section-8.1-1">If a signer uses the same key with multiple verifiers, or uses the same key over time with a single verifier, the ongoing use of that key can be used to track the signer throughout the set of verifiers that messages are sent to. Since cryptographic keys are meant to be functionally unique, the use of the same key over time is a strong indicator that it is the same party signing multiple messages.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">In many applications, this is a desirable trait, and it allows HTTP Message Signatures to be used as part of authenticating the signer to the verifier. However, unintentional tracking that a signer might not be aware of. To counter this kind of tracking, a signer can use a different key for each verifier that it is in communication with. Sometimes, a signer could also rotate their key when sending messages to a given verifier. These approaches do not negate the need for other anti-tracking techniques to be applied as necessary.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-confidentiality">
<section id="section-8.2">
        <h3 id="name-signatures-do-not-provide-c">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-signatures-do-not-provide-c" class="section-name selfRef">Signatures do not provide confidentiality</a>
        </h3>
<p id="section-8.2-1">HTTP Message Signatures do not provide confidentiality of any of the information protected by the signature. The content of the HTTP message, including the value of all fields and the value of the signature itself, is presented in plaintext to any party with access to the message.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">To provide confidentiality at the transport level, TLS or its equivalent can be used as discussed in <a href="#security-tls" class="xref">Section 7.2</a>.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-oracle">
<section id="section-8.3">
        <h3 id="name-oracles">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-oracles" class="section-name selfRef">Oracles</a>
        </h3>
<p id="section-8.3-1">It is important to balance the need for providing useful feedback to developers on error conditions without providing additional information to an attacker. For example, a naive but helpful server implementation might try to indicate the required key identifier needed for requesting a resource. If someone knows who controls that key, a correlation can be made between the resource's existence and the party identified by the key. Access to such information could be used by an attacker as a means to target the legitimate owner of the resource for further attacks.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-required">
<section id="section-8.4">
        <h3 id="name-required-content">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-required-content" class="section-name selfRef">Required Content</a>
        </h3>
<p id="section-8.4-1">A core design tenet of this specification is that all message components covered by the signature need to be available to the verifier in order to recreate the signature input string and verify the signature. As a consequence, if an application of this specification requires that a particular field be signed, the verifier will need access to the value of that field.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">For example, in some complex systems with intermediary processors this could cause the surprising behavior of an intermediary not being able to remove privacy-sensitive information from a message before forwarding it on for processing, for fear of breaking the signature. A possible mitigation for this specific situation would be for the intermediary to verify the signature itself, then modifying the message to remove the privacy-sensitive information. The intermediary can add its own signature at this point to signal to the next destination that the incoming signature was validated, as is shown in the example in <a href="#signature-multiple" class="xref">Section 4.3</a>.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS186-4">[FIPS186-4]</dt>
        <dd>
<span class="refTitle">"Digital Signature Standard (DSS)"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">https://csrc.nist.gov/publications/detail/fips/186/4/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTMLURL">[HTMLURL]</dt>
        <dd>
<span class="refTitle">"URL (Living Standard)"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MESSAGING">[MESSAGING]</dt>
        <dd>
<span class="refAuthor">Fielding, R. T.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">J. Reschke</span>, <span class="refTitle">"HTTP/1.1"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-messaging-19</span>, <time datetime="2021-09-12" class="refDate">12 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-messaging-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="POSIX.1">[POSIX.1]</dt>
        <dd>
<span class="refTitle">"The Open Group Base Specifications Issue 7, 2018 edition"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://pubs.opengroup.org/onlinepubs/9699919799/">https://pubs.opengroup.org/onlinepubs/9699919799/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2104">https://www.rfc-editor.org/rfc/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6234">https://www.rfc-editor.org/rfc/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8792">https://www.rfc-editor.org/rfc/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8941">[RFC8941]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">P-H. Kamp</span>, <span class="refTitle">"Structured Field Values for HTTP"</span>, <span class="seriesInfo">RFC 8941</span>, <span class="seriesInfo">DOI 10.17487/RFC8941</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8941">https://www.rfc-editor.org/rfc/rfc8941</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEMANTICS">[SEMANTICS]</dt>
      <dd>
<span class="refAuthor">Fielding, R. T.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">J. Reschke</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-semantics-19</span>, <time datetime="2021-09-12" class="refDate">12 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
        <dd><div class="refInstance" id="RFC7525">
            <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>. </div>
<div class="refInstance" id="RFC8996">
            <span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-client-cert-field">[I-D.ietf-httpbis-client-cert-field]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span> and <span class="refAuthor">M. Bishop</span>, <span class="refTitle">"Client-Cert HTTP Header Field"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-client-cert-field-01</span>, <time datetime="2022-01-25" class="refDate">25 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-client-cert-field-01">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-client-cert-field-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7239">[RFC7239]</dt>
        <dd>
<span class="refAuthor">Petersson, A.</span> and <span class="refAuthor">M. Nilsson</span>, <span class="refTitle">"Forwarded HTTP Extension"</span>, <span class="seriesInfo">RFC 7239</span>, <span class="seriesInfo">DOI 10.17487/RFC7239</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7239">https://www.rfc-editor.org/rfc/rfc7239</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="detection">
<section id="appendix-A">
      <h2 id="name-detecting-http-message-sign">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-detecting-http-message-sign" class="section-name selfRef">Detecting HTTP Message Signatures</a>
      </h2>
<p id="appendix-A-1">There have been many attempts to create signed HTTP messages in the past, including other non-standardized definitions of the <code>Signature</code> field, which is used within this specification. It is recommended that developers wishing to support both this specification and other historical drafts do so carefully and deliberately, as incompatibilities between this specification and various versions of other drafts could lead to unexpected problems.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">It is recommended that implementers first detect and validate the <code>Signature-Input</code> field defined in this specification to detect that this standard is in use and not an alternative. If the <code>Signature-Input</code> field is present, all <code>Signature</code> fields can be parsed and interpreted in the context of this draft.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="appendix-B">
      <h2 id="name-examples">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="example-keys">
<section id="appendix-B.1">
        <h3 id="name-example-keys">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-example-keys" class="section-name selfRef">Example Keys</a>
        </h3>
<p id="appendix-B.1-1">This section provides cryptographic keys that are referenced in example signatures throughout this document.  These keys <span class="bcp14">MUST NOT</span> be used for any purpose other than testing.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">The key identifiers for each key are used throughout the examples in this specification. It is assumed for these examples that the signer and verifier can unambiguously dereference all key identifiers used here, and that the keys and algorithms used are appropriate for the context in which the signature is presented.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<div id="example-key-rsa-test">
<section id="appendix-B.1.1">
          <h4 id="name-example-key-rsa-test">
<a href="#appendix-B.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-example-key-rsa-test" class="section-name selfRef">Example Key RSA test</a>
          </h4>
<p id="appendix-B.1.1-1">The following key is a 2048-bit RSA public and private key pair, referred to in this document
as <code>test-key-rsa</code>:<a href="#appendix-B.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.1-2">
<pre>
-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrw
WEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFq
MGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75jfZg
kne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0P
uKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZSFlQ
PSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQAB
-----END RSA PUBLIC KEY-----

-----BEGIN RSA PRIVATE KEY-----
MIIEqAIBAAKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsP
BRrwWEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsd
JKFqMGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75
jfZgkne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKI
lE0PuKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZ
SFlQPSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQABAoIBAG/JZuSWdoVHbi56
vjgCgkjg3lkO1KrO3nrdm6nrgA9P9qaPjxuKoWaKO1cBQlE1pSWp/cKncYgD5WxE
CpAnRUXG2pG4zdkzCYzAh1i+c34L6oZoHsirK6oNcEnHveydfzJL5934egm6p8DW
+m1RQ70yUt4uRc0YSor+q1LGJvGQHReF0WmJBZHrhz5e63Pq7lE0gIwuBqL8SMaA
yRXtK+JGxZpImTq+NHvEWWCu09SCq0r838ceQI55SvzmTkwqtC+8AT2zFviMZkKR
Qo6SPsrqItxZWRty2izawTF0Bf5S2VAx7O+6t3wBsQ1sLptoSgX3QblELY5asI0J
YFz7LJECgYkAsqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOM
cCNq8SyYbTqgnWlB9ZfcAm/cFpA8tYci9m5vYK8HNxQr+8FS3Qo8N9RJ8d0U5Csw
DzMYfRghAfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1
mwJ5AL0pYF0G7x81prlARURwHo0Yf52kEw1dxpx+JXER7hQRWQki5/NsUEtv+8RT
qn2m6qte5DXLyn83b1qRscSdnCCwKtKWUug5q2ZbwVOCJCtmRwmnP131lWRYfj67
B/xJ1ZA6X3GEf4sNReNAtaucPEelgR2nsN0gKQKBiGoqHWbK1qYvBxX2X3kbPDkv
9C+celgZd2PW7aGYLCHq7nPbmfDV0yHcWjOhXZ8jRMjmANVR/eLQ2EfsRLdW69bn
f3ZD7JS1fwGnO3exGmHO3HZG+6AvberKYVYNHahNFEw5TsAcQWDLRpkGybBcxqZo
81YCqlqidwfeO5YtlO7etx1xLyqa2NsCeG9A86UjG+aeNnXEIDk1PDK+EuiThIUa
/2IxKzJKWl1BKr2d4xAfR0ZnEYuRrbeDQYgTImOlfW6/GuYIxKYgEKCFHFqJATAG
IxHrq1PDOiSwXd2GmVVYyEmhZnbcp8CxaEMQoevxAta0ssMK3w6UsDtvUvYvF22m
qQKBiD5GwESzsFPy3Ga0MvZpn3D6EJQLgsnrtUPZx+z2Ep2x0xc5orneB5fGyF1P
WtP+fG5Q6Dpdz3LRfm+KwBCWFKQjg7uTxcjerhBWEYPmEMKYwTJF5PBG9/ddvHLQ
EQeNC8fHGg4UXU8mhHnSBt3EA10qQJfRDs15M38eG2cYwB1PZpDHScDnDA0=
-----END RSA PRIVATE KEY-----
</pre><a href="#appendix-B.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-key-rsa-pss-test">
<section id="appendix-B.1.2">
          <h4 id="name-example-rsa-pss-key">
<a href="#appendix-B.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-example-rsa-pss-key" class="section-name selfRef">Example RSA PSS Key</a>
          </h4>
<p id="appendix-B.1.2-1">The following key is a 2048-bit RSA public and private key pair, referred to in this document
as <code>test-key-rsa-pss</code>:<a href="#appendix-B.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.2-2">
<pre>
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr4tmm3r20Wd/PbqvP1s2
+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry53mm+
oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7OyrFAHq
gDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUAAN5W
Utzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw9lq4
aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oyc6XI
2wIDAQAB
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MIIEvgIBADALBgkqhkiG9w0BAQoEggSqMIIEpgIBAAKCAQEAr4tmm3r20Wd/Pbqv
P1s2+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry5
3mm+oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7Oyr
FAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUA
AN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw
9lq4aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oy
c6XI2wIDAQABAoIBAQCUB8ip+kJiiZVKF8AqfB/aUP0jTAqOQewK1kKJ/iQCXBCq
pbo360gvdt05H5VZ/RDVkEgO2k73VSsbulqezKs8RFs2tEmU+JgTI9MeQJPWcP6X
aKy6LIYs0E2cWgp8GADgoBs8llBq0UhX0KffglIeek3n7Z6Gt4YFge2TAcW2WbN4
XfK7lupFyo6HHyWRiYHMMARQXLJeOSdTn5aMBP0PO4bQyk5ORxTUSeOciPJUFktQ
HkvGbym7KryEfwH8Tks0L7WhzyP60PL3xS9FNOJi9m+zztwYIXGDQuKM2GDsITeD
2mI2oHoPMyAD0wdI7BwSVW18p1h+jgfc4dlexKYRAoGBAOVfuiEiOchGghV5vn5N
RDNscAFnpHj1QgMr6/UG05RTgmcLfVsI1I4bSkbrIuVKviGGf7atlkROALOG/xRx
DLadgBEeNyHL5lz6ihQaFJLVQ0u3U4SB67J0YtVO3R6lXcIjBDHuY8SjYJ7Ci6Z6
vuDcoaEujnlrtUhaMxvSfcUJAoGBAMPsCHXte1uWNAqYad2WdLjPDlKtQJK1diCm
rqmB2g8QE99hDOHItjDBEdpyFBKOIP+NpVtM2KLhRajjcL9Ph8jrID6XUqikQuVi
4J9FV2m42jXMuioTT13idAILanYg8D3idvy/3isDVkON0X3UAVKrgMEne0hJpkPL
FYqgetvDAoGBAKLQ6JZMbSe0pPIJkSamQhsehgL5Rs51iX4m1z7+sYFAJfhvN3Q/
OGIHDRp6HjMUcxHpHw7U+S1TETxePwKLnLKj6hw8jnX2/nZRgWHzgVcY+sPsReRx
NJVf+Cfh6yOtznfX00p+JWOXdSY8glSSHJwRAMog+hFGW1AYdt7w80XBAoGBAImR
NUugqapgaEA8TrFxkJmngXYaAqpA0iYRA7kv3S4QavPBUGtFJHBNULzitydkNtVZ
3w6hgce0h9YThTo/nKc+OZDZbgfN9s7cQ75x0PQCAO4fx2P91Q+mDzDUVTeG30mE
t2m3S0dGe47JiJxifV9P3wNBNrZGSIF3mrORBVNDAoGBAI0QKn2Iv7Sgo4T/XjND
dl2kZTXqGAk8dOhpUiw/HdM3OGWbhHj2NdCzBliOmPyQtAr770GITWvbAI+IRYyF
S7Fnk6ZVVVHsxjtaHy1uJGFlaZzKR4AGNaUTOJMs6NadzCmGPAxNQQOCqoUjn4XR
rOjr9w349JooGXhOxbu8nOxX
-----END PRIVATE KEY-----
</pre><a href="#appendix-B.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-key-ecc-p256">
<section id="appendix-B.1.3">
          <h4 id="name-example-ecc-p-256-test-key">
<a href="#appendix-B.1.3" class="section-number selfRef">B.1.3. </a><a href="#name-example-ecc-p-256-test-key" class="section-name selfRef">Example ECC P-256 Test Key</a>
          </h4>
<p id="appendix-B.1.3-1">The following key is an elliptical curve key over the curve P-256, referred
to in this document as <code>test-key-ecc-p256</code>.<a href="#appendix-B.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.3-2">
<pre>
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFKbhfNZfpDsW43+0+JjUr9K+bTeuxopu653+hBaXGA7oAoGCCqGSM49
AwEHoUQDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lfw0EkjqF7xB4FivAxzic30tMM
4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END EC PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lf
w0EkjqF7xB4FivAxzic30tMM4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END PUBLIC KEY-----
</pre><a href="#appendix-B.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-shared-secret">
<section id="appendix-B.1.4">
          <h4 id="name-example-shared-secret">
<a href="#appendix-B.1.4" class="section-number selfRef">B.1.4. </a><a href="#name-example-shared-secret" class="section-name selfRef">Example Shared Secret</a>
          </h4>
<p id="appendix-B.1.4-1">The following shared secret is 64 randomly-generated bytes encoded in Base64,
referred to in this document as <code>test-shared-secret</code>.<a href="#appendix-B.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.4-2">
<pre>
NOTE: '\' line wrapping per RFC 8792

uzvJfB4u3N0Jy4T7NZ75MDVcr8zSTInedJtkgcu46YW4XByzNJjxBdtjUkdJPBt\
  bmHhIDi6pcl8jsasjlTMtDQ==
</pre><a href="#appendix-B.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-key-ed25519">
<section id="appendix-B.1.5">
          <h4 id="name-example-ed25519-test-key">
<a href="#appendix-B.1.5" class="section-number selfRef">B.1.5. </a><a href="#name-example-ed25519-test-key" class="section-name selfRef">Example Ed25519 Test Key</a>
          </h4>
<p id="appendix-B.1.5-1">The following key is an elliptical curve key over the Edwards curve ed25519, referred to in this document as <code>test-key-edd25519</code>.<a href="#appendix-B.1.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.5-2">
<pre>
-----BEGIN PRIVATE KEY-----
MC4CAQAwBQYDK2VwBCIEIJ+DYvh6SEqVTm50DFtMDoQikTmiCqirVv9mWG9qfSnF
-----END PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
MCowBQYDK2VwAyEAJrQLj5P/89iXES9+vFgrIy29clF9CC/oPPsw3c5D0bs=
-----END PUBLIC KEY-----
</pre><a href="#appendix-B.1.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="test-cases">
<section id="appendix-B.2">
        <h3 id="name-test-cases">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-test-cases" class="section-name selfRef">Test Cases</a>
        </h3>
<p id="appendix-B.2-1">This section provides non-normative examples that may be used as test cases to validate implementation correctness. These examples are based on the following HTTP messages:<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">For requests, this <code>test-request</code> message is used:<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<div id="appendix-B.2-3">
<pre class="lang-http-message sourcecode">
POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre><a href="#appendix-B.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-4">For responses, this <code>test-response</code> message is used:<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
<div id="appendix-B.2-5">
<pre class="lang-http-message sourcecode">
HTTP/1.1 200 OK
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Digest: sha-512=:JlEy2bfUz7WrWIjc1qV6KVLpdr/7L5/L4h7Sxvh6sN\
  HpDQWDCL+GauFQWcZBvVDhiyOnAQsxzZFYwi0wDH+1pw==:
Content-Length: 23

{"message": "good dog"}
</pre><a href="#appendix-B.2-5" class="pilcrow">¶</a>
</div>
<div id="minimal-signature-using-rsa-pss-sha512">
<section id="appendix-B.2.1">
          <h4 id="name-minimal-signature-using-rsa">
<a href="#appendix-B.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-minimal-signature-using-rsa" class="section-name selfRef">Minimal Signature Using rsa-pss-sha512</a>
          </h4>
<p id="appendix-B.2.1-1">This example presents a minimal signature using the <code>rsa-pss-sha512</code> algorithm over <code>test-request</code>, covering none
of the components of the HTTP message, but providing a timestamped signature proof of possession of the key with a signer-provided nonce.<a href="#appendix-B.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.1-2">The corresponding signature input is:<a href="#appendix-B.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-3">
<pre>
NOTE: '\' line wrapping per RFC 8792

"@signature-params": ();created=1618884473;keyid="test-key-rsa-pss"\
  ;nonce="b3k2pp5k7z-50gnwp.yemd"
</pre><a href="#appendix-B.2.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.1-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message under the signature label <code>sig-b21</code>:<a href="#appendix-B.2.1-4" class="pilcrow">¶</a></p>
<div id="appendix-B.2.1-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b21=();created=1618884473\
  ;keyid="test-key-rsa-pss";nonce="b3k2pp5k7z-50gnwp.yemd"
Signature: sig-b21=:d2pmTvmbncD3xQm8E9ZV2828BjQWGgiwAaw5bAkgibUopem\
  LJcWDy/lkbbHAve4cRAtx31Iq786U7it++wgGxbtRxf8Udx7zFZsckzXaJMkA7ChG\
  52eSkFxykJeNqsrWH5S+oxNFlD4dzVuwe8DhTSja8xxbR/Z2cOGdCbzR72rgFWhzx\
  2VjBqJzsPLMIQKhO4DGezXehhWwE56YCE+O6c0mKZsfxVrogUvA4HELjVKWmAvtl6\
  UnCh8jYzuVG5WSb/QEVPnP5TmcAnLH1g+s++v6d4s8m0gCw1fV5/SITLq9mhho8K3\
  +7EPYTU8IU1bLhdxO5Nyt8C8ssinQ98Xw9Q==:
</pre><a href="#appendix-B.2.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.1-6">Note that since the covered components list is empty, this signature could be applied by an attacker to an unrelated HTTP message. In this example, the <code>nonce</code> parameter is included to prevent the same signature from being replayed more than once, but if an attacker intercepts the signature and prevents its delivery to the verifier, the attacker could apply this signature to another message. Therefore, use of an empty covered components set is discouraged. See <a href="#security-coverage" class="xref">Section 7.4</a> for more discussion.<a href="#appendix-B.2.1-6" class="pilcrow">¶</a></p>
<p id="appendix-B.2.1-7">Note that the RSA PSS algorithm in use here is non-deterministic, meaning a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly-generated signature values are not expected to match the example. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#appendix-B.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selective-covered-components-using-rsa-pss-sha512">
<section id="appendix-B.2.2">
          <h4 id="name-selective-covered-component">
<a href="#appendix-B.2.2" class="section-number selfRef">B.2.2. </a><a href="#name-selective-covered-component" class="section-name selfRef">Selective Covered Components using rsa-pss-sha512</a>
          </h4>
<p id="appendix-B.2.2-1">This example covers additional components in <code>test-request</code> using the <code>rsa-pss-sha512</code> algorithm.<a href="#appendix-B.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.2-2">The corresponding signature input is:<a href="#appendix-B.2.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.2-3">
<pre>
NOTE: '\' line wrapping per RFC 8792

"@authority": example.com
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"@signature-params": ("@authority" "content-digest")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre><a href="#appendix-B.2.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.2-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message under the label <code>sig-b22</code>:<a href="#appendix-B.2.2-4" class="pilcrow">¶</a></p>
<div id="appendix-B.2.2-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b22=("@authority" "content-digest")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig-b22=:Fee1uy9YGZq5UUwwYU6vz4dZNvfw3GYrFl1L6YlVIyUMuWs\
  wWDNSvql4dVtSeidYjYZUm7SBCENIb5KYy2ByoC3bI+7gydd2i4OAT5lyDtmeapnA\
  a8uP/b9xUpg+VSPElbBs6JWBIQsd+nMdHDe+ls/IwVMwXktC37SqsnbNyhNp6kcvc\
  WpevjzFcD2VqdZleUz4jN7P+W5A3wHiMGfIjIWn36KXNB+RKyrlGnIS8yaBBrom5r\
  cZWLrLbtg6VlrH1+/07RV+kgTh/l10h8qgpl9zQHu7mWbDKTq0tJ8K4ywcPoC4s2I\
  4rU88jzDKDGdTTQFZoTVZxZmuTM1FvHfzIw==:
</pre><a href="#appendix-B.2.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.2-6">Note that the RSA PSS algorithm in use here is non-deterministic, meaning a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly-generated signature values are not expected to match the example. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#appendix-B.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="full-coverage-using-rsa-pss-sha512">
<section id="appendix-B.2.3">
          <h4 id="name-full-coverage-using-rsa-pss">
<a href="#appendix-B.2.3" class="section-number selfRef">B.2.3. </a><a href="#name-full-coverage-using-rsa-pss" class="section-name selfRef">Full Coverage using rsa-pss-sha512</a>
          </h4>
<p id="appendix-B.2.3-1">This example covers all applicable in <code>test-request</code> (including the content type and length) plus many derived components, again using the <code>rsa-pss-sha512</code> algorithm. Note that the <code>Host</code> header field is not covered because the <code>@authority</code> derived component is included instead.<a href="#appendix-B.2.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-2">The corresponding signature input is:<a href="#appendix-B.2.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.3-3">
<pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@query": param=Value&amp;Pet=dog
"@authority": example.com
"content-type": application/json
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre><a href="#appendix-B.2.3-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.3-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message under the label <code>sig-b23</code>:<a href="#appendix-B.2.3-4" class="pilcrow">¶</a></p>
<div id="appendix-B.2.3-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b23=("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig-b23=:f9nOGJSjCdQ/t+/Mp7gpAHU7Kn1LpnWJE6W2081yRFITJob\
  BDODwQNxnjiIdAGstfGKuM2vlc5SyN16//K5dBLGoiaboMco4J6R0zS+8oXqD7o6K\
  RpIZR/qMrFc5Bu6f6UxuoWZPfCxhs3vxL/60JbF8dcdul1b77mWyC07ZjZ9VkelBy\
  eF5+zN7v6Al/vnBzMS3H1NLz9dI2sw5Vb7kxQQ6CvEI9v3R30aFgWz4rCuyT0Kt3y\
  tQvTHOBsadF66eDe641Sd6O/DgbdFibsE/+ToYopL9NlAuva42NlcFemrozvOKvGI\
  PXdAPqmng/bePoSR6DIaFbWp5aDlNSbWlcA==:
</pre><a href="#appendix-B.2.3-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.3-6">Note in this example that the value of the <code>Date</code> header and the value of the <code>created</code> signature parameter need not be the same. This is due to the fact that the <code>Date</code> header is added when creating the HTTP Message and the <code>created</code> parameter is populated when creating the signature over that message, and these two times could vary. If the <code>Date</code> header is covered by the signature, it is up to the verifier to determine whether its value has to match that of the <code>created</code> parameter or not.<a href="#appendix-B.2.3-6" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-7">Note that the RSA PSS algorithm in use here is non-deterministic, meaning a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly-generated signature values are not expected to match the example. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#appendix-B.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signing-a-response-using-ecdsa-p256-sha256">
<section id="appendix-B.2.4">
          <h4 id="name-signing-a-response-using-ec">
<a href="#appendix-B.2.4" class="section-number selfRef">B.2.4. </a><a href="#name-signing-a-response-using-ec" class="section-name selfRef">Signing a Response using ecdsa-p256-sha256</a>
          </h4>
<p id="appendix-B.2.4-1">This example covers portions of the <code>test-response</code> response message using the <code>ecdsa-p256-sha256</code> algorithm
and the key <code>test-key-ecc-p256</code>.<a href="#appendix-B.2.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.4-2">The corresponding signature input is:<a href="#appendix-B.2.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.4-3">
<pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 200
"content-type": application/json
"content-digest": sha-512=:JlEy2bfUz7WrWIjc1qV6KVLpdr/7L5/L4h7Sxvh6\
  sNHpDQWDCL+GauFQWcZBvVDhiyOnAQsxzZFYwi0wDH+1pw==:
"content-length": 23
"@signature-params": ("@status" "content-type" "content-digest" \
  "content-length");created=1618884473;keyid="test-key-ecc-p256"
</pre><a href="#appendix-B.2.4-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.4-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message under the label <code>sig-b24</code>:<a href="#appendix-B.2.4-4" class="pilcrow">¶</a></p>
<div id="appendix-B.2.4-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b24=("@status" "content-type" \
  "content-digest" "content-length");created=1618884473\
  ;keyid="test-key-ecc-p256"
Signature: sig-b24=:0Ry6HsvzS5VmA6HlfBYS/fYYeNs7fYuA7s0tAdxfUlPGv0C\
  SVuwrrzBOjcCFHTxVRJ01wjvSzM2BetJauj8dsw==:
</pre><a href="#appendix-B.2.4-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.4-6">Note that the ECDSA algorithm in use here is non-deterministic, meaning a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly-generated signature values are not expected to match the example. See <a href="#security-nondeterministic" class="xref">Section 7.19</a>.<a href="#appendix-B.2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signing-a-request-using-hmac-sha256">
<section id="appendix-B.2.5">
          <h4 id="name-signing-a-request-using-hma">
<a href="#appendix-B.2.5" class="section-number selfRef">B.2.5. </a><a href="#name-signing-a-request-using-hma" class="section-name selfRef">Signing a Request using hmac-sha256</a>
          </h4>
<p id="appendix-B.2.5-1">This example covers portions of the <code>test-request</code> using the <code>hmac-sha256</code> algorithm and the
secret <code>test-shared-secret</code>.<a href="#appendix-B.2.5-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.5-2">The corresponding signature input is:<a href="#appendix-B.2.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.5-3">
<pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@authority": example.com
"content-type": application/json
"@signature-params": ("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
</pre><a href="#appendix-B.2.5-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.5-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message under the label <code>sig-b25</code>:<a href="#appendix-B.2.5-4" class="pilcrow">¶</a></p>
<div id="appendix-B.2.5-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b25=("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
Signature: sig-b25=:pxcQw6G3AjtMBQjwo8XzkZf/bws5LelbaMk5rGIGtE8=:
</pre><a href="#appendix-B.2.5-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.5-6">Before using symmetric signatures in practice, see the discussion of the security tradeoffs in <a href="#security-symmetric" class="xref">Section 7.11</a>.<a href="#appendix-B.2.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signing-a-request-using-ed25519">
<section id="appendix-B.2.6">
          <h4 id="name-signing-a-request-using-ed2">
<a href="#appendix-B.2.6" class="section-number selfRef">B.2.6. </a><a href="#name-signing-a-request-using-ed2" class="section-name selfRef">Signing a Request using ed25519</a>
          </h4>
<p id="appendix-B.2.6-1">This example covers portions of the <code>test-request</code> using the <code>ed25519</code> algorithm 
and the key <code>test-key-ed25519</code>.<a href="#appendix-B.2.6-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.6-2">The corresponding signature input is:<a href="#appendix-B.2.6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.6-3">
<pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@authority": example.com
"content-type": application/json
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
</pre><a href="#appendix-B.2.6-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.6-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message under the label <code>sig-b26</code>:<a href="#appendix-B.2.6-4" class="pilcrow">¶</a></p>
<div id="appendix-B.2.6-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b26=("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
Signature: sig-b26=:wqcAqbmYJ2ji2glfAMaRy4gruYYnx2nEFN2HN6jrnDnQCK1\
  u02Gb04v9EDgwUPiu4A0w6vuQv5lIp5WPpBKRCw==:
</pre><a href="#appendix-B.2.6-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="tls-terminating-proxies">
<section id="appendix-B.3">
        <h3 id="name-tls-terminating-proxies">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-tls-terminating-proxies" class="section-name selfRef">TLS-Terminating Proxies</a>
        </h3>
<p id="appendix-B.3-1">In this example, there is a TLS-terminating reverse proxy sitting in front of the resource. The client does not sign the request but instead uses mutual TLS to make its call. The terminating proxy validates the TLS stream and injects a <code>Client-Cert</code> header according to <span>[<a href="#I-D.ietf-httpbis-client-cert-field" class="xref">I-D.ietf-httpbis-client-cert-field</a>]</span>, and then applies a signature to this field. By signing this header field, a reverse proxy can not only attest to its own validation of the initial request's TLS parameters but also authenticate itself to the backend system independently of the client's actions.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">The client makes the following request to the TLS terminating proxy using mutual TLS:<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<div id="appendix-B.3-3">
<pre class="lang-http-message sourcecode">
POST /foo?Param=value&amp;pet=Dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18

{"hello": "world"}
</pre><a href="#appendix-B.3-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-4">The proxy processes the TLS connection and extracts the client's TLS certificate to a <code>Client-Cert</code> header field and passes it along to the internal service hosted at <code>service.internal.example</code>. This results in the following unsigned request:<a href="#appendix-B.3-4" class="pilcrow">¶</a></p>
<div id="appendix-B.3-5">
<pre class="lang-http-message sourcecode">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:

{"hello": "world"}
</pre><a href="#appendix-B.3-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-6">Without a signature, the internal service would need to trust that the incoming connection has the right information. By signing the <code>Client-Cert</code> header and other portions of the internal request, the internal service can be assured that the correct party, the trusted proxy, has processed the request and presented it to the correct service. The proxy's signature input consists of the following:<a href="#appendix-B.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-7">
<pre>
NOTE: '\' line wrapping per RFC 8792

"@path": /foo
"@query": param=Value&amp;Pet=dog
"@method": POST
"@authority": service.internal.example
"client-cert": :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQ\
  KDBJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBD\
  QTAeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDM\
  FkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXm\
  ckC8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQY\
  DVR0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8B\
  Af8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQ\
  GV4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0\
  Q6bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
"@signature-params": ("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
</pre><a href="#appendix-B.3-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-8">This results in the following signature:<a href="#appendix-B.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-9">
<pre>
NOTE: '\' line wrapping per RFC 8792

aLFj9LxKArG+6IY9mfdR3e6K1zfoDJKw71fAkWROXZh34FIiWKAgshFIfBjmiU2X01u\
6YbDkRgzwyg5L9tky0w==
</pre><a href="#appendix-B.3-9" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-10">Which results in the following signed request sent from the proxy to the internal service with the proxy's signature under the label <code>ttrp</code>:<a href="#appendix-B.3-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-11">
<pre>
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
Signature-Input: ttrp=("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
Signature: ttrp=:aLFj9LxKArG+6IY9mfdR3e6K1zfoDJKw71fAkWROXZh34FIiWK\
  AgshFIfBjmiU2X01u6YbDkRgzwyg5L9tky0w==:

{"hello": "world"}
</pre><a href="#appendix-B.3-11" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-12">The internal service can validate the proxy's signature and therefore be able to trust that the client's certificate has been appropriately processed.<a href="#appendix-B.3-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-C">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-C-1">This specification was initially based on the draft-cavage-http-signatures internet draft.  The editors would like to thank the authors of that draft, Mark Cavage and Manu Sporny, for their work on that draft and their continuing contributions. The specification also includes contributions from the draft-oauth-signed-http-request internet draft and other similar efforts.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">The editors would also like to thank the following individuals for feedback, insight, and implementation of this draft and its predecessors (in alphabetical order):
Mark Adamcin,
Mark Allen,
Paul Annesley,
<span class="contact-name">Karl Böhlmark</span>,
<span class="contact-name">Stéphane Bortzmeyer</span>,
Sarven Capadisli,
Liam Dennehy,
Stephen Farrell,
Phillip Hallam-Baker,
Eric Holmes,
Andrey Kislyuk,
Adam Knight,
Dave Lehn,
Dave Longley,
Ilari Liusvaara,
James H. Manger,
Kathleen Moriarty,
Mark Nottingham,
Yoav Nir,
Adrian Palmer,
Lucas Pardue,
Roberto Polli,
Julian Reschke,
Michael Richardson,
Wojciech Rygielski,
Adam Scarr,
Cory J. Slep,
Dirk Stein,
Henry Story,
Lukasz Szewc,
Chris Webber, and
Jeffrey Yasskin.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-D">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-D-1"><em>RFC EDITOR: please remove this section before publication</em><a href="#appendix-D-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1">
          <p id="appendix-D-2.1.1">draft-ietf-httpbis-message-signatures<a href="#appendix-D-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.1">
              <p id="appendix-D-2.1.2.1.1">-08<a href="#appendix-D-2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.1.2.1">Editorial fixes.<a href="#appendix-D-2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.1.2.2">Changed "specialty component" to "derived component".<a href="#appendix-D-2.1.2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.1.2.3">Expanded signature input generation and ABNF rules.<a href="#appendix-D-2.1.2.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.1.2.4">Added Ed25519 algorithm.<a href="#appendix-D-2.1.2.1.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.1.2.5">Clarified encoding of ECDSA signature.<a href="#appendix-D-2.1.2.1.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.1.2.6">Clarified use of non-deterministic algorithms.<a href="#appendix-D-2.1.2.1.2.6" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.2">
              <p id="appendix-D-2.1.2.2.1">-07<a href="#appendix-D-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.2.2.1">Added security and privacy considerations.<a href="#appendix-D-2.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.2.2.2">Added pointers to algorithm values from definition sections.<a href="#appendix-D-2.1.2.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.2.2.3">Expanded IANA registry sections.<a href="#appendix-D-2.1.2.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.2.2.4">Clarified that the signing and verification algorithms take application requirements as inputs.<a href="#appendix-D-2.1.2.2.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.2.2.5">Defined "signature targets" of request, response, and related-response for specialty components.<a href="#appendix-D-2.1.2.2.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.3">
              <p id="appendix-D-2.1.2.3.1">-06<a href="#appendix-D-2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.3.2.1">Updated language for message components, including identifiers and values.<a href="#appendix-D-2.1.2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.3.2.2">Clarified that Signature-Input and Signature are fields which can be used as headers or trailers.<a href="#appendix-D-2.1.2.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.3.2.3">Add "Accept-Signature" field and semantics for signature negotiation.<a href="#appendix-D-2.1.2.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.3.2.4">Define new specialty content identifiers, re-defined request-target identifier.<a href="#appendix-D-2.1.2.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.3.2.5">Added request-response binding.<a href="#appendix-D-2.1.2.3.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.4">
              <p id="appendix-D-2.1.2.4.1">-05<a href="#appendix-D-2.1.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.4.2.1">Remove list prefixes.<a href="#appendix-D-2.1.2.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.4.2.2">Clarify signature algorithm parameters.<a href="#appendix-D-2.1.2.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.4.2.3">Update and fix examples.<a href="#appendix-D-2.1.2.4.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.4.2.4">Add examples for ECC and HMAC.<a href="#appendix-D-2.1.2.4.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.5">
              <p id="appendix-D-2.1.2.5.1">-04<a href="#appendix-D-2.1.2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.5.2.1">Moved signature component definitions up to intro.<a href="#appendix-D-2.1.2.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.5.2.2">Created formal function definitions for algorithms to fulfill.<a href="#appendix-D-2.1.2.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.5.2.3">Updated all examples.<a href="#appendix-D-2.1.2.5.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.5.2.4">Added nonce parameter field.<a href="#appendix-D-2.1.2.5.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.6">
              <p id="appendix-D-2.1.2.6.1">-03<a href="#appendix-D-2.1.2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.6.2.1">Clarified signing and verification processes.<a href="#appendix-D-2.1.2.6.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.6.2.2">Updated algorithm and key selection method.<a href="#appendix-D-2.1.2.6.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.6.2.3">Clearly defined core algorithm set.<a href="#appendix-D-2.1.2.6.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.6.2.4">Defined JOSE signature mapping process.<a href="#appendix-D-2.1.2.6.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.6.2.5">Removed legacy signature methods.<a href="#appendix-D-2.1.2.6.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.6.2.6">Define signature parameters separately from "signature" object model.<a href="#appendix-D-2.1.2.6.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.6.2.7">Define serialization values for signature-input header based on signature input.<a href="#appendix-D-2.1.2.6.2.7" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.7">
              <p id="appendix-D-2.1.2.7.1">-02<a href="#appendix-D-2.1.2.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.7.2.1">Removed editorial comments on document sources.<a href="#appendix-D-2.1.2.7.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.2">Removed in-document issues list in favor of tracked issues.<a href="#appendix-D-2.1.2.7.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.3">Replaced unstructured <code>Signature</code> header with <code>Signature-Input</code> and <code>Signature</code> Dictionary Structured Header Fields.<a href="#appendix-D-2.1.2.7.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.4">Defined content identifiers for individual Dictionary members, e.g., <code>"x-dictionary-field";key=member-name</code>.<a href="#appendix-D-2.1.2.7.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.5">Defined content identifiers for first N members of a List, e.g., <code>"x-list-field":prefix=4</code>.<a href="#appendix-D-2.1.2.7.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.6">Fixed up examples.<a href="#appendix-D-2.1.2.7.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.7">Updated introduction now that it's adopted.<a href="#appendix-D-2.1.2.7.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.8">Defined specialty content identifiers and a means to extend them.<a href="#appendix-D-2.1.2.7.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.9">Required signature parameters to be included in signature.<a href="#appendix-D-2.1.2.7.2.9" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.7.2.10">Added guidance on backwards compatibility, detection, and use of signature methods.<a href="#appendix-D-2.1.2.7.2.10" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.8">
              <p id="appendix-D-2.1.2.8.1">-01<a href="#appendix-D-2.1.2.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.8.2.1">Strengthened requirement for content identifiers for header fields to be lower-case (changed from <span class="bcp14">SHOULD</span> to <span class="bcp14">MUST</span>).<a href="#appendix-D-2.1.2.8.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.8.2.2">Added real example values for Creation Time and Expiration Time.<a href="#appendix-D-2.1.2.8.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.1.2.8.2.3">Minor editorial corrections and readability improvements.<a href="#appendix-D-2.1.2.8.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-2.1.2.9">
              <p id="appendix-D-2.1.2.9.1">-00<a href="#appendix-D-2.1.2.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1.2.9.2.1">Initialized from draft-richanna-http-message-signatures-00, following adoption by the working group.<a href="#appendix-D-2.1.2.9.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-D-2.2">
          <p id="appendix-D-2.2.1">draft-richanna-http-message-signatures<a href="#appendix-D-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.2.2.1">
              <p id="appendix-D-2.2.2.1.1">-00<a href="#appendix-D-2.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.2.2.1.2.1">Converted to xml2rfc v3 and reformatted to comply with RFC style guides.<a href="#appendix-D-2.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.2">Removed Signature auth-scheme definition and related content.<a href="#appendix-D-2.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.3">Removed conflicting normative requirements for use of algorithm parameter. Now <span class="bcp14">MUST NOT</span> be relied upon.<a href="#appendix-D-2.2.2.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.4">Removed Extensions appendix.<a href="#appendix-D-2.2.2.1.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.5">Rewrote abstract and introduction to explain context and need, and challenges inherent in signing HTTP messages.<a href="#appendix-D-2.2.2.1.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.6">Rewrote and heavily expanded algorithm definition, retaining normative requirements.<a href="#appendix-D-2.2.2.1.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.7">Added definitions for key terms, referenced RFC 7230 for HTTP terms.<a href="#appendix-D-2.2.2.1.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.8">Added examples for canonicalization and signature generation steps.<a href="#appendix-D-2.2.2.1.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.9">Rewrote Signature header definition, retaining normative requirements.<a href="#appendix-D-2.2.2.1.2.9" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.10">Added default values for algorithm and expires parameters.<a href="#appendix-D-2.2.2.1.2.10" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.11">Rewrote HTTP Signature Algorithms registry definition. Added change control policy and registry template. Removed suggested URI.<a href="#appendix-D-2.2.2.1.2.11" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.12">Added IANA HTTP Signature Parameter registry.<a href="#appendix-D-2.2.2.1.2.12" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.13">Added additional normative and informative references.<a href="#appendix-D-2.2.2.1.2.13" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-D-2.2.2.1.2.14">Added Topics for Working Group Discussion section, to be removed prior to publication as an RFC.<a href="#appendix-D-2.2.2.1.2.14" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Annabelle Backman (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div dir="auto" class="left"><span class="street-address">P.O. Box 81226</span></div>
<div dir="auto" class="left">
<span class="locality">Seattle</span>, <span class="region">WA</span> <span class="postal-code">98108-1226</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:richanna@amazon.com" class="email">richanna@amazon.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.amazon.com/" class="url">https://www.amazon.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Justin Richer</span></div>
<div dir="auto" class="left"><span class="org">Bespoke Engineering</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@justin.richer.org" class="email">ietf@justin.richer.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://bspk.io/" class="url">https://bspk.io/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Manu Sporny</span></div>
<div dir="auto" class="left"><span class="org">Digital Bazaar</span></div>
<div dir="auto" class="left"><span class="street-address">203 Roanoke Street W.</span></div>
<div dir="auto" class="left">
<span class="locality">Blacksburg</span>, <span class="region">VA</span> <span class="postal-code">24060</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:msporny@digitalbazaar.com" class="email">msporny@digitalbazaar.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://manu.sporny.org/" class="url">https://manu.sporny.org/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
