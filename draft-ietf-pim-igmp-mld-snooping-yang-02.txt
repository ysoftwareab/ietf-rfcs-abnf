PIM Working Group                                               H. Zhao
Internet Draft                                                 Ericsson
Intended status: Standards Track                                 X. Liu
Expires: November 13, 2018                                        Jabil
                                                                 Y. Liu
                                                                 Huawei
                                                           M. Sivakumar
                                                                  Cisco
                                                               A. Peter
                                                              Individual

                                                           May 14, 2018



                A Yang Data Model for IGMP and MLD Snooping
               draft-ietf-pim-igmp-mld-snooping-yang-02.txt




Abstract

   This document defines a YANG data model that can be used to
configure and manage Internet Group Management Protocol (IGMP) and
Multicast Listener Discovery (MLD) Snooping devices.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on November 13, 2018.




Zhao & Liu, etc        Expires November 13, 2018                 [Page 1]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document. Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Table of Contents


   1. Introduction...................................................3
      1.1. Terminology...............................................3
      1.2. Tree Diagrams.............................................3
   2. Design of Data Model...........................................4
      2.1. Overview..................................................4
      2.2. IGMP Snooping Instances...................................4
      2.3. MLD Snooping Instances....................................7
      2.4. IGMP and MLD Snooping References..........................9
      2.5. Augment /if:interfaces/if:interface......................10
      2.6. IGMP and MLD Snooping RPC................................12
   3. IGMP and MLD Snooping YANG Module.............................13
   4. Security Considerations.......................................42
   5. IANA Considerations...........................................44
   6. Normative References..........................................44
   Appendix A.  Data Tree Example...................................46
   Authors' Addresses...............................................52















Zhao & Liu, etc        Expires November 13, 2018                 [Page 2]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


1. Introduction

   This document defines a YANG [RFC6020] data model for the management
   of Internet Group Management Protocol (IGMP) and Multicast Listener
   Discovery (MLD) Snooping devices.

   The YANG model in this document conforms to the Network Management
   Datastore Architecture defined in [I-D.ietf-netmod-revised-
   datastores]. The "Network Management Datastore Architecture" (NMDA)
   adds the ability to inspect the current operational values for
   configuration, allowing clients to use identical paths for retrieving
   the configured values and the operational values.



1.1. Terminology

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP 14
[RFC2119].

The terminology for describing YANG data models is found in[RFC6020].



1.2. Tree Diagrams

A simplified graphical representation of the data model is used in this
document.  The meaning of the symbols in these diagrams is as follows:

   o Brackets "[" and "]" enclose list keys.

   o Abbreviations before data node names: "rw" means configuration
   (read-write), and "ro" means state data (read-only).

   o Symbols after data node names: "?" means an optional node, "!"
   means a presence container, and "*" denotes a list and leaf-list.

   o Parentheses enclose choice and case nodes, and case nodes are also
   marked with a colon (":").

   o Ellipsis ("...") stands for contents of subtrees that are not
   shown.







Zhao & Liu, etc        Expires November 13, 2018                 [Page 3]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


2. Design of Data Model

The model covers Considerations for Internet Group Management Protocol
(IGMP) and Multicast Listener Discovery (MLD) Snooping Switches
[RFC4541].

The goal of this document is to define a data model that provides a
common user interface to IGMP and MLD Snooping.  This document provides
freedom for vendors to adapt this data model to their product
implementations.



2.1. Overview

The IGMP and MLD Snooping YANG module defined in this document has all
the common building blocks for the IGMP and MLD Snooping protocol.

The YANG module includes IGMP and MLD Snooping instance definition,
instance reference in the scenario of BRIDGE, L2VPN. The module also
includes the RPC methods for clearing IGMP and MLD Snooping group
tables.

This YANG model follows the Guidelines for YANG Module Authors (NMDA)
[draft-dsdt-nmda-guidelines-01]. This NMDA ("Network Management
Datastore Architecture") architecture provides an architectural
framework for datastores as they are used by network management
protocols such as NETCONF [RFC6241], RESTCONF [RFC8040] and the YANG
[RFC7950] data modeling language.



2.2. IGMP Snooping Instances

The YANG module defines igmp-snooping-instance which could be referenced
in the BRIDGE or L2VPN scenario to enable IGMP Snooping.

All the IGMP Snooping related attributes have been defined in the igmp-
snooping-instance. The read-write attribute is configurable data. The
read-only attribute shows state data. The key attribute of the igmp-
snooping-instance is name.

The value of type in igmp-snooping-instance is bridge or l2vpn. When it
is bridge, the igmp-snooping-instance will be referenced in the BRIDGE
scenario. When it is l2vpn, the igmp-snooping-instance will be
referenced in the L2VPN scenario.

The value of bridge-mrouter-interface, l2vpn-mrouter-interface-ac,
l2vpn-mrouter-interface-pw are filled by routing system dynamically.
They are different from static-bridge-mrouter-interface, static-l2vpn-

Zhao & Liu, etc        Expires November 13, 2018                 [Page 4]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


mrouter-interface-ac, and static-l2vpn-mrouter-interface-pw which are
configured statically.

   module: ietf-igmp-mld-snooping

       +--rw igmp-snooping-instances

       |  +--rw igmp-snooping-instance* [name]

       |     +--rw name                                 string

       |     +--rw type?                                enumeration

       |     +--rw enable?                              boolean {admin-enable}?

       |     +--rw forwarding-mode?                     enumeration

       |     +--rw explicit-tracking?                   boolean {explicit-tracking}?

       |     +--rw exclude-lite?                        boolean {exclude-lite}?

       |     +--rw send-query?                          boolean

       |     +--rw immediate-leave?                     empty {immediate-leave}?

       |     +--rw last-member-query-interval?          uint16

       |     +--rw query-interval?                      uint16

       |     +--rw query-max-response-time?             uint16

       |     +--rw require-router-alert?                boolean {require-router-
   alert}?

       |     +--rw robustness-variable?                 uint8

       |     +--rw version?                             uint8

       |     +--rw static-bridge-mrouter-interface*     if:interface-ref {static-
   mrouter-interface}?

       |     +--rw static-l2vpn-mrouter-interface-ac*   if:interface-ref {static-
   mrouter-interface}?

       |     +--rw static-l2vpn-mrouter-interface-pw*   l2vpn-instance-pw-ref
   {static-mrouter-interface}?

       |     +--rw querier-source?                      inet:ipv4-address



Zhao & Liu, etc        Expires November 13, 2018                 [Page 5]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


       |     +--rw static-l2-multicast-group* [group source-addr] {static-l2-
   multicast-group}?

       |     |  +--rw group                        inet:ipv4-address

       |     |  +--rw source-addr                  source-ipv4-addr-type

       |     |  +--rw bridge-outgoing-interface*   if:interface-ref

       |     |  +--rw l2vpn-outgoing-ac*           l2vpn-instance-ac-ref

       |     |  +--rw l2vpn-outgoing-pw*           l2vpn-instance-pw-ref

       |     +--ro entries-count?                       uint32

       |     +--ro bridge-mrouter-interface*            if:interface-ref

       |     +--ro l2vpn-mrouter-interface-ac*          if:interface-ref

       |     +--ro l2vpn-mrouter-interface-pw*          l2vpn-instance-pw-ref

       |     +--ro group* [address]

       |        +--ro address          inet:ipv4-address

       |        +--ro mac-address?     yang:phys-address

       |        +--ro expire?          uint32

       |        +--ro up-time?         uint32

       |        +--ro last-reporter?   inet:ipv4-address

       |        +--ro source* [address]

       |           +--ro address                      inet:ipv4-address

       |           +--ro bridge-outgoing-interface*   if:interface-ref

       |           +--ro l2vpn-outgoing-ac*           l2vpn-instance-ac-ref

       |           +--ro l2vpn-outgoing-pw*           l2vpn-instance-pw-ref

       |           +--ro up-time?                     uint32

       |           +--ro expire?                      uint32

       |           +--ro host-count?                  uint32 {explicit-tracking}?

       |           +--ro last-reporter?               inet:ipv4-address

Zhao & Liu, etc        Expires November 13, 2018                 [Page 6]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


       |           +--ro host* [host-address] {explicit-tracking}?

       |              +--ro host-address        inet:ipv4-address

       |              +--ro host-filter-mode?   enumeration



2.3. MLD Snooping Instances

The YANG module defines mld-snooping-instance which could be referenced
in the BRIDGE or L2VPN scenario to enable MLD Snooping.

The mld-snooping-instance is the same as IGMP snooping except changing
IPV4 addresses to IPV6 addresses.

   module: ietf-igmp-mld-snooping

          +--rw mld-snooping-instances

          |  +--rw mld-snooping-instance* [name]

          |     +--rw name                                 string

          |     +--rw type?                                enumeration

          |     +--rw enable?                              boolean {admin-enable}?

          |     +--rw forwarding-mode?                     enumeration

          |     +--rw explicit-tracking?                   boolean {explicit-
   tracking}?

          |     +--rw exclude-lite?                        boolean {exclude-lite}?

          |     +--rw send-query?                          boolean

          |     +--rw immediate-leave?                     empty {immediate-leave}?

          |     +--rw last-member-query-interval?          uint16

          |     +--rw query-interval?                      uint16

          |     +--rw query-max-response-time?             uint16

          |     +--rw require-router-alert?                boolean {require-router-
   alert}?

          |     +--rw robustness-variable?                 uint8


Zhao & Liu, etc        Expires November 13, 2018                 [Page 7]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


          |     +--rw version?                             uint8

          |     +--rw static-bridge-mrouter-interface*     if:interface-ref {static-
   mrouter-interface}?

          |     +--rw static-l2vpn-mrouter-interface-ac*   if:interface-ref {static-
   mrouter-interface}?

          |     +--rw static-l2vpn-mrouter-interface-pw*   l2vpn-instance-pw-ref
   {static-mrouter-interface}?

          |     +--rw querier-source?                      inet:ipv6-address

          |     +--rw static-l2-multicast-group* [group source-addr] {static-l2-
   multicast-group}?

          |     |  +--rw group                        inet:ipv6-address

          |     |  +--rw source-addr                  source-ipv6-addr-type

          |     |  +--rw bridge-outgoing-interface*   if:interface-ref

          |     |  +--rw l2vpn-outgoing-ac*           l2vpn-instance-ac-ref

          |     |  +--rw l2vpn-outgoing-pw*           l2vpn-instance-pw-ref

          |     +--ro entries-count?                       uint32

          |     +--ro bridge-mrouter-interface*            if:interface-ref

          |     +--ro l2vpn-mrouter-interface-ac*          if:interface-ref

          |     +--ro l2vpn-mrouter-interface-pw*          l2vpn-instance-pw-ref

          |     +--ro group* [address]

          |        +--ro address          inet:ipv6-address

          |        +--ro mac-address?     yang:phys-address

          |        +--ro expire?          uint32

          |        +--ro up-time?         uint32

          |        +--ro last-reporter?   inet:ipv6-address

          |        +--ro source* [address]

          |           +--ro address                      inet:ipv6-address


Zhao & Liu, etc        Expires November 13, 2018                 [Page 8]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


          |           +--ro bridge-outgoing-interface*   if:interface-ref

          |           +--ro l2vpn-outgoing-ac*           l2vpn-instance-ac-ref

          |           +--ro l2vpn-outgoing-pw*           l2vpn-instance-pw-ref

          |           +--ro up-time?                     uint32

          |           +--ro expire?                      uint32

          |           +--ro host-count?                  uint32 {explicit-tracking}?

          |           +--ro last-reporter?               inet:ipv6-address

          |           +--ro host* [host-address] {explicit-tracking}?

          |              +--ro host-address        inet:ipv6-address

          |              +--ro host-filter-mode?   enumeration



2.4. IGMP and MLD Snooping References

The igmp-snooping-instance could be referenced in the scenario of BRIDGE
or L2VPN to configure the IGMP Snooping. The name of the instance is the
key attribute.

When the igmp-snooping-instance is referenced under the bridge view, it
means IGMP Snooping is enabled in the whole bridge. When the igmp-
snooping-instance is referenced under the VLAN view, it means IGMP
Snooping is enabled in the certain VLAN of the bridge.

The mld-snooping-instance could be referenced in concurrence with igmp-
snooping-instance to configure the MLD Snooping.

    +--rw bridges

    |  +--rw bridge* [name]

    |     +--rw name                      name-type

    |     +--rw igmp-snooping-instance?   igmp-snooping-instance-ref

    |     +--rw mld-snooping-instance?    mld-snooping-instance-ref

    |     +--rw component* [name]

    |        +--rw name           string


Zhao & Liu, etc        Expires November 13, 2018                 [Page 9]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


    |        +--rw bridge-vlan

    |           +--rw vlan* [vid]

    |              +--rw vid                       vlan-index-type

    |              +--rw igmp-snooping-instance?   igmp-snooping-instance-ref

    |              +--rw mld-snooping-instance?    mld-snooping-instance-ref

    +--rw l2vpn-instances

       +--rw l2vpn-instance* [name]

          +--rw name                      string

          +--rw igmp-snooping-instance?   igmp-snooping-instance-ref

          +--rw mld-snooping-instance?    mld-snooping-instance-ref



2.5. Augment /if:interfaces/if:interface

This model augment /if:interfaces/if:interface and then add the IGMP and
MLD Snooping related attributes under it. The attributes include enable,
version, etc.

The static-mrouter-interface and static-l2-multicast-group could be
configured statically under the /if:interfaces/if:interface/ims:igmp-
mld-snooping view. Meanwhile, you can configure them under the IGMP and
MLD Snooping instance view.

The attributes under the statistics are read-only. They show the
statistics of IGMP and MLD Snooping related packets.

augment /if:interfaces/if:interface:

    +--rw igmp-mld-snooping

       +--rw enable?                      boolean {admin-enable}?

       +--rw version?                     uint8

       +--rw type?                        enumeration

       +--rw static-mrouter-interface

       |  +--rw (static-mrouter-interface)?


Zhao & Liu, etc        Expires November 13, 2018                [Page 10]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


       |     +--:(bridge)

       |     |  +--rw bridge-name?           string

       |     |  +--rw vlan-id*               uint32

       |     +--:(l2vpn)

       |        +--rw l2vpn-instance-name?   string

       +--rw static-l2-multicast-group

       |  +--rw (static-l2-multicast-group)?

       |     +--:(bridge)

       |     |  +--rw bridge-name?       string

       |     |  +--rw bridge-group-v4* [group source-addr]

       |     |  |  +--rw group          inet:ipv4-address

       |     |  |  +--rw source-addr    source-ipv4-addr-type

       |     |  |  +--rw vlan-id*       uint32

       |     |  +--rw bridge-group-v6* [group source-addr]

       |     |     +--rw group          inet:ipv6-address

       |     |     +--rw source-addr    source-ipv6-addr-type

       |     |     +--rw vlan-id*       uint32

       |     +--:(l2vpn)

       |        +--rw l2vpn-group-v4* [group source-addr]

       |        |  +--rw group                  inet:ipv4-address

       |        |  +--rw source-addr            source-ipv4-addr-type

       |        |  +--rw l2vpn-instance-name?   string

       |        +--rw l2vpn-group-v6* [group source-addr]

       |           +--rw group                  inet:ipv6-address

       |           +--rw source-addr            source-ipv6-addr-type


Zhao & Liu, etc        Expires November 13, 2018                [Page 11]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


       |           +--rw l2vpn-instance-name?   string

       +--ro statistics

          +--ro received

          |  +--ro query?                  yang:counter64

          |  +--ro membership-report-v1?   yang:counter64

          |  +--ro membership-report-v2?   yang:counter64

          |  +--ro membership-report-v3?   yang:counter64

          |  +--ro leave?                  yang:counter64

          |  +--ro non-member-leave?       yang:counter64

          |  +--ro pim?                    yang:counter64

          +--ro sent

             +--ro query?                  yang:counter64

             +--ro membership-report-v1?   yang:counter64

             +--ro membership-report-v2?   yang:counter64

             +--ro membership-report-v3?   yang:counter64

             +--ro leave?                  yang:counter64

             +--ro non-member-leave?       yang:counter64

             +--ro pim?                    yang:counter64



2.6. IGMP and MLD Snooping RPC

   IGMP and MLD Snooping RPC clears the specified IGMP and MLD Snooping
   group tables.

   rpcs:
       +---x clear-igmp-snooping-groups {rpc-clear-groups}?
       |     +---w input
       |     +---w name?     string
       |     +---w group?    inet:ipv4-address
       |     +---w source?   inet:ipv4-address
       +---x clear-mld-snooping-groups {rpc-clear-groups}?

Zhao & Liu, etc        Expires November 13, 2018                [Page 12]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


          +---w input
             +---w name?     string
             +---w group?    inet:ipv6-address
             +---w source?   inet:ipv6-address




3. IGMP and MLD Snooping YANG Module

<CODE BEGINS> file ietf-igmp-mld-snooping@2018-05-03.yang
module ietf-igmp-mld-snooping {
      namespace "urn:ietf:params:xml:ns:yang:ietf-igmp-mld-snooping";
      // replace with IANA namespace when assigned
      prefix ims;

      import ietf-inet-types {
        prefix inet;
      }

      import ietf-yang-types {
        prefix "yang";
      }

      import ietf-interfaces {
        prefix "if";
      }

     import ietf-l2vpn {
      prefix "l2vpn";
     }

     import ietf-network-instance {
        prefix "ni";
      }


      organization
        "IETF PIM Working Group";

      contact
        "WG Web:   <http://tools.ietf.org/wg/pim/>
         WG List:  <mailto:pim@ietf.org>

         Editors:  Hongji Zhao
               <mailto:hongji.zhao@ericsson.com>

               Xufeng Liu
               <mailto:xufeng.liu.ietf@gmail.com>


Zhao & Liu, etc        Expires November 13, 2018                [Page 13]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


               Yisong Liu
               <mailto:liuyisong@huawei.com>

               Anish Peter
               <mailto:anish.ietf@gmail.com>

               Mahesh Sivakumar
               <mailto:sivakumar.mahesh@gmail.com>

               ";

      description
       "The module defines a collection of YANG definitions common for
        all Internet Group Management Protocol (IGMP) and Multicast
      Listener Discovery (MLD) Snooping devices.

        Copyright (c) 2018 IETF Trust and the persons identified as
        authors of the code.  All rights reserved.

        Redistribution and use in source and binary forms, with or
        without modification, is permitted pursuant to, and subject to
        the license terms contained in, the Simplified BSD License set
        forth in Section 4.c of the IETF Trust's Legal Provisions
        Relating to IETF Documents
        (http://trustee.ietf.org/license-info).

        This version of this YANG module is part of RFC XXXX; see the
        RFC itself for full legal notices.";

     revision 2018-05-03 {
      description
         "Initial revision.";
      reference
          "RFC XXXX: A YANG Data Model for IGMP and MLD Snooping";
     }


      /*
       * Features
       */

     feature admin-enable {
        description
          "Support configuration to enable or disable IGMP and MLD
Snooping.";
      }

      feature immediate-leave {
        description
          "Support configuration of immediate-leave.";

Zhao & Liu, etc        Expires November 13, 2018                [Page 14]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


      }

      feature join-group {
        description
          "Support configuration of join-group.";
      }

      feature require-router-alert {
        description
          "Support configuration of require-router-alert.";
      }

      feature static-l2-multicast-group {
        description
          "Support configuration of L2 multicast static-group.";
      }

     feature static-mrouter-interface {
        description
          "Support configuration of mrouter interface.";
      }

      feature per-instance-config {
        description
          "Support configuration of each VLAN or l2vpn instance or EVPN
instance.";
      }

     feature rpc-clear-groups {
        description
          "Support to clear statistics by RPC for IGMP and MLD
Snooping.";
      }

     feature explicit-tracking {
        description
          "Support configuration of per instance explicit-tracking
hosts.";
      }

      feature exclude-lite {
        description
          "Support configuration of per instance exclude-lite.";
      }

      /*
       * Typedefs
       */
    typedef name-type {
      type string {

Zhao & Liu, etc        Expires November 13, 2018                [Page 15]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


        length "0..32";
      }
      description
        "A text string of up to 32 characters, of locally determined
        significance.";
    }
    typedef vlan-index-type {
      type uint32 {
        range "1..4094 | 4096..4294967295";
      }
      description
        "A value used to index per-VLAN tables. Values of 0 and 4095
        are not permitted. The range of valid VLAN indices. If the
        value is greater than 4095, then it represents a VLAN with
        scope local to the particular agent, i.e., one without a
        global VLAN-ID assigned to it. Such VLANs are outside the
        scope of IEEE 802.1Q, but it is convenient to be able to
        manage them in the same way using this YANG module.";
      reference
        "IEEE Std 802.1Q-2014: Virtual Bridged Local Area Networks.";
    }

     typedef igmp-snooping-instance-ref {
       type leafref {
         path "/igmp-snooping-instances/igmp-snooping-instance/name";
       }
       description
         "This type is used by data models that need to reference igmp
snooping instance.";
     }

    typedef mld-snooping-instance-ref {
       type leafref {
         path "/mld-snooping-instances/mld-snooping-instance/name";
       }
       description
         "This type is used by data models that need to reference mld
snooping instance.";
     }

    typedef l2vpn-instance-ac-ref {
      type leafref {
       path "/ni:network-instances/ni:network-instance/l2vpn:endpoint/l2vpn:name";
      }
      description "l2vpn-instance-ac-ref";
    }

    typedef l2vpn-instance-pw-ref {
      type leafref {

Zhao & Liu, etc        Expires November 13, 2018                [Page 16]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


       path "/ni:network-instances/ni:network-instance/l2vpn:endpoint/l2vpn:name";
      }
      description "l2vpn-instance-pw-ref";
    }

     typedef source-ipv4-addr-type {
        type union {
          type enumeration {
            enum '*' {
              description
              "Any source address.";
            }
          }
          type inet:ipv4-address;
        }
        description
          "Multicast source IPV4 address type.";
      } // source-ipv4-addr-type

      typedef source-ipv6-addr-type {
        type union {
          type enumeration {
            enum '*' {
              description
              "Any source address.";
            }
          }
          type inet:ipv6-address;
        }
        description
          "Multicast source IPV6 address type.";
      } // source-ipv6-addr-type


      /*
       * Identities
       */

      /*
       * Groupings
       */


      grouping general-state-attributes {

      description "General State attributes";

        container received {
        config false;

Zhao & Liu, etc        Expires November 13, 2018                [Page 17]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


          description "Statistics of received IGMP and MLD Snooping
related packets.";
          uses general-statistics-sent-received;
        }
        container sent {
        config false;
          description "Statistics of sent IGMP and MLD Snooping related
packets.";
          uses general-statistics-sent-received;
        }


      } // general-state-attributes



      grouping instance-config-attributes-igmp-snooping {
        description "IGMP snooping configuration for each VLAN or l2vpn
instance or EVPN instance.";

        uses instance-config-attributes-igmp-mld-snooping;

      leaf querier-source {
          type inet:ipv4-address;
          description "Use the IGMP snooping querier to support IGMP
snooping in a VLAN where PIM and IGMP are not configured.
                  The IPV4 address is used as the source address in
messages.";
        }

       list static-l2-multicast-group {
         if-feature static-l2-multicast-group;
         key "group source-addr";
             description
               "A static multicast route, (*,G) or (S,G).";

         leaf group {
            type inet:ipv4-address;
            description
            "Multicast group IPV4 address";
         }

         leaf source-addr {
               type source-ipv4-addr-type;
               description
                 "Multicast source IPV4 address.";
             }

         leaf-list bridge-outgoing-interface {
            when "../../type = 'bridge'";

Zhao & Liu, etc        Expires November 13, 2018                [Page 18]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            type if:interface-ref;
            description "Outgoing interface in bridge fowarding";

         }

         leaf-list l2vpn-outgoing-ac {
            when "../../type = 'l2vpn'";
            type l2vpn-instance-ac-ref;
            description "Outgoing AC in L2VPN fowarding";

         }

         leaf-list l2vpn-outgoing-pw {
            when "../../type = 'l2vpn'";
            type l2vpn-instance-pw-ref;
            description "Outgoing PW in L2VPN fowarding";

         }


       } // static-l2-multicast-group

      } // instance-config-attributes-igmp-snooping

      grouping instance-config-attributes-igmp-mld-snooping {
        description
          "IGMP and MLD Snooping configuration of each VLAN.";

        leaf enable {
          if-feature admin-enable;
          type boolean;
        default false;
          description
            "Set the value to true to enable IGMP and MLD Snooping in
the VLAN instance.";
        }

      leaf forwarding-mode {
         type enumeration {
            enum "mac" {
             description
               "MAC-based lookup mode";
            }
            enum "ip"  {
             description
               "IP-based lookup mode";
            }
         }
         default "ip";


Zhao & Liu, etc        Expires November 13, 2018                [Page 19]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


         description "The default forwarding mode for IGMP and MLD
Snooping is ip.
                   cisco command is as below
                   Router(config-vlan-config)# multicast snooping lookup
{ ip | mac }  ";
      }

      leaf explicit-tracking {
         if-feature explicit-tracking;
         type boolean;
         default false;
         description "Tracks IGMP & MLD Snooping v3 membership reports
from individual hosts.
                  It contributes to saving network resources and
shortening leave latency.";

      }

      leaf exclude-lite {
          if-feature exclude-lite;
          type boolean;
        default false;
          description
            "lightweight IGMPv3 and MLDv2 protocols, which simplify the
             standard versions of IGMPv3 and MLDv2.";
          reference "RFC5790";
        }

      leaf send-query {
         type boolean;
         default true;
         description "Enable quick response for topo changes.
             To support IGMP snooping in a VLAN where PIM and IGMP are
not configured.
               It cooperates with param querier-source. ";
      }

      /**
      leaf mrouter-aging-time {
         type uint16 ;
         default 180;
         description "Aging time for mrouter interface";
      }
      **/

        leaf immediate-leave {
          if-feature immediate-leave;
          type empty;
          description


Zhao & Liu, etc        Expires November 13, 2018                [Page 20]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            "When fast leave is enabled, the IGMP software assumes that
no more than one host is present on each VLAN port.";
        }

        leaf last-member-query-interval {
            type uint16 {
              range "1..65535";
            }
            units seconds;
            default 1;
            description
              "Last Member Query Interval, which may be tuned to modify
the
               leave latency of the network.";
             reference "RFC3376. Sec. 8.8.";
        }

       leaf query-interval {

            type uint16;
            units seconds;
            default 125;
            description
              "The Query Interval is the interval between General
Queries
               sent by the Querier.";
            reference "RFC3376. Sec. 4.1.7, 8.2, 8.14.2.";
        }

        leaf query-max-response-time {

            type uint16;
            units seconds;
            default 10;
            description
              "Query maximum response time specifies the maximum time
               allowed before sending a responding report.";
            reference "RFC3376. Sec. 4.1.1, 8.3, 8.14.3.";

        }

        leaf require-router-alert {
          if-feature require-router-alert;
          type boolean;
        default false;
          description
            "When the value is true, router alert should exist in the IP
head of IGMP or MLD packet.";
        }


Zhao & Liu, etc        Expires November 13, 2018                [Page 21]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


        leaf robustness-variable {
            type uint8 {
              range "1..7";
            }
            default 2;
            description
              "Querier's Robustness Variable allows tuning for the
expected
               packet loss on a network.";
            reference "RFC3376. Sec. 4.1.6, 8.1, 8.14.1.";
        }

        leaf version {
          type uint8 {
            range "1..3";
          }
          description "IGMP and MLD Snooping version.";
        }


      leaf-list static-bridge-mrouter-interface {

         when "../type = 'bridge'";
         if-feature static-mrouter-interface;
         type if:interface-ref;
         description "static mrouter interface in bridge fowarding";

      }

      leaf-list static-l2vpn-mrouter-interface-ac {

         when "../type = 'l2vpn'";
         if-feature static-mrouter-interface;
         type if:interface-ref;
         description "static mrouter interface whose type is interface
in l2vpn forwarding";

      }

      leaf-list static-l2vpn-mrouter-interface-pw {

         when "../type = 'l2vpn'";
         if-feature static-mrouter-interface;
         type l2vpn-instance-pw-ref;
         description "static mrouter interface whose type is pw in l2vpn
forwarding";

      }



Zhao & Liu, etc        Expires November 13, 2018                [Page 22]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


      } // instance-config-attributes-igmp-mld-snooping

      grouping instance-config-attributes-mld-snooping {
        description "MLD snooping configuration of each VLAN.";

        uses instance-config-attributes-igmp-mld-snooping;

      leaf querier-source {
          type inet:ipv6-address;
          description
         "Use the MLD snooping querier to support MLD snooping where PIM
and MLD are not configured.
          The IPV6 address is used as the source address in messages.";
        }

        list static-l2-multicast-group {
         if-feature static-l2-multicast-group;
         key "group source-addr";
             description
               "A static multicast route, (*,G) or (S,G).";

         leaf group {
            type inet:ipv6-address;
            description
            "Multicast group IPV6 address";
         }

         leaf source-addr {
               type source-ipv6-addr-type;
               description
                 "Multicast source IPV6 address.";
             }

         leaf-list bridge-outgoing-interface {
            when "../../type = 'bridge'";
            type if:interface-ref;
            description "Outgoing interface in bridge fowarding";

         }

         leaf-list l2vpn-outgoing-ac {
            when "../../type = 'l2vpn'";
            type l2vpn-instance-ac-ref;
            description "Outgoing AC in L2VPN fowarding";

         }

         leaf-list l2vpn-outgoing-pw {
            when "../../type = 'l2vpn'";
            type l2vpn-instance-pw-ref;

Zhao & Liu, etc        Expires November 13, 2018                [Page 23]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            description "Outgoing PW in L2VPN fowarding";

         }


       } // static-l2-multicast-group

      } // instance-config-attributes-mld-snooping

     grouping instance-state-group-attributes-igmp-mld-snooping {
        description
          "Attributes for both IGMP and MLD snooping groups.";

      leaf mac-address {
         type yang:phys-address;
         description "Destination MAC address for L2 multicast
forwarding.";
      }

        leaf expire {
          type uint32;
          units seconds;
          description
         "The time left before multicast group timeout.";
        }

        leaf up-time {
          type uint32;
          units seconds;
          description
            "The time elapsed since the device created L2 multicast
record.";
        }


      } // instance-state-group-attributes-igmp-mld-snooping


      grouping instance-state-attributes-igmp-snooping {

        description
          "State attributes for IGMP snooping for each VLAN or l2vpn
instance or EVPN instance.";

        uses instance-state-attributes-igmp-mld-snooping;

        list group {

        key "address";


Zhao & Liu, etc        Expires November 13, 2018                [Page 24]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


        config false;

          description "IGMP snooping information";

          leaf address {
            type inet:ipv4-address;
            description
              "Multicast group IPV4 address";
          }

        uses instance-state-group-attributes-igmp-mld-snooping;

        leaf last-reporter {
            type inet:ipv4-address;
            description
              "Address of the last host which has sent report to join
the multicast group.";
          }

          list source {
            key "address";
         description "Source IPV4 address for multicast stream";
            leaf address {
              type inet:ipv4-address;
              description "Source IPV4 address for multicast stream";
            }

            uses instance-state-source-attributes-igmp-mld-snooping;

         leaf last-reporter {
              type inet:ipv4-address;
              description
                "Address of the last host which has sent report to join
the multicast group.";
            }

         list host {
              if-feature explicit-tracking;
              key "host-address";
              description
                "List of multicast membership hosts
                 of the specific multicast source-group.";

              leaf host-address {
                type inet:ipv4-address;
                description
                  "Multicast membership host address.";
              }
              leaf host-filter-mode {
                type enumeration {

Zhao & Liu, etc        Expires November 13, 2018                [Page 25]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


                  enum "include" {
                    description
                      "In include mode";
                  }
                  enum "exclude" {
                    description
                      "In exclude mode.";
                  }
                }
                description
                  "Filter mode for a multicast membership
                   host may be either include or exclude.";
              }
            }// list host

          } // list source
        } // list group

      } // instance-state-attributes-igmp-snooping

      grouping instance-state-attributes-igmp-mld-snooping {

          description
            "State attributes for both IGMP and MLD Snooping of each
VLAN or l2vpn instance or EVPN instance.";

        leaf entries-count {
            type uint32;
         config false;
            description
              "The number of L2 multicast entries in IGMP and MLD
Snooping.";
          }

        leaf-list bridge-mrouter-interface {

         when "../type = 'bridge'";
         type if:interface-ref;
         config false;
         description " mrouter interface in bridge fowarding";

        }

        leaf-list l2vpn-mrouter-interface-ac {

         when "../type = 'l2vpn'";
         type if:interface-ref;
         config false;
         description " mrouter interface whose type is interface in
l2vpn fowarding";

Zhao & Liu, etc        Expires November 13, 2018                [Page 26]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018



        }

        leaf-list l2vpn-mrouter-interface-pw {

         when "../type = 'l2vpn'";
         type l2vpn-instance-pw-ref;
         config false;
         description " mrouter interface whose type is pw in l2vpn
fowarding";

        }


      } // instance-config-attributes-igmp-mld-snooping

      grouping instance-state-attributes-mld-snooping {
        description
          "State attributes for MLD snooping of each VLAN.";

        uses instance-state-attributes-igmp-mld-snooping;


        list group {

        key "address";

        config false;

          description "MLD snooping statistics information";

          leaf address {
            type inet:ipv6-address;
            description
              "Multicast group IPV6 address";
          }

        uses instance-state-group-attributes-igmp-mld-snooping;

        leaf last-reporter {
            type inet:ipv6-address;
            description
              "Address of the last host which has sent report to join
the multicast group.";
          }

          list source {
            key "address";
         description "Source IPV6 address for multicast stream";


Zhao & Liu, etc        Expires November 13, 2018                [Page 27]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            leaf address {
              type inet:ipv6-address;
              description "Source IPV6 address for multicast stream";
            }

            uses instance-state-source-attributes-igmp-mld-snooping;

         leaf last-reporter {
            type inet:ipv6-address;
            description
               "Address of the last host which has sent report to join
the multicast group.";
         }

         list host {
              if-feature explicit-tracking;
              key "host-address";
              description
                "List of multicast membership hosts
                 of the specific multicast source-group.";

              leaf host-address {
                type inet:ipv6-address;
                description
                  "Multicast membership host address.";
              }
              leaf host-filter-mode {
                type enumeration {
                  enum "include" {
                    description
                      "In include mode";
                  }
                  enum "exclude" {
                    description
                      "In exclude mode.";
                  }
                }
                description
                  "Filter mode for a multicast membership
                   host may be either include or exclude.";
              }
            }// list host

          } // list source
        } // list group

      } // instance-state-attributes-mld-snooping

      grouping instance-state-source-attributes-igmp-mld-snooping {
        description

Zhao & Liu, etc        Expires November 13, 2018                [Page 28]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


          "State attributes for both IGMP and MLD Snooping of each VLAN
or l2vpn instance or EVPN instance.";

      leaf-list bridge-outgoing-interface {
         when "../../../type = 'bridge'";
         type if:interface-ref;
         description "Outgoing interface in bridge fowarding";

      }

      leaf-list l2vpn-outgoing-ac {
         when "../../../type = 'l2vpn'";
         type l2vpn-instance-ac-ref;
         description "Outgoing AC in L2VPN fowarding";

      }

      leaf-list l2vpn-outgoing-pw {
         when "../../../type = 'l2vpn'";
         type l2vpn-instance-pw-ref;
         description "Outgoing PW in L2VPN fowarding";

      }

        leaf up-time {
          type uint32;
          units seconds;
          description "The time elapsed since the device created L2
multicast record";
        }

      leaf expire {
          type uint32;
          units seconds;
          description
            "The time left before multicast group timeout.";
        }

      leaf host-count {
          if-feature explicit-tracking;
          type uint32;
          description
            "The number of host addresses.";
        }

      } // instance-state-source-attributes-igmp-mld-snooping

      grouping general-statistics-error {
        description
          "A grouping defining statistics attributes for errors.";

Zhao & Liu, etc        Expires November 13, 2018                [Page 29]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018



        leaf checksum {
          type yang:counter64;
          description
            "The number of checksum errors.";
        }
        leaf too-short {
          type yang:counter64;
          description
            "The number of messages that are too short.";
        }
      } // general-statistics-error

      grouping general-statistics-sent-received {
        description
          "A grouping defining statistics attributes.";

        leaf query {
          type yang:counter64;
          description
            "The number of query messages.";
        }
        leaf membership-report-v1 {
          type yang:counter64;
          description
            "The number of membership report v1 messages.";
        }
      leaf membership-report-v2 {
          type yang:counter64;
          description
            "The number of membership report v2 messages.";
        }
      leaf membership-report-v3 {
          type yang:counter64;
          description
            "The number of membership report v3 messages.";
        }
        leaf leave {
          type yang:counter64;
          description
            "The number of leave messages.";
        }
      leaf non-member-leave {
          type yang:counter64;
          description
            "The number of non member leave messages.";
        }
      leaf pim {
          type yang:counter64;
          description

Zhao & Liu, etc        Expires November 13, 2018                [Page 30]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            "The number of pim hello messages.";
        }
      } // general-statistics-sent-received

   grouping interface-endpoint-attributes-igmp-snooping {

      description "interface attributes for igmp snooping";

      list host {

            if-feature explicit-tracking;

            key "host-address";

            config false;

            description
               "List of multicast membership hosts
               of the specific multicast source-group.";



            leaf host-address {
               type inet:ipv4-address;
               description
               "Multicast membership host address.";
            }
            leaf host-filter-mode {
               type enumeration {
               enum "include" {
                  description
                  "In include mode";
               }
               enum "exclude" {
                  description
                  "In exclude mode.";
               }
               }
               description
               "Filter mode for a multicast membership
               host may be either include or exclude.";
            }
      }// list host
   } // interface-endpoint-attributes-igmp-snooping

   grouping interface-endpoint-attributes-mld-snooping {

      description "interface endpoint attributes mld snooping";

      list host {

Zhao & Liu, etc        Expires November 13, 2018                [Page 31]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018



            if-feature explicit-tracking;

            key "host-address";

            config false;

            description
               "List of multicast membership hosts
               of the specific multicast source-group.";

            leaf host-address {
               type inet:ipv6-address;
               description
               "Multicast membership host address.";
            }
            leaf host-filter-mode {
               type enumeration {
               enum "include" {
                  description
                  "In include mode";
               }
               enum "exclude" {
                  description
                  "In exclude mode.";
               }
               }
               description
               "Filter mode for a multicast membership
               host may be either include or exclude.";
            }
      }// list host
   } // interface-endpoint-attributes-mld-snooping

      /*
       * igmp-snooping-instance
       */
   container igmp-snooping-instances {
       description
         "igmp-snooping-instance list";


      list igmp-snooping-instance {
       key "name";
       description
                "IGMP Snooping instance to configure the igmp-
snooping.";

       leaf name {
          type string;

Zhao & Liu, etc        Expires November 13, 2018                [Page 32]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


          description
            "Name of the igmp-snooping-instance to configure the igmp
snooping.";
         }

       leaf type {
         type enumeration {
            enum "bridge" {
               description "bridge";
            }
            enum "l2vpn" {
               description "l2vpn";
            }
         }
         description "The type indicates bridge or l2vpn.";
       }


       uses instance-config-attributes-igmp-snooping {
           if-feature per-instance-config;
         }

       uses instance-state-attributes-igmp-snooping;

      } //igmp-snooping-instance
    } //igmp-snooping-instances




      /*
       * mld-snooping-instance
       */
   container mld-snooping-instances {
       description
         "mld-snooping-instance list";


      list mld-snooping-instance {
       key "name";
       description
                "MLD Snooping instance to configure the mld-snooping.";

       leaf name {
          type string;
          description
            "Name of the mld-snooping-instance to configure the mld
snooping.";
         }


Zhao & Liu, etc        Expires November 13, 2018                [Page 33]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018



       leaf type {
         type enumeration {
            enum "bridge" {
               description "bridge";
            }
            enum "l2vpn" {
               description "l2vpn";
            }
         }
         description "The type indicates bridge or l2vpn.";
       }


       uses instance-config-attributes-mld-snooping {
           if-feature per-instance-config;
         }

       uses instance-state-attributes-mld-snooping;

      } //mld-snooping-instance
    } //mld-snooping-instances



      container bridges {
       description
         "Apply igmp-mld-snooping instance in the bridge scenario";

         list bridge {
            key name;

            description
               "bridge list";

            leaf name {
               type name-type;
               description
               "bridge name";

            }
            leaf igmp-snooping-instance {
               type igmp-snooping-instance-ref;
               description "Configure igmp-snooping instance under the
bridge view";
            }
            leaf mld-snooping-instance {
               type mld-snooping-instance-ref;
               description "Configure mld-snooping instance under the
bridge view";

Zhao & Liu, etc        Expires November 13, 2018                [Page 34]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            }
            list component {
               key "name";
               description
               " ";

               leaf name {
                  type string;
                  description
                     "The name of the Component.";
               }
               container bridge-vlan {
                  description "bridge vlan";
                  list vlan {
                     key "vid";
                     description
                     "";

                     leaf vid {
                        type vlan-index-type;
                        description
                           "The VLAN identifier to which this entry
applies.";

                     }
                     leaf igmp-snooping-instance {
                        type igmp-snooping-instance-ref;
                        description "Configure igmp-snooping instance
under the vlan view";
                     }
                     leaf mld-snooping-instance {
                        type mld-snooping-instance-ref;
                        description "Configure mld-snooping instance
under the vlan view";
                     }

                  }//vlan
               }//bridge-vlan
             }//component
         }//bridge
     }   //bridges




   container l2vpn-instances {
      description "Apply igmp-mld-snooping instance in the l2vpn
scenario";

      list l2vpn-instance {

Zhao & Liu, etc        Expires November 13, 2018                [Page 35]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


         key "name";
         description "An l2vpn service instance";

         leaf name {
               type string;
               description "Name of l2vpn service instance";
         }

         leaf igmp-snooping-instance {
            type igmp-snooping-instance-ref;
            description "Configure igmp-snooping instance under the
l2vpn-instance view";
         }
         leaf mld-snooping-instance {
            type mld-snooping-instance-ref;
            description "Configure mld-snooping instance under the
l2vpn-instance view";
         }

      }
      }

   /* augments */

   augment "/if:interfaces/if:interface" {
      description "Augment interface for referencing attributes which
only fit for interface view.";

      container igmp-mld-snooping {
         description
            "igmp-mld-snooping related attributes under interface view";

         leaf enable {
            if-feature admin-enable;
            type boolean;
            default false;
            description
               "Set the value to true to enable IGMP and MLD Snooping in
the VLAN instance.";
         }

         leaf version {
            type uint8 {
               range "1..3";
            }
            description "IGMP and MLD Snooping version.";
         }

         leaf type {
            type enumeration {

Zhao & Liu, etc        Expires November 13, 2018                [Page 36]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


               enum "bridge" {
                  description "bridge";
               }
               enum "l2vpn" {
                  description "l2vpn";
               }
            }
            description "The type indicates bridge or l2vpn.";
         }

         container static-mrouter-interface {
            description
                "Container for choice static-mrouter-interface";

            choice static-mrouter-interface {
               description
                  "Configure static multicast router interface under the
interface view";

               case bridge {
                  when "../type = 'bridge'" {
                     description
                        "Applies to bridge scenario.";
                  }
                  description
                  "Applies to bridge scenario.";

                     leaf bridge-name {
                        type string;
                        description
                           "The name for a bridge. Each interface
belongs to only one bridge.";

                     }
                     leaf-list vlan-id {
                        type uint32;
                        description
                           "The vlan ids for bridge. If you don't
specify vlan id here, the interface serves as the mrouter interface for
all the vlans in this bridge.";
                     }


               }
               case l2vpn {
                  when "../type = 'l2vpn'" {
                     description
                        "Applies to l2vpn scenario.";
                  }
                  description

Zhao & Liu, etc        Expires November 13, 2018                [Page 37]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


                  "Applies to l2vpn scenario.";

                  leaf l2vpn-instance-name {
                     type string;
                     description
                        "The l2vpn instance name applied in the
interface";

                  }
               }

            } // choice static-mrouter-interface
         }  // container static-mrouter-interface

         container static-l2-multicast-group {
            description
                "Container for static-l2-multicast-group";

            choice static-l2-multicast-group {
               description
                  "Configure static l2 multicast group under the
interface view";

               case bridge {
                  when "../type = 'bridge'" {
                     description
                        "Applies to bridge scenario.";
                  }
                  description
                  "Applies to bridge scenario.";

                  leaf bridge-name {
                     type string;
                     description
                        "bridge name.";

                  }

                  list bridge-group-v4 {


                     key "group source-addr";
                     description
                     "A static multicast route, (*,G) or (S,G).";

                     leaf group {
                        type inet:ipv4-address;
                        description
                        "Multicast group IPV4 address";
                     }

Zhao & Liu, etc        Expires November 13, 2018                [Page 38]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018



                     leaf source-addr {
                        type source-ipv4-addr-type;
                        description
                           "Multicast source IPV4 address.";
                     }

                     leaf-list vlan-id {
                        type uint32;
                        description
                           "vlan id.";
                     }

                  }

                  list bridge-group-v6 {
                     key "group source-addr";
                     description
                     "A static multicast route, (*,G) or (S,G).";

                     leaf group {
                        type inet:ipv6-address;
                        description
                        "Multicast group IPV6 address";
                     }

                     leaf source-addr {
                        type source-ipv6-addr-type;
                        description
                           "Multicast source IPV6 address.";
                     }

                     leaf-list vlan-id {
                        type uint32;
                        description
                           "vlan id.";
                     }

                  }

               }
               case l2vpn {

                  when "../type = 'l2vpn'" {
                     description
                        "Applies to l2vpn scenario.";
                  }
                  description
                  "Applies to l2vpn scenario.";


Zhao & Liu, etc        Expires November 13, 2018                [Page 39]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


                  list l2vpn-group-v4 {
                     key "group source-addr";
                     description "A static multicast route, (*,G) or
(S,G).";

                     leaf group {
                        type inet:ipv4-address;
                        description
                           "Multicast group IPV4 address";
                     }

                     leaf source-addr {
                        type source-ipv4-addr-type;
                        description
                           "Multicast source IPV4 address.";
                     }

                     leaf l2vpn-instance-name {
                        type string;
                        description
                           "The l2vpn instance name applied in the
interface";

                     }
                  }
                  list l2vpn-group-v6 {

                     key "group source-addr";

                     description
                        "A static multicast route, (*,G) or (S,G).";

                     leaf group {
                        type inet:ipv6-address;
                        description
                        "Multicast group IPV6 address";
                     }

                     leaf source-addr {
                        type source-ipv6-addr-type;
                        description
                           "Multicast source IPV6 address.";
                     }

                     leaf l2vpn-instance-name {
                        type string;
                        description
                           "The l2vpn instance name applied in the
interface";


Zhao & Liu, etc        Expires November 13, 2018                [Page 40]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


                     }
                  }
               }

            } //choice static-l2-multicast-group

         } // container static-l2-multicast-group



         container statistics {
            config false;
            description
            "A collection of interface-related statistics objects.";

            uses general-state-attributes;

         }

      }

   }


   /*  RPCs  */

   rpc clear-igmp-snooping-groups {
        if-feature rpc-clear-groups;
        description
          "Clears the specified IGMP Snooping cache tables.";

        input {

        leaf name {
         type string;
         description
            "Name of the igmp-snooping-instance";
        }

          leaf group {
            type inet:ipv4-address;
            description
              "Multicast group IPv4 address.
               If it is not specified, all IGMP snooping group tables
are
               cleared.";
          }

          leaf source {
            type inet:ipv4-address;

Zhao & Liu, etc        Expires November 13, 2018                [Page 41]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            description
              "Multicast source IPv4 address.
               If it is not specified, all IGMP snooping source-group
tables are
               cleared.";
          }
        }
      } // rpc clear-igmp-snooping-groups

     rpc clear-mld-snooping-groups {
        if-feature rpc-clear-groups;
        description
          "Clears the specified MLD Snooping cache tables.";

        input {
          leaf name {
         type string;
         description
            "Name of the mld-snooping-instance";
        }

          leaf group {
            type inet:ipv6-address;
            description
              "Multicast group IPv6 address.
               If it is not specified, all MLD snooping group tables are
               cleared.";
          }

          leaf source {
            type inet:ipv6-address;
            description
              "Multicast source IPv6 address.
               If it is not specified, all MLD snooping source-group
tables are
               cleared.";
          }
        }
      } // rpc clear-mld-snooping-groups
}
<CODE ENDS>




4. Security Considerations

   The YANG module specified in this document defines a schema for data
   that is designed to be accessed via network management protocols such
   as NETCONF [RFC6241] or RESTCONF [RFC8040]. The lowest NETCONF layer

Zhao & Liu, etc        Expires November 13, 2018                [Page 42]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


   is the secure transport layer, and the mandatory-to-implement secure
   transport is Secure Shell (SSH) [RFC6242]. The lowest RESTCONF layer
   is HTTPS, and the mandatory-to-implement secure transport is TLS
   [RFC5246].

   The NETCONF access control model [RFC6536] provides the means to
   restrict access for particular NETCONF or RESTCONF users to a
   preconfigured subset of all available NETCONF or RESTCONF protocol
   operations and content.

   There are a number of data nodes defined in this YANG module that are
   writable/creatable/deletable (i.e., config true, which is the
   default). These data nodes may be considered sensitive or vulnerable
   in some network environments. Write operations (e.g., edit-config) to
   these data nodes without proper protection can have a negative effect
   on network operations. These are the subtrees and data nodes and
   their sensitivity/vulnerability:

   /ims:igmp-snooping-instances/ims:igmp-snooping-instance

   /ims:mld-snooping-instances/ims:mld-snooping-instance

   /if:interfaces/if:interface/ims:igmp-mld-snooping

   Unauthorized access to any data node of these subtrees can adversely
   affect the IGMP & MLD Snooping subsystem of both the local device and
   the network. This may lead to network malfunctions, delivery of
   packets to inappropriate destinations, and other problems.

   Some of the readable data nodes in this YANG module may be considered
   sensitive or vulnerable in some network environments. It is thus
   important to control read access (e.g., via get, get-config, or
   notification) to these data nodes. These are the subtrees and data
   nodes and their sensitivity/vulnerability:

   /ims:igmp-snooping-instances/ims:igmp-snooping-instance

   /ims:mld-snooping-instances/ims:mld-snooping-instance

   /if:interfaces/if:interface/ims:igmp-mld-snooping

   Unauthorized access to any data node of these subtrees can disclose
   the operational state information of IGMP & MLD Snooping on this
   device.

   Some of the RPC operations in this YANG module may be considered
   sensitive or vulnerable in some network environments. It is thus
   important to control access to these operations. The IGMP & MLD
   Snooping Yang module support the "clear-igmp-snooping-groups" and "
   clear-mld-snooping-groups" RPCs. If it meets unauthorized RPC

Zhao & Liu, etc        Expires November 13, 2018                [Page 43]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


   operation invocation, the IGMP and MLD Snooping group tables will be
   cleared unexpectedly.



5. IANA Considerations

   RFC Ed.: In this section, replace all occurrences of 'XXXX' with the
   actual RFC number (and remove this note).

   This document registers the following namespace URIs in the IETF XML

   registry [RFC3688]:



   --------------------------------------------------------------------

   URI: urn:ietf:params:xml:ns:yang:ietf-igmp-mld-snooping

   Registrant Contact: The IESG.

   XML: N/A, the requested URI is an XML namespace.

   --------------------------------------------------------------------



   This document registers the following YANG modules in the YANG
   Module Names registry [RFC7950]:

   --------------------------------------------------------------------

   name:         ietf-igmp-mld-snooping

   namespace:    urn:ietf:params:xml:ns:yang:ietf-igmp-mld-snooping

   prefix:       ims

   reference:    RFC XXXX

   --------------------------------------------------------------------



6. Normative References

   [RFC6020] Bjorklund, M., Ed., "YANG - A Data Modeling Language for
             the Network Configuration Protocol (NETCONF)", RFC 6020,
             October 2010.

Zhao & Liu, etc        Expires November 13, 2018                [Page 44]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


   [RFC6021] Schoenwaelder, J., Ed., "Common YANG Data Types", RFC 6021,
             October 2010.

   [RFC4541] M. Christensen, K. Kimball, F. Solensky, "Considerations
             for Internet Group Management Protocol (IGMP) and Multicast
             Listener Discovery (MLD) Snooping Switches", RFC 4541, May
             2006.

   [RFC2236] Fenner, W., "Internet Group Management Protocol, Version
             2", RFC 2236, November 1997.

   [RFC2710] Deering, S., Fenner, W., and B. Haberman, "Multicast
             Listener Discovery (MLD) for IPv6", RFC 2710, October 1999.

   [RFC3376] Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
             Thyagarajan, "Internet Group Management Protocol, Version
             3", RFC 3376, October 2002.

   [RFC3810] Vida, R. and L. Costa, "Multicast Listener Discovery
             Version 2 (MLDv2) for IPv6", RFC 3810, June 2004.

   [RFC4604] Holbrook, H., Cain, B., and B. Haberman, "Using
             InternetGroup Management Protocol Version 3 (IGMPv3) and
             Multicast Listener Discovery Protocol Version 2 (MLDv2) for
             Source-Specific Multicast", RFC 4604, August 2006.

   [RFC4607] Holbrook, H. and B. Cain, "Source-Specific Multicast for
             IP", RFC 4607, August 2006.

   [draft-ietf-pim-igmp-mld-yang-01] X. Liu, F. Guo, M. Sivakumar, P.
             McAllister, A. Peter, "A YANG data model for Internet Group
             Management Protocol (IGMP) and Multicast Listener Discovery
             (MLD)", draft-ietf-pim-igmp-mld-yang-01, October 28, 2016.

   [draft-ietf-pim-igmp-mld-yang-03] X. Liu, F. Guo, M. Sivakumar, P.
             McAllister, A. Peter, "A YANG data model for Internet Group
             Management Protocol (IGMP) and Multicast Listener Discovery
             (MLD)", draft-ietf-pim-igmp-mld-yang-03, March 13, 2017.

   [draft-dsdt-nmda-guidelines-01] M. Bjorklund, J. Schoenwaelder, P.
             Shafer, K. Watsen, R. Wilton, "Guidelines for YANG Module
             Authors (NMDA)", draft-dsdt-nmda-guidelines-01, May 2017

   [draft-bjorklund-netmod-rfc7223bis-00] M. Bjorklund, "A YANG Data
             Model for Interface Management",  draft-bjorklund-netmod-
             rfc7223bis-00, August 21, 2017

   [draft-bjorklund-netmod-rfc7277bis-00] M. Bjorklund, "A YANG Data
             Model for IP Management", draft-bjorklund-netmod-
             rfc7277bis-00, August 21, 2017

Zhao & Liu, etc        Expires November 13, 2018                [Page 45]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


   [draft-ietf-netmod-revised-datastores-03] M. Bjorklund, J.
             Schoenwaelder, P. Shafer, K. Watsen, R. Wilton, "Network
             Management Datastore Architecture", draft-ietf-netmod-
             revised-datastores-03, July 3, 2017

   [draft-ietf-bess-evpn-yang-02] P.Brissette, A. Sajassi, H. Shah, Z.
             Li, H. Chen, K. Tiruveedhula, I. Hussain, J. Rabadan, "Yang
             Data Model for EVPN", draft-ietf-bess-evpn-yang-02, March
             13, 2017

   [draft-ietf-bess-l2vpn-yang-06] H. Shah, P. Brissette, I. Chen, I.
             Hussain, B. Wen, K. Tiruveedhula, "YANG Data Model for
             MPLS-based L2VPN", draft-ietf-bess-l2vpn-yang-06.txt, June
             30, 2017



Appendix A.  Data Tree Example

This section contains an example of an instance data tree in the JSON

encoding [RFC7951], containing both configuration and state data.

             |                            +-------+           | 
             |  			  	   eth2/1 |       | eth2/2    |    +------------+  
             |				        +-----+  R2   +-----------+----+ Receiver 1 +  
             |                      |     |       |           |    +------------+
             |                      |     +-------+           |
			 |                      |                         |
             |  +-------+ eth1/2    |     +-------+           |
             |  |       +-----------+     |       | eth3/2    |	   +------------+  
      eth1/1 +--+  R1   |                 |  R3   +-----------+----+ Receiver 2 + 
             |  |       +-----------------+       |           |    +------------+  
  +-------+  |  +-------+ eth1/3   eth3/1 +-------+           |
  |       |  |                                                |
  |       +--+                                                |
  |       |  |                                                |
  |	      |	 |			                                      |
  +-------+  |                                                |
   Source                







Zhao & Liu, etc        Expires November 13, 2018                [Page 46]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


The configuration instance data tree for R1 in the above figure could be
as follows:

{

"ietf-igmp-mld-snooping:igmp-snooping-instances": {

      "igmp-snooping-instance": [

        {

          "name": "ins101",

          "type": "bridge",

          "enable": true

        }

      ]

    },

"ietf-igmp-mld-snooping:mld-snooping-instances": {

      "mld-snooping-instance": [

        {

          "name": "ins102",

          "type": "bridge",

          "enable": true

        }

      ]

    },

"ietf-igmp-mld-snooping:bridges": {

      "bridge": [

        {

          "name": "isp",

          "component": [


Zhao & Liu, etc        Expires November 13, 2018                [Page 47]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


            {

              "name": "comp1",

              "bridge-vlan": {

                "vlan": [

                  {

                    "vid": 101,

                    "igmp-snooping-instance": "ins101"

                  },

                  {

                    "vid": 102,

                    "mld-snooping-instance": "ins102"

                  }

                ]

              }

            }

          ]

        }

      ]

    }

  }

The corresponding operational state data for R1 could be as follows:

{

    "ietf-igmp-mld-snooping:igmp-snooping-instances": {

      "igmp-snooping-instance": [

        {

          "name": "ins101",

Zhao & Liu, etc        Expires November 13, 2018                [Page 48]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


          "type": "bridge",

          "enable": true,

                 "forwarding-mode": "ip",

                 "explicit-tracking": false,

                 "exclude-lite": false,

                 "send-query": true,

                 "immediate-leave": [null],

                 "last-member-query-interval": 1,

                 "query-interval": 125,

                 "query-max-response-time": 10,

                 "require-router-alert": false,

                 "robustness-variable": 2,

                 "entries-count": 1,

                 "bridge-mrouter-interface": ["1/1"],

                 "group": [

            {

              "address": "223.0.0.1",

              "mac-address": "01:00:5e:00:00:01",

                    "expire": 120,

                    "up-time": 180,

                    "last-reporter": "100.0.0.1",

                    "source": [

                {

                  "address": "192.168.0.1",

                  "bridge-outgoing-interface": ["1/2"],

                       "up-time": 180,

Zhao & Liu, etc        Expires November 13, 2018                [Page 49]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


                       "expire": 120,

                       "last-reporter": "100.0.0.1"

                }

              ]

            }

          ]

        }

      ]

    },

"ietf-igmp-mld-snooping:mld-snooping-instances": {

      "mld-snooping-instance": [

        {

          "name": "ins102",

          "type": "bridge",

          "enable": true,

                 "forwarding-mode": "ip",

                 "explicit-tracking": false,

                 "exclude-lite": false,

                 "send-query": true,

                 "immediate-leave": [null],

                 "last-member-query-interval": 1,

                 "query-interval": 125,

                 "query-max-response-time": 10,

                 "require-router-alert": false,

                 "robustness-variable": 2,

                 "entries-count": 1,

Zhao & Liu, etc        Expires November 13, 2018                [Page 50]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


                 "bridge-mrouter-interface": ["1/1"],

                 "group": [

            {

              "address": "FF0E::1",

              "mac-address": "01:00:5e:00:00:01",

                    "expire": 120,

                    "up-time": 180,

                    "last-reporter": "2001::1",

                    "source": [

                {

                  "address": "3001::1",

                  "bridge-outgoing-interface": ["1/2"],

                       "up-time": 180,

                       "expire": 120,

                       "last-reporter": "2001::1"

                }

              ]

            }

          ]

        }

      ]

   }









Zhao & Liu, etc        Expires November 13, 2018                [Page 51]

Internet-Draft      IGMP & MLD Snooping Yang Model             May 2018


Authors' Addresses

   Hongji Zhao
   Ericsson (China) Communications Company Ltd.
   Ericsson Tower, No. 5 Lize East Street,
   Chaoyang District Beijing 100102, P.R. China

   Email: hongji.zhao@ericsson.com



   Xufeng Liu
   Jabil
   8281 Greensboro Drive, Suite 200
   McLean VA 22102
   USA

   EMail: Xufeng.liu.ietf@gmail.com




   Yisong Liu
   Huawei Technologies
   Huawei Bld., No.156 Beiqing Rd.
   Beijing 100095
   China

   Email: liuyisong@huawei.com




   Anish Peter
   Individual

   EMail: anish.ietf@gmail.com




   Mahesh Sivakumar
   Cisco Systems
   510 McCarthy Boulevard
   Milpitas, California
   USA


   EMail: sivakumar.mahesh@gmail.com


Zhao & Liu, etc        Expires November 13, 2018                [Page 52] 
