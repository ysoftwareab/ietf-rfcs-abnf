<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Mailing List Manager (MLM) Transformations</title>
<meta content="Alessandro Vesely" name="author">
<meta content="
       
 The widespread adoption of Domain-based Message Authentication,
 Reporting, and Conformance (DMARC) led Mailing List Managers (MLM)
 to rewrite the From: header field as a workaround. 
       
 This document describes cases where it is possible to revert
 MLM transformations and hence verify DomainKeys Identified Mail
 (DKIM) signatures that were applied at submission time.  For reliable
 results, some compliance is required of all agents involved, author
 domain signers, MLMs, forwarders, and final recipients. 
       
 MLM transformation reversion reduces the DMARC's effects on indirect
 mail flows. 
    " name="description">
<meta content="xml2rfc 3.4.0" name="generator">
<meta content="DMARC" name="keyword">
<meta content="DKIM" name="keyword">
<meta content="Mailing List" name="keyword">
<meta content="draft-dmarc-vesely-mlm-transform-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.4.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.24.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/draft-dmarc-vesely-mlm-transform-56ooroq1.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">MLM Transformations</td>
<td class="right">November 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Vesely</td>
<td class="center">Expires 20 May 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dmarc-vesely-mlm-transform-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-11" class="published">November 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-05-20">20 May 2021</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Vesely</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Mailing List Manager (MLM) Transformations</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 The widespread adoption of Domain-based Message Authentication,
 Reporting, and Conformance (DMARC) led Mailing List Managers (MLM)
 to rewrite the From: header field as a workaround.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
 This document describes cases where it is possible to revert
 MLM transformations and hence verify DomainKeys Identified Mail
 (DKIM) signatures that were applied at submission time.  For reliable
 results, some compliance is required of all agents involved, author
 domain signers, MLMs, forwarders, and final recipients.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
 MLM transformation reversion reduces the DMARC's effects on indirect
 mail flows.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 May 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terms-definitions" class="xref">Terms Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-revertible-transformations" class="xref">Revertible Transformations</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-header-transformations" class="xref">Header Transformations</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-body-transformations" class="xref">Body Transformations</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-outline-of-a-reverting-veri" class="xref">Outline of a Reverting Verifier</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-actors-roles-and-compliance" class="xref">Actors Roles and Compliance</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-original-signer" class="xref">Original Signer</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-mlm" class="xref">MLM</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-verifier" class="xref">Verifier</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-permanent-message-header-fi" class="xref">Permanent Message Header Field Names</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-single-part-plain-text" class="xref">Single-part plain text</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-multipart-added" class="xref">Multipart added</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-multipart-wrapped" class="xref">Multipart wrapped</a><a href="#section-toc.1-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
 Mailing List Managers (MLMs) can be configured to add a footer and 
 a subject tag to the messages that they redistribute.  Although 
 that behavior slightly exceeds the very limited set of 
 modifications and actions described by <span><a href="https://rfc-editor.org/rfc/rfc5321#section-3.9.2" class="relref">Section 3.9.2</a> of [<a href="#RFC5321" class="xref">RFC5321</a>]</span>, it is a welcome, time-honored 
 tradition.  According to their configuration, the modifications 
 they carry out on messages may result in a set of stylized transformations 
 that are programmatically revertible. Reversion allows to verify 
 DomainKeys Identified Mail (DKIM) signatures (<span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>) that were applied before the 
 transformation.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
 Domain-based Message Authentication, Reporting, and Conformance
 (DMARC) (<span>[<a href="#I-D.ietf-dmarc-dmarcbis" class="xref">I-D.ietf-dmarc-dmarcbis</a>]</span>) hinges on the alignment of the
 domain in the From: header field with a verified DKIM signature.
 For that reason, MLMs that transform messages have to rewrite From:.
 A deed which can be mitigated in some cases.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
 Mailbox providers can configure their mail submission agents (MSAs)
 in order to ease MLM transformation reversion.  Or they can make it
 impossible.  It is their policy and their will.
 MLM operators make a similar decision.
 When they both agree on revertibility, a well equipped receiver can
 verify the original signatures.
 The outcome is twofold:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-4">
 <li id="section-1-4.1">
 Author domains receive positive feedback about DKIM verification
 of mailing list traffic.  That might eventually lead them to harden
 their DMARC policy.<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
        <li id="section-1-4.2">
 Final recipient's mail delivery agents (MDAs), which know by the
 Authentication-Results: field whether a rewritten From: header was
 verified, can safely undo From: munging (after any external
 forwarding).<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
      </ol>
</section>
<section id="section-2">
      <h2 id="name-terms-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terms-definitions" class="section-name selfRef">Terms Definitions</a>
      </h2>
<p id="section-2-1">
 <strong>Signers</strong> and <strong>verifiers</strong> are defined
 in <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>.  The use of the term <strong>Mailing List 
 Manager</strong>, almost always abbreviated <strong>MLM</strong>
 follows <span>[<a href="#RFC6377" class="xref">RFC6377</a>]</span>.  A MLM is a kind of
 <strong>Mediator</strong> in <span>[<a href="#RFC5598" class="xref">RFC5598</a>]</span> parlance.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
 <strong>Message</strong> is defined in <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>.  It
 consists of a <strong>header</strong> made up of one or more
 <strong>fields</strong> and a <strong>body</strong>, possibly
 composed of various MIME <strong>entities</strong>, the latter
 being defined in <span>[<a href="#RFC2045" class="xref">RFC2045</a>]</span> and companions.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
 The term <strong>original</strong> is used here to refer to the Author
 or parts of the Author's message as it was sent out by the Author's
 domain, where <strong>Author</strong> is defined in
 <span>[<a href="#RFC5598" class="xref">RFC5598</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
<div id="trans">
<section id="section-3">
      <h2 id="name-revertible-transformations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-revertible-transformations" class="section-name selfRef">Revertible Transformations</a>
      </h2>
<p id="section-3-1">
 Message modifications can affect the header and/or the body of a
 message.  This document only considers the very limited set of
 transformation described in the following subsections.
 They turn out to be revertible.<a href="#section-3-1" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-header-transformations">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-header-transformations" class="section-name selfRef">Header Transformations</a>
        </h3>
<p id="section-3.1-1">
 MLM often modify the Subject: field by inserting a tag at the
 beginning of its value.  A tag consists of a short text delimited
 by square brackets.  For example::<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="section-3.1-2">
<pre class="sourcecode">
  Subject: [added tag] Original value of subject
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">
 This transformation is easily reverted by removing the tag.
 For security reasons, subject tags must not exceed 20 characters.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
 A more recent modification carried out by MLMs is From: rewriting.
 It alters the value of From: in order to pass DMARC filters.  MLMs
 save the original value of From: in a variety of places,
 including Reply-To:, Cc:, X-Original-From:.  When the original
 value is known, the transformation is revertible.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-body-transformations">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-body-transformations" class="section-name selfRef">Body Transformations</a>
        </h3>
<p id="section-3.2-1">
 Footer addition is often performed in one of three ways, according
 to the format of the original message.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.2-2">
          <dt id="section-3.2-2.1">
 Single-part plain text</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.2">
 When the original message is not structured, a footer can be appended
 at the end of the original text.
 See example in <a href="#example-single" class="xref">Appendix A.1</a><a href="#section-3.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-2.3">
 Multipart added</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.4">
 The footer stands in its own MIME entity, which is appended as the
 last part of an original multipart/mixed structure.
 See example in <a href="#example-added" class="xref">Appendix A.2</a><a href="#section-3.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-2.5">
 Multipart wrapped</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.6">
 The footer stands in the second entity of a new multipart/mixed
 MIME structure whose first entity consists of the original body.
 See example in <a href="#example-wrapped" class="xref">Appendix A.3</a><a href="#section-3.2-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-3">
 The footer begins with a line consisting exclusively of underscore 
 ("_", ASCII 95) characters, at least four of them.  For security 
 reasons, the footer must belong to an entity of Content-Type: 
 text/plain in all cases.  In addition, footers cannot exceed 10 
 lines of text, each shorter than 80 characters.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="algo">
<section id="section-4">
      <h2 id="name-outline-of-a-reverting-veri">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-outline-of-a-reverting-veri" class="section-name selfRef">Outline of a Reverting Verifier</a>
      </h2>
<p id="section-4-1">
 The algorithm described here is implemented in a mail filter. It 
 usually reads the input message twice -first pass, verify; last 
 pass, write Authentication-Results and the rest of the message to 
 follow.  When enabling MLM transformation reversion, there can be a 
 retry pass in between those two.
 The result is yielded during the SMTP dialogue with no noticeable 
 delay. Implementing reversion changed the software from 22730 lines 
 of C code to 26762.  The bulk of such ~18% increase is due to the 
 addition of encoding conversion functions. Changes involve both 
 verifying and signing functions (see <a href="#sigrole" class="xref">Section 5.1</a> for 
 the latter).<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
 While reading the header in the first pass, the verifier looks for
 specific fields:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">From:<a href="#section-4-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.2">Original-From:<a href="#section-4-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.3">X-Original-From:<a href="#section-4-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.4">Reply-To:<a href="#section-4-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.5">Cc:<a href="#section-4-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-4">
 These are candidates to the original mailbox.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
 The verifier also collects the Subject: and any field named 
 Original-* that the original signer might have set to ease the
 reversion.
 At the end of the header, candidate original mailboxes are
 sorted according to the display name, which MLMs try and keep
 unaltered.  The best candidate is then added to the collected
 set of Original-* fields.
 If the Subject: begins with a tag, its version without tag is added
 to that set as well, unless one is there already.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">
 Next, before reading the body, the verifier looks for prospect
 signatures; that is, signatures whose "d=" domain is not aligned with
 SPF credentials (<span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span>),
 List-Post: (<span>[<a href="#RFC4201" class="xref">RFC4201</a>]</span>), Sender:, or the rewritten From:
 (if deemed to have been rewritten).  If any such signature exist,
 along with MLM or other signatures, then the verifier enables parsing
 the body to look for a footer.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">
 Body parsing is done in parallel with body canonicalization during
 the first pass.
 For multipart, track top level entities.  Set transformation type
 to "wrapped" if there are exactly two entities, "added" otherwise.
 For single-part, body parsing must avail of encoding conversions as
 needed.  Assume identity encoding, 7bit or 8bit, unless
 otherwise directed by an Original-Content-Transfer-Encoding: field.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">
 At the end of the first pass, the verifier knows how prospect
 signatures did.  Let's recall that DKIM signature verification
 results from two independent operations, steps 3 and 4 in
 <span><a href="https://rfc-editor.org/rfc/rfc6376#section-6.1.3" class="relref">Section 6.1.3</a> of [<a href="#RFC6376" class="xref">RFC6376</a>]</span>.
 The signature in the "b=" tag depends on the header, while the body
 hash in the "bh=" tag depends on the body:<a href="#section-4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-9.1">
 If the signature "b=" did not verify and the set of Original-* fields
 is not empty, then it is worth to try and re-canonicalize the header
 using the values in the set of Original-* fields.<a href="#section-4-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-9.2">
 If the body hash "bh=" did not match and a footer was found, then it
 is worth to try and re-canonicalize the body excluding the footer.<a href="#section-4-9.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-10">
 None, one, or both of the above operations are performed in the retry pass.<a href="#section-4-10" class="pilcrow">¶</a></p>
<p id="section-4-11">
 On writing Authentication-Results, if a prospect signature verifies
 after replacing the From: field,
 the verifier writes a prominent, well documented "reason" in the
 relevant resinfo stanza
 (<span><a href="https://rfc-editor.org/rfc/rfc7601#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC7601" class="xref">RFC7601</a>]</span>).
 That way, reversion elements can be easily recognized and parsed by
 downstream agents.<a href="#section-4-11" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5">
      <h2 id="name-actors-roles-and-compliance">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-actors-roles-and-compliance" class="section-name selfRef">Actors Roles and Compliance</a>
      </h2>
<div id="sigrole">
<section id="section-5.1">
        <h3 id="name-original-signer">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-original-signer" class="section-name selfRef">Original Signer</a>
        </h3>
<p id="section-5.1-1">
 Signers who wish their users to be able to participate to mailing
 lists can adopt rules apt to ease MLM transformations reversion.
 Doing so can slightly weaken DKIM'S stiffness, and expose to the
 risk of malicious MLMs.
 A sender that doesn't know which of its mail recipients are
 likely to be MLMs might abide by the following rules for all outgoing
 mail, in the expectation that few of its users correspondents are
 likely to be malicious.  A sender that had some idea which recipients
 are MLMs could apply the rules only to mail to those recipients.
 Or a sender might apply the rules to all mail except that sent to
 recipients with poor reputations.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
 A special rule is the addition of an Original-From: header field
 with a value identical to the one signed in From:.  Original-From:
 is defined by
 <span>[<a href="#RFC5703" class="xref">RFC5703</a>]</span> in the context of Sieve Email Filtering.
 As Sieve operates at time of final delivery, DKIM verifiers which
 act at the time of message transit can reliably use it.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">
 Original-From: is special because verifiers may infer that the field
 was added by the original signer rather than by MLMs.  In that case,
 they can send DMARC feedback reports to the original signer even if
 From: was rewritten.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">
 Other generic rules to ease reversion are as follows:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-5.1">
 DKIM signatures must deploy the "relaxed" canonicalization, at least
 for the header, since MLMs may reflow header fields.<a href="#section-5.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-5.2">
 The quoted-printable encoding must not be used for the body of
 single-part text/plain messages, as it is impossible to guess
 original soft line breaks after re-encoding.  Base64 is much more
 robust.<a href="#section-5.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-5.3">
 Single-part text/plain messages encoded as base64 must follow a
 constant column width of 76 characters.  The encoding must be
 advertised by adding a new header field as follows:<a href="#section-5.1-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<div id="section-5.1-6">
<pre class="sourcecode">
  Original-Content-Transfer-Encoding: base64
</pre><a href="#section-5.1-6" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-5.1-7.1">
 If the original Subject: begins with a tag, its value must be copied
 to an Original-Subject: header field.  The latter field
 is also defined by <span>[<a href="#RFC5703" class="xref">RFC5703</a>]</span>, and the same usage
 considerations hold.<a href="#section-5.1-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-7.2">
 Content-Type: and Content-Transfer-Encoding: are fields related to
 the data form.  Mailers often rewrite them, so they should not be
 signed.  If signed, their Original- counterpart should be set too.<a href="#section-5.1-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-7.3">
 When signing Cc: or Reply-To:, add their Original- counterparts to
 the header, as MLMs are likely to change them.<a href="#section-5.1-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-7.4">
 Original-*: fields
 with an empty value stand for non-existing counterparts.<a href="#section-5.1-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-7.5">
 Original-* fields need not be signed.  If original signatures can be
 recovered, that suffices; otherwise, the unverified signature
 is irrelevant.<a href="#section-5.1-7.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<section id="section-5.2">
        <h3 id="name-mlm">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-mlm" class="section-name selfRef">MLM</a>
        </h3>
<p id="section-5.2-1">
 Participating MLMs must not operate transformations other than those
 listed in <a href="#trans" class="xref">Section 3</a>.  Since DKIM is MIME-agnostic,
 attention must be paid to preserve the exact preamble and epilogue
 of the original MIME structure.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
 MLMs must apply their own DKIM signature.  The presence of signatures
 by multiple domains can be used by verifiers to infer that a message
 underwent MLM transformations.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
 MLMs must not set
 the Original-From: field, which is reserved to original signers.  It
 is recommended that MLMs add a mailbox entry to Reply-To: or Cc: in order
 to ease off-list replies as well as to allow transformation reversion,
 but only in case the Original-From: is missing.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">
 MLMs may set Original-* fields other than Original-From:,
 but only if the original message contains no Original-* field at all.
 That is, when the author's domain is not aware of the possibility to
 ease MLM transformation reversion.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">
 MLMs which collect posts from other MLMs must avoid to add their
 own footer and subject tag.  Transformation reversion cannot be stacked.
 A second-level MLM can modify or replace the content of previous
 transformations.  Attention must be paid to not exceed tag and footer
 length limits.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
<section id="section-5.3">
        <h3 id="name-verifier">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-verifier" class="section-name selfRef">Verifier</a>
        </h3>
<p id="section-5.3-1">
 Attempts to verify original signatures can be done as outlined
 in <a href="#algo" class="xref">Section 4</a>.  The reversion must not replace the
 messages signed and distributed by MLMs, with one exception detailed
 in the next paragraph.
 Only the result of the verification is written out.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
 If an original signature with rewritten From: is recovered, the
 verifier must make sure that an Original-From: field with the
 verified mailbox is written out.  An MDA downstream may combine
 the Authentication-Results: and Original-From: fields
 to restore the original value of From:.  This is the only recommended
 modification to the distributed message.  It must be done after any
 dot-forward processing, so that external verifiers receive the
 message as distributed by the MLM, and can revert transformations
 by themselves.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">
 If the Original-From: is set, the corresponding DMARC record may be
 looked up and its "rua=" and "ruf=" tags considered for feedback
 reports.  If DMARC policies are considered, it is the the From: field
 which rules, not the Original-From: nor any other mailbox value,
 unless verified.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">
 Rewriting the From: header field is an unwelcome modification to
 messages.  It fosters the belief that the display name of a
 mailbox is more trustworthy than the angle address.  A belief
 further consented by the tendency to not even display the latter.
 Bad actors take advantage of this belief by displaying the names of
 trusted institution paired with trash email addresses hidden between
 angle brackets.  That trick defeats DMARC's purpose.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
 It is out of this document's scope to suggest how mail user agents
 (MUAs) could counter phishing by highlighting security indicators
 (for the extent that indicators can actually help preventing phishing attacks).
 Let's just note that MUAs have to cope with MLM and phishing alike,
 which makes it hard to devise a pattern to tell apart one from the
 other without getting involved with the reputation of the specific
 domains.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
 By safely restoring munged From: to the original value, that contrast
 is eliminated.  Then, perhaps, deceptive mailboxes might become
 amenable to some kind of efficient indication.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
 Of course, MLM role can be played by miscreants as well.  However,
 replaying a signed message, even with revertible transformations, has
 more limits than forging scam messages anew.  Therefore, the risk
 introduced by easing transformation reversion is considerably
 lower than that of not signing, or of keeping DMARC policy at "none".<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">
 Compared with the use of "l=" tag (<span><a href="https://rfc-editor.org/rfc/rfc6376#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC6376" class="xref">RFC6376</a>]</span>), the fact that footers are
 written in plain text removes the main security objection about
 footer additions.
 Namely, footers cannot completely replace the original content in
 the end recipient's eyes by exploiting lax HTML parsing in the MUA.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">
 Still, a footer can contain dangerous URLs and deceiving text.  That
 possibility has to be countered by usual mail filtering and savvy
 behavior.<a href="#section-6-6" class="pilcrow">¶</a></p>
</section>
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">
 IANA maintains the "Message Header" registry with several subregistries.
 IANA is asked to make the assignments set out in the following section.<a href="#section-7-1" class="pilcrow">¶</a></p>
<section id="section-7.1">
        <h3 id="name-permanent-message-header-fi">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-permanent-message-header-fi" class="section-name selfRef">Permanent Message Header Field Names</a>
        </h3>
<p id="section-7.1-1">
 IANA is asked to create new entries in the "Permanent Message
 Header Field Names" registry as follows.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Header Field Name</th>
              <th class="text-left" rowspan="1" colspan="1">Template</th>
              <th class="text-left" rowspan="1" colspan="1">Protocol</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Original-Content-Transfer-Encoding</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
              <td class="text-left" rowspan="1" colspan="1">mail</td>
              <td class="text-left" rowspan="1" colspan="1">standard</td>
              <td class="text-left" rowspan="1" colspan="1">this I-D</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Original-Reply-To</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
              <td class="text-left" rowspan="1" colspan="1">mail</td>
              <td class="text-left" rowspan="1" colspan="1">standard</td>
              <td class="text-left" rowspan="1" colspan="1">this I-D</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Original-Cc</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
              <td class="text-left" rowspan="1" colspan="1">mail</td>
              <td class="text-left" rowspan="1" colspan="1">standard</td>
              <td class="text-left" rowspan="1" colspan="1">this I-D</td>
            </tr>
          </tbody>
        </table>
</section>
</section>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span><span class="refAuthor"> and N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5321">[RFC5321]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Simple Mail Transfer Protocol"</span>, <span class="seriesInfo">RFC 5321</span>, <span class="seriesInfo">DOI 10.17487/RFC5321</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5321">https://www.rfc-editor.org/info/rfc5321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6376">[RFC6376]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor">, Hansen, T., Ed.</span><span class="refAuthor">, and M. Kucherawy, Ed.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Signatures"</span>, <span class="seriesInfo">STD 76</span>, <span class="seriesInfo">RFC 6376</span>, <span class="seriesInfo">DOI 10.17487/RFC6376</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6376">https://www.rfc-editor.org/info/rfc6376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dmarc-dmarcbis">[I-D.ietf-dmarc-dmarcbis]</dt>
      <dd>
<span class="refAuthor">Gustafsson, E.</span><span class="refAuthor">, Herr, T.</span><span class="refAuthor">, and J. Levine</span>, <span class="refTitle">"Domain-based Message Authentication, Reporting, and Conformance (DMARC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dmarc-dmarcbis-00</span>, <time datetime="2020-11-11" class="refDate">11 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-dmarc-dmarcbis-00">https://tools.ietf.org/html/draft-ietf-dmarc-dmarcbis-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4201">[RFC4201]</dt>
        <dd>
<span class="refAuthor">Kompella, K.</span><span class="refAuthor">, Rekhter, Y.</span><span class="refAuthor">, and L. Berger</span>, <span class="refTitle">"Link Bundling in MPLS Traffic Engineering (TE)"</span>, <span class="seriesInfo">RFC 4201</span>, <span class="seriesInfo">DOI 10.17487/RFC4201</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4201">https://www.rfc-editor.org/info/rfc4201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5703">[RFC5703]</dt>
        <dd>
<span class="refAuthor">Hansen, T.</span><span class="refAuthor"> and C. Daboo</span>, <span class="refTitle">"Sieve Email Filtering: MIME Part Tests, Iteration, Extraction, Replacement, and Enclosure"</span>, <span class="seriesInfo">RFC 5703</span>, <span class="seriesInfo">DOI 10.17487/RFC5703</span>, <time datetime="2009-10" class="refDate">October 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5703">https://www.rfc-editor.org/info/rfc5703</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5598">[RFC5598]</dt>
        <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Internet Mail Architecture"</span>, <span class="seriesInfo">RFC 5598</span>, <span class="seriesInfo">DOI 10.17487/RFC5598</span>, <time datetime="2009-07" class="refDate">July 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5598">https://www.rfc-editor.org/info/rfc5598</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6377">[RFC6377]</dt>
        <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) and Mailing Lists"</span>, <span class="seriesInfo">BCP 167</span>, <span class="seriesInfo">RFC 6377</span>, <span class="seriesInfo">DOI 10.17487/RFC6377</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6377">https://www.rfc-editor.org/info/rfc6377</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7208">[RFC7208]</dt>
        <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1"</span>, <span class="seriesInfo">RFC 7208</span>, <span class="seriesInfo">DOI 10.17487/RFC7208</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7601">[RFC7601]</dt>
      <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"Message Header Field for Indicating Message Authentication Status"</span>, <span class="seriesInfo">RFC 7601</span>, <span class="seriesInfo">DOI 10.17487/RFC7601</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7601">https://www.rfc-editor.org/info/rfc7601</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="examples">
<section id="section-appendix.a">
      <h2 id="name-examples">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-appendix.a-1">
 In the examples that follow, the first character of each wrapped line
 of DKIM-Signature: fields should be a TAB.  For editorial reasons, it
 is rendered as four spaces.  While visually there is little difference,
 those signatures won't verify unless replacing them with a TAB.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">
 To verify the examples, public keys can be set as follows:<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<div id="section-appendix.a-3">
<pre class="sourcecode">
s._domainkey.example.com IN TXT ( "v=DKIM1; g=*; k=rsa; "
"p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCqlye7m5zLLXoIpBp2OO05LNMqK"
"u0zKowoHOpyRpviOVqOaNCk5uZ+wY00JwrKbt5u1G1ghuXsFkFkl0h00LBurz7ivyZH"
"3LohSWOZ8okgR+8kuGu9GHtQ+MqgRd16tlCF8PlWS2kGaBQKua1zk+ZCDwFy82Uo5G2"
"1nu/+Nn2sUwIDAQAB" )

s._domainkey.lists.example IN TXT ( "v=DKIM1; k=rsa; "
"p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgnLb2TZ6KECBMBo9ZLqDFt4ZBz"
"NHFrgBj/LVJVFU8IQP8uH4G8Pj0mEHRo1qpf0vuFI2HVpe/3NhzkT4Ay/1ZIIsxY754"
"f2thlhBvKh4AAgZFmzRvA3aZs6Tb/ERmD+a51liEMFaTOmY4mWeLi9wOM51usQ9Q65i"
"8IP/vjHM3rQIDAQAB" )
</pre><a href="#section-appendix.a-3" class="pilcrow">¶</a>
</div>
<div id="example-single">
<section id="section-a.1">
        <h2 id="name-single-part-plain-text">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-single-part-plain-text" class="section-name selfRef">Single-part plain text</a>
        </h2>
<p id="section-a.1-1">
 Base64 encoding has to be decoded in order to locate the footer.
 The original encoding was text/plain, this can be inferred by the
 verifier from the absence of an Original-Content-Transfer-Encoding:
 field.  The original body hash will match after decoding and
 removing the footer.
 Note that an "l=" tag couldn't have done the trick in this case.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<div id="section-a.1-2">
<pre class="sourcecode">
Received: from lists.example by subscriber.example.org with ESMTP
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=lists.example; s=s;
    t=1603901305; bh=MjC5ikx26j8beyDJiz7Rk/4W+ppdGOmqh6koz0gLa8o=;
    h=Date:From:To:Subject;
    b=PNIYHGd7aytHEvew44WRpSfl4Py3c/9mKjovvQ1ps/xdpkl1/z+gWeu8e8ZmR7gdE
     iT2TsJ7ni3Lfp5oUpGCko5MvCoqcKX7Zmq3CmXTxRTwwvVZrAp/ir8UTvG+rJFnyEZ
     Yi3dSTX4rKe2LotyLkqcs+/uXaWEADbqcBp/9iHo=
Received: from mail.example.com by lists.example with ESMTP
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=example.com; s=s;
    t=1603889142; bh=hrDXocZNPy1+eUFYIk1PVRKa6mUMb8+ql9CFNABacww=;
    h=Date:From:To:Subject;
    b=YFLwvvW5bGbE5HpJwBM1JoL1F9b8AxdVFlwE/vOkL0p/pPpr7g9KnPXqwoEXZgFI0
     /kkTHK/Afy4gaWZQfwDZ77LuxYSMFjwpNorSc0YEGzHYzLCN7rL1e+xE7B7kOCThiq
     ebaMdcaHeZF6QUmWcUkEj8LVkxrvWi+bTzd3RnaA=
Original-From: Author &lt;user@example.com&gt;
Received: from mua.example.com by mail.example.com with ESMTPA
Message-ID: &lt;123456@author.example&gt;
Date: Mon, 28 Oct 2020 13:12:55 +0100
From: Author &lt;user@example.com&gt;
MIME-Version: 1.0
To: MLM@lists.example
Subject: [example] Check simple MLM message
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: base64

VGhpcyBpcyBhIHBsYWluIHRleHQgbWVzc2FnZSBzdWJtaXR0ZWQgdG8gYSBtYWlsaW5nIGxpc3Qu
ClRoZSBtYWlsaW5nIGxpc3QgaXMgZXhwZWN0ZWQgdG8gYWRkIGEgZm9vdGVyIGFuZCBhIHN1Ympl
Y3QgdGFnLgoKQmVzdApBdXRob3IKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KdGhpcyBtZXNzYWdlIHdhcyBtb2RpZmllZCBieSBNTE0gZXhhbXBsZQphZGRpbmcgdGhp
cyBmb290ZXIgYW5kIHRoZSBzdWJqZWN0IHRhZwoobm90ZSB0aGF0IGw9IGlzIG5vdCBzZXQpCg==
</pre><a href="#section-a.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-added">
<section id="section-a.2">
        <h2 id="name-multipart-added">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-multipart-added" class="section-name selfRef">Multipart added</a>
        </h2>
<p id="section-a.2-1">
 When the original message has a MIME structure, MLMs can append an
 entity.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<div id="section-a.2-2">
<pre class="sourcecode">
Received: from lists.example by subscriber.example.org with ESMTP
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=lists.example; s=s;
    t=1603974193; bh=sEPYSlJlh90leqy5+63oPn1iU+9P684R92cZHXa9ENw=;
    h=Date:From:To:Subject;
    b=fTSAMcaEatofQCuAeUhlTXmVl5j9bPbwWgc84NWtoSt5zT+SSNp37DTzhYIGHozEk
     bpldArGQ+GygJE1b2witi6NctBd1O/xsUwDcJQxDXkF63QlCcalbKWypHZOhRqncUQ
     zgUzdcuYgqTYMJ0NoTP8fqu0HdgmjD2LJXjV3pVI=
Old-Authentication-Results: lists.example;
  dkim=pass header.d=example.com
Received: from mail.example.com by lists.example with ESMTP
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=example.com; s=s;
    t=1603973996; bh=eWqyE53pjRVCFGyHY1zGQTkCEvucN1vNN4cTcWk90WU=;
    h=Date:From:To:Subject;
    b=LGP1M3IX6XORfLs8HRLCFOcymzsPn+8+ljgQlmeNlCC/2Cl1+aBDCIEnzWI0pceCb
     zg32vFfEeryvRDHB1L1K4rrKCEznvO0J3p1xkUPEWpSpzxUGw+PK9KA9ePZ5qdz7cI
     /hXf7zjebznNdDQJnxajf7QHnx1tXmxijsJ1jiGQ=
Old-Authentication-Results: example.com; auth=pass (details omitted)
Original-From: Author &lt;user@example.com&gt;
Received: from mua.example.com by mail.example.com with ESMTPA
Message-ID: &lt;123456@author.example&gt;
Date: Mon, 28 Oct 2020 13:12:55 +0100
From: Author via MLM &lt;MLM@lists.example&gt;
MIME-Version: 1.0
To: MLM@lists.example
Subject: [example] Check simple MLM message
Content-Type: multipart/mixed; boundary=original-boundary

Original preamble must be preserved!

--original-boundary
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

This is a plain text message submitted to a mailing list.
The mailing list is expected to add a footer and a subject tag.

Best
Author

--original-boundary
Content-Type: image/png
Content-Transfer-Encoding: base64

iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAAHKgAAByoB49HU1wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAB+SURB
VAiZNcGxDYUgAEXRhxTMYWLFVlDTOAUjOIEzWDqEC1igCQ0LSLi/+ueotUZKieu6uO+bdV2ptaLz
PDHGsG0b+74jieM40Pd91Fr5K6UAMC3LImutxhgaY8g5p3meNcUYFULQ+756nkchBMUYpd47OWe8
93jvyTnTe+cHXqRZbKSV4EoAAAAASUVORK5CYII=

--original-boundary
Content-Tyep: text/plain

________________________________________
this message was modified by MLM example
adding this footer and the subject tag
(note that l= cannot work in this case)

--original-boundary--
</pre><a href="#section-a.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-wrapped">
<section id="section-a.3">
        <h2 id="name-multipart-wrapped">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-multipart-wrapped" class="section-name selfRef">Multipart wrapped</a>
        </h2>
<p id="section-a.3-1">
 When the original body is multipart/alternative, MLMs have to wrap
 the whole body into the first entity of a multipart/mixed structure.
 Indeed, appending an entity to a multipart/alternative would result
 in it either hiding or being hidden by the existing ones.<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<div id="section-a.3-2">
<pre class="sourcecode">
Received: from lists.example by subscriber.example.org with ESMTP
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=lists.example; s=s;
    t=1603962061; bh=n4/RahgnfVg7htgJtCr7TwEW4eKA1O5oiNaQFA5HU+A=;
    h=Date:From:To:Subject;
    b=RJlq/Fu40AC1hdJfljd+KPU69Vq2M7capbGQyEMhDWvaN7xDPJdXotwnTwiz91iZY
     5W3ITY7YXKHsWweLxu1Rph3ST3bbYQ1cifztpmtu4VPifBkm9MAe7OMDLHhk5ua9YL
     VzJOsXieiIw5a8JhOsr6F/05/K05kNiEXvuLgKd8=
Old-Authentication-Results: lists.example;
  dkim=pass header.d=example.com
Received: from mail.example.com by lists.example with ESMTP
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=example.com; s=s;
    t=1603961679; bh=XiCPbOV1vcu2Q2TyEUOuT4SMun2AjYj/Va6KRPa1lv0=;
    h=Date:From:To:Subject;
    b=gvM5grV2dbtinFMLcExv+gMATILzY+c8RY7QPVBJSFohH5HMgOLwrgSH8uwOcZxq0
     FoXtBcHnukonqo97l8nY0faHi0Dp0LAmqn9e4ijwXw9IWwhFuUiCwICRaLEzrNUVBN
     TWtzkQKnHpEXnPGBD7Q9f924mBe+eZsDyRc41ZvQ=
Old-Authentication-Results: example.com; auth=pass (details omitted)
Original-From: Author &lt;user@example.com&gt;
Received: from mua.example.com by mail.example.com with ESMTPA
Message-ID: &lt;123456@author.example&gt;
Date: Mon, 28 Oct 2020 13:12:55 +0100
From: Author via MLM &lt;MLM@lists.example&gt;
MIME-Version: 1.0
To: MLM@lists.example
Subject: [example] Check simple MLM message
Content-Type: multipart/mixed; boundary=MLM-boundary

This is the MLM preamble, not signed by Author.

--MLM-boundary
Content-Type: multipart/alternative; boundary=original-boundary

Original preamble must be preserved!

--original-boundary
Content-Type: text/plain;

This is a plain text message submitted to a mailing list.
The mailing list is expected to add a footer and a subject tag.

Best
Author

--original-boundary
Content-Type: text/html;

&lt;p&gt;This is a plain text message submitted to a mailing list.
The mailing list is expected to add a footer and a subject tag.

&lt;p&gt;Best&lt;br&gt;
Author&lt;br&gt;

--original-boundary--

Original epilogue

--MLM-boundary
Content-Type: text/plain

________________________________________
this message was modified by MLM example
adding this footer and the subject tag
(note that l= is not set)

--MLM-boundary--

MLM epilogue
</pre><a href="#section-a.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alessandro Vesely</span></div>
<div dir="auto" class="left"><span class="street-address">v. L. Anelli 13</span></div>
<div dir="auto" class="left">
<span class="postal-code">20122</span> <span class="locality">Milano</span> <span class="region">MI</span>
</div>
<div dir="auto" class="left"><span class="country-name">Italy</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vesely@tana.it" class="email">vesely@tana.it</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
