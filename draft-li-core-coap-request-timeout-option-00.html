<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>CoAP Option Extension : Timeout </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Justification">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Respuest-Timeout Option Extension">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Request-Timeout Option Definition">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Using the Request-Timeout Option">
<link href="#rfc.section.3" rel="Chapter" title="3 Example">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="CoAP is a RESTful application protocol for constrained nodes and networks. This specification provides a simple extension for CoAP, to inform a CoAP server of the maximum time that a CoAP client will wait a response to its request. A CoAP server can use this header to ensure that a timely response is generated.  " />
  <meta name="description" content="CoAP is a RESTful application protocol for constrained nodes and networks. This specification provides a simple extension for CoAP, to inform a CoAP server of the maximum time that a CoAP client will wait a response to its request. A CoAP server can use this header to ensure that a timely response is generated.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">core</td>
<td class="right">K. Li</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">B. Greevenbosch</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Huawei Technologies</td>
</tr>
<tr>
<td class="left">Expires: November 20, 2011</td>
<td class="right">May 19, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">CoAP Option Extension : Timeout <br />
  <span class="filename">draft-li-core-coap-request-timeout-option-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>CoAP is a RESTful application protocol for constrained nodes and networks. This specification provides a simple extension for CoAP, to inform a CoAP server of the maximum time that a CoAP client will wait a response to its request. A CoAP server can use this header to ensure that a timely response is generated.  </p>
<h1><a>Note</a></h1>
<p>Discussion and suggestions for improvement are requested, and should be sent to core@ietf.org.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 20, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Justification</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">Respuest-Timeout Option Extension</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Request-Timeout Option Definition</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Using the Request-Timeout Option</a>
</li>
<li>3.   <a href="#rfc.section.3">Example</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgements</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This specification adds a new option Request-Timeout to CoAP.  The main purpose is for the client to indicate the maximum time that a CoAP client will wait for a response to its request.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#just" id="just">Justification</a>
</h1>
<p id="rfc.section.1.1.p.1">It is useful for the client to indicate that the response is required to be returned within a certain amount of time.  For example, the client could require a response within 2 seconds.  This applies to both a Piggy-backed Response and a Separate Response.  With this indication of the response timeout, the client knows how long it should wait for the response, and it needs to keep the state of the request only for the indicated time. After this period, the request will be given up. In this way, the transmission resource can be saved to avoid the retransmission of requests.  Also it can avoid that the server wastes resources by sending a response which already exceeds the set timeout of the client.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#terms" id="terms">Terminology</a>
</h1>
<p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#Request-Timeout" id="Request-Timeout">Respuest-Timeout Option Extension</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#Definition" id="Definition">Request-Timeout Option Definition</a>
</h1>
<div id="#rfc.figure.1"></div>
<pre>
        +------+-----+----------------+-----------+--------+----------+
        | Type | C/E |      Name      | Data type | Length | Default  |
        +------+-----+----------------+-----------+--------+----------+
        |  20  | E   | Request-Timeout|   uint    | 0-1 B  |          |
        +------+-----+----------------+-----------+--------+----------+
         </pre>
<p></p>
<div id="#rfc.figure.2"></div>
<pre>   
           0
           0 1 2 3 4 5 6 7
          +-+-+-+-+-+-+-+-+
          |       T       |
          +-+-+-+-+-+-+-+-+
          </pre>
<p></p>
<p id="rfc.section.2.1.p.3">Request-Timeout    = 2^T milliseconds </p>
<p id="rfc.section.2.1.p.4">The value of the Request-Timeout option is 2^T milliseconds.  [TBD: keep the spec open on whether the base is milliseconds or 1024s of a second -- the clocks are not going to be that precise anyway, and this might help some implementations that count in 1024s ("mibiseconds") or in whole seconds.] </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#Usage" id="Usage">Using the Request-Timeout Option</a>
</h1>
<p id="rfc.section.2.2.p.1">This option is used to indicate the maximum time that a client is prepared to wait for a response.  </p>
<p id="rfc.section.2.2.p.2">The client adds the Request-Timeout option to any request for which it is prepared to wait for a response.  The client sets the option to the maximum time that it is prepared to wait.  </p>
<p id="rfc.section.2.2.p.3">The server interprets this option as the time between receipt of the complete request and the time that it generates and begins sending the response.  The client will observe a longer time interval between request and response, as network transit and processing by proxies add delays.  If timing is critical, the client SHOULD consider the possible delays and choose the value for the option accordingly.  </p>
<p id="rfc.section.2.2.p.4">The server MAY apply a lower value to the timeout based on local policy.  A server MAY choose to take longer to produce a response, at the risk that the client is no longer able to use the response.  </p>
<p id="rfc.section.2.2.p.5">In case that the CoAP message is transmitted through a proxy, the Proxy MAY reduce the value of a Request-Timeout option based on a local policy.  A Proxy MAY add a Request-Timeout option if none is present.  The value in the Request-Timeout option MUST NOT be increased or removed.  </p>
<p id="rfc.section.2.2.p.6">If the client does not receive a response within the indicated response time, the client MAY consider the request as failed.  </p>
<p id="rfc.section.2.2.p.7">If the server can't provide response within the required time, a 5.XX (Can't provide the data in time) [TBD] MUST be returned. Note that the client cannot rely on getting the response code, because the server might have failed in the meantime.  </p>
<p id="rfc.section.2.2.p.8">This option is not used in a response.  </p>
<p id="rfc.section.2.2.p.9">This option is "elective".  It MUST NOT occur more than once.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#example" id="example">Example</a>
</h1>
<p id="rfc.section.3.p.1">This section gives a short example with a message flow that illustrates the use of the Request-Timeout option in a GET request.  </p>
<p id="rfc.section.3.p.2">The first example (<a href="#TimeOutExample">Figure 3</a>) shows that the client wants to get a response within 2048 milliseconds.  </p>
<div id="#rfc.figure.3"></div>
<div id="#TimeOutExample"></div>
<pre> 

   Client  Server
      |      |
      |      |
      +-----&gt;|          Header: GET (T=CON, Code=1, MID=0x7d38)
      | GET  |           Token: 0x53      
      |      | Request-Timeout: 00001011   
      |      |        Uri-Path: "temperature"
      |      |
      |&lt;-----+     Header: 2.05 Content (T=ACK, Code=69, MID=0x7d38)
      | 2.05 |      Token: 0x53
      |      |    Payload: "22.3 C"
      |      |
 
       Figure 1: Request-Timeout Option in a request
      
        </pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.4.p.1">This presents no security considerations beyond those in section 10 of the base CoAP specification <a href="#I-D.ietf-core-coap">[I-D.ietf-core-coap]</a>.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">The IANA is requested to add the following Option Number entry.  </p>
<div id="#rfc.figure.4"></div>
<pre>
                +--------+------------------+----------------+
                | Number | Name             | Reference      |
                +--------+------------------+----------------+
                |  20    | Request-Timeout  | Section 2      |
                +--------+------------------+----------------+
         </pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#acknowledgement" id="acknowledgement">Acknowledgements</a>
</h1>
<p id="rfc.section.6.p.1">The authors of this draft would like to thank the participants of the email discussion on this issue.  Thanks to Carsten Bormann, Peter Bigot, Barry Leiba, Linyi Tian for the reviews and discussions.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-coap">[I-D.ietf-core-coap]</b></td>
<td class="top">
<a>Shelby, Z</a>, <a>Hartke, K</a>, <a>Bormann, C</a> and <a>B Frank</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-coap-08">Constrained Application Protocol (CoAP)</a>", Internet-Draft draft-ietf-core-coap-08, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-block">[I-D.ietf-core-block]</b></td>
<td class="top">
<a>Bormann, C</a> and <a>Z Shelby</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-block-04">Blockwise transfers in CoAP</a>", Internet-Draft draft-ietf-core-block-04, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-link-format">[I-D.ietf-core-link-format]</b></td>
<td class="top">
<a>Shelby, Z</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-link-format-09">CoRE Link Format</a>", Internet-Draft draft-ietf-core-link-format-09, November 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kepeng Li</span> 
	  <span class="n hidden">
		<span class="family-name">Li</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  <span>Huawei Base, Bantian, Longgang District</span>

	  <span class="vcardline">
		<span class="locality">Shenzhen</span>,  
		<span class="region">Guangdong</span> 
		<span class="code">518129</span>
	  </span>
	  <span class="country-name vcardline">P. R. China</span>
	</span>
	<span class="vcardline">Phone: +86-755-28974289</span>

<span class="vcardline">EMail: <a href="mailto:likepeng@huawei.com">likepeng@huawei.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Bert Greevenbosch</span> 
	  <span class="n hidden">
		<span class="family-name">Greevenbosch</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  <span>Huawei Base, Bantian, Longgang District</span>

	  <span class="vcardline">
		<span class="locality">Shenzhen</span>,  
		<span class="region">Guangdong</span> 
		<span class="code">518129</span>
	  </span>
	  <span class="country-name vcardline">P. R. China</span>
	</span>
	<span class="vcardline">Phone: +86-755-28978088</span>

<span class="vcardline">EMail: <a href="mailto:bgreeven@huawei.com">bgreeven@huawei.com</a></span>

  </address>
</div>

</body>
</html>