<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Using SCVP to Convey Long-term Evidence Records</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Using SCVP to Convey Long-term Evidence Records">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Long-term Archive And Notary</td><td class="header">C. Wallace</td></tr>
<tr><td class="header">Services (LTANS)</td><td class="header">Cygnacom Solutions</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">February 14, 2008</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Expires: August 17, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Using SCVP to Convey Long-term Evidence Records<br />draft-ietf-ltans-ers-scvp-06.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 17, 2008.</p>

<h3>Abstract</h3>

<p>
        The Simple Certificate Validation Protocol (SCVP) defines an extensible means of delegating the development and validation of certification paths to a server.  It can be used to support the development and validation of certification paths well after the expiration of the certificates in the path by specifying a time of interest in the past.  The Evidence Record Syntax (ERS) defines structures, called evidence records, to support non-repudiation of existence of data.  Evidence records can be used to preserve materials that comprise a certification path such that trust in the certificates can be established after the expiration of the certificates in the path and after the cryptographic algorithms used to sign the certificates in the path are no longer secure.  This document describes an application of SCVP to serve this purpose using the WantBack feature of SCVP to convey evidence records.
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements notation<br />
<a href="#anchor3">2.</a>&nbsp;
Concept of Operations<br />
<a href="#anchor4">3.</a>&nbsp;
Requests<br />
<a href="#anchor5">4.</a>&nbsp;
Responses<br />
<a href="#anchor6">5.</a>&nbsp;
WantBacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.1.</a>&nbsp;
Evidence record for a complete certification path<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.2.</a>&nbsp;
Evidence record for a partial certification path<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.3.</a>&nbsp;
Evidence record for a public key certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.4.</a>&nbsp;
Evidence record for revocation information<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.5.</a>&nbsp;
Evidence record for any replyWantBack<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.6.</a>&nbsp;
Partial certification path<br />
<a href="#anchor13">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor14">7.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#anchor17">Appendix&nbsp;A.</a>&nbsp;
ASN.1 Module<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Digital signatures are frequently verified using public key infrastructure (PKI) artifacts, including public key certificates and certificate revocation information.  Verifiers construct and validate certification paths from a public key certificate containing the public key used to verify the signature to a trusted public key.  Construction of a certification path may require acquisition of different types of information generated by multiple PKIs.  To verify digital signatures many years after signature generation, additional considerations must be addressed.  For example, some necessary PKI artifacts may no longer be available, some may have expired and the cryptographic algorithms or keys used in generating digital signatures may no longer provide the desired degree of security.
		
</p>
<p>SCVP <a class='info' href='#RFC5055'>[RFC5055]<span> (</span><span class='info'>Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;Server-Based Certificate Validation Protocol (SCVP),&rdquo; December&nbsp;2007.</span><span>)</span></a> provides a means of delegating certification path construction and/or validation to a server, including the ability to request the status of a certificate relative to a time in the past.  SCVP does not define a means of providing or validating long-term non-repudiation information.  ERS <a class='info' href='#RFC4998'>[RFC4998]<span> (</span><span class='info'>Gondrom, T., Brandner, R., and U. Pordesch, &ldquo;Evidence Record Syntax (ERS),&rdquo; August&nbsp;2007.</span><span>)</span></a> defines a syntax for preserving materials over long periods of time through a regimen that includes periodic re-signing of relevant materials using newer keys and stronger cryptographic algorithms.  LTAP <a class='info' href='#I-D.ietf-ltans-ltap'>[I&#8209;D.ietf&#8209;ltans&#8209;ltap]<span> (</span><span class='info'>Jerman-Blazic, A., Sylvester, P., and C. Wallace, &ldquo;Long-term Archive Protocol (LTAP),&rdquo; July&nbsp;2009.</span><span>)</span></a> defines a protocol for communicating with a long-term archive (LTA) server for the purpose of preserving evidence records and data.  Clients store, retrieve and delete data using LTAP; LTAs maintain evidence records covering data submitted by clients.
		
</p>
<p>This document defines an application of SCVP to permit retrieval of an evidence record corresponding to information returned by the SCVP server by creating an association between an evidence record and information contained in an SCVP response.  The SCVP response can then in turn be used to verify archived data objects retrieved using LTAP.  Separating the preservation of the certification path information from the preservation of data enables the LTA to store archived data objects more efficiently, i.e., complete verification information need not be stored with each archived data object.  Verifiers can more efficiently process archived data object by reusing the same certification path information to verify multiple archived data objects of similar vintage without retrieving and/or validating the same PKI artifacts multiple times.
		
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements notation</h3>

<p>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
          and "OPTIONAL" in this document are to be interpreted as
          described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Concept of Operations</h3>

<p>
		During certification path processing, active SCVP servers may encounter a large portion of the PKI artifacts generated by a particular PKI.  By storing and preserving these artifacts, an SCVP server can respond to queries for certificate status over very long periods of time.  Optionally, SCVP servers may actively seek PKI information for storage and preservation even when no query is made that requires the information during its period of validity in order to service future queries relative to any point in time.
		
</p>
<p>SCVP permits clients to request as much or as little information as desired from the SCVP server.  Clients include zero or more OIDs indicating the type(s) of information the server should include in the response.  By defining additional OID values, clients can request an evidence record for specific types of information returned by the SCVP server.  This document defines OIDs to permit the retrieval of evidence records for the following four types of information: 
		</p>
<blockquote class="text">
<p>- end entity certificates
</p>
<p>- certification paths containing an end entity certificate up to a trust anchor
</p>
<p>- certification paths containing an intermediate certificate up to a trust anchor
</p>
<p>- revocation information.
</p>
</blockquote><p>  
		Additionally, an OID is defined to permit inclusion of a single OID indicating an evidence record is desired for all information requested via the WantBack mechanism.
		
</p>
<p>By associating evidence records with information maintained by an SCVP server, clients are able to determine the status of certificates over very long periods of time using SCVP without consulting additional resources.  The nature of SCVP servers is well suited to preservation of infrastructure materials.  Additionally, the SCVP server's signature over an SCVP response can secure the transmission of trust anchors included in evidence records, allowing clients to refrain from establishing additional trust relationships with LTAs. 
		
</p>
<p>The transactions used to verify an archived data object using LTAP and the SCVP WantBacks described in this document are as follows: 
		</p>
<blockquote class="text">
<p>- Client retrieves a signed archived data object from an LTA using LTAP
</p>
<p>- Client prepares an SCVP request to validate the signer's certificate at the time of interest and includes WantBacks for evidence records corresponding to the PKI artifacts required to validate the signer's  certificate
</p>
<p>- SCVP server returns a response with status as of time of interest and includes requested evidence records
</p>
<p>- Client processes the SCVP request, determines the status and verifies the evidence records
</p>
<p>- Client verifies signatures in the archived data object using the validated signer's certificate
</p>
</blockquote><p>  
		
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requests</h3>

<p>
		Clients request long-term archive evidence records from an SCVP server by including one of the following OIDs in the wantBack field of a CVRequest sent to an SCVP server:
		
				</p>
<blockquote class="text">
<p>- id-swb-ers-best-cert-path
</p>
<p>- id-swb-ers-partial-cert-path
</p>
<p>- id-swb-ers-pkc-cert
</p>
<p>- id-swb-ers-revocation-info
</p>
<p>- id-swb-ers-all
</p>
</blockquote><p>			
		
</p>
<p>Additionally, id-swb-partial-cert-path is defined to permit clients to request a partial certification path consisting of the CA who issued the end entity certificate through a trust anchor.  This is similar to the id-swb-best-cert-path WantBack defined in SCVP except the resulting replyWantBack will contain a CertBundle containing the certification path minus the end entity certificate.
</p>
<p>
		For each id-swb-ers OID except id-swb-ers-all, an EvidenceRecord (as defined in <a class='info' href='#RFC4998'>[RFC4998]<span> (</span><span class='info'>Gondrom, T., Brandner, R., and U. Pordesch, &ldquo;Evidence Record Syntax (ERS),&rdquo; August&nbsp;2007.</span><span>)</span></a>) covering the corresponding information in the response will be returned as a replyWantBack.  For example, if a client wishes to obtain a certification path and revocation information plus an evidence record for each, the SCVP request would include the following four replyWantBack OIDs: id-swb-best-cert-path, id-swb-pkc-revocation-info, id-swb-ers-best-cert-path and id-swb-ers-revocation-info.
		
</p>
<p>Alternatively, for id-swb-ers-all, an EvidenceRecordWantBacks structure will be returned containing an EvidenceRecord for each information item contained in the replyWantBacks field.  For example, if a client wishes to obtain a certification path and revocation information plus an evidence record for each, the SCVP request would include the following four replyWantBack OIDs: id-swb-best-cert-path, id-swb-pkc-revocation-info and id-swb-ers-all.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Responses</h3>

<p>
      When a client request contains a WantBack request for an evidence record, the response generated MUST include the replyWantBack containing the requested information plus a replyWantBack containing the evidence record corresponding to that information.  For each id-swb-ers OID except id-swb-ers-pkc-cert and id-swb-ers-revocation-info, the evidence record MUST be calculated over the value of the value field in the corresponding replyWantBack; the tag and length bytes are not covered by the evidence record.  The targets for the id-swb-ers-pkc-cert and id-swb-ers-revocation-info replyWantBacks are described below.  For example, if a client request contains id-swb-pkc-best-cert-path and id-swb-ers-best-cert-path, the resulting response will contain a replyWantBack of each type where the evidence record covers the DER encoded CertBundle returned in the id-swb-pkc-best-cert-path replyWantBack.  For id-swb-ers-pkc-cert, the evidence record MUST be calculated over the value of the cert field in the CertReply object.  For id-swb-ers-revocation-info, a sequence of evidence records is returned.  Each revocation information object contained in the id-swb-pkc-revocation-info replyWantBack is covered by an evidence record in the id-swb-ers-revocation-info replyWantWant.  A single evidence record may cover multiple revocation information objects.  The correct evidence record can be identified by locating the hash of the revocation information object in the first initial timestamp of the evidence record.
    
</p>
<p>If the server can not return an EvidenceRecord for the requested information item, a replyWantBack of the appropriate type MUST be returned with an empty value field.  For example, if a client requests id-swb-ers-pkc-cert and the server cannot fulfill the request, the resulting response will contain a replyWantBack with the wb field set to id-swb-ers-pkc-cert and the value field empty, i.e., zero length.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
WantBacks</h3>

<p>The following sections describe each WantBack defined in this document.  Each wantBack for an evidence record requires a corresponding wantBack for the object covered by the evidence record to be present in the request.  Upon receipt of a request missing the corresponding wantBack for the object covered by a requested evidence record, the server MUST indicate wantBackUnsatisfied in the ReplyStatus.  Clients MAY ignore evidence record wantBacks when the wantBack for the corresponding object is not present.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Evidence record for a complete certification path</h3>

<p>The id-swb-ers-best-cert-path OID is used to request an evidence record for a complete certification path.  It is used in conjunction with the id-swb-best-cert-path OID.  Requests containing id-swb-ers-best-cert-path as a WantBack MUST also contain id-swb-best-cert-path.  Responses containing id-swb-ers-best-cert-path MUST also contain id-swb-best-cert-path.
</p>
<p>An SCVP server may maintain evidence records for complete certification paths, i.e., certification paths containing all certificates from end entity to trust anchor.  The evidence record MUST be calculated over the CertBundle returned via the id-swb-best-cert-path replyWantBack.  In such cases, a signature within the archived data object may be verified using an end entity certificate returned via SCVP.  The end entity certificate can be verified using SCVP using a request containing id-swb-ers-best-cert-path, id-swb-best-cert-path, id-swb-pkc-revocation-info and id-swb-ers-revocation-info
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Evidence record for a partial certification path</h3>

<p>The id-swb-ers-partial-cert-path OID is used to request an evidence record for a partial certification path.  It is used in conjunction with the id-swb-partial-cert-path OID.  Requests containing id-swb-ers-partial-cert-path as a WantBack MUST also contain id-swb-partial-cert-path.  Responses containing id-swb-ers-partial-cert-path MUST also contain id-swb-partial-cert-path.
</p>
<p>As an alternative to relying on SCVP to obtain evidence records for end entity certificates, the certificate could be included in the archived data object(s) submitted to an LTA.  In such cases, a signature within the archived data object may be verified using the included end entity certificate, which is protected by the evidence record covering the archived data object including the certificate.  The end entity certificate can be verified using SCVP using a request containing id-swb-partial-cert-path, id-swb-ers-partial-cert-path, id-swb-pkc-revocation-info and id-swb-ers-revocation-info.  Unlike the partial certification path, the revocation information includes material that can be used to determine the status of the end entity certificate.
</p>
<p>By maintaining an evidence record for a partial certification path, SCVP servers can achieve greater storage efficiency.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Evidence record for a public key certificate</h3>

<p>The id-swb-ers-pkc-cert OID is used to request an evidence record for an individual public key certificate.  It is used in conjunction with the id-swb-pkc-cert OID.  Requests containing id-swb-ers-pkc-cert as a WantBack MUST also contain id-swb-pkc-cert.  Responses containing id-swb-ers-pkc-cert MUST also contain id-swb-pkc-cert.
</p>
<p>SCVP servers may maintain evidence records for individual certificates.  This enables clients to omit the signer's certificate from archived data object(s) submitted to an LTA.  In such cases, a signature within the archived data object may be verified using an end entity certificate returned via SCVP.  The end entity certificate can be verified using SCVP using a request containing id-swb-pkc-cert, id-swb-ers-pkc-cert, id-swb-partial-cert-path, id-swb-ers-partial-cert-path, id-swb-pkc-revocation-info and id-swb-ers-revocation-info.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Evidence record for revocation information</h3>

<p>The id-swb-ers-revocation-info OID is used to request an evidence record for a set of revocation information.  It is used in conjunction with the id-swb-revocation-info OID.  Requests containing id-swb-ers-revocation-info as a WantBack MUST also contain id-swb-revocation-info.  Responses containing id-swb-ers-revocation-info MUST also contain id-swb-revocation-info.
</p>
<p>An SCVP server may maintain evidence records for revocation information.  Revocation information may be provided in the form of CRLs or OCSP responses.  Cumulative CRLs may be generated for archiving to simplify evidence record maintenance.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Evidence record for any replyWantBack</h3>

<p>An SCVP server may maintain evidence records for additional types of information that can be returned using the wantBack mechanism, e.g., attribute certificate information.  The id-swb-ers-all OID provides a shorthand means for clients to request evidence records for all information returned via the replyWantBacks field.  Since id-swb-ers-all can result in the return of multiple evidence records in the response, a mechanism is needed to associate an evidence record with the type of information covered by the evidence record.  The EvidenceRecordWantBacks structure provides a flexible means of conveying an evidence record for different types of information.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

EvidenceRecordWantBack ::= SEQUENCE
{
    targetWantBack    OBJECT IDENTIFIER,
    evidenceRecord    EvidenceRecord OPTIONAL
}

EvidenceRecordWantBacks ::=
    SEQUENCE SIZE (1...MAX) OF EvidenceRecordWantBack


</pre></div>
<p>EvidenceRecordWantBacks is a SEQUENCE OF EvidenceRecordWantBack structures.  The targetWantBack field indicates the type of replyWantBack covered by the associated EvidenceRecord.  The evidenceRecord field, if present, contains an EvidenceRecord structure calculated over the replyWantBack indicated by the targetWantBack field.  There MUST be a one to one correspondence between other replyWantBack objects and objects in the EvidenceRecordWantBacks collection.  If a server does not have an EvidenceRecord for a particular replyWantBack object, an EvidenceRecordWantBack with the evidenceRecord field absent should be included in the EvidenceRecordWantBacks collection.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Partial certification path</h3>

<p>The id-swb-partial-cert-path is an alternative to id-swb-best-cert-path.  This is the only OID defined in this document for which an EvidenceRecord is not returned in the response.  For efficiency, SCVP servers that maintain evidence records for certification paths may only do so for partial paths instead of maintaining one or more paths for each end entity certificate.
</p>
<p>
SCVP clients can include id-swb-partial-cert-path in a request when a partial certification path is required.  This would typically be included along with id-swb-ers-partial-cert-path to account for the fact that some SCVP servers only produce evidence records for partial paths for storage and computational efficiency reasons.  In such cases, a separate evidence record may be available for the end entity certificate by including id-swb-pkc-cert and id-swb-ers-pkc-cert in the request.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>For security considerations specific to SCVP, see <a class='info' href='#RFC5055'>[RFC5055]<span> (</span><span class='info'>Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;Server-Based Certificate Validation Protocol (SCVP),&rdquo; December&nbsp;2007.</span><span>)</span></a>.  For security considerations specific to ERS, see <a class='info' href='#RFC4998'>[RFC4998]<span> (</span><span class='info'>Gondrom, T., Brandner, R., and U. Pordesch, &ldquo;Evidence Record Syntax (ERS),&rdquo; August&nbsp;2007.</span><span>)</span></a>.
</p>
<p>The signature on the SCVP response containing one or more ERS structures must be verified using a public key trusted by the relying party.  The response may contain trust anchors used to verify interior layers of an ERS structure.  The trust anchors are protected by the SCVP server's signature covering the response.  The relying party may elect to use the trust anchors conveyed in the response or ignore the trust anchors in favor of trust anchors retrieved out of band.  Relying parties SHOULD ignore trust anchors contained in unsigned SCVP responses.
</p>
<p>Usage of cumulative CRLs may require additional extensions to existing standards.  Cumulative CRLs must contain revocation information for all certificates within the scope of the CRL, including expired certificates, must provide indications of when a certificate was placed on hold and removed from hold and must provide an indication of when a CRL entry first appeared on a CRL.  One approach tailored for long-term archiving purposes, which may be described in a subsequent draft, is to generate CRLs with a fixed thisUpdate value and containing a new CRL entry extension identifying the thisUpdate of the CRL on which the entry first appeared.  An LTA only needs to maintain the latest cumulative CRL in order to provide revocation status for all certificates within the scope and period of the CRL.  In some cases, the original CRLs may be required.
</p>
<p>The mechanism described in this document focuses on preserving PKI artifacts and uses SCVP to convey the preservation evidence.  A simpler alternative, or additional means, would be to define a directory entry to contain EvidenceRecords for the desired artifacts, e.g., certificates and cumulative CRLs.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4998">[RFC4998]</a></td>
<td class="author-text">Gondrom, T., Brandner, R., and U. Pordesch, &ldquo;<a href="http://tools.ietf.org/html/rfc4998">Evidence Record Syntax (ERS)</a>,&rdquo; RFC&nbsp;4998, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4998.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5055">[RFC5055]</a></td>
<td class="author-text">Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5055">Server-Based Certificate Validation Protocol (SCVP)</a>,&rdquo; RFC&nbsp;5055, December&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5055.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ltans-ltap">[I-D.ietf-ltans-ltap]</a></td>
<td class="author-text">Jerman-Blazic, A., Sylvester, P., and C. Wallace, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ltans-ltap-08.txt">Long-term Archive Protocol (LTAP)</a>,&rdquo; draft-ietf-ltans-ltap-08 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ltans-ltap-08.txt">TXT</a>).</td></tr>
</table>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
ASN.1 Module</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

LTANS_SCVP_EXTENSION
{ iso(1) identified-organization(3) dod(6) internet(1)
   security(5) mechanisms(5) ltans(11) id-mod(0) id-mod-ers-scvp(5)
   id-mod-ers-scvp-v1(1) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS

id-swb
FROM SCVP
{ iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0) 21 }

EvidenceRecord
FROM ERS
{iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) ltans(11) id-mod(0) id-mod-ers88(2)
    id-mod-ers88-v1(1) };

id-swb-partial-cert-path        OBJECT IDENTIFIER ::= {id-swb 15 }

id-swb-ers-pkc-cert             OBJECT IDENTIFIER ::= {id-swb 16 }
id-swb-ers-best-cert-path       OBJECT IDENTIFIER ::= {id-swb 17 }
id-swb-ers-partial-cert-path    OBJECT IDENTIFIER ::= {id-swb 18 }
id-swb-ers-revocation-info      OBJECT IDENTIFIER ::= {id-swb 19 }
id-swb-ers-all                  OBJECT IDENTIFIER ::= {id-swb 20 }

EvidenceRecordWantBack ::= SEQUENCE
{
    targetWantBack    OBJECT IDENTIFIER,
    evidenceRecord    EvidenceRecord OPTIONAL
}

EvidenceRecordWantBacks ::=
    SEQUENCE SIZE (1..MAX) OF EvidenceRecordWantBack

END

</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carl Wallace</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cygnacom Solutions</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 5200</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7925 Jones Branch Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">McLean, VA  22102</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cwallace@cygnacom.com">cwallace@cygnacom.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
