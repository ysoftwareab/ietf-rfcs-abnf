<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Source address validation in
    the local environment</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Source address validation in
    the local environment">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">F. Baker</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">November 08, 2007</td></tr>
<tr><td class="header">Expires: May 11, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Source address validation in
    the local environment<br />draft-baker-sava-implementation-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 11, 2008.</p>

<h3>Abstract</h3>

<p>This note describes how Source Address Validation might be applied in
      an IPv6 environment. Local systems should be able to ensure that their
      peers are using the IPv6 source addresses that the routing system uses
      to deliver data to them. Remote systems should be able to ensure that
      traffic they forward has reasonable source addresses.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Local Source Address Validation for IPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ipv6-complications">1.2.</a>&nbsp;
Local Source Address Validation for IPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.3.</a>&nbsp;
Defense in depth<br />
<a href="#local">2.</a>&nbsp;
Implementating Source Address Validation in the local environment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.1.</a>&nbsp;
Trust anchors<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.2.</a>&nbsp;
Host and Router validation of the addresses of neighboring systems<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.3.</a>&nbsp;
Validation of the addresses of neighboring systems by a switch<br />
<a href="#remote">3.</a>&nbsp;
Implementating Source Address Validation for remote systems<br />
<a href="#IANA">4.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">5.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">6.</a>&nbsp;
Contributors<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#anchor9">Appendix&nbsp;A.</a>&nbsp;
Summary of recommendations<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This note describes how Source Address Validation might be applied in
      an <a class='info' href='#RFC2460'>IPv6<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> [RFC2460] environment by a an IP host or
      router, or lower layer switch directly connected to the source system.
      Local systems, the hosts and routers directly connected to a neighbor
      system, should be able to ensure that their peers are using the IPv6
      source addresses that the routing system uses to deliver data to them.
      Remote systems cannot ensure the exact matching of addresses, but can
      determine whether the source address is reasonable. The recommendations
      of this specification are based on experience with such features that
      are currently available for <a class='info' href='#RFC0791'>IPv4<span> (</span><span class='info'>Postel, J., &ldquo;Internet Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> [RFC0791] from
      multiple vendors.
</p>
<p>This is in support of the requirements of <a class='info' href='#RFC2827'>[RFC2827]<span> (</span><span class='info'>Ferguson, P. and D. Senie, &ldquo;Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing,&rdquo; May&nbsp;2000.</span><span>)</span></a>, which recommends that networks defend
      themselves from spoofed traffic by dropping traffic that clearly has
      spoofed source addresses. The place this is usually implemented, the ISP
      ingress router, is an excellent second line of defense and very
      appropriate for defending the ISP. However, the only system that can
      definitively stop traffic from errant hosts is the systems they directly
      communicate with - their LAN switches, hosts that they are the immediate
      neighbors of, and their first hop routers. This note specifies that
      first line of defense.
</p>
<p>The purpose of Source Address Validation is to ensure that a system
      in the network sends only datagrams that can be replied to - datagrams
      that the routing system will deliver to that host and which the host
      will recognize as having been directed to it. This is the first part is
      isolating a denial of service attack; the second step is to identify
      systems sending attack traffic and remove their traffic from the
      network.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Local Source Address Validation for IPv4</h3>

<p>In IPv4, datagrams generally come from the address that has been
        assigned to an interface, so it is sufficient to determine "the"
        address and discard traffic that comes from other addresses. There are
        some caveats: multi-LAN hosts may reply to a request using the address
        of one interface but sending the datagram out another, and routers
        forward traffic from a myriad of addresses. But such systems can be
        treated as special cases and excluded from source address
        validation.
</p>
<p>As such, switch implementations of source address validation
        technology observe <a class='info' href='#RFC2131'>DHCP<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2131] assignments of
        addresses to hosts and drop host-originated datagrams using other
        source addresses. Neighboring hosts or routers may similarly only
        store one associated IP address for each MAC address, but this is more
        frequently a bug or side-effect of implementation than something well
        thought through, and may not operate as well as one would like.
</p>
<a name="ipv6-complications"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Local Source Address Validation for IPv6</h3>

<p>In an IPv6 network, the problem is somewhat more complicated than
        it is in an IPv4 network. As with IPv4, there are some caveats:
        multi-LAN hosts may reply to a request using the address of one
        interface but sending the datagram out another, and routers forward
        traffic from a myriad of addresses. But such systems can be treated as
        special cases and excluded from source address validation.
</p>
<p>The issue that complicates IPv6 is that each interface potentially
        has many addresses, and a single prefix may straddle multiple physical
        interfaces. It will generally have at least two: its link-local
        address and its address in the local prefix. There may, however, be
        multiple local prefixes, and with <a class='info' href='#RFC4941'>privacy
        addressing<span> (</span><span class='info'>Narten, T., Draves, R., and S. Krishnan, &ldquo;Privacy Extensions for Stateless Address Autoconfiguration in IPv6,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4941] there may be multiple legitimate addresses within
        the same prefix. So the mapping is not one-to-one, but rather
        one-to-many. The system verifying the address usage must carry the
        interface identification, in whatever form it may hold that, as an
        attribute of the IPv6 address, and verify that a datagram using a
        given IPv6 source address comes from the appropriate source.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Defense in depth</h3>

<p>There is also a place for ingress filtering by prefix, usually
        accomplished via Unicast Reverse Path Forwarding or via filters. In
        general, this is performed between administrations - at the interface
        between peer ISPs, an ISP and its customer, or between two networks of
        another type. In concept, however, it could be applied on every router
        in a network. This will be discussed in <a class='info' href='#remote'>Section&nbsp;3<span> (</span><span class='info'>Implementating Source Address Validation for remote systems</span><span>)</span></a>.
</p>
<a name="local"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Implementating Source Address Validation in the local environment</h3>

<p>This section will describe in general terms a common approach to
      source address validation between two directly connected systems.
</p>
<p>Addresses are allocated to systems in two ways in IPv6: <a class='info' href='#RFC3315'>DHCP<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a> [RFC3315], <a class='info' href='#RFC4862'>Stateless Address
      Autoconfiguration<span> (</span><span class='info'>Thomson, S., Narten, T., and T. Jinmei, &ldquo;IPv6 Stateless Address Autoconfiguration,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4862]. These addresses are exchanged with a system's
      neighbors using either <a class='info' href='#RFC4861'>Neighbor Discovery<span> (</span><span class='info'>Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;Neighbor Discovery for IP version 6 (IPv6),&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4861],
      or for <a class='info' href='#RFC3972'>Cryptographically Generated
      Addresses<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC3972], <a class='info' href='#RFC3971'>SEcure Neighbor Discovery<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC3971]. Each of these will be looked at.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Trust anchors</h3>

<p>In short, the implementation approach requires neighboring devices
        to associate a layer 3 entity addressed with an IPv6 address with a
        layer 2 entity. The identification of the layer 2 entity may take a
        number of forms:</p>
<ul class="text">
<li>On a traditional Ethernet or for a host or router attached to a
            switched Ethernet, the only real option is association with the
            MAC Address.
</li>
<li>The switch, however, may be able to associate the IPv6 address
            with a switch port if it knows that only one host is attached to
            the port.
</li>
<li>In a wireless network, there are often layer 2 security
            associations between neighboring devices, and the address can be
            associated with that security association.
</li>
<li>In a Cable Modem network, the address may be associated with
            the combination of a MAC address and a customer relationship.
</li>
<li> In a classical DSL network, it may be associated with an ATM Virtual Channel, or a PPPoE or L2TP Session ID.  
</li>
<li>In some cases, an IP/IP tunnel, an MPLS LSP, or similar
            tunneling technology is taken to a single system. In such cases,
            local address validation can be applied to the use of the
            tunnel.
</li>
</ul>

<p>The key is to have a solid understanding of </p>
<ul class="text">
<li>what identifies a neighbor in the context: a MAC Address, a
            switch port, an ATM VC, or whatever,
</li>
<li>what addresses one's neighbor is in fact using, and
</li>
<li>to limit what one accepts from the neighbor as so identified to
            that which the neighbor is legitimately using.
</li>
</ul>

<p>One could argue that this runs counter to the Robustness Principle,
        which is stated in RFC 793 as "be conservative in what you do, be
        liberal in what you accept from others." In fact, it follows the
        Robustness Principle, but adds the Russian proverb made famous in the
        west by Ronald Reagan: "Trust, but verify".
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Host and Router validation of the addresses of neighboring systems</h3>

<p>Since a peer's neighbors are intended to learn its address using
        Neighbor Discovery or Secure Neighbor Discovery, they should look
        there. If one system sends a datagram to a host or router on the same
        LAN or otherwise directly connected and the receiving system does not
        know the address to have been associated with the system that sent it,
        both of these protocols ask the receiver to query the sender using a
        Neighbor Solicit. Generally, this is done when sending the reply - the
        Neighbor Solicit and responding Neighbor Advertisement must be
        exchanged to send the application reply.
</p>
<p>This specification recommends that, to protect hosts from attack
        traffic and prevent routers from forwarding datagrams with spoofed
        addresses, the NS/NA exchange SHOULD happen before the received
        datagram is operated on.
</p>
<p>There are two schools of thought on the holding of the datagram;
        one holds that the host or router should hold the datagram in a short
        queue and release it on receipt of the NA, and one holds that the
        receiver may force the sender to retransmit it. As either approach may
        be viewed as an attack (a sender spewing datagrams with spoofed
        addresses may clog its neighbors with traffic, and an application
        being forced to retransmit experiences a user-observable delay), this
        specification takes no position on that matter. The receiver MAY hold
        the datagram in a short queue to be operated on when the NA arrives,
        and it MAY discard it.
</p>
<p>Given this model, there is a potential front-running attack on
        Stateless Address Autoconfiguration. When one system enters the
        Duplicate Address Detection phase, another system could see the
        address being verified and immediately send a message (perhaps an ICMP
        Echo Request sent as a link layer multicast) claiming the address. The
        systems that receive it would respond with a Neighbor Solicit, it
        would reply with a Neighbor Advertisement, and the original system
        would be denied the use of the address. As such, systems observing an
        address that they have no association for being verified using
        Duplicate Address Detection SHOULD NOT then grant it to another
        system.
</p>
<p>As noted, in IPv6 networks hosts and routers usually have multiple
        addresses on any given interface. There is a potential attack in this
        as well: especially with privacy addressing, one could imagine a host
        using a new address for each TCP or SCTP session it opens, and one
        could imagine an attack that simulates this but simply fills its
        neighbor's tables with addresses. A host or router MAY (eg, is
        authorized to) limit the number of addresses for a neighbor that it
        will simultaneously hold, and the number of addresses considered
        reasonable is intentionally not specified. It SHOULD use memory
        allocated to that function in a Least Recently Used fashion,
        preserving recollection of addresses a neighbor is actually using and
        reusing table entries that appear to be unused.
</p>
<p>As noted in <a class='info' href='#ipv6-complications'>Section&nbsp;1.2<span> (</span><span class='info'>Local Source Address Validation for IPv6</span><span>)</span></a>, caveats that
        make this difficult include any system that might send a datagram from
        an address unknown in the local environment. These include, but are
        not limited to, routers and any middleware that behaves like a router,
        in that it forwards datagrams originated by other systems using their
        source addresses, and multi-LAN hosts. To simplify source address
        validation, this specification declares that a host SHOULD send any
        datagram it originates on an interface the source address is
        associated with. Routers and router-like middleware such as firewalls
        must be exlcuded from such analysis.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Validation of the addresses of neighboring systems by a switch</h3>

<p>In this context, a "switch" refers to a system that switches
        messages for any lower layer protocol. Examples include Ethernet, ATM,
        Cable Modem, DSL, and so on.
</p>
<p>As with IPv4, it is reasonable for a switch to simply observe the
        Neighbor Advertisements issued by a host or router and note that the
        host or router may be using them. There is a potential attack in this,
        however, in that a host could simply spew Neighbor Advertisements. For
        this reason, the protocol calls for a Neighbor Advertisement to be in
        response to a Neighbor Solicit. Therefore, a switch implementation
        that observes Neighbor Discovery or Secure Neighbor Discovery SHOULD
        remember addresses from Neighbor Advertisement only if it has seen a
        prior Neighbor Solicit.
</p>
<p>A switch MAY observe DHCP assignments of addresses to hosts and
        drop host-originated datagrams using other source addresses. If it
        does, it SHOULD be prepared to accept multiple simultaneous
        assignments.
</p>
<p>A switch or upstream router MAY also observe assignments of
        prefixes to downstream routers using the <a class='info' href='#RFC3633'>DHCP
        Prefix Assignment Options<span> (</span><span class='info'>Troan, O. and R. Droms, &ldquo;IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6,&rdquo; December&nbsp;2003.</span><span>)</span></a> [RFC3633], and use that information to
        configure ingress prefix filtering.
</p>
<p>As with host implementations, a switch MAY limit the number of
        addresses it will simultaneously store. If it does so, it SHOULD use
        memory allocated to that function in a Least Recently Used fashion,
        preserving recollection of addresses a neighbor is actually using and
        reusing table entries that appear to be unused.
</p>
<a name="remote"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Implementating Source Address Validation for remote systems</h3>

<p>As mentioned, it is often in an administration's interest to protect
      itself from other administrations, which may have inadequate
      anti-spoofing measures in place. This is the original thrust of <a class='info' href='#RFC2827'>BCP 38<span> (</span><span class='info'>Ferguson, P. and D. Senie, &ldquo;Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing,&rdquo; May&nbsp;2000.</span><span>)</span></a> [RFC2827]. Unfortunately, one step removed from the
      source system, there is no anchor to verify that the address is exactly
      correct; rather, one can only verify that it is reasonable - it is
      within the prefix.
</p>
<p>It has been argued that this is nonsensical, as anti-spoofing
      procedures impose additional router processing and only protect other
      networks. This is incorrect, however, for two reasons. Modern routers
      often implement filtering or Unicast Reverse Path Forwarding procedures
      in hardware, minimizing the processing burden, although the
      differentiated tables may consume memory. In any event, attacks
      perpetrated from a downstream network (obscured in some cases by address
      spoofing) attack both the administration's network and the
      administration's customers. Dealing with that problem is generally the
      first step in side-stepping an attack.
</p>
<p>To implement, a router MAY be configured to discard traffic that
      routing believes is coming from an inappropriate direction. This does
      not depend on the router's choice of routes, however; it depends on the
      routing calculated by a router's neighbors. As such, if router A validly
      advertises to router B that it can route traffic to a prefix, the router
      B SHOULD accept traffic from that prefix via router A.
</p>
<p>The determination of when a routing advertisement is valid is beyond
      the scope of this specification.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
IANA Considerations</h3>

<p>This memo adds no new IANA considerations.
</p>
<p>Note to RFC Editor: This section will have served its purpose if it
      correctly tells IANA that no new assignments or registries are required,
      or if those assignments or registries are created during the RFC
      publication process. From the author's perspective, it may therefore be
      removed upon publication as an RFC at the RFC Editor's discretion.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>This note describes a set of security considerations for the IPv6
      Internet, specifically related to attack management in <a class='info' href='#RFC2460'>IPv6<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> [RFC2460] and in the configuration and communication
      mechanisms of <a class='info' href='#RFC4862'>Stateless Address
      Autoconfiguration<span> (</span><span class='info'>Thomson, S., Narten, T., and T. Jinmei, &ldquo;IPv6 Stateless Address Autoconfiguration,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4862], <a class='info' href='#RFC4861'>Neighbor
      Discovery<span> (</span><span class='info'>Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;Neighbor Discovery for IP version 6 (IPv6),&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4861], and <a class='info' href='#RFC3971'>SEcure Neighbor Discovery<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC3971]. It does not introduce new attacks, but it identifies some
      existing ones and recommends approaches to their mitigation.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Contributors</h3>

<p>This document was developed in the SAVA context. Contributors include
      the author, Christian Vogt, Gang Ren, Hannes Tschofenig, Jari Arkko,
      Jianping Wu, Jun Bi, Ke Xu, and Pekka Savola.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0791">[RFC0791]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;791, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc791.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2827">[RFC2827]</a></td>
<td class="author-text">Ferguson, P. and D. Senie, &ldquo;<a href="http://tools.ietf.org/html/rfc2827">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</a>,&rdquo; BCP&nbsp;38, RFC&nbsp;2827, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2827.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3971">[RFC3971]</a></td>
<td class="author-text">Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;<a href="http://tools.ietf.org/html/rfc3971">SEcure Neighbor Discovery (SEND)</a>,&rdquo; RFC&nbsp;3971, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3971.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4861">[RFC4861]</a></td>
<td class="author-text">Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;<a href="http://tools.ietf.org/html/rfc4861">Neighbor Discovery for IP version 6 (IPv6)</a>,&rdquo; RFC&nbsp;4861, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4861.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4862">[RFC4862]</a></td>
<td class="author-text">Thomson, S., Narten, T., and T. Jinmei, &ldquo;<a href="http://tools.ietf.org/html/rfc4862">IPv6 Stateless Address Autoconfiguration</a>,&rdquo; RFC&nbsp;4862, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4862.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4941">[RFC4941]</a></td>
<td class="author-text">Narten, T., Draves, R., and S. Krishnan, &ldquo;<a href="http://tools.ietf.org/html/rfc4941">Privacy Extensions for Stateless Address Autoconfiguration in IPv6</a>,&rdquo; RFC&nbsp;4941, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4941.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text"><a href="mailto:droms@bucknell.edu">Droms, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>,&rdquo; RFC&nbsp;2131, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2131.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2131.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2131.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3633">[RFC3633]</a></td>
<td class="author-text">Troan, O. and R. Droms, &ldquo;<a href="http://tools.ietf.org/html/rfc3633">IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6</a>,&rdquo; RFC&nbsp;3633, December&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3633.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3972">[RFC3972]</a></td>
<td class="author-text">Aura, T., &ldquo;<a href="http://tools.ietf.org/html/rfc3972">Cryptographically Generated Addresses (CGA)</a>,&rdquo; RFC&nbsp;3972, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3972.txt">TXT</a>).</td></tr>
</table>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Summary of recommendations</h3>

<p></p>
<ol class="text">
<li>The NS/NA exchange on a response to a received datagram SHOULD
          happen before the received datagram is operated on.
</li>
<li>The receiver MAY hold the triggering datagram in a short queue to
          be operated on when the NA arrives, and it MAY discard it.
</li>
<li>Systems observing an address that they have no association for
          being verified using Duplicate Address Detection SHOULD NOT then
          grant it to another system.
</li>
<li>A host or router MAY (eg, is authorized to) limit the number of
          addresses for a neighbor that it will simultaneously hold, and the
          number of addresses considered.
</li>
<li>It SHOULD use memory allocated to that function in a Least
          Recently Used fashion, preserving recollection of addresses a
          neighbor is actually using and reusing table entries that appear to
          be unused.
</li>
<li>To simplify source address validation, this specification
          declares that a host SHOULD send any datagram it originates on an
          interface the source address is associated with.
</li>
<li>A switch that monitors Neighbor Discovery or Secure Neighbor
          Discovery SHOULD remember addresses from Neighbor Advertisement only
          if it has seen a prior Neighbor Solicit.
</li>
<li>A switch MAY observe DHCP assignments of addresses to hosts and
          drop host-originated datagrams using other source addresses.
</li>
<li>If it does, it SHOULD be prepared to accept multiple simultaneous
          assignments.
</li>
<li>A switch or upstream router MAY also observe assignments of
          prefixes to downstream routers using the DHCP Prefix Assignment
          Options [RFC3633], and use that information to configure ingress
          prefix filtering.
</li>
<li>A switch MAY limit the number of addresses it will simultaneously
          store.
</li>
<li>If it does so, it SHOULD use memory allocated to that function in
          a Least Recently Used fashion, preserving recollection of addresses
          a neighbor is actually using and reusing table entries that appear
          to be unused.
</li>
<li>A router MAY discard traffic that routing believes is coming from
          an inappropriate direction.
</li>
<li>If router A validly advertises to router B that it can route
          traffic to a prefix, the router B SHOULD accept traffic from that
          prefix via router A.
</li>
</ol>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fred Baker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Barbara, California  93117</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-408-526-4257</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fred@cisco.com">fred@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
