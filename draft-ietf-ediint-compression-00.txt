Internet Draft                                     Editor: Terry Harding
draft-ietf-ediint-compression-00.txt               Cyclone Commerce Inc.
September 6, 2001
Expires April 2002
Target Category: Informational

                  Compressed Data for EDIINT

Status of this memo

This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of RFC2026.

Internet-Drafts are working documents of the Internet Engineering Task
Force (IETF), its areas, and its working groups.  Note that other
groups may also distribute working documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet-Drafts as reference material
or to cite them other than as "work in progress."

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.

Copyright (C) The Internet Society July 2001.  All Rights Reserved.

Abstract

The intent of this document is to be placed on the RFC track as an
Informational RFC.

The EDIINT AS1 and AS2 message formats don't currently contain any
transport neutral provisions for compressing data when utilizing S/MIME
as the secure packaging standard. Compressing data before transmission
provides a number of advantages including

1. reducing data redundancy, and so reducing opportunities for attacks
   exploiting redundancy, and
2. reducing the amount of data and so speeding up cryptographic
   processing such as signing, encryption, archiving, and
3. reducing the overall transmitted message size, reducing both time and
   bandwidth needed for transport.


1. Introduction

This document describes an additional mime layer of compressed data
utilizing a new ContentInfo type for S/MIME. This new compressed-data
content type is an extension to the types currently defined in
CMS[RFC2630]. Further reference can be found in the reference section

Terry Harding                                                [Page 1]

Compressed Data for EDIINT                            September, 2001

under [COMPRESSED-DATA]. The method of compression outlined in this
document will support any type of business related media. Documents
containing a large percentage of ASCII characters like xml, x12 or
edifact will experience greater compression ratios than documents
consisting largely of binary data. Ex: MSWord documents.


The key words "MUST", "MUST NOT", "REQUIRED", "SHOULD", "SHOULD NOT",
"RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in [RFC2119].

1.1 Compressed-Data Mime Wrapper

The compressed-data cms object will encapsulate a mime wrapped business
document. Implementors are to follow the appropriate specifications
identified under "References" in [MIME-TYPES], for the type of object
being transmitted. For example, to send an XML object, the MIME media
type of application/xml is used in the Content-type MIME header and the
specifications for enveloping the object are contained in [XMLTYPES];
for example:

        Content-type: application/xml; charset="utf-8"

The mime wrapped object will be compressed and placed inside a CMS
compressed-data object as outlined in [COMPRESSED-DATA]. The compressed
data object will be mime wrapped according to details outlined in
[S/MIME],Section 3.2. Since RFC2633 does not specifically reference the
new compressed-data type, we will use the encrypted-only section 3.3 as
a guide to properly mime wrapping the compressed data object.

Example:

	Content-type: application/pkcs7-mime; smime-type=compressed-data;
            name=smime.p7m
        Content-Transfer-Encoding: base64
        Content-Disposition: attachment; filename=smime.p7m

        rfvbnj756tbBghyHhHUujhJhjH77n8HHGT9HG4VQpfyF467GhIGfHfYT6
        7n8HHGghyHhHUujhJh4VQpfyF467GhIGfHfYGTrfvbnjT6jH7756tbB9H
        f8HHGTrfvhJhjH776tbB9HG4VQbnj7567GhIGfHfYT6ghyHhHUujpfyF4
        0GhIGfHfQbnj756YT64V

Note: Content-Transfer-Encoding would only be required if the mime
wrapped CMS object was transferred via SMTP and it was visible in the
outer layer of the mime message. If the compressed-data mime bodypart
was place inside of an encrypted mime bodypart,
content-transfer-encoding would not be required on the compressed-data
mime bodypart, but would be required on the encrypted mime bodypart.

1.2 Structure of an EDI MIME message utilizing compression



Terry Harding                                                [Page 2]

Compressed Data for EDIINT                            September, 2001

1.2.1 No encryption, no signature

   -RFC822/2045
     -[COMPRESSED-DATA](application/pkcs7-mime)
       -[MIME-TYPES](application/xxxxxxx)

1.2.2 No encryption, signature

   -RFC822/2045
     -RFC1847 (multipart/signed)
       -[COMPRESSED-DATA](application/pkcs7-mime)
         -[MIME-TYPES](application/xxxxxxx)
       -RFC2633 (application/pkcs7-signature)

1.2.3 Encryption, no signature

   -RFC822/2045
     -RFC2633 (application/pkcs7-mime)
       -[COMPRESSED-DATA](application/pkcs7-mime) (encrypted)
         -[MIME-TYPES](application/xxxxxxx) (encrypted)

1.2.4 Encryption, signature

   -RFC822/2045
     -RFC2633 (application/pkcs7-mime)
       -RFC1847 (multipart/signed) (encrypted)
         -[COMPRESSED-DATA](application/pkcs7-mime) (encrypted)
           -[MIME-TYPES](application/xxxxxxx) (encrypted)
         -RFC2633 (application/pkcs7-signature) (encrypted)


2. MIC Calculations For Signed Receipts

For any signed messages, the MIC to be returned is calculated over
the same data that was signed in the original message as per AS1.

For encrypted, unsigned messages, the MIC to be returned is
Calculated over the same data that was encrypted in the original
message as per AS1.

For unsigned, unencrypted messages, the MIC MUST be calculated
over the message contents prior to Content-Transfer-Encoding or
Content-Encoding, and without the MIME or any other RFC 822
headers, since these are sometimes altered or reordered by MTAs.


3. Compression Formats

Implementations SHOULD support ZLIB [RFC1950] which utilizes
DEFLATE[RFC1951], and is free of any intellectual property
restrictions and has a freely-available, portable and efficient
reference implementation.

Terry Harding                                                [Page 3]

Compressed Data for EDIINT                            September, 2001

4. Security Considerations

This document is not concerned with security, except for the fact that
compressing data before encryption can enhance the security by reducing
redundancy of the file. The lower the redundancy of the plaintext being
encrypted, the more difficult the cryptanalysis, see
reference[CRYPTANALYSIS].


Author Address

Terry Harding
Cyclone Commerce Inc.
Scottsdale, Arizona, USA
tharding@cyclonecommerce.com

References

  [ASN1]  CCITT Recommendation X.208: Specification of Abstract Syntax
        Notation One (ASN.1), 1988.

  [RFC2119] Key Words for Use in RFC's to Indicate Requirement Levels,
        S.Bradner, March 1997.

  [ZLIB] RFC1950 ZLIB Compressed Data Format Specification version 3.3,
        P.Deutsch and J-L Gailly, May 1996.

  [DEFLATE] RFC1951 DEFLATE Compressed Data Format Specification version
            1.3, P.Deutsch, May 1996.

  [CMS] RFC2630 Cryptographic Message Syntax, R.Housley, June 1999.

  [S/MIME]RFC2633 S/MIME Version 3 Message Specification, B.Ramsdell,
          June 1999.

  [MIME-TYPES]  "Media Types," http://www.isi.edu/in-
                notes/iana/assignments/media-types/media-types.

  [XMLTYPES]  E. Whitehead, M. Murata, "XML Media Types", RFC 2376,
              July 1998.

  [COMPRESSED-DATA]  P. Gutmann, "Compressed Data Content Type for CMS"
                     draft-ietf-smime-compression-05.txt, July 2001.

  [CRYPTANALYSIS]  B. Schneier, "Self-Study Course in Block Cipher
 Cryptanalysis", http://www.counterpane.com/self-study.html, Jan 2000.







Terry Harding                                                [Page 4]

Compressed Data for EDIINT                            September, 2001

Acknowledgements

   A number of the members of the EDIINT Working Group have also worked
   very hard and contributed to this document. The following people
   have made direct contributions to this document.

   David Fischer, Dale Moberg, Robert Asis.


Full Copyright Statement

Copyright (C) The Internet Society 2001.  All Rights Reserved.

This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it or
assist in its implementation may be prepared, copied, published and
distributed, in whole or in part, without restriction of any kind,
provided that the above copyright notice and this paragraph are
included on all such copies and derivative works. However, this
document itself may not be modified in any way, such as by removing the
copyright notice or references to the Internet Society or other
Internet organizations, except as needed for the purpose of developing
Internet standards in which case the procedures for copyrights defined
in the Internet Standards process must be followed, or as required to
translate it into languages other than English.

The limited permissions granted above are perpetual and will not be
revoked by the Internet Society or its successors or assigns.

This document and the information contained herein is provided on an
"AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT
NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL
NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR
FITNESS FOR A PARTICULAR PURPOSE.


















Terry Harding                                                [Page 5]
