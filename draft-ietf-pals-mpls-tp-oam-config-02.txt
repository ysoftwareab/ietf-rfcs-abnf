



Network Working Group                                      F. Zhang, Ed.
Internet-Draft                                                    Huawei
Intended status: Standards Track                              B. Wu, Ed.
Expires: January 7, 2016                                 ZTE Corporation
                                                      E. Bellagamba, Ed.
                                                                Ericsson
                                                            M. Chen, Ed.
                                                                  Huawei
                                                            July 6, 2015


LDP Extensions for Proactive Operations, Administration and Maintenance
       Configuration of Dynamic MPLS Transport Profile PseudoWire
                 draft-ietf-pals-mpls-tp-oam-config-02

Abstract

   This document defines extensions to LDP to configure proactive OAM
   functions for both SS-PW and MS-PW when the PW control plane is used.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 7, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must



Zhang, et al.            Expires January 7, 2016                [Page 1]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions used in this document . . . . . . . . . . . . . .   3
     2.1.  Acronyms  . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  MPLS-TP PW OAM Configuration  . . . . . . . . . . . . . . . .   5
     3.1.  OAM Configuration for SS-PW . . . . . . . . . . . . . . .   5
       3.1.1.  Establishment of OAM Entities and Functions . . . . .   5
       3.1.2.  Adjustment of OAM Parameters  . . . . . . . . . . . .   7
       3.1.3.  Deleting OAM Entities . . . . . . . . . . . . . . . .   8
     3.2.  OAM Configuration for MS-PW . . . . . . . . . . . . . . .   8
       3.2.1.  Establishment of OAM Entities and Functions . . . . .   8
       3.2.2.  Adjustment of OAM Parameters  . . . . . . . . . . . .  10
       3.2.3.  Deleting OAM Entities . . . . . . . . . . . . . . . .  11
   4.  LDP Extensions  . . . . . . . . . . . . . . . . . . . . . . .  12
     4.1.  MPLS-TP PW OAM Administration TLV . . . . . . . . . . . .  12
     4.2.  PW OAM Functions TLV  . . . . . . . . . . . . . . . . . .  13
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  15
     5.1.  TLVs  . . . . . . . . . . . . . . . . . . . . . . . . . .  15
     5.2.  OAM Configuration Status Code . . . . . . . . . . . . . .  15
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .  16
   7.  Acknowledgement . . . . . . . . . . . . . . . . . . . . . . .  17
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  17
     8.1.  Normative references  . . . . . . . . . . . . . . . . . .  17
     8.2.  Informative References  . . . . . . . . . . . . . . . . .  17
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  18

1.  Introduction

   There are two documents that define MultiProtocol Label Switching
   (MPLS) Pseudowire (PW).  [RFC3985] defines Singel Segment PW (SS-PW)
   and [RFC5659] defines Multi-Segment PW (MS-PW).  The two documents
   expain how to provide emulated services over an MPLS Packet Switched
   Network (PSN).  The MPLS Transport Profile (MPLS-TP) is described in
   [RFC5291], which describes a profile of MPLS that introduces the
   operational models that were typically used in transport networks,
   while providing additional Operations, Administration and Maintenance
   (OAM), survivability and other maintenance functions that were not
   previously supported by IP/MPLS network.  The MPLS-TP requirements
   are defined in [RFC5860].

   The MPLS-TP OAM mechanisms are described in [RFC6371], which can be
   categorized into proactive and on-demand OAM.  Proactive OAM refers
   to OAM operations that are either configured to be carried out



Zhang, et al.            Expires January 7, 2016                [Page 2]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   periodically and continuously or preconfigured to act on certain
   events (e.g., alarm signals).  In contrast, on-demand OAM is
   initiated manually and for a limited amount of time, usually for
   operations such as diagnostics to investigate into a defect
   condition.

   When a control plane is not used the OAM functions are typically
   configured from the Network Management System (NMS).  When a control
   plane is used, requirement 51 in [RFC5654] requires that it MUST be
   able to support configuration of the OAM functions.  The control
   plane is also required to be able to configure, maintain and modify,
   as well as activation/deactivation of maintenance points.

   For MPLS-TP OAM configuration, two companion documents exists.  One
   of them is [RFC7260] that specifies extensions to Resource
   Reservation Protocol - Traffic Engineering (RSVP-TE) to support the
   establishment and configuration of OAM entities along with Label
   Switched Path (LSP) signaling.  The other is
   [I-D.ietf-mpls-lsp-ping-mpls-tp-oam-conf] that defines how LSP Ping
   is extended to support the configuration of proactive MPLS-TP OAM
   functions.

   This document defines extensions to the Label Distribution Protocol
   (LDP) to configure MPLS-TP PW OAM functions for both Point to Point
   SS-PW and MS-PW, which are aligned with those companion documents.
   Extensions to Point to Multi-Point (P2MP) PW are for future study and
   outside the scope of this document.

2.  Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

2.1.  Acronyms

      AIS: Alarm indication signal

      BFD: Bidirectional Forwarding Detection

      CC: Continuity Check

      CV: Connectivity Verification

      DM: Delay Measurement

      FEC: Forwarding Equivalence Class




Zhang, et al.            Expires January 7, 2016                [Page 3]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


      FMS: Fault Management Signal

      G-ACh: Generic Associated Channel

      LDI: Link Down Indication

      LDP: Label Distribution Protocol

      LM: Loss Measurement

      LSP: Label Switched Path

      MEP: Maintenance Entity Group End Point

      MIP: Maintenance Entity Group Intermediate Point

      MPLS-TP: MPLS Transport Profile

      MS-PW: Multi-Segment PseudoWire

      NMS: Network Management System

      OAM: Operations, Administration and Maintenance

      P2MP: Point to Multi-Point

      PE: Provider Edge

      PHB: Per-Hop Behavior

      PM: Performance Monitoring

      PSN: Packet Switched Network

      PW: Pseudowire

      S-PE: Switching Provider Edge

      SS-PW: Single-Segment Pseudo Wire

      T-PE: Terminating Provider Edge

      TLV: Type Length Value








Zhang, et al.            Expires January 7, 2016                [Page 4]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


3.  MPLS-TP PW OAM Configuration

   This document defines two new TLVs, the PW OAM Administration TLV and
   the PW OAM Functions TLV.

   The PW OAM Administrations TLV is used setup/remove MIP and MEP
   Functions and to control whether alarms are suppressed or not.

   The PW Functions TLV is used to configure, enable and disable OAM
   Functions (e.g.  CC, CV and PM).  More details about the new TLVs are
   found in Section 4.

3.1.  OAM Configuration for SS-PW

3.1.1.  Establishment of OAM Entities and Functions

   OAM entities and functions can be setup, configured and activated
   either when the PW first is signalled or on an already established
   PW.  This section describes how the OAM entities and functions are
   setup and configured with the signalling of a PW.

   For the case where OAM entities and functions are setup and
   configured after PW establishment of a PW, the procedures are
   identical to the "adjustment of OAM parameters" procedures, more
   detail can be found in Section 3.1.2.

   Given that a SS-PW needs to be setup between PE1 and PE2 (see
   Figure 1) . OAM functions MUST be setup and enabled in the
   appropriate order so that spurious alarms can be avoided.

       +-------+               +-------+
       |       |               |       |
       |       |---------------|       |
       |       |               |       |
       +-------+               +-------+
          PE1                     PE2

          Figure 1 SS-PW OAM Configuration Scheme

                 Figure 1: SS-PW OAM Configuration Scheme

   Fist, the ingress PE (e.g., PE1) must setup the OAM sink function and
   prepare to receive OAM messages.  Until the PW is fully established,
   any OAM alarm SHOULD be suppressed.

   To achieve this, a Label Mapping message with the "OAM Alarms
   Enabled" flag cleared is sent.  In the message, the "OAM MEP Entities
   Desired" flag is set.  Since there is no MIPs for a SS-PW, the "OAM



Zhang, et al.            Expires January 7, 2016                [Page 5]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   MIP Entities desired" flag MUST be cleared.  In addition, to
   configure and enable particular OAM functions, the PW OAM Functions
   TLV and relevant sub-TLVs MUST be included.

   When the Label Mapping message is received by PE2, PE2 needs to check
   whether it supports the the requested OAM configuration.  If it does
   not support the requested OAM configuration, a Label Release message
   MUST be returned to PE1, with a Status Code set to "MPLS-TP PW OAM
   Parameters Rejected".  The PW signalling is complete and the PW will
   not be established.  If the requested OAM parameters and
   configuration are supported, PE2 will establish and configure the
   requested OAM entities.

   If PE2 fails to establish and configure the OAM entities, a Label
   Release message will be returned to PE1, with a Status Code set to
   "MPLS-TP PW MEP Configuration Failed".  The PW signalling is complete
   and the PW will not be established.

   If the OAM entities are setup and configured successfully, the OAM
   sink and source functions is setup and the OAM sink function will be
   configured to receive OAM messages.

   Since the OAM alarm is disabled, no alarms will be generated.  The
   OAM source function can start to send OAM messages.  PE2 will then
   reply a Label Mapping message to PE1, the PW OAM Administration TLV
   and PW OAM Configuration TLV from the received Label Mapping message
   MUST be copied and carried in the Label Mapping message.

   When PE1 receives this Label Mapping message, PE1 completes any
   pending OAM configuration and enables the OAM source function to send
   OAM messages.

   For PE1, the OAM entities and functions are now setup and configured,
   and OAM messages may be exchanged.  The OAM alarms can be safely
   enabled.  The initiator PE (PE1) will send another Label Mapping
   message with "OAM Alarms Enabled" flag set to PE2, this will allow
   PE2 to enable the OAM alarm function.

   When the Label Mapping message is received by PE2, the OAM alarm will
   be enabled.  PE2 then sends a Notification message with the Status
   Code set to "MPLS-TP PW OAM Alarms enabled" to PE1.

   When the Notification message is received by PE1, PE1 enables the OAM
   alarm function.  At this point, data-plane OAM is fully functional.







Zhang, et al.            Expires January 7, 2016                [Page 6]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


3.1.2.  Adjustment of OAM Parameters

   Existing OAM parameters may be changed during the life time of a PW.
   To achieve this, PE1 sends a Label Mapping message with the updated
   OAM parameters to PE2.

   To avoid spurious alarms, it is important that OAM sink and source
   functions on both PEs are updated in a synchronized way.  First, the
   alarms of the OAM sink function should be suppressed.  After that,
   new OAM parameters can be adjusted.  Subsequently, the parameters of
   the OAM source function can be updated.  Finally, the alarms can be
   enabled again.

   Consequently, the ingress PE needs to keep its OAM sink and source
   functions running without any changes until the OAM parameters are
   updated.  However, in order to suppress spurious alarms, it also need
   to disable the alarm functions before the Label Mapping message, with
   the "OAM Alarms Enabled" flag cleared and the updated PW OAM Function
   TLV, is sent.  The OAM alarm function needs to be disabled until the
   corresponding response message is received.

   On receipt of the Label Mapping message, PE2 needs to check whether
   the updated parameters can be supported.  If they can be supported,
   PE2 needs first disable the OAM alarms firstly and then update the
   OAM parameters.  When the update is done, a Notification message
   needs to be sent to PE1, with the Status Code set to "MPLS-TP PW MEP
   Configuration Succeed", to acknowledge the update.  If PE2 can not
   support the update, a Notification message with Status Code set to
   "MPLS-TP PW OAM Parameters Rejected" will be sent to PE1.

   When PE1 receives the Notification message with the Status Code set
   to "MPLS-TP PW MEP Configuration Succeed", PE1 will update using the
   new OAM parameters.  After the OAM parameters are updated and the OAM
   is running with the new parameter settings, OAM alarms are still
   disabled.  A subsequent Label Mapping message with "OAM Alarms
   Enabled" flag set will be sent to re-enable OAM alarms.  If the
   Status Code of the received Notification message is "MPLS-TP PW OAM
   Parameters Rejected", it will not update the OAM parameters.  The OAM
   alarms are just enabled again and the OAM will keep running with the
   old parameters.  PE1 can also re-try changing the OAM parameters
   using a different set of parameters.

   When PE2 received the Label Mapping message with "OAM Alarms Enabled"
   flag set, it will enable the OAM alarms and reply a Notification
   message with Status Code set to "MPLS-TP PW OAM Alarms Enabled".
   When received the Notification message, PE1 will enable the OAM
   alarms again.




Zhang, et al.            Expires January 7, 2016                [Page 7]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


3.1.3.  Deleting OAM Entities

   In some cases it may be useful to remove all OAM entities and
   functions from a PW without actually tearing down the connection.
   The deleting procedures are defined as below:

   First, the ingress PE (e.g., PE1) disables its own the OAM alarms and
   then sends a Label Mapping message to the remote PE (e.g., PE2) with
   the "OAM Alarms Enabled" flag set but with all other OAM
   configurations unchanged.

   When received the Label Mapping message, PE2 disables the OAM alarm
   and then send a Notification message with Status Code set to "MPLS-TP
   PW OAM Alarms Disabled" to PE1.

   When received the confirmation from PE2, it's safe to delete the OAM
   entities.  PE1 will delete the OAM entities related to the PW and
   send another Label Mapping message with the "OAM MEP Entities
   desired" flag cleared to PE2.

   When PE2 received the Label Mapping message, it will delete all OAM
   entities related to the PW and then reply a Notification message with
   the Status Code set to "MPLS-TP PW MEP Entities Disabled" to PE1.

3.2.  OAM Configuration for MS-PW

3.2.1.  Establishment of OAM Entities and Functions

   Given that a MS-PW needs to be setup between T-PE1 and T-PE2, across
   S-PE1 and S-PE2 (see Figure 2) . OAM functions MUST be setup and
   enabled in the appropriate order so that spurious alarms can be
   avoided.

       +-------+        +-------+        +-------+        +-------+
       |       |        |       |        |       |        |       |
       |      A|--------|B     C|--------|D     E|--------|F      |
       |       |        |       |        |       |        |       |
       +-------+        +-------+        +-------+        +-------+
         T-PE1            S-PE1            S-PE2            T-PE2

                             Figure 2 MS-PW Scenario

                 Figure 2: MS-PW OAM Configuration Scheme

   Fist, T-PE1 must setup the OAM sink function and prepare to receive
   OAM messages.  Until the PW is fully established, any OAM alarm
   SHOULD be suppressed.




Zhang, et al.            Expires January 7, 2016                [Page 8]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   To achieve this, a Label Mapping message with the "OAM Alarms
   Enabled" flag cleared is sent.  If the S-PEs are expected to setup
   and configure the MIP entities, the "OAM MIP Entities desired" flag
   MUST be set.  In the message, the "OAM MEP Entities Desired" flag is
   set.  In addition, to configure and enable particular OAM functions,
   the PW OAM Functions TLV and relevant sub-TLVs MUST be included.

   On receipt of the Label Mapping message, S-PE(e.g., S-PE1) needs to
   check whether it supports MIP function.  If S-PE1 does not support
   MIP function, a Notification message will be sent to T-PE1, with the
   Status Code set to "MPLS-TP PW MIP Configuration Failed".  If S-PE1
   supports MIP function, it will establish and configure the MIP
   entities according to the "OAM MIP Entities desired" flag in the PW
   OAM Administration TLV.  No mather whether S-PE1 supports MIP
   function, it will relay the Label Mapping message downstream to the
   next S-PE.  All the subsequent S-PEs along the PW will perform the
   same operations as S-PE1 does until the Label Mapping message reaches
   the remote T-PE (T-PE2).

   When the Label Mapping message is received by the remote T-PE
   (T-PE2), T-PE2 needs to check whether it support the requested OAM
   configuration.  If it does not support the requested OAM
   configuration, a Label Release message MUST be returned to its
   upstream PE, with a Status Code set to "MPLS-TP PW MEP Configuration
   Failed".  The signalling is complete and the PW will not be
   established.  If the requested OAM parameters and configuration are
   supported, T-PE2 will establish and configure requested OAM entities.

   If T-PE2 fails to establish and configure the OAM entities, a Label
   Release message MUST be replied to its upstream PE, with a Status
   Code set to "MPLS-TP PW MEP Configuration Failed".  The signalling is
   complete and the PW will not be established.

   If the OAM entities established and configured successfully, the OAM
   sink and source functions are setup and the OAM sink function will be
   configured to receive OAM messages.  Since the OAM alarm is disabled,
   no alarms will be generated.  The OAM source function can start to
   send OAM messages.  T-PE2 will then reply a Label Mapping message,
   the PW OAM Administration TLV and PW OAM Function TLV from the
   received Label Mapping message MUST be copied and carried in the
   returned Label Mapping message.

   S-PEs will relay the Label Mapping message upstream until it reaches
   T-PE1.  When the Label Mapping message is received by T-PE1, T-PE1
   will complete any pending OAM configuration and enables the OAM
   source function to send OAM messages.





Zhang, et al.            Expires January 7, 2016                [Page 9]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   For T-PE1, the OAM entities and functions are now setup and
   configured, and OAM messages may be exchanged.  The OAM alarms can be
   safely enabled.  T-PE1 will send another Label Mapping message with
   "OAM Alarms Enabled" flag set to enable the OAM alarm function.

   When the Label Mapping message is received by S-PEs, S-PEs will
   enable the OAM alarm and relay the Label Mapping message downstream
   until it reaches T-PE2.

   When the Label Mapping message is received by T-PE2, the OAM alarm
   will be enabled.  T-PE2 then sends a Notification message to T-PE1,
   with the Status Code set to "MPLS-TP PW OAM Alarms Enabled".  Once
   the Notification message is received by T-PE1, T-PE1 enables the OAM
   alarm function.  At this point, data-plane OAM is fully functional.

3.2.2.  Adjustment of OAM Parameters

   Existing OAM parameters may be changed during the life time of a PW.
   To achieve this, the T-PE1 needs to send a Label Mapping message with
   the updated OAM parameters to adjust and update OAM parameters.

   To avoid spurious alarms, it is important that OAM sink and source
   functions on both sides are updated in a synchronized way.  Fist, the
   alarms of the OAM sink function should be suppressed.  After that,
   new OAM parameters can be adjusted.  Subsequently, the parameters of
   the OAM source function can be updated.  Finally, the alarms can be
   enabled again.

   Consequently, T-PE1 needs to keep its OAM sink and source functions
   running without any changes until the OAM parameters are updated.
   However, in order to suppress spurious alarms, it also need to
   disable the alarm functions before the Label Mapping message, with
   the "OAM Alarms Enabled" flag cleared and the updated PW OAM Function
   TLV, is sent.  The OAM alarm function needs to be disabled until the
   corresponding response message is received.

   When the Label Mapping message is received by S-PEs, each S-PE just
   disables the OAM alarm and relay the Label Mapping message downstream
   until the Label Mapping message reaches the remote T-PE (T-PE2).

   On receipt of the Label Mapping message, T-PE2 needs to check whether
   the updated parameters can be supported.  If they can be supported,
   T-PE2 needs first disable the OAM alarms and then update the OAM
   parameters.  When the update is done, a Notification message needs to
   be sent to T-PE1, with the Status Code set to "MPLS-TP PW MEP
   Configuration Succeed", to acknowledge the update.  If T-PE2 can not
   support the update, a Notification message with Status Code set to
   "MPLS-TP PW OAM Parameters Rejected" will be sent T-PE1.



Zhang, et al.            Expires January 7, 2016               [Page 10]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   When T-PE1 receives the Notification message with the Status Code set
   to "MPLS-TP PW MEP Configuration Succeed", T-PE1 will update using
   the new OAM parameters.  After the OAM parameters are updated and the
   OAM is running with the new parameter settings, OAM alarms are still
   disabled.  A subsequent Label Mapping message with "OAM Alarms
   Enabled" flag set will be sent to re-enable OAM alarms.  If the
   Status Code of the received Notification message is "MPLS-TP PW OAM
   Parameters Rejected", it will not update the OAM parameters.  The OAM
   alarms are just enabled again and the OAM will keep running with the
   old parameters.  T-PE1 can also re-try changing the OAM parameters
   using a different set of parameters.

   When S-PEs receives the Label Mapping message, they will enable the
   OAM alarms and relay the Label Mapping message downstream.

   When T-PE2 receives the Label Mapping message with the "OAM Alarms
   Enabled" flag set, it will enable the OAM alarms and reply a
   Notification message with Status Code set to "MPLS-TP PW OAM Alarms
   Enabled".  When received the Notification message, T-PE1 will enable
   the OAM alarms again.

3.2.3.  Deleting OAM Entities

   In some cases it may be useful to remove all OAM entities and
   functions from a PW without actually tearing down the connection.
   The deleting procedures are defined as below:

   First, T-PE1disables its own the OAM alarms and then sends a Label
   Mapping message to the remote PE (e.g., T-PE2) with the "OAM Alarms
   Enabled" flag cleared but with all other OAM configurations
   unchanged.

   When received the Label Mapping message, S-PEs will disable the OAM
   alarm and relay the Mapping message downstream until the Label
   Mapping message reaches the remote T-PE (T-PE2).

   When received the Label Mapping message, T-PE2 will disable the OAM
   alarm and then reply a Notification message with Status Code set to
   "MPLS-TP PW OAM Alarms Disabled" to T-PE1.

   When received the confirmation from T-PE2, it's safe to delete the
   OAM entities.  T-PE1 will delete the all OAM entities associated with
   the PW and send another Label Mapping message with both the "OAM MEP
   Entities desired" and "OAM MIP Entities desired" flags cleared to the
   remote T-PE.

   When received the Label Mapping message, S-PE (e.g., S-PE1) will
   delete all the OAM entities associated with the PW and relay the



Zhang, et al.            Expires January 7, 2016               [Page 11]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   Label Mapping message downstream.  Subsequent S-PEs will do the same
   operations until the Label Mapping message reaches the remote T-PE.

   When T-PE2 receives the Label Mapping message, it will delete all OAM
   entities associated with the PW and then reply a Notification message
   with the Status Code set to "MPLS-TP PW MEP Entities Disabled" to
   T-PE1.

4.  LDP Extensions

4.1.  MPLS-TP PW OAM Administration TLV

   The PW OAM Administration TLV is used to configure and enable the
   MEP, MIP and Alarm functions.  It can be sent with the Label Mapping
   message.  The format of the TLV is as follows:

         0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |0|0|           Type          |           Length(=4)            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                OAM Administration Flags                       |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     MPLS-TP PW OAM Administration TLV

   The PW OAM Administration TLV type is TBD1.

   The Length field is 2 octets in length.  It defines the length in
   octets of OAM Administration Flags filed, it's value is 4.

   The OAM Administration Flags is a bitmap with the length of 4 octets.

   This document defines the following flags:

    OAM Administration Flags bit#      Description
    -----------------------------      --------------------------------
    0                                  Reserved
    1                                  OAM MIP Entities Desired
    2                                  OAM MEP Entities Desired
    3                                  OAM Alarms Enabled
    4-31                               Reserved


   The "OAM MIP Entities Desired" flag is used to direct the S-PE(s)
   along a PW to establish (when set) or delete (when cleared ) the OAM
   MIP entities.  This flag only applies to MS-PW scenario.  For SS-PW




Zhang, et al.            Expires January 7, 2016               [Page 12]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   case, this flag MUST be cleared when sent, and SHOULD be ignored when
   received.

   The "OAM MEP Entities Desired" flag is used to request the remote
   T-PE to establish (when set) or delete (when cleared) the OAM
   entities.

   The "OAM Alarms Enabled" flag is used to request the received PEs to
   enable (when set) or disable (when cleared) OAM alarms function.

   Reserved (4-31 bits): MUST be set to zero on transmission and SHOULD
   be ignored on receipt.

4.2.  PW OAM Functions TLV

   The PW OAM Functions TLV is defined to configure and enable specific
   OAM functions, it is carried in Label Mapping message when used.  The
   format of the TLV is as follows:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |0|0|           Type            |           Length              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      OAM Function Flags                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                           sub-TLVs                            ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                           PW OAM Functions TLV

   The PW OAM Functions TLV contains a number of flags indicating which
   OAM functions should be activated and OAM function specific sub-TLVs
   with configuration parameters for particular functions.

   The PW OAM Functions TLV type is TBD2.

   The Length field is 2 octets in length.  It defines the length in
   octets of OAM Function Flags and sub-TLVs fields.

   The OAM Function Flags is a bitmap with the length of 4 octets.

   This document defines the following flags:








Zhang, et al.            Expires January 7, 2016               [Page 13]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


      OAM Function Flags bit#             Description
      ---------------------      ---------------------------

      0                          Continuity Check (CC)
      1                          Connectivity Verification (CV)
      2                          Fault Management Signals (FMS)
      3                          Performance Monitoring (PM) Loss
      4                          Performance Monitoring (PM) Delay
      5                          Performance Monitoring (PM) Throughput
      6-31                       Reserved

   The sub-TLVs corresponding to the different OAM function flags are as
   follows.

   o  BFD Configuration sub-TLV MUST be included if the CC and/or the CV
      OAM Function flag is set.  Furthermore, if the CV flag is set, the
      CC flag MUST be set as well.

   o  Performance Monitoring sub-TLV MUST be included if the PM Loss/
      Delay OAM Function flag is set.

   o  MPLS-TP PW FMS sub-TLV MAY be included if the FMS OAM Function
      flag is set.  If the MPLS-TP PW FMS sub-TLV is not included, the
      default configuration values are used.

   PW OAM Functions TLV is designed to share the sub-TLVs with MPLS OAM
   Functions TLV that is defined in
   [I-D.ietf-mpls-lsp-ping-mpls-tp-oam-conf].  No assignments of sub-
   TLVs are made directly for PW OAM Functions TLV, the sub-TLV space
   and assignments for PW OAM Functions TLV will be the same as that for
   MPLS OAM Functions TLV.  Sub-types for MPLS OAM Functions TLV and PW
   OAM Functions TLV MUST be kept the same.  Any new sub-type added to
   MPLS OAM Functions TLV MUST apply to the PW OAM Functions TLV as
   well.  More detail about the sub-TLVs definitions, please refer to
   Section 2.2 of [I-D.ietf-mpls-lsp-ping-mpls-tp-oam-conf].

   In addition, [I-D.ietf-mpls-lsp-ping-mpls-tp-oam-conf] uses the LSP
   Ping return codes to carry the OAM parameters process related error
   codes.  When the sub-TLVs of MPLS OAM Functions TLV are used for
   MPLS-TP PW OAM configuration, those related error codes apply.  Since
   this document is based on LDP protocol, the LDP Status Codes are used
   to carry those error codes.  More detail about the error codes please
   refer to Section 2.2 of [I-D.ietf-mpls-lsp-ping-mpls-tp-oam-conf] and
   Section 5.2 of this document.







Zhang, et al.            Expires January 7, 2016               [Page 14]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


5.  IANA Considerations

5.1.  TLVs

   IANA is requested to assign two new TLV types from the registry "TLV
   Type Name Space" in the "Label Distribution Protocol (LDP)
   Parameters" registry.

      Value     TLV                            References
      -----     --------                       ----------
       TBD1     PW OAM Administration TLV      this document
       TBD2     PW OAM Functions TLV           this document

   The sub-TLV space and assignments for the PW OAM Functions TLV will
   be the same as that for the MPLS OAM Functions TLV.  Sub-types for
   the MPLS OAM Functions TLV and the PW OAM Functions TLV MUST be kept
   the same.  Any new sub-type added to the MPLS OAM Functions TLV MUST
   apply to the PW OAM Functions TLV as well.

5.2.  OAM Configuration Status Code

   IANA is requested to assign the following LDP status codes from the
   registry "STATUS CODE NAME SPACE" in the "Label Distribution Protocol
   (LDP) Parameters" registry.



























Zhang, et al.            Expires January 7, 2016               [Page 15]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


Range/Value   E    Description                             Reference
----------- -----  -------------------------------------   -------------
      TBD3    0    "MPLS-TP PW OAM Alarms Enabled"         This document
      TBD4    0    "MPLS-TP PW OAM Alarms Disabled"        This document
      TBD5    0    "MPLS-TP PW MEP Configuration Failed"   This document
      TBD6    0    "MPLS-TP PW MEP Configuration Succeed"  This document
      TBD7    0    "MPLS-TP PW MEP Entities Disabled"      This document
      TBD8    0    "MPLS-TP PW MIP Configuration Failed"   This document
      TBD9    0    "MPLS-TP PW OAM Parameters Rejected"    This document
      TBD10   0    "OAM Problem/Unsupported BFD            LSP-OAM-CONF
                    Version"
      TBD11   0    "OAM Problem/Unsupported BFD            LSP-OAM-CONF
                    Encapsulation format"
      TBD12   0    "OAM Problem/Unsupported BFD            LSP-OAM-CONF
                    Authentication Type"
      TBD13   0    "OAM Problem/Mismatch of BFD            LSP-OAM-CONF
                    Authentication Key ID
      TBD14   0    "OAM Problem/Unsupported Timestamp      LSP-OAM-CONF
                    Format"
      TBD15   0    "OAM Problem/Unsupported Delay          LSP-OAM-CONF
                    Mode"
      TBD16   0    "OAM Problem/Unsupported Loss Mode"     LSP-OAM-CONF
      TBD17   0    "OAM Problem/Delay variation            LSP-OAM-CONF
                    unsupported"
      TBD18   0    "OAM Problem/Dyadic mode                LSP-OAM-CONF
                    unsupported"
      TBD19   0    "OAM Problem/Loopback mode              LSP-OAM-CONF
                    unsupported"
      TBD20   0    "OAM Problem/Combined mode              LSP-OAM-CONF
                    unsupported"
      TBD21   0    "OAM Problem/Fault management           LSP-OAM-CONF
                    signaling unsupported"
      TBD22   0    "OAM Problem/Unable to create           LSP-OAM-CONF
                    fault management association"


6.  Security Considerations

   Security considerations relating to LDP are described in section 5 of
   [RFC5036] and section 11 of [RFC5561].  Security considerations
   relating to use of LDP in setting up PWs is described in section 8 of
   [RFC4447].

   This document defines new TLV/sub-TLV types, and OAM configuration
   procedures intended for use with MPLS-TP, which do not raise any
   additional security issues.





Zhang, et al.            Expires January 7, 2016               [Page 16]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


7.  Acknowledgement

   The authors would like to thank Andrew Malis, Greg Mirsky, Luca
   Martini, Matthew Bocci, Thomas Nadeau for their valuable comments and
   discussions, especially would like to thank Eric Gray for his review
   of this document.

8.  References

8.1.  Normative references

   [I-D.ietf-mpls-lsp-ping-mpls-tp-oam-conf]
              Bellagamba, E., Mirsky, G., Andersson, L., Skoldstrom, P.,
              Ward, D., and J. Drake, "Configuration of Proactive
              Operations, Administration, and Maintenance (OAM)
              Functions for MPLS-based Transport Networks using LSP
              Ping", draft-ietf-mpls-lsp-ping-mpls-tp-oam-conf-09 (work
              in progress), January 2015.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC4447]  Martini, L., Rosen, E., El-Aawar, N., Smith, T., and G.
              Heron, "Pseudowire Setup and Maintenance Using the Label
              Distribution Protocol (LDP)", RFC 4447, April 2006.

   [RFC5036]  Andersson, L., Minei, I., and B. Thomas, "LDP
              Specification", RFC 5036, October 2007.

   [RFC5561]  Thomas, B., Raza, K., Aggarwal, S., Aggarwal, R., and JL.
              Le Roux, "LDP Capabilities", RFC 5561, July 2009.

8.2.  Informative References

   [RFC3985]  Bryant, S. and P. Pate, "Pseudo Wire Emulation Edge-to-
              Edge (PWE3) Architecture", RFC 3985, March 2005.

   [RFC5226]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", BCP 26, RFC 5226,
              May 2008.

   [RFC5291]  Chen, E. and Y. Rekhter, "Outbound Route Filtering
              Capability for BGP-4", RFC 5291, August 2008.

   [RFC5654]  Niven-Jenkins, B., Brungard, D., Betts, M., Sprecher, N.,
              and S. Ueno, "Requirements of an MPLS Transport Profile",
              RFC 5654, September 2009.




Zhang, et al.            Expires January 7, 2016               [Page 17]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   [RFC5659]  Bocci, M. and S. Bryant, "An Architecture for Multi-
              Segment Pseudowire Emulation Edge-to-Edge", RFC 5659,
              October 2009.

   [RFC5860]  Vigoureux, M., Ward, D., and M. Betts, "Requirements for
              Operations, Administration, and Maintenance (OAM) in MPLS
              Transport Networks", RFC 5860, May 2010.

   [RFC5880]  Katz, D. and D. Ward, "Bidirectional Forwarding Detection
              (BFD)", RFC 5880, June 2010.

   [RFC6371]  Busi, I. and D. Allan, "Operations, Administration, and
              Maintenance Framework for MPLS-Based Transport Networks",
              RFC 6371, September 2011.

   [RFC6374]  Frost, D. and S. Bryant, "Packet Loss and Delay
              Measurement for MPLS Networks", RFC 6374, September 2011.

   [RFC6427]  Swallow, G., Fulignoli, A., Vigoureux, M., Boutros, S.,
              and D. Ward, "MPLS Fault Management Operations,
              Administration, and Maintenance (OAM)", RFC 6427, November
              2011.

   [RFC7260]  Takacs, A., Fedyk, D., and J. He, "GMPLS RSVP-TE
              Extensions for Operations, Administration, and Maintenance
              (OAM) Configuration", RFC 7260, June 2014.

Authors' Addresses

   Fei Zhang (editor)
   Huawei

   Email: zhangfei7@huawei.com


   Bo Wu (editor)
   ZTE Corporation

   Email: wu.bo@zte.com.cn












Zhang, et al.            Expires January 7, 2016               [Page 18]

Internet-Draft        LDP Extensions for TP PW OAM             July 2015


   Elisa Bellagamba (editor)
   Ericsson
   Farogatan 6
   Kista, 164 40
   Sweden

   Phone: +46 761440785
   Email: elisa.bellagamba@ericsson.com


   Mach(Guoyi) Chen (editor)
   Huawei

   Email: mach.chen@huawei.com





































Zhang, et al.            Expires January 7, 2016               [Page 19]
