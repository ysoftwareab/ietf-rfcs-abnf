<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Public Safety Answering Point (PSAP) Callback</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Callback Scenarios">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Routing Asymmetry">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Multi-Stage Routing">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Call Forwarding">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Network-based Service URN Resolution">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 PSTN Interworking">
<link href="#rfc.section.4" rel="Chapter" title="4 Specification">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Alternative Solutions Considered">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Identity-based Authorization">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Trait-based Authorization">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 Call Marking">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="After an emergency call is completed (either prematurely terminated by the emergency caller or normally by the call-taker) it is possible that the call-taker feels the need for further communication.  For example, the call may have been dropped by accident without the call-taker having sufficient information about the current situation of a wounded person. A call-taker may trigger a callback towards the emergency caller using the contact information provided with the initial emergency call. This callback could, under certain circumstances, be treated like any other call and as a consequence it may get blocked by authorization policies or may get forwarded to an answering machine." />
  <meta name="description" content="After an emergency call is completed (either prematurely terminated by the emergency caller or normally by the call-taker) it is possible that the call-taker feels the need for further communication.  For example, the call may have been dropped by accident without the call-taker having sufficient information about the current situation of a wounded person. A call-taker may trigger a callback towards the emergency caller using the contact information provided with the initial emergency call. This callback could, under certain circumstances, be treated like any other call and as a consequence it may get blocked by authorization policies or may get forwarded to an answering machine." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">ECRIT</td>
<td class="right">H. Schulzrinne</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Columbia University</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">H. Tschofenig</td>
</tr>
<tr>
<td class="left">Expires: April 29, 2012</td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">C.H. Holmberg</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">M. Patel</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">InterDigital Communications</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 27, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Public Safety Answering Point (PSAP) Callback<br />
  <span class="filename">draft-ietf-ecrit-psap-callback-03.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>After an emergency call is completed (either prematurely terminated by the emergency caller or normally by the call-taker) it is possible that the call-taker feels the need for further communication.  For example, the call may have been dropped by accident without the call-taker having sufficient information about the current situation of a wounded person. A call-taker may trigger a callback towards the emergency caller using the contact information provided with the initial emergency call. This callback could, under certain circumstances, be treated like any other call and as a consequence it may get blocked by authorization policies or may get forwarded to an answering machine.</p>
<p>The IETF emergency services architecture offers capabilities to allow callbask to bypass authorization policies to reach the caller without unnecessary delays. However, the mechanism specified prior to this document supports only limited scenarios. This document discusses some shortcomings, presents additional scenarios where better-than-normal call treatment behavior would be desirable, and specifies a protocol solution.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 29, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Callback Scenarios</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Routing Asymmetry</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Multi-Stage Routing</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Call Forwarding</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Network-based Service URN Resolution</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">PSTN Interworking</a>
</li>
<li>4.   <a href="#rfc.section.4">Specification</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Alternative Solutions Considered</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Identity-based Authorization</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Trait-based Authorization</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">Call Marking</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Summoning police, the fire department or an ambulance in emergencies is one of the fundamental and most-valued functions of the telephone. As telephone functionality moves from circuit-switched telephony to Internet telephony, its users rightfully expect that this core functionality will continue to work at least as well as it has for the legacy technology. New devices and services are being made available that could be used to make a request for help, which are not traditional telephones, and users are increasingly expecting them to be used to place emergency calls.</p>
<p id="rfc.section.1.p.2">An overview of the protocol interactions for emergency calling using the IETF emergency services architecture are described in <a href="#I-D.ietf-ecrit-framework">[I-D.ietf-ecrit-framework]</a> and <a href="#I-D.ietf-ecrit-phonebcp">[I-D.ietf-ecrit-phonebcp]</a> specifies the technical details. As part of the emergency call setup procedure two important identifiers are conveyed to the PSAP call-taker's user agent, namely the Address-Of-Record (AoR), and the Globally Routable User Agent (UA) URIs (GRUU). RFC 3261 <a href="#RFC3261">[RFC3261]</a> defines the AoR as: <a href="#RFC5627">[RFC5627]</a> specifies how to obtain and use GRUUs.  </p>

<ul class="empty"><li>An address-of-record (AOR) is a SIP or SIPS URI that points to a domain with a location service that can map the URI to another URI where the user might be available.  Typically, the location service is populated through registrations.  An AOR is frequently thought of as the "public address" of the user.  </li></ul>

<p> In SIP systems a single user can have a number of user agents (handsets, softphones, voicemail accounts, etc.) which are all referenced by the same AOR.  There are a number of cases in which it is desirable to have an identifier which addresses a single user agent rather than the group of user agents indicated by an AOR. The GRUU is such a unique user- agent identifier, which is still globally routable. </p>
<p id="rfc.section.1.p.3">Regulatory requirements demand that the emergency call itself provides enough information to allow the call-taker to initiate a call back to the emergency caller in case the call dropped or to interact with the emergency caller in case of further questions.  The AoR and the GRUU serve this purpose.  The communication attempt by the PSAP call-taker back to the emergency caller is called 'PSAP callback'.  </p>
<p id="rfc.section.1.p.4">A PSAP callback may, however, be blocked by user configured whitelis or may be forwarded to an answering machine as SIP entities (SIP proxies as well as the SIP UA itself) cannot differentiate the callback from any other SIP call establishing attempt from the SIP signaling message.</p>
<p id="rfc.section.1.p.5">While there are no regulatory requirements at the time of writing of this specification there is the believe that PSAP callbacks have to be treated in such a way that they reach the emergency caller.  For this purpose guidance for PSAP callback handling has been provided in Section 13 of <a href="#I-D.ietf-ecrit-framework">[I-D.ietf-ecrit-framework]</a>:</p>
<p></p>

<ul class="empty"><li>A UA may be able to determine a PSAP call back by examining the domain of incoming calls after placing an emergency call and comparing that to the domain of the answering PSAP from the emergency call. Any call from the same domain and directed to the supplied Contact header or AoR after an emergency call should be accepted as a callback from the PSAP if it occurs within a reasonable time after an emergency call was placed.</li></ul>
<p id="rfc.section.1.p.7">This approach mimics a stateful packet filtering firewall and is indeed helpful in a number of cases. It is also relatively simple to implement. Unfortunately, it does not work in all SIP deployment scenarios.  In <a href="#scenarios">Section 3</a> we describe scenarios where the currently standardized approach is insufficient. In <a href="#solution">Section 4</a> a solution is described.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">Emergency services related terminology is borrowed from <a href="#RFC5012">[RFC5012]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#scenarios" id="scenarios">Callback Scenarios</a>
</h1>
<p id="rfc.section.3.p.1">This section illustrates a number of scenarios where the currently specified solution, as specified in <a href="#I-D.ietf-ecrit-phonebcp">[I-D.ietf-ecrit-phonebcp]</a>, for preferential treatment of callbacks fails. As explained in <a href="#intro">Section 1</a> a SIP entity examines an incoming PSAP call back by comparing the domain of the PSAP with the destination domain of the emergency call.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Routing Asymmetry</h1>
<p id="rfc.section.3.1.p.1">In some deployment environments it is common to have incoming and outgoing SIP messaging routed through different SIP entities. <a href="#asymmetry">Figure 1</a> shows this graphically whereby a VoIP provider uses different SIP proxies for inbound and for outbound call handling. Unless they two devices are state synchronized the callback hitting the inbound proxy would get treated like any other call since the emergency call established state information at the outbound proxy only. </p>
<div id="#rfc.figure.1"></div>
<div id="#asymmetry"></div>
<pre>

              
                                                ,-------.
                                              ,'         `.
                   ,-------.                 /  Emergency  \
                 ,'         `.              |   Services    |
                /  VoIP       \      I      |   Network     |
               |   Provider    |     n      |               |
               |               |     t      |               |
               |               |     e      |               |
               |   +-------+   |     r      |               |
            +--+---|Inbound|&lt;--+-----m      |               |
            |  |   |Proxy  |   |     e      |   +------+    |
            |  |   +-------+   |     d      |   |PSAP  |    |
            |  |               |     i      |   +--+---+    |
  +----+    |  |               |     a-+    |      |        |
  | UA |&lt;---+  |               |     t |    |      |        |
  |    |----+  |               |     e |    |      |        |
  +----+    |  |               |       |    |      |        |
            |  |               |     P  |   |      |        |
            |  |               |     r  |   |      |        |
            |  |   +--------+  |     o   |  |      |        |
            +--+--&gt;|Outbound|--+----&gt;v   |  |   +--+---+    |
               |   |Proxy   |  |     i    | | +-+ESRP  |    |
               |   +--------+  |     d    | | | +------+    |
               |               |     e     || |             |
               |               |     r     |+-+             |
                \             /             |               |
                 `.         ,'               \             /
                   '-------'                  `.         ,'
                                                '-------'
           </pre>
<p></p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#multistage" id="multistage">Multi-Stage Routing</a>
</h1>
<p id="rfc.section.3.2.p.1">Consider the following emergency call routing scenario shown in <a href="#stages">Figure 2</a> where routing towards the PSAP occurs in several stages. In this scenario we consider a SIP UA that uses LoST to learn the next hop destination closer to the PSAP. This call is then sent to the user's VoIP provider.  The user's VoIP provider receives the emergency call and creates state based on the destination domain, namely state.com.  It then routes it to the indicated ESRP.  When the ESRP receives it it needs to decide what the next hop is to get it closer to the PSAP.  In our example the next hop is the PSAP with the URI psap@town.com.</p>
<p id="rfc.section.3.2.p.2">When a callback is sent from psap@town.com towards the emergency caller the call will get normal treatment by the VoIP providers inbound proxy since the domain of the PSAP does not match the stored state information.</p>
<div id="#rfc.figure.2"></div>
<div id="#stages"></div>
<pre>

                                      ,-------.
    +----+                          ,'         `.
    | UA |--- esrp1@foobar.com     /  Emergency  \
    +----+   \                    |   Services    |
              \  ,-------.        |   Network     |
               ,'         `.      |               |
              /   VoIP      \     |   +------+    |
             (    Provider   )    |   |PSAP  |    |
              \             /     |   +--+---+    |
               `.         ,'      |      |
                 '---+---'        |      |        |
                     |            |psap@town.com  |
             esrp@state.com       |      |        |
                     |            |      |        |
                     |            |      |        |
                     |            |   +--+---+    |
                     +------------+---+ESRP  |    |
                                  |   +------+    |
                                  |               |
                                   \             /
                                    `.         ,'
                                      '-------'
                              </pre>
<p></p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Call Forwarding</h1>
<p id="rfc.section.3.3.p.1">Imagine the following case where an emergency call enters an emergency network (state.org) via an ERSP but then gets forwarded to a different emergency services network (in our example to police-town.org, fire-town.org or medic-town.org). The same considerations apply when the the police, fire and ambulance networks are part of the state.org sub-domains (e.g., police.state.org).</p>
<p id="rfc.section.3.3.p.2">Similarly to the previous scenario the problem here is with the wrong state information being established during the emergency call setup procedure. A callback would originate in the police-town.org, fire-town.org or medic-town.org domain whereas the emergency caller's SIP UA or the VoIP outbound proxy has stored state.org.</p>
<div id="#rfc.figure.3"></div>
<div id="#fwd"></div>
<pre>
                                ,-------.
                              ,'         `.
                             /  Emergency  \
                            |   Services    |
                            |   Network     |
                            |   (state.org) |
                            |               |
                            |               |
                            |   +------+    |
                            |   |PSAP  +--+ |
                            |   +--+---+  | |
                            |      |      | |
                            |      |      | |
                            |      |      | |
                            |      |      | |
                            |      |      | |
                            |   +--+---+  | |
          ------------------+---+ESRP  |  | |
          esrp-a@state.org  |   +------+  | |
                            |             | |
                            |    Call Fwd | |
                            |     +-+-+---+ |
                             \    | | |    /
                              `.  | | |  ,'
                                '-|-|-|-'           ,-------.
                         Police   | | | Fire      ,'         `.
                     +------------+ | +----+     /  Emergency  \
      ,-------.      |              |      |    |   Services    |
    ,'         `.    |              |      |    |   Network     |
   /  Emergency  \   |          Ambulance  |    | fire-town.org |
  |   Services    |  |              |      |    |               |
  |   Network     |  |              +----+ |    |   +------+    |
  |police-town.org|  |     ,-------.     | +----+---+PSAP  |    |
  |               |  |   ,'         `.   |      |   +------+    |
  |   +------+    |  |  /  Emergency  \  |      |               |
  |   |PSAP  +----+--+ |   Services    | |      |               ,
  |   +------+    |    |   Network     | |      `~~~~~~~~~~~~~~~
  |               |    |medic-town.org | |
  |               ,    |               | |
  `~~~~~~~~~~~~~~~     |   +------+    | |
                       |   |PSAP  +----+ +
                       |   +------+    |
                       |               |
                       |               ,
                       `~~~~~~~~~~~~~~~
                              </pre>
<p></p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Network-based Service URN Resolution</h1>
<p id="rfc.section.3.4.p.1">The IETF emergency services architecture also considers cases where the resolution from the Service URN to the PSAP URI does not only happen at the SIP UA itself but at intermedidate SIP entities, such as the user's VoIP provider.</p>
<p><a href="#late-binding">Figure 4</a> shows this message exchange of the outgoing emergency call and the incoming PSAP graphically.  While the state information stored at the VoIP provider is correct the state allocated at the SIP UA is not. </p>
<div id="#rfc.figure.4"></div>
<div id="#late-binding"></div>
<pre>
     ,-------.
   ,'         `.
  /  Emergency  \
 |   Services    |
 |   Network     |
 |police-town.org|
 |               |
 |   +------+    |    Invite to police.example.com
 |   |PSAP  +&lt;---+------------------------+
 |   |      +----+------------------+     ^
 |   +------+    |Invite from       |     |
 |               ,police.example.com|     |
 `~~~~~~~~~~~~~~~                   v     |
 +--------+                        ++-----+-+
 |        |            query       |VoIP    |
 | LoST   |&lt;-----------------------|Service |
 | Server |   police.example.com   |Provider|
 |        |-----------------------&gt;|        |
 +--------+                        +--------+
                                    |     ^
                              Invite|     | Invite
                                from|     | to
                  police.example.com|     | urn:service:sos
                                    V     |
                                   +-------+
                                   | SIP   |
                                   | UA    |
                                   | Alice |
                                   +-------+
                              </pre>
<p></p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> PSTN Interworking</h1>
<p id="rfc.section.3.5.p.1">In case an emergency call enters the PSTN, as shown in <a href="#pstn">Figure 5</a>, there is no guarantee that the callback some time later does leave the same PSTN/VoIP gateway or that the same end point identifier is used in the forward as well as in the backward direction making it difficult to reliably detect PSAP callbacks.</p>
<div id="#rfc.figure.5"></div>
<div id="#pstn"></div>
<pre>
  +-----------+
  | PSTN      |-------------+
  | Calltaker |             |
  | Bob       |&lt;--------+   |
  +-----------+         |   v
             -------------------
         ////                   \\\\      +------------+
        |                           |     |PSTN / VoIP |
        |             PSTN          |----&gt;|Gateway     |
         \\\\                   ////      |            |
             -------------------          +----+-------+
                        ^                      |
                        |                      |
                  +-------------+              |  +--------+
                  |             |              |  |VoIP    |
                  | PSTN / VoIP |              +-&gt;|Service |
                  | Gateway     |                 |Provider|
                  |             |&lt;------Invite----|   Y    |
                  +-------------+                 +--------+
                                                   |     ^
                                                   |     |
                                                 Invite Invite
                                                   |     |
                                                   V     |
                                                  +-------+
                                                  | SIP   |
                                                  | UA    |
                                                  | Alice |
                                                  +-------+
                              </pre>
<p></p>
<p id="rfc.section.3.5.p.3">Note: This scenario is considered outside the scope of this document. The specified solution does not support this use case.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#solution" id="solution">Specification</a>
</h1>
<p id="rfc.section.4.p.1">[Editor's Note: The solution approach described in <a href="#I-D.holmberg-emergency-callback-id">[I-D.holmberg-emergency-callback-id]</a> will be discussed at the IETF#82 ECRIT meeting and at the ECRIT mailing list and will be incorporated here if agreed by the working group.]</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Security Considerations</h1>
<p id="rfc.section.5.p.1">[Editor's Note: Instead of an abstract security description text will be provided with the solution description.]</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">[Editor's Note: IANA consideration text will be added once an agreement on the solution has been reached.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Acknowledgements</h1>
<p id="rfc.section.7.p.1">We would like to thank members from the ECRIT working group, in particular Brian Rosen, for their discussions around PSAP callbacks. The working group discussed the topic of callbacks at their virtual interim meeting in February 2010 and the following persons provided valuable input: John Elwell, Bernard Aboba, Cullen Jennings, Keith Drage, Marc Linsner, Roger Marshall, Dan Romascanu, Geoff Thompson, Janet Gunn.</p>
<p id="rfc.section.7.p.2">At IETF#81 a small group of people got to together to continue the discussions started at the working group meeting to explore a GRUU-based solution approach. Martin Thomson, Marc Linsner, Andrew Allen, Brian Rosen, Martin Dolly, and Atle Monrad participated at this side-meeting.</p>
<p id="rfc.section.7.p.3">Finally, we would like to thank Cullen Jennings for his discussion input. He was the first to propose a "token-based" solution.</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3261">[RFC3261]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a>, <a>Camarillo, G.</a>, <a>Johnston, A.</a>, <a>Peterson, J.</a>, <a>Sparks, R.</a>, <a>Handley, M.</a> and <a>E. Schooler</a>, "<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>", RFC 3261, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3325">[RFC3325]</b></td>
<td class="top">
<a>Jennings, C.</a>, <a>Peterson, J.</a> and <a>M. Watson</a>, "<a href="http://tools.ietf.org/html/rfc3325">Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks</a>", RFC 3325, November 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3966">[RFC3966]</b></td>
<td class="top">
<a>Schulzrinne, H.</a>, "<a href="http://tools.ietf.org/html/rfc3966">The tel URI for Telephone Numbers</a>", RFC 3966, December 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3969">[RFC3969]</b></td>
<td class="top">
<a>Camarillo, G.</a>, "<a href="http://tools.ietf.org/html/rfc3969">The Internet Assigned Number Authority (IANA) Uniform Resource Identifier (URI) Parameter Registry for the Session Initiation Protocol (SIP)</a>", BCP 99, RFC 3969, December 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5627">[RFC5627]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, "<a href="http://tools.ietf.org/html/rfc5627">Obtaining and Using Globally Routable User Agent URIs (GRUUs) in the Session Initiation Protocol (SIP)</a>", RFC 5627, October 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5341">[RFC5341]</b></td>
<td class="top">
<a>Jennings, C</a> and <a>V. K.  Gurbani</a>, "<a>The Internet Assigned Number Authority (IANA) tel Uniform Resource Identifier (URI) Parameter Registry</a>", September 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4474">[RFC4474]</b></td>
<td class="top">
<a>Peterson, J.</a> and <a>C. Jennings</a>, "<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>", RFC 4474, August 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-ecrit-framework">[I-D.ietf-ecrit-framework]</b></td>
<td class="top">
<a>Rosen, B</a>, <a>Schulzrinne, H</a>, <a>Polk, J</a> and <a>A Newton</a>, "<a href="http://tools.ietf.org/html/draft-ietf-ecrit-framework-13">Framework for Emergency Calling using Internet Multimedia</a>", Internet-Draft draft-ietf-ecrit-framework-13, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-ecrit-phonebcp">[I-D.ietf-ecrit-phonebcp]</b></td>
<td class="top">
<a>Rosen, B</a> and <a>J Polk</a>, "<a href="http://tools.ietf.org/html/draft-ietf-ecrit-phonebcp-20">Best Current Practice for Communications Services in support of Emergency Calling</a>", Internet-Draft draft-ietf-ecrit-phonebcp-20, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-sip-saml">[I-D.ietf-sip-saml]</b></td>
<td class="top">
<a>Tschofenig, H</a>, <a>Hodges, J</a>, <a>Peterson, J</a>, <a>Polk, J</a> and <a>D Sicker</a>, "<a href="http://tools.ietf.org/html/draft-ietf-sip-saml-08">SIP SAML Profile and Binding</a>", Internet-Draft draft-ietf-sip-saml-08, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.holmberg-emergency-callback-id">[I-D.holmberg-emergency-callback-id]</b></td>
<td class="top">
<a>Holmberg, C</a>, "<a href="http://tools.ietf.org/html/draft-holmberg-emergency-callback-id-00">Session Initiation Protocol (SIP) emergency call back identification</a>", Internet-Draft draft-holmberg-emergency-callback-id-00, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4484">[RFC4484]</b></td>
<td class="top">
<a>Peterson, J.</a>, <a>Polk, J.</a>, <a>Sicker, D.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc4484">Trait-Based Authorization Requirements for the Session Initiation Protocol (SIP)</a>", RFC 4484, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5012">[RFC5012]</b></td>
<td class="top">
<a>Schulzrinne, H.</a> and <a>R. Marshall</a>, "<a href="http://tools.ietf.org/html/rfc5012">Requirements for Emergency Context Resolution with Internet Technologies</a>", RFC 5012, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5031">[RFC5031]</b></td>
<td class="top">
<a>Schulzrinne, H.</a>, "<a href="http://tools.ietf.org/html/rfc5031">A Uniform Resource Name (URN) for Emergency and Other Well-Known Services</a>", RFC 5031, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, January 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Alternative Solutions Considered</h1>
<p id="rfc.section.Appendix A.p.1">In an attempt to describe the problem and to explore solution approaches the working group had also investigated alternative approaches. We document them here for completeness. The solutions fall into three categories: (1) Identity-based authorization, (2) Trait-based authorization, and (3) Call Marking. Even though these solutions are not mutually exclusive we describe them in separate sub-sections.</p>
<p id="rfc.section.Appendix A.p.2">Beyond the disadvantages listed in each solution category none of them provides the emergency caller with the ability to restrict preferential PSAP callback handling to those cases where an earlier emergency call was initiated. </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Identity-based Authorization</h1>
<p id="rfc.section.Appendix A.1.p.1">In <a href="#identity-authz">Figure 6</a> an interaction is presented that allows a SIP entity to make a policy decision whether to bypass installed authorization policies and thereby providing preferential treatment. To make this decision the sender's identity is compared with a whitelist of valid PSAPs. The identity assurances in SIP can come in different forms, such as SIP Identity <a href="#RFC4474">[RFC4474]</a> or with P-Asserted-Identity <a href="#RFC3325">[RFC3325]</a>. The former technique relies on a cryptographic assurance and the latter on a chain of trust.</p>
<div id="#rfc.figure.6"></div>
<div id="#identity-authz"></div>
<pre>
                 +----------+
                 | List of  |+
                 | valid    ||
                 | PSAP ids ||
                 +----------+|
                  +----------+
                      *
                      * whitelist
                      *
                      V
   Incoming      +----------+    Normal
   SIP Msg       | SIP      |+   Treatment
  --------------&gt;| Entity   ||=============&gt;
   + Identity    |          ||(if not in whitelist)
                 +----------+|
                 +----------+
                      ||
                      ||
                      || Preferential
                      || Treatment
                      ++=============&gt;
                        (in whitelist)
				</pre>
<p></p>
<p id="rfc.section.Appendix A.1.p.3">This approach was not chosen because the establishment of a whitelist containing PSAP identities is operationally complex and does not easily scale world wide. Only when there is a local relationship between the VSP/ASP and the PSAP then populating the whitelist is far simpler. This would, however, constrain the applicability of the mechanism considerably.</p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Trait-based Authorization</h1>
<p id="rfc.section.Appendix A.2.p.1">An alternative approach to an identity based authorization model is outlined in <a href="#trait">Figure 7</a>. In fact, RFC 4484 <a href="#RFC4484">[RFC4484]</a> illustrates a related emergency service use case.</p>
<div id="#rfc.figure.7"></div>
<div id="#trait"></div>
<pre>
               +----------+
               | List of  |+
               | trust    ||
               | anchor   ||
               +----------+|
                +----------+
                    *
                    *
                    *
                    V
 Incoming      +----------+    Normal
 SIP Msg       | SIP      |+   Treatment
--------------&gt;| Entity   ||=============&gt;
 + trait       |          ||(no indication
               +----------+| of PSAP)
               +----------+
                    ||
                    ||
                    || Preferential
                    || Treatment
                    ++=============&gt;
                      (indicated as
                       PSAP)						
			</pre>
<p></p>
<p id="rfc.section.Appendix A.2.p.3">In a trait-based authorization scenario an incoming SIP message contains a form of trait, i.e. some form of assertion. The assertion contains an indication that the sending party has the role of a PSAP (or similar emergency services entity). The assertion is either cryptographically protected to enable end-to-end verification or an chain of trust security model has to be assumed. In <a href="#trait">Figure 7</a> we assume an end-to-end security model where trust anchors are provisioned to ensure the ability for a SIP entity to verify the received assertion.</p>
<p id="rfc.section.Appendix A.2.p.4">This solution was not chosen because trait-based authorization never got deployed in SIP. Furthermore, in order to ensure that the assertions are properly protected it is necessary to digitally sign, which requires some form of public key infrastructure for usage with emergency services.  Finally, there need to be some policies in place that define which entities are allowed to obtain various roles. These policies and procedures do not exist today.</p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> Call Marking</h1>
<p id="rfc.section.Appendix A.3.p.1">Call marking allows the PSAP to place a non-cryptographic label on outgoing calls that gives, when received by a SIP entity, preferential treatment for these callbacks. </p>
<p id="rfc.section.Appendix A.3.p.2">When used in isolation this mechanism introduces considerable denial of service attacks due to the ability to bypass any authorization policies and could be utilized to distribute unwanted traffic.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Henning Schulzrinne</span> 
	  <span class="n hidden">
		<span class="family-name">Schulzrinne</span>
	  </span>
	</span>
	<span class="org vcardline">Columbia University</span>
	<span class="adr">
	  <span>Department of Computer Science</span>
<span>450 Computer Science Building</span>

	  <span class="vcardline">
		<span class="locality">New York</span>,  
		<span class="region">NY</span> 
		<span class="code">10027</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: +1 212 939 7004</span>

<span class="vcardline">EMail: <a href="mailto:hgs+ecrit@cs.columbia.edu">hgs+ecrit@cs.columbia.edu</a></span>

<span class="vcardline">URI: <a href="http://www.cs.columbia.edu">http://www.cs.columbia.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hannes Tschofenig</span> 
	  <span class="n hidden">
		<span class="family-name">Tschofenig</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>Linnoitustie 6</span>

	  <span class="vcardline">
		<span class="locality">Espoo</span>,  
		<span class="region"></span>
		<span class="code">02600</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">Phone: +358 (50) 4871445</span>

<span class="vcardline">EMail: <a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></span>

<span class="vcardline">URI: <a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Christer Holmberg</span> 
	  <span class="n hidden">
		<span class="family-name">Holmberg</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span>Hirsalantie 11</span>

	  <span class="vcardline">
		<span class="locality">Jorvas</span>,  
		<span class="region"></span>
		<span class="code">02420</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:christer.holmberg@ericsson.com">christer.holmberg@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Milan Patel</span> 
	  <span class="n hidden">
		<span class="family-name">Patel</span>
	  </span>
	</span>
	<span class="org vcardline">InterDigital Communications</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Milan.Patel@interdigital.com">Milan.Patel@interdigital.com</a></span>

  </address>
</div>

</body>
</html>