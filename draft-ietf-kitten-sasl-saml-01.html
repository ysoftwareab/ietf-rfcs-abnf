<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A SASL and GSS-API Mechanism for SAML</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A SASL and GSS-API Mechanism for SAML">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">K. Wierenga</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">E. Lear</td></tr>
<tr><td class="header">Expires: April 25, 2011</td><td class="header">Cisco Systems GmbH</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Josefsson</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">SJD AB</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 22, 2010</td></tr>
</table></td></tr></table>
<h1><br />A SASL and GSS-API Mechanism for SAML<br />draft-ietf-kitten-sasl-saml-01.txt</h1>

<h3>Abstract</h3>

<p>
   Security Assertion Markup Language (SAML) has found its
   usage on the Internet for Web Single Sign-On. Simple Authentication
and
   Security Layer (SASL) and the Generic Security Service Application Program Interface (GSS-API)
   are application frameworks to generalize authentication. This memo specifies a SASL mechanism 
   and a GSS-API mechanism for SAML 2.0 that
   allows the integration of existing SAML Identity Providers with
   applications using SASL and GSS-API.
  
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 25, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#anchor2">3.</a>&nbsp;
Applicability for non-HTTP Use Cases<br />
<a href="#anchor3">4.</a>&nbsp;
SAML SASL Mechanism Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#advertisement">4.1.</a>&nbsp;
Advertisement<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#initiation">4.2.</a>&nbsp;
Initiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#1stresponse">4.3.</a>&nbsp;
Server Redirect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#empty">4.4.</a>&nbsp;
Client Empty Response and other<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#outcome">4.5.</a>&nbsp;
Outcome and parameters<br />
<a href="#gss-api">5.</a>&nbsp;
SAML GSS-API Mechanism Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gss-api-name-types">5.1.</a>&nbsp;
GSS-API Principal Name Types for SAML<br />
<a href="#channel-binding">6.</a>&nbsp;
Channel Binding<br />
<a href="#examples">7.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#examples-xmpp">7.1.</a>&nbsp;
XMPP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#examples-imap">7.2.</a>&nbsp;
IMAP<br />
<a href="#anchor4">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">8.1.</a>&nbsp;
Man in the middle and Tunneling Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">8.2.</a>&nbsp;
Binding SAML subject identifiers to Authorization Identities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">8.3.</a>&nbsp;
User Privacy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">8.4.</a>&nbsp;
Collusion between RPs<br />
<a href="#anchor9">9.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#anchor12">Appendix&nbsp;A.</a>&nbsp;
Acknowledgments<br />
<a href="#anchor13">Appendix&nbsp;B.</a>&nbsp;
Changes<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> 
Security Assertion Markup Language (SAML) 2.0 <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a> is a modular specification that provides
   various means for a user to be identified to a relying party (RP)
   through the exchange of (typically signed) assertions issued by an
   identity provider (IdP).  It includes a number of protocols, protocol
   bindings <a class='info' href='#OASIS.saml-bindings-2.0-os'>[OASIS.saml&#8209;bindings&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Hirsch, F., Kemp, J., Philpott, R., and E. Maler, &ldquo;Bindings for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>, and interoperability profiles
   <a class='info' href='#OASIS.saml-profiles-2.0-os'>[OASIS.saml&#8209;profiles&#8209;2.0&#8209;os]<span> (</span><span class='info'>Hughes, J., Cantor, S., Hodges, J., Hirsch, F., Mishra, P., Philpott, R., and E. Maler, &ldquo;Profiles for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a> designed for different use cases.

</p>
<p> 
Simple Authentication and Security Layer (SASL) <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a> is a generalized 
mechanism for identifying and authenticating a user and for optionally negotiating a security layer 
for subsequent protocol interactions. SASL is used by application protocols like <a class='info' href='#RFC3501'>IMAP<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> [RFC3501] and
<a class='info' href='#RFC3920'>XMPP<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a> [RFC3920]. The effect is to make modular authentication, so that newer
authentication mechanisms can be added as needed. This memo specifies
just such a mechanism. 

</p>
<p>
The <a class='info' href='#RFC2743'>Generic Security Service Application
Program Interface (GSS-API)<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> [RFC2743] provides a framework for
applications to support multiple authentication mechanisms through a
unified programming interface.  This document defines a pure SASL
mechanism for SAML, but it conforms to the new bridge between SASL and
the GSS-API called <a class='info' href='#RFC5801'>GS2<span> (</span><span class='info'>Josefsson, S. and N. Williams, &ldquo;Using Generic Security Service Application Program Interface (GSS-API) Mechanisms in Simple Authentication and Security Layer (SASL): The GS2 Mechanism Family,&rdquo; July&nbsp;2010.</span><span>)</span></a> [RFC5801].  This means that
this document defines both a SASL mechanism and a GSS-API mechanism.
We want to point out that the GSS-API interface is optional for SASL
implementers, and the GSS-API considerations can be avoided in
environments that uses SASL directly without GSS-API.

</p>
<p> As currently envisioned, this mechanism
is to allow the interworking between SASL and SAML in order to assert
identity and other attributes to relying parties. As such, while servers
(as relying parties) will advertise SASL mechanisms (including SAML),
clients will select
the SAML SASL mechanism as their SASL mechanism of choice. 
</p>
<p>The SAML mechanism described in this memo aims to re-use the
available SAML deployment to a maximum extent and therefore does not
establish a separate authentication, integrity and confidentiality
mechanism.  The mechanisms assumes a security layer, such as Transport
Layer Security (TLS), to protect against some attacks.
</p>
<p><a class='info' href='#overview'>Figure&nbsp;1<span> (</span><span class='info'>Interworking Architecture</span><span>)</span></a> describes the interworking between SAML and
SASL: this document requires enhancements to the Relying Party and to
the Client (as the two SASL communication end points) but no changes to
the SAML Identity Provider are necessary. To accomplish this goal some
indirect messaging is tunneled within SASL, and some use of external
methods is made.
</p>
<p> <br /><hr class="insert" />
<a name="overview"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


                                    +-----------+
                                    |           |
                                   &gt;|  Relying  |
                                  / |  Party    |
                                //  |           |
                              //    +-----------+
                   SAML/    //            ^
                   HTTPs  //           +--|--+
                        //             | S|  |
                       /             S | A|  |
                     //              A | M|  |
                   //                S | L|  |
                 //                  L |  |  |
               //                      |  |  |
             &lt;/                        +--|--+
      +------------+                      v
      |            |                 +----------+
      |  SAML      |     HTTPs       |          |
      |  Identity  |&lt;---------------&gt;|  Client  |
      |  Provider  |                 |          |
      +------------+                 +----------+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Interworking
Architecture&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words
"MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>The reader is assumed to be familiar with the terms used in the SAML
2.0 specification.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Applicability for non-HTTP Use Cases</h3>

<p>While SAML
itself is merely a markup language, its common use case these days is
with HTTP.  What follows is a typical flow: 
</p>
<p> 
</p>
<ol class="text">
<li>The browser requests a resource of a Relying Party (RP) (via an HTTP request).
</li>
<li>The RP sends an HTTP 
redirect as described in Section 10.3 of <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>  to
the browser to the Identity Provider (IdP) or an IdP discovery service with
an authentication request that contains the name of resource being
requested, some sort of a cookie and a return URL, 
</li>
<li> The user
authenticates to the IdP and perhaps authorizes the authentication to
the service provider. 
</li>
<li> In its authentication response, the IdP
redirects the browser back to the RP with an
authentication assertion (stating that the IdP vouches that the subject has successfully 
authenticated), optionally along with some additional attributes. 
</li>
<li> RP now has sufficient identity
information to approve access to the resource or not, and acts
accordingly.  The authentication is concluded. 
</li>
</ol><p> 
</p>
<p>When
considering this flow in the context of SASL, we note that while the
RP and the client both must change
their code to implement this SASL mechanism, the IdP must remain
untouched.  The  RP already has some sort of session 
(probably a TCP connection) established with the client. However, it may be
necessary to redirect a SASL client to another application or
handler.  This will be discussed below.

The steps are shown from below:
</p>
<p> 
</p>
<ol class="text">
<li> The Relying Party or SASL server advertises support for the SASL 
 SAML20 mechanism to the client 
</li>
<li> The client initiates a SASL authentication with SAML20 and sends an IdP identity
</li>
<li>The Relying Party transmits an authentication request encoded using a Universal Resource 
 Identifier (URI) as described in RFC 3986 <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> and a redirect to the IdP
</li>
<li> The SASL client now sends an empty response, as authentication continues via the normal SAML 
 flow. 
</li>
<li> At this point the SASL client MUST construct a URL containing the content received in the
 previous message from the RP. This URL is transmitted to the IdP either by the SASL client 
 application or an appropriate handler, such as a browser.
</li>
<li>Next the client authenticates to the IdP. The manner in which the end user is authenticated to 
 the IdP and any policies surrounding such authentication is out of scope for SAML and hence for 
 this draft. This step happens out of band from SASL.
</li>
<li>The IdP will convey information about the success or failure of the authentication back to the
 the RP in the form of an Authentication Statement or failure, using a indirect response via the 
 client browser or the handler. This step happens out of band from SASL.
</li>
<li> The SASL Server sends an appropriate SASL response to the client, along with an
optional list of attributes
</li>
</ol><p> 
</p>
<p>Please note: What is described here is the case in which the client has not previously 
authenticated. If the client can handle SAML internally it is possible that the client 
already holds a valid SAML authentication token so that the user does not need to be involved in 
the process anymore, but that would still be external to SASL. 

</p>
<p> With all of this in mind, the flow appears as follows: 
</p>
<p>
<br /><hr class="insert" />
<a name="flow"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


         SASL Serv.       Client          IdP
            |&gt;-----(1)-----&gt;|              | Advertisement
            |               |              |
            |&lt;-----(2)-----&lt;|              | Initiation
            |               |              |
            |&gt;-----(3)-----&gt;|              | Authentication Request
            |               |              |
            |&lt;-----(4)-----&lt;|              | Empty Response
            |               |              |
            |               |&lt; - - - - - -&gt;| Client&lt;&gt;IDP
            |               |              | Authentication
            |               |              |
            |&lt;- - - - - - - - - - - - - - -| Authentication Statement
            |               |              |
            |&gt;-----(6)-----&gt;|              | SASL completion with
            |               |              | status
            |               |              |

       ----- = SASL
       - - - = HTTP or HTTPs (external to SASL)



</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Authentication flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
SAML SASL Mechanism Specification</h3>

<p>
  Based on the previous figure, the following operations are performed
  with the SAML SASL mechanism.
 
</p>
<p>
  The mechanism is "client first" as discussed in section 3 of <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a> which means that the initial server challenge
  will be empty if the protocol does not support an initial client
  response.
 
</p>
<a name="advertisement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Advertisement</h3>

<p> 
   To advertise
   that a server supports SAML 2.0, during application session initiation,
   it displays the name &quot;SAML20&quot; in the list of supported SASL
   mechanisms. 
  
</p>
<a name="initiation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Initiation</h3>

<p>
   A client initiates a &quot;SAML20&quot; authentication with SASL by sending the
   GS2 header followed by the authentication identifier.  The GS2 header carries the optional authorization
   identity.
  
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     initial-response = gs2-header Idp-Identifier
     IdP-Identifier = Identifier ; IdP identifier
     Identifier = URI            ; IdP URI

</pre></div>
<p>
  The "gs2-header" is specified in <a class='info' href='#RFC5801'>[RFC5801]<span> (</span><span class='info'>Josefsson, S. and N. Williams, &ldquo;Using Generic Security Service Application Program Interface (GSS-API) Mechanisms in Simple Authentication and Security Layer (SASL): The GS2 Mechanism Family,&rdquo; July&nbsp;2010.</span><span>)</span></a>, and it is used
  as follows.  The "gs2-nonstd-flag" MUST NOT be present.  Regarding
  the channel binding "gs2-cb-flag" field, see Section 5.  The "gs2-
  authzid" carries the optional authorization identity.

  URI is specified in <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>.  
 
</p>
<a name="1stresponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Server Redirect</h3>

<p> 
   The SASL Server transmits a URI to the IdP that the user provided, 
   with a SAML authentication request 
   in the form of a SAML assertion as one of the parameters.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     redirect-url = URI

</pre></div>
<p>
  As before, URI is specified in <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>.  
 
</p>
<a name="empty"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Client Empty Response and other</h3>

<p>
   The SASL client hands
   the URI it received from the server in the previous step to either a
   browser or other appropriate handler to continue authentication
   externally while sending an empty response to the SASL server.  
   The URI is encoded according to
   Section 3.4 of the <a class='info' href='#OASIS.saml-bindings-2.0-os'>SAML
   bindings 2.0 specification<span> (</span><span class='info'>Cantor, S., Hirsch, F., Kemp, J., Philpott, R., and E. Maler, &ldquo;Bindings for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a> [OASIS.saml&#8209;bindings&#8209;2.0&#8209;os]. 
  
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     empty-response = ""

</pre></div>
<a name="outcome"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Outcome and parameters</h3>

<p>
   The SAML authentication having completed externally, the SASL
   server will transmit the outcome of the authentication exchange as
   success or failure.
  
</p>
<a name="gss-api"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
SAML GSS-API Mechanism Specification</h3>

<p>
   This section and its sub-sections and all normative references of it
   not referenced elsewhere in this document are INFORMATIONAL for SASL
   implementors, but they are NORMATIVE for GSS-API implementors.

</p>
<p>
   The SAML SASL mechanism is actually also a GSS-API mechanism.  The
   messages are the same, but 
 
</p>
<p>  
   a) the GS2 header on the client's first
   message and channel binding data is excluded when SAML is used as a
   GSS-API mechanism, and 
 
</p>
<p>  
   b) the RFC2743 section 3.1 initial context token header is prefixed to 
   the client's first authentication message (context token).

</p>
<p>
   The GSS-API mechanism OID for SAML is 1.3.6.1.4.1.11591.4.8.

</p>
<p>
   SAML20 security contexts always have the mutual_state flag
   (GSS_C_MUTUAL_FLAG) set to TRUE.  SAML does not support credential
   delegation, therefore SAML security contexts alway have the
   deleg_state flag (GSS_C_DELEG_FLAG) set to FALSE.

</p>
<p>
   The SAML mechanism does not support per-message tokens or
   GSS_Pseudo_random.
 
</p>
<p>
   Note that the GSS-API mechanism MUST only be used by the client
   when a secure channel with server authentication (e.g., TLS) is
   available.
 
</p>
<a name="gss-api-name-types"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
GSS-API Principal Name Types for SAML</h3>

<p>
   SAML supports standard generic name syntaxes for acceptors such as
   GSS_C_NT_HOSTBASED_SERVICE (see <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>, Section 4.1).

   SAML supports only a single name type for initiators:
   GSS_C_NT_USER_NAME.  GSS_C_NT_USER_NAME is the default name type for
   SAML.

   The query, display, and exported name syntaxes for SAML principal
   names are all the same.  There are no SAML-specific name syntaxes
   -- applications should use generic GSS-API name types such as
   GSS_C_NT_USER_NAME and GSS_C_NT_HOSTBASED_SERVICE (see <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>,
   Section 4).  The exported name token does, of course, conform to
   <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>, Section 3.2.
 
</p>
<a name="channel-binding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Channel Binding</h3>

<p>
   The "gs2-cb-flag" MUST use "n" because channel binding data cannot
   be integrity protected by the SAML negotiation. FIXME: Transfer
   channel binding in SAML assertion?
 
</p>
<a name="examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Examples</h3>

<a name="examples-xmpp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
XMPP</h3>

<p> Suppose the user has an identity at the SAML IdP saml.example.org and a Jabber Identifier (JID) 
"somenode@example.com", and wishes to authenticate his XMPP connection to xmpp.example.com. The 
authentication on the wire would then look something like the following: 
</p>
<p>Step 1: Client initiates stream to server: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;stream:stream xmlns='jabber:client'
xmlns:stream='http://etherx.jabber.org/streams'
to='example.com' version='1.0'&gt;

</pre></div>
<p>Step 2: Server responds with a stream tag sent to client: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;stream:stream
xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams'
id='some_id' from='example.com' version='1.0'&gt;

</pre></div>
<p>Step 3: Server informs client of available authentication
mechanisms:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;stream:features&gt;
 &lt;mechanisms xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
  &lt;mechanism&gt;DIGEST-MD5&lt;/mechanism&gt;
  &lt;mechanism&gt;PLAIN&lt;/mechanism&gt;
  &lt;mechanism&gt;SAML20&lt;/mechanism&gt;
 &lt;/mechanisms&gt;
&lt;/stream:features&gt;

</pre></div>
<p>Step 4: Client selects an authentication mechanism and provides the
initial client response: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='SAML20'&gt;
 n,,https://saml.example.org&lt;/auth&gt;

</pre></div>
<p>Step 5: Server sends a <a class='info' href='#RFC4648'>BASE64<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648] encoded challenge to client 
 in the form
 of an HTTP Redirect to the SAML IdP with the SAML
 Authentication Request as specified in the redirection url: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

aHR0cHM6Ly9zYW1sLmV4YW1wbGUub3JnL1NBTUwvQnJvd3Nlcj9TQU1MUmVx
dWVzdD1QSE5oYld4d09rRjFkR2h1VW1WeGRXVnpkQ0I0Yld4dWN6cHpZVzFz
Y0QwaWRYSnVPbTloYzJsek9tNWhiV1Z6T25Sak9sTkJUVXc2TWk0d09uQnli
M1J2WTI5c0lnMEtJQ0FnSUVsRVBTSmZZbVZqTkRJMFptRTFNVEF6TkRJNE9U
QTVZVE13Wm1ZeFpUTXhNVFk0TXpJM1pqYzVORGMwT1RnMElpQldaWEp6YVc5
dVBTSXlMakFpRFFvZ0lDQWdTWE56ZFdWSmJuTjBZVzUwUFNJeU1EQTNMVEV5
TFRFd1ZERXhPak01T2pNMFdpSWdSbTl5WTJWQmRYUm9iajBpWm1Gc2MyVWlE
UW9nSUNBZ1NYTlFZWE56YVhabFBTSm1ZV3h6WlNJTkNpQWdJQ0JRY205MGIy
TnZiRUpwYm1ScGJtYzlJblZ5YmpwdllYTnBjenB1WVcxbGN6cDBZenBUUVUx
TU9qSXVNRHBpYVc1a2FXNW5jenBJVkZSUUxWQlBVMVFpRFFvZ0lDQWdRWE56
WlhKMGFXOXVRMjl1YzNWdFpYSlRaWEoyYVdObFZWSk1QUTBLSUNBZ0lDQWdJ
Q0FpYUhSMGNITTZMeTk0YlhCd0xtVjRZVzF3YkdVdVkyOXRMMU5CVFV3dlFY
TnpaWEowYVc5dVEyOXVjM1Z0WlhKVFpYSjJhV05sSWo0TkNpQThjMkZ0YkRw
SmMzTjFaWElnZUcxc2JuTTZjMkZ0YkQwaWRYSnVPbTloYzJsek9tNWhiV1Z6
T25Sak9sTkJUVXc2TWk0d09tRnpjMlZ5ZEdsdmJpSStEUW9nSUNBZ0lHaDBk
SEJ6T2k4dmVHMXdjQzVsZUdGdGNHeGxMbU52YlEwS0lEd3ZjMkZ0YkRwSmMz
TjFaWEkrRFFvZ1BITmhiV3h3T2s1aGJXVkpSRkJ2YkdsamVTQjRiV3h1Y3pw
ellXMXNjRDBpZFhKdU9tOWhjMmx6T201aGJXVnpPblJqT2xOQlRVdzZNaTR3
T25CeWIzUnZZMjlzSWcwS0lDQWdJQ0JHYjNKdFlYUTlJblZ5YmpwdllYTnBj
enB1WVcxbGN6cDBZenBUUVUxTU9qSXVNRHB1WVcxbGFXUXRabTl5YldGME9u
Qmxjbk5wYzNSbGJuUWlEUW9nSUNBZ0lGTlFUbUZ0WlZGMVlXeHBabWxsY2ow
aWVHMXdjQzVsZUdGdGNHeGxMbU52YlNJZ1FXeHNiM2REY21WaGRHVTlJblJ5
ZFdVaUlDOCtEUW9nUEhOaGJXeHdPbEpsY1hWbGMzUmxaRUYxZEdodVEyOXVk
R1Y0ZEEwS0lDQWdJQ0I0Yld4dWN6cHpZVzFzY0QwaWRYSnVPbTloYzJsek9t
NWhiV1Z6T25Sak9sTkJUVXc2TWk0d09uQnliM1J2WTI5c0lpQU5DaUFnSUNB
Z0lDQWdRMjl0Y0dGeWFYTnZiajBpWlhoaFkzUWlQZzBLSUNBOGMyRnRiRHBC
ZFhSb2JrTnZiblJsZUhSRGJHRnpjMUpsWmcwS0lDQWdJQ0FnZUcxc2JuTTZj
MkZ0YkQwaWRYSnVPbTloYzJsek9tNWhiV1Z6T25Sak9sTkJUVXc2TWk0d09t
RnpjMlZ5ZEdsdmJpSStEUW9nb0NBZ0lDQjFjbTQ2YjJGemFYTTZibUZ0WlhN
NmRHTTZVMEZOVERveUxqQTZZV002WTJ4aGMzTmxjenBRWVhOemQyOXlaRkJ5
YjNSbFkzUmxaRlJ5WVc1emNHOXlkQTBLSUNBOEwzTmhiV3c2UVhWMGFHNURi
MjUwWlhoMFEyeGhjM05TWldZK0RRb2dQQzl6WVcxc2NEcFNaWEYxWlhOMFpX
UkJkWFJvYmtOdmJuUmxlSFErSUEwS1BDOXpZVzFzY0RwQmRYUm9ibEpsY1hW
bGMzUSs=

</pre></div>
<p>The decoded challenge is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

https://saml.example.org/SAML/Browser?SAMLRequest=PHNhbWxwOk
F1dGhuUmVxdWVzdCB4bWxuczpzYW1scD0idXJuOm9hc2lzOm5hbWVzOnRjOl
NBTUw6Mi4wOnByb3RvY29sIg0KICAgIElEPSJfYmVjNDI0ZmE1MTAzNDI4OT
A5YTMwZmYxZTMxMTY4MzI3Zjc5NDc0OTg0IiBWZXJzaW9uPSIyLjAiDQogIC
AgSXNzdWVJbnN0YW50PSIyMDA3LTEyLTEwVDExOjM5OjM0WiIgRm9yY2VBdX
Robj0iZmFsc2UiDQogICAgSXNQYXNzaXZlPSJmYWxzZSINCiAgICBQcm90b2
NvbEJpbmRpbmc9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpiaW5kaW
5nczpIVFRQLVBPU1QiDQogICAgQXNzZXJ0aW9uQ29uc3VtZXJTZXJ2aWNlVV
JMPQ0KICAgICAgICAiaHR0cHM6Ly94bXBwLmV4YW1wbGUuY29tL1NBTUwvQX
NzZXJ0aW9uQ29uc3VtZXJTZXJ2aWNlIj4NCiA8c2FtbDpJc3N1ZXIgeG1sbn
M6c2FtbD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbi
I+DQogICAgIGh0dHBzOi8veG1wcC5leGFtcGxlLmNvbQ0KIDwvc2FtbDpJc3
N1ZXI+DQogPHNhbWxwOk5hbWVJRFBvbGljeSB4bWxuczpzYW1scD0idXJuOm
9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIg0KICAgICBGb3JtYX
Q9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0On
BlcnNpc3RlbnQiDQogICAgIFNQTmFtZVF1YWxpZmllcj0ieG1wcC5leGFtcG
xlLmNvbSIgQWxsb3dDcmVhdGU9InRydWUiIC8+DQogPHNhbWxwOlJlcXVlc3
RlZEF1dGhuQ29udGV4dA0KICAgICB4bWxuczpzYW1scD0idXJuOm9hc2lzOm
5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIiANCiAgICAgICAgQ29tcGFyaX
Nvbj0iZXhhY3QiPg0KICA8c2FtbDpBdXRobkNvbnRleHRDbGFzc1JlZg0KIC
AgICAgeG1sbnM6c2FtbD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOm
Fzc2VydGlvbiI+DQogICAgICAgICAgIHVybjpvYXNpczpuYW1lczp0YzpTQU
1MOjIuMDphYzpjbGFzc2VzOlBhc3N3b3JkUHJvdGVjdGVkVHJhbnNwb3J0DQ
ogIDwvc2FtbDpBdXRobkNvbnRleHRDbGFzc1JlZj4NCiA8L3NhbWxwOlJlcX
Vlc3RlZEF1dGhuQ29udGV4dD4gDQo8L3NhbWxwOkF1dGhuUmVxdWVzdD4=

</pre></div>
<p>Where the decoded SAMLRequest looks like:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;samlp:AuthnRequest xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"
    ID="_bec424fa5103428909a30ff1e31168327f79474984" Version="2.0"
    IssueInstant="2007-12-10T11:39:34Z" ForceAuthn="false"
    IsPassive="false"
    ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
    AssertionConsumerServiceURL=
        "https://xmpp.example.com/SAML/AssertionConsumerService"&gt;
 &lt;saml:Issuer xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"&gt;
     https://xmpp.example.com
 &lt;/saml:Issuer&gt;
 &lt;samlp:NameIDPolicy xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"
     Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"
     SPNameQualifier="xmpp.example.com" AllowCreate="true" /&gt;
 &lt;samlp:RequestedAuthnContext
     xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"
        Comparison="exact"&gt;
  &lt;saml:AuthnContextClassRef
      xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"&gt;
      urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport
  &lt;/saml:AuthnContextClassRef&gt;
 &lt;/samlp:RequestedAuthnContext&gt;
&lt;/samlp:AuthnRequest&gt;

</pre></div>
<p>Step 5 (alt): Server returns error to client:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;failure xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
 &lt;incorrect-encoding/&gt;
&lt;/failure&gt;
&lt;/stream:stream&gt;

</pre></div>
<p>Step 6: Client sends a BASE64 encoded empty response to the
challenge:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
 =
&lt;/response&gt;

</pre></div>
<p>
[ The client now sends the URL to a browser for processing. The browser
engages in a normal SAML authentication flow (external to SASL),
like redirection to the Identity Provider (https://saml.example.org), the
user logs into https://saml.example.org, and agrees to authenticate to
xmpp.example.com.  A redirect is passed back to the client browser who
sends the AuthN response to the server, containing the subject-identifier as 
an attribute. If the AuthN response doesn't contain the JID, the server maps 
the subject-identifier received from the IdP to a JID]

</p>
<p>Step 7: Server informs client of successful authentication: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;success xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/&gt;

</pre></div>
<p>Step 7 (alt): Server informs client of failed authentication: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;failure xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
 &lt;temporary-auth-failure/&gt;
&lt;/failure&gt;
&lt;/stream:stream&gt;

</pre></div>
<p>Step 8: Client initiates a new stream to server: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;stream:stream xmlns='jabber:client'
xmlns:stream='http://etherx.jabber.org/streams'
to='example.com' version='1.0'&gt;

</pre></div>
<p>Step 9: Server responds by sending a stream header to client along
with any additional features (or an empty features element): 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;stream:stream xmlns='jabber:client'
xmlns:stream='http://etherx.jabber.org/streams'
id='c2s_345' from='example.com' version='1.0'&gt;
&lt;stream:features&gt;
 &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'/&gt;
 &lt;session xmlns='urn:ietf:params:xml:ns:xmpp-session'/&gt;
&lt;/stream:features&gt;

</pre></div>
<p>Step 10: Client binds a resource:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   &lt;iq type='set' id='bind_1'&gt;
     &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'&gt;
       &lt;resource&gt;someresource&lt;/resource&gt;
     &lt;/bind&gt;
   &lt;/iq&gt;

</pre></div>
<p>Step 11: Server informs client of successful resource binding:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   &lt;iq type='result' id='bind_1'&gt;
     &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'&gt;
       &lt;jid&gt;somenode@example.com/someresource&lt;/jid&gt;
     &lt;/bind&gt;
   &lt;/iq&gt;

</pre></div>
<p>Please note: line breaks were added to the
base64 for clarity.
</p>
<a name="examples-imap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
IMAP</h3>

<p>The following describes an IMAP exchange.  Lines beginning with
  'S:' indicate data sent by the server, and lines starting with 'C:'
  indicate data sent by the client.  Long lines are wrapped for
  readability.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
S: * OK IMAP4rev1
C: . CAPABILITY
S: * CAPABILITY IMAP4rev1 STARTTLS
S: . OK CAPABILITY Completed
C: . STARTTLS
S: . OK Begin TLS negotiation now
C: . CAPABILITY
S: * CAPABILITY IMAP4rev1 AUTH=SAML20
S: . OK CAPABILITY Completed
C: . AUTHENTICATE SAML20
S: +
C: biwsaHR0cHM6Ly9zYW1sLmV4YW1wbGUub3Jn
S: + aHR0cHM6Ly9zYW1sLmV4YW1wbGUub3JnL1NBTUwvQnJvd3Nlcj9TQU1MUmVx
dWVzdD1QSE5oYld4d09rRjFkR2h1VW1WeGRXVnpkQ0I0Yld4dWN6cHpZVzFz
Y0QwaWRYSnVPbTloYzJsek9tNWhiV1Z6T25Sak9sTkJUVXc2TWk0d09uQnli
M1J2WTI5c0lnMEtJQ0FnSUVsRVBTSmZZbVZqTkRJMFptRTFNVEF6TkRJNE9U
QTVZVE13Wm1ZeFpUTXhNVFk0TXpJM1pqYzVORGMwT1RnMElpQldaWEp6YVc5
dVBTSXlMakFpRFFvZ0lDQWdTWE56ZFdWSmJuTjBZVzUwUFNJeU1EQTNMVEV5
TFRFd1ZERXhPak01T2pNMFdpSWdSbTl5WTJWQmRYUm9iajBpWm1Gc2MyVWlE
UW9nSUNBZ1NYTlFZWE56YVhabFBTSm1ZV3h6WlNJTkNpQWdJQ0JRY205MGIy
TnZiRUpwYm1ScGJtYzlJblZ5YmpwdllYTnBjenB1WVcxbGN6cDBZenBUUVUx
TU9qSXVNRHBpYVc1a2FXNW5jenBJVkZSUUxWQlBVMVFpRFFvZ0lDQWdRWE56
WlhKMGFXOXVRMjl1YzNWdFpYSlRaWEoyYVdObFZWSk1QUTBLSUNBZ0lDQWdJ
Q0FpYUhSMGNITTZMeTk0YlhCd0xtVjRZVzF3YkdVdVkyOXRMMU5CVFV3dlFY
TnpaWEowYVc5dVEyOXVjM1Z0WlhKVFpYSjJhV05sSWo0TkNpQThjMkZ0YkRw
SmMzTjFaWElnZUcxc2JuTTZjMkZ0YkQwaWRYSnVPbTloYzJsek9tNWhiV1Z6
T25Sak9sTkJUVXc2TWk0d09tRnpjMlZ5ZEdsdmJpSStEUW9nSUNBZ0lHaDBk
SEJ6T2k4dmVHMXdjQzVsZUdGdGNHeGxMbU52YlEwS0lEd3ZjMkZ0YkRwSmMz
TjFaWEkrRFFvZ1BITmhiV3h3T2s1aGJXVkpSRkJ2YkdsamVTQjRiV3h1Y3pw
ellXMXNjRDBpZFhKdU9tOWhjMmx6T201aGJXVnpPblJqT2xOQlRVdzZNaTR3
T25CeWIzUnZZMjlzSWcwS0lDQWdJQ0JHYjNKdFlYUTlJblZ5YmpwdllYTnBj
enB1WVcxbGN6cDBZenBUUVUxTU9qSXVNRHB1WVcxbGFXUXRabTl5YldGME9u
Qmxjbk5wYzNSbGJuUWlEUW9nSUNBZ0lGTlFUbUZ0WlZGMVlXeHBabWxsY2ow
aWVHMXdjQzVsZUdGdGNHeGxMbU52YlNJZ1FXeHNiM2REY21WaGRHVTlJblJ5
ZFdVaUlDOCtEUW9nUEhOaGJXeHdPbEpsY1hWbGMzUmxaRUYxZEdodVEyOXVk
R1Y0ZEEwS0lDQWdJQ0I0Yld4dWN6cHpZVzFzY0QwaWRYSnVPbTloYzJsek9t
NWhiV1Z6T25Sak9sTkJUVXc2TWk0d09uQnliM1J2WTI5c0lpQU5DaUFnSUNB
Z0lDQWdRMjl0Y0dGeWFYTnZiajBpWlhoaFkzUWlQZzBLSUNBOGMyRnRiRHBC
ZFhSb2JrTnZiblJsZUhSRGJHRnpjMUpsWmcwS0lDQWdJQ0FnZUcxc2JuTTZj
MkZ0YkQwaWRYSnVPbTloYzJsek9tNWhiV1Z6T25Sak9sTkJUVXc2TWk0d09t
RnpjMlZ5ZEdsdmJpSStEUW9nb0NBZ0lDQjFjbTQ2YjJGemFYTTZibUZ0WlhN
NmRHTTZVMEZOVERveUxqQTZZV002WTJ4aGMzTmxjenBRWVhOemQyOXlaRkJ5
YjNSbFkzUmxaRlJ5WVc1emNHOXlkQTBLSUNBOEwzTmhiV3c2UVhWMGFHNURi
MjUwWlhoMFEyeGhjM05TWldZK0RRb2dQQzl6WVcxc2NEcFNaWEYxWlhOMFpX
UkJkWFJvYmtOdmJuUmxlSFErSUEwS1BDOXpZVzFzY0RwQmRYUm9ibEpsY1hW
bGMzUSs=
C:
S: . OK Success (tls protection)
</pre></div>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>
 This section will address only security considerations associated
   with the use of SAML with SASL applications.  For considerations
   relating to SAML in general, the reader is referred to the SAML
   specification and to other literature.  Similarly, for general SASL
   Security Considerations, the reader is referred to that
   specification.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Man in the middle and Tunneling Attacks</h3>

<p>
   This mechanism is vulnerable to man in the middle and tunneling
   attacks unless a client always verify the server identity before
   proceeding with authentication.  Typically TLS is used to provide a
   secure channel with server authentication.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Binding SAML subject identifiers to Authorization Identities</h3>

<p>
   As specified in <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a>, the server is responsible for binding
   credentials to a specific authorization identity.  It is therefore
   necessary that only specific trusted IdPs be 
   allowed. This is typical part of SAML trust establishment between RP's and IdP.  

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
User Privacy</h3>

<p>
   The IdP is aware of each RP that a user logs into.  There is nothing
   in the protocol to hide this information from the IdP.  It is not a
   requirement to track the visits, but there is nothing that prohibits
   the collection of information.  SASL servers should be aware that
   SAML IdPs will track - to some extent - user access to
   their services.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Collusion between RPs</h3>

<p>
   It is possible for RPs to link data that they have collected on you.
   By using the same identifier to log into every RP, collusion between
   RPs is possible.  In SAML, targeted identity was introduced.
   Targeted identity allows the IdP to transform the identifier the user
   typed in to an opaque identifier.  This way the RP would never see the
   actual user identifier, but a randomly generated identifier.  This is
   an option the user has to understand and decide to use if the IdP is
   supporting it.
 
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p> The IANA is requested to
register the following
SASL profile: 
</p>
<p>
</p>
<p>SASL mechanism profile: SAML20
</p>
<p>Security
Considerations: See this document
</p>
<p>Published Specification: See
this document
</p>
<p>For further information: Contact the authors of
this document.
</p>
<p>Owner/Change controller: the IETF
</p>
<p>Note:
None
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="OASIS.saml-bindings-2.0-os">[OASIS.saml-bindings-2.0-os]</a></td>
<td class="author-text"><a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:Frederick.Hirsch@nokia.com">Hirsch, F.</a>, <a href="mailto:John.Kemp@nokia.com">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf">Bindings for the OASIS Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-bindings-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</a></td>
<td class="author-text"><a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:John.Kemp@nokia.com">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf">Assertions and Protocol for the OASIS Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-core-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-profiles-2.0-os">[OASIS.saml-profiles-2.0-os]</a></td>
<td class="author-text"><a href="mailto:">Hughes, J.</a>, <a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:Jeff.Hodges@neustar.biz">Hodges, J.</a>, <a href="mailto:Frederick.Hirsch@nokia.com">Hirsch, F.</a>, <a href="mailto:pmishra@principalidentity.com">Mishra, P.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf">Profiles for the OASIS Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;OASIS.saml-profiles-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4422">[RFC4422]</a></td>
<td class="author-text">Melnikov, A. and K. Zeilenga, &ldquo;<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>,&rdquo; RFC&nbsp;4422, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4422.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5801">[RFC5801]</a></td>
<td class="author-text">Josefsson, S. and N. Williams, &ldquo;<a href="http://tools.ietf.org/html/rfc5801">Using Generic Security Service Application Program Interface (GSS-API) Mechanisms in Simple Authentication and Security Layer (SASL): The GS2 Mechanism Family</a>,&rdquo; RFC&nbsp;5801, July&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5801.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3501">[RFC3501]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>,&rdquo; RFC&nbsp;3501, March&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3501.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3920">[RFC3920]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3920">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; RFC&nbsp;3920, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3920.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3920.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3920.xml">XML</a>).</td></tr>
</table>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgments</h3>

<p>
The authors would like to thank Scott Cantor, Joe Hildebrand, Josh Howlett, Leif Johansson, 
Diego Lopez, Hank Mauldin, RL 'Bob' Morgan, Stefan Plug and Hannes Tschofenig for their review 
and contributions.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Changes</h3>

<p>This section to be removed
prior to publication.
</p>
<p> 
</p>
<ul class="text">
<li>00 WG -00 draft.  Updates GSS-API section, some fixes per Scott Cantor
</li>
<li>01 Added authorization identity, added GSS-API specifics, added client supplied IdP
</li>
<li>00 Initial Revision. 
</li>
</ul><p> 
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Klaas Wierenga</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haarlerbergweg 13-19</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Amsterdam, Noord-Holland  1101 CH</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Netherlands</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+31 20 357 1752</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:klaas@cisco.com">klaas@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eliot Lear</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems GmbH</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richtistrasse 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wallisellen, ZH  CH-8304</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Switzerland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+41 44 878 9200</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lear@cisco.com">lear@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Simon Josefsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SJD AB</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hagagatan 24</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm  113 47</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SE</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:simon@josefsson.org">simon@josefsson.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://josefsson.org/">http://josefsson.org/</a></td></tr>
</table>
</body></html>
