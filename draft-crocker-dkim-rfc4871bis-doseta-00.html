<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DomainKeys Identified Mail (DKIM) Signatures -
         Over DOSETA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DomainKeys Identified Mail (DKIM) Signatures -
         Over DOSETA">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DKIM</td><td class="header">D. Crocker, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Brandenburg InternetWorking</td></tr>
<tr><td class="header">Obsoletes: <a href='http://tools.ietf.org/html/rfc4871'>4871</a>, <a href='http://tools.ietf.org/html/rfc5672'>5672</a></td><td class="header">M. Kucherawy, Ed.</td></tr>
<tr><td class="header">(if&nbsp;approved)</td><td class="header">Cloudmark</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">January 14, 2011</td></tr>
<tr><td class="header">Expires: July 18, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />DomainKeys Identified Mail (DKIM) Signatures -
         Over DOSETA<br />draft-crocker-dkim-rfc4871bis-Doseta-00</h1>

<h3>Abstract</h3>

<p>DomainKeys Identified Mail (DKIM) permits a person, role, or
            organization that owns the signing domain to claim some
            responsibility for a message by associating the domain with the
            message. This can be an author's organization, an operational
            relay or one of their agents. DKIM separates the question of the
            identity of the signer of the message from the purported author of
            the message. Assertion of responsibility is validated through a
            cryptographic signature and querying the signer's domain directly
            to retrieve the appropriate public key. Message transit from
            author to recipient is through relays that typically make no
            substantive change to a message or its content and thus preserve
            the DKIM signature.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 18, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Signing Identity {rfc4871bis-02 1.1}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Terminology and Definitions<br />
<a href="#anchor4">2.</a>&nbsp;
Signing and Verifying Protocol {added}<br />
<a href="#anchor5">3.</a>&nbsp;
Extensions to DOSETA Template {rfc4871bis-02  - adapted for Doseta overlay}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signeddatastruct">3.1.</a>&nbsp;
Signature Data Structure {rfc4871bis-02 3.5, subset}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.2.</a>&nbsp;
Relationship between SDID and AUID {rfc4871bis-02 3.9}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keydata">3.3.</a>&nbsp;
Stored Key Data {rfc4871bis-02 3.6.1, subset}<br />
<a href="#anchor14">4.</a>&nbsp;
Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security">4.1.</a>&nbsp;
Security Considerations {rfc4871bis-02 8, subset}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana">4.2.</a>&nbsp;
IANA Considerations {rfc4871bis-02 7, subset}<br />
<a href="#rfc.references1">5.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">5.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">5.2.</a>&nbsp;
Informative References<br />
<a href="#anchor23">Appendix&nbsp;A.</a>&nbsp;
MUA Considerations {rfc4871bis-02 D}<br />
<a href="#anchor24">Appendix&nbsp;B.</a>&nbsp;
End-to-End Scenario Example {rfc4871bis-02 A}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">B.1.</a>&nbsp;
The User Composes an Email<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">B.2.</a>&nbsp;
The Email is Signed<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">B.3.</a>&nbsp;
The Email Signature is Verified<br />
<a href="#anchor28">Appendix&nbsp;C.</a>&nbsp;
Types of Use {rfc4871bis-02 B}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">C.1.</a>&nbsp;
Alternate Submission Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">C.2.</a>&nbsp;
Alternate Delivery Scenarios<br />
<a href="#anchor38">Appendix&nbsp;D.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>DomainKeys Identified Mail (DKIM) permits a person, role, or
            organization to claim some responsibility for a message by
            associating a domain name <a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;DOMAIN NAMES - CONCEPTS AND FACILITIES,&rdquo; November&nbsp;1987.</span><span>)</span></a> with the message <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. This can be an author's organization, an
            operational relay or one of their agents. Assertion of
            responsibility is validated through a cryptographic signature and
            querying the signer's domain directly to retrieve the appropriate
            public key. Message transit from author to recipient is through
            relays that typically make no substantive change to the message
            content and thus preserve the DKIM signature. A message can
            contain multiple signatures, from the same or different
            organizations involved with the message. 
</p>
<p>The DKIM service is described in detail in <a class='info' href='#RFC5585'>[RFC5585]<span> (</span><span class='info'>Hansen, T., Crocker, D., and P. Hallam-Baker, &ldquo;DomainKeys Identified Mail (DKIM) Service                   Overview,&rdquo; June&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#RFC5863'>[RFC5863]<span> (</span><span class='info'>Hansen, T., Siegel, H., Hallam-Baker, P., and D. Crocker, &ldquo;DomainKeys Identified Mail (DKIM): Development,                   Deployment, and Operations,&rdquo; May&nbsp;2010.</span><span>)</span></a>.</p>
<blockquote class="text">
<p>This version of DKIM is based on a split between
                  DKIM-specific details, versus an underlying component
                  mechanism, called DOSETA, that can be used for other
                  services. <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>.</p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Much of the text for this draft is
                        taken from the DKIM working group
                        draft-ietf-DKIM-rfc4871bis-02 revision. Sections in
                        this document cross reference their source with the
                        notation: <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{rfc4871bis-02 xx}</pre></div>where "xx" indicates the section number. It
                        might also indicate that a subset is taken, such as
                        when a portion is applied to the DKIM-over-DOSETA
                        draft and a portion to the DOSETA draft. In some cases
                        the base text also has been enhanced.
</dd>
</dl></blockquote>

</blockquote><p>
         
</p>
<p>The approach taken by DKIM differs from previous approaches to
            message signing (for example., Secure/Multipurpose Internet Mail
            Extensions (S/MIME) <a class='info' href='#RFC1847'>[RFC1847]<span> (</span><span class='info'>Galvin, J., Murphy, S., Crocker, S., and N. Freed, &ldquo;Security Multiparts for MIME:                   Multipart/Signed and Multipart/Encrypted,&rdquo; October&nbsp;1995.</span><span>)</span></a>, OpenPGP <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>) in that: </p>
<ul class="text">
<li>the message signature is written as a message header field
                  so that neither human recipients nor existing MUA (Mail User
                  Agent) software is confused by signature-related content
                  appearing in the message body;
</li>
<li>there is no dependency on public and private key pairs being
                  issued by well-known, trusted certificate authorities; 
</li>
<li>there is no dependency on the deployment of any new Internet
                  protocols or services for public key distribution or
                  revocation;
</li>
<li>signature verification failure does not force rejection of
                  the message;
</li>
<li>no attempt is made to include encryption as part of the
                  mechanism;
</li>
<li>message archiving is not a design goal.
</li>
</ul>

<p>DKIM: </p>
<ul class="text">
<li>is compatible with the existing email infrastructure and
                  transparent to the fullest extent possible;
</li>
<li>requires minimal new infrastructure;
</li>
<li>can be implemented independently of clients in order to
                  reduce deployment time;
</li>
<li>can be deployed incrementally;
</li>
<li>allows delegation of signing to third parties.
</li>
</ul>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Signing Identity {rfc4871bis-02 1.1}</h3>

<p>DKIM separates the question of the identity of the signer of
               the message from the purported author of the message. In
               particular, a signature includes the identity of the signer.
               Verifiers can use the signing information to decide how they
               want to process the message. The signing identity is included
               as part of the signature header field. 
</p>
<p>The signing identity specified by a DKIM signature is not
               required to match an address in any particular header field
               because of the broad methods of interpretation by recipient
               mail systems, including MUAs.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology and Definitions</h3>

<p>This specification incorporates the terminology defined in <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>.
</p>
<p>Syntax descriptions use Augmented BNF (ABNF) <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications:                   ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>. 
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
               NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
               "OPTIONAL" in this document are to be interpreted as described
               in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate                   Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Additional terminology: {rfc4871bis-02 #2, subset}</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Signing Domain Identifier (SDID):  </dt>
<dd>
                           This augments the definition provided by DOSETA <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>. A single domain name that
                           is the mandatory payload output of DKIM and that
                           refers to the identity claiming responsibility for
                           introduction of a message into the mail stream. For
                           DKIM processing, the name has only basic domain
                           name semantics; any possible owner-specific
                           semantics are outside the scope of DKIM. It is
                           specified in <a class='info' href='#signeddatastruct'>Section&nbsp;3.1<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>.
</dd>
<dt>Agent or User Identifier (AUID):  </dt>
<dd> A
                           single identifier that refers to the agent or user
                           on behalf of whom the Signing Domain Identifier
                           (SDID) has taken responsibility. The AUID comprises
                           a domain name and an optional &lt;local-part&gt;.
                           The domain name is the same as that used for the
                           SDID or is a sub-domain of it. For DOSETA
                           processing, the domain name portion of the AUID has
                           only basic domain name semantics; any possible
                           owner-specific semantics are outside the scope of
                           DOSETA. It is specified in <a class='info' href='#signeddatastruct'>Section&nbsp;3.1<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a> .
</dd>
<dt>Identity Assessor:  </dt>
<dd> This augments the
                           definition of Assessor in <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>. A module that consumes
                           DOSETA's mandatory payload, which is the
                           responsible Signing Domain Identifier (SDID). The
                           module is dedicated to the assessment of the
                           delivered identifier. Other DOSETA (and non-DOSETA)
                           values can also be delivered to this module as well
                           as to a more general message evaluation filtering
                           engine. However, this additional activity is
                           outside the scope of the DKIM signature
                           specification. 
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Signing and Verifying Protocol {added}</h3>

<p> DKIM uses the DOSETA "Generic Header/Content Signing Service
            Template" <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a> as its base.
</p>
<p>The DOSETA template specifies TEMPLATE information that is
            required to tailor the signing service:</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Signature Association: </dt>
<dd>The
                        DOSETA&#8209;Signature data are stored in a
                        DKIM&#8209;Signature header field that is part of the
                        Header of the message being signed. This contains all
                        of the signature and key-fetching data, per <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>.
</dd>
<dt>Semantics Signaling:  </dt>
<dd>The presence of a
                        DKIM&#8209;Signature header fields signals the use of
                        DKIM.
</dd>
<dt>Semantics:  </dt>
<dd>A DKIM signature means that
                        the owner of the signing domain is taking "some"
                        responsibility for the message. Hence, the payload, or
                        output, of DKIM is:
<ul class="text">
<li>A validated domain name, specifically the d=
                              parameter in the DKIM&#8209;Signature header
                              field
</li>
<li>An indication that its use has been
                              validated
</li>
</ul> The nature and extent of a DKIM signer's
                        responsibility can vary widely and is beyond the scope
                        of this specification.
</dd>
<dt>Header/Content Mapping:  </dt>
<dd>DKIM maps the
                        DOSETA Header processing to an email header and the
                        DOSETA Content to an email body, per <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>
</dd>
</dl></blockquote>

</blockquote><p>
         
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Extensions to DOSETA Template {rfc4871bis-02  - adapted for Doseta overlay}</h3>

<p>This section contains specifications that are added to the basic
            DOSETA H/C Signing Template.
</p>
<a name="signeddatastruct"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Signature Data Structure {rfc4871bis-02 3.5, subset}</h3>

<p>These are DKIM-specific tags: (</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>i= </dt>
<dd>The Agent or User Identifier (AUID)
                           on behalf of which the SDID is taking
                           responsibility (DOSETA-quoted-printable; OPTIONAL,
                           default is an empty &lt;local-part&gt; followed by
                           an "@" followed by the domain from the "d="
                           tag).
</dd>
<dt></dt>
<dd>The syntax is a standard email address where the
                           &lt;local-part&gt; MAY be omitted. The domain part
                           of the address MUST be the same as, or a subdomain
                           of, the value of the "d=" tag.
</dd>
<dt></dt>
<dd>Internationalized domain names MUST be converted
                           using the steps listed in Section 4 of <a class='info' href='#RFC5890'>[RFC5890]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalizing Domain Names in Applications (IDNA):                   Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a> using the "ToASCII"
                           function.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-i-tag</dfn>       = <span class='val'>%x69</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>]
                  [ <cite class='id'>local-part</cite> ] "<span class='str'>@</span>" <cite class='id'>domain-name</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt></dt>
<dd>The AUID is specified as having the same syntax as
                           an email address, but is not required to have the
                           same semantics. Notably, the domain name is not
                           required to be registered in the DNS -- so it might
                           not resolve in a query -- and the
                           &lt;local-part&gt; MAY be drawn from a namespace
                           unrelated to any mailbox. The details of the
                           structure and semantics for the namespace are
                           determined by the Signer. Any knowledge or use of
                           those details by verifiers or assessors is outside
                           the scope of the DOSETA Signing specification. The
                           Signer MAY choose to use the same namespace for its
                           AUIDs as its users' email addresses or MAY choose
                           other means of representing its users. However, the
                           signer SHOULD use the same AUID for each message
                           intended to be evaluated as being within the same
                           sphere of responsibility, if it wishes to offer
                           receivers the option of using the AUID as a stable
                           identifier that is finer grained than the SDID. 
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>The &lt;local-part&gt; of
                                 the "i=" tag is optional because in some
                                 cases a signer might not be able to establish
                                 a verified individual identity. In such
                                 cases, the signer might wish to assert that
                                 although it is willing to go as far as
                                 signing for the domain, it is unable or
                                 unwilling to commit to an individual user
                                 name within their domain. It can do so by
                                 including the domain part but not the
                                 &lt;local-part&gt; of the identity.
</dd>
<dt>NOTE:  </dt>
<dd>Absent public standards
                                 for the semantics of an AUID, an assessment
                                 based on AUID requires a non-standardized
                                 basis.
</dd>
<dt>NOTE: </dt>
<dd>This specification does not
                                 require the value of the "i=" tag to match
                                 the identity in any Header field. This is
                                 considered to be an assessment-time policy
                                 issue. Constraints between the value of the
                                 "i=" tag and other identities in other Header
                                 fields might seek to apply basic
                                 authentication into the semantics of trust
                                 associated with a role such as content
                                 author. Trust is a broad and complex topic
                                 and trust mechanisms are subject to highly
                                 creative attacks. The real-world efficacy of
                                 any but the most basic bindings between the
                                 "i=" value and other identities is not well
                                 established, nor is its vulnerability to
                                 subversion by an attacker. Hence reliance on
                                 the use of these options needs to be strictly
                                 limited. In particular, it is not at all
                                 clear to what extent a typical end-user
                                 recipient can rely on any assurances that
                                 might be made by successful use of the "i="
                                 options.
</dd>
</dl></blockquote>
</dd>
<dt>l=  </dt>
<dd>Content length count (plain-text
                           unsigned decimal integer; OPTIONAL, default is
                           entire Content). This tag informs the verifier of
                           the number of octets in the Content of the data
                           after canonicalization included in the
                           cryptographic hash, starting from 0 immediately
                           following the CRLF preceding the Content. This
                           value MUST NOT be larger than the actual number of
                           octets in the canonicalized Content. 
<blockquote class="text"><dl>
<dt></dt>
<dd>
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-l-tag</dfn>    = <span class='val'>%x6c</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>]
               <span class='rep'>1*76</span><cite class='key'>DIGIT</cite></pre></div>
</dd>
</dl></blockquote>
                           
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>Use of the "l=" tag might
                                 allow display of fraudulent content without
                                 appropriate warning to end users. The "l="
                                 tag is intended for increasing signature
                                 robustness when sending to intermediaries
                                 that append data to Content, such as mailing
                                 lists that both modify their content and do
                                 not sign their messages. However, using the
                                 "l=" tag enables attacks in which an
                                 intermediary with malicious intent modifies a
                                 message to include content that solely
                                 benefits the attacker. It is possible for the
                                 appended content to completely replace the
                                 original content in the end recipient's eyes
                                 and to defeat duplicate message detection
                                 algorithms. Examples are described in
                                 Security Considerations <a class='info' href='#security'>Section&nbsp;4.1<span> (</span><span class='info'>Security Considerations {rfc4871bis-02 8, subset}</span><span>)</span></a>. To avoid this attack,
                                 signers need be extremely wary of using this
                                 tag, and verifiers might wish to ignore the
                                 tag or remove text that appears after the
                                 specified content length.
</dd>
<dt>NOTE: </dt>
<dd>The value of the "l=" tag
                                 is constrained to 76 decimal digits. This
                                 constraint is not intended to predict the
                                 size of future data or to require
                                 implementations to use an integer
                                 representation large enough to represent the
                                 maximum possible value, but is intended to
                                 remind the implementer to check the length of
                                 this and all other tags during verification
                                 and to test for integer overflow when
                                 decoding the value. Implementers might need
                                 to limit the actual value expressed to a
                                 value smaller than 10^76, for example, to
                                 allow a message to fit within the available
                                 storage space.
</dd>
</dl></blockquote>
                        
</dd>
<dt>z=  </dt>
<dd>Copied Header fields
                           (DOSETA-quoted-printable, but see description;
                           OPTIONAL, default is null). A
                           vertical-bar-separated list of selected Header
                           fields present when the message was signed,
                           including both the field name and value. It is not
                           required to include all Header fields present at
                           the time of signing. This field need not contain
                           the same Header fields listed in the "h=" tag. The
                           Header field text itself MUST encode the vertical
                           bar ("|", %x7C) character. That is, vertical bars
                           in the "z=" text are meta-characters, and any
                           actual vertical bar characters in a copied header
                           field MUST be encoded. Note that all whitespace
                           MUST be encoded, including whitespace between the
                           colon and the header field value. After encoding,
                           FWS MAY be added at arbitrary locations in order to
                           avoid excessively long lines; such whitespace is
                           NOT part of the value of the header field, and MUST
                           be removed before decoding.
</dd>
<dt></dt>
<dd>The Header fields referenced by the "h=" tag refer
                           to the fields in the <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> Header, not to any copied
                           fields in the "z=" tag. Copied header field values
                           are for diagnostic use.
</dd>
<dt></dt>
<dd>Header fields with characters requiring conversion
                           (perhaps from legacy MTAs that are not <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> compliant) SHOULD be
                           converted as described in MIME Part Three <a class='info' href='#RFC2047'>[RFC2047]<span> (</span><span class='info'>Moore, K., &ldquo;MIME (Multipurpose                   Internet Mail Extensions) Part Three: Message Header                   Extensions for Non-ASCII Content,&rdquo; November&nbsp;1996.</span><span>)</span></a>.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>sig-z-tag</dfn>      = <span class='val'>%x7A</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>]
                 <cite class='id'>sig-z-tag-copy</cite>
                 <span class='rep'>*</span>( "<span class='str'>|</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-z-tag-copy</cite> )
<dfn>sig-z-tag-copy</dfn> = <cite class='id'>hdr-name</cite> [<cite class='id'>FWS</cite>] "<span class='str'>:</span>"
                 <cite class='id'>qp-hdr-value</cite></pre></div>
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

</blockquote><p>
               
<p style='text-align: left'>EXAMPLE of a signature header field spread across
                     multiple continuation lines:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>DKIM-Signature: v=1; a=rsa-sha256; d=example.net;
  s=brisbane;   c=simple; q=dns/txt; i=@eng.example.net;
  t=1117574938; x=1118006938;
  h=from:to:subject:date;
  z=From:foo@eng.example.net|To:joe@example.com|
   Subject:demo=20run|
   Date:July=205,=202005=203:44:08=20PM=20-0700;
  bh=MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTI=;
  b=dzdVyOfAKCdLXdJOc9G2q8LoXSlEniSbav+yuU4zGeeruD00lszZVoG4ZHRNiYzR</pre></div>

<a name="textlength"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Content Length Limits {rfc4871bis-02 3.4.5}</h3>

<p>A text length count MAY be specified to limit the signature
                  calculation to an initial prefix of an ASCII text data
                  portion, measured in octets. If the Content length count is
                  not specified, the entire Content is signed. 
</p>
<p>This capability is provided because it is very common for
                  intermediate data handling services to add trailers to text
                  (for example, instructions how to get off a mailing list).
                  Until such data is signed by the intermediate handler, the
                  text length count can be a useful tool for the verifier
                  since it can, as a matter of policy, accept messages having
                  valid signatures that do not cover the additional data.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>Using text length limits enables an
                        attack in which an attacker modifies a message to
                        include content that solely benefits the attacker. It
                        is possible for the appended content to completely
                        replace the original content in the end recipient's
                        eyes and to defeat duplicate message detection
                        algorithms. To avoid this attack, signers need to be
                        wary of using this tag, and verifiers might wish to
                        ignore the tag or remove text that appears after the
                        specified content length, perhaps based on other
                        criteria.
</dd>
</dl></blockquote>

<p>The text length count allows the signer of text to permit
                  data to be appended to the end of the text of a signed
                  message. The text length count MUST be calculated following
                  the canonicalization algorithm; for example, any whitespace
                  ignored by a canonicalization algorithm is not included as
                  part of the Content length count. Signers of MIME messages
                  that include a Content length count SHOULD be sure that the
                  length extends to the closing MIME boundary string. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>A creator wishing to ensure that
                        the only acceptable modifications are to add to a MIME
                        postlude would use a text length count encompassing
                        the entire final MIME boundary string, including the
                        final "--CRLF". A signer wishing to allow additional
                        MIME parts but not modification of existing parts
                        would use a Content length count extending through the
                        final MIME boundary string, omitting the final
                        "--CRLF". Note that this only works for some MIME
                        types, such as, multipart&#47;mixed but not
                        multipart&#47;signed.
</dd>
</dl></blockquote>

<p>A text length count of zero means that the text is
                  completely unsigned.
</p>
<p>Creators wishing to ensure that no modification of any sort
                  can occur will specify the "simple" canonicalization
                  algorithm for all data portions and will and omit the text
                  length counts.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Recommended Signature Content {rfc4871bis-02 5.5}</h3>

<p>In order to maximize compatibility with a variety of
                  verifiers, it is recommended that signers follow the
                  practices outlined in this section when signing a message.
                  However, these are generic recommendations applying to the
                  general case; specific senders might wish to modify these
                  guidelines as required by their unique situations. Verifiers
                  MUST be capable of verifying signatures even if one or more
                  of the recommended Header fields is not signed (with the
                  exception of From:, which MUST always be signed) or if one
                  or more of the dis-recommended Header fields is signed. Note
                  that verifiers do have the option of ignoring signatures
                  that do not cover a sufficient portion of the header or
                  Content, just as they might ignore signatures from an
                  identity they do not trust.
</p>
<p>The following Header fields SHOULD be included in the
                  signature, if they are present in the message being signed: </p>
<ul class="text">
<li>From (REQUIRED in all signatures)
</li>
<li>Sender, Reply-To
</li>
<li>Subject
</li>
<li>Date, Message-ID
</li>
<li>To, Cc
</li>
<li>MIME-Version
</li>
<li>Content-Type, Content-Transfer-Encoding, Content-ID,
                        Content- Description
</li>
<li>Resent-Date, Resent-From, Resent-Sender, Resent-To,
                        Resent-Cc, Resent-Message-ID
</li>
<li>In-Reply-To, References
</li>
<li>List-Id, List-Help, List-Unsubscribe, List-Subscribe,
                        List-Post, List-Owner, List-Archive
</li>
</ul>

<p>The following Header fields SHOULD NOT be included in the
                  signature: </p>
<ul class="text">
<li>Return-Path
</li>
<li>Received
</li>
<li>Comments, Keywords
</li>
<li>Bcc, Resent-Bcc
</li>
<li>DOSETA&#8209;Signature
</li>
</ul>

<p>Optional Header fields (those not mentioned above) normally
                  SHOULD NOT be included in the signature, because of the
                  potential for additional Header fields of the same name to
                  be legitimately added or reordered prior to verification.
                  There are likely to be legitimate exceptions to this rule,
                  because of the wide variety of application- specific Header
                  fields that might be applied to a message, some of which are
                  unlikely to be duplicated, modified, or reordered.
</p>
<p>Signers SHOULD choose canonicalization algorithms based on
                  the types of data they process and their aversion to risk.
                  For example, e-commerce sites sending primarily purchase
                  receipts, which are not expected to be processed by
                  intermediaries such as mailing lists or other software
                  likely to modify data, will generally prefer "simple"
                  canonicalization. Sites sending primarily person-to-person
                  data will likely prefer to be more resilient to modification
                  during transport by using "relaxed" canonicalization.
</p>
<p>Signers SHOULD NOT use "l=" unless they intend to
                  accommodate intermediate data processors that append text to
                  a message. For example, many mailing list processors append
                  "unsubscribe" information to message bodies. If signers use
                  "l=", they SHOULD include the entire Content existing at the
                  time of signing in computing the count. In particular,
                  signers SHOULD NOT specify a Content length of 0 since this
                  might be interpreted as a meaningless signature by some
                  verifiers.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Signature Verification {rfc4871bis-02 6.1.3, subset}</h3>

<p>A Content length specified in the "l=" tag of the signature
                  limits the number of bytes of the Content passed to the
                  verification algorithm. All data beyond that limit is not
                  validated by DOSETA. Hence, verifiers might treat a message
                  that contains bytes beyond the indicated Content length with
                  suspicion, such as by truncating the message at the
                  indicated Content length, declaring the signature invalid
                  (for example, by returning PERMFAIL (unsigned content)), or
                  conveying the partial verification to the policy module. </p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>Verifiers that truncate the Content
                        at the indicated Content length might pass on a
                        malformed MIME message if the signer used the "N-4"
                        trick (omitting the final "--CRLF") described in the
                        informative note in <a class='info' href='#textlength'>Section&nbsp;3.1.1<span> (</span><span class='info'>Content Length Limits {rfc4871bis-02 3.4.5}</span><span>)</span></a>. Such verifiers might wish to
                        check for this case and include a trailing "--CRLF" to
                        avoid breaking the MIME structure. A simple way to
                        achieve this might be to append "--CRLF" to any
                        "multipart" message with a Content length; if the MIME
                        structure is already correctly formed, this will
                        appear in the postlude and will not be displayed to
                        the end user.
</dd>
</dl></blockquote>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Relationship between SDID and AUID {rfc4871bis-02 3.9}</h3>

<p>DOSETA's primary task is to communicate from the Signer to a
               recipient-side Identity Assessor a single Signing Domain
               Identifier (SDID) that refers to a responsible identity. DOSETA
               MAY optionally provide a single responsible Agent or User
               Identifier (AUID).
</p>
<p>Hence, DOSETA's mandatory output to a receive-side Identity
               Assessor is a single domain name. Within the scope of its use
               as DOSETA output, the name has only basic domain name
               semantics; any possible owner-specific semantics are outside
               the scope of DOSETA. That is, within its role as a DOSETA
               identifier, additional semantics cannot be assumed by an
               Identity Assessor.
</p>
<p>Upon successfully verifying the signature, a receive-side
               DOSETA verifier MUST communicate the Signing Domain Identifier
               (d=) to a consuming Identity Assessor module and MAY
               communicate the Agent or User Identifier (i=) if present.
</p>
<p>To the extent that a receiver attempts to intuit any structured
               semantics for either of the identifiers, this is a heuristic
               function that is outside the scope of DOSETA's specification
               and semantics. Hence, it is relegated to a higher-level
               service, such as a delivery handling filter that integrates a
               variety of inputs and performs heuristic analysis of them. 
</p>
<p>This document does not require the value of the SDID or AUID to
               match an identifier in any other message header field. Such a
               requirement is, instead, an assessor policy issue. The purpose
               of such a linkage could be to authenticate the value in that
               other header field. This, in turn, is the basis for applying a
               trust assessment based on the identifier value. Trust is a
               broad and complex topic and trust mechanisms are subject to
               highly creative attacks. The real-world efficacy of any but the
               most basic bindings between the SDID or AUID and other
               identities is not well established, nor is its vulnerability to
               subversion by an attacker. Hence, reliance on the use of such
               bindings SHOULD be strictly limited. In particular, it is not
               at all clear to what extent a typical end-user recipient can
               rely on any assurances that might be made by successful use of
               the SDID or AUID.
</p>
<a name="keydata"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Stored Key Data {rfc4871bis-02 3.6.1, subset}</h3>

<p>This section defines additions to the DOSETA Library,
               concerning stored key data. </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>g=  </dt>
<dd>Granularity of the key (plain-text;
                           OPTIONAL, default is "*"). This value MUST match
                           the Local-part of the "i=" tag of the DKIM-
                           Signature header field (or its default value of the
                           empty string if "i=" is not specified), with a
                           single, optional "*" character matching a sequence
                           of zero or more arbitrary characters
                           ("wildcarding"). An email with a signing address
                           that does not match the value of this tag
                           constitutes a failed verification. The intent of
                           this tag is to constrain which signing address can
                           legitimately use this selector, for example, when
                           delegating a key to a third party that should only
                           be used for special purposes. Wildcarding allows
                           matching for addresses such as "user+*" or
                           "*-offer". An empty "g=" value never matches any
                           addresses. 
<blockquote class="text"><dl>
<dt></dt>
<dd>
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>key-g-tag</dfn>       = <span class='val'>%x67</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>key-g-tag-lpart</cite>
                     <cite class='id'>key-g-tag-lpart</cite> <span class='err'>= [dot-atom-text]
                                       ["*" [dot-atom-text] ]</span></pre></div>
</dd>
</dl></blockquote>
                        
</dd>
<dt>h=  </dt>
<dd>Acceptable hash algorithms
                           (plain-text; OPTIONAL, defaults to allowing all
                           algorithms). A colon-separated list of hash
                           algorithms that might be used. Signers and
                           Verifiers MUST support the "sha256" hash algorithm.
                           Verifiers MUST also support the "sha1" hash
                           algorithm.  Unrecognized
                           hash algorithms MUST be ignored. 
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>key-h-tag</dfn>       = <span class='val'>%x68</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>]
                  <cite class='id'>key-h-tag-alg</cite>
                  <span class='rep'>0*</span>( [<cite class='id'>FWS</cite>] "<span class='str'>:</span>" [<cite class='id'>FWS</cite>]
                  <cite class='id'>key-h-tag-alg</cite> )
<dfn>key-h-tag-alg</dfn>   = "<span class='str'>sha1</span>" / "<span class='str'>sha256</span>" /
                  <cite class='id'>x-key-h-tag-alg</cite>
<dfn>x-key-h-tag-alg</dfn> = <cite class='id'>hyphenated-word</cite>
                       <em>; for future extension</em></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>s=  </dt>
<dd>Service Type (plain-text; OPTIONAL;
                           default is "*"). A colon-separated list of service
                           types to which this record applies. Verifiers for a
                           given service type MUST ignore this record if the
                           appropriate type is not listed.  Unrecognized service types MUST be
                           ignored. Currently defined service types are as
                           follows: 
</dd>
<dt></dt>
<dd>
<blockquote class="text"><dl>
<dt>* </dt>
<dd>matches all service types
</dd>
<dt>email </dt>
<dd>electronic mail (not
                                 necessarily limited to SMTP)
</dd>
</dl></blockquote> This tag is intended to constrain the use
                           of keys for other purposes, if use of DOSETA is
                           defined by other services in the future.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>key-s-tag</dfn>        = <span class='val'>%x73</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>]
                   <cite class='id'>key-s-tag-type</cite>
                   <span class='rep'>0*</span>( [<cite class='id'>FWS</cite>] "<span class='str'>:</span>" [<cite class='id'>FWS</cite>]
                   <cite class='id'>key-s-tag-type</cite> )
<dfn>key-s-tag-type</dfn>   = "<span class='str'>email</span>" / "<span class='str'>*</span>" /
                   <cite class='id'>x-key-s-tag-type</cite>
<dfn>x-key-s-tag-type</dfn> = <cite class='id'>hyphenated-word</cite>
                        <em>; for future extension</em></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>t=  </dt>
<dd>Flags, represented as a
                           colon-separated list of names (plain-text;
                           OPTIONAL, default is no flags set).  Unrecognized flags MUST be ignored.
                           The defined flags are as follows: 
<blockquote class="text"><dl>
<dt>y  </dt>
<dd>This domain is testing DOSETA.
                                 Verifiers MUST NOT treat data from signers in
                                 testing mode differently from unsigned data,
                                 even if the signature fails to verify.
                                 Verifiers MAY wish to track testing mode
                                 results to assist the signer.
</dd>
<dt>s  </dt>
<dd>Any DOSETA&#8209;Signature
                                 Header fields using the "i=" tag MUST have
                                 the same domain value on the right-hand side
                                 of the "@" in the "i=" tag and the value of
                                 the "d=" tag. That is, the "i=" domain MUST
                                 NOT be a subdomain of "d=". Use of this flag
                                 is RECOMMENDED unless subdomaining is
                                 required.
</dd>
</dl></blockquote>
                        
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>key-t-tag</dfn>        = <span class='val'>%x74</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>]
                   <cite class='id'>key-t-tag-flag</cite>
                   <span class='rep'>0*</span>( [<cite class='id'>FWS</cite>] "<span class='str'>:</span>" [<cite class='id'>FWS</cite>]
                   <cite class='id'>key-t-tag-flag</cite> )
<dfn>key-t-tag-flag</dfn>   = "<span class='str'>y</span>" / "<span class='str'>s</span>" /
                   <cite class='id'>x-key-t-tag-flag</cite>
<dfn>x-key-t-tag-flag</dfn> = <cite class='id'>hyphenated-word</cite>
                        <em>; for future extension</em></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
</dl></blockquote>

</blockquote><p>
            
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Considerations</h3>

<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Security Considerations {rfc4871bis-02 8, subset}</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Misuse of Content Length Limits (&quot;l=&quot; Tag)</h3>

<p> Content length limits (in the form of the "l=" tag) are
                  subject to several potential attacks.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1.1"></a><h3>4.1.1.1.&nbsp;
Addition of New MIME Parts to Multipart/*</h3>

<p>If the Content length limit does not cover a closing MIME
                     multipart section (including the trailing "--CRLF"
                     portion), then it is possible for an attacker to
                     intercept a properly signed multipart message and add a
                     new Content part. Depending on the details of the MIME
                     type and the implementation of the Consumer, this could
                     allow an attacker to change the information displayed to
                     an end user from an apparently trusted source.
</p>
<p>For example, if attackers can append information to a
                     "text/html" Content part, they might be able to exploit a
                     bug in some MUAs that continue to read after a
                     "&lt;/html&gt;" marker, and thus display HTML text on top
                     of already displayed text. If a message has a
                     "multipart&#47;alternative" Content part, they might be
                     able to add a new Content part that is preferred by the
                     displaying MUA.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1.2"></a><h3>4.1.1.2.&nbsp;
Addition of new HTML content to existing content</h3>

<p>Several receiving MUA implementations do not cease
                     display after a ""&lt;/html&gt;"" tag. In particular,
                     this allows attacks involving overlaying images on top of
                     existing text. 
</p>
<p>EXAMPLE: Appending the following text to an existing,
                     properly closed message will in many MUAs result in
                     inappropriate data being rendered on top of existing,
                     correct data: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>&lt;div style="position: relative; bottom: 350px; z-index: 2;"&gt;
&lt;img src="http://www.ietf.org/images/ietflogo2e.gif"
     width=578 height=370&gt; &lt;/div&gt;
</pre></div><p>

</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
IANA Considerations {rfc4871bis-02 7, subset}</h3>

<p>DKIM uses registries now assigned to DOSETA <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>. This section specifies additions to
               the registries that were in the original DKIM Signing
               specification. They are not part of the DOSETA specification,
               but are now specific to DKIM.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
DKIM&#8209;Signature Tag Specifications</h3>

<p>These values are added to the registry that is now defined
                  in <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>:
</p><br /><hr class="insert" />
<a name="sigtagreg"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> i </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;3.1<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> l </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;3.1<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> z </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;3.1<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: DKIM&nbhy;Signature Tag Specification Registry Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="dnstxt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
_domainkey DNS TXT Record Tag Specifications</h3>

<p>These values are added to the registry that is now defined
                  in <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> g </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> h </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> s </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> t </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>) </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;DKIT _domainkey DNS TXT Record Tag Specification Registry
                     Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
DKIM Service Types Registry</h3>

<p>The "s=" &lt;key-s-tag&gt; tag (specified in <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>) provides for a list of service types
                  to which this selector might apply.
</p>
<p>IANA has established the DKIM Service Types Registry for
                  service types.
</p>
<p>The initial entries in the registry comprise:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> email </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>, "s=") </td>
</tr>
<tr>
<td align="center"> * </td>
<td align="left"> (this document, , <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>, "s=") </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;DKIM Service Types Registry Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="svcflags"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
DKIM Service Flags Registry</h3>

<p>The "t=" &lt;key-t-tag&gt; tag (specified in <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>) provides for a list of flags to
                  modify interpretation of the selector.
</p>
<p>IANA has established the DKIM Selector Flags Registry for
                  additional flags.
</p>
<p>The initial entries in the registry comprise:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> y </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>, "t=") </td>
</tr>
<tr>
<td align="center"> s </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.3<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset}</span><span>)</span></a>, "t=") </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;DKIM Service Flags Registry Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.5"></a><h3>4.2.5.&nbsp;
DKIM&#8209;Signature Header Field</h3>

<p>IANA has added DKIM&#8209;Signature to the "Permanent Message
                  Header Fields" registry (see <a class='info' href='#RFC3864'>[RFC3864]<span> (</span><span class='info'>Klyne, G., Nottingham, M., and J. Mogul, &ldquo;Registration Procedures for Message Header                   Fields,&rdquo; September&nbsp;2004.</span><span>)</span></a>) for the "mail" protocol, using this
                  document as the reference.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>5.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.Doseta">[I-D.Doseta]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a>, <a href="mailto:tony+dkimov@maillennium.att.com">Hansen, T., Ed.</a>, and <a href="mailto:msk@cloudmark.com">M. Kucherawy, Ed.</a>, &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; I-D&nbsp;draft-ietf-DKIM-DOSETA, 2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">DOMAIN NAMES - CONCEPTS AND FACILITIES</a>,&rdquo; RFC&nbsp;1034, November&nbsp;1987.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2047">[RFC2047]</a></td>
<td class="author-text"><a href="mailto:moore@cs.utk.edu">Moore, K.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2047">MIME (Multipurpose
                  Internet Mail Extensions) Part Three: Message Header
                  Extensions for Non-ASCII Content</a>,&rdquo; RFC&nbsp;2047, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2047.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2047.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2047.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate
                  Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4234">Augmented BNF for Syntax Specifications:
                  ABNF</a>,&rdquo; RFC&nbsp;4234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5322">[RFC5322]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>,&rdquo; RFC&nbsp;5322, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5322.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5672">[RFC5672]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5672">RFC 4871 DomainKeys Identified Mail (DKIM) Signatures:
                  Update</a>,&rdquo; RFC&nbsp;5672, August&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5890">[RFC5890]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5890">Internationalizing Domain Names in Applications (IDNA):
                  Definitions and Document Framework</a>,&rdquo; RFC&nbsp;5890, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5890.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>5.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1847">[RFC1847]</a></td>
<td class="author-text"><a href="mailto:galvin@tis.com">Galvin, J.</a>, <a href="mailto:sandy@tis.com">Murphy, S.</a>, <a href="mailto:crocker@cybercash.com">Crocker, S.</a>, and <a href="mailto:ned@innosoft.com">N. Freed</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1847">Security Multiparts for MIME:
                  Multipart/Signed and Multipart/Encrypted</a>,&rdquo; RFC&nbsp;1847, October&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1847.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3864">[RFC3864]</a></td>
<td class="author-text">Klyne, G., Nottingham, M., and J. Mogul, &ldquo;<a href="http://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header
                  Fields</a>,&rdquo; BCP&nbsp;90, RFC&nbsp;3864, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3864.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4870">[RFC4870]</a></td>
<td class="author-text">Delany, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4870">Domain-Based Email Authentication Using Public Keys
                  Advertised in the DNS (DomainKeys)</a>,&rdquo; RFC&nbsp;4870, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4870.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4880">[RFC4880]</a></td>
<td class="author-text"><a href="mailto:jon@pgp.com">Callas, J.</a>, <a href="mailto:lutz@iks-jena.de">Donnerhacke, L.</a>, <a href="mailto:hal@pgp.com">Finney, H.</a>, and <a href="mailto:rodney@unitran.com">R. Thayer</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4880">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;4880, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4880.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4880.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4880.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5585">[RFC5585]</a></td>
<td class="author-text">Hansen, T., Crocker, D., and P. Hallam-Baker, &ldquo;DomainKeys Identified Mail (DKIM) Service
                  Overview,&rdquo; June&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5863">[RFC5863]</a></td>
<td class="author-text">Hansen, T., Siegel, H., Hallam-Baker, P., and D. Crocker, &ldquo;DomainKeys Identified Mail (DKIM): Development,
                  Deployment, and Operations,&rdquo; May&nbsp;2010.</td></tr>
</table>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
MUA Considerations {rfc4871bis-02 D}</h3>

<p>When a DKIM signature is verified, the processing system sometimes
            makes the result available to the recipient user's MUA. How to
            present this information to the user in a way that helps them is a
            matter of continuing human factors usability research. The
            tendency is to have the MUA highlight the SDID, in an attempt to
            show the user the identity that is claiming responsibility for the
            message. An MUA might do this with visual cues such as graphics,
            or it might include the address in an alternate view, or it might
            even rewrite the original From address using the verified
            information. Some MUAs might indicate which header fields were
            protected by the validated DKIM signature. This could be done with
            a positive indication on the signed header fields, with a negative
            indication on the unsigned header fields, by visually hiding the
            unsigned header fields, or some combination of these. If an MUA
            uses visual indications for signed header fields, the MUA probably
            needs to be careful not to display unsigned header fields in a way
            that might be construed by the end user as having been signed. If
            the message has an l= tag whose value does not extend to the end
            of the message, the MUA might also hide or mark the portion of the
            message body that was not signed.
</p>
<p>The aforementioned information is not intended to be exhaustive.
            The MUA may choose to highlight, accentuate, hide, or otherwise
            display any other information that may, in the opinion of the MUA
            author, be deemed important to the end user.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
End-to-End Scenario Example {rfc4871bis-02 A}</h3>

<p>This section shows the complete flow of an email from submission
            to final delivery, demonstrating how the various components fit
            together. The key used in this example is shown in <a class='info' href='#I-D.Doseta'>[I&#8209;D.Doseta]<span> (</span><span class='info'>Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., &ldquo;DomainKeys Security Tagging (DOSETA),&rdquo; 2010.</span><span>)</span></a>, "Creating a Public Key".
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
The User Composes an Email</h3>

<p>
               <br /><hr class="insert" />
<a name="usercompose"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>From: Joe SixPack &lt;joe@football.example.com&gt;
To: Suzie Q &lt;suzie@shopping.example.net&gt;
Subject: Is dinner ready?
Date: Fri, 11 Jul 2003 21:00:37 -0700 (PDT)
Message-ID: &lt;;20030712040037.46341.5F8J@football.example.com&gt;

Hi.

We lost the game. Are you hungry yet?

Joe.</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: The User Composes an Email&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
The Email is Signed</h3>

<p>
               <br /><hr class="insert" />

<p style='text-align: left'>This email is signed by the example.com outbound
                     email server and now looks like this:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>DOSETA&amp;nbhy;Signature: v=1; a=rsa-sha256; s=brisbane; d=example.com;
     c=simple/simple; q=dns/txt; i=joe@football.example.com;
     h=Received : From : To : Subject : Date : Message-ID;
     bh=2jUSOH9NhtVGCQWNr9BrIAPreKQjO6Sn7XIkfJVOzv8=;
     b=AuUoFEfDxTDkHlLXSZEpZj79LICEps6eda7W3deTVFOk4yAUoqOB
     4nujc7YopdG5dWLSdNg6xNAZpOPr+kHxt1IrE+NahM6L/LbvaHut
     KVdkLLkpVaVVQPzeRDI009SO2Il5Lu7rDNH6mZckBdrIx0orEtZV
     4bmp/YzhwvcubU4=;
Received: from client1.football.example.com  [192.0.2.1]
     by submitserver.example.com with SUBMISSION;
     Fri, 11 Jul 2003 21:01:54 -0700 (PDT)
From: Joe SixPack &lt;joe@football.example.com&gt;
To: Suzie Q &lt;suzie@shopping.example.net&gt;
Subject: Is dinner ready?
Date: Fri, 11 Jul 2003 21:00:37 -0700 (PDT)
Message-ID: &lt;20030712040037.46341.5F8J@football.example.com&gt;

Hi.

We lost the game. Are you hungry yet?

Joe.</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;The Email is Signed&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            

<p>The signing email server requires access to the private key
               associated with the "brisbane" selector to generate this
               signature.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
The Email Signature is Verified</h3>

<p>The signature is normally verified by an inbound SMTP server or
               possibly the final delivery agent. However, intervening MTAs
               can also perform this verification if they choose to do so. The
               verification process uses the domain "example.com" extracted
               from the "d=" tag and the selector "brisbane" from the "s=" tag
               in the DOSETA&#8209;Signature header field to form the DNS
               DOSETA query for: brisbane._domainkey.example.com
</p>
<p>Signature verification starts with the physically last Received
               header field, the From header field, and so forth, in the order
               listed in the "h=" tag. Verification follows with a single CRLF
               followed by the body (starting with "Hi."). The email is
               canonically prepared for verifying with the "simple" method.
               The result of the query and subsequent verification of the
               signature is stored (in this example) in the
               X-Authentication-Results header field line. After successful
               verification, the email looks like this: <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>X-Authentication-Results: shopping.example.net
  header.from=joe@football.example.com; DOSETA=pass
Received: from mout23.football.example.com (192.168.1.1)
  by shopping.example.net with SMTP;
  Fri, 11 Jul 2003 21:01:59 -0700 (PDT)
DOSETA&amp;nbhy;Signature: v=1; a=rsa-sha256; s=brisbane; d=example.com;
  c=simple/simple; q=dns/txt; i=joe@football.example.com;
  h=Received : From : To : Subject : Date : Message-ID;
  bh=2jUSOH9NhtVGCQWNr9BrIAPreKQjO6Sn7XIkfJVOzv8=;
  b=AuUoFEfDxTDkHlLXSZEpZj79LICEps6eda7W3deTVFOk4yAUoqOB
    4nujc7YopdG5dWLSdNg6xNAZpOPr+kHxt1IrE+NahM6L/LbvaHut
    KVdkLLkpVaVVQPzeRDI009SO2Il5Lu7rDNH6mZckBdrIx0orEtZV
    4bmp/YzhwvcubU4=;
Received: from client1.football.example.com  [192.0.2.1]
  by submitserver.example.com with SUBMISSION;
  Fri, 11 Jul 2003 21:01:54 -0700 (PDT)
From: Joe SixPack &lt;joe@football.example.com&gt;
To: Suzie Q &lt;suzie@shopping.example.net&gt;
Subject: Is dinner ready?
Date: Fri, 11 Jul 2003 21:00:37 -0700 (PDT)
Message-ID: &lt;20030712040037.46341.5F8J@football.example.com&gt;

Hi.

We lost the game. Are you hungry yet?

Joe.</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Successful verification&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Types of Use {rfc4871bis-02 B}</h3>

<p> DOSETA signing and validating can be used in different ways, for
            different operational scenarios. This Appendix discusses some
            common examples. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Descriptions in this Appendix are for
                  informational purposes only. They describe various ways that
                  DOSETA can be used, given particular constraints and needs.
                  In no case are these examples intended to be taken as
                  providing explanation or guidance concerning DOSETA
                  specification details, when creating an implementation.
</dd>
</dl></blockquote>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1"></a><h3>C.1.&nbsp;
Alternate Submission Scenarios</h3>

<p>In the most simple scenario, a user's MUA, MSA, and Internet
               (boundary) MTA are all within the same administrative
               environment, using the same domain name. Therefore, all of the
               components involved in submission and initial transfer are
               related. However, it is common for two or more of the
               components to be under independent administrative control. This
               creates challenges for choosing and administering the domain
               name to use for signing, and for its relationship to common
               email identity Header fields.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.1"></a><h3>C.1.1.&nbsp;
Delegated Business Functions</h3>

<p>Some organizations assign specific business functions to
                  discrete groups, inside or outside the organization. The
                  goal, then, is to authorize that group to sign some mail,
                  but to constrain what signatures they can generate. DOSETA
                  selectors (the "s=" signature tag) facilitate this kind of
                  restricted authorization. Examples of these outsourced
                  business functions are legitimate email marketing providers
                  and corporate benefits providers.
</p>
<p>Here, the delegated group needs to be able to send messages
                  that are signed, using the email domain of the client
                  company. At the same time, the client often is reluctant to
                  register a key for the provider that grants the ability to
                  send messages for arbitrary addresses in the domain.
</p>
<p>There are multiple ways to administer these usage scenarios.
                  In one case, the client organization provides all of the
                  public query service (for example, DNS) administration, and
                  in another it uses DNS delegation to enable all ongoing
                  administration of the DOSETA key record by the delegated
                  group.
</p>
<p>If the client organization retains responsibility for all of
                  the DNS administration, the outsourcing company can generate
                  a key pair, supplying the public key to the client company,
                  which then registers it in the query service, using a unique
                  selector. The client company retains control over the use of
                  the delegated key because it retains the ability to revoke
                  the key at any time.
</p>
<p>If the client wants the delegated group to do the DNS
                  administration, it can have the domain name that is
                  specified with the selector point to the provider's DNS
                  server. The provider then creates and maintains all of the
                  DKIM signature information for that selector. Hence, the
                  client cannot provide constraints on the &lt;local-part&gt;
                  of addresses that get signed, but it can revoke the
                  provider's signing rights by removing the DNS delegation
                  record.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.2"></a><h3>C.1.2.&nbsp;
PDAs and Similar Devices</h3>

<p>PDAs demonstrate the need for using multiple keys per
                  domain. Suppose that John Doe wanted to be able to send
                  messages using his corporate email address,
                  jdoe@example.com, and his email device did not have the
                  ability to make a Virtual Private Network (VPN) connection
                  to the corporate network, either because the device is
                  limited or because there are restrictions enforced by his
                  Internet access provider. If the device was equipped with a
                  private key registered for jdoe@example.com by the
                  administrator of the example.com domain, and appropriate
                  software to sign messages, John could sign the message on
                  the device itself before transmission through the outgoing
                  network of the access service provider.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.3"></a><h3>C.1.3.&nbsp;
Roaming Users</h3>

<p>Roaming users often find themselves in circumstances where
                  it is convenient or necessary to use an SMTP server other
                  than their home server; examples are conferences and many
                  hotels. In such circumstances, a signature that is added by
                  the submission service will use an identity that is
                  different from the user's home system.
</p>
<p>Ideally, roaming users would connect back to their home
                  server using either a VPN or a SUBMISSION server running
                  with SMTP AUTHentication on port 587. If the signing can be
                  performed on the roaming user's laptop, then they can sign
                  before submission, although the risk of further modification
                  is high. If neither of these are possible, these roaming
                  users will not be able to send mail signed using their own
                  domain key.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.4"></a><h3>C.1.4.&nbsp;
Independent (Kiosk) Message Submission</h3>

<p>Stand-alone services, such as walk-up kiosks and web-based
                  information services, have no enduring email service
                  relationship with the user, but users occasionally request
                  that mail be sent on their behalf. For example, a website
                  providing news often allows the reader to forward a copy of
                  the article to a friend. This is typically done using the
                  reader's own email address, to indicate who the author is.
                  This is sometimes referred to as the "Evite problem", named
                  after the website of the same name that allows a user to
                  send invitations to friends.
</p>
<p>A common way this is handled is to continue to put the
                  reader's email address in the From header field of the
                  message, but put an address owned by the email posting site
                  into the Sender header field. The posting site can then sign
                  the message, using the domain that is in the Sender field.
                  This provides useful information to the receiving email
                  site, which is able to correlate the signing domain with the
                  initial submission email role.
</p>
<p>Receiving sites often wish to provide their end users with
                  information about mail that is mediated in this fashion.
                  Although the real efficacy of different approaches is a
                  subject for human factors usability research, one technique
                  that is used is for the verifying system to rewrite the From
                  header field, to indicate the address that was verified. For
                  example: From: John Doe via news@news-site.com
                  &lt;jdoe@example.com&gt;. (Note that such rewriting will
                  break a signature, unless it is done after the verification
                  pass is complete.)
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2"></a><h3>C.2.&nbsp;
Alternate Delivery Scenarios</h3>

<p>Email is often received at a mailbox that has an address
               different from the one used during initial submission. In these
               cases, an intermediary mechanism operates at the address
               originally used and it then passes the message on to the final
               destination. This mediation process presents some challenges
               for DKIM signatures.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.1"></a><h3>C.2.1.&nbsp;
Affinity Addresses</h3>

<p>"Affinity addresses" allow a user to have an email address
                  that remains stable, even as the user moves among different
                  email providers. They are typically associated with college
                  alumni associations, professional organizations, and
                  recreational organizations with which they expect to have a
                  long-term relationship. These domains usually provide
                  forwarding of incoming email, and they often have an
                  associated Web application that authenticates the user and
                  allows the forwarding address to be changed. However, these
                  services usually depend on users sending outgoing messages
                  through their own service providers' MTAs. Hence, mail that
                  is signed with the domain of the affinity address is not
                  signed by an entity that is administered by the organization
                  owning that domain.
</p>
<p>With DOSETA, affinity domains could use the Web application
                  to allow users to register per-user keys to be used to sign
                  messages on behalf of their affinity address. The user would
                  take away the secret half of the key pair for signing, and
                  the affinity domain would publish the public half in DNS for
                  access by verifiers.
</p>
<p>This is another application that takes advantage of
                  user-level keying, and domains used for affinity addresses
                  would typically have a very large number of user-level keys.
                  Alternatively, the affinity domain could handle outgoing
                  mail, operating a mail submission agent that authenticates
                  users before accepting and signing messages for them. This
                  is of course dependent on the user's service provider not
                  blocking the relevant TCP ports used for mail
                  submission.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.2"></a><h3>C.2.2.&nbsp;
Simple Address Aliasing (.forward)</h3>

<p>In some cases a recipient is allowed to configure an email
                  address to cause automatic redirection of email messages
                  from the original address to another, such as through the
                  use of a Unix .forward file. In this case, messages are
                  typically redirected by the mail handling service of the
                  recipient's domain, without modification, except for the
                  addition of a Received header field to the message and a
                  change in the envelope recipient address. In this case, the
                  recipient at the final address' mailbox is likely to be able
                  to verify the original signature since the signed content
                  has not changed, and DOSETA is able to validate the message
                  signature.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.3"></a><h3>C.2.3.&nbsp;
Mailing Lists and Re-Posters</h3>

<p>There is a wide range of behaviors in services that take
                  delivery of a message and then resubmit it. A primary
                  example is with mailing lists (collectively called
                  "forwarders" below), ranging from those that make no
                  modification to the message itself, other than to add a
                  Received header field and change the envelope information,
                  to those that add Header fields, change the Subject header
                  field, add content to the body (typically at the end), or
                  reformat the body in some manner. The simple ones produce
                  messages that are quite similar to the automated alias
                  services. More elaborate systems essentially create a new
                  message.
</p>
<p>A Forwarder that does not modify the body or signed Header
                  fields of a message is likely to maintain the validity of
                  the existing signature. It also could choose to add its own
                  signature to the message.
</p>
<p>Forwarders which modify a message in a way that could make
                  an existing signature invalid are particularly good
                  candidates for adding their own signatures (for example,
                  mailing-list-name@example.net). Since (re-)signing is taking
                  responsibility for the data, these signing forwarders are
                  likely to be selective, and forward or re-sign a message
                  only if it is received with a valid signature or if they
                  have some other basis for knowing that the message is not
                  spoofed.
</p>
<p>A common practice among systems that are primarily
                  redistributors of mail is to add a Sender header field to
                  the message, to identify the address being used to sign the
                  message. This practice will remove any preexisting Sender
                  header field as required by <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. The forwarder applies a new
                  DOSETA&#8209;Signature header field with the signature,
                  public key, and related information of the forwarder.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Acknowledgements</h3>

<p>The previous IETF version of DKIM <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> was edited by: Eric Allman, Jon Callas, Mark
            Delany, Miles Libbey, Jim Fenton and Michael Thomas.
</p>
<p>That specification was the result of an extended, collaborative
            effort, including participation by: Russ Allbery, Edwin Aoki,
            Claus Assmann, Steve Atkins, Rob Austein, Fred Baker, Mark
            Baugher, Steve Bellovin, Nathaniel Borenstein, Dave Crocker,
            Michael Cudahy, Dennis Dayman, Jutta Degener, Frank Ellermann,
            Patrik Faeltstroem, Mark Fanto, Stephen Farrell, Duncan Findlay,
            Elliot Gillum, Olafur Gu[eth]mundsson, Phillip Hallam-Baker, Tony
            Hansen, Sam Hartman, Arvel Hathcock, Amir Herzberg, Paul Hoffman,
            Russ Housley, Craig Hughes, Cullen Jennings, Don Johnsen, Harry
            Katz, Murray S. Kucherawy, Barry Leiba, John Levine, Charles
            Lindsey, Simon Longsdale, David Margrave, Justin Mason, David
            Mayne, Thierry Moreau, Steve Murphy, Russell Nelson, Dave Oran,
            Doug Otis, Shamim Pirzada, Juan Altmayer Pizzorno, Sanjay Pol,
            Blake Ramsdell, Christian Renaud, Scott Renfro, Neil Rerup, Eric
            Rescorla, Dave Rossetti, Hector Santos, Jim Schaad, the
            Spamhaus.org team, Malte S. Stretz, Robert Sanders, Rand Wacker,
            Sam Weiler, and Dan Wing.
</p>
<p> The earlier DomainKeys was a primary source from which DKIM was
            derived. Further information about DomainKeys is at <a class='info' href='#RFC4870'>[RFC4870]<span> (</span><span class='info'>Delany, M., &ldquo;Domain-Based Email Authentication Using Public Keys                   Advertised in the DNS (DomainKeys),&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">D. Crocker (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brandenburg InternetWorking</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">675 Spruce Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.408.246.8253</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">dcrocker@bbiw.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://bbiw.net">http://bbiw.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">M. Kucherawy (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cloudmark</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">128 King St., 2nd Floor</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Francisco, CA  94107</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:msk@cloudmark.com">msk@cloudmark.com</a></td></tr>
</table>
</body></html>
