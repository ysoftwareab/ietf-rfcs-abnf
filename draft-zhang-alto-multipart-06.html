<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Multiple ALTO Resources Query Using Multipart Message</title>
<meta content="Jingxuan Jensen Zhang" name="author">
<meta content="Yang Richard Yang" name="author">
<meta content="
       Many ALTO use cases involve multiple ALTO information resources like different
network maps, cost maps and property maps to achieve their own specific goals.
To make the ALTO client query them one by one is not only inefficient but also
error-prone. The inconsistent responses can be performed because of the unstable
communication environment, and finally conduct the unexpected traffic
optimization. Further more, some ALTO information resources may have
correlation, which means one's input parameters may depends on another one's
response. To address those issues, some advanced query schema is required. This
document proposes an ALTO extension to support the multiple ALTO resources query
in the single request using the HTTP multipart message and the existing JSON
query languages. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="ALTO, Internet-Draft" name="keyword">
<meta content="draft-zhang-alto-multipart-06" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 57.0.0
    six 1.16.0
-->
<link href="/tmp/draft-zhang-alto-multipart-06-zb900jou.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Multipart</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zhang &amp; Yang</td>
<td class="center">Expires 13 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ALTO WG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zhang-alto-multipart-06</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-12" class="published">12 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-13">13 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Zhang</div>
<div class="org">Tongji University</div>
</div>
<div class="author">
      <div class="author-name">Y.R. Yang</div>
<div class="org">Yale University</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Multiple ALTO Resources Query Using Multipart Message</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Many ALTO use cases involve multiple ALTO information resources like different
network maps, cost maps and property maps to achieve their own specific goals.
To make the ALTO client query them one by one is not only inefficient but also
error-prone. The inconsistent responses can be performed because of the unstable
communication environment, and finally conduct the unexpected traffic
optimization. Further more, some ALTO information resources may have
correlation, which means one's input parameters may depends on another one's
response. To address those issues, some advanced query schema is required. This
document proposes an ALTO extension to support the multiple ALTO resources query
in the single request using the HTTP multipart message and the existing JSON
query languages.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-requirements-language-2">
<a href="#name-requirements-language-2" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-note.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-2">
<a href="#name-status-of-this-memo-2" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-2">
<a href="#name-copyright-notice-2" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-2">
<a href="#name-table-of-contents-2" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminologies" class="xref">Terminologies</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-resource-query-entry" class="xref">Resource Query Entry</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-resource-response-entry" class="xref">Resource Response Entry</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-resource-response-entry-bod" class="xref">Resource Response Entry Body</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-use-cases" class="xref">Use Cases</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-simple-batch-query" class="xref">Simple Batch Query</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-properties-constrained-quer" class="xref">Properties Constrained Query</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-path-vector-query" class="xref">Path Vector Query</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-requirements" class="xref">Requirements</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-design-space-of-multipart-r" class="xref">Design Space of Multipart Resource in ALTO</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-multipart-query-resource" class="xref">Multipart Query Resource</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-media-type" class="xref">Media Type</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-http-method" class="xref">HTTP Method</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-capabilities" class="xref">Capabilities</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-accept-input-parameters" class="xref">Accept Input Parameters</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-uses" class="xref">Uses</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-response" class="xref">Response</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-protocol-errors" class="xref">Protocol Errors</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-partial-error" class="xref">Partial Error</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-entire-error" class="xref">Entire Error</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-incremental-update-integrat" class="xref">Incremental Update Integration</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-examples" class="xref">Examples</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-ird-example" class="xref">IRD Example</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-example-1-simple-batch-quer" class="xref">Example 1: Simple Batch Query</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-example-2-properties-constr" class="xref">Example 2: Properties Constrained Query</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-example-3-path-vector-query" class="xref">Example 3: Path Vector Query</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-example-4-incremental-updat" class="xref">Example 4: Incremental Updates</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-compatibility" class="xref">Compatibility</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-compatibility-with-legacy-a" class="xref">Compatibility with Legacy ALTO Clients/Servers</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-compatibility-with-existing" class="xref">Compatibility with Existing Protocol Extensions</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-misc-considerations" class="xref">Misc Considerations</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-return-alto-information-res" class="xref">Return ALTO Information Resources over HTTP/2</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-support-incremental-update" class="xref">Support Incremental Update</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-anonymous-resources" class="xref">Anonymous Resources</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-security-considerations-2" class="xref">Security Considerations</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-application-alto-media-type" class="xref">application/alto-* Media Types</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-references-2" class="xref">References</a></p>
<ul class="ulEmpty ulBare compact toc">
<li class="ulEmpty ulBare compact toc" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-normative-references-2" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty ulBare compact toc" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-informative-references-2" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-figures" class="xref">Figures</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses-2" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Application-Layer Traffic Optimization (ALTO) protocol <span>[<a href="#RFC7285" class="xref">RFC7285</a>]</span> and its
extensions already define several types of information resources, like Network
Map, Cost Map and Property Map, to expose useful network information to
applications. However, many applications do not only use a single information
resource to perform their traffic optimization. Retrieving multiple ALTO
information resources is very common in many ALTO use cases.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Using the current ALTO framework defined in <span>[<a href="#RFC7285" class="xref">RFC7285</a>]</span>, the ALTO client can
only query multiple ALTO information resources one by one. It is not only
inefficient but also error-prone. Because of the network delay between different
requests and the frequent change of ALTO information resources, the responses
received by the ALTO client may be inconsistent.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Furthermore, some ALTO information resources have known dependencies, which
means the ALTO client may need one's response to decide another one's query
input parameters.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">To be summarized, we need the multipart query service for three reasons:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">Clients may want to query multiple ALTO information resources in a single
request to reduce the network latency.<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.2">Clients may want to query multiple ALTO resources consistently, which means
the server should guarantee the responses of all resources are generated at
the same time.<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.3">Some use cases need to query multiple ALTO resources with a joint relationship.<a href="#section-1-5.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-6">This document defines a new ALTO service for: (1) querying multiple ALTO resources
in a single request/response, and (2) supporting general-purpose JSON query
languages to resolve the relational query.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminologies">
<section id="section-2">
      <h2 id="name-terminologies">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminologies" class="section-name selfRef">Terminologies</a>
      </h2>
<p id="section-2-1">Besides the terms defined in <span>[<a href="#RFC2045" class="xref">RFC2045</a>]</span>, <span>[<a href="#RFC2046" class="xref">RFC2046</a>]</span>, <span>[<a href="#RFC2387" class="xref">RFC2387</a>]</span>, and
<span>[<a href="#RFC7285" class="xref">RFC7285</a>]</span>, this document also uses the following additional terms:<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="resource-query-entry">
<section id="section-2.1">
        <h3 id="name-resource-query-entry">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-resource-query-entry" class="section-name selfRef">Resource Query Entry</a>
        </h3>
<p id="section-2.1-1">A Resource Query Entry indicates the ResoureQuery object (see
<a href="#mp-query-params" class="xref">Section 6.4</a>) for an individual resource in the accept input
parameters of the Multipart Query resource.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resource-response-entry">
<section id="section-2.2">
        <h3 id="name-resource-response-entry">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-resource-response-entry" class="section-name selfRef">Resource Response Entry</a>
        </h3>
<p id="section-2.2-1">A Resource Response Entry indicates the entry of an individual part of the
multipart response message, including the MIME headers and the body content.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resource-response-entry-body">
<section id="section-2.3">
        <h3 id="name-resource-response-entry-bod">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-resource-response-entry-bod" class="section-name selfRef">Resource Response Entry Body</a>
        </h3>
<p id="section-2.3-1">A Resource Response Entry Body indicates the body content of a Resource
Response Entry.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="usage">
<section id="section-3">
      <h2 id="name-use-cases">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="section-3-1">The following use cases can benefit from the multipart query service.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="simple-batch-query">
<section id="section-3.1">
        <h3 id="name-simple-batch-query">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-simple-batch-query" class="section-name selfRef">Simple Batch Query</a>
        </h3>
<p id="section-3.1-1">The simplest use case is to query a batch of ALTO resources in a single request.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Although the ALTO client can perform ALTO requests for multiple times, it is
not only inefficient but also inconsistent.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">For example, the ALTO server provides a network map resource A and a dependent
cost map resource B. Both resources may change frequently. Assume the ALTO
client queries the network map first, and it gets the revision A1. When the
client queries the cost map, the network map may be already changed from A1 to
A2, and the client receives cost map B2 which depends on A2 not A1. So the
responded cost map B2 is not consistent with the previous network map A1.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">This case requires the ALTO server to provide a way for the ALTO client to query
multiple ALTO resources in a single transaction.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="properties-constrained-query">
<section id="section-3.2">
        <h3 id="name-properties-constrained-quer">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-properties-constrained-quer" class="section-name selfRef">Properties Constrained Query</a>
        </h3>
<p id="section-3.2-1">Beyond the simple batch query, there are also some another use cases requiring
a new service for relational query. For example, Some clients may need to query
an endpoint property map first, and find endpoints with some properties fitting
some conditions. And then they query the endpoint cost of these endpoints.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In this case, the endpoint cost query depends on the result of the property map
query. Although the ALTO client can cache the whole property map in its local
storage, it is still not efficient and may conduct the consistency issue if the
property map changes frequently. So it requires a new service to provide
multiple dependent resources efficiently and consistently.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">A general multipart query service benefits the ALTO client in two aspects:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">It allows the ALTO client to specify the boolean test to reduce the
transmission of the useless data from the ALTO server.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-4.2">It compounds multiple ALTO information resources in a single response to
reduce the communication times. Thus, the transmission latency can be
reduced.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="path-vector-query">
<section id="section-3.3">
        <h3 id="name-path-vector-query">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-path-vector-query" class="section-name selfRef">Path Vector Query</a>
        </h3>
<p id="section-3.3-1">Another use case requiring the multiple resource query is the relational query
between the on-demand generated resources. A straightforward example is the
path vector query demonstrated in <span>[<a href="#I-D.ietf-alto-path-vector" class="xref">I-D.ietf-alto-path-vector</a>]</span>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2"><span>[<a href="#I-D.ietf-alto-path-vector" class="xref">I-D.ietf-alto-path-vector</a>]</span> introduces an extension of ALTO to provide path
vector information by cost map and unified property map
<span>[<a href="#I-D.ietf-alto-unified-props-new" class="xref">I-D.ietf-alto-unified-props-new</a>]</span>. The client using path vector extension
will usually query cost map and a dynamically generated property map
sequentially. It is even hard to cache the full data of resources, because both
the cost map and the property map are on-demand generated by the query input
here. Thus, the only way to reduce the time consumption is to compound the two
resources.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="requirements">
<section id="section-4">
      <h2 id="name-requirements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-4-1">From the use cases described in <a href="#usage" class="xref">Section 3</a>, there are three additional
requirements for ALTO protocol:<a href="#section-4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-2">
        <dt id="section-4-2.1">MPQ-Req1:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.2">
  The ALTO protocol SHOULD allow the client to query multiple ALTO resources in
a single request, and return the result in a single response.<a href="#section-4-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.3"></dt>
        <dd style="margin-left: 1.5em" id="section-4-2.4">It is the basic requirement to provide the query for the compound resources.
Even simple cases can benefit if this requirement is realized.<a href="#section-4-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.5">MPQ-Req2:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.6">
  The ALTO protocol SHOULD provide general filter schema for any ALTO
resources.<a href="#section-4-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.7"></dt>
        <dd style="margin-left: 1.5em" id="section-4-2.8">Current filter schema in ALTO protocol only supports the simple boolean test
of numerical comparison. And the boolean filtered query is only supported by
the cost map and the endpoint cost resource. It is not enough for the general
cases. Even simple property map may require more general filter schema.<a href="#section-4-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.9">MPQ-Req3:</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.10">
  The ALTO protocol SHOULD support relational query for mulitple joint
resources.<a href="#section-4-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.11"></dt>
        <dd style="margin-left: 1.5em" id="section-4-2.12">Some ALTO resources are relational and cannot be used individually. The path
vector query is such an example. In these use cases, the support of relational
query for multiple joint resources is very helpful.<a href="#section-4-2.12" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="design-space-of-multipart-resource-in-alto">
<section id="section-5">
      <h2 id="name-design-space-of-multipart-r">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-design-space-of-multipart-r" class="section-name selfRef">Design Space of Multipart Resource in ALTO</a>
      </h2>
<p id="section-5-1">This document discusses the solution of how to apply <code>multipart/*</code> (see
<span>[<a href="#RFC2045" class="xref">RFC2045</a>]</span> and <span>[<a href="#RFC2046" class="xref">RFC2046</a>]</span>) response to the ALTO protocol.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">There are three cases applying Multipart response to ALTO:<a href="#section-5-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-3">
        <dt id="section-5-3.1">Multipart Request and Multipart Response:</dt>
        <dd style="margin-left: 1.5em" id="section-5-3.2">
  In this case, an ALTO client can start a single request using Multipart
encoding to query a batch of resources.<a href="#section-5-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-3.3">Single Request and Fixed-Layout Multipart Response:</dt>
        <dd style="margin-left: 1.5em" id="section-5-3.4">
  In this case, an ALTO server receives a non-Multipart request, e.g., the
filtered costmap request or the endpoint cost request, but returns a
Multipart response. The ALTO server MUST export the layout of the Multipart
response in the IRD. A special example can be found in
<span>[<a href="#I-D.ietf-alto-path-vector" class="xref">I-D.ietf-alto-path-vector</a>]</span>.<a href="#section-5-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-3.5">Single Request and Flexible-Layout Multipart Response:</dt>
        <dd style="margin-left: 1.5em" id="section-5-3.6">
  This case extends the previous case to allows the Multipart response with
flexible layout. The ALTO server receives the unified query request and
generate the layout of the response based on the request. The ALTO client can
even use general-purpose query language like XQuery <span>[<a href="#W3CXQUERY" class="xref">W3CXQUERY</a>]</span> and JSONiq
<span>[<a href="#JSONIQ" class="xref">JSONIQ</a>]</span> for general query process and relational joint query.<a href="#section-5-3.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-4">The application about Multipart request to the single object response is out of
the scope of this document.<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multipart-query-resource">
<section id="section-6">
      <h2 id="name-multipart-query-resource">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-multipart-query-resource" class="section-name selfRef">Multipart Query Resource</a>
      </h2>
<div id="media-type">
<section id="section-6.1">
        <h3 id="name-media-type">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-media-type" class="section-name selfRef">Media Type</a>
        </h3>
<p id="section-6.1-1"><code>multipart/related</code> <span>[<a href="#RFC2387" class="xref">RFC2387</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-method">
<section id="section-6.2">
        <h3 id="name-http-method">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-http-method" class="section-name selfRef">HTTP Method</a>
        </h3>
<p id="section-6.2-1">An ALTO Multipart Query resource is requested using the HTTP POST method.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="capabilities">
<section id="section-6.3">
        <h3 id="name-capabilities">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-capabilities" class="section-name selfRef">Capabilities</a>
        </h3>
<p id="section-6.3-1">The capabilities are defined by an object of type MultipartQueryCapabilities:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.3-2">
<pre>
    object {
      JSONString query-langs&lt;0..*&gt;;
    } MultipartQueryCapabilities;
</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3-3">where <code>query-langs</code> is an array of JSONString to indicate which query languages
are supported by this resource.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mp-query-params">
<section id="section-6.4">
        <h3 id="name-accept-input-parameters">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-accept-input-parameters" class="section-name selfRef">Accept Input Parameters</a>
        </h3>
<p id="section-6.4-1">The input parameters for a Multipart Query request are supplied in the entity
body of the POST request. This document specifies the input parameters with
a data format indicated by the media type
<code>application/alto-multipartquery+alto</code>, which is a JSON object of type
ReqMultipartQuery:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.4-2">
<pre>
    object {
      ResourceQuery   resources&lt;1..*&gt;;
      [JsonString     query-lang;]
    } ReqMultipartQuery;

    object {
      JsonString      resource-id;
      [JsonValue      input;]
    } ResourceQuery;
</pre><a href="#section-6.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4-3">with fields:<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.4-4">
          <dt id="section-6.4-4.1">resources:</dt>
          <dd style="margin-left: 1.5em" id="section-6.4-4.2">
  List of ResourceQuery objects for which resources are to be queried and how to
query them. Each ResourceQuery object MUST include the <code>resource-id</code> field to
indicate which resource is to be queried. If the queried resource requires the
POST method, the <code>input</code> field MUST be specified. The value of the <code>input</code>
field MUST be either a JSONString or a JSONObject. When its value is a
JSONObject, its format MUST be as the accept input parameters of its resource.
When its value is a JSONString, it MUST be a program written in the query
language specified by the <code>query-lang</code> field.<a href="#section-6.4-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-4.3">query-lang:</dt>
          <dd style="margin-left: 1.5em" id="section-6.4-4.4">
  Optional. The value of the <code>query-lang</code> field MUST be one of values in the
<code>query-langs</code> capability. If this field is not specified in the request, the
ALTO client SHOULD NOT use any query language in the <code>input</code> field.<a href="#section-6.4-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="uses">
<section id="section-6.5">
        <h3 id="name-uses">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-uses" class="section-name selfRef">Uses</a>
        </h3>
<p id="section-6.5-1">An array with the resource ID(s) of resource(s) which this multipart query
resource can compound. The used resource can be any available ALTO resources
except for the multipart query resource. If the <code>uses</code> field is not specified,
all the available ALTO resources can be queried except for the multipart query
resource.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response">
<section id="section-6.6">
        <h3 id="name-response">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-response" class="section-name selfRef">Response</a>
        </h3>
<p id="section-6.6-1">The response of multipart query resource is a multipart message. Each part of
this multipart message is the response of a queried resource in the request.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-errors">
<section id="section-7">
      <h2 id="name-protocol-errors">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-protocol-errors" class="section-name selfRef">Protocol Errors</a>
      </h2>
<p id="section-7-1">At the top level, the request of ALTO Multipart Query resource may conduct two
types of errors: Partial Error and Entire Error.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="partial-error">
<section id="section-7.1">
        <h3 id="name-partial-error">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-partial-error" class="section-name selfRef">Partial Error</a>
        </h3>
<p id="section-7.1-1">The Partial Error only occurs when the value of the <code>resource-id</code> field or the
<code>input</code> field is invalid.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">When the Partial Error occurs, the ALTO server MUST still return the response in
the media type <code>multipart/related</code>. For the resource query entry with an error,
the ALTO server MUST specify the <code>Content-Type</code> of its resource response entry
as <code>application/alto-error+json</code>, and include the ALTO error message in its
resource response entry body. For the resource query entry without any error,
the ALTO server MUST perform its query request normally.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">The value of the <code>resource-id</code> field is invalid when this resource id is not
defined by the Information Resource Directory. In this case, the ALTO server
MUST return the E_INVALID_FIELD_VALUE error.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">The validation of each <code>input</code> field of the multipart query input parameters
depends on the queried resource:<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-5.1">If the <code>input</code> field of the multipart query input parameters is neither
a JSONObject nor a JSONString, the ALTO server SHOULD return the
E_INVALID_FIELD_TYPE error, unless a future protocol extension supports the
non-JSONObject input parameters.<a href="#section-7.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-5.2">If the <code>input</code> field of the multipart query input parameters is a JSONObject,
the ALTO server MUST validate the value using its queried resource and return
the corresponding error if it has.<a href="#section-7.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-5.3">
            <p id="section-7.1-5.3.1">If the <code>input</code> field of the multipart query input parameters is a JSONString:<a href="#section-7.1-5.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-5.3.2.1">If the <code>query-lang</code> is not specified, the ALTO server MUST return the
E_INVALID_FIELD_TYPE error.<a href="#section-7.1-5.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.1-5.3.2.2">If the <code>query-lang</code> is specified, the ALTO server MUST execute this
JSONString as a program written in the <code>query-lang</code>. If the execution
failed, the ALTO server MUST return the E_INVALID_FIELD_VALUE error. If
the execution succeeds but the result fails to pass the validation of the
queried resource, the ALTO server MUST return the E_INVALID_FIELD_VALUE
error and attach the error message returned by the queried resource into
the <code>message</code> field of the ALTO error message.<a href="#section-7.1-5.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-7.1-6">The syntax error is an Entire Error.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entire-error">
<section id="section-7.2">
        <h3 id="name-entire-error">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-entire-error" class="section-name selfRef">Entire Error</a>
        </h3>
<p id="section-7.2-1">Any other invalid request will conduct the Entire Error.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">When the Entire Error occurs, the ALTO server MUST return the error response in
the media type <code>application/alto-error+json</code> instead of <code>multipart/related</code>. The
process of the Entire Error is as defined in Section 8.5 of <span>[<a href="#RFC7285" class="xref">RFC7285</a>]</span>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="incremental-update-integration">
<section id="section-8">
      <h2 id="name-incremental-update-integrat">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-incremental-update-integrat" class="section-name selfRef">Incremental Update Integration</a>
      </h2>
<p id="section-8-1">This document defines a compatible incremental update process for Multipart
Query resource with <span>[<a href="#RFC8895" class="xref">RFC8895</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">An ALTO server's IRD can export an Update Stream service defined in
<span>[<a href="#RFC8895" class="xref">RFC8895</a>]</span> including the Resource ID of a Multipart
Query resource in the <code>uses</code> field. When an ALTO client subscribes the
incremental update for this Multipart Query resource, the ALTO server sends the
whole Multipart response message back at the first data update message. Then
the ALTO server subscribes all nodes in this multipart resource tree
automatically. Once data updated later, the ALTO server publishes the update
for each node individually.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-9">
      <h2 id="name-examples">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="ird-example">
<section id="section-9.1">
        <h3 id="name-ird-example">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-ird-example" class="section-name selfRef">IRD Example</a>
        </h3>
<p id="section-9.1-1">Assume the root IRD is like the following:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.1-2">
<pre>
  {
    "meta": {
        "path-vector": {
          "cost-mode": "array",
          "cost-metric": "ane-path"
        },
        "num-routingcost": {
          "cost-mode": "numerical",
          "cost-metric": "routingcost"
        },
        "num-hopcount": {
          "cost-mode": "numerical",
          "cost-metric": "hopcount"
        }
    },
    "resources": {
      "my-default-networkmap": {
        "uri": "https://alto.example.com/networkmap",
        "media-type": "application/alto-networkmap+json"
      },
      "my-default-costmap": {
        "uri": "https://alto.example.com/costmap",
        "media-type": "application/alto-costmap+json",
        "capabilities": {
          "cost-type-names": [ "num-routingcost" ]
        },
        "uses": [ "my-default-networkmap" ]
      },
      "my-filtered-costmap": {
        "uri": "https://alto.example.com/costmap/filtered",
        "media-type": "application/alto-costmap+json",
        "accepts": "application/alto-costmapfilter+json",
        "capabilities": {
          "cost-type-names": [ "num-hopcount" ]
        },
        "uses": [ "my-default-networkmap" ]
      },
      "endpoint-path-vector": {
        "uri": "https://alto.exmaple.com/endpointcost",
        "media-type": "application/alto-endpointcost+json",
        "accepts": "application/alto-endpointcostparams+json",
        "capabilities": {
          "cost-constraints": true,
          "cost-type-names": [ "path-vector" ],
        },
        "property-map": "propmap-availbw"
      },
      "propmap-availbw-delay": {
        "uri": "https://alto.exmaple.com/propmap/availbw",
        "media-type": "application/alto-propmap+json",
        "accepts": "application/alto-propmapparams+json",
        "uses": [ "endpoint-path-vector" ],
        "capabilities": {
          "mappings": {
            "endpoint-path-vector.ane": [ "availbw" ]
          }
        }
      },
      "propmap-location": {
        "uri": "https://alto.exmaple.com/propmap/location",
        "media-type": "application/alto-propmap+json",
        "accepts": "application/alto-propmapparams+json",
        "uses": [ "my-default-networkmap" ],
        "capabilities": {
          "mappings": {
            "my-default-networkmap.pid": [ "country", "state" ]
          }
        }
      },
      "multipart-query": {
        "uri": "https://alto.example.com/multipart",
        "media-type": "multipart/related",
        "accepts": "application/alto-multipartquery+json",
        "capabilities": {
          "query-langs": [ "xquery", "jsoniq" ]
        }
      },
      "update-multipart-query": {
        "uri": "https://alto.example.com/updates/multipart",
        "media-type": "text/event-stream",
        "uses": [ "multipart-query" ],
        "accepts": "application/alto-updatestreamparams+json",
        "capabilities": {
          "incremental-change-media-types": {
            "multipart-query": "application/merge-patch+json"
          },
          "support-stream-control": true
        }
      }
    }
  }
</pre><a href="#section-9.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-1-simple-batch-query">
<section id="section-9.2">
        <h3 id="name-example-1-simple-batch-quer">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-example-1-simple-batch-quer" class="section-name selfRef">Example 1: Simple Batch Query</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-9.2-1">
<pre>
POST /multipart HTTP/1.1
Host: alto.example.com
Accept: multipart/related, application/alto-error+json
Content-Lenght: TBD
Content-Type: application/alto-multipartquery+json

{
  "resources": [
    {
      "resource-id": "my-default-networkmap"
    },
    {
      "resource-id": "my-default-costmap"
    }
  ]
}
</pre><a href="#section-9.2-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-9.2-2">
<pre>
HTTP/1.1 200 OK
Content-Lenght: TBD
Content-Type: multipart/related; boundary=simple-batch-query

--simple-batch-query
Content-ID: my-default-networkmap
Content-Type: application/alto-networkmap+json

{
  "meta": {
    "vtag": {
      "resource-id": "my-default-networkmap",
      "tag": "75ed013b3cb58f896e839582504f622838ce670f"
    }
  },
  "network-map": {
    "PID1" : {
      "ipv4" : [
        "192.0.2.0/24",
        "198.51.100.0/25"
      ]
    },
    "PID2" : {
      "ipv4" : [
        "198.51.100.128/25"
      ]
    },
    "PID3" : {
      "ipv4" : [
        "0.0.0.0/0"
      ],
      "ipv6" : [
        "::/0"
      ]
    }
  }
}

--simple-batch-query
Content-ID: my-default-costmap
Content-Type: application/alto-costmap+json

{
  "meta": {
    "dependent-vtags": [
      {
        "resource-id": "my-default-networkmap",
        "tag": "75ed013b3cb58f896e839582504f622838ce670f"
      }
    ],
    "cost-type": {
      "cost-mode": "numerical",
      "cost-metric": "routingcost"
    }
  },
  "cost-map": {
    "PID1": { "PID1": 1,  "PID2": 5,  "PID3": 10 },
    "PID2": { "PID1": 5,  "PID2": 1,  "PID3": 15 },
    "PID3": { "PID1": 20, "PID2": 15  }
  }
}
--simple-batch-query
</pre><a href="#section-9.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-2-properties-constrained-query">
<section id="section-9.3">
        <h3 id="name-example-2-properties-constr">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-example-2-properties-constr" class="section-name selfRef">Example 2: Properties Constrained Query</a>
        </h3>
<p id="section-9.3-1">NOTE: In this example, we use the "`" block to express the raw string with
unescaped characters like <code>\n</code> and <code>\"</code>. It is not a valid HTTP body, but only
used to better present. When the request is sent to the ALTO server, the "`"
block should be escaped.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.3-2">
<pre>
POST /multipart HTTP/1.1
Host: alto.example.com
Accept: multipart/related, application/alto-error+json
Content-Lenght: TBD
Content-Type: application/alto-multipartquery+json

{
  "query-lang": "jsoniq",
  "resources": [
    {
      "resource-id": "propmap-location"
    },
    {
      "resource-id": "my-default-costmap",
      "input": `
        let $propmap := collection("propmap-location")
                        .("property-map")
        return {
          "cost-type": {
            "cost-mode": "numerical",
            "cost-metric": "hopcount"
          },
          "pids": {
            "srcs": [
              for $pid in keys($propmap)
              where $propmap.$pid.country eq "US"
              return substring-after($pid, "PID:")
            ],
            "dsts": [
              for $pid in keys($propmap)
              where $propmap.$pid.country eq "CA"
              return substring-after($pid, "PID:")
            ]
          }
        }
      `
    }
  ]
}
</pre><a href="#section-9.3-2" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-9.3-3">
<pre>
HTTP/1.1 200 OK
Content-Lenght: TBD
Content-Type: multipart/related; boundary=prop-const-query

--prop-const-query
Content-ID: propmap-location
Content-Type: application/alto-propmap+json

{
  "property-map": {
    "pid:PID1": {
      "country": "US",
      "state": "CA"
    },
    "pid:PID2": {
      "country": "US",
      "state": "CT"
    },
    "pid:PID3": {
      "country": "CA",
      "state": "QC"
    },
    "pid:PID4": {
      "country": "CA",
      "state": "NT"
    },
    "pid:PID5": {
      "country": "FR"
    }
  }
}

--prop-const-query
Content-ID: my-default-costmap
Content-Type: application/alto-costmap+json

{
  "meta": {
    "cost-type": {
      "cost-mode": "numerical",
      "cost-metric": "hopcount"
    }
  },
  "cost-map": {
    "PID1": {
      "PID3": 5,
      "PID4": 7
    },
    "PID2": {
      "PID3": 8,
      "PID4": 4
    }
  }
}
--prop-const-query
</pre><a href="#section-9.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-3-path-vector-query">
<section id="section-9.4">
        <h3 id="name-example-3-path-vector-query">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-example-3-path-vector-query" class="section-name selfRef">Example 3: Path Vector Query</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-9.4-1">
<pre>
POST /multipart HTTP/1.1
Host: alto.example.com
Accept: multipart/related, application/alto-error+json
Content-Lenght: TBD
Content-Type: application/alto-multipartquery+json

{
  "query-lang": "jsoniq",
  "resources": [
    {
      "resource-id": "endpoint-path-vector",
      "input": {
        "cost-type": {
          "cost-mode": "array",
          "cost-metric": "ane-path"
        },
        "endpoints": {
          "srcs": [ "ipv4:192.0.2.2" ],
          "dsts": [ "ipv4:192.0.2.89",
                    "ipv4:203.0.113.45" ]
        }
      }
    },
    {
      "resource-id": "propmap-availbw",
      "input": `
        let $propmap := collection("endpiont-path-vector")
                        .("endpoint-cost-map")
        return {
          "entities": [
            distinct-values(flatten(
              for $src in keys($propmap)
              let $dsts := $propmap.$src
              return flatten(
                for $dst in keys($dsts)
                return $dsts.$dst
              )
            ))
          ],
          "properties": [ "availbw" ]
        }
      `
    }
  ]
}
</pre><a href="#section-9.4-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-9.4-2">
<pre>
HTTP/1.1 200 OK
Content-Length: TBD
Content-Type: multipart/related; boundary=path-vector-query

--path-vector-query
Content-ID: endpoint-path-vector
Content-Type: application/alto-endpointcost+json

{
  "meta": {
    "cost-type": {
      "cost-mode": "array",
      "cost-metric": "ane-path"
    }
  },
  "endpoint-cost-map": {
    "ipv4:192.0.2.2": {
      "ipv4:192.0.2.89":   [ "ane:L001", "ane:L003", "ane:L004" ],
      "ipv4:203.0.113.45": [ "ane:L001", "ane:L004", "ane:L005" ],
      "ipv6:2001:db8::10": [ "ane:L001", "ane:L005", "ane:L007" ]
    }
  }
}

--path-vector-query
Content-ID: propmap-availbw
Content-Type: application/alto-propmap+json

{
  "property-map": {
    "ane:L001": { "availbw": 50 },
    "ane:L003": { "availbw": 48 },
    "ane:L004": { "availbw": 55 },
    "ane:L005": { "availbw": 60 },
    "ane:L007": { "availbw": 35 }
  }
}
--path-vector-query
</pre><a href="#section-9.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-4-incremental-updates">
<section id="section-9.5">
        <h3 id="name-example-4-incremental-updat">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-example-4-incremental-updat" class="section-name selfRef">Example 4: Incremental Updates</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-9.5-1">
<pre>
POST /updates/multipart
Host: alto.example.com
Accept: text/event-stream,application/alto-error+json
Content-Length: TBD
Content-Type: application/alto-updatestreamparams+json

{
  "add": {
    "multipart-query": {
      "resource-id": "multipart-query",
      "input": {
        "resources": [
          {
            "resource-id": "my-default-networkmap"
          },
          {
            "resource-id": "my-default-costmap"
          }
        ]
      }
    }
  }
}
</pre><a href="#section-9.5-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-9.5-2">
<pre>
HTTP/1.1 200 OK
Connection: keep-alive
Content-Type: text/event-stream

event: application/alto-updatestreamcontrol+json
data: {"control-uri":
data:  "https://alto.example.com/updates/streams/1414"}

event: multipart/related;boundary=example-update,multipart-query
data: --simple-batch-query
data: Content-ID: netmap
data: Content-Type: application/alto-networkmap+json
data:
data: { ... data (object) of network map ... }
data:
data: --simple-batch-query
data: Content-ID: costmap
data: Content-Type: application/alto-costmap+json
data:
data: { .. data (object) of cost map ... }
data: --simple-batch-query

   (pause)

event: application/merge-patch+json,multipart-query.netmap
data: { ... merge patch for updates of network map ... }

event: application/merge-patch+json,multipart-query.costmap
data: { ... merge patch for updates of cost map ... }
</pre><a href="#section-9.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="compatibility">
<section id="section-10">
      <h2 id="name-compatibility">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-compatibility" class="section-name selfRef">Compatibility</a>
      </h2>
<div id="compatibility-with-legacy-alto-clientsservers">
<section id="section-10.1">
        <h3 id="name-compatibility-with-legacy-a">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-compatibility-with-legacy-a" class="section-name selfRef">Compatibility with Legacy ALTO Clients/Servers</a>
        </h3>
<p id="section-10.1-1">The multipart query service is a new ALTO service using the new media type. So
the legacy ALTO client cannot identify this service from the IRD of the ALTO
server supporting it. And the legacy ALTO server also cannot interpret the
request of a multipart query service sent by the ALTO client.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compatibility-with-existing-protocol-extensions">
<section id="section-10.2">
        <h3 id="name-compatibility-with-existing">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-compatibility-with-existing" class="section-name selfRef">Compatibility with Existing Protocol Extensions</a>
        </h3>
<p id="section-10.2-1">The multipart query service can use any ALTO resources exchanging JSON data in
request/response mechanism. So all the known ALTO extensions like ALTO Calendar
<span>[<a href="#RFC8896" class="xref">RFC8896</a>]</span>, Multi-Cost <span>[<a href="#RFC8189" class="xref">RFC8189</a>]</span> and the Path Vector
<span>[<a href="#I-D.ietf-alto-path-vector" class="xref">I-D.ietf-alto-path-vector</a>]</span> extension, which does not change the
request/response mechanism, are compatible with the multipart query service.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="misc-considerations">
<section id="section-11">
      <h2 id="name-misc-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-misc-considerations" class="section-name selfRef">Misc Considerations</a>
      </h2>
<div id="return-alto-information-resources-over-http2">
<section id="section-11.1">
        <h3 id="name-return-alto-information-res">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-return-alto-information-res" class="section-name selfRef">Return ALTO Information Resources over HTTP/2</a>
        </h3>
<p id="section-11.1-1">HTTP/2 <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span> provides new features like streams and multiplexing that
can essentially reduce the web interface communication latency. As the growth
of deployment of HTTP/2, it is valuable to consider how to transit the ALTO
information resources over HTTP/2.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">The multipart query service defined in this document includes two parts: the
multiple-resource query schema and the multipart response schema.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">By leveraging HTTP/2 multiplexing in the scope of this document, the
multipart response schema can be replaced with sending multiple HTTP/2
streams using HTTP/2 server push. Each stream only needs to include a single
ALTO information resource. The benefit is that the Server can include
additional meta information in the HTTP HEADERS frame of each stream. And the
Client can parse each ALTO information resource in parallel.
However, the multiple-resource query schema is required to be reused to keep
the consistent request semantics. If the Client wants to receive consistent
query results, it should send a single multiple-resource query request over
the HTTP/2 stream to enforce the Server to generate the response to
different ALTO information resources based on the same database snapshot.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="support-incremental-update">
<section id="section-11.2">
        <h3 id="name-support-incremental-update">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-support-incremental-update" class="section-name selfRef">Support Incremental Update</a>
        </h3>
<p id="section-11.2-1">According to Section 5.2 of <span>[<a href="#RFC8895" class="xref">RFC8895</a>]</span>, the update
stream service can use concatenation of the substream-id, the '.' separator
and a Content-ID to identify the update to each part of a multipart response.
Thus, each part of a multiple-resource query response MUST include a
Content-ID, if the Server provides an update stream service defined in
<span>[<a href="#RFC8895" class="xref">RFC8895</a>]</span> for this multiple-resource query service.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="anonymous-resources">
<section id="section-11.3">
        <h3 id="name-anonymous-resources">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-anonymous-resources" class="section-name selfRef">Anonymous Resources</a>
        </h3>
<p id="section-11.3-1">Some use cases may need the server to generate "anonymous" ALTO resources for the
on-demand information. The "anonymous" ALTO resources usually cannot appear
alone but need to bind with some "non-anonymous" ALTO resources.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations-2">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations-2" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">Allow the ALTO clients to upload the query language script may not be safe. The
code injection and many potential attacks can be conducted. The security issue
should be discussed and considered.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">To avoid the attacks like the code injection, this document recommends the
following approaches:<a href="#section-12-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12-3">
        <dt id="section-12-3.1">Database Isolation:</dt>
        <dd style="margin-left: 1.5em" id="section-12-3.2">
  Some clients may attempt to access the secure database inside the server.
Isolate the data into the different databases can reduce the risk of the
information leak.<a href="#section-12-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-12-3.3">Application Container Isolation:</dt>
        <dd style="margin-left: 1.5em" id="section-12-3.4">
  Attackers may inject harmful code into the input query programs to attempt to
access the system control. To avoid this, each query process is recommended to
be isolated using the application container.<a href="#section-12-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-12-3.5">Resource Limit:</dt>
        <dd style="margin-left: 1.5em" id="section-12-3.6">
  Even attackers cannot get the permission to crack the data or the system, they
can still inject some heavy-load programs to consume the server resources.
Thus, limiting the memory usage and execution time of each query process is
highly recommended.<a href="#section-12-3.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-considerations">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="applicationalto-media-types">
<section id="section-13.1">
        <h3 id="name-application-alto-media-type">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-application-alto-media-type" class="section-name selfRef">application/alto-* Media Types</a>
        </h3>
<p id="section-13.1-1">This document registers an additional ALTO media type, listed in <a href="#tbl-media-types" class="xref">Table 1</a>.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<span id="name-additional-alto-media-type"></span><div id="tbl-media-types">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-additional-alto-media-type" class="selfRef">Additional ALTO Media Type.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Subtype</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application</td>
              <td class="text-left" rowspan="1" colspan="1">alto-multipartquery+json</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#mp-query-params" class="xref">Section 6.4</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-13.1-3">
          <dt id="section-13.1-3.1">Type name:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.2">
  application<a href="#section-13.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.3">Subtype name:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.4">
  This document registers multiple subtypes, as listed in <a href="#tbl-media-types" class="xref">Table 1</a>.<a href="#section-13.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.5">Required parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.6">
  n/a<a href="#section-13.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.7">Optional parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.8">
  n/a<a href="#section-13.1-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.9">Encoding considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.10">
  Encoding considerations are identical to those specified for the
<code>application/json</code> media type. See <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span>.<a href="#section-13.1-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.11">Security considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.12">
  Security considerations related to the generation and consumption of ALTO
Protocol messages are discussed in Section 15 of <span>[<a href="#RFC7285" class="xref">RFC7285</a>]</span>.<a href="#section-13.1-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.13">Interoperability considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.14">
  This document specifies formats of conforming messages and the interpretation
thereof.<a href="#section-13.1-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.15">Published specification:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.16">
  This document is the specification for these media types; see
<a href="#tbl-media-types" class="xref">Table 1</a> for the section documenting each media type.<a href="#section-13.1-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.17">Applications that use this media type:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.18">
  ALTO servers and ALTO clients either stand alone or are embedded within other
applications.<a href="#section-13.1-3.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.19">Additional information:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.20">
            <span class="break"></span><dl class="dlParallel" id="section-13.1-3.20.1">
              <dt id="section-13.1-3.20.1.1">Magic number(s):</dt>
              <dd style="margin-left: 1.5em" id="section-13.1-3.20.1.2">
        n/a<a href="#section-13.1-3.20.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-13.1-3.20.1.3">File extension(s):</dt>
              <dd style="margin-left: 1.5em" id="section-13.1-3.20.1.4">
        This document uses the mime type to refer to protocol messages and thus does
not require a file extension.<a href="#section-13.1-3.20.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-13.1-3.20.1.5">Macintosh file type code(s):</dt>
              <dd style="margin-left: 1.5em" id="section-13.1-3.20.1.6">
        n/a<a href="#section-13.1-3.20.1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.21">Person &amp; email address to contact for further information:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.22">
  See Authors' Addresses section.<a href="#section-13.1-3.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.23">Intended usage:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.24">
  COMMON<a href="#section-13.1-3.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.25">Restrictions on usage:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.26">
  n/a<a href="#section-13.1-3.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.27">Author:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.28">
  See Authors' Addresses section.<a href="#section-13.1-3.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-13.1-3.29">Change controller:</dt>
          <dd style="margin-left: 1.5em" id="section-13.1-3.30">
  Internet Engineering Task Force (mailto:iesg@ietf.org).<a href="#section-13.1-3.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-14">
      <h2 id="name-acknowledgements">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
    </h2>
</section>
</div>
<section id="section-15">
      <h2 id="name-references-2">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references-2" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references-2">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references-2" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2387">[RFC2387]</dt>
        <dd>
<span class="refAuthor">Levinson, E.</span>, <span class="refTitle">"The MIME Multipart/Related Content-type"</span>, <span class="seriesInfo">RFC 2387</span>, <span class="seriesInfo">DOI 10.17487/RFC2387</span>, <time datetime="1998-08" class="refDate">August 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2387">https://www.rfc-editor.org/info/rfc2387</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7285">[RFC7285]</dt>
        <dd>
<span class="refAuthor">Alimi, R., Ed.</span>, <span class="refAuthor">Penno, R., Ed.</span>, <span class="refAuthor">Yang, Y., Ed.</span>, <span class="refAuthor">Kiesel, S.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Roome, W.</span>, <span class="refAuthor">Shalunov, S.</span>, and <span class="refAuthor">R. Woundy</span>, <span class="refTitle">"Application-Layer Traffic Optimization (ALTO) Protocol"</span>, <span class="seriesInfo">RFC 7285</span>, <span class="seriesInfo">DOI 10.17487/RFC7285</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7285">https://www.rfc-editor.org/info/rfc7285</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7540">[RFC7540]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span>, <span class="refAuthor">Peon, R.</span>, and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8895">[RFC8895]</dt>
      <dd>
<span class="refAuthor">Roome, W.</span> and <span class="refAuthor">Y. Yang</span>, <span class="refTitle">"Application-Layer Traffic Optimization (ALTO) Incremental Updates Using Server-Sent Events (SSE)"</span>, <span class="seriesInfo">RFC 8895</span>, <span class="seriesInfo">DOI 10.17487/RFC8895</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8895">https://www.rfc-editor.org/info/rfc8895</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references-2">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references-2" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-alto-path-vector">[I-D.ietf-alto-path-vector]</dt>
        <dd>
<span class="refAuthor">Gao, K.</span>, <span class="refAuthor">Lee, Y.</span>, <span class="refAuthor">Randriamasy, S.</span>, <span class="refAuthor">Yang, Y. R.</span>, and <span class="refAuthor">J. J. Zhang</span>, <span class="refTitle">"ALTO Extension: Path Vector"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-alto-path-vector-14</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-alto-path-vector-14.txt">https://www.ietf.org/archive/id/draft-ietf-alto-path-vector-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-alto-unified-props-new">[I-D.ietf-alto-unified-props-new]</dt>
        <dd>
<span class="refAuthor">Roome, W.</span>, <span class="refAuthor">Randriamasy, S.</span>, <span class="refAuthor">Yang, Y. R.</span>, <span class="refAuthor">Zhang, J. J.</span>, and <span class="refAuthor">K. Gao</span>, <span class="refTitle">"ALTO Extension: Entity Property Maps"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-alto-unified-props-new-17</span>, <time datetime="2021-04-16" class="refDate">16 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-alto-unified-props-new-17.txt">https://www.ietf.org/archive/id/draft-ietf-alto-unified-props-new-17.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JSONIQ">[JSONIQ]</dt>
        <dd>
<span class="refAuthor">Robie, J.</span>, <span class="refAuthor">Fourny, G.</span>, <span class="refAuthor">Brantner, M.</span>, <span class="refAuthor">Florescu, D.</span>, <span class="refAuthor">Westmann, T.</span>, and <span class="refAuthor">M. Zaharioudakis</span>, <span class="refTitle">"JSONiq - the SQL of NoSQL 1.0"</span>, <span class="seriesInfo">JSONiq </span>, <time datetime="2015" class="refDate">2015</time>. </dd>
<dd class="break"></dd>
<dt id="RFC8189">[RFC8189]</dt>
        <dd>
<span class="refAuthor">Randriamasy, S.</span>, <span class="refAuthor">Roome, W.</span>, and <span class="refAuthor">N. Schwan</span>, <span class="refTitle">"Multi-Cost Application-Layer Traffic Optimization (ALTO)"</span>, <span class="seriesInfo">RFC 8189</span>, <span class="seriesInfo">DOI 10.17487/RFC8189</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8189">https://www.rfc-editor.org/info/rfc8189</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8896">[RFC8896]</dt>
        <dd>
<span class="refAuthor">Randriamasy, S.</span>, <span class="refAuthor">Yang, R.</span>, <span class="refAuthor">Wu, Q.</span>, <span class="refAuthor">Deng, L.</span>, and <span class="refAuthor">N. Schwan</span>, <span class="refTitle">"Application-Layer Traffic Optimization (ALTO) Cost Calendar"</span>, <span class="seriesInfo">RFC 8896</span>, <span class="seriesInfo">DOI 10.17487/RFC8896</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8896">https://www.rfc-editor.org/info/rfc8896</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3CXQUERY">[W3CXQUERY]</dt>
      <dd>
<span class="refAuthor">Robie, J.</span>, <span class="refAuthor">Chamberlin, D.</span>, <span class="refAuthor">Dyck, M.</span>, and <span class="refAuthor">J. Snelson</span>, <span class="refTitle">"XQuery 3.0: An XML query language"</span>, <span class="seriesInfo">W3C Recommendation, W3C</span>, <time datetime="2014" class="refDate">2014</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="figures">
<section id="appendix-A">
      <h2 id="name-figures">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-figures" class="section-name selfRef">Figures</a>
      </h2>
<p id="appendix-A-1">TODO: Put additional figures here if we have.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses-2">
<a href="#name-authors-addresses-2" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jingxuan Jensen Zhang</span></div>
<div dir="auto" class="left"><span class="org">Tongji University</span></div>
<div dir="auto" class="left"><span class="street-address">4800 Cao'An Hwy</span></div>
<div dir="auto" class="left"><span class="locality">Shanghai</span></div>
<div dir="auto" class="left"><span class="postal-code">201804</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jingxuan.n.zhang@gmail.com" class="email">jingxuan.n.zhang@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yang Richard Yang</span></div>
<div dir="auto" class="left"><span class="org">Yale University</span></div>
<div dir="auto" class="left"><span class="street-address">51 Prospect Street</span></div>
<div dir="auto" class="left">
<span class="locality">New Haven</span>,  <span class="postal-code">CT</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yry@cs.yale.edu" class="email">yry@cs.yale.edu</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
