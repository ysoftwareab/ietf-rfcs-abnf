I_message = HDR, T, RAND, [IDi], IDr,
               {SP}, DHi, KEMAC
                    ----------------------->   R_message = HDR, T,
                                                [IDr], IDi, DHr,
                                                DHi, KEMAC
                    <----------------------


      Figure 1: HMAC-authenticated Diffie-Hellman key-based exchange,
        where xi and xr are (pseudo) randomly chosen, respectively,
                    by the initiator and the responder.

I_message = HDR, T, [IDi], IDr,
               {SP}, [DHi], KEMAC
                    ----------------------->   R_message = HDR, T,
                                                [IDr], IDi,
                                                [DHr, DHi], KEMAC
                    <----------------------

                      Figure 2: DHHMAC update message

