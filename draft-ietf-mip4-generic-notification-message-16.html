<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Generic Notification Message for Mobile IPv4</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Generic Notification Message for Mobile IPv4">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">MIP4 Working Group</td><td class="header">H. Deng</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">China Mobile</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">H. Levkowetz</td></tr>
<tr><td class="header">Expires: April 28, 2011</td><td class="header">Netnod</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">V. Devarapalli</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">WiChorus</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Gundavelli</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. Haley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Hewlett-Packard Company</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 25, 2010</td></tr>
</table></td></tr></table>
<h1><br />Generic Notification Message for Mobile IPv4<br />draft-ietf-mip4-generic-notification-message-16</h1>

<h3>Abstract</h3>

<p>This document specifies protocol enhancements that allow Mobile IPv4
	    entities to send and receive explicit notification messages using a
	    Mobile IPv4 message type designed for this purpose.
	 
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 28, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#sect.intro">1.</a>&nbsp;
Introduction<br />
<a href="#sect.term">2.</a>&nbsp;
Terminology<br />
<a href="#sect.usage">3.</a>&nbsp;
Notification Message - Usage Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.usage.examples">3.1.</a>&nbsp;
Notification Message - Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.scen.topology">3.2.</a>&nbsp;
Notification Message - Topology<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.ha2mn">3.2.1.</a>&nbsp;
Notification Message between a Home Agent and a Mobile Node<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.fa2mn">3.2.2.</a>&nbsp;
Notification Message between a Foreign Agent and a Mobile Node<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.ha2fa">3.2.3.</a>&nbsp;
Notification Message between a Home Agent and a Foreign Agent<br />
<a href="#sect.message">4.</a>&nbsp;
Generic Notification Message and Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.gnm.definition">4.1.</a>&nbsp;
Generic Notification Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.gnam">4.2.</a>&nbsp;
Generic Notification Acknowledgment Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.gnm.retrans">4.3.</a>&nbsp;
Notification Retransmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">4.4.</a>&nbsp;
General Implementation Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">4.5.</a>&nbsp;
Mobile Node Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.5.1.</a>&nbsp;
Receiving Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.5.2.</a>&nbsp;
Sending Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.5.3.</a>&nbsp;
Sending Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.5.4.</a>&nbsp;
Receiving Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.6.</a>&nbsp;
Foreign Agent Consideration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.6.1.</a>&nbsp;
Receiving Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.6.2.</a>&nbsp;
Sending Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.6.3.</a>&nbsp;
Sending Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.6.4.</a>&nbsp;
Receiving Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.7.</a>&nbsp;
Home Agent Consideration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.7.1.</a>&nbsp;
Sending Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.7.2.</a>&nbsp;
Receiving Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.7.3.</a>&nbsp;
Receiving Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.7.4.</a>&nbsp;
Sending Generic Notification Acknowledgement Messages<br />
<a href="#sect.future">5.</a>&nbsp;
Future Extensibility<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.future.examples">5.1.</a>&nbsp;
Examples of Possible Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.future.specification">5.2.</a>&nbsp;
Extension Specification<br />
<a href="#sect.iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#sect.sec">7.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.security.replay">7.1.</a>&nbsp;
Replay Protection for GNM, GNAM messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.security.replay.timestamps">7.1.1.</a>&nbsp;
Replay Protection using Timestamps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.security.replay.nonces">7.1.2.</a>&nbsp;
Replay Protection using Nonces<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">7.2.</a>&nbsp;
Non-authentication Extensions Handling in Foreign Agent<br />
<a href="#anchor18">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="sect.intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In some situations, there is a need for Mobile IPv4 entities, 
	    such as the home agent(HA), foreign agent(FA) and mobile node(MN) 
	    to send and receive asynchronous
	    notification messages during a mobility session.  'Asynchronous messages'
	    in this context is used to mean messages which are not synchronous with
	    the Registration Request and Registration Reply messages of the base Mobile IP
	    Specification <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. The base Mobile IP
	    Specification does not have a provision for this.

	 
</p>
<p>

	    This document defines a generic message and a notification model that can
	    be used by Mobile IPv4 entities to send various notifications.
	    It also defines a corresponding acknowledgement message to allow for reliable 
	    delivery of notifications.  Only the following extensions may be present in
	    these new messages, as defined by this document:

	 
</p>
<p>
	    </p>
<blockquote class="text">
<p>  -  MN-HA Authentication Extension 
</p>
<p>  -  MN-FA Authentication Extension 
</p>
<p>  -  FA-HA Authentication Extension 
</p>
<p>  -  Message String Extension 
</p>
</blockquote><p>
	 
</p>
<p>

	    The semantics of receiving a generic notification message with a
	    Message String Extension are null; i.e., it has no effect on the state
	    of a mobile node's existing registration.  See <a class='info' href='#sect.usage.examples'>Section&nbsp;3.1<span> (</span><span class='info'>Notification Message - Examples</span><span>)</span></a>
	    for some application examples that motivate the new messages defined
	    in this document.

	 
</p>
<a name="sect.term"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>It is assumed that the reader is familiar with the terminology used
	    in <a class='info' href='#RFC4917'>[RFC4917]<span> (</span><span class='info'>Sastry, V., Leung, K., and A. Patel, &ldquo;Mobile IPv4 Message String Extension,&rdquo; June&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
	    In addition, this document frequently uses the following terms: 
</p>
<p>
	    </p>
<blockquote class="text"><dl>
<dt>Notification Message</dt>
<dd> 
		  A message from a mobility agent to a MN or other mobility
		  agent to asynchronously notify it about an event that is relevant to
		  the mobility service it is currently providing.
	       
</dd>
<dt>Generic Notification Message</dt>
<dd> 
		  A Notification Message in the context of Mobile IPv4 with
		  a well-defined envelope format and extensibility, and with
		  certain limitations on how extensions may be defined and used,
		  but otherwise generally available for notification purposes
		  within the Mobile IPv4 protocol.  Abbreviated 'GNM' in this document.
	       
</dd>
<dt>Generic Notification Acknowledgement Message</dt>
<dd> 
		  An acknowledgement of a received Generic Notification Message.
		  Abbreviated 'GNAM' in this document.
	       
</dd>
</dl></blockquote><p>
	 
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
	    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
	    document are to be interpreted as described in RFC 2119, <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.  
</p>
<a name="sect.usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Notification Message - Usage Scenarios</h3>

<a name="sect.usage.examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Notification Message - Examples</h3>

<p>

	       The simplest usage scenario for a notification message is one
	       where the notification has no semantic meaning within the protocol;
	       it is only carrying a message which can be displayed to a user or
	       an operator (depending on which is the receiving entity -- see more
	       on this below, 
	       in <a class='info' href='#sect.scen.topology'>Section&nbsp;3.2<span> (</span><span class='info'>Notification Message - Topology</span><span>)</span></a>).  Examples of such usage is
	       messages from operator to user about billing or service related
	       events ("You have used nearly all of your prepaid quota; there
	       is only XX MB left -- please purchase further service if you are
	       going to need it."; or "You have now used data transfer services
	       for the amount of $XXX since your last bill; this is above the
	       notification threshold for your account.") or messages about
	       service interruptions, and more.  These examples are all supported
	       by the use of the Mobile IPv4 Generic Notification Message together
	       with the Message String Extension, as defined in this document.

	    
</p>
<p>

	       There are also other examples, which cannot be implemented solely
	       using the messages and extensions defined in this document.  Some
	       of these are described briefly below, and covered slightly more
	       extensively in <a class='info' href='#sect.future'>Section&nbsp;5<span> (</span><span class='info'>Future Extensibility</span><span>)</span></a>.

	    
</p>
<p>

	       One example of an application of an extended Generic Notification
	       Message is that during handover between CDMA 2000
	       1x EV-DO and Wireless LAN, the PPP resource on the CDMA side has to
	       be removed on the FA (PDSN) to avoid over-charging subscribers.
	       To address this, the Registration Revocation Message was defined in
	       <a class='info' href='#RFC3543'>[RFC3543]<span> (</span><span class='info'>Glass, S. and M. Chandra, &ldquo;Registration Revocation in Mobile IPv4,&rdquo; August&nbsp;2003.</span><span>)</span></a>, but it would have been preferable to have
	       had it defined as a separate message (i.e., the Generic Notification
	       Message) with a Registration Revocation extension.

	    
</p>
<p>

	       Other applications are HA switch over (before HA decide to go
	       off-line it would like to notify the MNs to register with another
	       candidate HA), NEMO prefix changes (MN is notified by HA about NEMO
	       prefix changes and service or billing related events, which is an
	       operational requirement), Load balancing (HA wants to move some of the
	       registered MNs to other HAs), Service Termination (due to end of
	       prepaid time), and Service Interruption (due to system maintenance).

	    
</p>
<a name="sect.scen.topology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Notification Message - Topology</h3>

<p>
	       There are several scenarios where a mobility agent could 
	       initiate notification events.  Some of these are described in the following  
	       Sections. 
	    
</p>
<a name="sect.ha2mn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Notification Message between a Home Agent and a Mobile Node</h3>

<a name="sect.ha2mn.fa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1.1"></a><h3>3.2.1.1.&nbsp;
Mobile Registered using a Foreign Agent Care-of Address</h3>

<p>In this case, the HA cannot directly notify the MN, but
		     must send the notification via the FA, vice versa.  
</p><br /><hr class="insert" />
<a name="fig1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        +----+    notification  +----+ notification  +----+
        | MN |&lt;================&gt;| FA |&lt;=============&gt;| HA |
        +----+                  +----+               +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: HA notifies MN or MN notifies HA through FA&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.ha2mn.co"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1.2"></a><h3>3.2.1.2.&nbsp;
Mobile Registered using a Co-located Care-of Address</h3>

<p> In this case, the MN has registered with the home
		     agent directly, so the notification message can go directly to the MN.

		  
</p>
<p> The notification mechanism as specified here does not support the
		     case of Co-located CoA mode with registration through a FA  
		     (due to the 'R' bit being set in the FA's advertisement  
		     messages). 
		  
</p><br /><hr class="insert" />
<a name="fig2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        +----+               notification          +----+
        | MN |&lt;===================================&gt;| HA |
        +----+                                     +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: HA directly notifies MN or MN directly notifies HA&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.fa2mn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Notification Message between a Foreign Agent and a Mobile Node</h3>

<p>There are two cases where a FA may send notification
		  messages to a MN, one where it is relaying a message, the other
		  where the notification is triggered by a message from another network entity, for example
		  a AAA node(notification messages between a AAA entity and the FA
		  could be based on RADIUS or Diameter, but this is out of scope for
		  this document).  If the notification is initiated by a FA,
		  the FA may need to also notify the HA about the event.
	       
</p><br /><hr class="insert" />
<a name="fig3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+    notification  +----+    trigger   +--------+
| MN |&lt;================&gt;| FA |&lt;=============|   AAA  |
+----+                  +----+              +--------+
                          ||   notification +----+
                           ================&gt;| HA |
                                            +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: FA notifies MN&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.ha2fa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
Notification Message between a Home Agent and a Foreign Agent</h3>

<p>The HA may also need to send a notification to the FA, 
		  but not to the MN, The FA may also need to send a notification to the HA, 
		  as illustrated below:    
</p><br /><hr class="insert" />
<a name="fig4"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                    +----+ notification  +----+
                    | FA |&lt;=============&gt;| HA |
                    +----+               +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: HA notifies FA or FA notifies HA&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.message"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Generic Notification Message and Considerations</h3>

<p>This section describes in detail the Generic Notification Message (GNM),
	    Generic Notification Acknowledgement Message (GNAM), and some considerations
	    related to the handling of these messages in the MN, FA and HA. 
</p>
<p>The MN and HA MUST maintain the following information, FA also
	    needs to maintain both the HA's and MN's direction the below information: 
	    </p>
<blockquote class="text">
<p>  -  the IP source address of the Registration Request/Reply 
</p>
<p>  -  the IP destination address of the Registration Request/Reply 
</p>
<p>  -  the UDP source port of the Registration Request/Reply   
</p>
<p>  -  the UDP destination port of the Registration Request/Reply 
</p>
</blockquote><p>
	 
</p>
<p>The sending node always sends the GNM message following the same
	    procedure for sending Registration Request as in Section 3.3 of
	    <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> and the receiving node follows the same procedure
	    for Registration Reply as in Section 3.4. of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>
	    when sending GNAM.
	 
</p>
<a name="sect.gnm.definition"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Generic Notification Message</h3>

<p>A GNM is sent by a mobility agent to
	       inform another mobility agent, or a MN, of MIP-related information
	       in the form of a Message String Extension <a class='info' href='#RFC4917'>[RFC4917]<span> (</span><span class='info'>Sastry, V., Leung, K., and A. Patel, &ldquo;Mobile IPv4 Message String Extension,&rdquo; June&nbsp;2007.</span><span>)</span></a>. 
	       These messages MUST use the same IP and UDP headers as any previous 
	       Registration Request(RRQ) or Reply (RRP) message to the same entity.
	       This would support NAT traversal and ensure same security association
	       used for GNM/GNAM and RRQ/RRP.
	       The GNM is defined as follows: 
</p>
<p>IP Fields:
	       </p>
<blockquote class="text"><dl>
<dt>  Source Address</dt>
<dd>Typically copied from the destination address 
		     of the last Registration Reply/Request message that the agent received from 
		     the agent to which it is sending the GNM.
</dd>
<dt>  Destination Address</dt>
<dd>Copied from the source address of the last Registration
		     Reply/Request message that the agent received from the agent to which it is sending the GNM.
</dd>
</dl></blockquote><p>
	    
</p>
<p>UDP Fields:
	       </p>
<blockquote class="text"><dl>
<dt>  Source Port</dt>
<dd>Typically copied from the destination port 
		     of the last Registration Reply/Request message that the agent received
		     from the agent to which it is sending the GNM.
</dd>
<dt>  Destination Port</dt>
<dd>Copied from the source port of the last Registration
		     Reply/Request message that the agent received from the agent to which 
		     it is sending the GNM.
</dd>
</dl></blockquote><p>
	    
</p>
<p>The UDP header is followed by the Mobile IP fields shown below:
	    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |      MD       |A|  Reserved                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Home Address                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Home Agent Address                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Care-of Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                       Identification                          +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions...
   +-+-+-+-+-+-+-+-+-+-+-+-+-

</pre></div>
<p>Type    (To be assigned by IANA)
</p>
<p>MD: Message Direction        
	       </p>
<blockquote class="text">
<p> This memo defines the semantics of the following MD field value: 
		  
</p>
<p>  0   --   Message sent by the HA to the MN    
</p>
<p>  1   --   Message sent by the HA to the FA  
</p>
<p>  2   --   Message sent by the MN to the HA    
</p>
<p>  3   --   Message sent by the MN to the FA 
</p>
<p>  4   --   Message sent by the FA to the MN 
</p>
<p>  5   --   Message sent by the FA to the HA  
</p>
</blockquote><p>
	    
</p>
<p>A        
	       </p>
<blockquote class="text">
<p> This bit indicates whether the notification message MUST be acknowledged by 
		     the recipient.  If "A" bit has been set during the message, but the sender 
		     doesn't receive any acknowledgement message, then the sender will have to re-send the
		     notification message again. 
</p>
<p> Set to "1" to indicate that acknowledgement is REQUIRED.  
</p>
<p> Set to "0" to indicate that acknowledgement is OPTIONAL. 
</p>
</blockquote><p>
	    
</p>
<p>Reserved

	       </p>
<blockquote class="text">
<p>
		  MUST be sent as 0, and ignored when received.
		  
</p>
</blockquote><p>
	    
</p>
<p>Home Address

	       </p>
<blockquote class="text">
<p>
		  The home IP address of the mobile node.
		  
</p>
</blockquote><p>
	    
</p>
<p>Home Agent Address

	       </p>
<blockquote class="text">
<p>
		  The IP address of the mobile node's HA.
		  
</p>
</blockquote><p>
	    
</p>
<p>Care-of Address

	       </p>
<blockquote class="text">
<p>
		  The mobile node's care-of address, either the Co-located Care-of Address
		  or the foreign agent care-of address.
		  
</p>
</blockquote><p>
	    
</p>
<p>Identification

	       </p>
<blockquote class="text">
<p>
		  A 64-bit number, constructed by the sender, used for
		  matching GNM with GNAM,  and for protecting against replay
		  attacks of notification messages.  See
		  <a class='info' href='#sect.security.replay.timestamps'>Section&nbsp;7.1.1<span> (</span><span class='info'>Replay Protection using Timestamps</span><span>)</span></a> and
		  <a class='info' href='#sect.security.replay.nonces'>Section&nbsp;7.1.2<span> (</span><span class='info'>Replay Protection using Nonces</span><span>)</span></a> for more on
		  the use of timestamps and nonces in this field.
		  Support for the use of timestamps is REQUIRED and support for nonces is OPTIONAL.
		  
</p>
</blockquote><p>
	    
</p>
<p>Extensions

	       </p>
<blockquote class="text">
<p>
		     The fixed portion of the GNM is followed
		     by one or more extensions which may be used with this message, and
		     by one or more authentication extensions as defined in Section
		     3.5 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.
		  
</p>
<p>
		     Apart from the Authentication Extensions mentioned below, only
		     one extension is defined in this document as permitted for use with the GNM:
		     the Message String Extension defined in <a class='info' href='#RFC4917'>[RFC4917]<span> (</span><span class='info'>Sastry, V., Leung, K., and A. Patel, &ldquo;Mobile IPv4 Message String Extension,&rdquo; June&nbsp;2007.</span><span>)</span></a>.
		  
</p>
<p>
		     This document requires the MN-HA Authentication 
		     Extension (AE) to be used when this message
		     is sent between the MN and the HA; MN-FA AE and FA-HA AE are OPTIONAL.
		     This document also requires the use of the MN-FA AE when this message is sent between
		     the MN and the FA; where the MN-HA AE and FA-HA AE are not needed.  This document
		     finally require the use of the FA-HA AE when this message is sent between the FA 
		     and the HA, and the MN-HA AE and MN-FA AE are not needed.  This could be determined
		     based on the "MD" value.
		     <br />

		     See Sections 3.6.1.3 and 3.7.2.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> 
		     for the rules on the order of these extensions as they appear in Mobile 
		     IPv4 RRQ and RRP messages.  The same rules are applicable to GNM and GNAM.
		  
</p>
</blockquote><p>
	    
</p>
<a name="sect.gnam"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Generic Notification Acknowledgment Message</h3>

<p> A GNAM is sent by mobility agents or MNs to indicate the 
	       successful receipt of a GNM.  
</p>
<p>IP Fields:
	       </p>
<blockquote class="text"><dl>
<dt>  Source Address</dt>
<dd> Typically copied from the
		     destination address of the GNM to which the agent
		     is replying. 
</dd>
<dt>  Destination Address</dt>
<dd> Copied from the source address
		     of the GNM to which the agent is replying.  
</dd>
</dl></blockquote><p>
	    
</p>
<p>UDP Fields:
	       </p>
<blockquote class="text"><dl>
<dt>  Source Port</dt>
<dd>Copied from the destination port of the
		     corresponding GNM.
</dd>
<dt>  Destination Port</dt>
<dd>Copied from the source port of the
		     corresponding GNM. 
</dd>
</dl></blockquote><p>
	    
</p>
<p> The UDP header is followed by the Mobile IP fields shown below:
	    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |      MD       |     code      | Reserved      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Home Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Home Agent Address                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Care-of Address                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       Identification                          +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Extensions...
+-+-+-+-+-+-+-+-+-+-+-+-+-

</pre></div>
<p>Type     (To be assigned by IANA) 
</p>
<p>MD: Message Direction        
	       </p>
<blockquote class="text">
<p> This memo defines the semantics of the following MD field value: 
		  
</p>
<p>  0   --   Message sent by the HA to the MN    
</p>
<p>  1   --   Message sent by the HA to the FA  
</p>
<p>  2   --   Message sent by the MN to the HA    
</p>
<p>  3   --   Message sent by the MN to the FA 
</p>
<p>  4   --   Message sent by the FA to the MN 
</p>
<p>  5   --   Message sent by the FA to the HA  
</p>
</blockquote><p>
	    
</p>
<p>code
	       </p>
<blockquote class="text">
<p>A value indicating the result of the GNM.
		     See below for a list of currently defined Code values.
</p>
</blockquote><p>
	    
</p>
<p>Notification successful
	       </p>
<blockquote class="text">
<p>  0   --   notification accepted    
</p>
</blockquote><p>
	    
</p>
<p>Notification denied by the HA
	       </p>
<blockquote class="text">
<p>  128 --   reason unspecified    
</p>
<p>  129 --   administratively prohibited    
</p>
<p>  130 --   insufficient resources   
</p>
<p>  131 --   mobile node failed authentication    
</p>
<p>  132 --   foreign agent failed authentication   
</p>
<p>  133 --   notification Identification mismatch    
</p>
</blockquote><p>
	    
</p>
<p>Notification denied by the FA
	       </p>
<blockquote class="text">
<p>  64 --   reason unspecified    
</p>
<p>  65 --   administratively prohibited    
</p>
<p>  66 --   insufficient resources   
</p>
<p>  67 --   mobile node failed authentication    
</p>
<p>  68 --   home agent failed authentication   
</p>
<p>  69 --   notification Identification mismatch    
</p>
</blockquote><p>
	    
</p>
<p>Notification denied by the mobile node
	       </p>
<blockquote class="text">
<p>  192 --   reason unspecified    
</p>
<p>  193 --   administratively prohibited    
</p>
<p>  194 --   insufficient resources   
</p>
<p>  195 --   foreign agent failed authentication    
</p>
<p>  196 --   home agent failed authentication   
</p>
<p>  197 --   notification Identification mismatch    
</p>
</blockquote><p>
	    
</p>
<p>Home Address

	       </p>
<blockquote class="text">
<p> The home IP address of the mobile node.  
</p>
</blockquote><p>
	    
</p>
<p>Home Agent Address

	       </p>
<blockquote class="text">
<p> The IP address of the sender's home agent.
		  
</p>
</blockquote><p>
	    
</p>
<p>Care-of Address

	       </p>
<blockquote class="text">
<p>
		  The mobile node's care-of address, either the Co-located Care-of Address
		  or the foreign agent care-of address.

		  
</p>
</blockquote><p>
	    
</p>
<p> Identification
	       </p>
<blockquote class="text">
<p>
		  A 64-bit number used for matching GNM message with GNAM
		  message and for protecting against
		  replay attacks of registration messages.  See
		  <a class='info' href='#sect.security.replay.timestamps'>Section&nbsp;7.1.1<span> (</span><span class='info'>Replay Protection using Timestamps</span><span>)</span></a> and
		  <a class='info' href='#sect.security.replay.nonces'>Section&nbsp;7.1.2<span> (</span><span class='info'>Replay Protection using Nonces</span><span>)</span></a> for more on
		  the use of timestamps and nonces in this field.
		  Support for the use of timestamps is REQUIRED and support for nonces is OPTIONAL.

		  The value is
		  based on the Identification field from the GNM
		  message from the sender, and on the style of
		  replay protection used in the security context between
		  the sender and its receiver (defined by the
		  mobility security association between them, and SPI value
		  in the authorization-enabling extension). 
		  
</p>
</blockquote><p>
	    
</p>
<p>Extensions
	       </p>
<blockquote class="text">
<p>The fixed portion of the GNAM is followed
		  by one or more extensions which may be used with this message, and
		  by one or more authentication extensions as defined in Section
		  3.5 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.
		  
</p>
<p>
		  This document REQUIRES the MN-HA Authentication 
		  Extension (AE) to be used when this message
		  is sent between the MN and the HA; MN-FA AE and FA-HA AE are OPTIONAL.
		  This document also requires the use of the MN-FA AE when this message is sent between
		  the MN and the FA; where the MN-HA AE and FA-HA AE are not needed.  This document
		  finally requires the use of the FA-HA AE when this message is sent between the FA 
		  and the HA, and the MN-HA AE and MN-FA AE are not needed.  This could be determined
		  based on the "MD" value.
		  <br />

		  See Sections 3.6.1.3 and 3.7.2.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> 
		  for the rules on the order of these extensions as they appear in Mobile 
		  IPv4 RRQ and RRP messages.  The same rules are applicable to GNM and GNAM.
		  
</p>
</blockquote><p>
	    
</p>
<a name="sect.gnm.retrans"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Notification Retransmission</h3>

<p>If "A" flag has been set during the GNM message, but the sender
	       doesn't receive any GNAM message within a reasonable time, then another
	       GNM will be retransmitted.  When timestamps are used, a new registration 
	       Identification is chosen for each retransmission; Thus it counts as
	       a new GNM.  When
	       nonces are used, the unanswered GNM message is retransmitted unchanged;
	       thus the retransmission does not count as a new GNM (<a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>).
	       In this way a retransmission will not require the receiver
	       to re-synchronize with the sender by issuing another nonce in the
	       case in which the original GNM message (rather than its
	       GNAM message) was lost by the network.
	    
</p>
<p>The maximum time until a new GNM message is sent SHOULD be
	       no greater than the requested Lifetime of the last GNM message.
	       The minimum value SHOULD be large enough to account for the size of
	       the messages, twice the round trip time for transmission to the receiver,
	       and at least an additional 100 milliseconds to allow for
	       processing the messages before responding.  The round trip time for
	       transmission to the receiver will be at least as large as the time
	       REQUIRED to transmit the messages at the link speed of the sender's
	       current point of attachment.  Some circuits add another 200
	       milliseconds of satellite delay in the total round trip time to the
	       receiver.  The minimum time between GNM MUST NOT
	       be less than 1 second.  Each successive retransmission timeout period
	       SHOULD be at least twice the previous period, as long as that is less
	       than the maximum as specified above.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
General Implementation Considerations</h3>

<p>
	       Implementations of this specifications should provide support for management of
	       the various settings related to the notification messages.  In particular, it
	       should be possible to do the following:

	    </p>
<blockquote class="text">
<p>* List the notification messages supported
</p>
<p>* Show enabled/disabled status for notification message support, overall and in
		  detail.
</p>
<p>* Show the value of the maximum and minimum retransmission times.
</p>
<p>* Enable and disable notification support entirely.
</p>
<p>* Enable and disable the individual notification messages supported.
</p>
<p>* Set the value of the maximum and minimum retransmission times described in <a class='info' href='#sect.gnm.retrans'>Section&nbsp;4.3<span> (</span><span class='info'>Notification Retransmission</span><span>)</span></a>.
</p>
</blockquote><p>
	    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Mobile Node Considerations</h3>

<p>It is possible that the MN MAY receive a GNM from a FA or HA.
	       Both in the case of FA-CoA and Co-located CoA, the MN MAY reply 
	       with a GNAM based on the "A" flag in the GNM message.  
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Receiving Generic Notification Messages</h3>

<p>  When the MN is using FA-CoA and receives a Notification
		  message, if the "MD" value is 0, it means that the notification
		  message came from the HA.  If the "MD" value is 4, the
		  notification came from the FA.
	       
</p>
<p>If this notification message came from a FA and the MN
		  accepts the FA's GNM, then it will process the notification extension according 
		  to the specific rules for that extension. 
</p>
<p>The MN MUST check for the presence of an authorization-enabling extension, 
		  and perform the indicated authentication.  Exactly one authorization-enabling
		  extension MUST be present in the GNM, if this message 
		  came from a FA, then MN-FA AE MUST be present.  If no MN-FA AE
		  is found, or if more than one MN-FA AE is found, or if the Authenticator is
		  invalid, then the MN MUST reject the GNM and MAY send a GNAM
		  to the FA with Code 195, including an Identification field computed 
		  in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.
		  The MN MUST
		  do no further processing with such a notification, though it SHOULD log 
		  the error as a security exception.
</p>
<p>The MN MUST check that the Identification field is correct using the context
		  selected by the SPI within mandatory authentication extension like MN-FA AE
		  or MN-HA AE.  See <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a> for a description of how this is performed.  
		  If incorrect, the MN MUST reject the GNM and MAY send a GNAM
		  to the initiator with Code 197, including an Identification field computed 
		  in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.  The MN MUST do no further
		  processing with such a notification, though it SHOULD log the error
		  as a security exception.
</p>
<p>
		  The MN MUST also check that the extensions present in the Generic
		  Notification Message are permitted for use with the GNM.  If not, the
		  MN MUST silently discard the message.  It MUST NOT do any further
		  processing with such a notification, though it SHOULD log the error.
	       
</p>
<p>After this, the MN MAY reply GNAM back to the FA.  If the "A" flag is 
		  set in the GNM, then the MN MUST send the GNAM.  
</p>
<p>If this notification message came from the HA, relayed by the
		  FA, or is a Co-located CoA, then the MN-HA AE MUST be checked and 
		  the MN MUST check the Authenticator value in the Extension.  If no MN-HA AE
		  is found, or if more than one MN-HA AE is found, or if the Authenticator is
		  invalid, then the MN MUST reject the GNM and MAY send a GNAM
		  to the initiator with Code 196, including an Identification field computed 
		  in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.  The MN MUST
		  do no further processing with such a notification, though it SHOULD log 
		  the error as a security exception.  If the MN accepts the HA's GNM, 
		  then it will process it according to 
		  the specific rules for that extension.  After that, the MN MAY 
		  reply with a GNAM with Code 0 back to the HA based on the "A" flag in the GNM.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Sending Generic Notification Acknowledgement Messages</h3>

<p>Both in the case of a Co-located CoA and FA-CoA, the MN MAY
		  reply with a GNAM based on the "A" flag in the GNM as follows: 
	       
</p>
<p>If the GNM was initiated from the FA to the MN ("MD" value is set to
		  4), then MN-FA AE MUST be the last extension in order to protect all other
		  non-authentication extensions as defined in Section 3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. 
	       
</p>
<p>In the case of a FA-CoA, the source address is the MN's address, the
		  destination address is the FA's address. 
</p>
<p> The Code field of the GNAM is chosen in accordance with
		  the rules specified in <a class='info' href='#sect.gnam'>Section&nbsp;4.2<span> (</span><span class='info'>Generic Notification Acknowledgment Message</span><span>)</span></a>.  When replying to an
		  accepted notification, a MN SHOULD respond with Code 0.
</p>
<p> There are a number of reasons the MN might reject a
		  notification such as administrative in nature returning a GNAM with a code of 193,
		  similarly and provides the Code value 192 or 194 for the unspecified reason 
		  and insufficient resources.
</p>
<p>If the GNM was initiated from the HA to the MN ("MD" value is set to 0)
		  and in the case of Co-located CoA, then MN-HA AE MUST be the last extension 
		  in order to protect all other non-authentication extensions as 
		  defined in Section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> 
</p>
<p>In the case of a FA-CoA, the source address is the MN's HoA address
		  and the destination address is the FA's address ("MD" value is set to 2),
		  the ordering of the extension is: any non-authentication
		  Extensions used only by the HA, followed by the MN-HA AE defined in 
		  Section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>,
		  followed by any non-authentication Extensions used only by
		  the FA, followed by the MN-FA AE defined in Section 3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Sending Generic Notification Messages</h3>

<p>The MN may either send a GNM to notify the FA or HA.
	       
</p>
<p> If the message is sent to the FA, then the
		  source address is the MN's address, and the destination address is
		  the FA's address 
</p>
<p> If the FA is the target of this notification message, then the 
		  "MD" value is set to 3, MN-FA AE MUST be the last extension in order
		  to protect all other non-authentication extensions. 
		  Computing Authentication Extension Value
		  is the same as Section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p> If the FA is working only as a relay agent, then the "MD"
		  value is set to 2, and the ordering of the extension
		  is: the notification extension, followed by any non-authentication
		  extension expected to be used by HA, followed by MN-HA AE
		  defined in Section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>,  followed by any non-authentication Extensions
		  used only by the FA, followed by The MN-FA AE defined in Section 3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  Computing Authentication Extension Value is the
		  same as Section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p>In the case of a Co-located CoA, the MN MAY send a 
		  notification message directly to the HA if it needs to be
		  notified.  The "MD" value is set to 2, and the ordering of the extension
		  is: the notification extension, followed by any non-authentication
		  extension expected to be used by HA, followed by MN-HA AE
		  defined in Section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. 
	       
</p>
<p>The MN chooses the Identification field in accordance with
		  the style of replay protection it uses with its HA.  This is
		  part of the mobility security association the MN shares with
		  its HA.  See <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a> for the method by which the MN
		  computes the Identification field.
	       
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Receiving Generic Notification Acknowledgement Messages</h3>

<p>In the case of a FA-CoA, if the MN receives this message, and
		  the "MD" value is set to 0, it means that the GNAM came from HA
	       
</p>
<p>If the "MD" value is set to 4, then the MN-FA AE MUST be checked, 
		  and the MN MUST check the Authenticator value in the Extension.  
		  If no MN-FA AE is found, or if more than one MN-FA AE is found, 
		  or if the Authenticator is invalid, then the MN MUST silently discard 
		  the GNAM. 
</p>
<p>In addition, the low-order 32 bits of the Identification field in the
		  GNAM MUST be compared to the low-order 32 bits of the
		  Identification field in the most recent GNM sent to
		  the replying agent.  If they do not match, then the GNAM MUST be silently
		  discarded. 
</p>
<p> If the "MD" value is set to 0, then the MN-HA AE MUST be
		  checked, and the MN MUST check the Authenticator value in the
		  Extension.  If no MN-HA AE is found, or if more than one 
		  MN-HA AE is found, or if the Authenticator is invalid, then the MN MUST 
		  silently discard the GNAM.  If the MN accepted this message, 
		  then the MN MAY also process it based on the notification event.  
</p>
<p> In the case of a Co-located CoA, if the MN received this
		  message, then the MN-HA AE MUST be checked,
		  and the MN MUST check the Authenticator value in the Extension.
		  If no MN-HA AE is found, or if more than one MN-HA AE is found, or if the
		  Authenticator is invalid, then the MN MUST silently discard the
		  Notification Acknowledgement message. 
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Foreign Agent Consideration</h3>

<p> The FA may initiate a GNM to the MN or the HA.  Additionally,
	       the FA also relays GNM and GNAM messages between the MN and its
	       HA as long as there is an active binding for the MN at the FA.
	    
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.1"></a><h3>4.6.1.&nbsp;
Receiving Generic Notification Messages</h3>

<p>If the FA receives a GNM, and the "MD" value is set to 0, 
		  then it means that the HA is asking the FA to relay
		  the message to the MN.  If the "MD" value is set to 1, then it means
		  that the target of the notification is the FA.
		  If the "MD" value is set to 2, then it means that the MN is asking 
		  the FA to relay the message to the HA.
		  If the "MD" value is set to 3, then it means
		  that the notification came from the MN to the FA.
	       
</p>
<p>If the "MD" value is set to 0, then the FA MAY validate the FA-HA AE if present.
		  If the FA-HA AE is invalid, then all extensions between the HA-MN AE and the 
		  HA-FA AE MUST be removed, FA SHOULD relay the GNM to the MN's home address as specified 
		  in the Home Address field of the GNM, MN will eventually validate the MN-HA AE
		  to ensure that all information sent to the MN is integrity protected.
		  If the FA-HA AE is valid, FA MUST
		  relay the GNM to the MN's home address as specified in the Home Address 
		  field of the GNM.  The FA MUST NOT modify any of
		  the fields beginning with the fixed portion of the GNM through the
		  MN-HA AE or other authentication extension supplied by the HA
		  as an authorization-enabling extension for the MN.
</p>
<p>Furthermore, the FA MUST process and remove any extensions following
		  the MN-HA AE.  If the FA shares a mobility security association with
		  the MN, the FA MAY append any of its own non-authentication extensions
		  which of relevance to the MN.  In this case, the FA MUST append the MN-FA AE
		  after these non-authentication extensions.
</p>
<p> If the "MD" value is set to 1, the FA-HA AE MUST be checked, and
		  the FA MUST check the Authenticator value in the Extension.
		  If no FA-HA AE is found, 
		  or if more than one FA-HA AE is found, or if the Authenticator is
		  invalid, the FA MUST reject the GNM and MAY
		  send a GNAM to the HA with Code 68, including an Identification
		  field computed in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.
		  The FA MUST do no further processing with such a notification, though
		  it SHOULD log the error as a security exception.
</p>
<p>The FA MUST check that the Identification field is correct using the
		  context selected by the SPI within mandatory FA-HA AE.  
		  See <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a> for a description of how
		  this is performed.  If incorrect, the FA MUST reject the GNM and
		  MAY send a GNAM to the initiator with Code 69, including an
		  Identification field computed in accordance with the rules specified
		  in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.  The FA MUST do no further processing with such a
		  notification, though it SHOULD log the error as a security exception. 
</p>
<p>
		  The FA MUST also check that the extensions present in the Generic
		  Notification Message are permitted for use with the GNM.  If not, the
		  FA MUST silently discard the message.  It MUST NOT do any further
		  processing with such a notification, though it SHOULD log the error.
	       
</p>
<p>If FA accepts the HA's GNM, it will process it based on the specific rules
		  for that extension.  The FA MAY then reply with a GNAM with Code 0
		  back to the MN based on the "A" flag in the GNM.  
</p>
<p>In the case of a FA-CoA and if the "MD" value is set to 2, if the FA
		  received this message, and if the MN-FA AE is present, the MN-FA AE MUST be checked,
		  and the FA MUST check the Authenticator value in the Extension.
		  If no MN-FA AE is found, or if more than one MN-FA AE is found, or if the
		  Authenticator is invalid, the FA MUST silently discard the GNM message. 
		  If MN-FA is valid, FA MUST relay the GNM to the HA's address as specified 
		  in the Home Agent Address field of the GNM, HA will eventually validate the MN-HA AE
		  to ensure that all information sent to the HA is integrity protected.
		  The FA MUST NOT modify any of
		  the fields beginning with the fixed portion of the GNM through the
		  MN-HA AE or other authentication extension supplied by the MN
		  as an authorization-enabling extension for the HA.
</p>
<p>Furthermore, the FA MUST process and remove any Extensions following
		  the MN-HA AE, and MAY append any of its own non-authentication Extensions
		  of relevance to the HA if applicable, and MUST append the FA-HA AE, if 
		  the FA shares a mobility security association with the HA.
</p>
<p> If the "MD" value is set to 3, the MN-FA AE MUST be checked, and the FA MUST
		  check the Authenticator value in the Extension which is the same as the
		  Section 3.7.2.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  If no MN-FA AE is found, or if more than one
		  MN-FA AE is found, or if the Authenticator is
		  invalid, the FA MUST reject the GNM and MAY
		  send a GNAM to the MN with Code 67, including an Identification
		  field computed in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.
		  The FA MUST do no further processing with such a notification, though
		  it SHOULD log the error as a security exception.
</p>
<p>The FA MUST check that the Identification field is correct using the
		  context selected by the SPI within mandatory MN-FA AE.  See <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a> 
		  for a description of how
		  this is performed.  If incorrect, the FA MUST reject the GNM and
		  MAY send a GNAM to the initiator with Code 69, including an
		  Identification field computed in accordance with the rules specified
		  in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.  The FA MUST do no further processing with such a
		  notification, though it SHOULD log the error as a security exception. 
</p>
<p>If FA accepts the MN's GNM, it will process it based on the specific rules
		  for that extension.  The FA MAY then reply with a GNAM with Code 0 back
		  to the MN based on the "A" flag in the GNM.  
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.2"></a><h3>4.6.2.&nbsp;
Sending Generic Notification Acknowledgement Messages</h3>

<p>The FA may need to either relay a GNAM message between the MN and the 
		  HA or send one as a response to a GNM message that was sent to
		  it.  In both cases, the GNAM message is defined as follows:
</p>
<p>The source address is the FA address, the destination
		  address is HA's or MN's home address. 
</p>
<p>The Code field of the GNAM is chosen in accordance with
		  the rules specified in <a class='info' href='#sect.gnam'>Section&nbsp;4.2<span> (</span><span class='info'>Generic Notification Acknowledgment Message</span><span>)</span></a>.  When replying to an
		  accepted notification, a FA SHOULD respond with Code 0.
</p>
<p> There are a number of reasons the FA might reject a
		  notification such as administrative in nature returning a GNAM with a code of 65,
		  similarly and provides the Code value 64 or 66 for the unspecified reason 
		  and insufficient resources.
</p>
<p> If the FA is only relaying this message to the HA, the
		  FA MUST NOT modify any of the fields beginning with the
		  fixed portion of the GNAM through the including the MN-HA AE or other
		  authentication extension supplied by the MN as an
		  authorization-enabling extension for the MN.  Furthermore, the foreign
		  agent MUST process and remove any Extensions following the
		  MN-HA AE.  If the FA shares a mobility security
		  association with the HA, the FA MAY append any of its own
		  non-authentication extensions which of relevance to the HA, In this case
		  the FA MUST append the FA-HA AE after these non-authentication extensions.
</p>
<p> If the notification message is from the HA to the
		  FA then the "MD" value is set to 5 and
		  the ordering of the extension is: any non-authentication Extensions
		  used only by the FA, followed by The FA-HA AE defined in Section 3.5.4 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p> If the notification message is from the MN to the
		  FA then the "MD" value is set to 4 and
		  the ordering of the extension is: any non-authentication Extensions
		  used only by the FA, followed by The MN-FA AE defined in Section 3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.3"></a><h3>4.6.3.&nbsp;
Sending Generic Notification Messages</h3>

<p> If the FA is initiating a notification to the MN
		  using the GNM, it MAY also notify the HA as well.  
</p>
<p> In the message to the MN, the source address
		  is the FA address, the destination address is the MN's
		  address, the "MD" value is set to 4, and the ordering
		  of the extension is: the notification extension, followed by any
		  non-authentication Extensions used only by the MN, followed
		  by The MN-FA AE defined in Section
		  3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  Computing Authentication Extension
		  Value is the same as Section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>
		  except the payload is the notification other than registration.  
</p>
<p> In the message to the HA, the source address is
		  the FA's address, the destination address is the HA's address
		  (the "MD" value is set to 5), and the ordering of the
		  extension is: notification extension, followed by any non-authentication
		  Extensions used only by the HA, followed by The FA-HA AE defined in Section 3.5.4 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  Computing Authentication Extension Value is the
		  same as Section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> except the payload
		  is the notification other than registration.  
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.4"></a><h3>4.6.4.&nbsp;
Receiving Generic Notification Acknowledgement Messages</h3>

<p> In the case of a FA-CoA, if the FA receives this message, and
		  the "MD" value is set to 3, it means that the 
		  notification acknowledgement message came from the
		  MN, otherwise it came from the HA.   
</p>
<p> If the "MD" value is set to 1, the FA-HA AE MUST be checked, 
		  and the FA MUST check the Authenticator value in the Extension.  
		  If no FA-HA AE is found, or if more than 
		  one FA-HA AE is found, or if the Authenticator is
		  invalid, the FA MUST silently discard the Notification
		  Acknowledgement message.  If the FA accepted
		  this message, the FA MAY also process it based on the notification
		  event. 
</p>
<p> If the "MD" value is set to 3, if the MN-FA AE
		  is present, it MUST be checked, and the FA MUST check the Authenticator value in the
		  Extension.  If no MN-FA AE is found, or
		  if more than one MN-FA AE is found, or if
		  the Authenticator is invalid, the FA MUST silently discard
		  the GNAM message.  If the FA accepted
		  this message, the FA MAY also process it based on the notification
		  event.  
</p>
<p> In the case of a FA-CoA and if the "MD" value is set to 2, if the FA
		  received this message, and if the MN-FA AE is present, the MN-FA AE MUST be checked,
		  and the FA MUST check the Authenticator value in the Extension.
		  If no MN-FA AE is found, or if more than one MN-FA AE is found, or if the
		  Authenticator is invalid, the FA MUST silently discard the GNAM message. 
		  If FA accepted the MN's GNAM message, it MUST relay this message to the
		  HA.  The FA MUST NOT modify any of the fields beginning with 
		  the fixed portion of the GNAM message through the including the MN-HA 
		  AE or other authentication extension
		  supplied by the HA as an authorization-enabling extension for the MN.
		  Furthermore, the FA MUST process and remove any Extensions following
		  the MN-HA AE and MAY append any of its own
		  non-authentication Extensions of relevance to the HA, if
		  applicable, and MUST append the FA-HA AE, if the FA shares a mobility security
		  association with the HA. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Home Agent Consideration</h3>

<p>The HA MAY initiate a GNM message to both the mobile
	       node and FA, and it also MAY receive a GNAM message from both the FA and MN.
	       The HA also MAY receive a GNM message from the FA, but only when there is a
	       binding for a MN.  If the HA receives a GNM from a FA and there is no corresponding MN registration,
	       the HA SHOULD drop the GNM message.

	    
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7.1"></a><h3>4.7.1.&nbsp;
Sending Generic Notification Messages</h3>

<p>    In the case of a FA-CoA, the HA may either send a GNM
		  to notify the FA, or have the FA relay the GNM to the MN if the MN needs
		  to be notified.
	       
</p>
<p> If the message is from the HA to the FA, the
		  source address is the HA's address, and the destination address is
		  the FA's address 
</p>
<p> If the FA is working only as a relay agent, the "MD"
		  value is set to 0, and the ordering of the extension
		  is: the notification extension, followed by any non-authentication
		  extension expected to be used by MN, followed by MN-HA AE
		  defined in Section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>,  followed by any non-authentication Extensions
		  used only by the FA, followed by The FA-HA AE defined in Section 3.5.4 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  Computing Authentication Extension Value is the
		  same as Section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p> If the FA is the target of this
		  notification message, then the "MD" value is set to 1, 
		  and the ordering of the extension is:
		  the notification extension, followed by any non-authentication
		  Extensions used only by the FA, followed by The
		  FA-HA AE defined in Section 3.5.4 of
		  <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  Computing Authentication Extension Value
		  is the same as Section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p>In the case of a Co-located CoA, the HA MAY send a 
		  notification message directly to the MN if it needs to be
		  notified.  The "MD" value is set to 0, and the ordering of the extension
		  is: the notification extension, followed by any non-authentication
		  extension expected to be used by MN, followed by MN-HA AE
		  defined in Section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. 
	       
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7.2"></a><h3>4.7.2.&nbsp;
Receiving Generic Notification Acknowledgement Messages</h3>

<p> In the case of a FA-CoA, if the HA receives this message, and
		  the "MD" value is set to 2, it means that the 
		  GNAM message came from MN.    
</p>
<p> If the "MD" value is set to 5,  and the HA accepted
		  this message, the HA MAY also process it based on the notification
		  event.  The FA-HA AE MUST be checked, and the HA MUST check
		  the Authenticator value in the Extension.  If no FA-HA AE is found, 
		  or if more than one FA-HA AE is found, or if the Authenticator is
		  invalid, the HA MUST silently discard the GNAM message. 
</p>
<p> If the "MD" value is set to 2,  in the case of a FA-CoA, 
		  and if FA-HA AE is present, the FA-HA AE MUST be checked, 
		  and the HA MUST check the Authenticator value in the Extension.  
		  If more than one FA-HA AE is found, or if the Authenticator is
		  invalid, the HA MUST silently discard the GNAM message.
		  Anyway, MN-HA AE MUST be
		  checked, and the HA MUST check the Authenticator value in the
		  Extension.  If no MN-HA AE is found, or
		  if more than one MN-HA AE is found, or if
		  the Authenticator is invalid, the HA MUST silently discard
		  the GNAM.  If the HA accepted
		  this message, the HA MAY also process it based on the notification
		  event.  
</p>
<p> If the "MD" value is set to 2, in the case of a Co-located CoA, 
		  MN-HA AE MUST be checked, and the HA MUST check the Authenticator value in the
		  Extension.  If no MN-HA AE is found, or
		  if more than one MN-HA AE is found, or if
		  the Authenticator is invalid, the HA MUST silently discard
		  the GNAM.  If the HA accepted
		  this message, the HA MAY also process it based on the notification
		  event.  
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7.3"></a><h3>4.7.3.&nbsp;
Receiving Generic Notification Messages</h3>

<p> The HA MAY receive a GNM message sent
		  from the FA.  When the HA receives this message, 
		  if the the "MD" value is set to 5, this message came from FA.
		  FA-HA AE MUST be checked, and the HA
		  MUST check the Authenticator value in the Extension.  If no
		  FA-HA AE is found, or if more than one FA-HA AE is found, or if the
		  Authenticator is invalid, the HA MUST reject the GNM and MAY
		  send a GNAM to the FA with Code 132, including an Identification
		  field computed in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.
		  The HA MUST do no further processing with such a notification, though
		  it SHOULD log the error as a security exception.
</p>
<p>The HA MUST check that the Identification field is correct using the
		  context selected by the SPI within mandatory authentication extension
		  like MN-HA AE or FA-HA AE.  See <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a> for a description of how
		  this is performed.  If incorrect, the HA MUST reject the GNM and
		  MAY send a GNAM to the initiator with Code 133, including an
		  Identification field computed in accordance with the rules specified
		  in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.  The HA MUST do no further processing with such a
		  notification, though it SHOULD log the error as a security exception.
		  If HA accepts the FA's GNM message, it will process it based on the
		  notification extension.  Furthermore, the HA MAY reply with a GNAM
		  message with Code 0 back to the FA based on the "A" flag in the GNM message.  
</p>
<p> If the the "MD" value is set to 2, this message come from MN,
		  in the case of FA-COA, if FA-HA AE is present, it MUST be checked, and the HA
		  MUST check the Authenticator value in the Extension.  If more than one
		  FA-HA AE Extension is found, or if the
		  Authenticator is invalid, the HA MUST reject the GNM and MAY
		  send a GNAM to the FA with Code 132, including an Identification
		  field computed in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.
		  The HA MUST do no further processing with such a notification, though
		  it SHOULD log the error as a security exception.
		  And MN-HA AE MUST be checked, and the HA MUST check the Authenticator value in the 
		  Extension.  If no MN-HA AE is found, or if 
		  more than one MN-HA AE is found, or if the
		  Authenticator is invalid, the HA MUST reject the GNM and MAY
		  send a GNAM to the MN with Code 131, including an Identification
		  field computed in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.
		  The HA MUST do no further processing with such a notification, though
		  it SHOULD log the error as a security exception.  If HA accepts the MN's
		  GNM message, it will process it based on the
		  notification extension.  Furthermore, the HA MAY reply with a GNAM
		  message back to the MN with Code 0 based on the "A" flag in the GNM message.  
</p>
<p> If the the "MD" value is set to 2, in the case of a
		  Co-located CoA, the MN-HA AE MUST be checked, and the HA MUST check 
		  the Authenticator value in the 
		  Extension.  If no MN-HA AE is found, or if 
		  more than one MN-HA AE is found, or if the
		  Authenticator is invalid, the HA MUST reject the GNM and MAY
		  send a GNAM to the MN with Code 131, including an Identification
		  field computed in accordance with the rules specified in <a class='info' href='#sect.security.replay'>Section&nbsp;7.1<span> (</span><span class='info'>Replay Protection for GNM, GNAM messages</span><span>)</span></a>.
		  The HA MUST do no further processing with such a notification, though
		  it SHOULD log the error as a security exception.  If HA accepts the MN's
		  GNM message, it will process it based on the
		  notification extension.  Furthermore, the HA MAY reply with a GNAM
		  message back to the MN with Code 0 based on the "A" flag in the GNM message.  
</p>
<p>
		  The HA MUST also check that the extensions present in the Generic
		  Notification Message are permitted for use with the GNM.  If not, the
		  HA MUST silently discard the message.  It MUST NOT do any further
		  processing with such a notification, though it SHOULD log the error.
	       
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7.4"></a><h3>4.7.4.&nbsp;
Sending Generic Notification Acknowledgement Messages</h3>

<p> If the GNM message came from the FA only, and if the "A" flag is 
		  set in the GNM message, then the HA MUST send a 
		  GNAM message.  The message is as follows: The source address is HA's address,
		  the destination address is the FA's address, the "MD" value is set to 1.
		  The ordering of the extension is: any non-authentication
		  Extensions used only by the FA, followed by The
		  Foreign-Home Authentication extension defined in Section 3.5.4 of
		  <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p>The Code field of the GNAM is chosen in accordance with the rules
		  specified in <a class='info' href='#sect.gnam'>Section&nbsp;4.2<span> (</span><span class='info'>Generic Notification Acknowledgment Message</span><span>)</span></a>.  When replying to an accepted
		  GNM, a MN SHOULD respond with Code 0.
</p>
<p> If the GNM message came from the MN, and if the "A" 
		  flag is set in the GNM message, then the HA MUST send a GNAM message. 
		  The message is as follows: The source address is HA's address, the destination
		  address is the FA's address, the "MD" value is set to 0.
		  The ordering of the extension is: any non-authentication
		  Extensions used only by the MN, followed by the MN-HA AE defined in 
		  Section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>, optionally followed by any 
		  non-authentication Extensions used only by the FA, optionally followed by 
		  The MN-FA AE defined in Section 3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> 
</p>
<a name="sect.future"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Future Extensibility</h3>

<p>

	    This document defines the Generic Notification Message used with
	    the Message String Extension <a class='info' href='#RFC4917'>[RFC4917]<span> (</span><span class='info'>Sastry, V., Leung, K., and A. Patel, &ldquo;Mobile IPv4 Message String Extension,&rdquo; June&nbsp;2007.</span><span>)</span></a>.
	 
</p>
<p>
	    It is however possible to define new notification-related extensions
	    for use with the Generic Notification Message, for cases where the
	    notification is intended to have a semantic content and is
	    intended for the HA, FA or MN, rather than for the user.
	 
</p>
<a name="sect.future.examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Examples of Possible Extensions</h3>

<p>
		One example of such usage, which would have been defined in this document if
		it hadn't already been defined as a separate message is the
		<a class='info' href='#RFC3543'>Registration Revocation Message<span> (</span><span class='info'>Glass, S. and M. Chandra, &ldquo;Registration Revocation in Mobile IPv4,&rdquo; August&nbsp;2003.</span><span>)</span></a> [RFC3543].  This is a
		message sent from the HA to FA(s) or MN to notify the receiving node that
		a currently active registration is being revoked.  The use case for this
		is clearly laid out in <a class='info' href='#RFC3543'>[RFC3543]<span> (</span><span class='info'>Glass, S. and M. Chandra, &ldquo;Registration Revocation in Mobile IPv4,&rdquo; August&nbsp;2003.</span><span>)</span></a>.
	     
</p>
<p>
		Another example would be managed maintenance switch-over between HA instances,
		where a HA due to go down for maintenance could direct the MNs registered
		with it to re-register with another specified HA.  Such a
		message could also be used for managed load balancing.  There is currently no
		support for such forced switch-over in the Mobile IPv4 protocol.  
	     
</p>
<p>
		Yet another example is when the prefix set handled by an MIPv4 NEMO <a class='info' href='#RFC5177'>[RFC5177]<span> (</span><span class='info'>Leung, K., Dommety, G., Narayanan, V., and A. Petrescu, &ldquo;Network Mobility (NEMO) Extensions for Mobile IPv4,&rdquo; April&nbsp;2008.</span><span>)</span></a>
		HA changes; to ensure proper routing, the mobile router needs to be
		notified about the change so that its internal routing rules may be
		updated.
	     
</p>
<p>

		One final example is home network changes which require host configuration
		changes, for instance a change of address for the DNS server
		or another network server; again this is a case where the HA would want
		to notify the MN of the change, so that service interruptions can be
		avoided.

	     
</p>
<a name="sect.future.specification"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Extension Specification</h3>

<p>
	    In order to avoid making the MIPv4 Generic Notification Message a generic
	    protocol extension mechanism by which new protocol mechanisms could be
	    implemented without appropriate discussion and approval, any new extensions which are
	    to be used with the Generic Notification Message must be registered with
	    IANA, where registration is limited by the 'RFC Required' policy defined
	    in <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>
	 
</p>
<p>

	    If additional extensions are specified for use with the Generic Notification
	    Message, the practice exemplified in <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> and related
	    specification should be followed.  Generally it has not been necessary so
	    far to provide versioning support within individual extensions; in a few cases it
	    has been necessary to define new extensions with new extension numbers where
	    a generalizations of a pre-existing extension has been needed, and with the
	    current rate of extension number consumption that seems to be an acceptable
	    approach.

	 
</p>
<p>

	    If at some point extensions are specified for use with the Generic Notification
	    Message which overlap pre-existing notification messages, the authors of the
	    specification should consider providing a method to flag which notification messages
	    are supported, and which notification message usage is requested, in a manner
	    similar to the way tunnelling method capabilities and usage requests are flagged in
	    the <a class='info' href='#RFC3344'>Mobile IPv4 Base Specification<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344].

	 
</p>
<p>

	    Encoded in the extension number of Mobile IPv4 extensions is the notion of
	    'skippable' and 'not skippable' extensions; see Section 1.8 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  This notion is also applicable when extensions are used with
	    the Generic Notification Message:  It is not required that a receiver understand a
	    skippable extension, but a non-skippable extension needs to be handled according to
	    Section 1.8 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> (i.e., the message must be silently
	    discarded if the extension is not recognized).  This document does not specify
	    any change from the <a class='info' href='#RFC3344'>Mobile IPv4 Base Specification<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> [RFC3344]
	    in this respect.

	 
</p>
<a name="sect.iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>

	    This document defines two new messages, the Generic Notification Message
	    described in <a class='info' href='#sect.gnm.definition'>Section&nbsp;4.1<span> (</span><span class='info'>Generic Notification Message</span><span>)</span></a>, and the Generic Notification Acknowledgement
	    Message, described in <a class='info' href='#sect.gnam'>Section&nbsp;4.2<span> (</span><span class='info'>Generic Notification Acknowledgment Message</span><span>)</span></a>.  The message numbers for these two
	    message numbers are to be allocated from the same number space used by
	    the Registration Request and Registration Reply messages in <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.

	 
</p>
<p>
	    The Generic Notification Message may only carry extensions which are
	    explicitly permitted for use with this message.  This document defines
	    4 extensions which are permitted, in <a class='info' href='#sect.gnm.definition'>Section&nbsp;4.1<span> (</span><span class='info'>Generic Notification Message</span><span>)</span></a>.  IANA
	    must establish a register of Mobile IPv4 extensions which are permitted
	    for use with the Generic Notification Message.  Approval of new extensions
	    which are permitted for use with the Generic Notification Message requires
	    that they be defined in an RFC according to the 'RFC Required' policy described
	    in <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
	 
</p>
<p>

	    The Generic Notification Acknowledgement message, specified in <a class='info' href='#sect.gnam'>Section&nbsp;4.2<span> (</span><span class='info'>Generic Notification Acknowledgment Message</span><span>)</span></a>,
	    has a Code field.  The number space for the Code field
	    values is new, and also specified in <a class='info' href='#sect.gnam'>Section&nbsp;4.2<span> (</span><span class='info'>Generic Notification Acknowledgment Message</span><span>)</span></a>.  The Code number space
	    is structured according to whether the notification was successful, or
	    whether the HA denied the notification, or whether FA denied the
	    notification, or whether MN denied the notification, as follows:

	 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          0       Success Code
          64-69   Error Codes from the FA
          128-133 Error Codes from the HA
          192-197 Error Codes from the MN
</pre></div>
<p>Approval of new Code values require expert review.
</p>
<a name="sect.sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>

	    This specification operates with the security constraints and requirements of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  This means that when these message is transmitted between the
	    MN and the HA, MN-HA AE is REQUIRED, when this message is transmitted between the MN
	    and the FA, MN-FA AE is REQUIRED, when this message is transmitted between the FA
	    and the HA, FA-HA AE is REQUIRED.  It extends the operations of MN, HA and FA
	    defined in <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> to notify each other about some events.  The GNM
	    message defined in the specification could carry information that modifies the
	    mobility bindings.  Therefore the message MUST be integrity protected.  Replay
	    protection MUST also be guaranteed.

	 
</p>
<p>

	    RFC 3344 provides replay protection only for registration requests
	    sent by the MN.  There is no mechanism for replay protection for messages
	    initiated by a FA or a HA.  The 64-bit Identification field specified in this 
	    document (Section 4.1 and 4.2) for the GNM message is used to provide 
	    replay protection for the notification messages initiated by the FA or HA.

	 
</p>
<a name="sect.security.replay"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Replay Protection for GNM, GNAM messages</h3>

<p>The Identification field is used to let the receiving node 
	       verify that a GNM has been freshly generated by the sending node,
	       not replayed by an attacker from some previous registration.  Two
	       methods are described in this section:  timestamps (REQUIRED) and
	       "nonces" (OPTIONAL).  All senders and receivers MUST implement
	       timestamp-based replay protection.  These nodes MAY also implement
	       nonce-based replay protection 
</p>
<p>The style of replay protection in effect between any two peer nodes
	       among MN, FA and HA is part of the mobile security association.
	       A sending node and its receiving node MUST agree 
	       on which method of replay protection will be used.  The interpretation 
	       of the Identification field depends on the method of replay protection 
	       as described in the subsequent subsections.
</p>
<p>Whatever method is used, the low-order 32 bits of the Identification
	       MUST be copied unchanged 
	       from the GNM to the GNAM.  The receiver uses those bits (and the sender's 
	       source address) to match GNAM with corresponding replies.
	       The receiver MUST verify that the low-order 32 bits of any GNAM
	       are identical to the bits it sent in the GNM.
</p>
<p>The Identification in a new GNM MUST NOT be the same as in an immediately
	       preceding GNM, and SHOULD NOT repeat while the same security context is being
	       used between the MN and the HA.
</p>
<a name="sect.security.replay.timestamps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.1"></a><h3>7.1.1.&nbsp;
Replay Protection using Timestamps</h3>

<p>The basic principle of timestamp replay protection is that the node
		  generating a message inserts the current time of day, and the node
		  receiving the message checks that this timestamp is sufficiently
		  close to its own time of day.  Unless specified differently in the
		  security association between the nodes, a default value of 7 seconds
		  MAY be used to limit the time difference.  This value SHOULD be
		  greater than 3 seconds.  Obviously the two nodes must have adequately
		  synchronized time-of-day clocks.  As with any messages, time
		  synchronization messages may be protected against tampering by an
		  authentication mechanism determined by the security context between
		  the two nodes.
</p>
<p>In this document, the timestamps are used, the sender MUST set the 
		  Identification field to a 64-bit value formatted as specified by the 
		  Network Time Protocol (NTP) <a class='info' href='#RFC5905'>[RFC5905]<span> (</span><span class='info'>Mills, D., Martin, J., Burbank, J., and W. Kasch, &ldquo;Network Time Protocol Version 4: Protocol and Algorithms Specification,&rdquo; June&nbsp;2010.</span><span>)</span></a>.  The low-order 32 bits 
		  of the NTP format represent fractional seconds
		  .  Note, however, that when using timestamps, the 
		  64-bit Identification used in a GNM message from the sender MUST be 
		  greater than that used in any previous GNM message, as the receiver
		  uses this field also as a sequence number.  Without such a
		  sequence number, it would be possible for a delayed duplicate of an
		  earlier GNM message to arrive at the receiver (within the
		  clock synchronization required by the receiver), and thus be
		  applied out of order, mistakenly altering the sender's current status.
</p>
<p>Upon receipt of a GNM message with an authorization-enabling
		  extension, the receiver MUST check the Identification field for
		  validity.  In order to be valid, the timestamp contained in the
		  Identification field MUST be close enough to the receiver's time of
		  day clock and the timestamp MUST be greater than all previously
		  accepted timestamps for the requesting sender.  Time tolerances
		  and re-synchronization details are specific to a particular mobility
		  security association.
</p>
<p>If the timestamp is valid, the receiver copies the entire
		  Identification field into the GNAM it returns the GNAM message
		  to the sender.  If the timestamp is not valid, the receiver
		  copies only the low-order 32 bits into the GNAM, and
		  supplies the high-order 32 bits from its own time of day.  In this
		  latter case, the receiver MUST reject the registration by returning
		  Code 69/133/197 (identification mismatch) in the GNAM message.
</p>
<p>Furthermore, the receiver MUST verify that the low-order 32 bits of
		  the Identification in the GNAM are identical to those in the rejected 
		  GNM attempt, before using the high-order bits for clock re-synchronization.
</p>
<a name="sect.security.replay.nonces"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.2"></a><h3>7.1.2.&nbsp;
Replay Protection using Nonces</h3>

<p>The basic principle of nonce replay protection is that node A
		  includes a new random number in every message to node B, and checks
		  that node B returns that same number in its next message to node A.
		  Both messages use an authentication code to protect against
		  alteration by an attacker.  At the same time node B can send its own
		  nonces in all messages to node A (to be echoed by node A), so that it
		  too can verify that it is receiving fresh messages.
</p>
<p>The receiver may be expected to have resources for computing
		  pseudo-random numbers useful as nonces, according to <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>. 
		  It inserts a new nonce
		  as the high-order 32 bits of the identification field of every
		  GNAM message.  The receiver copies the low-order 32 bits of
		  the Identification from the GNM message into the
		  low-order 32 bits of the Identification in the GNAM message.
		  When the sender receives an authenticated GNAM message
		  from the receiver, it saves the high-order 32 bits of the
		  identification for use as the high-order 32 bits of its next
		  GNM message.
</p>
<p>The sender is responsible for generating the low-order 32 bits
		  of the Identification in each GNM message.  Ideally it
		  should generate its own random nonces.  However it may use any
		  expedient method, including duplication of the random value sent by
		  the receiver.  The method chosen is of concern only to the sender
		  , because it is the node that checks for valid values in the
		  GNAM message.  The high-order and low-order 32 bits of the
		  identification chosen SHOULD both differ from their previous values.
		  The receiver uses a new high-order value and the sender uses a
		  new low-order value for each registration message.
</p>
<p>If a GNM message is rejected because of an invalid nonce,
		  the GNAM always provides the sender with a new nonce to be used
		  in the next registration.  Thus the nonce protocol is self-
		  synchronizing.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Non-authentication Extensions Handling in Foreign Agent</h3>

<p>When the FA is relaying the GNM message between the MN and the HA, 
	       and if the FA does not share a mobility security association with the
	       MN or HA, all non-authentication extensions between MN and FA, or FA and 
	       HA are not protected; In this case, all non-authentication extensions
	       should be silently discarded.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>The author appreciate the efforts of Ahmad Muhanna for his detail reviewing of
	    this document and his many contributions to the text of this document.
	    The author also wants to thank Kent Leung, Peng Yang and Peter McCann et al. 
	    for their helping developing this document.  Thanks to Alexey Melnikov,
	    Sean Turner, Ralph Droms, Charles E. Perkins, Russ Housley, Magnus Westerlund, 
	    Lars Eggert, Dan Romascanu, Tim Polk, Amanda Baber, Sebastian Thalanany, 
	    and Joseph Salowey's discussion and comments. 
	    Thanks to Jari Arkko for each step of this document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3344">[RFC3344]</a></td>
<td class="author-text">Perkins, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3344">IP Mobility Support for IPv4</a>,&rdquo; RFC&nbsp;3344, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3344.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3543">[RFC3543]</a></td>
<td class="author-text">Glass, S. and M. Chandra, &ldquo;<a href="http://tools.ietf.org/html/rfc3543">Registration Revocation in Mobile IPv4</a>,&rdquo; RFC&nbsp;3543, August&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3543.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4917">[RFC4917]</a></td>
<td class="author-text">Sastry, V., Leung, K., and A. Patel, &ldquo;<a href="http://tools.ietf.org/html/rfc4917">Mobile IPv4 Message String Extension</a>,&rdquo; RFC&nbsp;4917, June&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4917.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5905">[RFC5905]</a></td>
<td class="author-text">Mills, D., Martin, J., Burbank, J., and W. Kasch, &ldquo;<a href="http://tools.ietf.org/html/rfc5905">Network Time Protocol Version 4: Protocol and Algorithms Specification</a>,&rdquo; RFC&nbsp;5905, June&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5905.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5177">[RFC5177]</a></td>
<td class="author-text">Leung, K., Dommety, G., Narayanan, V., and A. Petrescu, &ldquo;<a href="http://tools.ietf.org/html/rfc5177">Network Mobility (NEMO) Extensions for Mobile IPv4</a>,&rdquo; RFC&nbsp;5177, April&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5177.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hui Deng</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China Mobile</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">53A,Xibianmennei Ave.,</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Xuanwu District,</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing  100053</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:denghui02@gmail.com">denghui02@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henrik Levkowetz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Netnod</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Franzengatan 5</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">S-104 25, Stockholm</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SWEDEN</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:henrik@levkowetz.com">henrik@levkowetz.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vijay Devarapalli</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">WiChorus</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3590 North First St</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dvijay@gmail.com">dvijay@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sri Gundavelli</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W.Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:sgundave@cisco.com">sgundave@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Haley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hewlett-Packard Company</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">110 Spitbrook Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nashua, NH  03062</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.haley@hp.com">brian.haley@hp.com</a></td></tr>
</table>
</body></html>
