<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Sieve Email Filtering: Include Extension</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Sieve Email Filtering: Include Extension">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">C. Daboo</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">A. Stone</td></tr>
<tr><td class="header">Expires: September 24, 2009</td><td class="header">March 23, 2009</td></tr>
</table></td></tr></table>
<h1><br />Sieve Email Filtering: Include Extension<br />draft-ietf-sieve-include-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 24, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The Sieve Email Filtering "include" extension permits users to include one Sieve script inside another. This can make managing large scripts or multiple sets of scripts much easier, as well as supporting common 'libraries' of scripts. Users are able to include their own personal scripts or site-wide scripts provided by the local Sieve implementation.
</p>
<h3>Change History (to be removed prior to publication as an RFC)</h3>

<p>Changes from daboo-06 to ietf-00:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>None
</dd>
</dl></blockquote>
<p>Changes from -05 to -06:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Aaron Stone joins as author.
</dd>
<dt>b.</dt>
<dd>Removed | characters from the script examples.
</dd>
<dt>c.</dt>
<dd>Updated draft references to published RFCs.
</dd>
</dl></blockquote>
<p>Changes from -04 to -05:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Fixed examples.
</dd>
<dt>b.</dt>
<dd>Relaxed requirement that imported/exported variables be set before being used.
</dd>
</dl></blockquote>
<p>Changes from -03 to -04:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Fixed missing 2119 definitions.
</dd>
<dt>b.</dt>
<dd>Defined interaction with variables through use of import and export commands.
</dd>
</dl></blockquote>
<p>Changes from -02 to -03:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Refreshing expired draft (updated for nits).
</dd>
<dt>b.</dt>
<dd>Syntax -> Usage.
</dd>
<dt>c.</dt>
<dd>Updated to 3028bis reference.
</dd>
</dl></blockquote>
<p>Changes from -01 to -02:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Minor formatting changes only - refreshing expired draft.
</dd>
</dl></blockquote>
<p>Changes from -00 to -01:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Added IPR boiler plate.
</dd>
<dt>b.</dt>
<dd>Re-ordered sections at start to conform to RFC style.
</dd>
<dt>c.</dt>
<dd>Moved recursion comment into General Considerations section.
</dd>
<dt>d.</dt>
<dd>Switched to using optional parameter to indicate personal vs global.
</dd>
<dt>e.</dt>
<dd>Explicitly state that an error occurs when a missing script is included.
</dd>
</dl></blockquote>
<h3>Open Issues (to be resolved prior to publication as an RFC)</h3>

<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Interaction with variables (scoping). Should variables be carried over between scripts that are included? Or should variables defined in an included script be local to that script only?
</dd>
</dl></blockquote><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction and Overview<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions Used in This Document<br />
<a href="#anchor3">3.</a>&nbsp;
Include Extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
General Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Control Structure Include<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Control Structure Return<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#variables">3.4.</a>&nbsp;
Interaction with Variables<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.4.1.</a>&nbsp;
Control Structure Import<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.4.2.</a>&nbsp;
Control Structure Export<br />
<a href="#anchor9">4.</a>&nbsp;
Security Considerations<br />
<a href="#iana">5.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana-include">5.1.</a>&nbsp;
&quot;include&quot; Extension Registration<br />
<a href="#rfc.references1">6.</a>&nbsp;
Normative References<br />
<a href="#anchor11">Appendix&nbsp;A.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction and Overview</h3>

<p>Its convenient to be able to break <a class='info' href='#RFC5228'>SIEVE<span> (</span><span class='info'>Guenther, P. and T. Showalter, &ldquo;Sieve: An Email Filtering Language,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5228] scripts down into smaller components which can be reused in a variety of different circumstances. For example, users may want to have a default script and a special 'vacation' script, the later being activated when the user goes on vacation. In that case the default actions should continue to be run, but a vacation command should be executed first. One option is to edit the default script to add or remove the vacation command as needed. Another is to have a vacation script that simply has a vacation command and then includes the default script.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used in This Document</h3>

<p>Conventions for notations are as in <a class='info' href='#RFC5228'>SIEVE<span> (</span><span class='info'>Guenther, P. and T. Showalter, &ldquo;Sieve: An Email Filtering Language,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5228] Section 1.1.
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Include Extension</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
General Considerations</h3>

<p>Sieve implementations that implement the "include", "return", "export" and "import" commands described below have an identifier of "include" for use with the capability mechanism. If any of the "include", "return", "export" or "import" commands are used in a script, the "include" capability MUST be listed in the "require" statement in that script.
</p>
<p>Sieve implementations must track the use of actions in included scripts so that implicit "keep" behavior can be properly determined based on whether any actions have executed in any script.
</p>
<p>Sieve implementations are allowed to limit the total number of nested included scripts, but MUST provide for a total of at least three levels of nested scripts including the top-level script. An error MUST be generated either when the script is uploaded to the Sieve repository, or when the script is executed, if any nesting limit is exceeded. If such an error is detected whilst processing a Sieve script, an implicit "keep" action MUST be executed to prevent loss of any messages.
</p>
<p>Sieve implementations MUST ensure that recursive includes are not possible. i.e. if script "A" includes script "B", and script "B" includes script "A" an error MUST be generated either when the script is uploaded to the Sieve repository, or when the script is executed. If such an error is detected whilst processing a Sieve script, an implicit "keep" action MUST be executed to prevent loss of any messages.
</p>
<p>Sieve implementations MUST handle missing scripts being referenced via an includes in an existing script. An error MUST be generated when a missing included script is discovered during execution. If such an error is detected an implicit "keep" action MUST be executed to prevent loss of any messages.
</p>
<p>If the Sieve "variables" extension <a class='info' href='#RFC5229'>[RFC5229]<span> (</span><span class='info'>Homme, K., &ldquo;Sieve Email Filtering: Variables Extension,&rdquo; January&nbsp;2008.</span><span>)</span></a> is present, an issue arises with the "scope" of variables defined in scripts that may include each other. For example, if a script defines the variable "${status}" with one particular meaning or usage, and another defines "${status}" with a different meaning, then if one script includes the other there is an issue as to which "${status}" is being referenced. To solve this problem, Sieve implementations MUST follow the scoping rules defined in <a class='info' href='#variables'>Section&nbsp;3.4<span> (</span><span class='info'>Interaction with Variables</span><span>)</span></a> and support the "import" and "export" commands defined there.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Control Structure Include</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Usage:   include [&lt;location: LOCATION&gt;] &lt;value: string&gt;

        LOCATION = ":personal" / ":global"
</pre></div>
<p>The "include" command includes an optional "location" parameter, and a single string argument representing the name of the script to include in the main script at that point.
</p>
<p>The "location" parameter defaults to ":personal" if not specified.
The "location" has the following meanings:
</p>
<p>
</p>
<blockquote class="text">
<p>:personal
</p>
<p>
</p>
<blockquote class="text">
<p>Indicates that the named script is stored in the user's own personal (private) Sieve repository.
</p>
</blockquote>
<p>
</p>
<p>:global
</p>
<p>
</p>
<blockquote class="text">
<p>Indicates that the named script is stored in a site-wide Sieve repository, accessible to all users of the Sieve system.
</p>
</blockquote>
</blockquote>
<p>The included script MUST be a valid Sieve script, including having necessary "require" statements for all optional capabilities used by the script. The scope of a "require" statement in an included script is for that script only, not the including script. e.g. if script "A" includes script "B", and script "B" uses the "fileinto" extension, script "B" must have a "require" statement for "fileinto", irrespective of whether script "A" has one. In addition, if script "A" does not have a "require" statement for "fileinto", "fileinto" cannot be used anywhere in script "A", even after inclusion of script "B".
</p>
<p>A "stop" command in an included script MUST stop all script processing, including the processing of the scripts that include the current one. The "return" command (described below) stops processing of the current script only, and allows the scripts that include it to continue.
</p>
<p>Examples:
</p>
<p>The user has four scripts stored in their personal repository:
</p>
<p>
</p>
<p>"default"
</p>
<p>
</p>
<blockquote class="text">
<p>This is the default active script that includes several others.
</p>
</blockquote><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["include"];

            include :personal "always_allow";
            include :global "spam_tests";
            include :personal "my_spam_tests";
            include :personal "mailing_lists";
</pre></div>
<p>"always_allow"
</p>
<p>
</p>
<blockquote class="text">
<p>This script special cases some correspondent email addresses and makes sure any message containing those addresses are always kept.
</p>
</blockquote><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            if header :is "From" "boss@example.com"
            {
                keep;
            }
            elsif header :is "From" "ceo@example.com"
            {
                keep;
            }
</pre></div>
<p>"my_spam_tests"
</p>
<p>
</p>
<blockquote class="text">
<p>This script does some user-specific spam tests to catch spam messages not caught by the site-wide spam tests.
</p>
</blockquote><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["reject"];

            if header :contains "Subject" "XXXX"
            {
                reject;
            }
            elsif header :is "From" "money@example.com"
            {
                reject;
            }
</pre></div>
<p>"mailing_lists"
</p>
<p>
</p>
<blockquote class="text">
<p>This script looks for messages from different mailing lists and files each into a mailbox specific to the mailing list.
</p>
</blockquote><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["fileinto"];

            if header :is "Sender" "owner-ietf-mta-filters@imc.org"
            {
                fileinto "lists.sieve";
            }
            elsif header :is "Sender" "owner-ietf-imapext@imc.org"
            {
                fileinto "lists.imapext";
            }
</pre></div>
<p>There is one script stored in the global repository:
</p>
<p>"spam_tests"
</p>
<p>
</p>
<blockquote class="text">
<p>This script does some site-wide spam tests which any user at the site can include in their own scripts at a suitable point. The script content is kept up to date by the site administrator.
</p>
</blockquote><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["reject"];

            if anyof (header :contains "Subject" "$$",
                      header :contains "Subject" "Make money")
            {
                reject;
            }
</pre></div>
<p>The "include" command may appear anywhere in the script where a control structure is legal.
</p>
<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["include"];

            if anyof (header :contains "Subject" "$$",
                      header :contains "Subject" "Make money")
            {
                include "my_reject_script";
            }
</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Control Structure Return</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Usage: return
</pre></div>
<p>The "return" command stops processing of the currently included script only and returns processing control to the script which includes it. If used in the main script (i.e. not in an included script), it has the same effect as the "stop" command, including the appropriate "keep" action if no other actions have been executed up to that point.
</p>
<a name="variables"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Interaction with Variables</h3>

<p>
In order to avoid problems of variables in an included script "overwriting" those from the script that includes it, this specification requires that all variables defined in a script MUST be kept "private" to that script by default - i.e. they are not "visible" to other scripts. This ensures that two script authors cannot inadvertently cause problems by choosing the same name for a variable.

</p>
<p>
However, sometimes there is a need to make a variable defined in one script available to others. This specification defines the new commands "export" and "import" to alter the default behavior of variable scoping to allow variables to be "seen" by other scripts. The "export" command takes a list of variable names defined in a script and makes those available to any script that explicitly wants to use them. The "import" command allows a script to gain access to variables that have been explicitly made available by other scripts. The explicit use of "export and "import", coupled with the default behavior of variables only having local scope, ensures that multiple scripts cannot inadvertently overwrite each others variables.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Control Structure Import</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Usage:   import &lt;value: string-list&gt;
</pre></div>
<p>The "import" command contains a string list argument that defines one or more names of variables exported by other scripts which should be made available to the current script.
</p>
<p>
The "import" command, if present, MUST be used immediately after any "require" commands (at least one of which will be present listing the "include" extension).  Multiple "import" commands are allowed. An error occurs if an "import" command appears after a command other than "require" or "import". Use of the "import" command makes the listed variables immediately available for use in the body of the script that uses it.

</p>
<p>
If an "import" command lists a variable that has not been exported by any other script at that point during the Sieve execution process, then an error MUST occur.

</p>
<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["variables", "fileinto", "include"];
            import "test";

            if header :contains "Subject" "${test}"
            {
                fileinto "INBOX.spam-${test};
            }
</pre></div>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Control Structure Export</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Usage:   export &lt;value: string-list&gt;
</pre></div>
<p>The "export" command contains a string list argument that defines one or more names of variables defined in the current script which should be made available to any scripts that run during the current Sieve script execution process.
</p>
<p>
The "export" command, if present, MUST be used immediately after any "require" or "import"  commands.  Multiple "export" commands are allowed. An error occurs if an "export" command appears after a command other than "require", "import" or "export".

</p>
<p>
An error occurs if an "export" command lists a variable that is listed in an "import" command preceding it in the current script.

</p>
<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["variables", "include"];
            export "test";

            set "test" "$$"
            include "spam_filter_script";

            set "test" "Make money"
            include "spam_filter_script";
</pre></div>
<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            require ["variables", "include"];
            import "test";
            export "test-mailbox";

            if header :contains "Subject" "${test}"
            {
                set "test-mailbox" "INBOX.spam-${test};
                include "fileinto-script"
            }
</pre></div>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>Sieve implementations MUST ensure adequate security for the global script repository to prevent unauthorized changes to global scripts.
</p>
<p>Beyond that, the "include" extension does not raise any security considerations that are not present in the base Sieve protocol, and these issues are discussed in Sieve.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>The following template specifies the IANA registration of the Sieve extension specified in this document:
</p>
<a name="iana-include"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
&quot;include&quot; Extension Registration</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Capability name: include
   Description:     add the "include" command to execute other Sieve
                    scripts.
   RFC number:      this RFC
   Contact address: the Sieve discussion list &lt;ietf-mta-filters@imc.org&gt;
</pre></div>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5228">[RFC5228]</a></td>
<td class="author-text">Guenther, P. and T. Showalter, &ldquo;<a href="http://tools.ietf.org/html/rfc5228">Sieve: An Email Filtering Language</a>,&rdquo; RFC&nbsp;5228, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5228.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5229">[RFC5229]</a></td>
<td class="author-text">Homme, K., &ldquo;<a href="http://tools.ietf.org/html/rfc5229">Sieve Email Filtering: Variables Extension</a>,&rdquo; RFC&nbsp;5229, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5229.txt">TXT</a>).</td></tr>
</table>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgments</h3>

<p>Thanks to Ken Murchison, Rob Siemborski, Alexey Melnikov, Marc Mutz and Kjetil Torgrim Homme for comments and corrections.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cyrus Daboo</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cyrus@daboo.name">cyrus@daboo.name</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Aaron Stone</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:aaron@serendipity.palo-alto.ca.us">aaron@serendipity.palo-alto.ca.us</a></td></tr>
</table>
</body></html>
