X = 0:

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
X = 1:

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
O=Example Inc, C=US ") as defined in RFC 1779. 

P = 1 indicates the location is for the ESP SA.

Hx   = host x
SGx  = security gateway x
PSx  = policy server x
Qx   = query x
Rx   = reply x

Pi = Si1 x Si2 x ... x Sik -> Ai

T = {U3}            o
                          / \
              ~lsanchez  /   \ (user) lsanchez

T = U              o
                  _______/|\_______
T=U1,U2 o                     o  T = U4
                         / \   (user)          / \
T=U1,U2 o
T = U1 o
                            / \
                       ~22 /   \  (dport) 22


T = U. First we choose to decorrelate the protocol selector. The 
T = U              o
                         /|
           ~199.93/16   / | (src) 199.93/16
T = U              o
                         /|
        ~199.100.2/24   / | (dst) 199.100.2/24

T = U. First we choose to decorrelate the src selector. The 
