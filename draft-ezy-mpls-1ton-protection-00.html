<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>MPLS-TP 1toN Protection</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 1:n Protection architecture">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Path priority">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Preemption">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Contributing authors">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions used in this document">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Acronyms">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Definitions and Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Changes to PSC">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 PSC">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Changes to PSC Payload">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Acknowledge (K) flag">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Fault path (FPath) field">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Data path (Path) field">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Changes to PSC Operation">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Basic operation">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Two-phased operation">
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 Acknowledge message">
<link href="#rfc.section.3.3.4" rel="Chapter" title="3.3.4 Wait for Acknowledge (Wfa) timer">
<link href="#rfc.section.3.3.5" rel="Chapter" title="3.3.5 Additional PSC State">
<link href="#rfc.section.3.3.5.1" rel="Chapter" title="3.3.5.1  Wait for Acknowledge (Wfa) State">
<link href="#rfc.section.4" rel="Chapter" title="4 IANA Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A PSC state machine tables">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="As part of the Transport Profile for Multiprotocol Label Switching (MPLS-TP) there is a requirement to support 1:n linear protection for transport paths.  This requirement is elaborated on in the MPLS-TP Survivability Framework document " />
  <meta name="description" content="As part of the Transport Profile for Multiprotocol Label Switching (MPLS-TP) there is a requirement to support 1:n linear protection for transport paths.  This requirement is elaborated on in the MPLS-TP Survivability Framework document " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">E. Osborne</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">F. Zhang</td>
</tr>
<tr>
<td class="left">Expires: January 01, 2012</td>
<td class="right">ZTE</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Y. Weingarten</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">June 30, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">MPLS-TP 1toN Protection<br />
  <span class="filename">draft-ezy-mpls-1ton-protection-00.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>As part of the Transport Profile for Multiprotocol Label Switching (MPLS-TP) there is a requirement to support 1:n linear protection for transport paths.  This requirement is elaborated on in the MPLS-TP Survivability Framework document <a href="#SurvivFwk">[SurvivFwk]</a>.  The basic protocol for linear protection was specified in the MPLS-TP Linear Protection document <a href="#LinProt">[LinProt]</a> but is limited to 1+1 and 1:1 protection.  This document extends the protocol defined there to address the additional functionality necessary to support scenarios of a single protection path preconfigured to provide protection of multiple transport paths between two joint endpoints.</p>
<p>This document is a product of a joint Internet Engineering Task Force (IETF) / International Telecommunications Union Telecommunications Standardization Sector (ITU-T) effort to include an MPLS Transport Profile within the IETF MPLS and PWE3 architectures to support the capabilities and functionalities of a packet transport network as defined by the ITU-T. </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 01, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">1:n Protection architecture</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Path priority</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Preemption</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Contributing authors</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions used in this document</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Acronyms</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Definitions and Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Changes to PSC</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">PSC</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Changes to PSC Payload</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Acknowledge (K) flag</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Fault path (FPath) field</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Data path (Path) field</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Changes to PSC Operation</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Basic operation</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Two-phased operation</a>
</li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">Acknowledge message</a>
</li>
<li>3.3.4.   <a href="#rfc.section.3.3.4">Wait for Acknowledge (Wfa) timer</a>
</li>
<li>3.3.5.   <a href="#rfc.section.3.3.5">Additional PSC State</a>
</li>
<li>3.3.5.1.   <a href="#rfc.section.3.3.5.1"> Wait for Acknowledge (Wfa) State</a>
</li>
<li>4.   <a href="#rfc.section.4">IANA Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgements</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">PSC state machine tables</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The MPLS Transport Profile (MPLS-TP) Requirements document <a href="#TPReq">[TPReq]</a> includes requirements for the necessary survivability tools that are required for MPLS based transport networks.  Network survivability is the ability of a network to recover traffic delivery following failure, or degradation of network resources.  Requirement 67 lists various types of 1:n  protection architectures that are required for MPLS-TP.  The MPLS-TP Survivability Framework <a href="#SurvivFwk">[SurvivFwk]</a> is a framework for survivability in MPLS-TP networks, and describes recovery elements, types, methods, and topological considerations, focusing on mechanisms for recovering MPLS-TP Label Switched Paths (LSPs).</p>
<p id="rfc.section.1.p.2">Linear protection in mesh networks &#8211; networks with arbitrary interconnectivity between nodes &#8211; is described in Section 4.7 of <a href="#SurvivFwk">[SurvivFwk]</a>.  Linear protection provides rapid and simple protection switching.  In a mesh network, linear protection provides a very suitable protection mechanism because it can operate between any pair of points within the network.  It can protect against a defect in an intermediate node, a span, a transport path segment, or an end-to-end transport path.</p>
<p><a href="#LinProt">[LinProt]</a> defines a Protection State Coordination (PSC) protocol that supports the different 1+1 and 1:1 architectures described in <a href="#SurvivFwk">[SurvivFwk]</a>.  The PSC protocol is a single-phased protocol that allows the two endpoints of the protection domain to coordinate the protection switching operation when a switching condition is detected on the transport paths of the protection domain.</p>
<p id="rfc.section.1.p.4">This document extends the PSC protocol to allow it to support a protection domain that includes multiple working transport paths that are protected by a single protection transport path.  The protection transport path is pre-allocated with resources to transport the traffic normally carried by any one of the working transport paths.  This is the architecture described in <a href="#SurvivFwk">[SurvivFwk]</a> as 1:n protection, and is the generalization of the 1:1 protection architecture already supported by PSC.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> 1:n Protection architecture</h1>
<p id="rfc.section.1.1.p.1">Linear protection switching is a fully allocated survivability mechanism. It is fully allocated in the sense that the route and bandwidth of the protection path is reserved for a set of working paths. For 1:n protection the protection path is allocated to protect any one of n working paths between the two endpoints of the protection domain.</p>
<div id="#rfc.figure.1"></div>
<div id="#figure1"></div>
<pre>
            +-----+                             +-----+
            |     |=============================|     |
            |LER-A|     Working Path #1         |LER-Z|
            |     |                             |     |
            |     |=============================|     |
            |     |     Working Path #2         |     |
            |     |                             |     |
            |     |=============================|     |
            |     |     Working Path #3         |     |
            |     |                             |     |
            |     |      ooo                    |     |
            |     |                             |     |
            |     |=============================|     |
            |     |     Working Path #N         |     |
            |     |                             |     |
            |     |    Protection Path          |     |
            |     |*****************************|     |
            |     |                             |     |
            +-----+                             +-----+

                  |--------Protection Domain--------|

   		  </pre>
<p><a href="#figure1">Figure 1</a> shows a protection domain with N working transport paths and a single protection path.  In 1:n protection, it is assumed (as mentioned above) that the protection path may transport the traffic of only a single working path at any particular time.  The identity of the working path that is being protected must be communicated between the two endpoints.</p>
<p id="rfc.section.1.1.p.3">The different working paths may be disjoint at the intermediary points on the path between LER-A and LER-Z and may also have different resource requirements.  In addition, each of the working paths may be assigned a priority that could be used to decide which working path would be protected in cases of conflict (see more on this topic in <a href="#Preempt">Section 1.3</a>).  It is usually advised to arrange these protection groups in a way that would minimize any potential conflict situation.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Path priority</h1>
<p id="rfc.section.1.2.p.1">As the 1:n architecture requires the ability for one working path to preempt the traffic of another in the event of multiple failures (see <a href="#Preempt">Section 1.3</a>), there must be an indication of priority between the different working paths so that an implementation can decide whether a new failure should be allowed to preempt a protection switch already in place.  This priority is purely a local decision, i.e., determined by configuration at both endpoints of the protection domain.  It is also possible to assign the same priority to multiple working paths, thus creating a "first come first served" preemption policy.  This document provides no means to signal the priority of a given working path, nor a means to detect priority mismatches	or misconfigurations.  Any mismatch or misconfiguration will likely result in unexpected protection behavior.</p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#Preempt" id="Preempt">Preemption</a>
</h1>
<p id="rfc.section.1.3.p.1">Preemption occurs when the protection path is being used to transport traffic and is then required to transport traffic for a service with higher priority.  At this point, the current traffic that is being transported on the protection path needs to be interrupted to allow the transport of the protected traffic.</p>
<p id="rfc.section.1.3.p.2">There are two basic scenarios for preemption of traffic &#8211; </p>

<ol>
<li>When the protection path is used to transport "extra traffic".  While this practice is discouraged by <a href="#TPReq">[TPReq]</a>, it is still not precluded.  When the protection domain triggers a protection switch, the extra traffic should be preempted to allow the transport of the protected traffic from the working path that triggered the switching operation.  The subsequent treatment of the interrupted service is out of the scope of this document.</li>
<li>When the protection path is transporting traffic from a working path and a second working path triggers a switching condition.  This second trigger may either be a trigger with a higher priority (e.g. FS after a SF) or because the operator had assigned a higher priority to the working path of the second trigger.  At this point, the traffic for the lower priority working path will be interrupted, and the higher priority traffic will be transmitted on the protection path.  The preempted traffic will only renew transmission, when either the working path recovers, or the higher priority traffic relinquishes control of the protection path.</li>
</ol>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> Contributing authors</h1>
<p id="rfc.section.1.4.p.1">Nurit Sprecher (NSN)</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Conventions used in this document</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Acronyms</h1>
<div id="#rfc.table.1"></div>
<p>This draft uses the following acronyms:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left"></th>
<th class="left"></th>
</tr></thead>
<tbody>
<tr>
<td class="left">Ack</td>
<td class="left">Acknowledge</td>
</tr>
<tr>
<td class="left">DNR</td>
<td class="left">Do not revert</td>
</tr>
<tr>
<td class="left">FS</td>
<td class="left">Forced Switch</td>
</tr>
<tr>
<td class="left">LER</td>
<td class="left">Label Edge Router</td>
</tr>
<tr>
<td class="left">LO</td>
<td class="left">Lockout of protection</td>
</tr>
<tr>
<td class="left">MPLS-TP</td>
<td class="left">Transport Profile for MPLS</td>
</tr>
<tr>
<td class="left">MS</td>
<td class="left">Manual Switch</td>
</tr>
<tr>
<td class="left">NR</td>
<td class="left">No Request</td>
</tr>
<tr>
<td class="left">P2P</td>
<td class="left">Point-to-point</td>
</tr>
<tr>
<td class="left">P2MP</td>
<td class="left">Point-to-multipoint</td>
</tr>
<tr>
<td class="left">PSC</td>
<td class="left">Protection State Coordination Protocol</td>
</tr>
<tr>
<td class="left">SD</td>
<td class="left">Signal Degrade</td>
</tr>
<tr>
<td class="left">SF</td>
<td class="left">Signal Fail</td>
</tr>
<tr>
<td class="left">Wfa</td>
<td class="left">Wait for Acknowledge</td>
</tr>
<tr>
<td class="left">WTR</td>
<td class="left">Wait-to-Restore</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Definitions and Terminology</h1>
<p id="rfc.section.2.2.p.1">The terminology used in this document is based on the terminology defined in <a href="#RFC4427">[RFC4427]</a> and further adapted for MPLS-TP in <a href="#SurvivFwk">[SurvivFwk]</a>. In addition, we use the term LER to refer to a MPLS-TP Network Element, whether it is a LSR, LER, T-PE, or S-PE.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Changes to PSC</h1>
<p id="rfc.section.3.p.1">The Protection State Coordination protocol (PSC) is defined in <a href="#LinProt">[LinProt]</a>.  This includes both the format of the G-ACh based message as well as a description of the operations and the state transition logic of the protocol.  The extension to cover 1:n protection includes changes to both aspects of PSC.</p>
<p id="rfc.section.3.p.2">The changes to the message structure, include both the addition of new information and extension of the semantics of some of the existing fields of the message.  These changes will be described in <a href="#sub2">Section 3.2</a>.</p>
<p id="rfc.section.3.p.3">The changes relative to the behavior of the base PSC protocol will be described in <a href="#sub3">Section 3.3</a>.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> PSC</h1>
<p id="rfc.section.3.1.p.1">Base PSC (as defined in <a href="#LinProt">[LinProt]</a> is a single-phased protocol, i.e. the endpoints perform protection switching without waiting for acknowledgement from the far end LER.  The protocol messages are transmitted using the G-ACh and the format is described in <a href="#figure2">Figure 2</a>.</p>
<div id="#rfc.figure.2"></div>
<div id="#figure2"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |0 0 0 1|Version|  Reserved     |          PSC-CT               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Ver|Request|PT |R|  Reserved1  |     FPath     |     Path      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         TLV Length            |         Reserved2             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                         Optional TLVs                         ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
		  </pre>
<p id="rfc.section.3.1.p.2">In regards to the G-ACh Header no changes are suggested in the extensions for 1:n protection, i.e., the channel type field will continue to use the PSC-CT value defined in <a href="#LinProt">[LinProt]</a>.  The fields from the PSC payload which are affected by this document are the Ver field, the Reserved1 field, and the Fpath and Path fields.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#sub2" id="sub2">Changes to PSC Payload</a>
</h1>
<p id="rfc.section.3.2.p.1">In order to support 1:n protection there is a need to make changes to the format of the PSC payload (see <a href="#figure3">Figure 3</a>).  In particular, there is the need to add a new field to the payload to indicate an acknowledge of a protection switching operation.  In addition, the semantics of the FPath and Path field are adjusted to indicate an index of the multiple working paths.  The details of these changes are supplied in the following subsections.</p>
<p id="rfc.section.3.2.p.2">Due to the significance of these changes, the value of the Ver field (in the PSC payload) for 1:n protection domain MUST be set to 2.</p>
<div id="#rfc.figure.3"></div>
<div id="#figure3"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Ver|Request|PT |R|K| Reserved1 |     FPath     |     Path      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         TLV Length            |         Reserved2             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                         Optional TLVs                         ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
		  </pre>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Acknowledge (K) flag</h1>
<p id="rfc.section.3.2.1.p.1">The Acknowledge flag is used by an endpoint to acknowledge the request to preempt any current traffic on the parotection path and instead transmit the traffic from the requested working path.  See details in section x.y.</p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> Fault path (FPath) field</h1>
<p id="rfc.section.3.2.2.p.1">The Fpath field indicates which path is identified to be in a fault condition or affected by an administrative command.  The following are the possible values:</p>
<p></p>

<ul>
<li>0: indicates that the anomaly condition is on the protection path</li>
<li>1-128: indicates that the anomaly condition is on a working path whose index is indicated.</li>
<li>129-255: for future extensions or experimental use.</li>
</ul>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> Data path (Path) field</h1>
<p id="rfc.section.3.2.3.p.1">The Path field indicates which data is being transmitted on the protection path.  Under normal conditions, the protection path does not need to carry any user data traffic, but may carry extra traffic.  If there is a failure/degrade condition on one of the working paths, then that working path's data traffic will be transmitted over the protection path.  The following are the possible values:</p>
<p></p>

<ul>
<li>0: indicates that the protection path is not transporting user data traffic.</li>
<li>1-128: indicates that the protection path is transmitting user traffic replacing the use of the working path indexed.</li>
<li>129-255: for future extensions or experimental use.</li>
</ul>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#sub3" id="sub3">Changes to PSC Operation</a>
</h1>
<p id="rfc.section.3.3.p.1">In all of the following subsections, assume a protection domain between LER-A and LER-Z, using working paths 1-N and the protection path as shown in figure 1.</p>
<p id="rfc.section.3.3.p.2">A basic premise of this protection architecture is that both endpoints of the protection domain are configured to associate the indices of the working paths with the proper LSP identifiers.  If this condition is not met then the protection scheme will cause inconsistencies in traffic transmission.</p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Basic operation</h1>
<p id="rfc.section.3.3.1.p.1">Protection of the N working paths is based on the operational principles outlined in <a href="#LinProt">[LinProt]</a> and will employ the same basic Protection State Coordination Protocol (PSC) outlined in that document.  However, as can be expected, due to certain basic differences in the architecture of the protection domain, a small set of differences in operation are necessary.  The following sub-sections will highlight these differences and explain their effects on the PSC state machine.</p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> Two-phased operation</h1>
<p id="rfc.section.3.3.2.p.1">PSC, as presented in <a href="#LinProt">[LinProt]</a> is a single-phased protocol.  This means that when an endpoint receives a trigger to perform a protection switch, the LER switches traffic and then notifies the far end of the switch, without waiting for acknowledgement.  When addressing the situation in a 1:n protection domain, the endpoint that receives the trigger must first verify that the protection path is available to transmit the protected traffic.  This may involve interrupting the traffic that is currently being transmitted on the protection path by both endpoints.</p>
<p id="rfc.section.3.3.2.p.2">In general, after the LER has detected a trigger for protection switching, e.g. a FS	operator command, or a SF indication for one of the working paths, the LER SHALL transmit the appropriate PSC message as described in <a href="#LinProt">[LinProt]</a> with the following changes: </p>

<ul>
<li>If the protection domain is currently in either Protecting administrative or Protecting failure state, then the endpoint SHALL verify that the new trigger has a higher priority than the currently protected traffic.  If the new trigger has a lower priority then it SHOULD be ignored.</li>
<li>The PSC message SHALL set the FPath value to the index of the working path that generated the trigger.  The Path value SHOULD be set to 0, unless the protection path was previously transporting traffic from another working path (as indicated by the value of the Path field.</li>
<li>If the protection path is currently transporting protected traffic, then the endpoint SHALL block all traffic of the protected working path.</li>
<li>The endpoint SHALL transfer to Wfa state (see below).</li>
<li>Upon reception of the switching PSC message, the far end LER SHALL verify that the received request is of higher priority than the known current traffic on the protection path, and if so SHALL interrupt the current traffic on the protection path, perform the switch to the requested protected traffic, and send an Acknowledge message (i.e. a PSC message with the Acknowledge flag set to 1) with the Path field set to the index of the protecteed working path.</li>
<li>Upon reception of the Acknowledge message, the initiating LER SHALL perform the protection switch and transmit the appropriate PSC message, with the FPath field indicating the index of the working path that triggered the protection switch and the Path field set to the index of the working path whose traffic is being transported on the protection path.</li>
</ul>
<h1 id="rfc.section.3.3.3">
<a href="#rfc.section.3.3.3">3.3.3.</a> Acknowledge message</h1>
<p id="rfc.section.3.3.3.p.1">As stated above, before performing a protection switch the endpoint that detected a switching trigger MUST wait for an Acknowledge message prior to performing the switch.  There are two types of message that will be considered as an Acknowledge message: </p>

<ol>
<li>A reply message with the Request field reflecting the state of the far end, and the Path field set to the index of the working path that triggered the switching condition.  For example, if there is a Forced Switch command detected by LER-Z on working path #4, then LER-Z will have sent an FS(4,0) message to LER-A.  Then when LER-Z receives a message such as NR(0,4)Ack this should be considered acknowledgement of the switching and that the protection path is available to switch the traffic from working path #4.</li>
<li>A remote message with the same Request field and FPath field as that transmitted by the LER in the Wfa state.  For example, if there is a bi- directional Signal fault detected by LER-A on working path #2, then LER-A will enter Wfa state and transmit a SF(4,0) message.  When it receives the SF(4,0) message from LER-Z, that has also detected the SF condition, it should be considered an acknowledgement of the switching and that the protection path is available to switch the traffic from working path #2.  </li>
</ol>
<h1 id="rfc.section.3.3.4">
<a href="#rfc.section.3.3.4">3.3.4.</a> Wait for Acknowledge (Wfa) timer</h1>
<p id="rfc.section.3.3.4.p.1">The protection system should include a timer called the Wait for Acknowledge (Wfa) timer that SHALL be started when the LER enters Wfa state and reset when the Acknowledge message is received.  The length of the Wfa timer SHOULD be configured to allow protection switching within the normal time constraints.  The Wfa timer will expire only if no Acknowledge message was recieved by the LER in Wfa state.  The Wfa Expires local input should have a priority just below that of the WTRExpires signal.</p>
<h1 id="rfc.section.3.3.5">
<a href="#rfc.section.3.3.5">3.3.5.</a> Additional PSC State</h1>
<p id="rfc.section.3.3.5.p.1">As described above, there is a need for the endpoint that is reporting on a trigger for protection-switching to delay the actual switchover until an acknowledge is received from the far end LER.  In order to facilitate this wait period it is necessary to define a new PSC State - Wait for Acknowledge (Wfa) state.  This state will be entered by the LER upon receiving a trigger for protection switching, and will be exited either upon receiving an acknowledge message or receiving a remote message indicating that the protection path is currently occupied by a higher priority request.</p>
<p id="rfc.section.3.3.5.p.2">The following sub-section will describe the actions to be taken when an LER is in the Wfa state.</p>
<h1 id="rfc.section.3.3.5.1">
<a href="#rfc.section.3.3.5.1">3.3.5.1.</a>  Wait for Acknowledge (Wfa) State</h1>
<p id="rfc.section.3.3.5.1.p.1">An LER will enter the Wait for Acknowledge state before transitioning into a protection state, i.e. either Protecting administrative or Protecting failure state.  The LER SHALL remain in this state until either receiving an Acknowledge message, or until a Wfa timer expires.  Normally, the Acknowledge message will be a remote PSC input.  The following describe how the LER, in Wfa state, should react to a new local input: </p>

<ul>
<li>A local Clear SHALL cause the LER to go into Normal state if the LER is in Wfa state due to either a FS or MS trigger and transmit an NR(0,0) PSC message.  If the LER is in Wfa state due to a SF trigger then the local Clear SHALL be ignored.</li>
<li>A local LO SHALL cause the LER to go into Unavailable state and begin to transmit LO(x, 0) [where x indicates the index of the working path that triggered the Wfa state].</li>
<li>A local FS SHALL cause the LER to remain in Wfa state and transmit the FS(x, 0) message [where x indicates the index of the protected working path].  If the LER is in Wfa state due to a FS from a different working path, then the working path with the higher priority SHALL be the protected working path. If the LER is in Wfa state due to any other switching trigger, then the working path that is identified in this FS will be the protected working path.</li>
<li>A local SF SHALL cause the LER to remain in Wfa state.  If the LER is in Wfa state due to an existing FS trigger, then ignore the local SF and continue to transmit the FS(x, 0) PSC message.  If the LER is in Wfa state due to an existing SF trigger then transmit the SF(x, 0) PSC message [where x indicates the index of protected working path, i.e. the highest priority working path indicating an SF condition].  If the LER is in Wfa state due to any other trigger, then begin transmitting a SF(x, 0) PSC message [where x indicates the index of the working path that is generating the SF condition].</li>
<li>A local ClearSF indication where the working path is the same as the path that triggered the LER into Wfa state SHALL cause the LER to go into WTR state (note: 1:N protection is always revertive) and to transmit the WTR(0, 0) message.  If the ClearSF indicates a different index from the protected working path or incates the protection path then the indication SHALL be ignored.</li>
<li>A local MS operator command SHALL cause the LER to remain in Wfa state.  If the LER is in Wfa state due an existing MS trigger, then the node continues to transmit MS(x, 0) messages [where x indicates the index of the protected working path, i.e. the highest prirority working path indicating the MS condition].  If the LER is in Wfa state due to any other trigger, ignore the MS command and continue transmitting the current message.</li>
<li>If the Wfa timer expires, i.e. the LER did not receive the Acknowledge message from the far end in a timely manner, then the LER SHALL go to Unavailable state, i.e. it assumes that there is a problem on the protection path (where all PSC traffic is transmitted) and send an error notification to the management system.  The LER SHALL continue transmitting the current PSC message with Path field set to 0.</li>
<li>All other local indications SHALL be ignored.</li>
</ul>
<p id="rfc.section.3.3.5.1.p.2">The following details the reactions of the LER in Wfa state to remote messages: </p>

<ul>
<li>Any remote message with the Acknowledge flag set to 1 and the Path field set to the index of the protected working path SHALL cause the LER to change state.  If the trigger was either FS or MS command, the LER enters Protecting administrative state. The LER transmits the appropriate message according to the trigger (i.e. FS(x,x) for FS command and MS(x,x) for the MS command).  If the trigger was a SF condition, then the LER enters the Protecting failure state and begins to transmit the appropriate SF(x, x) message.  A remote message with the Acknowledge flag set to 1 but where the Path field does not match, according to the description above, SHALL be ignored.</li>
<li>A remote LO message SHALL cause the LER to go into Unavailable state and transmit the appropriate message for the trigger that caused the Wfa state.</li>
<li>A remote FS message indicating the same working path as the local FS command that triggered the Wfa state SHALL be considered an Acknowledge message, even if the Acknowledge flag is not set.  The LER SHALL perform the protection switch, and begin transmitting the FS(x, x) message [where x indicates the index of the protected working path].  If the remote FS message indicates a different index than the one indicated in the local FS and if the remote FS message indicates a lower priority working path than the working path in the local FS trigger then the LER SHALL ignore the remote FS message and remain in Wfa state.  If the remote FS message indicates an index of higher priority or the LER is in Wfa state as a result of a SF or MS trigger, then the LER SHALL perform the protection switch for the protected working path indicated by the remote FS message, and SHALL go to Protecting administrative state and transmit the appropriate message for the local trigger with the Path field set to the index of the remote message and the Acknowledge flag set to 1.</li>
<li>A remote SF message indicating an error on the protection path SHALL cause the LER to go into Unavailable stateand transmit the appropriate message for the trigger that caused to Wfa state.</li>
<li>A remote SF message indicating an error on the same working path as the local SF condition that triggered the Wfa state SHALL be considered an Acknowledge message (even if the Acknowledge flag is not set).  The LER SHALL perform the protection switch, go to Protecting failure state and transmit the SF(x, x) message [where x is the index of the protected working path].  If the remote SF message indicates a different index than the one indicated in the local SF, then if the local command indicates a higher priority working path the LER SHALL ignore the remote SF message and remain in Wfa state.  If the remote SF message indicates an index of higher priority or the LER is in Wfa state as a result of a MS trigger, then the LER SHALL perform the protection switch for the protected working path indicated by the remote SF message, and SHALL go to Protecting failure state and transmit the appropriate message for the local trigger with the Path field set to the index of the remote message and the Acknowledge flag set to 1.  If the LER is in Wfa state due to a local FS command, then it SHALL ignore the remote message and remain in Wfa state.</li>
<li>A remote MS message indicating an error on the same working path as the local MS that triggered the Wfa state SHALL be considered an Acknowledge message (even if the Acknowledge flag is not set).  The LER SHALL perform the protection switch, go to Protecting administrative state and transmit the MS(x, x) message [where x is the index of the protected working path].  If the remote MS message indicates a different index than the one indicated in the local MS, then if the local command indicates a higher priority working path or the LER is in Wfa due to either a FS or SF trigger, the LER SHALL ignore the remote MS message and remain in Wfa state.  If the remote MS message indicates an index of higher priority, then the LER SHALL perform the protection switch for the protected working path indicated by the remote MS message, and SHALL go to Protecting administrative state and transmit an NR(0, y) with the Path field set to the index of the remote message and the Acknowledge flag set to 1.</li>
<li>All other remote messages SHOULD be ignored.</li>
</ul>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.4.p.1">This document does not include any required IANA considerations</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">The generic security considerations for the data-plane of MPLS-TP are described in the security framework document <a href="#SecureFwk">[SecureFwk]</a> together with the required mechanisms needed to address them.   The security considerations for the generic associated control channel are described in <a href="#RFC5586">[RFC5586]</a>.  The security considerations for protection and recovery aspects of MPLS-TP are addressed in <a href="#SurvivFwk">[SurvivFwk]</a>. </p>
<p id="rfc.section.5.p.2">The extensions to the protocol described in this document are extensions to the protocol defined in <a href="#LinProt">[LinProt]</a> and does not introduce any new security risks.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.6.p.1">The authors would like to thank all members of the teams (the Joint Working Team, the MPLS Interoperability Design Team in IETF and the T-MPLS Ad Hoc Group in ITU-T) involved in the definition and specification of MPLS Transport Profile.</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="TPReq">[TPReq]</b></td>
<td class="top">
<a>Niven-Jenkins, B.</a>, <a>Brungard, D.</a>, <a>Betts, M.</a>, <a>Sprecher, N.</a> and <a>S. Ueno</a>, "<a href="http://tools.ietf.org/html/rfc5654">Requirements of an MPLS Transport Profile</a>", RFC 5654, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="LinProt">[LinProt]</b></td>
<td class="top">
<a>Bryant, S.</a>, <a>Sprecher, N.</a>, <a>Osborne, E.</a>, <a>Fulignoli, A.</a> and <a>Y. Weingarten</a>, "<a>Multi-protocol Label Switching Transport Profile Linear Protection</a>", ID draft-ietf-mpls-tp-linear-protection-07.txt, Apr 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC5586">[RFC5586]</b></td>
<td class="top">
<a>Vigoureux,, M.</a>, <a>Bocci, M.</a>, <a>Swallow, G.</a>, <a>Aggarwal, R.</a> and <a>D. Ward</a>, "<a href="http://tools.ietf.org/html/rfc5586">MPLS Generic Associated Channel</a>", RFC 5586, May 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4427">[RFC4427]</b></td>
<td class="top">
<a>Mannie, E.</a> and <a>D. Papadimitriou</a>, "<a href="http://tools.ietf.org/html/rfc4427">Recovery Terminology for Generalized Multi-Protocol Label Switching</a>", RFC 4427, Mar 2006.</td>
</tr>
<tr>
<td class="reference"><b id="SurvivFwk">[SurvivFwk]</b></td>
<td class="top">
<a>Sprecher, N.</a>, <a>Farrel, A.</a> and <a>H. Shah</a>, "<a>Multi-protocol Label Switching Transport Profile Survivability Framework</a>", ID draft-ietf-mpls-tp-survive-fwk-02.txt, Feb 2009.</td>
</tr>
<tr>
<td class="reference"><b id="SecureFwk">[SecureFwk]</b></td>
<td class="top">
<a>Fang, L.</a>, <a>Niven-Jenkins, B.</a>, <a>Mansfield, S.</a>, <a>Zhang, R.</a>, <a>Bitar, N.</a>, <a>Daikoku, M.</a> and <a>L. Wang</a>, "<a>MPLS-TP Security Framework</a>", ID draft-ietf-mpls-tp-security-framework-00.txt, Feb 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#StateMachine" id="StateMachine">PSC state machine tables</a>
</h1>
<p id="rfc.section.Appendix A.p.1">The full PSC state machine is described in <a href="#LinProt">[LinProt]</a>, both in textual and tabular form.  This appendix highlights the changes to the basic PSC state machine.  In the event of a mismatch between these tables and the text either in <a href="#LinProt">[LinProt]</a> or in this document, the text is authoritative.  Note that this appendix is intended to be a functional description, not an implementation specification.</p>
<p id="rfc.section.Appendix A.p.2">The tables here use the same format and state descriptions used in the Linear Protection document with the addition of the Wfa state, Wfa Expires, and the changes in the behavior that is noted.</p>
<p id="rfc.section.Appendix A.p.3">Each state corresponds to the transmission of a particular set of Request, FPath and Path bits.  The table below lists the message that is generally sent in each particular state.  If the message to be sent in a particular state deviates from the table below, it is noted in the footnotes to the state-machine table.</p>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">State</th>
<th class="left">REQ(FP,P)</th>
</tr></thead>
<tbody>
<tr>
<td class="left">N</td>
<td class="left">NR(0,0)</td>
</tr>
<tr>
<td class="left">UA:LO:L</td>
<td class="left">LO(0,0)</td>
</tr>
<tr>
<td class="left">UA:P:L</td>
<td class="left">SF(0,0)</td>
</tr>
<tr>
<td class="left">UA:LO:R</td>
<td class="left">NR(0,0)</td>
</tr>
<tr>
<td class="left">UA:P:R</td>
<td class="left">NR(0,0)</td>
</tr>
<tr>
<td class="left">PF:W:L</td>
<td class="left">SF(1,1)</td>
</tr>
<tr>
<td class="left">PF:W:R</td>
<td class="left">NR(0,1)</td>
</tr>
<tr>
<td class="left">PA:F:L</td>
<td class="left">FS(1,1)</td>
</tr>
<tr>
<td class="left">PA:M:L</td>
<td class="left">MS(1,1)</td>
</tr>
<tr>
<td class="left">PA:F:R</td>
<td class="left">NR(0,1)</td>
</tr>
<tr>
<td class="left">PA:M:R</td>
<td class="left">NR(0,1)</td>
</tr>
<tr>
<td class="left">WTR</td>
<td class="left">WTR(0,1)</td>
</tr>
<tr>
<td class="left">DNR</td>
<td class="left">DNR(0,1)</td>
</tr>
</tbody>
</table>
<div id="#rfc.table.3"></div>
<p>The top row in each table is the list of possible inputs.  The local inputs are:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left"></th>
<th class="left"></th>
</tr></thead>
<tbody>
<tr>
<td class="left">NR</td>
<td class="left">No Request</td>
</tr>
<tr>
<td class="left">OC</td>
<td class="left">Operator Clear</td>
</tr>
<tr>
<td class="left">LO</td>
<td class="left">Lockout of protection</td>
</tr>
<tr>
<td class="left">SF-P</td>
<td class="left">Signal Fail on protection path</td>
</tr>
<tr>
<td class="left">SF-W</td>
<td class="left">Signal Fail on working path</td>
</tr>
<tr>
<td class="left">FS</td>
<td class="left">Forced Switch</td>
</tr>
<tr>
<td class="left">SFc</td>
<td class="left">Clear Signal Fail</td>
</tr>
<tr>
<td class="left">MS</td>
<td class="left">Manual Switch</td>
</tr>
<tr>
<td class="left">WTRExp</td>
<td class="left">WTR Expired</td>
</tr>
</tbody>
</table>
<div id="#rfc.table.4"></div>
<p>and the remote inputs are:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left"></th>
<th class="left"></th>
</tr></thead>
<tbody>
<tr>
<td class="left">LO</td>
<td class="left">remote LO message</td>
</tr>
<tr>
<td class="left">SF-P</td>
<td class="left">remote SF message indicating protection path</td>
</tr>
<tr>
<td class="left">SF-W</td>
<td class="left">remote SF message indicating working path</td>
</tr>
<tr>
<td class="left">FS</td>
<td class="left">remote FS message</td>
</tr>
<tr>
<td class="left">MS</td>
<td class="left">remote MS message</td>
</tr>
<tr>
<td class="left">WTR</td>
<td class="left">remote WTR message</td>
</tr>
<tr>
<td class="left">DNR</td>
<td class="left">remote DNR message</td>
</tr>
<tr>
<td class="left">NR</td>
<td class="left">remote NR message</td>
</tr>
</tbody>
</table>
<p id="rfc.section.Appendix A.p.4">Section 4.3.3 refers to some states as 'remote' and some as 'local'.  By definition, all states listed in the table of local sources are local states, and all states listed in the table of remote sources are remote states.  For example, section 4.3.3.1 says "A local Lockout of protection input SHALL cause the LER to go into local Unavailable State".  As the trigger for this state change is a local one, 'local Unavailable State' is by definition displayed in the table of local sources.  Similarly, "A remote Lockout of protection message SHALL cause the LER to go into remote Unavailable state" means that the state represented in the Unavailable rows in the table of remote sources is by definition a remote Unavailable state.</p>
<p id="rfc.section.Appendix A.p.5">Each cell in the table below contains either a state, a footnote, or the letter 'i'.  'i' stands for Ignore, and is an indication to continue with the current behavior.  See section 4.3.3.  The footnotes are listed below the table.</p>
<div id="#rfc.figure.4"></div>
<div id="#FSM1"></div>
<p>Part 1: Local input state machine</p>
<pre>
           | OC  | LO    | SF-P | FS   | SF-W | SFc  | MS   | WTRExp
   --------+-----+-------+------+------+------+------+------+-------
   N       | i   |UA:LO:L|UA:P:L|PA:F:L|PF:W:L| i    |PA:M:L| i
   UA:LO:L | N   | i     | i    | i    | i    | i    | i    | i
   UA:P:L  | i   |UA:LO:L| i    | i    | i    | [5]  | i    | i
   UA:LO:R | i   |UA:LO:L| [1]  | i    | [2]  | [6]  | i    | i
   UA:P:R  | i   |UA:LO:L|UA:P:L| i    | [3]  | [6]  | i    | i
   PF:W:L  | i   |UA:LO:L|UA:P:L|PA:F:L| i    | [7]  | i    | i
   PF:W:R  | i   |UA:LO:L|UA:P:L|PA:F:L|PF:W:L| i    | i    | i
   PA:F:L  | N   |UA:LO:L|UA:P:L| i    | i    | i    | i    | i
   PA:M:L  | N   |UA:LO:L|UA:P:L|PA:F:L|PF:W:L| i    | i    | i
   PA:F:R  | i   |UA:LO:L|UA:P:L|PA:F:L| [4]  | [8]  | i    | i
   PA:M:R  | i   |UA:LO:L|UA:P:L|PA:F:L|PF:W:L| i    |PA:M:L| i
   WTR     | i   |UA:LO:L|UA:P:L|PA:F:L|PF:W:L| i    |PA:M:L| [9]
   DNR     | i   |UA:LO:L|UA:P:L|PA:F:L|PF:W:L| i    |PA:M:L| i
		  </pre>
<div id="#rfc.figure.5"></div>
<div id="#FSM2"></div>
<p>Part 2: Remote messages state machine</p>
<pre>
           | LO    | SF-P | FS   | SF-W | MS   | WTR  | DNR  | NR
   --------+-------+------+------+------+------+------+------+------
   N       |UA:LO:R|UA:P:R|PA:F:R|PF:W:R|PA:M:R| i    | i    | i
   UA:LO:L | i     | i    | i    | i    | i    | i    | i    | i
   UA:P:L  | [10]  | i    | i    | i    | i    | i    | i    | i
   UA:LO:R | i     | i    | i    | i    | i    | i    | i    | [16]
   UA:P:R  |UA:LO:R| i    | i    | i    | i    | i    | i    | [16]
   PF:W:L  | [11]  | [12] |PA:F:R| i    | i    | i    | i    | i
   PF:W:R  |UA:LO:R|UA:P:R|PA:F:R| i    | i    | [14] | [15] | N 
   PA:F:L  |UA:LO:R|UA:P:R| i    | i    | i    | i    | i    | i 
   PA:M:L  |UA:LO:R|UA:P:R|PA:F:R| [13] | i    | i    | i    | i 
   PA:F:R  |UA:LO:R|UA:P:R| i    | i    | i    | i    | i    | [17] 
   PA:M:R  |UA:LO:R|UA:P:R|PA:F:R| [13] | i    | i    | i    | N 
   WTR     |UA:LO:R|UA:P:R|PA:F:R|PF:W:R|PA:M:R| i    | i    | [18]
   DNR     |UA:LO:R|UA:P:R|PA:F:R|PF:W:R|PA:M:R| i    | i    | i 
		  </pre>
<p id="rfc.section.Appendix A.p.6">The following are the footnotes for the table:</p>
<p id="rfc.section.Appendix A.p.7">[1]  Remain in the current state (UA:LO:R) and transmit SF(0,0)</p>
<p id="rfc.section.Appendix A.p.8">[2]  Remain in the current state (UA:LO:R) and transmit SF(1,0)</p>
<p id="rfc.section.Appendix A.p.9">[3]  Remain in the current state (UA:P:R) and transmit SF(1,0)</p>
<p id="rfc.section.Appendix A.p.10">[4]  Remain in the current state (PA:F:R) and transmit SF(1,1)</p>
<p id="rfc.section.Appendix A.p.11">[5]  If the SF being cleared is SF-P, Transition to N.  If it's SF-W, ignore the clear.</p>
<p id="rfc.section.Appendix A.p.12">[6]  Remain in current state (UA:x:R), if the SFc corresponds to a previous SF then begin transmitting NR(0,0).</p>
<p id="rfc.section.Appendix A.p.13">[7]  If domain configured for revertive behavior transition to WTR, else transition to DNR</p>
<p id="rfc.section.Appendix A.p.14">[8]  Remain in PA:F:R and transmit NR(0,1)</p>
<p id="rfc.section.Appendix A.p.15">[9]  Remain in WTR, send NR(0,1)</p>
<p id="rfc.section.Appendix A.p.16">[10] Transition to UA:LO:R continue sending SF(0,0)</p>
<p id="rfc.section.Appendix A.p.17">[11] Transition to UA:LO:R and send SF(1,0)</p>
<p id="rfc.section.Appendix A.p.18">[12] Transition to UA and send SF(1,0)</p>
<p id="rfc.section.Appendix A.p.19">[13] Transition to PF:W:R and send NR(0,1)</p>
<p id="rfc.section.Appendix A.p.20">[14] Transition to WTR state and continue to send the current message.</p>
<p id="rfc.section.Appendix A.p.21">[15] Transition to DNR state and continue to send the current message.</p>
<p id="rfc.section.Appendix A.p.22">[16] If the local input is SF-P then transition to UA:P:L. If the local input is SF-W then transition to PF:W:L. Else - transition to N state and continue to send the current message.</p>
<p id="rfc.section.Appendix A.p.23">[17] If the local input is SF-W then transition to PF:W:L. Else - transition to N state and continue to send the current message.</p>
<p id="rfc.section.Appendix A.p.24">[18] If the receiving LER's WTR timer is running, maintain current state and message. If the WTR timer is stopped, transition to N.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eric Osborne</span> 
	  <span class="n hidden">
		<span class="family-name">Osborne</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:eosborne@cisco.com">eosborne@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Fei Zhang</span> 
	  <span class="n hidden">
		<span class="family-name">Zhang</span>
	  </span>
	</span>
	<span class="org vcardline">ZTE</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">China</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:zhang.fei3@zte.com.cn">zhang.fei3@zte.com.cn</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yaacov Weingarten</span> 
	  <span class="n hidden">
		<span class="family-name">Weingarten</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>3 Hanagar St. Neve Ne'eman B</span>

	  <span class="vcardline">
		<span class="locality">Hod Hasharon</span>,  
		<span class="region"></span>
		<span class="code">45241</span>
	  </span>
	  <span class="country-name vcardline">Israel</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:yaacov.weingarten@nsn.com">yaacov.weingarten@nsn.com</a></span>

  </address>
</div>

</body>
</html>