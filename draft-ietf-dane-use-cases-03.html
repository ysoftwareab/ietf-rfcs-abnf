<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Use Cases and Requirements for DNS-based Authentication of Named Entities (DANE)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Definitions">
<link href="#rfc.section.3" rel="Chapter" title="3 Use Cases">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 CA Constraints">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Certificate Constraints">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Domain-Issued Certificates">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Delegated Services">
<link href="#rfc.section.4" rel="Chapter" title="4 Other Requirements">
<link href="#rfc.section.5" rel="Chapter" title="5 Acknowledgements">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Many current applications use the certificate-based authentication features in TLS to allow clients to verify that a connected server properly represents a desired domain name. Traditionally, this authentication has been based on PKIX trust hierarchies, rooted in well-known CAs, but additional information can be provided via the DNS itself. This document describes a set of use cases in which the DNS and DNSSEC could be used to make assertions that support the TLS authentication process." />
  <meta name="description" content="Many current applications use the certificate-based authentication features in TLS to allow clients to verify that a connected server properly represents a desired domain name. Traditionally, this authentication has been based on PKIX trust hierarchies, rooted in well-known CAs, but additional information can be provided via the DNS itself. This document describes a set of use cases in which the DNS and DNSSEC could be used to make assertions that support the TLS authentication process." />
  <meta name="keywords" content="dns, tls, pkix, dane" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">DANE</td>
<td class="right">R.L. Barnes</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">BBN Technologies</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">June 12, 2011</td>
</tr>
<tr>
<td class="left">Expires: December 14, 2011</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Use Cases and Requirements for DNS-based Authentication of Named Entities (DANE)<br />
  <span class="filename">draft-ietf-dane-use-cases-03.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Many current applications use the certificate-based authentication features in TLS to allow clients to verify that a connected server properly represents a desired domain name. Traditionally, this authentication has been based on PKIX trust hierarchies, rooted in well-known CAs, but additional information can be provided via the DNS itself. This document describes a set of use cases in which the DNS and DNSSEC could be used to make assertions that support the TLS authentication process.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on December 14, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Definitions</a>
</li>
<li>3.   <a href="#rfc.section.3">Use Cases</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">CA Constraints</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Certificate Constraints</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Domain-Issued Certificates</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Delegated Services</a>
</li>
<li>4.   <a href="#rfc.section.4">Other Requirements</a>
</li>
<li>5.   <a href="#rfc.section.5">Acknowledgements</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro-sec" id="intro-sec">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Transport-Layer Security (TLS) is used as the basis for security features in many modern Internet application service protocols to provide secure client-server connections <a href="#RFC5246">[RFC5246]</a>.  It underlies secure HTTP and secure email <a href="#RFC2818">[RFC2818]</a><a href="#RFC2595">[RFC2595]</a><a href="#RFC3207">[RFC3207]</a>, and provides hop-by-hop security in real-time multimedia and instant-messaging protocols <a href="#RFC3261">[RFC3261]</a><a href="#RFC6120">[RFC6120]</a>.</p>
<p id="rfc.section.1.p.2">Application service clients typically establish TLS connections to application servers identified by DNS domain names. The process of obtaining this "source" domain is application specific. The name could be entered by a user or found through an automated discovery process such as an SRV or NAPTR record. After obtaining the address of the server via an A or AAAA DNS record, the client conducts a TLS handshake with the server, during which the server presents a PKIX certificate <a href="#RFC5280">[RFC5280]</a>. The TLS layer performs PKIX validation of the certificate, including verification that the certificate chains to a trust anchor. If this validation is successful, then the application layer determines whether the DNS name for the application service presented in the certificate matches the source domain name <a href="#RFC6125">[RFC6125]</a>. Typically, if the name matches, then the client proceeds with the TLS connection.</p>
<p id="rfc.section.1.p.3">Thus the certificate authorities (CAs) that issue PKIX certificates are asserting bindings between domain names and the public keys they certify. Application service clients are verifying these bindings and making authorization decisions -- whether to proceed with connections -- based on them. </p>
<p id="rfc.section.1.p.4">With the advent of DNSSEC <a href="#RFC4033">[RFC4033]</a>, it is now possible for DNS name resolution to provide its information securely, in the sense that clients can verify that DNS information was provided by the domain holder and not tampered with in transit. The goal of technologies for DNS-based Authentication of Named Entities (DANE) is to use the DNS and DNSSEC to provide additional information about the cryptographic credentials associated with a domain, so that clients can use this information to increase the level of assurance they receive from the TLS handshake process. This document describes a set of use cases that capture specific goals for using the DNS in this way, and a set of requirements that the ultimate DANE mechanism should satisfy.</p>
<p id="rfc.section.1.p.5">Finally, it should be noted that although this document will frequently use HTTPS as an example application service, DANE is intended to apply equally to all applications that make use of TLS to connect to application services named by domain names.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#def-sec" id="def-sec">Definitions</a>
</h1>
<p id="rfc.section.2.p.1">This document also makes use of standard PKIX, DNSSEC, and TLS terminology. See RFC 5280 <a href="#RFC5280">[RFC5280]</a>, RFC 4033 <a href="#RFC4033">[RFC4033]</a>, and RFC 5246 <a href="#RFC5246">[RFC5246]</a>, respectively, for these terms. In addition, terms related to TLS-protected application services and DNS names are taken from RFC 6125 <a href="#RFC6125">[RFC6125]</a>.</p>
<p id="rfc.section.2.p.2">Note in particular that the term "server" in this document refers to the server role in TLS, rather than to a host. Multiple servers of this type may be co-located on a single physical host, using different ports, and each of these can use different certificates.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#lock-sec" id="lock-sec">Use Cases</a>
</h1>
<p id="rfc.section.3.p.1">In this section, we describe the major use cases that the DANE mechanism should support. This list is not intended to represent all possible ways that the DNS can be used to support TLS authentication.  Rather it represents the specific cases that comprise the initial goal for DANE.</p>
<p id="rfc.section.3.p.2">In the below use cases, we will refer to the following dramatis personae:</p>

<dl>
<dt>Alice:</dt>
<dd style="margin-left: 8">The operator of a TLS-protected application service on the host alice.example.com, and administrator of the corresponding DNS zone.</dd>
<dt>Bob:</dt>
<dd style="margin-left: 8">A client connecting to alice.example.com</dd>
<dt>Charlie:</dt>
<dd style="margin-left: 8">A well-known CA that issues certificates with domain names as identifiers</dd>
<dt>Oscar:</dt>
<dd style="margin-left: 8">An outsourcing provider that operates TLS-protected application services on behalf of customers</dd>
<dt>Trent:</dt>
<dd style="margin-left: 8">A CA that issues certificates with domain names as identifiers, but is not generally well-known.</dd>
</dl>
<p id="rfc.section.3.p.3">These use cases are framed in terms of adding verification steps to TLS server identity checking on the part of application service clients.  In application services where the clients are also identified by domain names (e.g., XMPP server-to-server connections), the same considerations and use cases can applied to the application server's checking of identities in TLS client certificates.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#ca-cons" id="ca-cons">CA Constraints</a>
</h1>
<p id="rfc.section.3.1.p.1">Alice runs a website on alice.example.com and has obtained a certificate from the well-known CA Charlie. She is concerned that other well-known CAs might issue certificates for alice.example.com without her authorization, which clients would accept. Alice would like to provide a mechanism for visitors to her site to know that they should expect alice.example.com to use a certificate issued under the CA that she uses (Charlie) and not another CA. That is, Alice is recommending that the client verify that there is a valid certificate chain from the server certificate to Charlie before accepting the server certificate. (For example, in the TLS handshake, the server might include Charlie's certificate in the server Certificate message's certificate_list structure <a href="#RFC5246">[RFC5246]</a>).</p>
<p id="rfc.section.3.1.p.2">When Bob connects to alice.example.com, he uses this mechanism to verify that that the certificate presented by the server was issued under the proper CA, Charlie. Bob also performs the normal PKIX validation procedure for this certificate, in particular verifying that the certificate chains to a trust anchor (possibly Charlie's CA, if Bob accepts Charlie's CA as a trust anchor).</p>
<p id="rfc.section.3.1.p.3">Alice may wish to provide similar information to an external CA operator Charlie. Prior to issuing a certificate for alice.example.com to someone claiming to Alice, Charlie needs to verify that Alice is actually requesting a certificate. Alice could indicate her preferred CA using DANE to CAs as well as RPs. Charlie could then check to see whether Alice said that her certificates should be issued by Charlie or another CA. Note that this check does not guaranteed that the precise entity requesting a certification from Charlie actually represents Alice, only that Alice has authorized Charlie to issue certificates for her domain to properly authorized individuals.</p>
<p id="rfc.section.3.1.p.4">Because these constraints do not increase the scope of PKIX-based assertions about domains, there is not a strict requirement for DNSSEC. Deletion of records removes the protection provided by this constraint, but the client is still protected by CA practices (as now). Injected or modified false records are not useful unless the attacker can also obtain a certificate for the target domain. In the worst case, tampering with these constraints increases the risk of false authentication to the level that is now standard.</p>
<p id="rfc.section.3.1.p.5">Nonetheless, using DANE in this way without also using DNSSEC represents provides a very small incremental security feature. Many common attacks against TLS connections already require the attacker to inject false A or AAAA records in order to steer the victim client to the attacker's server. An attacker that can already inject false DNS records can also fake DANE information (without DNSSEC) by simply spoofing the additional records required to carry the DANE information. </p>
<p id="rfc.section.3.1.p.6">Injected or modified false records can be used for denial of service, even if the attacker does not have a certificate for the target domain. If an attacker can modify DNS responses that a target host receives, however, there are already much simpler ways of denying service, such as providing a false A or AAAA record. In this case, DNSSEC is not helpful, since an attacker could still case a denial of service by blocking all DNS responses for the target domain.</p>
<p id="rfc.section.3.1.p.7">Continuing to require PKIX validation also limits the degree to which DNS operators (as distinct from the holders of domains) can interfere with TLS authentication through this mechanism. As above, even if a DNS operator falsifies DANE records, it cannot masquerade as the target server unless it can also obtain a certificate for the target domain.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Certificate Constraints</h1>
<p id="rfc.section.3.2.p.1">Alice runs a website on alice.example.com and has obtained a certificate from the well-known CA Charlie. She is concerned about additional, unauthorized certificates being issued by Charlie as well as by other CAs. She would like to provide a way for visitors to her site to know that they should expect alice.example.com to present the specific certificate issued by Charlie. In TLS terms, Alice is letting Bob know that this specific certificate must be the first certificate in the server Certificate message's certificate_list structure <a href="#RFC5246">[RFC5246]</a>.</p>
<p id="rfc.section.3.2.p.2">When Bob connects to alice.example.com, he uses this mechanism to verify that that the certificate presented by the server is the correct certificate. Bob also performs the normal PKIX validation procedure for this certificate, in particular verifying that the certificate chains to a trust anchor.</p>
<p id="rfc.section.3.2.p.3">The security considerations for this case are the same as for the "CA Constraints" case above.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#dom-iss" id="dom-iss">Domain-Issued Certificates</a>
</h1>
<p id="rfc.section.3.3.p.1">Alice would like to be able to generate and use certificates for her website on alice.example.com without involving an external CA at all. Alice can generate her own certificates today, making self-signed certificates and possibly certificates subordinate to those certificates. When Bob receives such a certificate in a TLS handshake, however, he doesn't automatically have a way to verify that the issuer of the certificate is actually Alice, since because he doesn't necessarily possess Alice's corresponding trust anchor. This concerns him because an attacker could present a different certificate and perform a man in the middle attack. Bob would like to protect against this.</p>
<p id="rfc.section.3.3.p.2">Alice would thus like to have a mechanism for visitors to her site to know that the certificates presented by her application services are legitimately hers. When Bob connects to alice.example.com, he uses this mechanism to verify that the certificate presented by the server has been issued by Alice. Since Bob can bind certificates to Alice in this way, he can use Alice's CA as a trust anchor for purposes of validating certificates for alice.example.com. Alice can additionally recommend that clients accept only her certificates using the CA constraints described above.</p>
<p id="rfc.section.3.3.p.3">As in Section <a href="#ca-cons">Section 3.1</a> above, Alice may wish to represent this information to potential third-party CAs (Charlie) as well as to relying parties (Bob). Since publishing a certificate in a DANE record of this form authorizes the holder of the corresponding private key to represent alice.example.com, a CA that has received a request to issue a certificate from alice.example.com could use the DANE information to verify the requestor's authorization to receive a certificate for that domain. For example, a CA might choose to issue a certificate for a given domain name and public key only when the holder of the domain name has provisioned DANE information with a certificate containing the public key.</p>
<p id="rfc.section.3.3.p.4">Note that this use case is functionally equivalent to the case where Alice doesn't issue her own certificates, but uses Trent's CA, which is not well-known. In this case, Alice would be advising Bob that he should treat Trent as a trust anchor for purposes of validating Alice's certificates, rather than a CA operated by Alice herself. Bob would thus need a way to securely obtain Trent's trust anchor information, namely through DANE information.</p>
<p id="rfc.section.3.3.p.5">Alice's advertising of trust anchor material in this way does not guarantee that Bob will accept the advertised trust anchor. For example, Bob might have out-of-band information (such as a pre-existing local policy) that indicates that the CA advertised by Alice (Trent's CA) is not trustworthy, which would lead him to decide not to accept Trent as a TA, and thus to reject Alice's certificate if it is issued under Trent's CA.</p>
<p id="rfc.section.3.3.p.6">Providing trust anchor material in this way clearly requires DNSSEC, since corrupted or injected records could be used by an attacker to cause clients to trust an attacker's certificate (assuming that the attacker's certificate is not rejected by some other local policy). Deleted records will only result in connection failure and denial of service, although this could result in clients re-connecting without TLS (a downgrade attack), depending on the application.  Therefore, in order for this use case to be safe, applications must forbid clients from falling back to unsecured channels when records appear to have been deleted (e.g., when a missing record has no NSEC or NSEC3 record).</p>
<p id="rfc.section.3.3.p.7">By the same token, this use case puts the most power in the hands of DNS operators. Since the operator of the appropriate DNS zone has de facto control over the content and signing of the zone, he can create false DANE records that bind a malicious party's certificate to a domain. This risk is especially important to keep in mind in cases where the operator of a DNS zone is a different entity than the holder of the domain, as in DNS hosting/outsourcing arrangements, since in these cases the DNS operator might be able to make changes to a domain that are not authorized by the holder of the domain.</p>
<p id="rfc.section.3.3.p.8">It should be noted that DNS operators already have the ability to obtain certificates for domains under their control, under certain CA policies. In the current system, CAs need to verify that an entity requesting a certificate for a domain is actually the legitimate holder of that domain. Typically this is done using information published about that domain, such as WHOIS email addresses or special records inserted into a domain. By manipulating these values, it is possible for DNS operators to obtain certificates from some well-known certificate authorities today without authorization from the true domain holder.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Delegated Services</h1>
<p id="rfc.section.3.4.p.1">In addition to guarding against CA mis-issue, CA constraints and certificate constraints can also be used to constrain the set of certificates that can be used by an outsourcing provider. Suppose that Oscar operates alice.example.com on behalf of Alice. In particular, Oscar then has de facto control over what certificates to present in TLS handshakes for alice.example.com. In such cases, there are few ways that DNS-based information about TLS certificates could be configured, for example:</p>

<ol>
<li>Alice has the A/AAAA records in her DNS and can sign them along with the DANE record, but Oscar and Alice now need to have tight coordination if the addresses and/or the certificates change.</li>
<li>Alice refers to Oscar's DNS by delegating a sub-domain name to Oscar, and has no control over the A/AAAA, DANE or any other pieces under Oscar's control.</li>
<li>Alice can put DANE records into her DNS server, but delegate the address records to Oscar's DNS server. This means that Alice can control the usage of certificates but Oscar is free to move the servers around as needed. The only coordination needed is when the certificates change, and then it would depend on how the DANE record is set up (i.e. a CA or an EE certificate pointer).</li>
</ol>
<p id="rfc.section.3.4.p.2">Which of these deployment patterns is used in a given deployment will determine what sort of constraints can be made. In cases where Alice controls DANE records (1 and 3), she can use CA and certificate constraints to control what certificates Oscar presents for Alice's application services. For instance, Alice might require Oscar to use certificates under a given set of CAs. This control, however, requires that Alice update DANE records when Oscar needs to change certificates. Cases where Oscar controls DANE records allow Oscar to maintain more autonomy from Alice, but by the same token, Alice cannot enforce any requirements on the certificates that Oscar presents in TLS handshakes.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Other Requirements</h1>
<p id="rfc.section.4.p.1">In addition to supporting the above use cases, the DANE mechanism must satisfy several lower-level operational and protocol requirements and goals.</p>
<p></p>

<dl>
<dt>Multiple Ports:</dt>
<dd style="margin-left: 8">DANE should be able to support multiple application services with different credentials on the same named host, distinguished by port number.</dd>
<dt>No Downgrade:</dt>
<dd style="margin-left: 8">An attacker who can tamper with DNS responses must not be able to make a DANE-compliant client treat a site that has deployed DANE and DNSSEC like a site that has deployed neither.</dd>
<dt>Encapsulation:</dt>
<dd style="margin-left: 8">If there is DANE information for the name alice.example.com, it must only affect application services hosted at alice.example.com.</dd>
<dt>Predictability:</dt>
<dd style="margin-left: 8">Client behavior in response to DANE information must be spelled out in the DANE specification as precisely as possible, especially for cases where DANE information might conflict with PKIX information.</dd>
<dt>Opportunistic Security</dt>
<dd style="margin-left: 8">The DANE mechanism must allow a clients to determine whether DANE information is available for a site, so that a client can provide the highest level of security possible for a given application service. Clients that do not support DANE should continue to work as if DANE information were not present.</dd>
<dt>Combination:</dt>
<dd style="margin-left: 8">The DANE mechanism must allow multiple DANE statements of the above forms to be combined. For example, a domain holder should be able to specify its own CA (Section <a href="#dom-iss">Section 3.3</a>) and require that no other be used (Section <a href="#ca-cons">Section 3.1</a>).</dd>
<dt>Roll-over:</dt>
<dd style="margin-left: 8">The DANE mechanism must allow a site to transition from using one DANE mechanism to another. For example, a domain holder should be able to migrate from using DANE to assert a domain issued certificate (Section <a href="#dom-iss">Section 3.3</a>) to using DANE to require an external CA (Section <a href="#ca-cons">Section 3.1</a>), or vice versa. The DANE mechanism must also allow roll-over between records of the same-type, e.g., when changing CAs.</dd>
<dt>Simple Key Management:</dt>
<dd style="margin-left: 8">DANE should have a mode in which the domain holder only needs to maintain a single long-lived public/private key pair.</dd>
<dt>Minimal Dependencies:</dt>
<dd style="margin-left: 8">It should be possible for a site to deploy DANE without also deploying anything else, except DNSSEC.</dd>
<dt>Minimal Options:</dt>
<dd style="margin-left: 8">Ideally, DANE should have only one operating mode. Practically, DANE should have as few operating modes as possible.</dd>
<dt>Wild Cards:</dt>
<dd style="margin-left: 8">The mechanism for distributing DANE information should allow the use of DNS wild card labels (*) for setting DANE information for all names within a wild card expansion.</dd>
<dt>Redirection:</dt>
<dd style="margin-left: 8">The mechanism for distributing DANE information should work when the application service name is the result of following a DNS redirection time (e.g., via CNAME or DNAME).</dd>
</dl>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#ack-sec" id="ack-sec">Acknowledgements</a>
</h1>
<p id="rfc.section.5.p.1">Thanks to Eric Rescorla for the initial formulation of the use cases, Zack Weinberg and Phillip Hallam-Baker for contributing other requirements, and the whole DANE working group for helpful comments on the mailing list.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana-sec" id="iana-sec">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">This document makes no request of IANA.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#sec-cons-sec" id="sec-cons-sec">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The primary focus of this document is the enhancement of TLS authentication procedures using the DNS. The general effect of such mechanisms is to increase the role of DNS operators in authentication processes, either in place of or in addition to traditional third-party actors such as commercial certificate authorities. The specific security implications of the respective use cases are discussed in their respective sections above.</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2595">[RFC2595]</b></td>
<td class="top">
<a href="mailto:chris.newman@innosoft.com" title="Innosoft International, Inc.">Newman, C.</a>, "<a href="http://tools.ietf.org/html/rfc2595">Using TLS with IMAP, POP3 and ACAP</a>", RFC 2595, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2818">[RFC2818]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3207">[RFC3207]</b></td>
<td class="top">
<a>Hoffman, P.</a>, "<a href="http://tools.ietf.org/html/rfc3207">SMTP Service Extension for Secure SMTP over Transport Layer Security</a>", RFC 3207, February 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3261">[RFC3261]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a>, <a>Camarillo, G.</a>, <a>Johnston, A.</a>, <a>Peterson, J.</a>, <a>Sparks, R.</a>, <a>Handley, M.</a> and <a>E. Schooler</a>, "<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>", RFC 3261, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6120">[RFC6120]</b></td>
<td class="top">
<a>Saint-Andre, P.</a>, "<a href="http://tools.ietf.org/html/rfc6120">Extensible Messaging and Presence Protocol (XMPP): Core</a>", RFC 6120, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Richard Barnes</span> 
	  <span class="n hidden">
		<span class="family-name">Barnes</span>
	  </span>
	</span>
	<span class="org vcardline">BBN Technologies</span>
	<span class="adr">
	  <span>9861 Broken Land Parkway</span>

	  <span class="vcardline">
		<span class="locality">Columbia</span>,  
		<span class="region">MD</span> 
		<span class="code">21046</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: +1 410 290 6169</span>

<span class="vcardline">EMail: <a href="mailto:rbarnes@bbn.com">rbarnes@bbn.com</a></span>

  </address>
</div>

</body>
</html>