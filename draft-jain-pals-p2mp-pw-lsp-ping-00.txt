



PALS Workgroup                                                   P. Jain
Internet-Draft                                                S. Boutros
Intended status: Standards Track                     Cisco Systems, Inc.
Expires: September 10, 2015                                March 9, 2015


           Definition of P2MP PW TLV for LSP-Ping Mechanisms
                  draft-jain-pals-p2mp-pw-lsp-ping-00

Abstract

   LSP-Ping is a widely deployed Operation, Administration, and
   Maintenance (OAM) mechanism in MPLS networks.  This document
   describes a mechanism to verify connectivity of Point-to-Multipoint
   (P2MP) Pseudowires (PW) using LSP Ping.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 10, 2015.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




Jain & Boutros         Expires September 10, 2015               [Page 1]

Internet-Draft              P2MP PW LSP Ping                  March 2015


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Specification of Requirements . . . . . . . . . . . . . . . .   3
   3.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  Identifying a P2MP PW . . . . . . . . . . . . . . . . . . . .   3
     4.1.  FEC 130 Pseudowire Sub-TLV  . . . . . . . . . . . . . . .   3
   5.  Operations  . . . . . . . . . . . . . . . . . . . . . . . . .   4
   6.  Encapsulation of OAM Ping Packets . . . . . . . . . . . . . .   5
   7.   Echo Reply using Downstream Assigned Label . . . . . . . . .   6
   8.  Controlling Echo Responses  . . . . . . . . . . . . . . . . .   6
   9.  Security Considerations . . . . . . . . . . . . . . . . . . .   6
   10. IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
   11. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   6
   12. References  . . . . . . . . . . . . . . . . . . . . . . . . .   6
     12.1.  Normative References . . . . . . . . . . . . . . . . . .   6
     12.2.  Informative References . . . . . . . . . . . . . . . . .   7
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7

1.  Introduction

   A Point-to-Multipoint (P2MP) Pseudowire (PW) emulates the essential
   attributes of a unidirectional P2MP Telecommunications service such
   as P2MP ATM over PSN.  Requirements for P2MP PW are described in
   [RFC7338].  P2MP PWs are carried over P2MP MPLS LSP.  The Procedure
   for P2MP PW signaling using LDP for single segment P2MP PWs are
   described in [I-D.ietf-pwe3-p2mp-pw].  Many P2MP PWs can share the
   same P2MP MPLS LSP and this arrangement is called Aggregate P-tree.
   The aggregate P2MP trees require an upstream assigned label so that
   on the tail of the P2MP LSP, the traffic can be associated with a VPN
   or a VPLS instance.  When a P2MP MPLS LSP carries only one VPN or
   VPLS service instance, the arrangement is called Inclusive P-Tree.
   For Inclusive P-Trees, P2MP MPLS LSP label itself can uniquely
   identify the VPN or VPLS service being carried over P2MP MPLS LSP.
   The P2MP MPLS LSP can also be used in Selective P-Tree arrangement
   for carrying multicast traffic.  In a Selective P-Tree arrangement,
   traffic to each multicast group in a VPN or VPLS instance is carried
   by a separate unique P-tree.  In Aggregate Selective P-tree
   arrangement, traffic to a set of multicast groups from different VPN
   or VPLS instances is carried over a same shared P-tree.

   The P2MP MPLS LSP are setup either using MLDP [RFC6388] or P2MP RSVP-
   TE [RFC4875].  Mechanisms for fault detection and isolation for data
   plane failures for P2MP MPLS LSPs are specified in [RFC6425].  This
   document describes a mechanism to detect data plane failures for P2MP
   PW carried over P2MP MPLS LSPs.





Jain & Boutros         Expires September 10, 2015               [Page 2]

Internet-Draft              P2MP PW LSP Ping                  March 2015


   This document defines a new FEC 130 Pseudowire sub-TLV for Target FEC
   Stack for P2MP PW.  The FEC 130 Pseudowire sub-TLV is added in Target
   FEC Stack TLV by the originator of the Echo Request to inform the
   receiver at P2MP MPLS LSP tail, of the P2MP PW being tested.

   Multi-segment Pseudowires support is out of scope of this document at
   present and may be included in future.

2.  Specification of Requirements

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

3.  Terminology

   ATM: Asynchronous Transfer Mode

   LSR: Label Switching Router

   MPLS-OAM: MPLS Operations, Administration and Maintenance

   P2MP-PW: Point-to-Multipoint PseudoWire

   PW: PseudoWire

   TLV: Type Length Value

4.  Identifying a P2MP PW

   This document introduces a new LSP Ping Target FEC Stack sub-TLV, FEC
   130 Pseudowire sub-TLV, to identify the P2MP PW under test at the
   P2MP LSP Tail/Bud node.

4.1.  FEC 130 Pseudowire Sub-TLV

   The FEC 130 Pseudowire sub-TLV fields are taken from P2MP PW FEC
   Element (FEC Type 0x82) defined in [I-D.ietf-pwe3-p2mp-pw].  The PW
   Type is a 15-bit number indicating the encapsulation type.  It is
   carried right justified in the field below PW Type with the high-
   order bit set to zero.  All the other fields are treated as opaque
   values and copied directly from P2MP PW FEC Element (FEC Type 0x82)
   format.

   The FEC 130 Pseudowire sub-TLV has the format shown in Figure 1.
   This TLV will be included in the echo request sent over P2MP PW by
   the originator of request.




Jain & Boutros         Expires September 10, 2015               [Page 3]

Internet-Draft              P2MP PW LSP Ping                  March 2015


                     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0|   PW Type                 |   AGI Type    |   AGI Length    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                          AGI Value                            ~
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | AII Type    |   SAII Length |           SAII Value            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                     SAII Value (continued)                    ~
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                Figure 1: FEC 130 Pseudowire sub-TLV format

   For Inclusive and Selective P2MP MPLS P-trees, the echo request will
   be sent using the P2MP MPLS LSP label.

   For Aggregate Inclusive and Aggregate Selective P-trees, the echo
   request will be sent using a label stack of [P2MP MPLS P-tree label,
   upstream assigned P2MP PW label].  The P2MP MPLS P-tree label is the
   outer label and upstream assigned P2MP PW label is inner label.

5.  Operations

   In this section, we explain the operation of the LSP Ping over P2MP
   PW.  Figure 2 shows a P2MP PW PW1 setup from T-PE1 to remote PEs (T-
   PE2, T-PE3 and T-PE4).  The transport LSP associated with the P2MP
   PW1 can be MLDP P2MP MPLS LSP or P2MP TE tunnel.





















Jain & Boutros         Expires September 10, 2015               [Page 4]

Internet-Draft              P2MP PW LSP Ping                  March 2015


                    |<--------------P2MP PW---------------->|
             Native |                                       |  Native
            Service |     |<--PSN1->|      |<--PSN2->|      |  Service
             (AC)   V     V         V      V         V      V   (AC)
               |    +-----+         +------+         +------+    |
               |    |     |         |   P1 |=========|T-PE2 |AC3 |    +---+
               |    |     |         |   .......PW1.........>|-------->|CE3|
               |    |T-PE1|=========|   .  |=========|      |    |    +---+
               |    |  .......PW1........  |         +------+    |
               |    |  .  |=========|   .  |         +------+    |
               |    |  .  |         |   .  |=========|T-PE3 |AC4 |    +---+
       +---+   |AC1 |  .  |         |   .......PW1.........>|-------->|CE4|
       |CE1|------->|...  |         |      |=========|      |    |    +---+
       +---+   |    |  .  |         +------+         +------+    |
               |    |  .  |         +------+         +------+    |
               |    |  .  |=========|   P2 |=========|T-PE4 |AC5 |    +---+
               |    |  .......PW1..............PW1.........>|-------->|CE5|
               |    |     |=========|      |=========|      |    |    +---+
               |    +-----+         +------+         +------+    |

                                  Figure 2: P2MP PW



   When an operator wants to perform a connectivity check for the P2MP
   PW1, the operator initiate a LSP-Ping request with the Target FEC
   Stack TLV containing FEC 130 Pseudowire sub-TLV in the echo request
   packet.  The echo request packet is sent over the P2MP MPLS LSP using
   the P2MP MPLS LSP label for Inclusive P-tree or with a label stack
   with Upstream assigned P2MP PW label as inner label and P2MP MPLS LSP
   label as the top label.  The intermediate P router will do swap and
   replication based on the MPLS LSP label.  Once the packet reaches
   remote terminating PEs, the T-PEs will process the packet and perform
   checks for the FEC 130 Pseudowire sub-TLV present in the Target FEC
   Stack TLV as described in Section 4.4 in [RFC4379] and respond
   according to [RFC4379] processing rules.

6.  Encapsulation of OAM Ping Packets

   The LSP Ping Echo request IPv4/UDP packets will be encapsulated with
   the MPLS label stack as described in previous sections, followed by
   the GAL Label [RFC6426].  The GAL label will be followed by the ACH
   with the Pseudowire Associated Channel Type 16 bit value in the ACH
   set to IPv4 indicating that the carried packet is an IPv4 packet.







Jain & Boutros         Expires September 10, 2015               [Page 5]

Internet-Draft              P2MP PW LSP Ping                  March 2015


7.  Echo Reply using Downstream Assigned Label

   Root of a P2MP PW may send an optional downstream assigned p2p MPLS
   label in the LDP Label Mapping message for the P2MP PW signaling.  If
   the root of a P2MP PW expects leaf to send echo reply using the
   downstream assigned label signaled in the Label Mapping message of
   the P2MP PW message, the Reply Mode value of 4 "Reply via application
   level control channel" should be used in Reply Mode field described
   in Section 3 in [RFC4379] in echo request message for the P2MP PW.

8.  Controlling Echo Responses

   The procedures described in [RFC6425] for preventing congestion of
   Echo Responses (Echo Jitter TLV) and limiting the echo reply to a
   single egress node (Node Address P2MP Responder Identifier TLV) can
   be applied to P2MP PW LSP Ping.

9.  Security Considerations

   The proposal introduced in this document does not introduce any new
   security considerations beyond that already apply to [RFC6425].

10.  IANA Considerations

   This document defines a new sub-TLV type to be included in Target FEC
   Stack TLV (TLV Type 1) [RFC4379] in LSP Ping.

   IANA is requested to assign a sub-TLV type value to the following
   sub-TLV from the "Multiprotocol Label Switching (MPLS) Label Switched
   Paths (LSPs) Parameters - TLVs" registry, "TLVs and sub- TLVs" sub-
   registry:

   o  FEC 130 Pseudowire sub-TLV (See Section 3).  Suggested value 24.

11.  Acknowledgments

   The authors would like to thank Shaleen Saxena, Michael Wildt,
   Tomofumi Hayashi, Danny Prairie for their valuable input and
   comments.

12.  References

12.1.  Normative References

   [I-D.ietf-pwe3-p2mp-pw]
              Sivabalan, S., Boutros, S., and L. Martini, "Signaling
              Root-Initiated Point-to-Multipoint Pseudowire using LDP",
              draft-ietf-pwe3-p2mp-pw-04 (work in progress), March 2012.



Jain & Boutros         Expires September 10, 2015               [Page 6]

Internet-Draft              P2MP PW LSP Ping                  March 2015


   [RFC4379]  Kompella, K. and G. Swallow, "Detecting Multi-Protocol
              Label Switched (MPLS) Data Plane Failures", RFC 4379,
              February 2006.

   [RFC6425]  Saxena, S., Swallow, G., Ali, Z., Farrel, A., Yasukawa,
              S., and T. Nadeau, "Detecting Data-Plane Failures in
              Point-to-Multipoint MPLS - Extensions to LSP Ping", RFC
              6425, November 2011.

   [RFC6426]  Gray, E., Bahadur, N., Boutros, S., and R. Aggarwal, "MPLS
              On-Demand Connectivity Verification and Route Tracing",
              RFC 6426, November 2011.

12.2.  Informative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC4875]  Aggarwal, R., Papadimitriou, D., and S. Yasukawa,
              "Extensions to Resource Reservation Protocol - Traffic
              Engineering (RSVP-TE) for Point-to-Multipoint TE Label
              Switched Paths (LSPs)", RFC 4875, May 2007.

   [RFC5085]  Nadeau, T. and C. Pignataro, "Pseudowire Virtual Circuit
              Connectivity Verification (VCCV): A Control Channel for
              Pseudowires", RFC 5085, December 2007.

   [RFC6388]  Wijnands, IJ., Minei, I., Kompella, K., and B. Thomas,
              "Label Distribution Protocol Extensions for Point-to-
              Multipoint and Multipoint-to-Multipoint Label Switched
              Paths", RFC 6388, November 2011.

   [RFC7338]  Jounay, F., Kamite, Y., Heron, G., and M. Bocci,
              "Requirements and Framework for Point-to-Multipoint
              Pseudowires over MPLS Packet Switched Networks", RFC 7338,
              September 2014.

Authors' Addresses

   Parag Jain
   Cisco Systems, Inc.
   2000 Innovation Drive
   Kanata, ON  K2K-3E8
   Canada

   Email: paragj@cisco.com





Jain & Boutros         Expires September 10, 2015               [Page 7]

Internet-Draft              P2MP PW LSP Ping                  March 2015


   Sami Boutros
   Cisco Systems, Inc.
   3750 Cisco Way
   San Jose, CA  95134
   USA

   Email: sboutros@cisco.com












































Jain & Boutros         Expires September 10, 2015               [Page 8]

