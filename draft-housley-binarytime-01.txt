
Network Working Group                                        R. Housley
Internet Draft                                           Vigil Security
expires in six months                                    September 2004


                              BinaryTime:
      An alternate format for representing date and time in ASN.1

                   <draft-housley-binarytime-01.txt>


Status of this Memo

   By submitting this Internet-Draft, I certify that any applicable
   patent or other IPR claims of which I am aware have been disclosed,
   or will be disclosed, and any of which I become aware will be
   disclosed, in accordance with RFC 3668.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than a "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/1id-abstracts.html

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft is expected to be published as an Experimental
   RFC.

Abstract

   This document specifies a new ASN.1 type for representing time:
   BinaryTime.  This document also specifies an alternate signing-time
   attribute for use with the Cryptographic Message Syntax (CMS)
   SignedData content type that permits the use of BinaryTime.  CMS and
   the signing-time attribute are defined in RFC 3852.







Housley                                                         [Page 1]

INTERNET DRAFT                                            September 2004


1  Introduction

   This document specifies a new ASN.1 [ASN1] type for representing
   time: BinaryTime.  This ASN.1 type can be used to represent date and
   time values.

   This document also updates signing-time attribute used with the
   Cryptographic Message Syntax (CMS) [CMS] SignedData content type,
   allowing BinaryTime to be used.

1.1  BinaryTime

   Many operating systems represent date and time as an integer.  This
   document specifies an ASN.1 type for representing a date and time in
   a manner that is compatible with these operating systems.  This
   approach has several advantages over the UTCTime and GeneralizedTime
   types.

   First, a BinaryTime value is smaller than either a UTCTime or a
   GeneralizedTime value.

   Second, in many operating systems, the value can be used without
   conversion.  The operating systems that do require conversion can do
   so with straightforward computation.

   Third, date comparison is very easy with BinaryTime.  Integer
   comparison is easy, even when multi-precision integers are involved.
   Date comparison with UTCTime or GeneralizedTime can be complex when
   the two values to be compared are provided in different time zones.

   This is a rare instance where both memory and processor cycles are
   saved.

1.2  Binary Signing Time Attribute

   The signing-time attribute is defined in [CMS].  The updated signing-
   time attribute is defined in this document to obtain the benefits of
   the BinaryTime type, while maintaining backward compatibility with
   the original signing-time attribute specification.

1.3  Terminology

   In this document, the key words MUST, MUST NOT, REQUIRED, SHOULD,
   SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL are to be interpreted as
   described in [STDWORDS].






Housley                                                         [Page 2]

INTERNET DRAFT                                            September 2004


2  BinaryTime Definition

   The BinaryTime ASN.1 type is used to represent an absolute time and
   date.  A positive integer value is used to represent time values
   based on coordinated universal time (UTC), which is also called
   Greenwich Mean Time (GMT) and ZULU clock time.

   The syntax for BinaryTime is:

      BinaryTime ::= INTEGER

   The integer value is the number of seconds after midnight, January 1,
   1970.  This time format cannot represent time values prior to January
   1, 1970.  The latest UTC time value that can be represented by a
   four-octet integer value is 03:14:07 on January 19, 2038, which is
   represented by the hexadecimal value 7FFFFFFF.  Time values beyond
   03:14:07 on January 19, 2038 are represented by integer values that
   are longer than four octets.

   This specification uses a variable length encoding of INTEGER.  This
   permits any time value after midnight, January 1, 1970 to be
   represented.

   When encoding of an integer value that consists of more than one
   octet, which includes almost all of the time values of interest, the
   bits of the first octet and bit 8 of the second octet MUST NOT all be
   ones or all zeros.  This rule ensures that an integer value is always
   encoded in the smallest possible number of octets.  However, it means
   that implementations cannot assume a fixed length for the integer
   value.

3  Revised Signing Time Attribute Definition

   A new object identifier is assigned to the revised signing-time
   attribute.  In this way, an implementation that supports the signing-
   time attribute but does not support this revision will not encounter
   any difficulty since unrecognized CMS attributes are ignored.

   Like the original signing-time attribute, the updated signing-time
   attribute type specifies the time at which the signer (purportedly)
   performed the signing process.  The updated signing-time attribute
   type is intended for use in the CMS SignedData content type.  The
   attribute can also be used with the AuthenticatedData content type.

   The updated signing-time attribute MUST be a signed attribute or an
   authenticated attribute; it MUST NOT be an unsigned attribute,
   unauthenticated attribute, or unprotected attribute.




Housley                                                         [Page 3]

INTERNET DRAFT                                            September 2004


   The following object identifier identifies the updated signing-time
   attribute:

      id-aa-signingTime2 OBJECT IDENTIFIER ::= { iso(1)
          member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
          smime(16) aa(2) 46 }

   The updated signing-time attribute values have ASN.1 type
   SigningTime2:

      SigningTime2 ::= CHOICE {
        utcTime UTCTime,
        generalizedTime GeneralizedTime,
        binaryTime BinaryTime }

   In [CMS], the SignedAttributes syntax and the AuthAttributes syntax
   are each defined as a SET OF Attributes.  However,  the updated
   signing-time attribute MUST have a single attribute value, even
   though the syntax is defined as a SET OF AttributeValue.  There MUST
   NOT be zero or multiple instances of AttributeValue present.

   The SignedAttributes contained in the signerInfo structure within
   SignedData MUST NOT include multiple instances of the updated
   signing-time attribute.  Similarly, the AuthAttributes in an
   AuthenticatedData MUST NOT include multiple instances of the updated
   signing-time attribute.

   No requirement is imposed concerning the correctness of the signing
   time, and acceptance of a purported signing time is a matter of a
   recipient's discretion.  It is expected, however, that some signers,
   such as time-stamp servers, will be trusted implicitly.

3.1  utcTime

   Dates between January 1, 1950 and December 31, 2049 (inclusive) can
   be represented using the utcTime alternative.  Any dates with year
   values before 1950 or after 2049 MUST be encoded using either
   generalizedTime or binaryTime, and they MUST NOT be encoded using the
   utcTime alternative.

   Date and time values encoded using the utcTime alternative MUST be
   expressed in Coordinated Universal Time (UTC) and MUST include
   seconds (i.e., times are YYMMDDHHMMSSZ), even where the number of
   seconds is zero.  Midnight MUST be represented as "YYMMDD000000Z".
   Century information is implicit, and the century MUST be determined






Housley                                                         [Page 4]

INTERNET DRAFT                                            September 2004


   as follows:

      Where YY is greater than or equal to 50, the year MUST be
      interpreted as 19YY; and

      Where YY is less than 50, the year MUST be interpreted as 20YY.

3.2  generalizedTime

   Date and time values encoded using the generalizedTime alternative
   MUST be expressed in Coordinated Universal Time (UTC) and MUST
   include seconds (i.e., times are YYYYMMDDHHMMSSZ), even where the
   number of seconds is zero.  The GeneralizedTime value MUST NOT
   include fractional seconds.

3.2  binaryTime

   When the binaryTime alternative is used, date and time values MUST be
   expressed in Coordinated Universal Time (UTC), and the granularity of
   the time is seconds.  It is not possible to represent a finer
   granularity.

4  References

   This section provides normative and informative references.

4.1  Normative References

   ASN1       CCITT.  Recommendation X.208: Specification of Abstract
              Syntax Notation One (ASN.1).  1988.

   CMS        Housley, R.  Cryptographic Message Syntax.  RFC 3852.
              July 2004.

   STDWORDS   Bradner, S.  Key Words for Use in RFCs to Indicate
              Requirement Levels.  RFC 2119.  March 1997.

4.2  Informative References

   TSP        Adams, C., P. Cain, D. Pinkas, and R. Zuccherato.
              Internet X.509 Public Key Infrastructure Time-Stamp
              Protocol (TSP).  RFC 3161.  August 2001.









Housley                                                         [Page 5]

INTERNET DRAFT                                            September 2004


5  Security Considerations

   This specification does not introduce any new security considerations
   beyond those already discussed in [CMS].

   Use of the updated signing-time attribute does not necessarily
   provide confidence in the time that the signature value was produced.
   Therefore, acceptance of a purported signing time is a matter of a
   recipient's discretion.  RFC 3161 [TSP] specifies a protocol for
   obtaining time stamps from a trusted entity.

   The original signing-time attribute defined in [CMS] has the same
   semantics as the updated signing-time attribute specified in this
   document.  If both of these attributes are present, they SHOULD
   provide the same date and time.

6  IANA Considerations

   No IANA actions are needed.

7  IPR Considerations

   By submitting this Internet-Draft, I certify that any applicable
   patent or other IPR claims of which I am aware have been disclosed,
   or will be disclosed, and any of which I become aware will be
   disclosed, in accordance with RFC 3668.

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.



Housley                                                         [Page 6]

INTERNET DRAFT                                            September 2004


8  Author's Address

   Russell Housley
   Vigil Security, LLC
   918 Spring Knoll Drive
   Herndon, VA 20170
   USA

   housley@vigilsec.com

Appendix A:  ASN.1 Module

   The ASN.1 module contained in this appendix defines the structures
   that are needed to implement this specification.  It is expected to
   be used in conjunction with the ASN.1 modules in [CMS].

   BinarySigningTimeModule
     { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
       pkcs-9(9) smime(16) modules(0) 27 }

   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN


   -- BinaryTime Definition

   BinaryTime ::= INTEGER


   -- Signing Binary Time Attribute

   id-aa-signingTime2 OBJECT IDENTIFIER ::= { iso(1)
       member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
       smime(16) aa(2) 46 }

   SigningTime2 ::= CHOICE {
     utcTime UTCTime,
     generalizedTime GeneralizedTime,
     binaryTime BinaryTime }


   END









Housley                                                         [Page 7]

INTERNET DRAFT                                            September 2004


Full Copyright Statement

   Copyright (C) The Internet Society (2004).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.



























Housley                                                         [Page 8]

