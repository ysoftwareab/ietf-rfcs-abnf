<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Topology Independent Fast Reroute using Segment Routing</title>
<meta content="Stephane Litkowski" name="author">
<meta content="Ahmed Bashandy" name="author">
<meta content="Clarence Filsfils" name="author">
<meta content="Pierre Francois" name="author">
<meta content="Bruno Decraene" name="author">
<meta content="Daniel Voyer" name="author">
<meta content="
       
   This document presents Topology Independent Loop-free Alternate Fast
   Re-route (TI-LFA), aimed at providing protection of node and
   adjacency segments within the Segment Routing (SR) framework.  This
   Fast Re-route (FRR) behavior builds on proven IP-FRR concepts being
   LFAs, remote LFAs (RLFA), and remote LFAs with directed forwarding
   (DLFA).  It extends these concepts to provide guaranteed coverage in
   any two connected network using a link-state IGP.  A key aspect of TI-LFA is the FRR path selection
   approach establishing protection over the expected post-convergence paths from
   the point of local repair, reducing the operational
   need to control the tie-breaks among various FRR options. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-ietf-rtgwg-segment-routing-ti-lfa-08" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-rtgwg-segment-routing-ti-lfa-08-4skj60cp.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SR TI-LFA</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Litkowski, et al.</td>
<td class="center">Expires 25 July 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-rtgwg-segment-routing-ti-lfa-08</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01-21" class="published">21 January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-07-25">25 July 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Litkowski</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">A. Bashandy</div>
<div class="org">Individual</div>
</div>
<div class="author">
      <div class="author-name">C. Filsfils</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">P. Francois</div>
<div class="org">INSA Lyon</div>
</div>
<div class="author">
      <div class="author-name">B. Decraene</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">D. Voyer</div>
<div class="org">Bell Canada</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Topology Independent Fast Reroute using Segment Routing</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
   This document presents Topology Independent Loop-free Alternate Fast
   Re-route (TI-LFA), aimed at providing protection of node and
   adjacency segments within the Segment Routing (SR) framework.  This
   Fast Re-route (FRR) behavior builds on proven IP-FRR concepts being
   LFAs, remote LFAs (RLFA), and remote LFAs with directed forwarding
   (DLFA).  It extends these concepts to provide guaranteed coverage in
   any two connected network using a link-state IGP.  A key aspect of TI-LFA is the FRR path selection
   approach establishing protection over the expected post-convergence paths from
   the point of local repair, reducing the operational
   need to control the tie-breaks among various FRR options.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 July 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-acronyms" class="xref">Acronyms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-conventions-used-in-this-do" class="xref">Conventions used in this document</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-base-principle" class="xref">Base principle</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-intersecting-p-space-and-q-" class="xref">Intersecting P-Space and Q-Space with post-convergence paths</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-extended-p-space-property-c" class="xref">Extended P-Space property computation for a resource X, over post-convergence paths</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-q-space-property-computatio" class="xref">Q-Space property computation for a resource X,   over post-convergence paths</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-scaling-considerations-when" class="xref">Scaling considerations when computing Q-Space</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ti-lfa-repair-path" class="xref">TI-LFA Repair path</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-frr-path-using-a-direct-nei" class="xref">FRR path using a direct neighbor</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-frr-path-using-a-pq-node" class="xref">FRR path using a PQ node</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-frr-path-using-a-p-node-and" class="xref">FRR path using a P node and Q node that are adjacent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-connecting-distant-p-and-q-" class="xref">Connecting distant P and Q nodes along post-convergence paths</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-building-ti-lfa-repair-list" class="xref">Building TI-LFA repair lists</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-link-protection" class="xref">Link protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="xref">7.1.1</a>.  <a href="#name-the-active-segment-is-a-nod" class="xref">The active segment is a node segment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="xref">7.1.2</a>.  <a href="#name-the-active-segment-is-an-ad" class="xref">The active segment is an adjacency segment</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-dataplane-specific-consider" class="xref">Dataplane specific considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="xref">7.2.1</a>.  <a href="#name-mpls-dataplane-consideratio" class="xref">MPLS dataplane considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="xref">7.2.2</a>.  <a href="#name-srv6-dataplane-consideratio" class="xref">SRv6 dataplane considerations</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-ti-lfa-and-sr-algorithms" class="xref">TI-LFA and SR algorithms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-usage-of-adjacency-segments" class="xref">Usage of Adjacency segments in the repair list</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-analysis-based-on-real-netw" class="xref">Analysis based on real network topologies</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="acronyms">
<section id="section-1">
      <h2 id="name-acronyms">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-acronyms" class="section-name selfRef">Acronyms</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-1-1.1">DLFA: Remote LFA with Directed forwarding.<a href="#section-1-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.2">FRR: Fast Re-route.<a href="#section-1-1.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.3">IGP: Interior Gateway Protocol.<a href="#section-1-1.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.4">LFA: Loop-Free Alternate.<a href="#section-1-1.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.5">LSDB: Link State DataBase.<a href="#section-1-1.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.6">PLR: Point of Local Repair.<a href="#section-1-1.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.7">RL: Repair list.<a href="#section-1-1.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.8">RLFA: Remote LFA.<a href="#section-1-1.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.9">RSPT: Reverse Shortest Path Tree.<a href="#section-1-1.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.10">SID: Segment Identifier.<a href="#section-1-1.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.11">SLA: Service Level Agreement.<a href="#section-1-1.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.12">SPF: Shortest Path First.<a href="#section-1-1.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.13">SPT: Shortest Path Tree.<a href="#section-1-1.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.14">SR: Segment Routing.<a href="#section-1-1.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.15">SRGB: Segment Routing Global Block.<a href="#section-1-1.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.16">SRLG: Shared Risk Link Group.<a href="#section-1-1.16" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-1.17">TI-LFA: Topology Independant LFA.<a href="#section-1-1.17" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="introduction">
<section id="section-2">
      <h2 id="name-introduction">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-2-1">
   Segment Routing aims at supporting services with tight SLA
   guarantees <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>. By relying on SR this document provides
   a local repair mechanism for standard link-state IGP shortest path capable of
   restoring end-to-end connectivity in the case of a sudden directly
   connected failure of a network component. Non-SR mechanisms for
   local repair are beyond the scope of this document. Non-local
   failures are addressed in a separate document <span>[<a href="#I-D.bashandy-rtgwg-segment-routing-uloop" class="xref">I-D.bashandy-rtgwg-segment-routing-uloop</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
   The term topology independent (TI) refers to the ability to provide
   a loop free backup path irrespective of the topologies used in the network.
  This provides a major improvement compared to LFA <span>[<a href="#RFC5286" class="xref">RFC5286</a>]</span> and remote LFA <span>[<a href="#RFC7490" class="xref">RFC7490</a>]</span> which 
  cannot provide a complete protection coverage in some topologies as described in <span>[<a href="#RFC6571" class="xref">RFC6571</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
   For each destination in the network, TI-LFA pre-installs a backup forwarding
  entry for each protected destination ready to be activated upon detection of the failure of a link
   used to reach the destination.  TI-LFA provides protection in the
   event of any one of the following:  single link failure, single node
   failure, or single SRLG failure.  In link failure mode, the
   destination is protected assuming the failure of the link. In node
   protection mode, the destination is protected assuming that the
   neighbor connected to the primary link has failed.  In SRLG
   protecting mode, the destination is protected assuming that a
   configured set of links sharing fate with the primary link has
   failed (e.g. a linecard or a set of links sharing a common transmission pipe).<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">
   Protection techniques outlined in this document are limited to
   protecting links, nodes, and SRLGs that are within a link-state IGP area. 
   Protecting domain exit routers and/or links attached to
   another routing domains are beyond the scope of this document<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">
   Thanks to SR, TI-LFA does not require the establishment of TLDP sessions
   with remote nodes in order to take advantage of the applicability of
   remote LFAs (RLFA) <span>[<a href="#RFC7490" class="xref">RFC7490</a>]</span><span>[<a href="#RFC7916" class="xref">RFC7916</a>]</span> or remote LFAs with directed forwarding
   (DLFA)<span>[<a href="#RFC5714" class="xref">RFC5714</a>]</span>. All the Segment Identifiers (SIDs) are available in the link state database (LSDB) of the IGP.
  As a result, preferring LFAs over RLFAs or DLFAs, as well
   as minimizing the number of RLFA or DLFA repair nodes is not
   required anymore.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">
   Thanks to SR, there is no need to create state in the network in
   order to enforce an explicit FRR path.  This relieves the nodes
   themselves from having to maintain extra state, and it relieves the operator
   from having to deploy an extra
   protocol or extra protocol sessions just to enhance the protection
   coverage.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">
 <span>[<a href="#RFC7916" class="xref">RFC7916</a>]</span> raised several operational considerations when using LFA or remote LFA.
 
 <span>[<a href="#RFC7916" class="xref">RFC7916</a>]</span> Section 3 presents a case where a high bandwidth link between two core routers is protected through a PE router connected
 with low bandwidth links. In such a case, congestion may happen when the FRR backup path is activated.
 <span>[<a href="#RFC7916" class="xref">RFC7916</a>]</span> introduces a local policy framework to let the operator tuning manually the best alternate election based on its own requirements.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">
 From a network capacity planning point of view, it is often assumed that if a link L fails on a particular node X, the bandwidth consumed on L will be spread over some of the remaining links of X. The remaining links to be used are determined
 by the IGP routing considering that the link L has failed (we assume that the traffic uses the post-convergence path starting from the node X). In <a href="#figure1" class="xref">Figure 1</a>, we consider a network with all metrics equal to 1 except the metrics on links used by PE1, PE2 and PE3 which are 1000.
 An easy network capacity planning method is to consider that if the link L (X-B) fails, the traffic actually flowing through L will be spread over the remaining links of X (X-H, X-D, X-A). 
 Considering the IGP metrics, only X-H and X-D can be used in reality to carry the traffic flowing through the link L. 
  As a consequence, the bandwidth of links X-H and X-D is sized according to this rule.
 We should observe that this capacity planning policy works, however it is not fully accurate.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">
 In <a href="#figure1" class="xref">Figure 1</a>, considering that the source of traffic is only from PE1 and PE4, when the link L fails, depending on the convergence speed of the nodes, 
 X may reroute its forwarding entries to the remote PEs onto X-H or X-D; however in a similar timeframe, PE1 will also reroute a subset of its traffic (the subset destined to PE2) out of its nominal path reducing the quantity of traffic received by X.
 The capacity planning rule presented previously has the drawback of oversizing the network, however it allows to prevent any transient congestion (when for example X reroutes traffic before PE1 does).<a href="#section-2-9" class="pilcrow">¶</a></p>
<div id="figure1">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-2-10.1">
<pre>

           H --- I --- J
           |           | \
PE4        |           |  PE3
   \       | (L)       | /
     A --- X --- B --- G
    /      |           | \
 PE1       |           |  PE2
    \      |           | /
     C --- D --- E --- F

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
</div>
<p id="section-2-11">
 Based on this assumption, in order to facilitate the operation of FRR, and limit the implementation of local FRR policies, it looks interesting
 to steer the traffic onto the post-convergence path from the PLR point of view during the FRR phase.
 In our example, when link L fails, X switches the traffic destined to PE3 and PE2 on the post-convergence paths. 
 This is perfectly inline with the capacity planning rule that was presented before and also inline with the fact X may converge before PE1 (or any other upstream router) and may spread the X-B traffic onto the post-convergence paths rooted at X.<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">
 It should be noted, that some networks may have a different capacity planning rule, leading to an allocation of less bandwidth on X-H and X-D links. 
 In such a case, using the post-convergence paths rooted at X during FRR may introduce some congestion on X-H and X-D links. However it is important to note, that a transient congestion may possibly happen, even without FRR activated, for instance when X converges before the upstream routers.
 Operators are still free to use the policy framework defined in <span>[<a href="#RFC7916" class="xref">RFC7916</a>]</span> if the usage of the post-convergence paths rooted at the PLR is not suitable.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">Readers should be aware that FRR protection is pre-computing a backup path to protect against a particular type of failure (link, node, SRLG). 
 When using the post-convergence path as FRR backup path, the computed post-convergence path is the one considering the failure we are protecting against. 
 This means that FRR is using an expected post-convergence path, and this expected post-convergence path may be actually different from the post-convergence path used if the failure that happened is different from the failure FRR was protecting against.
 As an example, if the operator has implemented a protection against a node failure, the expected post-convergence path used during FRR will be the one considering that the node has failed. 
 However, even if a single link is failing or a set of links is failing (instead of the full node), the node-protecting post-convergence path will be used.
 The consequence is that the path used during FRR is not optimal with respect to the failure that has actually occurred.<a href="#section-2-13" class="pilcrow">¶</a></p>
<p id="section-2-14">
Another consideration to take into account is: while using the expected post-convergence path for SR traffic using node segments only (for instance, PE to PE traffic using shortest path) has some advantages, these advantages reduce when SR policies (<span>[<a href="#I-D.ietf-spring-segment-routing-policy" class="xref">I-D.ietf-spring-segment-routing-policy</a>]</span>) are involved. 
A segment-list used in an SR policy is computed to obey a set of path constraints defined locally at the head-end or centrally in a controller. TI-LFA cannot be aware of such path constraints and there is no reason to expect the TI-LFA backup path 
protecting one the segments in that segment list to obey those constraints.
When SR policies are used and the operator wants to have a backup path which still follows the policy requirements, this backup path should be computed as part of the SR policy in the ingress node (or central controller) and the SR policy should not rely on local protection.

Another option could be to use FlexAlgo (<span>[<a href="#I-D.ietf-lsr-flex-algo" class="xref">I-D.ietf-lsr-flex-algo</a>]</span>) to express the set of constraints and use a single node segment associated with a FlexAlgo to reach the destination. 
When using a node segment associated with a FlexAlgo, TI-LFA keeps providing an optimal backup by applying the appropriate set of constraints. The relationship between TI-LFA and the SR-algorithm is detailed in <a href="#tilfa-sr-algo" class="xref">Section 8</a>.<a href="#section-2-14" class="pilcrow">¶</a></p>
<p id="section-2-15">Thanks to SR and the combination of Adjacency segments and Node segments, the expression of the expected post-convergence path rooted at the PLR is facilitated and does not create any additional state on intermediate nodes.
The easiest way to express the expected post-convergence path in a loop-free manner is to encode it as a list of adjacency segments. However, this may create a long SID list that some hardware may not be able to push.
One of the challenges of TI-LFA is to encode the expected post-convergence path by combining adjacency segments and node segments. Each implementation will be free to have its own SID list compression optimization algorithm. 
This document details the basic concepts that could be used to build the SR backup path as well as the associated dataplane procedures.<a href="#section-2-15" class="pilcrow">¶</a></p>
<span id="name-ti-lfa-protection"></span><div id="ref-ti-lfa-protection">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-2-16.1">
<pre>
                                 L     ____
                              S----F--{____}----D
                             /\    |          /
                            |  |   | _______ /
                            |__}---Q{_______}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-ti-lfa-protection" class="selfRef">TI-LFA Protection</a>
        </figcaption></figure>
</div>
<p id="section-2-17">
   We use <a href="#ref-ti-lfa-protection" class="xref">Figure 2</a> to illustrate the TI-LFA approach.<a href="#section-2-17" class="pilcrow">¶</a></p>
<p id="section-2-18">
   The Point of Local Repair (PLR), S, needs to find a node Q (a repair
   node) that is capable of safely forwarding the traffic to a
   destination D affected by the failure of the protected link L, a set
   of links including L (SRLG), or the node F itself.
   The PLR also needs to find a way to reach Q without being affected
   by the convergence state of the nodes over the paths it wants to use
   to reach Q: the PLR needs a loop-free path to reach Q.<a href="#section-2-18" class="pilcrow">¶</a></p>
<p id="section-2-19">
   <a href="#terminology" class="xref">Section 3</a> defines the main notations used in the document.
   They are in line with <span>[<a href="#RFC5714" class="xref">RFC5714</a>]</span>.<a href="#section-2-19" class="pilcrow">¶</a></p>
<p id="section-2-20">
   <a href="#pq_space_intersect" class="xref">Section 5</a> suggests to compute the P-Space and Q-Space
   properties defined in <a href="#terminology" class="xref">Section 3</a>, for the specific case of nodes
   lying over the post-convergence paths towards the protected
   destinations.<a href="#section-2-20" class="pilcrow">¶</a></p>
<p id="section-2-21">
   Using the properties defined in <a href="#pq_space_intersect" class="xref">Section 5</a>, <a href="#tilfa_repair_path" class="xref">Section 6</a> describes
   how to compute protection lists that encode a loop-free post-convergence path towards the destination.<a href="#section-2-21" class="pilcrow">¶</a></p>
<p id="section-2-22">
   <a href="#repairlist" class="xref">Section 7</a> defines the segment operations to be applied by the PLR
   to ensure consistency with the forwarding state of the repair node.<a href="#section-2-22" class="pilcrow">¶</a></p>
<p id="section-2-23">
   By applying the algorithms specified in this document to actual
   service providers and large enterprise networks, we provide real
   life measurements for the number of SIDs used by repair paths. <a href="#analysis" class="xref">Section 10</a> summarizes these measurements.<a href="#section-2-23" class="pilcrow">¶</a></p>
<div id="conventions">
<section id="section-2.1">
        <h3 id="name-conventions-used-in-this-do">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-conventions-used-in-this-do" class="section-name selfRef">Conventions used in this document</a>
        </h3>
<p id="section-2.1-1"> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
   capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">
   We define the main notations used in this document as the following.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
   We refer to "old" and "new" topologies as the LSDB state before and
   after the considered failure.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
   SPT_old(R) is the Shortest Path Tree rooted at node R in the initial
   state of the network.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
   SPT_new(R, X) is the Shortest Path Tree rooted at node R in the
   state of the network after the resource X has failed.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
   PLR stands for "Point of Local Repair". It is the router that
   applies fast traffic restoration after detecting failure in a
   directly attached link, set of links, and/or node.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">
   Similar to <span>[<a href="#RFC7490" class="xref">RFC7490</a>]</span>, we use the concept of P-Space and Q-Space for TI-LFA.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">
   The P-space P(R,X) of a router R w.r.t. a resource X (e.g. a link S-F, a node F, or a SRLG) is the
      set of routers reachable from R using the pre-convergence 
      shortest paths without any of those paths (including
      equal-cost path splits) transiting through X.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">
 Consider the set of neighbors of a router R and a resource X.
      Exclude from that set of neighbors that are reachable from R using X.
   The Extended P-Space P'(R,X) of a node R w.r.t. a resource X is the union 
   of the P-spaces of the neighbors in that reduced set of neighbors w.r.t. the
      resource X.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">
 The Q-space Q(R,X) of a router R w.r.t. a resource X is the
      set of routers from which R can be reached
      without any path (including equal-cost path splits) transiting
      through X.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">
   A symmetric network is a network such that the IGP metric of each
   link is the same in both directions of the link.<a href="#section-3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="base">
<section id="section-4">
      <h2 id="name-base-principle">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-base-principle" class="section-name selfRef">Base principle</a>
      </h2>
<p id="section-4-1">
 The basic algorithm to compute the repair path is to pre-compute SPT_new(R,X) and for each destination, encode the repair path as a loop-free SID list. One way to provide a loop-free SID list is to use adjacency SIDs only. 
 However, this approach may create very long SID lists that hardware may not be able to handle due to MSD (Maximum SID Depth) limitations.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
 An implementation is free to use any local optimization to provide smaller SID lists by combining Node SIDs and Adjacency SIDs. In addition, the usage of Node-SIDs allow to maximize ECMPs over the backup path.
 These optimizations are out of scope of this document, however the subsequent sections provide some guidance on how to leverage P-Spaces and Q-Spaces to optimize the size of the SID list.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pq_space_intersect">
<section id="section-5">
      <h2 id="name-intersecting-p-space-and-q-">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-intersecting-p-space-and-q-" class="section-name selfRef">Intersecting P-Space and Q-Space with post-convergence paths</a>
      </h2>
<p id="section-5-1">
   One of the challenges of defining an SR path following the expected post-convergence path is to reduce the size of the segment list.
   In order to reduce this segment list, an implementation MAY determine the P-Space/Extended P-Space and Q-Space
   properties (defined in <span>[<a href="#RFC7490" class="xref">RFC7490</a>]</span>) of the nodes along the expected post-convergence path from the
   PLR to the protected destination and compute an SR-based explicit
   path from P to Q when they are not adjacent.  Such properties will
   be used in <a href="#tilfa_repair_path" class="xref">Section 6</a> to compute the TI-LFA repair list.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="extp_space">
<section id="section-5.1">
        <h3 id="name-extended-p-space-property-c">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-extended-p-space-property-c" class="section-name selfRef">Extended P-Space property computation for a resource X, over post-convergence paths</a>
        </h3>
<p id="section-5.1-1">
    We want to determine which nodes on the post-convergence path from
   the PLR R to the destination D are in the extended P-space of R 
   w.r.t. resource X (X can be a link or a set of links adjacent to the PLR, or a neighbor node of the PLR).<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
   This can be found by intersecting the set of nodes belonging to the post-convergence path from R to D,
   assuming the failure of X, with P'(R, X).<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="q_space">
<section id="section-5.2">
        <h3 id="name-q-space-property-computatio">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-q-space-property-computatio" class="section-name selfRef">Q-Space property computation for a resource X,   over post-convergence paths</a>
        </h3>
<p id="section-5.2-1">
   We want to determine which nodes on the post-convergence path from
   the PLR R to the destination D are in the Q-Space of destination D
   w.r.t. resource X (X can be a link or a set of links adjacent to the PLR, or a neighbor node of the PLR).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
   This can be found by intersecting the set of nodes belonging to the post-convergence path from R to D,
   assuming the failure of X, with Q(D, X).<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="q_space_scaling">
<section id="section-5.3">
        <h3 id="name-scaling-considerations-when">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-scaling-considerations-when" class="section-name selfRef">Scaling considerations when computing Q-Space</a>
        </h3>
<p id="section-5.3-1"><span>[<a href="#RFC7490" class="xref">RFC7490</a>]</span> raises scaling concerns about computing a Q-Space per destination. Similar concerns may affect TI-LFA computation if an implementation tries to 
 compute a reverse Shortest Path Tree (<span>[<a href="#RFC7490" class="xref">RFC7490</a>]</span>) for every destination in the network to determine the Q-Space. It will be up to each implementation to determine the good tradeoff between scaling and accuracy of the optimization.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tilfa_repair_path">
<section id="section-6">
      <h2 id="name-ti-lfa-repair-path">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ti-lfa-repair-path" class="section-name selfRef">TI-LFA Repair path</a>
      </h2>
<p id="section-6-1">
   The TI-LFA repair path (RP) consists of an outgoing interface and a
   list of segments (repair list (RL)) to insert on the SR header.  The
   repair list encodes the explicit post-convergence path to the
   destination, which avoids the protected resource X and, at the same
   time, is guaranteed to be loop-free irrespective of the state of
   FIBs along the nodes belonging to the explicit path. Thus, there is
   no need for any co-ordination or message exchange between the PLR
   and any other router in the network.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
   The TI-LFA repair path is found by intersecting P(S,X) and Q(D,X)
   with the post-convergence path to D and computing the explicit SR-
   based path EP(P, Q) from P to Q when these nodes are not adjacent
   along the post convergence path.  The TI-LFA repair list is
   expressed generally as (Node_SID(P), EP(P, Q)).<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
   Most often, the TI-LFA repair list has a simpler form, as described
   in the following sections. <a href="#analysis" class="xref">Section 10</a> provides statistics for the
   number of SIDs in the explicit path to protect against various
   failures.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="direct_backup">
<section id="section-6.1">
        <h3 id="name-frr-path-using-a-direct-nei">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-frr-path-using-a-direct-nei" class="section-name selfRef">FRR path using a direct neighbor</a>
        </h3>
<p id="section-6.1-1">
   When a direct neighbor is in P(S,X) and Q(D,x) and on the post-convergence path, the outgoing interface is
   set to that neighbor and the repair segment list SHOULD be empty.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
   This is comparable to a post-convergence LFA FRR repair.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pq_backup">
<section id="section-6.2">
        <h3 id="name-frr-path-using-a-pq-node">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-frr-path-using-a-pq-node" class="section-name selfRef">FRR path using a PQ node</a>
        </h3>
<p id="section-6.2-1">
   When a remote node R is in P(S,X) and Q(D,x) and on the post-convergence path, the repair list MUST be made of a
   single node segment to R and the outgoing interface SHOULD be set to the outgoing interface used to reach R.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">
   This is comparable to a post-convergence RLFA repair tunnel.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="adj_pq_backup">
<section id="section-6.3">
        <h3 id="name-frr-path-using-a-p-node-and">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-frr-path-using-a-p-node-and" class="section-name selfRef">FRR path using a P node and Q node that are adjacent</a>
        </h3>
<p id="section-6.3-1">
   When a node P is in P(S,X) and a node Q is in Q(D,x) and both are on the post-convergence path and both are adjacent to each other, the repair list SHOULD be made
   of two segments: A node segment to P (to be processed first), followed by an
   adjacency segment from P to Q.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">
   This is comparable to a post-convergence DLFA (LFA with directed forwarding) repair tunnel.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="remote_pq_backup">
<section id="section-6.4">
        <h3 id="name-connecting-distant-p-and-q-">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-connecting-distant-p-and-q-" class="section-name selfRef">Connecting distant P and Q nodes along post-convergence paths</a>
        </h3>
<p id="section-6.4-1">
   In some cases, there is no adjacent P and Q node along the post-
   convergence path. As mentioned in <a href="#base" class="xref">Section 4</a>, a list of adjacency SIDs can be used to encode the path between P and Q. However, the PLR can perform additional
   computations to compute a list of segments that represent a loop-free
   path from P to Q. How these computations are done is out of scope of this document and is left to implementation.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="repairlist">
<section id="section-7">
      <h2 id="name-building-ti-lfa-repair-list">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-building-ti-lfa-repair-list" class="section-name selfRef">Building TI-LFA repair lists</a>
      </h2>
<p id="section-7-1">
 The following sections describe how to build the repair lists using the terminology defined in <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>.
 The procedures described in <a href="#link-protect" class="xref">Section 7.1</a> are equally applicable to both SR-MPLS and SRv6 dataplane, while the dataplane-specific considerations are described in <a href="#dataplane" class="xref">Section 7.2</a>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="link-protect">
<section id="section-7.1">
        <h3 id="name-link-protection">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-link-protection" class="section-name selfRef">Link protection</a>
        </h3>
<p id="section-7.1-1">
    In this section, we explain how a protecting router S processes the
    active segment of a packet upon the failure of its primary outgoing
    interface for the packet, S-F.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div id="link-protect-node-sid">
<section id="section-7.1.1">
          <h4 id="name-the-active-segment-is-a-nod">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-the-active-segment-is-a-nod" class="section-name selfRef">The active segment is a node segment</a>
          </h4>
<p id="section-7.1.1-1">
  The active segment MUST be kept on the SR header unchanged and the
    repair list MUST be added. The active segment
    becomes the first segment of the repair list. 
    The way the repair list is added depends on the dataplane used (see <a href="#dataplane" class="xref">Section 7.2</a>).<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="link-protect-adj-sid">
<section id="section-7.1.2">
          <h4 id="name-the-active-segment-is-an-ad">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-the-active-segment-is-an-ad" class="section-name selfRef">The active segment is an adjacency segment</a>
          </h4>
<p id="section-7.1.2-1">
    We define hereafter the FRR behavior applied by S for any packet
    received with an active adjacency segment S-F for which protection
    was enabled. 
  As protection has been enabled for the segment S-F and signaled in the IGP (for instance using protocol extensions from <span>[<a href="#RFC8667" class="xref">RFC8667</a>]</span> and <span>[<a href="#RFC8665" class="xref">RFC8665</a>]</span>), any SR policy using this segment knows that it may be transiently rerouted out of S-F in case of S-F failure.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">
  The simplest approach for link protection of an adjacency segment S-F is to create a repair list that will carry the traffic to F.
  To do so, one or more "PUSH" operations are performed. If the repair list, while avoiding S-F, terminates on F, S only pushes segments of the repair list. Otherwise, S pushes a node segment of F, followed by the  segments of the repair list. For details on the "NEXT" and "PUSH" operations,
    refer to <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>.<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
<p id="section-7.1.2-3">
 This method which merges back the traffic at the remote end of the adjacency segment has the advantage of keeping as much as possible the traffic on the pre-failure path.
 As stated in <a href="#introduction" class="xref">Section 2</a>, when SR policies are involved and a strict compliance of the policy is required, an end-to-end protection should be preferred over a local repair mechanism.
  However, this method may not provide the expected post-convergence path to the final destination as the expected post-convergence path may not go through F.
  Another method requires to look to the next segment in the segment list.<a href="#section-7.1.2-3" class="pilcrow">¶</a></p>
<p id="section-7.1.2-4">
  We distinguish the case where this active segment is
    followed by another adjacency segment from the case where it is
    followed by a node segment.<a href="#section-7.1.2-4" class="pilcrow">¶</a></p>
<div id="link-protect-adj-sid-adj-sid">
<section id="section-7.1.2.1">
            <h5 id="name-protecting-adjacency-adjace">
<a href="#section-7.1.2.1" class="section-number selfRef">7.1.2.1. </a><a href="#name-protecting-adjacency-adjace" class="section-name selfRef">Protecting [Adjacency, Adjacency] segment lists</a>
            </h5>
<p id="section-7.1.2.1-1">
    If the next segment in the list is an Adjacency segment, then the
    packet has to be conveyed to F.<a href="#section-7.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2.1-2">
    To do so, S MUST apply a "NEXT" operation on Adj(S-F) and then one or more "PUSH" operations. If the repair list, while avoiding S-F, terminates on F, S only pushes the segments of the repair list. Otherwise, S pushes a node segment of F, followed by the segments of the repair list. 
    For details on the "NEXT" and "PUSH" operations,
    refer to <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>.<a href="#section-7.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1.2.1-3">
    Upon failure of S-F, a packet reaching S with a segment list
    matching [adj(S-F),adj(F-M),...] will thus leave S with a segment list
    matching [RL(F),node(F),adj(F-M),...], where RL(F) is the repair path
    for destination F.<a href="#section-7.1.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="link-protect-adj-sid-node-sid">
<section id="section-7.1.2.2">
            <h5 id="name-protecting-adjacency-node-s">
<a href="#section-7.1.2.2" class="section-number selfRef">7.1.2.2. </a><a href="#name-protecting-adjacency-node-s" class="section-name selfRef">Protecting [Adjacency, Node] segment lists</a>
            </h5>
<p id="section-7.1.2.2-1">
    If the next segment in the stack is a node segment, say for node T,
    the segment list on the packet matches [adj(S-F),node(T),...].<a href="#section-7.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2.2-2">In this case, S MUST
    apply a "NEXT" operation on the Adjacency segment related to S-F,
    followed by a "PUSH" of a repair list redirecting the traffic to a node Q, whose
    path to node segment T is not affected by the failure.<a href="#section-7.1.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.1.2.2-3">
    Upon failure of S-F, packets reaching S with a segment list matching
    [adj(S-F), node(T), ...], would leave S with a segment list matching
    [RL(Q),node(T), ...].<a href="#section-7.1.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="dataplane">
<section id="section-7.2">
        <h3 id="name-dataplane-specific-consider">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-dataplane-specific-consider" class="section-name selfRef">Dataplane specific considerations</a>
        </h3>
<div id="mpls-dataplane">
<section id="section-7.2.1">
          <h4 id="name-mpls-dataplane-consideratio">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-mpls-dataplane-consideratio" class="section-name selfRef">MPLS dataplane considerations</a>
          </h4>
<p id="section-7.2.1-1">MPLS dataplane for Segment Routing is described in <span>[<a href="#RFC8660" class="xref">RFC8660</a>]</span>.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">The following dataplane behaviors apply when creating a repair list using an MPLS dataplane:<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2.1-3">
<li id="section-7.2.1-3.1">If the active segment is a node segment that has been signaled with penultimate hop popping and the repair list ends with an adjacency segment terminating on the tail-end of the active segment, then the active segment MUST be popped before pushing the repair list.<a href="#section-7.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-7.2.1-3.2">If the active segment is a node segment but the other conditions in 1. are not met, the active segment MUST be popped then pushed again with a label value computed according to the SRGB of Q, where Q is the endpoint of the repair list. Finally, the repair list MUST be pushed.<a href="#section-7.2.1-3.2" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="srv6-dataplane">
<section id="section-7.2.2">
          <h4 id="name-srv6-dataplane-consideratio">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-srv6-dataplane-consideratio" class="section-name selfRef">SRv6 dataplane considerations</a>
          </h4>
<p id="section-7.2.2-1">SRv6 dataplane and programming instructions are described respectively in <span>[<a href="#RFC8754" class="xref">RFC8754</a>]</span> and <span>[<a href="#RFC8986" class="xref">RFC8986</a>]</span>.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">The TI-LFA path computation algorithm is the same as in the SR-MPLS dataplane. Note however that the Adjacency SIDs are typically globally routed. In such case, there is no need for a preceding Prefix SID and the resulting repair list is likely shorter.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3">If the traffic is protected at a Transit Node, then an SRv6 SID list is added on the packet to apply the repair list. The addition of the repair list follows the headend behaviors as specified in section 5 of <span>[<a href="#RFC8986" class="xref">RFC8986</a>]</span>.<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2.2-4">If the traffic is protected at an SR Segment Endpoint Node, first the Segment Endpoint packet processing is executed. Then the packet is protected as if its were a transit packet.<a href="#section-7.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="tilfa-sr-algo">
<section id="section-8">
      <h2 id="name-ti-lfa-and-sr-algorithms">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-ti-lfa-and-sr-algorithms" class="section-name selfRef">TI-LFA and SR algorithms</a>
      </h2>
<p id="section-8-1">
 SR allows an operator to bind an algorithm to a prefix SID (as defined in <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>. The algorithm value dictates how the path to the prefix is computed.
 The SR default algorithm is known has the "Shortest Path" algorithm.
 The SR default algorithm allows an operator to override the IGP shortest path by using local policies. 
 When TI-LFA uses Node-SIDs associated with the default algorithm, there is no guarantee that the path will be loop-free as a local policy may have overriden the expected IGP path.
 As the local policies are defined by the operator, it becomes the responsibility of this operator to ensure that the deployed policies do not affect the TI-LFA deployment. 
 It should be noted that such situation can already happen today with existing mechanisms as remote LFA.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
 <span>[<a href="#I-D.ietf-lsr-flex-algo" class="xref">I-D.ietf-lsr-flex-algo</a>]</span> defines a flexible algorithm (FlexAlgo) framework to be associated with Prefix SIDs. FlexAlgo allows a user to associate a constrained path to a Prefix SID rather than using the regular IGP shortest path.
 An implementation MAY support TI-LFA to protect Node-SIDs associated to a FlexAlgo. In such a case, rather than computing the expected post-convergence path based on the regular SPF, an implementation SHOULD use the constrained SPF algorithm bound to the FlexAlgo (using the Flex Algo Definition) instead of the regular Dijkstra in all the SPF/rSPF computations that are occurring during the TI-LFA computation. This includes the computation of the P-Space and Q-Space as well as the post-convergence path. 
 An implementation MUST only use Node-SIDs bound to the FlexAlgo and/or Adj-SIDs that are unprotected to build the repair list.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="adj-sid-repair-list">
<section id="section-9">
      <h2 id="name-usage-of-adjacency-segments">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-usage-of-adjacency-segments" class="section-name selfRef">Usage of Adjacency segments in the repair list</a>
      </h2>
<p id="section-9-1">
 The repair list of segments computed by TI-LFA may contain one or more adjacency segments.
 An adjacency segment may be protected or not protected.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="cascaded-frr">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-9-2.1">
<pre>

        S --- R2 --- R3 --- R4 --- R5 --- D
                 \    |  \  /
                    R7 -- R8
                     |    |
                    R9 -- R10

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a></figcaption></figure>
</div>
<p id="section-9-3">
 In <a href="#cascaded-frr" class="xref">Figure 3</a>, all the metrics are equal to 1 except R2-R7,R7-R8,R8-R4,R7-R9 which have a metric of 1000.
 Considering R2 as a PLR to protect against the failure of node R3 for the traffic S-&gt;D, the repair list computed by R2 will be [adj(R7-R8),adj(R8-R4)] and the outgoing interface will be to R7.
 If R3 fails, R2 pushes the repair list onto the incoming packet to D. During the FRR, if R7-R8 fails and if TI-LFA has picked a protected adjacency segment for adj(R7-R8), R7 will push an additional repair list onto the packet following the procedures defined in <a href="#repairlist" class="xref">Section 7</a>.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">To avoid the possibility of this double FRR activation, an implementation of TI-LFA MAY pick only non protected adjacency segments when building the repair list. However, this is important to note that FRR in general is intended to protect for a single pre-planned failure. If the failure that happens is worse than expected or multiple failures happen, FRR is not guaranteed to work. In such a case, fast IGP convergence remains important to restore traffic as quickly as possible.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="analysis">
<section id="section-10">
      <h2 id="name-analysis-based-on-real-netw">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-analysis-based-on-real-netw" class="section-name selfRef">Analysis based on real network topologies</a>
      </h2>
<p id="section-10-1">
   This section presents analysis performed on real service
   provider and large enterprise network topologies. The objective of the
   analysis is to assess the number of SIDs required in an explicit
   path when the mechanisms described in this document are used to
   protect against the failure scenarios within the scope of this
   document. The number of segments described in this section are
   applicable to instantiating segment routing over the MPLS forwarding
   plane.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
   The measurement below indicate that for link and local SRLG
   protection, a 1 SID repair path delivers more than 99% coverage. For
   node protection a 2 SIDs repair path yields 99% coverage.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">
   Table 1 below lists the characteristics of the networks used in our
   measurements. The number of links refers to the number of "bidirectional" links (not directed edges of the graph).
  The measurements are carried out as follows:<a href="#section-10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-4.1">For each network, the algorithms described in this document are
      applied to protect all prefixes against link, node, and local
      SRLG failure<a href="#section-10-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-4.2">For each prefix, the number of SIDs used by the repair path is
      recored<a href="#section-10-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-4.3">The percentage of number of SIDs are listed in Tables 2A/B, 3A/B,
      and 4A/B<a href="#section-10-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-10-5">
   The measurements listed in the tables indicate that for link and
   local SRLG protection, 1 SID repair paths are sufficient to protect
   more than 99% of the prefix in almost all cases. For node protection
   2 SIDs repair paths yield 99% coverage.<a href="#section-10-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10-6">
<pre>
+-------------+------------+------------+------------+------------+
|   Network   |    Nodes   |  Links     |Node-to-Link| SRLG info? |
|             |            |            |    Ratio   |            |
+-------------+------------+------------+------------+------------+
|    T1       |    408     |      665   |    1.63    |    Yes     |
+-------------+------------+------------+------------+------------+
|    T2       |    587     |     1083   |    1.84    |     No     |
+-------------+------------+------------+------------+------------+
|    T3       |    93      |      401   |    4.31    |    Yes     |
+-------------+------------+------------+------------+------------+
|    T4       |    247     |      393   |    1.59    |    Yes     |
+-------------+------------+------------+------------+------------+
|    T5       |    34      |      96    |    2.82    |    Yes     |
+-------------+------------+------------+------------+------------+
|    T6       |    50      |      78    |    1.56    |     No     |
+-------------+------------+------------+------------+------------+
|    T7       |    82      |      293   |    3.57    |     No     |
+-------------+------------+------------+------------+------------+
|    T8       |    35      |      41    |    1.17    |    Yes     |
+-------------+------------+------------+------------+------------+
|    T9       |    177     |     1371   |    7.74    |    Yes     |
+-------------+------------+------------+------------+------------+
                    Table 1: Data Set Definition
</pre><a href="#section-10-6" class="pilcrow">¶</a>
</div>
<p id="section-10-7">
   The rest of this section presents the measurements done on the
   actual topologies. The convention that we use is as follows<a href="#section-10-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-8.1">0 SIDs:  the calculated repair path starts with a directly
      connected neighbor that is also a loop free alternate, in which
      case there is no need to explicitly route the traffic using
      additional SIDs. This scenario is described in <a href="#direct_backup" class="xref">Section 6.1</a>.<a href="#section-10-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-8.2">1 SIDs: the repair node is a PQ node, in which case only 1 SID is
      needed to guarantee loop-freeness. This scenario is covered in
      <a href="#pq_backup" class="xref">Section 6.2</a>.<a href="#section-10-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-8.3">2 or more SIDs: The repair path consists of 2 or more SIDs as
      described in <a href="#adj_pq_backup" class="xref">Section 6.3</a> and <a href="#remote_pq_backup" class="xref">Section 6.4</a>. We do not cover the case for
      2 SIDs (<a href="#adj_pq_backup" class="xref">Section 6.3</a>) separately because there was no
      granularity in the result. Also we treat the node-SID+adj-SID and
      node-SID + node-SID the same because they do not differ from the
      data plane point of view.<a href="#section-10-8.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-10-9">
   Table 2A and 2B below summarize the measurements on the number of
   SIDs needed for link protection<a href="#section-10-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10-10">
<pre>
+-------------+------------+------------+------------+------------+
|   Network   |    0 SIDs  |    1 SID   |   2 SIDs   |   3 SIDs   |
+-------------+------------+------------+------------+------------+
|    T1       |  74.3%     |   25.3%    |   0.5%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T2       |  81.1%     |   18.7%    |   0.2%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T3       |  95.9%     |    4.1%    |   0.1%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T4       |  62.5%     |   35.7%    |   1.8%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T5       |  85.7%     |   14.3%    |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T6       |  81.2%     |   18.7%    |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T7       |  98.9%     |   1.1%     |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T8       |  94.1%     |   5.9%     |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T9       |  98.9%     |   1.0%     |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
        Table 2A: Link protection (repair size distribution)

+-------------+------------+------------+------------+------------+
|   Network   |    0 SIDs  |    1 SID   |   2 SIDs   |   3 SIDs   |
+-------------+------------+------------+------------+------------+
|    T1       |  74.2%     |   99.5%    |    99.9%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T2       |  81.1%     |   99.8%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T3       |  95.9%     |   99.9%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T4       |  62.5%     |   98.2%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T5       |  85.7%     |  100.0%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T6       |  81.2%     |   99.9%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T7       |  98,8%     |  100.0%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T8       |  94,1%     |  100.0%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
|    T9       |  98,9%     |  100.0%    |   100.0%   |   100.0%   |
+-------------+------------+------------+------------+------------+
    Table 2B: Link protection repair size cumulative distribution
Table 3A and 3B summarize the measurements on the number of SIDs
needed for local SRLG protection.

+-------------+------------+------------+------------+------------+
|   Network   |    0 SIDs  |    1 SID   |   2 SIDs   |   3 SIDs   |
+-------------+------------+------------+------------+------------+
|    T1       |  74.2%     |   25.3%    |   0.5%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T2       |                No SRLG Information                |
+-------------+------------+------------+------------+------------+
|    T3       |  93.6%     |    6.3%    |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T4       |  62.5%     |   35.6%    |   1.8%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T5       |  83.1%     |   16.8%    |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T6       |                No SRLG Information                |
+-------------+---------------------------------------------------+
|    T7       |                No SRLG Information                |
+-------------+------------+------------+------------+------------+
|    T8       |  85.2%     |   14.8%    |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T9       |  98,9%     |    1.1%    |   0.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
      Table 3A: Local SRLG protection repair size distribution

+-------------+------------+------------+------------+------------+
|   Network   |    0 SIDs  |    1 SID   |   2 SIDs   |   3 SIDs   |
+-------------+------------+------------+------------+------------+
|    T1       |  74.2%     |   99.5%    |  99.9%     | 100.0%     |
+-------------+------------+------------+------------+------------+
|    T2       |                No SRLG Information                |
+-------------+------------+------------+------------+------------+
|    T3       |  93.6%     |   99.9%    | 100.0%     |   0.0%     |
+-------------+------------+------------+------------+------------+
|    T4       |  62.5%     |   98.2%    | 100.0%     | 100.0%     |
+-------------+------------+------------+------------+------------+
|    T5       |  83.1%     |  100.0%    | 100.0%     | 100.0%     |
+-------------+------------+------------+------------+------------+
|    T6       |                No SRLG Information                |
+-------------+---------------------------------------------------+
|    T7       |                No SRLG Information                |
+-------------+------------+------------+------------+------------+
|    T8       |  85.2%     |   100.0%   | 100.0%     | 100.0%     |
+-------------+------------+------------+------------+------------+
|    T9       |  98.9%     |   100.0%   | 100.0%     | 100.0%     |
+-------------+------------+------------+------------+------------+
 Table 3B: Local SRLG protection repair size Cumulative distribution
The remaining two tables summarize the measurements on the number of
SIDs needed for node protection.

+---------+----------+----------+----------+----------+----------+
| Network |  0 SIDs  |   1 SID  | 2 SIDs   |  3 SIDs  |  4 SIDs  |
+---------+----------+----------+----------+----------+----------+
|    T1   |  49.8%   | 47.9%    | 2.1%     |  0.1%    |  0.0%    |
+---------+----------+----------+----------+----------+----------+
|    T2   |  36,5%   | 59.6%    | 3.6%     |  0.2%    |  0.0%    |
+---------+----------+----------+----------+----------+----------+
|    T3   |  73.3%   | 25.6%    | 1.1%     |  0.0%    |  0.0%    |
+---------+----------+----------+----------+----------+----------+
|    T4   |  36.1%   | 57.3%    | 6.3%     |  0.2%    |  0.0%    |
+---------+----------+----------+----------+----------+----------+
|    T5   |  73.2%   | 26.8%    | 0%       |  0%      |  0%      |
+---------+----------+----------+----------+----------+----------+
|    T6   |  78.3%   | 21.3%    | 0.3%     |  0%      |  0%      |
+---------+----------+----------+----------+----------+----------+
|    T7   |  66.1%   | 32.8%    | 1.1%     |  0%      |  0%      |
+---------+----------+----------+----------+----------+----------+
|    T8   |  59.7%   | 40.2%    | 0%       |  0%      |  0%      |
+---------+----------+----------+----------+----------+----------+
|    T9   |  98.9%   | 1.0%     | 0%       |  0%      |  0%      |
+---------+----------+----------+----------+----------+----------+
        Table 4A: Node protection (repair size distribution)

+---------+----------+----------+----------+----------+----------+
| Network |  0 SIDs  |   1 SID  | 2 SIDs   |  3 SIDs  |  4 SIDs  |
+---------+----------+----------+----------+----------+----------+
|    T1   |  49.7%   |  97.6%   |  99.8%   | 99.9%    |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T2   |  36.5%   |  96.1%   |  99.7%   | 99.9%    |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T3   |  73.3%   |  98.9%   |  99.9%   | 100.0%   |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T4   |  36.1%   |  93.4%   |  99.8%   | 99.9%    |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T5   |  73.2%   | 100.0%   | 100.0%   | 100.0%   |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T6   |  78.4%   | 99.7%    | 100.0%   | 100.0%   |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T7   |  66.1%   | 98.9%    | 100.0%   | 100.0%   |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T8   |  59.7%   | 100.0%   | 100.0%   | 100.0%   |  100%    |
+---------+----------+----------+----------+----------+----------+
|    T9   |  98.9%   | 100.0%   | 100.0%   | 100.0%   |  100%    |
+---------+----------+----------+----------+----------+----------+
   Table 4B: Node protection (repair size cumulative distribution)
</pre><a href="#section-10-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="security">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">
   The techniques described in this document are internal
   functionalities to a router that result in the ability to guarantee
   an upper bound on the time taken to restore traffic flow upon the
   failure of a directly connected link or node. As these techniques
   steer traffic to the post-convergence path as quickly as possible,
   this serves to minimize the disruption associated with a local
   failure which can be seen as a modest security enhancement. The
   protection mechanisms does not protect external destinations, but
   rather provides quick restoration for destination that are
   internal to a routing domain.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">Security considerations described in <span>[<a href="#RFC5286" class="xref">RFC5286</a>]</span> and <span>[<a href="#RFC7490" class="xref">RFC7490</a>]</span> apply to this document.
   Similarly, as the solution described in the document is based on Segment Routing technology, reader should be aware of the security considerations related to this technology (<span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>) and its dataplane instantiations
   (<span>[<a href="#RFC8660" class="xref">RFC8660</a>]</span>, <span>[<a href="#RFC8754" class="xref">RFC8754</a>]</span> and <span>[<a href="#RFC8986" class="xref">RFC8986</a>]</span>).
   However, this document does not introduce additional security concern.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-12-1">
   No requirements for IANA<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-13">
      <h2 id="name-contributors">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-13-1">In addition to the authors listed on the front page, the following co-authors have also contributed to this document:<a href="#section-13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-2.1">Francois Clad, Cisco Systems<a href="#section-13-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-2.2">Pablo Camarillo, Cisco Systems<a href="#section-13-2.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="ack">
<section id="section-14">
      <h2 id="name-acknowledgments">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-14-1">
   We would like to thank Les Ginsberg, Stewart Bryant, Alexander Vainsthein, Chris Bowers, Shraddha Hedge for their valuable
   comments.<a href="#section-14-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7916">[RFC7916]</dt>
        <dd>
<span class="refAuthor">Litkowski, S., Ed.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Raza, K.</span>, <span class="refAuthor">Horneffer, M.</span>, and <span class="refAuthor">P. Sarkar</span>, <span class="refTitle">"Operational Management of Loop-Free Alternates"</span>, <span class="seriesInfo">RFC 7916</span>, <span class="seriesInfo">DOI 10.17487/RFC7916</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7916">https://www.rfc-editor.org/info/rfc7916</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8660">[RFC8660]</dt>
        <dd>
<span class="refAuthor">Bashandy, A., Ed.</span>, <span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing with the MPLS Data Plane"</span>, <span class="seriesInfo">RFC 8660</span>, <span class="seriesInfo">DOI 10.17487/RFC8660</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8660">https://www.rfc-editor.org/info/rfc8660</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8754">[RFC8754]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Dukes, D., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">D. Voyer</span>, <span class="refTitle">"IPv6 Segment Routing Header (SRH)"</span>, <span class="seriesInfo">RFC 8754</span>, <span class="seriesInfo">DOI 10.17487/RFC8754</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8754">https://www.rfc-editor.org/info/rfc8754</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8986">[RFC8986]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Camarillo, P., Ed.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"Segment Routing over IPv6 (SRv6) Network Programming"</span>, <span class="seriesInfo">RFC 8986</span>, <span class="seriesInfo">DOI 10.17487/RFC8986</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8986">https://www.rfc-editor.org/info/rfc8986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.bashandy-rtgwg-segment-routing-uloop">[I-D.bashandy-rtgwg-segment-routing-uloop]</dt>
        <dd>
<span class="refAuthor">Bashandy, A.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Litkowski, S.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Francois, P.</span>, and <span class="refAuthor">P. Psenak</span>, <span class="refTitle">"Loop avoidance using Segment Routing"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bashandy-rtgwg-segment-routing-uloop-12</span>, <time datetime="2021-12-22" class="refDate">22 December 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-bashandy-rtgwg-segment-routing-uloop-12.txt">https://www.ietf.org/archive/id/draft-bashandy-rtgwg-segment-routing-uloop-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lsr-flex-algo">[I-D.ietf-lsr-flex-algo]</dt>
        <dd>
<span class="refAuthor">Psenak, P.</span>, <span class="refAuthor">Hegde, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K.</span>, and <span class="refAuthor">A. Gulko</span>, <span class="refTitle">"IGP Flexible Algorithm"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lsr-flex-algo-18</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-lsr-flex-algo-18.txt">https://www.ietf.org/archive/id/draft-ietf-lsr-flex-algo-18.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-spring-segment-routing-policy">[I-D.ietf-spring-segment-routing-policy]</dt>
        <dd>
<span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Bogdanov, A.</span>, and <span class="refAuthor">P. Mattes</span>, <span class="refTitle">"Segment Routing Policy Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-spring-segment-routing-policy-14</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-spring-segment-routing-policy-14.txt">https://www.ietf.org/archive/id/draft-ietf-spring-segment-routing-policy-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5286">[RFC5286]</dt>
        <dd>
<span class="refAuthor">Atlas, A., Ed.</span> and <span class="refAuthor">A. Zinin, Ed.</span>, <span class="refTitle">"Basic Specification for IP Fast Reroute: Loop-Free Alternates"</span>, <span class="seriesInfo">RFC 5286</span>, <span class="seriesInfo">DOI 10.17487/RFC5286</span>, <time datetime="2008-09" class="refDate">September 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5286">https://www.rfc-editor.org/info/rfc5286</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5714">[RFC5714]</dt>
        <dd>
<span class="refAuthor">Shand, M.</span> and <span class="refAuthor">S. Bryant</span>, <span class="refTitle">"IP Fast Reroute Framework"</span>, <span class="seriesInfo">RFC 5714</span>, <span class="seriesInfo">DOI 10.17487/RFC5714</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5714">https://www.rfc-editor.org/info/rfc5714</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6571">[RFC6571]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Francois, P., Ed.</span>, <span class="refAuthor">Shand, M.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Leymann, N.</span>, and <span class="refAuthor">M. Horneffer</span>, <span class="refTitle">"Loop-Free Alternate (LFA) Applicability in Service Provider (SP) Networks"</span>, <span class="seriesInfo">RFC 6571</span>, <span class="seriesInfo">DOI 10.17487/RFC6571</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6571">https://www.rfc-editor.org/info/rfc6571</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7490">[RFC7490]</dt>
        <dd>
<span class="refAuthor">Bryant, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Shand, M.</span>, and <span class="refAuthor">N. So</span>, <span class="refTitle">"Remote Loop-Free Alternate (LFA) Fast Reroute (FRR)"</span>, <span class="seriesInfo">RFC 7490</span>, <span class="seriesInfo">DOI 10.17487/RFC7490</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7490">https://www.rfc-editor.org/info/rfc7490</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8665">[RFC8665]</dt>
        <dd>
<span class="refAuthor">Psenak, P., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Gredler, H.</span>, <span class="refAuthor">Shakir, R.</span>, <span class="refAuthor">Henderickx, W.</span>, and <span class="refAuthor">J. Tantsura</span>, <span class="refTitle">"OSPF Extensions for Segment Routing"</span>, <span class="seriesInfo">RFC 8665</span>, <span class="seriesInfo">DOI 10.17487/RFC8665</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8665">https://www.rfc-editor.org/info/rfc8665</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8667">[RFC8667]</dt>
      <dd>
<span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L., Ed.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Bashandy, A.</span>, <span class="refAuthor">Gredler, H.</span>, and <span class="refAuthor">B. Decraene</span>, <span class="refTitle">"IS-IS Extensions for Segment Routing"</span>, <span class="seriesInfo">RFC 8667</span>, <span class="seriesInfo">DOI 10.17487/RFC8667</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8667">https://www.rfc-editor.org/info/rfc8667</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stephane Litkowski</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:slitkows@cisco.com" class="email">slitkows@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ahmed Bashandy</span></div>
<div dir="auto" class="left"><span class="org">Individual</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:abashandy.ietf@gmail.com" class="email">abashandy.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Clarence Filsfils</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div dir="auto" class="left"><span class="locality">Brussels</span></div>
<div dir="auto" class="left"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cfilsfil@cisco.com" class="email">cfilsfil@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pierre Francois</span></div>
<div dir="auto" class="left"><span class="org">INSA Lyon</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pierre.francois@insa-lyon.fr" class="email">pierre.francois@insa-lyon.fr</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bruno Decraene</span></div>
<div dir="auto" class="left"><span class="org">Orange</span></div>
<div dir="auto" class="left"><span class="locality">Issy-les-Moulineaux</span></div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bruno.decraene@orange.com" class="email">bruno.decraene@orange.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Voyer</span></div>
<div dir="auto" class="left"><span class="org">Bell Canada</span></div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daniel.voyer@bell.ca" class="email">daniel.voyer@bell.ca</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
