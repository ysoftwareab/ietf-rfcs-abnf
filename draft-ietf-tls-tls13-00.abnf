value = (byte[0] << 8*(n-1)) | (byte[1] << 8*(n-2)) |
              ... | byte[n-1];

additional_data = seq_num + TLSCompressed.type +
                        TLSCompressed.version + TLSCompressed.length;

AEADEncrypted = AEAD-Encrypt(write_key, nonce, plaintext,
                                   additional_data)
key_block = PRF(SecurityParameters.master_secret,
                      "key expansion",
                      SecurityParameters.server_random +
                      SecurityParameters.client_random);

pre_master_secret = ClientHello.client_version || R


       else If ClientHello.client_version <= TLS 1.0, and version number
       check is explicitly disabled:


pre_master_secret = M


       else:


pre_master_secret = ClientHello.client_version || M[2..47]

pre_master_secret = R


       else If ClientHello.client_version <= TLS 1.0, and version number
       check is explicitly disabled:


master_secret = PRF(pre_master_secret, "master secret",
                          ClientHello.random + ServerHello.random)
                          [0..47];

