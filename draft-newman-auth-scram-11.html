<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Salted Challenge Response (SCRAM) SASL Mechanism</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Salted Challenge Response (SCRAM) SASL Mechanism">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">NETWORK WORKING GROUP</td><td class="header">A. Menon-Sen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Oryx Mail Systems GmbH</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">A. Melnikov</td></tr>
<tr><td class="header">Expires: September 24, 2009</td><td class="header">Isode Ltd</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Newman</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">N. Williams</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Sun Microsystems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 23, 2009</td></tr>
</table></td></tr></table>
<h1><br />Salted Challenge Response (SCRAM) SASL Mechanism<br />draft-newman-auth-scram-11.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 24, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The secure authentication mechanism most widely deployed
		and used by Internet application protocols is the
		transmission of clear-text passwords over a channel
		protected by Transport Layer Security (TLS).  There are
		some significant security concerns with that mechanism,
		which could be addressed by the use of a challenge
		response authentication mechanism protected by TLS.
		Unfortunately, the challenge response mechanisms
		presently on the standards track all fail to meet
		requirements necessary for widespread deployment, and
		have had success only in limited use.
</p>
<p>This specification describes a family of authentication
		mechanisms called the Salted Challenge Response
		Authentication Mechanism (SCRAM), which addresses the
		security concerns and meets the deployability
		requirements. When used in combination with TLS or an
		equivalent security layer, a mechanism from this family
		could improve the status-quo for application protocol
		authentication and provide a suitable choice for a
		mandatory-to-implement mechanism for future application
		protocol standards.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#conv">1.</a>&nbsp;
Conventions Used in This Document<br />
<a href="#anchor1">1.1.</a>&nbsp;
Terminology<br />
<a href="#anchor2">1.2.</a>&nbsp;
Notation<br />
<a href="#anchor3">2.</a>&nbsp;
Introduction<br />
<a href="#anchor4">3.</a>&nbsp;
SCRAM Algorithm Overview<br />
<a href="#mechname">4.</a>&nbsp;
SCRAM Mechanism Names<br />
<a href="#protocol">5.</a>&nbsp;
SCRAM Authentication Exchange<br />
<a href="#attrs">5.1.</a>&nbsp;
SCRAM Attributes<br />
<a href="#channel-binding">6.</a>&nbsp;
Channel Binding<br />
<a href="#anchor5">6.1.</a>&nbsp;
Channel Binding to TLS Channels<br />
<a href="#syntax">7.</a>&nbsp;
Formal Syntax<br />
<a href="#anchor6">8.</a>&nbsp;
SCRAM as a GSS-API Mechanism<br />
<a href="#anchor7">8.1.</a>&nbsp;
GSS-API Principal Name Types for SCRAM<br />
<a href="#anchor8">8.2.</a>&nbsp;
GSS-API Per-Message Tokens for SCRAM<br />
<a href="#anchor9">8.3.</a>&nbsp;
GSS_Pseudo_random() for SCRAM<br />
<a href="#anchor10">9.</a>&nbsp;
Security Considerations<br />
<a href="#iana">10.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor11">11.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor12">Appendix&nbsp;A.</a>&nbsp;
Other Authentication Mechanisms<br />
<a href="#anchor13">Appendix&nbsp;B.</a>&nbsp;
Design Motivations<br />
<a href="#anchor14">Appendix&nbsp;C.</a>&nbsp;
SCRAM Examples and Internet-Draft Change History<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
<a href="#rfc.references2">12.2.</a>&nbsp;
Normative References for GSS-API implementors<br />
<a href="#rfc.references3">12.3.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="conv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Conventions Used in This Document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
		"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",
		"MAY", and "OPTIONAL" in this document are to be
		interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Formal syntax is defined by <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>
		including the core rules defined in Appendix B of <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<p>Example lines prefaced by "C:" are sent by the client and
		ones prefaced by "S:" by the server. If a single "C:" or
		"S:" label applies to multiple lines, then the line
		breaks between those lines are for editorial clarity
		only, and are not part of the actual protocol
		exchange.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>This document uses several terms defined in <a class='info' href='#RFC4949'>[RFC4949]<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a> ("Internet Security
		    Glossary") including the following: authentication,
		    authentication exchange, authentication information,
		    brute force, challenge-response, cryptographic hash
		    function, dictionary attack, eavesdropping, hash
		    result, keyed hash, man-in-the-middle, nonce,
		    one-way encryption function, password, replay attack
		    and salt. Readers not familiar with these terms
		    should use that glossary as a reference.
</p>
<p>Some clarifications and additional definitions
		    follow:

		    </p>
<ul class="text">
<li>Authentication information: Information used
			    to verify an identity claimed by a SCRAM
			    client. The authentication information for a
			    SCRAM identity consists of salt, iteration
			    count, the "StoredKey" and "ServerKey" (as
			    defined in the algorithm overview) for each
			    supported cryptographic hash function.
</li>
<li>Authentication database: The database used to
			    look up the authentication information
			    associated with a particular identity. For
			    application protocols, LDAPv3 (see <a class='info' href='#RFC4510'>[RFC4510]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map,&rdquo; June&nbsp;2006.</span><span>)</span></a>) is frequently used
			    as the authentication database. For
			    network-level protocols such as PPP or
			    802.11x, the use of RADIUS is more
			    common.
</li>
<li>Base64: An encoding mechanism defined in
			    <a class='info' href='#RFC4648'>[RFC4648]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> which converts an
			    octet string input to a textual output
			    string which can be easily displayed to a
			    human. The use of base64 in SCRAM is
			    restricted to the canonical form with no
			    whitespace.
</li>
<li>Octet: An 8-bit byte.
</li>
<li>Octet string: A sequence of 8-bit bytes.
</li>
<li>Salt: A random octet string that is combined
			    with a password before applying a one-way
			    encryption function. This value is used to
			    protect passwords that are stored in an
			    authentication database.
</li>
</ul><p>
		
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Notation</h3>

<p>The pseudocode description of the algorithm uses the
		    following notations:

		    </p>
<ul class="text">
<li>":=": The variable on the left hand side
			    represents the octet string resulting from
			    the expression on the right hand side.
</li>
<li>"+": Octet string concatenation.
</li>
<li>"[ ]": A portion of an expression enclosed in
			    "[" and "]" may not be included in the
			    result under some circumstances. See the
			    associated text for a description of those
			    circumstances.
</li>
<li>HMAC(key, str): Apply the HMAC keyed hash
			    algorithm (defined in <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>) using the octet
			    string represented by "key" as the key and
			    the octet string "str" as the input string.
			    The size of the result is the hash result
			    size for the hash function in use.  For
			    example, it is 20 octets for SHA-1 (see
			    <a class='info' href='#RFC3174'>[RFC3174]<span> (</span><span class='info'>Eastlake, D. and P. Jones, &ldquo;US Secure Hash Algorithm 1 (SHA1),&rdquo; September&nbsp;2001.</span><span>)</span></a>).
</li>
<li>H(str): Apply the cryptographic hash function
			    to the octet string "str", producing an
			    octet string as a result. The size of the
			    result depends on the hash result size for
			    the hash function in use.
</li>
<li>XOR: Apply the exclusive-or operation to
			    combine the octet string on the left of this
			    operator with the octet string on the right
			    of this operator. The length of the output
			    and each of the two inputs will be the same
			    for this use.
</li>
<li>Hi(str, salt):
</li>
</ul><p>

		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   U0   := HMAC(str, salt + INT(1))
   U1   := HMAC(str, U0)
   U2   := HMAC(str, U1)
   ...
   Ui-1 := HMAC(str, Ui-2)
   Ui   := HMAC(str, Ui-1)

   Hi := U0 XOR U1 XOR U2 XOR ... XOR Ui

</pre></div>
<p>

		    </p>
<blockquote class="text">
<p>where "i" is the iteration count, "+" is the
			    string concatenation operator and INT(g) is
			    a four-octet encoding of the integer g, most
			    significant octet first.
</p>
</blockquote><p>

		    </p>
<ul class="text">
<li>This is, essentially, PBKDF2 <a class='info' href='#RFC2898'>[RFC2898]<span> (</span><span class='info'>Kaliski, B., &ldquo;PKCS #5: Password-Based Cryptography Specification Version 2.0,&rdquo; September&nbsp;2000.</span><span>)</span></a> with HMAC() as the
			    PRF and with dkLen == output length of
			    HMAC() == output length of H().
</li>
</ul><p>

		
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>This specification describes a family of authentication
		mechanisms called the Salted Challenge Response
		Authentication Mechanism (SCRAM) which addresses the
		requirements necessary to deploy a challenge-response
		mechanism more widely than past attempts. When used in
		combination with Transport Layer Security (TLS, see
		<a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>) or an equivalent security
		layer, a mechanism from this family could improve the
		status-quo for application protocol authentication and
		provide a suitable choice for a mandatory-to-implement
		mechanism for future application protocol standards.
</p>
<p>For simplicity, this family of mechanism does not
		presently include negotiation of a security layer. It is
		intended to be used with an external security layer such
		as that provided by TLS or SSH, with optional channel
		binding <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a> to the external
		security layer.
</p>
<p>SCRAM is specified herein as a pure Simple Authentication
		and Security Layer (SASL) <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a>
		mechanism, but it conforms to the new bridge between
		SASL and the Generic Security Services Application
		Programming Interface (GSS-API) called "GS2"
		[ref-needed].  This means that SCRAM is actually both, a
		GSS-API and SASL mechanism.
</p>
<p>SCRAM provides the following protocol features:

		</p>
<ul class="text">
<li>The authentication information stored in the
			authentication database is not sufficient by
			itself to impersonate the client. The
			information is salted to prevent a pre-stored
			dictionary attack if the database is stolen.
</li>
<li>The server does not gain the ability to
			impersonate the client to other servers (with an
			exception for server-authorized proxies).
</li>
<li>The mechanism permits the use of a
			server-authorized proxy without requiring that
			proxy to have super-user rights with the
			back-end server.
</li>
<li>A standard attribute is defined to enable storage
			of the authentication information in LDAPv3 (see
			<a class='info' href='#RFC4510'>[RFC4510]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map,&rdquo; June&nbsp;2006.</span><span>)</span></a>).
</li>
<li>Mutual authentication is supported, but only the
			client is named (i.e., the server has no
			name).
</li>
</ul><p>

	    
</p>
<p>For an in-depth discussion of why other challenge
		response mechanisms are not considered sufficient, see
		appendix A. For more information about the motivations
		behind the design of this mechanism, see appendix B.
</p>
<p>Comments regarding this draft may be sent either to the
		ietf-sasl@imc.org mailing list or to the authors.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
SCRAM Algorithm Overview</h3>

<p>Note that this section omits some details, such as client
		and server nonces.  See <a class='info' href='#protocol'>Section&nbsp;5<span> (</span><span class='info'>SCRAM Authentication Exchange</span><span>)</span></a> for
		more details.
</p>
<p>To begin with, the client is in possession of a username
		and password.  It sends the username to the server,
		which retrieves the corresponding authentication
		information, i.e. a salt, StoredKey, ServerKey and the
		iteration count i. (Note that a server implementation
		may chose to use the same iteration count for all
		account.)  The server sends the salt and the iteration
		count to the client, which then computes the following
		values and sends a ClientProof to the server:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   SaltedPassword  := Hi(password, salt)
   ClientKey       := H(SaltedPassword)
   StoredKey       := H(ClientKey)
   AuthMessage     := client-first-message + "," +
                      server-first-message + "," +
                      client-final-message-without-proof
   ClientSignature := HMAC(StoredKey, AuthMessage)
   ClientProof     := ClientKey XOR ClientSignature
   ServerKey       := HMAC(SaltedPassword, salt)
   ServerSignature := HMAC(ServerKey, AuthMessage)

</pre></div>
<p>The server authenticates the client by computing the
		ClientSignature, exclusive-ORing that with the
		ClientProof to recover the ClientKey and verifying the
		correctness of the ClientKey by applying the hash
		function and comparing the result to the StoredKey. If
		the ClientKey is correct, this proves that the client
		has access to the user's password.
</p>
<p>Similarly, the client authenticates the server by
		computing the ServerSignature and comparing it to the
		value sent by the server.  If the two are equal, it
		proves that the server had access to the user's
		ServerKey.
</p>
<p>The AuthMessage is computed by concatenating messages
		from the authentication exchange. The format of these
		messages is defined in <a class='info' href='#syntax'>Section&nbsp;7<span> (</span><span class='info'>Formal Syntax</span><span>)</span></a>.
</p>
<a name="mechname"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
SCRAM Mechanism Names</h3>

<p>A SCRAM mechanism name is a string "SCRAM-HMAC-" followed
		by the uppercased name of the underlying hashed function
		taken from the IANA "Hash Function Textual Names"
		registry (see http://www.iana.org), optionally followed
		by the suffix "-PLUS" (see below)..
</p>
<p>For interoperability, all SCRAM clients and servers MUST
		implement the SCRAM-HMAC-SHA-1 authentication mechanism,
		i.e. an authentication mechanism from the SCRAM family
		that uses the SHA-1 hash function as defined in <a class='info' href='#RFC3174'>[RFC3174]<span> (</span><span class='info'>Eastlake, D. and P. Jones, &ldquo;US Secure Hash Algorithm 1 (SHA1),&rdquo; September&nbsp;2001.</span><span>)</span></a>.
</p>
<p>The "-PLUS" suffix is used only when the server supports
		channel binding to the external channel.  In this case
		the server will advertise both, SCRAM-HMAC-SHA-1 and
		SCRAM-HMAC-SHA-1-PLUS, otherwise the server will
		advertise only SCRAM-HMAC-SHA-1.  The "-PLUS" exists to
		allow negotiation of the use of channel binding.  See
		<a class='info' href='#channel-binding'>Section&nbsp;6<span> (</span><span class='info'>Channel Binding</span><span>)</span></a>.
</p>
<a name="protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
SCRAM Authentication Exchange</h3>

<p>SCRAM is a text protocol where the client and server
		exchange messages containing one or more attribute-value
		pairs separated by commas. Each attribute has a
		one-letter name. The messages and their attributes are
		described in <a class='info' href='#attrs'>Section&nbsp;5.1<span> (</span><span class='info'>SCRAM Attributes</span><span>)</span></a>, and defined in
		<a class='info' href='#syntax'>Section&nbsp;7<span> (</span><span class='info'>Formal Syntax</span><span>)</span></a>.
</p>
<p>This is a simple example of a SCRAM-HMAC-SHA-1
		authentication exchange:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   C: n,n=Chris Newman,r=ClientNonce
   S: r=ClientNonceServerNonce,s=PxR/wv+epq,i=128
   C: r=ClientNonceServerNonce,p=WxPv/siO5l+qxN4
   S: v=WxPv/siO5l+qxN4

</pre></div>
<p>With channel-binding data sent by the client this might look like
		this:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   C: p,n=Chris Newman,r=ClientNonce
   S: r=ClientNonceServerNonce,s=PxR/wv+epq,i=128
   C: c=0123456789ABCDEF,r=ClientNonceServerNonce,p=WxPv/siO5l+qxN4
   S: v=WxPv/siO5l+qxN4

</pre></div>
<p>&lt;&lt;Note that the channel-bind data
		    above, as well as all hashes are
		    fake&gt;&gt;
</p>
<p>First, the client sends a message containing:

		</p>
<ul class="text">
<li>a GS2 header consisting of a flag indicating
			whether channel binding is
			supported-but-not-used, not supported, or used,
			and the SASL authzid (optional);
</li>
<li>SCRAM username and client nonce attributes.
</li>
</ul><p>

	    
</p>
<p>Note that the client's first message will always start
		with "n", "y" or "p", otherwise the message is invalid
		and authentication MUST fail.  This is important, as it
		allows for GS2 extensibility (e.g., to add support for
		security layers).
</p>
<p>In response, the server sends the user's iteration count
		i, the user's salt, and appends its own nonce to the
		client-specified one.  The client then responds with the
		same nonce and a ClientProof computed using the selected
		hash function as explained earlier.  In this step the
		client can also include an optional authorization
		identity.  The server verifies the nonce and the proof,
		verifies that the authorization identity (if supplied by
		the client in the second message) is authorized to act
		as the authentication identity, and, finally, it
		responds with a ServerSignature, concluding the
		authentication exchange. The client then authenticates
		the server by computing the ServerSignature and
		comparing it to the value sent by the server.  If the
		two are different, the client MUST consider the
		authentication exchange to be unsuccessful and it might
		have to drop the connection.
</p>
<a name="attrs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
SCRAM Attributes</h3>

<p>This section describes the permissible attributes,
		    their use, and the format of their values. All
		    attribute names are single US-ASCII letters and are
		    case-sensitive.
</p>
<p>

		    </p>
<ul class="text">
<li>a: This is an optional attribute, and is part
			    of the GS2 [ref-needed] bridge between the
			    GSS-API and SASL.  This attribute specifies
			    an authorization identity. A client may
			    include it in its second message to the
			    server if it wants to authenticate as one
			    user, but subsequently act as a different
			    user.  This is typically used by an
			    administrator to perform some management
			    task on behalf of another user, or by a
			    proxy in some situations.

			    
<blockquote class="text">
<p>Upon the receipt of this value the
				    server verifies its correctness
				    according to the used SASL protocol
				    profile. Failed verification results
				    in failed authentication
				    exchange.
</p>
<p>If this attribute is omitted (as it
				    normally would be), or specified
				    with an empty value, the
				    authorization identity is assumed to
				    be derived from the username
				    specified with the (required) "n"
				    attribute.
</p>
<p>The server always authenticates the
				    user specified by the "n" attribute.
				    If the "a" attribute specifies a
				    different user, the server
				    associates that identity with the
				    connection after successful
				    authentication and authorization
				    checks.
</p>
<p>The syntax of this field is the same
				    as that of the "n" field with
				    respect to quoting of '=' and
				    ','.
</p>
</blockquote>

			
</li>
<li>n: This attribute specifies the name of the
			    user whose password is used for
			    authentication. A client must include it in
			    its first message to the server. If the "a"
			    attribute is not specified (which would
			    normally be the case), this username is also
			    the identity which will be associated with
			    the connection subsequent to authentication
			    and authorization.

			    
<blockquote class="text">
<p>Before sending the username to the
				    server, the client MUST prepare the
				    username using the "SASLPrep"
				    profile <a class='info' href='#RFC4013'>[RFC4013]<span> (</span><span class='info'>Zeilenga, K., &ldquo;SASLprep: Stringprep Profile for User Names and Passwords,&rdquo; February&nbsp;2005.</span><span>)</span></a> of
				    the "stringprep" algorithm <a class='info' href='#RFC3454'>[RFC3454]<span> (</span><span class='info'>Hoffman, P. and M. Blanchet, &ldquo;Preparation of Internationalized Strings (&quot;stringprep&quot;),&rdquo; December&nbsp;2002.</span><span>)</span></a>. If the
				    preparation of the username fails or
				    results in an empty string, the
				    client SHOULD abort the
				    authentication exchange (*).
</p>
<p>(*) An interactive client can request
				    a repeated entry of the username
				    value.
</p>
<p>Upon receipt of the username by the
				    server, the server SHOULD prepare it
				    using the "SASLPrep" profile <a class='info' href='#RFC4013'>[RFC4013]<span> (</span><span class='info'>Zeilenga, K., &ldquo;SASLprep: Stringprep Profile for User Names and Passwords,&rdquo; February&nbsp;2005.</span><span>)</span></a> of the
				    "stringprep" algorithm <a class='info' href='#RFC3454'>[RFC3454]<span> (</span><span class='info'>Hoffman, P. and M. Blanchet, &ldquo;Preparation of Internationalized Strings (&quot;stringprep&quot;),&rdquo; December&nbsp;2002.</span><span>)</span></a>.  If the
				    preparation of the username fails or
				    results in an empty string, the
				    server SHOULD abort the
				    authentication exchange.
</p>
<p>The characters ',' or '=' in
				    usernames are sent as '=2C' and
				    '=3D' respectively. If the server
				    receives a username which contains
				    '=' not followed by either '2C' or
				    '3D', then the server MUST fail the
				    authentication.
</p>
</blockquote>

			
</li>
<li>m: This attribute is reserved for future
			    extensibility.  In this version of SCRAM,
			    its presence in a client or a server message
			    MUST cause authentication failure when the
			    attribute is parsed by the other end.
</li>
<li>r: This attribute specifies a sequence of
			    random printable characters excluding ','
			    which forms the nonce used as input to the
			    hash function.  No quoting is applied to
			    this string (&lt;&lt;unless the binding of
			    SCRAM to a particular protocol states
			    otherwise&gt;&gt;). As described earlier,
			    the client supplies an initial value in its
			    first message, and the server augments that
			    value with its own nonce in its first
			    response. It is important that this be value
			    different for each authentication. The
			    client MUST verify that the initial part of
			    the nonce used in subsequent messages is the
			    same as the nonce it initially specified.
			    The server MUST verify that the nonce sent
			    by the client in the second message is the
			    same as the one sent by the server in its
			    first message.
</li>
<li>c: This REQUIRED attribute specifies
			    base64-encoded of a header and the channel-binding
			    data.  It is sent by the client in its second
			    authentication message.  The header consist
			    of: 

			    
<ul class="text">
<li>the GS2 header from the client's
				    first message (recall: a channel
				    binding flag and an optional
				    authzid);
</li>
<li>followed by the external channel's
				    channel binding type prefix (see
				    <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>, if and
				    only if the client is using channel
				    binding;
</li>
<li>followed by the external channel's
				    channel binding data, if and only if
				    the client is using channel
				    binding.
</li>
</ul>

			
</li>
<li>s: This attribute specifies the
			    base64-encoded salt used by the server for
			    this user. It is sent by the server in its
			    first message to the client.
</li>
<li>i: This attribute specifies an iteration
			    count for the selected hash function and
			    user, and must be sent by the server along
			    with the user's salt.

			    
<blockquote class="text">
<p>For SCRAM-HMAC-SHA-1 SASL mechanism
				    servers SHOULD announce a hash
				    iteration-count of at least 128.
</p>
</blockquote>

			
</li>
<li>p: This attribute specifies a base64-encoded
			    ClientProof. The client computes this value
			    as described in the overview and sends it to
			    the server.
</li>
<li>v: This attribute specifies a base64-encoded
			    ServerSignature. It is sent by the server in
			    its final message, and is used by the client
			    to verify that the server has access to the
			    user's authentication information.  This
			    value is computed as explained in the
			    overview.
</li>
</ul><p>

		
</p>
<a name="channel-binding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Channel Binding</h3>

<p>SCRAM supports channel binding to external secure
		channels, such as TLS.  Clients and servers may or may
		not support channel binding, therefore the use of
		channel binding is negotiable.  SCRAM does not provide
		security layers, however, therefore it is imperative
		that SCRAM provide integrity protection for the
		negotiation of channel binding.
</p>
<p>Use of channel binding is negotiated as follows:

		</p>
<ul class="text">
<li>The server advertises support for channel binding
			by advertising both,
			SCRAM-HMAC-&lt;hash-function&gt; and
			SCRAM-HMAC-&lt;hash-function&gt;-PLUS.
</li>
<li>If the client negotiates mechanisms then client
			MUST select
			SCRAM-HMAC-&lt;hash-function&gt;-PLUS if offered
			by the server.  Otherwise, if the client does
			not negotiate mechanisms then it MUST select
			only SCRAM-HMAC-&lt;hash-function&gt; (not
			suffixed with "-PLUS").
</li>
<li>If the client and server both support channel
			binding, or if the client wishes to use channel
			binding but the client does not negotiate
			mechanisms, the client MUST set the GS2 channel
			binding flag to "p" and MUST include channel
			binding data for the external channel in the
			computation of the "c=" attribute (see <a class='info' href='#attrs'>Section&nbsp;5.1<span> (</span><span class='info'>SCRAM Attributes</span><span>)</span></a>).
</li>
<li>If the client supports channel binding but the
			server does not then the client MUST set the GS2
			channel binding flag to "y" and MUST NOT include
			channel binding data for the external channel in
			the computation of the "c=" attribute (see <a class='info' href='#attrs'>Section&nbsp;5.1<span> (</span><span class='info'>SCRAM Attributes</span><span>)</span></a>).
</li>
<li>If the client does not support channel binding
			then the client MUST set the GS2 channel binding
			flag to "n" and MUST NOT include channel binding
			data for the external channel in the computation
			of the "c=" attribute (see <a class='info' href='#attrs'>Section&nbsp;5.1<span> (</span><span class='info'>SCRAM Attributes</span><span>)</span></a>).
</li>
<li>If the server receives a client first message
			with the GS2 channel binding flag set to "y" and
			the server supports channel binding the server
			MUST fail authentication.  This is because if
			the client sets the GS2 channel binding flag set
			to "y" then the client must have believed that
			the server did not support channel binding -- if
			the server did in fact support channel binding
			then this is an indication that there has been a
			downgrade attack (e.g., an attacker changed the
			server's mechanism list to exclude the -PLUS
			suffixed SCRAM mechanism name(s)).
</li>
</ul><p>

	    
</p>
<p>The server MUST always validate the client's "c=" field.
		The server does this by constructing the value of the
		"c=" attribute and then checking that it matches the
		client's c= attribute value.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Channel Binding to TLS Channels</h3>

<p>If an external TLS channel is to be bound into the
		    SCRAM authentication, and if the channel was
		    established using a server certificate to
		    authenticate the server, then the SCRAM client and
		    server MUST use the 'tls-server-end-point' channel
		    binding type.  See the IANA Channel Binding Types
		    registry.
</p>
<p>If an external TLS channel is to be bound into the
		    SCRAM authentication, and if the channel was
		    established without the use of any server
		    certificate to authenticate the server, then the
		    SCRAM client and server MUST use the 'tls-unique'
		    channel binding type.
</p>
<a name="syntax"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Formal Syntax</h3>

<p>The following syntax specification uses the Augmented
		Backus-Naur Form (ABNF) notation as specified in <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.  "UTF8-2", "UTF8-3" and "UTF8-4"
		non-terminal are defined in <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   <dfn>ALPHA</dfn> = &lt;<span class='str'>as defined in RFC 5234 appendix B.1</span>&gt;
   <dfn>DIGIT</dfn> = &lt;<span class='str'>as defined in RFC 5234 appendix B.1</span>&gt;
   <dfn>UTF8-2</dfn> = &lt;<span class='str'>as defined in RFC 3629 (STD 63)</span>&gt;
   <dfn>UTF8-3</dfn> = &lt;<span class='str'>as defined in RFC 3629 (STD 63)</span>&gt;
   <dfn>UTF8-4</dfn> = &lt;<span class='str'>as defined in RFC 3629 (STD 63)</span>&gt;

   <dfn>generic-message</dfn> = <cite class='id'>attr-val</cite> <span class='rep'>*</span>("<span class='str'>,</span>" <cite class='id'>attr-val</cite>)
                     <em>;; Generic syntax of any server challenge</em>
                     <em>;; or client response</em>

   <dfn>attr-val</dfn>        = <cite class='key'>ALPHA</cite> "<span class='str'>=</span>" <cite class='id'>value</cite>

   <dfn>value</dfn>           = <span class='rep'>*</span><cite class='id'>value-char</cite>

   <dfn>value-safe-char</dfn> = <span class='val'>%x01-2B</span> / <span class='val'>%x2D-3C</span> / <span class='val'>%x3E-7F</span> /
                     <cite class='id'>UTF8-2</cite> / <cite class='id'>UTF8-3</cite> / <cite class='id'>UTF8-4</cite>
                     <em>;; UTF8-char except NUL, "=", and ",".</em>

   <dfn>value-char</dfn>      = <cite class='id'>value-safe-char</cite> / "<span class='str'>=</span>"

   <dfn>base64-char</dfn>     = <cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite> / "<span class='str'>/</span>" / "<span class='str'>+</span>"

   <dfn>base64-4</dfn>        = <span class='rep'>4</span><cite class='id'>base64-char</cite>

   <dfn>base64-3</dfn>        = <span class='rep'>3</span><cite class='id'>base64-char</cite> "<span class='str'>=</span>"

   <dfn>base64-2</dfn>        = <span class='rep'>2</span><cite class='id'>base64-char</cite> "<span class='str'>==</span>"

   <dfn>base64</dfn>          = <span class='rep'>*</span><cite class='id'>base64-4</cite> [<cite class='id'>base64-3</cite> / <cite class='id'>base64-2</cite>]

   <dfn>posit-number</dfn> = <span class='val'>%x31-39</span> <span class='rep'>*</span><cite class='key'>DIGIT</cite>
                     <em>;; A positive number</em>

   <dfn>saslname</dfn>        = <span class='rep'>1*</span>(<cite class='id'>value-safe-char</cite> / "<span class='str'>=2C</span>" / "<span class='str'>=3D</span>")
                     <em>;; Conforms to &lt;value&gt;</em>

   <dfn>authzid</dfn>         = "<span class='str'>a=</span>" <cite class='id'>saslname</cite>
                     <em>;; Protocol specific.</em>

   <dfn>gs2-cbind-flag</dfn>  = "<span class='str'>n</span>" / "<span class='str'>y</span>" / "<span class='str'>p</span>"
                     <em>;; "n" -&gt; client doesn't support channel binding</em>
                     <em>;; "y" -&gt; client does support channel binding</em>
                     <em>;;        but thinks the server does not.</em>
                     <em>;; "p" -&gt; client requires channel binding</em>
   <dfn>gs2-header</dfn>      = <cite class='id'>gs2-cbind-flag</cite> [ <cite class='id'>authzid</cite> ] "<span class='str'>,</span>"
                     <em>;; GS2 header for SCRAM</em>
                     <em>;; (the actual GS2 header includes an optional</em>
                     <em>;; flag to indicate that the GSS mechanism is not</em>
                     <em>;; "standard" but since SCRAM is "standard" we</em>
                     <em>;; don't include that flag).</em>

   <dfn>username</dfn>        = "<span class='str'>n=</span>" <cite class='id'>saslname</cite>
                     <em>;; Usernames are prepared using SASLPrep.</em>

   <dfn>reserved-mext</dfn>  = "<span class='str'>m=</span>" <span class='rep'>1*</span>(<cite class='id'>value-char</cite>)
                     <em>;; Reserved for signalling mandatory extensions.</em>
                     <em>;; The exact syntax will be defined in</em>
                     <em>;; the future.</em>

   <em>;;cbind-type    = value</em>
   <em>;;cbind-input   = gs2-header [ value ":" cbind-data ]</em>
   <dfn>channel-binding</dfn> = "<span class='str'>c=</span>" <cite class='id'>base64</cite>
                     <em>;; base64 encoding of cbind-input</em>

   <dfn>proof</dfn>           = "<span class='str'>p=</span>" <cite class='id'>base64</cite>

   <dfn>nonce</dfn>           = "<span class='str'>r=</span>" <cite class='id'>c-nonce</cite> [<cite class='id'>s-nonce</cite>]
                     <em>;; Second part provided by server.</em>

   <dfn>c-nonce</dfn>         = <cite class='id'>value</cite>

   <dfn>s-nonce</dfn>         = <cite class='id'>value</cite>

   <dfn>salt</dfn>            = "<span class='str'>s=</span>" <cite class='id'>base64</cite>

   <dfn>verifier</dfn>        = "<span class='str'>v=</span>" <cite class='id'>base64</cite>
                     <em>;; base-64 encoded ServerSignature.</em>

   <dfn>iteration-count</dfn> = "<span class='str'>i=</span>" <cite class='id'>posit-number</cite>
                     <em>;; A positive number</em>

   <dfn>client-first-message</dfn> =
                     <cite class='id'>gs2-header</cite> [<cite class='id'>reserved-mext</cite> "<span class='str'>,</span>"]
                     <cite class='id'>username</cite> "<span class='str'>,</span>" <cite class='id'>nonce</cite> ["<span class='str'>,</span>" <cite class='id'>extensions</cite>]

   <dfn>server-first-message</dfn> =
                     [<cite class='id'>reserved-mext</cite> "<span class='str'>,</span>"] <cite class='id'>nonce</cite> "<span class='str'>,</span>" <cite class='id'>salt</cite> "<span class='str'>,</span>"
                     <cite class='id'>iteration-count</cite> ["<span class='str'>,</span>" <cite class='id'>extensions</cite>]

   <dfn>client-final-message-without-proof</dfn> =
                     [<cite class='id'>channel-binding</cite> "<span class='str'>,</span>"] <cite class='id'>nonce</cite> ["<span class='str'>,</span>"
                     <cite class='id'>extensions</cite>]

   <dfn>client-final-message</dfn> =
                     <cite class='id'>client-final-message-without-proof</cite> "<span class='str'>,</span>" <cite class='id'>proof</cite>

   <dfn>gss-server-error</dfn> = "<span class='str'>e=</span>" <cite class='id'>value</cite>
   <dfn>server-final-message</dfn> = <cite class='id'>gss-server-error</cite> /
                     <cite class='id'>verifier</cite> ["<span class='str'>,</span>" <cite class='id'>extensions</cite>]
                     <em>;; The error message is only for the GSS-API</em>
                     <em>;; form of SCRAM, and it is OPTIONAL to</em>
                     <em>;; implement it.</em>

   <dfn>extensions</dfn> = <cite class='id'>attr-val</cite> <span class='rep'>*</span>("<span class='str'>,</span>" <cite class='id'>attr-val</cite>)
                     <em>;; All extensions are optional,</em>
                     <em>;; i.e. unrecognized attributes</em>
                     <em>;; not defined in this document</em>
                     <em>;; MUST be ignored.</em>

</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
SCRAM as a GSS-API Mechanism</h3>

<p>This section and its sub-sections and all normative
		references of it not referenced elsewhere in this
		document are INFORMATIONAL for SASL implementors, but
		they are NORMATIVE for GSS-API implementors.
</p>
<p>SCRAM is actually also GSS-API mechanism.  The messages
		are the same, but a) the GS2 header on the client's
		first message and channel binding data is excluded when
		SCRAM is used as a GSS-API mechanism, and b) the RFC2743
		section 3.1 initial context token header is prefixed to
		the client's first authentication message (context
		token).
</p>
<p>The GSS-API mechanism OID for SCRAM is &lt;TBD&gt; (see
		<a class='info' href='#iana'>Section&nbsp;10<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>).
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
GSS-API Principal Name Types for SCRAM</h3>

<p>SCRAM does not name acceptors.  Therefore only
		    GSS_C_NO_NAME and names of type GSS_C_NT_ANONYMOUS
		    shall be allowed as the target name input of
		    GSS_Init_sec_context() when using a SCRAM
		    mechanism.
</p>
<p>SCRAM supports only a single name type for
		    initiators: GSS_C_NT_USER_NAME.  GSS_C_NT_USER_NAME
		    is the default name type for SCRAM.
</p>
<p>There is no name canonicalization procedure for
		    SCRAM beyond applying SASLprep as described in <a class='info' href='#attrs'>Section&nbsp;5.1<span> (</span><span class='info'>SCRAM Attributes</span><span>)</span></a>.
</p>
<p>The query, display and exported name syntax for SCRAM
		    principal names is the same: there is no syntax -- SCRAM
		    principal names are free-form.  (The exported name
		    token does, of course, conform to <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> section 3.2, but the "NAME"
		    part of the token is just a SCRAM user name.)
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
GSS-API Per-Message Tokens for SCRAM</h3>

<p>The per-message tokens for SCRAM as a GSS-API
		    mechanism SHALL BE the same as those for the
		    Kerberos V GSS-API mechanism <a class='info' href='#RFC4121'>[RFC4121]<span> (</span><span class='info'>Zhu, L., Jaganathan, K., and S. Hartman, &ldquo;The Kerberos Version 5 Generic Security Service Application Program Interface (GSS-API) Mechanism: Version 2,&rdquo; July&nbsp;2005.</span><span>)</span></a>, using the Kerberos V
		    "aes128-cts-hmac-sha1-96" enctype <a class='info' href='#RFC3962'>[RFC3962]<span> (</span><span class='info'>Raeburn, K., &ldquo;Advanced Encryption Standard (AES) Encryption for Kerberos 5,&rdquo; February&nbsp;2005.</span><span>)</span></a>.
</p>
<p>The 128-bit session key SHALL be derived by using the
		    least significant (right-most) 128 bits of
		    HMAC(StoredKey, "GSS-API session key" || ClientKey
		    || AuthMessage).
</p>
<p>SCRAM does support PROT_READY, and is PROT_READY on
		    the initiator side first upon receipt of the
		    server's reply to the initial security context
		    token.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
GSS_Pseudo_random() for SCRAM</h3>

<p>The GSS_Pseudo_random() <a class='info' href='#RFC4401'>[RFC4401]<span> (</span><span class='info'>Williams, N., &ldquo;A Pseudo-Random Function (PRF) API Extension for the Generic Security Service Application Program Interface (GSS-API),&rdquo; February&nbsp;2006.</span><span>)</span></a> for
		    SCRAM SHALL be the same as for the Kerberos V
		    GSS-API mechanism <a class='info' href='#RFC4402'>[RFC4402]<span> (</span><span class='info'>Williams, N., &ldquo;A Pseudo-Random Function (PRF) for the Kerberos V Generic Security Service Application Program Interface (GSS-API) Mechanism,&rdquo; February&nbsp;2006.</span><span>)</span></a>.  There
		    is no acceptor-asserted sub-session key for SCRAM,
		    thus GSS_C_PRF_KEY_FULL and GSS_C_PRF_KEY_PARTIAL
		    are equivalent for SCRAM's GSS_Pseudo_random().
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>If the authentication exchange is performed without a
		strong security layer, then a passive eavesdropper can
		gain sufficient information to mount an offline
		dictionary or brute-force attack which can be used to
		recover the user's password. The amount of time
		necessary for this attack depends on the cryptographic
		hash function selected, the strength of the password and
		the iteration count supplied by the server. An external
		security layer with strong encryption will prevent this
		attack.
</p>
<p>If the external security layer used to protect the SCRAM
		exchange uses an anonymous key exchange, then the SCRAM
		channel binding mechanism can be used to detect a
		man-in-the-middle attack on the security layer and cause
		the authentication to fail as a result.  However, the
		man-in-the-middle attacker will have gained sufficient
		information to mount an offline dictionary or
		brute-force attack.  For this reason, SCRAM includes the
		ability to increase the iteration count over time.
</p>
<p>If the authentication information is stolen from the
		authentication database, then an offline dictionary or
		brute-force attack can be used to recover the user's
		password. The use of salt mitigates this attack somewhat
		by requiring a separate attack on each password.
		Authentication mechanisms which protect against this
		attack are available (e.g., the EKE class of
		mechanisms), but the patent situation is presently
		unclear.
</p>
<p>If an attacker obtains the authentication information
		from the authentication repository and either eavesdrops
		on one authentication exchange or impersonates a server,
		the attacker gains the ability to impersonate that user
		to all servers providing SCRAM access using the same
		hash function, password, iteration count and salt.  For
		this reason, it is important to use randomly-generated
		salt values.
</p>
<p>SCRAM does not negotiate a hash function to use.  Hash
		function negotiation is left to the SASL mechanism
		negotiation.  It is important that clients be able to
		sort a locally available list of mechanisms by
		preference so that the client may pick the most
		preferred of a server's advertised mechanism list.  This
		preference order is not specified here as it is a local
		matter.  The preference order should include objective
		and subjective notions of mechanism cryptographic
		strength (e.g., SCRAM with a successor to SHA-1 may be
		preferred over SCRAM with SHA-1).
</p>
<p>Note that to protect the SASL mechanism negotiation
		applications normally must list the server mechs twice:
		once before and once after authentication, the latter
		using security layers.  Since SCRAM does not provide
		security layers the only ways to protect the mechanism
		negotiation are: a) use channel binding to an external
		channel, or b) use an external channel that
		authenticates a user-provided server name.
</p>
<p>A hostile server can perform a computational
		denial-of-service attack on clients by sending a big
		iteration count value.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>IANA is requested to add the following entries to the
		SASL Mechanism registry established by <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a>:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

To: iana@iana.org
Subject: Registration of a new SASL mechanism SCRAM-HMAC-SHA-1

SASL mechanism name (or prefix for the family): SCRAM-HMAC-SHA-1
Security considerations: Section 7 of [RFCXXXX]
Published specification (optional, recommended): [RFCXXXX]
Person &amp; email address to contact for further information:
 IETF SASL WG &lt;ietf-sasl@imc.org&gt;
Intended usage: COMMON
Owner/Change controller: IESG &lt;iesg@ietf.org&gt;
Note:

To: iana@iana.org
Subject: Registration of a new SASL mechanism SCRAM-HMAC-SHA-1-PLUS

SASL mechanism name (or prefix for the family): SCRAM-HMAC-SHA-1-PLUS
Security considerations: Section 7 of [RFCXXXX]
Published specification (optional, recommended): [RFCXXXX]
Person &amp; email address to contact for further information:
 IETF SASL WG &lt;ietf-sasl@imc.org&gt;
Intended usage: COMMON
Owner/Change controller: IESG &lt;iesg@ietf.org&gt;
Note:

</pre></div>
<p>Note that even though this document defines a family of
		SCRAM-HMAC mechanisms, it doesn't register a family of
		SCRAM-HMAC mechanisms in the SASL Mechanisms registry.
		IANA is requested to prevent future registrations of
		SASL mechanisms starting with SCRAM-HMAC- without
		consulting the SASL mailing list
		&lt;ietf-sasl@imc.org&gt; first.
</p>
<p>Note to future SCRAM-HMAC mechanism designers: each new
		SCRAM-HMAC SASL mechanism MUST be explicitly registered
		with IANA and MUST comply with SCRAM-HMAC mechanism
		naming convention defined in <a class='info' href='#mechname'>Section&nbsp;4<span> (</span><span class='info'>SCRAM Mechanism Names</span><span>)</span></a>
		of this document.
</p>
<p>We hereby request that IANA assign a GSS-API mechanism
		OID for SCRAM.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank Dave Cridland for his
		contributions to this document.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Other Authentication Mechanisms</h3>

<p>The DIGEST-MD5 <a class='info' href='#I-D.ietf-sasl-digest-to-historic'>[I&#8209;D.ietf&#8209;sasl&#8209;digest&#8209;to&#8209;historic]<span> (</span><span class='info'>Melnikov, A., &ldquo;Moving DIGEST-MD5 to Historic,&rdquo; July&nbsp;2008.</span><span>)</span></a>
		mechanism has proved to be too complex to implement and
		test, and thus has poor interoperability. The security
		layer is often not implemented, and almost never used;
		everyone uses TLS instead.  For a more complete list of
		problems with DIGEST-MD5 which lead to the creation of
		SCRAM see <a class='info' href='#I-D.ietf-sasl-digest-to-historic'>[I&#8209;D.ietf&#8209;sasl&#8209;digest&#8209;to&#8209;historic]<span> (</span><span class='info'>Melnikov, A., &ldquo;Moving DIGEST-MD5 to Historic,&rdquo; July&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The CRAM-MD5 SASL mechanism, while widely deployed has
		also some problems, in particular it is missing some
		modern SASL features such as support for
		internationalized usernames and passwords, support for
		passing of authorization identity, support for channel
		bindings. It also doesn't support server authentication.
		For a more complete list of problems with CRAM-MD5 see
		<a class='info' href='#I-D.ietf-sasl-crammd5-to-historic'>[I&#8209;D.ietf&#8209;sasl&#8209;crammd5&#8209;to&#8209;historic]<span> (</span><span class='info'>Zeilenga, K., &ldquo;CRAM-MD5 to Historic,&rdquo; November&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The PLAIN <a class='info' href='#RFC4616'>[RFC4616]<span> (</span><span class='info'>Zeilenga, K., &ldquo;The PLAIN Simple Authentication and Security Layer (SASL) Mechanism,&rdquo; August&nbsp;2006.</span><span>)</span></a> SASL mechanism allows
		a malicious server or eavesdropper to impersonate the
		authenticating user to any other server for which the
		user has the same password. It also sends the password
		in the clear over the network, unless TLS is used.
		Server authentication is not supported.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Design Motivations</h3>

<p>The DIGEST-MD5 <a class='info' href='#I-D.ietf-sasl-digest-to-historic'>[I&#8209;D.ietf&#8209;sasl&#8209;digest&#8209;to&#8209;historic]<span> (</span><span class='info'>Melnikov, A., &ldquo;Moving DIGEST-MD5 to Historic,&rdquo; July&nbsp;2008.</span><span>)</span></a>
		mechanism has proved to be too complex to implement and
		test, and thus has poor interoperability. The security
		layer is often not implemented, and almost never used;
		everyone uses TLS instead.  For a more complete list of
		problems with DIGEST-MD5 which lead to the creation of
		SCRAM see <a class='info' href='#I-D.ietf-sasl-digest-to-historic'>[I&#8209;D.ietf&#8209;sasl&#8209;digest&#8209;to&#8209;historic]<span> (</span><span class='info'>Melnikov, A., &ldquo;Moving DIGEST-MD5 to Historic,&rdquo; July&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The CRAM-MD5 SASL mechanism, while widely deployed has
		also some problems, in particular it is missing some
		modern SASL features such as support for
		internationalized usernames and passwords, support for
		passing of authorization identity, support for channel
		bindings. It also doesn't support server authentication.
		For a more complete list of problems with CRAM-MD5 see
		<a class='info' href='#I-D.ietf-sasl-crammd5-to-historic'>[I&#8209;D.ietf&#8209;sasl&#8209;crammd5&#8209;to&#8209;historic]<span> (</span><span class='info'>Zeilenga, K., &ldquo;CRAM-MD5 to Historic,&rdquo; November&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The PLAIN <a class='info' href='#RFC4616'>[RFC4616]<span> (</span><span class='info'>Zeilenga, K., &ldquo;The PLAIN Simple Authentication and Security Layer (SASL) Mechanism,&rdquo; August&nbsp;2006.</span><span>)</span></a> SASL mechanism allows
		a malicious server or eavesdropper to impersonate the
		authenticating user to any other server for which the
		user has the same password. It also sends the password
		in the clear over the network, unless TLS is used.
		Server authentication is not supported.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
SCRAM Examples and Internet-Draft Change History</h3>

<p>&lt;&lt;To be written.&gt;&gt;
</p>
<p>(RFC Editor: Please delete everything after this
		point)
</p>
<p>Open Issues

		</p>
<ul class="text">
<li>The appendices need to be written.
</li>
<li>Should the server send a base64-encoded
			ServerSignature for the value of the "v"
			attribute, or should it compute a ServerProof
			the way the client computes a ClientProof?
</li>
</ul><p>

	    
</p>
<p>Changes since -10

		</p>
<ul class="text">
<li>Converted the source for this I-D to XML.
</li>
<li>Added text to make SCRAM compliant with the new
			GS2 design.
</li>
<li>Added text on channel binding negotiation.
</li>
<li>Added text on channel binding, including a
			reference to RFC5056.
</li>
<li>Added text on SCRAM as a GSS-API mechanism.  This
			noted as not relevant to SASL-only implementors
			-- the normative references for SCRAM as a
			GSS-API mechanism are segregated as well.
</li>
</ul><p>

	    
</p>
<p>Changes since -07

		</p>
<ul class="text">
<li>Updated References.
</li>
<li>Clarified purpose of the m= attribute.
</li>
<li>Fixed a problem with authentication/authorization
			identity's ABNF not allowing for some
			characters.
</li>
<li>Updated ABNF for nonce to show client-generated
			and server-generated parts.
</li>
<li>Only register SCRAM-HMAC-SHA-1 with IANA and
			require explicit registrations of all other
			SCRAM-HMAC- mechanisms.
</li>
</ul><p>

	    
</p>
<p>Changes since -06

		</p>
<ul class="text">
<li>Removed hash negotiation from SCRAM and turned it
			into a family of SASL mechanisms.
</li>
<li>Start using "Hash Function Textual Names" IANA
			registry for SCRAM mechanism naming.
</li>
<li>Fixed definition of Hi(str, salt) to be
			consistent with [RFC2898].
</li>
<li>Clarified extensibility of SCRAM: added m=
			attribute (for future mandatory extensions) and
			specified that all unrecognized attributes must
			be ignored.
</li>
</ul><p>

	    
</p>
<p>Changes since -05

		</p>
<ul class="text">
<li>Changed the mandatory to implement hash algorithm
			to SHA-1 (as per WG consensus).
</li>
<li>Added text about use of SASLPrep for username
			canonicalization/validation.
</li>
<li>Clarified that authorization identity is
			canonicalized/verified according to SASL
			protocol profile.
</li>
<li>Clarified that iteration count is per-user.
</li>
<li>Clarified how clients select the authentication
			function.
</li>
<li>Added IANA registration for the new
			mechanism.
</li>
<li>Added missing normative references (UTF-8,
			SASLPrep).
</li>
<li>Various editorial changes based on comments from
			Hallvard B Furuseth, Nico William and Simon
			Josefsson.
</li>
</ul><p>

	    
</p>
<p>Changes since -04

		</p>
<ul class="text">
<li>Update Base64 and Security Glossary
			references.
</li>
<li>Add Formal Syntax section.
</li>
<li>Don't bother with "v=".
</li>
<li>Make MD5 mandatory to implement. Suggest
			i=128.
</li>
</ul><p>

	    
</p>
<p>Changes since -03

		</p>
<ul class="text">
<li>Seven years have passed, in which it became clear
			that DIGEST-MD5 suffered from unacceptably bad
			interoperability, so SCRAM-MD5 is now back from
			the dead.
</li>
<li>Be hash agnostic, so MD5 can be replaced more
			easily.
</li>
<li>General simplification.
</li>
</ul><p>

	    
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3174">[RFC3174]</a></td>
<td class="author-text">Eastlake, D. and P. Jones, &ldquo;<a href="http://tools.ietf.org/html/rfc3174">US Secure Hash Algorithm 1 (SHA1)</a>,&rdquo; RFC&nbsp;3174, September&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3174.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3454">[RFC3454]</a></td>
<td class="author-text">Hoffman, P. and M. Blanchet, &ldquo;<a href="http://tools.ietf.org/html/rfc3454">Preparation of Internationalized Strings ("stringprep")</a>,&rdquo; RFC&nbsp;3454, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3454.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4013">[RFC4013]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4013">SASLprep: Stringprep Profile for User Names and Passwords</a>,&rdquo; RFC&nbsp;4013, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4013.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4422">[RFC4422]</a></td>
<td class="author-text">Melnikov, A. and K. Zeilenga, &ldquo;<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>,&rdquo; RFC&nbsp;4422, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4422.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Normative References for GSS-API implementors</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3962">[RFC3962]</a></td>
<td class="author-text">Raeburn, K., &ldquo;<a href="http://tools.ietf.org/html/rfc3962">Advanced Encryption Standard (AES) Encryption for Kerberos 5</a>,&rdquo; RFC&nbsp;3962, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3962.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4121">[RFC4121]</a></td>
<td class="author-text">Zhu, L., Jaganathan, K., and S. Hartman, &ldquo;<a href="http://tools.ietf.org/html/rfc4121">The Kerberos Version 5 Generic Security Service Application Program Interface (GSS-API) Mechanism: Version 2</a>,&rdquo; RFC&nbsp;4121, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4121.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4401">[RFC4401]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc4401">A Pseudo-Random Function (PRF) API Extension for the Generic Security Service Application Program Interface (GSS-API)</a>,&rdquo; RFC&nbsp;4401, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4401.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4402">[RFC4402]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc4402">A Pseudo-Random Function (PRF) for the Kerberos V Generic Security Service Application Program Interface (GSS-API) Mechanism</a>,&rdquo; RFC&nbsp;4402, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4402.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.3.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sasl-crammd5-to-historic">[I-D.ietf-sasl-crammd5-to-historic]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-crammd5-to-historic-00.txt">CRAM-MD5 to Historic</a>,&rdquo; draft-ietf-sasl-crammd5-to-historic-00 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-crammd5-to-historic-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sasl-digest-to-historic">[I-D.ietf-sasl-digest-to-historic]</a></td>
<td class="author-text">Melnikov, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-digest-to-historic-00.txt">Moving DIGEST-MD5 to Historic</a>,&rdquo; draft-ietf-sasl-digest-to-historic-00 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-digest-to-historic-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sasl-rfc2831bis">[I-D.ietf-sasl-rfc2831bis]</a></td>
<td class="author-text">Melnikov, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-rfc2831bis-12.txt">Using Digest Authentication as a SASL Mechanism</a>,&rdquo; draft-ietf-sasl-rfc2831bis-12 (work in progress), March&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sasl-rfc2831bis-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2195">[RFC2195]</a></td>
<td class="author-text"><a href="mailto:klensin@mci.net">Klensin, J.</a>, <a href="mailto:randy@mci.net">Catoe, R.</a>, and <a href="mailto:paul@mci.net">P. Krumviede</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2195">IMAP/POP AUTHorize Extension for Simple Challenge/Response</a>,&rdquo; RFC&nbsp;2195, September&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2195.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2195.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2195.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2202">[RFC2202]</a></td>
<td class="author-text"><a href="mailto:pau@watson.ibm.com">Cheng, P.</a> and <a href="mailto:rob.glenn@nist.gov">R. Glenn</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2202">Test Cases for HMAC-MD5 and HMAC-SHA-1</a>,&rdquo; RFC&nbsp;2202, September&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2202.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2202.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2202.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2898">[RFC2898]</a></td>
<td class="author-text">Kaliski, B., &ldquo;<a href="http://tools.ietf.org/html/rfc2898">PKCS #5: Password-Based Cryptography Specification Version 2.0</a>,&rdquo; RFC&nbsp;2898, September&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2898.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4510">[RFC4510]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4510">Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map</a>,&rdquo; RFC&nbsp;4510, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4510.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4616">[RFC4616]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4616">The PLAIN Simple Authentication and Security Layer (SASL) Mechanism</a>,&rdquo; RFC&nbsp;4616, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4616.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4949">[RFC4949]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4949.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Abhijit Menon-Sen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Oryx Mail Systems GmbH</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ams@oryx.com">ams@oryx.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alexey Melnikov</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Isode Ltd</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Alexey.Melnikov@isode.com">Alexey.Melnikov@isode.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chris Newman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sun Microsystems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1050 Lakes Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">West Covina, CA  91790</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:chris.newman@sun.com">chris.newman@sun.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nicolas
	    Williams</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sun Microsystems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5300 Riata Trace Ct</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Austin, TX  78727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Nicolas.Williams@sun.com">Nicolas.Williams@sun.com</a></td></tr>
</table>
</body></html>
