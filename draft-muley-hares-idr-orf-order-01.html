<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Group Co-operative Route Filtering capability for BGP-4</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Group Co-operative Route Filtering capability for BGP-4">
<meta name="keywords" content="I-D, Internet-Draft, BGP, ORF">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IDR</td><td class="header">S. Hares</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Green Hills Software</td></tr>
<tr><td class="header">Expires: August 28, 2008</td><td class="header">P. Muley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Alcatel</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">K. Patel</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. Schliesser</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Saavis Communications</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 25, 2008</td></tr>
</table></td></tr></table>
<h1><br />Group Co-operative Route Filtering capability for BGP-4<br />draft-muley-hares-idr-orf-order-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 28, 2008.</p>

<h3>Abstract</h3>

<p>
Currently BGP-4 is capable of carrying multiple (Outbound Route Filters)
ORFs entries for a given "AFI/SAFI".  Each ORF provides a filter that a
route whose NLRI matches AFI/SAFI, must pass through to be transmitted
in the BGP Update message.  Efficient processing of ORF filters may require
ordering of individual ORFs in certain sequence and grouping of ORFs that
should be applied together. The grouping functionality also provides the
support for logical OR operation between the grouped ORFs.

</p>
<p>
This group ORF provides an ORF type that specifies that ordering and
grouping. The route set that passes set of ORFs running in a "Group ORF"
will pass the same ORFs sent in normal ORFs.
    
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions used in this document<br />
<a href="#anchor3">2.</a>&nbsp;
Introduction<br />
<a href="#anchor4">3.</a>&nbsp;
Past Contriburos<br />
<a href="#anchor5">4.</a>&nbsp;
Group ORF Type<br />
<a href="#anchor6">5.</a>&nbsp;
 Group ORF Encoding<br />
<a href="#anchor7">6.</a>&nbsp;
ORF Entry Encoding<br />
<a href="#anchor8">7.</a>&nbsp;
Group Cooperative route filtering capability <br />
<a href="#anchor9">8.</a>&nbsp;
 Operation <br />
<a href="#anchor10">9.</a>&nbsp;
Deployment Scenarios<br />
<a href="#anchor11">10.</a>&nbsp;
Security Considerations<br />
<a href="#anchor12">11.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Definitions</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions used in this document</h3>

<p>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
          "OPTIONAL" in this document are to be interpreted as described
          in <a class='info' href='#RFC2119'>RFC2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>
Currently it is not uncommon for a BGP speaker to receive set of ORFs from
an ORF capable BGP peer. Each ORF provides a filter that a route must pass
through to be transmitted in the BGP update message.  Today's operational
 procedure for cooperative route filtering provides the AFI/SAFI as the
 only context. ORF by definition in its current form have logical OR within
 ORF entries and logical AND within the ORF types. Efficient processing and
 expression of filters for ORF may require ordering of ORFs filters and
 ORF entries in certain sequence. Efficient processing entails both BGP
 processing and quick processing of the ORF generated from User policies.
 
</p>
<p>
This document defines GROUP ORF, a new BGP-4 ORF type that allows BGP to
send to its peer a group of set of ordered ORF filters.  Group ORF provides
a context for filtering rules that need to be interpreted together further
 within that context AFI/SAFI. The grouping functionality also provides the
 support for logical OR operation between grouped ORFs.
 
</p>
<p>
Today ORF entries of same ORF type have logical OR functionality only,
which limits the flexibility of defining an efficient ORF with less grammar
description. Group ORF capability will help in defining the relational
 meaning within the ORF entries as well.
 
</p>
<p>One example of this is the use of ORFs to efficiently handle complex
ORF policies applied per VPN per peer, in BGP/MPLS VPN deployment
as defined in: <a class='info' href='#RFC4364'>RFC4364<span> (</span><span class='info'>Cisco and Juniper, &ldquo;BGP/MPLS VPN,&rdquo; February&nbsp;2006.</span><span>)</span></a> [RFC4364].
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Past Contriburos</h3>

<p>
      The authors want to acknowledge the contributions of Luyuan Fang and Nabil Bitar. 
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Group ORF Type</h3>

<p>
 The group ORF type allows a set of ORF entries of different ORF types
and ORF entries within the type, to be grouped, and ordered in the
BGP ROUTE-REFRESH message  <a class='info' href='#RFC2918'>RFC2918<span> (</span><span class='info'>Cisco, &ldquo;Route Refresh Capability for BGP-4,&rdquo; Septebmer&nbsp;2000.</span><span>)</span></a> [RFC2918].
The Group ORF provides group cooperative route filtering.

</p>
<p>
Conceptually a Group ORF consist of multiple different types of ORF
entries as defined in <a class='info' href='#bgp-orf'>[BGP-ORF]<span> (</span><span class='info'>Sangli, S. and Cisco, &ldquo;&quot;Cooperative Router Filtering for BGP-4&quot;,&rdquo; July&nbsp;2005.</span><span>)</span></a> [bgp&#8209;orf],
<a class='info' href='#aspath-orf'>[ASPATH-ORF]<span> (</span><span class='info'>Hares, S. and K. Patel, &ldquo;&quot;Aspath Based Outbound Route Filter for BGP-4&quot;,&rdquo; August&nbsp;2007.</span><span>)</span></a> [aspath&#8209;orf] and
<a class='info' href='#prefix-orf'>[prefix-ORF]<span> (</span><span class='info'>Sangli, S. and Cisco, &ldquo;&quot;Address Prefix Based Outbound Route Filter for BGP-4&quot;,&rdquo; March&nbsp;2005.</span><span>)</span></a> [prefix&#8209;orf]. Each such ORF type,
will have ordered ORF entries, with an operation of logical OR or logical
AND defined with each other.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
 Group ORF Encoding</h3>

<p>
 The value of the ORF-Type for Group ORF is [TBD].

</p>
<p>
Conceptually the Route Refresh message carrying Group ORF can be viewed as below.

</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      +--------------------------------------------------+
      | Address Family Identifier (2 octets)             |
      +--------------------------------------------------+
      | Reserved (1 octet)                               |
      +--------------------------------------------------+
      | Subsequent Address Family Identifier (1 octet)   |
      +--------------------------------------------------+
      | When-to-refresh (1 octet)                        |
      +--------------------------------------------------+
      |  ORF Type (1 octet) (Group)                      |
      +--------------------------------------------------+
      |  ORF Group Flags                                 |
      +--------------------------------------------------+
      | Length of ORFs (2 octets)                        |
      +--------------------------------------------------+
      | First ORF entry (variable) (Group)               |
      +--------------------------------------------------+
      | Second ORF entry (variable)  (Group)             |
      +--------------------------------------------------+
         .........
      +--------------------------------------------------+
      | N-th ORF entry (variable)                        |
      +--------------------------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;ORF byte layout &nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Each Group ORF entry will be encoded as follows.

      +--------------------------------------------------+
      | ORF Group id (1 octet)                           |
      +--------------------------------------------------+
      | ORF Type (1 octet)    [Group]                    |
      +--------------------------------------------------+
      | ORF Action (1 octet)                             |
      +--------------------------------------------------+
      | ORF FLags (1 octet)                              |
      | Length of ORFs (2 octets)                        |
      +--------------------------------------------------+
      | First ORF entry (variable)                       |
      +--------------------------------------------------+
      | Second ORF entry (variable)                      |
      +--------------------------------------------------+
         .........
      +--------------------------------------------------+
      | N-th ORF entry (variable)                        |
      +--------------------------------------------------+
      | ORF Type (1 octet)                               |
      +--------------------------------------------------+
      | Length of ORFs (2 octets)                        |
      +--------------------------------------------------+
      | First ORF entry (variable)                       |
      +--------------------------------------------------+
      | Second ORF entry (variable)                      |
      +--------------------------------------------------+
        .........
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Group ORF byte layout&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>ORF Action: 
</p>
<p>Byte that indicates operation of "AND and OR" function
       within the full Group ORF.
</p>
<p>Value 000  Use AND or OR specified in Group ORF.
       OR between GROUP IDs.
</p>
<p>Value 001  Always AND between attributes in Flag Byte 
</p>
<p> Always ORed between same Route-map's different sequences. 
</p>
<p>
</p>
<p>ORF FLAG:
</p>
<p>
</p>
<p> Value 0000 0001   Route-Map
</p>
<p> Value 0000 0002   Access Control List 
</p>
<p> Value 1000 0000   Ignore ORF Action BIT 
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
ORF Entry Encoding</h3>

<p>
As specified in the <a class='info' href='#bgp-orf'>[BGP-ORF]<span> (</span><span class='info'>Sangli, S. and Cisco, &ldquo;&quot;Cooperative Router Filtering for BGP-4&quot;,&rdquo; July&nbsp;2005.</span><span>)</span></a> [bgp&#8209;orf]
the ORF entry definition has common part
and type specific part. The encoding of common part of the ORF entries
on Group ORF capability negotiation as defined below.

</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

          +---------------------------------+
          |   Action (2 bit)                |
          +---------------------------------+
          |  Match (1 bit)                  |
          +---------------------------------+
          |  AND/OR (1 bit)                 |
          +---------------------------------+
          |   Reserved (4 bits)             |
          +---------------------------------+
          |   Type specific part (variable)  |
          +---------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Group ORF Entry Byte&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
The new AND/OR is a one bit field additional to the definition specified
in <a class='info' href='#bgp-orf'>[BGP-ORF]<span> (</span><span class='info'>Sangli, S. and Cisco, &ldquo;&quot;Cooperative Router Filtering for BGP-4&quot;,&rdquo; July&nbsp;2005.</span><span>)</span></a> [bgp&#8209;orf]. The value of this field is
0 for expression of logical OR and 1 for logical AND with the next
ORF entry. The ORF entries grammar expression
for logical OR followed by logical AND ORF entries will be for
the over all the group of such and-ed ORF entries. This field in the
last entry of the ORF type will be ignored.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Group Cooperative route filtering capability </h3>

<p>
A BGP speaker that is willing to receive Group ORF entries from its peer, or
a BGP speaker that would like to send ORF entries to its peer advertises this
to the peer by using the Cooperative Route Filtering Capability, as described below.

</p>
<p>
The Group ORF Capability is a new BGP capability

</p>
<p><a class='info' href='#bgp-cap'>[BGP-CAP]<span> (</span><span class='info'>Cisco and Cisco, &ldquo;Capabilities Advertisement with BGP-4,&rdquo; November&nbsp;2002.</span><span>)</span></a> [bgp&#8209;cap] defined as follows
   </p>
<blockquote class="text">
<p>Capability code: X [IANA consideration]
</p>
<p>Capability length: variable 
</p>
<p>Capability value: one or more of the entries as defined for ORF
   entries in the <a class='info' href='#bgp-orf'>[BGP-ORF]<span> (</span><span class='info'>Sangli, S. and Cisco, &ldquo;&quot;Cooperative Router Filtering for BGP-4&quot;,&rdquo; July&nbsp;2005.</span><span>)</span></a> [bgp&#8209;orf].
   
</p>
</blockquote><p>
 
</p>
<p>
The use of ORF entry in Group ORF will depend upon the send/receive value of
the ORF type in capability negotiation

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
 Operation </h3>

<p>
In addition to operational procedures defined in <a class='info' href='#bgp-orf'>[BGP-ORF]<span> (</span><span class='info'>Sangli, S. and Cisco, &ldquo;&quot;Cooperative Router Filtering for BGP-4&quot;,&rdquo; July&nbsp;2005.</span><span>)</span></a> [bgp&#8209;orf]  several additional operational rules needs to be followed.

</p>
<p>
The Group ORF Group-ID allows a tag for a group of ORFs.  If multiple
instances of a Group ORF with the same Group-ID exist within a
Route Refresh Message, the additional group information is appended to the
set of previously received ORFs with the same Group-ID. The complete list of
ORFs within the Group will be included in the "and-ing" process for that Group.

</p>
<p>
When processing multiple Group ORFs into a filter, the Group ORFs will be
applied in ascending order of the Group ID.

</p>
<p>
When the BGP speaker receives multiple ORFs within a Group ORF entry, the
order of the ORFs is preserved and applied as per first ORF entry match rule.

</p>
<p>For each Group ORF, a BGP speaker will pass the set of candidate NLRIs
(routes) through each ORF that is a member of the Group, and-ing the results
(and-ing of PERMIT and DENY results in DENY). If a Group ORF would result in
a PERMIT for a given NLRI, it is advertised to the peer and it is removed from
the list of candidate NLRIs. If a Group ORF would result in a DENY for a
given NLRI, it is not advertised to the peer and it is removed from the list
of candidate NLRIs. The remaining list of candidate NLRIs are then filtered
through the next Group ORF.

</p>
<p>This process is repeated until the candidate
NRLIs have been filtered through all Group ORFs. The remaining candidate
NLRIs are then filtered through any non-Group ORFs that might exist.
While processing the ORF entries in the ORF type the result of ORF entry
match with AND/OR bit set will be and-ed  with the subsequent ORF
entry match. The ORF entry with AND/OR bit is set to 0 will OR the match
result with subsequent entry match result. Rest of the procedure for
treatment of NLRI remains same as described in the
<a class='info' href='#bgp-orf'>[BGP-ORF]<span> (</span><span class='info'>Sangli, S. and Cisco, &ldquo;&quot;Cooperative Router Filtering for BGP-4&quot;,&rdquo; July&nbsp;2005.</span><span>)</span></a> [bgp&#8209;orf].

</p>
<p>
To remove a group ORF then all the ORF entries in the Group ORF will have the
action component as REMOVE.

</p>
<p>The Group ORF MUST always have higher preference than non-Group ORFs,
and will be processed first.

</p>
<p>
Note: Group ORF are independent of ORF preference and configuration to occur
without concern for order of transmission. Individual ORF type preference
within the Group ORF will occur based on configuration policy.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Deployment Scenarios</h3>

<p>
Following are few deployment examples where Group ORF helps in filtering
and offering flexibility in ORF expression.

</p>
<p> Scenario 1 
</p>
<p>
An example of group ORF could be in the IPVPN case is where multiple
BGP communities <a class='info' href='#bgp-com'>[BGP-COM}<span> (</span><span class='info'>Cisco, Cisco, and Cisco, &ldquo;BGP/MPLS VPN,&rdquo; August&nbsp;1996.</span><span>)</span></a> [bgp&#8209;com]
and/or extended communities need to be considered together for
 a given VPN in the filtering rules although all IPVPN routes belong to
 the same AFI/SAFI.
 
</p>
<p>Consider the case where there are two VPNs, red and yellow, have routes
 belonging to sites tagged by community attributes that express city
 locations. The Red VPN wants or needs  to get routes from certain site
 locations but not others. Similarly, the yellow VPN wants or needs to get
 sites from certain location not others. For the purpose of ease
 in manageability, it would be desired to affiliate the community attribute
 value with the city location only. That is the red VPN and yellow VPN
 routes will carry the same city community value when these routes reside
 in same city. 
</p>
<p>If cooperative route filtering is used without group ORF, it
 will not be possible to express the ORFs when the the two VPNs have different
 rules whereby different city routes need to be imported to another city for
 the two VPNs. This is because of the ORing operation within the same ORF type
 and ANDing operation across ORF types.
 
</p>
<p> To illustrate further consider the
 following example where routers in the red VPN in city 4 needs to get the
routes from city 1 only and not from city 2 and 3. On the other hand, the
routers in the yellow VPN in city 4 needs to get routes from city 2 but not
city 3 and city 1. In current procedures for cooperative route filtering
without group ORF, the only way to express that for ORF from the routers
hosting VPN sites in city 4 is:
</p>
<blockquote class="text">
<p>AFI/SAFI = IPVPN
</p>
<p>Extended ORF Type = Target Extended Community
    </p>
<blockquote class="text">
<p>Permit Red
</p>
<p>Permit Yellow
</p>
</blockquote> 
     

<p>ORF Type = Community
	   </p>
<blockquote class="text">
<p>Permit City1
</p>
<p>Permit City2
</p>
</blockquote> 
    

</blockquote><p>
  
</p>
<p>
  Based on this ORF routes tagged with Red and City2 will be permitted
  and routes tagged with Yellow and City1 will be permitted although
  these are not deired routes and will need to be filtered out by a local
  policy on the routers in City4.
  
</p>
<p>
  If group ORF was available, the ORF policy can be more flexibly expressed in
  the following manner:

  </p>
<blockquote class="text">
<p>AFI/SAFI = IPVPN
</p>
<p> Group 1 (implicitly Red VPN)
	 </p>
<blockquote class="text">
<p>Extended ORF Type = Target Extended Community
       </p>
<blockquote class="text">
<p>Permit Red 
</p>
</blockquote>
       

<p>ORF Type = Community
       </p>
<blockquote class="text">
<p> Permit City1
</p>
</blockquote>
       

</blockquote>
  

<p>Group 2 (implicitly Yellow VPN)
	 </p>
<blockquote class="text">
<p>Extended ORF Type = Target Extended Community
      </p>
<blockquote class="text">
<p> Permit Yellow 
</p>
</blockquote>
      

<p>ORF Type = Community
       </p>
<blockquote class="text">
<p> Permit City2 
</p>
</blockquote>
       

</blockquote>
   

</blockquote><p>
  
</p>
<p>
Thus Group 1 provides a context for the red VPN and Group 2 provides a
context for the yellow VPN. Only routes that are tagged with Red target
extended community attributes and City1 community or routes tagged with
Yellow target community attributes and City2 community will be permitted
to be advertised to the BGP client that sent this ORF, achieving the desired
result.

</p>
<p>
It may be argued that in this simple case, the problem could be addressed
with existing ORF capabilities by simply tagging the Red and City 1 routes
with a new extended community tag (Red_City1) and the routes with the Yellow
and City2 tags with a new target extended community tag (Yellow_City2) and
including these in the ORF. However, this can get complicated as the number
of combinations of BGP extended communities
<a class='info' href='#RFC4360'>RFC4360<span> (</span><span class='info'>Cisco, Cisco, and Juniper, &ldquo;BGP Extended Communities Attribute,&rdquo; July&nbsp;2006.</span><span>)</span></a> [RFC4360] and communities increases. Having
group ORF capability offers the needed flexibility.

</p>
<p> It is also true that the same result can be achieved by defining
local policies on the routers but the tradeoff as in any ORF case is
between the work done at a client and that done at the route reflector
when used in topology.

</p>
<p> Scenario 2 
</p>
<p>
An example Group ORF in the global routing context can be where a BGP speaker
wants to learn certain more specific NLRIs only if they traverse certain
AS path. Otherwise routes which are less specific than /25. A Group ORF
will look like as defined below where X,Y,Z are the more specific NLRIs
to be learnt only if it learn it from AS1.

</p>
<p>
 </p>
<blockquote class="text">
<p>AFI/SAFI = IPV4 
</p>
<p>Group 1
   </p>
<blockquote class="text">
<p> ORF Type = Prefix
      </p>
<blockquote class="text">
<p>Permit X 
</p>
<p>Permit Y 
</p>
<p>Permit Z 
</p>
</blockquote>
      

<p> ORF Type = ASpath
      </p>
<blockquote class="text">
<p>Permit  AS1 
</p>
</blockquote>
      

</blockquote>
    

<p> Group 2
   </p>
<blockquote class="text">
<p>ORF Type = Prefix
     </p>
<blockquote class="text">
<p>Deny  prefix( */25) or longer 
</p>
</blockquote>
     

</blockquote>
   

<p> Group 3 
      </p>
<blockquote class="text">
<p>ORF Type = Prefix
         </p>
<blockquote class="text">
<p>Permit prefix(*)
</p>
</blockquote>
         

</blockquote>
      

</blockquote><p>
  
</p>
<p>
Although its possible to achieve the above mentioned application by
making use of route policies, use of Group ORF helps in simplifying
the configuration.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>
  This extension to BGP does not change the underlying security issues.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA Considerations</h3>

<p> IANA will need to assign the value of the ORF-Type for Group ORF.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.&nbsp;References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4364">[RFC4364]</a></td>
<td class="author-text">Cisco and Juniper, &ldquo;<a href="http://www.ietf.org/rfc/rfc4364.txt">BGP/MPLS VPN</a>,&rdquo; February&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="bgp-cap">[bgp-cap]</a></td>
<td class="author-text">Cisco and Cisco, &ldquo;<a href="http://www.ietf.org/rfc/rfc3392.txt">Capabilities Advertisement with BGP-4</a>,&rdquo; November&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="bgp-com">[bgp-com]</a></td>
<td class="author-text">Cisco, Cisco, and Cisco, &ldquo;<a href="ftp://ftp.isi.edu/rfc/rfc-1997">BGP/MPLS VPN</a>,&rdquo; August&nbsp;1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4360">[RFC4360]</a></td>
<td class="author-text">Cisco, Cisco, and Juniper, &ldquo;<a href="http://www.ietf.org/rfc/rfc4360.txt">BGP Extended Communities Attribute</a>,&rdquo; July&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2918">[RFC2918]</a></td>
<td class="author-text">Cisco, &ldquo;<a href="http://www.ietf.org/rfc/rfc2918">Route Refresh Capability for BGP-4</a>,&rdquo; Septebmer&nbsp;2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="bgp-orf">[bgp-orf]</a></td>
<td class="author-text">Sangli, S. and Cisco, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-idr-route-filter-15.txt">"Cooperative Router Filtering for BGP-4"</a>,&rdquo; July&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="prefix-orf">[prefix-orf]</a></td>
<td class="author-text">Sangli, S. and Cisco, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-idr-bgp-prefix-orf-04.txt">"Address Prefix Based Outbound Route Filter for BGP-4"</a>,&rdquo; March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="aspath-orf">[aspath-orf]</a></td>
<td class="author-text">Hares, S. and K. Patel, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-idr-aspath-orf-09.txt">"Aspath Based Outbound Route Filter for BGP-4"</a>,&rdquo; August&nbsp;2007.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Susan Hares</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Green Hills Software</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">825 Victors Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ann Arbor, MI  48108</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-734-222-1610</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:shares@ghs.com">shares@ghs.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Praveen Muley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">701, E. Middle Field Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mountain View, CA  94043</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-650-623-2622</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Praveen.Muley@alcatel.com">Praveen.Muley@alcatel.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Keyur Patel</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:keyupate@cisco.com">keyupate@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Benson Schliesser</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Saavis Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1 Savvis Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Town and Country, MO  63017</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-314-628-7036</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:bensons@savvis.net">bensons@savvis.net</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
