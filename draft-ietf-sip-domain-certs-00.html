<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Domain Certificates in the Session Initiation Protocol (SIP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Domain Certificates in the Session Initiation Protocol (SIP)">
<meta name="keywords" content="I-D, Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIP WG</td><td class="header">V. Gurbani</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Bell Laboratories, Alcatel-Lucent</td></tr>
<tr><td class="header">Intended status:  BCP</td><td class="header">S. Lawrence</td></tr>
<tr><td class="header">Expires:  May 11, 2008</td><td class="header">Bluesocket Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Jeffrey</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Bell Laboratories, Alcatel-Lucent</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 08, 2007</td></tr>
</table></td></tr></table>
<h1><br />Domain Certificates in the Session Initiation Protocol (SIP)<br />DOCNAME</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 11, 2008.</p>

<h3>Abstract</h3>

<p>This document describes how to interpret certain information in a 
X.509 PKIX-compliant certificate used in a Transport Layer Security (TLS) 
connection.  More specifically, it describes how to find the right
identity for authentication in such certificates and how to use it for 
mutual authentication.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Key Words<br />
<a href="#anchor3">2.</a>&nbsp;
Introduction<br />
<a href="#problem">3.</a>&nbsp;
Problem statement<br />
<a href="#problem-drilldown">4.</a>&nbsp;
SIP domain to host resolution<br />
<a href="#problem-mutual">5.</a>&nbsp;
The need for mutual interdomain authentication<br />
<a href="#sp">6.</a>&nbsp;
Guidelines for a service provider<br />
<a href="#SIP-considerations">7.</a>&nbsp;
Behavior of SIP entities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cert-subject">7.1.</a>&nbsp;
Finding SIP Identities in a Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#id-compare">7.2.</a>&nbsp;
Comparing SIP Identities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uac">7.3.</a>&nbsp;
Client behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uas">7.4.</a>&nbsp;
Server behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#proxy">7.5.</a>&nbsp;
Proxy behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#registrar">7.6.</a>&nbsp;
Registrar behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#redirect">7.7.</a>&nbsp;
Redirect server behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#virtual-servers">7.8.</a>&nbsp;
Virtual SIP Servers and Certificate Content<br />
<a href="#sec-cons">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#digest-connection">8.1.</a>&nbsp;
Connection authentication using Digest<br />
<a href="#iana-cons">9.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor7">10.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Terminology</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Key Words</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [1]. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Transport Layer Security (TLS) <a class='info' href='#RFC2246'>[3]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a> has started to
appear in an increasing number of Session Initiation Protocol (SIP) <a class='info' href='#RFC3261'>[2]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> implementations.  In order to use the authentication
capabilities of TLS, certificates as defined by the Internet X.509 Public
Key Infrastructure <a class='info' href='#RFC3280'>RFC 3280<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and   Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> [4] are required.
</p>
<p>Existing SIP specifications do no sufficiently specify how to use
certificates for domain (as opposed to host) authentication.  This document
provides guidance to ensure interoperability and uniform conventions for the 
construction of SIP domain certificates.
</p>
<p>The discussion in this document is pertinent to an X.509 PKIX-compliant
certificate used for a TLS connection; it may not apply to use of such
certificates with S/MIME, for instance.  
</p>
<a name="problem"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Problem statement</h3>

<p>TLS uses X.509 Public Key Infrastructure <a class='info' href='#RFC3280'>[4]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and   Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> to
bind an identity, or a set of identities, to the subject of a X.509
certificate.  Accordingly, the recommendations of the SIP working group 
have been to populate the X.509v3 subjectAltName extension with an
identity.  However, this is under-specified in RFC 3261, which mentions 
subjectAltName in conjunction with S/MIME only and not TLS.  The
security properties of TLS and S/MIME as used in SIP are different:
X.509 certificates used for S/MIME are generally used for end-to-end 
authentication and encryption, thus they serve to bind the identity
of a user to the certificate.  On the other hand, X.509 certificates 
used for TLS serve to bind the identities of the per-hop domain sending 
or receiving the SIP messages.
</p>
<p>While RFC3261 provides adequate guidance on the use of X.509
certificates used for S/MIME, it is relatively silent on the use of
such certificates for TLS.  The concept of what should be contained in a 
site (or domain) certificate in RFC3261 is quoted below (Section 26.3.1):
</p>
<p></p>
<blockquote class="text">
<p>Proxy servers, redirect servers and registrars SHOULD possess a
 site certificate whose subject corresponds to their canonical
 hostname.
</p>
</blockquote>

<p>The lack of specifications leads to problems when attempting to interpret 
the certificate contents for TLS connections in a uniform manner.
</p>
<p>This document shows how the certificates are to be used for mutual
authentication when both the client and server possess appropriate
certificates.  It also contains normative behavior for matching the 
DNS query string with an identity stored in the X.509 certificate.
Following the accepted practice of the time, legacy X.509 certificates 
may store the identity in the Common Name (CN) field of the certificate
<a class='info' href='#comment.Comment.1'>[Comment.1]<span> (</span><span class='info'>Stephen Kent: PKIX standards made an exception for RFC 822 names in legacy certificates, but not for DNS names or URIs!  There is a private extension, developed by Netscape for representing a DNS name in a certificate prior to the advent of SAN.  I think it's rather late to be accomodating certificates that are not compliant with RFC 3280, a spec that is 5 years old.</span><span>)</span></a><a name='anchor4'></a> 
instead of the currently used Subject Alternative Names (subjectAltName) 
extension.  Furthermore, it is permissible for a certificate to contain 
multiple identifiers for the Subject via the subjectAltName extension.  As 
such, this document specifies appropriate matching rules to encompass 
various Subject identity representation options.  And finally, this 
document also provides guidelines to service providers for assigning 
certificates to SIP servers.
</p>
<p>The rest of this document is organized as follows: the next section
provides an overview of the most primitive case of a client using DNS
to access a SIP server and the resulting authentication steps.  
<a class='info' href='#problem-mutual'>Section&nbsp;5<span> (</span><span class='info'>The need for mutual interdomain authentication</span><span>)</span></a> looks at the reason why mutual inter-domain 
authentication is desired in SIP, and the lack of normative text and 
behavior in RFC3261 for doing so. <a class='info' href='#SIP-considerations'>Section&nbsp;7<span> (</span><span class='info'>Behavior of SIP entities</span><span>)</span></a> provides
normative behavior on the SIP entities (user agent clients, user agent
servers, registrars, redirect servers, and proxies) that need perform
authentication based on X.509 certificates.   
<a class='info' href='#sec-cons'>Section&nbsp;8<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> includes the security considerations.
</p>
<a name="problem-drilldown"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
SIP domain to host resolution</h3>

<p>Routing in SIP is performed by having the client execute 
<a class='info' href='#RFC3263'>RFC 3263<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Location SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a> [5] procedures on a URI, called the 
"Application Unique String (AUS) (c.f. Section 8 of <a class='info' href='#RFC3263'>RFC 
3263<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Location SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a> [5]).  These procedures take as input a SIP AUS (the SIP domain) and 
return an ordered set containing one or more IP addresses, and a port number 
and transport corresponding to each IP address in the set (the "Expected 
Output") by querying an Domain Name Service (DNS).  If the transport 
indicates the use of TLS, then a TLS connection is opened to the server on a 
specific IP address and port.  The server presents an X.509 certificate 
to the client for verification as part of the initial TLS handshake.
</p>
<p>The client should extract identifiers from the Subject and subjectAltName
extension in the certificate (see <a class='info' href='#cert-subject'>Section&nbsp;7.1<span> (</span><span class='info'>Finding SIP Identities in a Certificate</span><span>)</span></a>) and compare 
these values to the AUS.  If any identifier match is found, the server is 
considered to be authenticated and subsequent signaling can now proceed 
over the TLS connection.  Matching rules for X.509 certificates and the 
normative behavior for clients is specified in <a class='info' href='#uac'>Section&nbsp;7.3<span> (</span><span class='info'>Client behavior</span><span>)</span></a>.
</p>
<p>As an example: a request is to be routed to the SIP address
"sips:alice@example.com".  This address requires a secure connection to the
SIP domain "example.com", so that is the SIP AUS value.  Through a series
of untrusted DNS manipulations, that AUS is mapped to a set of host
addresses and transports, from which an address appropriate for use with
TLS is selected.  A connection is established to that server, which
presents a certificate asserting an identity of "sip:example.com".  Since the
host portion of the SIP AUS matches the subject of the certificate, the 
server is authenticated.
</p>
<p></p>
<blockquote class="text">
<p>SIPS borrows this behavior from HTTPS.  However, to be pedantic,
 <a class='info' href='#RFC2818'>RFC 2818<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> [6] prefers that the identity 
 be conveyed as a subjectAltName extension of type dNSName instead 
 of the commonly used practice of conveying the identity in the CN 
 field of the Subject field.  Similarly, this document RECOMMENDS
 that the SIP identity be conveyed as a subjectAltName extension of
 type uniformResourceIdentifier (c.f. <a class='info' href='#sp'>Section&nbsp;6<span> (</span><span class='info'>Guidelines for a service provider</span><span>)</span></a>, <a class='info' href='#cert-subject'>Section&nbsp;7.1<span> (</span><span class='info'>Finding SIP Identities in a Certificate</span><span>)</span></a>).
</p>
<p>A domain name in an X.509 certificates is properly interpreted
 only as a sequence of octets to be compared to the URI used to reach the
 host.  No inference should be made based on the DNS name hierarchy.
</p>
</blockquote>

<a name="problem-mutual"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
The need for mutual interdomain authentication</h3>

<p>Consider the SIP trapezoid shown in <a class='info' href='#sip-trapezoid'>Figure&nbsp;1<span> (</span><span class='info'>SIP Trapezoid</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="sip-trapezoid"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   proxyA.example.com ------------ proxyB.example.net
          |                           |
          |                           |
          |                           |
          |                         +---+
        0---0                       |   |
         /-\                        |___|
        +---+                      /    /
                                  +----+
   alice@example.com          bob@example.net

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: SIP Trapezoid&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Assume that alice@example.com creates an INVITE for bob@example.net; her 
user agent routes the request to some proxy in her domain, example.com.
Suppose also that example.com is a large organization that 
maintains several SIP proxies, and normal resolution rules cause her 
INVITE to be sent to an outbound proxy proxyA.example.com, which then 
uses <a class='info' href='#RFC3263'>RFC 3263<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Location SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a> [5] resolution and finds that 
proxyB.example.net is a valid proxy for example.net that uses TLS.  
proxyA.example.com requests a TLS connection to proxyB.example.net, and 
each presents a certificate to authenticate that connection.

 </p>
<blockquote class="text">
<p><a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [2] section 26.3.2.2 
  &quot;Interdomain Requests&quot; states that when a TLS connection is 
  created between two proxies, each should authenticate the other by 
  validating the certificates exchanged during the TLS handshake and by 
  comparing the subject of those certificates to the expected domain name.
  However, RFC3261 does not make any reference to using an identifier 
  extracted specifically from the Subject field as opposed to the 
  subjectAltName when comparing against the domain name.
</p>
</blockquote><p>

</p>
<p>The authentication problem for proxyA is straightforward - if
we assume secure DNS, then proxyA already knows that proxyB is a valid
proxy for the SIP domain example.net, so it only needs a valid certificate
from proxyB that contains the fully qualified host name proxyB.example.net,
or a SIP URI that asserts proxy B's authority over example.net domain, i.e.,
a certificate that asserts the identity "sip:example.net".
<a class='info' href='#comment.Comment.2'>[Comment.2]<span> (</span><span class='info'>(authors) and Stephen Kent: Actually, even if DNSSEC provides a trusted host name, it is sufficient for proxyB to have presented a certificate that contains a SIP identity for example.net, so authentication of just the proxyB hostname has little value since it would not be sufficient without DNSSEC.</span><span>)</span></a><a name='anchor5'></a>  Normative behavior 
for proxyA is outlined in <a class='info' href='#uac'>Section&nbsp;7.3<span> (</span><span class='info'>Client behavior</span><span>)</span></a>.
</p>
<p>The problem for proxyB is slightly more complex since it accepted the
TLS request passively.  Thus, it does not possess an equivalent AUS
that proxyA did; instead, it uses local policies to consider the client
authenticated.  The normative behavior for servers is provided in
<a class='info' href='#uas'>Section&nbsp;7.4<span> (</span><span class='info'>Server behavior</span><span>)</span></a>.
</p>
<a name="sp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Guidelines for a service provider</h3>

<p>When assigning certificates to proxy servers, registrars, and
redirect servers, a service provider MUST ensure that the SIP AUS
used to address the server is present as an identity in the
subjectAltName field of the certificate.
</p>
<p>Service providers MAY continue the practice of using existing
certificates for SIP usage with the identity conveyed in the Subject 
field; however, such usage is NOT RECOMMENDED for new certificates, 
which MUST contain the identity in the subjectAltName extension.
</p>
<a name="SIP-considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Behavior of SIP entities</h3>

<p>This section normatively specifies the behavior of SIP entities
when using X.509 certificates to determine an authenticated SIP domain
identity.
</p>
<a name="cert-subject"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Finding SIP Identities in a Certificate</h3>

<p>Procedures for constructing a certificate path and checking revocation
status to determine the validity of a certificate are described in 
<a class='info' href='#RFC3280'>RFC 3280<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and   Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> [4]; implementations must follow checks 
as prescribed therein.  This document adds additional rules for interpreting 
an X.509 certificate for use in SIP.
</p>
<p><a class='info' href='#I-D.sip-eku'>I-D.sip-eku<span> (</span><span class='info'>Lawrence, S. and V. Gurbani, &ldquo;Using Extended Key Usage (EKU) for Session Initiation Protocol (SIP)     X.509 Certificates,&rdquo; 2007.</span><span>)</span></a> [9] describes the method 
to validate any Extended Key Usage values found in the certificate for a 
SIP domain.  Implementations MUST perform the checks prescribed by 
that specification.
</p>
<p>Given an X.509 certificate that the above checks have found to be
acceptable, the following describes how to determine what SIP identity or
identities it contains.  Note that a single certificate MAY serve more than
one purpose - that is, it MAY contain identities not valid for use in SIP,
and/or MAY contain one or more identities that are valid for use in SIP.

</p>
<ol class="text">
<li>Examine the values in the subjectAltName field.  The contents of
subjectAltName field and the constraints that may be imposed on them 
are defined in Section 4.2.1.7 of <a class='info' href='#RFC3280'>RFC 3280<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and   Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> [4].  
The subjectAltName field may not be present or it may contain one or
more identities.  Each value in the subjectAltName has a type; the only types
acceptable for encoding a SIP domain identity are:


<blockquote class="text"><dl>
<dt>URI</dt>
<dd>If the scheme of the URI value is 'sip' (URI scheme 
  tokens are always case insensitive), and there is no userinfo component 
  in the URI (there is no '@'), then the hostpart is a SIP domain identity.  
  A URI value that does contain a userpart MUST NOT be used as a domain 
  identity (such a certificate identifies an individual user, not a server 
  for the domain).
</dd>
<dt>DNS</dt>
<dd>A domain name system identifier MAY be accepted as a SIP
  domain identity.  An implementation MAY choose to accept a DNS name as a
  domain identity, but only when no identity is found using the URI 
  type above.
</dd>
</dl></blockquote>

</li>
<li>If and only if the subjectAltName does not appear in the certificate, the
client MAY examine the Subject Common Name (CN) field of the certificate.
If a valid DNS name is found there, the implementation MAY use this value
as a SIP domain identity.  The use of the CN value is allowed for backward
compatibility, but is NOT RECOMMENDED.
</li>
</ol><p>

</p>
<p>The above procedure yields a set containing zero or more 
identities from the certificate.  A client uses these identities
to authenticate a server (see <a class='info' href='#uac'>Section&nbsp;7.3<span> (</span><span class='info'>Client behavior</span><span>)</span></a>) and a server uses 
them to authenticate a client (see <a class='info' href='#uas'>Section&nbsp;7.4<span> (</span><span class='info'>Server behavior</span><span>)</span></a>). 
</p>
<a name="id-compare"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Comparing SIP Identities</h3>

<p>When comparing two values as SIP identities:

</p>
<blockquote class="text">
<p>Implementations MUST compare only that part of each identifier (from the
procedure defined in <a class='info' href='#cert-subject'>Section&nbsp;7.1<span> (</span><span class='info'>Finding SIP Identities in a Certificate</span><span>)</span></a> that is a DNS name.  Any
scheme or parameters extracted from an identifier MUST NOT be used in the
comparison procedure described below.
</p>
<p>The values MUST be compared as DNS names, which means that the
comparison is case insensitive.
</p>
<p>The match MUST be exact:
</p>
<blockquote class="text">
<p>A suffix match MUST NOT be considered a match.  For example,
"foo.example.com" does not match "example.com".
</p>
<p>Any form of wildcard, such as a leading "." or "*.", MUST NOT be considered
a match.  For example, "foo.example.com" does not match 
".example.com" or "*.example.com".

<a class='info' href='#comment.Comment.3'>[Comment.3]<span> (</span><span class='info'>(authors): RFC 2818 (HTTP over TLS) allows the dNSName component to contain a  wildcard; e.g., &quot;DNS:*.example.com&quot;.  RFC 3280, while not disallowing this  explicitly, leaves the interpretation of wildcards to the individual  specification.  RFC 3261 does not provide any guidelines on the presence  of wildcards in certificates.  The consensus from the working group  discussion leans in the favor of not using them in SIP.</span><span>)</span></a><a name='anchor6'></a>


</p>
</blockquote>


</blockquote><p>

</p>
<a name="uac"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Client behavior</h3>

<p>A client uses the SIP AUS (the SIP domain name) to query a (possibly
untrusted) DNS to obtain a result set, which is a one or more SRV and A records
identifying the server for the domain (see <a class='info' href='#problem-drilldown'>Section&nbsp;4<span> (</span><span class='info'>SIP domain to host resolution</span><span>)</span></a> for an overview.)
</p>
<p>The SIP server, when establishing a TLS connection, presents its
certificate to the client for authentication.  The client MUST determine
the SIP identities in the server certificate using the procedure in
<a class='info' href='#cert-subject'>Section&nbsp;7.1<span> (</span><span class='info'>Finding SIP Identities in a Certificate</span><span>)</span></a>.  Then, the client MUST compare the original
SIP domain name (the AUS) used as input to the server location procedures
<a class='info' href='#RFC3263'>[5]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Location SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a> to the SIP domain identities obtained from the
certificate.

</p>
<ul class="text">
<li>If there were no identities found in the server certificate, the server
is not authenticated.
</li>
<li>If the AUS matches any SIP domain identity obtained from the certificate
when compared as described in section <a class='info' href='#id-compare'>Section&nbsp;7.2<span> (</span><span class='info'>Comparing SIP Identities</span><span>)</span></a>, the
server is authenticated for the domain.
</li>
</ul><p>

</p>
<p>If the server is not authenticated, the client MUST close the connection
immediately.
</p>
<a name="uas"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Server behavior</h3>

<p>When a server accepts a TLS connection, it presents its own X.509
certificate to the client.  To authenticate the client, the server asks the
client for a certificate.  If the client possesses a certificate, it is
presented to the server.  If the client does not present a certificate, it
MUST NOT be considered authenticated.

</p>
<blockquote class="text">
<p>Whether or not to close a connection if the client cannot present a
  certificate is a matter of local policy, and depends on the authentication
  needs of the server for the connection.  Some currently deployed servers
  use Digest authentication to authenticate individual requests on the
  connection, and choose to treat the connection as authenticated by those
  requests for some purposes (but see <a class='info' href='#digest-connection'>Section&nbsp;8.1<span> (</span><span class='info'>Connection authentication using Digest</span><span>)</span></a>).
</p>
<p>If the server requires client authentication for some local purpose,
  then it MAY implement a policy of allowing the connection only if the
  client is authenticated.  For example, if the server is an inbound proxy
  that has peering relationships with the outbound proxies of other specific
  domains, it might only allow connections authenticated as coming from
  those domains.
</p>
</blockquote><p>

</p>
<p>The server MUST obtain the set of SIP domain identities from the client
certificate as described in <a class='info' href='#cert-subject'>Section&nbsp;7.1<span> (</span><span class='info'>Finding SIP Identities in a Certificate</span><span>)</span></a>.
Because the server accepted the TLS connection passively, unlike a
client, it does not possess an AUS for comparison.  Nonetheless, server
policies can use the authenticated SIP domain identity to make
authorization decisions.
</p>
<p>For example, a very open policy could be to accept any X.509
certificates and validate them using the procedures in RFC 3280; if they
validate, the identity is accepted and logged.  Alternatively, the server
could have a list of all SIP domain names is allowed to accept connections
from; when a client presents its certificate, for each identity in the
client certificate, the server searches for it in the list of acceptable
domains to decide whether or not to accept the connection.  Other policies
that make finer distinctions are possible.
</p>
<p>Note that the decision of whether or not the authenticated connection to
the client is appropriate for use to route new requests to the client
domain is independent of whether or not the connection is authenticated;
the <a class='info' href='#I-D.connect-reuse'>connect-reuse<span> (</span><span class='info'>Mahy, R., Gurbani, V., and B. Tate, &ldquo;Connection Reuse in the Session Initiation Protocol,&rdquo; October&nbsp;2007.</span><span>)</span></a> [10] draft discusses
this aspect in more detail.
</p>
<a name="proxy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Proxy behavior</h3>

<p>A proxy MUST use the procedures defined for a User Agent Server (UAS) in <a class='info' href='#uas'>Section&nbsp;7.4<span> (</span><span class='info'>Server behavior</span><span>)</span></a> when authenticating a connection from a client.
</p>
<p>A proxy MUST use the procedures defined for a User Agent Client (UAC) in <a class='info' href='#uac'>Section&nbsp;7.3<span> (</span><span class='info'>Client behavior</span><span>)</span></a> when requesting an authenticated connection to a UAS.
</p>
<p>If a proxy adds a Record-Route when forwarding a request with the
expectation that the route is to use secure connections, it MUST insert
into the Record-Route header a URI that corresponds to an identity for
which it has a certificate; if it does not, then it will not be possible
to create a secure connection using the value from the Record-Route as the
AUS.
</p>
<a name="registrar"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Registrar behavior</h3>

<p>A SIP registrar, acting as a server, follows the normative behavior
of <a class='info' href='#uas'>Section&nbsp;7.4<span> (</span><span class='info'>Server behavior</span><span>)</span></a>.  When it accepts a TLS connection from the client,
it present its certificate.  Depending on the registrar policies, it may
challenge the client with HTTP Digest.
</p>
<a name="redirect"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Redirect server behavior</h3>

<p>A SIP redirect server follows the normative behavior of
<a class='info' href='#uas'>Section&nbsp;7.4<span> (</span><span class='info'>Server behavior</span><span>)</span></a>.  It may accept a TLS connection from the client,
present its certificate, and then challenge the client with HTTP Digest.
</p>
<a name="virtual-servers"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.8"></a><h3>7.8.&nbsp;
Virtual SIP Servers and Certificate Content</h3>

<p>The closest guidance in SIP today regarding certificates and
virtual SIP servers occurs in SIP Identity (<a class='info' href='#RFC4474'>[8]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session          Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>,
Section 13.4).  The quoted section states that, "...  certificates have 
varying ways of describing their subjects, and may indeed have multiple 
subjects, especially in the 'virtual hosting' cases where multiple domains 
are managed by a single application." 
</p>
<p>The above quote is incorrect, in that it implies that one certificate
can have multiple subjectAltName (or Subject) fields, each corresponding to a
discrete virtual server that represents a single domain; actually, a
PKIX-compliant certificate has exactly one Subject field and at most one
subjectAltName (the subjectAltName MAY contain multiple identifiers for
the Subject).
</p>
<p>Since only one certificate is needed for multiple domains,
the keying material management is straightforward, but such a certificate
MUST be revoked if ANY identifier in the certificate is no longer
associated with the holder of the private key for the certificate.
</p>
<p>The TLS extended client hello <a class='info' href='#RFC4366'>[7]<span> (</span><span class='info'>Blake-Wilson, S., Nystrom, M., Hopwood, D., Mikkelsen, J., and T. Wright, &ldquo;Transport Layer Security (TLS) Extensions,&rdquo; April&nbsp;2006.</span><span>)</span></a> allows a TLS 
client to provide to the TLS server the name of the server to which a 
connection is desired.  Thus, the server can present the correct certificate 
to establish the TLS connection.
</p>
<a name="sec-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>The goals of TLS (when used with X.509 certificates) include the 
following security guarantees at the transport layer:

</p>
<blockquote class="text"><dl>
<dt>Confidentiality:</dt>
<dd>packets tunneled through TLS can be read only
  by the sender and receiver.
</dd>
<dt>Integrity:</dt>
<dd>packets tunneled through TLS cannot be undetectably 
  modified on the connection between the sender and receiver.
</dd>
<dt>Authentication:</dt>
<dd>each principal is authenticated to the other as
  possessing a private key for which a certificate has been issued.
  Moreover, this certificate has not been revoked, and is verifiable by a
  certificate chain leading to a (locally configured) trust anchor.
</dd>
</dl></blockquote>

<p>We expect appropriate processing of domain
certificates to provide the following security guarantees at the
application level:

</p>
<blockquote class="text"><dl>
<dt>Confidentiality:</dt>
<dd>SIPS messages from alice@example.com to 
  bob@example.edu can be read only by alice@example.com, bob@example.edu, and 
  SIP proxies issued with domain certificates for example.com or 
  example.edu.
</dd>
<dt>Integrity:</dt>
<dd>SIPS messages from alice@example.com to 
  bob@example.edu cannot be undetectably modified on the links between 
  alice@example.com, bob@example.edu, and SIP proxies issued with domain 
  certificates for example.com or example.edu.
</dd>
<dt>Authentication:</dt>
<dd>alice@example.com and proxy.example.com 
  are mutually authenticated; moreover proxy.example.com is authenticated to
  alice@example.com as an authoritative proxy for domain example.com.
  Similar mutual authentication guarantees are given between
  proxy.example.com and proxy.example.edu and between proxy.example.edu
  and bob@example.edu.  As a result, alice@example.com is transitively
  mutually authenticated to bob@example.edu (assuming trust in the
  authoritative proxies for example.com and example.edu).
</dd>
</dl></blockquote>

<a name="digest-connection"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Connection authentication using Digest</h3>

<p>Digest authentication in SIP provides for authentication of the
  message sender to the challenging UAS.  As commonly deployed, it provides
  only very limited integrity protection of the authenticated message.
  Many existing deployments have chosen to use the Digest authentication of
  one or more messages on a particular connection as a way to authenticate
  the connection itself - and by implication, authenticating other
  (unchallenged) messages on that connection.  Some even choose to
  similarly authenticate a UDP source address and port based on the Digest
  authentication of a message received from that address and port.  This
  use of Digest goes beyond the assurances it was designed to provide, and
  is NOT RECOMMENDED.  Authentication of the domain at the other end of a
  connection SHOULD be accomplished using TLS and the certificate
  validation rules described by this specification instead.
</p>
<a name="iana-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This memo does not contain any considerations for IANA.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgments</h3>

<p>The following IETF contributors provided substantive input to this
document: Jeroen van Bemmel, Michael Hammer, Cullen Jennings, Paul Kyzivat,
Derek MacDonald, Dave Oran, Jon Peterson, Eric Rescorla, Jonathan
Rosenberg, Russ Housley.  Special acknowledgement goes to Stephen Kent 
for extensively reviewing draft versions and suggesting invaluable 
feedback, edits, and comments.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[1]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.ietf.org/rfc/rfc2119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[2]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.ietf.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2246">[3]</a></td>
<td class="author-text">Dierks, T. and C. Allen, &ldquo;<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>,&rdquo; RFC&nbsp;2246, January&nbsp;1999 (<a href="http://www.ietf.org/rfc/rfc2246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[4]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and
  Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="http://www.ietf.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3263">[5]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3263">Session Initiation Protocol (SIP): Location SIP Servers</a>,&rdquo; RFC&nbsp;3263, June&nbsp;2002 (<a href="http://www.ietf.org/rfc/rfc3263.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[6]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.ietf.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4366">[7]</a></td>
<td class="author-text">Blake-Wilson, S., Nystrom, M., Hopwood, D., Mikkelsen, J., and T. Wright, &ldquo;<a href="http://tools.ietf.org/html/rfc4366">Transport Layer Security (TLS) Extensions</a>,&rdquo; RFC&nbsp;4366, April&nbsp;2006 (<a href="http://www.ietf.org/rfc/rfc4366.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[8]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session
         Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.ietf.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.sip-eku">[9]</a></td>
<td class="author-text">Lawrence, S. and V. Gurbani, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-eku-00.txt.txt">Using Extended Key Usage (EKU) for Session Initiation Protocol (SIP)
    X.509 Certificates</a>,&rdquo; draft-ietf-sip-eku-00.txt (work in progress), 2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-eku-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.connect-reuse">[10]</a></td>
<td class="author-text">Mahy, R., Gurbani, V., and B. Tate, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-connect-reuse-08.txt.txt">Connection Reuse in the Session Initiation Protocol</a>,&rdquo; draft-ietf-sip-connect-reuse-08.txt (work in progress), October&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-connect-reuse-08.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.comments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Editorial Comments</h3>
<table border="0">
<tr><td class="author-text" valign="top">
<a class="info" href="#anchor4">
Comment.1</a><a name="comment.Comment.1"></a>:
</td><td class="author-text">
Stephen Kent: PKIX standards made an exception for RFC 822 names in legacy certificates, but not for DNS names or URIs!  There is a private extension, developed by Netscape for representing a DNS name in a certificate prior to the advent of SAN.  I think it's rather late to be accomodating certificates that are not compliant with RFC 3280, a spec that is 5 years old.</td></tr>
<tr><td class="author-text" valign="top">
<a class="info" href="#anchor5">
Comment.2</a><a name="comment.Comment.2"></a>:
</td><td class="author-text">
(authors) and Stephen Kent: Actually, even if DNSSEC provides a trusted host name, it is sufficient for proxyB to have presented a certificate that contains a SIP identity for example.net, so authentication of just the proxyB hostname has little value since it would not be sufficient without DNSSEC.</td></tr>
<tr><td class="author-text" valign="top">
<a class="info" href="#anchor6">
Comment.3</a><a name="comment.Comment.3"></a>:
</td><td class="author-text">
(authors): RFC 2818 (HTTP over TLS) allows the dNSName component to contain a  wildcard; e.g., "DNS:*.example.com".  RFC 3280, while not disallowing this  explicitly, leaves the interpretation of wildcards to the individual  specification.  RFC 3261 does not provide any guidelines on the presence  of wildcards in certificates.  The consensus from the working group  discussion leans in the favor of not using them in SIP.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vijay K. Gurbani</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bell Laboratories, Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2701 Lucent Lane</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Room 9F-546</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lisle, IL  60532</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 630 224-0216</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vkg@alcatel-lucent.com">vkg@alcatel-lucent.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Scott Lawrence</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bluesocket Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 North Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Burlington, MA  01803</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 781 229 0533</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:slawrence@bluesocket.com">slawrence@bluesocket.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alan S.A. Jeffrey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bell Laboratories, Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2701 Lucent Lane</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Room 9F-534</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lisle, IL  60532</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ajeffrey@alcatel-lucent.com">ajeffrey@alcatel-lucent.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
