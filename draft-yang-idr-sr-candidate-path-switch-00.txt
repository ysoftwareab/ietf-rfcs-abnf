
Inter-Domain Routing Working Group                            L. Yang
Internet-Draft                                                  H. Li
Intended status: Standards Track                              Y. Wang
Expires: August 2, 2021                                        Y. Qiu
                                                              M. Chen
                                                     H3C Technologies
                                                     February 2, 2021

        Segment Routing Candidate Path Hot-standby switch in BGP
              draft-yang-idr-sr-candidate-path-switch-00

Abstract

   Segment Routing is a source routing paradigm that explicitly 
   indicates the forwarding path for packets at the ingress node.  An SR 
   policy is a set of candidate SR paths consisting of one or more 
   segment lists with necessary path attributes. If an SR policy has 
   multiple valid candidate paths, the device chooses the candidate path
   with the greatest preference value. If the chosen path fails, the SR 
   policy must select another candidate path. During path reselection, 
   packet loss might occur and thus affect service continuity. Therefore 
   the candidate path hot-standby function occurs, the headend can 
   compute two candidate paths, one is master and the other is backup, 
   set them to the forwarding plane, and in this way, the switchover
   time is reduced.
   
   This document defines extensions to BGP to distribute hot-standby 
   switch within SR policies.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the 
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF).  Note that other groups may also distribute 
   working documents as Internet-Drafts.  The list of current 
   Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six 
   months and may be updated, replaced, or obsoleted by other documents
   at any time. It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on June 1, 2021.

   
Yang, et al.              Expires August 2, 2021                [Page 1]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021

   
Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the 
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal 
   Provisions Relating to IETF Documents 
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents 
   carefully, as they describe your rights and restrictions with 
   respect to this document.  Code Components extracted from this 
   document must include Simplified BSD License text as described in 
   Section 4.e of the Trust Legal Provisions and are provided without 
   warranty as described in the Simplified BSD License.


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
   3.  SR Policy for Hot-standby  . . . . . . . . . .. . . . . . . .   3
     3.1.  Path Hot-standby Sub-TLV  . . . . . . . . . . . . . . . . . 4
   4.  Operations  . . . . . . . . . . . . . . . . . . . . . . . . .   5
   5.  Implementation Status . . . . . . . . . . . . . . . . . . . .   6
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   7
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .   7
   8.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . .    7
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   7
      9.1.  Normative References . . . . . . . . . . . . . . . . . .   7
      9.2.  Informative References . . . . . . . . . . . . . . . . .   8
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   8

1. Introduction

   Segment routing (SR) [RFC8402] is a source routing paradigm that 
   explicitly indicates the forwarding path for packets at the ingress
   node.  The ingress node steers packets into a specific path 
   according to the Segment Routing Policy (SR Policy) as defined in
   [I-D.ietf-spring-segment-routing-policy].  In order to distribute SR
   policies to the headend, [I-D.ietf-idr-segment-routing-te-policy] 
   specifies a mechanism by using BGP.
 
 
Yang, et al.              Expires August 2, 2021                [Page 2]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021


   An SR Policy includes multiple candidate paths, of which at any time
   there is only one active candidate path that is provisioned in the 
   forwarding plane and used for traffic steering. However, when the 
   hot-standby is enabled on the policy, another candidate path (with 
   the secondary greatest preference value) MAY be designated as the 
   backup for the active candidate path. The active candidate path can
   be called the primary candidate path. When the forwarding paths 
   corresponding to all SID lists of the primary path fails, the backup
   path immediately takes over to minimize service interruption.

   This document defines one extension to Border Gateway Protocol (BGP)
   to distribute SR policies carrying hot-standby switch.

2.  Terminology

2.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in 
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all 
   capitals, as shown here.

3.  SR Policy for hot-standby

   As defined in [I-D.ietf-idr-segment-routing-te-policy], the SR 
   policy encoding structure is as follows:

   SR Policy SAFI NLRI: <Distinguisher, Policy-Color, Endpoint>
   Attributes:
      Tunnel Encaps Attribute (23)
         Tunnel Type: SR Policy
             Binding SID
             SRv6 Binding SID
             Preference
             Priority
             Policy Name
             Policy Candidate Path Name
             Explicit NULL Label Policy (ENLP)
             Segment List
                 Weight
                 Segment
                 Segment
                 ...
             ...

Yang, et al.              Expires August 2, 2021                [Page 3]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021

   As introduced in Section 1, SR policy with hot-standby is expressed 
   as below:
   
   SR Policy SAFI NLRI: <Distinguisher, Policy-Color, Endpoint>
   Attributes:
      Tunnel Encaps Attribute (23)
         Tunnel Type: SR Policy
             Binding SID
             SRv6 Binding SID
             Preference
             Priority
             Policy Name
             Path Hot-standby 
             Policy Candidate Path Name
             Explicit NULL Label Policy (ENLP)
             Segment List
                 Weight
                 Segment
                 Segment
                 ...
             ...

3.1 Path Hot-standby Sub-TLV

   A Hot-standby sub-TLV is an Optional sub-TLV.  When it appears, it 
   MUST appear only once at most within a SR Policy SAFI NLRI.  If 
   multiple Hot-standby sub-TLVs appear within a SR Policy SAFI NLRI, 
   the NLRI MUST be treated as a malformed NLRI.
   
   As per [I-D.ietf-idr-segment-routing-te-policy], when the error 
   determined allows for the router to skip the malformed NLRI(s) and 
   continue processing of the rest of the update message, then it MUST 
   handle such malformed NLRIs as 'Treat-as-withdraw'.  This document 
   does not define new error handling rules for Hot-standby sub-TLV, 
   and the error handling rules defined in 
   [I-D.ietf-idr-segment-routing-te-policy] apply to this document.

   A Hot-standby sub-TLV associated with a SR policy, The Hot-standby 
   sub-TLV has the following format:

Yang, et al.              Expires August 2, 2021                [Page 4]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021
   
   
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |      Type     |    Length     |  Hot-standby  |    RESERVED   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                         Figure 1. Hot-standby sub-TLV
Where:

   Type: to be assigned by IANA.

   Length: the total length of the value field not including Type and 
   Length fields.

   Hot-standby: 1 octet of flags. Following flags are defined. Unused
   bits in the Flag octet SHOULD be set to zero upon transmission and
   MUST be ignored upon receipt.

    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |E|             |
   +-+-+-+-+-+-+-+-+

Where:

      E-Flag: 1 bit. Indicates the Policy Candidate Path hot-standby 
   switch flag. 
      When E-Flag is set, it represents the switch has been enabled.

   Reserved: 8 bits reserved and MUST be set to 0 on transmission and
   MUST be ignored on receipt.

   When the E-Flag of hot-standby changes, the selection process will 
   be re-executed, if E-Flag is present, the master and backup 
   candidate path selected set to data-plane. If E-Flag is absent, only
   the master's candidate path will be set to data-plane.

4. Operations

   The document does not bring new operation beyond the description of
   operations defined in [I-D.ietf-idr-segment-routing-te-policy]. The 
   existing operations defined in 
   [I-D.ietf-idr-segment-routing-te-policy] can apply to this document 
   directly.

Yang, et al.              Expires August 2, 2021                [Page 5]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021
   
   Typically but not limit to, the SR policies carrying Hot-standby are
   configured by a controller.

   After configuration, the SR policies carrying Hot-standby will be 
   advertised by BGP update messages.  The operation of advertisement 
   is the same as defined in [I-D.ietf-idr-segment-routing-te-policy], 
   as well as the reception.

   The consumer of the SR policies is not the BGP process.  The 
   operation of sending information to consumers is out of scope of 
   this document.

5. Implementation Status

   This section records the status of known implementations of the 
   protocol defined by this specification at the time of posting of 
   this Internet-Draft, and is based on a proposal described in 
   [RFC7942].

   The description of implementations in this section is intended to 
   assist the IETF in its decision processes in progressing drafts to 
   RFCs.  Please note that the listing of any individual implementation
   here does not imply endorsement by the IETF.  Furthermore, no effort
   has been spent to verify the information presented here that was 
   supplied by IETF contributors.  This is not intended as, and must 
   not be construed to be, a catalog of available implementations or 
   their features.  Readers are advised to note that other 
   implementations may exist.

   According to [RFC7942], "this will allow reviewers and working 
   groups to assign due consideration to documents that have the 
   benefit of running code, which may serve as evidence of valuable 
   experimentation and feedback that have made the implemented 
   protocols more mature. It is up to the individual working groups 
   to use this information as they see fit".

Yang, et al.              Expires August 2, 2021                [Page 6]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021
   
   
6. IANA Considerations

   This document defines a new Sub-TLV in registries "SR Policy List
   Sub- TLVs" [I-D.ietf-idr-segment-routing-te-policy]:

   Value    Description                                  Reference
   ---------------------------------------------------------------------
    TBA     Hot-standby sub-TLV                        This document

7.  Security Considerations

   TBA  
   
8.  Acknowledgments

   Authors would like to thank Changwang Lin for their paraprofessional
   comments and help.

9.  References

9.1.  Normative References

   [I-D.ietf-idr-segment-routing-te-policy]
              Previdi, S., Filsfils, C., Talaulikar, K., Mattes, P.,
              Rosen, E., Jain, D., and S. Lin, "Advertising Segment
              Routing Policies in BGP", draft-ietf-idr-segment-routing-
              te-policy-11 (work in progress), May 2020.

   [I-D.ietf-spring-segment-routing-policy]
              Filsfils, C., Talaulikar, K., Voyer, D., Bogdanov, A., and
              P. Mattes, "Segment Routing Policy Architecture", draft-
              ietf-spring-segment-routing-policy-09 (work in progress),
              July 2020.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8402]  Filsfils, C., Ed., Previdi, S., Ed., Ginsberg, L.,
              Decraene, B., Litkowski, S., and R. Shakir, "Segment
              Routing Architecture", RFC 8402, DOI 10.17487/RFC8402,
              July 2018, <https://www.rfc-editor.org/info/rfc8402>.

Yang, et al.              Expires August 2, 2021                [Page 7]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021

9.2.  Informative References

   [RFC7942]  Sheffer, Y. and A. Farrel, "Improving Awareness of Running
              Code: The Implementation Status Section", BCP 205,
              RFC 7942, DOI 10.17487/RFC7942, July 2016,
              <https://www.rfc-editor.org/info/rfc7942>.

Authors' Addresses

   Liping Yang
   H3C Technologies
   China

   Email: liping_yang@h3c.com

   
   Hao Li
   H3C Technologies
   China

   Email: lihao@h3c.com
   
   
   Yuanxiang Qiu
   H3C Technologies
   China
   
   Email: qiuyuanxiang@h3c.com

   
   Yang Wang
   H3C Technologies
   China

   Email: wang.a.yang@h3c.com
   
   
   Mengxiao Chen
   H3C Technologies
   China
   
   Email: chen.mengxiao@h3c.com  
  
Yang, et al.              Expires August 2, 2021                [Page 8]

Internet-Draft    SR Candidate Path Hot switch in BGP      February 2021