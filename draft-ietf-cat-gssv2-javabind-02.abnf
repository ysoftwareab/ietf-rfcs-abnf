inTok = readToken();
is = recvToken();

is = recvToken();

inTok = readToken();

clientCred = new GSSCredential(null /*default princ.*/,
                       GSSCredential.INDEFINITE /* max lifetime */,
                       mech /* mechanism  to use */,
                       GSSCredential.INITIATE_ONLY /* init context */,
                       null /* default provider */);

context = new GSSContext(peer, mech, gssCred,
                                GSSContext.INDEFINITE/*lifetime*/,
                                null);

outToken = context.initSecContext(inToken, 0,
                                                     inToken.length);

inToken = readGSSToken();
buffer = readFromFile();

outToken = context.wrap(buffer, 0, buffer.length,
                                           messgInfo);

inToken = readGSSToken();
buffer = context.unwrap(inToken, 0, inToken.length,
                                           messgInfo);
inToken = readGSSToken();


outToken = context.acceptSecContext(inToken, 0,
                                                   inToken.length);

inToken = readGSSToken();
inToken = readGSSToken();

buffer = context.unwrap(inToken, 0, inToken.length,
                                             supplInfo);
buffer = serverProcess(buffer);

outToken = context.wrap(buffer, 0, buffer.length,
                                              supplInfo);
factory = new com.xyz.GSSAPI.MyFactory();

clientCred = factory.createCredentials(
                      null /* default principal*/,
                      IGSSCredential.INDEFINITE /* max lifetime */,
                      mech /* mechanism  to use */,
                      IGSSCredential.INITIATE_ONLY /* init context */);

context = factory.createContext(peer, mech, gssCred,
                                IGSSContext.INDEFINITE/*lifetime*/);

outToken = context.initSecContext(inToken, 0,
                                                     inToken.length);

inToken = readGSSToken();
buffer = readFromFile();

outToken = context.wrap(buffer, 0, buffer.length,
                                           messgInfo);

inToken = readGSSToken();
buffer = context.unwrap(inToken, 0, inToken.length,
                                           messgInfo);
