


Individual submission                                       M. Kucherawy
Internet-Draft                                            Sendmail, Inc.
Intended status: Standards Track                            May 19, 2007
Expires: November 20, 2007


       Message Header for Indicating Sender Authentication Status
                 draft-kucherawy-sender-auth-header-05

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.
   This document may not be modified, and derivative works of it may not
   be created.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on November 20, 2007.

Copyright Notice

   Copyright (C) The IETF Trust (2007).












Kucherawy               Expires November 20, 2007               [Page 1]

Internet-Draft        Authentication-Results Header             May 2007


Abstract

   This memo defines a new message header for use with electronic mail
   messages to indicate the results of sender authentication efforts.
   Mail user agents (MUAs) may use this message header to relay that
   information in a convenient way to users or to make sorting and
   filtering decisions.












































Kucherawy               Expires November 20, 2007               [Page 2]

Internet-Draft        Authentication-Results Header             May 2007


1.  Introduction

   This memo defines a new message header for electronic mail messages
   which presents the results of a sender authentication effort in a
   machine-readable format.  The intent is to create a place to collect
   such data when sender authentication mechanisms are in use so that an
   MUA can provide a recommendation to the user as to the
   trustworthiness of the message's origin and content.

   This memo defines both the format of this new header, and discusses
   the implications of its presence or absence.

   [REMOVE OR REWORD PRIOR TO FINAL VERSION] At the time of publication
   of this draft, [AUTH], [SENDERID], [SPF] and [DKIM] are the published
   e-mail authentication methods in common use.  As various methods
   emerge, it is necessary to prepare for their appearance and encourage
   convergence in the area of interfacing these filters to MUAs.

1.1.  Purpose

   The header defined in this memo is expected to serve several
   purposes:

   1.  Convey to MUAs from filters and MTAs the results of various
       sender authentication checks being applied;

   2.  Provide a common location for the presentation of this data;

   3.  Create an extensible framework for specifying new authentication
       methods as such emerge;

   4.  Convey the results of sender authentication tests to later
       filtering agents within the same "trust domain", as such agents
       might apply more or less stringent checks based on sender
       authentication results.

1.2.  Requirements

   This memo establishes no new requirements on existing protocols or
   servers, as there is currently no standard place for the described
   data to be collected or presented.

1.3.  Definitions

   This document occasionally uses terms that appear in capital letters.
   When the terms "MUST", "SHOULD", "RECOMMENDED", "MUST NOT", "SHOULD
   NOT", and "MAY" appear capitalized, they are being used to indicate
   particular requirements of this specification.  A discussion of the



Kucherawy               Expires November 20, 2007               [Page 3]

Internet-Draft        Authentication-Results Header             May 2007


   meanings of these terms appears in RFC2119.

   Generally it is assumed that the work of applying sender
   authentication schemes takes place at a border MTA, that is, an MTA
   which acts as a gateway between the general Internet and the users
   within an organizational boundary.  This specification is written
   with that assumption in mind.  However, there are some sites at which
   the entire mail infrastructure consists of a single host.  In such
   cases, such terms as "border MTA" and "delivery MTA" may well apply
   to the same machine or even the very same agent.









































Kucherawy               Expires November 20, 2007               [Page 4]

Internet-Draft        Authentication-Results Header             May 2007


2.  Definition and Format of the Header

   The new header being defined here is called "Authentication-Results".
   It qualifies in [MAIL] [6] terms as a Structured Header Field, and
   thus all of the related definitions in that document apply.

   This new header SHOULD be added at the top of the message as it
   transits MTAs which do authentication checks so that some idea of how
   far away the checks were done can be inferred.  It therefore also
   qualifies in [MAIL] [6] terms as a Trace Header Field, and thus all
   of the related definitions in that document apply.

   The decommented value of the header consists of a hostname, some
   whitespace, a "property=value" statement indicating which property
   was selected to determine who sent the message and what value was
   extracted from that property, followed by zero or more authentication
   method names and a result associated with each, returned by the code
   that implements the method.

   As it is currently a matter of some debate, the header MAY appear
   more than once in a single message, or more than one result MAY be
   represented in a single header, or a combination of these MAY be
   applied.

   Formally, the header is specified as follows:

      header = "Authentication-Results:" hostname CFWS
                headerspec *(CFWS ";" CFWS method CFWS "=" CFWS result)
                CFWS


      hostname = domain
                 ; as defined in section 3.4.1 of [MAIL]


      method = token [ "-" version ]
               ; a method indicates which method's result is
               ; is represented by "value", and is one of the methods
               ; explicitly defined as valid in this document
               ; or is an extension method as defined below



      version = ( ALPHA / DIGIT ) 1*( "." ALPHA / DIGIT )
               ; indicates which version of the method was applied






Kucherawy               Expires November 20, 2007               [Page 5]

Internet-Draft        Authentication-Results Header             May 2007


      result = "pass" / "fail" / "softfail" / "neutral" /
                "temperror" / "permerror"
                ; an indication of the results of the attempt to
                ; authenticate the sender


      headerspec = ptype CWFS "." CWFS property CWFS "=" CFWS value
                   ; an indication of which property of the message
                   ; was evaluated by the authentication scheme being
                   ; applied to yield the reported result


      ptype = "smtp" / "header" / "body" / "policy"
              ; indicates whether the property being evaluated was
              ; a parameter to an [SMTP] command, or was a value taken
              ; from a message header, or was some property of the
              ; message body, or some other property evaluated by
              ; the receiving MTA


   property = token
              ; if "ptype" is "smtp", this indicates which [SMTP]
              ; command provided the value which was evaluated by the
              ; authentication scheme being applied; if "ptype" is
              ; "header", this indicates from which header the value
              ; being evaluated was extracted; if "ptype" is
              ; "body", this indicates the offset into the body at which
              ; content of interest was detected; if "ptype" is "policy"
              ; then this indicates the name of the policy which caused
              ; this header to be added (see below)


      value = token / mailbox
              ; the value extracted from the message property defined
              ; by the "ptype.property" construction; if the value is
              ; intended ; to identify a mailbox, then it is a "mailbox"
              ; as defined in section 3.4 of [MAIL]

   The "token" is as defined in Appendix A of [MIME] [7].

   The list of commands eligible for use with the "smtp" ptype can be
   found in [SMTP] [9] and subsequent amendments.

   "CFWS" is as defined in section 3.2.3 of [MAIL] [6].

   The "ptype" and "property" used by each authentication method should
   be defined in the specification for that method (or its amendments).




Kucherawy               Expires November 20, 2007               [Page 6]

Internet-Draft        Authentication-Results Header             May 2007


   The "ptype" and "property" are case-insensitive.

   A "ptype" of "policy" indicates a policy decision about the message
   not specific to a property of the message that could be extracted.
   For example, if a method would normally report a "ptype.property" of
   "header.From" and no From: header was present, the method can use
   "policy" to indicate that no conclusion about the authenticity of the
   message could be reached.

   If the parsed "ptype.property" construction clearly identifies a
   mailbox (in particular, smtp.mail, smtp.rcpt, header.from,
   header.sender), then the "value" MUST be a "mailbox".  Other
   properties (e.g. smtp.helo) may be evaluated, but the property MUST
   still be expressed as a "token" for simplified parsing.

   The six possible values of the "result" are:

   pass:  The message passed the authentication tests.  (This may
      require accessing an authentication policy of some kind published
      by the sending domain.)

   fail:  The message failed the authentication tests.  (This may
      require accessing an authentication policy of some kind published
      by the sending domain.)

   softfail:  The authentication method has either an explicit
      (published by the sending domain) or implicit policy, but the
      policy being used doesn't require successful authentication of all
      messages from that domain, and the message failed the
      authentication tests.

   neutral:  The authentication method completed without errors, but was
      unable to reach either a positive or negative result about the
      message.

   temperror:  A temporary (recoverable) error occurred attempting to
      authenticate the sender; either the process couldn't be completed
      locally, or (for methods requiring a policy to be accessed) there
      was a temporary failure retrieving the sending domain's policy.  A
      later retry may produce a more final result.

   permerror:  A permanent (unrecoverable) error occurred attempting to
      authenticate the sender; either the process couldn't be completed
      locally, or (for methods requiring a policy to be accessed) there
      was a permanent failure retrieving the sending domain's policy.

   New methods not specified in this document MUST indicate which of
   these should be returned when exceptions such as syntax errors are



Kucherawy               Expires November 20, 2007               [Page 7]

Internet-Draft        Authentication-Results Header             May 2007


   detected.


















































Kucherawy               Expires November 20, 2007               [Page 8]

Internet-Draft        Authentication-Results Header             May 2007


3.  Definition Of Initial Methods

   As they are currently existing specifications for sender
   authentication, it is appropriate to define an authentication method
   identifier for each of [AUTH] [1], [DKIM] [3], [SPF] [10] and
   [SENDERID] [8].  Therefore, the authentication method identifiers
   "auth", "dkim", "spf" and "senderid" are hereby defined for MTAs
   applying those specifications for e-mail sender authentication.











































Kucherawy               Expires November 20, 2007               [Page 9]

Internet-Draft        Authentication-Results Header             May 2007


4.  Adding The Header To A Message

   This specification makes no attempt to evaluate the relative
   strengths of various sender authentication methods that may become
   available.  As such, the order of the presented authentication
   methods and results are not relevant since ultimately the importance
   on any given method over another is the decision of the MUA that is
   interpreting the value of the header.

   The "method" MUST refer to an authentication method declared in this
   memo, or in a subsequent one, or to an authentication method name
   assigned by IANA.

   An MTA compliant with this specification MUST add this header (after
   performing one or more sender authentication tests) to indicate at
   which host the test was done, which test got applied and what the
   result was.  If an MTA applies more than one such test, it MUST
   either add this header once per test, or one header indicating all of
   the results.  An MTA MUST NOT add a result to an existing header.

   An MTA adding this header in either form MUST use its own hostname
   only.  It MUST be a fully-qualified domain name.

   For security reasons, an MTA conforming to this specification MUST
   remove any discovered instance of this header for which the
   "hostname" is its own, i.e. headers which claim to be from the MTA
   but were added before the mail arrived at the MTA for processing.  A
   border MTA SHOULD also delete any discovered instance of this header
   which claims to have been added within its trust boundary.  For
   example, a border MTA at mx.example.com MUST delete any instance of
   this header claiming to come from mx.example.com and SHOULD delete
   any instance of this header claiming to come from any host in
   example.com prior to adding its own headers.  This applies in both
   directions so that hosts outside the domain cannot claim results MUAs
   inside the domain might trust.  However, care must be taken not to
   remove headers added on messages which remain entirely within the
   originator's trust boundary (i.e. local-to-local mail).

   An MTA MAY add this header containing only the "hostname" portion to
   explicitly indicate that no sender authentication schemes were
   applied prior to delivery of this message.

4.1.  Header Position and Interpretation

   In order to ensure non-ambiguous results and avoid the impact of
   false headers, an MUA SHOULD NOT interpret this header unless
   specifically instructed to do so by the user.  That is, this should
   not be "on by default".  Naturally then, users would not activate



Kucherawy               Expires November 20, 2007              [Page 10]

Internet-Draft        Authentication-Results Header             May 2007


   such a feature unless they are certain the header will be added by
   the receiving MTA that accepts the mail which is ultimately read by
   the MUA, and instances of the header added by foreign MTAs will be
   removed before delivery.

   Furthermore, an MUA SHOULD NOT interpret this header unless the
   hostname it bears appears to be one within its own trust domain as
   configured by the user.

   This header field SHOULD be treated as though it were a trace header
   field as defined in section 3.6 of [MAIL] [6], and hence SHOULD not
   be reordered and SHOULD be prepended to the message, so that there is
   generally some indication upon delivery of where in the chain of
   handling MTAs the sender authentcation was done.

   Further discussion of this can be found in the Security
   Considerations section below.

4.2.  Extension Fields

   Additional authentication method identifiers may be defined in the
   future by later revisions or extensions to this specification.
   Extension identifiers beginning with "x-" will never be defined as
   standard fields; such names are reserved for experimental use.
   Method identifiers NOT beginning with "x-" MUST be registered with
   the Internet Assigned Numbers Authority (IANA) and published in an
   RFC.

   Extension identifiers may be defined for the following reasons:

   1.  To allow additional information from emergent authentication
       systems to be communicated to MUAs.  The names of such
       identifiers should reflect the name of the method being defined,
       but should not be needlessly long.

   2.  To allow the creation of "sub-identifiers" which indicate
       different levels of authentication and differentiate between
       their relative strengths, e.g. "auth1-weak" and "auth1-strong".

   Authentication method implementors are encouraged to provide adequate
   information, via [MAIL] comments if necessary, to allow an MUA
   developer to understand or relay ancilliary details of authentication
   results.  For example, if it might be of interest to relay what data
   was used to perform an evaluation, such information could be relayed
   as a comment in the header, such as:

      Authentication-Results: mx.example.com; foo=pass (2 of 3 tests OK)




Kucherawy               Expires November 20, 2007              [Page 11]

Internet-Draft        Authentication-Results Header             May 2007


5.  Discussion

   This section discusses various implementation issues not specifically
   related to security.  Security issues are discussed in a later
   section.

5.1.  Legacy MUAs

   Implementors of this proposal should be aware that many MUAs are
   unlikely to be retrofit to support the new header and its semantics.
   In the interests of convenience and quicker adaptation, a delivery
   MTA might want to consider adding things that are processed by
   existing MUAs as well as the header defined by this specification.
   One suggestion is to provide a Priority: header with a value that
   reflects the strength of the authentication that was accomplished,
   e.g. "low" for weak or no authentication, "normal" or "high" for good
   authentication.

   Certainly some modern MUAs can filter based on the content of this
   header, but as there is keen interest in having MUAs make some kind
   of graphical representation of this header's meaning, other interim
   means of doing so may be necessary while this proposal is adopted.





























Kucherawy               Expires November 20, 2007              [Page 12]

Internet-Draft        Authentication-Results Header             May 2007


6.  Conformance and Usage Requirements

   An MTA or gateway conforms to this specification if it applies one or
   more sender authentication mechanisms and inserts a header
   corresponding to this specification after doing so and prior to
   delivery.

   MTAs that are relaying mail rather than delivering it MAY perform
   sender authentication or even take actions based on the results
   found, but MUST NOT add a "Authentication-Results" header if relaying
   rather than rejecting or discarding at the gateway.  Conversely, an
   MTA doing local delivery MUST add this header prior to delivery the
   message in order to be compliant.

   A minimal implementation which does at least one sender
   authentication check will add the header defined by this memo prior
   to invoking local delivery procedures.

   This specification places no restrictions on the processing of the
   header's contents by user agents or distribution lists.  It is
   presented to those packages solely for their own information.






























Kucherawy               Expires November 20, 2007              [Page 13]

Internet-Draft        Authentication-Results Header             May 2007


7.  IANA Considerations

7.1.  The Authentication-Results: header

   Per [IANA-HEADERS] [5], the "Authentication-Results:" header field is
   added to the IANA Permanent Message Header Field Registry.  The
   following is the registration template:

     Header field name: Authentication-Results
     Applicable protocol: mail ([RFC2822])
     Status: Standard
     Author/Change controller: IETF
     Specification document(s): [TBD]
     Related information:
       Requesting review of any proposed changes and additions to
       this field is recommended.

7.2.  Method Registry

   Following the policies outlined in [IANA-CONSIDERATIONS] [4], names
   of sender authentication methods supported by this specification must
   be registered with IANA under the IETF Consensus method, with the
   exception of experimental names as described above.

   Each method must register a name, the RFC which defines it, which
   "ptype" is appropriate for use with that method, and which "property"
   should be reported by that method.

   The initial set of entries in this registry is as follows:

   +------------+------+--------+----------------------------+
   |   Method   | RFC  | ptype  | property                   |
   +------------+------+--------+----------------------------+
   |    auth    | 2554 | smtp   | auth                       |
   +------------+------+--------+----------------------------+
   | domainkeys | TBD  | header | From or Sender             |
   +------------+------+--------+----------------------------+
   |    dkim    | 4871 | header | i                          |
   +------------+------+--------+----------------------------+
   |  senderid  | 4406 | header | name of header used by PRA |
   +------------+------+--------+----------------------------+
   |     spf    | 4408 | smtp   | from                       |
   +------------+------+--------+----------------------------+








Kucherawy               Expires November 20, 2007              [Page 14]

Internet-Draft        Authentication-Results Header             May 2007


8.  Security Considerations

   The following security considerations apply when applying or
   processing the "Authentication-Results" header:

8.1.  Non-conformant MTAs

   An MUA that is aware of this specification which accesses a mailbox
   whose mail is handled by a non-conformant MTA is in a position to
   make false conclusions based on forged headers.  A malicious user or
   agent could forge a header using the destination MX for a receiving
   domain as the hostname token in the value of the header, and with the
   rest of the value claim that the sender was properly authenticated.
   The non-conformant MTA would fail to strip the forged header, and the
   MUA could trust it.

   It is for this reason an MUA SHOULD NOT have processing of the
   "Authentication-Results" header enabled by default; instead it must
   be ignored, at least for the purposes of enacting filtering
   decisions, unless specifically enabled by the user after verifying
   that the MTA is compliant.  It is acceptable to have an MUA aware of
   this standard, but have an explicit list of hostnames whose
   "Authentication-Results" headers are trustworthy, however this list
   SHOULD initially be empty.

   Proposed alternate solutions to this problem are nascent.  Possibly
   the simplest is a digital signature on the header which can be
   verified by a posted public key.  Another would be a means to
   interrogate the MTA that added the header to see if it is actually
   providing any sender authentication services and saw the message in
   question.  In either case, a method needs to exist to verify that the
   host which appears to have added the header (a) actually did so, and
   (b) is legitimately adding that header for this delivery.

8.2.  Header Position

   Despite the requirements of [MAIL] [6], headers can sometimes be
   reordered enroute by intermediate MTAs.  The goal of requiring header
   addition only at the top of a message is an acknowledgement that some
   MTAs do reorder headers, but most do not.  Thus, in the general case,
   there will be some indication of which MTAs (if any) handled the
   message after the addition of the header defined here.









Kucherawy               Expires November 20, 2007              [Page 15]

Internet-Draft        Authentication-Results Header             May 2007


9.  References

   [1]   Myers, J., "SMTP Service Extension for Authentication",
         RFC 2554, March 1999.

   [2]   Delany, M., "Domain-based Email Authentication Using Public
         Keys Advertised in the DNS (DomainKeys)", RFC RFC-DK, May 2007.

   [3]   Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and
         M. Thomas, "DomainKeys Identified Mail (DKIM) Signatures",
         RFC 4817, May 2007.

   [4]   Alvestrand, H. and T. Narten, "Guidelines for Writing an IANA
         Considerations Section in RFCs", RFC 2434, October 1998.

   [5]   Klyne, G., Nottingham, M., and J. Mogul, "Registration
         Procedures for Message Header Fields", RFC 2434,
         September 2004.

   [6]   Resnick, P., "Internet Message Format", RFC 2822, April 2001.

   [7]   Freed, N. and N. Borenstein, "Multipurpose Internet Mail
         Extensions (MIME) Part One: Format of Internet Message Bodies",
         RFC 2045, November 1996.

   [8]   Lyon, J. and M. Wong, "Sender ID: Authenticating E-Mail",
         RFC 4406, April 2006.

   [9]   Klensin, J., "Simple Mail Transfer Protocol", RFC 2821,
         April 2001.

   [10]  Wong, M. and W. Schlitt, "Sender Policy Framework (SPF) for
         Authorizing Use of Domains in E-Mail, Version 1", RFC 4408,
         April 2006.

















Kucherawy               Expires November 20, 2007              [Page 16]

Internet-Draft        Authentication-Results Header             May 2007


Appendix A.  Acknowledgements

   The author wishes to acknowledge the following for their review and
   constructive criticism of this proposal: Tony Hansen of AT&T, Mark
   Delany and Miles Libbey of Yahoo!  Inc., Jim Fenton of Cisco, and
   Eric Allman of Sendmail, Inc.













































Kucherawy               Expires November 20, 2007              [Page 17]

Internet-Draft        Authentication-Results Header             May 2007


Appendix B.  Public Discussion

   Public discussion of this proposed specification is handled via the
   mail-vet-discuss@mipassoc.org mailing list.  The list is open.
   Access to subscription forms and to list archives can be found at
   http://mipassoc.org/mailman/listinfo/mail-vet-discuss.













































Kucherawy               Expires November 20, 2007              [Page 18]

Internet-Draft        Authentication-Results Header             May 2007


Appendix C.  Authentication-Results Examples

   This section presents some examples of the use of this header to
   indicate authentication results.

C.1.  Trivial case; header not present

   The trivial case:

        From: sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [1.2.3.4])
                  by server.sendmail.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 1: Trivial case

   The "Authentication-Results" header is completely absent.  The MUA
   may make no conclusion about the validity of the message.  This could
   be the case because the sender authentication services were not
   available at the time of delivery, or no service is provided, or the
   MTA is not in compliance with this specification.






















Kucherawy               Expires November 20, 2007              [Page 19]

Internet-Draft        Authentication-Results Header             May 2007


C.2.  Nearly-trivial case; service provided, but no authentication done

   A message that was delivered by an MTA which conforms to this
   standard but provides no actual sender authentication service:

        Authentication-Results: mail-router.example.com
        From: sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [1.2.3.4])
                  by server.sendmail.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 2: Header present but no authentication done

   The "Authentication-Results" header is present, indicating that the
   delivering MTA (which is named in the value of the header) conforms
   to this specification.  The absence of any method and result tokens
   indicates that no sender authentication was done.

C.3.  Service provided, authentication done

   A message that was delivered by an MTA which conforms to this
   standard and applied some sender authentication:

        Authentication-Results: mail-router.example.com
                  smtp.auth=sender@example.com; auth=pass (cram-md5)
        From: sender@example.com
        Received: from dialup-1-2-3-4.example-isp.com
                      (dialup-1-2-3-4.example-isp.com [1.2.3.4])
                  by mail-router.example.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 3: Header reporting results




Kucherawy               Expires November 20, 2007              [Page 20]

Internet-Draft        Authentication-Results Header             May 2007


   The "Authentication-Results" header is present, indicating that the
   delivering MTA (which is named in the value of the header) conforms
   to this specification.  Furthermore, the sender authenticated
   herself/himself to the MTA via a method specified in [AUTH].  The
   actual method is identified in a header comment after the method's
   result is indicated.  The MUA could extract and relay this extra
   information if desired.

C.4.  Service provided, several authentications done, single MTA

   A message that was relayed inbound via a single MTA which conforms to
   this standard and applied two different sender authentication checks:

        Authentication-Results: mail-router.example.com
                  smtp.mail=sender@example.com;
                  auth=pass (cram-md5); spf=pass
        Authentication-Results: mail-router.example.com
                  header.from=sender@example.com; sender-id=pass
        From: sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [1.2.3.4])
                  by dialup-1-2-3-4.example-isp.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 4: Headers reporting results from one MTA

   The "Authentication-Results" header is present, indicating the
   delivering MTA (which is named in the value of the header) conforms
   to this specification.  Furthermore, the sender authenticated
   herself/himself to the MTA via a method specified in [AUTH], and both
   SPF and Sender-ID checks were done and passed.  The MUA could extract
   and relay this extra information if desired.

   Two "Authentication-Results" headers are required because the methods
   applied did not all base their results on the same property of the
   message.








Kucherawy               Expires November 20, 2007              [Page 21]

Internet-Draft        Authentication-Results Header             May 2007


C.5.  Service provided, several authentications done, different MTAs

   A message that was relayed inbound by two different MTAs which
   conform to this standard and applied multiple sender authentication
   checks:

        Authentication-Results: auth-checker.example.com
                  header.from=sender@example.com; sender-id=pass;
                  domainkeys=pass (good signature)
        Received: from mail-router.example.com
                      (mail-router.example.com [10.11.12.13])
                  by auth-checker.example.com (8.11.6/8.11.6)
                      with ESMTP id i7PK0sH7021929;
                  Fri, Feb 15 2002 17:19:22 -0800
        Authentication-Results: mail-router.example.com
                  smtp.mail=sender@example.com; auth=pass (cram-md5);
                  spf=fail
        Received: from dialup-1-2-3-4.example-isp.com
                      (dialup-1-2-3-4.example-isp.com [1.2.3.4])
                  by mail-router.example.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        DomainKey-Signature: a=rsa-sha1; s=gatsby; d=sendmail.com;
                  c=simple; q=dns;
                  b=EToRSuvUfQVP3Bkz ... rTB0t0gYnBVCM=
        From: sender@example.com
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 5: Headers reporting results from multiple MTAs

   The "Authentication-Results" header is present, indicating
   conformance to this specification.  It is present twice because two
   different MTAs in the chain of delivery did authentication tests.
   The first, "mail-router.example.com" reports that [AUTH] and SPF were
   both used and [AUTH] passed but SPF failed.  In the [AUTH] case,
   additional data is provided in the comment field, which the MUA can
   choose to render if desired.  The second MTA, "auth-
   checker.example.com", reports that it did a Sender-ID test and a
   DomainKeys [2] test, both of which passed.  Again, additional data
   about one of the tests is provided as a comment, which the MUA may
   choose to render.





Kucherawy               Expires November 20, 2007              [Page 22]

Internet-Draft        Authentication-Results Header             May 2007


Author's Address

   Murray S. Kucherawy
   Sendmail, Inc.
   6425 Christie Ave., Suite 400
   Emeryville, CA  94608
   US

   Phone: +1 510 594 5400
   Email: msk+ietf@sendmail.com









































Kucherawy               Expires November 20, 2007              [Page 23]

Internet-Draft        Authentication-Results Header             May 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Kucherawy               Expires November 20, 2007              [Page 24]

