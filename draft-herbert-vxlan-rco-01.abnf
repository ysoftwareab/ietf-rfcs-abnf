O = 1 indicates checksum offset is checksum start + 6 (UDP)

O = 0 indicates checksum offset is checksum start + 16 (TCP)

start = csum_start * 2
offset = start + 6
offset = start + 16

csum = packet_csum - checksum(start_of_packet,
                                     offset_encap_payload + start)

 




old = *(start_of_packet + offset_encap_payload + offset)
