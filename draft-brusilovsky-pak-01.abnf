Za = H1(A|B|PW)*(g^x mod p) to Bob;
S1 = H3(A|B|PW|Za/H1(A|B|PW)|g^y mod p|(Za/H1(A|B|PW))^y mod p), and Zb== H2(A|B|PW)*(g^y mod p). 
K = H5(A|B|PW|g^x mod p|Zb/H2(A|B|PW) mod p|(Zb/H2(A|B|PW))^x mod p)
S2 = H4(A|B|PW|g^x mod p|Zb/H2(A|B|PW) mod p|(Zb/H2(A|B|PW))^x mod p)
K = H5(A|B|PW|Za/H1(A|B|PW) mod p|g^y mod p|(Za/H1(A|B|PW))^y mod p)

S1 = H3(A|B|PW|Za/H1(A|B|PW) mod p|g^y mod p|(Za/H1(A|B|PW))^y mod p)
Zb = H2(A|B|PW)*(g^y mod p)
             
    A <-- B: Zb, S1

             Alice checks that Zb does not equal zero,verifies S1 and calculates
             S2 and K:
S2 = H4(A|B|PW|g^x mod p|Zb/H2(A|B|PW) mod p|(Zb/H2(A|B|PW))^x mod p)
K = H5(A|B|PW|g^x mod p|Zb/H2(A|B|PW) mod p|(Zb/H2(A|B|PW))^x mod p)

