<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Transport Layer Security (TLS) Based Transports for Network Endpoint Assessment (NEA) Protocol Exchanges</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Specification Requirements">
<link href="#rfc.section.3" rel="Chapter" title="3 Protocol Layering Model">
<link href="#rfc.section.4" rel="Chapter" title="4 Protocol Flows">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 PT-TCP Protocol Flow">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Initiating a PT-TCP session">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 TCP Port Usage">
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 TLS Setup Phase">
<link href="#rfc.section.4.1.4" rel="Chapter" title="4.1.4 NEA Data Transport Phase in PT-TCP">
<link href="#rfc.section.4.1.5" rel="Chapter" title="4.1.5 Entity Authentication using SASL in PT-TCP">
<link href="#rfc.section.4.1.5.1" rel="Chapter" title="4.1.5.1 Service Name">
<link href="#rfc.section.4.1.5.2" rel="Chapter" title="4.1.5.2 Mechanism Negotiation">
<link href="#rfc.section.4.1.5.3" rel="Chapter" title="4.1.5.3 Message Definition">
<link href="#rfc.section.4.1.5.4" rel="Chapter" title="4.1.5.4 Authorization Identity">
<link href="#rfc.section.4.1.5.5" rel="Chapter" title="4.1.5.5 Aborting Authentication">
<link href="#rfc.section.4.1.5.6" rel="Chapter" title="4.1.5.6 Security Layers">
<link href="#rfc.section.4.1.5.7" rel="Chapter" title="4.1.5.7 Multiple Authentications">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Tunnel EAP Message Flow">
<link href="#rfc.section.5" rel="Chapter" title="5 Packet Formats">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 PT-TCP transport Format">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 NEA TLV">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 SASL-MECH TLV">
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 SASL-AUTH TLV">
<link href="#rfc.section.5.1.4" rel="Chapter" title="5.1.4 SASL-RESULT TLV">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Using tunnel EAP to transport NEA data">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Carrying NEA data in PEAP or EAP-FAST">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Carrying NEA data in TTLS">
<link href="#rfc.section.6" rel="Chapter" title="6 Binding the PA exchange to the TLS Tunnel">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Evaluation Against NEA Requirements">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Evaluation Against Requirement C-1">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Evaluation Against Requirement C-2">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 Evaluation Against Requirement C-3">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 Evaluation Against Requirement C-4">
<link href="#rfc.appendix.Appendix%20A.5" rel="Chapter" title="Appendix A.5 Evaluation Against Requirement C-5">
<link href="#rfc.appendix.Appendix%20A.6" rel="Chapter" title="Appendix A.6 Evaluation Against Requirement C-6">
<link href="#rfc.appendix.Appendix%20A.7" rel="Chapter" title="Appendix A.7 Evaluation Against Requirement C-7">
<link href="#rfc.appendix.Appendix%20A.8" rel="Chapter" title="Appendix A.8 Evaluation Against Requirement C-8">
<link href="#rfc.appendix.Appendix%20A.9" rel="Chapter" title="Appendix A.9 Evaluation Against Requirement C-9">
<link href="#rfc.appendix.Appendix%20A.10" rel="Chapter" title="Appendix A.10 Evaluation Against Requirement C-10">
<link href="#rfc.appendix.Appendix%20A.11" rel="Chapter" title="Appendix A.11 Evaluation Against Requirement C-11">
<link href="#rfc.appendix.Appendix%20A.12" rel="Chapter" title="Appendix A.12 Evaluation Against Requirement PT-1">
<link href="#rfc.appendix.Appendix%20A.13" rel="Chapter" title="Appendix A.13 Evaluation Against Requirement PT-2">
<link href="#rfc.appendix.Appendix%20A.14" rel="Chapter" title="Appendix A.14 Evaluation Against Requirement PT-3">
<link href="#rfc.appendix.Appendix%20A.15" rel="Chapter" title="Appendix A.15 Evaluation Against Requirement PT-4">
<link href="#rfc.appendix.Appendix%20A.16" rel="Chapter" title="Appendix A.16 Evaluation Against Requirement PT-5">
<link href="#rfc.appendix.Appendix%20A.17" rel="Chapter" title="Appendix A.17 Evaluation Against Requirement PT-6">
<link href="#rfc.appendix.Appendix%20A.18" rel="Chapter" title="Appendix A.18 Evaluation Against Requirement PT-7">
<link href="#rfc.appendix.Appendix%20A.19" rel="Chapter" title="Appendix A.19 Evaluation Against Requirement PT-8">
<link href="#rfc.appendix.Appendix%20A.20" rel="Chapter" title="Appendix A.20 Evaluation Against Requirement PT-9">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes how Network Endpoint Assessment (NEA) data can be carried under the protection of a Transport Layer Security (TLS) secured tunnel.  This document defines NEA transports for TLS-based Extensible Authentication Protocol (EAP) tunnel methods and for TLS used over TCP.  " />
  <meta name="description" content="This document describes how Network Endpoint Assessment (NEA) data can be carried under the protection of a Transport Layer Security (TLS) secured tunnel.  This document defines NEA transports for TLS-based Extensible Authentication Protocol (EAP) tunnel methods and for TLS used over TCP.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">N. Cam-Winget</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">J. Salowey</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">H. Zhou</td>
</tr>
<tr>
<td class="left">Expires: September 09, 2011</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 08, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Transport Layer Security (TLS) Based Transports for Network Endpoint Assessment (NEA) Protocol Exchanges<br />
  <span class="filename">draft-cam-winget-eap-tlv-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes how Network Endpoint Assessment (NEA) data can be carried under the protection of a Transport Layer Security (TLS) secured tunnel.  This document defines NEA transports for TLS-based Extensible Authentication Protocol (EAP) tunnel methods and for TLS used over TCP.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 09, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Specification Requirements</a>
</li>
<li>3.   <a href="#rfc.section.3">Protocol Layering Model</a>
</li>
<li>4.   <a href="#rfc.section.4">Protocol Flows</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">PT-TCP Protocol Flow</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">Initiating a PT-TCP session</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">TCP Port Usage</a>
</li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">TLS Setup Phase</a>
</li>
<li>4.1.4.   <a href="#rfc.section.4.1.4">NEA Data Transport Phase in PT-TCP</a>
</li>
<li>4.1.5.   <a href="#rfc.section.4.1.5">Entity Authentication using SASL in PT-TCP</a>
</li>
<li>4.1.5.1.   <a href="#rfc.section.4.1.5.1">Service Name</a>
</li>
<li>4.1.5.2.   <a href="#rfc.section.4.1.5.2">Mechanism Negotiation</a>
</li>
<li>4.1.5.3.   <a href="#rfc.section.4.1.5.3">Message Definition</a>
</li>
<li>4.1.5.4.   <a href="#rfc.section.4.1.5.4">Authorization Identity</a>
</li>
<li>4.1.5.5.   <a href="#rfc.section.4.1.5.5">Aborting Authentication</a>
</li>
<li>4.1.5.6.   <a href="#rfc.section.4.1.5.6">Security Layers</a>
</li>
<li>4.1.5.7.   <a href="#rfc.section.4.1.5.7">Multiple Authentications</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Tunnel EAP Message Flow</a>
</li>
<li>5.   <a href="#rfc.section.5">Packet Formats</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">PT-TCP transport Format</a>
</li>
<li>5.1.1.   <a href="#rfc.section.5.1.1">NEA TLV</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">SASL-MECH TLV</a>
</li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">SASL-AUTH TLV</a>
</li>
<li>5.1.4.   <a href="#rfc.section.5.1.4">SASL-RESULT TLV</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Using tunnel EAP to transport NEA data</a>
</li>
<li>5.2.1.   <a href="#rfc.section.5.2.1">Carrying NEA data in PEAP or EAP-FAST</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Carrying NEA data in TTLS</a>
</li>
<li>6.   <a href="#rfc.section.6">Binding the PA exchange to the TLS Tunnel</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgements</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Evaluation Against NEA Requirements</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Evaluation Against Requirement C-1</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Evaluation Against Requirement C-2</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">Evaluation Against Requirement C-3</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">Evaluation Against Requirement C-4</a>
</li>
<li>Appendix A.5.   <a href="#rfc.appendix.Appendix%20A.5">Evaluation Against Requirement C-5</a>
</li>
<li>Appendix A.6.   <a href="#rfc.appendix.Appendix%20A.6">Evaluation Against Requirement C-6</a>
</li>
<li>Appendix A.7.   <a href="#rfc.appendix.Appendix%20A.7">Evaluation Against Requirement C-7</a>
</li>
<li>Appendix A.8.   <a href="#rfc.appendix.Appendix%20A.8">Evaluation Against Requirement C-8</a>
</li>
<li>Appendix A.9.   <a href="#rfc.appendix.Appendix%20A.9">Evaluation Against Requirement C-9</a>
</li>
<li>Appendix A.10.   <a href="#rfc.appendix.Appendix%20A.10">Evaluation Against Requirement C-10</a>
</li>
<li>Appendix A.11.   <a href="#rfc.appendix.Appendix%20A.11">Evaluation Against Requirement C-11</a>
</li>
<li>Appendix A.12.   <a href="#rfc.appendix.Appendix%20A.12">Evaluation Against Requirement PT-1</a>
</li>
<li>Appendix A.13.   <a href="#rfc.appendix.Appendix%20A.13">Evaluation Against Requirement PT-2</a>
</li>
<li>Appendix A.14.   <a href="#rfc.appendix.Appendix%20A.14">Evaluation Against Requirement PT-3</a>
</li>
<li>Appendix A.15.   <a href="#rfc.appendix.Appendix%20A.15">Evaluation Against Requirement PT-4</a>
</li>
<li>Appendix A.16.   <a href="#rfc.appendix.Appendix%20A.16">Evaluation Against Requirement PT-5</a>
</li>
<li>Appendix A.17.   <a href="#rfc.appendix.Appendix%20A.17">Evaluation Against Requirement PT-6</a>
</li>
<li>Appendix A.18.   <a href="#rfc.appendix.Appendix%20A.18">Evaluation Against Requirement PT-7</a>
</li>
<li>Appendix A.19.   <a href="#rfc.appendix.Appendix%20A.19">Evaluation Against Requirement PT-8</a>
</li>
<li>Appendix A.20.   <a href="#rfc.appendix.Appendix%20A.20">Evaluation Against Requirement PT-9</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">NEA has standardized a transport agnostic Posture Broker (PB) protocol defined in <a href="#RFC5793">[RFC5793]</a> to effect a network endpoint assessment between a Posture Broker Client and a Posture Broker Server.  These PB messages can be transported inside the already defined Type-Length-Value containers in existing TLS-based tunne EAP methods such as PEAP, EAP-FAST and TTLS.  Similarly, this document also defines a TCP based transport, PT-TCP, that uses TLVs encapsulated within TLS.   </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Specification Requirements</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a> .</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#protocol-layering" id="protocol-layering">Protocol Layering Model</a>
</h1>
<p id="rfc.section.3.p.1">When using EAP as the transport, the PB messages can be encapsulated in the TLVs defined by the tunnel EAP methods.  For TLS a new TLV container is defined to facilitate the PB transport over TCP.  The following diagram demonstrates the relationship between protocols when an EAP tunnel method is used: </p>
<div id="#rfc.figure.1"></div>
<pre>
	
 +---------------------------------------------------------------+ 
 |          TLV Encapsulation of PB-PA message                   | 
 |---------------------------------------------------------------| 
 |                         TLS                                   | 
 |---------------------------------------------------------------| 
 |                EAP tunnel based method                      | 
 |---------------------------------------------------------------| 
 |                         EAP                                   | 
 |---------------------------------------------------------------| 
 |        Carrier Protocol (EAPOL, RADIUS, Diameter, etc.)       | 
 +---------------------------------------------------------------+ 
	
	</pre>
<p id="rfc.section.3.p.2">The following diagram demonstrates the protocol relationship of PB when PT-TCP is used: </p>
<div id="#rfc.figure.2"></div>
<pre>
	
 +---------------------------------------------------------------+ 
 |           TLV Encapsulation of PB-PA message                  | 
 |---------------------------------------------------------------| 
 |                         TLS                                   | 
 +---------------------------------------------------------------+ 
 |                         TCP                                   | 
 +---------------------------------------------------------------+ 
	
	</pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#flows" id="flows">Protocol Flows</a>
</h1>
<p id="rfc.section.4.p.1">There are two distinct phases in TLS based transport operation: </p>
<p></p>

<ol>
<li>TLS Setup Phase: are the messages used to establish TLS channel protection for the posture messages.  The TLS Setup Phase begins with either the Posture Transport Client or Posture Transport Server initiating the TLS Handshake protocol to establish the protected TLS channel. </li>
<li>Data Transport Phase: are the messages that are protected by the TLS Record encapsulation. This phase is usually broken up into an optional entity authentication phase followed by the exchange of TLVs carrying NEA data. </li>
</ol>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#tlsflow" id="tlsflow">PT-TCP Protocol Flow</a>
</h1>
<p id="rfc.section.4.1.p.1">This section describes the general flow of messages between the NEA Posture Transport Client and the NEA Posture Transport Server.</p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#inittls" id="inittls">Initiating a PT-TCP session</a>
</h1>
<p id="rfc.section.4.1.1.p.1">With the use of TLS as the transport, it is possible for either the Posture Transport Client or the Posture Transport Server to initiate a PT-TCP session.</p>
<h1 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#tcpport" id="tcpport">TCP Port Usage</a>
</h1>
<p id="rfc.section.4.1.2.p.1">IANA is requested to allocate a TCP Port number for the use of PT-TCP so that both the Posture Transport Client and Posture Transport Server can communicate on a known allocated port.</p>
<h1 id="rfc.section.4.1.3">
<a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#tlssetup" id="tlssetup">TLS Setup Phase</a>
</h1>
<p id="rfc.section.4.1.3.p.1">Typically, it is the NEA Client (e.g. the Posture Transport Client) that initiates the TLS Setup Phase.  However, either party, e.g. the Posture Transport Client or the Posture Transport Server may establish a TCP connection and initiate the TLS Handshake protocol.  Furthermore, the TLS Handshake protocol is also used to establish the cryptographic protections used to secure the data carried within TLS Records.</p>
<p id="rfc.section.4.1.3.p.2">In typical deployments, it is expected for the initiator of a NEA exchange to initiate the TLS Setup.  However, this specification allows for multiple NEA data transactions and as such, each transaction may originate from either the NEA client or the NEA server.  Furthermore, through the use of the TLS session capabilities, PT-TCP also allows for the re-use of the TLS based (PT-TCP) session to allow either the NEA Client or the NEA Server to trigger subsequent NEA exchanges. </p>
<h1 id="rfc.section.4.1.4">
<a href="#rfc.section.4.1.4">4.1.4.</a> <a href="#tlsneaxport" id="tlsneaxport">NEA Data Transport Phase in PT-TCP</a>
</h1>
<p id="rfc.section.4.1.4.p.1">Once the PT-TCP session has been established, either the NEA Client or the NEA Server can trigger a NEA data transaction (typically a posture assessment).  The initiator for the NEA data transaction encapsulates the PB messages in a TLV as described in <a href="#tlsfmt">Section 5.1</a>. </p>
<p id="rfc.section.4.1.4.p.2">As PT-TCP is full-duplex (by the TLS design), it supports the full capabilities of the PB-TNC state machine.</p>
<h1 id="rfc.section.4.1.5">
<a href="#rfc.section.4.1.5">4.1.5.</a> <a href="#sasl" id="sasl">Entity Authentication using SASL in PT-TCP</a>
</h1>
<p id="rfc.section.4.1.5.p.1">Implementations may support entity authentication through the use of <a href="#RFC4422">SASL</a> <cite title="NONE">[RFC4422]</cite>.  This section details the SASL profile for PT-TCP. </p>
<p id="rfc.section.4.1.5.p.2">Typically, the PT-TCP initiator will also initiate the SASL exchange.  The responder presents a list of SASL mechanism it supports through the use of the SASL-AUTH-MECH TLV.  The initiator may request a list of SASL authentication mechanisms by sending an empty list of mechanisms in the SASL-AUTH-MECH TLV.</p>
<p id="rfc.section.4.1.5.p.3">The initiator starts the authentication by sending a SASL-AUTH TLV with the mech field containing the name of the mechanism it selects.  If the selected mechanism has an initial response then the client includes that response in the auth-data field.  If necessary the responder sends a SASL-AUTH TLV with the auth-data field containing a SASL challenge for the selected mechanism.  The SASL-AUTH exchange continues in this manner until the authentication completes upon completion the responder sends a SASL-RESULT TLV.  If the authentication is successful the SASL-RESULT TLV contains an result code of success.  If the authentication fails the SASL-RESULT TLV contains a result code indicating the reason for the failure.   The initiator may abort the exchange by sending a SASL-RESULT TLV with an ABORT result code.</p>
<p id="rfc.section.4.1.5.p.4">Implementations MUST provide the EXTERNAL SASL mechanism if the initiator is authenticated during the TLS establishment.  Implementations MUST also support the PLAIN SASL mechanism.  </p>
<h1 id="rfc.section.4.1.5.1">
<a href="#rfc.section.4.1.5.1">4.1.5.1.</a> Service Name</h1>
<p id="rfc.section.4.1.5.1.p.1">The service name for PT-TCP is "nea-pt-tcp".</p>
<h1 id="rfc.section.4.1.5.2">
<a href="#rfc.section.4.1.5.2">4.1.5.2.</a> Mechanism Negotiation</h1>
<p id="rfc.section.4.1.5.2.p.1">Mechanism Negotiation is performed using the SASL-AUTH-MECH TLV.  The SASL-AUTH-MECH TLV contains the list of mechanisms supported by the responder.  The initiator may send a SASL-AUTH-MECH TLV with an emptily list to request a list format from the responder. </p>
<h1 id="rfc.section.4.1.5.3">
<a href="#rfc.section.4.1.5.3">4.1.5.3.</a> Message Definition</h1>
<p id="rfc.section.4.1.5.3.p.1">The initiator starts authentication by sending a SASL-AUTH TLV indicating the sleeted mechanism.  The initial message may contain an initial response if required by the selected mechanism.  Subsequent challenges and response are carried within SASL-AUTH TLVs between the initiator and responder carrying the authentication data for the mechanism.  The authentication outcome is communicated in a SASL-RESULT TLV containing a status code. </p>
<h1 id="rfc.section.4.1.5.4">
<a href="#rfc.section.4.1.5.4">4.1.5.4.</a> Authorization Identity</h1>
<p id="rfc.section.4.1.5.4.p.1">The nea-pt-tcp protocol does not make use of an authorization identity.</p>
<h1 id="rfc.section.4.1.5.5">
<a href="#rfc.section.4.1.5.5">4.1.5.5.</a> Aborting Authentication</h1>
<p id="rfc.section.4.1.5.5.p.1">The initiator may abort the authentication exchange by sending the SASL-AUTH-RESULT TLV with a status code of ABORT.</p>
<h1 id="rfc.section.4.1.5.6">
<a href="#rfc.section.4.1.5.6">4.1.5.6.</a> Security Layers</h1>
<p id="rfc.section.4.1.5.6.p.1">The NEA PT-TCP protocol always runs under the protection of TLS. SASL security layers are not used. </p>
<h1 id="rfc.section.4.1.5.7">
<a href="#rfc.section.4.1.5.7">4.1.5.7.</a> Multiple Authentications</h1>
<p id="rfc.section.4.1.5.7.p.1">Only one authentication may be in progress at any one time.  Once an authentication completes, successfully on unsuccessfully, a new authentication may be initiated.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#eapflow" id="eapflow">Tunnel EAP Message Flow</a>
</h1>
<p id="rfc.section.4.2.p.1">This section discusses the general flow of messages between the NEA Client's Posture Transport Client and the NEA Server's Posture Transport Server in order to perform NEA assessments when using a tunnel EAP method. </p>
<p id="rfc.section.4.2.p.2">When NEA data exchange is conducted in a tunnel EAP method, it typically consists of four phases:</p>
<p></p>

<ol>
<li>Establishment of EAP tunnel method: a secure and protected TLS channel is established between the Transport Client and Transport Server, after the Transport Server's identity has been authenticated and a shared secret encryption key is established between them.</li>
<li>Entity authentication: during this phase, the NEA Client's Posture Transport Client's identity might be optionally authenticated, so appropriate posture assessment policy could be applied according to the authenticated entity. Typically, it is done via an inner EAP method or authentication exchanges within the protected tunnel. In addition, the identity could also be authenticated as part of the tunnel establishment instead (e.g., the client sends a client certificate as part of the tunnel establishment). </li>
<li>Posture assessment: the posture data are exchanged between the NEA Client's Posture Transport client and NEA Server's Posture Transport Server. The posture data is encapsulated in a TLV or TLV like type object, as described in Section 5.2. </li>
<li>Conclusion phase: the result of the authentication and/or posture assessment is exchanged between the client and server, so they will have synchronized state. Optional cryptographic binding might be done to ensure both peers are involved in both the tunnel establishment and the inner method exchanges. Both sides are ready to tear down the tunnel and finish the EAP method. </li>
</ol>

<p> </p>
<p id="rfc.section.4.2.p.4">At the end of the tunnel EAP method, an EAP-Success or EAP-Failure will be sent by the EAP server to indicate the end of the EAP authentication, and the NAS will apply appropriate authorization policy based on the authentication and posture assessment result. </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#neaformat" id="neaformat">Packet Formats</a>
</h1>
<p id="rfc.section.5.p.1">As there is no explicit authentication expected in the PB-PA message exchanges, no new inner EAP method is required; rather, the TLV formats defined in existing EAP tunnel methods can be used to encapsulate and transport PB-PA messages.  Similarly, when using TLS a TLV format can be defined to carry NEA data.  This section describes how NEA data can be carried in either a tunnel EAP method or TLS. </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#tlsfmt" id="tlsfmt">PT-TCP transport Format</a>
</h1>
<p id="rfc.section.5.1.p.1">This section defines a Type-Length-Value (TLV) encapsulation for carrying NEA data in a TLS channel.  The TLS channel MUST be protected to carry NEA data using the encapsulation defined below. The fields are transmitted from left to right.</p>
<div id="#rfc.figure.3"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| R |            TLV Type       |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Length            |      Data                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Data                                 |                                          
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 0">
<dl>
<dt>R</dt>
<dd style="margin-left: 3">
<br><br>Reserved, set to zero (0)<br><br>
</dd>
</dl>
<p> </p>
</dd>
<dt>TLV Type</dt>
<dd style="margin-left: 0">
<br><br> TLV Type Code. Allocated Types include:<br><br> <ul class="empty">
<li>Reserved</li>
<li>NEA TLV</li>
<li>SASL-MECH TLV</li>
<li>SASL-AUTH TLV</li>
<li>SASL-RESULT TLV</li>
</ul>
<p> </p>
<br><br>
</dd>
<dt>Length</dt>
<dd style="margin-left: 0">
<br><br>The length of the Data field in octets.<br><br>
</dd>
<dt>Data</dt>
<dd style="margin-left: 0">
<br><br> Data according to the TLV type.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> NEA TLV</h1>
<div id="#rfc.figure.4"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| R |            TLV Type       |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Length            |       PB-TNC Header           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        PB-TNC Header          |     PB-PA Message...          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          PB-PA Message...                     |                                      
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 0">
<dl>
<dt>R</dt>
<dd style="margin-left: 3">
<br><br>Reserved, set to zero (0)<br><br>
</dd>
</dl>
<p> </p>
</dd>
<dt>TLV Type</dt>
<dd style="margin-left: 0">
<br><br> 1 for NEA TLV <br><br>
</dd>
<dt>Length</dt>
<dd style="margin-left: 0">
<br><br>The length of the Value field in octets.<br><br>
</dd>
<dt>PB-TNC Header</dt>
<dd style="margin-left: 0">
<br><br> The PB-TNC encapsulation header as described in <a href="#RFC5793">[RFC5793]</a>.</dd>
<dt>PB-PA Message</dt>
<dd style="margin-left: 0">
<br><br> The message between the Posture Broker Client and Posture Broker Server as described in <a href="#RFC5793">[RFC5793]</a>.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> SASL-MECH TLV</h1>
<div id="#rfc.figure.5"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| R |            TLV Type       |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Length            |      Mech-Name-Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Mechanism Name                                    |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Mech-Name-Length           |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
|             Mechanism Name                                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...




</pre>
<p id="rfc.section.5.1.2.p.1">The SASL-MECH TLV contains a list of supported SASL mechanisms.  Each mechanism name consists of a name length followed by the name.  The total length of the list is determined by the TLV length field.</p>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 0">
<dl>
<dt>R</dt>
<dd style="margin-left: 3">
<br><br>Reserved, set to zero (0)<br><br>
</dd>
</dl>
<p> </p>
</dd>
<dt>TLV Type</dt>
<dd style="margin-left: 0">
<br><br> 2 for SASL-MECH TLV <br><br>
</dd>
<dt>Length</dt>
<dd style="margin-left: 0">
<br><br>The length of the Value field in octets.  The value field contains the list of mechanism names.<br><br>
</dd>
<dt>Mech-Name-Length</dt>
<dd style="margin-left: 0">
<br><br> Length of the mechanism name in bytes.</dd>
<dt>Mech-Name</dt>
<dd style="margin-left: 0">
<br><br> SASL mechanism Name adhering to the rules defined in <a href="#RFC4422">[RFC4422]</a>.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.5.1.3">
<a href="#rfc.section.5.1.3">5.1.3.</a> SASL-AUTH TLV</h1>
<div id="#rfc.figure.6"></div>
<pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| R |            TLV Type       |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Length            |      Mech-Name-Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Mechanism Name                                    |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                                                               |
|               Mechanism Data                                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.5.1.3.p.1">The SASL-AUTH TLV contains data pertaining a SASL mechanism.  The mechanism name is included in each SASL-AUTH TLV.  The TLV is used by the initiator to select from a list of supported mechanisms provided by the responder.  The initial response from the initiator may contain Mechanism Data containing the initial response.  If the mechanism selected does not use an initial response then the mechanism data field is not included.  The SASL-AUTH TLV is also used to communicate SASL mechanism data from the responder to the initiator. </p>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 0">
<dl>
<dt>R</dt>
<dd style="margin-left: 3">
<br><br>Reserved, set to zero (0)<br><br>
</dd>
</dl>
<p> </p>
</dd>
<dt>TLV Type</dt>
<dd style="margin-left: 0">
<br><br> 3 for SASL-AUTH TLV <br><br>
</dd>
<dt>Length</dt>
<dd style="margin-left: 0">
<br><br>The length of the Value field in octets.  The value field contains a mechanism name and optional mechanism data..<br><br>
</dd>
<dt>Mech-Name-Length</dt>
<dd style="margin-left: 0">
<br><br> Length of the mechanism name in bytes.</dd>
<dt>Mech-Name</dt>
<dd style="margin-left: 0">
<br><br> SASL mechanism Name adhering to the rules defined in <a href="#RFC4422">[RFC4422]</a>.  This is the mechanism selected for use by the initiator.</dd>
<dt>Mech-Name</dt>
<dd style="margin-left: 0">
<br><br> SASL mechanism data for named mechanism.  This field may be omitted in the initial response from the initiator if the selected mechanism does not use an initial response.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.5.1.4">
<a href="#rfc.section.5.1.4">5.1.4.</a> SASL-RESULT TLV</h1>
<div id="#rfc.figure.7"></div>
<pre>


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| R |            TLV Type       |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Length            |       Result-Code             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre>
<p id="rfc.section.5.1.4.p.1">The SASL-RESULT TLV contains the result of the SASL Exchange. A result code of 0 indicates success. Other result codes indicate some sort of failure.  A result code of 1 indicates the exchange was aborted by the sender. A result code of 2 indicates a failure within the mechanism.  Only the responder side of the conversation may send a successful result code.  Either side may send a failure result code which terminates the current authentication conversation.</p>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 0">
<dl>
<dt>R</dt>
<dd style="margin-left: 3">
<br><br>Reserved, set to zero (0)<br><br>
</dd>
</dl>
<p> </p>
</dd>
<dt>TLV Type</dt>
<dd style="margin-left: 0">
<br><br> 4 for SASL-Result TLV <br><br>
</dd>
<dt>Length</dt>
<dd style="margin-left: 0">
<br><br>The length of the Value field in octets.  This field is set to 2.<br><br>
</dd>
<dt>Result Code</dt>
<dd style="margin-left: 0">
<br><br> The value of the result code.  <br><br><ul class="empty">
<li>Success</li>
<li>Abort</li>
<li>Mechanism Failure</li>
</ul>
<br><br>
</dd>
</dl>

<p> </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#eapxport" id="eapxport">Using tunnel EAP to transport NEA data</a>
</h1>
<p id="rfc.section.5.2.p.1">This section describes the TLV encapsulation used in three predominant tunnel EAP methods deployed today: PEAP, EAP-FAST and TTLS.  When using EAP tunnel methods, the tunnel MUST be protected.</p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#eap-fast" id="eap-fast">Carrying NEA data in PEAP or EAP-FAST</a>
</h1>
<p id="rfc.section.5.2.1.p.1">As TLV format for PEAP and EAP-FAST are the same, the diagram below shows how PB-PA messages can be encapsulated in the TLVs.  Note however that the type assignments when using PEAP versus EAP-FAST may be different. The fields are transmitted from left to right.</p>
<div id="#rfc.figure.8"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|            TLV Type       |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          PB-TNC Header                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          PB-PA Message...                     |                                      
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 0"><dl>
<dt>M</dt>
<dd style="margin-left: 3">
<br><br><ul class="empty">
<li>Optional TLV</li>
<li>Mandatory TLV<br><br>
</li>
</ul>
</dd>
<dt>R</dt>
<dd style="margin-left: 3">
<br><br>Reserved, set to zero (0)<br><br>
</dd>
<dt>TLV Type</dt>
<dd style="margin-left: 3">
<br><br> The EAP-FAST NEA TLV type: <br><br><ul class="empty"><li></ul>
<br><br>
</dd>
<dt>Length</dt>
<dd style="margin-left: 3">
<br><br>The length of the Value field in octets.<br><br>
</dd>
<dt>PB-TNC Header</dt>
<dd style="margin-left: 3">
<br><br> The PB-TNC encapsulation header as described in <a href="#RFC5793">[RFC5793]</a>.</dd>
<dt>PB-PA Message</dt>
<dd style="margin-left: 3">
<br><br> The message between the Posture Broker Client and Posture Broker Server as described in <a href="#RFC5793">[RFC5793]</a>.</dd>
</dl></dd>
</dl>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> <a href="#ttls" id="ttls">Carrying NEA data in TTLS</a>
</h1>
<p id="rfc.section.5.2.2.p.1">The TTLS AVP Format to carry PB-PA messages is defined and described below. The fields are transmitted from left to right.</p>
<div id="#rfc.figure.9"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             AVP Code                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   AVP Flags   |            AVP Length                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           PB-TNC Header                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                        PB-PA-Message...                       |                                      
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 0"><dl>
<dt>AVP Code</dt>
<dd style="margin-left: 3">
<br><br> The TTLS NEA AVP type code: <br><br><ul class="empty"><li></ul>
<br><br>
</dd>
<dt>AVP Flags</dt>
<dd style="margin-left: 3">
<br><br> The AVP flags are set to 0.  <br><br><br><br>
</dd>
<dt>AVP Length</dt>
<dd style="margin-left: 3">
<br><br>The length of the AVP in octets.<br><br>
</dd>
<dt>PB-TNC Header</dt>
<dd style="margin-left: 3">
<br><br> The PB-TNC encapsulation header as described in <a href="#RFC5793">[RFC5793]</a>.</dd>
<dt>PB-PA Message</dt>
<dd style="margin-left: 3">
<br><br> The message between the Posture Broker Client and Posture Broker Server as described in <a href="#RFC5793">[RFC5793]</a>.</dd>
</dl></dd>
</dl>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#channelbind" id="channelbind">Binding the PA exchange to the TLS Tunnel</a>
</h1>
<p id="rfc.section.6.p.1">Some implementations of the NEA system allow for the external validation of the data collected and sent by the posture collector.  In these cases, an external measurement agent (EMA) signs the data sent by the collector.  In order to prevent posture data of the endpoint from being used on another machine, the TLS tunnel and the posture data signed by the EMA must be bound together.  This is done using the "tls-unique" channel binding defined in <a href="#RFC5929">RFC 5929</a> <cite title="NONE">[RFC5929]</cite>.  The data from the first TLS Finished message sent on the most recent TLS connection handshake is included in the data signed by the EMA.  The PA attributes used are specific to the EMA used by the posture collector.  </p>
<p id="rfc.section.6.p.2">The "tls-unique" channel-binding data can be used whenever a TLS transport is provided, including TLS over TCP and TLS used in tunnel EAP methods.  It is RECOMMENDED that posture collectors that support an EMA provide a PA attribute to carry the "tls-unique" channel binding data.  The channel binding data MAY be combined with other data using a cryptographic hash or similar technique.  The channel binding attribute MUST be signed by the EMA.  Posture validators that receive channel binding data MUST verify that it is consistent with the channel binding data obtained from the server-side of the TLS connection.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The NEA TLV container carries network endpoint assessment information between the Posture Broker Client and the Posture Broker Server.  As some of this data can be sensitive, TLS cipher suites that provide encryption are RECOMMENDED.</p>
<p id="rfc.section.7.p.2">To address the potential man-in-the-middle attack similar to the Asokan attack described in <a href="#I-D.salowey-nea-asokan">[I-D.salowey-nea-asokan]</a> the channel binding mechanism defined in <a href="#channelbind">Section 6</a> SHOULD be used whenever an EMA is available to sign the posture data.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">IANA is requested to assign a TCP port number in the "Registered Port" range with the keyword "pt-tcp". This port will be the default port for PT-TCP defined in this document.</p>
<p id="rfc.section.8.p.2">IANA is requested to allocate a TLV type from the EAP-FAST TLV Type registry for carrying posture data as specified in <a href="#eap-fast">Section 5.2.1</a>.</p>
<p id="rfc.section.8.p.3">IANA is requested to allocate a Diameter AVP code from the Diameter AVP code registry for carrying posture data as specified in <a href="#ttls">Section 5.2.2</a>. </p>
<p id="rfc.section.8.p.4">This document defines a registry for TLV types to be carried within PT-TCP, which may be assigned by Specification Required as defined in <a href="#RFC2434">[RFC2434]</a> </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Acknowledgements</h1>
<p id="rfc.section.9.p.1">The authors would like to recognize Susan Thomson, Syam Appala and Subbu Srinivasan for providing input into this draft.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2434">[RFC2434]</b></td>
<td class="top">
<a href="mailto:narten@raleigh.ibm.com" title="IBM Corporation">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no" title="Maxware">H.T. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 2434, October 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4493">[RFC4493]</b></td>
<td class="top">
<a>Song, JH.</a>, <a>Poovendran, R.</a>, <a>Lee, J.</a> and <a>T. Iwata</a>, "<a href="http://tools.ietf.org/html/rfc4493">The AES-CMAC Algorithm</a>", RFC 4493, June 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5929">[RFC5929]</b></td>
<td class="top">
<a>Altman, J.</a>, <a>Williams, N.</a> and <a>L. Zhu</a>, "<a href="http://tools.ietf.org/html/rfc5929">Channel Bindings for TLS</a>", RFC 5929, July 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5793">[RFC5793]</b></td>
<td class="top">
<a>Sahita, R.</a>, <a>Hanna, S.</a>, <a>Hurst, R.</a> and <a>K. Narayan</a>, "<a href="http://tools.ietf.org/html/rfc5793">PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC)</a>", RFC 5793, March 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4422">[RFC4422]</b></td>
<td class="top">
<a>Melnikov, A.</a> and <a>K. Zeilenga</a>, "<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>", RFC 4422, June 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody><tr>
<td class="reference"><b id="I-D.salowey-nea-asokan">[I-D.salowey-nea-asokan]</b></td>
<td class="top">
<a>Salowey, J</a> and <a>S Hanna</a>, "<a href="http://tools.ietf.org/html/draft-salowey-nea-asokan-00">NEA Asokan Attack Analysis</a>", Internet-Draft draft-salowey-nea-asokan-00, October 2010.</td>
</tr></tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#reqmts" id="reqmts">Evaluation Against NEA Requirements</a>
</h1>
<p id="rfc.section.Appendix A.p.1">This section evaluates both the PT-TCP and EAP based protocols against the PT requirements defined in the NEA Overview and Requirements and PB-TNC specifications.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Evaluation Against Requirement C-1</h1>
<p id="rfc.section.Appendix A.1.p.1">Requirement C-1 states: </p>
<p id="rfc.section.Appendix A.1.p.2">C-1  NEA protocols MUST support multiple round trips between the NEA Client and the NEA Server in a single assessment. </p>
<p id="rfc.section.Appendix A.1.p.3">PT-TCP meets this requirement.  By using the TLS protocol over TCP, multiple roundtrips of TLS records and thus PT-TCP messages are allowed.</p>
<p id="rfc.section.Appendix A.1.p.4">Tunnel EAP meets this requirement.  All available Tunnel EAP methods are based on the TLS design which allows for multiple round trips. </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Evaluation Against Requirement C-2</h1>
<p id="rfc.section.Appendix A.2.p.1">Requirement C-2 states: </p>
<p id="rfc.section.Appendix A.2.p.2">C-2  NEA protocols SHOULD provide a way for both the NEA Client and the NEA Server to initiate a posture assessment or reassessment as needed. </p>
<p id="rfc.section.Appendix A.2.p.3">PT-TCP meets this requirement.  PT-TCP allows either the NEA Client or the NEA Server to initiate an assessment or reassessment.</p>
<p id="rfc.section.Appendix A.2.p.4">Tunnel EAP does not meet this requirement.  The typical use case scenario for using a Tunnel EAP method is to service the layer 2 network stack.  In this use case, the endpoint would not have an IP address yet as it is requesting network access and thus would not be able to accept requests from the NEA Server.  However, once network access has been granted, then yes, the NEA Client could receive (re)assessment requests from the NEA Server.</p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> Evaluation Against Requirement C-3</h1>
<p id="rfc.section.Appendix A.3.p.1">Requirement C-3 states: </p>
<p id="rfc.section.Appendix A.3.p.2">C-3  NEA protocols including security capabilities MUST be capable of protecting against active and passive attacks by intermediaries and endpoints including prevention from replay based attacks. </p>
<p id="rfc.section.Appendix A.3.p.3">PT-TCP meets this requirement.  TLS includes mechanisms that provide strong cryptographic authentication, message integrity and confidentiality for NEA. In addition, to further mitigate man-in-the middle attacks, the use of channel binding at the PA layer must be used.</p>
<p id="rfc.section.Appendix A.3.p.4">Tunnel EAP meets this requirement.  All available Tunnel EAP methods are based on the TLS design which provide strong cryptographic authentication, message integrity and confidentiality for NEA. In addition, to further mitigate man-in-the middle attacks, the use of channel binding at the PA layer must be used. </p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> Evaluation Against Requirement C-4</h1>
<p id="rfc.section.Appendix A.4.p.1">Requirement C-4 states: </p>
<p id="rfc.section.Appendix A.4.p.2">C-4  The PA and PB protocols MUST be capable of operating over any PT protocol. </p>
<p id="rfc.section.Appendix A.4.p.3">This requirement is not applicable to PT, though the PT-TCP protocol is independent of both the PA and PB layer.</p>
<p id="rfc.section.Appendix A.4.p.4">This requirement is not applicable to PT, though the Tunnel EAP protocols are independent of both the PA and PB layer.</p>
<h1 id="rfc.appendix.Appendix A.5">
<a href="#rfc.appendix.Appendix%20A.5">Appendix A.5.</a> Evaluation Against Requirement C-5</h1>
<p id="rfc.section.Appendix A.5.p.1">Requirement C-5 states: </p>
<p id="rfc.section.Appendix A.5.p.2">C-5  The selection process for NEA protocols MUST evaluate and prefer the reuse of existing open standards that meet the requirements before defining new ones.  The goal of NEA is not to create additional alternative protocols where acceptable solutions already exist. </p>
<p id="rfc.section.Appendix A.5.p.3">As TLS is a widely used open standard, it should meet this requirement.</p>
<p id="rfc.section.Appendix A.5.p.4">As EMU is still in the early stages of standardizing a Tunnel EAP method, this specification reuses already widely deployed, published Tunnel EAP methods. Rather than defining a new Tunnel EAP method, this specification proposes to adopt already used ones and provides guidance for how new Tunnel EAP methods can meet this criteria to allow for NEA to use the method standardized by EMU at some future date.</p>
<h1 id="rfc.appendix.Appendix A.6">
<a href="#rfc.appendix.Appendix%20A.6">Appendix A.6.</a> Evaluation Against Requirement C-6</h1>
<p id="rfc.section.Appendix A.6.p.1">Requirement C-6 states: </p>
<p id="rfc.section.Appendix A.6.p.2">C-6  NEA protocols MUST be highly scalable; the protocols MUST support many Posture Collectors on a large number of NEA Clients to be assessed by numerous Posture Validators residing on multiple NEA Servers. </p>
<p id="rfc.section.Appendix A.6.p.3">PT-TCP meets this requirement.  As PT-TCP is a protocol to establish a protected channel by which NEA data can be transported, it is independent of the content of the data it is transporting and thus can allow for carrying batches of data to multiple Posture Validators or Posture Collectors.</p>
<p id="rfc.section.Appendix A.6.p.4">Tunnel EAP methods meet this requirement.  As the Tunnel EAP methods define a protected transport channel that is independent of the content it transports, it can carry batches of data from and to multiple Posture Collectors and Posture Validators.</p>
<h1 id="rfc.appendix.Appendix A.7">
<a href="#rfc.appendix.Appendix%20A.7">Appendix A.7.</a> Evaluation Against Requirement C-7</h1>
<p id="rfc.section.Appendix A.7.p.1">Requirement C-7 states: </p>
<p id="rfc.section.Appendix A.7.p.2">C-7  The protocols MUST support efficient transport of a large number of attribute messages between the NEA Client and the NEA Server. </p>
<p id="rfc.section.Appendix A.7.p.3">PT-TCP meets this requirement.  The PT-TCP usurps 6 octets of overhead per PT-TCP message; a small overhead to the ability to carry very many PA-TNC attributes within a PB-TNC batch.</p>
<p id="rfc.section.Appendix A.7.p.4">The Tunnel EAP methods meet this requirements subject to the limitations of the underlying EAP protocol and encapsulation mechanisms. Note that a typical use case for the Tunnel EAP methods is that the assessments are brief and used for enabling network access; as such, it is not recommended to use Tunnel EAP methods to carry large amounts of attributes.</p>
<h1 id="rfc.appendix.Appendix A.8">
<a href="#rfc.appendix.Appendix%20A.8">Appendix A.8.</a> Evaluation Against Requirement C-8</h1>
<p id="rfc.section.Appendix A.8.p.1">Requirement C-8 states: </p>
<p id="rfc.section.Appendix A.8.p.2">C-8 NEA protocols MUST operate efficiently over low bandwidth or high latency links. </p>
<p id="rfc.section.Appendix A.8.p.3">PT-TCP meets this requirement.  As TLS was originally designed to work at the TCP layer, it has been proven to work well over either low bandwidth or high latency links.</p>
<p id="rfc.section.Appendix A.8.p.4">EAP Tunnel methods meet this requirement.  The underlying EAP framework was designed and proven to work under constrained and low latency links.</p>
<h1 id="rfc.appendix.Appendix A.9">
<a href="#rfc.appendix.Appendix%20A.9">Appendix A.9.</a> Evaluation Against Requirement C-9</h1>
<p id="rfc.section.Appendix A.9.p.1">Requirement C-9 states: </p>
<p id="rfc.section.Appendix A.9.p.2">C-9 For any strings intended for display to a user, the protocols MUST support adapting these strings to the user's language preferences. </p>
<p id="rfc.section.Appendix A.9.p.3">PT-TCP meets this requirement.  The PT-TCP protocol does not define messages intended for display to the user.</p>
<p id="rfc.section.Appendix A.9.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods do not define messages intended for display to the user. </p>
<h1 id="rfc.appendix.Appendix A.10">
<a href="#rfc.appendix.Appendix%20A.10">Appendix A.10.</a> Evaluation Against Requirement C-10</h1>
<p id="rfc.section.Appendix A.10.p.1">Requirement C-10 states: </p>
<p id="rfc.section.Appendix A.10.p.2">C-10 NEA protocols MUST support encoding of strings in UTF-8 format. </p>
<p id="rfc.section.Appendix A.10.p.3">PT-TCP meets this requirement.  The PT-TCP protocol does not define messages intended for display to the user.</p>
<p id="rfc.section.Appendix A.10.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods do not define messages intended for display to the user. </p>
<h1 id="rfc.appendix.Appendix A.11">
<a href="#rfc.appendix.Appendix%20A.11">Appendix A.11.</a> Evaluation Against Requirement C-11</h1>
<p id="rfc.section.Appendix A.11.p.1">Requirement C-11 states: </p>
<p id="rfc.section.Appendix A.11.p.2">C-11 Due to the potentially different transport characteristics provided by the underlying candidate PT protocols, the NEA Client and the NEA Server MUST be capable of becoming aware of and adapting to the limitations of the available PT protocol. </p>
<p id="rfc.section.Appendix A.11.p.3">PT-TCP meets this requirement.  The PT-TCP protocol uses TLS which is designed to provide reliable transport that can adapt to constrained or low bandwidth links.</p>
<p id="rfc.section.Appendix A.11.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods are based on TLS which is designed to provide reliable transport and have been proven to adapt and work well under high latency or low bandwidth conditions. </p>
<h1 id="rfc.appendix.Appendix A.12">
<a href="#rfc.appendix.Appendix%20A.12">Appendix A.12.</a> Evaluation Against Requirement PT-1</h1>
<p id="rfc.section.Appendix A.12.p.1">Requirement PT-1 states: </p>
<p id="rfc.section.Appendix A.12.p.2">PT-1 The PT protocol MUST NOT interpret the contents of PB messages being transported, i.e., the data it is carrying must be opaque to it. </p>
<p id="rfc.section.Appendix A.12.p.3">PT-TCP meets this requirement.  The PT-TCP protocol encapsulates PB messages in a TLV container without interpreting their contents.</p>
<p id="rfc.section.Appendix A.12.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods define encapsulations for carrying arbitrary data without interpreting their contents. </p>
<h1 id="rfc.appendix.Appendix A.13">
<a href="#rfc.appendix.Appendix%20A.13">Appendix A.13.</a> Evaluation Against Requirement PT-2</h1>
<p id="rfc.section.Appendix A.13.p.1">Requirement PT-2 states: </p>
<p id="rfc.section.Appendix A.13.p.2">PT-2 The PT protocol MUST be capable of supporting mutual authentication, integrity, confidentiality, and replay protection of the PB messages between the Posture Transport Client and the Posture Transport Server. </p>
<p id="rfc.section.Appendix A.13.p.3">PT-TCP meets this requirement.  The PT-TCP protocol uses TLS to provide mutual authentication, integrity, confidentiality, and replay protection.</p>
<p id="rfc.section.Appendix A.13.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods are based on TLS which is designed to provide  mutual authentication, integrity, confidentiality, and replay protection. </p>
<h1 id="rfc.appendix.Appendix A.14">
<a href="#rfc.appendix.Appendix%20A.14">Appendix A.14.</a> Evaluation Against Requirement PT-3</h1>
<p id="rfc.section.Appendix A.14.p.1">Requirement PT-3 states: </p>
<p id="rfc.section.Appendix A.14.p.2">PT-3 The PT protocol MUST provide reliable delivery for the PB protocol.  This includes the ability to perform fragmentation and reassembly, detect duplicates, and reorder to provide in-sequence delivery, as required. </p>
<p id="rfc.section.Appendix A.14.p.3">PT-TCP meets this requirement.  The PT-TCP protocol is designed to work over TCP which provides the fragmentation and reassembly services, detect duplicates and reorder messages if they arrive out of order.</p>
<p id="rfc.section.Appendix A.14.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods are based on the EAP framework which provides retransmissions, while reordering and fragmentation are handled by the individual EAP Tunnel methods. </p>
<h1 id="rfc.appendix.Appendix A.15">
<a href="#rfc.appendix.Appendix%20A.15">Appendix A.15.</a> Evaluation Against Requirement PT-4</h1>
<p id="rfc.section.Appendix A.15.p.1">Requirement PT-4 states: </p>
<p id="rfc.section.Appendix A.15.p.2">PT-4 The PT protocol SHOULD be able to run over existing network access protocols such as 802.1X and IKEv2. </p>
<p id="rfc.section.Appendix A.15.p.3">PT-TCP does NOT meet this requirement as it is designed to operate over TCP.</p>
<p id="rfc.section.Appendix A.15.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods are based on EAP which has been enabled on both 802.1X and IKEv2.</p>
<h1 id="rfc.appendix.Appendix A.16">
<a href="#rfc.appendix.Appendix%20A.16">Appendix A.16.</a> Evaluation Against Requirement PT-5</h1>
<p id="rfc.section.Appendix A.16.p.1">Requirement PT-5 states: </p>
<p id="rfc.section.Appendix A.16.p.2">PT-5 The PT protocol SHOULD be able to run between a NEA Client and NEA Server over TCP or UDP (similar to Lightweight Directory Access Protocol (LDAP))</p>
<p id="rfc.section.Appendix A.16.p.3">PT-TCP meets this requirement.  The PT-TCP protocol is designed to operate over a TCP connection.</p>
<p id="rfc.section.Appendix A.16.p.4">EAP Tunnel methods do NOT meet this requirement.  The EAP Tunnel methods are designed to work pre-network admission and thus are not able to communicate at the IP layer. </p>
<h1 id="rfc.appendix.Appendix A.17">
<a href="#rfc.appendix.Appendix%20A.17">Appendix A.17.</a> Evaluation Against Requirement PT-6</h1>
<p id="rfc.section.Appendix A.17.p.1">Requirement PT-6 states: </p>
<p id="rfc.section.Appendix A.17.p.2">PT-6 The PT protocol MUST be connection oriented; it MUST support confirmed initiation and close down. </p>
<p id="rfc.section.Appendix A.17.p.3">PT-TCP meets this requirement.  The PT-TCP protocol is designed to operate over a TCP connection which is connection oriented and supports initiation and tear down of the connection.</p>
<p id="rfc.section.Appendix A.17.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods are based on EAP which provides both initiation and shutdown. </p>
<h1 id="rfc.appendix.Appendix A.18">
<a href="#rfc.appendix.Appendix%20A.18">Appendix A.18.</a> Evaluation Against Requirement PT-7</h1>
<p id="rfc.section.Appendix A.18.p.1">Requirement PT-7 states: </p>
<p id="rfc.section.Appendix A.18.p.2">PT-7 The PT protocol MUST be able to carry binary data. </p>
<p id="rfc.section.Appendix A.18.p.3">PT-TCP meets this requirement.  The PT-TCP protocol is capable of carrying binary data.</p>
<p id="rfc.section.Appendix A.18.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods are capable of carrying binary data.</p>
<h1 id="rfc.appendix.Appendix A.19">
<a href="#rfc.appendix.Appendix%20A.19">Appendix A.19.</a> Evaluation Against Requirement PT-8</h1>
<p id="rfc.section.Appendix A.19.p.1">Requirement PT-8 states: </p>
<p id="rfc.section.Appendix A.19.p.2">PT-8 The PT protocol MUST provide mechanisms for flow control and congestion control. </p>
<p id="rfc.section.Appendix A.19.p.3">PT-TCP meets this requirement.  The PT-TCP protocol operates over TCP which provides flow control and congestion control.</p>
<p id="rfc.section.Appendix A.19.p.4">EAP Tunnel methods meet this requirement.  The EAP Tunnel methods are based on EAP which, by use of the half-duplex, round-robin message exchange, flow and congestion control are provided.</p>
<h1 id="rfc.appendix.Appendix A.20">
<a href="#rfc.appendix.Appendix%20A.20">Appendix A.20.</a> Evaluation Against Requirement PT-9</h1>
<p id="rfc.section.Appendix A.20.p.1">Requirement PT-9 states: </p>
<p id="rfc.section.Appendix A.20.p.2">PT-9 The PT protocol specifications MUST describe the capabilities that they provide for and limitations that they impose on the PB protocol (e.g. half/full duplex, maximum message size). </p>
<p id="rfc.section.Appendix A.20.p.3">PT-TCP meets this requirement.  This specification has provided the required information.</p>
<p id="rfc.section.Appendix A.20.p.4">EAP Tunnel methods meet this requirement.  This specification has provided the required information.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nancy Cam-Winget</span> 
	  <span class="n hidden">
		<span class="family-name">Cam-Winget</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>80 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ncamwing@cisco.com">ncamwing@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Joseph Salowey</span> 
	  <span class="n hidden">
		<span class="family-name">Salowey</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>2901 Third Avenue</span>

	  <span class="vcardline">
		<span class="locality">Seattle</span>,  
		<span class="region">WA</span> 
		<span class="code">98121</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hao Zhou</span> 
	  <span class="n hidden">
		<span class="family-name">Zhou</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>4125 Highlander Parkway</span>

	  <span class="vcardline">
		<span class="locality">Richfield</span>,  
		<span class="region">OH</span> 
		<span class="code">44286</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:hzhou@cisco.com">hzhou@cisco.com</a></span>

  </address>
</div>

</body>
</html>