Network Working Group                                          G. Sisson
Internet-Draft                                                 B. Laurie
Expires: May 12, 2005                                            Nominet
                                                       November 11, 2004


            Derivation of DNS Name Predecessor and Successor
                  draft-sisson-dnsext-dns-name-p-s-00

Status of this Memo

   This document is an Internet-Draft and is subject to all provisions
   of section 3 of RFC 3667.  By submitting this Internet-Draft, each
   author represents that any applicable patent or other IPR claims of
   which he or she is aware have been or will be disclosed, and any of
   which he or she become aware will be disclosed, in accordance with
   RFC 3668.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on May 12, 2005.

Copyright Notice

   Copyright (C) The Internet Society (2004).

Abstract

   This document describes a method for deriving the canonically-ordered
   predecessor and successor of a DNS name.  This is expected to be
   useful for real-time NSEC resource record synthesis, which may be
   used in alterative implementations of DNSSEC-enabled DNS servers.






Sisson & Laurie           Expires May 12, 2005                  [Page 1]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Derivation of DNS Name Predecessor . . . . . . . . . . . . . .  3
   3.  Derivation of DNS Name Successor . . . . . . . . . . . . . . .  4
   4.  Notes  . . . . . . . . . . . . . . . . . . . . . . . . . . . .  4
     4.1   Possible Optimisation  . . . . . . . . . . . . . . . . . .  4
     4.2   Choice of Range  . . . . . . . . . . . . . . . . . . . . .  4
     4.3   Wild Card Considerations . . . . . . . . . . . . . . . . .  5
   5.  Examples . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
     5.1   Examples of Immediate Predecessors . . . . . . . . . . . .  6
     5.2   Examples of Immediate Successors . . . . . . . . . . . . .  8
   6.  Security Considerations  . . . . . . . . . . . . . . . . . . . 10
   7.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 10
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 10
   8.1   Normative References . . . . . . . . . . . . . . . . . . . . 10
   8.2   Informative References . . . . . . . . . . . . . . . . . . . 11
       Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . 11
       Intellectual Property and Copyright Statements . . . . . . . . 12
































Sisson & Laurie           Expires May 12, 2005                  [Page 2]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


1.  Introduction

   One of the proposals for avoiding the exposure of zone information
   while deploying DNSSEC is dynamic NSEC synthesis.  This technique is
   described briefly in [I-D.ietf-dnsext-dnssec-trans], and involves the
   generation of NSEC RRs which just span the query name for
   non-existent owner names.  In order to do this, the DNS names which
   would occur just prior to and just following a given query name must
   be calculated in real time, as maintaining a list of all possible
   owner names that might occur in a zone would normally be prohibitive.

   Section 6.1 of [I-D.ietf-dnsext-dnssec-records] defines canonical DNS
   name order.  This document does not amend or modify this definition.
   However, the derivation of immediate predecessor and successor, while
   trivial, is non-obvious.  Accordingly, the method is described here
   as an aid to implementors and a reference to other interested
   parties.

2.  Derivation of DNS Name Predecessor

   This derivation assumes that all upper-case US-ASCII letters in the
   DNS name have already been replaced by their corresponding lower-case
   equivalents.

   To derive the immediate predecessor of a DNS name:

   1.  If the DNS name is the same as the owner name of the apex,
       prepend it repeatedly with labels of the maximum length possible
       consisting of octets of the maximum sort value (e.g. 0xff) until
       the DNS name is the maximum length possible; otherwise continue
       to the next step.

   2.  If the least significant (left-most) label consists of a single
       octet of the minimum sort value (e.g. 0x00), remove it; otherwise
       continue to the next step.

   3.  If the least significant (right-most) octet in the least
       significant (left-most) label is the minimum sort value, remove
       that octet; otherwise decrement the value of the octet, skipping
       any values which correspond to upper-case US-ASCII letters, and
       then append the label with as many octets as possible of the
       maximum sort value.  In either case, continue to the next step.

   4.  Prepend the DNS name repeatedly with labels of as long a length
       as possible consisting of octets of the maximum sort value until
       DNS name is the maximum length possible.





Sisson & Laurie           Expires May 12, 2005                  [Page 3]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


3.  Derivation of DNS Name Successor

   This derivation assumes that all upper-case US-ASCII letters in the
   DNS name have already been replaced by their corresponding lower-case
   equivalents.

   To derive the immediate successor of a DNS name:

   1.  If the DNS name is two or more octets shorter than the maximum
       DNS name length, prepend the DNS name with a label containing a
       single octet of the minimum sort value (e.g. 0x00); otherwise
       continue to the next step.

   2.  If the DNS name is one or more octets shorter than the maximum
       DNS name length and the least significant (left-most) label is
       one or more octets shorter than the maximum label length, append
       an octet of the minimum sort value to the least significant
       label; otherwise continue to the next step.

   3.  Increment the value of the least significant (right-most) octet
       in the least significant (left-most) label that is less than the
       maximum sort value (e.g. 0xff), skipping any values which
       correspond to upper-case US-ASCII letters, and then remove any
       octets to the right of that one.  If all octets in the label are
       the maximum sort value, then continue to the next step.

   4.  Remove the least significant (left-most) label.  If the DNS name
       is now the same as the owner name of the apex, do nothing.  (This
       will occur only if the DNS name was the maximum possible in
       canonical DNS name order, and thus has wrapped to the apex.)
       Otherwise repeat starting at Step 2.


4.  Notes

4.1  Possible Optim
isation

   When the derivation of immediate predecessor is used only for the
   synthesis of NSEC RRs, step 1 of the derivation may be omitted as the
   existence of the owner name of the apex should never need to be
   denied.  This eliminates one condition that would otherwise always be
   tested during the derivation of the immediate predecessor.

4.2  Choice of Range

   RFC 2181 [RFC2181] makes the clarification that "any binary string
   whatever can be used as the label of any resource record".
   Consequently the minimum sort value may be set as 0x00 and the



Sisson & Laurie           Expires May 12, 2005                  [Page 4]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


   maximum sort value as 0xff, and the range of possible values will be
   any DNS name which contains octets of any value other than those
   corresponding to upper-case US-ASCII letters.

   However, if all owner names in a zone are in the letter-digit-hyphen,
   or LDH, format specified in RFC 1034 [RFC1034], it may be desirable
   to restrict the range of possible values to DNS names containing only
   LDH values.  This has the effect of:

   1.  making the output of tools such as `dig' and `nslookup' less
       potentially confusing;

   2.  minimising the impact that NSEC RRs containing DNS names with
       non-LDH values (or non-printable values) might have on faulty DNS
       resolver implementations; and

   3.  preventing the possibility of results which are wild card DNS
       names (see Section 4.3).

   This may be accomplished by using a minimum sort value of 0x1f
   (US-ASCII character `-') and a maximum sort value of 0x7a (US-ASCII
   character lower-case `z'), and then skipping non-LDH, non-lower-case
   values when incrementing or decrementing octets.

4.3  Wild Card Considerations

   Neither derivation avoids the possibility that the result may be a
   DNS name containing a wild card label, i.e. a label containing a
   single octet with the value 0x2a (US-ASCII character `*').  With
   additional tests, wild card DNS names may be explicitly avoided;
   alternatively, if the range of octet values can be restricted to
   those corresponding to letter-digit-hyphen, or LDH, characters (see
   Section 4.2), such DNS names will not occur.

   Note that it is improbable that a result which is a wild card DNS
   name will occur unintentionally; even if one does occur either as the
   owner name of, or in the RDATA of an NSEC RR, it is treated as a
   literal DNS name with no special meaning.

5.  Examples

   In the following examples:

      the owner name of the apex is "example.com.";

      the range of octet values is 0x00 - 0xff excluding values
      corresponding to upper-case US-ASCII letters; and




Sisson & Laurie           Expires May 12, 2005                  [Page 5]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


      non-printable octet values are expressed as three-digit octal
      numbers preceded by a backslash.


5.1  Examples of Immediate Predecessors

   Typical case:

      x  = foo.example.com.

      x' = \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377.\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377.\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377.fon\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377.exa\
           mple.com.

   Least significant (left-most) label of DNS name consists of a single
   octet of the minimum sort value:

      x  = \000.foo.example.com.

      x' = foo.example.com.

















Sisson & Laurie           Expires May 12, 2005                  [Page 6]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


   Least significant (right-most) octet of least significant (left-most)
   label has the minimum sort value:

      x  = foo\000.example.com.

      x' = \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377.\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377.\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377.\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377.foo.exa\
           mple.com.

   DNS name is the owner name of the apex, and consequently wraps to the
   DNS name with the maximum possible sort order in the zone.

      x  = example.com.

      x' = \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377.\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377.\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377.\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377.example.com.






Sisson & Laurie           Expires May 12, 2005                  [Page 7]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


5.2  Examples of Immediate Successors

   Typical case:

      y  = foo.example.com.

      y' = \000.foo.example.com.

   DNS name is one octet short of the maximum DNS name length:

      y  = foooooooooooooooooooooooooooooooooooooooooooooooo.oooooooooo\
           ooooooooooooooooooooooooooooooooooooooooooooooooooooo.oooooo\
           ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.oo\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\
           o.example.
com.

      y' = foooooooooooooooooooooooooooooooooooooooooooooooo\000.oooooo\
           ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.oo\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\
           o.oooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\
           ooooo.example.com.

   DNS name is the maximum DNS name length:

      y  = fooooooooooooooooooooooooooooooooooooooooooooooooo.ooooooooo\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooo.ooooo\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.o\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\
           oo.example.com.

      y' = foooooooooooooooooooooooooooooooooooooooooooooooop.ooooooooo\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooo.ooooo\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.o\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\
           oo.example.com.
















Sisson & Laurie           Expires May 12, 2005                  [Page 8]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


   DNS name is the maximum DNS name length and the least significant
   (left-most) label has the maximum sort value:

      y  = \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377.ooooooooooooooooooooooooooooooooooooooo\
           oooooooooooooooooooooooo.ooooooooooooooooooooooooooooooooooo\
           oooooooooooooooooooooooooooo.ooooooooooooooooooooooooooooooo\
           oooooooooooooooooooooooooooooooo.example.com.

      y' = oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\
           oop.oooooooooooooooooooooooooooooooooooooooooooooooooooooooo\
           ooooooo.oooooooooooooooooooooooooooooooooooooooooooooooooooo\
           ooooooooooo.example.com.

   DNS name is the maximum DNS name length and the eight least
   significant (right-most) octets of the least significant (left-most)
   label have the maximum sort value:

      y  = fooooooooooooooooooooooooooooooooooooooooo\377\377\377\377\
           \377\377\377\377.ooooooooooooooooooooooooooooooooooooooooooo\
           oooooooooooooooooooo.ooooooooooooooooooooooooooooooooooooooo\
           oooooooooooooooooooooooo.ooooooooooooooooooooooooooooooooooo\
           oooooooooooooooooooooooooooo.example.com.

      y' = foooooooooooooooooooooooooooooooooooooooop.ooooooooooooooooo\
           oooooooooooooooooooooooooooooooooooooooooooooo.ooooooooooooo\
           oooooooooooooooooooooooooooooooooooooooooooooooooo.ooooooooo\
           oooooooooooooooooooooooooooooooooooooooooooooooooooooo.examp\
           le.com.




















Sisson & Laurie           Expires May 12, 2005                  [Page 9]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


   DNS name has the maximum possible sort order in the zone, and
   consequently wraps to the owner name of the apex:

      y  = \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377.\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377.\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377.\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377\377\377\377\377\377\377\377\377\377\377\377\377\377\
           \377\377.example.com.

      y' = example.com.


6.  Security Considerations

   The derivation of some predecessors/successors requires the testing
   of more conditions than others.  Consequently the effectiveness of a
   denial-of-service attack may be enhanced by sending queries that
   require more conditions to be tested.

7.  IANA Considerations

   This document does not create any IANA considerations.

8.  References

8.1  Normative References

   [I-D.ietf-dnsext-dnssec-records]
              Arends, R., Austein, R., Larson, M., Massey, D. and S.
              Rose, "Resource Records for the DNS Security Extensions",
              draft-ietf-dnsext-dnssec-records-11 (work in progress),
              October 2004.

   [RFC1034]  Mockapetris, P., "Domain Names - Concepts and Facilities",
              STD 13, RFC 1034, November 1987.




Sisson & Laurie           Expires May 12, 2005                 [Page 10]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


   [RFC1035]  Mockapetris, P., "Domain Names - Implementation and
              Specification", STD 13, RFC 1035, November 1987.

   [RFC2181]  Elz, R. and R. Bush, "Clarifications to the DNS
              Specification", RFC 2181, July 1997.

8.2  Informative References

   [I-D.ietf-dnsext-dnssec-trans]
              Arends, R., Koch, P. and J. Schlyter, "Evaluating DNSSEC
              Transition Mechanisms", draft-ietf-dnsext-dnssec-trans-01
              (work in progress), October 2004.

   [RFC2026]  Bradner, S., "The Internet Standards Process -- Revision
              3", BCP 9, RFC 2026, October 1996.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2418]  Bradner, S., "IETF Working Group Guidelines and
              Procedures", BCP 25, RFC 2418, September 1998.


Authors' Addresses

   Geoffrey Sisson
   Nominet
   Sandford Gate
   Sandy Lane West
   Oxford  OX4 6LB
   GB

   Phone: +44 1865 332339
   EMail: geoff@nominet.org.uk


   Ben Laurie
   Nominet
   17 Perryn Road
   London  W3 7LR
   GB

   Phone: +44 20 8735 0686
   EMail: ben@algroup.co.uk







Sisson & Laurie           Expires May 12, 2005                 [Page 11]

Internet-Draft    draft-sisson-dnsext-dns-name-p-s-00      November 2004


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the inform
ation contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2004).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Sisson & Laurie           Expires May 12, 2005                 [Page 12]


