<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Better-Than-Nothing-Security: An Unauthenticated Mode of IPsec</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Better-Than-Nothing-Security: An Unauthenticated Mode of IPsec">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">NETWORK WORKING GROUP</td><td class="header">N. Williams</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Sun</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Richardson</td></tr>
<tr><td class="header">Expires: February 7, 2009</td><td class="header">SSW</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 06, 2008</td></tr>
</table></td></tr></table>
<h1><br />Better-Than-Nothing-Security: An Unauthenticated Mode of IPsec<br />draft-ietf-btns-core-07.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on February 7, 2009.</p>

<h3>Abstract</h3>

<p>This document specifies how to use the Internet Key
		Exchange (IKE) protocols, such as IKEv1 and IKEv2, to
		setup "unauthenticated" security associations (SAs) for
		use with the IPsec Encapsulating Security Payload (ESP)
		and the IPsec Authentication Header (AH).  No changes to
                IKEv2 bits-on-the-wire 
		are required, but Peer Authorization Database
		(PAD) and Security Policy Database (SPD) extensions are
		specified.  Unauthenticated IPsec is herein referred to
		by its popular acronym, "BTNS" (Better Than Nothing
		Security).
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">1.1.</a>&nbsp;
Conventions used in this document<br />
<a href="#core">2.</a>&nbsp;
BTNS<br />
<a href="#anchor3">3.</a>&nbsp;
Usage Scenarios<br />
<a href="#example_sgA">3.1.</a>&nbsp;
Example #1: A security gateway<br />
<a href="#anchor4">3.2.</a>&nbsp;
Example #2: A mixed end-system <br />
<a href="#anchor5">3.3.</a>&nbsp;
Example #3: A BTNS-only system<br />
<a href="#anchor6">3.4.</a>&nbsp;
Miscellaneous comments<br />
<a href="#anchor7">4.</a>&nbsp;
Security Considerations<br />
<a href="#anchor8">4.1.</a>&nbsp;
Connection-Latching and Channel Binding<br />
<a href="#lof">4.2.</a>&nbsp;
Leap-of-Faith (LoF) for BTNS<br />
<a href="#anchor9">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor10">6.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Here we describe how to establish unauthenticated IPsec
		SAs using IKEv2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> and
		unauthenticated public keys.  No new on-the-wire
		protocol elements are added to IKEv2.
</p>
<p>The <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> processing model is
		assumed.
</p>
<p>This document does not define an opportunistic BTNS mode
		of IPsec whereby nodes may fallback to unprotected IP
		when their peers do not support IKEv2, nor does it
		describe "leap-of-faith" modes, or "connection
		latching."
</p>
<p>See <a class='info' href='#I-D.ietf-btns-prob-and-applic'>[I&#8209;D.ietf&#8209;btns&#8209;prob&#8209;and&#8209;applic]<span> (</span><span class='info'>Touch, J., Black, D., and Y. Wang, &ldquo;Problem and Applicability Statement for Better Than Nothing Security  (BTNS),&rdquo; July&nbsp;2008.</span><span>)</span></a> for
		the applicability and uses of BTNS and definitions of
		these terms.
</p>
<p>This document describes BTNS in terms of IKEv2 and <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>'s concepts.  There is no reason
		why the same methods cannot be used with IKEv1 <a class='info' href='#RFC2408'>[RFC2408]<span> (</span><span class='info'>Maughan, D., Schneider, M., and M. Schertler, &ldquo;Internet Security Association and Key Management Protocol (ISAKMP),&rdquo; November&nbsp;1998.</span><span>)</span></a> <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a> and
		<a class='info' href='#RFC2401'>[RFC2401]<span> (</span><span class='info'>Kent, S. and R. Atkinson, &ldquo;Security Architecture for the Internet Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a>, however, those specifications
		do not include the PAD concepts, and therefore it may
		not be possible to implement BTNS on all compliant
		RFC2401 implementations.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
		    "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
		    and "OPTIONAL" in this document are to be interpreted as
		    described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="core"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
BTNS</h3>

<p>The IPsec processing model is hereby modified as follows:
		</p>
<ul class="text">
<li>A new ID type is added, 'PUBLICKEY'; IDs of this
			type have public keys as values.  This ID type
			is not used on the wire.
</li>
<li>PAD entries that match on PUBLICKEY IDs are
			referred to as "BTNS PAD entries."  All other
			PAD entries are referred to as "non-BTNS PAD
			entries."
</li>
<li>BTNS PAD entries may match on specific peer
			PUBLICKEY IDs (or public key fingerprints), or
			on all peer public keys.  The latter is referred
			to as the "wildcard BTNS PAD entry."
</li>
<li>BTNS PAD entries MUST logically (see below)
			follow all other PAD entries (the PAD being an
			ordered list).
</li>
<li>At most one wildcard BTNS PAD entry may appear in
			the PAD, and, if present, MUST be the last entry
			in the PAD (see below).
</li>
<li>Any peer that uses an IKEv2 AUTH method involving
			a digital signature (made with a private key to
			a public key cryptosystem) may match a BTNS PAD
			entry, provided that it matches no non-BTNS PAD
			entries.  Suitable AUTH methods as of August
			2007 are: RSA Digital Signature (method #1) and
			DSS Digital Signature (method #3); see <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, section 3.8.
</li>
<li>A BTNS capable implementation of IPsec will first
			search the PAD for non-BTNS entries matching a
			peer's ID.  If no matching non-BTNS PAD entries
			are found then the peer's ID MUST then be
			coerced to be of 'PUBLICKEY' type with the
			peer's public key as its value and the PAD  is
			then searched again for matching BTNS PAD
			entries.  This ensures that BTNS PAD entries
			logically follow non-BTNS PAD entries.  A single
			PAD search that preserves these semantics is
			allowed.
</li>
<li>A peer that matches a BTNS PAD entry is referred
			to as a "BTNS peer."  Such a peer is
			"authenticated" by verifying that the signature
			in its IKEv2 AUTH payload with the public key
			from the peer's CERT payload.
</li>
<li>Of course, if no matching PAD entry is found,
			then the IKE SA is rejected as usual.
</li>
<li>A new flag for SPD entries: 'BTNS_OK'.  Traffic
			to/from peers that match the BTNS PAD entry will
			match only SPD entries that have the BTNS_OK
			flag set.  The SPD may be searched by address or
			by ID (of type PUBLICKEY, for BTNS peers), as
			per the IPsec processing model <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>; searching by ID in this
			case requires creation of SPD entries that are
			bound to public key values (this could be used
			to build "leap-of-faith" <a class='info' href='#I-D.ietf-btns-prob-and-applic'>[I&#8209;D.ietf&#8209;btns&#8209;prob&#8209;and&#8209;applic]<span> (</span><span class='info'>Touch, J., Black, D., and Y. Wang, &ldquo;Problem and Applicability Statement for Better Than Nothing Security  (BTNS),&rdquo; July&nbsp;2008.</span><span>)</span></a>
			<a class='info' href='#lof'>Section&nbsp;4.2<span> (</span><span class='info'>Leap-of-Faith (LoF) for BTNS</span><span>)</span></a> behaviour, for
			example).
</li>
</ul><p>
	    
</p>
<p>Nodes MUST reject IKE_SA proposals from peers that match
		non-BTNS PAD entries but fail to authenticate
		properly.
</p>
<p>Nodes wishing to be treated as BTNS nodes by their peers
		MUST include bare public key CERT payloads.  Currently
		only bare RSA public key CERT payloads are defined,
		which means that BTNS works only with RSA public keys at
		this time (see "Raw RSA Key" in section 3.6 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>).  Nodes MAY also include any
		number of certificates that bind the same public key.
		These certificates need not to have been pre-shared with
		their peers (e.g., because ephermal, self-signed).  RSA
		keys for use in BTNS may be generated at any time, but
		"connection latching" <a class='info' href='#I-D.ietf-btns-connection-latching'>[I&#8209;D.ietf&#8209;btns&#8209;connection&#8209;latching]<span> (</span><span class='info'>Williams, N., &ldquo;IPsec Channels: Connection Latching,&rdquo; August&nbsp;2009.</span><span>)</span></a>
		requires that they remain constant between IKEv2
		exchanges that are used to establish SAs for latched
		connections.
</p>
<p>To preserve standard IPsec access control semantics:
		
		</p>
<ul class="text">
<li>BTNS PAD entries MUST logically follow all
			non-BTNS PAD entries
</li>
<li>the wildcard BTNS PAD entry MUST be the last
			entry in the PAD, logically
</li>
<li>the wildcard BTNS PAD entry MUST have ID
			constraints that do not logically overlap those
			of other PAD entries.
</li>
</ul><p>

	    
</p>
<p>As described above, the logical PAD ordering requirements
		can easily be implemented by searching the PAD twice at
		peer authentication time: once using the peer-asserted
		ID, and if that fails, once using the peer's public key
		as a PUBLICKEY ID.  A single pass implementation that
		meets this requirement is permitted.
</p>
<p>The BTNS entry ID constraint non-overlap requirement can
		easily be implemented by searching the PAD twice: once
		when BTNS peers authenticate, and again when BTNS peers
		negotiate child SAs.  In the first pass the PAD is
		searched for a matching PAD entry as described above,
		and in the second it is searched to make sure that BTNS
		peers' asserted child SA traffic selectors do not
		conflict with non-BTNS PAD entries.  Single pass
		implementations that preserve these semantics are
		feasible.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Usage Scenarios</h3>

<p>In order to explain the above rules a number of scenarios
		will be examined.  The goal here is to persuade the reader
		that the above rules are both sufficient and
		necessary.
</p>
<p>This section is informative only.
</p><br /><hr class="insert" />
<a name="networkdiagram"></a>

<p>
		    To explain the scenarios a reference diagram
		    describing an example network will be used. It is
		    as follows:
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                          [Q]  [R]
     AS1                   .    .              AS2
  [A]----+----[SG-A].......+....+.......[SG-B]-------[B]
                           ......               \
                           ..PI..                ----[btns-B]
                           ......
              [btns-C].....+....+.......[btns-D]
</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Reference Network Diagram&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In this diagram, there are six end-nodes: A, B, C and D.
		Two of the systems are security gateways: SG-A, SG-B,
		protecting networks on which [A] and [B] reside. There
		is a node [Q] which is IPsec and BTNS capable, and node
		[R] is a simple node, with no IPsec or BTNS capability.
		Nodes [C] and [D] are BTNS capable.
</p>
<p>Nodes [C] and [Q] have fixed addresses.  Node [D] has a
                non-fixed address.
</p>
<p> We will examine how these various nodes communicate with
                node SG-A, and/or how SG-A rejects communications with some
                such nodes.  In the first example, we examine SG-A's point of
                view. In the second example we look at Q's point of view.
                In the third example we look at C's point of view. 

</p>
<p>PI is the Public Internet ("The Wild").
</p>
<a name="example_sgA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Example #1: A security gateway</h3>

<p>The machine that we will care in this example is [SG-A], a
		    firewall device of some kind which we wish to
		    configure to respond to BTNS connections from
		    [C]. 
</p>
<p>SG-A has the following PAD and SPD entries: 
		    <br /><hr class="insert" />
<a name="sgA_pad"></a>

<p>
			
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                             Child SA
      Rule Remote ID        IDs allowed  SPD Search by
      ---- ---------        -----------  -------------
       1   &lt;B's ID&gt;         &lt;B's network&gt; by-IP
       2   &lt;Q's ID&gt;         &lt;Q's host&gt;     by-IP
       3   PUBLICKEY:any         ANY       by-IP
</pre></div>
<p>The last entry is the BTNS
			    entry.
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: SG-A PAD table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


		

<p>Note that [SG-A]'s PAD entry has one and only one
		    wildcard PAD entry: the BTNS catch-all PAD entry as
                    the last entry,
		    as described in <a class='info' href='#core'>Section&nbsp;2<span> (</span><span class='info'>BTNS</span><span>)</span></a>.
</p>
<p>&lt;Child SA IDs allowed&gt; and &lt;SPD Search
		    by&gt; are from <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> section
		    4.4.3
</p>
<p>
		    <br /><hr class="insert" />
<a name="sgA_spd"></a>

<p>
			
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Rule Local Remote Next Layer BTNS  Action
            addr  addr   Protocol   ok
      ---- ----- ------ ---------- ----  -----------------------
       1   [A]    [R]      ANY      N/A  BYPASS
       2   [A]    [Q]      ANY      no   PROTECT(ESP,tunnel,AES,
                                                     SHA256)
       3   [A]     B-net   ANY      no   PROTECT(ESP,tunnel,AES,
                                                     SHA256)
       4   [A]     ANY     ANY      yes  PROTECT(ESP,transport,
                                                     integr+conf)
</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: [SG-A] SPD table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

		

<p>The processing by [SG-A] of SA establishment attempts by various peers is as
		    follows:
		    </p>
<ul class="text">
<li>[Q] does not match PAD entry #1, but does match
			    PAD entry #2; PAD processing stops, then the
			    SPD is searched by [Q]'s ID to find entry #2;
			    CHILD SAs are then allowed that have [SG-A]'s
			    and [Q]'s addresses as the end-point
			    addresses.
</li>
<li>[SG-B] matches PAD entry #1; PAD processing
			    stops, then the SPD is searched by [SG-B]'s ID
			    to find SPD entry #3; CHILD SAs are then
			    allowed that have [SG-A]'s address and any
			    addresses from B's network as the end-point
			    addresses.
</li>
<li>[R] does not initiate any IKE SAs; its traffic
			    to [A] is bypassed by SPD entry #1.
</li>
<li>[C] does not match PAD entries #1 or #2, but
			    does match entry #3, the BTNS wildcard PAD
			    entry; the SPD is searched by [C]'s address
			    and SPD entry #4 is matched.  CHILD SAs are
			    then allowed that have [SG-A]'s address and [C]'s
			    address as the end-point addresses provided
			    that [C]'s address is neither [Q]'s nor any of
			    [B]'s (see <a class='info' href='#core'>Section&nbsp;2<span> (</span><span class='info'>BTNS</span><span>)</span></a>).  See the
			    last bullet item below.
</li>
<li>A rogue BTNS node attempting to assert [Q]'s or
			    [B]'s addresses will either match the PAD
			    entries for [Q] or [B] and fail to authenticate
			    as [Q] or [B], in which case they are rejected,
			    or they will match PAD entry #3 but will not
			    be allowed to create CHILD SAs with [Q]'s or
			    [B]'s addresses as traffic selectors.
</li>
<li>A rogue BTNS node attempting to establish an
			    SA whereby the rogue node asserts [C]'s
			    address will succeed at establishing such an
			    SA.  Protection for [C] requires additional
			    bindings of [C]'s specific BTNS ID (that is,
			    its public key) to its traffic flows through
			    connection-latching and channel binding, or
			    leap-of-faith, none of which are described
			    here.
</li>
</ul><p>
		
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Example #2: A mixed end-system </h3>

<p>[Q] is an NFSv4 server.
</p>
<p>[Q] is a native IPsec implementation, and it's
                    NFSv4 implementation is IPsec-aware.
</p>
<p>[Q] wants to protect all traffic with [A]. [Q] also wants
                    to protect NFSv4 traffice with all peers. It's PAD and
		    SPD are configured as follows:
		    <br /><hr class="insert" />
<a name="Q_pad"></a>

<p>
			
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                             Child SA
      Rule Remote ID        IDs allowed  SPD Search by
      ---- ---------        -----------  -------------
       1   &lt;[A]'s ID&gt;       &lt;[A]'s address&gt;  by-IP
       2   PUBLICKEY:any    ANY            by-IP
</pre></div>
<p>The last entry is the BTNS
			    entry.
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: [Q] PAD table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

		

<p>
		    <br /><hr class="insert" />
<a name="Q_spd"></a>

<p>
			
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Rule Local Remote Next Layer BTNS  Action
            addr  addr   Protocol   ok
      ---- ----- ------ ---------- ----  -----------------------
       1    [Q]    [A]     ANY      no   PROTECT(ESP,tunnel,AES,
                                                     SHA256)
       2    [Q]    ANY     ANY      yes  PROTECT(ESP,transport,
            with                                      integr+conf)
          port 2049
</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: [Q] SPD table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

		

<p>The same analysis shown above in <a class='info' href='#example_sgA'>Section&nbsp;3.1<span> (</span><span class='info'>Example #1: A security gateway</span><span>)</span></a> applies here with respect
		    to [SG-A], [C] and rogue peers.
                    The second SPD entry permits any BTNS capable node to
                    negotiate a port-specific SA to port 2049, the port on
                    which NFSv4 runs. 
                    Additionally
		    [SG-B] is treated as a BTNS peer as it is not known to
		    [Q], and therefore any host behind [SG-B] can access the
		    NFSv4 service on [Q]. As [Q] has no formal
		    relationship with [SG-B], rogues can impersonate
		    [B] (i.e., assert [B]'s addresses).
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Example #3: A BTNS-only system</h3>

<p>[C] supports only BTNS and wants to use BTNS to protect
		    NFSv4 traffic.  It's PAD and SPD are configured as
		    follows:
		    <br /><hr class="insert" />
<a name="C_pad"></a>

<p>
			
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                             Child SA
      Rule Remote ID        IDs allowed  SPD Search by
      ---- ---------        -----------  -------------
       1   PUBLICKEY:any    ANY          by-IP
</pre></div>
<p>The last (and only) entry is the BTNS
			    entry.
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Q PAD table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

		

<p>
		    <br /><hr class="insert" />
<a name="C_spd"></a>

<p>
			
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Rule Local Remote Next Layer BTNS  Action
            addr  addr   Protocol   ok
      ---- ----- ------ ---------- ----  -----------------------
       1    [C]    ANY      ANY      yes  PROTECT(ESP,transport,
                  with                               integr+conf)
                  port
                  2049

       2    [C]    ANY      ANY      N/A  BYPASS
</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: SG-A SPD table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

		

<p>The analysis from <a class='info' href='#example_sgA'>Section&nbsp;3.1<span> (</span><span class='info'>Example #1: A security gateway</span><span>)</span></a> applies as follows:
		    </p>
<ul class="text">
<li>Communication with [Q] on port 2049 matches
                            SPD entry number 1. This causes [C] to initiate
                            an IKEv2 exchange with [Q]. The PAD entry on [C]
                            causes it to not care what identity [Q]
                            asserts.  Further authentication (and channel
                            binding) could occur within the NFSv4 protocol.
                        
</li>
<li>Communication with [A], [B] or any other internet
                            machine (including [Q]), occurs in the clear,
                            so long as it is not
                            on port 2049.
</li>
<li>All analysis about rogue BTNS nodes applies, but 
                           they can only assert SAs for port 2049.
</li>
</ul><p>
                 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Miscellaneous comments</h3>

<p>If [SG-A] were not BTNS-capable then it would not have
		    PAD and SPD entries #3 and #4, respectively in example #1.  Then [C]
		    would be rejected as usual under the standard IPsec
		    model <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
</p>
<p>Similarly, if [Q] were not BTNS-capable then it would
		    not have PAD and SPD entries #2 in example #2.  Then [C] would be
		    rejected as usual under the standard IPsec model
		    <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>Unauthenticated security association negotiation is
		subject to MITM attacks and should be used with
		care.  Where security infrastructures are lacking this
		may indeed be better than nothing.
</p>
<p>Use with applications that bind authentication at
		higher network layers to secure channels at lower layers
		may provide one secure way to use unauthenticated IPsec,
		but this is not specified herein.
</p>
<p>The BTNS PAD entry must be last and its child SA ID constraints
               must be non-overlapping with any other PAD entry, as
               described in section 2, in order to ensure that no BTNS
               peer can impersonate another IPsec non-BTNS peer. 
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Connection-Latching and Channel Binding</h3>

<p>BTNS is subject to MITM attacks.  One way to protect
		    against MITM attacks subsequent to initial
		    communications is to use "connection latching" <a class='info' href='#I-D.ietf-btns-connection-latching'>[I&#8209;D.ietf&#8209;btns&#8209;connection&#8209;latching]<span> (</span><span class='info'>Williams, N., &ldquo;IPsec Channels: Connection Latching,&rdquo; August&nbsp;2009.</span><span>)</span></a>.
                    In connection latching, ULPs cooperate with IPsec
                    to bind discrete packet flows to
		    sequences of similar SAs. Connection latching requires
                    native IPsec implementations.
</p>
<p>MITMs can be detected by using application-layer
		    authentication frameworks and/or mechanisms, such as
		    the GSS-API <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>, with channel
		    binding <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.  IPsec "channels"
		    are nothing other than latched connnections.
</p>
<a name="lof"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Leap-of-Faith (LoF) for BTNS</h3>

<p>"Leap of faith" is the term generally used when a  
                    user accepts the assertion that a given key identifies a
		    peer on the first communication, despite a lack of strong
		    evidence for that assertion, and then remembers this association for future communications.
                    Specifically this is
		    a common mode of operation for Secure Shell <a class='info' href='#RFC4251'>[RFC4251]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Protocol Architecture,&rdquo; January&nbsp;2006.</span><span>)</span></a> client. When a server
		    is encountered for the first time the Secure Shell
                    client may ask
		    the user whether to accept the server's public key.
                    If so, records the server's name (as given by the user)
                    and public key in a database.
</p>
<p>Leap of faith can work in a similar way for BTNS
		    nodes, but it is currently still being designed and
		    specified by the IETF BTNS WG.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document has no IANA considerations, neither seeking
		to create new registrations nor new registries.  (The
		new ID type is not used on the wire, therefore it need
		not be assigned a number from the IANA IKEv2
		Identification Payload ID Types registry.)
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>Thanks for the following reviewers: Stephen Kent
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-btns-connection-latching">[I-D.ietf-btns-connection-latching]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-btns-connection-latching-11.txt">IPsec Channels: Connection Latching</a>,&rdquo; draft-ietf-btns-connection-latching-11 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-btns-connection-latching-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-btns-prob-and-applic">[I-D.ietf-btns-prob-and-applic]</a></td>
<td class="author-text">Touch, J., Black, D., and Y. Wang, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-btns-prob-and-applic-07.txt">Problem and Applicability Statement for Better Than Nothing Security  (BTNS)</a>,&rdquo; draft-ietf-btns-prob-and-applic-07 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-btns-prob-and-applic-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2401">[RFC2401]</a></td>
<td class="author-text"><a href="mailto:kent@bbn.com">Kent, S.</a> and <a href="mailto:rja@corp.home.net">R. Atkinson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2401">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;2401, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2401.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2401.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2401.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2408">[RFC2408]</a></td>
<td class="author-text"><a href="mailto:wdm@tycho.ncsc.mil">Maughan, D.</a>, <a href="mailto:mss@tycho.ncsc.mil">Schneider, M.</a>, and <a href="er@raba.com">M. Schertler</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2408">Internet Security Association and Key Management Protocol (ISAKMP)</a>,&rdquo; RFC&nbsp;2408, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2408.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2408.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2408.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2409">[RFC2409]</a></td>
<td class="author-text"><a href="mailto:dharkins@cisco.com">Harkins, D.</a> and <a href="mailto:carrel@ipsec.org">D. Carrel</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2409">The Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;2409, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2409.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2409.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2409.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4251">[RFC4251]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4251">The Secure Shell (SSH) Protocol Architecture</a>,&rdquo; RFC&nbsp;4251, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4251.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nicolas
	    Williams</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sun Microsystems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5300 Riata Trace Ct</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Austin, TX  78727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Nicolas.Williams@sun.com">Nicolas.Williams@sun.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Michael C.
	    Richardson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sandelman Software
		Works</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">470 Dawson Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ottawa, ON  K1Z
			5V7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcr@sandelman.ottawa.on.ca">mcr@sandelman.ottawa.on.ca</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.sandelman.ottawa.on.ca/">http://www.sandelman.ottawa.on.ca/</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
