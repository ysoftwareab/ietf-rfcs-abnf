<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Example of an ISP Web Notification System</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Example of an ISP Web Notification System">
<meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, XML, Extensible Markup Language, notification, Comcast, ISP, Internet Service Provider, bot remediation, bot notification">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">C. Chung</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">A. Kasyanov</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">J. Livingood</td></tr>
<tr><td class="header">Expires: December 8, 2010</td><td class="header">N. Mody</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Comcast</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. Van Lieu</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Unaffiliated</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 6, 2010</td></tr>
</table></td></tr></table>
<h1><br />Example of an ISP Web Notification System<br />draft-livingood-web-notification-07</h1>

<h3>Abstract</h3>

<p>The objective of this document is to describe a method of providing critical end user notifications to web browsers, which has been deployed by Comcast, an Internet Service Provider (ISP).  Such a notification system is being used to provide near-immediate notifications to customers, such as to warn them that their traffic exhibits patterns that are indicative of malware or virus infection.  There are other proprietary systems that can perform such notifications but these systems utilize Deep Packet Inspection (DPI) technology. In contrast to DPI, this document describes a system that does not rely upon DPI, and is instead based in open IETF standards and open source applications.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on December 8, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#ReqLang">1.</a>&nbsp;
Requirements Language<br />
<a href="#intro">2.</a>&nbsp;
Introduction<br />
<a href="#anchor1">3.</a>&nbsp;
High-Level Design of the System<br />
<a href="#requirements">4.</a>&nbsp;
Design Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#general-requirements">4.1.</a>&nbsp;
General Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#web-proxy-requirements">4.2.</a>&nbsp;
Web Proxy Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#icap-server-requirements">4.3.</a>&nbsp;
ICAP Server Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#messaging-service-requirements">4.4.</a>&nbsp;
Messaging Service Requirements<br />
<a href="#anchor2">5.</a>&nbsp;
Implementation Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#functional-components">5.1.</a>&nbsp;
Functional Components Described, As Implemented<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">5.2.</a>&nbsp;
Functional Diagram, As Implemented<br />
<a href="#anchor4">6.</a>&nbsp;
High Level Communication Flow, As Implemented<br />
<a href="#anchor5">7.</a>&nbsp;
Communication Between Web Proxy and ICAP Server, As Implemented<br />
<a href="#anchor6">8.</a>&nbsp;
End-to-End Web Notification Flow, As Implemented<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">8.1.</a>&nbsp;
Step-by-Step Description of the End-to-End Web Notification Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">8.2.</a>&nbsp;
Diagram of the End-to-End Web Notification Flow<br />
<a href="#anchor9">9.</a>&nbsp;
Example HTTP Headers and JavaScript for a Web Notification<br />
<a href="#anchor10">10.</a>&nbsp;
Deployment Considerations<br />
<a href="#anchor11">11.</a>&nbsp;
Security Considerations<br />
<a href="#anchor12">12.</a>&nbsp;
Debating The Necessity of Such a Critical Notification System<br />
<a href="#anchor13">13.</a>&nbsp;
Suggesting a Walled Garden As An Alternative<br />
<a href="#anchor14">14.</a>&nbsp;
Intended Next Steps<br />
<a href="#anchor15">15.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor16">16.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">17.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">17.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">17.2.</a>&nbsp;
Informative References<br />
<a href="#anchor19">Appendix&nbsp;A.</a>&nbsp;
Document Change Log<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="ReqLang"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Internet Service Providers (ISPs) have a need for a system that is capable of communicating with customers in a nearly immediate manner, to convey critical service notices such as warnings concerning likely malware infection. Given the prevalence of the web browser as the predominant client software in use by Internet users, the web browser is an ideal vehicle for providing these notifications. This document describes a system that has been deployed by Comcast, a broadband ISP, to provide near-immediate notifications to web browsers.
</p>
<p>In the course of evaluating potential solutions, the authors discovered that the large majority of commercially available systems utilized Deep Packet Inspection (DPI) technology.  While a DPI-based system would certainly work, this and other ISPs are trying to avoid widespread deployment and use of DPI, and are searching for alternatives.  Thus, Comcast desired to use a system based on open standards, non-proprietary software, and which MUST NOT require the use of DPI.  While the system described herein is specific to the Data-Over-Cable Service Interface Specifications (DOCSIS, <a class='info' href='#CableLabs DOCSIS'>[CableLabs DOCSIS]<span> (</span><span class='info'>CableLabs, &ldquo;Data-Over-Cable Service Interface Specifications,&rdquo; .</span><span>)</span></a>) networks used by most cable-based broadband ISPs, concepts described in this document can generally be applied to many different types of networks should those ISPs be interested in alternatives to DPI.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
High-Level Design of the System</h3>

<p>The web notification system design is based on the use of the Internet Content Adaptation Protocol <a class='info' href='#RFC3507'>[RFC3507]<span> (</span><span class='info'>Elson, J. and A. Cerpa, &ldquo;Internet Content Adaptation Protocol (ICAP),&rdquo; April&nbsp;2003.</span><span>)</span></a>.  The design uses open source applications, which are the Squid Web Proxy, GreasySpoon ICAP server, and Apache Tomcat.  The ICAP protocol, an existing IETF protocol, allows for message transformation or adaptation.  An ICAP client passes a HyperText Transport Protocol (HTTP, <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) response to an ICAP server for content adaption.  The ICAP Server in turn responds back to the client with the HTTP response containing the notification message by using the 'respmod' method defined in Section 3.2 of <a class='info' href='#RFC3507'>[RFC3507]<span> (</span><span class='info'>Elson, J. and A. Cerpa, &ldquo;Internet Content Adaptation Protocol (ICAP),&rdquo; April&nbsp;2003.</span><span>)</span></a>.
</p>
<a name="requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Design Requirements</h3>

<p>This section describes all of the key requirements taken into consideration by Comcast for the design of this system.  This information is provided in order to convey important design choices which were made in order to avoid the use of DPI, among other things.  An Additional Background section is included with each requirement to provide additional information, context, or other useful explanation.
</p>
<a name="general-requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
General Requirements</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>REQ1:</dt>
<dd>MUST Only Be Used for Critical Service Notifications
       					
       					Additional Background: The system MUST only provide critical notifications, rather than trivial notifications.  An example of a critical, non-trivial notification, which is also the primary motivation of this system, is to advise the user that their computer is infected with malware, that their security is at severe risk and/or has already been compromised, and that it is recommended that they take immediate, corrective action NOW.
</dd>
<dt>REQ2:</dt>
<dd>MUST Use TCP Port 80
       					
       					Additional Background: The system MUST provide notifications via TCP port 80, the well-known port for HTTP traffic. Since the large majority of customers use a web browser as their primary application, this was deemed the best method to provide them with an immediate, critical notification.
</dd>
<dt>REQ3:</dt>
<dd>MUST Support Block Listing
       					
       					Additional Background: While unlikely, since it is possible that the HyperText Markup Language (HTML, <a class='info' href='#RFC1866'>[RFC1866]<span> (</span><span class='info'>Berners-Lee, T. and D. Connolly, &ldquo;Hypertext Markup Language - 2.0,&rdquo; November&nbsp;1995.</span><span>)</span></a>) or JavaScript <a class='info' href='#RFC4329'>[RFC4329]<span> (</span><span class='info'>Hoehrmann, B., &ldquo;Scripting Media Types,&rdquo; April&nbsp;2006.</span><span>)</span></a> used for notifications may cause problems while accessing a particular website.  Therefore, such a system MUST be capable of using a block list of website Uniform Resource Indicators (URIs, <a class='info' href='#RFC2396'>[RFC2396]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifiers (URI): Generic Syntax,&rdquo; August&nbsp;1998.</span><span>)</span></a>) or Fully Qualified Domain Named (FQDNs, Section 5.1 of <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>) that conflict with the system, so that the system MUST NOT provide a notifications in these cases, in order to eliminate any errors or unexpected results. Also, while extensive development and testing has been performed to ensure that this system does not behave in unexpected ways, and the standard ICAP protocol which has been in use for many years is utilized, it is critical that if it does behave in such a way that there MUST be a method to rapidly except specific URIs or FQDNs.
</dd>
<dt>REQ4:</dt>
<dd>MUST NOT Cause Problems with Instant Messaging (IM) Clients Using TCP Port 80
       					
       					Additional Background: Some IM clients use TCP port 80 in their communications, often as an alternate port when standard, well-known ports do not work.  Other IM clients may in fact use TCP port 80 by default, in some cases even being based in a web browser.  Therefore, this system MUST NOT conflict with or cause unexpected results for IM clients (or any other client types) which use TCP port 80.
</dd>
<dt>REQ5:</dt>
<dd>MUST Handle Pre-Existing Active TCP Sessions Gracefully
       					
       					Additional Background: Since the web notification system may temporarily re-route TCP port 80 traffic in order to provide a critical notification, previously established TCP port 80 sessions MUST NOT be disrupted and MUST be routed to the proxy layer. Also, since the critical web notification occurs at a point in time, it is logical to conclude that an end user may well have an active TCP port 80 session in progress before the notification is sent, and which is still active at the time of the notification.  It is therefore important that any such connections MUST NOT be reset, and that they instead MUST be handled gracefully.
</dd>
<dt>REQ6:</dt>
<dd>MUST NOT Use TCP Resets
       					
       					Additional Background: The use of TCP resets has been widely criticized, both in the Internet community generally as well as in <a class='info' href='#RFC3360'>[RFC3360]<span> (</span><span class='info'>Floyd, S., &ldquo;Inappropriate TCP Resets Considered Harmful,&rdquo; August&nbsp;2002.</span><span>)</span></a>. In Comcast's recent history, for example, the company was criticized for using TCP resets in the course of operating a DPI-based network management system.  As such, TCP resets as a function of the system MUST NOT be used.
</dd>
<dt>REQ7:</dt>
<dd>MUST Be Non-Disruptive
       					
       					Additional Background: The web notification system MUST NOT disrupt the end user experience, such as causing significant clients errors.
</dd>
<dt>REQ8:</dt>
<dd>Notification Acknowledgement MUST Stop Further Immediate Notifications       					
       					
       					Additional Background: Once a user acknowledges a critical notification, the notification should immediately stop. Otherwise, the user may believe the system is stuck in an error state and may not believe that the critical notification is valid.  In addition, it is quite possible that the user will be annoyed that the system did not react to his acknowledgement.
</dd>
<dt>REQ9:</dt>
<dd>Non-Modification of Content SHOULD Be Maintained.
       					
       					Additional Background: The system SHOULD NOT significantly alter the content of the HTTP response from any website the user is accessing.
</dd>
<dt>REQ10:</dt>
<dd>MUST Handle Unexpected Content Gracefully
       					
       					Additional Background: Sometimes developers and/or implementers of software systems assume that a narrow range of inputs to a system will occur, all of which have been thought of beforehand by the designers.  The authors believe this is a poor assumption to make in the design and implementation of a system and, in contrast that unexpected or even malformed inputs SHOULD be assumed.  As a result, the system MUST gracefully and transparently handle traffic which is unexpected, and that there will be cases when the system cannot provide a critical web notification as a result of this.  Thus, widely varying content should be expected, and all such unexpected traffic MUST be handled by the system without generating user-perceived errors or unexpected results.
</dd>
<dt>REQ11:</dt>
<dd>Web Content MUST NOT Be Cached
       					
       					Additional Background: Maintaining the privacy of users important.  As such, content flowing through or incidentally observed the system MUST NOT be cached.
</dd>
<dt>REQ12:</dt>
<dd>Advertising Replacement or Insertion MUST NOT Be Performed Under ANY Circumstances
       					
       					Additional Background: The system MUST NOT be used to replace any advertising provided by a website, or insert advertising into websites.  This therefore includes both cases where a web page already has space for advertising, as well as cases where a web page does not have any advertising.  This is a critical area of concern for end users, privacy advocates, and other members of the Internet community.  Therefore it must be made abundantly clear that this system MUST NOT and SHALL NOT be used for such purposes.
</dd>
</dl></blockquote><p>
					
</p>
<a name="web-proxy-requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Web Proxy Requirements</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>REQ13:</dt>
<dd>Open-Source Software MUST Be Used
       					
       					Additional Background: The system MUST use an open source web proxy server.  (As noted later, Squid has been chosen.) While it is possible to use any web proxy, the use of open source enables others to easily access openly available documentation for the software, among the other benefits commonly attributed to the use of open source software which are also beneficial.
</dd>
<dt>REQ14:</dt>
<dd>ICAP Client SHOULD Be Integrated
       					
       					Additional Background: The web proxy server SHOULD have an integrated ICAP client, which simplifies the design and implementation of the system.
       					
</dd>
<dt>REQ15:</dt>
<dd>Access Control MUST Be Implemented
       					
       					Additional Background: Access to the proxy MUST be limited exclusively to the IP addresses of users for which notifications are intended, and only for limited periods of time. Furthermore, since a Session Management Broker (SMB) is utilized, as described in <a class='info' href='#functional-components'>Section&nbsp;5.1<span> (</span><span class='info'>Functional Components Described, As Implemented</span><span>)</span></a> below, then the proxy MUST restrict access only to the address of the SMB.
       					
</dd>
</dl></blockquote><p>
        			
</p>
<a name="icap-server-requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
ICAP Server Requirements</h3>

<p> 
					</p>
<blockquote class="text"><dl>
<dt>REQ16:</dt>
<dd>MUST Provide ICAP Response Support: 
       					
       					Additional Background: The system MUST support response adaptation, in accordance with <a class='info' href='#RFC3507'>[RFC3507]<span> (</span><span class='info'>Elson, J. and A. Cerpa, &ldquo;Internet Content Adaptation Protocol (ICAP),&rdquo; April&nbsp;2003.</span><span>)</span></a>. An ICAP client passes a HyperText Transport Protocol (HTTP, <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) response to an ICAP server for content adaption.  The ICAP Server in turn responds back to the client with the HTTP response containing the notification message by using the 'respmod' method defined in Section 3.2 of <a class='info' href='#RFC3507'>[RFC3507]<span> (</span><span class='info'>Elson, J. and A. Cerpa, &ldquo;Internet Content Adaptation Protocol (ICAP),&rdquo; April&nbsp;2003.</span><span>)</span></a>
</dd>
<dt>REQ17:</dt>
<dd>MUST Provide Consistency of Critical Notifications
       					
       					Additional Background: The system MUST be able to consistently provide a specific notification. For example, if a critical alert to notify a user that they are infected with malware is desired, then that notification should consistently look the same for all users and not vary.
</dd>
<dt>REQ18:</dt>
<dd>MUST Support Multiple Notification Types 
       					
       					Additional Background: While the initial and sole critical notification sent by the system is intended to alert users of a malware infection, malware is a rapidly and continuously evolving threat. As a result of this reality, the system must be able to evolve to provide different types of critical notifications.  For example, if malware begins to diverge into several different categories with substantially different implications for end users, then it MAY become desirable to provide a notification which has been narrowly tailored to each category of malware.
</dd>
<dt>REQ19:</dt>
<dd>MUST Support Notification to Multiple Users Simultaneously 
       					
       					Additional Background: The system MUST be able to simultaneously serve notifications to different users.  For example, if 100 users have been infected with malware and critically need to be notified about this security problem, then the system MUST be capable of providing the notification to several users at a time, or all of the users at the same time, rather that to just one user at a time.
       					
</dd>
</dl></blockquote><p>
        			
</p>
<a name="messaging-service-requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Messaging Service Requirements</h3>

<p>
				</p>
<blockquote class="text"><dl>
<dt>REQ20:</dt>
<dd>A Messaging Service MUST Be Used  
        				
       					Additional Background: The Messaging Service, as described in <a class='info' href='#functional-components'>Section&nbsp;5.1<span> (</span><span class='info'>Functional Components Described, As Implemented</span><span>)</span></a> below, caches the notifications for each specific user.  Thus, the notification messages are cached by the system rather than having to retrieve them each time a notification is needed.  As a result, the system can be more easily scaled to provide notification to multiple users simultaneously, as noted in an earlier requirement (MUST Support Notification to Multiple Users Simultaneously).
</dd>
<dt>REQ21:</dt>
<dd>MUST Process Acknowledgements On a Timely Basis
       					
       					Additional Background: The Messaging Service MUST quickly process notification acknowledgements by end users, as noted in an earlier requirement (Notification Acknowledgement MUST Stop Further Immediate Notifications).
</dd>
<dt>REQ22:</dt>
<dd>MUST Ensure Notification Targeting Accuracy
       					
       					Additional Background: The Messaging Service MUST ensure that notifications are presented to the intended users.  For example, if the system intends to provide a critical notification to User A and User B, but not User C, then User C MUST NOT be sent a notification.
</dd>
<dt>REQ23:</dt>
<dd>SHOULD Keep Notification Records for Customer Support Purposes
       					
       					Additional Background: The Messaging Service SHOULD maintain some type of record that a notification being sent to a user, in case that user inquires with customer support personnel.  For example, when a user is presented with the critical notification advising them of a malware infection, that user may choose to call Comcast's Customer Security Assurance team, in the customer service organization.  As a result, a Customer Security Assurance representative should be able to confirm that the user did in fact receive a notification concerning malware infection in the course of providing assistance to the end user in remediating the malware infection.
</dd>
</dl></blockquote><p>
        			
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Implementation Details</h3>

<p>This section defines and documents the various core functional components of the system, as they are implemented.  These components are then shown in a diagram to describe how the various components are linked and relate to one another.
</p>
<a name="functional-components"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Functional Components Described, As Implemented</h3>

<p>This section accurately and transparently describes the software packages used by the system described herein, as well as all of the details of how the system functions.  The authors acknowledge that there may be multiple alternative software choices for each component; the purpose of this section is to describe those selections which have been made and deployed.  
				</p>
<blockquote class="text"><dl>
<dt>5.1.A.</dt>
<dd>Web Proxy: The system SHOULD use and does use Squid Proxy, an open source web proxy application in wide use, and one which supports an integrated ICAP client.
</dd>
<dt>5.1.B.</dt>
<dd>ICAP Server: The system SHOULD use and does use GreasySpoon, an open source application. The ICAP Server retrieves the notifications from the Messaging service cache when content adaption is needed.
</dd>
<dt>5.1.C.</dt>
<dd>Customer Database:  The Customer Database SHOULD hold the relevant information that the system needs to provide a critical notification to a given user. The database MAY also hold the status of which users were notified and users which are pending notification.
</dd>
<dt>5.1.D.</dt>
<dd>Messaging Service: The system SHOULD use and does use Apache Tomcat, an open source application.  This is a process engine that retrieves specific web notification messages from a catalog of possible notifications.  While only one notification is currently used, concerning malware infection, as noted in <a class='info' href='#icap-server-requirements'>Section&nbsp;4.3<span> (</span><span class='info'>ICAP Server Requirements</span><span>)</span></a> the system MAY eventually need to provide multiple notifications (the specific requirement is MUST Support Multiple Notification Types).  When a notification for a specific user is not in cache, the process retrieves this information from the Customer Database and populates the cache for a specific period of time. 
</dd>
<dt>5.1.E.</dt>
<dd>Session Management Broker (SMB): A Load Balancer (LB) with a customized layer 7 inspection policy SHOULD be and is used to differentiate between HTTP and non-HTTP traffic on TCP port 80, in order to meet the requirements documented in <a class='info' href='#requirements'>Section&nbsp;4<span> (</span><span class='info'>Design Requirements</span><span>)</span></a> above.  The system uses a LB from A10 Networks. The SMB functions as a full stateful TCP proxy with the ability to forward packets from existing TCP sessions that do not exist in the internal session table (to meet the specific requirement MUST Handle Pre-Existing Active TCP Sessions Gracefully). New HTTP sessions are load balanced to the web proxy layer either transparently or using source Network Address Translation (NAT <a class='info' href='#RFC1631'>[RFC1631]<span> (</span><span class='info'>Egevang, K. and P. Francis, &ldquo;The IP Network Address Translator (NAT),&rdquo; May&nbsp;1994.</span><span>)</span></a>) from the SMB. Non-HTTP traffic for established TCP sessions not in the SMB session table is simply forwarded to the destination transparently via the TCP proxy layer (again, to meet the specific requirement MUST Handle Pre-Existing Active TCP Sessions Gracefully).
</dd>
</dl></blockquote><p>
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Functional Diagram, As Implemented</h3>
<br /><hr class="insert" />
<a name="Web Notification System - Functional Components"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

+--------+        +------------+        +----------+
|  ICAP  | &lt;----&gt; | Messaging  | &lt;----&gt; | Customer |
| Server |        |  Service   |        | Database |
+--------+        +------------+        +----------+
  ^
  |                +----------+
  |                |          |
  |      +-------&gt; | Internet | &lt;-------+
  |      |         |          |         |
  |      |         +----------+         |
  |      |              ^               |
  v      v              |               |
+----------+            v               v
|+--------+|        +-------+       +--------+
||  ICAP  || &lt;----&gt; |  SMB  | &lt;---&gt; | Access |
|| Client ||        +-------+       | Router |
|+--------+|                        +--------+
|| SQUID  ||                            ^
|| Proxy  ||                            |
|+--------+|                            v
+----------+                       +----------+
                                   |  CMTS*   |
                                   +----------+
                                       ^
                                       |
                                       v
                                    +------+
                                    |  PC  |
                                    +------+

 * A Cable Modem Termination System (CMTS)
   is an access network element.


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Web Notification System - Functional Components&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
High Level Communication Flow, As Implemented</h3>

<p>
				</p>
<blockquote class="text"><dl>
<dt>6.A.</dt>
<dd>Setup Differentiated Services (DiffServ): Using DiffServe <a class='info' href='#RFC2474'>[RFC2474]<span> (</span><span class='info'>Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers,&rdquo; December&nbsp;1998.</span><span>)</span></a> <a class='info' href='#RFC2475'>[RFC2475]<span> (</span><span class='info'>Blake, S., Black, D., Carlson, M., Davies, E., Wang, Z., and W. Weiss, &ldquo;An Architecture for Differentiated Services,&rdquo; December&nbsp;1998.</span><span>)</span></a> <a class='info' href='#RFC2597'>[RFC2597]<span> (</span><span class='info'>Heinanen, J., Baker, F., Weiss, W., and J. Wroclawski, &ldquo;Assured Forwarding PHB Group,&rdquo; June&nbsp;1999.</span><span>)</span></a> <a class='info' href='#RFC3140'>[RFC3140]<span> (</span><span class='info'>Black, D., Brim, S., Carpenter, B., and F. Le Faucheur, &ldquo;Per Hop Behavior Identification Codes,&rdquo; June&nbsp;2001.</span><span>)</span></a> <a class='info' href='#RFC3246'>[RFC3246]<span> (</span><span class='info'>Davie, B., Charny, A., Bennet, J., Benson, K., Le Boudec, J., Courtney, W., Davari, S., Firoiu, V., and D. Stiliadis, &ldquo;An Expedited Forwarding PHB (Per-Hop Behavior),&rdquo; March&nbsp;2002.</span><span>)</span></a> <a class='info' href='#RFC3260'>[RFC3260]<span> (</span><span class='info'>Grossman, D., &ldquo;New Terminology and Clarifications for Diffserv,&rdquo; April&nbsp;2002.</span><span>)</span></a> <a class='info' href='#RFC4594'>[RFC4594]<span> (</span><span class='info'>Babiarz, J., Chan, K., and F. Baker, &ldquo;Configuration Guidelines for DiffServ Service Classes,&rdquo; August&nbsp;2006.</span><span>)</span></a>, set a policy to direct TCP port 80 traffic to the web notification system's web proxy.
</dd>
<dt>6.B.</dt>
<dd>Session Management:  TCP port 80 packets are routed to a Session Management Broker which distinguishes between HTTP or non-HTTP traffic and between new and existing sessions. HTTP packets are forwarded to the web proxy by the SMB. Non-HTTP packets such as instant messaging (IM) traffic are forwarded to a TCP proxy layer for routing to destination or the SMB operates as the full TCP proxy and forwards the non-HTTP packets to the destination. Pre-established TCP sessions on port 80 are identified by the SMB and forwarded with no impact.
</dd>
<dt>6.C.</dt>
<dd>Web Proxy Forwards Request: The web proxy forwards the HTTP request on to the destination site, a web server, as a web proxy normally would do.
</dd>
<dt>6.D.</dt>
<dd>On Response, Send Message to ICAP Server: When the HTTP response is received from the destination server, the web proxy sends a message to the ICAP server for the web notification.
</dd>
<dt>6.E.</dt>
<dd>Messaging Service: The Messaging Service should respond with appropriate notification content or null response if notification is not cached.
</dd>
<dt>6.F.</dt>
<dd>ICAP Server Responds: The ICAP server responds and furnishes the appropriate content for the web notification to the web proxy.
</dd>
<dt>6.G.</dt>
<dd>Web Proxy Sends Response: The web proxy then forwards the HTTP response to the client web browser containing the web notification.
</dd>
<dt>6.H.</dt>
<dd>User Response: The user observes the critical web notification, and clicks an appropriate option, such as: OK/acknowledged, snooze/remind me later, etc.
</dd>
<dt>6.I.</dt>
<dd>More Information: Depending upon the notification, the user may be provided with more information. For example, as noted previously herein, the system was designed to provide critical notifications concerning malware infection.  Thus, in the case of malware infection, the user may be advised to go to a malware remediation web page that provides directions on how to attempt to remove the malware and attempt to secure hosts against future malware infection.
</dd>
<dt>6.J.</dt>
<dd>Turn Down DiffServ: Once the notification transaction has completed, remove any special DiffServ settings.
</dd>
</dl></blockquote><p>
        		
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Communication Between Web Proxy and ICAP Server, As Implemented</h3>
<br /><hr class="insert" />
<a name="Communication Between Web Proxy and ICAP Server"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+------------+
|  www URI   |
+------------+
   ^      |
(2)|      |(3)
   |      v
  +--------+     (4)     +--------+     (4)     +--------+
  |        |------------&gt;|        |------------&gt;|        |
  |        |     (5)     |        |     (5)     |        |
  | Proxy  |&lt;------------|  ICAP  |&lt;------------|  ICAP  |
  | Module |     (6)     | Client |     (6)     | Server |
  |        |------------&gt;|        |------------&gt;|        |
  |        |     (7)     |        |     (7)     |        |
  |        |&lt;------------|        |&lt;------------|        |
  +--------+             +--------+             +--------+
   ^      |
(1)|      |(8)
   |      v
+------------+              (9)             +------------+
|            |-----------------------------&gt;|            |
|  Browser   |              (10)            | Web Server |
|            |&lt;-----------------------------|            |
+------------+                              +------------+

(1) - HTTP GET (TCP 80)
(2) - Proxy HTTP GET (TCP 80)
(3) - HTTP 200 OK w/ Response
(4) - ICAP RESPMOD
(5) - ICAP 200 OK
(6) - TCP Stream - Encapsulate Header
(7) - ICAP 200 OK Insert Message
(8) - HTTP 200 OK w/ Response + Message Frame
(9) - HTTP GET for Message
(10) - HTTP 200 w/ Message Content
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Communication Between Web Proxy and ICAP Server&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
End-to-End Web Notification Flow, As Implemented</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Step-by-Step Description of the End-to-End Web Notification Flow</h3>

<p>8.1.1. Policy-Based Routing
</p>
<p>
			</p>
<ol class="text">
<li>TCP port 80 packets from the user that needs to be notified are routed to the Web Proxy via policy based routing.
</li>
<li>Packets are forwarded to the Session Management Broker, which establishes a session with the Web Proxy and routes the packets to the Web Proxy.
</li>
</ol><p>
	    	
</p>
<p>8.1.2. Web Proxy
</p>
<p>
            </p>
<ol class="text">
<li>The user's HTTP request is directed to the Web Proxy.
</li>
<li>The Web Proxy receives HTTP traffic and retrieves content from the requested web site.
</li>
<li>The Web Proxy receives the response and forwards it to the ICAP Server for response adaptation.
</li>
<li>The ICAP Server checks the HTTP content in order to determine whether notification message can be inserted.
</li>
<li>The ICAP Server initiates a request to the Messaging Service cache process with the IP address of the user.
</li>
<li>If a notification message for the user exists then the appropriate notification is cached on the Messaging Service.  The Messaging Service then returns the appropriate notification content to the ICAP Server.
</li>
<li>Once the notification message is retrieved from Messaging Service cache the ICAP server may insert the notification message in the HTTP response body without altering or modifying the original content of the HTTP response.
</li>
<li>The ICAP Server then sends the response back to the Web Proxy, which in turn forwards the HTTP response back to the browser.
</li>
<li>If the user's IP address is not found or provisioned for a notification message, then the ICAP Server should return a '204 No Modifications Needed' response to the ICAP Client as defined in section 4.3.3 of <a class='info' href='#RFC3507'>[RFC3507]<span> (</span><span class='info'>Elson, J. and A. Cerpa, &ldquo;Internet Content Adaptation Protocol (ICAP),&rdquo; April&nbsp;2003.</span><span>)</span></a>. As a result, the user will not receive any web notification message. 
</li>
<li>The user observes the web notification, and clicks an appropriate  option, such as: OK/acknowledged, snooze/ remind me later, etc.
</li>
</ol><p>
        	
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Diagram of the End-to-End Web Notification Flow</h3>

<p>The two figures below show the communications flow from the Web Browser, through the Web Notification System.
</p>
<p>The first figure below illustrates what occurs when a notification request cannot be inserted because the notification type for the user's IP address is not cached in the Messaging Service.
</p><br /><hr class="insert" />
<a name="End-to-End Web Notification Flow - With Cache Miss"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                         ICAP     ICAP    Message          Customer
      Browser   Proxy   Client   Server   Service  Internet    DB
        |  HTTP  |         |         |        |        |        |
        |  GET   | Proxy   |         |        |        |        |
        +-------&gt;| Request |         |        |        |        |
        |        +---------|---------|--------|-------&gt;|        |
        |        |         |         |        | 200 OK |        |
        |        |&lt;--------|---------|--------|--------+        |
        |        | ICAP    |         |        |        |        |
        |        | RESPMOD | ICAP    |        |        |        |
        |        +--------&gt;| RESPMOD | Check  |        |        |
        |        |         +--------&gt;| Cache  |        |        |
        |        |         |         | for IP |        |        |
        |        |         |         | Match  |        |        |
        |        |         |         +-------&gt;|        |        |
        |        |         |         | Cache  |        |        |
        |        |         |         | Miss   |        |        |
        |        |         |         |&lt;-------+ Request|        |
        |        |         | 204 No  |        | Type   |        |
        |        |         | Modif.  |        +--------|-------&gt;|
       	|        |         | Needed  |        |        |        |
        |        | No      |&lt;--------+        |        | Type   |
        |        | Insert  |         |        |        |Returned|
        | 200 OK |&lt;--------+         |        |&lt;-------|--------+
        | w/o    |         |         |        |        |        |
        | Insert |         |         |        |        |        |
        |&lt;-------+         |         |        |        |        |
        |        |         |         |        |        |        |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: End-to-End Web Notification Flow - With Cache Miss&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The figure below illustrates what occurs when a notification request for the user's IP address is cached in the Messaging Service.
</p><br /><hr class="insert" />
<a name="End-to-End Web Notification Flow - With Cache Hit"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                         ICAP     ICAP    Message          Customer
      Browser   Proxy   Client   Server   Service  Internet    DB
        |  HTTP  |         |         |        |        |        |
        |  GET   | Proxy   |         |        |        |        |
        +-------&gt;| Request |         |        |        |        |
        |        +---------|---------|--------|-------&gt;|        |
        |        |         |         |        | 200 OK |        |
        |        |&lt;--------|---------|--------|--------+        |
        |        | ICAP    |         |        |        |        |
        |        | RESPMOD | ICAP    |        |        |        |
        |        +--------&gt;| RESPMOD | Check  |        |        |
        |        |         +--------&gt;| Cache  |        |        |
        |        |         |         | for IP |        |        |
        |        |         |         | Match  |        |        |
        |        |         |         +-------&gt;|        |        |
        |        |         |         | Cache  |        |        |
        |        |         |         | Hit    |        |        |
        |        |         | Insert  |&lt;-------+        |        |
        |        | Return  | Type    |        |        |        |
        |        | 200 OK  |&lt;--------+        |        |        |
        |        | with    |         |        |        |        |
        |        | Insert  |         |        |        |        |
        | 200 OK |&lt;--------+         |        |        |        |
        | w/     |         |         |        |        |        |
        | Notify |         |         |        |        |        |
        |&lt;-------+         |         |        |        |        |
        |        |         |         |        |        |        |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: End-to-End Web Notification Flow - With Cache Hit&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Example HTTP Headers and JavaScript for a Web Notification</h3>

<p>The figure below shows an example of a normal HTTP GET request from the user's web browser to www.example.com, a web server on the Internet.
</p><br /><hr class="insert" />
<a name="Example HTTP Headers for a Web Notification - HTTP Get"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
------------------------------------------------------------------------
1.  HTTP Get Request to www.example.com
------------------------------------------------------------------------
http://www.example.com/

GET / HTTP/1.1
Host: www.example.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.14)
        Gecko/20080404 Firefox/2.0.0.14
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Pragma: no-cache
------------------------------------------------------------------------
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Example HTTP Headers for a Web Notification - HTTP Get&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In the figure below, the traffic is routed via the Web Proxy, which communicates with the ICAP Server and returns the response from www.example.com. In this case that response is a 200 OK, with the desired notification message inserted.
</p><br /><hr class="insert" />
<a name="Example HTTP Headers for a Web Notification - HTTP Response"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
------------------------------------------------------------------------
2.  Response from www.example.com via PROXY
------------------------------------------------------------------------
HTTP/1.x 200 OK
Date: Thu, 08 May 2008 16:26:29 GMT
Server: Apache/2.2.3 (CentOS)
Last-Modified: Tue, 15 Nov 2005 13:24:10 GMT
Etag: "b80f4-1b6-80bfd280"
Accept-Ranges: bytes
Content-Length: 438
Connection: close
Content-Type: text/html; charset=UTF-8
Age: 18
X-Cache: HIT from localhost.localdomain
Via: 1.0 localhost.localdomain (squid/3.0.STABLE5)
Proxy-Connection: keep-alive
------------------------------------------------------------------------
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Example HTTP Headers for a Web Notification - HTTP Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The figure below shows an example of the web notification content inserted in the 200 OK response, in this example JavaScript code.
</p><br /><hr class="insert" />
<a name="Example JavaScript Used in a Web Notification"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
------------------------------------------------------------------------
3.  Example of JavaScript containing Notification Insertion
------------------------------------------------------------------------
&lt;!--all elements used in a notification should have css properties
defined to avoid unwanted inheritance from parent page--&gt;
&lt;style type="text/css"&gt;
#example {
  position: absolute; left: 100px; top: 50px;
  z-index: 9999999; height: auto; width: 550px;
  padding: 10px;
  border: solid 2px black;
  background-color:#FDD017;
  opacity: 0.8; filter: alpha(opacity = 80);
}
&lt;/style&gt;

&lt;script language="javascript" type="text/javascript"&gt;
// ensure that content is not part of an iframe
if (self.location == top.location) {
  // this is a floating div with 80% transparency
  document.write('&lt;div id="example" name="example"&gt;');
  document.write('&lt;h2&gt;IMPORTANT MESSAGE&lt;/h2&gt;');
  document.write('&lt;p&gt;Lorem ipsum dolor sit amet, consecteteur ');
  document.write('adipisicing elit, sed do eiusmod tempor ');
  document.write('incididunt ut labore et dolore magna aliqua. ');
  document.write('Ut enim ad minim veniam, quis nostrud ');
  document.write('exercitation ullamco laboris nisi ut aliquip ex ');
  document.write('ea commodo consequat.');
  document.write('&lt;/div&gt;');
}&lt;/script&gt;
------------------------------------------------------------------------
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Example JavaScript Used in a Web Notification&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Deployment Considerations</h3>

<p>The components of the web notification system SHOULD be distributed throughout the network and close to end users.  This ensures that the routing performance and the user's web browsing experience remains excellent. In addition, a HTTP-aware load balancer SHOULD used in each datacenter where servers are located, so that traffic can be spread across N+1 servers and the system can be easily scaled.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>This critical web notification system was conceived in order to provide an additional method of notifying end user customers that their computer has been infected with malware.  Depending upon the specific text of the notification, users could fear that it is some kind of phishing attack.  As a result, care SHOULD and has been taken with the text and any links contained in the web notification itself.  For example, should the notification text change over time, it MAY be best to provide a general URI or a telephone number.  In contrast to that, the notification MUST NOT ask for login credentials, and MUST NOT ask a user to follow a link in order to change their password, since these are common phishing techniques.  Finally, care SHOULD be taken to provide confidence that the web notification is valid and from a trusted party, and/or that the user has an alternate method of checking the validity of the web notification.  One alternate method of validating the notification may be to call customer support, in this example to call Comcast's Customer Security Assurance team, which explains a key requirement (specifically, SHOULD Keep Notification Records for Customer Support Purposes) in <a class='info' href='#messaging-service-requirements'>Section&nbsp;4.4<span> (</span><span class='info'>Messaging Service Requirements</span><span>)</span></a> above.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Debating The Necessity of Such a Critical Notification System</h3>

<p>Some members of the community may question whether it is ever, under any circumstances, acceptable to modify Internet content in order to provide critical service notification concerning malware infection - even in the smallest of ways, even if openly and transparently documented, even if thoroughly tested, and even if for the best of motivations.  It is important that anyone with such concerns recognize that this document is by no means the first to propose this, particularly as a tactic to combat a security problem, and in fact simply leverages previous work in the IETF, such as <a class='info' href='#RFC3507'>[RFC3507]<span> (</span><span class='info'>Elson, J. and A. Cerpa, &ldquo;Internet Content Adaptation Protocol (ICAP),&rdquo; April&nbsp;2003.</span><span>)</span></a>.  Such concerned parties should also study the many organizations using ICAP and the many software systems which have implemented ICAP.
</p>
<p>In addition, concerned members of the community should review <a class='info' href='#intro'>Section&nbsp;2<span> (</span><span class='info'>Introduction</span><span>)</span></a> which describes the fact that this is a common feature of DPI systems, made by DPI vendors and many, if not most, major networking equipment vendors. As the authors describe herein, they are motivated to AVOID the need for widespread, ubiquitous deployment of DPI, via the use of both open source software and open protocols, and are further motivated to transparently describe the details of how such a system functions, what it IS intended to do, what it IS NOT intended to do, and purposes for which it WILL NOT be used.
</p>
<p>The authors also believe it is important for ISPs to transparently disclose network management techniques and systems, and to have a venue to do so, as has been done here.  In addition, the authors believe it is important for the IETF and other members of the Internet community encourage and positively reinforce such disclosures. In the publishing of such a document for reference and comment by the Internet community, this may serve to motivate other ISPs to be similarly open and to engage the IETF and other organizations that are part of the Internet community. Members of the community that argue that documents such as this have no value may wish to consider that such a viewpoint could have unintended effects, such as motivating less disclosure on the part of ISPs and other members of the Internet community, increased rather than decreased use of DPI, and decreased rather than increased participation in the critical technical bodies that make up parts of the Internet community.
</p>
<p>In addition, it is critical that members of the community recognize the good motivations of ISPs like Comcast to combat the massive and continuing proliferation malware, which is a huge threat to the security of average Internet users and now represents a multi-billion-dollar underground economy engaged in identity theft, financial fraud, transmission of spam, and other criminal activity.  Such a critical notification system in fact is only necessary due to the failure of host-based security at defending against and preventing malware infection.  As such, ISPs such as Comcast are being urged by their customers and by other parties such as security and/or privacy organizations, as well as governmental organizations, to take action to help solve this massive problem since so many other tactics have been unsuccessful.  For example, as Howard Schmidt, the Special Advisory for Cyber Security to President Obama, of the United States of America, was recently quoted: "As attacks on home-based and unsecured networks become as prevalent as those against large organizations, the need for ISPs to do everything they can to make security easier for their subscribers is critical for the preservation of our nation's information backbone. Additionally, there is tremendous potential to grow further the use of broadband around the world; and making safety and security part of an ISP's core offering will enable the end user to fully experience the rich and robust benefits broadband provides."
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Suggesting a Walled Garden As An Alternative</h3>

<p>A walled garden refers to an environment that controls the information and services that a subscriber is allowed to utilize and what network access permissions are granted. Placing a user in a walled garden is therefore another approach that ISPs may take to notify users, and this method is being explored as a possible alternative in other documents and community efforts.  As such, web notifications should be considered one of many possible notification methods which merits documentation.
</p>
<p>However, a walled garden approach can pose challenges and may in some cases be considered disruptive to end users. For example, a user could be playing a game online, via the use of a dedicated, Internet-connected game console, which would likely stop working when the user was placed in the walled garden. In another example, the user may be in the course of a telephone conversation, using a Voice Over IP (VoIP) device of some type, which would also likely stop working when the user was placed in the walled garden. In both cases, the user is not using a web browser and would not have a way to determine the reason why their service seemingly stopped working.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Intended Next Steps</h3>

<p>Unfortunately, no existing working group of the IETF is focused on issues of malware infection and related issues.  As a result, there is not a definite venue for this document so this has been submitted to the RFC Editor as an individual submission. While documentation and disclosure of this system is beneficial for the Internet community in and of itself, there are other benefits to having this document published.  One of those reasons is that members of the community, including members of the IETF, have a stable document to refer to in case of any potential new work that the community may undertake in the area of malware, security, and critical notification to end users.  It is also hoped that, in the tradition of a Request for Comment, other members of the community may be motivated to propose alternative systems or other improvements. In addition, the authors hope to be able to use this reference document with the World Wide Web Consortium (W3C) or other organization, to request the development of alternative or superior methods to provide critical web notifications, as recommended by a member of the Internet Engineering Steering Group (IESG).
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
IANA Considerations</h3>

<p>There are no IANA considerations in this document.
</p>
<p>NOTE TO RFC EDITOR: PLEASE REMOVE THIS NULL SECTION PRIOR TO PUBLICATION.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
Acknowledgements</h3>

<p>The authors wish to thank Alissa Cooper for her review of and comments on the document, as well as others who reviewed the document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17"></a><h3>17.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>17.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1631">[RFC1631]</a></td>
<td class="author-text"><a href="mailto:kbe@craycom.dk">Egevang, K.</a> and <a href="mailto:francis@cactus.ntt.jp">P. Francis</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1631">The IP Network Address Translator (NAT)</a>,&rdquo; RFC&nbsp;1631, May&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1631.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1866">[RFC1866]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a> and <a href="mailto:connolly@w3.org">D. Connolly</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1866">Hypertext Markup Language - 2.0</a>,&rdquo; RFC&nbsp;1866, November&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1866.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2396">[RFC2396]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, and <a href="mailto:masinter@parc.xerox.com">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2396">Uniform Resource Identifiers (URI): Generic Syntax</a>,&rdquo; RFC&nbsp;2396, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2396.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2396.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2396.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2434">[RFC2434]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no">H. Alvestrand</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;2434, October&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2434.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2434.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2434.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2474">[RFC2474]</a></td>
<td class="author-text"><a href="mailto:kmn@cisco.com">Nichols, K.</a>, <a href="mailto:slblake@torrentnet.com">Blake, S.</a>, <a href="mailto:fred@cisco.com">Baker, F.</a>, and <a href="mailto:black_david@emc.com">D. Black</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2474">Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</a>,&rdquo; RFC&nbsp;2474, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2474.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2474.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2474.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2475">[RFC2475]</a></td>
<td class="author-text"><a href="mailto:slblake@torrentnet.com">Blake, S.</a>, <a href="mailto:black_david@emc.com">Black, D.</a>, <a href="mailto:mark.carlson@sun.com">Carlson, M.</a>, <a href="mailto:elwynd@nortel.co.uk">Davies, E.</a>, <a href="mailto:zhwang@bell-labs.com">Wang, Z.</a>, and <a href="mailto:wweiss@lucent.com">W. Weiss</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2475">An Architecture for Differentiated Services</a>,&rdquo; RFC&nbsp;2475, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2475.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2475.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2475.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2597">[RFC2597]</a></td>
<td class="author-text"><a href="mailto:jh@telia.fi">Heinanen, J.</a>, <a href="mailto:fred@cisco.com">Baker, F.</a>, <a href="mailto:wweiss@lucent.com">Weiss, W.</a>, and <a href="mailto:jtw@lcs.mit.edu">J. Wroclawski</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2597">Assured Forwarding PHB Group</a>,&rdquo; RFC&nbsp;2597, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2597.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2782">[RFC2782]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2915">[RFC2915]</a></td>
<td class="author-text">Mealling, M. and R. Daniel, &ldquo;<a href="http://tools.ietf.org/html/rfc2915">The Naming Authority Pointer (NAPTR) DNS Resource Record</a>,&rdquo; RFC&nbsp;2915, September&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2915.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3140">[RFC3140]</a></td>
<td class="author-text">Black, D., Brim, S., Carpenter, B., and F. Le Faucheur, &ldquo;<a href="http://tools.ietf.org/html/rfc3140">Per Hop Behavior Identification Codes</a>,&rdquo; RFC&nbsp;3140, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3140.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3246">[RFC3246]</a></td>
<td class="author-text">Davie, B., Charny, A., Bennet, J., Benson, K., Le Boudec, J., Courtney, W., Davari, S., Firoiu, V., and D. Stiliadis, &ldquo;<a href="http://tools.ietf.org/html/rfc3246">An Expedited Forwarding PHB (Per-Hop Behavior)</a>,&rdquo; RFC&nbsp;3246, March&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3260">[RFC3260]</a></td>
<td class="author-text">Grossman, D., &ldquo;<a href="http://tools.ietf.org/html/rfc3260">New Terminology and Clarifications for Diffserv</a>,&rdquo; RFC&nbsp;3260, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3260.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3263">[RFC3263]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3263">Session Initiation Protocol (SIP): Locating SIP Servers</a>,&rdquo; RFC&nbsp;3263, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3263.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3507">[RFC3507]</a></td>
<td class="author-text">Elson, J. and A. Cerpa, &ldquo;<a href="http://tools.ietf.org/html/rfc3507">Internet Content Adaptation Protocol (ICAP)</a>,&rdquo; RFC&nbsp;3507, April&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3507.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4329">[RFC4329]</a></td>
<td class="author-text">Hoehrmann, B., &ldquo;<a href="http://tools.ietf.org/html/rfc4329">Scripting Media Types</a>,&rdquo; RFC&nbsp;4329, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4329.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4594">[RFC4594]</a></td>
<td class="author-text">Babiarz, J., Chan, K., and F. Baker, &ldquo;<a href="http://tools.ietf.org/html/rfc4594">Configuration Guidelines for DiffServ Service Classes</a>,&rdquo; RFC&nbsp;4594, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4594.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>17.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CableLabs DOCSIS">[CableLabs DOCSIS]</a></td>
<td class="author-text">CableLabs, &ldquo;<a href="http://www.cablelabs.com/specifications/archives/docsis.html">Data-Over-Cable Service Interface Specifications</a>,&rdquo; CableLabs Specifications&nbsp;Various DOCSIS Reference Documents.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3360">[RFC3360]</a></td>
<td class="author-text">Floyd, S., &ldquo;<a href="http://tools.ietf.org/html/rfc3360">Inappropriate TCP Resets Considered Harmful</a>,&rdquo; BCP&nbsp;60, RFC&nbsp;3360, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3360.txt">TXT</a>).</td></tr>
</table>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Document Change Log</h3>

<p>[RFC Editor: This section is to be removed before publication]
</p>
<p>
     			</p>
<ul class="text">
<li>-07 - Made modifications to accommodate concerns raised by the RFC Editor and his reviewers.  This includes CAPITALIZING all RFC 2119 language, adding more context and background to the requirements section, making the introduction more precise, making the document describe more of the actual implementation details, updating security considerations, and adding three new sections (12, 13, 14).
</li>
<li>-06 - Corrected WL/BL error
</li>
<li>-05 - fixed odd spacing in 8.1
</li>
<li>-04 - corrections and tweaks by Jason
</li>
<li>-03 - corrections and clarifications from Nirmal and BVL
</li>
<li>-02 - updated BVL's contact info, clearing one open issue.  Also added content to Security Considerations.
</li>
<li>-01 - updated doc to reflect that this system is deployed and not in development, closing out two open issues.  Added reference for JavaScript, closing an open issue.
</li>
<li>-00 - first version published
</li>
</ul><p>
 			
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chae Chung</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Comcast Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1701 John F. Kennedy Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:chae_chung@cable.comcast.com">chae_chung@cable.comcast.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comcast.com">http://www.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alex Kasyanov</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Comcast Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1701 John F. Kennedy Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:alexander_kasyanov@cable.comcast.com">alexander_kasyanov@cable.comcast.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comcast.com">http://www.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jason Livingood</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Comcast Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1701 John F. Kennedy Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jason_livingood@cable.comcast.com">jason_livingood@cable.comcast.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comcast.com">http://www.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nirmal Mody</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Comcast Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1701 John F. Kennedy Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nirmal_mody@cable.comcast.com">nirmal_mody@cable.comcast.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comcast.com">http://www.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Van Lieu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Unaffiliated</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bethlehem, PA  18018</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian@vanlieu.net">brian@vanlieu.net</a></td></tr>
</table>
</body></html>
