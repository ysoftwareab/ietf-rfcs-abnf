<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DKIM Third-Party Authorization Label</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DKIM Third-Party Authorization Label">
<meta name="keywords" content="DKIM-TPA-Label, Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DKIM Working Group</td><td class="header">D. Otis</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Trend Micro</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">D. Black</td></tr>
<tr><td class="header">Expires: February 11, 2011</td><td class="header">August 10, 2010</td></tr>
</table></td></tr></table>
<h1><br />DKIM Third-Party Authorization Label<br />draft-otis-dkim-tpa-label-06</h1>

<h3>Abstract</h3>

<p>A third party authorization label (TPA-Label) is a DNS-based extension for DKIM ADSP
        records that allows domains in the From header field to authorize acceptable third-party
        signatures. This approach allows autonomous and unilateral authorizations for third-party
        domains using scalable, individual DNS transactions. The extended scope of DKIM signing
        practice assertions introduced here supplants transparent authorization schemes that are
        more difficult to administer. Alternatives for facilitating third-party authorizations
        currently necessitate coordination between two or more domains to synchronously set up
        selector/key DNS records, DNS zone delegations, and/or a regular exchange of public/private
        keys.
</p>
<p>Checking TPA-Label Resource Records for signing practices might occur infrequently when a
        message is not compliant with restrictive ADSP practices, where an Author Domain Signature
        is either missing or invalid. When a third-party signature is found, TPA-Label Resource
        Record transactions offer an efficient means for Author Domains to authorize specific
        third-party signing domains. Recipients are afforded a method to determine whether
        authorization exists in situations where other modes of authorization are impractical.
        TPA-Label Resource Records permit Author Domains a means to influence message handling
        selectively, for messages otherwise lacking valid Author Domain signatures.<br />
<br />

</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on February 11, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Language and Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Terms Imported from other DKIM Specifications:<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Terms Defined by this Specification:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.2.1.</a>&nbsp;
Third Party Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.2.</a>&nbsp;
Third Party Signer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.2.3.</a>&nbsp;
TPA-Label Listed Domain, TPA-LLD<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.2.4.</a>&nbsp;
Author's Domain Acceptable Third-Party Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.2.5.</a>&nbsp;
Author's Domain Acceptable Third-Party Service<br />
<a href="#anchor10">3.</a>&nbsp;
Combinatorial ADSP &quot;dkim&quot; tag Values.<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.1.</a>&nbsp;
tpa-sig<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.2.</a>&nbsp;
tpa-path<br />
<a href="#anchor13">4.</a>&nbsp;
TPA-Label Resource Record Authorization Considerations<br />
<a href="#eval-3p-tpa-domain">5.</a>&nbsp;
Evaluating the Third-party Signing Domain or Service<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tpa-auth">5.1.</a>&nbsp;
Third Party Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.1.1.</a>&nbsp;
Third Party Authentication - Web Email Provider with Subscriber Pingbacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.1.2.</a>&nbsp;
Third Party Authentication - Closed Mailing List Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.1.3.</a>&nbsp;
Third Party Authentication - Open Mailing List Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.1.4.</a>&nbsp;
Third Party Authentication Example - Sender Header Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.1.5.</a>&nbsp;
Services Lacking DKIM Signatures<br />
<a href="#anchor23">6.</a>&nbsp;
DNS Representation<br />
<a href="#anchor24">7.</a>&nbsp;
TPA-Label and Tag Syntax Definitions<br />
<a href="#anchor25">8.</a>&nbsp;
TPA-Label Generation<br />
<a href="#tpalabel-rr">9.</a>&nbsp;
TPA-Label TXT Resource Record Structure<br />
<a href="#tpalabelrr-defn">10.</a>&nbsp;
TPA-Label Resource Record Definition<br />
<a href="#oesp-defn">11.</a>&nbsp;
Outbound Extended Signing Practice<br />
<a href="#scope-defn">12.</a>&nbsp;
TPA-Label Resource Record Scope Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tpa-defn">12.1.</a>&nbsp;
Authorized Signing Domain<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scopeF-defn">12.2.</a>&nbsp;
TPA-Label Listed Domain Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">12.2.1.</a>&nbsp;
From (Author) Header Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">12.3.</a>&nbsp;
Header Dependent Authorizations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scopeL-defn">12.3.1.</a>&nbsp;
List-ID Header Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scopeS-defn">12.3.2.</a>&nbsp;
Sender Header Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">12.3.3.</a>&nbsp;
Combined 'L' or 'S' Scopes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scopeE-defn">12.4.</a>&nbsp;
SMTP Host domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scopeH-defn">12.5.</a>&nbsp;
SMTP Host domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scopeM-defn">12.6.</a>&nbsp;
MailFrom Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scopeT-defn">12.7.</a>&nbsp;
SMTP Host domains<br />
<a href="#tpa-qt">13.</a>&nbsp;
TPA-Label Resource Record Query Transactions<br />
<a href="#auth-meaning">14.</a>&nbsp;
TPA-Label Resource Record Compliance Assessment<br />
<a href="#IANA">15.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">15.1.</a>&nbsp;
Author Domain Signing Practices (ADSP) Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">15.2.</a>&nbsp;
Email Authentication Method Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">15.3.</a>&nbsp;
Email Authentication Result Names Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">15.4.</a>&nbsp;
Third Party Authorizations Labels Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scope-registry">15.5.</a>&nbsp;
Third Party Authorizations Scope Registry<br />
<a href="#Security">16.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">16.1.</a>&nbsp;
Benefits to Recipients<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">16.2.</a>&nbsp;
Risks to Recipients<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">16.3.</a>&nbsp;
Benefits to Author Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">16.4.</a>&nbsp;
Risks to Author Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">16.5.</a>&nbsp;
Benefits to Third Party Signers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">16.6.</a>&nbsp;
Risks caused by Third Party Signers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">16.7.</a>&nbsp;
SHA-1 Collisions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DNS">16.8.</a>&nbsp;
DNS Limits<br />
<a href="#Acknowledgements">17.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">18.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">18.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">18.2.</a>&nbsp;
Informative References<br />
<a href="#anchor42">Appendix&nbsp;A.</a>&nbsp;
DNS Example of TPA-Label Resource Record placement<br />
<a href="#anchor43">Appendix&nbsp;B.</a>&nbsp;
C code for label generation<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>A transparent method for DKIM authorization requires the sharing of a number of details
        between the domain owner, and one or more providers of email and DNS. Transparent
        authorization occurs when an Author Domain's DNS resolves a public DKIM key, with the
        corresponding private key being held by a third-party. With the many ways in which this
        might be achieved, it is unlikely that standardized formats will be developed to exchange
        necessary, and at times, sensitive information between various informal third-party
        services, such as mailing-lists. With transparent authorizations, when a security breach
        does occur, the wrong party might be held accountable for content it never saw nor logged.
        For informal authorizations, the TPA-Label Resource Record supports a simple authorization
        method that keeps visible which administrative entity signed a message, and whether an
        Author Domain authorized the signature. The authorization record may also impose additional
        header field requirements to better ensure protective message sorting.
</p>
<p>Tens of thousands of domains of various financial institutions are frequently being
        phished. Phishing creates a nuisance for those who aren't expecting these messages, and a
        threat for those who then interact with them. Whenever institutions employ DKIM and wish to
        utilize various informal third-party services, the integrity of their Author Domain
        Signatures might be affected. Some respond to this by implementing less stringent Author
        Domain Signing Practices on subdomains to accommodate the impact of these third-party
        services, as suggested by <a class='info' href='#I-D.ietf-dkim-mailinglists'>[I&#8209;D.ietf&#8209;dkim&#8209;mailinglists]<span> (</span><span class='info'>Kucherawy, M., &ldquo;DKIM And Mailing Lists,&rdquo; July&nbsp;2010.</span><span>)</span></a> Section 4.1, that
        recommends use of subdomains to assert less restrictive ADSP practices.
</p>
<p>As currently structured, ADSP does not offer an alternative to using more domains, where
        only some are protected by a restrictive practice. As such, it lacks a method to retain an
        authentication &amp; authorization as an acceptance condition when using informal third
        party services. Loss of authentication will lead to an increase of those being deceived by
        phishing attempts. This is because people often do not understand the significance of URI
        hierarchy, and become confused or insensitive to domain changes. APWG phishing trends, <a class='info' href='#apwg-globalphishingsurvey-2H2009'>[apwg&#8209;globalphishingsurvey&#8209;2H2009]<span> (</span><span class='info'>Anti-Phishing Working Group, &ldquo;Global Phishing Survey: Trends and Domain Name Use 2H2009,&rdquo; May&nbsp;2009.</span><span>)</span></a> page 18, indicates phishing commonly uses
        subdomains in a URL to fool potential victims.
</p>
<p>Deterrents based upon reputation and/or path based strategies that utilize a variety of
        originating header fields are ineffective. These header fields often remain invisible to
        recipients, and contain domains being exploited for periods measured in hours, in an
        avoidance of any Whack-A-Mole like response. Even long term reputations are increasingly
        problematic due to an intermix of messages from compromised accounts. Few recipients will
        inspect the stack of message header fields, or be able to draw useful conclusions from a
        profusion of unfriendly information. However, many recipients deal with abuse by sorting
        messages into groups based upon an assumed source found in a few originating header
        fields.
</p>
<p>ADSP represents an open registry that offers domain specific guidance for DKIM acceptance
        criteria when determining whether messages should be delivered, refused, or discarded.
        However, appropriate actions become unclear whenever third-party services are involved. For
        example, it is not clear whether ADSP "dkim=all" assertions include third-party services
        that could potentially damage Author-Domain signatures. Although ADSP warns of a potential
        for disruption, specific handling recommendations are limited to "dkim=discardable".
        Administrative domains that assert all of their outbound messages are signed offer
        significant forensic value. However, the handling for their messages lacking an Author
        Domain Signature with an ADSP "dkim=all" assertion remains unclear.
</p>
<p>This document describes how any Author Domain publishing ADSP records defined in <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a> can autonomously authorize DKIM signatures <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>
        (updated by <a class='info' href='#RFC5672'>[RFC5672]<span> (</span><span class='info'>Crocker, D., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update,&rdquo; August&nbsp;2009.</span><span>)</span></a>) by specific domains. This document offers secondary
        signing practices for additional ADSP compliance options whenever no Author Domain Signature
        is present within the message. The intended purpose of TPA-Label Resource Records is to
        improve acceptance rates of genuine messages, to minimize domain use, to minimize success
        rates for phishing, to improve sorting protections, and to minimize a recipient's
        administrative costs.
</p>
<p>TPA-Label Resource Records authorize third-party signing domains and services to extend
        DKIM compliance options for signing practices defined by <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a>. Domains
        that both reference and are listed within a TPA-Label resource record are to be considered
        equivalent to the authorizing Author Domain when assessing compliance with ADSP. The TXT
        resource records, associated with TPA-Labels, start with the 'dkim' tag as defined by <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a> for signing practices, and may contain tags specifically defined for
        TPA-Label Resource Records.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Language and Terminology</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Terms Imported from other DKIM Specifications:</h3>

<p>
          </p>
<blockquote class="text">
<p>A "Valid Signature" is any signature on a message that correctly verifies using the
              procedure described in Section 6.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.<br />
<br />

</p>
<p>"Author Address" is defined in Section 2.3 of <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a>.<br />
<br />

</p>
<p>"Author Domain" is defined in Section 2.4 of <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a>.<br />
<br />

</p>
<p>"Alleged Author" is defined in Section 2.5 of <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a>.<br />
<br />

</p>
<p>"Author Domain Signature" is defined in Section 2.7 of <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a>
            
</p>
</blockquote><p>
          <br />
<br />

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Terms Defined by this Specification:</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Third Party Signature</h3>

<p>A "Third Party Signature" is a Valid Signature that does not qualify as an Author
            Domain Signature.
</p>
<p>
            </p>
<blockquote class="text">
<p>Editor's Note: While this term is defined in Section 6.3 of <a class='info' href='#RFC5863'>[RFC5863]<span> (</span><span class='info'>Hansen, T., Siegel, E., Hallam-Baker, P., and D. Crocker, &ldquo;DomainKeys Identified Mail (DKIM) Development, Deployment, and Operations,&rdquo; May&nbsp;2010.</span><span>)</span></a> and in Section 2 of <a class='info' href='#RFC5016'>[RFC5016]<span> (</span><span class='info'>Thomas, M., &ldquo;Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol,&rdquo; October&nbsp;2007.</span><span>)</span></a>, this definition is in terms of the
                Author Domain Signature and avoids statements about any header field
                dependencies.
</p>
</blockquote><p>
          
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Third Party Signer</h3>

<p>A "Third Party Signer" is a signer that adds a valid DKIM signature that references a
            domain with the 'd=' tag in the DKIM-Signature header field that is not the Author
            Domain.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
TPA-Label Listed Domain, TPA-LLD</h3>

<p>TPA-Label Listed Domain, TPA-LLD, is a TXT resource record referenced with a TPA-Label
            published within an Author Domain. When a "tpa" tag exists within the TXT resource
            record located at the TPA-Label, the referencing domain (the domain used to generate the
            label) must be within the listed domain. When the "tpa" tag does not exist, the
            referenced domain is presumed listed. The "scope" tag may stipulate existence of
            additional header fields, or indicate alternate confirmation methods applied against
            specific email elements. Third-party domain confirmation might use a DKIM signature or
            confirm the authorized domain using specific methods with various path related email
            elements. 'F' is the default confirmation scope assumed, indicating DKIM confirms the
            authorized domain when no other method is specified. The 'S' and 'L' scope do not
            confirm the domain, but require at least one Sender or List-ID header field to hold the
            identity of the authorized domain respectively. The 'e', 'h', 'm', and 't' indicate
            specific alternative methods using message elements to confirm the authorized domain.
            Being compliant with TPA-LLD allows the referencing domain to informally act on behalf
            of the Author Domain. Following <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>, domain name comparisons, as
            well as TPA-Labels, are case insensitive.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.4"></a><h3>2.2.4.&nbsp;
Author's Domain Acceptable Third-Party Signature</h3>

<p>An "Author's Domain Acceptable Third-Party Signature" is a Valid Signature in which the
            domain name of the DKIM signing entity, i.e., the 'd=' tag in the DKIM-Signature header
            field, is the domain name referenced in the TPA-Label Resource Record published by the
            Author Domain with a scope of 'F'. The 'F' scope indicates this third-party domain
            implements DKIM signing. For 'S' and 'L' scopes, the respective Sender header field or a
            List-ID identifier of the List-ID header field must exist for either scope and contain a
            domain within the TPA-LLD for authorization to be valid.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.5"></a><h3>2.2.5.&nbsp;
Author's Domain Acceptable Third-Party Service</h3>

<p>An "Author's Domain Acceptable Third-Party Service" is a service that confirms the
            administrative domain through the message element determined by the method specified by
            the scope of 'e', 'h', 'm', or 't'. For 'S' or 'L' scopes, the respective Sender header
            field or a List-ID identifier of the List-ID header field must exist for either scope
            and contain a domain within the TPA-LLD for authorization to be valid.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Combinatorial ADSP &quot;dkim&quot; tag Values.</h3>

<p>This document defines new values listed with the ADSP "dkim" tag in addition to those
        defined in <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a> Section 4.2.1. These values can be appended to those
        currently defined or used separately. When used separately, the value "all" is to be assumed
        to prefix the new values when recognized, otherwise the value "unknown" will be assumed. It
        is not recommended to use any new value in conjunction with "discardable", because when not
        understood, a message that depends upon different handling might become lost.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
tpa-sig</h3>

<p>The ADSP dkim tag value "tpa-sig" indicates that TPA-Labels will offer a comprehensive
          list of Author's Domain Acceptable Third-Party Signatures that may also include header
          field requirements. When there is no valid Author Domain Signature or Author's Domain
          Acceptable Third-Party Signature, the Author Domain recommends these messages be
          refused.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
tpa-path</h3>

<p>The ADSP dkim tag value "tpa-path" indicates that TPA-Labels will offer a comprehensive
          list of Author's Domain Acceptable Third-Party Signatures and Authorized Third-Party
          Services that may also include header field requirements.
</p>
<p>The "tpa-path" allows alternative path verification methods, to accommodate third party
          services lacking DKIM signatures. The message element is determined by the method
          specified by the scope. When the path domain is confirmed by the specified method, and the
          message is compliant with TPA-LLD requirements, then it is also compliant with the Author
          Domain's asserted signing practices. The leaf of the hostname (left most label) may need
          to be omitted when checking for TPA-Label Resource Record authorization.
</p>
<p>When there is no valid Author Domain Signature, or Author's Domain Acceptable Third-Party
          Signature, or Author's Domain Acceptable Third-Party Service, the Author Domain recommends
          these messages be refused.
</p>
<p>ADSP defends domains against spoofing. Any subdomain of a domain publishing an ADSP with
          the "dkim" tag value containing "tpa-sig" or "tpa-path" not also publishing an MX resource
          record should be assumed to have published the same ADSP records there as well.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
TPA-Label Resource Record Authorization Considerations</h3>

<p>When an Author Domain is not within the DKIM signing domain, the TPA-LLD scheme can extend
        ADSP signing practice compliance. The TPA-LLD scheme with an 'F', 'S', or 'L' scope permits
        a contained Third Party Signature to be treated as an Author Domain Signature. The 'e', 'h',
        and 't' scopes permit acceptance based upon confirmation of the client hostname (EHLO/HELO).
        The 'm' scope permits confirmations based upon the return path (Mail From) domain. For 'S'
        and 'L' scopes, a respective Sender header field or a List-ID identifier of the List-ID
        header field must exist for at least one of the scopes, and contain a domain within the
        TPA-LLD for authorization to be valid.
</p>
<p>The 'S' and 'L' scopes support message sorting. Any matching header field with a domain
        within the TPA-LLD allows recipients to differentiate sources, which satisfies requirements
        for any other 'S' or 'L' scope. The 'S' and 'L' scopes provide Author Domains a means to
        extend restrictive policy compliance.
</p>
<p>The TPA-LLD scheme plays the role of only providing acceptable signatures or services which
        might be suitable for non-critical messages, with the goal of improving delivery acceptance,
        such as those from specific mailing-lists. The TPA-LLD authorization scheme only requires
        that DNS publications be made by the Author Domain, even when signing domains and the Author
        Domain differ. This approach avoids a need to exchange DKIM key related information and
        better protects private key information. Before TPA-LLD authorization is deployed, the
        Author Domain should be assured by domains being authorized that appropriate measures are in
        place to authenticate those who are submitting messages.
</p>
<p>Retaining authentication &amp; authorization for the From, Sender, and List-ID header
        fields, and being able to ensure third-party inclusion of a Sender or List-ID header fields,
        enhances protections afforded by message sorting. This protection reduces susceptibility to
        deceptive look-alike phishing attempts. Use of subdomains that assert less stringent
        practices, might inadvertently combine with those having more stringent practices when
        sorting is based upon parent domains. Consistently using the same domain avoids confusion
        that could be exploited to deceive recipients.
</p>
<p>At this time, it is not practical for large ISPs to make restrictive ADSP assertions. This
        would impair the utility of their service by excluding all third-party services lacking
        suitable source authentication. However, institutions can benefit by making restrictive ADSP
        assertions that better retain recipient trust in their email notifications, without forgoing
        use of all informal third-party services. Rather than using subdomains lacking ADSP
        restrictions, suitable third-party services can be authorized by using TPA-Labels instead.
        This approach also offers a proactive means for recipients to filter phishing attempts.
</p>
<p>TPA-Label authorization will not ensure all possible spoofing is prevented. However, by
        permitting broader use of restrictive practices, this should generally reduce the level of
        spoofing over what might be otherwise allowed. Authorized third party messages SHOULD NOT
        receive annotations that indicate the message contains authenticated identities. The TPA-LLD
        scope SHOULD include the 'S' or 'L' scope where appropriate to allow recipients a means to
        isolate and distinguish different message sources.
</p>
<p>The "dkim" tag within the TPA-Label Resource Record is normally expected to contain a copy
        of the value asserted by the ADSP Resource Record "dkim" tag. When the TPA-Label Resource
        Record "dkim" tag value differs, and the message is compliant with the "scope" and "tpa" tag
        values, the TPA-Label Resource Record "dkim" tag value overrides the ADSP Resource Record
        "dkim" tag value. When the TPA-Label Resource Record "dkim" tag value contains
        "discardable", compliance with the "scope" tag values is not required to override the ADSP
        Resource Record. Use of "tpa-path" SHOULD selectively override the ADSP "tpa-sig" only where
          needed.
</p>
<a name="eval-3p-tpa-domain"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Evaluating the Third-party Signing Domain or Service</h3>

<p>An Author Domain deploying a TPA-Label Resource Record does so on a trust basis. Reasons
        for deploying TPA-Label Resource Records might be to allow deployment of more stringent ADSP
        records while also utilizing third-party signatures or services.
</p>
<p>When an authorized Third Party Signer does not employ DKIM authentication with ADSP or does
        not include Authentication-Results header fields <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>, this could allow
        authorizations to be exploited.
</p>
<a name="tpa-auth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Third Party Authentication</h3>

<p>The Author Domain SHOULD ensure the Authorization Scope of the TPA-Label Resource Record
          is authenticated. There are a number of ways email can be authenticated, and different
          authentication mechanisms validate different parts of the email. The following are
          examples of how authorization might work.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Third Party Authentication - Web Email Provider with Subscriber Pingbacks</h3>

<p>The Author Domain "example.com" wants to deploy a TPA-Label Resource Record to permit
            its traveling agents the use of "webmail.example.net" services. This email provider has
            a closed user policy and adds DKIM signatures to messages on behalf of the
            "webmail.example.net" domain.
</p>
<p>The closed user policy of "webmail.example.net" permits subscribers to post messages
            with Author Domains that are not "webmail.example.net" in the From header fields, only
            when control of the Author Address has been validated by a response to an encoded
            "pingback" email. The "webmail.example.net" service also establishes accounts to
            authenticate all users sending messages through its service. Therefore, the referenced
            TPA-Label Resource Record can include an 'F' scope value to authorize Author Domain
            messages signed by this Third-Party Signer.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Third Party Authentication - Closed Mailing List Example</h3>

<p>The Author Domain wants to deploy a TPA-Label Resource Record for a mailing list with a
            closed posting policy that redistributes email in a way that breaks Author Domain
            Signatures, but adds a DKIM signature on behalf of the mailing list domain and includes
            an Authentication-Results header field for posted messages. The closed posting policy is
            enforced by requiring subscribers to validate their control of their Author Addresses by
            responding to encoded "pingback" email sent to these addresses.
</p>
<p>Since the mailing list management always verifies control of the Author Address, and is
            configured to include Authentication-Results header fields, and includes a List-ID
            header field, the referenced TPA-Label Resource Record can include an 'L' scope value to
            permit Author Domain messages containing an authorized List-ID domain to be signed by
            this Third-Party Signer.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Third Party Authentication - Open Mailing List Example</h3>

<p>The Author Domain wants to deploy a TPA-Label Resource Record for a mailing list with
            an open posting policy that redistributes email in a way that breaks Author Domain
            Signatures, but that adds a DKIM signature on behalf of the mailing list domain and
            includes an Authentication-Results header field for posted messages. The open posting
            policy will refuse messages lacking Author Domain Signatures for domains that have
            deployed an ADSP signing practice of "dkim=all" or "dkim=discardable".
</p>
<p>Since the list management always refuses to post an Author Address lacking a Author
            Domain Signature when the domain has deployed an ADSP record with an "dkim=all" or
            "dkim=discardable", and is configured to include Authentication-Results header fields,
            and includes a List-ID header field, the referenced TPA-Label Resource Record can
            include an 'L' scope value to permit Author Domain messages containing an authorized
            List-ID domain to be signed by this Third-Party Signer.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
Third Party Authentication Example - Sender Header Field</h3>

<p>Author Domain "example.com" wishes to temporarily employ the service agency
            "temp.example.org" to handle overflow secretarial support. The agency "temp.example.org"
            sends email on behalf of the executive staff of "example.com" and adds the Sender header
            field of "secretary@temp.example.org" in the email. Since "temp.example.org" only allows
            its own staff to email through its server which adds "temp.example.org" DKIM signatures,
            a TPA-LLD can include the "temp.example.org" domain with an 'S' scope to specifically
            authorize messages containing the Sender header field to help ensure these messages are
            not handled as phishing attempts.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.5"></a><h3>5.1.5.&nbsp;
Services Lacking DKIM Signatures</h3>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.5.1"></a><h3>5.1.5.1.&nbsp;
Abuse and DSN Reporting</h3>

<p>There is likely little interest for an otherwise uninvolved domain to receive a
              massive number of bogus messages being returned as feedback. Often the purpose of
              feedback is to discover compromised systems or accounts actively being exploited in
              some manner. Unless the Author Domain is confirmed as having handled or authorized the
              handling of the message, only statistics and samples should be reported to the
              associated Autonomous System <a class='info' href='#RFC1930'>[RFC1930]<span> (</span><span class='info'>Hawkinson, J. and T. Bates, &ldquo;Guidelines for creation, selection, and registration of an Autonomous System (AS),&rdquo; March&nbsp;1996.</span><span>)</span></a>, and perhaps to the Author
              Domain when interest is expressed.
</p>
<p>The 'e', 'h', 'm', and 't' scope options within the TPA-LLD records allow the Author
              Domain to be associated through various methods with path related domains, when DKIM
              is not employed by the third-party service. In this case, appropriate DSN or abuse
              reporting to the Author Domain is better assured as well.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.5.2"></a><h3>5.1.5.2.&nbsp;
Third Party Authentication Example - SMTP Host</h3>

<p>Author Domain "example.com" makes use of invite services. This service does not
              utilize DKIM, where the host name given by the EHLO command is "invite.example.net".
              The Author Domain can authorize the domain "invite.example.net" or "example.net" with
              the scope of 'e' to improve acceptance of messages that are sent on behalf of
              "example.com" from this outbound server.<br />
<br />

</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.5.3"></a><h3>5.1.5.3.&nbsp;
Third Party Authentication Example - Return Path</h3>

<p>Author Domain "example.com" makes use of tell-a-friend services. This service does
              not utilize DKIM with its own return path as "customer@taf.example.net" in the SMTP
              exchange. The Author Domain can authorize the domain "taf.example.net" with the scope
              of 'm' to improve acceptance of messages that are on behalf of "example.com" from this
              outbound server.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.5.4"></a><h3>5.1.5.4.&nbsp;
Use of Path Authorization</h3>

<p>Those using the "tpa-path" value should not authorize domains requiring more than 5
              network transactions to confirm their domain. Those implementing this ADSP extension
              should also limit the number of DNS transactions attempted, or this could negatively
              impact unrelated domains when evaluating path related protocols.<br />
<br />

              </p>
<blockquote class="text">
<p>Methods that create subsequent transactions based upon the macro expansion of
                  email-address local-parts should not be used. Libraries that process <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a> record scripts may invoke a large number of DNS transactions
                  from cached records, and target unrelated domains with queries modulated by
                  recipients through macro expansion. Recipient processing of such scripts might
                  become blocked, when found to produce significant network amplification from
                  cached records during spam campaigns.
</p>
</blockquote>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
DNS Representation</h3>

<p>The receiver obtains domain authorizations with a DNS query for an IN class TXT TPA-Label
        resource record located below the location specified in <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> Section 7.4
        and the label "_tpa.". The TPA-Label itself is generated by processing the domain in
        question, which normally matches the DKIM signature's "d=" parameter. A TPA-Label Resource
        Record is published adjacent to the <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a> conventional ADSP record, for
        example below "_tpa._domainkey.&lt;Author-Domain&gt;". The Author Domain provides
        authorization for other domains with the existence of a TPA-Label TXT resource record. When
        a "tpa" tag value exists, it must include the referenced domain before authorization is
        valid. Authorization to informally act on behalf of the Author Domain can also be limited by
        the "scope" tag value for specific message elements.
</p>
<p>An Author Domain may wish to delegate the listing of third-party services to a different
        administrative domain. Ideally, this would be accomplished by delegating the
        _tpa._domainkey.&lt;Author-Domain&gt; zone to the administrative entity handling publication
        of TPA-Label Resource Records. This delegation could also be done unilaterally with a <a class='info' href='#RFC2672'>[RFC2672]<span> (</span><span class='info'>Crawford, M., &ldquo;Non-Terminal DNS Name Redirection,&rdquo; August&nbsp;1999.</span><span>)</span></a> DNAME resource record published at
        _tpa._domainkey.&lt;Author-Domain&gt;.
</p>
<p>Character-strings contained within the TXT resource record are concatenated into forming a
        single string. A character-string, as defined in <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> Section 3.3 for
        resource records, is a single length octet followed by that number of characters treated as
        binary information. <br />
<br />

</p>
<p>The TPA-Label Resource Records should be located at these domains:</p>
<blockquote class="text">
<p>
</p>
<p>&lt;tpa-label&gt;._tpa._domainkey.&lt;Author-Domain&gt;.
</p>
</blockquote><p>
      
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
TPA-Label and Tag Syntax Definitions</h3>

<p>Augmented BNF for Syntax Specifications:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          asterisk = %x2A ; "*"
          dash = %x2D ; "-"
          dot = %x2E ; "."
          underscore = %x5F ; "_"
          ANY = asterisk dot ; "*."
          dns-char = ALPHA / DIGIT / dash
          id-prefix = ALPHA / DIGIT
          label = id-prefix [*61dns-char id-prefix]
          sldn = label dot label
          base-char = (dns-char / underscore)
          domain = *(label dot) sldn

          tag-list  =  tag-spec 0*( ";" tag-spec ) [ ";" ]
          tag-spec  =  *WSP tag-name *WSP "=" *WSP tag-value [WSP]
          tag-name  =  ALPHA 0*ALNUMPUNC / "dkim" / "scope" / "tpa"
          tag-value =  [ tval 0*( 1*(WSP) tval ) ]
                          ; WSP prohibited at end
          tval      =  1*VALCHAR
          VALCHAR   =  %x21-3A / %x3C-7E
                          ; EXCLAMATION to TILDE except SEMICOLON
          ALNUMPUNC =  ALPHA / DIGIT / "_"
</pre></div>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
TPA-Label Generation</h3>

<p>The TPA-Label is generated by nesting functions as follows:
</p>
<p></p>
<blockquote class="text">
<p>"base32" function is defined in <a class='info' href='#RFC4648'>[RFC4648]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a>.<br />
<br />

</p>
<p>"sha1" function is defined in <a class='info' href='#FIPS.180-2.2002'>[FIPS.180&#8209;2.2002]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a>.<br />
<br />

</p>
<p>"lcase" converts upper-case ALPHA characters to lower-case.<br />
<br />

</p>
<p>"tpa-domain" is normally the "d=" tag value defined in Section 3.5 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.<br />
<br />
<br />

</p>
<p> &#40;underscore&#41; base32&#40; sha1&#40; lcase&#40;tpa-domain&#41;&#41;&#41;
          
</p>
</blockquote><br />
<br />


<p>The TPA-Label is created from the hash value returned by the "sha1" function of the
        tpa-domain expressed in lower case ASCII. Any terminating period is not included with the
        tpa-domain, as indicated by the ABNF definition.<br />
<br />
</p>
<blockquote class="text">
<p>Note: No newline character, 0x0A, is to be appended to the end of the domain name, as
            might occur with the command line generation of sha1 values. For example, these command
            line appended newlines can be avoided by using the 'echo -n" option.
</p>
</blockquote>

<p>The label encoding process inputs the hash as a byte stream of four 40-bit data blocks
        where each data block outputs 8 encoded characters. Proceeding from left to right, a 40-bit
        input group is formed by concatenating 5 bytes. The 40-bit input is then treated as 8
        concatenated 5-bit groups, each of which is translated into a single digit of the base32
        alphabet. The bit stream is ordered with the most-significant-bit first, being the
        high-order bit of the first byte. The entire output is then concatenated first to last, left
        to right, into 32 characters prefixed with an underscore.
</p>
<a name="tpalabel-rr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
TPA-Label TXT Resource Record Structure</h3>

<p>Every TPA-Label TXT resource record MUST start with an outbound signing-practices tag, so
        the first four characters of the record are lowercase "dkim", followed by optional
        whitespace and "=". In addition to the tags defined by <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a>, TPA-Label
        syntax descriptions for additional tags follow the tag-value syntax described in section
        4.2.1 of <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a> and Section 3.2 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. Unrecognized
        tags and tags with illegal values MUST be ignored. In the ABNF below, the WSP token is
        inherited from <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., Ed., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. The ALPHA and DIGIT tokens are imported from <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The tags used in TPA-Label resource records are as follows:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">Tag</th><th align="left">Function</th></tr>
<tr>
<td align="center">dkim</td>
<td align="left">Outbound Extended Signing Practices (dkim-tag)</td>
</tr>
<tr>
<td align="center">scope</td>
<td align="left">Authorization Scope List (scope-tag)</td>
</tr>
<tr>
<td align="center">tpa</td>
<td align="left">Authorized Domains List (tpa-tag)</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-Label Tags&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center" width="10%"><col align="left">
<tr><th align="center">dkim values</th><th align="left">Field or Parameter</th></tr>
<tr>
<td align="center">tpa-sig</td>
<td align="left">Third-Party Signature</td>
</tr>
<tr>
<td align="center">tpa-path</td>
<td align="left">Third-Party Path or Signature</td>
</tr>
<tr>
<td align="center">all tpa-sig</td>
<td align="left">Third-Party Signature</td>
</tr>
<tr>
<td align="center">discardable</td>
<td align="left">Selective discardable</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Outbound Extended Signing Practices Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center" width="10%"><col align="left"><col align="left">
<tr><th align="center">scope values</th><th align="left">Field or Parameter</th><th align="left">Method</th></tr>
<tr>
<td align="center">F</td>
<td align="left">From (Author) Header Field</td>
<td align="left">Match Address Domain</td>
</tr>
<tr>
<td align="center">L</td>
<td align="left">List-ID Header Field</td>
<td align="left">Match List-ID Identifier</td>
</tr>
<tr>
<td align="center">S</td>
<td align="left">Sender Header Field</td>
<td align="left">Match Address Domain</td>
</tr>
<tr>
<td align="center">e</td>
<td align="left">SMTP Hostname</td>
<td align="left">Resolve Hostname IP Addr</td>
</tr>
<tr>
<td align="center">h</td>
<td align="left">SMTP Hostname</td>
<td align="left">Pass SPF with Hostname</td>
</tr>
<tr>
<td align="center">m</td>
<td align="left">MailFrom</td>
<td align="left">Pass SPF with MailFrom</td>
</tr>
<tr>
<td align="center">t</td>
<td align="left">SMTP Hostname</td>
<td align="left">Cert of Hostname</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-Label Scope Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="tpalabelrr-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
TPA-Label Resource Record Definition</h3>

<p>Tags in the TPA-Label Resourse Record are shown below. The dkim tag MUST be present as the
        left most tag.Unrecognized tags MUST be ignored.
</p>
<p>TPA-Label Resource Record Definition</p>
<blockquote class="text">
<p>tpalabelrr = dkim-tag [";"] 0*( 1*(WSP) tag-list) ] 
</p>
</blockquote><p>
      
</p>
<a name="oesp-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Outbound Extended Signing Practice</h3>

<p>Outbound Signing Practice Extensions. This tag defines a list of extended outbound signing
        practices that combine with those for various email-address locations within the message.
        Only recognized scope values offer any form of ADSP authorization.
</p>
<p>"dkim" tag </p>
<blockquote class="text">
<p>; hyphenated-word is defined in <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>
</p>
<p>x-obesp = hyphenated-word ; for future extension
</p>
<p>dkim_val = ( "tpa-sig" / "tpa-path" / "all tpa-sig"/ "discardable" / x-obsp)
</p>
<p>dkim-tag = %x64.6b.69.6d *WSP "=" *WSP dkim_val
</p>
</blockquote>

<a name="scope-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
TPA-Label Resource Record Scope Syntax</h3>

<p>Authorization Scope List (Optional). This tag defines a list of scoping assertions for
        various email-address locations within the message. Only recognized scope values offer any
        form of ADSP authorization.
</p>
<p>"scope" tag </p>
<blockquote class="text">
<p>as_val = "F" / "L" / "S" / "e" / "h" / "m" / "t"
</p>
<p>as-list = %x73.63.6f.70.65 *WSP "=" [ as_val 0*( 1*(WSP) as_val )]
</p>
</blockquote><p>
      
</p>
<a name="tpa-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
Authorized Signing Domain</h3>

<p>Authorized Signing Domain list. (optional) This tag, when present, MUST repeat all or
          portions of the domain encoded within the TPA-Label Resource Record. This option ensures
          the proper handling of possible hash collisions. When a domain is prefixed with the "*."
          ANY label, then all subdomains of this domain are to be considered included within the
          list. When the 'tpa' tag is not present or has no value, it should be assumed to compare
          with the domain used to generate the TPA-Label.
</p>
<p>"tpa" tag </p>
<blockquote class="text">
<p>ad_val = [ANY] domain
</p>
<p>ad-list = %x74.70.61 *WSP "=" [ ad_val 0*( 1*(WSP) ad_val )]
</p>
</blockquote><p>
        
</p>
<a name="scopeF-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
TPA-Label Listed Domain Authorization</h3>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2.1"></a><h3>12.2.1.&nbsp;
From (Author) Header Field</h3>

<p>The "F" scope asserts that messages carrying the Author Domain within the From header
            field are authorized to be signed by the TPA-LLD.<br />
<br />

</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
Header Dependent Authorizations</h3>

<a name="scopeL-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3.1"></a><h3>12.3.1.&nbsp;
List-ID Header Field</h3>

<p>The "L" scope asserts that authorization is valid only when a List-ID identifier of the
            List-ID header field <a class='info' href='#RFC2919'>[RFC2919]<span> (</span><span class='info'>Chandhok, R. and G. Wenger, &ldquo;List-Id: A Structured Field and Namespace for the Identification of Mailing Lists,&rdquo; March&nbsp;2001.</span><span>)</span></a> contains a domain that is within a domain
            listed in the TPA-LLD "tpa" tag.
</p>
<p>The syntax of the List-Id header field is as follows:</p>
<blockquote class="text">
<p>list-id-header = "List-ID:" [phrase] "&lt;"identifier"&gt;"CRLF<br />
<br />

</p>
</blockquote>

<a name="scopeS-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3.2"></a><h3>12.3.2.&nbsp;
Sender Header Field</h3>

<p>The "S" scope asserts that authorization is valid only when the domain in the Sender
            header field is within the TPA-LLD.<br />
<br />

</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3.3"></a><h3>12.3.3.&nbsp;
Combined 'L' or 'S' Scopes</h3>

<p>When combined, the scopes 'L' and 'S' require that either a List-ID identifier of the
            List-ID header field or the Sender header field must contain a domain within the TPA-LLD
            for the authorization to be valid.
</p>
<a name="scopeE-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.4"></a><h3>12.4.&nbsp;
SMTP Host domains</h3>

<p>The "e" scope asserts that host names given in <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a> EHLO or HELO
          commands within TPA-LLD is authorized when the hostname resolves the server's IP
            address.<br />
<br />

</p>
<a name="scopeH-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.5"></a><h3>12.5.&nbsp;
SMTP Host domains</h3>

<p>The "h" scope asserts that host names given in <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a> EHLO or HELO
          commands within TPA-LLD is authorized only when this hostname submitted to an spf <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a> process returns pass.<br />
<br />

</p>
<a name="scopeM-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.6"></a><h3>12.6.&nbsp;
MailFrom Parameter</h3>

<p>The "m" scope asserts that an email-address domain in the <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a> MAIL
          command within a TPA-LLD is authorized only when this email-address submitted to an spf
            <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a> process returns pass.<br />
<br />

        
</p>
<a name="scopeT-defn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.7"></a><h3>12.7.&nbsp;
SMTP Host domains</h3>

<p>The "t" scope asserts that host names given in <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a> EHLO command
          after <a class='info' href='#RFC3207'>[RFC3207]<span> (</span><span class='info'>Hoffman, P., &ldquo;SMTP Service Extension for Secure SMTP over Transport Layer Security,&rdquo; February&nbsp;2002.</span><span>)</span></a> negotiation where the Cert DNS-ID domain is within TPA-LLD
          is authorized.
</p>
<p>Not to RFC Editor: Remove this comment before publishing.</p>
<blockquote class="text">
<p>Currently, no general practice employs certificates to confirm the domain of the
              client initiating a connection. This may be needed for clients within IPv6 IP address
              space where tunneling, carrier grade NATs, and rapid space assignment without any
              practical reverse mapping reduces the effectiveness of IP address based
              reputations.
</p>
<p>There is an existing TLS option for SMTP and an ongoing effort to standardize
              automated server confirmation. It might be possible to leverage this effort to
              establish practices used at the client. It might also be possible to utilize the DKIM
              public key to verify a challenge signed by the client based upon keys located at its
              hostname, but this would require a change made to SMTP conversations defined in <a class='info' href='#RFC4954'>[RFC4954]<span> (</span><span class='info'>Siemborski, R. and A. Melnikov, &ldquo;SMTP Service Extension for Authentication,&rdquo; July&nbsp;2007.</span><span>)</span></a> Section 4. For information related to ongoing server related
              efforts see:
</p>
<p><a class='info' href='#I-D.saintandre-tls-server-id-check'>[I&#8209;D.saintandre&#8209;tls&#8209;server&#8209;id&#8209;check]<span> (</span><span class='info'>Saint-Andre, P. and J. Hodges, &ldquo;Representation and Verification of Domain-Based Application Service Identity in Certificates Used with Transport Layer Security,&rdquo; August&nbsp;2010.</span><span>)</span></a><br />
<br />

</p>
</blockquote>

<a name="tpa-qt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
TPA-Label Resource Record Query Transactions</h3>

<p>The discovery of TPA-Label resource records need not be subsequent to the discovery of the
        ADSP record specified by <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a>. However, when no ADSP record is
        discovered or when it does not contain a "dkim" tag value of either "tpa-sig" or "tpa-path",
        the verifier MAY assume that no TPA-Label Resource Records have been published. Otherwise,
        when there is a Third Party Signature without any Author Domain Signature, the discovery of
        TPA-Label Resource Records should be attempted.
</p>
<a name="auth-meaning"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
TPA-Label Resource Record Compliance Assessment</h3>

<p>The signing practice compliance assessment of Third Party Signatures is a discretionary
        operation performed by the verifier. Messages that have valid Author Domain Signatures are
        already considered to result in a pass. When a verifier decides to assess compliance for
        Third Party Signatures with an Author Domain ADSP "dkim" tag value "tpa-sig" or "tpa-path",
        then, checked in succession, one of the following sets of conditions MUST be met for the
        result to be considered a pass.
</p>
<p>For Third Party Signatures, the following represents the set of "tpa-sig" assessment
        conditions to be checked:
</p>
<p>
        </p>
<ul class="text">
<li>The Third Party Signature MUST validate according to <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
<li>A TXT Resource Record, referenced by a TPA-Label created by the DKIM signature "d="
            tag, MUST exist in DNS.
</li>
<li>The discovered TPA-Label TXT Resource Record structure MUST be valid.
</li>
<li>The domain that created the TPA-Label MUST be within the TPA-LLD.
</li>
<li>Where a scope of 'F', 'S', or 'L' is specified, the Author Domain MUST have an Author's
            Domain Acceptable Third-Party Signature.
</li>
<li>Where a scope of 'L' or 'S' is specified, a List-ID identifier in the List-ID header
            field or a Sender header field MUST contain a domain within the TPA-LLD.
</li>
</ul>

<p>Meeting all the conditions in this set results in a "tpa-sig" pass, where subsequent checks
        are then skipped.<br />
<br />

</p>
<p>For Third Party Services where the Author Domain ADSP "dkim" tag value contains "tpa-path",
        and where the preceding assessment conditions were not met, then the following represents
        "tpa-path" assessment conditions to be checked:
</p>
<p>One of the three possible TXT Resource Records is checked in succession. Each would be
        referenced by an 'h' or 'e' or 't' related domain given by <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a> EHLO or
        HELO command, this domain with left-most label omitted, or by an 'm' related email-address
        domain within the <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a> MAIL command.<br />
<br />

</p>
<p>The TXT record discovery process continues until a TPA-Label TXT Resource Record structure
        is found where:
</p>
<p></p>
<ul class="text">
<li>The discovered TPA-Label TXT Resource Record Structure is valid.
</li>
<li>The domain that created the TPA-Label is within the TPA-LLD.
</li>
<li>The domain that created the TPA-Label corresponds with a listed scope of 'e', 'h' or
            'm' or 't'.
</li>
<li>Where a scope of 'L' or 'S' is specified, either the domain in List-ID given by <a class='info' href='#RFC2919'>[RFC2919]<span> (</span><span class='info'>Chandhok, R. and G. Wenger, &ldquo;List-Id: A Structured Field and Namespace for the Identification of Mailing Lists,&rdquo; March&nbsp;2001.</span><span>)</span></a> in the List-ID header field is within the TPA-LLD, or a Sender
            header field contains a domain within the TPA-LLD respectively.
</li>
<li>Once these four conditions have been met, for 'h' or 'm' scopes the domain MUST be
            confirmed by submitting the domain to an spf process that then returns pass. The 'e'
            scope MUST be confirmed by a forward DNS reference that resolves the address of the SMTP
            client. The 't' scope MUST be confirm the DNS-ID in the client certificate. 
</li>
</ul>

<p>Meeting all four conditions in this set, and confirming the domain, results in a "tpa-path"
          pass.<br />
<br />

</p>
<p>When the TPA-Label TXT Resource Record can not be retrieved due to some error that is
        likely transient in nature, as specified in <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a> Section 4.3. such as
        "SERVFAIL" for example, the result of the TPA-Label Resource Record compliance assessment is
        "temperror".
</p>
<p>When the TPA-Label TXT Resource Record retrieval returns a DNS "NOERROR", but not with a
        single record, the result of the TPA-Label Resource Record compliance assessment is
        "permerror".
</p>
<p>When the TPA-Label TXT Resource Record can not be retrieved with a DNS "NXDOMAIN"
        response,the result of the TPA-Label Resource Record compliance assessment is
          "nxdomain".<br />
<br />

</p>
<p>The following pass conditions are combined to provide a single pass value. </p>
<ul class="text">
<li>A "tpa-sig" pass confirms an Author Domain Acceptable Third-Party Signature.
</li>
<li>A "tpa-path" pass confirms an Author Domain Acceptable Service.<br />
<br />

          
</li>
</ul><p>
      
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
IANA Considerations</h3>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.1"></a><h3>15.1.&nbsp;
Author Domain Signing Practices (ADSP) Parameters</h3>

<p>To accommodate the extensions to ADSP Signing Practices, the IANA Registry "ADSP Outbound
          Signing Practices" defined by Section 4.2.1 of <a class='info' href='#RFC5617'>[RFC5617]<span> (</span><span class='info'>Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; August&nbsp;2009.</span><span>)</span></a> needs the
          following elements to be added:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Type</th><th align="center">Reference</th></tr>
<tr>
<td align="center">tpa-sig</td>
<td align="center">(this document)</td>
</tr>
<tr>
<td align="center">tpa-path</td>
<td align="center">(this document)</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-Label Resource Record validation Method&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
          
        
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.2"></a><h3>15.2.&nbsp;
Email Authentication Method Registry</h3>

<p>To accommodate the method derived from TPA-Label Resource Record processing, the IANA
          Registry "Email Authentication Method" defined by Section 6.2 of <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>
          needs the following elements to be added:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="center" width="10%"><col align="center" width="10%"><col align="left"><col align="left">
<tr><th align="left">Method</th><th align="center">Defined</th><th align="center">ptype</th><th align="left">property</th><th align="left">value</th></tr>
<tr>
<td align="left">tpa-lld</td>
<td align="center">(this document)</td>
<td align="center">header field</td>
<td align="left">d</td>
<td align="left">value of signature "d" tag. The dkim method results from <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>
            should also be included in a Authenticated Results header field</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="left">scope</td>
<td align="left">value of <a class='info' href='#scope-registry'>scope<span> (</span><span class='info'>Third Party Authorizations Scope Registry</span><span>)</span></a> tag. (When 'scope' contains 'e',
            'h' or 'm', the <a class='info' href='#RFC5451'>iprev<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a> [RFC5451] (Section 3) method results should
            also be included in the Authenticated-Results header field to capture the SMTP client IP
            address.</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="left">ca-scope</td>
<td align="left">The <a class='info' href='#scope-registry'>scopes<span> (</span><span class='info'>Third Party Authorizations Scope Registry</span><span>)</span></a> with a compliance assessment as
            pass</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="left">tpa</td>
<td align="left">Value of <a class='info' href='#tpa-defn'>tpa<span> (</span><span class='info'>Authorized Signing Domain</span><span>)</span></a> tag at time of compliance assessment</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-Label Resource Record validation Method&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
          
        
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.3"></a><h3>15.3.&nbsp;
Email Authentication Result Names Registry</h3>

<p>To accommodate the results derived from TPA-Label Resource Record processing, the IANA
          Registry "Email Authentication Method" defined by Section 6.3 of <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>
          needs the following elements added:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="20%"><col align="left"><col align="left">
<tr><th align="left">code</th><th align="left">method</th><th align="left">meaning</th></tr>
<tr>
<td align="left">none</td>
<td align="left">tpa-lld</td>
<td align="left">No TPA-Label was published</td>
</tr>
<tr>
<td align="left">pass</td>
<td align="left">tpa-lld</td>
<td align="left"><a class='info' href='#auth-meaning'>Section&nbsp;14<span> (</span><span class='info'>TPA-Label Resource Record Compliance Assessment</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">tempfail</td>
<td align="left">tpa-lld</td>
<td align="left"><a class='info' href='#auth-meaning'>Section&nbsp;14<span> (</span><span class='info'>TPA-Label Resource Record Compliance Assessment</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">permfail</td>
<td align="left">tpa-lld</td>
<td align="left"><a class='info' href='#auth-meaning'>Section&nbsp;14<span> (</span><span class='info'>TPA-Label Resource Record Compliance Assessment</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">unknown</td>
<td align="left">tpa-lld</td>
<td align="left">The TPA-Label Resource Record had a tag/value of "dkim=unknown" and the Third Party
            Signature failed its compliance assessment.</td>
</tr>
<tr>
<td align="left">discard</td>
<td align="left">tpa-lld</td>
<td align="left">The TPA-Label Resource Record had a tag/value of dkim=discard and the Third Party
            Signature failed its compliance assessment.</td>
</tr>
<tr>
<td align="left">fail</td>
<td align="left">tpa-lld</td>
<td align="left">The TPA-Label Resource Record had a tag/value of dkim=all and the Third Party Signature
            failed to its compliance assessment.</td>
</tr>
<tr>
<td align="left">nxdomain</td>
<td align="left">tpa-lld</td>
<td align="left">When obtaining the TPA-Label Resource Record, DNS indicated this domain does not exist. </td>
</tr>
<tr>
<td align="left">Other value defined in the IANA ADSP Outbound Signing Practices Registry</td>
<td align="left">tpa-lld</td>
<td align="left">The TPA-Label Resource Record had a tag/value of dkim={other value} and the Third Party
            Signature failed its compliance assessment.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-Label Resource Record complaince assessment Results&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.4"></a><h3>15.4.&nbsp;
Third Party Authorizations Labels Registry</h3>

<p>Names of tags that are valid in TPA-Label Resource Records with the exception of
          experimental tags <a class='info' href='#tpalabel-rr'>Section&nbsp;9<span> (</span><span class='info'>TPA-Label TXT Resource Record Structure</span><span>)</span></a> MUST be registered in this created IANA
          registry.
</p>
<p>New entries are assigned only for values that have been documented in a published RFC
          that has had IETF Review, per <a class='info' href='#RFC5226'>IANA CONSIDERATIONS<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226].
</p>
<p>Each tag registered must correspond to a definition.
</p>
<p>The initial set of values for this registry is:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="20%"><col align="left"><col align="left">
<tr><th align="left">tag</th><th align="left">defined</th><th align="left">definition</th></tr>
<tr>
<td align="left">dkim</td>
<td align="left">
            <a class='info' href='#tpalabel-rr'>Section&nbsp;9<span> (</span><span class='info'>TPA-Label TXT Resource Record Structure</span><span>)</span></a>
          </td>
<td align="left">As per IANA Registry ADSP Outbound Signing Practices</td>
</tr>
<tr>
<td align="left">tpa-sig</td>
<td align="left">
            <a class='info' href='#oesp-defn'>Section&nbsp;11<span> (</span><span class='info'>Outbound Extended Signing Practice</span><span>)</span></a>
          </td>
<td align="left">DKIM auth</td>
</tr>
<tr>
<td align="left">tpa-path</td>
<td align="left">
            <a class='info' href='#oesp-defn'>Section&nbsp;11<span> (</span><span class='info'>Outbound Extended Signing Practice</span><span>)</span></a>
          </td>
<td align="left">DKIM or path auth</td>
</tr>
<tr>
<td align="left">all tpa-sig</td>
<td align="left">
            <a class='info' href='#oesp-defn'>Section&nbsp;11<span> (</span><span class='info'>Outbound Extended Signing Practice</span><span>)</span></a>
          </td>
<td align="left">Same as tpa-sig</td>
</tr>
<tr>
<td align="left">scope</td>
<td align="left">
            <a class='info' href='#scope-defn'>Section&nbsp;12<span> (</span><span class='info'>TPA-Label Resource Record Scope Syntax</span><span>)</span></a>
          </td>
<td align="left">
            <a class='info' href='#scope-registry'>Section&nbsp;15.5<span> (</span><span class='info'>Third Party Authorizations Scope Registry</span><span>)</span></a>
          </td>
</tr>
<tr>
<td align="left">tpa</td>
<td align="left">
            <a class='info' href='#tpa-defn'>Section&nbsp;12.1<span> (</span><span class='info'>Authorized Signing Domain</span><span>)</span></a>
          </td>
<td align="left">List of Authorized Domains or Identifiers </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-Label Resource Record compliance assessment Results&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="scope-registry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.5"></a><h3>15.5.&nbsp;
Third Party Authorizations Scope Registry</h3>

<p>Values that correspond to <a class='info' href='#scope-defn'>Section&nbsp;12<span> (</span><span class='info'>TPA-Label Resource Record Scope Syntax</span><span>)</span></a> MUST be registered in this created
          registry:
</p>
<p>New entries are assigned only for values that have been documented in a published RFC
          that has had IETF Review, per <a class='info' href='#RFC5226'>IANA CONSIDERATIONS<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226].
</p>
<p>Each value registered must correspond to a definition.
</p>
<p>The initial set of values for this registry is:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">value</th><th align="left">defined</th></tr>
<tr>
<td align="left">F</td>
<td align="left">
            <a class='info' href='#scopeF-defn'>Section&nbsp;12.2<span> (</span><span class='info'>TPA-Label Listed Domain Authorization</span><span>)</span></a>
          </td>
</tr>
<tr>
<td align="left">L</td>
<td align="left">
            <a class='info' href='#scopeL-defn'>Section&nbsp;12.3.1<span> (</span><span class='info'>List-ID Header Field</span><span>)</span></a>
          </td>
</tr>
<tr>
<td align="left">S</td>
<td align="left">
            <a class='info' href='#scopeS-defn'>Section&nbsp;12.3.2<span> (</span><span class='info'>Sender Header Field</span><span>)</span></a>
          </td>
</tr>
<tr>
<td align="left">h</td>
<td align="left">
            <a class='info' href='#scopeH-defn'>Section&nbsp;12.5<span> (</span><span class='info'>SMTP Host domains</span><span>)</span></a>
          </td>
</tr>
<tr>
<td align="left">e</td>
<td align="left">
            <a class='info' href='#scopeE-defn'>Section&nbsp;12.4<span> (</span><span class='info'>SMTP Host domains</span><span>)</span></a>
          </td>
</tr>
<tr>
<td align="left">m</td>
<td align="left">
            <a class='info' href='#scopeM-defn'>Section&nbsp;12.6<span> (</span><span class='info'>MailFrom Parameter</span><span>)</span></a>
          </td>
</tr>
<tr>
<td align="left">t</td>
<td align="left">
            <a class='info' href='#scopeT-defn'>Section&nbsp;12.7<span> (</span><span class='info'>SMTP Host domains</span><span>)</span></a>
          </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;TPA-Label Resource Record compliance assessment Results&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
Security Considerations</h3>

<p>This draft extends signing practices for <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> where most generic DKIM
        Signature related security matters are discussed. Additional considerations are also
        included in <a class='info' href='#I-D.ietf-dkim-mailinglists'>[I&#8209;D.ietf&#8209;dkim&#8209;mailinglists]<span> (</span><span class='info'>Kucherawy, M., &ldquo;DKIM And Mailing Lists,&rdquo; July&nbsp;2010.</span><span>)</span></a>. Security considerations for the
        TPA-LLD scheme are mostly related to attempts on the part of malicious senders to falsely
        represent themselves as other senders, often in an attempt to defraud either the recipient
        or the alleged originator.
</p>
<p>Additional security considerations regarding DKIM signing practices may be found in the
        DKIM threat analysis <a class='info' href='#RFC4686'>[RFC4686]<span> (</span><span class='info'>Fenton, J., &ldquo;Analysis of Threats Motivating DomainKeys Identified Mail (DKIM),&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.1"></a><h3>16.1.&nbsp;
Benefits to Recipients</h3>

<p>The verifier, after finding either an Author's Domain Acceptable Third-Party Signature or
          Author's Domain Acceptable Third-Party Service in a message, will have significantly
          greater confidence in the Third-Party, than when no TPA-Label Resource Record is obtained.
          This enhanced confidence may, at the recipients' discretion, cause a message to be
          delivered to the recipient without further source related assessment.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.2"></a><h3>16.2.&nbsp;
Risks to Recipients</h3>

<p>The decisions a recipient makes in regard to message filtering based on TPA-Label
          Resource Records are likely to depend on the system integrity of the Third Party with
          respect to the Authentication (see <a class='info' href='#tpa-auth'>Section&nbsp;5.1<span> (</span><span class='info'>Third Party Authentication</span><span>)</span></a>) and the provided scope
          labels. When the 'e', 'h', or 'm' scoped domain is not confirmed or the third-party domain
          does not authenticate the sender, there is a risk of accepting potentially spoofed
          messages. When there is no out-of-band authentication confirming the sender,
          Authentication-Results header fields then play an important role. Without proper
          Authentication-Results handling by the third-party, there is also risk of accepting
          potentially spoofed messages.
</p>
<p>With this specification, third party signatures have verifiable value. When implementing
          the compliance assessment of third party signatures and TPA-Label Resource Records,
          implementers need to consider the possibility that a Bad Actor will send the recipient a
          message with a large number of valid DKIM Signatures. Verifying all of these may consume a
          large amount of processing resources such that it may be worth checking the existence of a
          TPA-Label Resource Record first. <a class='info' href='#tpa-qt'>Section&nbsp;13<span> (</span><span class='info'>TPA-Label Resource Record Query Transactions</span><span>)</span></a> describes a quick check to see if
          TPA-Label Resource Records may exist. Additionally validating DKIM signatures and
          obtaining related resource records might be limited to known trustworthy domains.
</p>
<p>Services that depend only upon path authorizations might permit the Author Domain to be
          spoofed and yet obtain acceptance. During such events, the Author Domain might need to
          retract its authorization from the service. For this reason, "tpa-path" authorization
          should only be used as a carefully monitored interim solution.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.3"></a><h3>16.3.&nbsp;
Benefits to Author Domains</h3>

<p>TPA-Label resource records can replace domain delegations, selector/key record mirroring,
          or key exchanges. A significant number of details are associated with selector/key
          records. These details include user limitations, suitable services, key resource record's
          Time-To-Live, revocation and update procedures, and how the DKIM Signature header field's
          'i=' semantics are to be applied. In addition, services that depend upon DKIM keys are
          better secured by not delegating these DKIM keys, where instead the TPA-LLD scheme allows
          Author Domains an ability to limit the scope of their authorizations, while also not being
          mistaken for having authenticated the entity submitting the message.
</p>
<p>TPA-Label Resource Records convey which domains are authoritative even when they are not
          the Author Domain. However, authorized domains are unable to utilize the DKIM signature's
          'i=' semantics to directly assert which identifiers on whose behalf a signature was added.
          As such, no domain should be authorized unless it is trusted to ensure the Alleged Author
          of an email undergoes authentication that offers acceptable protections for the Author
          Domain. For example, such authentication might ensure submitting entities have
          demonstrated receipt of "pingback" messages sent to the Author Address contained within
          the messages being signed.
</p>
<p>By deploying TPA-Label Resource Records, Author Domains benefit when recipients assess
          signing practice compliance by using the TPA-LLD scheme. These recipients will be less
          likely to drop the Author Domain's genuine messages, whenever the Author Domain attempts
          to restrict acceptance. Restricting acceptance of non-compliant messages is the basic
          motivation for publishing ADSP records. In addition, recipients are more likely to
          validate Authorized Third Party Domain Signatures.
</p>
<p>Broader use of restrictive ADSP policies provides a better likelihood of being able to
          eliminate a greater range of non-compliant messages, in addition to improving acceptance
          from authorized sources. With authorization, scope labels allow the Author Domain to
          control message attributes even from the authorized third parties.
</p>
<p>Signing domains having good reputations referenced by a TPA-LLD might therefore provide a
          means to safely extend limited compliance assessment resources to otherwise unknown
          domains or SMTP Clients.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.4"></a><h3>16.4.&nbsp;
Risks to Author Domains</h3>

<p>As indicated in <a class='info' href='#eval-3p-tpa-domain'>Section&nbsp;5<span> (</span><span class='info'>Evaluating the Third-party Signing Domain or Service</span><span>)</span></a>, there is ultimately a trust of the
          third party domain to do the right thing and not generate, or allow others to generate,
          messages that falsely appear to be from the Author Domain. The authentication methods in
          place for different email elements need to be carefully reflected in the scope of the TPA
          records.
</p>
<p>By authorizing mailing lists with TPA-Label Resource Records, this could cause a loss of
          confidentiality in mailing list participation by the Author Domain. This might help Bad
          Actors deduce which subscription related email the Author Domain may receive. Because of
          the hashing function in generating the TPA-label, anyone wishing to discover which domains
          are being authorized, has to probe each TPA-label based on the exact signing domain. In
          addition, service organizations or community groups are able to share comprehensive lists
          which means, even though the domain has been authorized, that in itself does not mean the
          Author Domain is exchanging messages with the authorized domain.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.5"></a><h3>16.5.&nbsp;
Benefits to Third Party Signers</h3>

<p>Third Party Signers benefit by allowing those using their service, the autonomy to
          authorize their service without needing to exchange DKIM key related details. This is
          particularly useful for mailing lists.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.6"></a><h3>16.6.&nbsp;
Risks caused by Third Party Signers</h3>

<p>As mentioned before, Third Party Signers need to authenticate messages from Author
          Domains. This authentication provides a safety mechanism for the Author Domain and their
          recipients. The Third Party may not be aware of the authentication value or the message
          elements involved and make changes without understanding the impact this may have upon
          targeted Author Domains and their recipients. For example, the Third Party might stop DKIM
          signing or stop applying Authentication-Results header fields. The unexpected exposure
          might enable wide spread abuse and prove detrimental for both the Author Domain and their
          recipients.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.7"></a><h3>16.7.&nbsp;
SHA-1 Collisions</h3>

<p>The use of the SHA-1 hash algorithm does not represent a security concern. The hash
          simply ensures a deterministic domain-name size is achieved. Unexpected collisions can be
          detected and handled by using the extended TPA-Label Resource Record "tpa=" option. The
          use of TPA-Label Resource Records without the TPA-Label "tpa=" options does present an
          opportunity for an adversary to attempt to find a hash collision. Message spoofing outside
          the realm of DKIM protection is likely easier to achieve than finding hash collisions.
          There is minimal risk of TPA-Labels colliding. Listing 3 x 10^45 domains has less than a
          0.1 percent risk of any two domain labels colliding.
</p>
<a name="DNS"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16.8"></a><h3>16.8.&nbsp;
DNS Limits</h3>

<p>Use of the TPA-Label Resource Records, rather than simply listing the authorized domain,
          ensures the DNS record size is independent of the Third Party Domain. The typical domain
          name size has been steadily increasing. This increase has been caused by domain names that
          encode international character sets. Perhaps soon there will be a further increase spurred
          by an expanse of TLDs having larger international labels.
</p>
<p>The maximum domain name size allowed, per <a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> Section 3, is 255
          bytes (or octets). Each label has a byte for its length. Every domain name has a right
          most label representing the root with a zero length, for another byte. A scheme that
          concatenates a listed domain with the publishing domain, separated by some conventional
          label, reduces the maximal domain name in half, where the conventional label reduces this
          further.
</p>
<p>If "_tpa." were used as the conventional label with a simple listing method, the maximum
          domain name size this supports would be 122 bytes. The suffix for TPA-Labels is
          "_tpa.domainkey." which consumes 16 bytes. The TPA-Label itself consumes 34 bytes. A
          domain that publishes the TPA-labels in its domain would then have 205 bytes available for
          their Author Domain. Since an Author's Domain Acceptable Third-Party Service might not
          implement DKIM, the TPA-Label is still able to authorize any domain name with a valid
          length. As a result, the maximum allowable Author Domain is increased by 83 bytes or
          68&#37; over simple name concatenation.
</p>
<p>Normally, DNS messages should not exceed 512 bytes as per Section 2.3.4 of <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>. Using TPA-Label Resource Records in the DNS, as described by this
          document, consumes a consistent 50 bytes, in addition to the domain name publishing the
          TPA-Labels. With this being constant, a limit can be determined as a constraint to
          resource record size, to ensure a response does not exceed the maximum DNS message size.
          DNS servers that add additional resource records, for nameservers as an example, will
          further reduce available resource record capacity. Domains publishing TPA-Labels exceeding
          the DNS message limit will need to rely on recipients using TCP for DNS retrieval, or
          EDNS0 <a class='info' href='#RFC2671'>[RFC2671]<span> (</span><span class='info'>Vixie, P., &ldquo;Extension Mechanisms for DNS (EDNS0),&rdquo; August&nbsp;1999.</span><span>)</span></a> for extended DNS lengths. <br />
<br />

</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17"></a><h3>17.&nbsp;
Acknowledgements</h3>

<p>Jeff MacDonald, Michael Deutschmann, Frank Ellermann, Murray Kucherawy, and Wietse
          Venema.<br />
<br />
<br />
<br />
<br />
<br />

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.18"></a><h3>18.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>18.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS.180-2.2002">[FIPS.180-2.2002]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">Secure Hash Standard</a>,&rdquo; FIPS&nbsp;PUB 180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.saintandre-tls-server-id-check">[I-D.saintandre-tls-server-id-check]</a></td>
<td class="author-text">Saint-Andre, P. and J. Hodges, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-saintandre-tls-server-id-check-09.txt">Representation and Verification of Domain-Based Application Service Identity in Certificates Used with Transport Layer Security</a>,&rdquo; draft-saintandre-tls-server-id-check-09 (work in progress), August&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-saintandre-tls-server-id-check-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2919">[RFC2919]</a></td>
<td class="author-text">Chandhok, R. and G. Wenger, &ldquo;<a href="http://tools.ietf.org/html/rfc2919">List-Id: A Structured Field and Namespace for the Identification of Mailing Lists</a>,&rdquo; RFC&nbsp;2919, March&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2919.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3207">[RFC3207]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc3207">SMTP Service Extension for Secure SMTP over Transport Layer Security</a>,&rdquo; RFC&nbsp;3207, February&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3207.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4408">[RFC4408]</a></td>
<td class="author-text">Wong, M. and W. Schlitt, &ldquo;<a href="http://tools.ietf.org/html/rfc4408">Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1</a>,&rdquo; RFC&nbsp;4408, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4408.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5321">[RFC5321]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;5321, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5322">[RFC5322]</a></td>
<td class="author-text"><a href="mailto:presnick@qualcomm.com">Resnick, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>,&rdquo; RFC&nbsp;5322, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5322.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc5322.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc5322.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5451">[RFC5451]</a></td>
<td class="author-text">Kucherawy, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5451">Message Header Field for Indicating Message Authentication Status</a>,&rdquo; RFC&nbsp;5451, April&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5451.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5617">[RFC5617]</a></td>
<td class="author-text">Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;<a href="http://tools.ietf.org/html/rfc5617">DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)</a>,&rdquo; RFC&nbsp;5617, August&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5617.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>18.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dkim-mailinglists">[I-D.ietf-dkim-mailinglists]</a></td>
<td class="author-text">Kucherawy, M., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-mailinglists-01.txt">DKIM And Mailing Lists</a>,&rdquo; draft-ietf-dkim-mailinglists-01 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-mailinglists-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1930">[RFC1930]</a></td>
<td class="author-text"><a href="mailto:jhawk@bbnplanet.com">Hawkinson, J.</a> and <a href="mailto:Tony.Bates@mci.net">T. Bates</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1930">Guidelines for creation, selection, and registration of an Autonomous System (AS)</a>,&rdquo; BCP&nbsp;6, RFC&nbsp;1930, March&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1930.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2671">[RFC2671]</a></td>
<td class="author-text"><a href="mailto:vixie@isc.org">Vixie, P.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2671">Extension Mechanisms for DNS (EDNS0)</a>,&rdquo; RFC&nbsp;2671, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2671.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2672">[RFC2672]</a></td>
<td class="author-text"><a href="mailto:crawdad@fnal.gov">Crawford, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2672">Non-Terminal DNS Name Redirection</a>,&rdquo; RFC&nbsp;2672, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2672.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4954">[RFC4954]</a></td>
<td class="author-text">Siemborski, R. and A. Melnikov, &ldquo;<a href="http://tools.ietf.org/html/rfc4954">SMTP Service Extension for Authentication</a>,&rdquo; RFC&nbsp;4954, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4954.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5016">[RFC5016]</a></td>
<td class="author-text">Thomas, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5016">Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol</a>,&rdquo; RFC&nbsp;5016, October&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5016.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5672">[RFC5672]</a></td>
<td class="author-text">Crocker, D., &ldquo;<a href="http://tools.ietf.org/html/rfc5672">RFC 4871 DomainKeys Identified Mail (DKIM) Signatures -- Update</a>,&rdquo; RFC&nbsp;5672, August&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5672.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5863">[RFC5863]</a></td>
<td class="author-text">Hansen, T., Siegel, E., Hallam-Baker, P., and D. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc5863">DomainKeys Identified Mail (DKIM) Development, Deployment, and Operations</a>,&rdquo; RFC&nbsp;5863, May&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5863.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="apwg-globalphishingsurvey-2H2009">[apwg-globalphishingsurvey-2H2009]</a></td>
<td class="author-text">Anti-Phishing Working Group, &ldquo;<a href="http://www.antiphishing.org/reports/APWG_GlobalPhishingSurvey_2H2009.pdf">Global Phishing Survey: Trends and Domain Name Use 2H2009</a>,&rdquo; May&nbsp;2009.</td></tr>
</table>

<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
DNS Example of TPA-Label Resource Record placement</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
####
# Practices for Example.com email domain using example.com, isp.com,
# and example.com.isp.com as signing domains.
####

#### 5322.From authorization for 3P domains ####

## "isp.com" TPA-Label Resource Record ##
_HTIE4SWL3L7G4TKAFAUA7UYJSS2BTEOV._tpa._domainkey.example.com. IN TXT
  "dkim=all tpa-sig; tpa=isp.com; scope=F;"

#### 5322.Sender/List-ID authorization for 3P domains ####

## "example.com.isp.com" TPA-Label Resource Record ##
_6MEHLQLKWAL5HQREXWDN2TBXAJ6VZ44B._tpa._domainkey.example.com.  IN TXT
  "dkim=all tpa-sig; tpa=*.isp.com; scope=L S;"
</pre></div>
<p>
        
      
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
C code for label generation</h3>

<p>The following utility can be compiled as tpa-label.c using the following:
</p>
<p>gcc -lcrypto tpa-label.c -o tpa-label
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
/*
 * TPA-Label generation utility
 * Copyright (c) 2010 IETF Trust and the persons identified as the
 * document authors.  All rights reserved.
 *
 * This document is subject to BCP 78 and the IETF Trust's Legal
 * Provisions Relating to IETF Documents
 * (http://trustee.ietf.org/license-info) in effect on the date of
 * publication of this document.  Please review these documents
 * carefully, as they describe your rights and restrictions with respect
 * to this document.  Code Components extracted from this document must
 * include Simplified BSD License text as described in Section 4.e of
 * the Trust Legal Provisions and are provided without warranty as
 * described in the Simplified BSD License.
 *
 * This document and the information contained herein are provided on an
 * "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
 * OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
 * THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
 * THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
 * WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 */

#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stddef.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;ctype.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;errno.h&gt;
#include &lt;openssl/sha.h&gt;

#define TPA_LABEL_VERSION   102
#define MAX_DOMAIN_NAME     256
#define MAX_FILE_NAME       1024

static char base32[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
static char sign_on[] =
{"%s v%d.%02d Copyright (C) (2010)  The IETF Trust, Otis &amp; Black\n"};
char err_cmd[] =\
 "ERR: Command error with [%s]\n";
char use_txt[]=\
 "Usage: tpa-label [-i domain_input_file] [-o label_output_file][-v]\n";
char help_txt[]=\
 "The options are as follows:\n"\
 "-i  domain name input. Defaults to stdin. Removes trailing '.'\n"\
 "-o  TPA-Label output.  Defaults to stdout.\n"\
 "-v  Specifies Verbose Mode.\n\n";

static void usage(void);
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */

static void
usage(void)
{
    (void) fprintf(stderr, "\n%s%s", use_txt, help_txt);
    exit(1);
}
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */

int
main (int argc, char * argv[])
{
    int  ret_val, in_mode, out_mode, verbose, done, i, j, k;
    char ch;
    unsigned int len;
    unsigned long long b_5;
    char in_fn[MAX_FILE_NAME], out_fn[MAX_FILE_NAME];
    unsigned char in_buf[MAX_DOMAIN_NAME + 2];
    unsigned char sha_res[20], tpa_label[33];
    FILE *in_file, *out_file;

    ret_val = in_mode = out_mode = verbose = done = 0;
    len = 0;

    while ((ch = getopt(argc, argv, "i:o:v")) != -1)
    {
        switch (ch)
        {
            case 'i':
                in_mode = 1;          /* input from file */
                (void) strncpy(in_fn, optarg, sizeof(in_fn));
                in_fn[sizeof(in_fn) - 1] = '\0';
                break;
            case 'o':
                out_mode = 1;         /* out to file */
                (void) strncpy(out_fn, optarg, sizeof(out_fn));
                out_fn[sizeof(out_fn) - 1] = '\0';
                break;
            case 'v':
                verbose = 1;
                break;
            case '?':
            default:
                (void) usage();
                break;
        }
    };

    if (in_mode)
    {
        if ((in_file = fopen(in_fn, "r")) == NULL)
        {
            (void) fprintf(stderr,
                           "ERR: Error opening [%s] input file.\n",
                           in_fn);
            exit(2);
        }
    }
    else
    {
        in_file = stdin;
    }

    if (out_mode)
    {
        if ((out_file = fopen(out_fn, "w")) == NULL)
        {
            (void) fprintf(stderr,
                           "ERR: Error opening [%s] output file.\n",
                           out_fn);
            exit(3);
        }
    }
    else
    {
        out_file = stdout;
    }

    if (out_mode &amp;&amp; verbose)
    {
        (void) printf(sign_on, "tpa-label utility",
                      TPA_LABEL_VERSION / 100,
                      TPA_LABEL_VERSION % 100);
    }

    for (i = 0; i &lt; MAX_DOMAIN_NAME &amp;&amp; !done; i++)
    {
        if ((ch = fgetc(in_file)) == EOF)
        {
            ch = 0;
        }
        else  if (ch == '\n' || ch == '\r')
        {
            ch = 0;
        }

        in_buf[i] = tolower(ch);

        if (ch == 0)
        {
            len = i;         /* string length */
            done = 1;
        }
    }

    if (!done)
    {
        (void) fprintf(stderr, "ERR: Domain name too long.\n");
        exit (4);
    }

    if (len &amp;&amp; in_buf[len - 1] == '.')    /* remove any trailing "." */
    {
        len--;
        in_buf[len] = 0;     /* replace trailing "." with 0 */
    }

    in_buf[len] = 0;         /* terminate string */

    if (len &lt; 2)
    {
        (void)
        fprintf(stderr,
                "ERR: Domain name [%s] too short with %d length.\n",
                in_buf,
                len);
        exit (5);
    }

    SHA1(in_buf, len, sha_res);

    if (verbose)
    {
        printf("Normalized Domain = [%s] %d, SHA-1 = ", in_buf, len);

        for (i = 0; i &lt; 20; i++)
        {
            printf("%02x", sha_res[i]);
        }
        printf("\nTPA-Label: 5 bit intervals left to right.\n");
    }

    /* process sha1 results 4 times by 40 bits (160 bits) */
    for (i = 0, j = 0; i &lt; 4 ; i++)
    {
        b_5 =  (unsigned long long) sha_res[(i * 5)] &lt;&lt; 32;
        b_5 |= (unsigned long long) sha_res[(i * 5) + 1] &lt;&lt; 24;
        b_5 |= (unsigned long long) sha_res[(i * 5) + 2] &lt;&lt; 16;
        b_5 |= (unsigned long long) sha_res[(i * 5) + 3] &lt;&lt; 8;
        b_5 |= (unsigned long long) sha_res[(i * 5) + 4];

        if (verbose)
        {
            printf(" {%010llX}-&gt;", b_5);
        }

        for (k = 35; k &gt;= 0; k-= 5, j++)    /* convert 40 bits (5x8) */
        {
            tpa_label[j] = base32[(b_5 &gt;&gt; k) &amp; 0x1F];

            if (verbose)
            {
                printf(" %02X:%c",
                       (unsigned int)(b_5 &gt;&gt; k) &amp; 0x1F,
                       tpa_label[j]);
            }
        }
        if (verbose)
        {
            printf ("\n");
        }
    }
    if (verbose)
    {
        printf("\n");
    }
    tpa_label[j] = 0;   /* terminate label string */
    fprintf(out_file, "_%s", tpa_label);
    printf("\n");

    /* close */
    if (out_mode)
    {
        if (fclose (out_file) != 0)
        {
            (void) fprintf(stderr,
                           "ERR: Unable to close %s output file.\n",
                           out_fn);
            ret_val = 6;
        }
    }
    if (in_mode)
    {
        if (fclose (in_file) != 0)
        {
            (void) fprintf(stderr,
                           "ERR: Unable to close %s input file.\n",
                           in_fn);
            ret_val = 7;
        }
    }
    return (ret_val);
 }
</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Douglas Otis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trend Micro</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10101 N. De Anza Blvd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.408.257-1500</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:doug_otis@trendmicro.com">doug_otis@trendmicro.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Daniel Black</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canberra ACT</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:daniel.subs@internode.on.net">daniel.subs@internode.on.net</a></td></tr>
</table>
</body></html>
