<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Extensions to Resource Reservation Protocol - Traffic Engineering (RSVP-TE) for Hub and Spoke Multipoint Label Switched Paths (LSPs) </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Application">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Time Synchronization">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 P2MP Pseudowire based L2VPNs (VPMS and VPLS)">
<link href="#rfc.section.2" rel="Chapter" title="2 Comparing Hub-Spoke MP LSP with P2MP and Unidirectional Reverse LSP">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Number of Path and Resv State Blocks">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Hardware Programming and Label Utilization">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 RSVP Control Traffic">
<link href="#rfc.section.3" rel="Chapter" title="3 Setting up a Hub and Spoke Multipoint LSP with RSVP-TE">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Hub and Spoke Multipoint LSP and Path Messages">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Procedures for Hub and Spoke Multipoint LSP">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Bandwidth Allocation">
<link href="#rfc.section.4" rel="Chapter" title="4 Setting up the Hub Spoke Multipoint  LSP">
<link href="#rfc.section.5" rel="Chapter" title="5 Grafting">
<link href="#rfc.section.6" rel="Chapter" title="6 Pruning">
<link href="#rfc.section.7" rel="Chapter" title="7 Refresh Reduction">
<link href="#rfc.section.8" rel="Chapter" title="8 Fast Reroute">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgements">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="In Multiprotocol Label Switching (MPLS) and Generalized MPLS (GMPLS) environment, the RSVP-TE based Point-to-Multipoint (P2MP) LSP allows traffic to transmit from root to leaf node, but there is no co-routed reverse path for traffic from leaf to root node. This draft introduces a Hub and Spoke Multipoint (HSMP) LSP, which allows traffic from both the root to the leaves through a P2MP LSP and also the leaves to the root along a co-routed reverse path. " />
  <meta name="description" content="In Multiprotocol Label Switching (MPLS) and Generalized MPLS (GMPLS) environment, the RSVP-TE based Point-to-Multipoint (P2MP) LSP allows traffic to transmit from root to leaf node, but there is no co-routed reverse path for traffic from leaf to root node. This draft introduces a Hub and Spoke Multipoint (HSMP) LSP, which allows traffic from both the root to the leaves through a P2MP LSP and also the leaves to the root along a co-routed reverse path. " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">CCAMP Working Group</td>
<td class="right">L. Jin</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">ZTE Corporation</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">F. Jounay</td>
</tr>
<tr>
<td class="left">Expires: August 22, 2011</td>
<td class="right">France Telecom</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">M.B. Bhatia</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Alcatel-Lucent</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">February 18, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Extensions to Resource Reservation Protocol - Traffic Engineering (RSVP-TE) for Hub and Spoke Multipoint Label Switched Paths (LSPs) <br />
  <span class="filename">draft-jjb-ccamp-rsvp-te-hsmp-lsp-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>In Multiprotocol Label Switching (MPLS) and Generalized MPLS (GMPLS) environment, the RSVP-TE based Point-to-Multipoint (P2MP) LSP allows traffic to transmit from root to leaf node, but there is no co-routed reverse path for traffic from leaf to root node. This draft introduces a Hub and Spoke Multipoint (HSMP) LSP, which allows traffic from both the root to the leaves through a P2MP LSP and also the leaves to the root along a co-routed reverse path. </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 22, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Application</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Time Synchronization</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">P2MP Pseudowire based L2VPNs (VPMS and VPLS)</a>
</li>
<li>2.   <a href="#rfc.section.2">Comparing Hub-Spoke MP LSP with P2MP and Unidirectional Reverse LSP</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Number of Path and Resv State Blocks</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Hardware Programming and Label Utilization</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">RSVP Control Traffic</a>
</li>
<li>3.   <a href="#rfc.section.3">Setting up a Hub and Spoke Multipoint LSP with RSVP-TE</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Hub and Spoke Multipoint LSP and Path Messages</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Procedures for Hub and Spoke Multipoint LSP</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Bandwidth Allocation</a>
</li>
<li>4.   <a href="#rfc.section.4">Setting up the Hub Spoke Multipoint  LSP</a>
</li>
<li>5.   <a href="#rfc.section.5">Grafting</a>
</li>
<li>6.   <a href="#rfc.section.6">Pruning</a>
</li>
<li>7.   <a href="#rfc.section.7">Refresh Reduction</a>
</li>
<li>8.   <a href="#rfc.section.8">Fast Reroute</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgements</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<li>12.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <p id="rfc.section..p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC2119 <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section..p.2">When used in lower case, these words convey their typical use in common language, and are not to be interpreted as described in RFC2119 <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Application</h1>
<p id="rfc.section.1.p.1">The proposed technique targets one-to-many applications that require reverse one-to-one traffic flow (thus many one-to-one in the reverse direction). </p>
<p id="rfc.section.1.p.2">There are a few applications that could use such kind of Resource Reservation Protocol - Traffic Engineering (RSVP-TE) based Hub and Spoke Multipoint LSPs. </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Time Synchronization</h1>
<p id="rfc.section.1.1.p.1">The delivery of time synchronization to end equipments, such as base stations, can be achieved using a time protocol as <a href="#IEEE">[IEEE]</a> (also known as PTP). This protocol defines Transparent Clock (TC) function, which can be used in transport nodes to improve the accuracy of time synchronization. Two types of TCs exist in <a href="#IEEE">[IEEE]</a>: End-to-end Transparent Clock (E2E TC) and Peer-to-peer Transparent Clock (P2P TC). P2P TCs assume that the link delays between the different nodes are calculated </p>
<p id="rfc.section.1.1.p.2">Assuming that a chain of P2P TCs is used between a PTP master and a PTP slave, time synchronization can be delivered to the PTP slave by sending timestamps only in the direction master to slave (one way mode), via PTP Sync messages. This is possible because of the link delay calculation performed locally by each node, which enables it to calculate the propagation delay over the path. This scenario permits that the same PTP Sync messages would be sent by the PTP master to all the PTP slaves. </p>
<p id="rfc.section.1.1.p.3">In this scenario (chain of P2P TCs), the PTP slave might have to send also messages (not carrying timestamps) back to the PTP master in some cases. For instance, PTP Signaling messages could be sent back to the PTP master. These PTP Signaling messages are not intended to be received by the other PTP slaves. </p>
<p id="rfc.section.1.1.p.4">By using Point-to-Multipoint (P2MP) technology to transmit PTP Sync messages will greatly improve the bandwidth usage for above applications. This will also be useful for monitoring performance metrics for two-way delay and related metrics such as delay variation and loopback measurement. Current RSVP-TE based Point-to-Multipoint LSP mechanism only provides unidirectional path from the root to the leaf nodes, which cannot fulfill the above new requirement (i.e. need for a reverse path for the PTP Signaling messages). </p>
<p id="rfc.section.1.1.p.5">This draft attempts to solve this problem. RSVP-TE based Hub and Spoke P2MP LSP described in this draft provides a co-routed reverse path from the leaf to the root based on current unidirectional Point-to-Multipoint LSP. </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> P2MP Pseudowire based L2VPNs (VPMS and VPLS)</h1>
<p id="rfc.section.1.2.p.1">Point-to-Multipoint (P2MP) Pseudowires (PW) described in <a href="#I-D.ietf-pwe3-p2mp-pw">[I-D.ietf-pwe3-p2mp-pw]</a> requires an additional reverse LSP to be set up from the leaf node (referred as egress PE) to root node (referred as ingress PE). Instead, if HSMP LSP is used to multiplex P2MP PW, the reverse path can also be multiplexed to HSMP upstream path to avoid setting up an independent reverse path. In that case, the operational cost will be reduced for maintaining only one HSMP LSP, instead of P2MP LSP and n (number of leaf nodes) P2P reverse LSPs </p>
<p id="rfc.section.1.2.p.2">The VPMS defined in <a href="#I-D.ietf-l2vpn-vpms-frmwk-requirements">[I-D.ietf-l2vpn-vpms-frmwk-requirements]</a> requires reverse path from the leaf to the root node. The P2MP PW multiplexed to HSMP LSP can provide VPMS with reverse path, without introducing independent reverse paths from each leaf to the root. </p>
<p id="rfc.section.1.2.p.3">The P2MP PW multiplexed to HSMP LSP can also be used for VPLS <a href="#RFC4672">[RFC4672]</a>, which will reduce the overall broadcast/multicast utilization for VPLS. In current VPLS implementations with a full mesh of P2P LSPs between PEs, broadcast, unknown and multicast (BUM) traffic is efficiently distributed over the physical links between Provider (P) and Provider Edge (PE) routers. <a href="#I-D.ietf-l2vpn-vpls-mcast">[I-D.ietf-l2vpn-vpls-mcast]</a> and <a href="#I-D.ietf-l2vpn-ldp-vpls-broadcast-exten">[I-D.ietf-l2vpn-ldp-vpls-broadcast-exten]</a> leverages this constraint by introducing the usage of P2MP PW and/or P2MP LSP. But a specific P2P PW over P2P LSP is still needed for unicast traffic between the PEs. </p>
<p id="rfc.section.1.2.p.4">In the VPLS implementation scenario with P2MP PW multiplexed to HSMP LSPs, each PE signals a P2MP PW with itself as a root to all other PEs in the VPLS. Thereafter, all BUM traffic from this PE will use this P2MP PW. Unicast (learnt) traffic from a particular PE (e.g.  PE1) to another PE (e.g. PE2) will be sent from leaf to root using the reverse path of P2MP PW where PE2 is the root. </p>
<p id="rfc.section.1.2.p.5">This simplifies the VPLS implementation by reducing (a) link utilization for the BUM traffic and (b) the total number of LSPs maintained by each PE (i.e. instead of requiring a full mesh of LSPs, PEs now only require one HSMP LSP). It also helps in avoiding the unnecessary MAC learning that happens on the hub PE routers in case of H-VPLS. </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Comparing Hub-Spoke MP LSP with P2MP and Unidirectional Reverse LSP</h1>
<p id="rfc.section.2.p.1">An HSMP LSP provides a Point-to-Multipoint reachability from the root node to the leaf nodes and a unicast reachability from all the leaf nodes back to the root node. An obvious question that comes up is that how is this better than setting up a P2MP LSP from a root node and Unidirectional reverse LSPs back from the leaves to the root node. This section compares the two mechanisms and demonstrates how establishing one HSMP LSP is better than establishing a P2MP LSP with reverse LSPs from the leaves back to the root. </p>
<div id="#rfc.figure.1"></div>
<div id="#Figure 1"></div>
<pre> 
                                 A
                                 |
                                 B
                                / \
                               C   D
                              / \ / \
                             E  F G  H	  
		  </pre>
<p id="rfc.section.2.p.2">Consider the topology as shown in Figure 1. Router A wants to establish a Point-to-Multipoint connectivity to Routers E, F, G and H and also wants a Unicast path back from these routers to itself. There are two ways to accomplish this. In the first, we set up a HSMP LSP between A, E, F, G and H. In the second, we set up a P2MP LSP between A, E, F, G and H and establish regular LSPs back from these routers to A.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Number of Path and Resv State Blocks</h1>
<p id="rfc.section.2.1.p.1">When an RSVP-capable router receives an initial Path message, it creates a path state block (PSB) for that particular session. Each PSB consists of parameters derived from the received Path message such as SESSION, SENDER_TEMPLATE, SENDER_TSPEC, RSVP_HOP objects, and the outgoing interface provided by the IGP routing. Similarly, as a Resv message travels upstream toward the sender, it creates a reservation state block (RSB) in each RSVP-capable node along the way which stores information derived from the objects in the received Resv message, such as SESSION, RSVP_HOP, FLOWSPEC, FILTERSPEC, STYLE, etc objects.  The PSB and the RSB need to be periodically refreshed by the Path and the Resv messages. </p>
<p id="rfc.section.2.1.p.2">In case of HSMP LSP, the number of PSBs and the RSBs is the same as that for establishing a single P2MP LSP and is a function of how the P2MP LSP is signaled. It is equal to the number of S2L sub-LSPs of the P2MP LSP if each S2L sub-lsp is signaled independently. It is one, if an aggregated mode is used where multiple sub-lsps of the P2MP LSP are signaled togethar. </p>
<p id="rfc.section.2.1.p.3">In the second case routers need to maintain this state for the P2MP LSP and all the Unidirectional LSPs that go via it. </p>
<p id="rfc.section.2.1.p.4">Lets look at the state that branch node B needs to maintain. In case of HSMP LSP it is the same as a P2MP LSP. In the other approach it needs to maintain state for the following LSPs: </p>
<p></p>

<ol>
<li>P2MP LSP from A and E, F, G and H </li>
<li>Reverse LSP ECBA</li>
<li>Reverse LSP FCBA</li>
<li>Reverse LSP GDBA</li>
<li>Reverse LSP HDBA</li>
</ol>
<p id="rfc.section.2.1.p.6">We can thus clearly see that the amount of state that routers need to maintain in the second approach is much more than the HSMP LSP. It becomes all the more pronounced when the P2MP LSP is signalled using the aggregated approach described in <a href="#RFC4875">[RFC4875]</a> where a single Path and Resv message is used to signal the entire P2MP LSP. In such cases the amount of state that such branch nodes need to maintain increase linearly with the leaf nodes that get added to the P2MP LSP.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Hardware Programming and Label Utilization</h1>
<p id="rfc.section.2.2.p.1">In the HSMP LSP the LSR B advertises the same (upstream) label to C and D, thus consumes only one label and needs to only program one entry in the ILM table.</p>
<p id="rfc.section.2.2.p.2">In the second approach, LSR B needs to advertise two different labels to LSRs C and D and will thus consume 2 ILM entries in HW. </p>
<p id="rfc.section.2.2.p.3">We can clearly see that the number of labels consumed in the second approach will increase linearly with the amount of branching that happens on that LSR. It will further aggravate as the number of P2MP LSPs increase. </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> RSVP Control Traffic</h1>
<p id="rfc.section.2.3.p.1">In the second approach, LSR B will have RSVP control traffic for the P2MP LSP and all the Unidirectional reverse LSPs that pass through it. In case of HSMP LSR B will only have the RSVP traffic for the P2MP LSP. </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Setting up a Hub and Spoke Multipoint LSP with RSVP-TE</h1>
<p id="rfc.section.3.p.1">The Hub and Spoke Multipoint LSP comprises of one downstream unidirectional P2MP LSP from ingress LSR to each of egress LSR, and a co-routed upstream path from each of egress LSR to ingress LSR.</p>
<p><a href="#RFC3473">[RFC3473]</a> describes a point-to-point bidirectional LSP mechanism for the GMPLS architecture, where a bidirectional LSP setup is indicated by the presence of an Upstream_Label object in the Path message. The Upstream_Label object has the same format as the generalized label, and uses Class-Number 35 (of form 0bbbbbbb) and the C-Type of the label being used. Hub and Spoke Multipoint LSP describe in this draft will use similar mechanism, and reuse the Upstream_Label object defined in <a href="#RFC3473">[RFC3473]</a>. Note: the downstream label assignment is still applied, and upstream direction is based on the h&amp;s topology (hub = upstream, spoke= downstream), rather on forwarding direction.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Hub and Spoke Multipoint LSP and Path Messages</h1>
<p><a href="#RFC4875">[RFC4875]</a> allows a P2MP LSP to be signaled using one or more Path messages . Each Path message may signal one or more source to leaf (S2L) sub-LSPs. This document assumes that a unique Path message is being used to signal each individual sub-LSP of the HSMP LSP. Later versions of this document can describe mechanisms to use a single Path message to describe each component sub LSP of the HSMP LSP. </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Procedures for Hub and Spoke Multipoint LSP</h1>
<p id="rfc.section.3.2.p.1">The process of establishing a Hub and Spoke Multipoint LSP follows the establishment of a unidirectional P2MP LSP define in <a href="#RFC4875">[RFC4875]</a> with some additions. To support Hub and Spoke Multipoint LSPs an Upstream_Label object is added to the Path message.  The Upstream_Label object MUST indicate a label that is valid for forwarding at the time the Path message is sent. When a Path message containing an Upstream_Label object is received, the receiver first verifies that the upstream label is acceptable. If the label is not acceptable, the receiver MUST issue a PathErr message with a "Routing problem/Unacceptable label value" indication. </p>
<p id="rfc.section.3.2.p.2">The generated PathErr message MAY include an Acceptable Label Set defined in <a href="#RFC3473">[RFC3473]</a> section 4.1.</p>
<p id="rfc.section.3.2.p.3">The transit node must also allocate one label for the co-routed upstream path before propagating the Path message to all downstream nodes. If a transit node is unable to allocate a label or internal resources, then it MUST issue a PathErr message with a "Routing problem/MPLS label allocation failure" indication. With regards to the co-routed return path from the leafs to the root, the forwarding table on transit node will have one incoming labels allocated for all of the outgoing interfaces, and one outgoing label received from Upstream_Label object in Path message sent by upstream node. That means the traffic from different egress LSRs will be merged at each transit node, and will be sent together to upstream node, see section 3.3 for more detail of bandwidth guarantee in this case. </p>
<p id="rfc.section.3.2.p.4">The Path messages sending downstream with same [P2MP ID, Tunnel ID, Extended Tunnel ID] tuple as part of the SESSION object and the [Tunnel Sender Address, LSP ID] tuple as part of the SENDER_TEMPLATE object, but may different [Sub-Group Originator ID, Sub-Group ID] MUST use same allocated label value for Upstream_Label object. </p>
<p id="rfc.section.3.2.p.5">Leaf nodes process Path messages as usual, with the exception that the upstream label should be used to transport data traffic associated with the Hub and Spoke Multipoint LSP upstream towards the root node.</p>
<p id="rfc.section.3.2.p.6">When a Hub and Spoke Multipoint LSP is removed, both upstream and downstream labels are invalidated and it is no longer valid to send data using the associated labels. </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Bandwidth Allocation</h1>
<p id="rfc.section.3.3.p.1">The bandwidth allocation for upstream path from leaf to root could be same as the downstream path from root to leaf node <a href="#RFC3473">[RFC3473]</a>, and the bandwidth will be guarantee only when there is no traffic merging happened on transit node. If there are cases where leaf nodes send traffic to root node at the same time which may cause traffic to be merged on one physical link at transit node, then traffic overload may happen on these links. There are several ways to avoid this kind of traffic overload. One way is to let the application to do some delay at each leaf node to avoid traffic merging on some links of transit node. </p>
<p id="rfc.section.3.3.p.2">Some applications may not require bandwidth guarantee for the upstream path from leaf to root, then it is not necessary to allocate bandwidth for the upstream path. The mechanism described in <a href="#I-D.ietf-ccamp-asymm-bw-bidir-lsps-bis">[I-D.ietf-ccamp-asymm-bw-bidir-lsps-bis]</a> can be used to allocate zero bandwidth for the upstream path. </p>
<p id="rfc.section.3.3.p.3">The mechanism of providing asymmetric bandwidth allocation (non-zero bandwidth of upstream path) for HSMP LSP is out of the draft scope.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#SettingUp" id="SettingUp">Setting up the Hub Spoke Multipoint  LSP</a>
</h1>
<p id="rfc.section.4.p.1">The Following is an example of establishing a HSMP LSP using the procedures described in the previous sections.  </p>
<div id="#rfc.figure.2"></div>
<pre> 
             +-- Receiver
             | 
             PE2   PE3 --- Receiver
             |     |
             P1 -- P3
            /
Source --- PE1
            \
             P2 -- PE5 --- Receiver
             |
             PE4 --- Receiver

          Figure 2
          </pre>
<p></p>
<p id="rfc.section.4.p.3">The mechanism is explained using Figure 1. PE1 is a root LER (head end) node. PE2, PE3, PE4 and PE5 are the leaf LER nodes. P1 and P2 are branch LSR nodes and P3 is a plain LSR node. </p>
<p></p>

<ol>
<li>PE1 learns that PE2, PE3, PE4 and PE5 are interested in joining a HSMP tree with a P2MP ID of P2MP ID1. We assume that PE1 learns of the egress LERs at different points in time. </li>
<li>PE1 computes the P2P path to reach PE3 and sends a Path message with ERO [PE1, P1, P3, PE3]. It also provides an Upstream Label UL1 in the Upstream_Label object that P1 should use when forwarding packets to PE1. </li>
<li>The Path message traverses hop-by-hop and finally reaches PE3.  Assume that the Path message from P1 to P3 uses upstream label of UL3, in which case P1 must program the ILM to swap UL3 with UL1. The Path message from P3 to PE3 uses upstream label UL4, and thus P3 programs the ILM to swap UL4 with UL3. </li>
<li>PE3 responds with a Resv message that contains label L4, that P3 should use when forwarding packets to PE3. Similarly, the Resv from P3 to P1 contains label L3, that P1 should use when forwarding packets to P3. </li>
<li>Similarly when setting up the component sub-LSP from PE1 to PE2, PE1 will use the same Upstream label UL1 as it knows that this sub-LSP belongs to the same HSMP LSP because of the same P2MP session object that both sub-LSPs carry. </li>
<li>The Path message, thus for this component sub-LSP goes with ERO [PE1, P1, PE2] along with the Upstream label UL1 that P1 should use when forwarding packets to PE1. </li>
<li>P1 forwards the Path message with a new Upstream label UL2.  Finally, PE2 sends a Resv message containing label L2, that P1 should use when forwarding packets to PE2. P1 also understands that the Resv messages from PE2 and PE3 refer to the same HSMP LSP, because of the P2MP Session Object carried in each. [ </li>
<li>P1 sends a separate Resv message to PE1 corresponding to each of the sub-LSPs, but uses the same label L1 since the two sub LSPs belong to the same HSMP LSP. </li>
<li>The other component sub LSPs are set up in a similar way as described above. </li>
</ol>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#Graft" id="Graft">Grafting</a>
</h1>
<p id="rfc.section.5.p.1">The operation of adding leaf LER(s) to an existing HSMP LSP is termed grafting. This operation allows leaf nodes to join a HSMP LSP at different points in time. </p>
<p id="rfc.section.5.p.2">The leaf LER(s) can be added by signaling only the impacted component sub- LSPs in a new Path message. Hence, the existing component sub-LSPs do not have to be re-signaled. </p>
<div id="#rfc.figure.3"></div>
<pre> 
             +-- Receiver
             | 
             PE2   PE3 --- Receiver
             |     |
             P1 -- P3 -- P6 -- PE6 --- Receiver
            /
Source --- PE1
            \
             P2 -- PE5 --- Receiver
             |
             PE4 --- Receiver

          Figure 3
</pre>
<p></p>
<p id="rfc.section.5.p.4">Assume PE1 needs to set up another sub-LSP from PE1 to PE6. Being a part of the same HSMP LSP, PE1 MUST advertise the same Upstream Label to P1 in its Path message. P1 advertises the same Upstream Label to P3. P3 when sending the Path message to P6 would advertise a fresh Upstream label and similarly P6 would use a new upstream label when forwarding the Path message to PE6. </p>
<p id="rfc.section.5.p.5">PE6 sends a Resv message with a label back to P6. P6, would send a new label back to P3. P3 because of this new component sub-LSP (PE1-PE6) is now a branch LSR node that performs MPLS multicast replication. </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#Pruning" id="Pruning">Pruning</a>
</h1>
<p id="rfc.section.6.p.1">The operation of removing egress LER nodes from an existing HSMP LSP is termed as pruning. This operation allows leaf nodes to be removed from a HSMP LSP at different points in time. This section describes the mechanisms to perform pruning. </p>
<p id="rfc.section.6.p.2">Assume that the LER PE6 wants to be removed from the HSMP LSP. Since we used a unique Path message for each component sub LSP, the teardown will rely on generating a PathTear message for the corresponding Path message. PE6 will send a Path Tear message with the SESSION and SENDER_TEMPLATE objects corresponding to the HSMP LSP and the [Sub-Group Originator ID, Sub-Group ID] tuple corresponding to the Path message. P3 upon receiving the PathTear message would prune the MPLS multicast replication list and will become a normal RSVP LSR node. </p>
<p id="rfc.section.6.p.3">In the P2MP and HSMP context the PathTear is used for a specific component sub LSP teardown. This does not necessarily mean the whole path's breakdown from upstream; hence the LSRs MUST retain the Upstream label until all the component sub LSPs of the HSMP LSP are torn down.  </p>
<p id="rfc.section.6.p.4">When a HSMP LSP is removed by the root, a PathTear message MUST be generated for each Path message used to signal the HS Multipoint LSP.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Refresh" id="Refresh">Refresh Reduction</a>
</h1>
<p id="rfc.section.7.p.1">The refresh reduction procedures described in <a href="#RFC2961">[RFC2961]</a> are equally applicable to HS Multipoint LSPs described in this document. Refresh reduction applies to individual messages and the state they install/maintain, and that continues to be the case for HS Multipoint LSPs. </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#FRR" id="FRR">Fast Reroute</a>
</h1>
<p><a href="#RFC4090">[RFC4090]</a> extensions can be used to perform fast reroute for the mechanism described in this document when applied within packet networks.</p>
<p id="rfc.section.8.p.2">This is still TBD.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#Acks" id="Acks">Acknowledgements</a>
</h1>
<p id="rfc.section.9.p.1">We would like to thank Dimitri Papadimitriou, Yuji Kamite, Sebastien Jobert for their comments and feedback on the document.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.10.p.1">The same security considerations apply as for the RSVP-TE P2MP LSP specification, as described in <a href="#RFC4875">[RFC4875]</a>.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.11.p.1">No requests for IANA at this point of time. </p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="IEEE">[IEEE]</b></td>
<td class="top">
<a>IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems </a>", 2008.</td>, "</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3473">[RFC3473]</b></td>
<td class="top">
<a>Berger, L.</a>, "<a href="http://tools.ietf.org/html/rfc3473">Generalized Multi-Protocol Label Switching (GMPLS) Signaling Resource ReserVation Protocol-Traffic Engineering (RSVP-TE) Extensions</a>", RFC 3473, January 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4875">[RFC4875]</b></td>
<td class="top">
<a>Aggarwal, R.</a>, <a>Papadimitriou, D.</a> and <a>S. Yasukawa</a>, "<a href="http://tools.ietf.org/html/rfc4875">Extensions to Resource Reservation Protocol - Traffic Engineering (RSVP-TE) for Point-to-Multipoint TE Label Switched Paths (LSPs)</a>", RFC 4875, May 2007.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-ccamp-asymm-bw-bidir-lsps-bis">[I-D.ietf-ccamp-asymm-bw-bidir-lsps-bis]</b></td>
<td class="top">
<a>Takacs, A</a>, <a>Berger, L</a>, <a>Caviglia, D</a>, <a>Fedyk, D</a> and <a>J Meuric</a>, "<a href="http://tools.ietf.org/html/draft-ietf-ccamp-asymm-bw-bidir-lsps-bis-03">GMPLS Asymmetric Bandwidth Bidirectional Label Switched Paths (LSPs)</a>", Internet-Draft draft-ietf-ccamp-asymm-bw-bidir-lsps-bis-03, August 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC4090">[RFC4090]</b></td>
<td class="top">
<a>Pan, P.</a>, <a>Swallow, G.</a> and <a>A. Atlas</a>, "<a href="http://tools.ietf.org/html/rfc4090">Fast Reroute Extensions to RSVP-TE for LSP Tunnels</a>", RFC 4090, May 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2961">[RFC2961]</b></td>
<td class="top">
<a>Berger, L.</a>, <a>Gan, D.</a>, <a>Swallow, G.</a>, <a>Pan, P.</a>, <a>Tommasi, F.</a> and <a>S. Molendini</a>, "<a href="http://tools.ietf.org/html/rfc2961">RSVP Refresh Overhead Reduction Extensions</a>", RFC 2961, April 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4672">[RFC4672]</b></td>
<td class="top">
<a>De Cnodder, S.</a>, <a>Jonnala, N.</a> and <a>M. Chiba</a>, "<a href="http://tools.ietf.org/html/rfc4672">RADIUS Dynamic Authorization Client MIB</a>", RFC 4672, September 2006.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-pwe3-p2mp-pw">[I-D.ietf-pwe3-p2mp-pw]</b></td>
<td class="top">
<a>Sivabalan, S</a>, <a>Boutros, S</a>, <a>Martini, L</a>, <a>Konstantynowicz, M</a>, <a>Vecchio, G</a>, <a>Kamite, Y</a> and <a>L Jin</a>, "<a href="http://tools.ietf.org/html/draft-ietf-pwe3-p2mp-pw-03">Signaling Root-Initiated Point-to-Multipoint Pseudowire using LDP</a>", Internet-Draft draft-ietf-pwe3-p2mp-pw-03, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-l2vpn-vpms-frmwk-requirements">[I-D.ietf-l2vpn-vpms-frmwk-requirements]</b></td>
<td class="top">
<a>Kamite, Y</a>, <a>JOUNAY, F</a>, <a>Niven-Jenkins, B</a>, <a>Brungard, D</a> and <a>L Jin</a>, "<a href="http://tools.ietf.org/html/draft-ietf-l2vpn-vpms-frmwk-requirements-04">Framework and Requirements for Virtual Private Multicast Service (VPMS)</a>", Internet-Draft draft-ietf-l2vpn-vpms-frmwk-requirements-04, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-l2vpn-ldp-vpls-broadcast-exten">[I-D.ietf-l2vpn-ldp-vpls-broadcast-exten]</b></td>
<td class="top">
<a>Delord, S</a>, <a>Key, R</a>, <a>JOUNAY, F</a>, <a>Kamite, Y</a>, <a>Liu, Z</a>, <a>Paul, M</a>, <a>Kunze, R</a>, <a>Chen, M</a> and <a>L Jin</a>, "<a href="http://tools.ietf.org/html/draft-ietf-l2vpn-ldp-vpls-broadcast-exten-02">Extension to LDP-VPLS for Ethernet Broadcast and Multicast</a>", Internet-Draft draft-ietf-l2vpn-ldp-vpls-broadcast-exten-02, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-l2vpn-vpls-mcast">[I-D.ietf-l2vpn-vpls-mcast]</b></td>
<td class="top">
<a>Aggarwal, R</a>, <a>Kamite, Y</a> and <a>L Fang</a>, "<a href="http://tools.ietf.org/html/draft-ietf-l2vpn-vpls-mcast-09">Multicast in VPLS</a>", Internet-Draft draft-ietf-l2vpn-vpls-mcast-09, July 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lizhong Jin</span> 
	  <span class="n hidden">
		<span class="family-name">Jin</span>
	  </span>
	</span>
	<span class="org vcardline">ZTE Corporation</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Bibo Road, Shanghai</span>,  
		<span class="region"></span>
		<span class="code">201203</span>
	  </span>
	  <span class="country-name vcardline">China</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lizhong.jin@zte.com.cn">lizhong.jin@zte.com.cn</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Frederic Jounay </span> 
	  <span class="n hidden">
		<span class="family-name">Jounay</span>
	  </span>
	</span>
	<span class="org vcardline">France Telecom </span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Lannion Cedex</span>,  
		<span class="region"></span>
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:frederic.jounay@orange-ftgroup.com">frederic.jounay@orange-ftgroup.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Manav Bhatia</span> 
	  <span class="n hidden">
		<span class="family-name">Bhatia</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Bangalore</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:manav.bhatia@alcatel-lucent.com">manav.bhatia@alcatel-lucent.com</a></span>

  </address>
</div>

</body>
</html>