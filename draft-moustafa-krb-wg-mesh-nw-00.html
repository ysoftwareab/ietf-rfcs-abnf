<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Distributed Authentication in Wireless Mesh Networks Through Kerberos Tickets</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Distributed Authentication in Wireless Mesh Networks Through Kerberos Tickets">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Kerberos Working Group</td><td class="header">H. Moustafa</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">France Telecom - Orange</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">G. Bourdon</td></tr>
<tr><td class="header">Expires: April 21, 2011</td><td class="header">France Telecom</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">T. Yu</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">MIT Kerberos Consortium</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 18, 2010</td></tr>
</table></td></tr></table>
<h1><br />Distributed Authentication in Wireless Mesh Networks Through Kerberos Tickets<br />draft-moustafa-krb-wg-mesh-nw-00.txt</h1>

<h3>Abstract</h3>

<p>This document presents the problem of authentication and authorization in wireless mesh networks constituted by
several users communicating with application servers and communicating with each other in a single or multi-hop fashion.  
Each user in this environment can also play the role of an application provider.
</p>
<p>Imagine a large music event where the provided network infrastructure
is enhanced with network storage equipment to allow visitors to
access content relating to the bands playing at the events, such as
recorded video of previous performances, supplementary audio and
video material relevant to the bands playing, etc.  Certain content
is, however, not necessarily available to everyone under the same
conditions.  Instead access control is applied before the full range
of audio, and video material can be accessed.  Other content, such as
previews, might be offered for free.  How can such authentication,
and authorization infrastructure be made available with minimal
configuration complexity for a temporary event like a music festival?
</p>
<p>This document lists the requirements for a potentially needed Kerberos extension and presents a solution proposal based on the attempt to
use a Kerberos extension for mutual authentication in wireless mesh networks.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 21, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>

<a name="anchor1"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Specification Requirements</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction and Problem Statement</h3>

<p>Authentication and authorization to services access is still an open
   problem in wireless mesh network distributed environments in which 
   several users would need to communicate to several application servers 
   and with each other in a single or multi-hop fashion, and each user 
   could play the role of an application provider.
</p>
<p>The Kerberos authentication model <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neumann, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> uses a symmetric
   cryptography approach, offering a high security level and
   allowing mutual authentication. The principle of using service 
   tickets in Kerberos allows for credentials distribution which is 
   suitable for wireless mesh networks distributed environments.  
   However, the centralized approach in Kerberos (where
   each user should communicate with the authentication server each time
   he needs services credentials) restricts its usage for authentication
   in such distributed environments. Furthermore, Kerberos rather 
   authenticates each node with respect to the authentication server and 
   to the application server. The distributed credentials principle in 
   Kerberos (through Service tickets) is promising for allowing 
   authentication between each user and the application.  However, the    
   authentication between each two users who communicate with each other 
   is still not covered by Service tickets, especially with the dynamic 
   nature of distributed environments in which users connectivity (that 
   could be single or multi-hop) change frequently with time.
</p>
<p>Although the multi-hop communication is transparent to the application, there is a need to handle the authentication 
	and access control among the different multi-hop communicating nodes to prevent against 
	malicious actions taken by the human users themselves. Based on this fact, this draft proposes to use a common key 
	obtained by Kerberos for authentication among each two nodes who communicate together in a multi-hop 
        fashion. This common key is dynamic (renewable with time) for security reasons in such dynamic and 
        distributed wireless environment that is less secure. 
</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requirements</h3>

<p> This section presents a number of requirements motivated by the
   problem defined in the previous section.  These requirements are as 
   follows:</p>
<ul class="text">
<li>Distributed environment consisting of fixed and mobile nodes.
</li>
<li>Dynamic neighbors and dynamic application providers (any node could be an application provider at any time 
             providing applications to other nodes in the network, e.g. file sharing, sending special announcement 
             concerning the surrounding environments, and sending alarms in case of problems).
</li>
<li>User Generated Content (UGC) application, in which each node could be a source of content (mainly multimedia 
             contents) for other nodes in the network, e.g. transmitting video snapshots during festival events. 
</li>
<li>Hundreds of nodes (indoor or outdoor environment).
</li>
<li>Personal devices (of low power) individually used by users.
</li>
<li>Multihop communication.
</li>
<li>Authentication and access control of each user node by a trusted third party.
</li>
<li>Access control of each user by a trusted third party in a way that corresponds to the user subscription type and profile.
</li>
<li>Mutual authentication between each pair of communicating users.
</li>
<li>Limited bandwidth: need for minimizing traffic (minimizing the communication with the KDC).
</li>
<li>Dynamic credentials (attributing dynamic credentials to be distributed to each user).
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Kerberos Extension Solution Proposal</h3>

<p>This section presents a solution proposal extending the Kerberos authentication model for authenticating each user
node in wireless mesh networks with respect to the network operator and with respect to other users nodes participating in
 the network. 
</p>
<p>The Kerberos server resides in the local mesh network or in an external network and each user node needs to communicate
 firstly with this server in order to authenticate with respect to the operator and to obtain the necessary credentials 
(Kerberos tickets) for authentication with other users nodes and for accessing the offered services in the mesh network. 
The communication can take place in a single hop or through multi-hops (passing by intermediate users nodes) according to 
the proximity of each user node from the application providers nodes. 
</p>
<p>To prevent unreliable communication from taking place (intermediate nodes could do DoS, messages truncating,...), this solution 
proposal extends the classical Kerberos authentication model to adapt to the multi-hop communication through introducing a 
new shared secret for authentication and access control between intermediate nodes along the multi-hop communication. But, if
this secret is the same for all the time, it could be compromised and the entire network would be compromised. Then several 
shared secrets (taking the form of a service ticket obtained through a TGS request) should be obtained.
</p>
<p> The solution proposal takes the following sequence:</p>
<ul class="text">
<li>Each user node wishing to access the services offered by the mesh network starts by sending a first request 
to the KDC (TGT part) in order to authenticate with respect to the operator and to obtain the TGT ticket. The process is 
similar to the classical Kerberos authentication approach, and the user, if legitimate, obtains the corresponding TGT ticket.
</li>
<li>After obtaining the TGT, the user node re-contacts the KDC (TGS part), through sending a TGS request, in order
to obtain the necessary credentials while presenting the obtained TGT ticket as a proof of authenticity. The classical Kerberos
TGS request should be extended to illustrate the need of extra credentials for authentication with intermediate nodes along 
the multi-hop communication.
</li>
<li>Once the KDC (TGS part), receiving the TGS request from the user, verifies the TGT ticket and the user authenticity,
it sends to the user the classical service ticket containing the necessary credentials according to the user profile and 
according to the required service.
</li>
<li>The shared secrets provided to the user to enable him to authenticate with other intermediate nodes could take 
the form of service tickets sent through normal Kerberos TGS request process, where the service is the relaying 
process and each relay is considered as a service provider node. Or the classical Kerberos TGS reply message could be extended
to include these shared secrets.
</li>
<li>To avoid the shared secret compromise, several shared secrets (taking the form of a service ticket obtained through
a TGS request) are obtained, where each shared secret is valid for a given time interval. However, the shared secret distributions
should be done in a mean that would not compromise the security of the whole network:
<ul class="text">
<li>If the shared secrets are required by each mesh node at each time interval, this would generate lot of traffic during 
the communication with the KDC.
</li>
<li>If the shared secrets for future time intervals are pre-generated by the KDC and given in batch to each user, this would 
optimize traffic, but if a node is compromised at an interval of time, all the shared secrets would be known and the network 
would be compromised.
</li>
</ul>
</li>
<li>Then, the KDC sends to each mesh node the current interval shared secret and the pre-generated ones for the 
future, while each pre-generated shared secret is encrypted with a key corresponding to the its related time interval. This 
encryption key should is sent to each mesh node in the corresponding time interval either through Kerberos protocol or through
a multicast routing protocol.
</li>
<li> Group keys can be also considered allowing to have a shared secret for each group of mesh nodes and allowing 
each mesh node to participate to more than one group and hence to have several group keys. If one group key is compromised it
could be deleted by the KDC. Mesh nodes sharing the same group key are mesh nodes sharing some common characteristics (making
a cluster, hierarchal group keys for example, ...).
</li>
</ul>

<a name="anchor5"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
Potential Use-cases</h3>

<p>This section presents the potential use-cases for distributed    environments of wireless mesh networks having multi-hop communication  
and requiring distributed authentication authorization.</p>
<ul class="text">
<li>Temporary network infrastructure deployment for special events (sport events, music festivals, ..). Network operators
 deploy temporary low-cost infrastructure for temporary events and hence counts on the communication of users with application
 servers that are locally deployed.  Also the users themselves can play the role of application providers contributing to the
 diffusion of multimedia services (video snapshots on the event,video streams with inserted comments, video streaming for what was
 missed in the event, downloading an interactive audio-visual program for the event,. ..).  In such use-case, there is a need
 for dynamic credentials distribution on the different participating nodes and there is also a need of controlling the
 access of each user to the authorized service for a duration corresponding to his subscription.
</li>
<li>Community networks, where a user owns the home gateway to the Internet and allows other distributed users to have access to the
      Internet through passing by his home gateway.  Users may need to pass by other users (in the community network) in order to reach
      the home gateway.  In this use-case, there is a need for credentials distribution in a dynamic manner (adapting to the
      random configuration of the community network) to allow mutual authentication between each pair of communicating users and
      between each user and the home gateway providing the Internet access.
</li>
</ul>

<a name="anchor6"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>This document focuses on the distributed authentication through the Kerberos protocol and presents the requirements to be considered.
</p>
<a name="anchor7"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document does not require actions by IANA.
</p>
<a name="anchor8"></a><br /><hr />
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgment</h3>

<p> We would like to thank Hannes Tschofenig for his comments on this draft and for encouraging us to publish it.
</p>
<p> We would also like to thank our colleague Estelle Transy for all the discussions during the use-cases definition.
</p>
<a name="rfc.references1"></a><br /><hr />
<h3>9.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3365">[RFC3365]</a></td>
<td class="author-text">Schiller, J., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3365.txt">Strong Security Requirements for Internet Engineering 
          Task Force Standard Protocols</a>,&rdquo; August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neumann, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4120.txt">The Kerberos Network Authentication Service (V5)</a>,&rdquo; July&nbsp;2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hassnaa Moustafa</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom - Orange</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">38-40 rue du General Leclerc</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Issy Les Moulineaux,   92794 Cedex 9</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hassnaa.moustafa@orange-ftgroup.com">hassnaa.moustafa@orange-ftgroup.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gilles Bourdon</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">90 boulevard Kellermann</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">75013 Paris,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gilles.bourdon@orange-ftgroup.com">gilles.bourdon@orange-ftgroup.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tom Yu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">MIT Kerberos Consortium</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tlyu@mit.edu">tlyu@mit.edu</a></td></tr>
</table>
</body></html>
