<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BGP Flow Specification Version 2</title>
<meta content="Susan Hares" name="author">
<meta content="Donald Eastlake" name="author">
<meta content="Chaitanya Yadlapalli" name="author">
<meta content="Sven Maduschke" name="author">
<meta content="
       BGP flow specification version 1 (FSv1) defined in RFC 8955, RFC 8956, and 
   RFC 9117 describes the distribution of traffic filter policy (traffic 
   filters and actions) distributed via BGP.  Multiple applications have used 
   BGP FSv1 to distribute traffic filter policy.  These applications include 
   the following: mitigation of denial of service (DoS), enabling traffic 
   filtering in BGP/MPLS VPNs, centralized traffic control of router firewall 
   functions, and SFC traffic insertion. 
       
        During the deployment of BGP FSv1 a number of issues were detected due to
   lack of consistent TLV encoding for rules for flow specifications, lack of    
   user ordering of filter rules and/or actions, and lack of clear definition 
   of interaction with BGP peers not supporting FSv1.  Version 2 of the BGP 
   flow specification (FSv2) protocol addresses these features.  In order to 
   provide a clear demarcation between FSv1 and FSv2, a different NLRI
 encapsulates FSv2.    
       
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="RFC" name="keyword">
<meta content="Request for Comments" name="keyword">
<meta content="I-D" name="keyword">
<meta content="Internet-Draft" name="keyword">
<meta content="BGP Flow Specification" name="keyword">
<meta content="draft-hares-idr-flowspec-v2-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-hares-idr-flowspec-v2-03-r3pl_prx.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BGP FlowSpec v2</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hares, et al.</td>
<td class="center">Expires 27 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">IDR Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hares-idr-flowspec-v2-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-24" class="published">24 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-27">27 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Hares</div>
<div class="org">Hickory Hill Consulting</div>
</div>
<div class="author">
      <div class="author-name">D. Eastlake</div>
<div class="org">Futurewei Technologies</div>
</div>
<div class="author">
      <div class="author-name">C. Yadlapalli</div>
<div class="org">ATT</div>
</div>
<div class="author">
      <div class="author-name">S. Maduscke</div>
<div class="org">Verizon</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BGP Flow Specification Version 2</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">BGP flow specification version 1 (FSv1) defined in RFC 8955, RFC 8956, and 
   RFC 9117 describes the distribution of traffic filter policy (traffic 
   filters and actions) distributed via BGP.  Multiple applications have used 
   BGP FSv1 to distribute traffic filter policy.  These applications include 
   the following: mitigation of denial of service (DoS), enabling traffic 
   filtering in BGP/MPLS VPNs, centralized traffic control of router firewall 
   functions, and SFC traffic insertion.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2"> During the deployment of BGP FSv1 a number of issues were detected due to
   lack of consistent TLV encoding for rules for flow specifications, lack of    
   user ordering of filter rules and/or actions, and lack of clear definition 
   of interaction with BGP peers not supporting FSv1.  Version 2 of the BGP 
   flow specification (FSv2) protocol addresses these features.  In order to 
   provide a clear demarcation between FSv1 and FSv2, a different NLRI
 encapsulates FSv2.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-flow-specification-v1-revie" class="xref">Flow Specification v1 Review</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-ordering-for-flow-specifica" class="xref">Ordering for Flow Specification v2 (FSv2)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-definitions-and-acronyms" class="xref">Definitions and Acronyms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-rfc-2119-language" class="xref">RFC 2119 language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-flow-specification" class="xref">Flow Specification</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-distribution-of-flow-specif" class="xref">Distribution of Flow Specification Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-ip-header-subtlv-type1" class="xref">IP header SubTLV (type=1)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-ip-destination-prefix-type-" class="xref">IP Destination Prefix (type = 1)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-ip-source-prefix-type-2" class="xref">IP Source Prefix (type = 2) )</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-ip-protocol-type-3" class="xref">IP Protocol (type = 3)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.4">
                    <p id="section-toc.1-1.4.2.1.2.4.1"><a href="#section-4.1.4" class="xref">4.1.4</a>.  <a href="#name-port-type-4" class="xref">Port (type = 4)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.5">
                    <p id="section-toc.1-1.4.2.1.2.5.1"><a href="#section-4.1.5" class="xref">4.1.5</a>.  <a href="#name-destination-port-type-5" class="xref">Destination Port (type = 5)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.6">
                    <p id="section-toc.1-1.4.2.1.2.6.1"><a href="#section-4.1.6" class="xref">4.1.6</a>.  <a href="#name-source-port-type-6" class="xref">Source Port (type = 6)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.7">
                    <p id="section-toc.1-1.4.2.1.2.7.1"><a href="#section-4.1.7" class="xref">4.1.7</a>.  <a href="#name-icmp-type-type-7" class="xref">ICMP Type (type = 7)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.8">
                    <p id="section-toc.1-1.4.2.1.2.8.1"><a href="#section-4.1.8" class="xref">4.1.8</a>.  <a href="#name-icmp-code-type-8" class="xref">ICMP Code (type = 8)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.9">
                    <p id="section-toc.1-1.4.2.1.2.9.1"><a href="#section-4.1.9" class="xref">4.1.9</a>.  <a href="#name-tcp-flags-type-9" class="xref">TCP Flags (type = 9)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.10">
                    <p id="section-toc.1-1.4.2.1.2.10.1"><a href="#section-4.1.10" class="xref">4.1.10</a>. <a href="#name-packet-length-type-10" class="xref">Packet length (type = 10)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.11">
                    <p id="section-toc.1-1.4.2.1.2.11.1"><a href="#section-4.1.11" class="xref">4.1.11</a>. <a href="#name-dscp-diffserve-code-pointty" class="xref">DSCP (DiffServe Code Point)(type = 11)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.12">
                    <p id="section-toc.1-1.4.2.1.2.12.1"><a href="#section-4.1.12" class="xref">4.1.12</a>. <a href="#name-fragment-type-12" class="xref">Fragment (type = 12)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.13">
                    <p id="section-toc.1-1.4.2.1.2.13.1"><a href="#section-4.1.13" class="xref">4.1.13</a>. <a href="#name-flow-labeltype-13" class="xref">Flow Label(type = 13)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.14">
                    <p id="section-toc.1-1.4.2.1.2.14.1"><a href="#section-4.1.14" class="xref">4.1.14</a>. <a href="#name-parts-of-sid-type-14" class="xref">Parts of SID (type = 14</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-encoding-of-actions-type2" class="xref">Encoding of Actions (type=2)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-action-1-action-chain-opera" class="xref">Action 1 - Action Chain operation (ACO) (0x01)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-traffic-actions-per-interfa" class="xref">Traffic Actions per interface set (TAIS) (0x02)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-traffic-rate-limited-by-byt" class="xref">Traffic rate limited by bytes (TRB) (0x6)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="xref">4.2.4</a>.  <a href="#name-traffic-action-ta0x7" class="xref">Traffic Action (TA)(0x7)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a href="#section-4.2.5" class="xref">4.2.5</a>.  <a href="#name-redirect-to-ipv4-rdipv40x8" class="xref">Redirect to IPv4 (RDIPv4)[0x8)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.6">
                    <p id="section-toc.1-1.4.2.2.2.6.1"><a href="#section-4.2.6" class="xref">4.2.6</a>.  <a href="#name-traffic-marking-tm-0x9" class="xref">Traffic marking (TM) (0x9)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.7">
                    <p id="section-toc.1-1.4.2.2.2.7.1"><a href="#section-4.2.7" class="xref">4.2.7</a>.  <a href="#name-traffic-rate-limited-by-pac" class="xref">Traffic rate limited by packets (TRP) (12/0xC)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.8">
                    <p id="section-toc.1-1.4.2.2.2.8.1"><a href="#section-4.2.8" class="xref">4.2.8</a>.  <a href="#name-traffic-redirect-to-ipv6-rd" class="xref">Traffic redirect to IPv6 (RDIPv6) (13, 0xD)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.9">
                    <p id="section-toc.1-1.4.2.2.2.9.1"><a href="#section-4.2.9" class="xref">4.2.9</a>.  <a href="#name-traffic-insertion-in-sfc-ti" class="xref">Traffic insertion in SFC (TISFC)(14, OXE)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.10">
                    <p id="section-toc.1-1.4.2.2.2.10.1"><a href="#section-4.2.10" class="xref">4.2.10</a>. <a href="#name-flow-specification-redirect" class="xref">Flow Specification Redirect to Indirection-ID (RDIID) (0x0F)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.11">
                    <p id="section-toc.1-1.4.2.2.2.11.1"><a href="#section-4.2.11" class="xref">4.2.11</a>. <a href="#name-vlan-action-vlan-action-0x1" class="xref">VLAN action (VLAN) (action 0x16, 22)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.12">
                    <p id="section-toc.1-1.4.2.2.2.12.1"><a href="#section-4.2.12" class="xref">4.2.12</a>. <a href="#name-tpid-action-tpid-action-0x1" class="xref">TPID action (TPID) (action 0x17, 23)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.13">
                    <p id="section-toc.1-1.4.2.2.2.13.1"><a href="#section-4.2.13" class="xref">4.2.13</a>. <a href="#name-extended-community-vs-actio" class="xref">Extended Community vs. Action SubTLV formats</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-l2-and-l2vpn-fsv2-filters" class="xref">L2 and L2VPN FSv2 Filters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-fsv2-sfc-nlri-traffic-filte" class="xref">FSv2 SFC NLRI Traffic Filters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-encoding-of-actions-passed-" class="xref">Encoding of Actions passed in Wide Communities</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-validation-of-fsv2-nlri" class="xref">Validation of FSv2 NLRI</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-validation-of-fs-nlri-fsv1-" class="xref">Validation of FS NLRI (FSv1 or FSv2)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-validation-of-flow-specific" class="xref">Validation of Flow Specification Actions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-error-handling-and-validati" class="xref">Error handling and Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ordering-for-flow-specificat" class="xref">Ordering for Flow Specification v2 (FS-v2)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-ordering-of-fsv2-nlri-filte" class="xref">Ordering of FSv2 NLRI Filters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-ordering-of-the-actions" class="xref">Ordering of the Actions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-action-chain-operation" class="xref">Action Chain Operation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-summary-of-fsv2-ordering" class="xref">Summary of FSv2 ordering</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-ordering-of-fs-filters-for-" class="xref">Ordering of FS filters for BGP Peers support FSv1 and FSv2</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-scalability-and-aspirations" class="xref">Scalability and Aspirations for FSv2</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-optional-security-additions" class="xref">Optional Security Additions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-bgp-fs-v2-and-bgpsec" class="xref">BGP FS v2 and BGPSEC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-bgp-fs-v2-with-with-roa" class="xref">BGP FS v2 with with ROA</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-flow-specification-v2-safis" class="xref">Flow Specification V2 SAFIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-bgp-capability-code" class="xref">BGP Capability Code</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-filter-ip-component-types" class="xref">Filter IP Component types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.  <a href="#name-filter-ip-component-types-2" class="xref">Filter IP component types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"> 
   Modern IP routers have the capability to forward traffic and to classify, 
   shape, rate limit, filter, or redirect packets based on administratively 
   defined policies. These traffic policy mechanisms allow the operator 
   to define match rules that operate on multiple fields within header 
   of an IP data packet.  Upon a match, the traffic policy allows actions 
   to be associated with each match rule.  These rules can be more widely 
   defined as "event-condition-action" (ECA) rules where the event 
   is always the reception of a packet.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">BGP (<span>[<a href="#RFC4271" class="xref">RFC4271</a>]</span>) flow specification as defined by
    <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>,  
    <span>[<a href="#RFC9117" class="xref">RFC9117</a>]</span> specifies the distribution of traffic filter policy (traffic 
    filters and actions) via BGP to a mesh of BGP peers (IBGP and EBGP peers). 
    The traffic filter policy is applied when packets are received on a router 
    with the flow specification function turned on. The flow specification 
    protocol defined in <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>, and 
     <span>[<a href="#RFC9117" class="xref">RFC9117</a>]</span> will be called BGP 
 flow specification version 1 (BGP FSv1) in this draft.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"> Some modern IP routers also include the abilities of firewalls which can 
   match on a sequence of packet events based on administrative policy. These 
   firewall capabilities allow for user ordering of match rules and user 
   ordering of actions per match.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
   Multiple deployed applications currently use BGP FSv1 to distribute traffic 
   filter policy.  These applications include: 1) mitigation of Denial of 
   Service (DoS), 2) traffic filtering in BGP/MPLS VPNS, and 3) centralized 
   traffic control for networks utilizing SDN control of router firewall 
   functions, 4) classifiers for insertion in an SFC, and 5) filters for SRv6 routing.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">During the deployment of BGP flow specification 
   v1, the following issues were detected:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">lack of consistent TLV encoding prevented extension of encodings,<a href="#section-1-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.2">inability to allow user defined order for filtering rules,<a href="#section-1-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.3">inability to order actions to provide deterministic interactions 
     or to allow users to define order for actions, and<a href="#section-1-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.4">no clearly defined mechanisms for BGP peers which do 
     not support flow specification v1.<a href="#section-1-6.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-7">
   Networks currently cope with some of these issues by limiting the type of 
   traffic filter policy sent in BGP.  Current Networks do not have a good 
   workaround/solution for applications that receive but do not understand FSv1 
   policies.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">
   This document defines version 2 of the BGP flow specification protocol to 
   address these shortcomings in BGP FSv1.  Version 2 of BGP flow specification 
   will be denoted as BGP FSv2.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">BGP FSv1 as defined in <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>, and 
     <span>[<a href="#RFC9117" class="xref">RFC9117</a>]</span> specified 2 SAFIs (133, 134) 
 to be used with IPv4 AFI (AFI = 1) and IPv6 AFI (AFI=2).<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">
   This document specifies 2 new SAFIs (TBD1, TBD2) for FSv2 to be used with 5 AFIs   
   (1, 2, 6, 25, and 31) to allow user-ordered lists of traffic match filters for user-ordered 
   traffic match actions encoded in Communities (Wide or Extended) or a SubTLV of the FSv2 NRLI.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">
   FSv1 and FSv2 use different AFI/SAFIs to send flow specification filters.  Since BGP AFI/SAFIs 
   perform route selection per AFI/SAFI, this approach can be termed "ships in the night" based on AFI/SAFI.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">
   FSv1 is a critical component of deployed applications. Therefore, this 
   specification defines how FSv2 will interact with BGP peers that support 
   either FSv2 or FSv1 or BGP peers that do not support either FSv1 or FSv2.  
   It is expected that a transition to FSv2 will occur over time as new 
   applications require FSv2 extensibility and user-defined ordering for rules 
   and actions or network operators tire of the restrictions of FSv1 such as error 
   handling issues and restricted topologies.<a href="#section-1-12" class="pilcrow">¶</a></p>
<p id="section-1-13">
  This section contains a short review of FSv1 and an overview of FSv2.<a href="#section-1-13" class="pilcrow">¶</a></p>
<p id="section-1-14">Section 3 contains the definition of flow specification v2. Section 4 contains the encoding 
  rules for FSv2 and user-based encoding sent via BGP, and section 5 describes how to 
  validate FSv2 NLRI. Section 6 discusses how to combine FSv2 user-ordered match rules and FSv1 rules.  
  Section 6 also discusses how to combine user-ordered actions, FSv1 actions, and default actions.  
  Sections 7-10 address an alternate security mechanism, considerations for IANA, 
  security in deployments, and manageability.<a href="#section-1-14" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-flow-specification-v1-revie">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-flow-specification-v1-revie" class="section-name selfRef">Flow Specification v1 Review</a>
        </h3>
<p id="section-1.1-1">
   The FSv1 NLRI defined in <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span> 
      for this policy include 13 match conditions encoded for the following AFI/SAFIs<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">IPv4 traffic: AFI:1, SAFI:133<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">IPv6 Traffic: AFI:2  SAFI:133<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">BGP/MPLS IPv4 VPN: AFI:1, SAFI: 134<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.4"> BGP/MPLS IPv6 VPN: AFI:2, SAFI: 134<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-3">If one considers the reception of the packet as an event,
   then BGP flow specification describes a set of 
   Event-MatchCondition-Action (ECA) policies where:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">event is the reception of a packet<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">condition stands for "match conditions" defined in the BGP NLRI as an n-tuple of component filters, and<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3"> the action is defined taken is either: the default condition (accept traffic), or a set of actions (1 or more)
       defined in Extended BGP Community values <span>[<a href="#RFC4360" class="xref">RFC4360</a>]</span>.<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5">
  The flow specification conditions and actions combine to make up FSv1 specification rules. Each FSv1 NLRI must 
  have a type 1 component (destination prefix) and Extended Communities with FSv1 actions can be attached 
  to a single NLRI or multiple NLRIs in a BGP packet.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">
   Within an AFI/SAFI pair, FSv1 rules are ordered based on the components in 
   the packet (types 1-13) ordered from left-most to right-most and within the 
   component types by value of the component. Rules are inserted in the rule
   list by component-based order where a FSv1 rule with existing component type has 
   higher precedence than one missing a specific component type,<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">
   Since FSv1 specifications (<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>, and 
   <span>[<a href="#RFC9117" class="xref">RFC9117</a>]</span>) specify that the FSv1 NLRI MUST have a destination prefix 
  (as component type 1) embedded in the flow specification, the FSv1 rules with destination 
  components are ordered by IP Prefix comparison rules for IPv4 (<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>)
     and IPv6 (<span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>). <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>
  specifies that more specific prefixes (aka longest match) have higher precedence than 
  that of less specific prefixes AND for prefixes of the same length the lower IP number 
  is selected (lowest IP value).  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> specifies that if the 
  offsets within component 1 are the same, then the longest match and lowest IP comparison rules from 
  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> apply.  If the offsets are different, then the lower offset has precedence.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8">
   These rules work to provide a set of FSv1 rules ordered by IP Destination Prefix 
   by longest match and lowest IP address.   <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>
   also states that the requirement for a destination prefix component "MAY be relaxed by explicit configuration" 
   Since the rule insertions are based on comparing component types between two rules in order, 
   this means the rules without destination prefixes are inserted after all rules which 
   contain destination prefix component.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9">
  The actions specified by FSv1 are:<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-10.1">accept packet (default)<a href="#section-1.1-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.2">traffic flow limitation by bytes (6)<a href="#section-1.1-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.3">traffic-action (7)<a href="#section-1.1-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.4">redirect traffic (8)<a href="#section-1.1-10.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.5">mark traffic (9)<a href="#section-1.1-10.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.6">traffic flow limiation by packrts (12)<a href="#section-1.1-10.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-11"> Figure 1 shows a diagram of the FSv1 logical data structures
       with 5 rules.  If FSv1 rules have destination prefix components 
       (type=1) and FSv1 rule 5 does not have a destination prefix, 
        then FSv1 rule 5 will be inserted in the policy after rules 1-4.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.1-12">
<pre>

     +--------------------------------------+
     | Flow Specification (FS)              |
     |  Policy                              |
     +--------------------------------------+
         ^               ^              ^
         |               |              |
         |               |              |
+--------^----+  +-------^-------+     +-------------+
|   FS Rule 1 |  |   FS Rule 2   | ... |  FS rule 5  |
+-------------+  +---------------+     +-------------+
                    :          :
                    :          :
                 ...:          :........
                 :                     :
       +---------V---------+      +----V-------------+
       |  Rule Condition   |      |   Rule Action    |
       |  in BGP NLRIs     |      | in BGP extended  |
           | AFIs: 1 and 2     |      | Communities      |
       | SAFI 133, 134     |      |                  |
       +-------------------+      +------------------+
           :     :    :                 :      :    :
      .....:     .    :.....       .....:      .    :.....
      :          :         :       :           :         :
 +----V---+  +---V----+ +--V---+ +-V------+ +--V-----++--V---+
 |  Match |  | match  | |match | | Action | | action ||action|
 |Operator|  |Variable| |Value | |Operator| |variable|| Value|
 |*1      |  |        | |      | |(subtype| |        ||      |
 +--------+  +--------+ +------+ +--------+ +--------++------+

   *1 match operator may be complex.

   Figure 1: BGP Flow Specification v1 Policy
</pre><a href="#section-1.1-12" class="pilcrow">¶</a>
</div>
</section>
<section id="section-1.2">
        <h3 id="name-ordering-for-flow-specifica">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-ordering-for-flow-specifica" class="section-name selfRef">Ordering for Flow Specification v2 (FSv2)</a>
        </h3>
<p id="section-1.2-1">
Flow Specification v2 allows the user to order the flow specification rules and the actions 
associated with a rule. Each FSv2 rule may have one or more match conditions 
and one or more associated actions.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">
This FSv2 specification supports the components and actions for the following<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-3.1">IPv4 (AFI=1, SAFI: TBD1),<a href="#section-1.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.2">IPv6 (AFI=2, SAFI: TBD2),<a href="#section-1.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.3">L2 (AFI=6, SAFI: TDB1),<a href="#section-1.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.4">BGP/MPLS IPv4 VPN: (AFI=1, SAFI: TBD2),<a href="#section-1.2-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.5"> BGP/MPLS IPv6 VPN: (AFI=2, SAFI: TBD2),<a href="#section-1.2-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.6"> BGP/MPLS L2VPN (AFI=25, SAFI: TDB2),<a href="#section-1.2-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.7"> SFC: (AFI=31, SAFI: TBD1), and<a href="#section-1.2-3.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-3.8"> SFC VPN (AFI=31, SAFI: TBD2).<a href="#section-1.2-3.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-4">The FSv2 specification for tunnel traffic is outside the 
scope of this specification. The FSv1 specification for tunneled 
traffic is in <span>[<a href="#I-D.ietf-idr-flowspec-nvo3" class="xref">I-D.ietf-idr-flowspec-nvo3</a>]</span>.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">FSv2 operates in the ships-in-the night model with FSv1 so network 
operators can manipulate FSv2 and FSv1 using configuration parameters.  
Since deterministic ordering was a short coming in FSv1, this specification 
provides rules and protocol features to keep filters in a deterministic order.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">
The basic principles regarding ordering of rules are simple:<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-7.1">1) Rule-0 (zero) is defined to be 0/0 with the "permit-all" action.<a href="#section-1.2-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-1.2-7.2">
            <p id="section-1.2-7.2.1">2) FSv2 rules are ordered based on user-specified order.<a href="#section-1.2-7.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-7.2.2.1">The user-specified order is carried FSv2 NLRI with the sentence 
that the numerical lower value takes precedence over the numerically higher value.  
For rules received with the same order value, the FSv1 rules apply (order by component type and then by value of the components).<a href="#section-1.2-7.2.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-1.2-7.3">
            <p id="section-1.2-7.3.1">3) FSv2 rules are added starting with Rule 1 and FSv1 rules are added after FSv2 rules.<a href="#section-1.2-7.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-7.3.2.1">For this example, BGP Peer A has FSv2 data base with 10 FSv2 rules (1-10) and 10 FSv1 rules (301-310).<a href="#section-1.2-7.3.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-1.2-7.4">
            <p id="section-1.2-7.4.1">4) An FSv2 peer may receive BGP NLRI routes from a FSv1 peer or a BGP peer that does not support FSv1 or FSv2.  
The capabilities sent by a BGP peer indicate whether the AFI/SAFI can be received (FSv1 NLRI or FSv2 NLRI).<a href="#section-1.2-7.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-7.4.2.1">Suppose an FSv2 peer (BGP Peer A) has the capability to send either FSv1 or FSv2.  BGP Peer A peers with BGP Peers B, C, D and E.<a href="#section-1.2-7.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-7.4.2.2">BGP Peer B can only send FSv1 routes (NLRI + Extended Community). BGP Peer C can send FSv2 routes (NLRI + path attributes (wide community or extended community or none)).  
BGP Peer D cannot send any FS routes.  BGP E can send FSv2 and FSv1 routes<a href="#section-1.2-7.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-7.4.2.3">BGP Peer A sends FSv1 routes in its databases to BGP B.  Since the FSv2 NLRI cannot be sent to the FSv1 peer, only the FSv1 NLRI is sent. 
BGP Peer A sends to BGP C the FSv2 routes in its database (configured or received).<a href="#section-1.2-7.4.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-7.4.2.4">BGP peer A would not send the FSv1 NLRI or FSv2 NLRI to BGP Peer D.  The BGP Peer D does not support for these NLRI.<a href="#section-1.2-7.4.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-7.4.2.5">BGP Peer A sends the NLRI for both FSv1 and FSv2 to BGP Peer E.<a href="#section-1.2-7.4.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-1.2-7.5">
            <p id="section-1.2-7.5.1">5) Associate a chain of actions to rules based on user-defined action number<a href="#section-1.2-7.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-7.5.2.1">FSv2 allows actions to be associated by the following:
 a) actions in an Extended Community, b) actions in a wide community, 
 or c) actions within the FSv2 NRLI associated as a SubTLV.<a href="#section-1.2-7.5.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-7.5.2.2">Action user-order value zero is reserved.<a href="#section-1.2-7.5.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-7.5.2.3">An action associated with FSv2 NLRI using in a SubTLV always has a user-defined order.<a href="#section-1.2-7.5.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-7.5.2.4">The precedence between two actions with user-defined order (Wide community) is discussed in detail in section 6.2.<a href="#section-1.2-7.5.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-1.2-8">
Examples of action chain<a href="#section-1.2-8" class="pilcrow">¶</a></p>
<p id="section-1.2-9">
An action associated with FSv2 NLRI using in a SubTLV always has a user-defined order.  
If two actions have the same user-defined order and the same action type, 
the ordering of the actions within the same type is defined by the action type (see section 4.2).<a href="#section-1.2-9" class="pilcrow">¶</a></p>
<p id="section-1.2-10">
The use case for the Action which always associated with an NRLI is the DDOS match case that always 
drops the packet in order to kill off a widespread DDoS attack. The idea is easy, but the deployment issues may be more complex.  
An example may help illustrate this point.<a href="#section-1.2-10" class="pilcrow">¶</a></p>
<p id="section-1.2-11">
Suppose BGP Peer A has a configured value for FSv2ExtComActionStart of 
10.  Suppose BGP Peer A receives the following attributes associated 
with the same FSv2 NLRI to form an action chain:<a href="#section-1.2-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-12.1"> a Wide Community action with user-defined order 10 from AS 2020 
that limits packet-based rate limit of 600 packets per second<a href="#section-1.2-12.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-12.2">an action SubTLV with a user order of 11 from AS 10 that 
limits the packet base rate to zero packets per second,<a href="#section-1.2-12.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-12.3">a Wide Community with a user order of 11 from AS 2021 that limits the packet-based rate limit of 50.<a href="#section-1.2-12.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.2-13">The FSv2 data base would store the following action chain:<a href="#section-1.2-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-14.1">
            <p id="section-1.2-14.1.1"> at user-defined action order 10:<a href="#section-1.2-14.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-14.1.2.1"> a user action type of 12 (packet-based rate limit) with values of AS 2020 and float value of 1000.<a href="#section-1.2-14.1.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.2-14.2">
            <p id="section-1.2-14.2.1">at user-defined action order 11 in order:<a href="#section-1.2-14.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-14.2.2.1">1.A user action of type 12 with values of AS 10 and float value of zero,<a href="#section-1.2-14.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.2-14.2.2.2">2. A user action of type 12 with value of AS 2021 and float value of 50.<a href="#section-1.2-14.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-1.2-15">When does the action chain stop?<a href="#section-1.2-15" class="pilcrow">¶</a></p>
<p id="section-1.2-16">The default process for the action chain is to stop on failure.<a href="#section-1.2-16" class="pilcrow">¶</a></p>
<p id="section-1.2-17">
If setting the packet-based rate limit of 1000 works, the action chain 
would go on to set the value of zero. If this works, it would go on to 
set the value to 50.  This set of actions may not be what the user 
wanted if this is a DDoS attack.<a href="#section-1.2-17" class="pilcrow">¶</a></p>
<p id="section-1.2-18">
BGP FSv2 rules are ephemeral by default (just as BGP routes are ephemeral) upon a restart of a BGP session or a router.<a href="#section-1.2-18" class="pilcrow">¶</a></p>
<p id="section-1.2-19">
After FSv2 NLRI are checked for errors in syntax, those with valid syntax 
are checked for the same validation procedure FSv1 NLRI uses  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and
<span>[<a href="#RFC9117" class="xref">RFC9117</a>]</span>. See section 5 for for a detailed discussion of validation and error handling.<a href="#section-1.2-19" class="pilcrow">¶</a></p>
<p id="section-1.2-20">
Names may be associated with rules or actions in order for 
network management protocols (NETCONF/RESTCONF) to be able to 
provide detailed reports in the BGP Yang models.<a href="#section-1.2-20" class="pilcrow">¶</a></p>
<p id="section-1.2-21">
Figure 2 provides a logical diagram of the FSv2 structure<a href="#section-1.2-21" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.2-22">
<pre>

       +--------------------------------+
       |          Rule Group            |
       +------------------------------ -+
         ^          ^                  ^
                 |          ----------         |
         |                   |             ------
         |                   |               |
+--------^-------+   +-------^-----+     +---^-----+
|      Rule1     |   |     Rule2   | ... |  Rule-n |
+----------------+   +-------------+     +---------+
                      :  :   :    :
    :.................:  :   :    :
    :          |.........:   :    :
 +--V--+    +--V--+          :    :
 | name|    |order| .........:    :.....
 +-----+    +-----+ :                  :
                    :                  :
   +----------------V----+  +-----V----------------+
   |Rule Match condition |  | Rule Action          |
   +---------------------+  +----------------------+
    :      :     :    :       :      :   :   :   |
 +--V--+   :     :    :    +--V---+  :   :   :   V
 | Rule|   :     :    :    |action|  :   :   :  +-----------+
 | name|   :     :    :    |order |  :   :   :  |action name|
 +-----+   :     :    :    +------+  :   :   :  +-----------+
           :     :    :              :   :   :...........
           :     :    :              :   :              :
      .....:     .    :.....       ..:   :.....         :
      :          :         :       :          :         :
 +----V---+  +---V----+ +--V---+ +-V------++--V-----++--V---+
 |  Match |  | match  | |match | | Action || action ||action|
 |Operator|  |variable| |Value | |Operator||Variable|| Value|
 +--------+  +--------+ +------+ +--------++--------++------+

   Figure 2: Order Flow Specification Data storage
</pre><a href="#section-1.2-22" class="pilcrow">¶</a>
</div>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<section id="section-2.1">
        <h3 id="name-definitions-and-acronyms">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-definitions-and-acronyms" class="section-name selfRef">Definitions and Acronyms</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-1.1">AFI - Address Family Identifier<a href="#section-2.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.2">BGPSEC - secure BGP <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span> updated by <span>[<a href="#RFC8206" class="xref">RFC8206</a>]</span><a href="#section-2.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.3">BGP Session ephemeral state - state which does not survive the loss of BGP peer,<a href="#section-2.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.4">Ephemeral state - state which does not survive the reboot of a software module,
    or a hardware reboot. Ephemeral state can be ephemeral configuration state or 
    operational state.<a href="#section-2.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.5">configuration state - state which persist across a reboot of software module within 
       a routing system or a reboot of a hardware routing device.<a href="#section-2.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.6">NETCONF: The Network Configuration Protocol <span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span>.<a href="#section-2.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.7">RESTCONF:  The RESTCONF configuration Protocol <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span><a href="#section-2.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.8"> ROA: Route Origin Authentication <span>[<a href="#RFC6482" class="xref">RFC6482</a>]</span><a href="#section-2.1-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-1.9"> SAFI - Subsequent Address Family Identifier<a href="#section-2.1-1.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-2.2">
        <h3 id="name-rfc-2119-language">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-rfc-2119-language" class="section-name selfRef">RFC 2119 language</a>
        </h3>
<p id="section-2.2-1">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals as shown here.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-3">
      <h2 id="name-flow-specification">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-flow-specification" class="section-name selfRef">Flow Specification</a>
      </h2>
<p id="section-3-1">
 A BGP Flow Specification is an n-tuple containing several match criteria 
 that can be applied to IP traffic, traffic encapsulated in IP traffic or 
 traffic associated with IP traffic.  The following traffic filters are
examples of traffic associated with IP traffic: IP packet or an IP packet 
inside a L2 packet (Ethernet), an MPLS packet, and SFC flow.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
 A given Flow Specification NLRI may be associated with a set of path 
attributes depending on the particular application, and attributes within
that set may or may not include reachability information (e.g., NEXT_HOP). 
Extended Community or Wide Community attributes (well-known or AS-specific)
MAY be used to encode a set of pre-determined actions.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
 A particular application is identified by a specific AFI/SAFI (Address 
 Family Identifier/Subsequent Address Family Identifier) and responds to a 
 distinct set of RIBs. Those RIBs should be treated independently of each 
 other in order to assure noninterference between distinct applications.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
 BGP processing treats the NLRI as a key to entries in AFI/SAFI BGP 
 databases.   Entries that are placed in the Loc-RIB are then associated with 
 a given set of semantics which are application dependent. Standard BGP 
 mechanisms such as update filtering by NLRI or by attributes such as AS_PATH or 
 large communities apply to the BGP Flow Specification defined NLRI-types.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
 Network operators can control the propagation of BGP routes by enabling or 
 disabling the exchange of routes for a particular AFI/SAFI pair on a 
 particular peering session.  As such, the Flow Specification may be 
 distributed to only a portion of the BGP infrastructure.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-distribution-of-flow-specif">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-distribution-of-flow-specif" class="section-name selfRef">Distribution of Flow Specification Information</a>
      </h2>
<p id="section-4-1">
 The BGP Flow Specification version 2 (BGP-FS v2) uses an NRLI with the format for
 AFIs for IPv4 (AFI = 1), IPv6 (AFI = 2), L2 (AFI = 6), L2VPN (AFI=25), and 
 SFC (AFI=31) with two following SAFIs to support transmission of the flow specification
 which supports user ordering of traffic filters and actions for iP traffic and 
 IP VPN traffic.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
  This NLRI information is encoded using MP_REACH_NLRI and MP_UNREACH_NLRI attributes defined in
 <span>[<a href="#RFC4760" class="xref">RFC4760</a>]</span>.  When advertising FSv2 NLRI, the length of the 
  Next-Hop Network Address MUST be set to 0. Upon reception, 
  the Network Address of the Next-Hop field MUST be ignored.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Implementations wishing to exchange flow specification rules MUST use 
BGP's Capability Advertisement facility to exchange the Multiprotocol Extension Capability Code 
(Code 1) as defined in <span>[<a href="#RFC4760" class="xref">RFC4760</a>]</span>, and 
indicate a capability for flow specification v2 (Code TBD4).<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The AFI/SAFI NLRI for BGP Flow Specification version 2 (FSv2) has the format:<a href="#section-4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-5">
<pre>
 +-------------------------------+
 |length (2 octets)              |
 +-------------------------------+
 | Sub-TLVs (variable)           |
 | +===========================+ |
 | | order (4 octets)          | |
 | +---------------------------+ |
 | |  identifier (4 octets)    | |
 | +---------------------------+ |
 | | type (2 octets)           | |
 | +---------------------------+ |
 | | length-Subtlv (2 octets)  | |
 | +---------------------------+ |
 | | value (variable)          | |
 | +===========================+ |
 +-------------------------------+


 Figure 3 -Flow Specification v2 format
</pre><a href="#section-4-5" class="pilcrow">¶</a>
</div>
<p id="section-4-6">
  where:<a href="#section-4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-7.1">
          <p id="section-4-7.1.1"> length: length of field including all SubTLVs in octets.<a href="#section-4-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-7.1.2.1"> The combined lengths of any FSv2 NLRI in the 
      MP_REACH_NLRI or MP_UNREACH_NLRI plus the 
      BGP path attributes, the BGP NLRI length
      and the BGP header must be less than the packet size.<a href="#section-4-7.1.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-4-7.2"> order: flow-specification global rule order number (4 octets).<a href="#section-4-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-7.3">identifier: identifier for the rule (used for NM/Logging) (4 octets)<a href="#section-4-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-7.4">
          <p id="section-4-7.4.1"> type: contains a type for the TLV format of the NRLI (2 octets) which can be:<a href="#section-4-7.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-7.4.2.1">0 - reserved,<a href="#section-4-7.4.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-7.4.2.2">1 - FSv2 IP header traffic rules<a href="#section-4-7.4.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-7.4.2.3">2 - FSv2 Actions<a href="#section-4-7.4.2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-7.4.2.4">3-  FSv2 L2 traffic rules<a href="#section-4-7.4.2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-7.4.2.5">4-  FSv2 SFC Traffic rules<a href="#section-4-7.4.2.5" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-4-7.5"> length-tlv: is the length of the value part of the Sub-TLV,<a href="#section-4-7.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-7.6">value: value depends on the subTLV (see sections below).<a href="#section-4-7.6" class="pilcrow">¶</a>
</li>
      </ul>
<section id="section-4.1">
        <h3 id="name-ip-header-subtlv-type1">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-ip-header-subtlv-type1" class="section-name selfRef">IP header SubTLV (type=1)</a>
        </h3>
<p id="section-4.1-1">
The format of the IP header TLV value field is shown in figure 4.  
The AFI/SAFI field includes the AFI (2 octets), SAFI (1 octet).
The AFI will be 1 (IPv4) or 2 (IPv6) and the SAFI will be 
TBD1 or, for the VPN case, TBD2.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
    +-------------------------------+
    | +--------------------------+  |
    | | AFI/SAFI field (3)       |  |
    | | (subTLVs)+               |  |
    | +==========================+  |
    +-------------------------------+

      Figure 4 - IP Header TLV
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">
Each SubTLV has the format:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-4">
<pre>
    +-------------------------------+
    |  SubTLV type (1 octet)        |
    +-------------------------------+
    |  length (1 octet)             |
    + ------------------------------+
    |  value (variable)             |
    +-------------------------------+
     Figure 5 – IP header SubTLV format

</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1-5">
Where:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-6.1">SubTLV type: component values are defined in 
the "Flow Specification Component types" registry for IPv4 and IPv6 by 
<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>,
<span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>, and <span>[<a href="#I-D.ietf-idr-flowspec-srv6" class="xref">I-D.ietf-idr-flowspec-srv6</a>]</span><a href="#section-4.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-6.2">length: length of SubTLV (varies depending on SubTLV type).<a href="#section-4.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-6.3">
            <p id="section-4.1-6.3.1">value: dependent on the subTLV<a href="#section-4.1-6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-6.3.2.1"> For descriptions of value portions for components 1-13 see 
<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>. 
 For components 14 see <span>[<a href="#I-D.ietf-idr-flowspec-srv6" class="xref">I-D.ietf-idr-flowspec-srv6</a>]</span>.<a href="#section-4.1-6.3.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-4.1-7">Many of the components use the operators [numeric_op] and [bitmask_op] 
defined in <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span><a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8"> Table 2<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">The list of valid subtypes are:<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-10.1">1 - IP Destination prefix<a href="#section-4.1-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.2"> 2 - IP Source prefix<a href="#section-4.1-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.3"> 3 - IPv4 Protocol / IPv6 Upper Layer Protocol<a href="#section-4.1-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.4"> 4 - Port<a href="#section-4.1-10.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.5">5 - Destination Port<a href="#section-4.1-10.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.6">6 - Source Port<a href="#section-4.1-10.6" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.7"> 7 - ICMPv4 type / ICMPv6 type<a href="#section-4.1-10.7" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.8"> 8 - ICMPv4 code / ICPv6 code<a href="#section-4.1-10.8" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.9"> 9 - TCP Flags<a href="#section-4.1-10.9" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.10"> 10 - Packet length<a href="#section-4.1-10.10" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.11"> 11 - DSCP (Diffserv Code Point)<a href="#section-4.1-10.11" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.12"> 12 - Fragment<a href="#section-4.1-10.12" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.13"> 13 - Flow Label<a href="#section-4.1-10.13" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-10.14"> 14 - Parts of SID<a href="#section-4.1-10.14" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-11">
Ordering within the TLV in FSv2: The transmission of SubTLVs within a 
flow specification rule must be sent ascending order by SubTLV type.  
If the SubTLV types are the same, then the value fields are compared 
using mechanisms defined in <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>
and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>. 
NLRIs having TLVs which do not follow the above ordering rules MUST be considered as
 malformed by a BGP FSv2 propagator. This rule prevents any ambiguities that arises 
 from the multiple copies of the same NLRI from multiple BGP FSv2 propagators. 
 A BGP implementation SHOULD treat such malformed NLRIs as "Treat-as-withdraw" 
<span>[<a href="#RFC7606" class="xref">RFC7606</a>]</span>.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1-12">See <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>, and
<span>[<a href="#I-D.ietf-idr-flowspec-srv6" class="xref">I-D.ietf-idr-flowspec-srv6</a>]</span>. for specific details.<a href="#section-4.1-12" class="pilcrow">¶</a></p>
<section id="section-4.1.1">
          <h4 id="name-ip-destination-prefix-type-">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-ip-destination-prefix-type-" class="section-name selfRef">IP Destination Prefix (type = 1)</a>
          </h4>
<p id="section-4.1.1-1"> IPv4 Name: IP Destination Prefix   (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>)<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2"> IPv6 Name: IPv6 Destination prefix (reference:  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3"></p>
<p id="section-4.1.1-4">IPv4 length: Prefix length<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">IPv4 value: IPv4 Prefix (variable length)<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">IPv6 length: length of value<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.1-7">IPv6 value: [offset (1 octet)] [pattern (variable)] [padding(variable)]<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1.1-8">If IPv6 length = 0 and offset = 0, then component matches every address.  
Otherwise, length must be offset "less than" length "less than" 129 or component is malformed.<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.2">
          <h4 id="name-ip-source-prefix-type-2">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-ip-source-prefix-type-2" class="section-name selfRef">IP Source Prefix (type = 2) )</a>
          </h4>
<p id="section-4.1.2-1"> IPv4 Name: IP Source Prefix      (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>)<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2"> IPv6 Name: IPv6 Source prefix  (reference: <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3"></p>
<p id="section-4.1.2-4">IPv4 length: Prefix length<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">IPv4 value: Source IPv4 Prefix (variable length)<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">IPv6 length: length of value<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2-7">IPv6 value: [offset (1 octet)] [pattern (variable)][padding(variable)]<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8"></p>
<p id="section-4.1.2-9">
If IPv6 length = 0 and offset = 0, then component matches every address.  Otherwise, length must be offset &lt; length &lt; 129 
or component is malformed.<a href="#section-4.1.2-9" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.3">
          <h4 id="name-ip-protocol-type-3">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-ip-protocol-type-3" class="section-name selfRef">IP Protocol (type = 3)</a>
          </h4>
<p id="section-4.1.3-1"> IPv4 Name: IP Protocol  IP Source Prefix  (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>)<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2"> IPv6 Name: IPv6 Upper-Layer Protocol:   (reference: <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3-3"></p>
<p id="section-4.1.3-4">IPv4 length: variable<a href="#section-4.1.3-4" class="pilcrow">¶</a></p>
<p id="section-4.1.3-5">IPv4 value: [numeric_op, value]+<a href="#section-4.1.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.3-6"></p>
<p id="section-4.1.3-7">IPv6 length: variable<a href="#section-4.1.3-7" class="pilcrow">¶</a></p>
<p id="section-4.1.3-8">IPv6 value: [numeric_op, value}+<a href="#section-4.1.3-8" class="pilcrow">¶</a></p>
<p id="section-4.1.3-9">where the value following each numeric_op is a single octet.<a href="#section-4.1.3-9" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.4">
          <h4 id="name-port-type-4">
<a href="#section-4.1.4" class="section-number selfRef">4.1.4. </a><a href="#name-port-type-4" class="section-name selfRef">Port (type = 4)</a>
          </h4>
<p id="section-4.1.4-1"> IPv4/IPv6 Name: Port    (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>), <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.4-1" class="pilcrow">¶</a></p>
<p id="section-4.1.4-2">Filter defines: a set of port values to match either destination port or source port.<a href="#section-4.1.4-2" class="pilcrow">¶</a></p>
<p id="section-4.1.4-3"></p>
<p id="section-4.1.4-4">IPv4 length: variable<a href="#section-4.1.4-4" class="pilcrow">¶</a></p>
<p id="section-4.1.4-5">IPv4 value: [numeric_op, value]+<a href="#section-4.1.4-5" class="pilcrow">¶</a></p>
<p id="section-4.1.4-6"></p>
<p id="section-4.1.4-7">IPv6 length: variable<a href="#section-4.1.4-7" class="pilcrow">¶</a></p>
<p id="section-4.1.4-8">IPv6 value: [numeric_op, value]+<a href="#section-4.1.4-8" class="pilcrow">¶</a></p>
<p id="section-4.1.4-9"></p>
<p id="section-4.1.4-10">where the value following each numeric_op is a single octet.<a href="#section-4.1.4-10" class="pilcrow">¶</a></p>
<p id="section-4.1.4-11">Note-1: In the presence of the port component (destination or source port), 
only a TCP (port 6) or UDP (port 17) packet can match the entire flow specification. 
If the packet is fragmented and this is not the first fragment, then the system
may not be able to find the header.  At this point, the FSv2 filter may fail to 
detect the correct flow.  Similarly, if other IP options or the encapsulating 
security payload (ESP) is present, then the  node may not be able to describe the transport header
and the FSv2 filter may fail to detect the flow.<a href="#section-4.1.4-11" class="pilcrow">¶</a></p>
<p id="section-4.1.4-12">This problem comes from the inheritance of the FSv1 filter component for port.  
If better resolution is desired, a new FSv2 filter should be defined.<a href="#section-4.1.4-12" class="pilcrow">¶</a></p>
<p id="section-4.1.4-13">Note-2: Although IPv6 allows for more than one Next Header field in the packet, the main goal 
of the Type 3 FSv2 component is to match the first upper layer protocol value.<a href="#section-4.1.4-13" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.5">
          <h4 id="name-destination-port-type-5">
<a href="#section-4.1.5" class="section-number selfRef">4.1.5. </a><a href="#name-destination-port-type-5" class="section-name selfRef">Destination Port (type = 5)</a>
          </h4>
<p id="section-4.1.5-1"> IPv4/IPv6 Name: Destination Port    (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>), <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.5-1" class="pilcrow">¶</a></p>
<p id="section-4.1.5-2">Filter defines: a list of match filters for destination port for TCP or UDP within a received packet<a href="#section-4.1.5-2" class="pilcrow">¶</a></p>
<p id="section-4.1.5-3">Length: variable<a href="#section-4.1.5-3" class="pilcrow">¶</a></p>
<p id="section-4.1.5-4"> Component Value format: [numeric_op, value]+<a href="#section-4.1.5-4" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.6">
          <h4 id="name-source-port-type-6">
<a href="#section-4.1.6" class="section-number selfRef">4.1.6. </a><a href="#name-source-port-type-6" class="section-name selfRef">Source Port (type = 6)</a>
          </h4>
<p id="section-4.1.6-1"> IPv4/IPv6 Name: Source Port (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>), <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.6-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6-2">Filter defines: a list of match filters for source port for TCP or UDP within a received packet<a href="#section-4.1.6-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6-3">IPv4/IPv6 length: variable<a href="#section-4.1.6-3" class="pilcrow">¶</a></p>
<p id="section-4.1.6-4">IPv4/Ipv6 value: [numeric_op, value]+<a href="#section-4.1.6-4" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.7">
          <h4 id="name-icmp-type-type-7">
<a href="#section-4.1.7" class="section-number selfRef">4.1.7. </a><a href="#name-icmp-type-type-7" class="section-name selfRef">ICMP Type (type = 7)</a>
          </h4>
<p id="section-4.1.7-1"> IPv4: ICMP Type : Source Port (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>)<a href="#section-4.1.7-1" class="pilcrow">¶</a></p>
<p id="section-4.1.7-2"> Filter defines: Defines: a list of match criteria for ICMPv4 type<a href="#section-4.1.7-2" class="pilcrow">¶</a></p>
<p id="section-4.1.7-3">IPv6: ICMPv6 Type (reference: <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.7-3" class="pilcrow">¶</a></p>
<p id="section-4.1.7-4">Filter defines: a list of match criteria for ICMPv6 type.<a href="#section-4.1.7-4" class="pilcrow">¶</a></p>
<p id="section-4.1.7-5"></p>
<p id="section-4.1.7-6">IPv4/IPv6 length: variable<a href="#section-4.1.7-6" class="pilcrow">¶</a></p>
<p id="section-4.1.7-7">IPv4/IPv6 value: [numeric_op, value]+<a href="#section-4.1.7-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.8">
          <h4 id="name-icmp-code-type-8">
<a href="#section-4.1.8" class="section-number selfRef">4.1.8. </a><a href="#name-icmp-code-type-8" class="section-name selfRef">ICMP Code (type = 8)</a>
          </h4>
<p id="section-4.1.8-1"> IPv4: ICMP Type : Source Port (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>)<a href="#section-4.1.8-1" class="pilcrow">¶</a></p>
<p id="section-4.1.8-2"> Filter defines: a list of match criteria for ICMPv4 code.<a href="#section-4.1.8-2" class="pilcrow">¶</a></p>
<p id="section-4.1.8-3">IPv6: ICMPv6 Type (reference: <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.8-3" class="pilcrow">¶</a></p>
<p id="section-4.1.8-4">Filter defines: a list of match criteria for ICMPv6 code.<a href="#section-4.1.8-4" class="pilcrow">¶</a></p>
<p id="section-4.1.8-5"></p>
<p id="section-4.1.8-6">IPv4/IPv6 length: variable<a href="#section-4.1.8-6" class="pilcrow">¶</a></p>
<p id="section-4.1.8-7">IPv4/IPv6 value: [numeric_op, value]+<a href="#section-4.1.8-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.9">
          <h4 id="name-tcp-flags-type-9">
<a href="#section-4.1.9" class="section-number selfRef">4.1.9. </a><a href="#name-tcp-flags-type-9" class="section-name selfRef">TCP Flags (type = 9)</a>
          </h4>
<p id="section-4.1.9-1"> IPv4/IPv6: TCP Flags Code  (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>)<a href="#section-4.1.9-1" class="pilcrow">¶</a></p>
<p id="section-4.1.9-2">Filter defines: a list of match criteria for TCP Control bits<a href="#section-4.1.9-2" class="pilcrow">¶</a></p>
<p id="section-4.1.9-3"></p>
<p id="section-4.1.9-4">IPv4/IPv6 length: variable<a href="#section-4.1.9-4" class="pilcrow">¶</a></p>
<p id="section-4.1.9-5">IPv4/IPv6 value: [bitmask_op, value]+<a href="#section-4.1.9-5" class="pilcrow">¶</a></p>
<p id="section-4.1.9-6"></p>
<p id="section-4.1.9-7">Note: a 2 octets bitmask match is always used for TCP-Flags<a href="#section-4.1.9-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.10">
          <h4 id="name-packet-length-type-10">
<a href="#section-4.1.10" class="section-number selfRef">4.1.10. </a><a href="#name-packet-length-type-10" class="section-name selfRef">Packet length (type = 10)</a>
          </h4>
<p id="section-4.1.10-1"> IPv4/IPv6: Packet Length (reference: <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.10-1" class="pilcrow">¶</a></p>
<p id="section-4.1.10-2"> Filter defines: a list of match criteria for length of packet 
(excluding L2 header but including IP header).<a href="#section-4.1.10-2" class="pilcrow">¶</a></p>
<p id="section-4.1.10-3">IPv4/IPv6 length: variable<a href="#section-4.1.10-3" class="pilcrow">¶</a></p>
<p id="section-4.1.10-4">IPv4/IPv6 value: [numeric_op, value]+<a href="#section-4.1.10-4" class="pilcrow">¶</a></p>
<p id="section-4.1.10-5"></p>
<p id="section-4.1.10-6">Note:<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> uses either 1 or 2 octet values.<a href="#section-4.1.10-6" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.11">
          <h4 id="name-dscp-diffserve-code-pointty">
<a href="#section-4.1.11" class="section-number selfRef">4.1.11. </a><a href="#name-dscp-diffserve-code-pointty" class="section-name selfRef">DSCP (DiffServe Code Point)(type = 11)</a>
          </h4>
<p id="section-4.1.11-1"> IPv4/IPv6: DSCP Code  (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>,  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.11-1" class="pilcrow">¶</a></p>
<p id="section-4.1.11-2"> Filter defines: a list of match criteria for DSCP code values to match the
6-bit DSCP field.<a href="#section-4.1.11-2" class="pilcrow">¶</a></p>
<p id="section-4.1.11-3"></p>
<p id="section-4.1.11-4">IPv4/IPv6 length: variable<a href="#section-4.1.11-4" class="pilcrow">¶</a></p>
<p id="section-4.1.11-5">IPv4/IPv6 value: [numeric_op, value]+<a href="#section-4.1.11-5" class="pilcrow">¶</a></p>
<p id="section-4.1.11-6"></p>
<p id="section-4.1.11-7">Note: This component uses the Numeric Operator (numeric_op) described in
   <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> in section 4.2.1.1.  
   Type 11 component values MUST be encoded as single
   octet (numeric_op len=00).<a href="#section-4.1.11-7" class="pilcrow">¶</a></p>
<p id="section-4.1.11-8">The six least significant bits contain the DSCP value.  All other
   bits SHOULD be treated as 0.<a href="#section-4.1.11-8" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.12">
          <h4 id="name-fragment-type-12">
<a href="#section-4.1.12" class="section-number selfRef">4.1.12. </a><a href="#name-fragment-type-12" class="section-name selfRef">Fragment (type = 12)</a>
          </h4>
<p id="section-4.1.12-1"> IPv4/IPv6: Fragment  (reference:  <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>,  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.12-1" class="pilcrow">¶</a></p>
<p id="section-4.1.12-2"> Filter defines: a list of match criteria for specific IP fragments.<a href="#section-4.1.12-2" class="pilcrow">¶</a></p>
<p id="section-4.1.12-3"></p>
<p id="section-4.1.12-4">Length: variable<a href="#section-4.1.12-4" class="pilcrow">¶</a></p>
<p id="section-4.1.12-5">Component Value format: [bitmask_op, value]+<a href="#section-4.1.12-5" class="pilcrow">¶</a></p>
<p id="section-4.1.12-6">Bitmask values are:<a href="#section-4.1.12-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.12-7">
<pre>
      0    1   2   3   4   5   6  7
    +---+---+---+---+---+---+---+---+
    | 0 | 0 | 0 | 0 |lf |FF |IsF| DF|
    +---+---+---+---+---+---+---+---+
                 Figure 6
</pre><a href="#section-4.1.12-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1.12-8"> Where:<a href="#section-4.1.12-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1.12-9.1"> DF (don't fragment): match If IP header flags bit 1 (DF) is 1.<a href="#section-4.1.12-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.12-9.2">IsF(is a fragment other than first: match if IP header fragment offset is not 0.<a href="#section-4.1.12-9.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.12-9.3"> FF (First Fragment): Match if <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span> IP Header Fragment offset is zero and Flags Bit-2 (MF) is 1.<a href="#section-4.1.12-9.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.12-9.4">LF (last Fragment): Match if [RFC7091] IP header Fragment is not 0 And Flags bit-2 (MF) is 0<a href="#section-4.1.12-9.4" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.12-9.5">0:  must be sent in NLRI encoding as 0, and must be ignored during reception.<a href="#section-4.1.12-9.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
<section id="section-4.1.13">
          <h4 id="name-flow-labeltype-13">
<a href="#section-4.1.13" class="section-number selfRef">4.1.13. </a><a href="#name-flow-labeltype-13" class="section-name selfRef">Flow Label(type = 13)</a>
          </h4>
<p id="section-4.1.13-1"> IPv4/IPv6: Fragment  (reference:  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)<a href="#section-4.1.13-1" class="pilcrow">¶</a></p>
<p id="section-4.1.13-2"> Filter defines: a list of match criteria for 20-bit Flow Label in the IPv6 header field.<a href="#section-4.1.13-2" class="pilcrow">¶</a></p>
<p id="section-4.1.13-3"></p>
<p id="section-4.1.13-4">Length: variable<a href="#section-4.1.13-4" class="pilcrow">¶</a></p>
<p id="section-4.1.13-5">Component Value format: [numeric_op, value]+<a href="#section-4.1.13-5" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.14">
          <h4 id="name-parts-of-sid-type-14">
<a href="#section-4.1.14" class="section-number selfRef">4.1.14. </a><a href="#name-parts-of-sid-type-14" class="section-name selfRef">Parts of SID (type = 14</a>
          </h4>
<p id="section-4.1.14-1"> IPv6: Service Identifier Matches (reference: <span>[<a href="#I-D.ietf-idr-flowspec-srv6" class="xref">I-D.ietf-idr-flowspec-srv6</a>]</span><a href="#section-4.1.14-1" class="pilcrow">¶</a></p>
<p id="section-4.1.14-2"> Filter defines: a list of match bit match criteria for some combinations of the
LOC, FUNCT and ARG in SID fields in the SID or or whole SID.<a href="#section-4.1.14-2" class="pilcrow">¶</a></p>
<p id="section-4.1.14-3"></p>
<p id="section-4.1.14-4">Length: variable<a href="#section-4.1.14-4" class="pilcrow">¶</a></p>
<p id="section-4.1.14-5">Component Value format: [type, LOC-Len, FUNCT-Len, ARG-Len, [op, value]+]<a href="#section-4.1.14-5" class="pilcrow">¶</a></p>
<p id="section-4.1.14-6">where:<a href="#section-4.1.14-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.14-7.1">type (1 octet):  This indicates the new component type (TBD1, which is to be assigned by IANA).<a href="#section-4.1.14-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.14-7.2">LOC-Len (1 octet):  This indicates the length in bits of LOC in SID.<a href="#section-4.1.14-7.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.14-7.3">iFUNCT-Len (1 octet):  This indicates the length in bits of FUNCT in SID.<a href="#section-4.1.14-7.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.14-7.4">ARG-Len (1 octet):  This indicates the length in bits of ARG in SID.<a href="#section-4.1.14-7.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.14-7.5">[op, value]+:  This contains a list of {operator, value} pairs that are used to match some parts of SID.<a href="#section-4.1.14-7.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.14-8">The total of three lengths (i.e., LOC length + FUNCT length + ARG
length) MUST NOT be greater than 128.  If it is greater than 128, an
error occurs and it is treated as a withdrawl [RFC7606] and
[RFC4760].<a href="#section-4.1.14-8" class="pilcrow">¶</a></p>
<p id="section-4.1.14-9">The operator (op) byte is encoded as:<a href="#section-4.1.14-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.14-10">
<pre>
      0   1   2   3   4   5   6   7
    +---+---+---+---+---+---+---+---+
    | e | a | field type|lt |gt |eq |
    +---+---+---+---+---+---+---+---+
            Figure 7

</pre><a href="#section-4.1.14-10" class="pilcrow">¶</a>
</div>
<p id="section-4.1.14-11">where:<a href="#section-4.1.14-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1.14-12.1">where the behavior of each operator bit has clear similarity with that
of [RFC8955]'s Numeric Operator field.<a href="#section-4.1.14-12.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.14-12.2">e (end-of-list bit):  Set in the last {op, value} pair in the sequence.<a href="#section-4.1.14-12.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.14-12.3">a - AND bit: If unset, the previous term is logically ORed with the
current one.  If set, the operation is a logical AND.  It should be
unset in the first operator byte of a sequence.  The AND operator has
higher priority than OR for the purposes of evaluating logical
expressions.<a href="#section-4.1.14-12.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.14-12.4">
              <p id="section-4.1.14-12.4.1">field type:<a href="#section-4.1.14-12.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.14-12.4.2.1">000: SID's LOC<a href="#section-4.1.14-12.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.1.14-12.4.2.2">001: SID's FUNCT<a href="#section-4.1.14-12.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.1.14-12.4.2.3">010: SID's ARG<a href="#section-4.1.14-12.4.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.1.14-12.4.2.4">011: SID's LOC:FUNCT<a href="#section-4.1.14-12.4.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.1.14-12.4.2.5">100: SID's FUNCT:ARG<a href="#section-4.1.14-12.4.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.1.14-12.4.2.6">101: SID's LOC:FUNCT:ARG<a href="#section-4.1.14-12.4.2.6" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal ulEmpty" id="section-4.1.14-12.5">Note: For an unknown field type, Error Handling is to "treat as withdrawl" [RFC7606]
and [RFC4760].<a href="#section-4.1.14-12.5" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.14-12.6">lt: less than comparison between data' and value'.<a href="#section-4.1.14-12.6" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.14-12.7">gt: greater than comparison between data' and value'.<a href="#section-4.1.14-12.7" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.1.14-12.8">eq: equality between data' and value'.<a href="#section-4.1.14-12.8" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.14-13">The data' and value' used in lt, gt and eq are indicated by the field
type in an operator and the value field following the operator.<a href="#section-4.1.14-13" class="pilcrow">¶</a></p>
<p id="section-4.1.14-14">The value field depends on the field type and has the value of SID's
some parts rounding up to bytes (refer to the table 3 in figure 8 below ).<a href="#section-4.1.14-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.14-15">
<pre>
         Table 3 - SID Parts fields

       +-----------------------+------------------------------+
       | Field Type            | Value                        |
       +=======================+==============================+
       | SID's LOC             | value of LOC bits            |
       +-----------------------+------------------------------+
       | SID's FUNCT           | value of FUNCT bits          |
       +-----------------------+------------------------------+
       | SID's ARG             | value of ARG bits            |
       +-----------------------+------------------------------+
       | SID's LOC:FUNCT       | value of LOC:FUNCT bits      |
       +-----------------------+------------------------------+
       | SID's FUNCT:ARG       | value of FUNCT:ARG bits      |
       +-----------------------+------------------------------+
       | SID's LOC:FUNCT:ARG   | value of LOC:FUNCT:ARG bits  |
       +-----------------------+------------------------------+
                               Figure 8

</pre><a href="#section-4.1.14-15" class="pilcrow">¶</a>
</div>
</section>
</section>
<section id="section-4.2">
        <h3 id="name-encoding-of-actions-type2">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-encoding-of-actions-type2" class="section-name selfRef">Encoding of Actions (type=2)</a>
        </h3>
<p id="section-4.2-1">The FSv2 actions may be sent in an Extended Community, a Wide Community or an NLRI.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
The Extended Community encodes the Flow Specification actions in the Extended Community format 
<span>[<a href="#RFC4360" class="xref">RFC4360</a>]</span>.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-3">
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  Type high    |  Type low(*)  |                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+          Value (6 octets)     |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                              Figure 9
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2-4">
The Wide Community definition for FSv2 actions is as follows:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-5">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |             Type = 2          |    Flags  |C|T|   Reserved    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |            Length             |&lt;sequence of FSv2-Action-TLV&gt;+ |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+--------------------------------

                                Figure 10

</pre><a href="#section-4.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2-6">
where FSv2-Action-TLV is defined as:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-7">
<pre>
  FSv2-Action-TLV
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | action order                  |   Identifier                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |&lt;action-subTLVs&gt;+              |
 +--------------------------------


                               Figure 11

</pre><a href="#section-4.2-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2-8">
Where FS-SubTLVs have the format:<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-9">
<pre>
 FS-SubTLVs

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  SubTLV type (2 octet)        |   length type (2 octet)       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  value (variable)             |
 +-------------------------------+

                      Figure 12

</pre><a href="#section-4.2-9" class="pilcrow">¶</a>
</div>
<p id="section-4.2-10">
The FSv2 Action TLV may be included in the NLRI to be associated with a 
specific NLRI. (Note inclusion with the FSv2 NLRI does not have good scaling properties.)<a href="#section-4.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-11">
<pre>

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Type = 2          |    length                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            action-order       |  chain-ID                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | length-TLV                    |  value &lt;SubTLVs&gt;+             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                          Figure 13

</pre><a href="#section-4.2-11" class="pilcrow">¶</a>
</div>
<p id="section-4.2-12">where:<a href="#section-4.2-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2-13.1">action-order: is the user defined action within the list<a href="#section-4.2-13.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.2-13.2">chain ID: is a 2-byte identifier for action chain<a href="#section-4.2-13.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.2-13.3">length -TLV - is the length of the TLV<a href="#section-4.2-13.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.2-13.4">value - contains a sequence of action SubTLVs.<a href="#section-4.2-13.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-14">Each Action SubTLV has the format:<a href="#section-4.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-15">
<pre>
    +-------------------------------+
    |  SubTLV type (2 octet)        |
    +-------------------------------+
    |  length (2 octet)             |
    +-------------------------------+
    |  value (variable)             |
    +-------------------------------+

       Figure 14

</pre><a href="#section-4.2-15" class="pilcrow">¶</a>
</div>
<p id="section-4.2-16">Where:<a href="#section-4.2-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-17.1">SubTLV type: values are action type values shown in Table 4 below.<a href="#section-4.2-17.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-17.2">length: is the length of the action subtlv<a href="#section-4.2-17.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-17.3">Value is specific to the SubTLV<a href="#section-4.2-17.3" class="pilcrow">¶</a>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-4.2-18">
<pre>

 Table 4 – FSv2 Action types

 Action   Description
 ======   ===========
   00     reserved
   01     Action Chain Operation
   02     traffic actions per interface group
   06     traffic rate limited by bytes
   07     traffic action (terminal/sample)
   08     redirect IPv4
   09     mark DSCP value
   10     associate L2 Information
   11     associate E-Tree Information
   12     traffic rate limited by packets
   13     redirect to IPv6
   14     SFC Classifier Info (moved from OD to OE)
   15     redirect to Indirection-id (move from 0x00)
   15-21  TBA (to be assigned)
   22     VLAN-Action (0x16)[draft-ietf-idr-flowspec-l2vpn-17]
   23     TPID-Action (0x17) [draft-ietf-idr-flowspec-l2vpn-17]
   24-254 TBA (to be assigned)
   255    reserved

          Figure 15
</pre><a href="#section-4.2-18" class="pilcrow">¶</a>
</div>
<p id="section-4.2-19">Ordering of actions within a rule<a href="#section-4.2-19" class="pilcrow">¶</a></p>
<p id="section-4.2-20"></p>
<p id="section-4.2-21">The actions are first stored in user-defined order.  If multiple actions exist 
  for a single action order value, then the actions will be ordered by action type followed by value.<a href="#section-4.2-21" class="pilcrow">¶</a></p>
<p id="section-4.2-22">Action specifications must include descriptions of order comparison for the values within the action.<a href="#section-4.2-22" class="pilcrow">¶</a></p>
<section id="section-4.2.1">
          <h4 id="name-action-1-action-chain-opera">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-action-1-action-chain-opera" class="section-name selfRef">Action 1 - Action Chain operation (ACO) (0x01)</a>
          </h4>
<p id="section-4.2.1-1">SubTLV: 0x01<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">Length: variable<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">Value:<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-4.1">AC-failure-type - byte that determines the action on failure<a href="#section-4.2.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.1-4.2">AC-failure-value - variable depending on AC-failure-type.<a href="#section-4.2.1-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-5">Actions may succeed or fail and an Action chain must deal with it.  
 The default value stored for an action chain that does not have this action chain is "stop on failure".<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.2.1-6">where:<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-7.1">
              <p id="section-4.2.1-7.1.1">AC-Failure types are:<a href="#section-4.2.1-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-7.1.2.1">0x00 - default - stop on failure<a href="#section-4.2.1-7.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.1-7.1.2.2">0x01 - continue on failure (best effort on actions)<a href="#section-4.2.1-7.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.1-7.1.2.3">0x02 - conditional stop on failure - depending on AC-Failure-value<a href="#section-4.2.1-7.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.1-7.1.2.4">0x03 - rollback - do all or nothing - depending in AC-Failure-value<a href="#section-4.2.1-7.1.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal ulEmpty" id="section-4.2.1-7.2">AC-Failure values:  TBD<a href="#section-4.2.1-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-8">Interactions with other actions: Interactions with all other Actions<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9">Ordering within Action type:By AC-Failure type<a href="#section-4.2.1-9" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.2">
          <h4 id="name-traffic-actions-per-interfa">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-traffic-actions-per-interfa" class="section-name selfRef">Traffic Actions per interface set (TAIS) (0x02)</a>
          </h4>
<p id="section-4.2.2-1">SubTLV: 0x2<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2"> Length:  8 octets (6 in extended community)<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3"> Value field: [4-octet-AS] [GroupID 2-octet] [action 2-octet]<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">where:<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.2-5.1">
              <p id="section-4.2.2-5.1.1">Group-ID: identifier for group in 2 octets (14 lower bits)<a href="#section-4.2.2-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-5.1.2.1">Note: Extended Community format will have 2 bits for action.<a href="#section-4.2.2-5.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal ulEmpty" id="section-4.2.2-5.2">
              <p id="section-4.2.2-5.2.1"> Action: determines inbound or outbound action where:<a href="#section-4.2.2-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-5.2.2.1">Outbound(0x1): FSv2 rule MUST be applied in outbound
        Direction to interface set identified by
        Group-id<a href="#section-4.2.2-5.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.2-5.2.2.2">Inbound (0x2): FSv2 rule MUST be applied in inbound
  Direction to interface set identified by Group-ID.<a href="#section-4.2.2-5.2.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.2-6"></p>
<p id="section-4.2.2-7">Value ordering: AS, then Group ID, then Action bytes.<a href="#section-4.2.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2.2-8">Conflict: with any bi-direction action such as<a href="#section-4.2.2-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2-9">
<li id="section-4.2.2-9.1">traffic rate limited by bytes, or<a href="#section-4.2.2-9.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.2-9.2">traffic rate limited by packets.<a href="#section-4.2.2-9.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.2.2-10">Reference: <span>[<a href="#I-D.ietf-idr-flowspec-interfaceset" class="xref">I-D.ietf-idr-flowspec-interfaceset</a>]</span><a href="#section-4.2.2-10" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.3">
          <h4 id="name-traffic-rate-limited-by-byt">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-traffic-rate-limited-by-byt" class="section-name selfRef">Traffic rate limited by bytes (TRB) (0x6)</a>
          </h4>
<p id="section-4.2.3-1"> SubTLV:0x6<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">Length: 8 octets<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3-3"> Value field:[4-octet-AS] [float (4 bytes)]<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.2.3-4">where:<a href="#section-4.2.3-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.3-5.1">
              <p id="section-4.2.3-5.1.1">[4-octet-AS]:4 byte AS number<a href="#section-4.2.3-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-5.1.2.1">If FSv1 passes the lower 2 bytes of 4 byte AS number, 
    use [TBD5] as higher 2 bytes to identify.<a href="#section-4.2.3-5.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal ulEmpty" id="section-4.2.3-5.2">
              <p id="section-4.2.3-5.2.1">Float: maximum byte rate in IEEE floating point [IEEE.754.19895 format]
  in units per second.<a href="#section-4.2.3-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-5.2.2.1">A value of 0 should result in all traffic
   for the particular flow to be discarded.<a href="#section-4.2.3-5.2.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.3-6">Value ordering: AS then float value<a href="#section-4.2.3-6" class="pilcrow">¶</a></p>
<p id="section-4.2.3-7">Action Conflict: traffic-rate-packets<a href="#section-4.2.3-7" class="pilcrow">¶</a></p>
<p id="section-4.2.3-8">reference: <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span><a href="#section-4.2.3-8" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.4">
          <h4 id="name-traffic-action-ta0x7">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-traffic-action-ta0x7" class="section-name selfRef">Traffic Action (TA)(0x7)</a>
          </h4>
<p id="section-4.2.4-1"> SubTLV: 0x7<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-2"> Length: 1<a href="#section-4.2.4-2" class="pilcrow">¶</a></p>
<p id="section-4.2.4-3">Value field: [1-octet action]<a href="#section-4.2.4-3" class="pilcrow">¶</a></p>
<p id="section-4.2.4-4">where the traffic action values are:<a href="#section-4.2.4-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-5.1">1 = Terminal flow specification action<a href="#section-4.2.4-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.4-5.2">2 - Sample - enables sampling and logging<a href="#section-4.2.4-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.4-5.3">3 - Terminal action + sample<a href="#section-4.2.4-5.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.4-6">Value ordering: By traffic action values<a href="#section-4.2.4-6" class="pilcrow">¶</a></p>
<p id="section-4.2.4-7">Conflicts/Interactions: duplication of packets also occurs in:<a href="#section-4.2.4-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-8.1"> Redirect to IPv4 (action 0x08),<a href="#section-4.2.4-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.4-8.2"> Redirect to IPv6 (action 0x0D (13)),<a href="#section-4.2.4-8.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.4-8.3"> Redirect to SFC  (action 0xOE (14))<a href="#section-4.2.4-8.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.4-8.4"> Redirect to Indirection-ID (action 0xF (15)<a href="#section-4.2.4-8.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
<section id="section-4.2.5">
          <h4 id="name-redirect-to-ipv4-rdipv40x8">
<a href="#section-4.2.5" class="section-number selfRef">4.2.5. </a><a href="#name-redirect-to-ipv4-rdipv40x8" class="section-name selfRef">Redirect to IPv4 (RDIPv4)[0x8)</a>
          </h4>
<p id="section-4.2.5-1">  SubTLV: 0x08<a href="#section-4.2.5-1" class="pilcrow">¶</a></p>
<p id="section-4.2.5-2">  Length: 12 octets<a href="#section-4.2.5-2" class="pilcrow">¶</a></p>
<p id="section-4.2.5-3">Value field:<a href="#section-4.2.5-3" class="pilcrow">¶</a></p>
<p id="section-4.2.5-4">[4-byte-AS] [IPv4 address (4 octets] [ID (4 octets)] [Flag (1 octet)]<a href="#section-4.2.5-4" class="pilcrow">¶</a></p>
<p id="section-4.2.5-5">where:<a href="#section-4.2.5-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-6.1">4-octet-AS - is a 4-byte AS in a Route Target<a href="#section-4.2.5-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-6.2">IPv4 address - is an IP Address in RT<a href="#section-4.2.5-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-6.3">ID - the 4-octet value set by user<a href="#section-4.2.5-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-6.4">
              <p id="section-4.2.5-6.4.1">Flag is 1 octet value with the following definitions:<a href="#section-4.2.5-6.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.5-6.4.2.1">0 - reserved<a href="#section-4.2.5-6.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.5-6.4.2.2">1 - copy and redirect copy<a href="#section-4.2.5-6.4.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.5-7"></p>
<p id="section-4.2.5-8">Value ordering: 4-octet AS, then IP addres, then ID (lowest to highest) with:<a href="#section-4.2.5-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-9.1"> No AS specified uses AS value of zero.<a href="#section-4.2.5-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-9.2">No IP specified uses IP value of zero.<a href="#section-4.2.5-9.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-9.3">No ID specified uses ID value of zero.<a href="#section-4.2.5-9.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.5-10">Conflicts/Interactions: Any redirection or traffic sampling found in:<a href="#section-4.2.5-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-11.1">Traffic Action (action 0x07),<a href="#section-4.2.5-11.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-11.2"> Redirect to IPv6 (action 0x0D (13)),<a href="#section-4.2.5-11.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-11.3"> Redirect to SFC  (action 0xOE (14))<a href="#section-4.2.5-11.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.5-11.4"> Redirect to Indirection-ID (action 0xF (15)<a href="#section-4.2.5-11.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.5-12">reference: <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, draft-ietf-idr-flowspec-ip-02.txt<a href="#section-4.2.5-12" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.6">
          <h4 id="name-traffic-marking-tm-0x9">
<a href="#section-4.2.6" class="section-number selfRef">4.2.6. </a><a href="#name-traffic-marking-tm-0x9" class="section-name selfRef">Traffic marking (TM) (0x9)</a>
          </h4>
<p id="section-4.2.6-1">SubTLV: 0x9<a href="#section-4.2.6-1" class="pilcrow">¶</a></p>
<p id="section-4.2.6-2">Length: 1 octet<a href="#section-4.2.6-2" class="pilcrow">¶</a></p>
<p id="section-4.2.6-3">Value: DSCP field with the 2 left most bits zero<a href="#section-4.2.6-3" class="pilcrow">¶</a></p>
<p id="section-4.2.6-4">
The DSCP field format is:<a href="#section-4.2.6-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.6-5">
<pre>
  0 1 2 3 4 5 6 7
+---------------+
|R R DSCP bits  |
+---------------+
  Figure 16

</pre><a href="#section-4.2.6-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.6-6">where:<a href="#section-4.2.6-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.6-7.1">RR - reserved bits (set to zero to send, ignored upon reception and set to zero.<a href="#section-4.2.6-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.6-7.2">DSCP - 6 bits of DSCP values<a href="#section-4.2.6-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.6-8">Ordering within Value: Based on DSCP value<a href="#section-4.2.6-8" class="pilcrow">¶</a></p>
<p id="section-4.2.6-9">Conflicts: none<a href="#section-4.2.6-9" class="pilcrow">¶</a></p>
<p id="section-4.2.6-10">reference: <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span><a href="#section-4.2.6-10" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.7">
          <h4 id="name-traffic-rate-limited-by-pac">
<a href="#section-4.2.7" class="section-number selfRef">4.2.7. </a><a href="#name-traffic-rate-limited-by-pac" class="section-name selfRef">Traffic rate limited by packets (TRP) (12/0xC)</a>
          </h4>
<p id="section-4.2.7-1">SubTLV= 12 (0xC)<a href="#section-4.2.7-1" class="pilcrow">¶</a></p>
<p id="section-4.2.7-2">Length: 8<a href="#section-4.2.7-2" class="pilcrow">¶</a></p>
<p id="section-4.2.7-3">Value field:  [4-octet-AS] [float (4 octet)]<a href="#section-4.2.7-3" class="pilcrow">¶</a></p>
<p id="section-4.2.7-4">Where:<a href="#section-4.2.7-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.7-5.1">4-octet AS - is the AS setting this value<a href="#section-4.2.7-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.7-5.2">
              <p id="section-4.2.7-5.2.1">Float - specifies maximum rate [IEEE.754.185] format in packets per second.<a href="#section-4.2.7-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.7-5.2.2.1"> A traffic rate of zero should result
  in all packets being discard.  The traffic rate should not 
  be negative.<a href="#section-4.2.7-5.2.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.7-6">Ordering within Value: Based on DSCP value<a href="#section-4.2.7-6" class="pilcrow">¶</a></p>
<p id="section-4.2.7-7">Conflicts: Traffic rate limited by bytes (0x06)<a href="#section-4.2.7-7" class="pilcrow">¶</a></p>
<p id="section-4.2.7-8">reference: <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span><a href="#section-4.2.7-8" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.8">
          <h4 id="name-traffic-redirect-to-ipv6-rd">
<a href="#section-4.2.8" class="section-number selfRef">4.2.8. </a><a href="#name-traffic-redirect-to-ipv6-rd" class="section-name selfRef">Traffic redirect to IPv6 (RDIPv6) (13, 0xD)</a>
          </h4>
<p id="section-4.2.8-1">SubTLV = 13 (0xD)<a href="#section-4.2.8-1" class="pilcrow">¶</a></p>
<p id="section-4.2.8-2">Length = 24 octets<a href="#section-4.2.8-2" class="pilcrow">¶</a></p>
<p id="section-4.2.8-3">Value field: [4-octet-as] [IPv6-address (16 octets)] [local administrator (2 octets] 
       [Flag (1 octets)]<a href="#section-4.2.8-3" class="pilcrow">¶</a></p>
<p id="section-4.2.8-4">where:<a href="#section-4.2.8-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-5.1">4-octet-AS - is the AS requesting action in 4 byte AS format,<a href="#section-4.2.8-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.8-5.2">IPv6-address - is the redirection IPv6 address<a href="#section-4.2.8-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.8-5.3">Local administrator - 2 bytes assigned by network administrator.<a href="#section-4.2.8-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.8-5.4">
              <p id="section-4.2.8-5.4.1">lag (1 octet) with the following definitions:<a href="#section-4.2.8-5.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.8-5.4.2.1">0 - reserved<a href="#section-4.2.8-5.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.8-5.4.2.2">1 - copy and redirect copy<a href="#section-4.2.8-5.4.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.8-6"></p>
<p id="section-4.2.8-7">Ordering within Value: AS, then IPv6, the flag (low to high)<a href="#section-4.2.8-7" class="pilcrow">¶</a></p>
<p id="section-4.2.8-8">Conflicts/Interactions: Any redirection or traffic sampling found in:<a href="#section-4.2.8-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-9.1">Traffic Action (action 0x07) ,<a href="#section-4.2.8-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.8-9.2"> Redirect to IPv4 (action 0x08 (8)),<a href="#section-4.2.8-9.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.8-9.3"> Redirect to SFC  (action 0xOE (14))<a href="#section-4.2.8-9.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.8-9.4"> Redirect to Indirection-ID (action 0xF (15)<a href="#section-4.2.8-9.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
<section id="section-4.2.9">
          <h4 id="name-traffic-insertion-in-sfc-ti">
<a href="#section-4.2.9" class="section-number selfRef">4.2.9. </a><a href="#name-traffic-insertion-in-sfc-ti" class="section-name selfRef">Traffic insertion in SFC (TISFC)(14, OXE)</a>
          </h4>
<p id="section-4.2.9-1">SubTLV = (14, 0xE)<a href="#section-4.2.9-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-2.1">Note: replace IANA 0xD FSv1 with FSv2 OxE.<a href="#section-4.2.9-2.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.9-3">Length = 6 octets<a href="#section-4.2.9-3" class="pilcrow">¶</a></p>
<p id="section-4.2.9-4">Value field:  [SPI (3 octets)][SI (1 octet)][SFT (2 octet)]<a href="#section-4.2.9-4" class="pilcrow">¶</a></p>
<p id="section-4.2.9-5">where:<a href="#section-4.2.9-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-6.1">SPI - is the service path identifier<a href="#section-4.2.9-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.9-6.2">SI - is the service index<a href="#section-4.2.9-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.9-6.3">SFT - is the service function type.<a href="#section-4.2.9-6.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.9-7"></p>
<p id="section-4.2.9-8">Value ordering: SPI, then SI, then SFT (lowest to highest)<a href="#section-4.2.9-8" class="pilcrow">¶</a></p>
<p id="section-4.2.9-9">Conflicts/Interactions: Any redirection or traffic sampling found in:<a href="#section-4.2.9-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-10.1">Traffic Action (action 0x07) ,<a href="#section-4.2.9-10.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.9-10.2"> Redirect to IPv4 (action 0x08 (8)),<a href="#section-4.2.9-10.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.9-10.3"> Redirect to IPv6  (action 0xOD (13))<a href="#section-4.2.9-10.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.9-10.4"> Redirect to Indirection-ID (action 0xF (15)<a href="#section-4.2.9-10.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.9-11">Reference: <span>[<a href="#RFC9015" class="xref">RFC9015</a>]</span><a href="#section-4.2.9-11" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.10">
          <h4 id="name-flow-specification-redirect">
<a href="#section-4.2.10" class="section-number selfRef">4.2.10. </a><a href="#name-flow-specification-redirect" class="section-name selfRef">Flow Specification Redirect to Indirection-ID (RDIID) (0x0F)</a>
          </h4>
<p id="section-4.2.10-1">
SubTLV: 15, 0x0F<a href="#section-4.2.10-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-2.1">note: current value is 0x00 for FSv1<a href="#section-4.2.10-2.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.10-3">Length: 6 octets<a href="#section-4.2.10-3" class="pilcrow">¶</a></p>
<p id="section-4.2.10-4">Value field:<a href="#section-4.2.10-4" class="pilcrow">¶</a></p>
<p id="section-4.2.10-5">[Flags (1 octet)] [ID-Type (1 octet)][Generalized-ID (4 octets)]<a href="#section-4.2.10-5" class="pilcrow">¶</a></p>
<p id="section-4.2.10-6">where:<a href="#section-4.2.10-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-7.1">
              <p id="section-4.2.10-7.1.1">Flags: are defined as:<a href="#section-4.2.10-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.10-7.1.2.1">
                  <p id="section-4.2.10-7.1.2.1.1">S-ID]: sequence number for indirection IDs (3 bits).<a href="#section-4.2.10-7.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.10-7.1.2.1.2.1">Value of zero means sequence is not set and all other
S-ID values should be ignored<a href="#section-4.2.10-7.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-4.2.10-7.1.2.2"> [C] - copy packets matching this ID<a href="#section-4.2.10-7.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal ulEmpty" id="section-4.2.10-7.2">
              <p id="section-4.2.10-7.2.1">ID-Type: type of indirection ID with following values:<a href="#section-4.2.10-7.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.10-7.2.2.1">0 - localized ID<a href="#section-4.2.10-7.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.10-7.2.2.2">1 - Node with SID/index in MPLS SR<a href="#section-4.2.10-7.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.10-7.2.2.3">2 - Node with SID/label in MPLS SR<a href="#section-4.2.10-7.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.10-7.2.2.4">3 - Node with Binding Segment ID with SID/Index<a href="#section-4.2.10-7.2.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.10-7.2.2.5">4 - Node with Binding Segment ID with SID/Label<a href="#section-4.2.10-7.2.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.2.10-7.2.2.6">5 - Tunnel ID<a href="#section-4.2.10-7.2.2.6" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal ulEmpty" id="section-4.2.10-7.3"> Generalized-ID (G-ID): indirection value<a href="#section-4.2.10-7.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.10-8"></p>
<p id="section-4.2.10-9">Value Ordering: first indirection ID, then Generalized ID<a href="#section-4.2.10-9" class="pilcrow">¶</a></p>
<p id="section-4.2.10-10">Action Value ordering: ID-Type by value (lowest to highest)<a href="#section-4.2.10-10" class="pilcrow">¶</a></p>
<p id="section-4.2.10-11">Conflicts/Interactions: Any redirection or traffic sampling found in:<a href="#section-4.2.10-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-12.1">Traffic Action (action 0x07) ,<a href="#section-4.2.10-12.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.10-12.2"> Redirect to IPv4 (action 0x08 (8)),<a href="#section-4.2.10-12.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.10-12.3"> Redirect to IPv6 (action 0x0D, (13)<a href="#section-4.2.10-12.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.10-12.4"> Redirect to SFC  (action 0xOE (14))<a href="#section-4.2.10-12.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.10-13">reference: <span>[<a href="#I-D.ietf-idr-flowspec-path-redirect" class="xref">I-D.ietf-idr-flowspec-path-redirect</a>]</span><a href="#section-4.2.10-13" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.11">
          <h4 id="name-vlan-action-vlan-action-0x1">
<a href="#section-4.2.11" class="section-number selfRef">4.2.11. </a><a href="#name-vlan-action-vlan-action-0x1" class="section-name selfRef">VLAN action (VLAN) (action 0x16, 22)</a>
          </h4>
<p id="section-4.2.11-1">Function: Rewrite inner or outer VLAN header<a href="#section-4.2.11-1" class="pilcrow">¶</a></p>
<p id="section-4.2.11-2">SubTLV: 22 (0x16)<a href="#section-4.2.11-2" class="pilcrow">¶</a></p>
<p id="section-4.2.11-3">Length: 6 octets<a href="#section-4.2.11-3" class="pilcrow">¶</a></p>
<p id="section-4.2.11-4">Value:<a href="#section-4.2.11-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-5.1">[Rewrite-actions (2 octets)]<a href="#section-4.2.11-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-5.2">[vlan-PCP-DE-1 (2 octets)]<a href="#section-4.2.11-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-5.3">[vlan-PCP-DE-2 [2 octets)]<a href="#section-4.2.11-5.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.11-6">where:<a href="#section-4.2.11-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-7.1">Rewrite-actions - is as follows:<a href="#section-4.2.11-7.1" class="pilcrow">¶</a>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-4.2.11-8">
<pre>

     0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
   |PO1|PU1|SW1|RI1|RO1| Resv      |PO2|PU2|SW2|RI2|RO2| Resv      |
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

       Figure 17
</pre><a href="#section-4.2.11-8" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-9.1">PO1: Pop action.  If the PO1 flag is one, it indicates the outmost
     VLAN should be removed.<a href="#section-4.2.11-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.2"> PU1: Push action.  If PU1 is one, it indicates VLAN ID1 will be
    added, the associated Priority Code Point (PCP and Drop Eligibility 
     Indicator (DEI) are PCP1 and DE1.<a href="#section-4.2.11-9.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.3"> SW1: Swap action.  If the SW1 flag is one, it indicates the outer
    VLAN and inner VLAN should be swapped.<a href="#section-4.2.11-9.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.4">PO2: Pop action.  If the PO2 flag is one, it indicates the outmost
   VLAN should be removed.<a href="#section-4.2.11-9.4" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.5">PU2: Push action.  If PU2 is one, it indicates VLAN ID2 will be
   added, the associated PCP and DEI are PCP2 and DE2.<a href="#section-4.2.11-9.5" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.6">SW2: Swap action.  If the SW2 flag is one, it indicates the outer
   VLAN and inner VLAN should be swapped.<a href="#section-4.2.11-9.6" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.7">RI1 and RI2: Rewrite inner VLAN action.  If the RIx flag is one
   where "x" is "1" or "2"), it indicates the inner VLAN should be
   replaced by a new VLAN where the new VLAN is VLAN IDx and the
   associated PCP and DEI are PCPx and DEx.  If the VLAN IDx is 0, the
   action is to only modify the PCP and DEI value of the inner VLAN.<a href="#section-4.2.11-9.7" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.8">RO1 and RO2: Rewrite outer VLAN action.  If the ROx flag is one
(where "x" is "1" or "2"), it indicates the outer VLAN should be
replaced by a new VLAN where the new VLAN is VLAN IDx and the
associated PCP and DEI are PCPx and DEx.  If the VLAN IDx is 0, the
action is to only modify the PCP and DEI value of the outer VLAN.<a href="#section-4.2.11-9.8" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.11-9.9">Resv: Reserved for future use.  MUST be sent as zero and ignored on
     receipt.<a href="#section-4.2.11-9.9" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.11-10">Value ordering: rewrite-actions, VLAN1, VLAN2, PCP-DE1, PCP-DE2<a href="#section-4.2.11-10" class="pilcrow">¶</a></p>
<p id="section-4.2.11-11">Conflicts: TIPD Action<a href="#section-4.2.11-11" class="pilcrow">¶</a></p>
<p id="section-4.2.11-12">reference: <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span><a href="#section-4.2.11-12" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.12">
          <h4 id="name-tpid-action-tpid-action-0x1">
<a href="#section-4.2.12" class="section-number selfRef">4.2.12. </a><a href="#name-tpid-action-tpid-action-0x1" class="section-name selfRef">TPID action (TPID) (action 0x17, 23)</a>
          </h4>
<p id="section-4.2.12-1">Function: Replace Inner or outer TP<a href="#section-4.2.12-1" class="pilcrow">¶</a></p>
<p id="section-4.2.12-2">SubTLV: 23 (0x17)<a href="#section-4.2.12-2" class="pilcrow">¶</a></p>
<p id="section-4.2.12-3"> Length: 6 octets<a href="#section-4.2.12-3" class="pilcrow">¶</a></p>
<p id="section-4.2.12-4"> Value:<a href="#section-4.2.12-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12-5.1">[Rewrite-actions (2 octets)]<a href="#section-4.2.12-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.12-5.2">[TP-ID-1 (2 octets)]<a href="#section-4.2.12-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-4.2.12-5.3">[TP-ID-2 (2 octets)]<a href="#section-4.2.12-5.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.12-6"> Where: rewrite-actions are bitmask (2 octets) 
    with 2 actions as follows:<a href="#section-4.2.12-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12-7">
<pre>

        0                                           15
      +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
      |TI|TO|                     Resv                |
      +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

                Figure 18
</pre><a href="#section-4.2.12-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12-8">TI: Mapping inner Tag Protocol (TP) ID (typically a VLAN) action.
    If the TI flag is one, it indicates the inner TP ID should be
    replaced by a new TP ID, the new TP ID is TP ID1.<a href="#section-4.2.12-8" class="pilcrow">¶</a></p>
<p id="section-4.2.12-9">TO: Mapping outer TP ID action.  If the TO flag is one, it indicates
   the outer TP ID should be replaced by a new TP ID, the new TP ID is
   TP ID2.<a href="#section-4.2.12-9" class="pilcrow">¶</a></p>
<p id="section-4.2.12-10">
Resv: Reserved for future use.  MUST be sent as zero and ignored on
     receipt<a href="#section-4.2.12-10" class="pilcrow">¶</a></p>
<p id="section-4.2.12-11">Value Ordering: rewrite-actions, TP-ID-1, TP-ID-2<a href="#section-4.2.12-11" class="pilcrow">¶</a></p>
<p id="section-4.2.12-12">Conflicts: VLAN action<a href="#section-4.2.12-12" class="pilcrow">¶</a></p>
<p id="section-4.2.12-13">reference:<span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span><a href="#section-4.2.12-13" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.13">
          <h4 id="name-extended-community-vs-actio">
<a href="#section-4.2.13" class="section-number selfRef">4.2.13. </a><a href="#name-extended-community-vs-actio" class="section-name selfRef">Extended Community vs. Action SubTLV formats</a>
          </h4>
<p id="section-4.2.13-1">
The SubTLV format is used for the Wide communities 
and for the action subTLVs in the NLRI.<a href="#section-4.2.13-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.13-2">
<pre>
Sub-TLV  Action Action SubTLV      Extended Community
type     Name   format             format
=======  =====  ===============    ====================
 1       ACO    type: 1            not applicable (n/a)
                length:variable

 2       TAIS   type: 2             type: 0x0702 or 0x4702
                length:8            length: 6
                [4-octet-as]        [4-octet-AS]
                [group-3-octet]     [flags-group] (2)
                [flags-1-octet]

 3-5     reserved





Sub-TLV  Action  Action SubTLV     Extended Community
type     Name    format            format
=======  =====   ===============   ====================
 6       TRB    type:6              type:8006
                length:8            length: 6
                [4-byte-AS]         [2-byte-AS]
                [float (4 octets)]  [float (4 octets)]

 7       TA     type:7              type:8007
                length:1            length:6 octets
                flags: (1 octet)    flags (6 octets)


 8       RDIPv4 type:8              type:8008
                length: 12          length: 6 octets
                [4-byte-AS]         [AS-2-octets]
                [IPv4-address]      [IPv4 address]
                                    type:8108
                                    length: 6 octets
                                    [IPv4 address]
                                    [ID-2 octets]
                                    type:8208
                                    length: 6 octets
                                    [AS-4-octets]
                                    [ID-2-octets]

9       TM      type:9              type:8009
                length:1            length:6
                DSCP: 1 octet       DSCP: 1 octet

10-11   reserved

12      TRP     type:12 (0xC)       type: 0x800C
                length: 8 octets    length: 6 octets
                [4-byte-AS]         [2-byte-AS]
                [float-4-octet]     [float-4-octet]

13      RDIPv6  type:13 (0xD)       type:0x000C
                length:22           length: 18
                [4-byte-AS]         [IPv6-address (16)]
                [IPv6-address (16)] [local-admin (2)]
                [local-admin (2)]







Sub-TLV  Action  Action SubTLV     Extended Community
type     Name    format            format
=======  =====   ===============   ====================


14      TISFC   type:14 (0xE)       type: 0xD (FSv1)
                                    type: 0xE (FSv2)
                length:6            length:6
                SPI (3 octets)      SPI (3 octets)
                SI (1 octet)        SI (1 octet)
                SFT (2 octets)      SFT (2 octets)

15      RDIID   type:15 (0xF)       Type: 0900 (FSv1)
                length: 6           length 6
                flags (1)           flags (1)
                ID-type (1)         ID type (1)
                G-ID (4 octets)     G-ID (4-octets)

16-21   reserved



22      VLAN    type:22 (0x16)      Type: (TBD)
                length:6            length:6
                [rewrite-action(2)] [rewrite-actions (2)]
                [vlan-pcp-de-1 (2)] [vlan-pcp-de-1 (2)]
                [vlan-pcp-de-2 (2)]     [vlan-pcp-de-2 (2)]

23      TPID    type:23 (0x17)      Type: (TBD)
                length:6            length:6
                [rewrite-action(2)] [rewrite-actions (2)]
                [TP-ID-1 (2)]       [TP-ID-1 (2)]
                [TP-ID-2 (2)]       [TP-ID-2 (2)]

</pre><a href="#section-4.2.13-2" class="pilcrow">¶</a>
</div>
</section>
</section>
<section id="section-4.3">
        <h3 id="name-l2-and-l2vpn-fsv2-filters">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-l2-and-l2vpn-fsv2-filters" class="section-name selfRef">L2 and L2VPN FSv2 Filters</a>
        </h3>
<p id="section-4.3-1"> field includes the AFI (2 octets), 
SAFI (1 octet) and will be 6/TBD1 or, 
for the VPN case, 28/TBD2<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>

    +-------------------------------+
    | +--------------------------+  |
    | | L3 AFI-SAFI field (3)    |  |
    | | &lt;subTLVs&gt;+               |  |
    | +==========================+  |
    +-------------------------------+


        Each SubTLV has the format:

    +-------------------------------+
    |  SubTLV type (1 octet)        |
    +-------------------------------+
    |  length (1 octet)             |
    + ------------------------------+
    |  value (variable)             |
    +-------------------------------+
             Figure 19

</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3-3">
SubTLV type: A component type value defined in the "L2 Flow Specification Component Types" registry for L2 by 
[draft-ietf-idr-flowspec-l2vpn).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">Where the SubTLVs have the following component types:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-5">
<pre>
Component Types Table

Component
type      Description
=======   ==================
1          EtherType
2          Source MAC
3          Destination MAC
4          DSAP (destination service access point)
5          SSAP (source service access point)
6          control field in LLC
7          SNAP
8          VLAN ID
9          VPAN PCP
10         Inner VLAN ID
11         Inner VLAN PCP
12         VLAN DEI
13         VLAN DEI
14         Source MAC special bits
15         Destination MAC special bits

   Table 4 – L2 VPN components

</pre><a href="#section-4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-4.3-6">See <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span> for 
the details on the format and value fields for each component.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">Value ordering: Ordering of L2 FSv2 rules will be by user-defined order of the rule.  For 
FSv2 filters within the same rule, the ordering will be by component number 
and then by value within the component.  See 
 <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span> for the ordering of the 
 values within the component.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">reference: <span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span><a href="#section-4.3-8" class="pilcrow">¶</a></p>
</section>
<section id="section-4.4">
        <h3 id="name-fsv2-sfc-nlri-traffic-filte">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-fsv2-sfc-nlri-traffic-filte" class="section-name selfRef">FSv2 SFC NLRI Traffic Filters</a>
        </h3>
<p id="section-4.4-1">The FSv2 filters allow for filtering of the SFC NLRI family of routes.  The 
traffic NLRIs filtered are from SFC AFI/SAFI (AFI = 31, SAFI=9).<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
The FSv2 filters provide this filtering with SFC AFI (AFI=31) and
 SAFI for FSv2 filters (SAFI = TB1).<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-3">
<pre>
    +--------------------------------------+
    | +---------------------------------+  |
    | | Tunneled AFI/SAFI field         |  |
    | | &lt;subTLVs&gt;+                      |  |
    | +=================================+  |
    +--------------------------------------+

              Figure 20

</pre><a href="#section-4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-4.4-4">Each SubTLV has the format:<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-5">
<pre>
    +-------------------------------+
    |  SubTLV type (1 octet)        |
    +-------------------------------+
    |  length (1 octet)             |
    + ------------------------------+
    |  value (variable)             |
    +-------------------------------+
     Figure 21 – Tunneled SubTLV format

</pre><a href="#section-4.4-5" class="pilcrow">¶</a>
</div>
<p id="section-4.4-6">The components listed are:<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-7">
<pre>
   1 = SFIR RD Type (types 1, 2, 3)
   2 = SFIR RD Value
   3 = SFIR Pool ID
   4 = SFIR MPLS context/label
   5 = SFPR SPI
   6 = SPF attribute fields

    Table 6 – SFC Filter types

</pre><a href="#section-4.4-7" class="pilcrow">¶</a>
</div>
<p id="section-4.4-8">Ordering is by: User-defined rule order, component number, and then value within component.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">reference: <span>[<a href="#RFC9015" class="xref">RFC9015</a>]</span>, [TBD]<a href="#section-4.4-9" class="pilcrow">¶</a></p>
</section>
<section id="section-4.5">
        <h3 id="name-encoding-of-actions-passed-">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-encoding-of-actions-passed-" class="section-name selfRef">Encoding of Actions passed in Wide Communities</a>
        </h3>
<p id="section-4.5-1">The BGP Flow specification version 2 actions are passed in a 
Wide Community <span>[<a href="#I-D.ietf-idr-wide-bgp-communities" class="xref">I-D.ietf-idr-wide-bgp-communities</a>]</span>
atom with the following format:<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-2">
<pre>
 +----------------------------+
 |    atom-id                 |
 +----------------------------+
 |  length (2 octets)         |
 +----------------------------+
 | &lt;Action-Sub-TLVs&gt;+   |
 +----------------------------+

 Figure 22 - Flow Specification with
 IDs for Wide Community Actions
</pre><a href="#section-4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5-3">
where:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.5-4.1">Atom-id (TBD) - is id to be defined<a href="#section-4.5-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.5-4.2">length: variable depending on SubTLVS<a href="#section-4.5-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.5-4.3">Action Sub-TLVs as defined above<a href="#section-4.5-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.5-5">The BGP Flow Specification (BGP-FS) atom can be part of the Wide Community 
container (type 1) or the BGP Flow Specification Atom can be part of the
BGP Flow Specification container (type 2) which will have:<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-6">
<pre>
+-----------------------------+
| Source AS Number  (4 octets)|
+-----------------------------+
| list of atoms (variable)    |
+-----------------------------+
Figure 23: Atom format
</pre><a href="#section-4.5-6" class="pilcrow">¶</a>
</div>
</section>
</section>
<section id="section-5">
      <h2 id="name-validation-of-fsv2-nlri">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-validation-of-fsv2-nlri" class="section-name selfRef">Validation of FSv2 NLRI</a>
      </h2>
<p id="section-5-1">The validation of FSv2 NLRI adheres to the combination of rules for general 
BGP FSv1 NLRI found in <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>, <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>,
<span>[<a href="#RFC9117" class="xref">RFC9117</a>]</span>, and the specific 
additions made for SFC NLRI <span>[<a href="#RFC9015" class="xref">RFC9015</a>]</span>, L2VPN NLRI 
<span>[<a href="#I-D.ietf-idr-flowspec-l2vpn" class="xref">I-D.ietf-idr-flowspec-l2vpn</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">To provide clarity, the full validation process for flow specification 
routes (FSv1 or FSv2) is described in this section rather 
than simply refer to the portions of these RFCs.  Validation only occurs after BGP UPDATE 
packet, the FSv2 NLRI and the path attributes relating to FSv2 (Extended
community and Wide Community) have been determined to be well-formed.  Any 
MALFORMED FSv2 NRLI is handled as a "TREAT as WITHDRAW".<a href="#section-5-2" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-validation-of-fs-nlri-fsv1-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-validation-of-fs-nlri-fsv1-" class="section-name selfRef">Validation of FS NLRI (FSv1 or FSv2)</a>
        </h3>
<p id="section-5.1-1">
Flow specification received from a BGP peer that are accepted in the
respective Adj-RIB-In are used as input to the route selection process.
Although the forwarding attributes of the two routes for same prefix may be 
the same, BGP is still required to perform its path selection algorithm in 
order to select the correct set of attributes to advertise.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The first step of the BGP Route selection procedure (section 9.1.2 of 
<span>[<a href="#RFC4271" class="xref">RFC4271</a>]</span> is to exclude from the selection procedure routes that are 
considered unfeasible. In the context of IP routing information, this 
is used to validate that the NEXT_HOP Attribute of a given route is 
 resolvable.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The concept can be extended in the case of the Flow Specification NLRI to allow other validation procedures.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The FSv2 validation process validates the FSv2 NLRI with following unicast 
routes received over the same AFI (1 or 2) but different SAFIs:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-5.1">Flow specification routes (FSv1 or FSv2) received over SAFI=133 will be validated against SAFI=1,<a href="#section-5.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-5.2">Flow Specification routes (FSv1 or FSv2) received over SAFI=134 will be validated against SAFI=128, and<a href="#section-5.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-5.3">Flow Specification routes (FSv1 or FSv2) [AFI =1, 2] received over SAFI=77 will be validated 
will be validated using only the Outer Flow Spec against SAFI = 133.<a href="#section-5.1-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-6">The FSv2 validates L2 FSv2 NLRI with the following L2 routes received over the 
same AFI (25), but a different SAFI:<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-7.1">Flow specification routes (FSv1 or FSv2)received over SAFI=135 are validated against SAFI=128.<a href="#section-5.1-7.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-8">In the absence of explicit configuration, a Flow specification NLRI (FSv1 or FSv2) 
MUST be validated such that it is considered feasible if and only if 
all of the conditions are true:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-9.1">a) A destination prefix component is embedded in the Flow Specification,<a href="#section-5.1-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.1-9.2">
            <p id="section-5.1-9.2.1">b) One of the following conditions must hold true:<a href="#section-5.1-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-9.2.2.1"> 1. The originator of the Flow Specification 
matches the originator of the best-math unicast route for the destination prefix 
embedded in the flow specification (this is the unicast route 
with the longest possible prefix length covering the destination 
prefix embedded in the flow specification).<a href="#section-5.1-9.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.1-9.2.2.2">
                <p id="section-5.1-9.2.2.2.1">2. The AS_PATH attribute of the flow specification is empty or 
contains only an AS_CONFED_SEQUENCE segment <span>[<a href="#RFC5065" class="xref">RFC5065</a>]</span>.<a href="#section-5.1-9.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-9.2.2.2.2.1">1.This condition should be enabled by default.<a href="#section-5.1-9.2.2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.1-9.2.2.2.2.2">2.This condition may be disabled by explicit configuration on a BGP Speaker,<a href="#section-5.1-9.2.2.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.1-9.2.2.2.2.3">3.As an extension to this rule, a given non-empty AS_PATH 
(besides AS_CONFED_SEQUENCE segments) MAY be permitted by policy].<a href="#section-5.1-9.2.2.2.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-5.1-9.3">c) There are no "more-specific" unicast routes when compared 
with the flow destination prefix that have been received from a different 
neighbor AS than the best-match unicast route, which has been 
determined in rule b.<a href="#section-5.1-9.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-10">However, rule a may be relaxed by explicit configuration, permitting Flow 
Specifications that include no destination prefix component.  If such is the 
case, rules b and c are moot and MUST be disregarded.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<p id="section-5.1-11">By "originator" of a BGP route, we mean either the address of the originator 
in the ORIGINATOR_ID Attribute [RFC4456] or the source address of the BGP
peer, if this path attribute is not present.<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<p id="section-5.1-12">BGP implementation MUST enforce that the AS in the left-most position of the 
AS_PATH attribute of a Flow Specification Route (FSv1 or FSv2) received via 
the Exterior Border Gateway Protocol (eBGP) matches the AS in the left-most
position of the AS_PATH attribute of the best-match unicast route for the 
destination prefix embedded in the Flow Specification (FSv1 or FSv2) NLRI.<a href="#section-5.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1-13">The best-match unicast route may change over time independently of the Flow 
Specification NLRI (FSv1 or FSv2). Therefore, a revalidation of the Flow 
Specification MUST be performed whenever unicast routes change.  
Revalidation is defined as retesting rules a to c as described above.<a href="#section-5.1-13" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-validation-of-flow-specific">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-validation-of-flow-specific" class="section-name selfRef">Validation of Flow Specification Actions</a>
        </h3>
<p id="section-5.2-1"> Flow Specification may be mapped using Extended Communities, 
Wide Communities or a FSv2 NLRI TLV.  The scaling of FSv2 actions implies that 
Extended Communities and wide communities which can associate an action to a 
large number of NLRIs will be most often used.  Therefore, it is likely the 
FSv2 NLRI TLV for actions will be very few actions (such as the "die-die-die Internet worm" use case).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The ordering of precedence for these actions in the absence of user-defined ordering, 
is to follow the precedence of the FSv2 NLRI action TLV values (lowest to highest).  
If multiple items exist for the same action type, then ordering is described within
each Action SubTLV.  Extended Community actions should be translated to the 
Action SubTLV format for internal comparison.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
Actions may conflict, duplicate, or complementation other actions. An 
example of conflict is the packet rate limiting by byte and by packet.
An example of a duplicate is the request to copy or sample a packet under
one of hte redirect functions (RDIPv4, RDIPv6, RDIID, )
Each FSv2 actions in this document defines the potential conflicts or duplications. 
Specifications for new FSv2 actions outside of this specification MUST
specify interactions or conflicts with any FSv2 actions (in this specification or 
subsequent specification).<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">Well-formed syntactically correct actions should be linked to a 
filtering rule in order the actions should be enacted.  
If one action in the ordered list fails, the default procedure is 
for the action process for this rule to stop and flag the error via system management.  
By explicit configuration, the action processing may continue after errors..<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">Implementations MAY wish to log the actions taken by FS actions (FSv1 or FSv2).<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
<section id="section-5.3">
        <h3 id="name-error-handling-and-validati">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-error-handling-and-validati" class="section-name selfRef">Error handling and Validation</a>
        </h3>
<p id="section-5.3-1">The following two error handling rules must be followed by 
all BGP speakers which support FSv2:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">FSv2 NLRI having TLVs which do not have the correct lengths or syntax must be considered MALFORMED.<a href="#section-5.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-2.2">FSv2 NLRIs having TLVs which do not follow the above ordering rules described in 
section 4.1 MUST be considered as malformed by a BGP FSv2 propagator.<a href="#section-5.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-3">
The above two rules prevent any ambiguity that arises from the multiple copies of 
the same NLRI from multiple BGP FSv2 propagators.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">A BGP implementation SHOULD treat such malformed NLRIs as 'Treat-as-withdraw'.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">
An implementation for a BGP speaker supporting both FSv1 and FSv2 must 
support the error handling for both FSv1 and FSv2.  The storage of the BGP 
FSv1 and FSv2 must support both the AFI/SAFI and the configuration which 
translates FSv1 NLRI into FSv2 NLRI for order storage.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-6">
      <h2 id="name-ordering-for-flow-specificat">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ordering-for-flow-specificat" class="section-name selfRef">Ordering for Flow Specification v2 (FS-v2)</a>
      </h2>
<p id="section-6-1">Flow Specification v2 allows the user to order flow specification rules and 
the actions associated with a rule. Each FSv2 rule has one or more match 
conditions and one or more actions associated with each rule.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This section describes how to order FSv2 filters received from a peer prior 
to transmission to another peer. The same ordering should be used for the 
ordering of forwarding filtering installed based on only FSv2 filters.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Section 7.0 describes how a BGP peer that supports FSv1 and FSv2 should order
order the flow specification filters during the installation of these flow  
specification filters into FIBs or firewall engines in routers.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The BGP distribution of FSv1 NLRI and FSv2 NLRI and their associated path 
attributes for actions (Wide Communities and Extended Communities) is 
"ships-in-the-night" forwarding of different AFI/SAFI information. This 
recommended ordering provides for deterministic ordering of filters sent by 
the BGP distribution.<a href="#section-6-4" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-ordering-of-fsv2-nlri-filte">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ordering-of-fsv2-nlri-filte" class="section-name selfRef">Ordering of FSv2 NLRI Filters</a>
        </h3>
<p id="section-6.1-1">The basic principles regarding ordering of rules are simple:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">1) Rule-0 (zero) is defined to be 0/0 with the "permit-all" action<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1.2.1">BGP peers which do not support flow specification permit traffic for 
routes received.  Rule-0 is defined to be "permit-all" for 0/0 which 
is the normal case for filtering for routes received by BGP.<a href="#section-6.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.2">By configuration option, the "permit-all" may be set to "deny-all" if 
traffic rules on routers used as BGP must have a "route" AND a 
firewall filter to allow traffic flow.<a href="#section-6.1-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal ulEmpty" id="section-6.1-2.2">2)FSv2 rules are ordered based on the user-defined order numbers 
specified in the FSv2 NLRI (rules 1-n).<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-6.1-2.3">
            <p id="section-6.1-2.3.1">3) If multiple FSv2 NLRI have the same user-defined order, then the filters are 
ordered by type of FSv2 NRLI filters (see Table 1, section 4) with 
lowest numerical number have the best precedence.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.3.2.1">For the same user-defined order and the same value for the FSv2 
filters type, then the filters are ordered by FSv2 the component type 
for that FSv2 filter type (see Tables 3-6) with the lowest number 
having the best precedence.<a href="#section-6.1-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.3.2.2">For the same user-defined order, the same value of FSv2 Filter Type, 
and the same value for the component type, then the filters are 
ordered by value within the component type.  Each component type 
defines value ordering.<a href="#section-6.1-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.3.2.3">
                <p id="section-6.1-2.3.2.3.1">For component types inherited from the FSv1 component types, there are 
the following two types of comparisons:<a href="#section-6.1-2.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.3.2.3.2.1">FSv1 component value comparison for the IP prefix values, 
compares the length of the two prefixes.  If the length is 
different, the longer prefix has precedence.  If the length is 
the same, the lower IP number has precedence.<a href="#section-6.1-2.3.2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.1-2.3.2.3.2.2">For all other FSv1 component types, unless specified, the 
component data is compared using the memcmp() function defined 
by [ISO_IEC_9899].  For strings with the same length, the lowest 
string memcmp() value has precedence. For strings of different 
lengths, the common prefix is compared. If the common string 
prefix is not equal, then the string with the lowest string 
prefix has higher precedence.  If the common prefix is equal,
the longest string is considered to have higher precedence<a href="#section-6.1-2.3.2.3.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.1-3">Notes:<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">Since the user can define rules that re-order these value comparisons, 
this order is arbitrary and set to provide a deterministic default.<a href="#section-6.1-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-6.2">
        <h3 id="name-ordering-of-the-actions">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-ordering-of-the-actions" class="section-name selfRef">Ordering of the Actions</a>
        </h3>
<p id="section-6.2-1">The FSv2 specification allows for actions to be associated by:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2-2.1">a) a Wide Community path attribute,<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-6.2-2.2">b) an Extended Community path attribute,  and<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-6.2-2.3">c)  a FSv2 Action TLV in an FSv2 NLRI (poor scaling)<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-3">Actions may be ordered by user-defined action order number from 1-n (where n 
is 2**16-2 and value of 2**16-1 is reserved.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Extended community actions are associated with order number 32768 [0x8000] 
or a specific configured value for the FSv2 domain.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Action user-order number zero is defined to have an Action type of "Set Action Chain operation" (ACO) 
(value 0x01) that defines the default action chain process. 
For details on "set action chain operation" see section 4.2.0 and section 6.2.1 below.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">If the user-defined action number for an action is the same, then the 
actions are ordered by FSv2 action types (see Table 3 for a list of action 
types).  If the user-defined action number and the FSv2 action types are the 
same, then the order must be defined by the FSv2 action.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<section id="section-6.2.1">
          <h4 id="name-action-chain-operation">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-action-chain-operation" class="section-name selfRef">Action Chain Operation</a>
          </h4>
<p id="section-6.2.1-1">The "Action Chain Operation" (ACO) changes the way the actions after this 
action in an action chain handles a failure.  If no action chain operations 
are set, then the default action of "stop upon failure" (value 0x00) will be 
used for the chain.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">
An example may help illustrate how failure impacts an action chain.  
Suppose we have the following 4 actions defined for a match:<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-3.1"> Sent
 Redirect to indirection ID (0x01) with user-defined match 2 attached in wide community,<a href="#section-6.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-3.2"> Traffic rate limit by bytes (0x07) with user-defined match 1 attached in wide community,<a href="#section-6.2.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-3.3"> Traffic sample (0x07) sent in extended community, and<a href="#section-6.2.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-3.4"> SF classifier Info (0x0E) sent in extended community.<a href="#section-6.2.1-3.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-4">These 4 filters rate limit a potential DDoS attack by: a) redirect the 
packet to indirection ID (for slower speed processing), sample to local 
hardware, and forward the attack traffic via a SFC to a data collection box.<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<p id="section-6.2.1-5">The FSv2 action list for the match would look like this<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-6.1">Action 0: Operation of action chain (0x01) (stop upon failure)<a href="#section-6.2.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-6.2">Action 1: Traffic Rate limit by byte (0x07)<a href="#section-6.2.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-6.3">Action 2: Redirect to Redirection ID (0x0F)<a href="#section-6.2.1-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-6.4">Action 32768 (0x8000) Traffic Action (0x07) Sample<a href="#section-6.2.1-6.4" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-6.5">Action 32768 (0x8000) SFC Classifier: (0xE)<a href="#section-6.2.1-6.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-7">If the redirect to a redirection ID fails, then Traffic Sample and sending the data to 
an SFC classifier for forwarding via SFC will not happen. The traffic is limited, 
but not redirect away from the network and a sample sent to DDOS processing 
via a SFC classifier.<a href="#section-6.2.1-7" class="pilcrow">¶</a></p>
<p id="section-6.2.1-8">Suppose the following 5 actions were defined for a 
FSV2 filter:<a href="#section-6.2.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-9.1">Set Action Chain Operation (ACO) (0x01) to continue on failure (ox01) 
at user-order 2 attached in wide community,<a href="#section-6.2.1-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-9.2">redirect to indirection ID (0x0F) at user-order 2 attached in wide community,<a href="#section-6.2.1-9.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-9.3">traffic rate limit by bytes (0x07)with user-order 1 attached in wide community,<a href="#section-6.2.1-9.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-9.4">Traffic sample (0x07) attached via extended community, and<a href="#section-6.2.1-9.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-9.5">SFC classifier Info (0x0E) attached in extended community.<a href="#section-6.2.1-9.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-10">The FSv2 action list for the match would look like this:<a href="#section-6.2.1-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-11.1">Action 0: Operation of action chain (0x01) (stop upon failure)<a href="#section-6.2.1-11.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-11.2">Action 01:Traffic Rate limit by byte (0x07)<a href="#section-6.2.1-11.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-11.3">Action 02:Set Action Chain Operation (ACO) (0x01) (continue on failure)<a href="#section-6.2.1-11.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-11.4">Action 02: Redirect to Redirection ID (0F)<a href="#section-6.2.1-11.4" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-11.5">Action 32768 (0x8000): Traffic Action (0x07) Sample<a href="#section-6.2.1-11.5" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.2.1-11.6">Action 32768 (0x8000): SFC classifier (0x0E) forward via SFC [to DDoS classifier]<a href="#section-6.2.1-11.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-12">
If the redirect to a redirection ID fails, 
the action chain will continue on to sample the data and enact SFC classifier actions.<a href="#section-6.2.1-12" class="pilcrow">¶</a></p>
<p id="section-6.2.1-13">Note:The scaling for associating actions is better with Wide or Extended Communities
which can be associated with many FSv2 filters.  The FSv2 action with 
FSv2 NLRI should be used in rare cases such the use case of an pernicious Internet worm. 
In this case, Suppose we call the filter "Internet worm" particular filter match 
identifies the pernicious Internet worm that must be die off and not be forwarded.  
Let us call the actions in the action chain "Die-Die-Internet-worm".  
For such a use case, the the FSV2 actions to stop the packets are tied to the 
filter even though it may not scale or have issues  in some deployments.<a href="#section-6.2.1-13" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.2">
          <h4 id="name-summary-of-fsv2-ordering">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-summary-of-fsv2-ordering" class="section-name selfRef">Summary of FSv2 ordering</a>
          </h4>
<p id="section-6.2.2-1">Operators should use user-defined ordering to clearly specify the actions
desired upon a match.  The FSv2 actions default ordering is specified to  
provide deterministic order for actions which have the same user-defined 
order and same type.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-2">
<pre>

FS Action                        Value Order
(lowest value to highest)        (lowest to highest)
=============================    =================================
0x01: Action chain operation     Failure flag
0x02: traffic actions per        AS, then Group-ID, then Action ID
       Interface group

0x03-0x05 to be assigned         TBD

0x06: Traffic rate limit         AS, then float value
0x07 – Traffic Action            traffic Action value
0x08 – Redirect to IP            AS, then IP Address, then ID
0x09 – Traffic Marking           DSCP value (lowest to highest)
0x0C – Redirect to Indirect ID   AS, then Float value
0x0D – Traffic Redirect to IPv6  AS, IPv6 value, then local Admin
0x0E – Traffic insertion to SFC  SPI, then SI, the SFT
0xOF – Redirect to
          Indirection-ID         ID-type, then Generalized-ID

0x10-0x15 – to be assigned           TBD

0x16 – VLAN action               rewrite-actions, VALN1, VLAN2,
                                 PCP-DE1, PCP-DE2
0x17 – TPID action               rewrite actions, TP-ID-1, TP-ID-2

                 Figure 24
</pre><a href="#section-6.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
<section id="section-7">
      <h2 id="name-ordering-of-fs-filters-for-">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-ordering-of-fs-filters-for-" class="section-name selfRef">Ordering of FS filters for BGP Peers support FSv1 and FSv2</a>
      </h2>
<p id="section-7-1">
FSv2 allows the user to order flow specification rules and the actions 
associated with a rule. Each FSv2 rule has one or more match conditions and 
one or more actions associated with each rule.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Some BGP peers will support FSv1 and FSv2.  This section describes the best 
practice for ordering the FSv1 and FSv2 filter rules.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">One simple rule captures the best practice:  Order the FSv1 filters after
the FSv2 filter by placing the FSv1 filters after the FSv2 filters.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">To operationally make this work, all flow specification filters should be 
included the same data base with the FSv1 filters being assigned a user-
defined order beyond the normal size of FSv2 user-ordered values.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">Suppose you might have 10,000 rules for the FSv2 filters.  Assign all the 
FSv1 user defined rules to 10,001 (or better yet 20,000).  The FSv1 rules 
will be ordered by the components and component values.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">
All FSv1 actions are defined ordered actions in FSv2.  Translate your FSv1 
actions into FSv2 ordered actions for storing in a common FSv1-FSv2 flow 
specification data base.<a href="#section-7-6" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-scalability-and-aspirations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-scalability-and-aspirations" class="section-name selfRef">Scalability and Aspirations for FSv2</a>
      </h2>
<p id="section-8-1">Operational issues drive the deployment of BGP flow specification as a quick 
and scalable way to distribute filters.  The early operations accepted the 
fact validation of the distribution of filter needed to be done outside of 
the BGP distribution mechanism.  Other mechanisms (NETCONF/RESTCONF or PCEP) 
have reply-request protocols.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">These features within BGP have not changed. BGP still does not have an 
action-reply feature.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">NETCONF/RESTCONF latest enhancements provide action/response features which 
scale.  The combination of a quick distribution of filters via BGP and a 
long-term action in NETCONF/RESTCONF that ask for reporting of the
installation of FSv2 filters may provide the best scalability.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">The combination of NETCONF/RESTCONF NM protocols and BGP focuses each 
protocol on the strengths of scalability.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">FSv2 will be deployed in webs of BGP peers which have some BGP peers passing 
FSv1, some BGP peers passing FSv2, some BGP peers passing FSv1 and FSv2, and 
some BGP peers not passing any routes.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">The TLV encoding and deterministic behaviors of FSv2 will not deprecate the 
need for careful design of the distribution of flow specification filters in 
this mixed environment.  The needs of networks for flow specification are 
different depending on the network topology and the deployment technology 
for BGP peers sending flow specification.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">Suppose we have a centralized RR connected to DDoS processing sending out 
flow specification to a second tier of RR who distribute the information to 
targeted nodes. This type of distribution has one set of needs for FSv2 and 
the transition from FSv1 to FSv2<a href="#section-8-7" class="pilcrow">¶</a></p>
<p id="section-8-8">Suppose we have Data Center with a 3-tier backbone trying to distribute DDoS 
or other filters from the spine to combinational nodes, to the leaf BGP 
nodes.  The BGP peers may use RR or normal BGP distribution. This deployment
has another set of needs for FSv2 and the transition from FSv1 to FSV2.<a href="#section-8-8" class="pilcrow">¶</a></p>
<p id="section-8-9">Suppose we have a corporate network with a few AS sending DDoS filters using 
basic BGP from a variety of sites. Perhaps the corporate network will be 
satisfied with FSv1 for a long time.<a href="#section-8-9" class="pilcrow">¶</a></p>
<p id="section-8-10">These examples are given to indicate that BGP FSv2 like so many BGP 
protocols needs to be carefully tuned to aid the mitigation services within 
the network. This protocol suite starts the migration toward better tools 
using FSv2, but it does not end it.  With FSv2 TLVs and deterministic 
actions, new operational mechanisms can start to be understood and utilized.<a href="#section-8-10" class="pilcrow">¶</a></p>
<p id="section-8-11">This FSv2 specification is merely the start of a revolution of work - not the end.<a href="#section-8-11" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-optional-security-additions">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-optional-security-additions" class="section-name selfRef">Optional Security Additions</a>
      </h2>
<p id="section-9-1">This section discusses the optional BGP Security additions for BGP-FS v2
relating to BGPSEC <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span> and ROA.<a href="#section-9-1" class="pilcrow">¶</a></p>
<section id="section-9.1">
        <h3 id="name-bgp-fs-v2-and-bgpsec">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-bgp-fs-v2-and-bgpsec" class="section-name selfRef">BGP FS v2 and BGPSEC</a>
        </h3>
<p id="section-9.1-1"> Flow specification v1 (<span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>)
do not comment on how BGP Flow specifications to be passed BGPSEC <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span>
  BGP Flow Specification v2 can be passed in BGPSEC, but it is not required.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">FSv1 and FSv2 may be sent via BGPSEC.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-9.2">
        <h3 id="name-bgp-fs-v2-with-with-roa">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-bgp-fs-v2-with-with-roa" class="section-name selfRef">BGP FS v2 with with ROA</a>
        </h3>
<p id="section-9.2-1">
  BGP Flow Specification v2 can utilize ROAs in the validation. If BGP-FS v2 is 
  used with BGPSEC and ROA, the first thing is to validate the 
  route within BGPSEC and second to utilize BGP ROA to validate
  the route origin.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2"> The BGP-FS peers using both ROA and BGP-FS validation 
  determine that a BGP Flow specification is valid
  if and only if one of the following cases:<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-3.1">
            <p id="section-9.2-3.1.1">If the BGP Flow Specification NLRI has a IPv4 or 
  IPv6 address in destination address match
  filter and the following is true:<a href="#section-9.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-3.1.2.1">A BGP ROA has been received to validate the originator, and<a href="#section-9.2-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2-3.1.2.2">the route is the best-match unicast route for the destination
  prefix embedded in the match filter; or<a href="#section-9.2-3.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-9.2-3.2">
            <p id="section-9.2-3.2.1">If a BGP ROA has not been received that matches the 
  IPv4 or IPv6 destination address in the destination filter, the 
  match filter must abide by the <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> and
  <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span> validation rules of:<a href="#section-9.2-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-3.2.2.1">The originator match of the flow specification matches the
  originator of the best-match unicast route for the destination
  prefix filter embedded in the flow specification", and<a href="#section-9.2-3.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2-3.2.2.2">No more specific unicast routes exist when compared with the 
   flow destination prefix that have been received from a different
   neighboring AS than the best-match unicast route, which has been 
   determined in step A.<a href="#section-9.2-3.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-9.2-4">
  The best match is defined to be the longest-match NLRI with the highest preference.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
</section>
</section>
<div id="IANA">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This section complies with <span>[<a href="#RFC7153" class="xref">RFC7153</a>]</span><a href="#section-10-1" class="pilcrow">¶</a></p>
<section id="section-10.1">
        <h3 id="name-flow-specification-v2-safis">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-flow-specification-v2-safis" class="section-name selfRef">Flow Specification V2 SAFIs</a>
        </h3>
<p id="section-10.1-1"> IANA is required to assign two SAFI Values from the 
   registry at https://www.iana.org/assignments/safi-namespace 
   from the Standard Action Range as follows:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.1-2">
<pre>
        Value   Description      Reference
     -----   -------------    ---------------
      TBD1   BGP-FS V2        [This document]
      TBD2   BGP-FS V2 VPN    [this document]

</pre><a href="#section-10.1-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-10.2">
        <h3 id="name-bgp-capability-code">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-bgp-capability-code" class="section-name selfRef">BGP Capability Code</a>
        </h3>
<p id="section-10.2-1">
   IANA is requested to assign a Capability Code from the registry at 
   https://www.iana.org/assignments/capability-codes/ from the IETF Review
   range as follows:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.2-2">
<pre>
   Value   Description            Reference       Controller
   -----  ---------------------  ---------------  ----------
    TBD3  Flow Specification V2  [this document]  IETF
</pre><a href="#section-10.2-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-10.3">
        <h3 id="name-filter-ip-component-types">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-filter-ip-component-types" class="section-name selfRef">Filter IP Component types</a>
        </h3>
<p id="section-10.3-1">IANA is requested to indicate [this draft] as a reference on the 
   following assignments in the Flow Specification Component Types 
   Registry:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.3-2">
<pre>
     Value  Description          Reference
     -----  -------------------- ------------------------
        1   Destination filter   [RFC8955][RFC8956][this draft]
        2   Source Prefix        [RFC8955][RFC8956][this draft]
        3   IP Protocol          [RFC8955][RFC8956][this draft]
        4   Port                 [RFC8955][RFC8956][this draft]
        5   Destination Port     [RFC8955][RFC8956][this draft]
        6   Source Port          [RFC8955][RFC8956][this draft]
        7   ICMP Type [v4 or v6] [RFC8955][RFC8956][this draft]
        8   ICMP Code [v4 or v6] [RFC8955][RFC8956][this draft]
        9   TCP Flags [v4]       [RFC8955][RFC8956][this draft]
       10   Packet Length        [RFC8955][RFC8956][this draft]
       11   DSCP marking         [RFC8955][RFC8956][this draft]
       12   Fragment             [RFC8955][RFC8956][This draft]
       13   Flow Label           [RFC8956] [This draft]
       14   Partial SID          {draft-ietf-idr-flowspec-srv6]
                                 [This draft]
</pre><a href="#section-10.3-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-10.4">
        <h3 id="name-filter-ip-component-types-2">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-filter-ip-component-types-2" class="section-name selfRef">Filter IP component types</a>
        </h3>
<p id="section-10.4-1">IANA is requested to create the following two new registries 
      on a new "Flow Specification v2 TLV types".<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.4-2">
<pre>
   Name: BGP FSv2 TLV types
   Reference: [this document]
   Registration Procedures: 0x01-0x3FFF Standards Action.

    Type          Use                     Reference
   -----          ---------------         ---------------
    0x00          Reserved                [this document]
    0x01          IP traffic rules        [this document]
    0x02          FSv2 Actions            [this document]
    0x03          L2 traffic rules        [this document]
    0x04          tunnel traffic rules    [this document]
    0x05          SFC AFI filter rules    [this document]
    0x06-0x3FFF   Unassigned              [this document]
    0x4000-0x7FFF Vendor specific         [this document]
    0x8000-
      0xFFFFFFFF  Reserved                [this document]

</pre><a href="#section-10.4-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-10.4-3">
<pre>

   Name: BGP FSv2 Action types
   Reference: [this document]
   Registration Procedure: 0x01-0x3FFF Standards Action.

    Type     Use                           Reference
   -----  ---------------                 ---------------
   0x00   Reserved                        [this document]
   0x01   Action Chain Operation (ACO)    [this document]
   0x02   Traffic actions per
          interface group                 [this document]
   0x03   Unassigned                      [this document]
   0x04   Unassigned                      [this document]
   0x05   Unassigned                      [this document]
   0x06   traffic rate limited by bytes   [this document]
   0x07   traffic action (terminal/sample)[this document]
   0x08   redirect IPv4                   [this document]
   0x09   mark DSCP value                 [this document]
   0x0a   associate L2 Information        [this document]
   0x0b   associate E-Tree Information    [this document]
   0xoc   traffic rate limited by packets [this document]
   0x0D   Redirect to IPv6                [this document]
   0x0E   Traffic insertion to SFC        [this document]
   0x0F   Redirect to indirection-iD      [this document]
   0x10   unassigned                      [this document]
   0x11   unassigned                      [this document]
   0x12   unassigned                      [this document]
   0x13   unassigned                      [this document]
   0x14   unassigned                      [this document]
   0x15   unassigned                      [this document]
   0x16   VLAN action                     [this document]
   0x17   TIPD action                     [this document]
   0x18-
   0x3ff  Unassigned                      [this document]
   0x4000-
   0x7fff Vendor assigned                 [this document]
   0xc800-
   0xFFFFFFFFF                            [this document]
</pre><a href="#section-10.4-3" class="pilcrow">¶</a>
</div>
</section>
</section>
</div>
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">The use of ROA improves on <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span>
   by checking to see of the route origination. This check can improve the 
   validation sequence for a multiple-AS environment.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">&gt;The use of BGPSEC  <span>[<a href="#RFC8205" class="xref">RFC8205</a>]</span> to secure the packet
   can increase security of BGP flow specification information sent in the packet.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">The use of the reduced validation within an AS <span>[<a href="#RFC9117" class="xref">RFC9117</a>]</span>
   can provide adequate validation for distribution of flow specification within an single 
   autonomous system for prevention of DDOS.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">Distribution of flow filters may provide insight into traffic being sent within 
   an AS, but this information should be composite information that does not reveal the
   traffic patterns of individuals.<a href="#section-11-4" class="pilcrow">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-idr-flowspec-interfaceset">[I-D.ietf-idr-flowspec-interfaceset]</dt>
        <dd>
<span class="refAuthor">Litkowski, S.</span>, <span class="refAuthor">Simpson, A.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Haas, J.</span>, and <span class="refAuthor">L. Yong</span>, <span class="refTitle">"Applying BGP flowspec rules on a specific interface set"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-flowspec-interfaceset-05</span>, <time datetime="2019-11-18" class="refDate">18 November 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-interfaceset-05.txt">https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-interfaceset-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-flowspec-l2vpn">[I-D.ietf-idr-flowspec-l2vpn]</dt>
        <dd>
<span class="refAuthor">Hao, W.</span>, <span class="refAuthor">Eastlake, D. E.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">S. Zhuang</span>, <span class="refTitle">"BGP Dissemination of L2 Flow Specification Rules"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-flowspec-l2vpn-17</span>, <time datetime="2021-05-12" class="refDate">12 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-l2vpn-17.txt">https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-l2vpn-17.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-flowspec-nvo3">[I-D.ietf-idr-flowspec-nvo3]</dt>
        <dd>
<span class="refAuthor">Eastlake, D.</span>, <span class="refAuthor">Weiguo, H.</span>, <span class="refAuthor">Zhuang, S.</span>, <span class="refAuthor">Li, Z.</span>, and <span class="refAuthor">R. Gu</span>, <span class="refTitle">"BGP Dissemination of Flow Specification Rules for Tunneled Traffic"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-flowspec-nvo3-14</span>, <time datetime="2021-08-15" class="refDate">15 August 2021</time>, <span>&lt;<a href="https://www.ietf.org/internet-drafts/draft-ietf-idr-flowspec-nvo3-14.txt">https://www.ietf.org/internet-drafts/draft-ietf-idr-flowspec-nvo3-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-flowspec-path-redirect">[I-D.ietf-idr-flowspec-path-redirect]</dt>
        <dd>
<span class="refAuthor">Velde, G. V. D.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"Flowspec Indirection-id Redirect"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-flowspec-path-redirect-11</span>, <time datetime="2020-05-26" class="refDate">26 May 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-path-redirect-11.txt">https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-path-redirect-11.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-flowspec-srv6">[I-D.ietf-idr-flowspec-srv6]</dt>
        <dd>
<span class="refAuthor">Li, Z.</span>, <span class="refAuthor">Li, L.</span>, <span class="refAuthor">Chen, H.</span>, <span class="refAuthor">Loibl, C.</span>, <span class="refAuthor">Mishra, G. S.</span>, <span class="refAuthor">Fan, Y.</span>, <span class="refAuthor">Zhu, Y.</span>, <span class="refAuthor">Liu, L.</span>, and <span class="refAuthor">X. Liu</span>, <span class="refTitle">"BGP Flow Specification for SRv6"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-flowspec-srv6-00</span>, <time datetime="2021-10-08" class="refDate">8 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-srv6-00.txt">https://www.ietf.org/archive/id/draft-ietf-idr-flowspec-srv6-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-wide-bgp-communities">[I-D.ietf-idr-wide-bgp-communities]</dt>
        <dd>
<span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Haas, J.</span>, <span class="refAuthor">Lange, A.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Amante, S.</span>, and <span class="refAuthor">P. Jakma</span>, <span class="refTitle">"BGP Community Container Attribute"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-wide-bgp-communities-05</span>, <time datetime="2018-07-02" class="refDate">2 July 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-wide-bgp-communities-05.txt">https://www.ietf.org/archive/id/draft-ietf-idr-wide-bgp-communities-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4360">[RFC4360]</dt>
        <dd>
<span class="refAuthor">Sangli, S.</span>, <span class="refAuthor">Tappan, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP Extended Communities Attribute"</span>, <span class="seriesInfo">RFC 4360</span>, <span class="seriesInfo">DOI 10.17487/RFC4360</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4360">https://www.rfc-editor.org/info/rfc4360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4760">[RFC4760]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chandra, R.</span>, <span class="refAuthor">Katz, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Multiprotocol Extensions for BGP-4"</span>, <span class="seriesInfo">RFC 4760</span>, <span class="seriesInfo">DOI 10.17487/RFC4760</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5065">[RFC5065]</dt>
        <dd>
<span class="refAuthor">Traina, P.</span>, <span class="refAuthor">McPherson, D.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Autonomous System Confederations for BGP"</span>, <span class="seriesInfo">RFC 5065</span>, <span class="seriesInfo">DOI 10.17487/RFC5065</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5065">https://www.rfc-editor.org/info/rfc5065</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6482">[RFC6482]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span>, <span class="refAuthor">Kent, S.</span>, and <span class="refAuthor">D. Kong</span>, <span class="refTitle">"A Profile for Route Origin Authorizations (ROAs)"</span>, <span class="seriesInfo">RFC 6482</span>, <span class="seriesInfo">DOI 10.17487/RFC6482</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6482">https://www.rfc-editor.org/info/rfc6482</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7153">[RFC7153]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"IANA Registries for BGP Extended Communities"</span>, <span class="seriesInfo">RFC 7153</span>, <span class="seriesInfo">DOI 10.17487/RFC7153</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7153">https://www.rfc-editor.org/info/rfc7153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8955">[RFC8955]</dt>
        <dd>
<span class="refAuthor">Loibl, C.</span>, <span class="refAuthor">Hares, S.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">McPherson, D.</span>, and <span class="refAuthor">M. Bacher</span>, <span class="refTitle">"Dissemination of Flow Specification Rules"</span>, <span class="seriesInfo">RFC 8955</span>, <span class="seriesInfo">DOI 10.17487/RFC8955</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8955">https://www.rfc-editor.org/info/rfc8955</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8956">[RFC8956]</dt>
        <dd>
<span class="refAuthor">Loibl, C., Ed.</span>, <span class="refAuthor">Raszuk, R., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"Dissemination of Flow Specification Rules for IPv6"</span>, <span class="seriesInfo">RFC 8956</span>, <span class="seriesInfo">DOI 10.17487/RFC8956</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8956">https://www.rfc-editor.org/info/rfc8956</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9015">[RFC9015]</dt>
        <dd>
<span class="refAuthor">Farrel, A.</span>, <span class="refAuthor">Drake, J.</span>, <span class="refAuthor">Rosen, E.</span>, <span class="refAuthor">Uttaro, J.</span>, and <span class="refAuthor">L. Jalil</span>, <span class="refTitle">"BGP Control Plane for the Network Service Header in Service Function Chaining"</span>, <span class="seriesInfo">RFC 9015</span>, <span class="seriesInfo">DOI 10.17487/RFC9015</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9015">https://www.rfc-editor.org/info/rfc9015</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9117">[RFC9117]</dt>
      <dd>
<span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Alcaide, J.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Smith, D.</span>, and <span class="refAuthor">P. Mohapatra</span>, <span class="refTitle">"Revised Validation Procedure for BGP Flow Specifications"</span>, <span class="seriesInfo">RFC 9117</span>, <span class="seriesInfo">DOI 10.17487/RFC9117</span>, <time datetime="2021-08" class="refDate">August 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9117">https://www.rfc-editor.org/info/rfc9117</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span> and <span class="refAuthor">K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8206">[RFC8206]</dt>
      <dd>
<span class="refAuthor">George, W.</span> and <span class="refAuthor">S. Murphy</span>, <span class="refTitle">"BGPsec Considerations for Autonomous System (AS) Migration"</span>, <span class="seriesInfo">RFC 8206</span>, <span class="seriesInfo">DOI 10.17487/RFC8206</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8206">https://www.rfc-editor.org/info/rfc8206</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Susan Hares</span></div>
<div dir="auto" class="left"><span class="org">Hickory Hill Consulting</span></div>
<div dir="auto" class="left"><span class="street-address">7453 Hickory Hill</span></div>
<div dir="auto" class="left">
<span class="locality">Saline</span>, <span class="region">MI</span> <span class="postal-code">48176</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shares@ndzh.com" class="email">shares@ndzh.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Donald Eastlake</span></div>
<div dir="auto" class="left"><span class="org">Futurewei Technologies</span></div>
<div dir="auto" class="left"><span class="street-address">2396 Panoramic Circle</span></div>
<div dir="auto" class="left">
<span class="locality">Apopka</span>, <span class="region">FL</span> <span class="postal-code">32703</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1-508-333-2270" class="tel">+1-508-333-2270</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:d3e3e3@gmail.com" class="email">d3e3e3@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chaitanya Yadlapalli</span></div>
<div dir="auto" class="left"><span class="org">ATT</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cy098d@att.com" class="email">cy098d@att.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sven Maduschke</span></div>
<div dir="auto" class="left"><span class="org">Verizon</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sven.maduschke@de.verizon.com" class="email">sven.maduschke@de.verizon.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
