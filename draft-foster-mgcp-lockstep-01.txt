
Internet Engineering Task Force                             B. Foster 
Internet Draft                                           F. Andreasen 
Document: <draft-foster-mgcp-lockstep-01.txt>           Cisco Systems 
Category: Informational                                     July 2003 
                                                            
 
 
     Media Gateway Control Protocol (MGCP) Lockstep State Reporting 
                               Mechanism 
 
Status of this Document 
 
  This document is an Internet-Draft and is in full conformance with 
  all provisions of Section 10 of RFC2026 
   
  Internet-Drafts are working documents of the Internet Engineering 
  Task Force (IETF), its areas, and its working groups. Note that other 
  groups may also distribute working documents as Internet- Drafts. 
   
  Internet-Drafts are draft documents valid for a maximum of six months 
  and may be updated, replaced, or obsoleted by other documents at any 
  time. It is inappropriate to use Internet- Drafts as reference 
  material or to cite them other than as work in progress." 
   
  The list of current Internet-Drafts can be accessed at 
  http://www.ietf.org/ietf/1id-abstracts.txt 
   
  The list of Internet-Draft Shadow Directories can be accessed at 
  http://www.ietf.org/shadow.html. 
 
Abstract 
 
  A Media Gateway Control Protocol (MGCP) endpoint that has encountered 
  an adverse failure condition such as being involved in a transient 
  call when a Call Agent failover occurred could be left in a lockstep 
  state such that events are quarantined but not notified. The MGCP 
  package described in this document provides a mechanism for reporting 
  these situations so that the new Call Agent can take the necessary 
  fault recovery procedures. 
 
Conventions used in this document 
   
  The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
  "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this 
  document are to be interpreted as described in RFC-2119 [1]. 









 
B. Foster, F. Andreasen      Informational                     [Page 1] 

             MGCP Lockstep State Reporting Mechanism          July 2003 

1. Introduction 
 
  In the Media Gateway Control Protocol (MGCP) [2], when an endpoint 
  operating in "step" mode generates a Notify, it will enter the 
  "notification state" where it waits for a response to the Notify.  
  Furthermore, the endpoint must wait for a new NotificationRequest 
  before it can resume event processing.  As long as the endpoint is 
  waiting for this NotificationRequest, we say that it is in the 
  lockstep state.  
   
  An endpoint that is in lockstep state cannot perform any event 
  processing and hence can also not generate any new Notifys.  
  Endpoints should only be in lockstep state for a very short time, 
  however in case of adverse conditions, an endpoint could potentially 
  end in the lockstep state without the Call Agent realizing it. 
  Clearly, this could have very negative consequences in terms of the 
  service provided.  
   
  The Lockstep package defined in this document defines extensions to 
  the EndpointConfiguration and RestartInProgress commands that allow a 
  Call Agent to request an endpoint to inform it if the endpoint is in 
  the lockstep state for a specified period of time.  
   
2.0. Lockstep Package 
   
  Package Name: LCK 
  Version: 0 
   
  Package Description: The purpose of this package is to provide a 
  mechanism for reporting a condition in which an endpoint has been in 
  the "lockstep state" for a specified period of time. 
   
  There are two aspects of this package: 
   
     * The ability for a Call Agent to request endpoints to report if 
       they are in lockstep state. This is done with the 
       EndpointConfiguration command as described in section 2.1. 
     * The reporting mechanism itself, which is done with a new 
       "lockstep" RestartMethod for the RSIP command as described in 
       section 2.2. 
   
2.1. Request to Report Lockstep State 
 
  The new "lstime" EndpointConfiguration parameter is used by the Call 
  Agent to request the reporting of "lockstep" state.  It uses the 
  following ABNF: 
   
     "LCK/LST:" 0*WSP LSTIME 
   
     LSTIME = 1*(4DIGIT) 
   
  where LSTIME is expressed in seconds, with a value ranging from 0 to 
  999. A value greater than 2*T-HIST (refer to [2]) is RECOMMENDED. 
   
 
B. Foster, F. Andreasen      Informational                     [Page 2] 

             MGCP Lockstep State Reporting Mechanism          July 2003 

  LSTIME is the amount of time the endpoint is in the lockstep state 
  before reporting.  The timer starts when the endpoint enters the 
  lockstep state and is cancelled if the endpoint leaves the lockstep 
  state before the timeout occurs.  The value zero is used to turn off 
  reporting.  
   
  This parameter can be audited using the AuditEndpoint command. 
 
2.2. Lockstep restart Method 
 
  A new "lockstep" restart method is defined in the "LCK" package.  A 
  RestartInProgress (RSIP) will be sent with this RestartMethod if the 
  endpoint has been configured with a non-zero value for LSTIME and 
  that timer has expired.  The syntax of the restart method is as per 
  [2]: 
   
     "RM" ":" 0*(WSP) "LCK/lockstep" 
   
  RestartDelay (see [2]) is not used with the "lockstep" RestartMethod.  
  Also, the "lockstep" RestartMethod does not define a service-state, 
  and hence it will never be returned when auditing the RestartMethod.  
 
3.0. IANA Considerations 
   
  The MGCP package title "Lockstep" with the name "LCK" and version 
  number zero should be registered with IANA as indicated in Appendix 
  C.1 in [2]. 
 
4.0. Security Considerations 
 
  Section 5 of the base MGCP specification [2] discusses security 
  requirements for the base MGCP protocol, which apply equally to the 
  package defined in this document.  Use of a security Protocol such as 
  IPsec (RFC 2401, RFC 2406) that provides per message authentication 
  and integrity services is required in order to ensure that requests 
  and responses are obtained from authenticated sources and that 
  messages have not been modified.  Without such services, gateways and 
  Call Agents are open to attacks. 
 
5.0. Normative References 
 
 [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement 
      Levels", BCP 14, RFC 2119, March 1997. 
 [2]  F. Andreasen, B. Foster "Media Gateway Control Protocol (MGCP) 
      Version 1.0", RFC 3435, January 2003. 
   
Authors' Addresses 
 
  Bill Foster 
  Phone: +1 250 758 9418 
  EMail: bfoster@cisco.com 
   
 
B. Foster, F. Andreasen      Informational                     [Page 3] 

             MGCP Lockstep State Reporting Mechanism          July 2003 

  Flemming Andreasen 
  Cisco Systems 
  499 Thornall Street, 8th Floor 
  Edison, NJ 08837 
  EMail: fandreas@cisco.com 
    
Intellectual Property Statement 
    
   The IETF takes no position regarding the validity or scope of any 
   intellectual property or other rights that might be claimed to  
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
   might or might not be available; neither does it represent that it 
   has made any effort to identify any such rights.  Information on the 
   IETF's procedures with respect to rights in standards-track and 
   standards-related documentation can be found in BCP-11.  Copies of 
   claims of rights made available for publication and any assurances 
   of licenses to be made available, or the result of an attempt made 
   to obtain a general license or permission for the use of such 
   proprietary rights by implementors or users of this specification 
   can be obtained from the IETF Secretariat. 
    
   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights which may cover technology that may be required to practice 
   this standard.  Please address the information to the IETF Executive 
   Director. 
 
Full Copyright Statement 
 
  Copyright (C) The Internet Society (2003).  All Rights Reserved. 
   
  This document and translations of it may be copied and furnished to 
  others, and derivative works that comment on or otherwise explain it 
  or assist in its implementation may be prepared, copied, published 
  and distributed, in whole or in part, without restriction of any 
  kind, provided that the above copyright notice and this paragraph are 
  included on all such copies and derivative works.  However, this 
  document itself may not be modified in any way, such as by removing 
  the copyright notice or references to the Internet Society or other 
  Internet organizations, except as needed for the purpose of 
  developing Internet standards in which case the procedures for 
  copyrights defined in the Internet Standards process must be 
  followed, or as required to translate it into languages other than 
  English. 
   
  The limited permissions granted above are perpetual and will not be 
  revoked by the Internet Society or its successors or assigns. 
   
  This document and the information contained herein is provided on an 
  "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING 
  TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING 
  BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION 

 
B. Foster, F. Andreasen      Informational                     [Page 4] 

             MGCP Lockstep State Reporting Mechanism          July 2003 

  HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF 
  MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 
   
Acknowledgement 
   
  Funding for the RFC Editor function is currently provided by the 
  Internet Society. 
 
   
 












































 
B. Foster, F. Andreasen      Informational                     [Page 5] 
