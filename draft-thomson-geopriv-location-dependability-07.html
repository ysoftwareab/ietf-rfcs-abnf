<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Digital Signature Methods for Location Dependability </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Goals">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Non-Goals">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Basic Countermeasures">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Signing Location Information">
<link href="#rfc.section.3" rel="Chapter" title="3 PIDF-LO Signature">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Signature Design">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Signed Elements and Semantics">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Signature Algorithms">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 LIS/Signer Identification">
<link href="#rfc.section.4" rel="Chapter" title="4 Limited Validity">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Validity Elements">
<link href="#rfc.section.5" rel="Chapter" title="5 Signing for a User">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 The 'entity' Attribute">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Target Identity">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Protecting User Anonymity">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Authenticated Identity">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Multiple Identity Attack">
<link href="#rfc.section.6" rel="Chapter" title="6 Target Identity Element">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Identity Types">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Identity Hashing">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Authentication Indicator">
<link href="#rfc.section.7" rel="Chapter" title="7 Requesting Dependable Location Information using HELD">
<link href="#rfc.section.8" rel="Chapter" title="8 Signature Validation">
<link href="#rfc.section.9" rel="Chapter" title="9 Code and Examples">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Dependability Data Schema">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 HELD Dependability Request Schema">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 PIDF-LO Transforms">
<link href="#rfc.section.9.3.1" rel="Chapter" title="9.3.1 PIDF-LO Tuple-only Transform">
<link href="#rfc.section.9.3.2" rel="Chapter" title="9.3.2 PIDF-LO Selective Transform">
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Example">
<link href="#rfc.section.10" rel="Chapter" title="10 Location Reference Attribution">
<link href="#rfc.section.11" rel="Chapter" title="11 Security Considerations">
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Signature Rules">
<link href="#rfc.section.12" rel="Chapter" title="12 IANA Considerations">
<link href="#rfc.section.12.1" rel="Chapter" title="12.1 URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig">
<link href="#rfc.section.12.2" rel="Chapter" title="12.2 XML Schema Registration">
<link href="#rfc.section.12.3" rel="Chapter" title="12.3 URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity">
<link href="#rfc.section.12.4" rel="Chapter" title="12.4 URN Sub-Namespace Registration for urn:ietf:params:xml:ns:geopriv:held:dep">
<link href="#rfc.section.12.5" rel="Chapter" title="12.5 XML Schema Registration">
<link href="#rfc.section.13" rel="Chapter" title="13 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="14 References">
<link href="#rfc.references.1" rel="Chapter" title="14.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="14.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The dependability of location information is closely related to the degree of trust placed in the source of that information.  This document describes techniques that can be used to mitigate the impact of falsifying location information.  The application of digital signatures is described, relating these methods to the attacks that they address." />
  <meta name="description" content="The dependability of location information is closely related to the degree of trust placed in the source of that information.  This document describes techniques that can be used to mitigate the impact of falsifying location information.  The application of digital signatures is described, relating these methods to the attacks that they address." />
  <meta name="keywords" content="Internet-Draft, Location, Dependability, PIDF-LO, HELD, LIS" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">GEOPRIV</td>
<td class="right">M. Thomson</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">J. Winterbottom</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Andrew</td>
</tr>
<tr>
<td class="left">Expires: September 11, 2011</td>
<td class="right">March 10, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Digital Signature Methods for Location Dependability <br />
  <span class="filename"></span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The dependability of location information is closely related to the degree of trust placed in the source of that information.  This document describes techniques that can be used to mitigate the impact of falsifying location information.  The application of digital signatures is described, relating these methods to the attacks that they address.</p>
<p>The IETF has been notified of intellectual property rights claimed in regard to some or all of the specification contained in this document.  For more information consult the online list of claimed rights.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 11, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">Goals</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Non-Goals</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Basic Countermeasures</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Signing Location Information</a>
</li>
<li>3.   <a href="#rfc.section.3">PIDF-LO Signature</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Signature Design</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Signed Elements and Semantics</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Signature Algorithms</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">LIS/Signer Identification</a>
</li>
<li>4.   <a href="#rfc.section.4">Limited Validity</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Validity Elements</a>
</li>
<li>5.   <a href="#rfc.section.5">Signing for a User</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">The 'entity' Attribute</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Target Identity</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Protecting User Anonymity</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Authenticated Identity</a>
</li>
<li>5.5.   <a href="#rfc.section.5.5">Multiple Identity Attack</a>
</li>
<li>6.   <a href="#rfc.section.6">Target Identity Element</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Identity Types</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Identity Hashing</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Authentication Indicator</a>
</li>
<li>7.   <a href="#rfc.section.7">Requesting Dependable Location Information using HELD</a>
</li>
<li>8.   <a href="#rfc.section.8">Signature Validation</a>
</li>
<li>9.   <a href="#rfc.section.9">Code and Examples</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Dependability Data Schema</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">HELD Dependability Request Schema</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">PIDF-LO Transforms</a>
</li>
<li>9.3.1.   <a href="#rfc.section.9.3.1">PIDF-LO Tuple-only Transform</a>
</li>
<li>9.3.2.   <a href="#rfc.section.9.3.2">PIDF-LO Selective Transform</a>
</li>
<li>9.4.   <a href="#rfc.section.9.4">Example</a>
</li>
<li>10.   <a href="#rfc.section.10">Location Reference Attribution</a>
</li>
<li>11.   <a href="#rfc.section.11">Security Considerations</a>
</li>
<li>11.1.   <a href="#rfc.section.11.1">Signature Rules</a>
</li>
<li>12.   <a href="#rfc.section.12">IANA Considerations</a>
</li>
<li>12.1.   <a href="#rfc.section.12.1">URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig</a>
</li>
<li>12.2.   <a href="#rfc.section.12.2">XML Schema Registration</a>
</li>
<li>12.3.   <a href="#rfc.section.12.3">URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity</a>
</li>
<li>12.4.   <a href="#rfc.section.12.4">URN Sub-Namespace Registration for urn:ietf:params:xml:ns:geopriv:held:dep</a>
</li>
<li>12.5.   <a href="#rfc.section.12.5">XML Schema Registration</a>
</li>
<li>13.   <a href="#rfc.section.13">Acknowledgements</a>
</li>
<li>14.   <a href="#rfc.references">References</a>
</li>
<li>14.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>14.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Location information about a particular person or device is critical to a number of applications.  The integrity of this information - whether or not it can be relied upon for correctness - is also important to the user of the data.  This is especially important if the recipient of location information expends resources based on the information.  </p>
<p id="rfc.section.1.p.2">The quitessential example of an application where the veracity of location information is critical is emergency calling.  Location information is used both by routing functions to determine the correct Public Safety Answering Point (PSAP) and by the selected PSAP to determine where to send personnel.  If location information were faked, the call could be directed to the wrong PSAP, or personnel could be directed to an incorrect location.  In either case, an attacker wastes PSAP resources and risks delaying their life-critical interventions for other legitimate emergency callers.  </p>
<p id="rfc.section.1.p.3">This document details several cryptographic methods that limit the scope of attacks on location recipients based on faked or stolen location information.  Methods for applying digital signatures are described so that a location recipient can identify the source of the location information, either Location Information Server (LIS) or Target.  Identifying the source allows the location recipient to make a judgement on whether or not to trust the content of the location information.  </p>
<p id="rfc.section.1.p.4">Ultimately, these methods are limited in practicality by the transient nature of the relationships between LIS (the access network) and the Target.  Because these relationships can be arbitrary and temporary, schemes like authentication are not always feasible.  The basic goal of this draft is to both limit the scope of attacks and to provide as much information to the location recipient as possible so that they can make a decision on whether or not to act on the location information they are provided.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Goals</h1>
<p id="rfc.section.2.p.1">This document describes several measures that can be applied to limit attacks that rely on using faked or stolen location information.  These attacks leave a user of location information vulnerable to exploitation by an attacker.  </p>
<p id="rfc.section.2.p.2">The measures outlined in this document are designed to limit exposure to the following attacks: <a href="#RFC5687">[RFC5687]</a>.  </p>

<dl>
<dt>Place Shifting:</dt>
<dd style="margin-left: 8">In place shifting, an attacker selects any location (presumably somewhere other than where they are currently located) and constructs a PIDF-LO based on that information.  </dd>
<dt>Time Shifting:</dt>
<dd style="margin-left: 8">In a time shifting, or replay, attack the attacker uses location information that was valid in the past, but is no longer valid because the attacker has moved since the location was generated.  </dd>
<dt>Location Theft:</dt>
<dd style="margin-left: 8">An attacker that is able to observe the Target's location information can replay this information and thereby appear to be at the same location.  </dd>
<dt>Location Swapping:</dt>
<dd style="margin-left: 8">Two colluding attackers can conspire to fake location by exchanging location information.  One attacker can pretend to be at the other's location.  </dd>
</dl>

<p> These attacks are a subset of those described in </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Non-Goals</h1>
<p id="rfc.section.2.1.p.1">The measures outlined in this document cannot address all possible cases where location is spoofed.  This section outlines general areas where this document does not provide guidance; more specific limitations are included in the relevant sections.  </p>
<p id="rfc.section.2.1.p.2">Attacks where the authenticated identity of the Target can be reliably mimicked are not included.  This includes active collusion, as well as any attacks, network-based or otherwise, on the Target host that result in complete access to the Target's credentials.  In addition, this includes attacks that require cooperation between the attacker and Target.  If the attacker is able to gain access to the Target's private key, then to all cryptographic means the attacker can pretend to be the Target.  </p>
<p id="rfc.section.2.1.p.3">Methods for determining trust in either LIS or Target are out of scope for this document.  This document only describes the means by which an identity can be verified; the decision over whether or not to trust the entity is left to the location recipient.  Means for establishing trust will be the topic of a separate work.  </p>
<p id="rfc.section.2.1.p.4">Note that where certificate chains are used for authentication, a domain name-based certificate does not necessarily indicate trustworthiness in the provision of location information.  Therefore, verification of LIS identity through a certificate alone is not enough to ensure that the location recipient can trust the LIS, the recipient needs to use additional criteria to decide on whether to trust the LIS.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Basic Countermeasures</h1>
<p id="rfc.section.2.2.p.1">A good minimum requirement for the exchange of location information is that location information is protected from interception and modification by third parties in all protocol exchanges.  Confidentiality from unauthorized third parties and integrity protection are required for all location using-protocols <a href="#RFC3693">[RFC3693]</a>.  </p>
<p id="rfc.section.2.2.p.2">Location protocols that use <a href="#RFC5246">TLS</a> <cite title="NONE">[RFC5246]</cite> are able to meet this requirement providing mutual authentication is adequate.  <a href="#RFC5985">HELD</a> <cite title="NONE">[RFC5985]</cite> relies on TLS for this purpose.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Signing Location Information</h1>
<p id="rfc.section.2.3.p.1">A digital signature provides data integrity and attribution for the signed information.  This document describes how <a href="#RFC3275">XML-Signature</a> <cite title="NONE">[RFC3275]</cite> can be applied to a <a href="#RFC4119">Presence Information Data Format - Location Object (PIDF-LO)</a> <cite title="NONE">[RFC4119]</cite>.  It also describes the benefits of signing and how signing can be practically applied.  </p>
<p id="rfc.section.2.3.p.2">PIDF-LO contains a number of different units of data: location information, time, and identity being most important in this context <a href="#I-D.ietf-geopriv-arch">[I-D.ietf-geopriv-arch]</a>.  How these are bound in a signature determine what meaning is conveyed.  This document describes how certain bindings can be signed.  </p>
<p id="rfc.section.2.3.p.3">In signing a PIDF-LO, the signer makes an assertion about these bindings.  It is the signer's responsibility to verify that the bindings it signs are correct and verified.  Failure to do so has an impact on how trust in the signer is maintained.  Without trust in a signer, the signatures they provide are ineffectual.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> PIDF-LO Signature</h1>
<p id="rfc.section.3.p.1">A location recipient can use the signature on a location object to authenticate the identity of the signer, usually the source of the information.   The identity of the source is indicated in the certificate that is attached to the signature.  The signature also ensures that the contents have not been modified since the location object was signed.  </p>
<p id="rfc.section.3.p.2">In <a href="#I-D.ietf-geopriv-arch">GEOPRIV</a> <cite title="NONE">[I-D.ietf-geopriv-arch]</cite> this entity is likely to be either a location information server (LIS) or the Device that is the subject of the location information.  Other providers of location information, or location servers (LS), might also provide signatures.  </p>
<p id="rfc.section.3.p.3">It is important to specify the semantics of a certificate of this nature.  In essence, information that is signed SHOULD be verifiable by the signer.  However, in some cases it is expedient to include some unverifiable information (as is shown in later sections).  Therefore, this document assigns a strict semantic to each signed element in the location object.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Signature Design</h1>
<p id="rfc.section.3.1.p.1">[[Design Note:  It is recognized that XML-Signature has a major failure in its reliance on XML canonicalization.  Due to this reliance, very few interoperable implementations of XML-Signature exist.  On the other hand, it does offer a great deal of flexibility, such as the ability to select the elements that are signed.  The alternative is for the signer to just remove the unsigned portions.  Then any alternative signature method could be used, such as the equally widely implemented S/MIME.]] </p>
<p id="rfc.section.3.1.p.2">This document uses the <a href="#RFC3275">XML-Signature</a> <cite title="NONE">[RFC3275]</cite> enveloped signature type; that is, signature elements are included within the normal structure of the PIDF-LO document.  This ensures that the location object does not appear to be any different from a regular PIDF-LO document.  This permits use of the document in any protocol that carries PIDF-LO without requiring any changes to the protocol.  Applications that rely on PIDF-LO can simply ignore the signature elements if they are not supported.  </p>
<p id="rfc.section.3.1.p.3">A signature is applied to a single tuple within the PIDF document.  This means that signed location information can be included in a composite presence document without destroying the signature.  </p>
<p id="rfc.section.3.1.p.4">It is also a goal of the signature design to ensure that if unsigned elements are removed from the PIDF-LO, the document remains a valid PIDF-LO.  This keeps the PIDF-LO usable if the signature and any unsigned data are stripped out.  This is particularly important when the <a href="#rules">signature rules</a> <cite title="NONE">[rules]</cite> are applied.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#elements" id="elements">Signed Elements and Semantics</a>
</h1>
<p id="rfc.section.3.2.p.1">When location information is signed by a LIS, each unit of data in the signed document is given certain significance.  A location recipient needs to know what significance the LIS has given to each field before it can base any decision on the contents of that field.  </p>
<p id="rfc.section.3.2.p.2">The following list describes each of the elements that are included in a signed LO, justifies their inclusion and outlines the intended semantics of each being signed: </p>

<dl>
<dt>presence (urn:ietf:params:xml:ns:pidf):</dt>
<dd style="margin-left: 8">The root element of a <a href="#RFC3863">presence document</a> <cite title="NONE">[RFC3863]</cite>, the <samp>presence</samp> element, is signed.  The <samp>entity</samp> attribute is also signed.  In most cases, the <samp>entity</samp> attribute contains an identifier generated by the LIS, see <a href="#identity">Section 5</a> and <a href="#anon-identity">Section 5.3</a>.  </dd>
<dt>tuple (urn:ietf:params:xml:ns:pidf):</dt>
<dd style="margin-left: 8">Only the tuple that contains location information is signed.  The <samp>id</samp> attribute is signed to ensure a valid PIDF-LO is produced, but no significance is attached to its value.  Likewise, the <samp>device</samp> and <samp>person</samp> elements (in the <samp>urn:ietf:params:xml:ns:pidf:data-model</samp> namespace, <a href="#RFC4479">[RFC4479]</a>) that contain location information need to be included by the signature.  </dd>
<dt>geopriv (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd style="margin-left: 8">The <samp>geopriv</samp> element is signed, along with select elements within it.  </dd>
<dt>location-info (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd style="margin-left: 8">The most important element of the PIDF-LO, <samp>location-info</samp> contains location data.  This element and all its contents are signed.  </dd>
<dt>usage-rules (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd style="margin-left: 8">Usage rules are included to ensure the validity of the PIDF-LO.  An empty <samp>usage-rules</samp> element is valid.  The contents of these are not signed to allow a user to enter their preferences upon receipt of the signed LO.  A LIS does not typically set policy, so SHOULD NOT sign these elements unless a Rule Maker (see <a href="#RFC3693">[RFC3693]</a>) has provided values.  No decisions can be made on the unsigned content of usage rules.  </dd>
<dt>method (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd style="margin-left: 8">The method parameter is included, and consequently signed, only if known.  The LIS SHOULD verify the accuracy of this field, but MAY opt to include the element without validation.  An unvalidated method is allowed because of the informational nature of the data it contains.  Method is a metadata element and therefore is not a suitable basis for decision making, especially where a similar decision can be based on location information.  A recipient SHOULD NOT use the value of this field as the basis for any decision.  </dd>
<dt>timestamp (...:pidf or ...:pidf:data-model):</dt>
<dd style="margin-left: 8">The time that location is generated (or signed) is extremely important in determining whether location information is valid.  This element, defined in <a href="#RFC3863">[RFC3863]</a> or <a href="#RFC4479">[RFC4479]</a> is always validated and signed.  </dd>
<dt>All elements defined in this document:</dt>
<dd style="margin-left: 8">This document defines a number of elements that are designed for inclusion in the tuple.  These elements limit the effectiveness of certain attacks.  Validity intervals and Target identity are defined in <a href="#validity">Section 4</a>, <a href="#identity">Section 5</a>.  </dd>
</dl>
<p id="rfc.section.3.2.p.3">This document defines two transforms that can be applied to a PIDF-LO in order to limit what is signed <a href="#transforms">Section 9.3</a>.  The first is a selective transform that only selects the elements listed above.  The second simply selects the enveloping <samp>tuple</samp>, <samp>device</samp> or <samp>person</samp>element.  The signing entity MAY choose not to use either transform, but in doing so, all unverified elements MUST be removed before applying the signature.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Signature Algorithms</h1>
<p id="rfc.section.3.3.p.1">As specified in <a href="#RFC3275">RFC 3275</a> <cite title="NONE">[RFC3275]</cite>, implementations of this specification MUST provide the following algorithms: </p>

<dl>
<dt>digest algorithm:</dt>
<dd style="margin-left: 8">The SHA1 digest, as identified by the URN <samp>http://www.w3.org/2000/09/xmldsig#sha1</samp>.  </dd>
<dt>signature algorithm:</dt>
<dd style="margin-left: 8">DSA with SHA1, as identified by the URN <samp>http://www.w3.org/2000/09/xmldsig#dsa-sha1</samp>.  </dd>
<dt>canonicalization method:</dt>
<dd style="margin-left: 8">Canonical XML <a href="#RFC3076">[RFC3076]</a>, as identified by the URN <samp>http://www.w3.org/TR/2001/REC-xml-c14n-20010315</samp>.  </dd>
<dt>transforms:</dt>
<dd style="margin-left: 8">The enveloped signature transform, as identified by the URN <samp>http://www.w3.org/2000/09/xmldsig#enveloped-signature</samp>; and the transforms defined in this document: the <a href="#transform-tuple">tuple-only transform</a> <cite title="NONE">[transform-tuple]</cite>, as identified by the URN <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#tuple</samp> and the <a href="#transform-selective">selective transform</a> <cite title="NONE">[transform-selective]</cite>, as identified by the URN <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#selective</samp>.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.3.p.2">It is also RECOMMENDED that the PKCS1 (RSA-SHA1) signature algorithm, as idenfied by <samp>http://www.w3.org/2000/09/xmldsig#rsa-sha1</samp> is also supported.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> LIS/Signer Identification</h1>
<p><a href="#RFC3275">RFC 3275</a> <cite title="NONE">[RFC3275]</cite> describes a number of methods for describing the key used to sign the document.  For the purpose of signing a location object, the <samp>KeyInfo</samp> element MUST be provided in the <samp>Signature</samp> element.  </p>
<p id="rfc.section.3.4.p.2">The signer MUST include an X.509v3 certificate in the signature.  This can be either by including an <samp>X509Certificate</samp> element, or by referencing another certificate in the same document.  </p>
<p id="rfc.section.3.4.p.3">A reference to a certificate within the same document may be made using a fragment identifier URI.  Internal references could be applicable where multiple signatures are applied to different parts of the document.  This might be the case if a multiple location forms are included.  </p>
<p id="rfc.section.3.4.p.4">The signer MUST NOT reference an external source unless there is a reasonable expectation that the location recipient can successfully retrieve the certificate.  A reference to an external certificate MUST be described by URI in the <samp>RetrievalMethod</samp> element.  The scheme for the the RetrievalMethod URI MUST be <samp>https:</samp>.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#validity" id="validity">Limited Validity</a>
</h1>
<p id="rfc.section.4.p.1">The simplest attack to address is the Time Shifting attack.  The <samp>timestamp</samp> element provides a basic indication of when location information was created.  </p>
<p id="rfc.section.4.p.2">However, the basic timestamp doesn't provide any indication of how long that information is likely to be valid for.  The signer can specify a limited time period where the location information can be considered valid.  </p>
<p id="rfc.section.4.p.3">A known limitation of this method is that the information could become invalid at any time after the document is signed.  Once location is generated, the Target can move at any time, thereby invalidating the location object.  Therefore, there is a trade-off in selecting a value that minimizes errors, while increasing the chance that the information is useful.  The signer might base any chosen period on any knowledge it has about the mobility or current speed of the Target.  </p>
<p id="rfc.section.4.p.4">The time constraints can be considered guidelines provided by a signer.  Recipients can choose instead to base decisions purely on the <samp>timestamp</samp> element.  Location recipients MAY choose to implement a minimum age policy for locations.  If present, either the <samp>from</samp> element or the <samp>timestamp</samp> element can be used to determine age, depending on whether elapsed time from validation or time from generation is considered most important to the application.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Validity Elements</h1>
<p id="rfc.section.4.1.p.1">A <samp>validity</samp> element is defined with two sub-elements, <samp>from</samp> and <samp>until</samp>.  </p>
<p id="rfc.section.4.1.p.2">The <samp>from</samp> element contains the time that the location information was validated by the signer.  This could differ from the time that the location was generated, which is included in the PIDF <samp>timestamp</samp> element.  </p>
<p id="rfc.section.4.1.p.3">The <samp>until</samp> element contains the last time that the signature can be considered valid.  Choice of an appropriate validity interval is left to LIS implementations; however, this period MUST NOT exceed one day.  The period chosen SHOULD also consider the type of network access in use - location becomes invalid faster in more mobile networks.  </p>
<p id="rfc.section.4.1.p.4">The signature MUST NOT be considered valid if the current time is outside of the interval specified in these elements.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#identity" id="identity">Signing for a User</a>
</h1>
<p id="rfc.section.5.p.1">Signing location information alone, even with a limited validity period does not ensure that it is not reused.  Signing some sort of user identifier with the location object provides an additional degree of protection.  Most importantly, the location recipient is able to detect duplicate location objects for the same Target.  In addition, if some extra data is included from the Target, the location recipient is also able to link the location object with a user identity.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#presentity" id="presentity">The 'entity' Attribute</a>
</h1>
<p id="rfc.section.5.1.p.1">The <samp>entity</samp> attribute of a presence document is intended to convey the identity of the Target.  The signer does not necessarily know this identity.  Nor does the LIS necessarily have the means to authenticate the Target.  This is especially true for identities in application domains that are not known to the LIS.  </p>
<p id="rfc.section.5.1.p.2">The signer SHOULD construct an "unlinked pseudonym" for the presentity.  This pseudonym does not contain any information that could be used to identity the Target.  The simplest way to meet this requirement is to generate a <samp>pres:</samp> URI randomly, using a random sequence of characters and the host name of the LIS (e.g., <samp>pres:f6pc98w1pd49s0p@lis.example.com</samp>).  </p>
<p id="rfc.section.5.1.p.3">An unlinked pseudonym provides a limited means of ensuring that location information is not reused or replayed.  The presentity identifier used acts as a serial number for each location object, allowing each to be uniquely identified.  A location recipient is able to use this identifier to detect multiple uses of the same piece of location information.  This limits the effectiveness of replay attacks.  </p>
<p id="rfc.section.5.1.p.4">However, an unlinked pseudonym does not provide any useful identification information.  Users of this information are forced to rely on external information to bind the identity of the Target of the document to a specific entity.  </p>
<p id="rfc.section.5.1.p.5">Some continuity can be provided by reusing unlinked pseudonyms for the same Target.  If the LIS is able to verify that the Target is the same, the same identifier can be used in multiple PIDF-LO documents, linking these documents.  This depends on the means by which location is acquired from the LIS; if session data that links subsequent requests exists, the LIS MAY reuse the presentity identifier.  Note that some means is required to break this continuity to allow for a Target that does not wish for this linkage to occur.  </p>
<p id="rfc.section.5.1.p.6">This does not prevent the use of a "real" presentity in this field.  If the LIS is able to authenticate the Target, and the Target grants permission to the LIS to use this field, the LIS can include this information in the <samp>entity</samp> field.  These conditions are hard to meet, which leads to two alternative means of including Target identity, described in the following sections.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#target-identity" id="target-identity">Target Identity</a>
</h1>
<p id="rfc.section.5.2.p.1">The unlinked pseudonym used by the LIS acts as an anonymous identifier.  The only information that this provides to a location recipient is that two location objects were generated for the same anonymous Target.  The location recipient might also wish to link the location object to the identity of a particular user.  For example, a PSAP might want to link the location object to the authenticated identity of a emergency caller.  </p>
<p id="rfc.section.5.2.p.2">To achieve this linkage between location object and the Target's identity, the Target sends its identity to the LIS.  The LIS includes this identifier in the signed location object, effectively linking the identity to the location information.  </p>
<p id="rfc.section.5.2.p.3">A location recipient verifies that location information was signed for a particular Target by authenticating the Target and comparing the authenticated identity against the one in the signed location object.  </p>
<p id="rfc.section.5.2.p.4">The LIS is not expected to authenticate this identity information, although it MAY do so.  This means that an attacker within the network could request a signed location object with any identity they choose.  However, the location object could only be used by an entity that can prove that they have the chosen identity, which limits the number of potential attackers.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#anon-identity" id="anon-identity">Protecting User Anonymity</a>
</h1>
<p id="rfc.section.5.3.p.1">The problem with sending the Target's identity to the LIS is that the Target might not wish to provide this information to the access network operator.  </p>
<p id="rfc.section.5.3.p.2">This can be addressed by using a cryptographic hash of the user identity in place of the actual identifier.  Since the LIS does not necessarily authenticate the identity, this information provides the same attributes as the real identity.  Since the hash is not reversible, the LIS is unable to identify the Target, but the hash cannot be generated from any identifier other than the one used by the Target.  </p>
<p id="rfc.section.5.3.p.3">The location recipient authenticates the Target's identity, then compares a hash of the identity to the hash that is included in the location object to verify that the identity matches.  </p>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> <a href="#auth-identity" id="auth-identity">Authenticated Identity</a>
</h1>
<p id="rfc.section.5.4.p.1">With the above solution, one easy collusion attack exists.  One attacker at the actual location requests a location object with another attacker's identity.  The second, potentially remote, attacker is able to use this object.  If the first attacker is authenticated by the LIS, this attack is limited, because it requires that both attackers have access to the same authentication credentials.  </p>
<p id="rfc.section.5.4.p.2">The effectiveness of this approach is limited by the ability of the LIS to authenticate arbitrary users in the access network.  Location recipients cannot rely on the LIS performing authentication.  </p>
<p id="rfc.section.5.4.p.3">Authenticating the Target is complicated by the fact that the identity used in the application domain where location is consumed might be significantly different to the one that a LIS operates in.   Identity that might be used by a location recipient might have no meaning (or a completely different meaning) to a LIS.  </p>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> <a href="#plethora-identity" id="plethora-identity">Multiple Identity Attack</a>
</h1>
<p id="rfc.section.5.5.p.1">The schemes described in this section rely on the Target providing an identity.  A potential attack uses a single attacker in the access network that requests location information using a number of different identities.  The attacker requests multiple location objects, using a different identity each time.  These objects are passed to any number of other attackers, who are each able to authenticate with the identity that is included in the location object.  This potentially allows a large number of distributed attackers to use the same location information to perform a denial of service attack.  </p>
<p id="rfc.section.5.5.p.2">In some scenarios, multiple identities can be valid.  Examples in Section 3 of <a href="#RFC5687">[RFC5687]</a> show that multiple hosts can appear from the same network demarcation point.  Ideally, the LIS would still serve these hosts individually because they each have a valid reason to acquire location information under different identities.  </p>
<p id="rfc.section.5.5.p.3">A LIS SHOULD limit the number of identities that can be served from any particular network point to limit attacks where users request large numbers of location objects with different identity information.  Authenticating the Targets in this scenario could provide some additional surety that each is legitimate.  If multiple Targets legitimately exist at the same location, then these Targets can authenticate with the LIS.  The LIS MAY use a higher limit for authenticated Targets.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#identity-element" id="identity-element">Target Identity Element</a>
</h1>
<p id="rfc.section.6.p.1">This document defines an XML <samp>identity</samp> element that can be used to include identity information in a PIDF-LO.  This element is used in addition to a randomized <samp>entity</samp> attribute for several reasons: a randomized <samp>entity</samp> attribute can be used to detect replays; the identity is not necessarily authenticated; and the content can be other than a presentity identifier.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Identity Types</h1>
<p id="rfc.section.6.1.p.1">The content of this element is dependent on the type associated with the identifier.  The <samp>type</samp> attribute is used to define the nature of the identity that is included.  Two values are provided by default: </p>

<dl>
<dt>URI:</dt>
<dd style="margin-left: 8">A value of <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri</samp> for the type attribute indicates that the contents are a URI.  This URI can include a presentity URI, or other URI that identifies the target; for example a SIP URI.  This type MUST be supported.  </dd>
<dt>An X.509 certificate:</dt>
<dd style="margin-left: 8">A value of <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#x509</samp> indicates that the contents are an <a href="#X509v3">X.509v3 certificate</a> <cite title="NONE">[X509v3]</cite>, in the format described in <a href="#RFC3275">[RFC3275]</a> for <samp>X509Certificate</samp>.  </dd>
</dl>

<p> </p>
<p id="rfc.section.6.1.p.2">New identity types are identified by URNs, which means that registration is not required to add new types.  A location recipient that does not support a particular identity type MUST treat the location object as if no identity information were included.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Identity Hashing</h1>
<p id="rfc.section.6.2.p.1">To allow for anonymity, the content of the <samp>identity</samp> element MAY be hashed and the hash value included in this element instead.  The <samp>hash</samp> attribute indicates whether the value has been hashed.  A reserved value of <samp>##none</samp> indicates that the actual value is included.  Otherwise, the attribute includes a hash algorithm identifier, as defined in <a href="#RFC3275">[RFC3275]</a>.  The SHA1 algorithm MUST be supported; this is identified by the URN <samp>http://www.w3.org/2000/09/xmldsig#sha1</samp>.  </p>
<p id="rfc.section.6.2.p.2">Each different identity type requires a procedure for obtaining the bytes that are hashed.  </p>

<dl>
<dt>URI:</dt>
<dd style="margin-left: 8">For the URI type, the input to the hash algorithm is the UTF-8 bytes of the URI.  One consequence of this is that portions of URIs that might be case insensitive are made case sensitive.  </dd>
<dt>X.509:</dt>
<dd style="margin-left: 8">For the X.509 type, the input to the hash algorithm is the distinguished encoding rules (DER) encoded value of the certificate.  </dd>
</dl>
<p id="rfc.section.6.2.p.3">If the <samp>hash</samp> attribute is present and set to a value other than <samp>##none</samp>, the contents of the <samp>identity</samp> element are always the <a href="#RFC3548">base64 encoded</a> <cite title="NONE">[RFC3548]</cite> result from the hash function.  </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> Authentication Indicator</h1>
<p id="rfc.section.6.3.p.1">If the LIS is able to authenticate the Target, the LIS can indicate this in the <samp>authenticated</samp> attribute.  </p>
<p id="rfc.section.6.3.p.2">This indicator can be used irrespective of the value of the <samp>hash</samp> attribute.  This indicates to the location recipient that user identity included in the <samp>identity</samp> element was authenticated by the LIS.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Requesting Dependable Location Information using HELD</h1>
<p><a href="#RFC5985">HELD</a> <cite title="NONE">[RFC5985]</cite> is used by Devices to request location information.  This section outlines parameters that can be included in HELD requests to ensure that location.  Requesting dependable location information from a context provides less direct benefit to a Location Recipient that is requesting location information directly from a LIS.  </p>
<p id="rfc.section.7.p.2">Inclusion of a <samp>dependability</samp> element in a HELD location request indicates that the Device wants signed location information.  In a context creation or update requests, the Device can include this information for the LIS to store in the context for use when serving requests to the associated location URI.  </p>
<p id="rfc.section.7.p.3">Since this is an extension to the HELD protocol, the LIS might not provide a signature if it does not support this specification or it chooses not to for administrative reasons.  The Device is responsible for ensuring that a signature was applied.  </p>
<p id="rfc.section.7.p.4">The Device SHOULD include an <samp>identity</samp> element, which indicates what value is to be included in the <samp>identity</samp> element of the signed PIDF-LO.  Location Recipients MUST NOT include this parameter when requesting location information from a location URI.  The <samp>identity</samp> element is identical to that included in the PIDF-LO (see <a href="#identity-element">Section 6</a>) except that it does not include the <samp>authenticated</samp> attribute.  </p>
<div id="#rfc.figure.1"></div>
<p>The following sample HELD location request includes a dependency element with identity information.  </p>
<pre>
&lt;locationRequest xmlns="urn:ietf:params:xml:ns:geopriv:held"
		 responseTime="2000"&gt;
  &lt;locationType exact="true"&gt;geodetic&lt;/locationType&gt;
  &lt;dependency
      xmlns="urn:ietf:params:xml:ns:geopriv:held:dep"&gt;
    &lt;identity
      form="urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri"
      hash="http://www.w3.org/2000/09/xmldsig#sha1"&gt;
      60NvZvtdTB+7UnlLp/H24p7h4bs=
    &lt;/identity&gt;
  &lt;/dependency&gt;
&lt;/locationRequest&gt;
</pre>
<p id="rfc.section.7.p.5">Identity information is provided to the LIS under the understanding that the Device identity is included in the PIDF-LO.  This information could be used to link identity with location information by the LIS or by Location Recipients.  Including hashed information ensures that identity information is not revealed to the LIS.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Signature Validation</h1>
<p id="rfc.section.8.p.1">A location recipient performs the following steps to validate a signed location object: </p>

<ol>
<li>Authenticate the entity that provided the location information (the sender).  </li>
<li>Check the integrity of the digital certificate.  </li>
<li>Extract the identity of the LIS from the digital certificate.  </li>
<li>Remove all unsigned components from the location object.  </li>
<li>Ensure the validity interval from the location object covers the present time.  </li>
<li>Check that the authenticated identity of the identified subject matches the identity in the location object, or that a hash of this identity matches the hashed identity in the location object.  How the subject is identified depends on how the location object is acquired by the location recipient.  </li>
</ol>

<p> </p>
<p id="rfc.section.8.p.2">Once this process is complete, the location recipient has the following information upon which to base any policy decision: </p>

<ul>
<li>Whether the location object was signed.  </li>
<li>Whether the signature on the location object was valid.  </li>
<li>The identity of the sender.  </li>
<li>The identity of the LIS.  </li>
<li>Whether the LIS authenticated the sender in generating the location object.  </li>
<li>The presentity identifier generated by the LIS that distinguishes this location object.  </li>
</ul>

<p> </p>
<p id="rfc.section.8.p.3">Policies are set by individual location recipients and are dictated by a range of factors.  Even a failure in signature validation does not necessarily require that the location recipient reject the location information.  </p>
<p id="rfc.section.8.p.4">For instance, a PSAP might not reject an emergency call with no signature.  The PSAP could instead place a lower priority on such a call so that in a busy period the call is queued behind calls that contained valid signatures.  Similarly, un-authenticated calls could be given similar treatment.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Code and Examples</h1>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#schema" id="schema">Dependability Data Schema</a>
</h1>
<div id="#rfc.figure.2"></div>
<p>The following <a href="#W3C.REC-xmlschema-1-20041028">XML Schema</a> <cite title="NONE">[W3C.REC-xmlschema-1-20041028]</cite> defines the <samp>dependability</samp> element.  This element is intended for use in a PIDF-LO within a <samp>tuple</samp>.  </p>
<pre>
&lt;?xml version="1.0"?&gt;
&lt;xs:schema
  targetNamespace="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:dsig="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"
  xmlns:xmldsig="http://www.w3.org/2000/09/xmldsig#"
  elementFormDefault="qualified" attributeFormDefault="unqualified"&gt;

  &lt;xs:import namespace="http://www.w3.org/2000/09/xmldsig#"/&gt;

  &lt;xs:element name="dependability" type="dsig:dependabilityType"/&gt;
  &lt;xs:complexType name="dependabilityType"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref="dsig:validity"/&gt;
      &lt;xs:element ref="dsig:identity" minOccurs="0"/&gt;
      &lt;xs:element ref="xmldsig:Signature" minOccurs="0"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:element name="validity" type="dsig:validityType"/&gt;
  &lt;xs:complexType name="validityType"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name="from" type="xs:dateTime" minOccurs="0"/&gt;
      &lt;xs:element name="until" type="xs:dateTime"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:element name="identity" type="dsig:identityType"/&gt;
  &lt;xs:complexType name="identityType"&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base="xs:anySimpleType"&gt;

	&lt;xs:attribute name="type" use="required" type="xs:anyURI"/&gt;

	&lt;xs:attribute name="hash" default="##none"&gt;
	  &lt;xs:simpleType&gt;
	    &lt;xs:union memberTypes="xs:anyURI"&gt;
	      &lt;xs:simpleType&gt;
		&lt;xs:restriction base="xs:token"&gt;
		  &lt;xs:enumeration value="##none"/&gt;
		&lt;/xs:restriction&gt;
	      &lt;/xs:simpleType&gt;
	    &lt;/xs:union&gt;
	  &lt;/xs:simpleType&gt;
	&lt;/xs:attribute&gt;

	&lt;xs:attribute name="authenticated" type="xs:boolean"
		      default="false"/&gt;

      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;

&lt;/xs:schema&gt;
</pre>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> <a href="#heldschema" id="heldschema">HELD Dependability Request Schema</a>
</h1>
<div id="#rfc.figure.3"></div>
<p>The following <a href="#W3C.REC-xmlschema-1-20041028">XML Schema</a> <cite title="NONE">[W3C.REC-xmlschema-1-20041028]</cite> defines the <samp>dependability</samp> element for inclusion in HELD requests.  </p>
<pre>
&lt;?xml version="1.0"?&gt;
&lt;xs:schema
  targetNamespace="urn:ietf:params:xml:ns:geopriv:held:dep"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:hd="urn:ietf:params:xml:ns:geopriv:held:dep"
  elementFormDefault="qualified" attributeFormDefault="unqualified"&gt;

  &lt;xs:annotation&gt;
    &lt;xs:appinfo
	source="urn:ietf:params:xml:schema:geopriv:held:dep"&gt;
      HELD Dependability Request Elements
    &lt;/xs:appinfo&gt;
    &lt;xs:documentation source="http://www.ietf.org/rfc/rfcXXXX.txt"&gt;
&lt;!-- [[NOTE TO RFC-EDITOR: Please replace above URL with URL of
		       published RFC and remove this note.]] --&gt;
      This document defines dependability elements for HELD.
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

  &lt;xs:element name="dependability" type="hd:dependabilityType"/&gt;
  &lt;xs:complexType name="dependabilityType"&gt;
    &lt;xs:complexContent&gt;
      &lt;xs:restriction base="xs:anyType"&gt;
	&lt;xs:sequence&gt;
	  &lt;xs:element ref="hd:identity" minOccurs="0"/&gt;
	  &lt;xs:any namespace="##other" processContents="lax"
		  minOccurs="0" maxOccurs="unbounded"/&gt;
	&lt;/xs:sequence&gt;
      &lt;/xs:restriction&gt;
    &lt;/xs:complexContent&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:element name="identity" type="hd:identityType"/&gt;
  &lt;xs:complexType name="identityType"&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base="xs:anySimpleType"&gt;
	&lt;xs:attribute name="type" type="xs:anyURI" use="required"/&gt;
	&lt;xs:attribute name="hash" default="##none"&gt;
	  &lt;xs:simpleType&gt;
	    &lt;xs:union memberTypes="xs:anyURI"&gt;
	      &lt;xs:simpleType&gt;
		&lt;xs:restriction base="xs:token"&gt;
		  &lt;xs:enumeration value="##none"/&gt;
		&lt;/xs:restriction&gt;
	      &lt;/xs:simpleType&gt;
	    &lt;/xs:union&gt;
	  &lt;/xs:simpleType&gt;
	&lt;/xs:attribute&gt;
      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;

&lt;/xs:schema&gt;
</pre>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> <a href="#transforms" id="transforms">PIDF-LO Transforms</a>
</h1>
<p id="rfc.section.9.3.p.1">The transforms defined in this section select certain parts of a PIDF-LO document for signing.  These transforms ensure that only one tuple is signed, with varying amounts of content.  This allows location information to be composed with other tuples and for independent signatures on multiple tuples.  </p>
<p id="rfc.section.9.3.p.2">The LIS MUST use one of these transforms to avoid the implication that only the tuple is signed (where in fact the entire document would be signed).  The enveloped signature transform MUST also be used.  </p>
<p id="rfc.section.9.3.p.3">These transforms can be implemented by substituting instances of transforms (identified by URNs) with the XPath transforms below.  However, equivalent implementations using other means might provide better performance.  </p>
<h1 id="rfc.section.9.3.1">
<a href="#rfc.section.9.3.1">9.3.1.</a> <a href="#transform-tuple" id="transform-tuple">PIDF-LO Tuple-only Transform</a>
</h1>
<div id="#rfc.figure.4"></div>
<p>The following <a href="#RFC3275">XPath filter</a> <cite title="NONE">[RFC3275]</cite> selects the first <samp>tuple</samp>, <samp>device</samp> or <samp>person</samp> descendant of the signature element and all its contents.  The <samp>presence</samp> element that is the immediate parent of the tuple is also selected.  This transform is identified by the URN <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#tuple</samp>.  </p>
<pre>
&lt;dsig:Transform id="tuple"
   Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116"
   xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;dsig:XPath
   xmlns:pidf="urn:ietf:params:xml:ns:pidf"
   xmlns:dm="urn:ietf:params:xml:ns:pidf:data-model"&gt;

&lt;!-- The 'tuple' element and all decendants --&gt;
(count(ancestor-or-self::pidf:tuple[1]
       | here()/ancestor::pidf:tuple[1]) == 1)

&lt;!-- The 'device' element and all decendants --&gt;
or (count(ancestor-or-self::dm:device[1]
       | here()/ancestor::dm:device[1]) == 1)

&lt;!-- The 'person' element and all decendants --&gt;
or (count(ancestor-or-self::dm:person[1]
       | here()/ancestor::dm:person[1]) == 1)

&lt;!-- The 'presence' element --&gt;
or (count(self::pidf:presence
	  | here()/ancestor::pidf:presence[1]) = 1)

&lt;!-- All attributes and namespace declarations
	 on the presence element --&gt;
or ((count(parent::pidf:presence
	   | here()/ancestor::pidf:presence[1]) = 1)
    and (count(self::node() | parent::*/attribute::*
	       | parent::*/namespace::*) + 1
	 == (count(self::node()) + count(parent::*/attribute::*)
		   + count(parent::*/namespace::*))))
  &lt;/dsig:XPath&gt;
&lt;/dsig:Transform&gt;
</pre>
<h1 id="rfc.section.9.3.2">
<a href="#rfc.section.9.3.2">9.3.2.</a> <a href="#transform-selective" id="transform-selective">PIDF-LO Selective Transform</a>
</h1>
<div id="#rfc.figure.5"></div>
<p>Similar to the tuple-only transform, this transform selects a single <samp>tuple</samp> element and its parent <samp>presence</samp> element.  In contrast, this transform only selects those elements listed in <a href="#elements">Section 3.2</a>.  This transform allows a Target to make adjustments to non-critical elements in the PIDF-LO after the signed PIDF-LO is received from the LIS.  In particular, this allows the Target to set the content of the <samp>usage-rules</samp> element and other PIDF data, like contact information.  This transform is identified by the URN <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#selective</samp>.  </p>
<pre>
&lt;dsig:Transform id="selective"
   Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116"
   xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;dsig:XPath
   xmlns:pidf="urn:ietf:params:xml:ns:pidf"
   xmlns:gp="urn:ietf:params:xml:ns:pidf:geopriv10"
   xmlns:dep="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"
   xmlns:dm="urn:ietf:params:xml:ns:pidf:data-model"&gt;

&lt;!-- The 'presence' element --&gt;
(count(self::pidf:presence
	  | here()/ancestor::pidf:presence[1]) = 1)

&lt;!-- The 'tuple' element and all selected descendants --&gt;
or (((count(ancestor-or-self::pidf:tuple[1]
	   | here()/ancestor::pidf:tuple[1]) == 1)
     or (count(ancestor-or-self::dm:device[1]
	      | here()/ancestor::dm:device[1]) == 1)
     or (count(ancestor-or-self::dm:person[1]
	      | here()/ancestor::dm:person[1]) == 1))
    and (self::pidf:tuple or self::dm:device
	 or self::dm:person or self::pidf:status
	 or ancestor-or-self::pidf:timestamp
	 or ancestor-or-self::dm:timestamp
	 or ancestor-or-self::dm:deviceID
	 or self::gp:geopriv or self::gp:usage-rules
	 or ancestor-or-self::gp:method
	 or ancestor-or-self::gp:location-info
	 or ancestor-or-self::dep:dependability))

&lt;!-- All attributes (including namespace declarations) --&gt;
&lt;!-- Needed for elements without ancestor-or-self rules above --&gt;
or ((count(self::node() | parent::*/attribute::*
	   | parent::*/namespace::*) + 1
	 == (count(self::node()) + count(parent::*/attribute::*)
		   + count(parent::*/namespace::*)))
    and parent::*[
	  (count(self::pidf:presence
		 | here()/ancestor::pidf:presence[1]) = 1)

	  or (((count(ancestor-or-self::pidf:tuple[1]
		     | here()/ancestor::pidf:tuple[1]) == 1)
	       or (count(ancestor-or-self::dm:device[1]
			| here()/ancestor::dm:device[1]) == 1)
	       or (count(ancestor-or-self::dm:person[1]
			| here()/ancestor::dm:person[1]) == 1))

	      and (self::pidf:tuple or self::dm:device
		   or self::dm:person or self::pidf:status
		   or self::gp:geopriv or self::gp:usage-rules))
	])
  &lt;/dsig:XPath&gt;
&lt;/dsig:Transform&gt;
</pre>
<h1 id="rfc.section.9.4">
<a href="#rfc.section.9.4">9.4.</a> <a href="#example" id="example">Example</a>
</h1>
<div id="#rfc.figure.6"></div>
<p>The following PIDF-LO document has been signed using the selective transform. [[NOTE:  A proper example, with a verifiable signature, will be created in a later version of this draft.]] </p>
<pre>
&lt;?xml version="1.0"?&gt;
&lt;presence entity="pres:a6d5bs14vy9pu@lis.example.com"
	  xmlns="urn:ietf:params:xml:ns:pidf"
	  xmlns:gml="http://opengis.net/gml"
	  xmlns:gp="urn:ietf:params:xml:ns:pidf:geopriv10"&gt;
  &lt;tuple id="pidflo1a786c3"&gt;
    &lt;status&gt;
      &lt;gp:geopriv&gt;
	&lt;gp:location-info&gt;
	  &lt;gml:position&gt;
	    &lt;gml:Point srsName="urn:ogc:def:crs:EPSG::4979"&gt;
	      &lt;gml:pos&gt;-34.407 150.88001 34&lt;/gml:pos&gt;
	    &lt;/gml:Point&gt;
	  &lt;/gml:position&gt;
	&lt;/gp:location-info&gt;
	&lt;gp:usage-rules&gt;
	  &lt;gp:retransmission-allowed&gt;no&lt;/gp:retransmission-allowed&gt;
	  &lt;gp:retention-expiry&gt;
	    2004-12-01T21:28:43+10:00
	  &lt;/gp:retention-expiry&gt;
	&lt;/gp:usage-rules&gt;
      &lt;/gp:geopriv&gt;
    &lt;/status&gt;
    &lt;dependability
	xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"&gt;
      &lt;validity&gt;
	&lt;from&gt;2007-02-16T16:25:24+11:00&lt;/from&gt;
	&lt;until&gt;2007-02-17T16:25:24+11:00&lt;/until&gt;
      &lt;/validity&gt;
      &lt;identity
  type="urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri"&gt;
      pres:user@example.com&lt;/identity&gt;
      &lt;dsig:Signature
	  xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;
	&lt;dsig:SignedInfo&gt;
	  &lt;dsig:CanonicalizationMethod
  Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/&gt;
	  &lt;dsig:SignatureMethod
  Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/&gt;
	  &lt;dsig:Reference URI=""&gt;
	    &lt;dsig:Transforms&gt;
	      &lt;dsig:Transform
  Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/&gt;
	      &lt;dsig:Transform
  Algorithm="urn:ietf:params:xml:ns:pidf:geopriv10:dsig#selective"/&gt;
	    &lt;/dsig:Transforms&gt;
	    &lt;dsig:DigestMethod
  Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
	    &lt;dsig:DigestValue&gt;
	      60NvZvtdTB+7UnlLp/H24p7h4bs=
	    &lt;/dsig:DigestValue&gt;
	  &lt;/dsig:Reference&gt;
	&lt;/dsig:SignedInfo&gt;
	&lt;dsig:SignatureValue&gt;
	  juS5RhJ884qoFR8flVXd/rbrSDVGn40CapgB7qeQiT+rr0NekEQ6BHhUA
	  8dT3+BCTBUQI0dBjlml9lwzENXvS83zRECjzXbMRTUtVZiPZG2pqKPnL2
	  YU3A9645UCjTXU+jgFumv7k78hieAGDzNci+PQ9KRmm//icT7JaYztgt4=
	&lt;/dsig:SignatureValue&gt;
	&lt;dsig:KeyInfo&gt;
	  &lt;dsig:X509Data&gt;
	    &lt;dsig:X509Certificate&gt;
	      MIICeDCCAeGgAwIBAgIEOd3+iDANBgkqhkiG9w0BAQQFADBbMQsw
	      CQYDVQQGEwJJRTEPMA0GA1UECBMGRHVibGluMSUwIwYDVQQKExxC
	      YWx0aW1vcmUgVGVjaG5vbG9naWVzLCBMdGQuMRQwEgYDVQQDEwtU
	      ZXN0IFJTQSBDQTAeFw0wMDEwMDYxNjMyMDdaFw0wMTEwMDYxNjMy
	      MDRaMF0xCzAJBgNVBAYTAklFMQ8wDQYDVQQIEwZEdWJsaW4xJTAj
	      BgNVBAoTHEJhbHRpbW9yZSBUZWNobm9sb2dpZXMsIEx0ZC4xFjAU
	      BgNVBAMTDU1lcmxpbiBIdWdoZXMwgZ8wDQYJKoZIhvcNAQEBBQAD
	      gY0AMIGJAoGBALgorpKYDmjpq6tXz1Ex9wgF8bhZj47JkuI50ysa
	      79MNSSnF7SdjN2pGldXf5Gq7yZZnmqNtIzcva/v7ysIm4zO+xft2
	      yJHjBBpgCFJxXIiZEfooTu2+HE7mJxIvMR7buIjJ+hjgwaBM6hUG
	      HXfKeL62QbL7OOJ060vKssoW2uuPAgMBAAGjRzBFMB4GA1UdEQQX
	      MBWBE21lcmxpbkBiYWx0aW1vcmUuaWUwDgYDVR0PAQH/BAQDAgeA
	      MBMGA1UdIwQMMAqACEngrZIVgu03MA0GCSqGSIb3DQEBBAUAA4GB
	      AHJu4JVq/WnXK2oqqfLWqes5vHOtfX/ZhCjFyDMhzslI8am62gZe
	      dwZ9IIZIwlNRMvEDQB2zds/eEBnIAQPl/yRLCLOfZnbA8PXrbFP5
	      igs3qQWScBUjZVjik748HU2sUVZOa90c0mJl2vJs/RwyLW7/uCAf
	      C/I/k9xGr7fneoIW
	  &lt;/dsig:X509Certificate&gt;&lt;/dsig:X509Data&gt;
	&lt;/dsig:KeyInfo&gt;
      &lt;/dsig:Signature&gt;
    &lt;/dependability&gt;
    &lt;note&gt;
      This note may be changed without affecting the signature.
    &lt;/note&gt;
    &lt;timestamp&gt;2005-05-18T15:03:39.362+10:00&lt;/timestamp&gt;
  &lt;/tuple&gt;
&lt;/presence&gt;
</pre>
<div id="#rfc.figure.7"></div>
<p>Once the signature has been checked, the following document is extracted.  Only these elements have been included in the signature.  Note that whitespace has been added to this example to improve readability and to conform to the limitations of this document format.  </p>
<pre>
&lt;presence xmlns="urn:ietf:params:xml:ns:pidf"
	  xmlns:gml="http://opengis.net/gml"
	  xmlns:gp="urn:ietf:params:xml:ns:pidf:geopriv10"
	  entity="pres:a6d5bs14vy9pu@lis.example.com"&gt;
  &lt;tuple id="pidflo1a786c3"&gt;
    &lt;status&gt;
      &lt;gp:geopriv&gt;
	&lt;gp:location-info&gt;
	  &lt;gml:position&gt;
	    &lt;gml:Point srsName="urn:ogc:def:crs:EPSG::4979"&gt;
	      &lt;gml:pos&gt;-34.407 150.88001 34&lt;/gml:pos&gt;
	    &lt;/gml:Point&gt;
	  &lt;/gml:position&gt;
	&lt;/gp:location-info&gt;
	&lt;gp:usage-rules&gt;&lt;/gp:usage-rules&gt;
      &lt;/gp:geopriv&gt;
    &lt;/status&gt;
    &lt;dependability
	xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"&gt;
      &lt;validity&gt;
	&lt;from&gt;2007-02-16T16:25:24+11:00&lt;/from&gt;
	&lt;until&gt;2007-02-17T16:25:24+11:00&lt;/until&gt;
      &lt;/validity&gt;
      &lt;identity
  type="urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri"&gt;
      pres:user@example.com&lt;/identity&gt;
    &lt;/dependability&gt;
    &lt;timestamp&gt;2005-05-18T15:03:39.362+10:00&lt;/timestamp&gt;
  &lt;/tuple&gt;
&lt;/presence&gt;
</pre>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Location Reference Attribution</h1>
<p id="rfc.section.10.p.1">Digital signatures are less useful when location is provided by reference.  In this case, the location recipient acquires location information directly from the LIS.  </p>
<p id="rfc.section.10.p.2">The location recipient is able to authenticate the LIS when it establishes a session to retrieve location information (and indeed, this authentication is necessary to protect against other forms of attack).  This authentication process reveals to the location recipient the same information that would be included in a digital signature.  Therefore, signing the result of a location deference is not necessary, unless the dereferencing entity intends to then pass the location object to another entity (note that this MUST also be permitted by the usage rules in the PIDF-LO).  </p>
<p id="rfc.section.10.p.3">For use with location by reference, the <samp>dependability</samp> element can be provided without a signature.  Allowing a LIS to provide location information where the attribution is based on the secure dereference channel, but the same information is available.  </p>
<p id="rfc.section.10.p.4">Similar constraints apply to a location object that is retrieved by reference as those that apply to a signed location object.  The location object that is retrieved by reference needs to include the same identity information that would be included in a signed location object.  </p>
<p id="rfc.section.10.p.5">Validity elements are less critical, since it can be assumed that the LIS does not provide location information unless it is current.  The PIDF <samp>timestamp</samp> element is sufficient to indicate when location information was generated.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.11.p.1">This entire document is about the security properties of location objects.  </p>
<h1 id="rfc.section.11.1">
<a href="#rfc.section.11.1">11.1.</a> <a href="#rules" id="rules">Signature Rules</a>
</h1>
<p id="rfc.section.11.1.p.1">Three rules that relate to the treatment of signed information are described in <a href="#RFC3275">[RFC3275]</a>.  These rules are: </p>

<ul>
<li>Only What is Signed is Secure</li>
<li>Only What is "Seen" Should be Signed</li>
<li>"See" What is Signed</li>
</ul>

<p> These rules apply when a location recipient evaluates and uses a location object.  These especially apply when displaying location information to a user, unsigned nodes SHOULD NOT be displayed and MUST be clearly marked as unsigned if they are shown.  </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.12.p.1">This section registers the dependability elements schema and related namespace URNs with IANA.  </p>
<h1 id="rfc.section.12.1">
<a href="#rfc.section.12.1">12.1.</a> URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig</h1>
<div id="#rfc.figure.8"></div>
<pre>
      BEGIN
	&lt;?xml version="1.0"?&gt;
	&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
	&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;
	  &lt;head&gt;
	    &lt;title&gt;GEOPRIV Dependability Elements&lt;/title&gt;
	  &lt;/head&gt;
	  &lt;body&gt;
	    &lt;h1&gt;Namespace for GEOPRIV Dependability Elements&lt;/h1&gt;
	    &lt;h2&gt;urn:ietf:params:xml:ns:pidf:geopriv10:dsig&lt;/h2&gt;
[[NOTE TO IANA/RFC-EDITOR: Please update RFC URL and replace XXXX
    with the RFC number for this specification.]]
	    &lt;p&gt;See &lt;a href="[[RFC URL]]"&gt;RFCXXXX&lt;/a&gt;.&lt;/p&gt;
	  &lt;/body&gt;
	&lt;/html&gt;
      END
      </pre>
<p id="rfc.section.12.1.p.1">This section registers a new XML namespace, <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig</samp>, as per the guidelines in <a href="#RFC3688">[RFC3688]</a>.  </p>

<dl>
<dt>URI:</dt>
<dd style="margin-left: 8">urn:ietf:params:xml:ns:pidf:geopriv10:dsig</dd>
<dt>Registrant Contact:</dt>
<dd style="margin-left: 8">IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).</dd>
<dt>XML:</dt>
<dd style="margin-left: 8"></dd>
<dt>Note:</dt>
<dd style="margin-left: 8">Two fragment identifiers (<samp>#tuple</samp> and <samp>#selective</samp>) are added to this URN to identify the two transforms defined in RFCXXXX.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.12.2">
<a href="#rfc.section.12.2">12.2.</a> XML Schema Registration</h1>
<p id="rfc.section.12.2.p.1">This section registers an XML schema as per the guidelines in <a href="#RFC3688">[RFC3688]</a>.  </p>

<dl>
<dt>URI:</dt>
<dd style="margin-left: 8">urn:ietf:params:xml:schema:pidf:geopriv10:dsig</dd>
<dt>Registrant Contact:</dt>
<dd style="margin-left: 8">IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).</dd>
<dt>Schema:</dt>
<dd style="margin-left: 8">The XML for this schema can be found in <a href="#schema">Section 9.1</a> of this document, between <samp>&lt;?xml version="1.0"?&gt;</samp> and <samp>&lt;/xs:schema&gt;</samp> (inclusive).  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.12.3">
<a href="#rfc.section.12.3">12.3.</a> URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity</h1>
<div id="#rfc.figure.9"></div>
<pre>
      BEGIN
	&lt;?xml version="1.0"?&gt;
	&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
	&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;
	  &lt;head&gt;
	    &lt;title&gt;GEOPRIV Dependability Elements&lt;/title&gt;
	  &lt;/head&gt;
	  &lt;body&gt;
	    &lt;h1&gt;Namespace for GEOPRIV Dependability Elements:
		Identity Identifiers&lt;/h1&gt;
      &lt;h2&gt;urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity&lt;/h2&gt;
[[NOTE TO IANA/RFC-EDITOR: Please update RFC URL and replace XXXX
    with the RFC number for this specification.]]
	   &lt;p&gt;See &lt;a href="[[RFC URL]]"&gt;RFCXXXX&lt;/a&gt;.&lt;/p&gt;
	  &lt;/body&gt;
	&lt;/html&gt;
      END
      </pre>
<p id="rfc.section.12.3.p.1">This section registers a new XML namespace, <samp>urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity</samp>, as per the guidelines in <a href="#RFC3688">[RFC3688]</a>.  </p>

<dl>
<dt>URI:</dt>
<dd style="margin-left: 8">urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity</dd>
<dt>Registrant Contact:</dt>
<dd style="margin-left: 8">IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).</dd>
<dt>XML:</dt>
<dd style="margin-left: 8"></dd>
<dt>Note:</dt>
<dd style="margin-left: 8">Two fragment identifiers (<samp>#uri</samp> and <samp>#x509</samp>) are added to this URN to identify the two types of identity defined in RFCXXXX.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.12.4">
<a href="#rfc.section.12.4">12.4.</a> URN Sub-Namespace Registration for urn:ietf:params:xml:ns:geopriv:held:dep</h1>
<div id="#rfc.figure.10"></div>
<pre>
      BEGIN
	&lt;?xml version="1.0"?&gt;
	&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
	&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;
	  &lt;head&gt;
	    &lt;title&gt;HELD Dependability Request Elements&lt;/title&gt;
	  &lt;/head&gt;
	  &lt;body&gt;
	    &lt;h1&gt;Namespace for HELD Dependability Request&lt;/h1&gt;
	    &lt;h2&gt;urn:ietf:params:xml:ns:geopriv:held:dep&lt;/h2&gt;
[[NOTE TO IANA/RFC-EDITOR: Please update RFC URL and replace XXXX
    with the RFC number for this specification.]]
	    &lt;p&gt;See &lt;a href="[[RFC URL]]"&gt;RFCXXXX&lt;/a&gt;.&lt;/p&gt;
	  &lt;/body&gt;
	&lt;/html&gt;
      END
      </pre>
<p id="rfc.section.12.4.p.1">This section registers a new XML namespace, <samp>urn:ietf:params:xml:ns:geopriv:held:dep</samp>, as per the guidelines in <a href="#RFC3688">[RFC3688]</a>.  </p>

<dl>
<dt>URI:</dt>
<dd style="margin-left: 8">urn:ietf:params:xml:ns:geopriv:held:dep</dd>
<dt>Registrant Contact:</dt>
<dd style="margin-left: 8">IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).</dd>
<dt>XML:</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<h1 id="rfc.section.12.5">
<a href="#rfc.section.12.5">12.5.</a> XML Schema Registration</h1>
<p id="rfc.section.12.5.p.1">This section registers an XML schema as per the guidelines in <a href="#RFC3688">[RFC3688]</a>.  </p>

<dl>
<dt>URI:</dt>
<dd style="margin-left: 8">urn:ietf:params:xml:schema:geopriv:held:dep</dd>
<dt>Registrant Contact:</dt>
<dd style="margin-left: 8">IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).</dd>
<dt>Schema:</dt>
<dd style="margin-left: 8">The XML for this schema can be found in <a href="#heldschema">Section 9.2</a> of this document, between <samp>&lt;?xml version="1.0"?&gt;</samp> and <samp>&lt;/xs:schema&gt;</samp> (inclusive).  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#ack" id="ack">Acknowledgements</a>
</h1>
<p id="rfc.section.13.p.1">The authors would like to acknowledge the contribution of the GEOPRIV WG; the L7 design team; Hannes Tschofenig and Henning Schulzrinne.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">14.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">14.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3076">[RFC3076]</b></td>
<td class="top">
<a>Boyer, J.</a>, "<a href="http://tools.ietf.org/html/rfc3076">Canonical XML Version 1.0</a>", RFC 3076, March 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3275">[RFC3275]</b></td>
<td class="top">
<a>Eastlake, D.</a>, <a>Reagle, J.</a> and <a>D. Solo</a>, "<a href="http://tools.ietf.org/html/rfc3275">(Extensible Markup Language) XML-Signature Syntax and Processing</a>", RFC 3275, March 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4119">[RFC4119]</b></td>
<td class="top">
<a>Peterson, J.</a>, "<a href="http://tools.ietf.org/html/rfc4119">A Presence-based GEOPRIV Location Object Format</a>", RFC 4119, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5687">[RFC5687]</b></td>
<td class="top">
<a>Tschofenig, H.</a> and <a>H. Schulzrinne</a>, "<a href="http://tools.ietf.org/html/rfc5687">GEOPRIV Layer 7 Location Configuration Protocol: Problem Statement and Requirements</a>", RFC 5687, March 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3548">[RFC3548]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc3548">The Base16, Base32, and Base64 Data Encodings</a>", RFC 3548, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3863">[RFC3863]</b></td>
<td class="top">
<a>Sugano, H.</a>, <a>Fujimoto, S.</a>, <a>Klyne, G.</a>, <a>Bateman, A.</a>, <a>Carr, W.</a> and <a>J. Peterson</a>, "<a href="http://tools.ietf.org/html/rfc3863">Presence Information Data Format (PIDF)</a>", RFC 3863, August 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4479">[RFC4479]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, "<a href="http://tools.ietf.org/html/rfc4479">A Data Model for Presence</a>", RFC 4479, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="X509v3">[X509v3]</b></td>
<td class="top">
<a>ITU-T Recommendation</a>, "<a>Information Technology - Open Systems Interconnection - The Directory Authentication Framework</a>", ISO/IEC 9594-8:1997, 1997.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.REC-xmlschema-1-20041028">[W3C.REC-xmlschema-1-20041028]</b></td>
<td class="top">
<a>Maloney, M.</a>, <a>Beech, D.</a>, <a>Thompson, H.</a> and <a>N. Mendelsohn</a>, "<a>XML Schema Part 1: Structures Second Edition</a>", World Wide Web Consortium Recommendation REC-xmlschema-1-20041028, October 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5985">[RFC5985]</b></td>
<td class="top">
<a>Barnes, M.</a>, "<a href="http://tools.ietf.org/html/rfc5985">HTTP-Enabled Location Delivery (HELD)</a>", RFC 5985, September 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">14.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3688">[RFC3688]</b></td>
<td class="top">
<a>Mealling, M.</a>, "<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>", BCP 81, RFC 3688, January 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3693">[RFC3693]</b></td>
<td class="top">
<a>Cuellar, J.</a>, <a>Morris, J.</a>, <a>Mulligan, D.</a>, <a>Peterson, J.</a> and <a>J. Polk</a>, "<a href="http://tools.ietf.org/html/rfc3693">Geopriv Requirements</a>", RFC 3693, February 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-geopriv-arch">[I-D.ietf-geopriv-arch]</b></td>
<td class="top">
<a>Barnes, R</a>, <a>Lepinski, M</a>, <a>Cooper, A</a>, <a>Morris, J</a>, <a>Tschofenig, H</a> and <a>H Schulzrinne</a>, "<a href="http://tools.ietf.org/html/draft-ietf-geopriv-arch-03">An Architecture for Location and Location Privacy in Internet Applications</a>", Internet-Draft draft-ietf-geopriv-arch-03, October 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Martin Thomson</span> 
	  <span class="n hidden">
		<span class="family-name">Thomson</span>
	  </span>
	</span>
	<span class="org vcardline">Andrew</span>
	<span class="adr">
	  <span>Andrew Building (39)</span>
<span>Wollongong University Campus</span>
<span>Northfields Avenue</span>

	  <span class="vcardline">
		<span class="locality">Wollongong</span>,  
		<span class="region">NSW</span> 
		<span class="code">2522</span>
	  </span>
	  <span class="country-name vcardline">Australia</span>
	</span>
	<span class="vcardline">Phone: +61 2 4221 2915</span>

<span class="vcardline">EMail: <a href="mailto:martin.thomson@andrew.com">martin.thomson@andrew.com</a></span>

<span class="vcardline">URI: <a href="http://www.andrew.com/">http://www.andrew.com/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">James Winterbottom</span> 
	  <span class="n hidden">
		<span class="family-name">Winterbottom</span>
	  </span>
	</span>
	<span class="org vcardline">Andrew</span>
	<span class="adr">
	  <span>Andrew Building (39)</span>
<span>Wollongong University Campus</span>
<span>Northfields Avenue</span>

	  <span class="vcardline">
		<span class="locality">Wollongong</span>,  
		<span class="region">NSW</span> 
		<span class="code">2522</span>
	  </span>
	  <span class="country-name vcardline">Australia</span>
	</span>
	<span class="vcardline">Phone: +61 2 4221 2938</span>

<span class="vcardline">EMail: <a href="mailto:james.winterbottom@andrew.com">james.winterbottom@andrew.com</a></span>

<span class="vcardline">URI: <a href="http://www.andrew.com/">http://www.andrew.com/</a></span>

  </address>
</div>

</body>
</html>