<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Signing HTTP Messages</title>
<meta content="Annabelle Backman" name="author">
<meta content="Justin Richer" name="author">
<meta content="Manu Sporny" name="author">
<meta content="
       This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over content within an HTTP message.  This mechanism supports use cases where the full HTTP message may not be known to the signer, and where the message may be transformed (e.g., by intermediaries) before reaching the verifier. 
    " name="description">
<meta content="xml2rfc 3.4.0" name="generator">
<meta content="PKI" name="keyword">
<meta content="draft-ietf-httpbis-message-signatures-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.4.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.25.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/draft-ietf-httpbis-message-signatures-01-sg0kxbt5.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Signing HTTP Messages</td>
<td class="right">November 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Backman, et al.</td>
<td class="center">Expires 21 May 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">HTTP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-httpbis-message-signatures-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-11-17" class="published">17 November 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-05-21">21 May 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Backman, <span class="editor">Ed.</span>
</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">J. Richer</div>
<div class="org">Bespoke Engineering</div>
</div>
<div class="author">
      <div class="author-name">M. Sporny</div>
<div class="org">Digital Bazaar</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Signing HTTP Messages</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over content within an HTTP message.  This mechanism supports use cases where the full HTTP message may not be known to the signer, and where the message may be transformed (e.g., by intermediaries) before reaching the verifier.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1"><em>RFC EDITOR: please remove this section before publication</em><a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">This work was originally based on draft-cavage-http-signatures-12, but has since diverged from it, to reflect discussion since adoption by the HTTP Working Group. In particular, it addresses issues that have been identified, and adds features to support new use cases. It is a work-in-progress and not yet suitable for deployment.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 May 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-discussion" class="xref">Requirements Discussion</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-http-message-transformation" class="xref">HTTP Message Transformations</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-safe-transformations" class="xref">Safe Transformations</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a><a href="#section-toc.1-1.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-identifying-and-canonicaliz" class="xref">Identifying and Canonicalizing Content</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-http-header-fields" class="xref">HTTP Header Fields</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-canonicalization-examples" class="xref">Canonicalization Examples</a><a href="#section-toc.1-1.2.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-dictionary-structured-field" class="xref">Dictionary Structured Field Members</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-canonicalization-examples-2" class="xref">Canonicalization Examples</a><a href="#section-toc.1-1.2.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-list-prefixes" class="xref">List Prefixes</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-canonicalization-examples-3" class="xref">Canonicalization Examples</a><a href="#section-toc.1-1.2.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-signature-creation-time" class="xref">Signature Creation Time</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-signature-expiration-time" class="xref">Signature Expiration Time</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-target-endpoint" class="xref">Target Endpoint</a><a href="#section-toc.1-1.2.2.6.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.2.2.6.2.1">
                    <p id="section-toc.1-1.2.2.6.2.1.1"><a href="#section-2.6.1" class="xref">2.6.1</a>.  <a href="#name-canonicalization-examples-4" class="xref">Canonicalization Examples</a><a href="#section-toc.1-1.2.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-http-message-signatures" class="xref">HTTP Message Signatures</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-signature-metadata" class="xref">Signature Metadata</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-creating-a-signature" class="xref">Creating a Signature</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-choose-and-set-signature-me" class="xref">Choose and Set Signature Metadata Properties</a><a href="#section-toc.1-1.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-create-the-signature-input" class="xref">Create the Signature Input</a><a href="#section-toc.1-1.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-sign-the-signature-input" class="xref">Sign the Signature Input</a><a href="#section-toc.1-1.3.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-verifying-a-signature" class="xref">Verifying a Signature</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-enforcing-application-requi" class="xref">Enforcing Application Requirements</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-including-a-message-signatu" class="xref">Including a Message Signature in a Message</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-the-signature-input-http-he" class="xref">The 'Signature-Input' HTTP Header</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-metadata-parameters" class="xref">Metadata Parameters</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-the-signature-http-header" class="xref">The 'Signature' HTTP Header</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-http-signature-algorithms-r" class="xref">HTTP Signature Algorithms Registry</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-registration-template" class="xref">Registration Template</a><a href="#section-toc.1-1.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-initial-contents" class="xref">Initial Contents</a><a href="#section-toc.1-1.5.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-http-signature-metadata-par" class="xref">HTTP Signature Metadata Parameters Registry</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-registration-template-2" class="xref">Registration Template</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-initial-contents-2" class="xref">Initial Contents</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-examples-2" class="xref">Examples</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-example-keys" class="xref">Example Keys</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-a.1.1" class="xref">A.1.1</a>.  <a href="#name-example-key-rsa-test" class="xref">Example Key RSA test</a><a href="#section-toc.1-1.8.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-example-keyid-values" class="xref">Example keyId Values</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-test-cases" class="xref">Test Cases</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-a.3.1" class="xref">A.3.1</a>.  <a href="#name-signature-generation" class="xref">Signature Generation</a><a href="#section-toc.1-1.8.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-a.3.2" class="xref">A.3.2</a>.  <a href="#name-signature-verification" class="xref">Signature Verification</a><a href="#section-toc.1-1.8.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-topics-for-working-group-di" class="xref">Topics for Working Group Discussion</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-issues" class="xref">Issues</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-b.1.1" class="xref">B.1.1</a>.  <a href="#name-confusing-guidance-on-algor" class="xref">Confusing guidance on algorithm and key identification</a><a href="#section-toc.1-1.9.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-b.1.2" class="xref">B.1.2</a>.  <a href="#name-lack-of-definition-of-keyid" class="xref">Lack of definition of keyId hurts interoperability</a><a href="#section-toc.1-1.9.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-b.1.3" class="xref">B.1.3</a>.  <a href="#name-algorithm-registry-duplicat" class="xref">Algorithm Registry duplicates work of JWA</a><a href="#section-toc.1-1.9.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-b.1.4" class="xref">B.1.4</a>.  <a href="#name-algorithm-registry-should-n" class="xref">Algorithm Registry should not be initialized with deprecated entries</a><a href="#section-toc.1-1.9.2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.5">
                    <p id="section-toc.1-1.9.2.1.2.5.1"><a href="#section-b.1.5" class="xref">B.1.5</a>.  <a href="#name-no-percent-encoding-normali" class="xref">No percent-encoding normalization of path/query</a><a href="#section-toc.1-1.9.2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.6">
                    <p id="section-toc.1-1.9.2.1.2.6.1"><a href="#section-b.1.6" class="xref">B.1.6</a>.  <a href="#name-misleading-name-for-headers" class="xref">Misleading name for headers parameter</a><a href="#section-toc.1-1.9.2.1.2.6.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.7">
                    <p id="section-toc.1-1.9.2.1.2.7.1"><a href="#section-b.1.7" class="xref">B.1.7</a>.  <a href="#name-changes-to-whitespace-in-he" class="xref">Changes to whitespace in header field values break verification</a><a href="#section-toc.1-1.9.2.1.2.7.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.8">
                    <p id="section-toc.1-1.9.2.1.2.8.1"><a href="#section-b.1.8" class="xref">B.1.8</a>.  <a href="#name-multiple-set-cookie-headers" class="xref">Multiple Set-Cookie headers are not well supported</a><a href="#section-toc.1-1.9.2.1.2.8.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.9">
                    <p id="section-toc.1-1.9.2.1.2.9.1"><a href="#section-b.1.9" class="xref">B.1.9</a>.  <a href="#name-covered-content-list-is-not" class="xref">Covered Content list is not signed</a><a href="#section-toc.1-1.9.2.1.2.9.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.10">
                    <p id="section-toc.1-1.9.2.1.2.10.1"><a href="#section-b.1.10" class="xref">B.1.10</a>. <a href="#name-algorithm-is-not-signed" class="xref">Algorithm is not signed</a><a href="#section-toc.1-1.9.2.1.2.10.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.11">
                    <p id="section-toc.1-1.9.2.1.2.11.1"><a href="#section-b.1.11" class="xref">B.1.11</a>. <a href="#name-verification-key-identifier" class="xref">Verification key identifier is not signed</a><a href="#section-toc.1-1.9.2.1.2.11.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.12">
                    <p id="section-toc.1-1.9.2.1.2.12.1"><a href="#section-b.1.12" class="xref">B.1.12</a>. <a href="#name-max-values-precision-for-in" class="xref">Max values, precision for Integer String and Decimal String not defined</a><a href="#section-toc.1-1.9.2.1.2.12.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.13">
                    <p id="section-toc.1-1.9.2.1.2.13.1"><a href="#section-b.1.13" class="xref">B.1.13</a>. <a href="#name-keyid-parameter-value-could" class="xref">keyId parameter value could break list syntax</a><a href="#section-toc.1-1.9.2.1.2.13.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.14">
                    <p id="section-toc.1-1.9.2.1.2.14.1"><a href="#section-b.1.14" class="xref">B.1.14</a>. <a href="#name-creation-time-and-expiratio" class="xref">Creation Time and Expiration Time do not allow for clock skew</a><a href="#section-toc.1-1.9.2.1.2.14.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.15">
                    <p id="section-toc.1-1.9.2.1.2.15.1"><a href="#section-b.1.15" class="xref">B.1.15</a>. <a href="#name-should-require-lowercased-h" class="xref">Should require lowercased header field names as identifiers</a><a href="#section-toc.1-1.9.2.1.2.15.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.16">
                    <p id="section-toc.1-1.9.2.1.2.16.1"><a href="#section-b.1.16" class="xref">B.1.16</a>. <a href="#name-reconcile-date-header-and-c" class="xref">Reconcile Date header and Creation Time</a><a href="#section-toc.1-1.9.2.1.2.16.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.17">
                    <p id="section-toc.1-1.9.2.1.2.17.1"><a href="#section-b.1.17" class="xref">B.1.17</a>. <a href="#name-remove-algorithm-specific-r" class="xref">Remove algorithm-specific rules for content identifiers</a><a href="#section-toc.1-1.9.2.1.2.17.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.18">
                    <p id="section-toc.1-1.9.2.1.2.18.1"><a href="#section-b.1.18" class="xref">B.1.18</a>. <a href="#name-add-guidance-for-signing-co" class="xref">Add guidance for signing compressed headers</a><a href="#section-toc.1-1.9.2.1.2.18.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.19">
                    <p id="section-toc.1-1.9.2.1.2.19.1"><a href="#section-b.1.19" class="xref">B.1.19</a>. <a href="#name-transformations-to-via-head" class="xref">Transformations to Via header field value break verification</a><a href="#section-toc.1-1.9.2.1.2.19.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.20">
                    <p id="section-toc.1-1.9.2.1.2.20.1"><a href="#section-b.1.20" class="xref">B.1.20</a>. <a href="#name-case-changes-to-case-insens" class="xref">Case changes to case-insensitive header field values break verification</a><a href="#section-toc.1-1.9.2.1.2.20.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.21">
                    <p id="section-toc.1-1.9.2.1.2.21.1"><a href="#section-b.1.21" class="xref">B.1.21</a>. <a href="#name-need-more-examples-for-sign" class="xref">Need more examples for Signature header</a><a href="#section-toc.1-1.9.2.1.2.21.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1.2.22">
                    <p id="section-toc.1-1.9.2.1.2.22.1"><a href="#section-b.1.22" class="xref">B.1.22</a>. <a href="#name-expiration-not-needed" class="xref">Expiration not needed</a><a href="#section-toc.1-1.9.2.1.2.22.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-features" class="xref">Features</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-b.2.1" class="xref">B.2.1</a>.  <a href="#name-define-more-content-identif" class="xref">Define more content identifiers</a><a href="#section-toc.1-1.9.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-b.2.2" class="xref">B.2.2</a>.  <a href="#name-multiple-signature-support" class="xref">Multiple signature support</a><a href="#section-toc.1-1.9.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-b.2.3" class="xref">B.2.3</a>.  <a href="#name-support-for-incremental-sig" class="xref">Support for incremental signing of header field value list items</a><a href="#section-toc.1-1.9.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#section-b.2.4" class="xref">B.2.4</a>.  <a href="#name-support-expected-authority-" class="xref">Support expected authority changes</a><a href="#section-toc.1-1.9.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.5">
                    <p id="section-toc.1-1.9.2.2.2.5.1"><a href="#section-b.2.5" class="xref">B.2.5</a>.  <a href="#name-support-for-signing-specifi" class="xref">Support for signing specific cookies</a><a href="#section-toc.1-1.9.2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-document-history" class="xref">Document History</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.e" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Message integrity and authenticity are important security properties that are critical to the secure operation of many HTTP applications.
Application developers typically rely on the transport layer to provide these properties, by operating their application over <span>[<a href="#TLS" class="xref">TLS</a>]</span>.  However, TLS only guarantees these properties over a single TLS connection, and the path between client and application may be composed of multiple independent TLS connections (for example, if the application is hosted behind a TLS-terminating gateway or if the client is behind a TLS Inspection appliance).  In such cases, TLS cannot guarantee end-to-end message integrity or authenticity between the client and application.  Additionally, some operating environments present obstacles that make it impractical to use TLS, or to use features necessary to provide message authenticity.  Furthermore, some applications require the binding of an application-level key to the HTTP message, separate from any TLS certificates in use. Consequently, while TLS can meet message integrity and authenticity needs for many HTTP-based applications, it is not a universal solution.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document defines a mechanism for providing end-to-end integrity and authenticity for content within an HTTP message.  The mechanism allows applications to create digital signatures or message authentication codes (MACs) over only that content within the message that is meaningful and appropriate for the application.  Strict canonicalization rules ensure that the verifier can verify the signature even if the message has been transformed in any of the many ways permitted by HTTP.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The mechanism described in this document consists of three parts:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">A common nomenclature and canonicalization rule set for the different protocol elements and other content within HTTP messages.<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.2">Algorithms for generating and verifying signatures over HTTP message content using this nomenclature and rule set.<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.3">A mechanism for attaching a signature and related metadata to an HTTP message.<a href="#section-1-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<div id="requirements-discussion">
<section id="section-1.1">
        <h3 id="name-requirements-discussion">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-discussion" class="section-name selfRef">Requirements Discussion</a>
        </h3>
<p id="section-1.1-1">HTTP permits and sometimes requires intermediaries to transform messages in a variety of ways.  This may result in a recipient receiving a message that is not bitwise equivalent to the message that was oringally sent.  In such a case, the recipient will be unable to verify a signature over the raw bytes of the sender's HTTP message, as verifying digital signatures or MACs requires both signer and verifier to have the exact same signed content.  Since the raw bytes of the message cannot be relied upon as signed content, the signer and verifier must derive the signed content from their respective versions of the message, via a mechanism that is resilient to safe changes that do not alter the meaning of the message.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">For a variety of reasons, it is impractical to strictly define what constitutes a safe change versus an unsafe one.  Applications use HTTP in a wide variety of ways, and may disagree on whether a particular piece of information in a message (e.g., the body, or the <code>Date</code> header field) is relevant.  Thus a general purpose solution must provide signers with some degree of control over which message content is signed.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">HTTP applications may be running in environments that do not provide complete access to or control over HTTP messages (such as a web browser's JavaScript environment), or may be using libraries that abstract away the details of the protocol (such as <a href="https://openjdk.java.net/groups/net/httpclient/intro.html">the Java HTTPClient library</a>).  These applications need to be able to generate and verify signatures despite incomplete knowledge of the HTTP message.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="about_sigs">
<section id="section-1.2">
        <h3 id="name-http-message-transformation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-http-message-transformation" class="section-name selfRef">HTTP Message Transformations</a>
        </h3>
<p id="section-1.2-1">As mentioned earlier, HTTP explicitly permits and in some cases requires implementations to transform messages in a variety of ways.  Implementations are required to tolerate many of these transformations.  What follows is a non-normative and non-exhaustive list of transformations that may occur under HTTP, provided as context:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">Re-ordering of header fields with different header field names (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 3.2.2).<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">Combination of header fields with the same field name (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 3.2.2).<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">Removal of header fields listed in the <code>Connection</code> header field (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 6.1).<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.4">Addition of header fields that indicate control options (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 6.1).<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.5">Addition or removal of a transfer coding (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 5.7.2).<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.6">Addition of header fields such as <code>Via</code> (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 5.7.1) and <code>Forwarded</code> (<span>[<a href="#RFC7239" class="xref">RFC7239</a>]</span>, Section 4).<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="safe-transformations">
<section id="section-1.3">
        <h3 id="name-safe-transformations">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-safe-transformations" class="section-name selfRef">Safe Transformations</a>
        </h3>
<p id="section-1.3-1">Based on the definition of HTTP and the requirements described above, we can identify certain types of transformations that should not prevent signature verification, even when performed on content covered by the signature.  The following list describes those transformations:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">Combination of header fields with the same field name.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">Reordering of header fields with different names.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">Conversion between different versions of the HTTP protocol (e.g., HTTP/1.x to HTTP/2, or vice-versa).<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">Changes in casing (e.g., "Origin" to "origin") of any case-insensitive content such as header field names, request URI scheme, or host.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.5">Addition or removal of leading or trailing whitespace to a header field value.<a href="#section-1.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.6">Addition or removal of <code>obs-folds</code>.<a href="#section-1.3-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.7">Changes to the <code>request-target</code> and <code>Host</code> header field that when applied together do not
result in a change to the message's effective request URI, as defined in Section 5.5 of
<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>.<a href="#section-1.3-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.3-3">Additionally, all changes to content not covered by the signature are considered safe.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-1.4">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.4-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">The terms "HTTP message", "HTTP request", "HTTP response",
<code>absolute-form</code>, <code>absolute-path</code>, "effective request URI",
"gateway", "header field", "intermediary", <code>request-target</code>,
"sender", and "recipient" are used as defined in <span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">The term "method" is to be interpreted as defined in Section 4 of <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">For brevity, the term "signature" on its own is used in this document to refer to both digital signatures and keyed MACs.  Similarly, the verb "sign" refers to the generation of either a digital signature or keyed MAC over a given input string.  The qualified term "digital signature" refers specifically to the output of an asymmetric cryptographic signing operation.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">In addition to those listed above, this document uses the following terms:<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.4-6">
          <dt id="section-1.4-6.1">Decimal String</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.2"></dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.3"></dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.4">An Integer String optionally concatenated with a period "." followed by a second Integer String, representing a positive real number expressed in base 10.  The first Integer String represents the integral portion of the number, while the optional second Integer String represents the fractional portion of the number.  (( Editor's note: There's got to be a definition for this that we can reference. ))<a href="#section-1.4-6.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.5">Integer String</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.6"></dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.7"></dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.8">A US-ASCII string of one or more digits "0-9", representing a positive integer in base 10. (( Editor's note: There's got to be a definition for this that we can reference. ))<a href="#section-1.4-6.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.9">Signer</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.10"></dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.11"></dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.12">The entity that is generating or has generated an HTTP Message Signature.<a href="#section-1.4-6.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.13">Verifier</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.14"></dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.15"></dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.16">An entity that is verifying or has verified an HTTP Message Signature against an HTTP Message.  Note that an HTTP Message Signature may be verified multiple times, potentially by different entities.<a href="#section-1.4-6.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.4-7">This document contains non-normative examples of partial and complete HTTP messages.  To improve readability, header fields may be split into multiple lines, using the <code>obs-fold</code> syntax.  This syntax is deprecated in <span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, and senders MUST NOT generate messages that include it.<a href="#section-1.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="content-identifiers">
<section id="section-2">
      <h2 id="name-identifying-and-canonicaliz">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-identifying-and-canonicaliz" class="section-name selfRef">Identifying and Canonicalizing Content</a>
      </h2>
<p id="section-2-1">In order to allow signers and verifiers to establish which content is covered by a signature, this document defines content identifiers for signature metadata and discrete pieces of message content that may be covered by an HTTP Message Signature.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Some content within HTTP messages may undergo transformations that change the bitwise value without altering meaning of the content (for example, the merging together of header fields with the same name).  Message content must therefore be canonicalized before it is signed, to ensure that a signature can be verified despite such innocuous transformations.  This document defines rules for each content identifier that transform the identifier's associated content into such a canonical form.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The following sections define content identifiers, their associated content, and their canonicalization rules.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="http-header-fields">
<section id="section-2.1">
        <h3 id="name-http-header-fields">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-http-header-fields" class="section-name selfRef">HTTP Header Fields</a>
        </h3>
<p id="section-2.1-1">An HTTP header field is identified by its header field name.  While HTTP header field names are case-insensitive, implementations MUST use lowercased field names (e.g., <code>content-type</code>, <code>date</code>, <code>etag</code>) when using them as content identifiers.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">An HTTP header field value is canonicalized as follows:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-3">
<li id="section-2.1-3.1">Create an ordered list of the field values of each instance of the header field in the message, in the order that they occur (or will occur) in the message.<a href="#section-2.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.2">Strip leading and trailing whitespace from each item in the list.<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.3">Concatenate the list items together, with a comma "," and space " " between each item. The resulting string is the canonicalized value.<a href="#section-2.1-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<div id="canonicalization-examples">
<section id="section-2.1.1">
          <h4 id="name-canonicalization-examples">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-canonicalization-examples" class="section-name selfRef">Canonicalization Examples</a>
          </h4>
<p id="section-2.1.1-1">This section contains non-normative examples of canonicalized values for header fields, given the following example HTTP message:<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1.1-2">
<pre>
HTTP/1.1 200 OK
Server: www.example.com
Date: Tue, 07 Jun 2014 20:51:35 GMT
X-OWS-Header:   Leading and trailing whitespace.
X-Obs-Fold-Header: Obsolete
    line folding.
X-Empty-Header:
Cache-Control: max-age=60
Cache-Control:    must-revalidate
</pre><a href="#section-2.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1-3">The following table shows example canonicalized values for header fields, given that message:<a href="#section-2.1.1-3" class="pilcrow">¶</a></p>
<span id="name-non-normative-examples-of-h"></span><table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-non-normative-examples-of-h" class="selfRef">Non-normative examples of header field canonicalization.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Header Field</th>
                <th class="text-left" rowspan="1" colspan="1">Canonicalized Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cache-control</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">max-age=60, must-revalidate</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>date</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Tue, 07 Jun 2014 20:51:35 GMT</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>server</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">www.example.com</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-empty-header</code>
</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-obs-fold-header</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Obsolete line folding.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-ows-header</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Leading and trailing whitespace.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="dictionary-structured-field-members">
<section id="section-2.2">
        <h3 id="name-dictionary-structured-field">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-dictionary-structured-field" class="section-name selfRef">Dictionary Structured Field Members</a>
        </h3>
<p id="section-2.2-1">An individual member in the value of a Dictionary Structured Field is identified by the lowercased field name, followed by a semicolon <code>":"</code>, followed by the member name. An individual member in the value of a Dictionary Structured Field is canonicalized by applying the serialization algorithm described in Section 4.1.2 of <span>[<a href="#StructuredFields" class="xref">StructuredFields</a>]</span> on a Dictionary containing only that member.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div id="canonicalization-examples-1">
<section id="section-2.2.1">
          <h4 id="name-canonicalization-examples-2">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-canonicalization-examples-2" class="section-name selfRef">Canonicalization Examples</a>
          </h4>
<p id="section-2.2.1-1">This section contains non-normative examples of canonicalized values for Dictionary Structured Field Members given the following example header field, whose value is assumed to be a Dictionary:<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2.1-2">
<pre>
X-Dictionary:  a=1, b=2;x=1;y=2, c=(a, b, c)
</pre><a href="#section-2.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-3">The following table shows example canonicalized values for different content identifiers, given that field:<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<span id="name-non-normative-examples-of-d"></span><table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-non-normative-examples-of-d" class="selfRef">Non-normative examples of Dictionary member canonicalization.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Content Identifier</th>
                <th class="text-left" rowspan="1" colspan="1">Canonicalized Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-dictionary:a</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-dictionary:b</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">2;x=1;y=2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-dictionary:c</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">(a, b, c)</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="list-prefixes">
<section id="section-2.3">
        <h3 id="name-list-prefixes">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-list-prefixes" class="section-name selfRef">List Prefixes</a>
        </h3>
<p id="section-2.3-1">A prefix of a List Structured Field consisting of the first N members in the field's value (where N is an integer greater than 0 and less than or equal to the number of members in the List) is identified by the lowercased field name, followed by a semicolon <code>":"</code>, followed by N expressed as an Integer String. A list prefix is canonicalized by applying the serialization algorithm described in Section 4.1.1 of <span>[<a href="#StructuredFields" class="xref">StructuredFields</a>]</span> on a List containing only the first N members as specified in the list prefix, in the order they appear in the original List.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="canonicalization-examples-2">
<section id="section-2.3.1">
          <h4 id="name-canonicalization-examples-3">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-canonicalization-examples-3" class="section-name selfRef">Canonicalization Examples</a>
          </h4>
<p id="section-2.3.1-1">This section contains non-normative examples of canonicalized values for list prefixes given the following example header fields, whose values are assumed to be Dictionaries:<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3.1-2">
<pre>
X-List-A: (a, b, c, d, e, f)
X-List-B: ()
</pre><a href="#section-2.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.1-3">The following table shows example canonicalized values for different content identifiers, given those fields:<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<span id="name-non-normative-examples-of-l"></span><table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-non-normative-examples-of-l" class="selfRef">Non-normative examples of list prefix canonicalization.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Content Identifier</th>
                <th class="text-left" rowspan="1" colspan="1">Canonicalized Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-list-a:0</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">()</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-list-a:1</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">(a)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-list-a:3</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">(a, b, c)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-list-a:6</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">(a, b, c, d, e, f)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>x-list-b:0</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">()</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="signature-creation-time">
<section id="section-2.4">
        <h3 id="name-signature-creation-time">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-signature-creation-time" class="section-name selfRef">Signature Creation Time</a>
        </h3>
<p id="section-2.4-1">The signature's Creation Time (<a href="#signature-metadata" class="xref">Section 3.1</a>) is identified by the <code>*created</code> identifier.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Its canonicalized value is an Integer String containing the signature's Creation Time expressed as the number of seconds since the Epoch, as defined in <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_16">Section 4.16</a> of <span>[<a href="#POSIX.1" class="xref">POSIX.1</a>]</span>.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.4-3.1">The use of seconds since the Epoch to canonicalize a timestamp simplifies processing and avoids timezone management required by specifications such as <span>[<a href="#RFC3339" class="xref">RFC3339</a>]</span>.<a href="#section-2.4-3.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="signature-expiration-time">
<section id="section-2.5">
        <h3 id="name-signature-expiration-time">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-signature-expiration-time" class="section-name selfRef">Signature Expiration Time</a>
        </h3>
<p id="section-2.5-1">The signature's Expiration Time (<a href="#signature-metadata" class="xref">Section 3.1</a>) is identified by the <code>*expires</code> identifier.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">Its canonicalized value is a Decimal String containing the signature's Expiration Time expressed as the number of seconds since the Epoch, as defined in <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_16">Section 4.16</a> of <span>[<a href="#POSIX.1" class="xref">POSIX.1</a>]</span>.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="target-endpoint">
<section id="section-2.6">
        <h3 id="name-target-endpoint">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-target-endpoint" class="section-name selfRef">Target Endpoint</a>
        </h3>
<p id="section-2.6-1">The request target endpoint, consisting of the request method and the path and query of the effective request URI, is identified by the <code>*request-target</code> identifier.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">Its value is canonicalized as follows:<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.6-3">
<li id="section-2.6-3.1">Take the lowercased HTTP method of the message.<a href="#section-2.6-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.6-3.2">Append a space " ".<a href="#section-2.6-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.6-3.3">Append the path and query of the request target of the message, formatted according to the rules defined for the :path pseudo-header in <span>[<a href="#HTTP2" class="xref">HTTP2</a>]</span>, Section 8.1.2.3.  The resulting string is the canonicalized value.<a href="#section-2.6-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<div id="canonicalization-examples-3">
<section id="section-2.6.1">
          <h4 id="name-canonicalization-examples-4">
<a href="#section-2.6.1" class="section-number selfRef">2.6.1. </a><a href="#name-canonicalization-examples-4" class="section-name selfRef">Canonicalization Examples</a>
          </h4>
<p id="section-2.6.1-1">The following table contains non-normative example HTTP messages and their canonicalized <code>*request-target</code> values.<a href="#section-2.6.1-1" class="pilcrow">¶</a></p>
<span id="name-non-normative-examples-of-r"></span><table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-non-normative-examples-of-r" class="selfRef">Non-normative examples of     <code>*request-target</code>
 canonicalization.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">HTTP Message</th>
                <th class="text-left" rowspan="1" colspan="1">*request-target</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <div id="section-2.6.1-2.2.1.1.1">
<pre class="sourcecode">
POST /?param=value HTTP/1.1
Host: www.example.com</pre><a href="#section-2.6.1-2.2.1.1.1" class="pilcrow">¶</a>
</div>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>post /?param=value</code>
                </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <div id="section-2.6.1-2.2.2.1.1">
<pre class="sourcecode">
POST /a/b HTTP/1.1
Host: www.example.com</pre><a href="#section-2.6.1-2.2.2.1.1" class="pilcrow">¶</a>
</div>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>post /a/b</code>
                </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <div id="section-2.6.1-2.2.3.1.1">
<pre class="sourcecode">
GET http://www.example.com/a/ HTTP/1.1</pre><a href="#section-2.6.1-2.2.3.1.1" class="pilcrow">¶</a>
</div>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>get /a/</code>
                </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <div id="section-2.6.1-2.2.4.1.1">
<pre class="sourcecode">
GET http://www.example.com HTTP/1.1</pre><a href="#section-2.6.1-2.2.4.1.1" class="pilcrow">¶</a>
</div>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>get /</code>
                </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <div id="section-2.6.1-2.2.5.1.1">
<pre class="sourcecode">
CONNECT server.example.com:80 HTTP/1.1
Host: server.example.com</pre><a href="#section-2.6.1-2.2.5.1.1" class="pilcrow">¶</a>
</div>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>connect /</code>
                </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <div id="section-2.6.1-2.2.6.1.1">
<pre class="sourcecode">
OPTIONS * HTTP/1.1
Host: server.example.com</pre><a href="#section-2.6.1-2.2.6.1.1" class="pilcrow">¶</a>
</div>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>options *</code>
                </td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="message-signatures">
<section id="section-3">
      <h2 id="name-http-message-signatures">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-http-message-signatures" class="section-name selfRef">HTTP Message Signatures</a>
      </h2>
<p id="section-3-1">An HTTP Message Signature is a signature over a string generated from a subset of the content in an HTTP message and metadata about the signature itself.  When successfully verified against an HTTP message, it provides cryptographic proof that with respect to the subset of content that was signed, the message is semantically equivalent to the message for which the signature was generated.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="signature-metadata">
<section id="section-3.1">
        <h3 id="name-signature-metadata">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-signature-metadata" class="section-name selfRef">Signature Metadata</a>
        </h3>
<p id="section-3.1-1">HTTP Message Signatures have metadata properties that provide information regarding the signature's generation and/or verification.  The following metadata properties are defined:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-2">
          <dt id="section-3.1-2.1">Algorithm</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.2"></dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.3"></dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.4">An HTTP Signature Algorithm defined in the HTTP Signature Algorithms Registry defined in this document. It describes the signing and verification algorithms for the signature.<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.5">Creation Time</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.6"></dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.7"></dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.8">A timestamp representing the point in time that the signature was generated. Sub-second precision is not supported. A signature's Creation Time MAY be undefined, indicating that it is unknown.<a href="#section-3.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.9">Covered Content</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.10"></dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.11"></dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.12">An ordered list of content identifiers (Section 2) that indicates the metadata and message content that is covered by the signature. The order of identifiers in this list affects signature generation and verification, and therefore MUST be preserved.<a href="#section-3.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.13">Expiration Time</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.14"></dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.15"></dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.16">A timestamp representing the point in time at which the signature expires. An expired signature always fails verification. A signature's Expiration Time MAY be undefined, indicating that the signature does not expire.<a href="#section-3.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.17">Verification Key Material</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.18"></dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.19"></dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.20">The key material required to verify the signature.<a href="#section-3.1-2.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="create">
<section id="section-3.2">
        <h3 id="name-creating-a-signature">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-creating-a-signature" class="section-name selfRef">Creating a Signature</a>
        </h3>
<p id="section-3.2-1">In order to create a signature, a signer completes the following process:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">Choose key material and algorithm, and set metadata properties <a href="#choose-metadata" class="xref">Section 3.2.1</a><a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.2">Create the Signature Input <a href="#canonicalization" class="xref">Section 3.2.2</a><a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.3">Sign the Signature Input <a href="#sign-sig-input" class="xref">Section 3.2.3</a><a href="#section-3.2-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.2-3">The following sections describe each of these steps in detail.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div id="choose-metadata">
<section id="section-3.2.1">
          <h4 id="name-choose-and-set-signature-me">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-choose-and-set-signature-me" class="section-name selfRef">Choose and Set Signature Metadata Properties</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-3.2.1-1">
<li id="section-3.2.1-1.1">The signer chooses an HTTP Signature Algorithm from those registered in the HTTP Signature Algorithms Registry defined by this document, and sets the signature's Algorithm property to that value.  The signer MUST NOT choose an algorithm marked "Deprecated".  The mechanism by which the signer chooses an algorithm is out of scope for this document.<a href="#section-3.2.1-1.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.1-1.2">The signer chooses key material to use for signing and verification, and sets the signature's Verification Key Material property to the key material required for verification.  The signer MUST choose key material that is appropriate for the signature's Algorithm, and that conforms to any requirements defined by the Algorithm, such as key size or format.  The mechanism by which the signer chooses key material is out of scope for this document.<a href="#section-3.2.1-1.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.1-1.3">The signer sets the signature's Creation Time property to the current time.<a href="#section-3.2.1-1.3" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.1-1.4">The signer sets the signature's Expiration Time property to the time at which the signature is to expire, or to undefined if the signature will not expire.<a href="#section-3.2.1-1.4" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.1-1.5">
              <p id="section-3.2.1-1.5.1">The signer creates an ordered list of content identifiers representing the message content and signature metadata to be covered by the signature, and assigns this list as the signature's Covered Content.<a href="#section-3.2.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-1.5.2.1">Each identifier MUST be one of those defined in Section 2.<a href="#section-3.2.1-1.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1-1.5.2.2">This list MUST NOT be empty, as this would result in creating a signature over the empty string.<a href="#section-3.2.1-1.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1-1.5.2.3">If the signature's Algorithm name does not start with rsa, hmac, or ecdsa, signers SHOULD include <code>*created</code> and <code>*request-target</code> in the list.<a href="#section-3.2.1-1.5.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1-1.5.2.4">If the signature's Algorithm starts with rsa, hmac, or ecdsa, signers SHOULD include <code>date</code> and <code>*request-target</code> in the list.<a href="#section-3.2.1-1.5.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1-1.5.2.5">Further guidance on what to include in this list and in what order is out of scope for this document.  However, the list order is significant and once established for a given signature it MUST be preserved for that signature.<a href="#section-3.2.1-1.5.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ol>
<p id="section-3.2.1-2">For example, given the following HTTP message:<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2.1-3">
<pre>
GET /foo HTTP/1.1
Host: example.org
Date: Sat, 07 Jun 2014 20:51:35 GMT
X-Example: Example header
        with some whitespace.
X-EmptyHeader:
X-Dictionary: a=1, b=2
X-List: (a, b, c, d)
Cache-Control: max-age=60
Cache-Control: must-revalidate
</pre><a href="#section-3.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-4">The following table presents a non-normative example of metadata values that a signer may choose:<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<span id="name-non-normative-example-metad"></span><div id="example-metadata">
<table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-non-normative-example-metad" class="selfRef">Non-normative example metadata values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Property</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Algorithm</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>hs2019</code>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Covered Content</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>*request-target</code>, <code>*created</code>, <code>host</code>, <code>date</code>, <code>cache-contol</code>, <code>x-emptyheader</code>, <code>x-example</code>, <code>x-dictionary:b</code>, <code>x-dictionary:a</code>, <code>x-list:3</code>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Creation Time</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>1402174295</code>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Expiration Time</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>1402174595</code>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Verification Key Material</td>
                <td class="text-left" rowspan="1" colspan="1">The public key provided in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a> and identified by the <code>keyId</code> value "test-key-a".</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="canonicalization">
<section id="section-3.2.2">
          <h4 id="name-create-the-signature-input">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-create-the-signature-input" class="section-name selfRef">Create the Signature Input</a>
          </h4>
<p id="section-3.2.2-1">The Signature Input is a US-ASCII string containing the content that will be signed.  To create it, the signer concatenates together entries for each identifier in the signature's Covered Content in the order it occurs in the list, with each entry separated by a newline <code>"\n"</code>.  An identifier's entry is a US-ASCII string consisting of the lowercased identifier followed with a colon <code>":"</code>, a space <code>" "</code>, and the identifier's canonicalized value (described below).<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">If Covered Content contains <code>*created</code> and the signature's Creation Time is undefined or the signature's Algorithm name starts with <code>rsa</code>, <code>hmac</code>, or <code>ecdsa</code> an implementation MUST produce an error.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">If Covered Content contains <code>*expires</code> and the signature does not have an Expiration Time or the signature's Algorithm name starts with <code>rsa</code>, <code>hmac</code>, or <code>ecdsa</code> an implementation MUST produce an error.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">If Covered Content contains an identifier for a header field that is not present or malformed in the message, the implementation MUST produce an error.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">If Covered Content contains an identifier for a Dictionary member that references a header field that is not present, is malformed in the message, or is not a Dictionary Structured Field, the implementation MUST produce an error. If the header field value does not contain the specified member, the implementation MUST produce an error.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2.2-6">If Covered Content contains an identifier for a List Prefix that references a header field that is not present, is malformed in the message, or is not a List Structured Field, the implementation MUST produce an error. If the header field value contains fewer than the specified number of members, the implementation MUST produce an error.<a href="#section-3.2.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2.2-7">For the non-normative example Signature metadata in <a href="#example-metadata" class="xref">Table 5</a>, the corresponding Signature Input is:<a href="#section-3.2.2-7" class="pilcrow">¶</a></p>
<span id="name-non-normative-example-signa"></span><div id="example-sig-input">
<figure id="figure-1">
            <div class="artwork art-text alignLeft" id="section-3.2.2-8.1">
<pre>
*request-target: get /foo
*created: 1402170695
host: example.org
date: Tue, 07 Jun 2014 20:51:35 GMT
cache-control: max-age=60, must-revalidate
x-emptyheader:
x-example: Example header with some whitespace.
x-dictionary: b=2
x-dictionary: a=1
x-list: (a, b, c)
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-non-normative-example-signa" class="selfRef">Non-normative example Signature Input</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="sign-sig-input">
<section id="section-3.2.3">
          <h4 id="name-sign-the-signature-input">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-sign-the-signature-input" class="section-name selfRef">Sign the Signature Input</a>
          </h4>
<p id="section-3.2.3-1">The signer signs the Signature Input using the signing algorithm described by the signature's Algorithm property, and the key material chosen by the signer.  The signer then encodes the result of that operation as a base 64-encoded string <span>[<a href="#RFC4648" class="xref">RFC4648</a>]</span>.  This string is the signature value.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">For the non-normative example Signature metadata in <a href="#choose-metadata" class="xref">Section 3.2.1</a> and Signature Input in <a href="#example-sig-input" class="xref">Figure 1</a>, the corresponding signature value is:<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<span id="name-non-normative-example-signat"></span><div id="example-sig-value">
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-3.2.3-3.1">
<pre>
K2qGT5srn2OGbOIDzQ6kYT+ruaycnDAAUpKv+ePFfD0RAxn/1BUeZx/Kdrq32DrfakQ6b
PsvB9aqZqognNT6be4olHROIkeV879RrsrObury8L9SCEibeoHyqU/yCjphSmEdd7WD+z
rchK57quskKwRefy2iEC5S2uAH0EPyOZKWlvbKmKu5q4CaB8X/I5/+HLZLGvDiezqi6/7
p2Gngf5hwZ0lSdy39vyNMaaAT0tKo6nuVw0S1MVg1Q7MpWYZs0soHjttq0uLIA3DIbQfL
iIvK6/l0BdWTU7+2uQj7lBkQAsFZHoA96ZZgFquQrXRlmYOh+Hx5D9fJkXcXe5tmAg==
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-non-normative-example-signat" class="selfRef">Non-normative example signature value</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="verify">
<section id="section-3.3">
        <h3 id="name-verifying-a-signature">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-verifying-a-signature" class="section-name selfRef">Verifying a Signature</a>
        </h3>
<p id="section-3.3-1">In order to verify a signature, a verifier MUST:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-2">
<li id="section-3.3-2.1">Examine the signature's metadata to confirm that the signature meets the requirements described in this document, as well as any additional requirements defined by the application such as which header fields or other content are required to be covered by the signature.<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.2">Use the received HTTP message and the signature's metadata to recreate the Signature Input, using the process described in <a href="#canonicalization" class="xref">Section 3.2.2</a>.<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.3">Use the signature's Algorithm and Verification Key Material with the recreated Signing Input to verify the signature value.<a href="#section-3.3-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-3">A signature with a Creation Time that is in the future or an Expiration Time that is in the past MUST NOT be processed.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">The verifier MUST ensure that a signature's Algorithm is appropriate for the key material the verifier will use to verify the signature.  If the Algorithm is not appropriate for the key material (for example, if it is the wrong size, or in the wrong format), the signature MUST NOT be processed.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div id="enforcing-application-requirements">
<section id="section-3.3.1">
          <h4 id="name-enforcing-application-requi">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-enforcing-application-requi" class="section-name selfRef">Enforcing Application Requirements</a>
          </h4>
<p id="section-3.3.1-1">The verification requirements specified in this document are intended as a baseline set of restrictions that are generally applicable to all use cases.  Applications using HTTP Message Signatures MAY impose requirements above and beyond those specified by this document, as appropriate for their use case.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">Some non-normative examples of additional requirements an application might define are:<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-3.1">Requiring a specific set of header fields to be signed (e.g., Authorization, Digest).<a href="#section-3.3.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-3.2">Enforcing a maximum signature age.<a href="#section-3.3.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-3.3">Prohibiting the use of certain algorithms, or mandating the use of an algorithm.<a href="#section-3.3.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-3.4">Requiring keys to be of a certain size (e.g., 2048 bits vs. 1024 bits).<a href="#section-3.3.1-3.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.3.1-4">Application-specific requirements are expected and encouraged.  When an application defines additional requirements, it MUST enforce them during the signature verification process, and signature verification MUST fail if the signature does not conform to the application's requirements.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">Applications MUST enforce the requirements defined in this document.  Regardless of use case, applications MUST NOT accept signatures that do not conform to these requirements.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="including-a-message-signature-in-a-message">
<section id="section-4">
      <h2 id="name-including-a-message-signatu">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-including-a-message-signatu" class="section-name selfRef">Including a Message Signature in a Message</a>
      </h2>
<p id="section-4-1">Message signatures can be included within an HTTP message via the <code>Signature-Input</code> and <code>Signature</code> HTTP header fields, both defined within this specification. The <code>Signature</code> HTTP header field contains signature values, while the <code>Signature-Input</code> HTTP header field identifies the Covered Content and metadata that describe how each signature was generated.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="the-signature-input-http-header">
<section id="section-4.1">
        <h3 id="name-the-signature-input-http-he">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-the-signature-input-http-he" class="section-name selfRef">The 'Signature-Input' HTTP Header</a>
        </h3>
<p id="section-4.1-1">The <code>Signature-Input</code> HTTP header field is a Dictionary Structured Header <span>[<a href="#StructuredFields" class="xref">StructuredFields</a>]</span> containing the metadata for zero or more message signatures generated from content within the HTTP message. Each member describes a single message signature. The member's name is an identifier that uniquely identifies the message signature within the context of the HTTP message. The member's value is the message signature's Covered Content, expressed as a List of Tokens. Further signature metadata is expressed in parameters on the member value, as described below.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="params">
<section id="section-4.1.1">
          <h4 id="name-metadata-parameters">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-metadata-parameters" class="section-name selfRef">Metadata Parameters</a>
          </h4>
<p id="section-4.1.1-1">The parameters on each <code>Signature-Input</code> member value contain metadata about the signature. Each parameter name MUST be a parameter name registered in the IANA HTTP Signatures Metadata Parameters Registry defined in <a href="#param-registry" class="xref">Section 5.2</a> of this document. This document defines the following parameters, and registers them as the initial contents of the registry:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.1-2">
            <dt id="section-4.1.1-2.1">alg</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.2"></dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.3"></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.4">RECOMMENDED. The <code>alg</code> parameter is a Token containing the name of the signature's Algorithm, as registered in the HTTP Signature Algorithms Registry defined by this document. Verifiers MUST determine the signature's Algorithm from the <code>keyId</code> parameter rather than from <code>alg</code>. If <code>alg</code> is provided and differs from or is incompatible with the algorithm or key material identified by <code>keyId</code> (for example, <code>alg</code> has a value of <code>rsa-sha256</code> but <code>keyId</code> identifies an EdDSA key), then implementations MUST produce an error.<a href="#section-4.1.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.5">created</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.6"></dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.7"></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.8">RECOMMENDED. The <code>created</code> parameter is a Decimal containing the signature's Creation Time, expressed as the canonicalized value of the <code>*created</code> content identifier, as defined in Section 2.  If not specified, the signature's Creation Time is undefined.  This parameter is useful when signers are not capable of controlling the Date HTTP Header such as when operating in certain web browser environments.<a href="#section-4.1.1-2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.9">expires</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.10"></dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.11"></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.12">OPTIONAL. The <code>expires</code> parameter is a Decimal containing the signature's Expiration Time, expressed as the canonicalized value of the <code>*expires</code> content identifier, as defined in Section 2.  If the signature does not have an Expiration Time, this parameter MUST be omitted.  If not specified, the signature's Expiration Time is undefined.<a href="#section-4.1.1-2.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.13">keyId</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.14"></dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.15"></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.16">REQUIRED. The <code>keyId</code> parameter is a String whose value can be used by a verifier to identify and/or obtain the signature's Verification Key Material. Further format and semantics of this value are out of scope for this document.<a href="#section-4.1.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="the-signature-http-header">
<section id="section-4.2">
        <h3 id="name-the-signature-http-header">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-the-signature-http-header" class="section-name selfRef">The 'Signature' HTTP Header</a>
        </h3>
<p id="section-4.2-1">The <code>Signature</code> HTTP header field is a Dictionary Structured Header <span>[<a href="#StructuredFields" class="xref">StructuredFields</a>]</span> containing zero or more message signatures generated from content within the HTTP message. Each member's name is a signature identifier that is present as a member name in the <code>Signature-Input</code> Structured Header within the HTTP message. Each member's value is a Byte Sequence containing the signature value for the message signature identified by the member name. Any member in the <code>Signature</code> HTTP header field that does not have a corresponding member in the HTTP message's <code>Signature-Input</code> HTTP header field MUST be ignored.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-4.3">
        <h3 id="name-examples">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h3>
<p id="section-4.3-1">The following is a non-normative example of <code>Signature-Input</code> and <code>Signature</code> HTTP header fields representing the signature in <a href="#example-sig-value" class="xref">Figure 2</a>:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-2">
<pre>
Signature-Input: sig1=(*request-target, *created, host, date,
    cache-control, x-empty-header, x-example); keyId="test-key-a";
    alg=hs2019; created=1402170695; expires=1402170995
Signature: sig1=:K2qGT5srn2OGbOIDzQ6kYT+ruaycnDAAUpKv+ePFfD0RAxn/1BUe
    Zx/Kdrq32DrfakQ6bPsvB9aqZqognNT6be4olHROIkeV879RrsrObury8L9SCEibe
    oHyqU/yCjphSmEdd7WD+zrchK57quskKwRefy2iEC5S2uAH0EPyOZKWlvbKmKu5q4
    CaB8X/I5/+HLZLGvDiezqi6/7p2Gngf5hwZ0lSdy39vyNMaaAT0tKo6nuVw0S1MVg
    1Q7MpWYZs0soHjttq0uLIA3DIbQfLiIvK6/l0BdWTU7+2uQj7lBkQAsFZHoA96ZZg
    FquQrXRlmYOh+Hx5D9fJkXcXe5tmAg==:
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3-3">Since <code>Signature-Input</code> and <code>Signature</code> are both defined as Dictionary Structured Headers, they can be used to easily include multiple signatures within the same HTTP message. For example, a signer may include multiple signatures signing the same content with different keys and/or algorithms to support verifiers with different capabilities, or a reverse proxy may include information about the client in header fields when forwarding the request to a service host, and may also include a signature over those fields and the client's signature. The following is a non-normative example of header fields a reverse proxy might add to a forwarded request that contains the signature in the above example:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-4">
<pre>
X-Forwarded-For: 192.0.2.123
Signature-Input: reverse_proxy_sig=(*created, host, date,
    signature:sig1, x-forwarded-for); keyId="test-key-a";
    alg=hs2019; created=1402170695; expires=1402170695.25
Signature: reverse_proxy_sig=:ON3HsnvuoTlX41xfcGWaOEVo1M3bJDRBOp0Pc/O
    jAOWKQn0VMY0SvMMWXS7xG+xYVa152rRVAo6nMV7FS3rv0rR5MzXL8FCQ2A35DCEN
    LOhEgj/S1IstEAEFsKmE9Bs7McBsCtJwQ3hMqdtFenkDffSoHOZOInkTYGafkoy78
    l1VZvmb3Y4yf7McJwAvk2R3gwKRWiiRCw448Nt7JTWzhvEwbh7bN2swc/v3NJbg/w
    JYyYVbelZx4IywuZnYFxgPl/qvqbAjeEVvaLKLgSMr11y+uzxCHoMnDUnTYhMrmOT
    4O8lBLfRFOcoJPKBdoKg9U0a96U2mUug1bFOozEVYFg==:
</pre><a href="#section-4.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="hsa-registry">
<section id="section-5.1">
        <h3 id="name-http-signature-algorithms-r">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-http-signature-algorithms-r" class="section-name selfRef">HTTP Signature Algorithms Registry</a>
        </h3>
<p id="section-5.1-1">This document defines HTTP Signature Algorithms, for which IANA is asked to create and maintain a new registry titled "HTTP Signature Algorithms".  Initial values for this registry are given in <a href="#iana-hsa-contents" class="xref">Section 5.1.2</a>.  Future assignments and modifications to existing assignment are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-hsa-template" class="xref">Section 5.1.1</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="iana-hsa-template">
<section id="section-5.1.1">
          <h4 id="name-registration-template">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-5.1.1-1">
            <dt id="section-5.1.1-1.1">Algorithm Name</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.2"></dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.3"></dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.4">An identifier for the HTTP Signature Algorithm. The name MUST be an ASCII string consisting only of lower-case characters (<code>"a"</code> - <code>"z"</code>), digits (<code>"0"</code> - <code>"9"</code>), and hyphens (<code>"-"</code>), and SHOULD NOT exceed 20 characters in length.  The identifier MUST be unique within the context of the registry.<a href="#section-5.1.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.5">Status</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.6"></dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.7"></dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.8">A brief text description of the status of the algorithm.  The description MUST begin with one of "Active" or "Deprecated", and MAY provide further context or explanation as to the reason for the status.<a href="#section-5.1.1-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.9">Description</dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.10"></dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.11"></dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.12">A description of the algorithm used to sign the signing string when generating an HTTP Message Signature, or instructions on how to determine that algorithm.  When the description specifies an algorithm, it MUST include a reference to the document or documents that define the algorithm.<a href="#section-5.1.1-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-hsa-contents">
<section id="section-5.1.2">
          <h4 id="name-initial-contents">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-initial-contents" class="section-name selfRef">Initial Contents</a>
          </h4>
<p id="section-5.1.2-1">(( MS: The references in this section are problematic as many of the specifications that they refer to are too implementation specific, rather than just pointing to the proper signature and hashing specifications.  A better approach might be just specifying the signature and hashing function specifications, leaving implementers to connect the dots (which are not that hard to connect). ))<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<div id="hs2019">
<section id="section-5.1.2.1">
            <h5 id="name-hs2019">
<a href="#section-5.1.2.1" class="section-number selfRef">5.1.2.1. </a><a href="#name-hs2019" class="section-name selfRef">hs2019</a>
            </h5>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2.1-1">
              <dt id="section-5.1.2.1-1.1">Algorithm Name</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.2"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.3"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.4">
                <code>hs2019</code><a href="#section-5.1.2.1-1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.5">Status</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.6"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.7"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.8">active<a href="#section-5.1.2.1-1.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.9">Description</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.10"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.11"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.12">Derived from metadata associated with keyId. Recommend support for:<a href="#section-5.1.2.1-1.12" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.13"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.14">
                <ul class="normal">
<li class="normal" id="section-5.1.2.1-1.14.1.1">RSASSA-PSS <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span><a href="#section-5.1.2.1-1.14.1.1" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.15"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.16">
                <ul class="normal">
<li class="normal" id="section-5.1.2.1-1.16.1.1">HMAC <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span> using SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span><a href="#section-5.1.2.1-1.16.1.1" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.17"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.18">
                <ul class="normal">
<li class="normal" id="section-5.1.2.1-1.18.1.1">ECDSA using curve P-256 DSS <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> and SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span><a href="#section-5.1.2.1-1.18.1.1" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.19"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.20">
                <ul class="normal">
<li class="normal" id="section-5.1.2.1-1.20.1.1">Ed25519ph, Ed25519ctx, and Ed25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-5.1.2.1-1.20.1.1" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="rsa-sha1">
<section id="section-5.1.2.2">
            <h5 id="name-rsa-sha1">
<a href="#section-5.1.2.2" class="section-number selfRef">5.1.2.2. </a><a href="#name-rsa-sha1" class="section-name selfRef">rsa-sha1</a>
            </h5>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2.2-1">
              <dt id="section-5.1.2.2-1.1">Algorithm Name</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.2"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.3"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.4">
                <code>rsa-sha1</code><a href="#section-5.1.2.2-1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.5">Status</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.6"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.7"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.8">Deprecated; SHA-1 not secure.<a href="#section-5.1.2.2-1.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.9">Description</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.10"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.11"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.12">RSASSA-PKCS1-v1_5 <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using SHA-1 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span><a href="#section-5.1.2.2-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="rsa-sha256">
<section id="section-5.1.2.3">
            <h5 id="name-rsa-sha256">
<a href="#section-5.1.2.3" class="section-number selfRef">5.1.2.3. </a><a href="#name-rsa-sha256" class="section-name selfRef">rsa-sha256</a>
            </h5>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2.3-1">
              <dt id="section-5.1.2.3-1.1">Algorithm Name</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.2"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.3"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.4">
                <code>rsa-sha256</code><a href="#section-5.1.2.3-1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.5">Status</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.6"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.7"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.8">Deprecated; specifying signature algorithm enables attack vector.<a href="#section-5.1.2.3-1.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.9">Description</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.10"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.11"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.12">RSASSA-PKCS1-v1_5 <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span><a href="#section-5.1.2.3-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="hmac-sha256">
<section id="section-5.1.2.4">
            <h5 id="name-hmac-sha256">
<a href="#section-5.1.2.4" class="section-number selfRef">5.1.2.4. </a><a href="#name-hmac-sha256" class="section-name selfRef">hmac-sha256</a>
            </h5>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2.4-1">
              <dt id="section-5.1.2.4-1.1">Algorithm Name</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.2"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.3"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.4">
                <code>hmac-sha256</code><a href="#section-5.1.2.4-1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.5">Status</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.6"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.7"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.8">Deprecated; specifying signature algorithm enables attack vector.<a href="#section-5.1.2.4-1.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.9">Description</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.10"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.11"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.12">HMAC <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span> using SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span><a href="#section-5.1.2.4-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ecdsa-sha256">
<section id="section-5.1.2.5">
            <h5 id="name-ecdsa-sha256">
<a href="#section-5.1.2.5" class="section-number selfRef">5.1.2.5. </a><a href="#name-ecdsa-sha256" class="section-name selfRef">ecdsa-sha256</a>
            </h5>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2.5-1">
              <dt id="section-5.1.2.5-1.1">Algorithm Name</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.5-1.2"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.5-1.3"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.5-1.4">
                <code>ecdsa-sha256</code><a href="#section-5.1.2.5-1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.5-1.5">Status</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.5-1.6"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.5-1.7"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.5-1.8">Deprecated; specifying signature algorithm enables attack vector.<a href="#section-5.1.2.5-1.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.5-1.9">Description</dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.5-1.10"></dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.5-1.11"></dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.5-1.12">ECDSA using curve P-256 DSS <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> and SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span><a href="#section-5.1.2.5-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="param-registry">
<section id="section-5.2">
        <h3 id="name-http-signature-metadata-par">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-http-signature-metadata-par" class="section-name selfRef">HTTP Signature Metadata Parameters Registry</a>
        </h3>
<p id="section-5.2-1">This document defines the <code>Signature-Input</code> Structured Header, whose member values may have parameters containing metadata about a message signature. IANA is asked to create and maintain a new registry titled "HTTP Signature Metadata Parameters" to record and maintain the set of parameters defined for use with member values in the <code>Signature-Input</code> Structured Header. Initial values for this registry are given in <a href="#iana-param-contents" class="xref">Section 5.2.2</a>.  Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-param-template" class="xref">Section 5.2.1</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="iana-param-template">
<section id="section-5.2.1">
          <h4 id="name-registration-template-2">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-registration-template-2" class="section-name selfRef">Registration Template</a>
        </h4>
</section>
</div>
<div id="iana-param-contents">
<section id="section-5.2.2">
          <h4 id="name-initial-contents-2">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-initial-contents-2" class="section-name selfRef">Initial Contents</a>
          </h4>
<p id="section-5.2.2-1">The table below contains the initial contents of the HTTP Signature Metadata Parameters Registry.  Each row in the table represents a distinct entry in the registry.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-htt"></span><table class="center" id="table-6">
            <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-initial-contents-of-the-htt" class="selfRef">Initial contents of the HTTP Signature Metadata Parameters Registry.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Reference(s)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>alg</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#params" class="xref">Section 4.1.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>created</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#params" class="xref">Section 4.1.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>expires</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#params" class="xref">Section 4.1.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>keyId</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#params" class="xref">Section 4.1.1</a> of this document</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">(( TODO: need to dive deeper on this section; not sure how much of what's referenced below is actually applicable, or if it covers everything we need to worry about. ))<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">(( TODO: Should provide some recommendations on how to determine what content needs to be signed for a given use case. ))<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">There are a number of security considerations to take into account when implementing or utilizing this specification.  A thorough security analysis of this protocol, including its strengths and weaknesses, can be found in <span>[<a href="#WP-HTTP-Sig-Audit" class="xref">WP-HTTP-Sig-Audit</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS186-4">[FIPS186-4]</dt>
        <dd>
<span class="refTitle">"Digital Signature Standard (DSS)"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">https://csrc.nist.gov/publications/detail/fips/186/4/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP2">[HTTP2]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span><span class="refAuthor">, Peon, R.</span><span class="refAuthor">, and M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MESSAGING">[MESSAGING]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="POSIX.1">[POSIX.1]</dt>
        <dd>
<span class="refTitle">"The Open Group Base Specifications Issue 7, 2018 edition"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://pubs.opengroup.org/onlinepubs/9699919799/">https://pubs.opengroup.org/onlinepubs/9699919799/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor">, Bellare, M.</span><span class="refAuthor">, and R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEMANTICS">[SEMANTICS]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="StructuredFields">[StructuredFields]</dt>
      <dd>
<span class="refTitle">"Structured Field Vaues for HTTP"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-header-structure">https://datatracker.ietf.org/doc/draft-ietf-httpbis-header-structure</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3230">[RFC3230]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span><span class="refAuthor"> and A. Van Hoff</span>, <span class="refTitle">"Instance Digests in HTTP"</span>, <span class="seriesInfo">RFC 3230</span>, <span class="seriesInfo">DOI 10.17487/RFC3230</span>, <time datetime="2002-01" class="refDate">January 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3230">https://www.rfc-editor.org/info/rfc3230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3339">[RFC3339]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span><span class="refAuthor"> and C. Newman</span>, <span class="refTitle">"Date and Time on the Internet: Timestamps"</span>, <span class="seriesInfo">RFC 3339</span>, <span class="seriesInfo">DOI 10.17487/RFC3339</span>, <time datetime="2002-07" class="refDate">July 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3339">https://www.rfc-editor.org/info/rfc3339</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span><span class="refAuthor">, Fielding, R.</span><span class="refAuthor">, and L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7239">[RFC7239]</dt>
        <dd>
<span class="refAuthor">Petersson, A.</span><span class="refAuthor"> and M. Nilsson</span>, <span class="refTitle">"Forwarded HTTP Extension"</span>, <span class="seriesInfo">RFC 7239</span>, <span class="seriesInfo">DOI 10.17487/RFC7239</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7239">https://www.rfc-editor.org/info/rfc7239</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7541">[RFC7541]</dt>
        <dd>
<span class="refAuthor">Peon, R.</span><span class="refAuthor"> and H. Ruellan</span>, <span class="refTitle">"HPACK: Header Compression for HTTP/2"</span>, <span class="seriesInfo">RFC 7541</span>, <span class="seriesInfo">DOI 10.17487/RFC7541</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7541">https://www.rfc-editor.org/info/rfc7541</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, Jonsson, J.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WP-HTTP-Sig-Audit">[WP-HTTP-Sig-Audit]</dt>
      <dd>
<span class="refTitle">"Security Considerations for HTTP Signatures"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://web-payments.org/specs/source/http-signatures-audit/">https://web-payments.org/specs/source/http-signatures-audit/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="examples-1">
<section id="section-appendix.a">
      <h2 id="name-examples-2">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-examples-2" class="section-name selfRef">Examples</a>
      </h2>
<div id="example-keys">
<section id="section-a.1">
        <h2 id="name-example-keys">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-example-keys" class="section-name selfRef">Example Keys</a>
        </h2>
<p id="section-a.1-1">This section provides cryptographic keys that are referenced in example signatures throughout this document.  These keys MUST NOT be used for any purpose other than testing.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<div id="example-key-rsa-test">
<section id="section-a.1.1">
          <h3 id="name-example-key-rsa-test">
<a href="#section-a.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-example-key-rsa-test" class="section-name selfRef">Example Key RSA test</a>
          </h3>
<p id="section-a.1.1-1">The following key is a 2048-bit RSA public and private key pair:<a href="#section-a.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.1-2">
<pre>
-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrw
WEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFq
MGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75jfZg
kne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0P
uKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZSFlQ
PSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQAB
-----END RSA PUBLIC KEY-----

-----BEGIN RSA PRIVATE KEY-----
MIIEqAIBAAKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsP
BRrwWEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsd
JKFqMGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75
jfZgkne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKI
lE0PuKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZ
SFlQPSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQABAoIBAG/JZuSWdoVHbi56
vjgCgkjg3lkO1KrO3nrdm6nrgA9P9qaPjxuKoWaKO1cBQlE1pSWp/cKncYgD5WxE
CpAnRUXG2pG4zdkzCYzAh1i+c34L6oZoHsirK6oNcEnHveydfzJL5934egm6p8DW
+m1RQ70yUt4uRc0YSor+q1LGJvGQHReF0WmJBZHrhz5e63Pq7lE0gIwuBqL8SMaA
yRXtK+JGxZpImTq+NHvEWWCu09SCq0r838ceQI55SvzmTkwqtC+8AT2zFviMZkKR
Qo6SPsrqItxZWRty2izawTF0Bf5S2VAx7O+6t3wBsQ1sLptoSgX3QblELY5asI0J
YFz7LJECgYkAsqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOM
cCNq8SyYbTqgnWlB9ZfcAm/cFpA8tYci9m5vYK8HNxQr+8FS3Qo8N9RJ8d0U5Csw
DzMYfRghAfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1
mwJ5AL0pYF0G7x81prlARURwHo0Yf52kEw1dxpx+JXER7hQRWQki5/NsUEtv+8RT
qn2m6qte5DXLyn83b1qRscSdnCCwKtKWUug5q2ZbwVOCJCtmRwmnP131lWRYfj67
B/xJ1ZA6X3GEf4sNReNAtaucPEelgR2nsN0gKQKBiGoqHWbK1qYvBxX2X3kbPDkv
9C+celgZd2PW7aGYLCHq7nPbmfDV0yHcWjOhXZ8jRMjmANVR/eLQ2EfsRLdW69bn
f3ZD7JS1fwGnO3exGmHO3HZG+6AvberKYVYNHahNFEw5TsAcQWDLRpkGybBcxqZo
81YCqlqidwfeO5YtlO7etx1xLyqa2NsCeG9A86UjG+aeNnXEIDk1PDK+EuiThIUa
/2IxKzJKWl1BKr2d4xAfR0ZnEYuRrbeDQYgTImOlfW6/GuYIxKYgEKCFHFqJATAG
IxHrq1PDOiSwXd2GmVVYyEmhZnbcp8CxaEMQoevxAta0ssMK3w6UsDtvUvYvF22m
qQKBiD5GwESzsFPy3Ga0MvZpn3D6EJQLgsnrtUPZx+z2Ep2x0xc5orneB5fGyF1P
WtP+fG5Q6Dpdz3LRfm+KwBCWFKQjg7uTxcjerhBWEYPmEMKYwTJF5PBG9/ddvHLQ
EQeNC8fHGg4UXU8mhHnSBt3EA10qQJfRDs15M38eG2cYwB1PZpDHScDnDA0=
-----END RSA PRIVATE KEY-----
</pre><a href="#section-a.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="example-keyid-values">
<section id="section-a.2">
        <h2 id="name-example-keyid-values">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-example-keyid-values" class="section-name selfRef">Example keyId Values</a>
        </h2>
<p id="section-a.2-1">The table below maps example <code>keyId</code> values to associated algorithms and/or keys.  These are example mappings that are valid only within the context of examples in examples within this and future documents that reference this section.  Unless otherwise specified, within the context of examples it should be assumed that the signer and verifier understand these <code>keyId</code> mappings.  These <code>keyId</code> values are not reserved, and deployments are free to use them, with these associations or others.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-7">
          <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">keyId</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">Verification Key</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>test-key-a</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>hs2019</code>, using RSASSA-PSS <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> and SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">The public key specified in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>test-key-b</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>rsa-sha256</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">The public key specified in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="test-cases">
<section id="section-a.3">
        <h2 id="name-test-cases">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-test-cases" class="section-name selfRef">Test Cases</a>
        </h2>
<p id="section-a.3-1">This section provides non-normative examples that may be used as test cases to validate implementation correctness.  These examples are based on the following HTTP message:<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3-2">
<pre>
POST /foo?param=value&amp;pet=dog HTTP/1.1
Host: example.com
Date: Tue, 07 Jun 2014 20:51:35 GMT
Content-Type: application/json
Digest: SHA-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
Content-Length: 18

{"hello": "world"}
</pre><a href="#section-a.3-2" class="pilcrow">¶</a>
</div>
<div id="signature-generation">
<section id="section-a.3.1">
          <h3 id="name-signature-generation">
<a href="#section-a.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-signature-generation" class="section-name selfRef">Signature Generation</a>
          </h3>
<div id="hs2019-signature-over-minimal-recommended-content">
<section id="section-a.3.1.1">
            <h4 id="name-hs2019-signature-over-minim">
<a href="#section-a.3.1.1" class="section-number selfRef">A.3.1.1. </a><a href="#name-hs2019-signature-over-minim" class="section-name selfRef">hs2019 signature over minimal recommended content</a>
            </h4>
<p id="section-a.3.1.1-1">This presents metadata for a Signature using <code>hs2019</code>, over minimum recommended data to sign:<a href="#section-a.3.1.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-8">
              <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Property</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Algorithm</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>hs2019</code>, using RSASSA-PSS <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Covered Content</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>*created, *request-target</code>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Creation Time</td>
                  <td class="text-left" rowspan="1" colspan="1">8:51:35 PM GMT, June 7th, 2014</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Expiration Time</td>
                  <td class="text-left" rowspan="1" colspan="1">Undefined</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Verification Key Material</td>
                  <td class="text-left" rowspan="1" colspan="1">The public key specified in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a>.</td>
                </tr>
              </tbody>
            </table>
<p id="section-a.3.1.1-3">The Signature Input is:<a href="#section-a.3.1.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1.1-4">
<pre>
*created: 1402170695
*request-target: post /foo?param=value&amp;pet=dog
</pre><a href="#section-a.3.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-a.3.1.1-5">The signature value is:<a href="#section-a.3.1.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1.1-6">
<pre>
QaVaWYfF2da6tG66Xtd0GrVFChJ0fOWUe/C6kaYESPiYYwnMH9egOgyKqgLLY9NQJFk7b
QY834sHEUwjS5ByEBaO3QNwIvqEY1qAAU/2MX14tc9Yn7ELBnaaNHaHkV3xVO9KIuLT7V
6e4OUuGb1axfbXpMgPEql6CEFrn6K95CLuuKP5/gOEcBtmJp5L58gN4VvZrk2OVA6U971
YiEDNuDa4CwMcQMvcGssbc/L3OULTUffD/1VcPtdGImP2uvVQntpT8b2lBeBpfh8MuaV2
vtzidyBYFtAUoYhRWO8+ntqA1q2OK4LMjM2XgDScSVWvGdVd459A0wI9lRlnPap3zg==
</pre><a href="#section-a.3.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-a.3.1.1-7">A possible <code>Signature-Input</code> and <code>Signature</code> header containing this signature is:<a href="#section-a.3.1.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1.1-8">
<pre>
Signature-Input: sig1=(*created, *request-target);
    keyId="test-key-a"; created=1402170695
Signature: sig1=:QaVaWYfF2da6tG66Xtd0GrVFChJ0fOWUe/C6kaYESPiYYwnMH9eg
    OgyKqgLLY9NQJFk7bQY834sHEUwjS5ByEBaO3QNwIvqEY1qAAU/2MX14tc9Yn7ELB
    naaNHaHkV3xVO9KIuLT7V6e4OUuGb1axfbXpMgPEql6CEFrn6K95CLuuKP5/gOEcB
    tmJp5L58gN4VvZrk2OVA6U971YiEDNuDa4CwMcQMvcGssbc/L3OULTUffD/1VcPtd
    GImP2uvVQntpT8b2lBeBpfh8MuaV2vtzidyBYFtAUoYhRWO8+ntqA1q2OK4LMjM2X
    gDScSVWvGdVd459A0wI9lRlnPap3zg==:
</pre><a href="#section-a.3.1.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="hs2019-signature-covering-all-header-fields">
<section id="section-a.3.1.2">
            <h4 id="name-hs2019-signature-covering-a">
<a href="#section-a.3.1.2" class="section-number selfRef">A.3.1.2. </a><a href="#name-hs2019-signature-covering-a" class="section-name selfRef">hs2019 signature covering all header fields</a>
            </h4>
<p id="section-a.3.1.2-1">This presents metadata for a Signature using <code>hs2019</code> that covers all header fields in the request:<a href="#section-a.3.1.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-9">
              <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Property</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Algorithm</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>hs2019</code>, using RSASSA-PSS <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Covered Content</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>*created, *request-target, host, date, content-type, digest, content-length</code>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Creation Time</td>
                  <td class="text-left" rowspan="1" colspan="1">8:51:35 PM GMT, June 7th, 2014</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Expiration Time</td>
                  <td class="text-left" rowspan="1" colspan="1">Undefined</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Verification Key Material</td>
                  <td class="text-left" rowspan="1" colspan="1">The public key specified in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a>.</td>
                </tr>
              </tbody>
            </table>
<p id="section-a.3.1.2-3">The Signature Input is:<a href="#section-a.3.1.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1.2-4">
<pre>
*created: 1402170695
*request-target: post /foo?param=value&amp;pet=dog
host: example.com
date: Tue, 07 Jun 2014 20:51:35 GMT
content-type: application/json
digest: SHA-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
content-length: 18
</pre><a href="#section-a.3.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-a.3.1.2-5">The signature value is:<a href="#section-a.3.1.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1.2-6">
<pre>
B24UG4FaiE2kSXBNKV4DA91J+mElAhS3mncrgyteAye1GKMpmzt8jkHNjoudtqw3GngGY
3n0mmwjdfn1eA6nAjgeHwl0WXced5tONcCPNzLswqPOiobGeA5y4WE8iBveel30OKYVel
0lZ1OnXOmN5TIEIIPo9LrE+LzZis6A0HA1FRMtKgKGhT3N965pkqfhKbq/V48kpJKT8+c
Zs0TOn4HFMG+OIy6c9ofSBrXD68yxP6QYTz6xH0GMWawLyPLYR52j3I05fK1ylAb6K0ox
PxzQ5nwrLD+mUVPZ9rDs1En6fmOX9xfkZTblG/5D+s1fHHs9dDXCOVkT5dLS8DjdIA==
</pre><a href="#section-a.3.1.2-6" class="pilcrow">¶</a>
</div>
<p id="section-a.3.1.2-7">A possible <code>Signature-Input</code> and <code>Signature</code> header containing this signature is:<a href="#section-a.3.1.2-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.1.2-8">
<pre>
Signature-Input: sig1=(*request-target, *created, host, date,
        content-type, digest, content-length); keyId="test-key-a";
    alg=hs2019; created=1402170695
Signature: sig1=:B24UG4FaiE2kSXBNKV4DA91J+mElAhS3mncrgyteAye1GKMpmzt8
    jkHNjoudtqw3GngGY3n0mmwjdfn1eA6nAjgeHwl0WXced5tONcCPNzLswqPOiobGe
    A5y4WE8iBveel30OKYVel0lZ1OnXOmN5TIEIIPo9LrE+LzZis6A0HA1FRMtKgKGhT
    3N965pkqfhKbq/V48kpJKT8+cZs0TOn4HFMG+OIy6c9ofSBrXD68yxP6QYTz6xH0G
    MWawLyPLYR52j3I05fK1ylAb6K0oxPxzQ5nwrLD+mUVPZ9rDs1En6fmOX9xfkZTbl
    G/5D+s1fHHs9dDXCOVkT5dLS8DjdIA==:
</pre><a href="#section-a.3.1.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="signature-verification">
<section id="section-a.3.2">
          <h3 id="name-signature-verification">
<a href="#section-a.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-signature-verification" class="section-name selfRef">Signature Verification</a>
          </h3>
<div id="minimal-required-signature-header">
<section id="section-a.3.2.1">
            <h4 id="name-minimal-required-signature-">
<a href="#section-a.3.2.1" class="section-number selfRef">A.3.2.1. </a><a href="#name-minimal-required-signature-" class="section-name selfRef">Minimal Required Signature Header</a>
            </h4>
<p id="section-a.3.2.1-1">This presents a <code>Signature-Input</code> and <code>Signature</code> header containing only the minimal required parameters:<a href="#section-a.3.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.2.1-2">
<pre>
Signature-Input: sig1=(); keyId="test-key-a"; created=1402170695
Signature: sig1=:cxieW5ZKV9R9A70+Ua1A/1FCvVayuE6Z77wDGNVFSiluSzR9TYFV
    vwUjeU6CTYUdbOByGMCee5q1eWWUOM8BIH04Si6VndEHjQVdHqshAtNJk2Quzs6WC
    2DkV0vysOhBSvFZuLZvtCmXRQfYGTGhZqGwq/AAmFbt5WNLQtDrEe0ErveEKBfaz+
    IJ35zhaj+dun71YZ82b/CRfO6fSSt8VXeJuvdqUuVPWqjgJD4n9mgZpZFGBaDdPiw
    pfbVZHzcHrumFJeFHWXH64a+c5GN+TWlP8NPg2zFdEc/joMymBiRelq236WGm5VvV
    9a22RW2/yLmaU/uwf9v40yGR/I1NRA==:
</pre><a href="#section-a.3.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-a.3.2.1-3">The corresponding signature metadata derived from this header field is:<a href="#section-a.3.2.1-3" class="pilcrow">¶</a></p>
<table class="center" id="table-10">
              <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Property</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Algorithm</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>hs2019</code>, using RSASSA-PSS  using SHA-256</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Covered Content</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>*created</code>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Creation Time</td>
                  <td class="text-left" rowspan="1" colspan="1">8:51:35 PM GMT, June 7th, 2014</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Expiration Time</td>
                  <td class="text-left" rowspan="1" colspan="1">Undefined</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Verification Key Material</td>
                  <td class="text-left" rowspan="1" colspan="1">The public key specified in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a>.</td>
                </tr>
              </tbody>
            </table>
<p id="section-a.3.2.1-5">The corresponding Signature Input is:<a href="#section-a.3.2.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.2.1-6">
<pre>
*created: 1402170695
</pre><a href="#section-a.3.2.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="minimal-recommended-signature-header">
<section id="section-a.3.2.2">
            <h4 id="name-minimal-recommended-signatu">
<a href="#section-a.3.2.2" class="section-number selfRef">A.3.2.2. </a><a href="#name-minimal-recommended-signatu" class="section-name selfRef">Minimal Recommended Signature Header</a>
            </h4>
<p id="section-a.3.2.2-1">This presents a <code>Signature-Input</code> and <code>Signature</code> header containing only the minimal required and recommended parameters:<a href="#section-a.3.2.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.2.2-2">
<pre>
Signature-Input: sig1=(); alg=hs2019; keyId="test-key-a";
    created=1402170695
Signature: sig1=:cxieW5ZKV9R9A70+Ua1A/1FCvVayuE6Z77wDGNVFSiluSzR9TYFV
    vwUjeU6CTYUdbOByGMCee5q1eWWUOM8BIH04Si6VndEHjQVdHqshAtNJk2Quzs6WC
    2DkV0vysOhBSvFZuLZvtCmXRQfYGTGhZqGwq/AAmFbt5WNLQtDrEe0ErveEKBfaz+
    IJ35zhaj+dun71YZ82b/CRfO6fSSt8VXeJuvdqUuVPWqjgJD4n9mgZpZFGBaDdPiw
    pfbVZHzcHrumFJeFHWXH64a+c5GN+TWlP8NPg2zFdEc/joMymBiRelq236WGm5VvV
    9a22RW2/yLmaU/uwf9v40yGR/I1NRA==:
</pre><a href="#section-a.3.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-a.3.2.2-3">The corresponding signature metadata derived from this header field is:<a href="#section-a.3.2.2-3" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
              <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Property</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Algorithm</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>hs2019</code>, using RSASSA-PSS  using SHA-512</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Covered Content</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>*created</code>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Creation Time</td>
                  <td class="text-left" rowspan="1" colspan="1">8:51:35 PM GMT, June 7th, 2014</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Expiration Time</td>
                  <td class="text-left" rowspan="1" colspan="1">Undefined</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Verification Key Material</td>
                  <td class="text-left" rowspan="1" colspan="1">The public key specified in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a>.</td>
                </tr>
              </tbody>
            </table>
<p id="section-a.3.2.2-5">The corresponding Signature Input is:<a href="#section-a.3.2.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.2.2-6">
<pre>
*created: 1402170695
</pre><a href="#section-a.3.2.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="minimal-signature-header-using-rsa-sha256">
<section id="section-a.3.2.3">
            <h4 id="name-minimal-signature-header-us">
<a href="#section-a.3.2.3" class="section-number selfRef">A.3.2.3. </a><a href="#name-minimal-signature-header-us" class="section-name selfRef">Minimal Signature Header using rsa-sha256</a>
            </h4>
<p id="section-a.3.2.3-1">This presents a minimal <code>Signature-Input</code> and <code>Signature</code> header for a signature using the <code>rsa-sha256</code> algorithm:<a href="#section-a.3.2.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.2.3-2">
<pre>
Signature: sig1=(date); alg=rsa-sha256; keyId="test-key-b"
Signature: sig1=:HtXycCl97RBVkZi66ADKnC9c5eSSlb57GnQ4KFqNZplOpNfxqk62
    JzZ484jXgLvoOTRaKfR4hwyxlcyb+BWkVasApQovBSdit9Ml/YmN2IvJDPncrlhPD
    VDv36Z9/DiSO+RNHD7iLXugdXo1+MGRimW1RmYdenl/ITeb7rjfLZ4b9VNnLFtVWw
    rjhAiwIqeLjodVImzVc5srrk19HMZNuUejK6I3/MyN3+3U8tIRW4LWzx6ZgGZUaEE
    P0aBlBkt7Fj0Tt5/P5HNW/Sa/m8smxbOHnwzAJDa10PyjzdIbywlnWIIWtZKPPsoV
    oKVopUWEU3TNhpWmaVhFrUL/O6SN3w==:
</pre><a href="#section-a.3.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-a.3.2.3-3">The corresponding signature metadata derived from this header field is:<a href="#section-a.3.2.3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-12">
              <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Property</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Algorithm</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>rsa-sha256</code>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Covered Content</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>date</code>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Creation Time</td>
                  <td class="text-left" rowspan="1" colspan="1">Undefined</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Expiration Time</td>
                  <td class="text-left" rowspan="1" colspan="1">Undefined</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Verification Key Material</td>
                  <td class="text-left" rowspan="1" colspan="1">The public key specified in <a href="#example-key-rsa-test" class="xref">Appendix A.1.1</a>.</td>
                </tr>
              </tbody>
            </table>
<p id="section-a.3.2.3-5">The corresponding Signature Input is:<a href="#section-a.3.2.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3.2.3-6">
<pre>
date: Tue, 07 Jun 2014 20:51:35 GMT
</pre><a href="#section-a.3.2.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="wg-discuss">
<section id="section-appendix.b">
      <h2 id="name-topics-for-working-group-di">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-topics-for-working-group-di" class="section-name selfRef">Topics for Working Group Discussion</a>
      </h2>
<p id="section-appendix.b-1"><em>RFC EDITOR: please remove this section before publication</em><a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">The draft has known issues that will need to be addressed during development, and these issues have been enumerated but not addressed in this version. Topics are not listed in any particular order.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<div id="issues">
<section id="section-b.1">
        <h2 id="name-issues">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-issues" class="section-name selfRef">Issues</a>
        </h2>
<div id="issue-alg-keyid">
<section id="section-b.1.1">
          <h3 id="name-confusing-guidance-on-algor">
<a href="#section-b.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-confusing-guidance-on-algor" class="section-name selfRef">Confusing guidance on algorithm and key identification</a>
          </h3>
<p id="section-b.1.1-1">The current draft encourages determining the Algorithm metadata property from the <code>keyId</code> field, both in the guidance for the use of <code>algorithm</code> and <code>keyId</code>, and the definition for the <code>hs2019</code> algorithm and deprecation of the other algorithms in the registry.  The current state arose from concern that a malicious party could change the value of the <code>algorithm</code> parameter, potentially tricking the verifier into accepting a signature that would not have been verified under the actual parameter.<a href="#section-b.1.1-1" class="pilcrow">¶</a></p>
<p id="section-b.1.1-2">Punting algorithm identification into <code>keyId</code> hurts interoperability, since we aren't defining the syntax or semantics of <code>keyId</code>.  It actually goes against that claim, as we are dictating that the signing algorithm must be specified by <code>keyId</code> or derivable from it.  It also renders the algorithm registry essentially useless.  Instead of this approach, we can protect against manipulation of the Signature header field by adding support for (and possibly mandating) including Signature metadata within the Signature Input.<a href="#section-b.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lack-of-definition-of-keyid-hurts-interoperability">
<section id="section-b.1.2">
          <h3 id="name-lack-of-definition-of-keyid">
<a href="#section-b.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-lack-of-definition-of-keyid" class="section-name selfRef">Lack of definition of keyId hurts interoperability</a>
          </h3>
<p id="section-b.1.2-1">The current text leaves the format and semantics of <code>keyId</code> completely up to the implementation.  This is primarily due to the fact that most implementers of Cavage have extensive investment in key distribution and management, and just need to plug an identifier into the header.  We should support those cases, but we also need to provide guidance for the developer that doesn't have that and just wants to know how to identify a key.  It may be enough to punt this to profiling specs, but this needs to be explored more.<a href="#section-b.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="algorithm-registry-duplicates-work-of-jwa">
<section id="section-b.1.3">
          <h3 id="name-algorithm-registry-duplicat">
<a href="#section-b.1.3" class="section-number selfRef">B.1.3. </a><a href="#name-algorithm-registry-duplicat" class="section-name selfRef">Algorithm Registry duplicates work of JWA</a>
          </h3>
<p id="section-b.1.3-1"><span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span> already defines an IANA registry for cryptographic algorithms.  This wasn't used by Cavage out of concerns about complexity of JOSE, and issues with JWE and JWS being too flexible, leading to insecure combinations of options.  Using JWA's definitions does not need to mean we're using JOSE, however.
We should look at if/how we can leverage JWA's work without introducing too many sharp edges for implementers.<a href="#section-b.1.3-1" class="pilcrow">¶</a></p>
<p id="section-b.1.3-2">In any use of JWS algorithms, this spec would define a way to create the JWS Signing Input string to be applied to the algorithm.  It should be noted that this is incompatible with JWS itself, which requires the inclusion of a structured header in the signature input.<a href="#section-b.1.3-2" class="pilcrow">¶</a></p>
<p id="section-b.1.3-3">A possible approach is to incorporate all elements of the JWA signature algorithm registry into this spec using a prefix or other marker, such as <code>jws-RS256</code> for the RSA 256 JSON Web Signature algorithm.<a href="#section-b.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="algorithm-registry-should-not-be-initialized-with-deprecated-entries">
<section id="section-b.1.4">
          <h3 id="name-algorithm-registry-should-n">
<a href="#section-b.1.4" class="section-number selfRef">B.1.4. </a><a href="#name-algorithm-registry-should-n" class="section-name selfRef">Algorithm Registry should not be initialized with deprecated entries</a>
          </h3>
<p id="section-b.1.4-1">The initial entries in this document reflect those in Cavage.  The ones that are marked deprecated were done so because of the issue explained in <a href="#issue-alg-keyid" class="xref">Appendix B.1.1</a>, with the possible exception of <code>rsa-sha1</code>.  We should probably just remove that one.<a href="#section-b.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-percent-encoding-normalization-of-pathquery">
<section id="section-b.1.5">
          <h3 id="name-no-percent-encoding-normali">
<a href="#section-b.1.5" class="section-number selfRef">B.1.5. </a><a href="#name-no-percent-encoding-normali" class="section-name selfRef">No percent-encoding normalization of path/query</a>
          </h3>
<p id="section-b.1.5-1">See: <a href="https://github.com/w3c-dvcg/http-signatures/issues/26">issue #26</a><a href="#section-b.1.5-1" class="pilcrow">¶</a></p>
<p id="section-b.1.5-2">The canonicalization rules for <code>*request-target</code> do not perform handle minor, semantically meaningless differences in percent-encoding, such that verification could fail if an intermediary normalizes the effective request URI prior to forwarding the message.<a href="#section-b.1.5-2" class="pilcrow">¶</a></p>
<p id="section-b.1.5-3">At a minimum, they should be case and percent-encoding normalized as described in sections 6.2.2.1 and 6.2.2.2 of <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>.<a href="#section-b.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="misleading-name-for-headers-parameter">
<section id="section-b.1.6">
          <h3 id="name-misleading-name-for-headers">
<a href="#section-b.1.6" class="section-number selfRef">B.1.6. </a><a href="#name-misleading-name-for-headers" class="section-name selfRef">Misleading name for headers parameter</a>
          </h3>
<p id="section-b.1.6-1">The Covered Content list contains identifiers for more than just headers, so the <code>header</code> parameter name is no longer appropriate.  Some alternatives: "content", "signed-content", "covered-content".<a href="#section-b.1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-to-whitespace-in-header-field-values-break-verification">
<section id="section-b.1.7">
          <h3 id="name-changes-to-whitespace-in-he">
<a href="#section-b.1.7" class="section-number selfRef">B.1.7. </a><a href="#name-changes-to-whitespace-in-he" class="section-name selfRef">Changes to whitespace in header field values break verification</a>
          </h3>
<p id="section-b.1.7-1">Some header field values contain RWS, OWS, and/or BWS.  Since the header field value canonicalization rules do not address whitespace, changes to it (e.g., removing OWS or BWS or replacing strings of RWS with a single space) can cause verification to fail.<a href="#section-b.1.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-set-cookie-headers-are-not-well-supported">
<section id="section-b.1.8">
          <h3 id="name-multiple-set-cookie-headers">
<a href="#section-b.1.8" class="section-number selfRef">B.1.8. </a><a href="#name-multiple-set-cookie-headers" class="section-name selfRef">Multiple Set-Cookie headers are not well supported</a>
          </h3>
<p id="section-b.1.8-1">The Set-Cookie header can occur multiple times but does not adhere to the list syntax, and thus is not well supported by the header field value concatenation rules.<a href="#section-b.1.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="covered-content-list-is-not-signed">
<section id="section-b.1.9">
          <h3 id="name-covered-content-list-is-not">
<a href="#section-b.1.9" class="section-number selfRef">B.1.9. </a><a href="#name-covered-content-list-is-not" class="section-name selfRef">Covered Content list is not signed</a>
          </h3>
<p id="section-b.1.9-1">The Covered Content list should be part of the Signature Input, to protect against malicious changes.<a href="#section-b.1.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="algorithm-is-not-signed">
<section id="section-b.1.10">
          <h3 id="name-algorithm-is-not-signed">
<a href="#section-b.1.10" class="section-number selfRef">B.1.10. </a><a href="#name-algorithm-is-not-signed" class="section-name selfRef">Algorithm is not signed</a>
          </h3>
<p id="section-b.1.10-1">The Algorithm should be part of the Signature Input, to protect against malicious changes.<a href="#section-b.1.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-key-identifier-is-not-signed">
<section id="section-b.1.11">
          <h3 id="name-verification-key-identifier">
<a href="#section-b.1.11" class="section-number selfRef">B.1.11. </a><a href="#name-verification-key-identifier" class="section-name selfRef">Verification key identifier is not signed</a>
          </h3>
<p id="section-b.1.11-1">The Verification key identifier (e.g., the value used for the <code>keyId</code> parameter) should be part of the Signature Input, to protect against malicious changes.<a href="#section-b.1.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="max-values-precision-for-integer-string-and-decimal-string-not-defined">
<section id="section-b.1.12">
          <h3 id="name-max-values-precision-for-in">
<a href="#section-b.1.12" class="section-number selfRef">B.1.12. </a><a href="#name-max-values-precision-for-in" class="section-name selfRef">Max values, precision for Integer String and Decimal String not defined</a>
          </h3>
<p id="section-b.1.12-1">The definitions for Integer String and Decimal String do not specify a maximum value.  The definition for Decimal String (used to provide sub-second precision for Expiration Time) does not define minimum or maximum precision requirements.  It should set a sane requirement here (e.g., MUST support up to 3 decimal places and no more).<a href="#section-b.1.12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keyid-parameter-value-could-break-list-syntax">
<section id="section-b.1.13">
          <h3 id="name-keyid-parameter-value-could">
<a href="#section-b.1.13" class="section-number selfRef">B.1.13. </a><a href="#name-keyid-parameter-value-could" class="section-name selfRef">keyId parameter value could break list syntax</a>
          </h3>
<p id="section-b.1.13-1">The <code>keyId</code> parameter value needs to be constrained so as to not break list syntax (e.g., by containing a comma).<a href="#section-b.1.13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="creation-time-and-expiration-time-do-not-allow-for-clock-skew">
<section id="section-b.1.14">
          <h3 id="name-creation-time-and-expiratio">
<a href="#section-b.1.14" class="section-number selfRef">B.1.14. </a><a href="#name-creation-time-and-expiratio" class="section-name selfRef">Creation Time and Expiration Time do not allow for clock skew</a>
          </h3>
<p id="section-b.1.14-1">The processing instructions for Creation Time and Expiration Time imply that verifiers are not permitted to account for clock skew during signature verification.<a href="#section-b.1.14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="should-require-lowercased-header-field-names-as-identifiers">
<section id="section-b.1.15">
          <h3 id="name-should-require-lowercased-h">
<a href="#section-b.1.15" class="section-number selfRef">B.1.15. </a><a href="#name-should-require-lowercased-h" class="section-name selfRef">Should require lowercased header field names as identifiers</a>
          </h3>
<p id="section-b.1.15-1">The current text allows mixed-case header field names when they are being used as content identifiers.  This is unnecessary, as header field names are case-insensitive, and creates opportunity for incompatibility.  Instead, content identifiers should always be lowercase.<a href="#section-b.1.15-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reconcile-date-header-and-creation-time">
<section id="section-b.1.16">
          <h3 id="name-reconcile-date-header-and-c">
<a href="#section-b.1.16" class="section-number selfRef">B.1.16. </a><a href="#name-reconcile-date-header-and-c" class="section-name selfRef">Reconcile Date header and Creation Time</a>
          </h3>
<p id="section-b.1.16-1">The draft is missing guidance on if/how the Date header relates to signature Creation Time.  There are cases where they may be different, such as if a signature was pre-created.  Should Creation Time default to the value in the Date header if the <code>created</code> parameter is not specified?<a href="#section-b.1.16-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="remove-algorithm-specific-rules-for-content-identifiers">
<section id="section-b.1.17">
          <h3 id="name-remove-algorithm-specific-r">
<a href="#section-b.1.17" class="section-number selfRef">B.1.17. </a><a href="#name-remove-algorithm-specific-r" class="section-name selfRef">Remove algorithm-specific rules for content identifiers</a>
          </h3>
<p id="section-b.1.17-1">The rules that restrict when the signer can or must include certain identifiers appear to be related to the pseudo-revving of the Cavage draft that happened when the <code>hs2019</code> algorithm was introduced.  We should drop these rules, as it can be expected that anyone implementing this draft will support all content identifiers.<a href="#section-b.1.17-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="add-guidance-for-signing-compressed-headers">
<section id="section-b.1.18">
          <h3 id="name-add-guidance-for-signing-co">
<a href="#section-b.1.18" class="section-number selfRef">B.1.18. </a><a href="#name-add-guidance-for-signing-co" class="section-name selfRef">Add guidance for signing compressed headers</a>
          </h3>
<p id="section-b.1.18-1">The draft should provide guidance on how to sign headers when <span>[<a href="#RFC7541" class="xref">RFC7541</a>]</span> is used.  This guidance might be as simple as "sign the uncompressed header field value."<a href="#section-b.1.18-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transformations-to-via-header-field-value-break-verification">
<section id="section-b.1.19">
          <h3 id="name-transformations-to-via-head">
<a href="#section-b.1.19" class="section-number selfRef">B.1.19. </a><a href="#name-transformations-to-via-head" class="section-name selfRef">Transformations to Via header field value break verification</a>
          </h3>
<p id="section-b.1.19-1">Intermediaries are permitted to strip comments from the <code>Via</code> header field value, and consolidate related sequences of entries.  The canonicalization rules do not account for these changes, and thus they cause signature verification to fail if the <code>Via</code> header is signed. At the very least, guidance on signing or not signing <code>Via</code> headers needs to be included.<a href="#section-b.1.19-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="case-changes-to-case-insensitive-header-field-values-break-verification">
<section id="section-b.1.20">
          <h3 id="name-case-changes-to-case-insens">
<a href="#section-b.1.20" class="section-number selfRef">B.1.20. </a><a href="#name-case-changes-to-case-insens" class="section-name selfRef">Case changes to case-insensitive header field values break verification</a>
          </h3>
<p id="section-b.1.20-1">Some header field values are case-insensitive, in whole or in part. The canonicalization rules do not account for this, thus a case change to a covered header field value causes verification to fail.<a href="#section-b.1.20-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="need-more-examples-for-signature-header">
<section id="section-b.1.21">
          <h3 id="name-need-more-examples-for-sign">
<a href="#section-b.1.21" class="section-number selfRef">B.1.21. </a><a href="#name-need-more-examples-for-sign" class="section-name selfRef">Need more examples for Signature header</a>
          </h3>
<p id="section-b.1.21-1">Add more examples showing different cases e.g, where <code>created</code> or <code>expires</code> are not present.<a href="#section-b.1.21-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="expiration-not-needed">
<section id="section-b.1.22">
          <h3 id="name-expiration-not-needed">
<a href="#section-b.1.22" class="section-number selfRef">B.1.22. </a><a href="#name-expiration-not-needed" class="section-name selfRef">Expiration not needed</a>
          </h3>
<p id="section-b.1.22-1">In many cases, putting the expiration of the signature into the hands of the signer opens up more options for failures than necessary.  Instead of the <code>expires</code>, any verifier can use the <code>created</code> field and an internal lifetime or offset to calculate expiration.  We should consider dropping the <code>expires</code> field.<a href="#section-b.1.22-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="features">
<section id="section-b.2">
        <h2 id="name-features">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-features" class="section-name selfRef">Features</a>
        </h2>
<div id="define-more-content-identifiers">
<section id="section-b.2.1">
          <h3 id="name-define-more-content-identif">
<a href="#section-b.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-define-more-content-identif" class="section-name selfRef">Define more content identifiers</a>
          </h3>
<p id="section-b.2.1-1">It should be possible to independently include the following content and metadata properties in Covered Content:<a href="#section-b.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.1-2.1">The signature's Algorithm<a href="#section-b.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-b.2.1-2.2">The signature's Covered Content<a href="#section-b.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-b.2.1-2.3">The value used for the <code>keyId</code> parameter<a href="#section-b.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-b.2.1-2.4">Request method<a href="#section-b.2.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-b.2.1-2.5">Individual components of the effective request URI: scheme, authority, path, query<a href="#section-b.2.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-b.2.1-2.6">Status code<a href="#section-b.2.1-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-b.2.1-2.7">Request body (currently supported via Digest header <span>[<a href="#RFC3230" class="xref">RFC3230</a>]</span>  )<a href="#section-b.2.1-2.7" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="multiple-signature-support">
<section id="section-b.2.2">
          <h3 id="name-multiple-signature-support">
<a href="#section-b.2.2" class="section-number selfRef">B.2.2. </a><a href="#name-multiple-signature-support" class="section-name selfRef">Multiple signature support</a>
          </h3>
<p id="section-b.2.2-1">(( Editor's note: I believe this use case is theoretical.  Please let me know if this is a use case you have. ))<a href="#section-b.2.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2.2-2">There may be scenarios where attaching multiple signatures to a single message is useful:<a href="#section-b.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2.2-3.1">A gateway attaches a signature over headers it adds (e.g., <code>Forwarded</code>) to messages already signed by the user agent.<a href="#section-b.2.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-b.2.2-3.2">A signer attaches two signatures signed by different keys, to be verified by different entities.<a href="#section-b.2.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-b.2.2-4">This could be addressed by changing the Signature header syntax to accept a list of parameter sets for a single signature, e.g., by separating parameters with <code>";"</code> instead of <code>","</code>.  It may also be necessary to include a signature identifier parameter.<a href="#section-b.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="support-for-incremental-signing-of-header-field-value-list-items">
<section id="section-b.2.3">
          <h3 id="name-support-for-incremental-sig">
<a href="#section-b.2.3" class="section-number selfRef">B.2.3. </a><a href="#name-support-for-incremental-sig" class="section-name selfRef">Support for incremental signing of header field value list items</a>
          </h3>
<p id="section-b.2.3-1">(( Editor's note: I believe this use case is theoretical.  Please let me know if this is a use case you have. ))<a href="#section-b.2.3-1" class="pilcrow">¶</a></p>
<p id="section-b.2.3-2">Currently, signing a header field value is all-or-nothing: either the entire value is signed, or none of it is.  For header fields that use list syntax, it would be useful to be able to specify which items in the list are signed.<a href="#section-b.2.3-2" class="pilcrow">¶</a></p>
<p id="section-b.2.3-3">A simple approach that allowed the signer to indicate the list size at signing time would allow a signer to sign header fields that are may be appended to by intermediaries as the message makes its way to the recipient.  Specifying list size in terms of number of items could introduce risks of list syntax is not strictly adhered to (e.g., a malicious party crafts a value that gets parsed by the application as 5 items, but by the verifier as 4).  Specifying list size in number of octets might address this, but more exploration is required.<a href="#section-b.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="support-expected-authority-changes">
<section id="section-b.2.4">
          <h3 id="name-support-expected-authority-">
<a href="#section-b.2.4" class="section-number selfRef">B.2.4. </a><a href="#name-support-expected-authority-" class="section-name selfRef">Support expected authority changes</a>
          </h3>
<p id="section-b.2.4-1">In some cases, the authority of the effective request URI may be expected to change, for example from "public-service-name.example.com" to "service-host-1.public-service-name.example.com".  This is commonly the case for services that are hosted behind a load-balancing gateway, where the client sends requests to a publicly known domain name for the service, and these requests are transformed by the gateway into requests to specific hosts in the service fleet.<a href="#section-b.2.4-1" class="pilcrow">¶</a></p>
<p id="section-b.2.4-2">One possible way to handle this would be to special-case the Host header field to allow verifier to substitute a known expected value, or a value provided in another header field (e.g., <code>Via</code>) when generating the Signature Input, provided that the verifier also recognizes the real value in the <code>Host</code> header.  Alternatively, this logic could apply to an <code>(audience)</code> content identifier.<a href="#section-b.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="support-for-signing-specific-cookies">
<section id="section-b.2.5">
          <h3 id="name-support-for-signing-specifi">
<a href="#section-b.2.5" class="section-number selfRef">B.2.5. </a><a href="#name-support-for-signing-specifi" class="section-name selfRef">Support for signing specific cookies</a>
          </h3>
<p id="section-b.2.5-1">A signer may only wish to sign one or a few cookies, for example if the website requires its authentication state cookie to be signed, but also sets other cookies (e.g., for analytics, ad tracking, etc.)<a href="#section-b.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.c">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.c-1">This specification is based on the draft-cavage-http-signatures draft.  The editor would like to thank the authors of that draft, Mark Cavage and Manu Sporny, for their work on that draft and their continuing contributions.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">The editor would also like to thank the following individuals for feedback on and implementations of the draft-cavage-http-signatures draft (in alphabetical order):
Mark Adamcin,
Mark Allen,
Paul Annesley,
Karl Boehlmark,
Stephane Bortzmeyer,
Sarven Capadisli,
Liam Dennehy,
ductm54,
Stephen Farrell,
Phillip Hallam-Baker,
Eric Holmes,
Andrey Kislyuk,
Adam Knight,
Dave Lehn,
Dave Longley,
James H. Manger,
Ilari Liusvaara,
Mark Nottingham,
Yoav Nir,
Adrian Palmer,
Lucas Pardue,
Roberto Polli,
Julian Reschke,
Michael Richardson,
Wojciech Rygielski,
Adam Scarr,
Cory J. Slep,
Dirk Stein,
Henry Story,
Lukasz Szewc,
Chris Webber, and
Jeffrey Yasskin<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="section-appendix.d">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="section-appendix.d-1"><em>RFC EDITOR: please remove this section before publication</em><a href="#section-appendix.d-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1">
          <p id="section-appendix.d-2.1.1">draft-ietf-httpbis-message-signatures<a href="#section-appendix.d-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.1">
              <p id="section-appendix.d-2.1.2.1.1">Since -01<a href="#section-appendix.d-2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.1.2.1">Replaced unstructured <code>Signature</code> header with <code>Signature-Input</code> and <code>Signature</code> Dictionary Structured Header Fields.<a href="#section-appendix.d-2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.1.2.2">Defined content identifiers for individual Dictionary members, e.g., <code>x-dictionary-field:member-name</code>.<a href="#section-appendix.d-2.1.2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.1.2.3">Defined content identifiers for first N members of a List, e.g., <code>x-list-field:4</code>.<a href="#section-appendix.d-2.1.2.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.1.2.4">Fixed up examples.<a href="#section-appendix.d-2.1.2.1.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.1.2.5">Updated introduction now that it's adopted.<a href="#section-appendix.d-2.1.2.1.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-appendix.d-2.1.2.2">
              <p id="section-appendix.d-2.1.2.2.1">-01<a href="#section-appendix.d-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.2.2.1">Strengthened requirement for content identifiers for header fields to be lower-case (changed from SHOULD to MUST).<a href="#section-appendix.d-2.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.2.2.2">Added real example values for Creation Time and Expiration Time.<a href="#section-appendix.d-2.1.2.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.2.2.3">Minor editorial corrections and readability improvements.<a href="#section-appendix.d-2.1.2.2.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-appendix.d-2.1.2.3">
              <p id="section-appendix.d-2.1.2.3.1">-00<a href="#section-appendix.d-2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.3.2.1">Initialized from draft-richanna-http-message-signatures-00, following adoption by the working group.<a href="#section-appendix.d-2.1.2.3.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
        <li class="normal" id="section-appendix.d-2.2">
          <p id="section-appendix.d-2.2.1">draft-richanna-http-message-signatures<a href="#section-appendix.d-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.2.2.1">
              <p id="section-appendix.d-2.2.2.1.1">-00<a href="#section-appendix.d-2.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.2.2.1.2.1">Converted to xml2rfc v3 and reformatted to comply with RFC style guides.<a href="#section-appendix.d-2.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.2">Removed Signature auth-scheme definition and related content.<a href="#section-appendix.d-2.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.3">Removed conflicting normative requirements for use of algorithm parameter. Now MUST NOT be relied upon.<a href="#section-appendix.d-2.2.2.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.4">Removed Extensions appendix.<a href="#section-appendix.d-2.2.2.1.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.5">Rewrote abstract and introduction to explain context and need, and challenges inherent in signing HTTP messages.<a href="#section-appendix.d-2.2.2.1.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.6">Rewrote and heavily expanded algorithm definition, retaining normative requirements.<a href="#section-appendix.d-2.2.2.1.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.7">Added definitions for key terms, referenced RFC 7230 for HTTP terms.<a href="#section-appendix.d-2.2.2.1.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.8">Added examples for canonicalization and signature generation steps.<a href="#section-appendix.d-2.2.2.1.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.9">Rewrote Signature header definition, retaining normative requirements.<a href="#section-appendix.d-2.2.2.1.2.9" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.10">Added default values for algorithm and expires parameters.<a href="#section-appendix.d-2.2.2.1.2.10" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.11">Rewrote HTTP Signature Algorithms registry definition. Added change control policy and registry template. Removed suggested URI.<a href="#section-appendix.d-2.2.2.1.2.11" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.12">Added IANA HTTP Signature Parameter registry.<a href="#section-appendix.d-2.2.2.1.2.12" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.13">Added additional normative and informative references.<a href="#section-appendix.d-2.2.2.1.2.13" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.14">Added Topics for Working Group Discussion section, to be removed prior to publication as an RFC.<a href="#section-appendix.d-2.2.2.1.2.14" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.e">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Annabelle Backman (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div dir="auto" class="left"><span class="street-address">P.O. Box 81226</span></div>
<div dir="auto" class="left">
<span class="locality">Seattle</span>, <span class="region">WA</span> <span class="postal-code">98108-1226</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:richanna@amazon.com" class="email">richanna@amazon.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.amazon.com/" class="url">https://www.amazon.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Justin Richer</span></div>
<div dir="auto" class="left"><span class="org">Bespoke Engineering</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@justin.richer.org" class="email">ietf@justin.richer.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://bspk.io/" class="url">https://bspk.io/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Manu Sporny</span></div>
<div dir="auto" class="left"><span class="org">Digital Bazaar</span></div>
<div dir="auto" class="left"><span class="street-address">203 Roanoke Street W.</span></div>
<div dir="auto" class="left">
<span class="locality">Blacksburg</span>, <span class="region">VA</span> <span class="postal-code">24060</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:msporny@digitalbazaar.com" class="email">msporny@digitalbazaar.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://manu.sporny.org/" class="url">https://manu.sporny.org/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
