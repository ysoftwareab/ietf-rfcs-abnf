<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Oblivious Pseudorandom Functions (OPRFs) using Prime-Order Groups</title>
<meta content="Alex Davidson" name="author">
<meta content="Armando Faz-Hernandez" name="author">
<meta content="Nick Sullivan" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       An Oblivious Pseudorandom Function (OPRF) is a two-party protocol for
computing the output of a PRF. One party (the server) holds the PRF
secret key, and the other (the client) holds the PRF input. The
'obliviousness' property ensures that the server does not learn anything
about the client's input during the evaluation. The client should also
not learn anything about the server's secret PRF key. Optionally, OPRFs
can also satisfy a notion 'verifiability' (VOPRF). In this setting, the
client can verify that the server's output is indeed the result of
evaluating the underlying PRF with just a public key. This document
specifies OPRF and VOPRF constructions instantiated within prime-order
groups, including elliptic curves. 
    " name="description">
<meta content="xml2rfc 3.3.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-irtf-cfrg-voprf-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.3.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.24.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/draft-irtf-cfrg-voprf-05-zgx1ofco.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OPRFs</td>
<td class="right">November 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Davidson, et al.</td>
<td class="center">Expires 6 May 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-voprf-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-11-02" class="published">2 November 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-05-06">6 May 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Davidson</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">A. Faz-Hernandez</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">N. Sullivan</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">C.A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Oblivious Pseudorandom Functions (OPRFs) using Prime-Order Groups</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">An Oblivious Pseudorandom Function (OPRF) is a two-party protocol for
computing the output of a PRF. One party (the server) holds the PRF
secret key, and the other (the client) holds the PRF input. The
'obliviousness' property ensures that the server does not learn anything
about the client's input during the evaluation. The client should also
not learn anything about the server's secret PRF key. Optionally, OPRFs
can also satisfy a notion 'verifiability' (VOPRF). In this setting, the
client can verify that the server's output is indeed the result of
evaluating the underlying PRF with just a public key. This document
specifies OPRF and VOPRF constructions instantiated within prime-order
groups, including elliptic curves.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/cfrg/draft-irtf-cfrg-voprf">https://github.com/cfrg/draft-irtf-cfrg-voprf</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 May 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-change-log" class="xref">Change log</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-requirements" class="xref">Requirements</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-preliminaries" class="xref">Preliminaries</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-prime-order-group-api" class="xref">Prime-order group API</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-other-conventions" class="xref">Other conventions</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-oprf-protocol" class="xref">OPRF Protocol</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-context-setup" class="xref">Context Setup</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-data-structures" class="xref">Data Structures</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-context-apis" class="xref">Context APIs</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-server-context" class="xref">Server Context</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-verifiableservercontext" class="xref">VerifiableServerContext</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-client-context" class="xref">Client Context</a><a href="#section-toc.1-1.3.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="xref">3.4.4</a>.  <a href="#name-verifiableclientcontext" class="xref">VerifiableClientContext</a><a href="#section-toc.1-1.3.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-ciphersuites" class="xref">Ciphersuites</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-oprfristretto255-sha-256" class="xref">OPRF(ristretto255, SHA-256)</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-oprfdecaf448-sha-512" class="xref">OPRF(decaf448, SHA-512)</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-oprfp-256-sha-256" class="xref">OPRF(P-256, SHA-256)</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-oprfp-384-sha-512" class="xref">OPRF(P-384, SHA-512)</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-oprfp-521-sha-512" class="xref">OPRF(P-521, SHA-512)</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-security-properties" class="xref">Security properties</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-cryptographic-security" class="xref">Cryptographic security</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-computational-hardness-assu" class="xref">Computational hardness assumptions</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-protocol-security" class="xref">Protocol security</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-q-strong-dh-oracle" class="xref">Q-strong-DH oracle</a><a href="#section-toc.1-1.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="xref">5.2.4</a>.  <a href="#name-implications-for-ciphersuit" class="xref">Implications for ciphersuite choices</a><a href="#section-toc.1-1.5.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-hashing-to-curve" class="xref">Hashing to curve</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-timing-leaks" class="xref">Timing Leaks</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-key-rotation" class="xref">Key rotation</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-additive-blinding" class="xref">Additive blinding</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-preprocess" class="xref">Preprocess</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-blind-2" class="xref">Blind</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-unblind-3" class="xref">Unblind</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-parameter-commitments" class="xref">Parameter Commitments</a><a href="#section-toc.1-1.6.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-contributors" class="xref">Contributors</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A pseudorandom function (PRF) F(k, x) is an efficiently computable
function taking a private key k and a value x as input. This function is
pseudorandom if the keyed function K(_) = F(K, _) is indistinguishable
from a randomly sampled function acting on the same domain and range as
K(). An oblivious PRF (OPRF) is a two-party protocol between a server
and a client, where the server holds a PRF key k and the client holds
some input x. The protocol allows both parties to cooperate in computing
F(k, x) such that: the client learns F(k, x) without learning anything
about k; and the server does not learn anything about x or F(k, x).
A Verifiable OPRF (VOPRF) is an OPRF wherein the server can prove to the
client that F(k, x) was computed using the key k.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The usage of OPRFs has been demonstrated in constructing a number of
applications: password-protected secret sharing schemes <span>[<a href="#JKKX16" class="xref">JKKX16</a>]</span>;
privacy-preserving password stores <span>[<a href="#SJKS17" class="xref">SJKS17</a>]</span>; and
password-authenticated key exchange or PAKE <span>[<a href="#I-D.irtf-cfrg-opaque" class="xref">I-D.irtf-cfrg-opaque</a>]</span>. A VOPRF is
necessary in some applications, e.g., the Privacy Pass protocol
<span>[<a href="#I-D.davidson-pp-protocol" class="xref">I-D.davidson-pp-protocol</a>]</span>, wherein this VOPRF is used to generate
one-time authentication tokens to bypass CAPTCHA challenges. VOPRFs have
also been used for password-protected secret sharing schemes e.g.
<span>[<a href="#JKK14" class="xref">JKK14</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document introduces an OPRF protocol built in prime-order groups,
applying to finite fields of prime-order and also elliptic curve (EC)
groups. The protocol has the option of being extended to a VOPRF with
the addition of a NIZK proof for proving discrete log equality
relations. This proof demonstrates correctness of the computation, using
a known public key that serves as a commitment to the server's secret
key. The document describes the protocol, the public-facing API, and its
security properties.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="change-log">
<section id="section-1.1">
        <h3 id="name-change-log">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-change-log" class="section-name selfRef">Change log</a>
        </h3>
<p id="section-1.1-1"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-05">draft-05</a>:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">Move to ristretto255 and decaf448 ciphersuites.<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">Clean up ciphersuite definitions.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">Pin domain separation tag construction to draft version.<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.4">Move key generation outside of context construction functions.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.5">Editorial changes.<a href="#section-1.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-3"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-04">draft-04</a>:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">Introduce Client and Server contexts for controlling verifiability and
required functionality.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">Condense API.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">Remove batching from standard functionality (included as an extension)<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.4">Add Curve25519 and P-256 ciphersuites for applications that prevent
strong-DH oracle attacks.<a href="#section-1.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.5">Provide explicit prime-order group API and instantiation advice for
each ciphersuite.<a href="#section-1.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.6">Proof-of-concept implementation in sage.<a href="#section-1.1-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.7">Remove privacy considerations advice as this depends on applications.<a href="#section-1.1-4.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-03">draft-03</a>:<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-6.1">Certify public key during VerifiableFinalize<a href="#section-1.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.2">Remove protocol integration advice<a href="#section-1.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.3">Add text discussing how to perform domain separation<a href="#section-1.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.4">Drop OPRF_/VOPRF_ prefix from algorithm names<a href="#section-1.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.5">Make prime-order group assumption explicit<a href="#section-1.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.6">Changes to algorithms accepting batched inputs<a href="#section-1.1-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.7">Changes to construction of batched DLEQ proofs<a href="#section-1.1-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.8">Updated ciphersuites to be consistent with hash-to-curve and added
OPRF specific ciphersuites<a href="#section-1.1-6.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-7"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-02">draft-02</a>:<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-8.1">Added section discussing cryptographic security and static DH oracles<a href="#section-1.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.2">Updated batched proof algorithms<a href="#section-1.1-8.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-9"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-01">draft-01</a>:<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-10.1">Updated ciphersuites to be in line with
https://tools.ietf.org/html/draft-irtf-cfrg-hash-to-curve-04<a href="#section-1.1-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.2">Made some necessary modular reductions more explicit<a href="#section-1.1-10.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">The following terms are used throughout this document.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">PRF: Pseudorandom Function.<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">OPRF: Oblivious Pseudorandom Function.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">VOPRF: Verifiable Oblivious Pseudorandom Function.<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.4">Client: Protocol initiator. Learns pseudorandom function evaluation as
the output of the protocol.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.5">Server: Computes the pseudorandom function over a secret key. Learns
nothing about the client's input.<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.6">NIZK: Non-interactive zero knowledge.<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.7">DLEQ: Discrete Logarithm Equality.<a href="#section-1.2-2.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="requirements">
<section id="section-1.3">
        <h3 id="name-requirements">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
        </h3>
<p id="section-1.3-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="preliminaries">
<section id="section-2">
      <h2 id="name-preliminaries">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-preliminaries" class="section-name selfRef">Preliminaries</a>
      </h2>
<div id="pog">
<section id="section-2.1">
        <h3 id="name-prime-order-group-api">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-prime-order-group-api" class="section-name selfRef">Prime-order group API</a>
        </h3>
<p id="section-2.1-1">In this document, we assume the construction of an additive, prime-order
group <code>GG</code> for performing all mathematical operations. Such groups are
uniquely determined by the choice of the prime <code>p</code> that defines the
order of the group. We use <code>GF(p)</code> to represent the finite field of
order <code>p</code>. For the purpose of understanding and implementing this
document, we take <code>GF(p)</code> to be equal to the set of integers defined by
<code>{0, 1, ..., p-1}</code>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The fundamental group operation is addition <code>+</code> with identity element
<code>I</code>. For any elements <code>A</code> and <code>B</code> of the group <code>GG</code>, <code>A + B = B + A</code> is
also a member of <code>GG</code>. Also, for any <code>A</code> in <code>GG</code>, there exists an element
<code>-A</code> such that <code>A + (-A) = (-A) + A = I</code>. Scalar multiplication is
equivalent to the repeated application of the group operation on an
element A with itself <code>r-1</code> times, this is denoted as <code>r*A = A + ... +
A</code>. For any element <code>A</code>, the equality <code>p*A=I</code> holds. Scalar base multiplication
is equivalent to the repeated application of the group operation on the
base point with itself <code>r-1</code> times, this is denoted as <code>ScalarBaseMult(r)</code>.
The set of scalars corresponds to <code>GF(p)</code>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">We now detail a number of member functions that can be invoked on a
prime-order group.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-4.1">Order(): Outputs the order of GG (i.e. <code>p</code>).<a href="#section-2.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.2">Identity(): Outputs the identity element of the group (i.e. <code>I</code>).<a href="#section-2.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.3">Serialize(A): A member function of <code>GG</code> that maps a group element <code>A</code>
to a unique byte array <code>buf</code>.<a href="#section-2.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.4">Deserialize(buf): A member function of <code>GG</code> that maps a byte array
<code>buf</code> to a group element <code>A</code>, or fails if the input is not a valid
byte representation of an element.<a href="#section-2.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.5">HashToGroup(x): A member function of <code>GG</code> that deterministically maps
an array of bytes <code>x</code> to an element of <code>GG</code>. The map must ensure that,
for any adversary receiving <code>R = HashToGroup(x)</code>, it is
computationally difficult to reverse the mapping. Examples of hash to
group functions satisfying this property are described for prime-order
(sub)groups of elliptic curves, see <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-2.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.6">HashToScalar(x): A member function of <code>GG</code> that deterministically maps
an array of bytes <code>x</code> to an element in GF(p). A recommended method
for its implementation is instantiating the hash to field function,
defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> setting the target field to GF(p).<a href="#section-2.1-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.7">RandomScalar(): A member function of <code>GG</code> that chooses at random a
non-zero element in GF(p).<a href="#section-2.1-4.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-5">It is convenient in cryptographic applications to instantiate such
prime-order groups using elliptic curves, such as those detailed in
<span>[<a href="#SEC2" class="xref">SEC2</a>]</span>. For some choices of elliptic curves (e.g. those detailed in
<span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, which require accounting for cofactors) there are some
implementation issues that introduce inherent discrepancies between
standard prime-order groups and the elliptic curve instantiation. In
this document, all algorithms that we detail assume that the group is a
prime-order group, and this MUST be upheld by any implementer. That is,
any curve instantiation should be written such that any discrepancies
with a prime-order group instantiation are removed. See <a href="#ciphersuites" class="xref">Section 4</a>
for advice corresponding to implementation of this interface for
specific definitions of elliptic curves.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-conventions">
<section id="section-2.2">
        <h3 id="name-other-conventions">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-other-conventions" class="section-name selfRef">Other conventions</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-2.2-1.1">We use the notation <code>x &lt;-$ Q</code> to denote sampling <code>x</code> from the uniform
distribution over the set <code>Q</code>.<a href="#section-2.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-1.2">For any object <code>x</code>, we write <code>len(x)</code> to denote its length in bytes.<a href="#section-2.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-1.3">For two byte arrays <code>x</code> and <code>y</code>, write <code>x || y</code> to denote their
concatenation.<a href="#section-2.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-1.4">I2OSP and OS2IP: Convert a byte array to and from a non-negative
integer as described in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>. Note that these functions
operate on byte arrays in big-endian byte order.<a href="#section-2.2-1.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-2">All algorithm descriptions are written in a Python-like pseudocode. We
use the <code>ABORT()</code> function for presentational clarity to denote the
process of terminating the algorithm or returning an error accordingly.
We also use the <code>CT_EQUAL(a, b)</code> function to represent constant-time
byte-wise equality between byte arrays <code>a</code> and <code>b</code>. This function
returns <code>true</code> if <code>a</code> and <code>b</code> are equal, and <code>false</code> otherwise.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol">
<section id="section-3">
      <h2 id="name-oprf-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-oprf-protocol" class="section-name selfRef">OPRF Protocol</a>
      </h2>
<p id="section-3-1">In this section, we define two OPRF variants: a base mode and verifiable
mode. In the base mode, a client and server interact to compute y =
F(skS, x), where x is the client's input, skS is the server's private
key, and y is the OPRF output. The client learns y and the server learns
nothing. In the verifiable mode, the client also gets proof that the
server used skS in computing the function.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">To achieve verifiability, as in the original work of <span>[<a href="#JKK14" class="xref">JKK14</a>]</span>, we
provide a zero-knowledge proof that the key provided as input by the
server in the <code>Evaluate</code> function is the same key as it used to produce
their public key. As an example of the nature of attacks that this
prevents, this ensures that the server uses the same private key for
computing the VOPRF output and does not attempt to "tag" individual
servers with select keys. This proof must not reveal the server's
long-term private key to the client.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The following one-byte values distinguish between these two modes:<a href="#section-3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Mode</th>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">modeBase</td>
            <td class="text-left" rowspan="1" colspan="1">0x00</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">modeVerifiable</td>
            <td class="text-left" rowspan="1" colspan="1">0x01</td>
          </tr>
        </tbody>
      </table>
<div id="overview">
<section id="section-3.1">
        <h3 id="name-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-3.1-1">Both participants agree on the mode and a choice of ciphersuite that is
used before the protocol exchange. Once established, the core protocol
runs to compute <code>output = F(skS, input)</code> as follows:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1-2">
<pre>
   Client(pkS, input, info)                 Server(skS, pkS)
  ----------------------------------------------------------
    token, blindToken = Blind(input)

                         blindToken
                        ----------&gt;

                         evaluation = Evaluate(skS, pkS, blindToken)

                         evaluation
                        &lt;----------

    issuedToken = Unblind(pkS, token, blindToken, evaluation)
    output = Finalize(input, issuedToken, info)
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">In <code>Blind</code> the client generates a token and blinding data. The server
computes the (V)OPRF evaluation in <code>Evaluation</code> over the client's
blinded token. In <code>Unblind</code> the client unblinds the server response (and
verifies the server's proof if verifiability is required). In
<code>Finalize</code>, the client produces a byte array corresponding to the output
of the OPRF protocol.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">Note that in the final output, the client computes Finalize over some
auxiliary input data <code>info</code>. This parameter SHOULD be used for domain
separation in the (V)OPRF protocol. Specifically, any system which has
multiple (V)OPRF applications should use separate auxiliary values to
ensure finalized outputs are separate. Guidance for constructing info
can be found in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>; Section 3.1.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="context-setup">
<section id="section-3.2">
        <h3 id="name-context-setup">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-context-setup" class="section-name selfRef">Context Setup</a>
        </h3>
<p id="section-3.2-1">Both modes of the OPRF involve an offline setup phase. In this phase,
both the client and server create a context used for executing the
online phase of the protocol. Prior to this phase, keys (<code>skS</code>, <code>pkS</code>)
should be generated by calling a <code>KeyGen</code> function. <code>KeyGen</code>
generates a private and public key pair (<code>skS</code>, <code>pkS</code>), where <code>skS</code> is a
non-zero element chosen at random from the scalar field of the
corresponding group and <code>pkS = ScalarBaseMult(skS)</code>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The base mode setup functions for creating client and server contexts are below:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-3">
<pre>
def SetupBaseServer(suite, skS):
  contextString = I2OSP(modeBase, 1) || I2OSP(suite.ID, 2)
  return ServerContext(contextString, skS)

def SetupBaseClient(suite):
  contextString = I2OSP(modeBase, 1) || I2OSP(suite.ID, 2)
  return ClientContext(contextString)
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">The verifiable mode setup functions for creating client and server
contexts are below:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-5">
<pre>
def SetupVerifiableServer(suite, skS, pkS):
  contextString = I2OSP(modeVerifiable, 1) || I2OSP(suite.ID, 2)
  return VerifiableServerContext(contextString, skS), pkS

def SetupVerifiableClient(suite, pkS):
  contextString = I2OSP(modeVerifiable, 1) || I2OSP(suite.ID, 2)
  return VerifiableClientContext(contextString, pkS)
</pre><a href="#section-3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.2-6">Each setup function takes a ciphersuite from the list defined in
<a href="#ciphersuites" class="xref">Section 4</a>. Each ciphersuite has a two-byte field ID used to
identify the suite.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="structs">
<section id="section-3.3">
        <h3 id="name-data-structures">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-data-structures" class="section-name selfRef">Data Structures</a>
        </h3>
<p id="section-3.3-1">The following is a list of data structures that are defined for
providing inputs and outputs for each of the context interfaces defined
in <a href="#api" class="xref">Section 3.4</a>. Each data structure description uses TLS notation
(see <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, Section 3).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The following types are a list of aliases that are used throughout the
protocol.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">A <code>ClientInput</code> is a byte array.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-4">
<pre>
opaque ClientInput&lt;1..2^16-1&gt;;
</pre><a href="#section-3.3-4" class="pilcrow">¶</a>
</div>
<p id="section-3.3-5">A <code>SerializedElement</code> is also a byte array, representing the unique
serialization of an <code>Element</code>.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-6">
<pre>
opaque SerializedElement&lt;1..2^16-1&gt;;
</pre><a href="#section-3.3-6" class="pilcrow">¶</a>
</div>
<p id="section-3.3-7">A <code>Token</code> is an object created by a client when constructing a (V)OPRF
protocol input. It is stored so that it can be used after receiving the
server response.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-8">
<pre>
struct {
  opaque data&lt;1..2^16-1&gt;;
  Scalar blind&lt;1..2^16-1&gt;;
} Token;
</pre><a href="#section-3.3-8" class="pilcrow">¶</a>
</div>
<p id="section-3.3-9">An <code>Evaluation</code> is the type output by the <code>Evaluate</code> algorithm. The
member <code>proof</code> is added only in verifiable contexts.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-10">
<pre>
struct {
  SerializedElement element;
  Scalar proof&lt;0...2^16-1&gt;; /* only for modeVerifiable */
} Evaluation;
</pre><a href="#section-3.3-10" class="pilcrow">¶</a>
</div>
<p id="section-3.3-11">Evaluations may also be combined in batches with a constant-size proof,
producing a <code>BatchedEvaluation</code>. These carry a list of
<code>SerializedElement</code> values and proof. These evaluation types are only
useful in verifiable contexts which carry proofs.<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-12">
<pre>
struct {
  SerializedElement elements&lt;1..2^16-1&gt;;
  Scalar proof&lt;0...2^16-1&gt;; /* only for modeVerifiable */
} BatchedEvaluation;
</pre><a href="#section-3.3-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="api">
<section id="section-3.4">
        <h3 id="name-context-apis">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-context-apis" class="section-name selfRef">Context APIs</a>
        </h3>
<p id="section-3.4-1">In this section, we detail the APIs available on the client and server
(V)OPRF contexts. This document uses the types <code>Element</code> and <code>Scalar</code> to
denote elements of the group <code>GG</code> and its underlying scalar field <code>GF(p)</code>,
respectively. For notational clarity, <code>PublicKey</code> is an item of type
<code>Element</code> and <code>PrivateKey</code> is an item of type <code>Scalar</code>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div id="server-context">
<section id="section-3.4.1">
          <h4 id="name-server-context">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-server-context" class="section-name selfRef">Server Context</a>
          </h4>
<p id="section-3.4.1-1">The ServerContext encapsulates the context string constructed during
setup and the (V)OPRF key pair. It has three functions, <code>Evaluate</code>,
<code>FullEvaluate</code> and <code>VerifyFinalize</code> described below. <code>Evaluate</code> takes
serialized representations of blinded group elements from the client as inputs.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2"><code>FullEvaluate</code> takes ClientInput values, and it is useful for applications
that need to compute the whole OPRF protocol on the server side only.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-3"><code>VerifyFinalize</code> takes ClientInput values and their corresponding output
digests from <code>Finalize</code> as input, and returns true if the inputs match the outputs.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
<p id="section-3.4.1-4">Note that <code>VerifyFinalize</code> and <code>FullEvaluate</code> are not used in the main OPRF
protocol. They are exposed as an API for building higher-level protocols.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<div id="evaluate">
<section id="section-3.4.1.1">
            <h5 id="name-evaluate">
<a href="#section-3.4.1.1" class="section-number selfRef">3.4.1.1. </a><a href="#name-evaluate" class="section-name selfRef">Evaluate</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.1.1-1">
<pre>
Input:

  PrivateKey skS
  SerializedElement blindToken

Output:

  Evaluation Ev

def Evaluate(skS, blindToken):
  BT = GG.Deserialize(blindToken)
  Z = skS * BT
  serializedElement = GG.Serialize(Z)

  Ev = Evaluation{ element: serializedElement }

  return Ev
</pre><a href="#section-3.4.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="fullevaluate">
<section id="section-3.4.1.2">
            <h5 id="name-fullevaluate">
<a href="#section-3.4.1.2" class="section-number selfRef">3.4.1.2. </a><a href="#name-fullevaluate" class="section-name selfRef">FullEvaluate</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.1.2-1">
<pre>
Input:

  PrivateKey skS
  ClientInput input
  opaque info&lt;1..2^16-1&gt;

Output:

  opaque output&lt;1..2^16-1&gt;

def FullEvaluate(skS, input, info):
  P = GG.HashToGroup(input)
  T = skS * P
  issuedToken = GG.serialize(T)

  finalizeDST = "VOPRF05-Finalize-" || self.contextString
  hashInput = I2OSP(len(input), 2) || input ||
              I2OSP(len(issuedToken), 2) || issuedToken ||
              I2OSP(len(info), 2) || info ||
              I2OSP(len(finalizeDST), 2) || finalizeDST

  return Hash(hashInput)
</pre><a href="#section-3.4.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verifyfinalize">
<section id="section-3.4.1.3">
            <h5 id="name-verifyfinalize">
<a href="#section-3.4.1.3" class="section-number selfRef">3.4.1.3. </a><a href="#name-verifyfinalize" class="section-name selfRef">VerifyFinalize</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.1.3-1">
<pre>
Input:

  PrivateKey skS
  ClientInput input
  opaque info&lt;1..2^16-1&gt;
  opaque output&lt;1..2^16-1&gt;

Output:

  boolean valid

def VerifyFinalize(skS, input, info, output):
  T = GG.HashToGroup(input)
  element = GG.Serialize(T)
  issuedElement = Evaluate(skS, [element])
  E = GG.Serialize(issuedElement)

  finalizeDST = "VOPRF05-Finalize-" || self.contextString
  hashInput = I2OSP(len(input), 2) || input ||
              I2OSP(len(E), 2) || E ||
              I2OSP(len(info), 2) || info ||
              I2OSP(len(finalizeDST), 2) || finalizeDST

  digest = Hash(hashInput)

  return CT_EQUAL(digest, output)
</pre><a href="#section-3.4.1.3-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1.3-2">[[RFC editor: please change "VOPRF05" to "RFCXXXX", where XXXX is the final number, here and elsewhere before publication.]]<a href="#section-3.4.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verifiableservercontext">
<section id="section-3.4.2">
          <h4 id="name-verifiableservercontext">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-verifiableservercontext" class="section-name selfRef">VerifiableServerContext</a>
          </h4>
<p id="section-3.4.2-1">The VerifiableServerContext extends the base ServerContext with an
augmented <code>Evaluate()</code> function. This function produces a proof that
<code>skS</code> was used in computing the result. It makes use of the helper
functions <code>GenerateProof</code> and <code>ComputeComposites</code>, described below.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<div id="evaluate-1">
<section id="section-3.4.2.1">
            <h5 id="name-evaluate-2">
<a href="#section-3.4.2.1" class="section-number selfRef">3.4.2.1. </a><a href="#name-evaluate-2" class="section-name selfRef">Evaluate</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.2.1-1">
<pre>
Input:

  PrivateKey skS
  PublicKey pkS
  SerializedElement blindToken

Output:

  Evaluation Ev

def Evaluate(skS, pkS, blindToken):
  BT = GG.Deserialize(blindToken)
  Z = skS * BT
  serializedElement = GG.Serialize(Z)

  proof = GenerateProof(skS, pkS, blindToken, serializedElement)
  Ev = Evaluation{ element: serializedElement, proof: proof }

  return Ev
</pre><a href="#section-3.4.2.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4.2.1-2">The helper functions <code>GenerateProof</code> and <code>ComputeComposites</code> are defined
below.<a href="#section-3.4.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generateproof">
<section id="section-3.4.2.2">
            <h5 id="name-generateproof">
<a href="#section-3.4.2.2" class="section-number selfRef">3.4.2.2. </a><a href="#name-generateproof" class="section-name selfRef">GenerateProof</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.2.2-1">
<pre>
Input:

  PrivateKey skS
  PublicKey pkS
  SerializedElement blindToken
  SerializedElement element

Output:

  Scalar proof[2]

def GenerateProof(skS, pkS, blindToken, element)
  blindTokenList = [blindToken]
  elementList = [element]

  a = ComputeComposites(pkS, blindTokenList, elementList)

  M = GG.Deserialize(a[0])
  r = GG.RandomScalar()
  a2 = GG.Serialize(ScalarBaseMult(r))
  a3 = GG.Serialize(r * M)

  challengeDST = "VOPRF05-challenge-" || self.contextString
  h2Input = I2OSP(len(pkS), 2) || pkS ||
            I2OSP(len(a[0]), 2) || a[0] ||
            I2OSP(len(a[1]), 2) || a[1] ||
            I2OSP(len(a2), 2) || a2 ||
            I2OSP(len(a3), 2) || a3 ||
            I2OSP(len(challengeDST), 2) || challengeDST

  c = GG.HashToScalar(h2Input)
  s = (r - c * skS) mod p

  return [c, s]
</pre><a href="#section-3.4.2.2-1" class="pilcrow">¶</a>
</div>
<div id="batching-inputs">
<section id="section-3.4.2.2.1">
              <h6 id="name-batching-inputs">
<a href="#section-3.4.2.2.1" class="section-number selfRef">3.4.2.2.1. </a><a href="#name-batching-inputs" class="section-name selfRef">Batching inputs</a>
              </h6>
<p id="section-3.4.2.2.1-1">Unlike other functions, <code>ComputeComposites</code> takes lists of inputs,
rather than a single input. It is optimized to produce a constant-size
output. This functionality lets applications batch inputs together to
produce a constant-size proofs from <code>GenerateProof</code>. Applications can
take advantage of this functionality by invoking <code>GenerateProof</code> on
batches of inputs. (Notice that in the pseudocode above, the single
inputs <code>blindToken</code> and <code>element</code> are translated into lists before
invoking <code>ComputeComposites</code>. A batched <code>GenerateProof</code> variant would
permit lists of inputs, and no list translation would be needed.)<a href="#section-3.4.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2.2.1-2">Note that using batched inputs creates a <code>BatchedEvaluation</code> object as
the output of <code>Evaluate</code>.<a href="#section-3.4.2.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fresh-randomness">
<section id="section-3.4.2.2.2">
              <h6 id="name-fresh-randomness">
<a href="#section-3.4.2.2.2" class="section-number selfRef">3.4.2.2.2. </a><a href="#name-fresh-randomness" class="section-name selfRef">Fresh randomness</a>
              </h6>
<p id="section-3.4.2.2.2-1">We note here that it is essential that a different <code>r</code> value is used for
every invocation. If this is not done, then this may leak <code>skS</code> as is
possible in Schnorr or (EC)DSA scenarios where fresh randomness is not
used.<a href="#section-3.4.2.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="computecomposites">
<section id="section-3.4.2.3">
            <h5 id="name-computecomposites">
<a href="#section-3.4.2.3" class="section-number selfRef">3.4.2.3. </a><a href="#name-computecomposites" class="section-name selfRef">ComputeComposites</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.2.3-1">
<pre>
Input:

  PublicKey pkS
  SerializedElement blindTokens[m]
  SerializedElement elements[m]

Output:

  SerializedElement composites[2]

def ComputeComposites(pkS, blindTokens, elements):
  seedDST = "VOPRF05-seed-" || self.contextString
  compositeDST = "VOPRF05-composite-" || self.contextString
  h1Input = I2OSP(len(pkS), 2) || pkS ||
            I2OSP(len(blindTokens), 2) || blindTokens ||
            I2OSP(len(elements), 2) || elements ||
            I2OSP(len(seedDST), 2) || seedDST

  seed = Hash(h1Input)
  M = GG.Identity()
  Z = GG.Identity()
  for i = 0 to m-1:
    h2Input = I2OSP(len(seed), 2) || seed || I2OSP(i, 2) ||
              I2OSP(len(compositeDST), 2) || compositeDST
    di = GG.HashToScalar(h2Input)
    Mi = GG.Deserialize(blindTokens[i])
    Zi = GG.Deserialize(elements[i])
    M = di * Mi + M
    Z = di * Zi + Z
 return [GG.Serialize(M), GG.Serialize(Z)]
</pre><a href="#section-3.4.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="client-context">
<section id="section-3.4.3">
          <h4 id="name-client-context">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-client-context" class="section-name selfRef">Client Context</a>
          </h4>
<p id="section-3.4.3-1">The ClientContext encapsulates the context string constructed during
setup. It has three functions, <code>Blind()</code>, <code>Unblind()</code>, and <code>Finalize()</code>,
as described below.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<div id="blind">
<section id="section-3.4.3.1">
            <h5 id="name-blind">
<a href="#section-3.4.3.1" class="section-number selfRef">3.4.3.1. </a><a href="#name-blind" class="section-name selfRef">Blind</a>
            </h5>
<p id="section-3.4.3.1-1">We note here that the blinding mechanism that we use can be modified
slightly with the opportunity for making performance gains in some
scenarios. We detail these modifications in <a href="#blinding" class="xref">Section 6</a>.<a href="#section-3.4.3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.3.1-2">
<pre>
Input:

  ClientInput input

Output:

  Token token
  SerializedElement blindToken

def Blind(input):
  r = GG.RandomScalar()
  P = GG.HashToGroup(input)
  blindToken = GG.Serialize(r * P)

  token = Token{ data: input, blind: r }

  return (token, blindToken)
</pre><a href="#section-3.4.3.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="unblind">
<section id="section-3.4.3.2">
            <h5 id="name-unblind">
<a href="#section-3.4.3.2" class="section-number selfRef">3.4.3.2. </a><a href="#name-unblind" class="section-name selfRef">Unblind</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.3.2-1">
<pre>
Input:

  Token token
  Evaluation Ev

Output:

  SerializedElement issuedToken

def Unblind(token, Ev):
  r = token.blind
  Z = GG.Deserialize(Ev.element)
  N = (r^(-1)) * Z

  issuedToken = GG.Serialize(N)

  return issuedToken
</pre><a href="#section-3.4.3.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="finalize">
<section id="section-3.4.3.3">
            <h5 id="name-finalize">
<a href="#section-3.4.3.3" class="section-number selfRef">3.4.3.3. </a><a href="#name-finalize" class="section-name selfRef">Finalize</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.3.3-1">
<pre>
Input:

  Token token
  SerializedElement issuedToken
  opaque info&lt;1..2^16-1&gt;

Output:

  opaque output&lt;1..2^16-1&gt;

def Finalize(token, issuedToken, info):
  finalizeDST = "VOPRF05-Finalize-" || self.contextString
  hashInput = I2OSP(len(token.data), 2) || token.data ||
              I2OSP(len(issuedToken), 2) || issuedToken ||
              I2OSP(len(info), 2) || info ||
              I2OSP(len(finalizeDST), 2) || finalizeDST
  return Hash(hashInput)
</pre><a href="#section-3.4.3.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verifiable-client">
<section id="section-3.4.4">
          <h4 id="name-verifiableclientcontext">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-verifiableclientcontext" class="section-name selfRef">VerifiableClientContext</a>
          </h4>
<p id="section-3.4.4-1">The VerifiableClientContext extends the base ClientContext with the
desired server public key <code>pkS</code> with an augmented <code>Unblind()</code> function.
This function verifies an evaluation proof using <code>pkS</code>. It makes use of
the helper function <code>ComputeComposites</code> described above. It has one
helper function, <code>VerifyProof()</code>, defined below.<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<div id="verifyproof">
<section id="section-3.4.4.1">
            <h5 id="name-verifyproof">
<a href="#section-3.4.4.1" class="section-number selfRef">3.4.4.1. </a><a href="#name-verifyproof" class="section-name selfRef">VerifyProof</a>
            </h5>
<p id="section-3.4.4.1-1">This algorithm outputs a boolean <code>verified</code> which indicates whether the
proof inside of the evaluation verifies correctly, or not.<a href="#section-3.4.4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.4.1-2">
<pre>
Input:

  PublicKey pkS
  SerializedElement blindToken
  Evaluation Ev

Output:

  boolean verified

def VerifyProof(pkS, blindToken, Ev):
  blindTokenList = [blindToken]
  elementList = [Ev.element]

  a = ComputeComposites(pkS, blindTokenList, elementList)

  A' = (ScalarBaseMult(Ev.proof[1]) + Ev.proof[0] * pkS)
  B' = (Ev.proof[1] * M + Ev.proof[0] * Z)
  a2 = GG.Serialize(A')
  a3 = GG.Serialize(B')

  challengeDST = "VOPRF05-challenge-" || self.contextString
  h2Input = I2OSP(len(pkS), 2) || pkS ||
            I2OSP(len(a[0]), 2) || a[0] ||
            I2OSP(len(a[1]), 2) || a[1] ||
            I2OSP(len(a2), 2) || a2 ||
            I2OSP(len(a3), 2) || a3 ||
            I2OSP(len(challengeDST), 2) || challengeDST

  c  = GG.HashToScalar(h2Input)

  return CT_EQUAL(c, Ev.proof[0])
</pre><a href="#section-3.4.4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="unblind-1">
<section id="section-3.4.4.2">
            <h5 id="name-unblind-2">
<a href="#section-3.4.4.2" class="section-number selfRef">3.4.4.2. </a><a href="#name-unblind-2" class="section-name selfRef">Unblind</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.4.2-1">
<pre>
Input:

  PublicKey pkS
  Token token
  SerializedElement blindToken
  Evaluation Ev

Output:

  SerializedElement issuedToken

def Unblind(pkS, token, blindToken, Ev):
  if VerifyProof(pkS, blindToken, Ev) == false:
    ABORT()

  r = token.blind
  Z = GG.Deserialize(Ev.element)
  N = (r^(-1)) * Z

  issuedToken = GG.Serialize(N)

  return issuedToken
</pre><a href="#section-3.4.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-4">
      <h2 id="name-ciphersuites">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-4-1">A ciphersuite (also referred to as 'suite' in this document) for the protocol
wraps the functionality required for the protocol to take place. This
ciphersuite should be available to both the client and server, and agreement
on the specific instantiation is assumed throughout. A ciphersuite contains
instantiations of the following functionalities:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <code>GG</code>: A prime-order group exposing the API detailed in <a href="#pog" class="xref">Section 2.1</a>, with base
point defined in the corresponding reference for each group.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">
          <code>Hash</code>: A cryptographic hash function that is indifferentiable from a
Random Oracle.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">This section specifies supported VOPRF group and hash function
instantiations. For each group, we specify the HashToGroup, HashToScalar,
and serialization functionalities.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Applications should take caution in using ciphersuites targeting P-256
and ristretto255. See <a href="#cryptanalysis" class="xref">Section 5.2</a> for related discussion.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="oprfristretto255-sha-256">
<section id="section-4.1">
        <h3 id="name-oprfristretto255-sha-256">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-oprfristretto255-sha-256" class="section-name selfRef">OPRF(ristretto255, SHA-256)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.1-1.1">
            <p id="section-4.1-1.1.1">Group: ristretto255 <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span><a href="#section-4.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-1.1.2.1">HashToGroup(): hash_to_ristretto255
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> with DST =
"VOPRF05-" || contextString, where contextString is that which is
computed in the Setup functions, and <code>expand_message</code> = <code>expand_message_xmd</code>
using SHA-256.<a href="#section-4.1-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L=48, and expand_message_xmd with
SHA-256.<a href="#section-4.1-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-1.1.2.3">Serialization: Serialization converts group elements to 32-byte strings
using the 'Encode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>. Deserialization converts
32-byte strings to group elements using the 'Decode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>.<a href="#section-4.1-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-1.2">Hash: SHA-256<a href="#section-4.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-1.3">ID: 0x0001<a href="#section-4.1-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfdecaf448-sha-512">
<section id="section-4.2">
        <h3 id="name-oprfdecaf448-sha-512">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-oprfdecaf448-sha-512" class="section-name selfRef">OPRF(decaf448, SHA-512)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.2-1.1">
            <p id="section-4.2-1.1.1">Group: decaf448 <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span><a href="#section-4.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-1.1.2.1">HashToGroup(): hash_to_decaf448
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> with DST =
"VOPRF05-" || contextString, where contextString is that which is
computed in the Setup functions, and <code>expand_message</code> = <code>expand_message_xmd</code>
using SHA-512.<a href="#section-4.2-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L=84, and <code>expand_message_xmd</code> with
SHA-512.<a href="#section-4.2-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-1.1.2.3">Serialization: Serialization converts group elements to 56-byte strings
using the 'Encode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>. Deserialization converts
56-byte strings to group elements using the 'Decode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>.<a href="#section-4.2-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-1.2">Hash: SHA-512<a href="#section-4.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-1.3">ID: 0x0002<a href="#section-4.2-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfp-256-sha-256">
<section id="section-4.3">
        <h3 id="name-oprfp-256-sha-256">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-oprfp-256-sha-256" class="section-name selfRef">OPRF(P-256, SHA-256)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.3-1.1">
            <p id="section-4.3-1.1.1">Group: P-256 (secp256r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-4.3-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-1.1.2.1">HashToGroup(): P256_XMD:SHA-256_SSWU_RO_
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> with DST =
"VOPRF05-" || contextString, where contextString is that which is
computed in the Setup functions.<a href="#section-4.3-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L=48, and <code>expand_message_xmd</code> with
SHA-256.<a href="#section-4.3-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3-1.1.2.3">Serialization: The compressed point encoding for the curve <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>
consisting of 33 bytes.<a href="#section-4.3-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-1.2">Hash: SHA-256<a href="#section-4.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-1.3">ID: 0x0003<a href="#section-4.3-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfp-384-sha-512">
<section id="section-4.4">
        <h3 id="name-oprfp-384-sha-512">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-oprfp-384-sha-512" class="section-name selfRef">OPRF(P-384, SHA-512)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.4-1.1">
            <p id="section-4.4-1.1.1">Group: P-384 (secp384r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-4.4-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-1.1.2.1">HashToGroup(): P384_XMD:SHA-512_SSWU_RO_
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> with DST =
"VOPRF05-" || contextString, where contextString is that which is
computed in the Setup functions.<a href="#section-4.4-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.4-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L=72, and <code>expand_message_xmd</code> with
SHA-512.<a href="#section-4.4-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.4-1.1.2.3">Serialization: The compressed point encoding for the curve <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>
consisting of 49 bytes.<a href="#section-4.4-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-1.2">Hash: SHA-512<a href="#section-4.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-1.3">ID: 0x0004<a href="#section-4.4-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfp-521-sha-512">
<section id="section-4.5">
        <h3 id="name-oprfp-521-sha-512">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-oprfp-521-sha-512" class="section-name selfRef">OPRF(P-521, SHA-512)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.5-1.1">
            <p id="section-4.5-1.1.1">Group: P-521 (secp521r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-4.5-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-1.1.2.1">HashToGroup(): P521_XMD:SHA-512_SSWU_RO_
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> with DST =
"VOPRF05-" || contextString, where contextString is that which is
computed in the Setup functions.<a href="#section-4.5-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.5-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L=98, and <code>expand_message_xmd</code> with
SHA-512.<a href="#section-4.5-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.5-1.1.2.3">Serialization: The compressed point encoding for the curve <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>
consisting of 67 bytes.<a href="#section-4.5-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.5-1.2">Hash: SHA-512<a href="#section-4.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-1.3">ID: 0x0005<a href="#section-4.5-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">This section discusses the cryptographic security of our protocol, along
with some suggestions and trade-offs that arise from the implementation
of an OPRF.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="properties">
<section id="section-5.1">
        <h3 id="name-security-properties">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-security-properties" class="section-name selfRef">Security properties</a>
        </h3>
<p id="section-5.1-1">The security properties of an OPRF protocol with functionality y = F(k,
x) include those of a standard PRF. Specifically:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">Pseudorandomness: F is pseudorandom if the output y = F(k,x) on any
input x is indistinguishable from uniformly sampling any element in
F's range, for a random sampling of k.<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-3">In other words, consider an adversary that picks inputs x from the
domain of F and evaluates F on (k,x) (without knowledge of randomly
sampled k). Then the output distribution F(k,x) is indistinguishable
from the output distribution of a randomly chosen function with the same
domain and range.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">A consequence of showing that a function is pseudorandom, is that it is
necessarily non-malleable (i.e. we cannot compute a new evaluation of F
from an existing evaluation). A genuinely random function will be
non-malleable with high probability, and so a pseudorandom function must
be non-malleable to maintain indistinguishability.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">An OPRF protocol must also satisfy the following property:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-6.1">Oblivious: The server must learn nothing about the client's input or
the output of the function. In addition, the client must learn nothing
about the server's private key.<a href="#section-5.1-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-7">Essentially, obliviousness tells us that, even if the server learns the
client's input x at some point in the future, then the server will not
be able to link any particular OPRF evaluation to x. This property is
also known as unlinkability <span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span>.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">Optionally, for any protocol that satisfies the above properties, there
is an additional security property:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-9.1">Verifiable: The client must only complete execution of the protocol if
it can successfully assert that the OPRF output it computes is
correct. This is taken with respect to the OPRF key held by the
server.<a href="#section-5.1-9.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-10">Any OPRF that satisfies the 'verifiable' security property is known as a
verifiable OPRF, or VOPRF for short. In practice, the notion of
verifiability requires that the server commits to the key before the
actual protocol execution takes place. Then the client verifies that the
server has used the key in the protocol using this commitment. In the
following, we may also refer to this commitment as a public key.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptanalysis">
<section id="section-5.2">
        <h3 id="name-cryptographic-security">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-cryptographic-security" class="section-name selfRef">Cryptographic security</a>
        </h3>
<p id="section-5.2-1">Below, we discuss the cryptographic security of the (V)OPRF protocol
from <a href="#protocol" class="xref">Section 3</a>, relative to the necessary cryptographic assumptions
that need to be made.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="assumptions">
<section id="section-5.2.1">
          <h4 id="name-computational-hardness-assu">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-computational-hardness-assu" class="section-name selfRef">Computational hardness assumptions</a>
          </h4>
<p id="section-5.2.1-1">Each assumption states that the problems specified below are
computationally difficult to solve in relation to a particular choice of
security parameter <code>sp</code>.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">Let GG = GG(sp) be a group with prime-order p, and let FFp be the finite
field of order p.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<div id="dl">
<section id="section-5.2.1.1">
            <h5 id="name-discrete-log-dl-problem">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-discrete-log-dl-problem" class="section-name selfRef">Discrete-log (DL) problem</a>
            </h5>
<p id="section-5.2.1.1-1">Given G, a generator of GG, and H = hG for some h in FFp; output h.<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ddh">
<section id="section-5.2.1.2">
            <h5 id="name-decisional-diffie-hellman-d">
<a href="#section-5.2.1.2" class="section-number selfRef">5.2.1.2. </a><a href="#name-decisional-diffie-hellman-d" class="section-name selfRef">Decisional Diffie-Hellman (DDH) problem</a>
            </h5>
<p id="section-5.2.1.2-1">Sample a uniformly random bit d in {0,1}. Given (G, aG, bG, C), where:<a href="#section-5.2.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.2-2.1">G is a generator of GG;<a href="#section-5.2.1.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.2-2.2">a,b are elements of FFp;<a href="#section-5.2.1.2-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.2-2.3">if d == 0: C = abG; else: C is sampled uniformly GG(sp).<a href="#section-5.2.1.2-2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.1.2-3">Output d' == d.<a href="#section-5.2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-sec">
<section id="section-5.2.2">
          <h4 id="name-protocol-security">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-protocol-security" class="section-name selfRef">Protocol security</a>
          </h4>
<p id="section-5.2.2-1">Our OPRF construction is based on the VOPRF construction known as
2HashDH-NIZK given by <span>[<a href="#JKK14" class="xref">JKK14</a>]</span>; essentially without providing
zero-knowledge proofs that verify that the output is correct. Our VOPRF
construction is identical to the <span>[<a href="#JKK14" class="xref">JKK14</a>]</span> construction, except that we
can optionally perform multiple VOPRF evaluations in one go, whilst only
constructing one NIZK proof object. This is enabled using an established
batching technique.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">Consequently the cryptographic security of our construction is based on
the assumption that the One-More Gap DH is computationally difficult to
solve.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">The (N,Q)-One-More Gap DH (OMDH) problem asks the following.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2.2-4">
<pre>
    Given:
    - G, k * G, G_1, ... , G_N where G, G_1, ... G_N are elements of GG;
    - oracle access to an OPRF functionality using the key k;
    - oracle access to DDH solvers.

    Find Q+1 pairs of the form below:

    (G_{j_s}, k * G_{j_s})

    where the following conditions hold:
      - s is a number between 1 and Q+1;
      - j_s is a number between 1 and N for each s;
      - Q is the number of allowed queries.
</pre><a href="#section-5.2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2.2-5">The original paper <span>[<a href="#JKK14" class="xref">JKK14</a>]</span> gives a security proof that the
2HashDH-NIZK construction satisfies the security guarantees of a VOPRF
protocol <a href="#properties" class="xref">Section 5.1</a> under the OMDH assumption in the universal
composability (UC) security model.<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="qsdh">
<section id="section-5.2.3">
          <h4 id="name-q-strong-dh-oracle">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-q-strong-dh-oracle" class="section-name selfRef">Q-strong-DH oracle</a>
          </h4>
<p id="section-5.2.3-1">A side-effect of our OPRF design is that it allows instantiation of a
oracle for constructing Q-strong-DH (Q-sDH) samples. The Q-Strong-DH
problem asks the following.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2.3-2">
<pre>
    Given G1, G2, h*G2, (h^2)*G2, ..., (h^Q)*G2; for G1 and G2
    generators of GG.

    Output ( (1/(k+c))*G1, c ) where c is an element of FFp
</pre><a href="#section-5.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.3-3">The assumption that this problem is hard was first introduced in
<span>[<a href="#BB04" class="xref">BB04</a>]</span>. Since then, there have been a number of cryptanalytic studies
that have reduced the security of the assumption below that implied by
the group instantiation (for example, <span>[<a href="#BG04" class="xref">BG04</a>]</span> and <span>[<a href="#Cheon06" class="xref">Cheon06</a>]</span>). In
summary, the attacks reduce the security of the group instantiation by
log_2(Q) bits.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3-4">As an example, suppose that a group instantiation is used that provides
128 bits of security against discrete log cryptanalysis. Then an
adversary with access to a Q-sDH oracle and makes Q=2^20 queries can
reduce the security of the instantiation by log_2(2^20) = 20 bits.<a href="#section-5.2.3-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3-5">Notice that it is easy to instantiate a Q-sDH oracle using the OPRF
functionality that we provide. A client can just submit sequential
queries of the form (G, k * G, (k^2)G, ..., (k^(Q-1))G), where each
query is the output of the previous interaction. This means that any
client that submit Q queries to the OPRF can use the aforementioned
attacks to reduce security of the group instantiation by log_2(Q) bits.<a href="#section-5.2.3-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3-6">Recall that from a malicious client's perspective, the adversary wins if
they can distinguish the OPRF interaction from a protocol that computes
the ideal functionality provided by the PRF.<a href="#section-5.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implications-for-ciphersuite-choices">
<section id="section-5.2.4">
          <h4 id="name-implications-for-ciphersuit">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-implications-for-ciphersuit" class="section-name selfRef">Implications for ciphersuite choices</a>
          </h4>
<p id="section-5.2.4-1">The OPRF instantiations that we recommend in this document are informed
by the cryptanalytic discussion above. In particular, choosing elliptic
curves configurations that describe 128-bit group instantiations would
appear to in fact instantiate an OPRF with 128-log_2(Q) bits of
security.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">In most cases, it would require an informed and persistent attacker to
launch a highly expensive attack to reduce security to anything much
below 100 bits of security. We see this possibility as something that
may result in problems in the future. For applications that cannot
tolerate discrete logarithm security of lower than 128 bits, we
recommend only implementing ciphersuites with IDs: 0x0002, 0x0004, and
0x0005.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="hashing-to-curve">
<section id="section-5.3">
        <h3 id="name-hashing-to-curve">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-hashing-to-curve" class="section-name selfRef">Hashing to curve</a>
        </h3>
<p id="section-5.3-1">A critical requirement of implementing the prime-order group using
elliptic curves is a method to instantiate the function
<code>GG.HashToGroup</code>, that maps inputs to group elements. In the elliptic
curve setting, this deterministically maps inputs x (as byte arrays) to
uniformly chosen points on the curve.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">In the security proof of the construction Hash is modeled as a random
oracle. This implies that any instantiation of <code>GG.HashToGroup</code> must be
pre-image and collision resistant. In <a href="#ciphersuites" class="xref">Section 4</a> we give
instantiations of this functionality based on the functions described in
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>. Consequently, any OPRF implementation
must adhere to the implementation and security considerations discussed
in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> when instantiating the function.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timing-leaks">
<section id="section-5.4">
        <h3 id="name-timing-leaks">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-timing-leaks" class="section-name selfRef">Timing Leaks</a>
        </h3>
<p id="section-5.4-1">To ensure no information is leaked during protocol execution, all
operations that use secret data MUST run in constant time. Operations that
SHOULD run in constant time include all prime-order group operations and
proof-specific operations (<code>GenerateProof()</code> and <code>VerifyProof()</code>).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-rotation">
<section id="section-5.5">
        <h3 id="name-key-rotation">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-key-rotation" class="section-name selfRef">Key rotation</a>
        </h3>
<p id="section-5.5-1">Since the server's key is critical to security, the longer it is exposed
by performing (V)OPRF operations on client inputs, the longer it is
possible that the key can be compromised. For example,if the key is kept
in circulation for a long period of time, then it also allows the
clients to make enough queries to launch more powerful variants of the
Q-sDH attacks from <a href="#qsdh" class="xref">Section 5.2.3</a>.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">To combat attacks of this nature, regular key rotation should be
employed on the server-side. A suitable key-cycle for a key used to
compute (V)OPRF evaluations would be between one week and six months.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="blinding">
<section id="section-6">
      <h2 id="name-additive-blinding">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-additive-blinding" class="section-name selfRef">Additive blinding</a>
      </h2>
<p id="section-6-1">Let <code>H</code> refer to the function <code>GG.HashToGroup</code>, in <a href="#pog" class="xref">Section 2.1</a> we assume
that the client-side blinding is carried out directly on the output of
<code>H(x)</code>, i.e. computing <code>r * H(x)</code> for some <code>r &lt;-$ GF(p)</code>. In the
<span>[<a href="#I-D.irtf-cfrg-opaque" class="xref">I-D.irtf-cfrg-opaque</a>]</span> document, it is noted that it may be more efficient to use
additive blinding (rather than multiplicative) if the client can
preprocess some values. For example, a valid way of computing additive
blinding would be to instead compute <code>H(x) + (r * G)</code>, where <code>G</code> is the
fixed generator for the group <code>GG</code>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The advantage of additive blinding is that it allows the client to
pre-process tables of blinded scalar multiplications for <code>G</code>. This may
give it a computational efficiency advantage (due to the fact that a
fixed-base multiplication can be calculated faster than a variable-base
multiplication). Pre-processing also reduces the amount of computation
that needs to be done in the online exchange. Choosing one of these
values <code>r * G</code> (where <code>r</code> is the scalar value that is used), then
computing <code>H(x) + (r * G)</code> is more efficient than computing <code>r * H(x)</code>.
Therefore, it may be advantageous to define the OPRF and VOPRF protocols
using additive blinding (rather than multiplicative) blinding. In fact,
the only algorithms that need to change are Blind and Unblind (and
similarly for the VOPRF variants).<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">We define the variants of the algorithms in <a href="#api" class="xref">Section 3.4</a> for performing
additive blinding below, along with a new algorithm <code>Preprocess</code>. The
<code>Preprocess</code> algorithm can take place offline and before the rest of the
OPRF protocol. The Blind algorithm takes the preprocessed values as
inputs, but the signature of Unblind remains the same.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="preprocess">
<section id="section-6.1">
        <h3 id="name-preprocess">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-preprocess" class="section-name selfRef">Preprocess</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.1-1">
<pre>
struct {
  Scalar blind;
  SerializedElement blindedGenerator;
  SerializedElement blindedPublicKey;
} PreprocessedBlind;
</pre><a href="#section-6.1-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-6.1-2">
<pre>
Input:

  PublicKey pkS

Output:

  PrepocessedBlind preproc

def Preprocess(pkS):
  PK = GG.Deserialize(pkS)
  r = GG.RandomScalar()
  blindedGenerator = GG.Serialize(ScalarBaseMult(r))
  blindedPublicKey = GG.Serialize(r * PK)

  preproc = PrepocessedBlind{
    blind: r,
    blindedGenerator: blindedGenerator,
    blindedPublicKey: blindedPublicKey,
  }

  return preproc
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="blind-1">
<section id="section-6.2">
        <h3 id="name-blind-2">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-blind-2" class="section-name selfRef">Blind</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.2-1">
<pre>
Input:

  ClientInput input
  PreprocessedBlind preproc

Output:

  Token token
  SerializedElement blindToken

def Blind(input, preproc):
  Q = GG.Deserialize(preproc.blindedGenerator) /* Q = ScalarBaseMult(r) */
  P = GG.HashToGroup(input)

  token = Token{
    data: input,
    blind: preproc.blindedPublicKey
  }
  blindToken = GG.Serialize(P + Q)           /* P + ScalarBaseMult(r) */

  return (token, blindToken)
</pre><a href="#section-6.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="unblind-2">
<section id="section-6.3">
        <h3 id="name-unblind-3">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-unblind-3" class="section-name selfRef">Unblind</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.3-1">
<pre>
Input:

  Token token
  Evaluation ev
  SerializedElement blindToken

Output:

 SerializedElement unblinded

def Unblind(token, ev, blindToken):
  PKR = GG.Deserialize(token.blind)
  Z = GG.Deserialize(ev.element)
  N := Z - PKR

  issuedToken = GG.Serialize(N)

  return issuedToken
</pre><a href="#section-6.3-1" class="pilcrow">¶</a>
</div>
<p id="section-6.3-2">Let <code>P = GG.HashToGroup(x)</code>. Notice that Unblind computes:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.3-3">
<pre>
Z - PKR = k * (P + r * G) - r * pkS
        = k * P + k * (r * G) - r * (k * G)
        = k * P
</pre><a href="#section-6.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.3-4">by the commutativity of scalar multiplication in GG. This is the same
output as in the <code>Unblind</code> algorithm for multiplicative blinding.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">Note that the verifiable variant of <code>Unblind</code> works as above but
includes the step to <code>VerifyProof</code>, as specified in
<a href="#verifiable-client" class="xref">Section 3.4.4</a>.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<div id="parameter-commitments">
<section id="section-6.3.1">
          <h4 id="name-parameter-commitments">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-parameter-commitments" class="section-name selfRef">Parameter Commitments</a>
          </h4>
<p id="section-6.3.1-1">For some applications, it may be desirable for server to bind tokens to
certain parameters, e.g., protocol versions, ciphersuites, etc. To
accomplish this, server should use a distinct scalar for each parameter
combination. Upon redemption of a token T from the client, server can
later verify that T was generated using the scalar associated with the
corresponding parameters.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-7">
      <h2 id="name-contributors">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-7-1.1">Sofia Celi            (cherenkov@riseup.net)<a href="#section-7-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-1.2">Alex Davidson         (alex.davidson92@gmail.com)<a href="#section-7-1.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-1.3">Armando Faz Hernandez (armfazh@cloudflare.com)<a href="#section-7-1.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-1.4">Eli-Shaoul Khedouri   (eli@intuitionmachines.com)<a href="#section-7-1.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-1.5">Nick Sullivan         (nick@cloudflare.com)<a href="#section-7-1.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-1.6">Christopher A. Wood   (caw@heapingbits.net)<a href="#section-7-1.6" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">This document resulted from the work of the Privacy Pass team
<span>[<a href="#PrivacyPass" class="xref">PrivacyPass</a>]</span>. The authors would also like to acknowledge the helpful
conversations with Hugo Krawczyk. Eli-Shaoul Khedouri provided
additional review and comments on key consistency.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BB04">[BB04]</dt>
        <dd>
<span class="refTitle">"Short Signatures Without Random Oracles"</span>, <span>&lt;<a href="http://ai.stanford.edu/~xb/eurocrypt04a/bbsigs.pdf">http://ai.stanford.edu/~xb/eurocrypt04a/bbsigs.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BG04">[BG04]</dt>
        <dd>
<span class="refTitle">"The Static Diffie-Hellman Problem"</span>, <span>&lt;<a href="https://eprint.iacr.org/2004/306">https://eprint.iacr.org/2004/306</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cheon06">[Cheon06]</dt>
        <dd>
<span class="refTitle">"Security Analysis of the Strong Diffie-Hellman Problem"</span>, <span>&lt;<a href="https://www.iacr.org/archive/eurocrypt2006/40040001/40040001.pdf">https://www.iacr.org/archive/eurocrypt2006/40040001/40040001.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DGSTV18">[DGSTV18]</dt>
        <dd>
<span class="refTitle">"Privacy Pass, Bypassing Internet Challenges Anonymously"</span>, <span>&lt;<a href="https://www.degruyter.com/view/j/popets.2018.2018.issue-3/popets-2018-0026/popets-2018-0026.xml">https://www.degruyter.com/view/j/popets.2018.2018.issue-3/popets-2018-0026/popets-2018-0026.xml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.davidson-pp-protocol">[I-D.davidson-pp-protocol]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refTitle">"Privacy Pass: The Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-davidson-pp-protocol-01</span>, <time datetime="2020-07-13" class="refDate">13 July 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-davidson-pp-protocol-01.txt">http://www.ietf.org/internet-drafts/draft-davidson-pp-protocol-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span><span class="refAuthor">, Scott, S.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, Wahby, R.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-10</span>, <time datetime="2020-10-11" class="refDate">11 October 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-irtf-cfrg-hash-to-curve-10.txt">http://www.ietf.org/internet-drafts/draft-irtf-cfrg-hash-to-curve-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-opaque">[I-D.irtf-cfrg-opaque]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor">, Lewi, K.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"The OPAQUE Asymmetric PAKE Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-opaque-00</span>, <time datetime="2020-09-28" class="refDate">28 September 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-irtf-cfrg-opaque-00.txt">http://www.ietf.org/internet-drafts/draft-irtf-cfrg-opaque-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JKK14">[JKK14]</dt>
        <dd>
<span class="refTitle">"Round-Optimal Password-Protected Secret Sharing and T-PAKE in the Password-Only model"</span>, <span>&lt;<a href="https://eprint.iacr.org/2014/650">https://eprint.iacr.org/2014/650</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JKKX16">[JKKX16]</dt>
        <dd>
<span class="refTitle">"Highly-Efficient and Composable Password-Protected Secret Sharing (Or, How to Protect Your Bitcoin Wallet Online)"</span>, <span>&lt;<a href="https://eprint.iacr.org/2016/144">https://eprint.iacr.org/2016/144</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PrivacyPass">[PrivacyPass]</dt>
        <dd>
<span class="refTitle">"Privacy Pass"</span>, <span>&lt;<a href="https://github.com/privacypass/challenge-bypass-server">https://github.com/privacypass/challenge-bypass-server</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span><span class="refAuthor">, Hamburg, M.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, Jonsson, J.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RISTRETTO">[RISTRETTO]</dt>
        <dd>
<span class="refAuthor">Valence, H.</span><span class="refAuthor">, Grigg, J.</span><span class="refAuthor">, Tankersley, G.</span><span class="refAuthor">, Valsorda, F.</span><span class="refAuthor">, Lovecruft, I.</span><span class="refAuthor">, and M. Hamburg</span>, <span class="refTitle">"The ristretto255 and decaf448 Groups"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-ristretto255-decaf448-00</span>, <time datetime="2020-10-05" class="refDate">5 October 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-irtf-cfrg-ristretto255-decaf448-00.txt">http://www.ietf.org/internet-drafts/draft-irtf-cfrg-ristretto255-decaf448-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group (SECG), .</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span>&lt;<a href="https://www.secg.org/sec1-v2.pdff">https://www.secg.org/sec1-v2.pdff</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group (SECG), .</span>, <span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters"</span>, <span>&lt;<a href="http://www.secg.org/sec2-v2.pdf">http://www.secg.org/sec2-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SJKS17">[SJKS17]</dt>
        <dd>
<span class="refTitle">"SPHINX, A Password Store that Perfectly Hides from Itself"</span>, <span>&lt;<a href="https://eprint.iacr.org/2018/695">https://eprint.iacr.org/2018/695</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="x9.62">[x9.62]</dt>
      <dd>
<span class="refAuthor">ANSI</span>, <span class="refTitle">"Public Key Cryptography for the Financial Services Industry: the Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">ANSI X9.62-1998</span>, <time datetime="1998-09" class="refDate">September 1998</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alex Davidson</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">County Hall</span></div>
<div dir="auto" class="left"><span class="locality">London, SE1 7GP</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alex.davidson92@gmail.com" class="email">alex.davidson92@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Armando Faz-Hernandez</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:armfazh@cloudflare.com" class="email">armfazh@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nick Sullivan</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nick@cloudflare.com" class="email">nick@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
