ALPHA-LOW   = %x61-7A   ; lowercase "a"-"z"
ASTERISK    = %x2A      ; asterisk "*"
ATSIGN      = %x40      ; at sign "@"
COLON       = %x3A      ; colon ":"
SLASH       = %x2F      ; forward slash "/"

non-alpha   = DIGIT / HYPHEN / USCORE
keyname     = 1*(ALPHA / non-alpha)
keyname-low = 1*(ALPHA-LOW / non-alpha)

o=infra
host             = keyname-low
domain           = keyname-low *(DOT keyname-low)
host-domain      = host DOT domain
all-domain       = ASTERISK DOT domain

netgroupHost     = host / host-domain / all-domain

user             =  keyname
user-host        =  user ATSIGN host
user-host-domain =  user ATSIGN host-domain
user-all-domain  =  user ATSIGN all-domain

netgroupUser     =  user / user-host
netgroupUser     =/ user-host-domain / user-all-domain

service-name       = keyname
service-descriptor = keyname *(SLASH keyname)

en                 = service-name COLON service-descriptor

t-host             = LPAREN host COMMA COMMA RPAREN
t-host-domain      = LPAREN host-domain COMMA COMMA RPAREN
t-all-domain       = LPAREN COMMA COMMA domain RPAREN
t-user             = LPAREN COMMA user COMMA RPAREN
t-user-host        = LPAREN host COMMA user COMMA RPAREN
t-user-host-domain = LPAREN host-domain COMMA user COMMA RPAREN
t-user-all-domain  = LPAREN COMMA user COMMA domain RPAREN

triple-any   =  t-host / t-host-domain / t-all-domain
triple-any   =/ t-user / t-user-host / t-user-host-domain
triple-any   =/ t-user-all-domain

triples      = t-any *(SPACE t-any)

