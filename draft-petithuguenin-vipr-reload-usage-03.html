<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>A Usage of Resource Location and Discovery (RELOAD) for Public Switched Telephone Network (PSTN) Verification</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Registering an E.164 number">
<link href="#rfc.section.4" rel="Chapter" title="4 Fetching a registration">
<link href="#rfc.section.5" rel="Chapter" title="5 VIPR-REGISTRATION Kind Definition">
<link href="#rfc.section.6" rel="Chapter" title="6 Overlay Configuration Document Extension">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Access Control Policies">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Application-ID">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Data Kind-ID">
<link href="#rfc.section.8.4" rel="Chapter" title="8.4 IETF XML Namespaces Registry">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Examples">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Release notes">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 Modifications between vipr-03 and vipr-02">
<link href="#rfc.appendix.Appendix%20B.2" rel="Chapter" title="Appendix B.2 Modifications between vipr-02 and vipr-01">
<link href="#rfc.appendix.Appendix%20B.3" rel="Chapter" title="Appendix B.3 Modifications between vipr-01 and vipr-00">
<link href="#rfc.appendix.Appendix%20B.4" rel="Chapter" title="Appendix B.4 Modifications between vipr-00 and dispatch-03">
<link href="#rfc.appendix.Appendix%20B.5" rel="Chapter" title="Appendix B.5 Modifications between dispatch-03 and dispatch-02">
<link href="#rfc.appendix.Appendix%20B.6" rel="Chapter" title="Appendix B.6 Running Code Considerations">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Verification Involving PSTN Reachability (VIPR) is a technique for inter-domain SIP federation.  VIPR makes use of the RELOAD protocol to store unverified mappings from phone numbers to RELOAD nodes, with whom a validation process can be run.  This document defines the usage of RELOAD for this purpose.  " />
  <meta name="description" content="Verification Involving PSTN Reachability (VIPR) is a technique for inter-domain SIP federation.  VIPR makes use of the RELOAD protocol to store unverified mappings from phone numbers to RELOAD nodes, with whom a validation process can be run.  This document defines the usage of RELOAD for this purpose.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">VIPR</td>
<td class="right">M. Petit-Huguenin</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Stonyfish</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">J.R. Rosenberg</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">jdrosen.net</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">C. Jennings</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">A Usage of Resource Location and Discovery (RELOAD) for Public Switched Telephone Network (PSTN) Verification<br />
  <span class="filename">draft-petithuguenin-vipr-reload-usage-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Verification Involving PSTN Reachability (VIPR) is a technique for inter-domain SIP federation.  VIPR makes use of the RELOAD protocol to store unverified mappings from phone numbers to RELOAD nodes, with whom a validation process can be run.  This document defines the usage of RELOAD for this purpose.  </p>
<p>The IETF has been notified of intellectual property rights claimed in regard to some or all of the specification contained in this document.  For more information consult the online list of claimed rights.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Registering an E.164 number</a>
</li>
<li>4.   <a href="#rfc.section.4">Fetching a registration</a>
</li>
<li>5.   <a href="#rfc.section.5">VIPR-REGISTRATION Kind Definition</a>
</li>
<li>6.   <a href="#rfc.section.6">Overlay Configuration Document Extension</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">Access Control Policies</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Application-ID</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">Data Kind-ID</a>
</li>
<li>8.4.   <a href="#rfc.section.8.4">IETF XML Namespaces Registry</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgements</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Examples</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Release notes</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">Modifications between vipr-03 and vipr-02</a>
</li>
<li>Appendix B.2.   <a href="#rfc.appendix.Appendix%20B.2">Modifications between vipr-02 and vipr-01</a>
</li>
<li>Appendix B.3.   <a href="#rfc.appendix.Appendix%20B.3">Modifications between vipr-01 and vipr-00</a>
</li>
<li>Appendix B.4.   <a href="#rfc.appendix.Appendix%20B.4">Modifications between vipr-00 and dispatch-03</a>
</li>
<li>Appendix B.5.   <a href="#rfc.appendix.Appendix%20B.5">Modifications between dispatch-03 and dispatch-02</a>
</li>
<li>Appendix B.6.   <a href="#rfc.appendix.Appendix%20B.6">Running Code Considerations</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document relies heavily on the concepts and terminology defined in <a href="#VIPR-OVERVIEW">[VIPR-OVERVIEW]</a> and will not make sense if you have not read that document first.  As it defines a usage for RELOAD <a href="#P2PSIP-BASE">[P2PSIP-BASE]</a>, it assumes the reader is also familiar with that specification.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Registering an E.164 number</h1>
<p id="rfc.section.3.p.1">To register an E.164 number a VIPR server stores a ViprRegistration structure using the fully qualified E.164 based number without any non-digit characters but the '+' character as Resource Name.  </p>
<p id="rfc.section.3.p.2">The contents of the ViprRegistration structure are as follow:</p>
<div id="#rfc.figure.1"></div>
<pre>
enum { reserved(0), node_id(8200), (65535) } ViprRegistrationType;

struct {
    opaque                name&lt;0..2^8-1&gt;;
} Method;

struct {
    select (ViprRegistrationType) {
      case node_id:
        NodeId            pvp_provider;
        Method            methods&lt;0..2^16-1&gt;;

      /* This type can be extended */
    } ViprRegistrationData;

struct {
    ViprRegistrationType  type;
    uint16                length;
    ViprRegistrationData  data;
} ViprRegistration;

				</pre>
<p id="rfc.section.3.p.3">The ViprRegistration structure contains the following values:</p>
<p></p>

<dl>
<dt>type</dt>
<dd style="margin-left: 8"></dd>
<dt></dt>
<dd style="margin-left: 8">The type of the registration</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>length</dt>
<dd style="margin-left: 8"></dd>
<dt></dt>
<dd style="margin-left: 8">The length of the data structure, i.e. not counting the type and length fields</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>pvp_provider</dt>
<dd style="margin-left: 8"></dd>
<dt></dt>
<dd style="margin-left: 8">The Node-ID of the peer to which an AppAttach request should be sent to initiate the PVP protocol</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>methods</dt>
<dd style="margin-left: 8"></dd>
<dt></dt>
<dd style="margin-left: 8">The set of methods that the PVP client can try to validate a PSTN call to the E.164 number used as Resource Name.  </dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
</dl>
<p id="rfc.section.3.p.5">The Node-ID used in the pvp_provider field and in the key MUST be ready to process AppAttach requests for Application-ID 8470 at the time the registration is done.</p>
<p id="rfc.section.3.p.6">VIPR supports multiple registrations for a single E.164 number by using a Dictionary Data Model.  The dictionary key is the concatenation of the Node-ID and the VServiceId, resulting in a 24 bytes long value.  Using the Node-ID of the node performing the store segments the keyspace of the dictionary so that no two peers ever store using the same key.  Using the VService allows for a single VIPR server to service multiple clusters, and to ensure that numbers published by one cluster (using one VServiceID) do not clobber or step on numbers published by another cluster (using a different VServiceID).  </p>
<p id="rfc.section.3.p.7">The Store operations are paced into the overlay at a fixed rate.  The VIPR server maintains a queue that is filled with store requests.  The VIPR server services that queue at a fixed, provisioned rate, which is stored in a kind configuration variable named &lt;store-rate-limit&gt;.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Fetching a registration</h1>
<p id="rfc.section.4.p.1">A VIPR server wishing to validate a E.164 number will start a Fetch transaction using the fully qualified E.164 based number without any non-digit characters but the '+' character as Resource Name.  The VIPR server will also retrieves the two replicas of the resource record just retrieved.  </p>
<p id="rfc.section.4.p.2">The VIPR server will then inspects the elements in the 3 resource record returned and will keep only the registrations that have the same key in at least 2 of the 3 resource records returned.  For each registration kept, the VIPR server will fetch the certificates associated with the Node-ID in the key using the CERTIFICATE_BY_NODE usage and will verify that the signature of the registration is valid.  </p>
<p id="rfc.section.4.p.3">The VIPR server can then send an AppAttach to the Node-ID found in the key and registration, using the Application-ID 8470.  After the connection is established, the VIPR server can start PVP as specified in <a href="#VIPR-PVP">[VIPR-PVP]</a>.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#kind" id="kind">VIPR-REGISTRATION Kind Definition</a>
</h1>
<p></p>

<dl>
<dt>Name</dt>
<dd style="margin-left: 8">VIPR-REGISTRATION</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Kind Ids</dt>
<dd style="margin-left: 8">The Resource Name for the VIPR-REGISTRATION Kind-ID is a fully qualified E.164 based number without any non-digit characters but the '+' character.  The data stored is a ViprRegistration, which contains the Node-ID of the peer to which an AppAttach request should be sent to initiate the PVP protocol.  </dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Data Model</dt>
<dd style="margin-left: 8">The data model for the VIPR Kind-ID is dictionary.  The dictionary key is the concatenation of the Node-ID and the VServiceId, resulting in a 24 bytes long value.  Using the Node-ID of the node performing the store segments the keyspace of the dictionary so that no two peers ever store using the same key and using the VService allows for a single VIPR server to service multiple clusters, and to ensure that numbers published by one cluster (using one VServiceID) do not clobber or step on numbers published by another cluster (using a different VServiceID).  </dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Access Control</dt>
<dd style="margin-left: 8">The VIPR-MATCH policy can only be used with a VIPR-REGISTRATION Kind-ID.  In this policy, a given value MUST be written (or overwritten) if and only if the Node-ID in the pvp_provider field of the ViprRegistration structure is equal to the first 16 bytes of the dictionary key and if the same Node-ID is the one indicated in the SignerIdentity of the value.  Note that VIPR always let the values stored expire, so the exists field is always equal to TRUE.  </dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Quota</dt>
<dd style="margin-left: 8">This kind MUST use the proportional quota algorithm described in <a href="#RELOAD-QUOTA">[RELOAD-QUOTA]</a> by adding the &lt;max-count-per&gt; element with a value of "SIGNER" to the configuration file.  A VIPR server MUST provide enough Node-IDs to store all the E.164 numbers it is responsible for by dividing this count by the &lt;max-count&gt; value, itself adjusted by an additional 3x factor to make sure that the probability is low that a rejection occurs due to imperfect distribution of Resource-IDs across the ring.  </dd>
</dl>
<p id="rfc.section.5.p.2">[[Open Issue: need to adjust the multiplier - basically birthday problem!]]</p>
<p id="rfc.section.5.p.3">The method for merging data after a partition follows the normal RELOAD rules around temporal ordering.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Overlay Configuration Document Extension</h1>
<p id="rfc.section.6.p.1">This document extends the overlay configuration document by defining a new element in the "urn:ietf:params:xml:ns:p2p:vipr" namespace.</p>
<p id="rfc.section.6.p.2">The &lt;store-rate-limit&gt; defines the maximum rate in seconds that a VIPR server must use to execute Store requests.</p>
<p id="rfc.section.6.p.3">The Compact Relax NG Grammar for this element is:</p>
<div id="#rfc.figure.2"></div>
<pre>
namespace vipr = "urn:ietf:params:xml:ns:p2p:vipr"

parameter &amp;= element vipr:store-rate-limit { xsd:unsignedInt }

				</pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Security Considerations</h1>
<p id="rfc.section.7.p.1">TBD</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> IANA Considerations</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> Access Control Policies</h1>
<p id="rfc.section.8.1.p.1">This document adds a new access control policy to the "RELOAD Access Control Policy" Registry:</p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Access-Policy</th>
<th class="left">RFC</th>
</tr></thead>
<tbody><tr>
<td class="left">VIPR-MATCH</td>
<td class="left">This document</td>
</tr></tbody>
</table>
<p id="rfc.section.8.1.p.2">This access control policy was described in <a href="#kind">Section 5</a>.</p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> Application-ID</h1>
<p id="rfc.section.8.2.p.1">This document adds a new application ID to the "RELOAD Application-ID" Registry:</p>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Application</th>
<th class="left">Application-ID</th>
<th class="left">Specification</th>
</tr></thead>
<tbody><tr>
<td class="left">PVP</td>
<td class="left">8470</td>
<td class="left">This document</td>
</tr></tbody>
</table>
<p id="rfc.section.8.2.p.2">This access control policy was described in <a href="#kind">Section 5</a>.</p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> Data Kind-ID</h1>
<p id="rfc.section.8.3.p.1">This document adds a new Data Kind-ID to the "RELOAD Data Kind-ID Registry":</p>
<div id="#rfc.table.3"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">KIND</th>
<th class="left">Kind-ID</th>
<th class="left">RFC</th>
</tr></thead>
<tbody><tr>
<td class="left">VIPR-REGISTRATION</td>
<td class="left">17</td>
<td class="left">This document</td>
</tr></tbody>
</table>
<p id="rfc.section.8.3.p.2">This Kind-ID was defined in <a href="#kind">Section 5</a>.</p>
<h1 id="rfc.section.8.4">
<a href="#rfc.section.8.4">8.4.</a> IETF XML Namespaces Registry</h1>
<p id="rfc.section.8.4.p.1">This document adds the following URN to the "XML Namespaces" class of the "IETF XML Registry":</p>
<p id="rfc.section.8.4.p.2">urn:ietf:params:xml:ns:p2p:vipr</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Acknowledgements</h1>
<p id="rfc.section.9.p.1">This document was improved by the input from the VIPR Design Team:</p>
<p></p>

<ul class="empty">
<li>Mary Barnes</li>
<li>Daryl Malas</li>
<li>Hakim Mehmood</li>
<li>Muthu Arul Mozhi Perumal</li>
<li>Jon Peterson</li>
<li>Marc Petit-Huguenin</li>
<li>Michael Procter</li>
<li>John Ward</li>
<li>Dean Willis</li>
</ul>
<p id="rfc.section.9.p.3">This document was written with the xml2rfc tool described in <a href="#RFC2629">[RFC2629]</a>.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="P2PSIP-BASE">[P2PSIP-BASE]</b></td>
<td class="top">
<a>Jennings, C</a>, <a>Lowekamp, B</a>, <a>Rescorla, E</a>, <a>Baset, S</a> and <a>H Schulzrinne</a>, "<a href="http://tools.ietf.org/html/draft-ietf-p2psip-base-19">REsource LOcation And Discovery (RELOAD) Base Protocol</a>", Internet-Draft draft-ietf-p2psip-base-19, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="VIPR-OVERVIEW">[VIPR-OVERVIEW]</b></td>
<td class="top">
<a>Barnes, M</a>, <a>Jennings, C</a>, <a>Rosenberg, J</a> and <a>M Petit-Huguenin</a>, "<a href="http://tools.ietf.org/html/draft-jennings-vipr-overview-02">Verification Involving PSTN Reachability: Requirements and Architecture Overview</a>", Internet-Draft draft-jennings-vipr-overview-02, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="VIPR-PVP">[VIPR-PVP]</b></td>
<td class="top">
<a>Rosenberg, J</a>, <a>Jennings, C</a> and <a>M Petit-Huguenin</a>, "<a href="http://tools.ietf.org/html/draft-petithuguenin-vipr-pvp-01">The Public Switched Telephone Network (PSTN) Validation Protocol (PVP)</a>", Internet-Draft draft-petithuguenin-vipr-pvp-01, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RELOAD-QUOTA">[RELOAD-QUOTA]</b></td>
<td class="top">
<a>Petit-Huguenin, M</a>, <a>Rosenberg, J</a> and <a>C Jennings</a>, "<a href="http://tools.ietf.org/html/draft-petithuguenin-vipr-proportional-quota-00">Proportional Quota in REsource LOcation And Discovery (RELOAD)</a>", Internet-Draft draft-petithuguenin-vipr-proportional-quota-00, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2629">[RFC2629]</b></td>
<td class="top">
<a href="mailto:mrose@not.invisible.net" title="Invisible Worlds, Inc.">Rose, M.T.</a>, "<a href="http://tools.ietf.org/html/rfc2629">Writing I-Ds and RFCs using XML</a>", RFC 2629, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="ACCESS-CONTROL">[ACCESS-CONTROL]</b></td>
<td class="top">
<a>Petit-Huguenin, M</a>, "<a href="http://tools.ietf.org/html/draft-petithuguenin-p2psip-access-control-03">Configuration of Access Control Policy in REsource LOcation And Discovery (RELOAD) Base Protocol</a>", Internet-Draft draft-petithuguenin-p2psip-access-control-03, July 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Examples</h1>
<p id="rfc.section.Appendix A.p.1">The Resource Name and Resource-ID for the E.164 number +1 408 555 5432 are:</p>
<div id="#rfc.table.4"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Resource Name</th>
<th class="left">Resource-ID</th>
</tr></thead>
<tbody><tr>
<td class="left">+14085555432</td>
<td class="left">6abaec4308294521e2f600ab5fd01e5</td>
</tr></tbody>
</table>
<p id="rfc.section.Appendix A.p.2">The VIPR-MATCH access control can be implemented with the following code (Using the notation in <a href="#ACCESS-CONTROL">[ACCESS-CONTROL]</a>):</p>
<div id="#rfc.figure.3"></div>
<pre>
var equals = function(a, b) {
  if (a.length !== b.length) return false;
  for (var i = 0; i &lt; a.length; i++) {
    if (a[i] !== b[i]) return false;
  }
  return true;
};
var length = configuration.node_id_length;
return equals(entry.key.slice(0, length),
  entry.value.slice(4, length + 4))
  &amp;&amp; equals(entry.key.slice(0, length), signature.node_id);</pre>
<p></p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> Release notes</h1>
<p id="rfc.section.Appendix B.p.1">This section must be removed before publication as an RFC.</p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> Modifications between vipr-03 and vipr-02</h1>
<p></p>

<ul>
<li>The E.164 number is no longer stored 3 times.</li>
<li>Moved the &lt;store-rate-limit&gt; parameter under the &lt;configuration&gt; element.</li>
<li>The VIPR registration now also contains the list of supported PVP methods.</li>
</ul>
<h1 id="rfc.appendix.Appendix B.2">
<a href="#rfc.appendix.Appendix%20B.2">Appendix B.2.</a> Modifications between vipr-02 and vipr-01</h1>
<p></p>

<ul>
<li>Made clear in the access control policy that exists is always equal to TRUE.</li>
<li>Updated with new version of proportional-quota.</li>
<li>The access control code now uses the configuration parameter.</li>
<li>Assigned values to Application-ID and Kind-ID.</li>
<li>Added running code section.</li>
<li>Nits</li>
</ul>
<h1 id="rfc.appendix.Appendix B.3">
<a href="#rfc.appendix.Appendix%20B.3">Appendix B.3.</a> Modifications between vipr-01 and vipr-00</h1>
<p></p>

<ul>
<li>Moved most of the quota algorithm to a separate I-D named draft-petithuguenin-p2psip-proportional-quota.</li>
<li>Removed the text saying that the same DHT can also be used for a RELOAD SIP usage, as it contradicts text in overview.  Also the quota algorithm does not work with clients, but SIP registration uses clients.  </li>
<li>Added Terminology section</li>
<li>Converted the TLV value stored to a structure using the syntax described in p2psip-base to not be dependent on VAP.  The new structure is bit compatible with the old definition.  </li>
<li>Changed the dictionary key to be binary based instead of text based.</li>
<li>Copied text from VAP explaining that the Store operations are queued and that the rate is limited.</li>
<li>Added voting algorithm when fetch returns different results for the 3 copies.</li>
<li>Added explanation on how to verify the signatures.</li>
<li>Added text on how to form the PVP connection</li>
<li>Rewrote some of the text so it looks more like a regular RELOAD usage.</li>
<li>Removed section 3 "PeerID Shim" now that support for multiple Node-ID in certificates in fully integrated in RELOAD base.</li>
<li>Filled IANA section</li>
<li>Added examples of conversion from E.164 number to Resource-ID</li>
<li>Added example code for the VIPR access control</li>
</ul>
<h1 id="rfc.appendix.Appendix B.4">
<a href="#rfc.appendix.Appendix%20B.4">Appendix B.4.</a> Modifications between vipr-00 and dispatch-03</h1>
<p></p>

<ul><li>Moved to new Working Group.</li></ul>
<h1 id="rfc.appendix.Appendix B.5">
<a href="#rfc.appendix.Appendix%20B.5">Appendix B.5.</a> Modifications between dispatch-03 and dispatch-02</h1>
<p></p>

<ul>
<li>Nits.</li>
<li>Shorter I-Ds references.</li>
<li>Fixed the peerID and VServiceID to be hexadecimal.</li>
<li>Fixed the description of the dictionary entry</li>
<li>Fixed the description of the TLV.</li>
<li>Used +1 408 555 prefix for phone numbers in examples.</li>
<li>Replaced peerId by Node-ID</li>
<li>Replaced resourceID by Resource-ID</li>
</ul>
<h1 id="rfc.appendix.Appendix B.6">
<a href="#rfc.appendix.Appendix%20B.6">Appendix B.6.</a> Running Code Considerations</h1>
<p></p>

<ul><li>Reference Implementation for the kind and access control policy (&lt;http://debian.implementers.org/testing/source/reload.tar.gz&gt;).  Marc Petit-Huguenin.  Implements version -02.  </li></ul>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Marc Petit-Huguenin</span> 
	  <span class="n hidden">
		<span class="family-name">Petit-Huguenin</span>
	  </span>
	</span>
	<span class="org vcardline">Stonyfish</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:marc@stonyfish.com">marc@stonyfish.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jonathan Rosenberg</span> 
	  <span class="n hidden">
		<span class="family-name">Rosenberg</span>
	  </span>
	</span>
	<span class="org vcardline">jdrosen.net</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Monmouth</span>,  
		<span class="region">NJ</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jdrosen@jdrosen.net">jdrosen@jdrosen.net</a></span>

<span class="vcardline">URI: <a href="http://www.jdrosen.net">http://www.jdrosen.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Cullen Jennings</span> 
	  <span class="n hidden">
		<span class="family-name">Jennings</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco</span>
	<span class="adr">
	  <span>170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 408 421-9990</span>

<span class="vcardline">EMail: <a href="mailto:fluffy@cisco.com">fluffy@cisco.com</a></span>

  </address>
</div>

</body>
</html>