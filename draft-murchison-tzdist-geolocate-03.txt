



Independent Submission                                      K. Murchison
Internet-Draft                                                  FastMail
Intended status: Standards Track                        November 9, 2018
Expires: May 13, 2019


  The Time Zone Data Distribution Service (TZDIST) Geolocate Extension
                  draft-murchison-tzdist-geolocate-03

Abstract

   This document defines an extension to the Time Zone Data Distribution
   Service (RFC 7808) to allow a mobile device to retrieve the time
   zones associated with a geographic location as specified by a 'geo'
   URI (RFC 5870).

Open Issues

   o  Determine which, if any, GEOPRIV requirements we need to follow
      and how they impact Security/Privacy considerations.

   o  Need a new field(s) in the response to indicate which time zone(s)
      contain the point location vs those which are nearby (intersect
      the radius of uncertainty).

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 13, 2019.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.





Murchison                 Expires May 13, 2019                  [Page 1]

Internet-Draft         TZDIST Geolocate Extension          November 2018


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   2
   3.  "geolocate" Action  . . . . . . . . . . . . . . . . . . . . .   3
     3.1.  Examples: geolocate
           action  . . . . . . . . . . . . . . . . . . . . . . . . .   4
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   7
   5.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .   7
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   7
     6.1.  Service Action Registration . . . . . . . . . . . . . . .   7
     6.2.  Registration of invalid-location Error URN  . . . . . . .   7
   7.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   7
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .   8
     8.2.  Informative References  . . . . . . . . . . . . . . . . .   8
   Appendix A.  Change History (To be removed by RFC Editor before
                publication) . . . . . . . . . . . . . . . . . . . .   8
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   Updating time zone data with Time Zone Data Distribution (TZDIST)
   requires prior knowledge of the time zone identifier.  Such prior
   knowledge may be inconvenient for mobile devices that may pass
   through multiple time zones as their geographic location changes.
   This specification defines a new TZDIST service action to allow a
   client on a mobile device to retrieve the time zone identifiers
   associated with its current location, as specified by a 'geo' URI
   [RFC5870].

   This specification does not define the source of the time zone
   boundary data.  It is assumed that a reliable and accurate source is
   available.  One such source is the Time Zone Boundary Builder [TZBB].

2.  Conventions Used in This Document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [RFC2119].



Murchison                 Expires May 13, 2019                  [Page 2]

Internet-Draft         TZDIST Geolocate Extension          November 2018


   This specification contains examples of HTTP requests and responses.
   In some cases, additional line breaks have been introduced into the
   request or response data to match maximum line-length limits of this
   document.

3.  "geolocate" Action

   Name:  geolocate

   Request-URI Template:
      {/service-prefix,data-prefix}/zones{?location}

   Description:  This action allows a client to query the time zone data
      distribution service for the time zone identifier(s) corresponding
      to the given geographic location, specified as a 'geo' URI
      [RFC5870].

      If the 'geo' URI specifies a location that lies on a time zone
      boundary or within multiple time zone boundaries (e.g. there is no
      consensus as to the official time zone in the given region), the
      server SHOULD return the time zone identifiers for all time zones
      whose boundary contains the location.

      If the 'geo' URI specifies an uncertainty value (";u=" parameter),
      the server MUST return the time zone identifiers for all time
      zones whose boundary passes through the radius of uncertainty.  In
      the absence of a client-supplied uncertainty value, the server MAY
      use an implicit uncertainty to coincide with any uncertainty in
      the time zone boundary data that it uses.

      If the 'geo' URI specifies a coordinate reference system (";crs="
      parameter) that is unsupported by the server, the server SHOULD
      return a JSON "problem details" object [RFC7807] in the response
      body including a "type" member with an "invalid-location" error
      URN as defined below.

   Parameters:

      location=<geo-URI>  REQUIRED, and MUST occur only once.

   Response:  The response has the same format as the "list" and "find"
      actions (see [RFC7808] Section 6.2), with one result object for
      each geolocated time zone.  If for any reason the server can not
      determine a time zone in which the point is located (e.g.
      uninhabited location), it MUST return a "list" response containing
      zero time zone objects.

   Possible Error Codes



Murchison                 Expires May 13, 2019                  [Page 3]

Internet-Draft         TZDIST Geolocate Extension          November 2018


      urn:ietf:params:tzdist:error:invalid-location  The "location" URI
         query parameter has an incorrect or unsupported value or
         appears more than once.

3.1.  Examples: geolocate action

   The examples below presume that the timezone context path has been
   discovered (see [RFC7808] Section 4.2.1) to be "/tzdist".

   In this example the client asks for the time zone corresponding to
   the Royal Observatory, Greenwich [ROG].

   >> Request <<

   GET /tzdist/zones?location=geo:51.47778,0.001388889 HTTP/1.1
   Host: tz.example.com

   >> Response <<

   HTTP/1.1 200 OK
   Date: Fri, 09 Nov 2018 13:43:28 GMT
   Content-Type: application/json; charset="utf-8"
   Content-Length: xxxx

   {
     "synctoken": "2860088640-1510059107",
     "timezones": [
       {
         "tzid": "Europe/London",
         "etag": "873664-1510059107",
         "last-modified": "2017-11-07T12:51:47Z",
         "publisher": "IANA Time Zone Database",
         "version": "2017c",
         "aliases": [
           "GB",
           "GB-Eire",
           "Europe/Isle_of_Man",
           "Europe/Guernsey",
           "Europe/Belfast",
           "Europe/Jersey"
         ]
       }
     ]
   }







Murchison                 Expires May 13, 2019                  [Page 4]

Internet-Draft         TZDIST Geolocate Extension          November 2018


   In this example the client asks for the time zone corresponding to
   Urumqi, Xinjiang, China [Urumqi].  Note that there are two different
   time standards [Xinjiang_Time] in use in this region.

   >> Request <<

   GET /tzdist/zones?location=geo:43.825,87.6 HTTP/1.1
   Host: tz.example.com

   >> Response <<

   HTTP/1.1 200 OK
   Date: Fri, 09 Nov 2018 13:45:31 GMT
   Content-Type: application/json; charset="utf-8"
   Content-Length: xxxx

   {
     "synctoken": "2860088640-1517192208",
     "timezones": [
       {
         "tzid": "Asia/Shanghai",
         "etag": "914662-1517192208",
         "last-modified": "2018-01-29T02:16:48Z",
         "publisher": "IANA",
         "version": "2018c",
         "aliases": [
           "Asia/Chungking",
           "Asia/Harbin",
           "Asia/Chongqing",
           "PRC"
         ]
       },
       {
         "tzid": "Asia/Urumqi",
         "etag": "229038-1517192208",
         "last-modified": "2018-01-29T02:16:48Z",
         "publisher": "IANA",
         "version": "2018c",
         "aliases": [
           "Asia/Kashgar"
         ]
       }
     ]
   }







Murchison                 Expires May 13, 2019                  [Page 5]

Internet-Draft         TZDIST Geolocate Extension          November 2018


   In this example the client asks for the timezone corresponding to the
   Niagara Falls [NF] with an uncertainty of 50m.  Note that the
   cataracts are located on the border of Ontario, Canada, and New York,
   United States, and therefore straddle a time zone boundary.

   >> Request <<

   GET /tzdist/zones?location=geo:43.0799,-79.0747;u=50 HTTP/1.1
   Host: tz.example.com

   >> Response <<

   HTTP/1.1 200 OK
   Date: Fri, 09 Nov 2018 13:58:07 GMT
   Content-Type: application/json; charset="utf-8"
   Content-Length: xxxx

   {
     "synctoken": "2860088640-1510059107",
     "timezones": [
       {
         "tzid": "America/New_York",
         "etag": "6602582-1510059107",
         "last-modified": "2017-11-07T12:51:47Z",
         "publisher": "IANA Time Zone Database",
         "version": "2017c",
         "aliases": [
           "US/Eastern"
         ]
       },
       {
         "tzid": "America/Toronto",
         "etag": "3297806-1510059107",
         "last-modified": "2017-11-07T12:51:47Z",
         "publisher": "IANA Time Zone Database",
         "version": "2017c",
         "aliases": [
           "America/Montreal",
           "Canada/Eastern"
         ]
       }
     ]
   }








Murchison                 Expires May 13, 2019                  [Page 6]

Internet-Draft         TZDIST Geolocate Extension          November 2018


4.  Security Considerations

   This specification does not introduce any additional security
   concerns beyond those described in Section 8 of [RFC7808]

5.  Privacy Considerations

   A client that uses this extension will leak the precise location of a
   user's device.  The strategies described in Section 9 of [RFC7808]
   can be used to diminish the ability of an untrusted server or network
   observer to track the device.

6.  IANA Considerations

6.1.  Service Action Registration

   This document defines the following new TZDIST Service Action to be
   added to the registry defined in Section 10.3.1 of [RFC7808]:

                   +-------------+--------------------+
                   | Action Name | Reference          |
                   +-------------+--------------------+
                   | geolocate   | RFCXXXX, Section 3 |
                   +-------------+--------------------+

6.2.  Registration of invalid-location Error URN

   This section registers the "urn:ietf:params:tzdist:error:invalid-
   location" URN in the "TZDIST Identifiers" registry defined in
   Section 10.4 of [RFC7808].

   URN:  urn:ietf:params:tzdist:error:invalid-location

   Description:  Error code for incorrect use of the "location" URI
      query parameter.

   Specification:  RFCXXXX, Section 3

   Contact:  IESG <iesg@ietf.org>

   Index value:  N/A.

7.  Acknowledgments

   The author would like to thank the following individuals for
   contributing their ideas and support for writing this specification:
   Cyrus Daboo, Michael Douglass, Paul Eggert, Eliot Lear, and Daniel
   Migault.



Murchison                 Expires May 13, 2019                  [Page 7]

Internet-Draft         TZDIST Geolocate Extension          November 2018


8.  References

8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC5870]  Mayrhofer, A. and C. Spanring, "A Uniform Resource
              Identifier for Geographic Locations ('geo' URI)",
              RFC 5870, DOI 10.17487/RFC5870, June 2010,
              <https://www.rfc-editor.org/info/rfc5870>.

   [RFC7807]  Nottingham, M. and E. Wilde, "Problem Details for HTTP
              APIs", RFC 7807, DOI 10.17487/RFC7807, March 2016,
              <https://www.rfc-editor.org/info/rfc7807>.

   [RFC7808]  Douglass, M. and C. Daboo, "Time Zone Data Distribution
              Service", RFC 7808, DOI 10.17487/RFC7808, March 2016,
              <https://www.rfc-editor.org/info/rfc7808>.

8.2.  Informative References

   [NF]       Wikipedia, "Niagara Falls",
              <https://en.wikipedia.org/wiki/Niagara_Falls>.

   [ROG]      Wikipedia, "Royal Observatory, Greenwich",
              <https://en.wikipedia.org/wiki/
              Royal_Observatory,_Greenwich>.

   [TZBB]     Siroky, E., "Timezone Boundary Builder",
              <https://github.com/evansiroky/timezone-boundary-builder>.

   [Urumqi]   Wikipedia, "Urumqi",
              <https://en.wikipedia.org/wiki/Urumqi>.

   [Xinjiang_Time]
              Wikipedia, "Xinjiang Time",
              <https://en.wikipedia.org/wiki/Xinjiang_Time>.

Appendix A.  Change History (To be removed by RFC Editor before
             publication)

   Changes since -02:

   o  Made it clear that this extension is primarily for use by mobile
      devices.



Murchison                 Expires May 13, 2019                  [Page 8]

Internet-Draft         TZDIST Geolocate Extension          November 2018


   o  Made it clear that multiple time zones may be returned for a
      specified location (with example).

   o  Minor editorial changes.

   Changes since -01:

   o  Minor editorial changes.

   Changes since -00:

   o  Updated author information.

   o  Changed locations used in examples.

   o  Closed issue "percent-encode 'geo' URI value" as unnecessary.

   o  Closed issue "advertise supported coordinate reference system" as
      unnecessary (only "wgs84" is defined for RFC 5870).

   o  Closed issue "discuss territorial and/or international waters" as
      unnecessary.

   o  Added privacy concern.

   o  Minor editorial changes.

Author's Address

   Kenneth Murchison
   FastMail US LLC
   1315 Walnut Street, Suite 320
   Philadelphia, PA  19107
   USA

   Email: murch@fastmailteam.com















Murchison                 Expires May 13, 2019                  [Page 9]
