CNAP-URI		   = URI-PARAMETERS
PROTOCOL-VERSION	   = 1*3DIGIT ; 0 TO 255
CNAS			   = 1*16DIGIT ; 
HOLDTIME		   = 1*3 DIGIT ; 0 TO 255
DISTRIB-LEVEL-TYPES  = ("MULTIPLE" | "SINGLE")
RRS-TYPE		   = ("DNS-CNAME")
IP-VERSION           = ("4" | "6")
IPV4-ADDRESS	   = 1*DIGIT "." 1*DIGIT "." 1*DIGIT "." 
                             1*DIGIT
IPV4-MASK	   	   = 1*DIGIT
IPV6-PARAMETER       = TBD
OTHER-PARAM		   = (token | (token "=" (token | 
                              QUOTED- STRING)))
ADVERT-TYPE		   = ("AREA" | "CONTENT")
CONTENT-AS-PATH	   = *((1*5DIGIT) [","])
AREA-LIST		   = *((IPV4-ADDRESS "&" IPV4-MASK)[","])
ERROR-DATA		   = *(ALPHANUM)
STATUS-TYPE		   = ("ADD" | "WITHDRAW")
REGION-ID-LIST	   = *((1*16DIGIT) [","])
REGION-ID            = *((1*32DIGIT) [","])
RDIR-VALUE		   = *(ALPHANUM)


generic-message	=	start-line
					[message-header]
					CRLF

message-header		=	( open-header
					| notification-header
					| advertisement-header )
   

Message-header = field-name ":" [field-value] CRLF
Field-name = token
Field-value = *(field-content |LWS)
Field-content = <the OCTETs making up the field-value and 
                    consisting of either TEXT-UTF8 or combinations 
                    of token, separators and quoted string>




start-line	=	Method CRLF

Method = "OPEN" | "NOTIFY" | "ADVERTISEMENT" | "KEEPALIVE"

   
open-header	= PROTOCOL-VERSION
PROTOCOL-VERSION = "Protocol-Version" ":" Protocol-Version

NODE-ID = " NODE-ID" ":" IPV4-ADDRESS, or
NODE-ID = " NODE-ID" ":" IPV6-ADDRESS 

Content-AS = "Content-AS" ":" CNAS




HOLDTIME = "HOLDTIME" ":" HOLDTIME 
 
DISTRIB-LEVEL = " DISTRIB-LEVEL" ":" DISTRIB-LEVEL-TYPE

RRS-TYPES = "RRS-TYPES" ":" *(RRS-TYPE)

CNAP-ABILITIES = *( CNAP-ABILITY)


notify-header	=   ERROR-CODE
			  | ERROR-SUBCODE
			  | ERROR-DATA
	
Error-Code = "Error-Code" ":" 3DIGIT



Error-Subcode = "Error-Subcode" ":" 3DIGIT

Error-Data = "Error-Data" ":" *(alphanum)

advertisement-header	=   ADVERTISEMENT-TYPE
			        | AUTHORITATIVE-CN
			        | CN-PATH
				  | (AREA-HEADER | CONTENT-HEADER)

ADVERTISEMENT-TYPE = "ADVERTISEMENT-TYPE" ":" ADVERT-TYPE

AUTHORITATIVE-CN = "AUTHORITATIVE-CN" ":" CONTENTAS

CN-PATH = "CN-PATH" ":" CONTENT-AS-PATH
	
content-header	=  CONTENT-SET
			  | STATUS
			  | REGION-LIST
			  | TTL
			  | REDIRECTION-INFO

CONTENT-SET = "CONTENT-SET" ":" *( (CNAP-URI) [","] )

Status = "Status" ":" status-type

Region-List = "Region-List" ":" region-id-list

TTL = "TTL" ":" 32DIGITS

REDIRECTION-INFO =   REDIRECTION-TYPE
			    | REDIRECTION-VALUE

REDIRECTION-TYPE = "REDIRECTION-TYPE" ":" RRS-TYPE
		      
    - Redirection-Value

      Value of redirection parameter set (terminated by CRLF like 
      other headers). See Section 4 for the structure of the 
      Redirection value for cname based request routing systems.

REDIRECTION-VALUE = "REDIRECTION-VALUE" ":" RDIR-VALUE
 
REDIRECTION-INFO = WITHDRAW-EFFECTIVE

    where,



WITHDRAW-EFFECTIVE = "WITHDRAW-EFFECTIVE" ":" 32DIGITS


area-header	=   AREA-SET
			  | STATUS
			  | REGION-LIST
			  | TTL
			  | METRIC-LIST


AREA-SET = "AREA-SET" ":" AREA-LIST
	
STATUS = "STATUS" ":" STATUS-TYPE

REGION-LIST = "REGION-LIST" ":" REGION-ID-LIST

TTL = "TTL" ":" 32DIGITS

METRIC-LIST = *(METRIC)

METRIC = METRIC-TYPE| METRIC-VALUE

METRIC-TYPE = "METRIC-TYPE" ":" 16DIGIT
   
METRIC-VALUE = "METRIC-VALUE" ":" *(ALPHANUM)

REDIRECTION-TYPE = "REDIRECTION-TYPE" ":" "DNS-CNAME"

REDIRECTION-VALUE = "REDIRECTION-VALUE" ":"
                                *(ALPHANUM)
   
