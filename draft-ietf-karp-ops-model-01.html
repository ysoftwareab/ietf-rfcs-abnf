<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Operations Model for Router Keying</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Requirements notation">
<link href="#rfc.section.3" rel="Chapter" title="3 Breakdown of KARP configuration">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Integrity of the Key Table">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Management of Key Table">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Protocol Limitations from the Key Table">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 VRFs">
<link href="#rfc.section.4" rel="Chapter" title="4 Credentials and Authorization">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Preshared Keys">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Asymmetric Keys">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Public Key Infrastructure">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 The role of Central Servers">
<link href="#rfc.section.5" rel="Chapter" title="5 Grouping Peers Together">
<link href="#rfc.section.6" rel="Chapter" title="6 Administrator Involvement">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Enrollment">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Handling Faults">
<link href="#rfc.section.7" rel="Chapter" title="7 Upgrade Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Related Work">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Developing an operational and management model for routing protocol security that works across protocols will be critical to the success of routing protocol security efforts. This document discusses issues and begins to consider development of these models." />
  <meta name="description" content="Developing an operational and management model for routing protocol security that works across protocols will be critical to the success of routing protocol security efforts. This document discusses issues and begins to consider development of these models." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">S. Hartman</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Painless Security</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">D. Zhang</td>
</tr>
<tr>
<td class="left">Expires: April 26, 2012</td>
<td class="right">Huawei</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 24, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Operations Model for Router Keying<br />
  <span class="filename">draft-ietf-karp-ops-model-01.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Developing an operational and management model for routing protocol security that works across protocols will be critical to the success of routing protocol security efforts. This document discusses issues and begins to consider development of these models.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 26, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Requirements notation</a>
</li>
<li>3.   <a href="#rfc.section.3">Breakdown of KARP configuration</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Integrity of the Key Table</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Management of Key Table</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Protocol Limitations from the Key Table</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">VRFs</a>
</li>
<li>4.   <a href="#rfc.section.4">Credentials and Authorization</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Preshared Keys</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Asymmetric Keys</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Public Key Infrastructure</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">The role of Central Servers</a>
</li>
<li>5.   <a href="#rfc.section.5">Grouping Peers Together</a>
</li>
<li>6.   <a href="#rfc.section.6">Administrator Involvement</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Enrollment</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Handling Faults</a>
</li>
<li>7.   <a href="#rfc.section.7">Upgrade Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Related Work</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgments</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The KARP working group is designing improvements to the cryptographic authentication of IETF routing protocols. These improvements include improvements to how integrity functions are handled within each protocol as well as designing an automated key management solution.</p>
<p id="rfc.section.1.p.2">This document discusses issues to consider when thinking about the operational and management model for KARP. Each implementation will take its own approach to management; this is one area for vendor differentiation. However, it is desirable to have a common baseline for the management objects allowing administrators, security architects and protocol designers to understand what management capabilities they can depend on in heterogeneous environments. Similarly, designing and deploying the protocol will be easier with thought paid to a common operational model. This will also help with the design of NetConf schemas or MIBs later.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Requirements notation</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Breakdown of KARP configuration</h1>
<p id="rfc.section.3.p.1">There are multiple ways of structuring configuration information. One factor to consider is the scope of the configuration information. Several protocols are peer-to-peer routing protocols where a different key could potentially be used for each neighbor. Other protocols require the same group key to be used for all nodes in an administrative domain or routing area. In other cases, the same group key needs to be used for all routers on an interface, but different group keys can be used for each interface.</p>
<p id="rfc.section.3.p.2">Within situations where a per-interface, per-area or per-peer key can be used for manually configured long-term keys, that flexibility may not be desirable from an operational standpoint. For example consider OSPF [RFC2328]. Each OSPF link needs to use the same authentication configuration, including the set of keys used for reception and the set of keys used for transmission, but may use different keys for different links. The most general management model would be to configure keys per link. However for deployments where the area uses the same key it would be strongly desirable to configure the key as a property of the area. If the keys are configured per-link, they can get out of sync. In order to support generality of configuration and common operational situations, it would be desirable to have some sort of inheritance where default configurations are made per-area unless overridden per-interface.</p>
<p id="rfc.section.3.p.3">As described in <a href="#I-D.housley-saag-crypto-key-table">[I-D.housley-saag-crypto-key-table]</a>, the cryptographic keys are separated from the interface configuration into their own configuration store. This document should specify how key selection interacts with the key table. One possible approach would be to assume that all keys that permit use on a given interface would be used on that interface with no additional configuration steps. If this model is adopted then the key table draft should be expanded to permit specification of domains and areas as well. It's not clear why "all" is permitted as an interface specification in this model; it seems unlikely that it would be desirable to use the same set of keys for two different instances of an IGP or across autonomous system boundaries. </p>
<p id="rfc.section.3.p.4">Another model is that the interface specification in the key table is a restriction that limits keys on top of other configuration enabling them. Then a set of keys from the key table is attached to an interface, area or routing domain using an additional configuration step. This avoids the previous problems at the expense of significant complexity of configuration. </p>
<p id="rfc.section.3.p.5">Operational Requirements: KARP MUST support configuration of keys at the most general scope for the underlying protocol; protocols supporting per-peer keys MUST permit configuration of per-peer keys, protocols supporting per-interface keys MUST support configuration of per-interface keys, and so on. KARP MUST NOT permit configuration of an inappropriate key scope. For example, configuration of separate keys per interface MUST NOT be supported for a protocol requiring per-area keys.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Integrity of the Key Table</h1>
<p id="rfc.section.3.1.p.1">The routing key table <a href="#I-D.housley-saag-crypto-key-table">[I-D.housley-saag-crypto-key-table]</a> provides a very general mechanism to abstract the storage of keys for routing protocols. To avoid misconfiguration and simplify problem determination, the router MUST verify the internal consistency of entries added to the table. At a minimum, the router MUST verify: </p>

<ul>
<li>The cryptographic algorithms are valid for the protocol.</li>
<li>The key derivation function is valid for the protocol.</li>
<li>The direction is valid for the protocol; for example protocols that require the same session key be used in both directions MUST have a direction of both.</li>
<li>The peer and interface specification is consistent with the protocol.</li>
</ul>

<p> </p>
<p id="rfc.section.3.1.p.2">Other checks are possible. For example the router could verify that if a key is associated with a peer, that peer is a configured peer for the specified protocol. However, this may be undesirable. It may be desirable to load a key table when some peers have not yet been configured. Also, it may be desirable to share portions of a key table across devices even when their current configuration does not require an adjacency with a particular peer in the interest of uniform configuration or preparing for fail-over. </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Management of Key Table</h1>
<p id="rfc.section.3.2.p.1">Several management operations will be quite common. For service provider deployments the configuration management system can simply update the key table. However, for smaller deployments, efficient management operations are important.</p>
<p id="rfc.section.3.2.p.2">As part of adding a new key it is typically desirable to set an expiration time for an old key. The management interface SHOULD provide a mechanism to easily update the expiration time for a current key used with a given peer or interface. Also when adding a key it is desirable to push the key out to nodes that will need it, allowing use for receiving packets then later enabling transmit. This can be accomplished automatically by providing a delay between when a key becomes valid for reception and transmission. However, some environments may not be able to predict when all the necessary changes will be made. In these cases having a mechanism to enable a key for sending is desirable.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Protocol Limitations from the Key Table</h1>
<p id="rfc.section.3.3.p.1">The format of the key table imposes a few limitations on routing protocols. The first is that the key ID is 16 bits; some routing protocols have 32-bit key identifiers. A key mapping table as discussed in 4.1 of <a href="#I-D.polk-saag-rtg-auth-keytable">[I-D.polk-saag-rtg-auth-keytable]</a> could be used to map to the larger key identifier. However it's probably desirable to either decide that only 16 bits of the key ID space is to be used or to expand the identifier space in the key table. From a management standpoint we need to make concrete requirements around whether a key ID is per-protocol or whether subspaces in the key ID space are reserved for each protocol. This is necessary so that implementations from different vendors can be managed consistently.</p>
<p id="rfc.section.3.3.p.2">The second requirement that the key table places is that the key ID is scoped fairly broadly. At least within some protocols such as OSPF, the key ID might only need to be unique per-link or per-peer. That is, packets sent on two different interfaces could use key ID 32 even if the keys were different for these interfaces. An implementation could use the interface and the key ID as a lookup to find the right key. However, the key table draft requires that a key ID be sufficient to look up a key, meaning that the key ID is a globally scoped identifier. There is nothing wrong with this restriction, but it does need to be noted when assigning key IDs for a domain. </p>
<p id="rfc.section.3.3.p.3">Consideration is required for how an automated key management protocol will assign key IDs for group keys. All members of the group may need to use the same key ID. This requires careful coordination of global key IDs. Interactions with the peer key ID field may make this easier; this requires additional study.</p>
<p id="rfc.section.3.3.p.4">Automated key management protocols also assign keys for single peers. If the key ID is global and needs to be coordinated between the receiver and transmitter, then there is complexity in key management protocols.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> VRFs</h1>
<p id="rfc.section.3.4.p.1">Many core and enterprise routers support multiple routing instances. For example a router serving multiple VPNs is likely to have a forwarding/routing instance for each of these VPNs. We need to decide how the key table and other configuration information for KARP interacts with this. The obvious first-order answer is that each routing instance gets its own key table. However, we need to consider how these instances interact with each other and confirm this makes sense.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Credentials and Authorization</h1>
<p id="rfc.section.4.p.1">Several methods for authentication have been proposed for KARP. The simplest is preshared keys used directly as traffic keys. In this mode, the traffic integrity keys are directly configured. This is the mode supported by today's routing protocols.</p>
<p id="rfc.section.4.p.2">As discussed in <a href="#I-D.polk-saag-rtg-auth-keytable">[I-D.polk-saag-rtg-auth-keytable]</a>, preshared keys can be used as the input to a key derivation function (KDF) to generate traffic keys. For example the TCP Authentication Option (TCP-AO) <a href="#RFC5925">[RFC5925]</a> derives keys based on the initial TCP session state. Typically a KDF will combine a long-term key with public inputs exchanged as part of the protocol to form fresh session keys. a KDF could potentially be used with some inputs that are configured along with the long-term key. Also, it's possible that inputs to a KDF will be private and exchanged as part of the protocol, although this will be uncommon in KARP's uses of KDFs. </p>
<p id="rfc.section.4.p.3">Preshared keys could also be used by an automated key management protocol. In this mode, preshared keys would be used for authentication. However traffic keys would be generated by some key agreement mechanism or transported in a key encryption key derived from the preshared key. This mode may provide better replay protection. Also, in the absence of active attackers, key agreement strategies such as Diffie-Hellman can be used to produce high-quality traffic keys even from relatively weak preshared keys.</p>
<p id="rfc.section.4.p.4">Public keys can be used for authentication. The design guide <a href="#I-D.ietf-karp-design-guide">[I-D.ietf-karp-design-guide]</a> describes a mode in which routers have the hashes of peer routers' public keys. In this mode, a traditional public-key infrastructure is not required. The advantage of this mode is that a router only contains its own keying material, limiting the scope of a compromise. The disadvantage is that when a router is added or deleted from the set of authorized routers, all routers that peer need to be updated. Note that self-signed certificates are a common way of communicating public-keys in this style of authentication.</p>
<p id="rfc.section.4.p.5">Certificates signed by a certification authority or some other PKI could be used. The advantage of this approach is that routers may not need to be directly updated when peers are added or removed. The disadvantage is that more complexity and cost is required.</p>
<p id="rfc.section.4.p.6">Each of these approaches has a different set of management and operational requirements. Key differences include how authorization is handled and how identity works. This section discusses these differences.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#PRESHARED" id="PRESHARED">Preshared Keys</a>
</h1>
<p id="rfc.section.4.1.p.1">In the protocol, manual preshared keys are either unnamed or named by a small integer (typically 16 or 32 bits) key ID. Implementations that support multiple keys for protocols that have no names for keys need to try all possible keys before deciding a packet cannot be validated <a href="#RFC4808">[RFC4808]</a>. Typically  key IDs are names used by  one group or peer.</p>
<p id="rfc.section.4.1.p.2">Manual preshared keys are often known by a group of peers rather than  just oneother  peer. This is an interesting security property: unlike with digitally signed messages or protocols where symmetric keys are known only to two parties, it is impossible to identify the peer sending a message cryptographically. However, it is possible to show that the sender of a message is one of the parties who knows the preshared key. Within the routing threat model the peer sending a message can be identified only because peers are trusted and thus can be assumed to correctly label the packets they send. This contrasts with a protocol where cryptographic means such as digital signatures are used to verify the origin of a message. As a consequence, authorization is typically based on knowing the preshared key rather than on being a particular peer. Note that once an authorization decision is made, the peer can assert its identity; this identity is trusted just as the routing information from the peer is trusted. Doing an additional check for authorization based on the identity included in the packet would provide little value: an attacker who somehow had the key could claim the identity of an authorized peer and an attacker without the key should be unable to claim the identity of any peer. Such a check is not required by the KARP threat model: inside attacks are not in scope.</p>
<p id="rfc.section.4.1.p.3">Preshared keys used with key derivation function similarly to manual preshared keys. However to form the actual traffic keys, session or peer specific information is combined with the key. From an authorization standpoint, the derivation key works the same as a manual key. An additional routing protocol step or transport step forms the key that is actually used.</p>
<p id="rfc.section.4.1.p.4">Preshared keys that are used via automatic key management have not been specified for KARP. Their naming and authorization may differ from existing uses of preshared keys in routing protocols. In particular, such keys may end up being known only by two peers. Alternatively they may also be known by a group of peers. Authorization could potentially be based on peer identity, although it is likely that knowing the right key will be sufficient. There does not appear to be a compelling reason to decouple the authorization of a key for some purpose from authorization of peers holding that key to perform the authorized function.</p>
<p id="rfc.section.4.1.p.5">Care needs to be taken when symmetric keys are used for multiple purposes. Consider the implications of using the same preshared key for two interfaces: it becomes impossible to cryptographically distinguish a router on one interface from a router on another interface. So, a router that is trusted to participate in a routing protocol on one interface becomes implicitly trusted for the other interfaces that share the key. For many cases, such as link-state routers in the same routing area, there is no significant advantage that an attacker could gain from this trust within the KARP threat model. However, distance-vector protocols, such as BGP and RIP, permit routes to be filtered across a trust boundary. For these protocols, participation in one interface might be more advantageous than another. Operationally, when this trust distinction is important to a deployment, different keys need to be used on each side of the trust boundary. Key derivation can help prevent this problem in cases of accidental misconfiguration. However, key derivation cannot protect against a situation where a system was incorrectly trusted to have the key used to perform the derivation. To the extent that there are multiple zones of trust and a routing protocol is determining whether a particular router is within a certain zone, the question of untrusted actors is within the scope of the routing threat model.</p>
<p id="rfc.section.4.1.p.6">Key derivation can be part of a management solution to a desire to have multiple keys for different zones of trust. A master key could be combined with peer, link or area identifiers to form a router-specific preshared key that is loaded onto routers. Provided that the master key lives only on the management server and not the individual routers, trust is preserved. However in many cases, generating independent keys for the routers and storing the result is more practical. If the master key were somehow compromised, all the resulting keys would need to be changed. However if independent keys are used, the scope of a compromise may be more limited.</p>
<p id="rfc.section.4.1.p.7">More subtle problems with key separation can appear in protocol design. Two protocols that use the same traffic keys may work together in unintended ways permitting one protocol to be used to attack the other. Consider two hypothetical protocols. Protocol A starts its messages with a set of extensions that are ignored if not understood. Protocol B has a fixed header at the beginning of its messages but ends messages with extension information. It may be that the same message is valid both as part of protocol A and protocol B. An attacker may be able to gain an advantage by getting a router to generate this message with one protocol under situations where the other protocol would not generate the message. This hypothetical example is overly simplistic; real-world attacks exploiting key separation weaknesses tend to be complicated and involve specific properties of the cryptographic functions involved. The key point is that whenever the same key is used in multiple protocols, attacks may be possible. All the involved protocols need to be analyzed to understand the scope of potential attacks. </p>
<p id="rfc.section.4.1.p.8">Key separation attacks interact with the KARP operational model in a number of ways. Administrators need to be aware of situations where using the same manual traffic key with two different protocols (or the same protocol in different contexts) creates attack opportunities. Design teams should consider how their protocol might interact with other routing protocols and describe any attacks discovered so that administrators can understand the operational implications. When designing automated key management or new cryptographic authentication within routing protocols, we need to be aware that administrators expect to be able to use the same preshared keys in multiple contexts. As a result, we should use appropriate key derivation functions so that different cryptographic keys are used even when the same initial input key is used.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Asymmetric Keys</h1>
<p id="rfc.section.4.2.p.1">Outside of a PKI, public keys are expected to be known by the hash of a key or (potentially self-signed) certificate. The Session Description Protocol provides a standardized mechanism for naming keys (in that case certificates) based on hashes  (section 5 <a href="#RFC4572">[RFC4572]</a>). KARP SHOULD adopt this approach or another approach already standardized within the IETF rather than inventing a new mechanism for naming public keys.</p>
<p id="rfc.section.4.2.p.2">A public key is typically expected to belong to one peer. As a peer generates new keys and retires old keys, its public key may change. For this reason, from a management standpoint, peers should be thought of as associated with multiple public keys rather than as containing a single public key hash as an attribute of the peer object.</p>
<p id="rfc.section.4.2.p.3">Authorization of public keys could be done either by key hash or by peer identity. Performing authorizations by peer identity should make it easier to update the key of a peer without risk of losing authorizations for that peer. However management interfaces need to be carefully designed to avoid making this extra level of indirection complicated for operators.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Public Key Infrastructure</h1>
<p id="rfc.section.4.3.p.1">When a PKI is used, certificates are used. The certificate binds a key to a name of a peer. The key management protocol is responsible for exchanging certificates and validating them to a trust anchor. </p>
<p id="rfc.section.4.3.p.2">Authorization needs to be done in terms of peer identities not in terms of keys. One reason for this is that when a peer changes its key, the new certificate needs to be sufficient for authentication to continue functioning even though the key has never been seen before. </p>
<p id="rfc.section.4.3.p.3">Potentially authorization could be performed in terms of groups of peers rather than single peers. An advantage of this is that it may be possible to add a new router with no authentication related configuration of the peers of that router. For example, a domain could decide that any router with a particular keyPurposeID signed by the organization's certificate authority is permitted to join the IGP. Just as in configurations where cryptographic authentication is not used, automatic discovery of this router can establish appropriate adjacencies.</p>
<p id="rfc.section.4.3.p.4">Assuming that potentially self-signed certificates are used by routers that wish to use public keys but that do not need a PKI, then PKI and the infrastructureless mode of public-key operation described in the previous section can work well together. One router could identify its peers based on names and use certificate validation. Another router could use hashes of certificates. This could be very useful for border routers between two organizations. Smaller organizations could use public keys and larger organizations could use PKI.</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> The role of Central Servers</h1>
<p id="rfc.section.4.4.p.1">An area to explore is the role of central servers like RADIUS or directories. As discussed in the design-guide, a system where keys are pushed by a central management system is undesirable as an end result for KARP. However central servers may play a role in authorization and key rollover. For example a node could send a hash of a public key to a RADIUS server. </p>
<p id="rfc.section.4.4.p.2">If central servers do play a role it will be critical to make sure that they are not required during routine operation or a cold-start of a network. They are more likely to play a role in enrollment of new peers or key migration/compromise.</p>
<p id="rfc.section.4.4.p.3">Another area where central servers may play a role is for group key agreement. As an example, <a href="#I-D.liu-ospfv3-automated-keying-req">[I-D.liu-ospfv3-automated-keying-req]</a> discusses the potential need for key agreement servers in OSPF. Other routing protocols that use multicast or broadcast such as IS-IS are likely to need a similar approach.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Grouping Peers Together</h1>
<p id="rfc.section.5.p.1">One significant management consideration will be the grouping of management objects necessary to determine who is authorized to act as a peer for a given routing action. As discussed previously, the following objects are potentially required:</p>

<ul>
<li>Key objects are required. Symmetric keys may be preshared. Asymmetric public keys may be used directly for authorization as well. During key transitions more than one key may refer to a given peer. Group preshared keys may refer to multiple peers.</li>
<li>A peer is a router that this router might wish to communicate with. Peers may be identified by names or keys.</li>
<li>Groups of peers may be authorized for a given routing protocol.</li>
</ul>

<p> </p>
<p id="rfc.section.5.p.2">Establishing a management model is difficult because of the complex relationships between each set of objects. As discussed there may be more than one key for a peer. However in the preshared key case, there may be more than one peer for a key. This is true both for group security association protocols such as an IGP or one-to-one protocols where the same key is used administratively. In some of these situations, it may be undesirable to explicitly enumerate the peers in the configuration; for example IGP peers are auto-discovered for broadcast links but not for non-broadcast multi-access links.</p>
<p id="rfc.section.5.p.3">Peers may be identified either by name or key. If peers are identified by key it is probably strongly desirable from an operational standpoint to consider any peer identifiers or name to be a local matter and not require the names or identifiers to be synchronized. Obviously if peers are identified by names (for example with certificates in a PKI), identifiers need to be synchronized between the authorized peer and the peer making the authorization decision. </p>
<p id="rfc.section.5.p.4">In many cases peers will explicitly be identified. In these cases it is possible to attach the authorization information (keys or identifiers) to the peer's configuration object. Two cases do not involve enumerating peers. The first is the case where preshared keys are shared among a group of peers. It is likely that this case can be treated from a management standpoint as a single peer representing all the peers that share the keys. The other case is one where certificates in a PKI are used to introduce peers to a router. In this case, rather than configuring peers, , the router needs to be configured with information on what certificates represent acceptable peers.</p>
<p id="rfc.section.5.p.5">Another consideration is what routing protocols share peers. For example it may be common for LDP peers to also be peers of some other routing protocol. Also, RSVP-TE may be associated with some TE-based IGP. In some of these cases it would be desirable to use the same authorization information for both routing protocols.</p>
<p id="rfc.section.5.p.6">In order to develop a management model for authorization, the working group needs to consider several questions. What protocols support auto-discovery of peers? What protocols require more configuration of a peer than simply the peer's authorization information and network address? What management operations are going to be common as security information for peers is configured and updated? What operations will be common while performing key transitions or while migrating to new security technologies?</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Administrator Involvement</h1>
<p id="rfc.section.6.p.1">One key operational question is what areas will administrator involvement be required. Likely areas where involvement may be useful includes enrollment of new peers. Fault recovery should also be considered.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Enrollment</h1>
<p id="rfc.section.6.1.p.1">One area where the management of routing security needs to be optimized is the deployment of a new router. In some cases a new router may be deployed on an existing network where routing to management servers is already available. In other cases, routers may be deployed as part of connecting or creating a site. Here, the router and infrastructure may not be available until the router has securely authenticated. This problem is similar to the problem of getting initial configuration of routing instances onto the router. However, especially in cases where asymmetric keys or per-peer preshared keys are used, the configuration of other routers needs to be modified to bring up the security association. Also, there has been discussion of generating keys on routers and not allowing them to leave devices. This also impacts what strategies are possible. For example this might mean that routers need to be booted in a secure environment where keys can be generated, and public keys copied to a management server to push out the new public key to potential peers. Then, the router needs to be packaged, moved to where it will be deployed and set up.Alternatives are possible; it is critical that we understand how what we propose impacts operators.</p>
<p id="rfc.section.6.1.p.2">We need to work through examples with operators familiar with specific real-world deployment practices and understand how proposed security mechanisms will interact with these practices. </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Handling Faults</h1>
<p id="rfc.section.6.2.p.1">Faults may interact with operational practice in at least two ways. First, security solutions may introduce faults. For example if certificates expire in a PKI, previous adjacencies may no longer form. Operational practice will require a way of repairing these errors. This may end up being very similar to deploying a router that is connecting a new site as the security fault may have partitioned the network. However, unlike a new deployment, the event is unplanned. Strategies such as configuring a router and shipping it to a site may not be appropriate for recovering a fault even though they may be more useful for new deployments.</p>
<p id="rfc.section.6.2.p.2">Monitoring will play a critical role in avoiding security faults such as certificate expiration. However, the protocols MUST still have adequate operational mechanisms to recover from these situations. Also, some faults, such as those resulting from a compromise or actual attack on a facility are inherent and may not be prevented.</p>
<p id="rfc.section.6.2.p.3">A second class of faults is equipment faults that impact security. For example if keys are stored on a router and never moved from that device, failure of a router implies a need to update security provisioning on the replacement router and its peers.</p>
<p id="rfc.section.6.2.p.4">To address these operational considerations, we should identify circumstances surrounding recovery from today's faults and understand how protocols will impact mechanisms used today.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Upgrade Considerations</h1>
<p id="rfc.section.7.p.1">It needs to be possible to deploy automated key management in an organization without either having to disable existing security or disrupting routing. As a result, it needs to be possible to perform a phased upgrade from manual keying to automated key management.</p>
<p id="rfc.section.7.p.2">For peer-to-peer protocols such as BGP, this is likely to be relatively easy. First, code that supports automated key management needs to be loaded on both peers. Then the adjacency can be upgraded. The configuration can be updated to switch to automated key management when the second router reboots.</p>
<p id="rfc.section.7.p.3">The situation is more complicated for multicast protocols. It's probably not reasonable to bring down an entire link to reconfigure it as using automated key management. Two approaches should be considered. One is to support key table rows from the automated key management and manually configured for the same link at the same time. Coordinating this may be tricky. Another possibility is for the automated key management protocol to actually select the same traffic key that is being used manually </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Related Work</h1>
<p id="rfc.section.8.p.1">Discuss draft-housley-saag-*, draft-polk-saag-*, the discussions in the KARP framework, etc.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<p id="rfc.section.9.p.1">This document does not define a protocol. It does discuss the operational and management implications of several security technologies.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgments</h1>
<p id="rfc.section.10.p.1">Funding for Sam Hartman's work on this memo is provided by Huawei.</p>
<p id="rfc.section.10.p.2">The authors would like to thank Gregory Lebovitz, Russ White and  Bill Atwood for valuable reviews.</p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.housley-saag-crypto-key-table">[I-D.housley-saag-crypto-key-table]</b></td>
<td class="top">
<a>Housley, R</a> and <a>T Polk</a>, "<a href="http://tools.ietf.org/html/draft-housley-saag-crypto-key-table-04">Database of Long-Lived Symmetric Cryptographic Keys</a>", Internet-Draft draft-housley-saag-crypto-key-table-04, October 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.liu-ospfv3-automated-keying-req">[I-D.liu-ospfv3-automated-keying-req]</b></td>
<td class="top">
<a>Liu, Y</a>, "<a href="http://tools.ietf.org/html/draft-liu-ospfv3-automated-keying-req-01">OSPFv3 Automated Group Keying Requirements</a>", Internet-Draft draft-liu-ospfv3-automated-keying-req-01, July 2007.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-karp-design-guide">[I-D.ietf-karp-design-guide]</b></td>
<td class="top">
<a>Lebovitz, G</a> and <a>M Bhatia</a>, "<a href="http://tools.ietf.org/html/draft-ietf-karp-design-guide-08">Keying and Authentication for Routing Protocols (KARP) Design Guidelines</a>", Internet-Draft draft-ietf-karp-design-guide-08, November 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2328">[RFC2328]</b></td>
<td class="top">
<a href="mailto:jmoy@casc.com" title="Ascend Communications, Inc.">Moy, J.</a>, "<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>", STD 54, RFC 2328, April 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4808">[RFC4808]</b></td>
<td class="top">
<a>Bellovin, S.</a>, "<a href="http://tools.ietf.org/html/rfc4808">Key Change Strategies for TCP-MD5</a>", RFC 4808, March 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4572">[RFC4572]</b></td>
<td class="top">
<a>Lennox, J.</a>, "<a href="http://tools.ietf.org/html/rfc4572">Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)</a>", RFC 4572, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.polk-saag-rtg-auth-keytable">[I-D.polk-saag-rtg-auth-keytable]</b></td>
<td class="top">
<a>Polk, T</a> and <a>R Housley</a>, "<a href="http://tools.ietf.org/html/draft-polk-saag-rtg-auth-keytable-05">Routing Authentication Using A Database of Long-Lived Cryptographic Keys</a>", Internet-Draft draft-polk-saag-rtg-auth-keytable-05, November 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5925">[RFC5925]</b></td>
<td class="top">
<a>Touch, J.</a>, <a>Mankin, A.</a> and <a>R. Bonica</a>, "<a href="http://tools.ietf.org/html/rfc5925">The TCP Authentication Option</a>", RFC 5925, June 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Sam Hartman</span> 
	  <span class="n hidden">
		<span class="family-name">Hartman</span>
	  </span>
	</span>
	<span class="org vcardline">Painless Security</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:hartmans-ietf@mit.edu">hartmans-ietf@mit.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dacheng Zhang</span> 
	  <span class="n hidden">
		<span class="family-name">Zhang</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:zhangdacheng@huawei.com">zhangdacheng@huawei.com</a></span>

  </address>
</div>

</body>
</html>