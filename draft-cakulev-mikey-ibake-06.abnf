K_PUBr=H1(IDRr||date)), where Hi is hash function known to all users,
K_PUBi=H1(IDRi||date)) and IBE-encrypts (IDRi, IDRr, [x]P, [y]P)
REQUEST_KEY_INIT_PSK =          ---->
REQUEST_KEY_INIT_PKE =          ---->
KEMAC = E(encr_key, (ID || K_PR))

I_MESSAGE_1 =                    ---->
I_MESSAGE_2 =                    ---->
IBAKE = E(encr_key, IDRi || ECCPTi || IDRr)

ESK = E(encr_key, ID || SK)

IBAKE = E(encr_key, IDRi || {ECCPTi} || IDRr || ECCPTr)

IBAKE = E(encr_key, IDRi || {ECCPTi} || IDRr || ECCPTr)

ESK = E(encr_key, ID || SK)

encr_key = K_PUBi) as follows:


IBAKE = E(encr_key, IDRi || ECCPTi)

I_MESSAGE_1 =                 ---->
I_MESSAGE_1 =                 ---->
