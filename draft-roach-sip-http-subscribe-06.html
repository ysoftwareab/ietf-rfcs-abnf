<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A SIP Event Package for Subscribing to Changes to an HTTP Resource</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A SIP Event Package for Subscribing to Changes to an HTTP Resource">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIP WG</td><td class="header">A. Roach</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Tekelec</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">December 19, 2009</td></tr>
<tr><td class="header">Expires: June 22, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />A SIP Event Package for Subscribing to Changes to an HTTP Resource<br />draft-roach-sip-http-subscribe-06</h1>

<h3>Abstract</h3>

<p>
      The Session Initiation Protocol (SIP) is increasingly being
      used in systems that are tightly coupled with Hypertext
      Transport Protocol (HTTP) servers for a variety of
      reasons. In many of these cases, applications
      can benefit from being able to discover, in near-real-time,
      when a specific HTTP resource is created, changed, or
      deleted. This document proposes a mechanism, based on
      the SIP events framework, for doing so.
    
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 22, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Associating Monitoring SIP URIs with HTTP URLs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Monitoring a Single HTTP Resource<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Monitoring Multiple HTTP Resources<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Rationale: Other Approaches Considered<br />
<a href="#package">4.</a>&nbsp;
HTTP Change Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.</a>&nbsp;
Event Package Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#event-parameters">4.2.</a>&nbsp;
Event Package Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.3.</a>&nbsp;
SUBSCRIBE Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.4.</a>&nbsp;
Subscription Duration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notify-bodies">4.5.</a>&nbsp;
NOTIFY Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.5.1.</a>&nbsp;
Use of message/http in HTTP Monitor Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.6.</a>&nbsp;
Notifier processing of SUBSCRIBE requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notifier-subscribe">4.7.</a>&nbsp;
Notifier generation of NOTIFY requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.8.</a>&nbsp;
Subscriber processing of NOTIFY requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.9.</a>&nbsp;
Handling of forked requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.10.</a>&nbsp;
Rate of notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.11.</a>&nbsp;
State Agents<br />
<a href="#anchor16">5.</a>&nbsp;
Example Message Flow<br />
<a href="#anchor17">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor18">7.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">7.1.</a>&nbsp;
New Link Relations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">7.1.1.</a>&nbsp;
New Link Relation: monitor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">7.1.2.</a>&nbsp;
New Link Relation: monitor-group<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">7.2.</a>&nbsp;
New SIP Event Package: http-monitor<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">7.3.</a>&nbsp;
New Event Header Field Parameter: body<br />
<a href="#anchor24">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
      The Session Initiation Protocol (SIP) 
      <a class='info' href='#RFC3261'>[3]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>
      is increasingly being
      used in systems that are tightly coupled with Hypertext
      Transport Protocol (HTTP) 
      <a class='info' href='#RFC2616'>[2]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>
      servers for a variety of
      reasons.  In many of these cases, applications
      can benefit from learning of changes to specified
      HTTP resources in near-real-time. For example,
      user agent terminals may elect to store service-related
      data in an HTTP tree. 

      

      When such configuration information is stored and retrieved
      using HTTP, clients may need to be informed when information
      changes, so as to make appropriate changes to their local behavior
      and user interface.
    
</p>
<p>
      This document defines a mechanism, based on the SIP Event Framework
      <a class='info' href='#RFC3265'>[4]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, for subscribing to changes in
      the resource referenced by an HTTP server.
      Such subscriptions do not necessarily carry the content
      associated with the resource.  In the cases that the content
      is not conveyed, the HTTP protocol is still used to transfer
      the contents of HTTP resources.

      This document further defines
      a mechanism by which the proper SIP and/or SIPS URI to be
      used for such subscriptions can be determined from the HTTP
      server.
    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
      The capitalized terms "MUST," "SHOULD," "MAY," "SHOULD NOT," and "MUST NOT"
      in this document are to be interpreted as described in RFC 2119
      <a class='info' href='#RFC2119'>[1]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
    
</p>
<p>
      Note that this document discusses both SIP messages and HTTP
      messages.  Because SIP's syntax was heavily based on HTTP's,
      the components of these messages have similar or identical
      names. When referring to message payloads, HTTP documents
      have historically preferred the hyphenated form "message-body",
      while SIP documents favor the unhyphenated form "message
      body". This document conforms to both conventions, using the
      hyphenated form for HTTP, and the unhyphenated form for SIP.
    
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Associating Monitoring SIP URIs with HTTP URLs</h3>

<p>
      One of the key challenges in subscribing to the changes
      of a resource indicated by an HTTP URL is determining
      which SIP URI corresponds to a specific HTTP URL. This
      specification takes the approach of having the HTTP
      server responsible for the URL in question select
      an appropriate SIP URI for the corresponding resource,
      and to return that URI within an HTTP transaction.
    
</p>
<p>
      In particular, HTTP servers use link relations --
      such as the HTTP Link: header field
      <a class='info' href='#I-D.nottingham-http-link-header'>[10]<span> (</span><span class='info'>Nottingham, M., &ldquo;Web Linking,&rdquo; July&nbsp;2009.</span><span>)</span></a>,
      the HTML &lt;link/> element <a class='info' href='#W3C.REC-html401-19991224'>[11]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.01 Specification,&rdquo; December&nbsp;1999.</span><span>)</span></a>,
      and the Atom &lt;atom:link/> element <a class='info' href='#RFC4287'>[5]<span> (</span><span class='info'>Nottingham, M., Ed. and R. Sayre, Ed., &ldquo;The Atom Syndication Format,&rdquo; December&nbsp;2005.</span><span>)</span></a> --
      to convey the URI or URIs that
      can be used to discover changes to the resource. 
      This document defines two new link relation types ("monitor"
      and "monitor-group") for this purpose, and specifies behavior
      for SIP and SIPS URIs in link relations of these types.
      Handling for other URI schemes is out of scope for the current
      document, although we expect future specifications to define
      procedures for monitoring via other protocols.
    
</p>
<p>
      Clients making use of the mechanism described in this document
      MUST support the HTTP Link: header field. Those clients that support
      processing of HTML documents SHOULD support the HTML
      &lt;link/> element; those that support processing of Atom
      documents SHOULD support Atom &lt;atom:link/> elements.
      These requirements are not intended to preclude the use of
      any other means of conveying link relations.
    
</p>
<p>
      The service that provides HTTP access to a resource might
      provide monitoring of that resource using multiple protocols,
      so it is perfectly legal for an HTTP
      response to contain
      multiple link relationships with relations that allow for
      monitoring of changes (see 
      <a class='info' href='#I-D.nottingham-http-link-header'>[10]<span> (</span><span class='info'>Nottingham, M., &ldquo;Web Linking,&rdquo; July&nbsp;2009.</span><span>)</span></a>).
      Implementors are cautioned to process all link relations
      to locate a one that corresponds with
      their preferred change monitoring protocol.
    
</p>
<p>
      These link relations are scoped to a single HTTP entity.  When
      an HTTP resource is associated with multiple entities (for
      example, to facilitate content negotiation), the "monitor"
      and "monitor-group" link relations will generally be different
      for each entity.
    
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Monitoring a Single HTTP Resource</h3>

<p>
        If an HTTP server wishes to offer the ability to subscribe to a
        changes in a resource's value using this event package,
        it returns a link relation containing a SIP or SIPS URI
        with a relation type of "monitor" in a successful response
        to a GET or HEAD request on that resource. If the server
        supports both SIP and SIPS access, it MAY return link
        relations for both kinds of access.
      
</p>
<p>
        A client wishing to subscribe to the change state of an HTTP
        resource obtains a SIP or SIPS URI by sending a GET or
        HEAD request to the HTTP URL it wishes to monitor. This SIP or
        SIPS URI is then used in a SUBSCRIBE request, according to the
        event package defined in <a class='info' href='#package'>Section&nbsp;4<span> (</span><span class='info'>HTTP Change Event Package</span><span>)</span></a>.
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Monitoring Multiple HTTP Resources</h3>

<p>
        If a client wishes to subscribe to the state of multiple
        HTTP resources, it is free to make use of the mechanisms
        defined in RFC 4662 <a class='info' href='#RFC4662'>[6]<span> (</span><span class='info'>Roach, A., Campbell, B., and J. Rosenberg, &ldquo;A Session Initiation Protocol (SIP) Event Notification Extension for Resource Lists,&rdquo; August&nbsp;2006.</span><span>)</span></a> and/or
        RFC 5367 <a class='info' href='#RFC5367'>[9]<span> (</span><span class='info'>Camarillo, G., Roach, A., and O. Levin, &ldquo;Subscriptions to Request-Contained Resource Lists in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2008.</span><span>)</span></a>. This requires no
        special support by the server that provides
        resource state information. These approaches, however,
        require the addition of a Resource List Server (RLS)
        as defined in RFC 4662, which will typically subscribe
        to the state of resources on behalf of the monitoring user.
        In many cases, this is not a particularly efficient
        means of monitoring several resources, particularly
        when such resources reside on the same HTTP server.
      
</p>
<p>
        As a more efficient alternative, if an HTTP server wishes
        to offer the ability to subscribe to the state of several
        HTTP resources in a single SUBSCRIBE request, it returns
        a link relation containing a SIP or SIPS URI with a relation
        type of "monitor-group" in a successful response to a GET
        or HEAD request on any monitorable resource.  In
        general, this monitor-group URI will be the same for all
        resources on the same HTTP server. 
      
</p>
<p>
        The monitor-group URI corresponds
        to an RLS service associated with the HTTP server. This
        RLS service MUST support subscriptions to request-contained
        resource lists, as defined in RFC 5367 <a class='info' href='#RFC5367'>[9]<span> (</span><span class='info'>Camarillo, G., Roach, A., and O. Levin, &ldquo;Subscriptions to Request-Contained Resource Lists in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
        This RLS service MAY, but is not required to, accept URI lists
        that include monitoring URIs that are not associated with
        resources served by its related HTTP server. Not requiring
        such functionality allows
        the RLS to be implemented without requiring back-end
        subscriptions. If a server wishes to reject such requests,
        the "403" (Forbidden) response code is appropriate. Any 
        "403" responses generated for this reason SHOULD contain
        a message body of type "application/resource-lists+xml"; this 
        message body
        lists the offending URI or URIs. See RFC 4826 
        <a class='info' href='#RFC4826'>[7]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Extensible Markup Language (XML) Formats for Representing Resource Lists,&rdquo; May&nbsp;2007.</span><span>)</span></a> for the definition of the
        "application/resource-lists+xml" MIME type.
      
</p>
<p>
        The HTTP server MUST also return a SIP and/or SIPS link relation with
        a relation type of "monitor" whenever it returns a SIP and/or
        SIPS link relation with a relation type of "monitor-group".
        The monitor-group URI corresponds only to an RLS, and never an HTTP
        resource or fixed set of HTTP resources.
      
</p>
<p>
        If a client wishes to subscribe to the state of multiple HTTP
        resources, and has received monitor-group URIs for each of them,
        it may use the monitor-group URIs to subscribe to multiple
        resources in the same subscription. To do so, it starts with the
        set of HTTP resources it wishes to monitor. It then groups
        these resources by their respective monitor-group URIs. Finally,
        for each such group, it initiates a subscription to the group's
        monitor-group URI; this subscription includes a URI list,
        as described in RFC 5367. The URI list contains all of the
        URIs in the group.
      
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
            For example: consider the case in which a client wishes
            to monitor the resources http://www.example.com/goat,
            http://www.example.com/sheep,
            http://www.example.org/llama, and
            http://www.example.org/alpaca. It would use HTTP to
            perform HEAD and/or GET operations on these resources.
            The responses to these operations will contain link relations
            for both monitor and monitor-type for each of the four
            resources. Assume the monitor link for 
            http://www.example.com/goat is sip:a94aa000@example.com;
            for http://www.example.com/sheep, sip:23ec24c5@example.com;
            for http://www.example.org/llama, sip:yxbO-UHYxyizU2H3dnEerQ@example.org;
            and for http://www.example.org/alpaca, sip:-J0piC0ihB9hfNaJc7GCBg@example.org.
            Further, assume the monitor-group link for http://www.example.com/goat
            and http://www.example.com/sheep are both sip:httpmon@rls.example.com,
            while the monitor-group link for http://www.example.org/llama and
            http://www.example.org/alpaca are both sip:rls@example.org.
          
</dd>
<dt></dt>
<dd>
            
            Because they share a common monitor-group link, the client
            would group together http://www.example.com/goat and
            http://www.example.com/sheep in a single subscription.
            It sends this subscription to the monitor-group URI
            (sip:httpmon@rls.example.com), with a resource-list
            containing the relevant monitor URIs (sip:a94aa000@example.com
            and sip:23ec24c5@example.com). It then repeats this process
            for the remaining two HTTP resources, using their monitor-group
            and monitor URIs in the same way.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Rationale: Other Approaches Considered</h3>

<p>
            <br />
<br />

            [This section will be removed before publication
            as an RFC]
          
</p>
<p>
            Several potential mechanisms for retrieving the SIP
            URI from the HTTP server were evaluated. Of them,
            link relations were determined to have the most
            favorable set of properties. Two key candidates
            that were considered but rejected in favor of link
            relations are discussed below.
          
</p>
<p>
            The HTTP PROPFIND method (<a class='info' href='#RFC4918'>[14]<span> (</span><span class='info'>Dusseault, L., &ldquo;HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV),&rdquo; June&nbsp;2007.</span><span>)</span></a>, section 9.1)
            can be used to retrieve the value of a
            specific property associated with an HTTP URL.
            However, this cannot be done in conjunction with
            retrieval of the document itself, which is
            usually desirable. If a PROPFIND approach is
            employed, clients will typically perform both a
            GET and a PROPFIND on resources of interest.
            Additionally, the use of PROPFIND requires
            support of the PROPFIND method in HTTP User
            Agents -- which, although fairly well implemented,
            still lacks the penetration of GET implementations.
          
</p>
<p>
            Similar to PROPFIND, XRDS 
            <a class='info' href='#XRI_Resolution_2.0'>[15]<span> (</span><span class='info'>Wachob, G., Reed, D., Chasen, L., Tan, W., and S. Churchill, &ldquo;Extensible Resource Identifier (XRI) Resolution V2.0,&rdquo; February&nbsp;2008.</span><span>)</span></a>
            can be used to retrieve properties associated with
            an HTTP URL. It has the advantage of using GET
            instead of PROPFIND; however, it suffers from both
            the two-round-trip issue discussed above, as well
            as an unfortunately large number of options in specifying
            how to retrieve the properties.
          
</p>
<a name="package"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
HTTP Change Event Package</h3>

<p>
    
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Event Package Name</h3>

<p>
            The name of this event package is "http-monitor".
          
</p>
<a name="event-parameters"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Event Package Parameters</h3>

<p>
            This event package defines a single parameter
            to be used with the "Event" header field. The syntax 
            for this parameter is shown below, using the
            ABNF format defined in RFC 5234
            <a class='info' href='#RFC5234'>[8]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
            The use of the
            construction "EQUAL" is as defined by RFC 3261
            <a class='info' href='#RFC3261'>[3]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  body-event-param = "body" EQUAL ( "true" / "false" )

</pre></div><p>

          
</p>
<p>
            If present and set to "true" in a SUBSCRIBE request,
            this parameter indicates to the server that the client
            wishes to receive a message-body component in the
            message/http message bodies sent in NOTIFY messages.
          
</p>
<p>
            If a server receives a SUBSCRIBE message with a "Event"
            header field "body" parameter set to "true", it MAY
            choose to include a message-body component in the
            message/http message bodies that it sends in NOTIFY
            messages.  Alternatively, it MAY decline to send such
            message-bodies, even when this parameter is present,
            based on local policy.  In particular, it would be quite
            reasonable for servers to have a policy of not including
            HTTP message-bodies larger than a relatively small
            number of bytes.
          
</p>
<p>
            When absent, the value of this parameter is assumed to be "false".
          
</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
            
            Note that this parameter refers to the message-body
            component of the HTTP message, not the message body
            component of the SIP message.
          
</dd>
</dl></blockquote>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
SUBSCRIBE Bodies</h3>

<p>
            This event package defines no message bodies to be used
            in the SUBSCRIBE message.
          
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Subscription Duration</h3>

<p>
           Reasonable values for the duration of subscriptions
           to the http-monitor event package vary widely with the
           nature of the HTTP resource being monitored. 
           Some HTTP resources change infrequently (if ever),
           while others can change comparatively rapidly. For
           rapidly changing documents, the ability to recover
           more rapidly from a subscription failure is relatively
           important, so implementations will be well served by
           selecting smaller durations for their subscriptions,
           on the order of 1800 to 3600 seconds (30 minutes to
           an hour).
          
</p>
<p>
           Subscriptions to slower-changing resources lack
           this property, and the need to periodically refresh
           subscriptions render short subscriptions wasteful. For
           these type of subscriptions, expirations as long as
           604800 (one week) or even longer may well make sense.
          
</p>
<p>
            The subscriber is responsible for selecting an expiration time
            that is appropriate for its purposes, taking the foregoing considerations
            into account.

	    Keep in mind that the goal behind selecting subscription
	    durations is to balance server load against time to
	    recover in the case of a failure.  In particular, short
	    subscription expiration times guard against the loss
	    of subscription server state, albeit at the expense of
	    additional load on the server.
	  
</p>
<p>
            In the absence of
            an expires value in a subscription, the notifier
            can assume a default expiration period according to local
            policy. This local policy might choose to take various aspects
            of the monitored resource into account, such as its
            age and presumed period of validity.
            Absent any other information, it would not be unreasonable
            for a server to assume a default expiration value of 86400
            (one day) when the client fails to provide one.
          
</p>
<a name="notify-bodies"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
NOTIFY Bodies</h3>

<p>
            By default, the message bodies of NOTIFY messages for the
            http-monitor event package will be of content-type
            "message/http," as defined in RFC 2616 <a class='info' href='#RFC2616'>[2]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
          
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Use of message/http in HTTP Monitor Event Package</h3>

<p>
              The message/http NOTIFY message bodies used in the
              HTTP monitor event package reflect a subset of the
              response that would be returned if the client performed
              an HTTP HEAD operation on the HTTP resource.
            
</p>
<p>
              An example of a message/http message body as used in this
              event package is shown below.
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 200 OK
  Date: Sat, 13 Nov 2010 17:18:52 GMT
  ETag: 38fe6-58b-1840e7d0
  Content-MD5: 4e3b50421829c7c379a5c6154e560449
  Last-Modified: Sat, 13 Nov 2010 03:29:00 GMT
  Accept-Ranges: bytes
  Content-Location: http://www.example.com/pet-profiles/alpacas/
  Content-Length: 12511
  Content-Type: text/html

</pre></div>
<p>
              When used in the HTTP monitor event package defined
              in this document, the message/http SHOULD contain at
              least one of an ETag or Content-MD5 header field,
              unless returning a null state as described in <a class='info' href='#notifier-subscribe'>Section&nbsp;4.7<span> (</span><span class='info'>Notifier generation of NOTIFY requests</span><span>)</span></a>.
              Inclusion of a Last-Modified header field is
              also RECOMMENDED.
              Additionally, the message/http message body MUST contain
              a Content-Location field that identifies the
              resource being monitored. Note that this is
              not necessarily the same URL from which the link
              association was originally obtained; see RFC 2616
              <a class='info' href='#RFC2616'>[2]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>
              for details.
            
</p>
<p>
              Except for the foregoing normative requirements,
              The decision regarding which HTTP header fields to
              include is at the discretion of the notifier.
            
</p>
<p>
              When used in the HTTP monitor event package,
              the message/http MUST NOT contain a message-body
              component, unless the corresponding subscription
              has explicitly indicated the desire to receive such
              bodies as described in <a class='info' href='#event-parameters'>Section&nbsp;4.2<span> (</span><span class='info'>Event Package Parameters</span><span>)</span></a>.
            
</p>
<p>
              If the change to the resource being communicated 
              represents a renaming of the HTTP resource, the
              message/http 
              start line will contain the same 3xx-class HTTP
              response that would be returned if a user agent
              attempted to access the relocated HTTP resource with
              a HEAD request (e.g., "301 Moved Permanently").
              The message/http also SHOULD contain a Location:
              header field that communicates the new name of the
              resource.
            
</p>
<p>
              If the change to the resource being communicated 
              represents a deletion of the HTTP resource, the
              start line will contain the same 4xx-class HTTP
              response that would be returned if a user agent
              attempted to access the missing HTTP resource with
              a HEAD request (e.g., "404 Not Found" or "410 Gone").
            
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Notifier processing of SUBSCRIBE requests</h3>

<p>
            Upon receipt of a SUBSCRIBE request, the notifier
            applies authorization according to local policy.
            Typically, this policy will be aligned with the
            HTTP server authorization policies regarding access
            to the resource whose change state is being requested.
          
</p>
<a name="notifier-subscribe"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Notifier generation of NOTIFY requests</h3>

<p>
            NOTIFY messages are generated whenever the
            underlying resource indicated by the corresponding
            HTTP URL has been modified.
          
</p>
<p>
            In the case that the notifier has insufficient information
            to return any useful information about the underlying
            HTTP resource, it MUST return a message body that is zero
            bytes long (subject to any mechanisms that would
            supress sending of a NOTIFY message).
          
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
Subscriber processing of NOTIFY requests</h3>

<p>
            Upon receipt of a NOTIFY message, the subscriber applies
            any information in the message/http to update its
            view of the underlying HTTP resource. In most cases,
            this results in an invalidation of its view of the
            HTTP resource. It is up to the subscriber implementation
            to decide whether it is appropriate to fetch a new copy
            of the HTTP resource as a reaction to a NOTIFY message.
          
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.9"></a><h3>4.9.&nbsp;
Handling of forked requests</h3>

<p>
            Multiple notifiers for a single HTTP resource
            is semantically nonsensical. In the aberrant
            circumstance that a SUBSCRIBE request is forked,
            the subscriber SHOULD terminate all but one
            subscription, as described in section 4.4.9
            of RFC 3265 <a class='info' href='#RFC3265'>[4]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
          
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.10"></a><h3>4.10.&nbsp;
Rate of notifications</h3>

<p>
            Because the data stored in HTTP for the
            purpose of SIP services may change rapidly
            due to user input, and because it may potentially
            be rendered to users and/or used to impact call
            routing, a high degree of responsiveness is
            appropriate. However, for the protection of
            the network, notifiers for the http-monitor event
            package SHOULD NOT send notifications
            more frequently than once every second.
          
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.11"></a><h3>4.11.&nbsp;
State Agents</h3>

<p>
            Decomposition of the authority for the HTTP
            resource into an HTTP Server and a SIP Events
            Server is likely to be useful, due to the
            potentially different scaling properties
            associated with serving HTTP resources and
            managing subscriptions. In the case of such
            decomposition, implementors are encouraged
            to familiarize themselves with the PUBLISH
            mechanism described in RFC 3903
            <a class='info' href='#RFC3903'>[12]<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a>.
          
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Example Message Flow</h3>

<p>
      The following is a simple example message flow, to aid
      in understanding how this event package can be used.
      It is included for illustrative purposes only,
      and does not form any portion of the specification of
      the mechanisms defined in this document.
    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Client            HTTP Server      SIP Events Server
          |                   |                   |
          |                   |                   |
          |(1) HTTP GET       |                   |
          |------------------&gt;|                   |
          |(2) HTTP 200 OK    |                   |
          |&lt;------------------|                   |
          |(3) SIP SUBSCRIBE  |                   |
          |--------------------------------------&gt;|
          |(4) SIP 200 OK     |                   |
          |&lt;--------------------------------------|
          |(5) SIP NOTIFY     |                   |
          |&lt;--------------------------------------|
          |(6) SIP 200 OK     |                   |
          |--------------------------------------&gt;|
          |                   |                   |
          |                   |                   |
          |        [HTTP document changes]        |
          |                   |                   |
          |                   |                   |
          |                   |(7) SIP PUBLISH    |
          |                   |------------------&gt;|
          |                   |(8) SIP 200 OK     |
          |                   |&lt;------------------|
          |(9) SIP NOTIFY     |                   |
          |&lt;--------------------------------------|
          |(10) SIP 200       |                   |
          |--------------------------------------&gt;|
          |                   |                   |
          |                   |                   |
</pre></div>
<p>
      The following messages illustrate only the 
      portions of the messages that are relevant
      to the example. They intentionally elide
      fields that, while typical or mandatory, are
      not key to understanding the foregoing message
      flow.
    
</p>
<p></p>
<ol class="text">
<li>
        The client issues a GET request to retrieve
        the document identified by the URL 
        "http://www.example.com/pet-profiles/alpacas/".
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /pet-profiles/alpacas/ HTTP/1.1
  Host: www.example.com
</pre></div>
<li>
        The HTTP server responds with the document,
        and several relevant pieces of meta-data. Of
        key interest for this example is the "Link" header field
        with a "rel" parameter of "monitor". This is the
        SIP URL that the client will use to monitor changes
        to the state of the HTTP resource. 
        Note that, since the message-body is an HTML document,
        the "monitor" link relation could alternately
        be indicated in the HTML document itself, through
        the use of a &lt;link/> element.
        <br />
<br />
Note also the
        presence of the "ETag", "Content-MD5", and "Last-Modified"
        header fields. These can be used by the client to identify
        the version of the entity returned by the HTTP
        server.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  ETag: 38fe6-58b-1840e7d0
  Content-MD5: 4e3b50421829c7c379a5c6154e560449
  Last-Modified: Sat, 13 Nov 2010 03:29:00 GMT
  Content-Location: http://www.example.com/pet-profiles/alpacas/
  Link: &lt;sip:23ec24c5@example.com&gt;; rel="monitor"
  Link: &lt;sip:httpmon@rls.example.com&gt;; rel="monitor-group"
  Content-Length: 12511
  Content-Type: text/html

  [HTML message-body]
</pre></div>
<li>
        The client sends a SUBSCRIBE request to the
        SIP URI indicated in the "monitor" link relation,
        indicating an event type of "http-monitor".
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  SUBSCRIBE sip:23ec24c5@example.com SIP/2.0
  To: &lt;sip:23ec24c5@example.com&gt;
  From: &lt;sip:adam@example.org&gt;;tag=57dac993-0b5b-4f04
  Event: http-monitor
  Contact: &lt;sip:adam@198.51.100.17:2487&gt;
</pre></div>
<li>
        The SIP Events server acknowledges receipt
        of the subscription request, and establishes
        a dialog for the resulting subscription.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  SIP/2.0 200 OK
  To: &lt;sip:23ec24c5@example.com&gt;;tag=907A953576E6
  From: &lt;sip:adam@example.org&gt;;tag=57dac993-0b5b-4f04
  Contact: &lt;sip:23ec24c5@203.0.113.72&gt;
</pre></div>
<li>
        The SIP Events server sends a NOTIFY message containing
        the current state of the HTTP resource. The client can
        compare the contents of the ETag, Content-MD5, or
        Last-Modified header fields against those received in
        the HTTP "200" response to verify that it has the most
        recent version of the entity.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  NOTIFY sip:adam@198.51.100.17:2487 SIP/2.0
  To: &lt;sip:adam@example.org&gt;;tag=57dac993-0b5b-4f04
  From: &lt;sip:23ec24c5@example.com&gt;;tag=907A953576E6
  Contact: &lt;sip:23ec24c5@203.0.113.72&gt;
  Event: http-monitor
  Subscription-State: active
  Content-Type: message/http

  HTTP/1.1 200 OK
  ETag: 38fe6-58b-1840e7d0
  Content-MD5: 4e3b50421829c7c379a5c6154e560449
  Last-Modified: Sat, 13 Nov 2010 03:29:00 GMT
  Content-Location: http://www.example.com/pet-profiles/alpacas/
  Content-Length: 12511
  Content-Type: text/html
</pre></div>
<li>
        The client acknowledges receipt of the NOTIFY message.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  SIP/2.0 200 OK
  To: &lt;sip:adam@example.org&gt;;tag=57dac993-0b5b-4f04
  From: &lt;sip:23ec24c5@example.com&gt;;tag=907A953576E6
  Contact: &lt;sip:adam@198.51.100.17:2487&gt;
</pre></div>
<li>
        At some point after the subscription has been established,
        the entity hosted by the HTTP server changes. It can convey
        this information to a SIP Events server using a SIP PUBLISH
        request. The PUBLISH message body contains information
        regarding the state of the entity.
        <br />
<br />

        Note that SIP PUBLISH is one of many ways such information
        could be conveyed -- any other means of communicating
        this information would also be valid.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  PUBLISH sip:23ec24c5@example.com SIP/2.0
  To: &lt;sip:23ec24c5@example.com&gt;
  From: &lt;sip:webserver@example.com&gt;;tag=03-5gbK652_jNMr-b8-11Z_G-NsLR
  Contact: &lt;sip:webserver@203.0.113.99&gt;
  Event: http-monitor
  Content-Type: message/http

  HTTP/1.1 200 OK
  ETag: 3238e-1a3-b83be580
  Content-MD5: 10a1ef5b223577059fafba867829abf8
  Last-Modified: Sat, 17 Nov 2010 08:17:39 GMT
  Content-Location: http://www.example.com/pet-profiles/alpacas/
  Content-Length: 17481
  Content-Type: text/html
</pre></div>
<li>
        The SIP Events server acknowledges the changed entity state.
        Note that the value of the "SIP-ETag" header field is not
        related to the "ETag" header field associated with the HTTP entity.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  SIP/2.0 200 OK
  To: &lt;sip:23ec24c5@example.com&gt;
  From: &lt;sip:webserver@example.com&gt;;tag=03-5gbK652_jNMr-b8-11Z_G-NsLR
  SIP-ETag: 3psbqi1o5633
</pre></div>
<li>
        The SIP events server informs the client of the change in
        state for the subscribed resource using a NOTIFY message.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  NOTIFY sip:adam@198.51.100.17:2487 SIP/2.0
  To: &lt;sip:adam@example.org&gt;;tag=57dac993-0b5b-4f04
  From: &lt;sip:23ec24c5@example.com&gt;;tag=907A953576E6
  Contact: &lt;sip:23ec24c5@203.0.113.72&gt;
  Event: http-monitor
  Subscription-State: active
  Content-Type: message/http

  HTTP/1.1 200 OK
  ETag: 3238e-1a3-b83be580
  Content-MD5: 10a1ef5b223577059fafba867829abf8
  Last-Modified: Sat, 17 Nov 2010 08:17:39 GMT
  Content-Location: http://www.example.com/pet-profiles/alpacas/
  Content-Length: 17481
  Content-Type: text/html
</pre></div>
<li>
        The client acknowledges receipt of the changed state.
        At this point, the client may choose to retrieve a
        fresh copy of the document so that it can act on the
        new content. Alternately, it may simply mark the
        previously retrieved document as out of date or
        discard it, choosing to retrieve a new copy at a
        later point in time.
      
</li><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  SIP/2.0 200 OK
  To: &lt;sip:adam@example.org&gt;;tag=57dac993-0b5b-4f04
  From: &lt;sip:23ec24c5@example.com&gt;;tag=907A953576E6
  Contact: &lt;sip:adam@198.51.100.17:2487&gt;
</pre></div>
</ol>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
      Unless secured using TLS, IPSEC, or a similar technology, the content of
      the Link header field is not secure, private or integrity-guaranteed.
    
</p>
<p>
      Because an unencrypted Link header field can be intercepted, server
      implementations are cautioned not to use the value sent in the "Link"
      header field as a security token that authenticates a subscriber, or
      that demonstrates authorization to subscribe to a particular resource. 
    
</p>
<p>
      Because an unsecured Link header field can be tampered with -- or inserted
      -- in transit, client implementations need to consider the interaction
      between their application and a forged set of notifications. This
      issue becomes particularly problematic when the change notifications
      include entity state (using "body=true").
    
</p>
<p>
      This mechanism introduces the means to learn information about the state
      of an HTTP resource using an alternate protocol, and potentially a different
      server. If the HTTP resource is restricted using some form of access
      control, special care MUST be taken to ensure that the SIP means of
      subscribing to the resource state is also restricted in the same
      way. Otherwise, unauthorized users may learn information that was intended to be
      confidential (including the actual resource value, in some cases).
    
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
New Link Relations</h3>

<p>
        The following entries are to be added to the "Link Relation Type
        Registry," as created by the "Web Linking" specification
        <a class='info' href='#I-D.nottingham-http-link-header'>[10]<span> (</span><span class='info'>Nottingham, M., &ldquo;Web Linking,&rdquo; July&nbsp;2009.</span><span>)</span></a>.

          </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
              
              Note: In the case that
              the final, published version of "Web Linking"
              <a class='info' href='#I-D.nottingham-http-link-header'>[10]<span> (</span><span class='info'>Nottingham, M., &ldquo;Web Linking,&rdquo; July&nbsp;2009.</span><span>)</span></a>
              does not deprecate the registry defined in RFC4287
              <a class='info' href='#RFC4287'>[5]<span> (</span><span class='info'>Nottingham, M., Ed. and R. Sayre, Ed., &ldquo;The Atom Syndication Format,&rdquo; December&nbsp;2005.</span><span>)</span></a>, this section
              will be changed to add the link relations to the registry
              defined by RFC 4287.
              [This note to be removed prior to publication as an RFC]
            
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.1"></a><h3>7.1.1.&nbsp;
New Link Relation: monitor</h3>

<p></p>
<ul class="text">
<li> Relation Name: monitor
</li>
<li> Description: Refers to a resource that can be used to monitor 
              changes in an HTTP resource.
</li>
<li> Reference: RFC XXXX [[Note to RFC Editor: replace 
                                  with the RFC number for this specification]]
</li>
</ul>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.2"></a><h3>7.1.2.&nbsp;
New Link Relation: monitor-group</h3>

<p></p>
<ul class="text">
<li> Relation Name: monitor-group
</li>
<li> Description: Refers to a resource that can be used to monitor 
              changes in a specified group of HTTP resources.
</li>
<li> Reference: RFC XXXX [[Note to RFC Editor: replace 
                                  with the RFC number for this specification]]
</li>
</ul>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
New SIP Event Package: http-monitor</h3>

<p>
        The following entry is to be added to the "SIP Events" registry,
        as created by the SIP Event Framework <a class='info' href='#RFC3265'>[4]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Package Name:</dt>
<dd>http-monitor
</dd>
<dt>Type:</dt>
<dd>package
</dd>
<dt>Contact:</dt>
<dd>Adam Roach, adam@nostrum.com
</dd>
<dt>Reference:</dt>
<dd>RFC XXXX [[Note to RFC Editor: replace 
                               with the RFC number for this specification]]
</dd>
</dl></blockquote>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
New Event Header Field Parameter: body</h3>

<p>
        The following entry is to be added to the SIP 
        "Header Field Parameters and Parameter Values" registry,
        as created by the SIP Change Framework <a class='info' href='#RFC3968'>[13]<span> (</span><span class='info'>Camarillo, G., &ldquo;The Internet Assigned Number Authority (IANA) Header Field Parameter Registry for the Session Initiation Protocol (SIP),&rdquo; December&nbsp;2004.</span><span>)</span></a>.
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Header Field:</dt>
<dd>Event
</dd>
<dt>Parameter Name:</dt>
<dd>body
</dd>
<dt>Predefined Values:</dt>
<dd>yes
</dd>
<dt>Reference:</dt>
<dd>RFC XXXX [[Note to RFC Editor: replace 
                               with the RFC number for this specification]]
</dd>
</dl></blockquote>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>
      Thanks to Lisa Dusseault and Mark Nottingham for significant
      input on the mechanisms to bind an HTTP URL to a SIP URI.
      Thanks also to Mark Nottingham and Theo Zourzouvillys for
      thorough feedback on early versions of this document. Thanks
      to Martin Thompson, Shida Schubert, John Elwell, and 
      Scott Lawrence for their careful reviews and feedback.
    
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[1]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[2]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[3]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[4]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4287">[5]</a></td>
<td class="author-text"><a href="mailto:mnot@pobox.com">Nottingham, M., Ed.</a> and <a href="mailto:rfsayre@boswijck.com">R. Sayre, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4287">The Atom Syndication Format</a>,&rdquo; RFC&nbsp;4287, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4287.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4287.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4287.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4662">[6]</a></td>
<td class="author-text">Roach, A., Campbell, B., and J. Rosenberg, &ldquo;<a href="http://tools.ietf.org/html/rfc4662">A Session Initiation Protocol (SIP) Event Notification Extension for Resource Lists</a>,&rdquo; RFC&nbsp;4662, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4662.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4826">[7]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4826">Extensible Markup Language (XML) Formats for Representing Resource Lists</a>,&rdquo; RFC&nbsp;4826, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4826.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[8]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5367">[9]</a></td>
<td class="author-text">Camarillo, G., Roach, A., and O. Levin, &ldquo;<a href="http://tools.ietf.org/html/rfc5367">Subscriptions to Request-Contained Resource Lists in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;5367, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5367.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.nottingham-http-link-header">[10]</a></td>
<td class="author-text">Nottingham, M., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-nottingham-http-link-header-06.txt">Web Linking</a>,&rdquo; draft-nottingham-http-link-header-06 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-nottingham-http-link-header-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-html401-19991224">[11]</a></td>
<td class="author-text">Hors, A., Jacobs, I., and D. Raggett, &ldquo;<a href="http://www.w3.org/TR/1999/REC-html401-19991224">HTML 4.01 Specification</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-html401-19991224, December&nbsp;1999 (<a href="http://www.w3.org/TR/1999/REC-html401-19991224">HTML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3903">[12]</a></td>
<td class="author-text">Niemi, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3903">Session Initiation Protocol (SIP) Extension for Event State Publication</a>,&rdquo; RFC&nbsp;3903, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3903.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3968">[13]</a></td>
<td class="author-text">Camarillo, G., &ldquo;<a href="http://tools.ietf.org/html/rfc3968">The Internet Assigned Number Authority (IANA) Header Field Parameter Registry for the Session Initiation Protocol (SIP)</a>,&rdquo; BCP&nbsp;98, RFC&nbsp;3968, December&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3968.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4918">[14]</a></td>
<td class="author-text">Dusseault, L., &ldquo;<a href="http://tools.ietf.org/html/rfc4918">HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)</a>,&rdquo; RFC&nbsp;4918, June&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4918.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XRI_Resolution_2.0">[15]</a></td>
<td class="author-text">Wachob, G., Reed, D., Chasen, L., Tan, W., and S. Churchill, &ldquo;<a href="http://docs.oasis-open.org/xri/2.0/specs/xri-resolution-V2.0.html">Extensible Resource Identifier (XRI) Resolution V2.0</a>,&rdquo; February&nbsp;2008 (<a href="http://docs.oasis-open.org/xri/2.0/specs/xri-resolution-V2.0.pdf">PDF</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Adam Roach</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tekelec</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">17210 Campbell Rd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 250</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dallas, TX  75252</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:adam@nostrum.com">adam@nostrum.com</a></td></tr>
</table>
</body></html>
