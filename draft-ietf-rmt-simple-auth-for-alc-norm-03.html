<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Simple Authentication Schemes for the ALC and NORM Protocols</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Simple Authentication Schemes for the ALC and NORM Protocols">
<meta name="keywords" content="TESLA, FLUTE, ALC, NORM">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">RMT</td><td class="header">V. Roca</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">INRIA</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">July 2, 2010</td></tr>
<tr><td class="header">Expires: January 3, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Simple Authentication Schemes for the ALC and NORM Protocols<br />draft-ietf-rmt-simple-auth-for-alc-norm-03</h1>

<h3>Abstract</h3>

<p>
                This document introduces four schemes that provide a per-packet authentication and 
		integrity service in the context of the ALC and NORM protocols.
		The first scheme is based on digital signatures.
		Because it relies on asymmetric cryptography, this scheme generates a high processing
		load at the sender and to a lesser extent at a receiver, as well as a significant
		transmission overhead.
		It is therefore well suited to low data rate sessions.
		The second scheme relies on the Elliptic Curve Digital Signature Algorithm (ECDSA).
		If this approach also relies an asymmetric cryptography, the processing load
		and the transmission overhead are significantly reduced compared to traditional
		digital signature schemes.
		It is therefore well suited to medium data rate sessions.
		The third scheme relies on a group Message Authentication Code (MAC).
		Because this scheme relies on symmetric cryptography, MAC calculation and verification
		are fast operations, which makes it suited to high data rate sessions.
		However it only provides a group authentication and integrity service, which means
		that it only protects against attackers that are not group members.
		Finally, the fourth scheme merges the digital signature and group group schemes,
		and is useful to mitigate DoS attacks coming from attackers that are not group members.
                
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 3, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Scope of this Document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.2.</a>&nbsp;
Conventions Used in this Document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.3.</a>&nbsp;
Terminology and Notations<br />
<a href="#anchor4">2.</a>&nbsp;
RSA Digital Signature Scheme<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:signature_principles">2.1.</a>&nbsp;
Principles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signature_params">2.2.</a>&nbsp;
Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:signature_auth_he_format">2.3.</a>&nbsp;
Authentication Header Extension Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:signature_auth_he_use">2.4.</a>&nbsp;
In Practice<br />
<a href="#anchor5">3.</a>&nbsp;
Elliptic Curve Digital Signature Scheme<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:ecc_signature_principles">3.1.</a>&nbsp;
Principles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ecc_signature_params">3.2.</a>&nbsp;
Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:ecc_signature_auth_he_format">3.3.</a>&nbsp;
Authentication Header Extension Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:ecc_signature_auth_he_use">3.4.</a>&nbsp;
In Practice<br />
<a href="#anchor6">4.</a>&nbsp;
Group Message Authentication Code (MAC) Scheme<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:group_mac_principles">4.1.</a>&nbsp;
Principles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#group_mac_params">4.2.</a>&nbsp;
Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:group_mac_auth_he_format">4.3.</a>&nbsp;
Authentication Header Extension Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:group_mac_auth_he_use">4.4.</a>&nbsp;
In Practice<br />
<a href="#anchor7">5.</a>&nbsp;
Combined Use of the RSA/ECC Digital Signatures and Group MAC Schemes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:combined_use_principles">5.1.</a>&nbsp;
Principles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#combined_params">5.2.</a>&nbsp;
Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:combined_auth_he_format">5.3.</a>&nbsp;
Authentication Header Extension Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:combined_use_auth_he_use">5.4.</a>&nbsp;
In Practice<br />
<a href="#sec:iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor8">7.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">7.1.</a>&nbsp;
Dealing With DoS Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">7.2.</a>&nbsp;
Dealing With Replay Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">7.2.1.</a>&nbsp;
Impacts of Replay Attacks on the Simple Authentication Schemes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">7.2.2.</a>&nbsp;
Impacts of Replay Attacks on NORM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">7.2.3.</a>&nbsp;
Impacts of Replay Attacks on ALC<br />
<a href="#anchor14">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
Many applications using multicast and broadcast communications
require that each receiver be able to authenticate the source of any
packet it receives to check check its integrity.
For instance, ALC <a class='info' href='#RFC5775'>[RFC5775]<span> (</span><span class='info'>Luby, M., Watson, M., and L. Vicisano, &ldquo;Asynchronous Layered Coding (ALC) Protocol Instantiation,&rdquo; April&nbsp;2010.</span><span>)</span></a> and NORM <a class='info' href='#RFC5740'>[RFC5740]<span> (</span><span class='info'>Adamson, B., Bormann, C., Handley, M., and J. Macker, &ldquo;NACK-Oriented Reliable Multicast (NORM) Transport Protocol,&rdquo; November&nbsp;2009.</span><span>)</span></a>
are two Content Delivery Protocols (CDP) designed to transfer reliably
objects (e.g. files) between a session's sender and several receivers.

</p>
<p>
The NORM protocol is based on bidirectional transmissions.
Each receiver acknowledges data received or, in case of packet erasures,
asks for retransmissions.
On the opposite, the ALC protocol defines unidirectional transmissions.
Reliability can be achieved by means of cyclic transmissions of the content
within a carousel, or by the use of proactive Forward Error Correction codes
(FEC), or by the joint use of these mechanisms.
Being purely unidirectional, ALC is massively scalable, while NORM is
intrinsically limited in terms of the number of receivers that can
be handled in a session.
Both protocols have in common the fact that they operate at application
level, on top of an erasure channel (e.g. the Internet) where packets
can be lost (erased) during the transmission.

</p>
<p>
With these CDP, an attacker might impersonate the ALC or NORM
session sender and inject forged packets to the receivers, thereby
corrupting the objects reconstructed by the receivers.
An attacker might also impersonate a NORM session receiver and
inject forged feedback packets to the NORM sender.

</p>
<p>
In case of group communications, several solutions exist to provide
the receiver some guaranties on the integrity of the packets it
receives and on the identity of the sender of these packets.
These solutions have different features that make them more or
less suited to a given use case:
</p>
<ul class="text">
<li>digital signatures <a class='info' href='#RFC4359'>[RFC4359]<span> (</span><span class='info'>Weis, B., &ldquo;The Use of RSA/SHA-1 Signatures within Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; January&nbsp;2006.</span><span>)</span></a>:
		this scheme is well suited to low data rate flows, when a
		true packet sender authentication and packet integrity service
		is needed.
		However, digital signatures based on RSA asymmetric cryptography
		is limited by high computational costs and high transmission overheads.
		The use of ECC ("Elliptic Curve Cryptography") significantly relaxes
		these constraints, especially when seeking for higher security levels.
		For instance, the following key sizes provide equivalent
		security: 1024 bit RSA key versus 160 bit ECC key, or
		2048 bit RSA key versus 224 bit ECC key.

	
</li>
<li>group Message Authentication Codes (MAC):
		this scheme is well suited to high data rate flows, when
		transmission overheads must be minimized.
		However this scheme cannot protect against attacks coming from
		inside the group, where a group member impersonates the sender
		and sends forged messages to other receivers.
	
</li>
<li>TESLA (Timed Efficient Stream Loss-tolerant Authentication)
		<a class='info' href='#RFC4082'>[RFC4082]<span> (</span><span class='info'>Perrig, A., Song, D., Canetti, R., Tygar, J., and B. Briscoe, &ldquo;Timed Efficient Stream Loss-Tolerant Authentication (TESLA):           Multicast Source Authentication Transform Introduction,&rdquo; June&nbsp;2005.</span><span>)</span></a><a class='info' href='#RFC5776'>[RFC5776]<span> (</span><span class='info'>Roca, V., Francillon, A., and S. Faurite, &ldquo;Use of Timed Efficient Stream Loss-Tolerant Authentication (TESLA) in the Asynchronous Layered Coding (ALC) and NACK-Oriented Reliable Multicast (NORM) Protocols,&rdquo; April&nbsp;2010.</span><span>)</span></a>:
		this scheme is well suited to high data rate flows, when
		transmission overheads must be minimized, and when a
		true packet sender authentication and packet integrity service
		is needed.
		The price to pay is an increased complexity, in particular the
		need to loosely synchronize the receivers and the sender, as
		well as the need to wait for the key to be disclosed before
		being able to authenticate a packet.
	
</li>
</ul><p>

</p>
<p>The following table summarizes the pros/cons of each
authentication/integrity scheme used at application/transport
level (where "-" means bad, "0" means neutral, and "+" means good):
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="left"></th><th align="center">RSA Digital Signature</th><th align="center">ECC Digital Signature</th><th align="center">Group MAC</th><th align="center">TESLA</th></tr>
<tr>
<td align="left">True auth and integrity</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="center">No (group security)</td>
<td align="center">Yes</td>
</tr>
<tr>
<td align="left">Immediate auth</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>
<tr>
<td align="left">Processing load</td>
<td align="center">-</td>
<td align="center">0</td>
<td align="center">+</td>
<td align="center">+</td>
</tr>
<tr>
<td align="left">Transmission overhead</td>
<td align="center">-</td>
<td align="center">0</td>
<td align="center">+</td>
<td align="center">+</td>
</tr>
<tr>
<td align="left">Complexity</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">-</td>
</tr>
</table>
<br clear="all" />

<p>
Several authentication schemes MAY be used in the same ALC or NORM session,
even on the same communication path.
Since all the above schemes make use of the same authentication header extension mechanism
(<a class='info' href='#sec:signature_auth_he_format'>Section&nbsp;2.3<span> (</span><span class='info'>Authentication Header Extension Format</span><span>)</span></a>, <a class='info' href='#sec:group_mac_auth_he_format'>Section&nbsp;4.3<span> (</span><span class='info'>Authentication Header Extension Format</span><span>)</span></a>,
<a class='info' href='#sec:combined_auth_he_format'>Section&nbsp;5.3<span> (</span><span class='info'>Authentication Header Extension Format</span><span>)</span></a>) and <a class='info' href='#RFC5776'>[RFC5776]<span> (</span><span class='info'>Roca, V., Francillon, A., and S. Faurite, &ldquo;Use of Timed Efficient Stream Loss-Tolerant Authentication (TESLA) in the Asynchronous Layered Coding (ALC) and NACK-Oriented Reliable Multicast (NORM) Protocols,&rdquo; April&nbsp;2010.</span><span>)</span></a>, section 5.1),
the same 4-bit "ASID" (Authentication Scheme IDentifier) has been reserved
in all the specifications.
The association between the "ASID" value and the actual authentication
scheme is defined at session startup and communicated to all the group members
by an out-of-band mechanism.

</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Scope of this Document</h3>

<p>
<a class='info' href='#RFC5776'>[RFC5776]<span> (</span><span class='info'>Roca, V., Francillon, A., and S. Faurite, &ldquo;Use of Timed Efficient Stream Loss-Tolerant Authentication (TESLA) in the Asynchronous Layered Coding (ALC) and NACK-Oriented Reliable Multicast (NORM) Protocols,&rdquo; April&nbsp;2010.</span><span>)</span></a> explains how to
use TESLA in the context of ALC and NORM protocols.

</p>
<p>
The current document specifies the use of 
the Digital Signature based on RSA asymmetric cryptography, the Elliptic
Curve Digital Signature Algorithm (ECDSA)  and Group MAC schemes.
The current document also specifies the joint use of Digital Signature
and Group MAC schemes which is useful to mitigate DoS attacks coming
from attackers that are not group members.

</p>
<p>
Unlike the TESLA scheme, this specification considers the authentication/integrity
of the packets generated by the session's sender as well as those generated
by the receivers (NORM).

</p>
<p>
All the applications build on top of ALC and NORM
directly benefit from the source authentication and packet
integrity services defined in this document.
For instance this is the case of  the FLUTE application
<a class='info' href='#RMT-FLUTE'>[RMT&#8209;FLUTE]<span> (</span><span class='info'>Paila, T., Walsh, R., Luby, M., Lehtonen, R., and V. Roca, &ldquo;FLUTE - File Delivery over Unidirectional Transport,&rdquo; March&nbsp;2010.</span><span>)</span></a> built on top of ALC.

</p>
<p>
The current specification assumes that several parameters
(like keying material) are communicated out-of-band, sometimes
securely, between the sender and the receivers.
This is detailed in <a class='info' href='#signature_params'>Section&nbsp;2.2<span> (</span><span class='info'>Parameters</span><span>)</span></a> and
<a class='info' href='#group_mac_params'>Section&nbsp;4.2<span> (</span><span class='info'>Parameters</span><span>)</span></a>.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Conventions Used in this Document</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
and "OPTIONAL" in this document are to be interpreted as
described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Terminology and Notations</h3>

<p>
The following notations and definitions are used throughout this document:
</p>
<ul class="text">
<li>MAC is the Message Authentication Code;
</li>
<li>HMAC is the Keyed-Hash Message Authentication Code;
</li>
<li>sender denotes the sender of a packet that needs the
		authentication/integrity check service.
		It can be an ALC or NORM session sender, or a NORM session
		receiver in case of feedback traffic;
</li>
<li>receiver denotes the receiver of a packet  that needs the
		authentication/integrity check service.
		It can be an ALC or NORM session receiver, or a NORM session
		sender in case of feedback traffic;
</li>
</ul><p>

</p>
<p>
Digital signature related notations and definitions:
</p>
<ul class="text">
<li>K_pub is the public key used by a receiver to check a packet's signature.
		This key MUST be communicated to all receivers, before starting the
		session;
</li>
<li>K_priv is the private key used by a sender to generate a packet's signature;
</li>
<li>n_k is the private key and public key length, in bits.
	n_k is also the signature length, since both values are equal with digital signatures;
</li>
</ul><p>

</p>
<p>
Group MAC related notations and definitions:
</p>
<ul class="text">
<li>K_g is a shared group key used by the senders and the receivers.
		This key MUST be communicated to all group members, confidentially,
		before starting the session;
</li>
<li>n_k is the group key length, in bits;
</li>
<li>n_m is the length of the truncated output of the MAC <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>.
		Only the n_m left-most bits (most significant bits) of the MAC
		output are kept;
</li>
</ul><p>

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
RSA Digital Signature Scheme</h3>

<a name="sec:signature_principles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Principles</h3>

<p>
The computation of the digital signature, using K_priv, MUST include the ALC or NORM header (with the
various header extensions) and the payload when applicable.
The UDP/IP/MAC headers MUST NOT be included.
During this computation, the "Signature" field MUST be set to 0.

</p>
<p>
Upon receiving this packet, the receiver recomputes the Group MAC, using K_pub, and compares
it to the value carried in the packet.
During this computation, the Weak Group MAC field MUST also be set to 0.
If the check fails, the packet MUST be immediately dropped.

</p>
<p>
Several "Signature Encoding Algorithms" can be used, including
RSASSA-PKCS1-v1_5 and RSASSA-PSS.
With these encodings, several "Signature Cryptographic Function"
can be used, like SHA-256.

</p>
<p>
First, let us consider a packet sender.
More specifically, from <a class='info' href='#RFC4359'>[RFC4359]<span> (</span><span class='info'>Weis, B., &ldquo;The Use of RSA/SHA-1 Signatures within Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; January&nbsp;2006.</span><span>)</span></a>:
digital signature generation is performed as described in
<a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>, Section 8.2.1 for RSASSA-PKCS1-v1_5 and
Section 8.1.1 for RSASSA-PSS.
The authenticated portion of the packet is used as the message M,
which is passed to the signature generation function.
The signer's RSA private key is passed as K.
In summary (when SHA-256 is used), the signature generation process computes
a SHA-256 hash of the authenticated packet bytes, signs the SHA-256 hash using
the private key, and encodes the result with the specified RSA encoding type.
This process results in a value S, which is the digital signature to
be included in the packet.

</p>
<p>
With RSASSA-PKCS1-v1_5 and RSASSA-PSS signatures,
the size of the signature is equal to the "RSA modulus", unless the "RSA modulus"
is not a multiple of 8 bits. In that case, the signature MUST be prepended with
between 1 and 7 bits set to zero such that the signature is a multiple of 8 bits
<a class='info' href='#RFC4359'>[RFC4359]<span> (</span><span class='info'>Weis, B., &ldquo;The Use of RSA/SHA-1 Signatures within Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; January&nbsp;2006.</span><span>)</span></a>.
The key size, which in practice is also equal to the "RSA modulus", has major security
implications.
<a class='info' href='#RFC4359'>[RFC4359]<span> (</span><span class='info'>Weis, B., &ldquo;The Use of RSA/SHA-1 Signatures within Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; January&nbsp;2006.</span><span>)</span></a> explains how to choose this value depending on the maximum
expected lifetime of the session.
This choice is out of the scope of this document.

</p>
<p>
Now let us consider a receiver.
From <a class='info' href='#RFC4359'>[RFC4359]<span> (</span><span class='info'>Weis, B., &ldquo;The Use of RSA/SHA-1 Signatures within Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; January&nbsp;2006.</span><span>)</span></a>:
Digital signature verification is performed as described in
<a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>, Section 8.2.2 (RSASSA-PKCS1-v1_5) and
<a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>, Section 8.1.2 (RSASSA-PSS).
Upon receipt, the digital signature is passed to the
verification function as S.
The authenticated portion of the packet is used as the message M,
and the RSA public key is passed as (n, e).
In summary (when SHA-256 is used), the verification function computes a SHA-256
hash of the authenticated packet bytes, decrypts the SHA-256 hash in
the packet using the sender's public key, and validates that the appropriate
encoding was applied.
The two SHA-256 hashes are compared and if they are identical the
validation is successful.

</p>
<a name="signature_params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Parameters</h3>

<p>
Several parameters MUST be initialized by an out-of-band mechanism.
The sender or group controller:
</p>
<ul class="text">
<li>	MUST communicate his public key, for each receiver to
	be able to verify the signature of the packets received.
	As a side effect, the receivers also know the key length, n_k,
	and the signature length, the two parameters being equal;
</li>
<li>	MAY communicate a certificate (which also means
	that a PKI has been setup), for each receiver to be able to
	check the sender's public key;
</li>
<li>	MUST communicate the Signature Encoding Algorithm.
	For instance, <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> defines the
	RSASSA-PKCS1-v1_5 and RSASSA-PSS algorithms that are usually
	used to that purpose;
</li>
<li>	MUST communicate the Signature Cryptographic Function,
	for instance SHA-1, SHA-224, SHA-256, SHA-384, or SHA-512.
	Because of security threats on SHA-1, the use of SHA-256
	is RECOMMENDED;
</li>
<li>	MUST associate a value to the "ASID" field
	(Authentication Scheme Identifier) of the EXT_AUTH header extension
	(<a class='info' href='#sec:signature_auth_he_format'>Section&nbsp;2.3<span> (</span><span class='info'>Authentication Header Extension Format</span><span>)</span></a>);
</li>
</ul><p>
These parameters MUST be communicated to all receivers before they can
authenticate the incoming packets. For instance it can be communicated in
the session description, or initialized in a static way on the receivers,
or communicated by means of an appropriate protocol.
The details of this out-of-band mechanism are out of the scope of this
document.

</p>
<a name="sec:signature_auth_he_format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Authentication Header Extension Format</h3>

<p>
The integration of Digital Signatures is similar in ALC and NORM and relies on the 
header extension mechanism defined in both protocols.
More precisely this document details the EXT_AUTH==1 header extension defined
in <a class='info' href='#RFC5651'>[RFC5651]<span> (</span><span class='info'>Luby, M., Watson, M., and L. Vicisano, &ldquo;Layered Coding Transport (LCT) Building Block,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

</p>
<p>
Several fields are added in addition to the HET (Header Extension Type) and HEL
(Header Extension Length) fields (<a class='info' href='#fig:signature_lct_integration'>Figure&nbsp;1<span> (</span><span class='info'>Format of the Digital Signature EXT_AUTH header extension.</span><span>)</span></a>).

</p>
<p>
<br /><hr class="insert" />
<a name="fig:signature_lct_integration"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   HET (=1)    |      HEL      |  ASID |       Reserved        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 ~                                                               ~
 |                           Signature                           |
 +                                               +-+-+-+-+-+-+-+-+
 |                                               |    Padding    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Format of the Digital Signature EXT_AUTH header extension.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<p>
The fields of the Digital Signature EXT_AUTH header extension are:
</p>
<p>"ASID" (Authentication Scheme Identifier) field (4 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "ASID" identifies the source authentication scheme or protocol
	in use.
	The association between the "ASID" value and the actual authentication
	scheme is defined out-of-band, at session startup.

</p>
</blockquote>

<p>"Reserved" field (12 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	This is a reserved field that MUST be set to zero in this specification.

</p>
</blockquote>

<p>"Signature" field (variable size, multiple of 32 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "Signature" field contains a digital signature of the message.
	If need be, this field is padded (with 0) up to a multiple of 32 bits.

</p>
</blockquote>

<a name="sec:signature_auth_he_use"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
In Practice</h3>

<p>
Each packet sent MUST contain exactly one Digital Signature EXT_AUTH header extension.
A receiver MUST drop all the packets that do not contain a Digital Signature EXT_AUTH
header extension.

</p>
<p>
All receivers MUST recognize EXT_AUTH but MAY not be able to parse its content,
for instance because they do not support digital signatures.
In that case the Digital Signature EXT_AUTH header extension is ignored.

</p>
<p>
<br /><hr class="insert" />
<a name="fig:signature_auth_he_with_1024b_sig"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   HET (=1)    |    HEL (=33)  |  ASID |          0            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
|                                                               | ^ 1
+                                                               + | 2
|                                                               | | 8
.                                                               . |
.                      Signature (128 bytes)                    . | b
.                                                               . | y
|                                                               | | t
+                                                               + | e
|                                                               | v s
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Example: Format of the Digital Signature EXT_AUTH header extension
	using 1024 bit signatures.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />



<p>
For instance <a class='info' href='#fig:signature_auth_he_with_1024b_sig'>Figure&nbsp;2<span> (</span><span class='info'>Example: Format of the Digital Signature EXT_AUTH header extension 	using 1024 bit signatures.</span><span>)</span></a> shows the digital signature
EXT_AUTH header extension when using 128 byte (1024 bit) key digital signatures
(which also means that the signature field is 128 byte long).
The Digital Signature EXT_AUTH header extension is then 132 byte long.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Elliptic Curve Digital Signature Scheme</h3>

<a name="sec:ecc_signature_principles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Principles</h3>

<p>
The computation of the ECC digital signature, using K_priv, MUST include the ALC or NORM header (with the
various header extensions) and the payload when applicable.
The UDP/IP/MAC headers MUST NOT be included.
During this computation, the "Signature" field MUST be set to 0.

</p>
<p>
Upon receiving this packet, the receiver recomputes the Group MAC, using K_pub, and compares
it to the value carried in the packet.
During this computation, the Weak Group MAC field MUST also be set to 0.
If the check fails, the packet MUST be immediately dropped.

</p>
<p>
Several "Elliptic Curves" groups can be used, as well as several "Hash Algorithms".
In practice both choices are related and there is a minimum hash algorithm size for
any key size.
Using a larger hash algorithm and then truncated the output is also feasible,
however it consumes more processing power than is necessary.
The following table lists the RECOMMENDED choices <a class='info' href='#RFC4754'>[RFC4754]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;IKE and IKEv2 Authentication Using the Elliptic Curve Digital Signature Algorithm (ECDSA),&rdquo; January&nbsp;2007.</span><span>)</span></a>
<a class='info' href='#RFC5480'>[RFC5480]<span> (</span><span class='info'>Turner, S., Brown, D., Yiu, K., Housley, R., and T. Polk, &ldquo;Elliptic Curve Cryptography Subject Public Key Information,&rdquo; March&nbsp;2009.</span><span>)</span></a>.

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Digital Signature Algorithm name [RFC4754]</th><th align="center">Key Size (n_k)</th><th align="center">Message Digest Algorithm</th><th align="center">Elliptic Curve</th></tr>
<tr>
<td align="center">
	ECDSA-256
	</td>
<td align="center">
	256
	</td>
<td align="center">
	SHA-256
	</td>
<td align="center">
	secp256r1
	</td>
</tr>
<tr>
<td align="center">
	ECDSA-384
	</td>
<td align="center">
	384
	</td>
<td align="center">
	SHA-384
	</td>
<td align="center">
	secp384r1
	</td>
</tr>
<tr>
<td align="center">
	ECDSA-521
	</td>
<td align="center">
	512
	</td>
<td align="center">
	SHA-512
	</td>
<td align="center">
	secp521r1
	</td>
</tr>
</table>
<br clear="all" />

<p>
The ECDSA-256, ECDSA-384 and ECDSA-521 are designed to offer security
comparable with AES-128, AES-192 and AES-256 respectively <a class='info' href='#RFC4754'>[RFC4754]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;IKE and IKEv2 Authentication Using the Elliptic Curve Digital Signature Algorithm (ECDSA),&rdquo; January&nbsp;2007.</span><span>)</span></a>.

</p>
<a name="ecc_signature_params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Parameters</h3>

<p>
Several parameters MUST be initialized by an out-of-band mechanism.
The sender or group controller:
</p>
<ul class="text">
<li>	MUST communicate his public key, for each receiver to
	be able to verify the signature of the packets received.
	As a side effect, the receivers also know the key length, n_k,
	and the signature length, the two parameters being equal;
</li>
<li>	MAY communicate a certificate (which also means
	that a PKI has been setup), for each receiver to be able to
	check the sender's public key;
</li>
<li>	MUST communicate the Message Digest Algorithm;
</li>
<li>	MUST communicate the Elliptic Curve;
</li>
<li>	MUST associate a value to the "ASID" field
	(Authentication Scheme Identifier) of the EXT_AUTH header extension
	(<a class='info' href='#sec:signature_auth_he_format'>Section&nbsp;2.3<span> (</span><span class='info'>Authentication Header Extension Format</span><span>)</span></a>);
</li>
</ul><p>
These parameters MUST be communicated to all receivers before they can
authenticate the incoming packets. For instance it can be communicated in
the session description, or initialized in a static way on the receivers,
or communicated by means of an appropriate protocol.
The details of this out-of-band mechanism are out of the scope of this
document.

</p>
<a name="sec:ecc_signature_auth_he_format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Authentication Header Extension Format</h3>

<p>
The integration of ECC Digital Signatures is similar in ALC and NORM and relies on the 
header extension mechanism defined in both protocols.
More precisely this document details the EXT_AUTH==1 header extension defined
in <a class='info' href='#RFC5651'>[RFC5651]<span> (</span><span class='info'>Luby, M., Watson, M., and L. Vicisano, &ldquo;Layered Coding Transport (LCT) Building Block,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

</p>
<p>
Several fields are added in addition to the HET (Header Extension Type) and HEL
(Header Extension Length) fields (<a class='info' href='#fig:signature_lct_integration'>Figure&nbsp;1<span> (</span><span class='info'>Format of the Digital Signature EXT_AUTH header extension.</span><span>)</span></a>).

</p>
<p>
<br /><hr class="insert" />
<a name="fig:ecc_signature_lct_integration"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   HET (=1)    |      HEL      |  ASID |       Reserved        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 ~                                                               ~
 |                           Signature                           |
 +                                               +-+-+-+-+-+-+-+-+
 |                                               |    Padding    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Format of the Digital Signature EXT_AUTH header extension.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<p>
The fields of the Digital Signature EXT_AUTH header extension are:
</p>
<p>"ASID" (Authentication Scheme Identifier) field (4 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "ASID" identifies the source authentication scheme or protocol
	in use.
	The association between the "ASID" value and the actual authentication
	scheme is defined out-of-band, at session startup.

</p>
</blockquote>

<p>"Reserved" field (12 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	This is a reserved field that MUST be set to zero in this specification.

</p>
</blockquote>

<p>"Signature" field (variable size, multiple of 32 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "Signature" field contains a digital signature of the message.
	If need be, this field is padded (with 0) up to a multiple of 32 bits.

</p>
</blockquote>

<a name="sec:ecc_signature_auth_he_use"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
In Practice</h3>

<p>
Each packet sent MUST contain exactly one ECC Digital Signature EXT_AUTH header extension.
A receiver MUST drop all the packets that do not contain an ECC Digital Signature EXT_AUTH
header extension.

</p>
<p>
All receivers MUST recognize EXT_AUTH but MAY not be able to parse its content,
for instance because they do not support ECC digital signatures.
In that case the Digital Signature EXT_AUTH header extension is ignored.

</p>
<p>
<br /><hr class="insert" />
<a name="fig:ecc_signature_auth_he_with_256b_sig"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   HET (=1)    |    HEL (=9)   |  ASID |          0            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
|                                                               | ^ 3
+                                                               + | 2
.                                                               . |
.                      Signature (32 bytes)                     . | b
.                                                               . | y
|                                                               | | t
+                                                               + | e
|                                                               | v s
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Example: Format of the ECC Digital Signature EXT_AUTH header extension
	using ECDSA-256 signatures.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />



<p>
For instance <a class='info' href='#fig:ecc_signature_auth_he_with_256b_sig'>Figure&nbsp;4<span> (</span><span class='info'>Example: Format of the ECC Digital Signature EXT_AUTH header extension 	using ECDSA-256 signatures.</span><span>)</span></a> shows the digital signature
EXT_AUTH header extension when using ECDSA-256 (256 bit) ECC digital signatures.
The ECC Digital Signature EXT_AUTH header extension is then 36 byte long.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Group Message Authentication Code (MAC) Scheme</h3>

<a name="sec:group_mac_principles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Principles</h3>

<p>
The computation of the Group MAC, using K_g, includes the ALC or NORM header (with the various header
extensions) and the payload when applicable.
The UDP/IP/MAC headers are not included.
During this computation, the Weak Group MAC field MUST be set to 0.
Then the sender truncates the MAC output to keep the n_m most significant bits
and stores the result in the Group MAC Authentication header. 

</p>
<p>
Upon receiving this packet, the receiver recomputes the Group MAC, using K_g, and compares
it to the value carried in the packet.
During this computation, the Group MAC field MUST also be set to 0.
If the check fails, the packet MUST be immediately dropped.

</p>
<p>
<a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a> explains that it is current practice to truncate the MAC
output, on condition that the truncated output length, n_m be not less than half
the length of the hash and not less than 80 bits.
However, this choice is out of the scope of this document.

</p>
<a name="group_mac_params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Parameters</h3>

<p>
Several parameters MUST be initialized by an out-of-band mechanism.
The sender or group controller:
</p>
<ul class="text">
<li>	MUST communicate the Cryptographic MAC Function,
	for instance, HMAC-SHA-1, HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, or HMAC-SHA-512.
	Because of security threats on SHA-1, the use of HMAC-SHA-256 is RECOMMENDED.
	As a side effect, the receivers also know the key length, n_k, and the
	non truncated MAC output length;
	
</li>
<li>	MUST communicate the length of the truncated output of the MAC, n_m, which
	depends on the Cryptographic MAC Function chosen.
	Only the n_m left-most bits (most significant bits) of the MAC
	output are kept. Of course, n_m MUST be lower or equal to n_k;
</li>
<li>	MUST communicate the K_g group key to the receivers, confidentially, before
	starting the session.
	This key might have to be periodically refreshed for improved robustness;
	
</li>
<li>	MUST associate a value to the "ASID" field
	(Authentication Scheme Identifier) of the EXT_AUTH header extension
	(<a class='info' href='#sec:group_mac_auth_he_format'>Section&nbsp;4.3<span> (</span><span class='info'>Authentication Header Extension Format</span><span>)</span></a>);
</li>
</ul><p>
These parameters MUST be communicated to all receivers before they can
authenticate the incoming packets. For instance it can be communicated in
the session description, or initialized in a static way on the receivers,
or communicated by means of an appropriate protocol (this will be often
the case when periodic re-keying is required).
The details of this out-of-band mechanism are out of the scope of this
document.

</p>
<a name="sec:group_mac_auth_he_format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Authentication Header Extension Format</h3>

<p>
The integration of Group MAC is similar in ALC and NORM and relies on the 
header extension mechanism defined in both protocols.
More precisely this document details the EXT_AUTH==1 header extension defined
in <a class='info' href='#RFC5651'>[RFC5651]<span> (</span><span class='info'>Luby, M., Watson, M., and L. Vicisano, &ldquo;Layered Coding Transport (LCT) Building Block,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

</p>
<p>
Several fields are added in addition to the HET (Header Extension Type) and HEL
(Header Extension Length) fields (<a class='info' href='#fig:group_mac_lct_integration'>Figure&nbsp;5<span> (</span><span class='info'>Format of the Group MAC EXT_AUTH header extension.</span><span>)</span></a>).

</p>
<p>
<br /><hr class="insert" />
<a name="fig:group_mac_lct_integration"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   HET (=1)    |      HEL      |  ASID |       Reserved        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 ~                                                               ~
 |                           Group MAC                           |
 +                                               +-+-+-+-+-+-+-+-+
 |                                               |    Padding    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Format of the Group MAC EXT_AUTH header extension.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<p>
The fields of the Group MAC EXT_AUTH header extension are:
</p>
<p>"ASID" (Authentication Scheme Identifier) field (4 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "ASID" identifies the source authentication scheme or protocol
	in use.
	The association between the "ASID" value and the actual authentication
	scheme is defined out-of-band, at session startup.

</p>
</blockquote>

<p>"Reserved" field (12 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	This is a reserved field that MUST be set to zero in this specification.

</p>
</blockquote>

<p>"Group MAC" field (variable size, multiple of 32 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "Group MAC" field contains a truncated Group MAC of the message.
	If need be, this field is padded (with 0) up to a multiple of 32 bits.

</p>
</blockquote>

<a name="sec:group_mac_auth_he_use"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
In Practice</h3>

<p>
Each packet sent MUST contain exactly one Group MAC EXT_AUTH header extension.
A receiver MUST drop packets that do not contain a Group MAC EXT_AUTH header extension.

</p>
<p>
All receivers MUST recognize EXT_AUTH but MAY not be able to parse its content,
for instance because they do not support Group MAC.
In that case the Group MAC EXT_AUTH extension is ignored.

</p>
<p>
<br /><hr class="insert" />
<a name="fig:group_mac_auth_he_with_1024b_sig"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   HET (=1)    |     HEL (=4)  |  ASID |          0            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 +                                                               +
 |                      Group MAC (10 bytes)                     |
 +                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                               |            Padding            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Example: Format of the Group MAC EXT_AUTH header extension
	using HMAC-SHA-1.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />



<p>
For instance <a class='info' href='#fig:group_mac_auth_he_with_1024b_sig'>Figure&nbsp;6<span> (</span><span class='info'>Example: Format of the Group MAC EXT_AUTH header extension 	using HMAC-SHA-1.</span><span>)</span></a> shows the Group MAC
EXT_AUTH header extension when using HMAC-SHA-1.
The Group MAC EXT_AUTH header extension is then 16 byte long.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Combined Use of the RSA/ECC Digital Signatures and Group MAC Schemes</h3>

<a name="sec:combined_use_principles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Principles</h3>

<p>
In some situations, it can be interesting to use both authentication
schemes.
The goal of the Group MAC is to mitigate DoS attacks coming from attackers
that are not group members <a class='info' href='#RFC4082'>[RFC4082]<span> (</span><span class='info'>Perrig, A., Song, D., Canetti, R., Tygar, J., and B. Briscoe, &ldquo;Timed Efficient Stream Loss-Tolerant Authentication (TESLA):           Multicast Source Authentication Transform Introduction,&rdquo; June&nbsp;2005.</span><span>)</span></a> by adding a light authentication
scheme as a front-end.

</p>
<p>
More specifically, before sending a message, the sender sets the
Signature field and Group MAC field to zero.
Then the sender computes the Signature as detailed in <a class='info' href='#sec:signature_principles'>Section&nbsp;2.1<span> (</span><span class='info'>Principles</span><span>)</span></a>
or in <a class='info' href='#sec:ecc_signature_principles'>Section&nbsp;3.1<span> (</span><span class='info'>Principles</span><span>)</span></a> and stores the value in the Signature field.
Then the sender computes the Group MAC as detailed in <a class='info' href='#sec:group_mac_principles'>Section&nbsp;4.1<span> (</span><span class='info'>Principles</span><span>)</span></a>
and stores the value in the Group MAC field.
The (RSA or ECC) digital signature value is therefore protected by the Group MAC, which
avoids DoS attacks where the attacker corrupts the digital signature itself.

</p>
<p>
Upon receiving the packet, the receiver first checks the Group MAC, as
detailed in <a class='info' href='#sec:group_mac_principles'>Section&nbsp;4.1<span> (</span><span class='info'>Principles</span><span>)</span></a>.
If the check fails, the packet MUST be immediately dropped.
Otherwise the receiver checks the Digital Signature, as detailed
in <a class='info' href='#sec:signature_principles'>Section&nbsp;2.1<span> (</span><span class='info'>Principles</span><span>)</span></a>.
If the check fails, the packet MUST be immediately dropped.

</p>
<p>
This scheme features a few limits:
</p>
<ul class="text">
<li>the Group MAC is of no help if a group member (who knows K_g) impersonates
	the sender and sends forged messages to other receivers. DoS attacks are
	still feasible;
</li>
<li>it requires an additional MAC computing for each packet,
	both at the sender and receiver sides;
</li>
<li>it increases the size of the authentication headers.
	In order to limit this problem, the length of the truncated output of the
	MAC, n_m, SHOULD be kept small (see <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a> section 9.5).
	In the current specification, n_m MUST be a multiple of 32 bits, and
	default value is 32 bits.
	As a side effect, with $n_m = 32$ bits, the authentication service is
	significantly weakened since the probability that any packet be successfully
	forged is one in 2^32.
	Since the Group MAC check is only a pre-check that is followed
	by the standard signature authentication check, this is not
	considered to be an issue.
</li>
</ul><p>
For a given use-case, the benefits brought by the Group MAC must be balanced
against these limitations.

</p>
<a name="combined_params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Parameters</h3>

<p>
Several parameters MUST be initialized by an out-of-band mechanism, as
defined in <a class='info' href='#signature_params'>Section&nbsp;2.2<span> (</span><span class='info'>Parameters</span><span>)</span></a>,
<a class='info' href='#ecc_signature_params'>Section&nbsp;3.2<span> (</span><span class='info'>Parameters</span><span>)</span></a> and <a class='info' href='#group_mac_params'>Section&nbsp;4.2<span> (</span><span class='info'>Parameters</span><span>)</span></a>.

</p>
<a name="sec:combined_auth_he_format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Authentication Header Extension Format</h3>

<p>
The integration of combined RSA/ECC Digital Signature and Group MAC is similar in ALC and NORM
and relies on the header extension mechanism defined in both protocols.
More precisely this document details the EXT_AUTH==1 header extension defined
in <a class='info' href='#RFC5651'>[RFC5651]<span> (</span><span class='info'>Luby, M., Watson, M., and L. Vicisano, &ldquo;Layered Coding Transport (LCT) Building Block,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

</p>
<p>
Several fields are added in addition to the HET (Header Extension Type) and HEL
(Header Extension Length) fields (<a class='info' href='#fig:combined_lct_integration'>Figure&nbsp;7<span> (</span><span class='info'>Format of the Group MAC EXT_AUTH header extension.</span><span>)</span></a>).

</p>
<p>
<br /><hr class="insert" />
<a name="fig:combined_lct_integration"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   HET (=1)    |      HEL      |  ASID |       Reserved        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 ~                                                               ~
 |                           Signature                           |
 +                                               +-+-+-+-+-+-+-+-+
 |                                               |    Padding    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           Group MAC                           |
 ~                                                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Format of the Group MAC EXT_AUTH header extension.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<p>
The fields of the Group MAC EXT_AUTH header extension are:
</p>
<p>"ASID" (Authentication Scheme Identifier) field (4 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "ASID" identifies the source authentication scheme or protocol
	in use.
	The association between the "ASID" value and the actual authentication
	scheme is defined out-of-band, at session startup.

</p>
</blockquote>

<p>"Reserved" field (12 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	This is a reserved field that MUST be set to zero in this specification.

</p>
</blockquote>

<p>"Signature" field (variable size, multiple of 32 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "Signature" field contains a digital signature of the message.
	If need be, this field is padded (with 0) up to a multiple of 32 bits.

</p>
</blockquote>

<p>"Group MAC" field (variable size, multiple of 32 bits, by default 32 bits):
</p>
<p></p>
<blockquote class="text">
<p>
	The "Group MAC" field contains a truncated Group MAC of the message.

</p>
</blockquote>

<a name="sec:combined_use_auth_he_use"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
In Practice</h3>

<p>
Each packet sent MUST contain exactly one combined Digital Signature/Group MAC EXT_AUTH header extension.
A receiver MUST drop packets that do not contain a combined Digital Signature/Group MAC EXT_AUTH header extension.

</p>
<p>
All receivers MUST recognize EXT_AUTH but MAY not be able to parse its content,
for instance because they do not support combined Digital Signature/Group MAC.
In that case the combined Digital Signature/Group MAC EXT_AUTH extension is ignored.

</p>
<p>
It is RECOMMENDED that the n_m parameter of the group authentication
scheme be small, and by default equal to 32 bits
(<a class='info' href='#sec:combined_use_principles'>Section&nbsp;5.1<span> (</span><span class='info'>Principles</span><span>)</span></a>).

</p>
<p>
<br /><hr class="insert" />
<a name="fig:combined_auth_he_with_1024b_sig"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   HET (=1)    |    HEL (=34)  |  ASID |          0            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
|                                                               | ^ 1
+                                                               + | 2
|                                                               | | 8
.                                                               . |
.                      Signature (128 bytes)                    . | b
.                                                               . | y
|                                                               | | t
+                                                               + | e
|                                                               | v s
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
|                       Group MAC (32 bits)                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: Example: Format of the combined RSA Digital Signature/Group MAC EXT_AUTH header extension
	using 1024 bit signatures.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />



<p>
For instance <a class='info' href='#fig:combined_auth_he_with_1024b_sig'>Figure&nbsp;8<span> (</span><span class='info'>Example: Format of the combined RSA Digital Signature/Group MAC EXT_AUTH header extension 	using 1024 bit signatures.</span><span>)</span></a> shows the combined
Digital Signature/Group MAC
EXT_AUTH header extension when using 128 byte (1024 bit) key RSA digital signatures
(which also means that the signature field is 128 byte long).
The EXT_AUTH header extension is then 136 byte long.

</p>
<a name="sec:iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document does not require any IANA registration.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Dealing With DoS Attacks</h3>

<p>
Digital signatures introduces new opportunities for an attacker to mount DoS attacks.
For instance an attacker can try to saturate the processing
capabilities of the receiver (faked packets are easy to create but checking
them requires to compute a costly digital signature).

</p>
<p>
In order to mitigate these attacks, it is RECOMMENDED to use the combined
Digital Signature/Group MAC scheme (<a class='info' href='#sec:combined_use_principles'>Section&nbsp;5.1<span> (</span><span class='info'>Principles</span><span>)</span></a>).
However, no mitigation is possible if a group member acts as an attacker.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Dealing With Replay Attacks</h3>

<p>
Replay attacks consist for an attacker to store a valid message and to replay
it later on.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.1"></a><h3>7.2.1.&nbsp;
Impacts of Replay Attacks on the Simple Authentication Schemes</h3>

<p>
Since all the above authentication schemes are memoryless, replay attacks
have no impact on these schemes.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.2"></a><h3>7.2.2.&nbsp;
Impacts of Replay Attacks on NORM</h3>

<p>
We review here the potential impacts of a replay attack on the NORM component.
Note that we do not consider here the protocols that could be used along with
NORM, for instance the congestion control protocols.

</p>
<p>
First, let us consider replay attacks within a given NORM session.
NORM defines a "sequence" field that can be used to protect against replay
attacks <a class='info' href='#RFC5740'>[RFC5740]<span> (</span><span class='info'>Adamson, B., Bormann, C., Handley, M., and J. Macker, &ldquo;NACK-Oriented Reliable Multicast (NORM) Transport Protocol,&rdquo; November&nbsp;2009.</span><span>)</span></a> within a given NORM session.
This "sequence" field is a 16-bit value that is set by the message
originator (sender or receiver) as a monotonically increasing number
incremented with each NORM message transmitted.
It is RECOMMENDED that a receiver check this sequence field and drop messages considered
as replayed.
Similarly, it is RECOMMENDED that a sender check this sequence, for each known receiver,
and drop messages considered as replayed.
In both cases, checking this sequence field SHOULD be done before
authenticating the packet: if the sequence field has not been
corrupted, the replay attack will immediately be identified, and
otherwise the packet will fail the authentication test.
This analysis shows that NORM itself is robust in front of replay attacks
within the same session.

</p>
<p>
Now let us consider replay attacks across several NORM sessions.
A host participation in a NORM session is uniquely identified by
the {"source_id"; "instance_id"} tuple.
Therefore, when a given host participates in several NORM sessions, it is
RECOMMENDED that the "instance_id" be changed for each NORM instance.
It is also RECOMMENDED, when the Group MAC authentication/integrity check
scheme is used, that the shared group key, K_g, be changed across sessions.
Therefore, NORM can be made robust in front of replay attacks across different
sessions.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.3"></a><h3>7.2.3.&nbsp;
Impacts of Replay Attacks on ALC</h3>

<p>
We review here the potential impacts of a replay attack on the ALC component.
Note that we do not consider here the protocols that could be used along with
ALC, for instance the layered or wave based congestion control protocols.

</p>
<p>
First, let us consider replay attacks within a given ALC session:
</p>
<ul class="text">
<li>Regular packets containing an authentication tag: a replayed message
	containing an encoding symbol will be detected once authenticated, thanks to
	the object/block/symbol identifiers, and will be silently discarded.
	This kind of replay attack is only penalizing in terms of memory and
	processing load, but does not compromise the ALC behavior.
	
</li>
<li>Control packets containing an authentication tag:
	ALC control packets, by definition, do not include any encoding symbol
	and therefore do not include any object/block/symbol identifier that would
	enable a receiver to identify duplicates.
	However, a sender has a very limited number of reasons to send control packets.
	More precisely:
	
<ul class="text">
<li>At the end of the session, a "close session" (A flag) packet is sent.
		Replaying this packet has no impact since the receivers already left.
</li>
<li>Similarly, replaying a packet containing a "close object" (B flag)
		has no impact since this object is probably already marked as closed
		by the receiver.
</li>
</ul>
	
</li>
</ul><p>
This analysis shows that ALC itself is robust in front of replay attacks
within the same session.

</p>
<p>
Now let us consider replay attacks across several ALC sessions.
An ALC session is uniquely identified by the {sender's IP address; 
Transport Session Identifier (TSI)} <a class='info' href='#RFC5651'>[RFC5651]<span> (</span><span class='info'>Luby, M., Watson, M., and L. Vicisano, &ldquo;Layered Coding Transport (LCT) Building Block,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
Therefore, when a given sender creates several sessions, it is
RECOMMENDED that the TSI be changed for each ALC instance.
It is also RECOMMENDED, when the Group MAC authentication/integrity check
scheme is used, that the shared group key, K_g, be changed across sessions.
Therefore, ALC can be made robust in front of replay attacks across different
sessions.

</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>
The author is grateful to the authors of <a class='info' href='#RFC4359'>[RFC4359]<span> (</span><span class='info'>Weis, B., &ldquo;The Use of RSA/SHA-1 Signatures within Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; January&nbsp;2006.</span><span>)</span></a>, <a class='info' href='#RFC4754'>[RFC4754]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;IKE and IKEv2 Authentication Using the Elliptic Curve Digital Signature Algorithm (ECDSA),&rdquo; January&nbsp;2007.</span><span>)</span></a>
and <a class='info' href='#RFC5480'>[RFC5480]<span> (</span><span class='info'>Turner, S., Brown, D., Yiu, K., Housley, R., and T. Polk, &ldquo;Elliptic Curve Cryptography Subject Public Key Information,&rdquo; March&nbsp;2009.</span><span>)</span></a> that inspired several sections of the present document.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, BCP&nbsp;14, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5651">[RFC5651]</a></td>
<td class="author-text">Luby, M., Watson, M., and L. Vicisano, &ldquo;<a href="http://tools.ietf.org/html/rfc5651">Layered Coding Transport (LCT) Building Block</a>,&rdquo; RFC&nbsp;5651, October&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5740">[RFC5740]</a></td>
<td class="author-text">Adamson, B., Bormann, C., Handley, M., and J. Macker, &ldquo;<a href="http://tools.ietf.org/html/rfc5740">NACK-Oriented Reliable Multicast (NORM) Transport Protocol</a>,&rdquo; RFC&nbsp;5740, November&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5740.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5775">[RFC5775]</a></td>
<td class="author-text">Luby, M., Watson, M., and L. Vicisano, &ldquo;<a href="http://tools.ietf.org/html/rfc5775">Asynchronous Layered Coding (ALC) Protocol Instantiation</a>,&rdquo; RFC&nbsp;5775, April&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5775.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text">Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3447">[RFC3447]</a></td>
<td class="author-text">Jonsson, J. and B. Kaliski, &ldquo;<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>,&rdquo; RFC&nbsp;3447, February&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3447.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3711">[RFC3711]</a></td>
<td class="author-text">Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3711">The Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; RFC&nbsp;3711, March&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3711.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4082">[RFC4082]</a></td>
<td class="author-text">Perrig, A., Song, D., Canetti, R., Tygar, J., and B. Briscoe, &ldquo;<a href="http://tools.ietf.org/html/rfc4082">Timed Efficient Stream Loss-Tolerant Authentication (TESLA):
          Multicast Source Authentication Transform Introduction</a>,&rdquo; RFC&nbsp;4082, June&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4082.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4359">[RFC4359]</a></td>
<td class="author-text">Weis, B., &ldquo;<a href="http://tools.ietf.org/html/rfc4359">The Use of RSA/SHA-1 Signatures within Encapsulating Security Payload (ESP) and Authentication Header (AH)</a>,&rdquo; RFC&nbsp;4359, January&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4359.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4754">[RFC4754]</a></td>
<td class="author-text">Fu, D. and J. Solinas, &ldquo;<a href="http://tools.ietf.org/html/rfc4754">IKE and IKEv2 Authentication Using the Elliptic Curve Digital Signature Algorithm (ECDSA)</a>,&rdquo; RFC&nbsp;4754, January&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4754.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5480">[RFC5480]</a></td>
<td class="author-text">Turner, S., Brown, D., Yiu, K., Housley, R., and T. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5480">Elliptic Curve Cryptography Subject Public Key Information</a>,&rdquo; RFC&nbsp;5480, March&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5776">[RFC5776]</a></td>
<td class="author-text">Roca, V., Francillon, A., and S. Faurite, &ldquo;<a href="http://tools.ietf.org/html/rfc5776">Use of Timed Efficient Stream Loss-Tolerant Authentication (TESLA) in the Asynchronous Layered Coding (ALC) and NACK-Oriented Reliable Multicast (NORM) Protocols</a>,&rdquo; RFC&nbsp;5776, April&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5776.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RMT-FLUTE">[RMT-FLUTE]</a></td>
<td class="author-text">Paila, T., Walsh, R., Luby, M., Lehtonen, R., and V. Roca, &ldquo;FLUTE - File Delivery over Unidirectional Transport,&rdquo; Work in&nbsp;Progress, March&nbsp;2010.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vincent Roca</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">INRIA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">655, av. de l'Europe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Zirst; Montbonnot</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ST ISMIER cedex  38334</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vincent.roca@inria.fr">vincent.roca@inria.fr</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://planete.inrialpes.fr/people/roca/">http://planete.inrialpes.fr/people/roca/</a></td></tr>
</table>
</body></html>
