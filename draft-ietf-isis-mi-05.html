<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>IS-IS Multi-Instance</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Elements Of Procedure">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Instance Identifier TLV">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Instance Membership">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Use of Authentication">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Adjacency Establishment">
<link href="#rfc.section.2.4.1" rel="Chapter" title="2.4.1 Point-to-Point Adjacencies">
<link href="#rfc.section.2.4.2" rel="Chapter" title="2.4.2 Multi-Access Adjacencies">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Update Process Operation">
<link href="#rfc.section.2.5.1" rel="Chapter" title="2.5.1 Update Process Operation on Point-to-Point Circuits">
<link href="#rfc.section.2.5.2" rel="Chapter" title="2.5.2 Update Process Operation on Broadcast Circuits">
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 Interoperability Considerations">
<link href="#rfc.section.2.6.1" rel="Chapter" title="2.6.1 Interoperability Issues on Broadcast Circuits">
<link href="#rfc.section.2.6.2" rel="Chapter" title="2.6.2 Interoperability using point-to-point circuits">
<link href="#rfc.section.3" rel="Chapter" title="3 Usage Guidelines">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 One-One Mapping Between Topologies and Instances">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Many-to-one Mapping Between Topologies and Instances">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Considerations for the Number of Instances">
<link href="#rfc.section.4" rel="Chapter" title="4 Relationship to M-ISIS">
<link href="#rfc.section.5" rel="Chapter" title="5 Graceful Restart Interactions">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This draft describes a mechanism that allows a single router to share one or more circuits among multiple Intermediate System To Intermediate System (IS-IS) routing protocol instances." />
  <meta name="description" content="This draft describes a mechanism that allows a single router to share one or more circuits among multiple Intermediate System To Intermediate System (IS-IS) routing protocol instances." />
  <meta name="keywords" content="Sample" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Networking Working Group</td>
<td class="right">S. Previdi, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">L. Ginsberg</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">M. Shand</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">A. Roy</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Ward</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Juniper Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">IS-IS Multi-Instance<br />
  <span class="filename">draft-ietf-isis-mi-05.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This draft describes a mechanism that allows a single router to share one or more circuits among multiple Intermediate System To Intermediate System (IS-IS) routing protocol instances.</p>
<p>Multiple instances allow the isolation of resources associated with each instance. Routers will form instance specific adjacencies. Each instance can support multiple topologies. Each topology has a unique Link State Database (LSDB). Each Protocol Data Unit (PDU) will contain a new Type Length Value (TLV) identifying the instance and the topology(ies) to which the PDU belongs.</p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 [RFC2119].</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Elements Of Procedure</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Instance Identifier TLV</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Instance Membership</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Use of Authentication</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Adjacency Establishment</a>
</li>
<li>2.4.1.   <a href="#rfc.section.2.4.1">Point-to-Point Adjacencies</a>
</li>
<li>2.4.2.   <a href="#rfc.section.2.4.2">Multi-Access Adjacencies</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Update Process Operation</a>
</li>
<li>2.5.1.   <a href="#rfc.section.2.5.1">Update Process Operation on Point-to-Point Circuits</a>
</li>
<li>2.5.2.   <a href="#rfc.section.2.5.2">Update Process Operation on Broadcast Circuits</a>
</li>
<li>2.6.   <a href="#rfc.section.2.6">Interoperability Considerations</a>
</li>
<li>2.6.1.   <a href="#rfc.section.2.6.1">Interoperability Issues on Broadcast Circuits</a>
</li>
<li>2.6.2.   <a href="#rfc.section.2.6.2">Interoperability using point-to-point circuits</a>
</li>
<li>3.   <a href="#rfc.section.3">Usage Guidelines</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">One-One Mapping Between Topologies and Instances</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Many-to-one Mapping Between Topologies and Instances</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Considerations for the Number of Instances</a>
</li>
<li>4.   <a href="#rfc.section.4">Relationship to M-ISIS</a>
</li>
<li>5.   <a href="#rfc.section.5">Graceful Restart Interactions</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Acknowledgements</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">An existing limitation of the protocol defined by [IS-IS] is that only one instance of the protocol can operate on a given circuit. This document defines an extension to IS-IS to remove this restriction. The extension is referred to as "Multi-instance IS-IS" (MI-IS-IS).</p>
<p id="rfc.section.1.p.2">Routers which support this extension are referred to as "Multi-instance capable routers" (MI-RTR).</p>
<p id="rfc.section.1.p.3">The use of multiple instances enhances the ability to isolate the resources associated with a given instance both within a router and across the network. Instance specific prioritization for processing PDUs and performing routing calculations within a router may be specified.  Instance specific flooding parameters may also be defined so as to allow different instances to consume network wide resources at different rates.</p>
<p id="rfc.section.1.p.4">A given instance MAY support multiple topologies. Each topology is associated with a unique LSDB and a topology specific IS-IS Update Process. This differs from [RFC5120] where a single LSDB/single IS-IS Update Process is used in support of all topologies.</p>
<p id="rfc.section.1.p.5">MI-IS-IS might be used to support topology specific routing. When used for this purpose it is an alternative to [RFC5120].</p>
<p id="rfc.section.1.p.6">MI-IS-IS might also be used to support advertisement of information on behalf of applications [I-D.ietf-isis-genapp]. The advertisement of information not directly related to the operation of the IS-IS protocol can therefore be done in a manner which minimizes its impact on the operation of routing.</p>
<p id="rfc.section.1.p.7">The above are examples of how MI-IS-IS might be used. The specification of uses of MI-IS-IS is outside the scope of this document.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Elements Of Procedure</h1>
<p id="rfc.section.2.p.1">An Instance Identifier (IID) is introduced to uniquely identify an IS-IS instance. The protocol extension includes a new TLV (IID-TLV) in each IS-IS PDU originated by an MI-RTR. The IID-TLV identifies the unique instance as well as the topology/topologies to which the PDU applies. Each IS-IS PDU is associated with only one IS-IS instance.</p>
<p id="rfc.section.2.p.2">MI-RTRs form instance specific adjacencies. The IID-TLV included in Intermediate System-Intermediate System Hellos (IIH) includes the IID and the set of Instance Specific Topology Identifiers (ITID) that the sending IS supports. When multiple instances share the same link each instance will have a separate set of adjacencies.</p>
<p id="rfc.section.2.p.3">MI-RTRs support the exchange of topology specific Link State PDUs for the IID/ITID pairs that each neighbor supports. A unique IS-IS Update process [see IS-IS] operates for each IID/ITID pair. This MAY also imply IID/ITID specific routing calculations and IID/ITID specific routing and forwarding tables. However, this aspect is outside the scope of this specification.</p>
<p id="rfc.section.2.p.4">The mechanisms used to implement support of the separation of IS-IS instances and topology specific Update processes within a router are outside the scope of this specification.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Instance Identifier TLV</h1>
<p id="rfc.section.2.1.p.1">A new TLV is defined in order to convey the IID and ITIDs supported. The IID-TLV associates PDUs with each IS-IS instance using a unique 16-bit number. The IID-TLV is carried in all IS-IS PDUs (Intermediate System to Intermediate System Hellos (IIH), Sequence Number PDUs (SNP) and Link State PDUs (LSP)) originated by the router.</p>
<p id="rfc.section.2.1.p.2">Multiple instances of IS-IS may co-exist on the same circuit and on the same physical router. IIDs MUST be unique within the same routing domain.</p>
<p id="rfc.section.2.1.p.3">Instance identifier #0 is reserved for the standard instance supported by legacy systems. The following format is used for the IID-TLV:</p>
<div id="#rfc.figure.1"></div>
<pre>  Type:   7 
  Length: 2 - 255 
  Value:  
                                         No. of octets
              +-------------------------+
              | IID (0 - 65535)         |     2
              +-------------------------+
              | Supported ITID (0 - 255)|     0 - 253
              +-------------------------+

  When the IID = 0, the list of supported ITIDs MUST NOT be present.

  When the IID is non-zero and the TLV appears in an SNP or LSP, 
  exactly one ITID MUST be present indicating the topology with 
  which the PDU is associated. If no ITIDs or multiple ITIDs are
  present the PDU MUST be ignored.

  When the IID is non-zero and the TLV appears in an IIH, the set 
  of ITIDs supported on the link over which the IIH is sent is 
  included. There MUST BE at least one ITID present.
</pre>
<p id="rfc.section.2.1.p.4">When an LSP purge is initiated, the IID-TLV MUST be retained but the remainder of the body of the LSP SHOULD be removed. Purge procedure is described in [RFC6233] and [RFC6232].</p>
<p id="rfc.section.2.1.p.5">A PDU MUST NOT be generated with multiple IID-TLVs. PDUs received with multiple IID-TLVs MUST be ignored. A PDU without an IID-TLV is assumed to belong to the standard instance (#0).</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Instance Membership</h1>
<p id="rfc.section.2.2.p.1">Each MI-RTR is configured to be participating in one or more instances of IS-IS. For each instance in which it participates, an MI-RTR marks all IS-IS PDUs (IIHs, LSPs or SNPs) generated pertaining to that instance by including the IID-TLV with the appropriate instance identifier.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Use of Authentication</h1>
<p id="rfc.section.2.3.p.1">When authentication is in use, the IID, if present, is first used to select the authentication configuration which is applicable. The authentication check is then performed as normal. When multiple ITIDs are supported, ITID specific authentication MAY be used in SNPs and LSPs.</p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Adjacency Establishment</h1>
<p id="rfc.section.2.4.p.1">In order to establish adjacencies, IS-IS routers exchange IIH PDUs.  Two types of adjacencies exist in IS-IS: point-to-point and broadcast.  The following sub-sections describe the additional rules an MI-RTR MUST follow when establishing adjacencies.</p>
<h1 id="rfc.section.2.4.1">
<a href="#rfc.section.2.4.1">2.4.1.</a> Point-to-Point Adjacencies</h1>
<p id="rfc.section.2.4.1.p.1">MI-RTRs include the IID-TLV in the point-to-point hello PDUs they originate. Upon reception of an IIH, an MI-RTR inspects the received IID-TLV and if the IID matches any of the IIDs which the router supports on that link, normal adjacency establishment procedures are used to establish an instance specific adjacency. Note that the absence of the IID TLV implies instance ID #0. For instances other than IID #0, an adjacency SHOULD NOT be established unless there is at least one ITID in common.</p>
<p id="rfc.section.2.4.1.p.2">This extension allows an MI-RTR to establish multiple adjacencies to the same physical neighbor over a point-to-point link. However, as the instances are logically independent, the normal expectation of at most one neighbor on a given point-to-point link still applies.</p>
<h1 id="rfc.section.2.4.2">
<a href="#rfc.section.2.4.2">2.4.2.</a> Multi-Access Adjacencies</h1>
<p id="rfc.section.2.4.2.p.1">Multi-Access (broadcast) circuits behave differently than point-to-point in that PDUs sent by one router are visible to all routers and all routers must agree on the election of a Designated Intermediate System (DIS) independent of the set of ITIDs supported.</p>
<p id="rfc.section.2.4.2.p.2">MI-RTRs will establish adjacencies and elect a DIS per IS-IS instance. Each MI-RTR will form adjacencies only with routers which advertise support for the instances which the local router has been configured to support on that link. Since an MI-RTR is not required to support all possible instances on a LAN, it's possible to elect a different DIS for different instances.</p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> Update Process Operation</h1>
<p id="rfc.section.2.5.p.1">For non-zero instances, a unique Update Process exists for each supported ITID.</p>
<h1 id="rfc.section.2.5.1">
<a href="#rfc.section.2.5.1">2.5.1.</a> Update Process Operation on Point-to-Point Circuits</h1>
<p id="rfc.section.2.5.1.p.1">On Point-to-Point circuits - including Point-to-Point Operation over LAN [RFC5309] - the ITID specific Update Process only operates on that circuit for those ITIDs which are supported by both ISs operating on the circuit.</p>
<h1 id="rfc.section.2.5.2">
<a href="#rfc.section.2.5.2">2.5.2.</a> Update Process Operation on Broadcast Circuits</h1>
<p id="rfc.section.2.5.2.p.1">On Broadcast circuits, a single DIS is elected for each supported IID independent of the set of ITIDs advertised in LAN IIHs. This requires that the DIS generate pseudo-node LSPs for all supported ITIDs and that the Update Process for all supported ITIDs operate on the Broadcast Circuit. In cases where the set of supported ITIDs for a given non-zero IID is inconsistent among the MI-RTRs operating on a broadcast circuit, connectivity for the topology(ies) associated with ITIDs not supported by some MI-RTRs operating on the circuit can be compromised.</p>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> Interoperability Considerations</h1>
<p id="rfc.section.2.6.p.1">[IS-IS] requires that any TLV that is not understood is silently ignored without compromising the processing of the whole IS-IS PDU (IIH, LSP, SNP).</p>
<p id="rfc.section.2.6.p.2">To a router not implementing this extension, all IS-IS PDUs received will appear to be associated with the standard instance regardless of whether an IID TLV is present in those PDUs. This can cause interoperability issues unless the mechanisms and procedures discussed below are followed.</p>
<h1 id="rfc.section.2.6.1">
<a href="#rfc.section.2.6.1">2.6.1.</a> Interoperability Issues on Broadcast Circuits</h1>
<p id="rfc.section.2.6.1.p.1">In order for routers to correctly interoperate with routers not implementing this extension and in order not to cause disruption, a specific and dedicated Media Access Control (MAC) address is used for multicasting IS-IS PDUs with any non-zero IID. Each level will use a specific layer 2 multicast address. Such an address allows MI-RTRs to exchange IS-IS PDUs with non-zero IIDs without these PDUs being processed by legacy routers and therefore no disruption is caused.</p>
<p id="rfc.section.2.6.1.p.2">An MI-RTR will use the AllL1IS and AllL2IS ISIS MAC layer addresses (as defined in [IS-IS]) when sending ISIS PDUs for the standard instance (IID #0). An MI-RTR will use two new (TBD) dedicated layer 2 multicast addresses (one for each level) when sending IS-IS PDUs for any non-zero IID.</p>
<p id="rfc.section.2.6.1.p.3">MI-RTRs MUST discard IS-IS PDUs received if either of the following is true:</p>
<p></p>

<ul><li>The destination multicast address is AllL1IS or AllL2IS and the PDU contains an IID-TLV</li></ul>

<ul><li>The destination multicast address is one of the two new addresses and the PDU contains an IID-TLV with a zero value for the IID or has no IID-TLV.</li></ul>
<p id="rfc.section.2.6.1.p.5">NOTE: If the multicast addresses AllL1IS and/or AllL2IS are improperly used to send IS-IS PDUs for non-zero IIDs, legacy systems will interpret these PDUs as being associated with IID #0. This will cause inconsistencies in the LSDB in those routers, may incorrectly maintain adjacencies, and may lead to inconsistent DIS election.</p>
<h1 id="rfc.section.2.6.2">
<a href="#rfc.section.2.6.2">2.6.2.</a> Interoperability using point-to-point circuits</h1>
<p id="rfc.section.2.6.2.p.1">In order for an MI-RTR to interoperate over a point-to-point circuit with a router which does NOT support this extension, the MI-RTR MUST NOT send IS-IS PDUs for instances other than IID #0 over the point-to-point link as these PDUs may affect the state of IID #0 in the neighbor.</p>
<p id="rfc.section.2.6.2.p.2">The presence/absence of the IID-TLV in an IIH indicates that the neighbor does/does not support this extension. Once it is determined that the neighbor does not support this extension, an MI-RTR MUST NOT send PDUs (including IIHs) for instances other than IID #0.</p>
<p id="rfc.section.2.6.2.p.3">Until an IIH is received from a neighbor, an MI-RTR MAY send IIHs for a non-zero instance. However, once an IIH with no IID TLV has been received - indicating that the neighbor is not an MI-RTR - the MI-RTR MUST NOT send IIHs for a non-zero instance. The temporary relaxation of the restriction on sending IIHs for non-zero instances allows a non-zero instance adjacency to be established on an interface on which an MI-RTR does NOT support instance #0.</p>
<p id="rfc.section.2.6.2.p.4">Point-to-point adjacency setup MUST be done through the use of three-way handshaking procedure as defined in [RFC5303] in order to prevent a non-MI capable neighbor from bringing up an adjacency prematurely based on reception of an IIH w an IID-TLV for a non-zero instance.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Usage Guidelines</h1>
<p id="rfc.section.3.p.1">As discussed above, MI-IS-IS extends IS-IS to support multiple instances on a given circuit. Each instance is uniquely identified by the IID and forms instance specific adjacencies. Each instance supports 1-255 topologies as represented by the ITIDs. All topologies associated with a given instance share the instance specific adjacencies. The set of topologies supported by a given IID MAY differ from circuit to circuit. Each topology has its own set of LSPs and runs a topology specific Update process. Flooding of topology specific LSPs is only performed on circuits on which both the local router and the neighbor(s) support a given topology (i.e. advertise the same ITID in the set of supported ITIDs sent in the IID-TLV included in IIHs).</p>
<p id="rfc.section.3.p.2">The following sub-sections provide some guidelines for usage of instances and topologies within each instance. While this represents examples based on the intent of the authors, implementors are not constrained by the examples.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> One-One Mapping Between Topologies and Instances</h1>
<p id="rfc.section.3.1.p.1">When the set of information to be flooded in LSPs is intended to be flooded to all MI-RTRs supporting a given IID a single topology MAY be used. The information contained in the single LSDB MAY still contain information associated with multiple applications as the GENINFO TLV for each application has an application specific ID which identifies the application to which the TLV applies [I-D.ietf-isis-genapp].</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Many-to-one Mapping Between Topologies and Instances</h1>
<p id="rfc.section.3.2.p.1">When the set of information to be flooded in LSPs includes subsets which are of interest to a subset of the MI-RTRs supporting a given IID, support of multiple ITIDs allows each subset to be flooded only to those MI-RTRs which are interested in that subset. In the simplest case, a one-one mapping between a given application and an ITID allows the information associated with that application to be flooded only to MI-RTRs which support that application - but a many-to-one mapping between applications and a given ITID is also possible. When the set of application specific information is large, the use of multiple ITIDs provides significantly greater efficiencies as MI-RTRs only need to maintain the LSDB for applications of interest and that information only needs to be flooded over a topology defined by the MI-RTRs who support a given ITID.</p>
<p id="rfc.section.3.2.p.2">The use of multiple ITIDs also allows the dedication of a full LSP set (256 LSPs at each level) for the use of a given (set of) applications, thereby minimizing the possibility of exceeding the carrying capacity of an LSP set which might arise if information for all applications were to be included in a single LSP set.</p>
<p id="rfc.section.3.2.p.3">Note that the topology associated with each ITID MUST be fully connected in order for ITID specific LSPs to be successfully flooded to all MI-RTRs who support that ITID.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Considerations for the Number of Instances</h1>
<p id="rfc.section.3.3.p.1">The support of multiple topologies within the context of a single instance provides better scalability in support of multiple applications both in terms of the number of adjacencies which are required and in the flooding of topology specific LSDB. In many cases the use of a single non-zero instance would be sufficient and optimal.  However, in cases where the set of topologies desired in support of a set of applications is largely disjoint from the set of topologies desired in support of a second set of applications, it could make sense to use multiple instances.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Relationship to M-ISIS</h1>
<p id="rfc.section.4.p.1">[RFC5120] defines support for Multi-Topology Routing. In that document 12 bit Multi-topology IDs are defined to identify the topologies which an IS-IS instance (a "standard instance" as defined by this document) supports. There is no relationship between the Multi-topology IDs defined in [RFC5120] and the ITIDs defined in this document.</p>
<p id="rfc.section.4.p.2">If an MI-RTR uses the extensions in support of the BFD Enabled TLV [RFC6213] , the 8 bit ITID (0 filled) SHOULD be used in place of the MTID.</p>
<p id="rfc.section.4.p.3">An MI-RTR MAY use the extensions defined in this document to support multiple topologies in the context of an instance with a non-zero IID.  Each MI topology is associated with a unique LSDB identified by an ITID.  An ITID specific IS-IS Update Process operates on each topology. This differs from [RFC5120] where a single LSDB/single IS-IS Update Process is used in support of all topologies. Although it is possible for an MI-RTR to use [RFC5120] multi-topology support within a non-zero instance such usage is seen as unnecessary and is discouraged.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Graceful Restart Interactions</h1>
<p id="rfc.section.5.p.1">[RFC5306] defines protocol extensions in support of graceful restart of a routing instance. The extensions defined there apply to MI-RTRs with the notable addition that as there are topology specific LSP databases each of these must be synchronized following restart in order for database synchronization to be complete. This involves the use of additional T2 timers. See [RFC5306] for further details.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">This document requires the definition of a new ISIS TLV that needs to be reflected in the ISIS TLV code-point registry:</p>
<div id="#rfc.figure.2"></div>
<pre> 
 Type  Description            IIH  LSP  SNP  Purge 
 ----  ---------------------  ---  ---  ---  ----- 
  7    Instance Identifier     y    y    y     y 
</pre>
<p></p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">Security concerns for IS-IS are addressed in [IS-IS], [RFC5304], and [RFC5310].</p>
<p id="rfc.section.7.p.2">Use of the extensions defined here with authentication as defined in [RFC5304] or [RFC5310] will result in the discarding of purges by legacy systems which are in strict conformance with either of those RFCs. To avoid this issue an MI-RTR MAY omit the IID-TLV in purges for the standard instance (IID #0) until such time as all ISs in the network have been upgraded to support [RFC6232].</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.8.p.1">The authors would like to acknowledge contributions made by Dino Farinacci and Tony Li.</p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5304">[RFC5304]</b></td>
<td class="top">
<a>Li, T.</a> and <a>R. Atkinson</a>, "<a href="http://tools.ietf.org/html/rfc5304">IS-IS Cryptographic Authentication</a>", RFC 5304, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5120">[RFC5120]</b></td>
<td class="top">
<a>Przygienda, T.</a>, <a>Shen, N.</a> and <a>N. Sheth</a>, "<a href="http://tools.ietf.org/html/rfc5120">M-ISIS: Multi Topology (MT) Routing in Intermediate System to Intermediate Systems (IS-ISs)</a>", RFC 5120, February 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5303">[RFC5303]</b></td>
<td class="top">
<a>Katz, D.</a>, <a>Saluja, R.</a> and <a>D. Eastlake</a>, "<a href="http://tools.ietf.org/html/rfc5303">Three-Way Handshake for IS-IS Point-to-Point Adjacencies</a>", RFC 5303, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5306">[RFC5306]</b></td>
<td class="top">
<a>Shand, M.</a> and <a>L. Ginsberg</a>, "<a href="http://tools.ietf.org/html/rfc5306">Restart Signaling for IS-IS</a>", RFC 5306, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5310">[RFC5310]</b></td>
<td class="top">
<a>Bhatia, M.</a>, <a>Manral, V.</a>, <a>Li, T.</a>, <a>Atkinson, R.</a>, <a>White, R.</a> and <a>M. Fanto</a>, "<a href="http://tools.ietf.org/html/rfc5310">IS-IS Generic Cryptographic Authentication</a>", RFC 5310, February 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6213">[RFC6213]</b></td>
<td class="top">
<a>Hopps, C.</a> and <a>L. Ginsberg</a>, "<a href="http://tools.ietf.org/html/rfc6213">IS-IS BFD-Enabled TLV</a>", RFC 6213, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6232">[RFC6232]</b></td>
<td class="top">
<a>Wei, F.</a>, <a>Qin, Y.</a>, <a>Li, Z.</a>, <a>Li, T.</a> and <a>J. Dong</a>, "<a href="http://tools.ietf.org/html/rfc6232">Purge Originator Identification TLV for IS-IS</a>", RFC 6232, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6233">[RFC6233]</b></td>
<td class="top">
<a>Li, T.</a> and <a>L. Ginsberg</a>, "<a href="http://tools.ietf.org/html/rfc6233">IS-IS Registry Extension for Purges</a>", RFC 6233, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-isis-genapp">[I-D.ietf-isis-genapp]</b></td>
<td class="top">
<a>Ginsberg, L</a>, <a>Previdi, S</a> and <a>M Shand</a>, "<a href="http://tools.ietf.org/html/draft-ietf-isis-genapp-04">Advertising Generic Information in IS-IS</a>", Internet-Draft draft-ietf-isis-genapp-04, November 2010.</td>
</tr>
<tr>
<td class="reference"><b id="IS-IS">[IS-IS]</b></td>
<td class="top">
<a>Intermediate system to Intermediate system intra-domain routeing information exchange protocol for use in conjunction with the protocol for providing the connectionless-mode Network Service (ISO 8473), ISO/IEC 10589:2002, Second Edition.</a>", Nov 2002.</td>, "</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC5309">[RFC5309]</b></td>
<td class="top">
<a>Shen, N.</a> and <a>A. Zinin</a>, "<a href="http://tools.ietf.org/html/rfc5309">Point-to-Point Operation over LAN in Link State Routing Protocols</a>", RFC 5309, October 2008.</td>
</tr></tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stefano Previdi</span> editor
	  <span class="n hidden">
		<span class="family-name">Previdi</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>Via Del Serafico 200</span>

	  <span class="vcardline">
		<span class="locality">Rome</span>,  
		<span class="region"></span>
		<span class="code">0144</span>
	  </span>
	  <span class="country-name vcardline">Italy</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:sprevidi@cisco.com">sprevidi@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Les Ginsberg</span> 
	  <span class="n hidden">
		<span class="family-name">Ginsberg</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>510 McCarthy Blvd.</span>

	  <span class="vcardline">
		<span class="locality">Milpitas</span>,  
		<span class="region">CA</span> 
		<span class="code">95035</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ginsberg@cisco.com">ginsberg@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mike Shand</span> 
	  <span class="n hidden">
		<span class="family-name">Shand</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:imc.shand@googlemail.com">imc.shand@googlemail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Abhay Roy</span> 
	  <span class="n hidden">
		<span class="family-name">Roy</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>170 W. Tasman Dr.</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:akr@cisco.com">akr@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dave Ward</span> 
	  <span class="n hidden">
		<span class="family-name">Ward</span>
	  </span>
	</span>
	<span class="org vcardline">Juniper Networks</span>
	<span class="adr">
	  <span>1194 N. Mathilda Ave.</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">CA</span> 
		<span class="code">94089-1206</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dward@juniper.net">dward@juniper.net</a></span>

  </address>
</div>

</body>
</html>