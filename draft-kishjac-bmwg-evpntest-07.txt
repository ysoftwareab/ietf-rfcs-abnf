 



INTERNET-DRAFT                                      Kishore Tiruveedhula
Intended Status:Standard                                    Sudhin Jacob
Expires: October 1,2017                                Juniper Networks
                                                          May 1,2017


             Benchmarking Methodology for EVPN and PBB-EVPN 
                     draft-kishjac-bmwg-evpntest-07


Abstract

   This document defines the methodologies for benchmarking performance
   of EVPN and PBB-EVPN.EVPN is defined in RFC 7432.It is being deployed
   in provider network.This document provides the benchmarking
   methodologies for EVPN/PBB-EVPN convergence,data plane,control plane
   learning of mac.


Status of this Memo

       This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

      This Internet-Draft will expire on  October 1,2017.


Copyright and License Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.


<Jacob&Kishore>         Expires <October 1,2017>                [Page 1]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


   



Table of Contents

   1  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . .  4
     1.1  Terminology . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.Test Topology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
     2.1 Terminologies  . . . . . . . . . . . . . . . . . . . . . . .  5
   3. Network . . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
      3.1 PBB-EVPN Network Setup  . . . . . . . . . . . . . . . . . .  5
   4.  Test Procedure . . . . . . . . . . . . . . . . . . . . . . . .  6
   5 Test Cases . . . . . . . . . . . . . . . . . . . . . . . . . . .  7
       5.1.1  To check the time taken to learn the mac address in
              DUT . . . . . . . . . . . . . . . . . . . . . . . . . .  7
        5.1.2. To check the time taken to learn X  macs from remote
               peer by DUT  . . . . . . . . . . . . . . . . . . . . .  9
       5.1.3.  To check the time taken to flush the local entry due
               to CE link failure . . . . . . . . . . . . . . . . . . 10
       5.1.4.  To check the time taken by DUT to flush X routes
               learned from remote PE after R1 traffic generator 
			   link failure . ........................................11
       5.1.5.  To measure the mac ageing time.  . . . . . . . . . . . 12
       5.1.6.  To check the time taken by DUT to age X routes
               learned from remote PE after stopping the traffic at
			   remote PE.  ...........................................14
       5.1.7.  To check the time taken by DUT to learn X routes
               from local and X from remote and measure the time
			   of flood from DUT .................................. . 15
       5.1.8.  To measure the time taken to elect a new DF by
               adding a a MHPE. . . . . . . . . . . . . . . . . . . . 16
      5.2    High Availability  . . . . . . . . . . . . . . . . . . . 18
       5.2.1  To check the whether there is traffic loss due to
              routing engine failover for redundancy test.  . . . . . 18
      5.3 ARP/ND Scaling  . . . . . . . . . . . . . . . . . . . . . . 19
      5.4 Type 5 Route scaling  . . . . . . . . . . . . . . . . . . . 20
    6. Scale  . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
     6.1.  To Scale the DUT to N EVI and clear bgp in DUT with out 
           traffic. . . . . . . . . . . . . . . . . . . . . . . . . . 20
     6.2.  To Scale the DUT to N EVI and clear bgp in DUT with 
           traffic.Measure the convergence time . . . . . . . . . . . 22
    7. Soak Test  . . . . . . . . . . . . . . . . . . . . . . . . . . 23
     7.1.  To Scale the DUT to N EVI in DUT with traffic and run 
           the set up for 24hrs . . . . . . . . . . . . . . . . . . . 23
   8. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . 25
   9.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 25
   10.  Security Considerations . . . . . . . . . . . . . . . . . . . 25
 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 2]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


   11 References  . . . . . . . . . . . . . . . . . . . . . . . . . . 25
     11.1  Normative References . . . . . . . . . . . . . . . . . . . 25
     11.2  Informative References . . . . . . . . . . . . . . . . . . 25
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 26










































 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 3]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


1  Introduction

    EVPN which is defined in RFC7432 which describes procedures for
   BGP MPLS-based Ethernet VPNs(EVPN).This document defines the  
   methodologies for benchmarking performance of EVPN.EVPN has been  
   implemented with many varying designs in order to achieve their  
   intended network functionality.The scope of this document is to
   provide methodologies for benchmarking evpn data,control plane mac
   learning,mac flush,mac ageing,convergence,high availability,scale.
   The methodologies defined for evpn can be used for benchmarking the
    performance of PBB-EVPN.PBB-EVPN is defined in RFC 7623.It is
   being deployed in provider network.The difference between PBB-EVPN
   and EVPN is the former learns the customer mac in data plane the
   later learns in control plane.

1.1  Terminology


      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
   NOT",   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
   in this   document are to be interpreted as described in RFC 2119
   [RFC2119].


2.Test Topology


                  Topology Diagram


         Topology Diagram


            | Traffic Generator layer 2 traffic send to each sub interface.
   +----------+
   |          |
   |  R1      |
   |          |
   +----------+
       |
       |
   +----------+
   |          |
   |  RR      |
   |          |
   +----------+-------------|
      |                     |
      |                     |
   +----------+       +-----------+
   |          |       |    MHPE2  |
   |   DUT    |       |           |
   |  MHPE1   |       |           |
   +----------+       +-----------+
        |                  |
   +----------+------------
   |          |
   |  CE      |
   |          |
   +----------+------------ Traffic Generator
                             Layer 2 traffic send to each sub interface


                             Topology Diagram

      	  Figure 1
         	  
			  

 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 4]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


2.1 Terminologies

   MHPE  Multi homed Provide Edge router.

   RR   Route Reflector

   CE Customer Router/Devices

   PE2  Provider Edge router 2		

   AA  EVPN Terminologies AA All-Active 	

   SA  EVPN Terminologies SA Single-Active

   RT Router Tester
   
3. Network

      The network consists of 5 routers and 2 traffic generator
   ports.DUT is acting as one of the MHPE to CE.The RR is acting as
   route reflector and core router.R1 is a Single home router running
   evpn. All four routers except CE are running mpls,bgp emulating a
   provider scenario.CE is a dual home connected to DUT and MHPE2.The
   testing will be done on DUT in order to bench mark the service. DUT
   and the MHPE2 is running EVPN with SA/AA, CE will be configured
   with layer 2 bridge.In AA EVPN there will be LAG running from CE to
   both MHPE's.The DUT and other PE's will be running X EVI's (EVPN
   instances) on X sub interfaces.The traffic generator will be
   connected to R1 and the CE, which is capable of sending layer 2
   frames.The traffic will be send either uni directional or bi   
   directional based on the benchmark parameters to be measured.

 3.1 PBB-EVPN Network Setup

     The network consists of 5 routers and 2 traffic generator
   ports.DUT is acting as one of the MHPE to CE.The RR is acting as
   route reflector and core router.R1 is a Single home router running
   pbbevpn. All four routers except CE are running mpls,bgp emulating
   a provider scenario.CE is a dual home connected to DUT and
   MHPE2.DUT and MHPE2 is running PBB-EVPN with SA/AA with CE.CE will
   be configured with layer 2 bridge.In AA PBB-EVPN there will be LAG
   running from CE to both MHPE's.The DUT and other PE's will be
   running X EVI's (PBB-EVPN instances) on X sub interfaces.The
   traffic generator will be connected to R1 and the CE, which is
   capable of sending layer 2 frames.The traffic will be send either
   uni directional or bi directional based on the benchmark parameters
   to be measured.


 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 5]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


4.  Test Procedure

   The test defined to bench mark the performance of EVPN mac learning
   in control pland and data plane. Mac flush,High Availability,
   convergence time in link failures,scale scenarios.


   4.1 MAC Learning in Control plane and Data Plane

   The MAC will be learned in data plane and control plane, test is to
   measure the time taken to learn the "X" number of mac's in time "T"
   sec. The data plane learning will from the locally connected
   interface. The control plane learning is through BGP advertisements
   from the remote PE. Let the local learning time be "T" and control
   plane learning time be "T'". The data plane mac learning can be
   measured using the parameters defined in RFC 2889 section 5.8.


   4.2 MAC flush for locally learned and remote learned MAC

   The time taken to flush the "X" locally learned mac, let it be "T1"
   sec, once the traffic is stopped. The time taken to flush the remote
   mac which is learned by control plane let it be "X" macs.The time
   taken to flush the "X" remote macs, which is measured as "T2" sec. 


   4.3 High Availability

   The traffic is flowing bi direction. The bgp is converged,consider 
   there are "X" numbers of macs learned locally and remotely. 
   Then traffic is flowing at "P" packets per sec. The traffic generator
   is measuring the Tx and Rx packets, while the routing engine fail over there
   should not any packet loss the router tester must show both "P"
   packet per seconds.


   4.4 Convergence Time

   During any events like link failure, hard reset measure the time
   taken to learn "X" mac's locally and remotely.


   4.5 Scale

   This is to measure the performance of DUT in scaling to "X" EVPN
   instances. The measured parameters are CPU usage, memory
   leak,crashes.

 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 6]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


   4.6 SOAK

   This test is used to measure the performance of DUT over a period of
   time,with scaled configuration and traffic over a period of time
   "T'". In each interval "t1" the parameters measured are CPU usage,
   memory usage and crashes.


   4.7 Measurement Statistics

   The test is repeated for "N" times and the value is taken by
   averaging the values.



5 Test Cases

   The following tests are conducted to measure mac learning of local as
   well as remote.
   
5.1.1  To check the time taken to learn the mac address in DUT

      Objective:

      To check the time taken to learn the mac address locally and time 
    taken to send the locally learned routes to peers.

      a.  Send X unicast frames from CE to MHPE1(DUT) working in SA     
    mode with different source and destination address, where DUT is    
     the DF so that it can forward the traffic.Measure the time      
   taken to learn these mac in forwarding table and in control plane. 	 
    The data plane learning is measured using RFC 2889 section 5.8. 	  
   Sending frames to the limit of bridge domain of particular EVI. 	  
   Measure the time taken to learn all X mac in data plane/hardware. 	  
   The Range of MAC is known from RT and this is verified in DUT.

      b.  Measure the time taken to send these X type 2 routes from     
    DUT to its peers. 	
	
 	Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 7]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


     be configured per IFD/Interface.Using RT (traffic generator) to  
   send the traffic to the CE. The traffic is unidirectional.Since CE
   is working in bridge mode,frames will be send to ingress sub  
   interface of DUT.



      Measurement

      The DUT mac table must learn the X macs in data plane in T time
   frame.The DUT must send type 2 routes to remote router in T' time
   frame.Repeat the test and plot the data.The data plane measurement
   is taken by considering DUT as black box the range of X mac is
   known from RT and the same is learned in DUT, the time to learn
   that is measured.


      PBB-EVPN  To check the time taken to learn the mac address in DUT

      Objective:

      To check the time taken to learn the mac address locally.


      a.  Send X unicast frames from CE to MHPE1(DUT) working in SA     
    mode with different source and destination address, where DUT is    
     the DF so that it can forward the traffic. Measure the time      
   taken to learn these mac in forwarding table.The data plane 	  
   learning is measured using RFC 2889 section 5.8.Sending frames to
   the limit of bridge domain of particular EVI.Measure the time
   taken to learn all X mac in data plane/hardware.The Range of
   MAC is known from RT and this is verified in DUT.

      Procedure:

      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.Using RT (traffic generator) to  
   send the traffic to the routers.








 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 8]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


      Measurement

      The DUT mac table must learn the X macs in data plane in T time
   frame. Repeat the test and plot the data.The data plane measurement
   is taken by considering DUT as black box the range of X mac is
   known from RT and the same is learned in DUT, the time to learn
   that is measured.





 5.1.2. To check the time taken to learn X  macs from remote peer by DUT

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.Measure the time taken to learn these X          
    macs from remote peer and program the mac address table.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table. For MH PE ESI  
   must be configured per IFD/Interface.Using RT(traffic generator)   
   send the traffic to R1. The traffic is uni directional. There   wont
   be any traffic flow from CE to DUT during this test.

      Measurement:

      The DUT mac table must learn the X mac address in T time frame.  
   Repeat these test and plot the data.


     PBB-EVPN To check the time taken to learn X mac's from remote peer 
            by DUT.

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.Measure the time taken to learn these X macs from
   remote peer and program the mac address table.

       Procedure:

      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
 


<Jacob&Kishore>         Expires <October 1,2017>                [Page 9]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


   DUT.Once the bgp comes up check the DUT pbb-evpn table. For MHPE ESI 
    must be configured per IFD/Interface.Using RT(traffic generator)   
   send the traffic to R1. The traffic is uni directional. There   wont
   be any traffic flow from CE to DUT during this test.

      Measurement:

      The DUT mac table must learn the X mac address in T time frame.  
   Repeat these test and plot the data.







   The following test cases are executed to measure the time taken to
   flush the mac table in case of an event

5.1.3.  To check the time taken to flush the local entry due to CE link
   failure

      Objective:

      Send  X frames with different SA and DA to DUT from CE using  
   traffic generator.Wait for a while  to learn all X mac address.  
   Then fail the DUT CE link and measure the time taken to flush these  
   X macs from the mac table and from control plane.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and DUT.
     Once the bgp comes up check the DUT evpn table. For MH PE ESI must 
    be configured per IFD/Interface. Using RT(traffic generator) to send
     the traffic to the routers.In this traffic will be only send from
   CE.

      Measurement:

       Measure the time taken for flushing these X mac address.Repeat
   the test and plot the data. 
   
   PBB-EVPN  To check the time taken to flush the local entry due to CE
             link failure

      Objective:

      Send  X frames with different SA and DA to DUT from CE using  
   traffic generator.Wait for a while to learn all X mac address.Then  
 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 10]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


   fail the DUT CE link and measure the time taken to flush these X
   macs from the mac table.

     Procedure:

      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.   Once the bgp comes up check the DUT pbb-evpn table. For MH PE
   ESI must   be configured per IFD/Interface. Using RT(traffic
   generator) to send   the traffic to the routers.In this traffic will
   be only send from CE.

      Measurement:

      The DUT mac table must learn the X mac address and  measure the
   time taken for flushing these X mac address.







5.1.4.  To check the time taken by DUT to flush X routes learned from
   remote PE after R1 traffic generator link failure

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.Bring down the link between R1 and traffic  
   generator.Then measure the time taken to flush the DUT mac address  
   table.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface. Using RT(traffic generator) to
   send   the traffic to the  R1.There wont be any traffic flowing to CE
   from RT.

      Measurement:

      Measure the time taken to flush X remote routes from mac table  
   of DUT.Repeat the test and plot the data.


 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 11]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


    PBB-EVPN To check the time taken by DUT to flush X macs learned     
     from remote PE after R1 traffic generator link failure

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.Bring down the link between R1 and traffic  
   generator.Then measure the time taken to flush the DUT mac address  
   table.The remote macs will be learned by Data plane,but the B-MAC  
   will be learned by control plane.

      Procedure:

     Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are 
    running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.   Once the bgp comes up check the DUT pbb-evpn table.For MH PE
   ESI must   be configured per IFD/Interface. Using RT(traffic
   generator) to send   the traffic to the routers.In this traffic will
   be only send from CE.


      Measurement:

      Measure the time taken to flush X remote macs from mac table of
   DUT.








   The following test cases are executed to measure the mac ageing in
   locally learned and remote mac learned by control plane.

5.1.5.  To measure the mac ageing time.

      Objective:

      Send X frames with different SA and DA to DUT from CE using  
   traffic generator.Wait to learn all X mac address.Then stop the
   traffic.Wait to see how long it takes to flush these mac entries
   due to ageing.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are  
 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 12]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI  
   must be configured per IFD/Interface.Using RT(traffic generator) to  
   send the traffic to the routers.The traffic will be flowing from CE  
   to DUT.There wont be any traffic from R1.

      Measurement:

      Measure the time taken to flush X mac address due to ageing.Repeat
   the   test and plot the data.

       PBB-EVPN To measure the mac ageing time.

      Objective:

      Send X frames with different SA and DA to DUT from CE using  
   traffic generator.Wait to learn all X mac address.Then   stop the
   traffic.Wait to see how long it takes to flush these mac   entries
   due to ageing.

      Procedure:

      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT mac table.  For MH PE ESI  
   must be configured per IFD/Interface.  Using RT(traffic generator) to
     send the traffic to the routers.

      Measurement:

      The DUT mac table must learn the X mac address, measure the time
   taken for flushing these X mac address due to ageing.
















 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 13]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


5.1.6.  To check the time taken by DUT to age X routes learned from
   remote PE after stopping the traffic at remote PE.

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.After stopping the traffic at remote PE R1  
   traffic generator due to mac ageing it will withdraw its routes from 
    remote PE's.Measure the time taken to remove these macs from DUT  
   mac table.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.Using RT(traffic generator) to send
     the traffic to R1.There wont be any traffic from CE.

      Measurement:

      Measure the time taken to flush X remote macs from mac table of
   DUT due to ageing.Repeat the test and plot the data.


      PBB-EVPN To check the time taken by DUT to age X mac from remote
   PE after stopping the traffic at remote PE.

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.After stopping the traffic at remote PE(R1) traffic
     generator.Measure the time taken to remove these macs from DUT mac 
    table.

      Procedure:

      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT mac table.For MH PE ESI must 
    be configured per IFD/Interface.Using RT(traffic generator) to
   send the traffic to the routers.

      Measurement:

      Measure the time taken to flush the remote macs from mac table of 
    DUT due to ageing.

 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 14]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


   The following tests are executed to measure the convergence time in
   case of an event or by lerning the mac without any external trigger.

5.1.7.  To check the time taken by DUT to learn X routes from local and
   X from remote and measure the time of flood from DUT.

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.Send X frames with different SA and DA from
   traffic generator connected to CE.The SA and DA of flows must be
   complimentary to have unicast flows.Measure the time taken by the
   DUT to learn 2X in mac table and in control plane.Measure the flood
   time period of DUT.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI  
   must be configured per IFD/Interface.Using RT(traffic generator) to  
   send the traffic to the routers.The traffic is bi directional.

      Measurement:

      Measure the time taken to learn 2X routes in control and mac  
   address table in DUT and measure the flood time of DUT.Repeat the
   test and plot the data.


      PBB-EVPN To check the time taken by DUT to learn X macs from      
    local and X from remote and measure the time of flood from       
   DUT.

      Objective:

      Send X frames with different SA and DA to DUT from R1 using  
   traffic generator.  Send X frames with different SA and DA from  
   traffic generator connected to CE.The SA and DA of flows must be  
   complimentary to have unicast flows.Measure the time taken by the  
   DUT to learn 2X in mac table.Measure the flood time period of   DUT.







 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 15]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


      Procedure:

      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI  
   must be configured per IFD/Interface.Using RT(traffic generator) to  
   send the traffic to the routers.









     Measurement:

      Measure the time taken to learn 2X mac address table in DUT.   and
   measure the flood time of DUT.Repeat the test and plot the data.




5.1.8.  To measure the time taken to elect a new DF by adding a a MHPE.

      Objective:

      Send X frames from CE to DUT from traffic generator with  
   different SA and DA.Wait to learn all X mac address.Then add a new
   router configured with evpn to the same ethernet segment.Configure
   same ESI value which is configured in DUT and in MHPE1 on IFD.Then
   the new DF election take place during that time there should not be
   any loop and measure the time taken to come up the new DF.Measure
   the time taken to elect the new DF.


      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MHPE ESI  
   must be configured per IFD/Interface.Using RT(traffic generator) to  
   send the traffic to the routers.

      Measurement:

      Measure the time taken for new DF election in DUT and there should
 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 16]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


     not be any loop or forwarding the BUM traffic back to the same  
   segment.

     PBB-EVPN To measure the time taken to elect a new DF by adding a a
   MHPE.

      Objective:

      Send X frames from CE to DUT from traffic generator with  
   different SA and DA.Wait to learn all X mac address.Then   add a new
   router to the same Ethernet segment by configuring the same   ESI
   value configured in DUT,MHPE2 in IFD.Then the new DF election take
   place   during that time there should not be any loop and measure the
   time   taken to come up the new DF.Measure the time taken to elect
   the new   DF.

      Procedure:

      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI  
   must be configured per IFD/Interface.  Using RT(traffic generator) to
     send the traffic to the routers.

      Measurement:

      Measure the time taken for new DF election in DUT and there should
     not be any loop or forwarding the BUM traffic back to the same  
   segment.



















 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 17]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


 5.2    High Availability

      These tests are conducted to check after an event there wont be
   any change in functionality.
   
5.2.1  To check the whether there is traffic loss due to routing engine
   failover for redundancy test.

      Objective:

      Send X frames from CE to DUT from traffic generator with  
   different SA and DA.  Send X frames from traffic generator to R1
   with different SA and DA so that 2X mac address will be   learned in
   DUT. There is a bi directional traffic flow with X   pps in each
   direction. Then do a routing engine failover.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.Using RT(traffic generator) to send
     the traffic to the routers.

      Measurement:

     There should be 0 traffic loss  which is the ideal case,No
   change in the DF role.No withdraw of any routes.





   PBB-EVPN  To check the whether there is traffic loss due to routing
   engine failover for redundancy test.

      Objective:

      Send X frames from CE to DUT from traffic generator with  
   different SA and DA.Send X frames from traffic generator to R1 with
   different SA and DA so that 2X mac address will be learned in DUT. 
   There is a bi directional traffic flow with X pps in each
   direction.Then do a routing engine failover.


     Procedure:


      Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 18]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


     running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.  Using RT(traffic generator) to
   send   the traffic to the routers.

      Measurement:

      There should be 0 packet loss loss which is a ideal case,No change
   in the DF role. No withdraw of any routes.







 5.3 ARP/ND Scaling

      These tests are conducted to check the scaling parameter of arp/ND
   of the DUT.

   EVPN: To check the ARP/ND scale of the DUT when the gateway is
   configured.

      Objective:

      Send X arp/icmpv6 request from RT to DUT,that with different
   sender ip/ipv6 address to the same target gateway ip address.


     Procedure:


      Configure EPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.Using RT(traffic generator) to
   send the arp request to the DUT which has gateway configured.

      Measurement:

      The DUT must learn X mac+ip/mac+ipv6 and it must advertise the X
   mac+ip/mac+ipv6 to the remote router.





 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 19]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


 5.4 Type 5 Route scaling 


    These tests are conducted to scale the type 5 route or the IP
   prefixes in DUT.


   EVPN: To check the scale of ip prefixes advertised by DUT to the peer
   router.

      Objective:

     To check the scale of IP Prefixes advertised by the DUT to the peer
   router.


     Procedure:


      Configure EPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.Configure the X IRB sub interface  
    in the DUT which is not extended to peer router.

      Measurement:

      The DUT must advertise X IP prefixes of the IRB to the peer
   router.















 6. Scale
6.1.  To Scale the DUT to N EVI and clear bgp in DUT with out traffic.

      Objective:
 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 20]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


      The main purpose of the test the DUT performance to scale N EVI's.
     Then clear bgp neighbor. There should not be any loss of routes or 
    any crashes.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MHPE,DUT ESI
   must   be configured per IFD/Interface.  Using RT(traffic generator)
   to send   the traffic to the routers.

      Measurement

    There should not be any loss of route types 1,2,3 and 4 in DUT.


    PBB-EVPN To Scale the DUT to N PBB-EVPN instances and clear bgp in
   DUT        without traffic.

      Objective:

      The main purpose of the test the DUT performance to scale N PBB-
   EVPN  instances.Then clear bgp neighbor.There should not be any loss
   of routes or any crashes.


      Procedure:

      Configure PBB-EVPN instances in R1,MHPE2,DUT.All 4 routers except
   CE   are running mpls,bgp,RR is acting as route reflector to R1,MHPE2
   and   DUT.Once the bgp comes up check the DUT evpn table.For MH PE
   ESI must   be configured per IFD/Interface.Using RT(traffic
   generator) to send the traffic to the routers.

      Measurement

      There should not be any loss of route types 2,3 and 4 in DUT.










 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 21]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


6.2.  To Scale the DUT to N EVI and clear bgp in DUT with
   traffic.Measure the convergence time

      Objective:

      The main purpose of the test the DUT performance to scale N EVI's 
    with traffic.  Then clear bgp neighbor.There should not be any loss 
    of routes or any crashes.  Send F frames from CE to DUT from  
   traffic generator with different SA and DA for N EVI's.  Send   F
   frames from traffic generator to R1 with different SA and DA   for N
   EVI's.so that 2F number of mac address will be learned in DUT.  
   There is a bi directional traffic flow with F pps in each  
   direction.  Then clear the bgp nei in DUT after the bgp comes up and 
    started learning the routes, measure the time taken to learn all  
   2F mac routes.

      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.  Using RT(traffic generator) to
   send   the traffic to the routers.

      Measurement:

      The DUT must learn all 2F mac address.Measure the time taken   to
   learn 2F mac in DUT, measure the flood traffic time "t" of DUT


      PBB-EVPN To Scale the DUT to "N" PBB-EVPN instances and clear bgp
   in DUT with traffic.Measure the convergence time

      Objective:

      The main purpose of the test the DUT performance to scale N pbb-
   evpn   instances with traffic.Then clear bgp neighbor.There should
   not be   any loss of routes or any crashes.Send F frames from CE to  
   DUT from traffic generator with different SA and DA for N pbb-evpn  
   instances.Send F frames from traffic generator to R1 with   different
   SA and DA for N pbb-evpn instances.so that F mac address will be
   learned in DUT.There is a bi directional traffic flow with F pps in
   each direction.Then clear the bgp nei in   DUT after the bgp comes up
   and started learning the routes, measure the time taken to learn
   all 2F macs in DUT.



 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 22]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


      Procedure:

      Configure PBB-EVPN instances in R1,MHPE2,DUT.All 4 routers except
   CE   are running mpls,bgp,RR is acting as route reflector to R1,MHPE2
   and   DUT.Once the bgp comes up check the DUT evpn table.For MH PE
   ESI must   be configured per IFD/Interface.  Using RT(traffic
   generator) to send   the traffic to the routers.

      Measurement:

        The DUT must learn all 2F mac address.Measure the time taken  
   to learn 2F mac in DUT, measure the flood traffic time "t"   of DUT


 7. Soak Test

7.1.  To Scale the DUT to N EVI in DUT with traffic and run the set up
   for 24hrs

      Objective:

    The main purpose of the test the DUT performance to scale N EVI's 
    with traffic.There should not be any loss of routes or any crashes.
	Send  F frames from CE to DUT from traffic generator with different
	SA and DA for N EVI's.Send F frames from traffic generator to R1 with 
	different SA and DA for N EVI's.so that 2F mac address will be 
	learned in DUT. There is a bi directional traffic flow with F 
	pps in each direction.Keep the setup up and running for 24 hrs,
	take hourly CPU   utilization,memory usage.





      Procedure:

      Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are  
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and  
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
     be configured per IFD/Interface.  Using RT(traffic generator) to
   send   the traffic to the routers.

      Measurement:

      Take the hourly reading of CPU,process memory.There should not be
   any   leak,crashes,CPU spikes.

 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 23]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


      PBB-EVPN To Scale the DUT to N PBB-EVPN instances in DUT with
   traffic and run the set up for 24hrs

      Objective:

      The main purpose of the test the DUT performance to scale N EVI's 
    with traffic.There should not be any
   loss of routes or any crashes.Send F frames from CE to DUT from 
    traffic generator with different SA and DA for N EVI's.Send F
   frames from traffic generator to R1 with different SA and DA for N
   EVI's.so that 2F mac address will be learned in DUT.   There is a bi
   directional traffic flow with F pps in each direction.Keep the
   setup up and running for 24 hrs,take hourly CPU utilization,memory
   usage.

      Procedure:

      Configure PBB-EVPN instances in R1,MHPE2,DUT.All 4 routers except
   CE are running mpls,bgp,RR is acting as route reflector to R1,MHPE2
   and DUT.Once the bgp comes up check the DUT evpn table.For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) to send the traffic to the routers.

      Measurement:

      Take the hourly reading of CPU,process memory.There should not be
   any leak,crashes,CPU spikes.





















 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 24]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


8. Acknowledgements

      We would like to thank Fioccola Giuseppe of Telecom Italia
   reviewing our draft and commenting it.
   
9.  IANA Considerations

    This memo includes no request to IANA.
	
10.  Security Considerations

      There is no additional consideration from RFC 6192.
11 References

11.1  Normative References


            [RFC2119]  Bradner, S., "Key words for use in RFCs to
              Indicate Requirement Levels", BCP 14, RFC 2119,           
                DOI 10.17487/RFC2119, June 1997,<http://www.rfc-
              editor.org/info/rfc2119>.

            [RFC2544]  Bradner, S. and J. McQuaid, "Benchmarking
              Methodology for Network Interconnect Devices", RFC   
              2544,DOI 10.17487/RFC2544, June 1999,<http://www.rfc-
              editor.org/info/rfc2544>. 
			  
	[RFC2889]  R.Mandeville and J. Perser "Benchmarking Methodology
			  for LAN Switching Devices"

11.2  Informative References



            [RFC7432]  Sajassi, A., Ed., Aggarwal, R., Bitar, N.,
              Isaac, A.,Uttaro, J., Drake, J., and W.Henderickx, 
			  "BGP MPLS-Based Ethernet VPN",
              RFC 7432, DOI 10.17487/RFC7432, February             
              2015, <http://www.rfc-editor.org/info/rfc7432>.

            [RFC7623]  Sajassi, A., Ed., Aggarwal, R., Bitar, N.,
              Isaac, A.,J., Drake, J., and W. Henderickx,
              " Provider Backbone Bridging Combined with Ethernet
              VPN(PBB-EVPN)",RFC 7623,10.17487/RFC7623,September 2015              
              <http://www.rfc-editor.org/info/rfc7623>.


              			  


 


<Jacob&Kishore>         Expires <October 1,2017>               [Page 25]

INTERNET DRAFT      <draft-kishjac-bmwg-evpntest-06>        <May 1,2017>


Authors' Addresses


   Appendix A.  Appendix

   Authors' Addresses

      Sudhin Jacob (editor)
      Juniper Networks
      Bangalore
      India

      Phone: +91 8061212543
      Email: sjacob@juniper.net
             sudhinjacob@rediffmail.com



      Kishore Tiruveedhula
      Juniper Networks
      10 Technology Park Dr
      Westford, MA  01886
      USA

      Phone: +1 9785898861
      Email: kishoret@juniper.net

























<Jacob&Kishore>         Expires <October 1,2017>               [Page 26]
