<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Describing Protocol Data Units with Augmented Packet Header Diagrams</title>
<meta content="Stephen McQuistin" name="author">
<meta content="Vivian Band" name="author">
<meta content="Dejice Jacob" name="author">
<meta content="Colin Perkins" name="author">
<meta content="
       
              This document describes a machine-readable format for specifying
              the syntax of protocol data units within a protocol specification.
              This format is comprised of a consistently formatted packet header
              diagram, followed by structured explanatory text. It is
              designed to maintain human readability while enabling support for
              automated parser generation from the specification document. This
              document is itself an example of how the format can be used.
       
    " name="description">
<meta content="xml2rfc 2.45.3" name="generator">
<meta content="draft-mcquistin-augmented-ascii-diagrams-05" name="ietf.draft">
<link href="/tmp/draft-mcquistin-augmented-ascii-diagrams-t88bf5oj.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Augmented Packet Diagrams</td>
<td class="right">June 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">McQuistin, et al.</td>
<td class="center">Expires 19 December 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mcquistin-augmented-ascii-diagrams-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-06-17" class="published">17 June 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-12-19">19 December 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. McQuistin</div>
<div class="org">University of Glasgow</div>
</div>
<div class="author">
      <div class="author-name">V. Band</div>
<div class="org">University of Glasgow</div>
</div>
<div class="author">
      <div class="author-name">D. Jacob</div>
<div class="org">University of Glasgow</div>
</div>
<div class="author">
      <div class="author-name">C. S. Perkins</div>
<div class="org">University of Glasgow</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Describing Protocol Data Units with Augmented Packet Header Diagrams</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
              This document describes a machine-readable format for specifying
              the syntax of protocol data units within a protocol specification.
              This format is comprised of a consistently formatted packet header
              diagram, followed by structured explanatory text. It is
              designed to maintain human readability while enabling support for
              automated parser generation from the specification document. This
              document is itself an example of how the format can be used.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 December 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-limitations-of-current-pack" class="xref">Limitations of Current Packet Format Diagrams</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-formal-languages-in-standar" class="xref">Formal languages in standards documents</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-design-principles" class="xref">Design Principles</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-augmented-packet-header-dia" class="xref">Augmented Packet Header Diagrams</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-pdus-with-fixed-and-variabl" class="xref">PDUs with Fixed and Variable-Width Fields</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-pdus-that-cross-reference-p" class="xref">PDUs That Cross-Reference Previously Defined Fields</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-pdus-with-non-contiguous-fi" class="xref">PDUs with Non-Contiguous Fields</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-pdus-with-constraints-on-fi" class="xref">PDUs with Constraints on Field Values</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-pdus-that-extend-sub-struct" class="xref">PDUs That Extend Sub-Structures</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-storing-data-for-parsing" class="xref">Storing Data for Parsing</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-connecting-structures-with-" class="xref">Connecting Structures with Functions</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-specifying-enumerated-types" class="xref">Specifying Enumerated Types</a><a href="#section-toc.1-1.4.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-specifying-protocol-data-un" class="xref">Specifying Protocol Data Units</a><a href="#section-toc.1-1.4.2.9.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="xref">4.10</a>. <a href="#name-importing-pdu-definitions-f" class="xref">Importing PDU Definitions from Other Documents</a><a href="#section-toc.1-1.4.2.10.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-open-issues" class="xref">Open Issues</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-abnf-specification" class="xref">ABNF specification</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-constraint-expressions" class="xref">Constraint Expressions</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-augmented-packet-diagrams" class="xref">Augmented packet diagrams</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-source-code-repository" class="xref">Source code repository</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="ulEmpty compact toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
                Packet header diagrams have become a widely used format for
                describing the syntax of binary protocols. In otherwise largely textual
                documents, they allow for the visualisation of packet formats, reducing
                human error, and aiding in the implementation of parsers for the protocols
                that they specify.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
                <a href="#tcp-header-format" class="xref">Figure 1</a> gives an example of how packet
                header diagrams are used to define binary protocol formats. The format
                has an obvious structure: the diagram clearly delineates each field,
                showing its width and its position within the header. This type of diagram is
                designed for human readers, but is consistent enough that it should
                be possible to develop a tool that generates a parser for the packet
                format from the diagram.<a href="#section-1-2" class="pilcrow">¶</a></p>
<span id="name-tcps-header-format-from"></span><div id="tcp-header-format">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-1-3.1">
<pre>
:    0                   1                   2                   3
:    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |          Source Port          |       Destination Port        |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                        Sequence Number                        |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                    Acknowledgment Number                      |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |  Data |           |U|A|P|R|S|F|                               |
:   | Offset| Reserved  |R|C|S|S|Y|I|            Window             |
:   |       |           |G|K|H|T|N|N|                               |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |           Checksum            |         Urgent Pointer        |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                    Options                    |    Padding    |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                             data                              |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-tcps-header-format-from" class="selfRef">TCP's header format (from <em class="xref">RFC793</em>)</a>
        </figcaption></figure>
</div>
<p id="section-1-4">
                Unfortunately, the format of such packet diagrams varies both within
                and between documents. This variation makes it difficult to build
                tools to generate parsers from the specifications. Better tooling
                could be developed if protocol specifications adopted a consistent
                format for their packet descriptions. Indeed,
                this underpins the format described by this draft: we want to
                retain the benefits that packet header diagrams provide, while identifying
                the benefits of adopting a consistent format.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
                This document describes a consistent packet header diagram format and
                accompanying structured text constructs that allow for the parsing process
                of protocol headers to be fully specified. This provides support for the
                automatic generation of parser code. Broad design principles, that seek
                to maintain the primacy of human readability and flexibility in
                writing, are described, before the format itself is given.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
                This document is itself an example of the approach that it describes, with
                the packet header diagrams and structured text format described by example.
                Examples that do not form part of the protocol description language are
                marked by a colon at the beginning of each line; this prevents them from
                being parsed by the accompanying tooling.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">
                This draft describes early work. As consensus builds around the
                particular syntax of the format described, both a formal ABNF
                specification (<a href="#ABNF" class="xref">Appendix A</a>) and code (<a href="#source" class="xref">Appendix B</a>) that
                parses it (and, as described above, this document) will be provided.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background">
<section id="section-2">
      <h2 id="name-background">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-2-1">
                This section begins by considering how packet header diagrams are
                used in existing documents. This exposes the limitations that the current
                usage has in terms of machine-readability, guiding the design of the
                format that this document proposes.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
                While this document focuses on the machine-readability of packet format
                diagrams, this section also discusses the use of other structured or formal
                languages within IETF documents. Considering how and why these languages
                are used provides an instructive contrast to the relatively incremental
                approach proposed here.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="background-ascii">
<section id="section-2.1">
        <h3 id="name-limitations-of-current-pack">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-limitations-of-current-pack" class="section-name selfRef">Limitations of Current Packet Format Diagrams</a>
        </h3>
<span id="name-quics-reset_stream-frame-fo"></span><div id="quic-reset-stream">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-2.1-1.1">
<pre>
:   The RESET_STREAM frame is as follows:
:
:    0                   1                   2                   3
:    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                        Stream ID (i)                        ...
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |  Application Error Code (16)  |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |                        Final Size (i)                       ...
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:
:   RESET_STREAM frames contain the following fields:
:
:   Stream ID:  A variable-length integer encoding of the Stream ID
:      of the stream being terminated.
:
:   Application Protocol Error Code:  A 16-bit application protocol
:      error code (see Section 20.1) which indicates why the stream
:      is being closed.
:
:   Final Size: A variable-length integer indicating the final size
:      of the stream by the RESET_STREAM sender, in unit of bytes.
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-quics-reset_stream-frame-fo" class="selfRef">QUIC's RESET_STREAM frame format (from <em class="xref">QUIC-TRANSPORT</em>)</a>
          </figcaption></figure>
</div>
<p id="section-2.1-2">
                  Packet header diagrams are frequently used in IETF standards to describe the
                  format of binary protocols. While there is no standard for how
                  these diagrams should be formatted, they have a broadly similar structure,
                  where the layout of a protocol data unit (PDU) or structure is shown in
                  diagrammatic form, followed by a description list of the fields that it
                  contains. An example of this format, taken from the QUIC specification,
                  is given in <a href="#quic-reset-stream" class="xref">Figure 2</a>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">
                  These packet header diagrams, and the accompanying descriptions, are
                  formatted for human readers rather than for automated processing. As
                  a result, while there is rough consistency in how packet header diagrams are
                  formatted, there are a number of limitations that make them difficult
                  to work with programmatically:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2.1-4">
          <dt id="section-2.1-4.1">
                    Inconsistent syntax:
          </dt>
<dd id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">
                      There are two classes of consistency that are needed to support
                      automated processing of specifications: internal consistency
                      within a diagram or document, and external consistency across
                      all documents.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-4.2.2">
                        <a href="#quic-reset-stream" class="xref">Figure 2</a> gives an example of internal
                        inconsistency. Here, the packet diagram shows a field labelled
                        "Application Error Code", while the accompanying description lists
                        the field as "Application Protocol Error Code". The use of an
                        abbreviated name is suitable for human readers, but makes parsing
                        the structure difficult for machines.

                        <a href="#dhcpv6-relaysrcopt" class="xref">Figure 3</a> gives a further example, where
                        the description includes an "Option-Code" field that does not appear
                        in the packet diagram; and where the description states that
                        each field is 16 bits in length, but the diagram shows
                        the OPTION_RELAY_PORT as 13 bits, and Option-Len as 19 bits.

                        Another example is <span>[<a href="#RFC6958" class="xref">RFC6958</a>]</span>, where the packet
                        format diagram showing the structure of the Burst/Gap Loss Metrics
                        Report Block shows the Number of Bursts field as being 12 bits wide
                        but the corresponding text describes it as 16 bits.<a href="#section-2.1-4.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-4.2.3">
                        Comparing <a href="#quic-reset-stream" class="xref">Figure 2</a> with
                        <a href="#dhcpv6-relaysrcopt" class="xref">Figure 3</a> exposes external
                        inconsistency across documents. While the packet format
                        diagrams are broadly similar, the surrounding text is
                        formatted differently. If machine parsing is to be made
                        possible, then this text must be structured consistently.<a href="#section-2.1-4.2.3" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-2.1-4.3">
                      Ambiguous constraints:
          </dt>
<dd id="section-2.1-4.4">
                      The constraints that are enforced on a particular field are often
                      described ambiguously, or in a way that cannot be parsed easily.
                      In <a href="#dhcpv6-relaysrcopt" class="xref">Figure 3</a>, each of the three fields
                      in the structure is constrained. The first two fields
                      ("Option-Code" and "Option-Len") are to be set to constant values
                      (note the inconsistency in how these constraints are expressed in
                      the description). However, the third field ("Downstream Source
                      Port") can take a value from a constrained set. This constraint
                      is expressed in prose that cannot readily by understood by machine.<a href="#section-2.1-4.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-2.1-4.5">
                      Poor linking between sub-structures:
          </dt>
<dd id="section-2.1-4.6">
            <p id="section-2.1-4.6.1">
                        Protocol data units and other structures are often comprised of
                        sub-structures that are defined elsewhere, either in the same
                        document, or within another document. Chaining these structures
                        together is essential for machine parsing: the parsing process for
                        a protocol data unit is only fully expressed if all elements can
                        be parsed.<a href="#section-2.1-4.6.1" class="pilcrow">¶</a></p>
<p id="section-2.1-4.6.2">
                        <a href="#quic-reset-stream" class="xref">Figure 2</a> highlights the difficulty that
                        machine parsers have in chaining structures together. Two fields
                        ("Stream ID" and "Final Size") are described as being encoded as
                        variable-length integers; this is a structure described elsewhere
                        in the same document. Structured text is required both alongside
                        the definition of the containing structure and with the definition
                        of the sub-structure, to allow a parser to link the two together.<a href="#section-2.1-4.6.2" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-2.1-4.7">
                        Lack of extension and evolution syntax:
          </dt>
<dd id="section-2.1-4.8">
            <p id="section-2.1-4.8.1">
                            Protocols are often specified across multiple documents, either
                            because the protocol explicitly includes extension points (e.g.,
                            profiles and payload format specifications in RTP
                            <span>[<a href="#RFC3550" class="xref">RFC3550</a>]</span>) or because definition of a protocol
                            data unit has changed and evolved over time. As a result, it is
                            essential that syntax be provided to allow for a complete
                            definition of a protocol's parsing process to be constructed
                            across multiple documents.<a href="#section-2.1-4.8.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
<span id="name-dhcpv6s-relay-source-port-o"></span><div id="dhcpv6-relaysrcopt">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-2.1-5.1">
<pre>
:   The format of the "Relay Source Port Option" is shown below:
:
:    0                   1                   2                   3
:    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |    OPTION_RELAY_PORT    |         Option-Len                  |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:   |    Downstream Source Port     |
:   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:
:   Where:
:
:   Option-Code:  OPTION_RELAY_PORT. 16-bit value, 135.
:
:   Option-Len:  16-bit value to be set to 2.
:
:   Downstream Source Port:  16-bit value.  To be set by the IPv6
:      relay either to the downstream relay agent's UDP source port
:      used for the UDP packet, or to zero if only the local relay
:      agent uses the non-DHCP UDP port (not 547).
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-dhcpv6s-relay-source-port-o" class="selfRef">DHCPv6's Relay Source Port Option (from <em class="xref">RFC8357</em>)</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="background-others">
<section id="section-2.2">
        <h3 id="name-formal-languages-in-standar">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-formal-languages-in-standar" class="section-name selfRef">Formal languages in standards documents</a>
        </h3>
<p id="section-2.2-1">
                    A small proportion of IETF standards documents contain
                    structured and formal languages, including ABNF <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>,
                    ASN.1 <span>[<a href="#ASN1" class="xref">ASN1</a>]</span>, C, CBOR <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span>, JSON,
                    the TLS presentation language <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, YANG models
                    <span>[<a href="#RFC7950" class="xref">RFC7950</a>]</span>, and XML. While this broad
                    range of languages may be problematic for the development of tooling
                    to parse specifications, these, and other, languages serve a range of
                    different use cases. ABNF, for example, is typically used to specify
                    text protocols, while ASN.1 is used to specify data structure
                    serialisation. This document specifies a structured language for specifying
                    the parsing of binary protocol data units.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="designprinciples">
<section id="section-3">
      <h2 id="name-design-principles">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-design-principles" class="section-name selfRef">Design Principles</a>
      </h2>
<p id="section-3-1">
                The use of structures that are designed to support machine readability
                might potentially interfere with the existing ways in which protocol
                specifications are used and authored. To the extent that these existing uses
                are more important than machine readability, such interference must be
                minimised.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
                In this section, the broad design principles that underpin the format
                described by this document are given. However, these principles apply more
                generally to any approach that introduces structured and formal languages
                into standards documents.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
                It should be noted that these are design principles: they expose the
                trade-offs that are inherent within any given approach. Violating these
                principles is sometimes necessary and beneficial, and this document sets
                out the potential consequences of doing so.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
                The central tenet that underpins these design principles is a recognition
                that the standardisation process is not broken, and so does not need to be
                fixed. Failure to recognise this will likely lead to approaches that are
                incompatible with the standards process, or that will see limited
                adoption. However, the standards process can be improved with appropriate
                approaches, as guided by the following broad design principles:<a href="#section-3-4" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3-5">
        <dt id="section-3-5.1">
                    Most readers are human:
        </dt>
<dd id="section-3-5.2">
          <p id="section-3-5.2.1">
                        Primarily, standards documents should be written for people, who
                        require text and diagrams that they can understand. Structures that
                        cannot be easily parsed by people should be avoided, and if
                        included, should be clearly delineated from human-readable
                        content.<a href="#section-3-5.2.1" class="pilcrow">¶</a></p>
<p id="section-3-5.2.2">
                        Any approach that shifts this balance -- that is, that primarily
                        targets machine readers -- is likely to be disruptive to the
                        standardisation process, which relies upon discussion centered
                        around documents written in prose.<a href="#section-3-5.2.2" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3-5.3">
                    Writing tools are diverse:
        </dt>
<dd id="section-3-5.4">
          <p id="section-3-5.4.1">
                        Standards document writing is a distributed process that involves a diverse set of
                        tools and workflows. The introduction of machine-readable
                        structures into specifications should not require that specific tools are
                        used to produce standards documents, to ensure that disruption to
                        existing workflows is minimised. This does not preclude the
                        development of optional, supplementary tools that aid in the
                        authoring machine-readable structures.<a href="#section-3-5.4.1" class="pilcrow">¶</a></p>
<p id="section-3-5.4.2">
                        The immediate impact of requiring specific tooling is that
                        adoption is likely to be limited. A long-term impact might be that
                        authors whose workflows are incompatible might be alienated from
                        the process.<a href="#section-3-5.4.2" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3-5.5">
                    Canonical specifications:
        </dt>
<dd id="section-3-5.6">
          <p id="section-3-5.6.1">
                        As far as possible, machine-readable structures should not
                        replicate the human readable specification of the protocol
                        within the same document. Machine-readable structures should form part
                        of a canonical specification of the protocol. Adding supplementary
                        machine-readable structures, in parallel to the existing
                        human readable text, is undesirable because it creates
                        the potential for inconsistency.<a href="#section-3-5.6.1" class="pilcrow">¶</a></p>
<p id="section-3-5.6.2">
                        As an example, program code that describes how a protocol data
                        unit can be parsed might be provided as an appendix within a
                        standards document. This code would provide a specification of
                        the protocol that is separate to the prose description in the
                        main body of the document. This has the undesirable effect of
                        introducing the potential for the program code to specify behaviour
                        that the prose-based specification does not, and vice-versa.<a href="#section-3-5.6.2" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3-5.7">
                    Expressiveness:
        </dt>
<dd id="section-3-5.8">
          <p id="section-3-5.8.1">
                        Any approach should be expressive enough to capture the syntax
                        and parsing process for the majority of binary protocols. If a
                        given language is not sufficiently expressive, then adoption is
                        likely to be limited. At the limits of what can be expressed by
                        the language, authors are likely to revert to defining the
                        protocol in prose: this undermines the broad goal of using
                        structured and formal languages. Equally, though, understandable
                        specifications and ease of use are critical for adoption. A
                        tool that is simple to use and addresses the most common use
                        cases might be preferred to a complex tool that addresses all
                        use cases.<a href="#section-3-5.8.1" class="pilcrow">¶</a></p>
<p id="section-3-5.8.2">
                        It may be desirable to restrict expressiveness, however, to
                        guarantee intrinsic safety, security, and computability
                        properties of both the generated parser code for the protocol,
                        and the parser of the description language itself. In
                        much the same way as the language-theoretic security
                        (<span>[<a href="#LANGSEC" class="xref">LANGSEC</a>]</span>) community advocates for programming
                        language design to be informed by the desired properties of
                        the parsers for those languages, protocol designers should be
                        aware of the implications of their design choices. The
                        expressiveness of the protocol description languages that they use to
                        define their protocols can force such awareness.<a href="#section-3-5.8.2" class="pilcrow">¶</a></p>
<p id="section-3-5.8.3">
                        Broadly, those languages that have grammars which are more expressive tend to
                        have parsers that are more complex and less safe. As a
                        result, while considering the other goals described in
                        this document, protocol description languages should attempt to be
                        minimally expressive, and either restrict protocol designs to
                        those for which safe and secure parsers can be generated, or
                        as a minimum, ensure that protocol designers are aware of the boundaries their
                        designs cross, in terms of computability and decidability <span>[<a href="#SASSAMAN" class="xref">SASSAMAN</a>]</span>.<a href="#section-3-5.8.3" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3-5.9">
                    Minimise required change:
        </dt>
<dd id="section-3-5.10">
          <p id="section-3-5.10.1">
                        Any approach should require as few changes as possible to the way
                        that documents are formatted, authored, and published. Forcing adoption
                        of a particular structured or formal language is incompatible with
                        the IETF's standardisation process: there are very few components
                        of standards documents that are non-optional.<a href="#section-3-5.10.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="augmentedascii">
<section id="section-4">
      <h2 id="name-augmented-packet-header-dia">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-augmented-packet-header-dia" class="section-name selfRef">Augmented Packet Header Diagrams</a>
      </h2>
<p id="section-4-1">
                The design principles described in <a href="#designprinciples" class="xref">Section 3</a> can
                largely be met by the existing uses of packet header diagrams. These
                diagrams aid human readability, do not require new or specialised
                tools to write, do not split the specification into multiple parts,
                can express most binary protocol features, and require no changes to
                existing publication processes.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
                However, as discussed in <a href="#background-ascii" class="xref">Section 2.1</a> there are
                limitations to how packet header diagrams are used that must be addressed if they
                are to be parsed by machine. In this section, an augmented packet
                header diagram format is described.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
                The concept is first illustrated by example. This is appropriate, given the visual
                nature of the language. In future drafts, these examples will be parsable using
                provided tools, and a formal specification of the augmented packet
                diagrams will be given in <a href="#ABNF" class="xref">Appendix A</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="ascii-simple">
<section id="section-4.1">
        <h3 id="name-pdus-with-fixed-and-variabl">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-pdus-with-fixed-and-variabl" class="section-name selfRef">PDUs with Fixed and Variable-Width Fields</a>
        </h3>
<p id="section-4.1-1">
                  The simplest PDU is one that contains only a set of fixed-width
                  fields in a known order, with no optional fields or variation
                  in the packet format.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
                  Some packet formats include variable-width fields, where
                  the size of a field is either derived from the value of
                  some previous field, or is unspecified and inferred from
                  the total size of the packet and the size of the other
                  fields.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
                  To ensure that there is no ambiguity, a PDU description
                  can contain only one field whose length is unspecified.
                  The length of a single field, where all other fields are
                  of known (but perhaps variable) length, can be inferred
                  from the total size of the containing PDU.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
                  A PDU description is introduced by the exact phrase "A/An
                  _______ is formatted as follows:" at the end of a paragraph.
                  This is followed by the PDU description itself, as a packet
                  diagram within an &lt;artwork&gt; element in the XML representation,
                  starting with a header line to show the bit width of the diagram.
                  The description of the fields follows the diagram, as an XML
                  &lt;dl&gt; list, after a paragraph containing the text "where:".<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">
                  PDU names must be unique, both within a document, and across
                  all documents that are linked together (i.e., using the
                  structured language defined in <a href="#ascii-import" class="xref">Section 4.10</a>).<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">
                  Each field of the description starts with a &lt;dt&gt; tag
                  comprising the field name and an optional short name in
                  parenthesis. These are followed by a colon, the field
                  length, an optional presence expression (described in
                  <a href="#ascii-xref" class="xref">Section 4.2</a>), and a terminating period. The following &lt;dd&gt;
                  tag contains a prose description of the field. Field names
                  cannot be the same as a previously defined PDU name, and must
                  be unique within a given structure definition.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">
                 For example, this can be illustrated using the IPv4 Header
                 Format <span>[<a href="#RFC791" class="xref">RFC791</a>]</span>. An IPv4 Header is formatted
                 as follows:<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-8">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Version|   IHL |    DSCP   |ECN|         Total Length          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Identification        |Flags|     Fragment Offset     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Time to Live  |    Protocol   |        Header Checksum        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Source Address                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Destination Address                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                            Options                          ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               :
    :                            Payload                            :
    :                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.1-8" class="pilcrow">¶</a>
</div>
<p id="section-4.1-9">
                    where:<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.1-10">
          <dt id="section-4.1-10.1">
                        Version (V): 4 bits.
          </dt>
<dd id="section-4.1-10.2">
            <p id="section-4.1-10.2.1">
                            This is a fixed-width field, whose full label is shown
                            in the diagram. The field's width -- 4 bits -- is given
                            in the label of the description list, separated from the
                            field's label by a colon.<a href="#section-4.1-10.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.3">
                        Internet Header Length (IHL): 4 bits.
          </dt>
<dd id="section-4.1-10.4">
                        This is a shorter field, whose full label is too large to be
                        shown in the diagram. A short label (IHL) is used in the diagram, and this
                        short label is provided, in brackets, after the full label
                        in the description list.<a href="#section-4.1-10.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.5">
                        Differentiated Services Code Point (DSCP): 6 bits.
          </dt>
<dd id="section-4.1-10.6">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.7">
                        Explicit Congestion Notification (ECN): 2 bits.
          </dt>
<dd id="section-4.1-10.8">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.9">
                        Total Length (TL): 2 bytes.
          </dt>
<dd id="section-4.1-10.10">
                        This is a fixed-width field, as previously discussed. Where
                        fields are an integral number of bytes in size, the field
                        length can be given in bytes rather than in bits.<a href="#section-4.1-10.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.11">
                        Identification: 2 bytes.
          </dt>
<dd id="section-4.1-10.12">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.12" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.13">
                        Flags: 3 bits.
          </dt>
<dd id="section-4.1-10.14">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.14" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.15">
                        Fragment Offset: 13 bits.
          </dt>
<dd id="section-4.1-10.16">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.16" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.17">
                        Time to Live (TTL): 1 byte.
          </dt>
<dd id="section-4.1-10.18">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.18" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.19">
                        Protocol: 1 byte.
          </dt>
<dd id="section-4.1-10.20">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.20" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.21">
                        Header Checksum: 2 bytes.
          </dt>
<dd id="section-4.1-10.22">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.22" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.23">
                        Source Address: 32 bits.
          </dt>
<dd id="section-4.1-10.24">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.24" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.25">
                        Destination Address: 32 bits.
          </dt>
<dd id="section-4.1-10.26">
                        This is a fixed-width field, as previously discussed.<a href="#section-4.1-10.26" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.27">
                        Options: (IHL-5)*32 bits.
          </dt>
<dd id="section-4.1-10.28">
                      This is a variable-length field, whose length is defined
                      by the value of the field with short label IHL (Internet
                      Header Length).  Constraint expressions can be used in place of
                      constant values: the grammar for the expression language is
                      defined in <a href="#ABNF-constraints" class="xref">Appendix A.1</a>. Constraints can
                      include a previously defined field's short or full label, where one has been
                      defined. Short variable-length fields are indicated by "..."
                      instead of a pipe at the end of the row.<a href="#section-4.1-10.28" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.1-10.29">
                        Payload: TL - ((IHL*32)/8) bytes.
          </dt>
<dd id="section-4.1-10.30">
                      This is a multi-row variable-length field, constrained by
                      the values of fields TL and IHL.  Instead of the "..." notation,
                      ":" is used to indicate that the field is variable-length.
                      The use of ":" instead of "..." indicates the field is likely
                      to be a longer, multi-row field.  However, semantically, there
                      is no difference: these different notations are for the benefit
                      of human readers.<a href="#section-4.1-10.30" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="ascii-xref">
<section id="section-4.2">
        <h3 id="name-pdus-that-cross-reference-p">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-pdus-that-cross-reference-p" class="section-name selfRef">PDUs That Cross-Reference Previously Defined Fields</a>
        </h3>
<p id="section-4.2-1">
                Binary formats often reference sub-structures that have been
                defined earlier in the specification. For example, in RTP
                <span>[<a href="#RFC3550" class="xref">RFC3550</a>]</span>, the Contributing Source Identifiers
                in an RTP Data Packet are defined as comprising a list of Source
                Identifier elements. A Source Identifier is formatted as follows:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-2">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               SSRC                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">
                  where:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.2-4">
          <dt id="section-4.2-4.1">
                      SSRC: 32 bits.
          </dt>
<dd id="section-4.2-4.2">
                      This is a fixed-width field, as described previously.<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-4.2-5">
                The following example shows how a Source Identifier can be referenced
                in the description of an RTP Data Packet. It also shows how the presence
                of some fields in a format may be dependent on the values of an earlier
                field.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">
                An RTP Data Packet is formatted as follows:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-7">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | V |P|X|  CC   |M|     PT      |       Sequence Number         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Timestamp                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                Synchronization Source identifier              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                [Contributing Source identifiers]              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       Header Extension                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                             Payload                           :
    :                                                               :
    :                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Padding             | Padding Count |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2-8">
                    where:<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.2-9">
          <dt id="section-4.2-9.1">
                        Version (V): 2 bits.
          </dt>
<dd id="section-4.2-9.2">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.3">
                        Padding (P): 1 bit.
          </dt>
<dd id="section-4.2-9.4">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.5">
                        Extension (X): 1 bit.
          </dt>
<dd id="section-4.2-9.6">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.7">
                        CSRC count (CC): 4 bits.
          </dt>
<dd id="section-4.2-9.8">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.9">
                        Marker (M): 1 bit.
          </dt>
<dd id="section-4.2-9.10">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.11">
                        Payload Type (PT): 7 bits.
          </dt>
<dd id="section-4.2-9.12">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.12" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.13">
                        Sequence Number (PT): 16 bits.
          </dt>
<dd id="section-4.2-9.14">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.14" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.15">
                        Timestamp (PT): 32 bits.
          </dt>
<dd id="section-4.2-9.16">
                        This is a fixed-width field, as described previously.<a href="#section-4.2-9.16" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.17">
                        Synchronization Source identifier: 1 Source Identifier.
          </dt>
<dd id="section-4.2-9.18">
                        This is a field whose structure is a previously defined PDU format (Source Identifier).
                        To indicate this, the width of the field is expressed in terms of
                        cross-referenced structure. When used in constraint expressions, PDU names refer to the
                        length of that PDU structure.<a href="#section-4.2-9.18" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.19">
                        Contributing Source identifiers: CC Source Identifier.
          </dt>
<dd id="section-4.2-9.20">
            <p id="section-4.2-9.20.1">
                        Where a field is comprised of a sequence of previously defined structures,
                        square brackets can be used to indicate this in the diagram.  The length
                        of the sequence can be defined using the constraint expression
                        grammar as described earlier. Where the length is unknown, the type of each
                        element of the sequence must be given in square brackets.<a href="#section-4.2-9.20.1" class="pilcrow">¶</a></p>
<p id="section-4.2-9.20.2">
                        In this example, both a PDU name (Source Identifier) and a field name (CC) are
                        used in the constraint expression. The PDU name refers to the length of the
                        PDU, while the field name refers to the value of the field. This is possible
                        because field names cannot be the same as previously defined PDU names.<a href="#section-4.2-9.20.2" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.21">
                      Header Extension: 32 bits; present only when X == 1.
          </dt>
<dd id="section-4.2-9.22">
            <p id="section-4.2-9.22.1">
                        This is a field whose presence is predicated
                        on an expression given using the constraint expression grammar described
                        earlier.  Optional fields can be of any previously defined format (e.g.,
                        fixed- or variable-width).  Optional fields are indicated by the presence
                        of "; present only when [expr]." at the end of the definition term (i.e.,
                        the text contained within the &lt;dt&gt; tag).<a href="#section-4.2-9.22.1" class="pilcrow">¶</a></p>
<p id="section-4.2-9.22.2">
                        [Note that this example deviates from the format as described in
                        <span>[<a href="#RFC3550" class="xref">RFC3550</a>]</span>. As specified in that document, the Header
                        Extension would be a cross-referenced structure. This is not shown
                        here for brevity.]<a href="#section-4.2-9.22.2" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.23">
                      Payload.
          </dt>
<dd id="section-4.2-9.24">
                      The length of the Payload is not specified, and hence needs to be
                      inferred from the total length of the packet and the lengths of
                      the known fields. There can only be one field of unspecified size
                      in a PDU.<a href="#section-4.2-9.24" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.25">
                      Padding: PC bytes; present only when (P == 1) &amp;&amp;
                      (PC &gt; 0).
          </dt>
<dd id="section-4.2-9.26">
                      This is a variable size field, with size dependent on a later
                      field in the packet. Fields can only depend on the value of a
                      later field if they follow a field with unspecified size.<a href="#section-4.2-9.26" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-9.27">
                      Padding Count (PC): 1 byte; present only when P == 1.
          </dt>
<dd id="section-4.2-9.28">
                      This is a fixed-width field, as previously discussed.<a href="#section-4.2-9.28" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="ascii-split">
<section id="section-4.3">
        <h3 id="name-pdus-with-non-contiguous-fi">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-pdus-with-non-contiguous-fi" class="section-name selfRef">PDUs with Non-Contiguous Fields</a>
        </h3>
<p id="section-4.3-1">
                  In some binary formats, fields are striped across multiple
                  non-contiguous bits. This is often to allow for backwards
                  compatibility with previous definitions of the same fields
                  in earlier documents: striping in this way allows for
                  careful use of the possible range of values.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
                  This format is illustrated using the STUN Message Type
                  <span>[<a href="#draft-ietf-tram-stunbis-21" class="xref">draft-ietf-tram-stunbis-21</a>]</span>.
                  A STUN Message Type is formatted as follows:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-3">
<pre>
     0                   1
     0 1 2 3 4 5 6 7 8 9 0 1 2 3
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |M|M|M|M|M|C|M|M|M|C|M|M|M|M|
    |B|A|9|8|7|1|6|5|4|0|3|2|1|0|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">
                    where:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.3-5">
          <dt id="section-4.3-5.1">
                        Method (M): 12 bits.
          </dt>
<dd id="section-4.3-5.2">
                        This field is comprised of multiple sub-fields (M0 through
                        MB) as shown in the diagram. That these sub-fields should be
                        concatenated, after parsing, into a single field is indicated
                        by their being labelled using the 'M' short field name
                        followed by a single hexadecimal digit, with the least significant
                        bit labelled with 0, and subsequent bits labelled in sequence.<a href="#section-4.3-5.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.3-5.3">
                        Class (C): 2 bits.
          </dt>
<dd id="section-4.3-5.4">
                        This field follows the same format as M described above.<a href="#section-4.3-5.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="ascii-value_constraints">
<section id="section-4.4">
        <h3 id="name-pdus-with-constraints-on-fi">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-pdus-with-constraints-on-fi" class="section-name selfRef">PDUs with Constraints on Field Values</a>
        </h3>
<p id="section-4.4-1">
                    A PDU may be defined not only by the layout and type of
                    its fields, but also by the value of those fields. For
                    example, field values may be constrained to be of a
                    known exact value or to be within a range. More generally,
                    our format enables a boolean expression to be attached to
                    a field, which must be true for the PDU to be parsed
                    successfully.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
                  This format is illustrated using the QUIC Long Header Packet format
                  <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>.
                  A Long Header is formatted as follows:<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.4-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+
|1|1| T | R | P |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Version                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    DCID Len   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Destination Connection ID (DCID)            ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    SCID Len   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Source Connection ID (SCID)                ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-4.4-4">
                    where:<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.4-5">
          <dt id="section-4.4-5.1">
                        Header Form (HF): 1 bit; HF == 1.
          </dt>
<dd id="section-4.4-5.2">
                            This is a fixed-width field, constrained to be a of an known, exact value. At most one field value constraint may be given, and if provided, it must be given as a boolean expression, separated by a semi-colon in the field definition name (i.e., the text contained within the &lt;dt&gt; tag). If present, a value constraint must follow the name, short name, and length of the field, but appear before any presence constraint, if applicable. The order of the field must be the same in both the diagram and description list.<a href="#section-4.4-5.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.3">
                        Fixed Bit (FB): 1 bit; FB == 1.
          </dt>
<dd id="section-4.4-5.4">
                        This is a fixed-width field, with a value constraint, as previously described.<a href="#section-4.4-5.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.5">
                        Long Packet Type (T): 2 bits.
          </dt>
<dd id="section-4.4-5.6">
                        This is a fixed-width field as previously described.<a href="#section-4.4-5.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.7">
                        Reserved Bits (R): 2 bits.
          </dt>
<dd id="section-4.4-5.8">
                        This is a fixed-width field as previously described.<a href="#section-4.4-5.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.9">
                        Packet Number Length (P): 2 bits.
          </dt>
<dd id="section-4.4-5.10">
                        This is a fixed-width field as previously described.<a href="#section-4.4-5.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.11">
                        Version: 32 bits.
          </dt>
<dd id="section-4.4-5.12">
                        This is a fixed-width field as previously described.<a href="#section-4.4-5.12" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.13">
                        DCID Len (DLen): 1 byte; DLen &lt;= 20.
          </dt>
<dd id="section-4.4-5.14">
                        This is a fixed-width field, with a value constraint, as previously described. Note that the constraint language is not limited to equality; it is defined fully in <a href="#ABNF-constraints" class="xref">Appendix A.1</a>.<a href="#section-4.4-5.14" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.15">
                        Destination Connection ID: DLen bytes.
          </dt>
<dd id="section-4.4-5.16">
                        This is a variable-width field as previously described.<a href="#section-4.4-5.16" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.17">
                        SCID Len (SLen): 1 byte; SLen &lt;= 20.
          </dt>
<dd id="section-4.4-5.18">
                        This is a fixed-width field, with a value constraint, as previously described.<a href="#section-4.4-5.18" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.4-5.19">
                        Source Connection ID: SLen bytes.
          </dt>
<dd id="section-4.4-5.20">
                        This is a variable-width field as previously described.<a href="#section-4.4-5.20" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="ascii-extendstructures">
<section id="section-4.5">
        <h3 id="name-pdus-that-extend-sub-struct">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-pdus-that-extend-sub-struct" class="section-name selfRef">PDUs That Extend Sub-Structures</a>
        </h3>
<p id="section-4.5-1">
                A PDU may not only use or reference existing sub-structures, but they
                may extend them, adding new fields, or enforcing different or additional constraints.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">
               Where a sub-structure is extended, the diagram may show the sub-structure as
               a block, labelled with the sub-structure name. It may also be desirable to
               show the sub-structure diagram in full; in this case, the fields must be
               given in the same order and be of the same length. New field constraints
               can be shown. Similarly, in the description list, those fields inherited
               without change (i.e., with no change to their constraints) do not need to
               be repeated. Those with different or additional constraints must be described,
               and the order of the fields in the description list must match that of the
               sub-structure and the containing structure.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">
               This format is illustrated using the QUIC Retry Packet format
               <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>.
               A Retry Packet is formatted as follows:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5-4">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               :
 :                          Long Header                          :
 :                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Retry Token                        ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 +                                                               +
 |                                                               |
 +                     Retry Integrity Tag                       +
 |                                                               |
 +                                                               +
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.5-4" class="pilcrow">¶</a>
</div>
<p id="section-4.5-5">
                  where:<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.5-6">
          <dt id="section-4.5-6.1">
                    Long Header (LH): 1 Long Header; LH.T == 3.
          </dt>
<dd id="section-4.5-6.2">
                    This field is a previously defined sub-structure. Its constraints can access fields in that sub-structure. In this example, the T field of the Long Header must be equal to 3.<a href="#section-4.5-6.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.5-6.3">
                     Retry Token
          </dt>
<dd id="section-4.5-6.4">
                    This is a variable-length field as previously defined.<a href="#section-4.5-6.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.5-6.5">
                    Retry Integrity Tag: 128 bits.
          </dt>
<dd id="section-4.5-6.6">
                    This is a fixed-width field as previously defined.<a href="#section-4.5-6.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-4.5-7">
                 As shown, the Long Header packet sub-structure is included. The Retry Packet enforces
                 a new value constraint on the Long Packet Type (T) field.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-store">
<section id="section-4.6">
        <h3 id="name-storing-data-for-parsing">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-storing-data-for-parsing" class="section-name selfRef">Storing Data for Parsing</a>
        </h3>
<p id="section-4.6-1">
                  The parsing process may require data from previously parsed structures. This means that
                  data needs to be stored persistently throughout the process. This data needs to be
                  identified.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">
                  That the value of a particular field be stored upon parsing is indicated by the exact phrase "On receipt, the value of &lt;field name&gt; is stored as &lt;stored name&gt;." being present at the end of the description of a field (i.e., at the end of the &lt;dd&gt; element.)<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">An Initial Packet is formatted as follows:<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.6-4">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               :
  :                          Long Header                          :
  :                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.6-4" class="pilcrow">¶</a>
</div>
<p id="section-4.6-5">
                   where:<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.6-6">
          <dt id="section-4.6-6.1">
                      Long Header (LH): 1 Long Header; LH.T == 0.
          </dt>
<dd id="section-4.6-6.2">
                      This is field is a sub-structure, with a constraint, as previously defined. On receipt, the value of LH.DCID is stored as Initial DCID.<a href="#section-4.6-6.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-4.6-7">
                  In this example, the value of the DCID field of the Long Header sub-structure is stored as Initial DCID.<a href="#section-4.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-functions">
<section id="section-4.7">
        <h3 id="name-connecting-structures-with-">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-connecting-structures-with-" class="section-name selfRef">Connecting Structures with Functions</a>
        </h3>
<p id="section-4.7-1">
                The parsing or serialisation of some binary formats cannot be fully described without
                the use of functions. These functions take arguments (values from another structure),
                perform some computation, and generate a new structure.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">
                Given the goal of fully capturing the parsing or serialisation of binary protocols, it
                is necessary to include the signature of these helper functions.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">
                Function signatures are described in &lt;artwork&gt; elements. They are constructed as
                the word "func", followed by a space, then the name of the function. This is immediately
                followed by a set of brackets containing a comma separated list of the function's parameters,
                formatted as "&lt;parameter name&gt;: &lt;parameter type&gt;". This is followed by "-&gt;"
                and the return type of the function, followed by a colon.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">
                The body of the function is not captured, owing to the complexity of both capturing and translating
                arbitrary code. As a result, it can be described in whichever format is most suitable for the
                document and its readership.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">
                  Those values that are stored persistently, as defined in <a href="#ascii-store" class="xref">Section 4.6</a>, are accessible by functions.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">
                As an example, the "apply_protection" function is defined as:<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.7-7">
<pre>
func apply_protection(to: Unprotected Packet)
                -&gt; Protected Packet:
   apply packet protection to payload
   apply header protection to first_byte and packet_number
   construct appropriate Protected Packet based on first_byte
   return Protected Packet
</pre><a href="#section-4.7-7" class="pilcrow">¶</a>
</div>
<p id="section-4.7-8">
              In this example, 'Unprotected Packet' and 'Protected Packet' are existing types.<a href="#section-4.7-8" class="pilcrow">¶</a></p>
<p id="section-4.7-9">
                To indicate that a PDU is created from another by way of a
                function, the sentence "A/An &lt;PDU name A&gt; is parsed from a
                &lt;PDU name B&gt; using the &lt;function name&gt; function" is used.
                This indicates that a PDU A is generated by passing PDU B into
                the named function. The function must take a single parameter,
                of the same type as PDU B, and return a PDU B.<a href="#section-4.7-9" class="pilcrow">¶</a></p>
<p id="section-4.7-10">
                To indicate that a PDU can be serialised to another by way of a
                function, the sentence "A/An &lt;PDU name A&gt; is serialised to a
                &lt;PDU name B&gt; using the &lt;function name&gt; function" is used.
                This indicates that a PDU B is generated by passing PDU A into
                the named function. The function must take a single parameter,
                of the same type as PDU A, and return a PDU B.<a href="#section-4.7-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-enums">
<section id="section-4.8">
        <h3 id="name-specifying-enumerated-types">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-specifying-enumerated-types" class="section-name selfRef">Specifying Enumerated Types</a>
        </h3>
<p id="section-4.8-1">
                  In addition to the use of the sub-structures, it is desirable to be able to define a type that
                  may take the value of one of a set of alternative structures.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">
                  The alternative structures that comprise an enumerated type are identified using the exact phrase "The &lt;enumerated type name&gt;
                   is one of: &lt;list of structure names&gt;" where the list of structure names is a comma
                  separated list (with the last element, if there is more than one element, preceded by 'or'),
                  each optionally preceded by "a" or "an". The structure names must be defined within the document or a linked document.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">
                    Where an enumerated type has only two variants, an alternative phrase can be used: "The &lt;enumerated type name&gt; is either a &lt;variant 1 name&gt; or &lt;variant 2 name&gt;". The names of the variants must be defined within the document or a linked document.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<p id="section-4.8-4">A PING Frame is formatted as follows:<a href="#section-4.8-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.8-5">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |       1       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.8-5" class="pilcrow">¶</a>
</div>
<p id="section-4.8-6">
                   where:<a href="#section-4.8-6" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.8-7">
          <dt id="section-4.8-7.1">
                      Frame Type (FT): 1 Variable-Length Integer Encoding; FT == 1.
          </dt>
<dd id="section-4.8-7.2">
                      Frame type, set to 1 for PING frames.<a href="#section-4.8-7.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-4.8-8">A HANDSHAKE_DONE Frame is formatted as follows:<a href="#section-4.8-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.8-9">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       30      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.8-9" class="pilcrow">¶</a>
</div>
<p id="section-4.8-10">
                  where:<a href="#section-4.8-10" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.8-11">
          <dt id="section-4.8-11.1">
                     Frame Type (FT): 1 Variable-Length Integer Encoding; FT == 30.
          </dt>
<dd id="section-4.8-11.2">
                     Frame type, set to 30 for HANDSHAKE_DONE frames.<a href="#section-4.8-11.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-4.8-12">
                  A Frame is either a PING Frame or a HANDSHAKE_DONE Frame.<a href="#section-4.8-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-pdus">
<section id="section-4.9">
        <h3 id="name-specifying-protocol-data-un">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-specifying-protocol-data-un" class="section-name selfRef">Specifying Protocol Data Units</a>
        </h3>
<p id="section-4.9-1">
                  A document will set out different structures that are not, on their own, protocol data units.
                  To capture the parsing or serialisation of a protocol, it is necessary to be able to identify
                  or construct those packets that are valid PDUs. As a result, it is necessary for the document
                  to identify those structures that are PDUs.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<p id="section-4.9-2">
                  The PDUs that comprise a protocol are identified using the
                  exact phrase "This document describes the &lt;protocol name&gt;
                  protocol, The &lt;protocol name&gt; protocol uses &lt;list of PDU
                  names&gt;" where the list of PDU names is a comma separated list
                  (with the last element, if there is more than one element,
                  preceded by 'and'), each optionally preceded by "a" or "an".
                  The PDU names must be structure names defined in the document
                  or a linked document. The PDU names are pluralised in the
                  list. A document must contain exactly one instance of this
                  phrase.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
<p id="section-4.9-3">
                  This document describes the Example protocol. The Example protocol uses Long Headers, STUN Message Types, IPv4 Headers, and RTP Data Packets.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ascii-import">
<section id="section-4.10">
        <h3 id="name-importing-pdu-definitions-f">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-importing-pdu-definitions-f" class="section-name selfRef">Importing PDU Definitions from Other Documents</a>
        </h3>
<p id="section-4.10-1">
                  Protocols are often specified across multiple documents, either because
                  the specification of a protocol's data units has changed over time, or
                  because of explicit extension points contained in the protocol's original
                  specification. To allow a document to make use of a previous PDU definition,
                  it is possible to import PDU definitions (written in the format described in
                  this document) from other documents.<a href="#section-4.10-1" class="pilcrow">¶</a></p>
<p id="section-4.10-2">
                  A PDU definition is imported using the exact phrase "A/An ________ is formatted as
                  described in &lt;document identifier&gt;". The document identifier must refer, unambiguously,
                  to an existing document. An Internet-Draft is identified by its name. RFCs are identified by
                  "RFC" followed by their number.<a href="#section-4.10-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="issues">
<section id="section-5">
      <h2 id="name-open-issues">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-open-issues" class="section-name selfRef">Open Issues</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-5-1.1">
              Need a simple syntax for defining a list of identical objects,
              and a way of referring to the size of the enclosing packet.
              The format cannot currently represent RFC 6716 section 3.2.3,
              and should be able to (the underlying type system can do so).<a href="#section-5-1.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5-1.2">
              Need some discussion about the checks that the tooling might
              perform, and the implications of those checks. For example,
              the tooling checks for consistency between the diagram and
              the description list of fields, ensuring that fields match
              by name and width. -01 of this draft had a field that
              mismatched because of case: is this something that the
              tooling should identify? More broadly, what is the trade-off
              between the rigour that the tooling can enforce, and the
              flexibility desired/needed by authors?<a href="#section-5-1.2" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5-1.3">
              Need to describe the rules governing the import of PDU definitions
              from other documents.<a href="#section-5-1.3" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">
                This document contains no actions for IANA.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">
                Poorly implemented parsers are a frequent source of security
                vulnerabilities in protocol implementations. Structuring the
                description of a protocol data unit so that a parser can be
                automatically derived from the specification can reduce the
                likelihood of vulnerable implementations.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
                As described in <a href="#designprinciples" class="xref">Section 3</a>, the expressiveness
                of a protocol description language has implications for the safety,
                security, and computability properties of the parser for the protocol
                description language itself, and on the generated parser code for the
                protocols described using it. The language-theoretic security (<span>[<a href="#LANGSEC" class="xref">LANGSEC</a>]</span>)
                community explores the security implications of programming language
                design; the principles developed in that community should guide the
                development of protocol description languages.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">
                The authors would like to thank David Southgate for preparing
                a prototype implementation of some of the ideas described here.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
                The authors would like to thank Marc Petit-Huguenin for
                feedback on the draft.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">
                This work has received funding from the UK Engineering and Physical
                Sciences Research Council under grant EP/R04144X/1.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-informative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC8357">[RFC8357]</dt>
<dd>
<span class="refAuthor">Deering, S.</span><span class="refAuthor"> and R. Hinden</span>, <span class="refTitle">"Generalized UDP Source Port for DHCP Relay"</span>, <span class="seriesInfo">RFC 8357</span>, <time datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8357">https://www.rfc-editor.org/info/rfc8357</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TRANSPORT">[QUIC-TRANSPORT]</dt>
<dd>
<span class="refAuthor">Iyengar, J.</span><span class="refAuthor"> and M. Thomson</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-transport-27</span>, <time datetime="2020-02-21">21 February 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-27.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-27.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6958">[RFC6958]</dt>
<dd>
<span class="refAuthor">Clark, A.</span><span class="refAuthor">, Zhang, S.</span><span class="refAuthor">, Zhao, J.</span><span class="refAuthor">, and Q. Wu</span>, <span class="refTitle">"RTP Control Protocol (RTCP) Extended Report (XR) Block for Burst/Gap Loss Metric Reporting"</span>, <span class="seriesInfo">RFC 6958</span>, <time datetime="2013-05">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6958">https://www.rfc-editor.org/info/rfc6958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
<dd>
<span class="refAuthor">Bjorklund, M.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <time datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <time datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
<dd>
<span class="refAuthor">Crocker, D.</span><span class="refAuthor"> and P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">RFC 5234</span>, <time datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ASN1">[ASN1]</dt>
<dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"ITU-T Recommendation X.680, X.681, X.682, and X.683"</span>, <span class="seriesInfo">ITU-T Recommendation X.680, X.681, X.682, and X.683</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <time datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3550">[RFC3550]</dt>
<dd>
<span class="refAuthor">Schulzrinne, H.</span><span class="refAuthor">, Casner, S.</span><span class="refAuthor">, Frederick, R.</span><span class="refAuthor">, and V. Jacobson</span>, <span class="refTitle">"RTP: A Transport Protocol for Real-Time Applications"</span>, <span class="seriesInfo">RFC 3550</span>, <time datetime="2003-07">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3550">https://www.rfc-editor.org/info/rfc3550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-ietf-tram-stunbis-21">[draft-ietf-tram-stunbis-21]</dt>
<dd>
<span class="refAuthor">Petit-Huguenin, M.</span><span class="refAuthor">, Salgueiro, G.</span><span class="refAuthor">, Rosenberg, J.</span><span class="refAuthor">, Wing, D.</span><span class="refAuthor">, Mahy, R.</span><span class="refAuthor">, and P. Matthews</span>, <span class="refTitle">"Session Traversal Utilities for NAT (STUN)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tram-stunbis-21</span>, <time datetime="2019-03-21">21 March 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tram-stunbis-21.txt">http://www.ietf.org/internet-drafts/draft-ietf-tram-stunbis-21.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC791">[RFC791]</dt>
<dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">RFC 791</span>, <time datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC793">[RFC793]</dt>
<dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">RFC 793</span>, <time datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LANGSEC">[LANGSEC]</dt>
<dd>
<span class="refAuthor">LANGSEC</span>, <span class="refTitle">"LANGSEC: Language-theoretic Security"</span>, <span>&lt;<a href="http://langsec.org">http://langsec.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SASSAMAN">[SASSAMAN]</dt>
<dd>
<span class="refAuthor">Sassaman, L.</span><span class="refAuthor">, Patterson, M. L.</span><span class="refAuthor">, Bratus, S.</span><span class="refAuthor">, and A. Shubina</span>, <span class="refTitle">"The Halting Problems of Network Stack Insecurity"</span>, <span class="refContent">;login: -- December 2011, Volume 36, Number 6</span>, <span>&lt;<a href="https://www.usenix.org/publications/login/december-2011-volume-36-number-6/halting-problems-network-stack-insecurity">https://www.usenix.org/publications/login/december-2011-volume-36-number-6/halting-problems-network-stack-insecurity</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="ABNF">
<section id="section-appendix.a">
      <h2 id="name-abnf-specification">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-abnf-specification" class="section-name selfRef">ABNF specification</a>
      </h2>
<div id="ABNF-constraints">
<section id="section-a.1">
        <h2 id="name-constraint-expressions">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-constraint-expressions" class="section-name selfRef">Constraint Expressions</a>
        </h2>
<div id="section-a.1-1">
<pre class="sourcecode lang-abnf">
    cond-expr = eq-expr "?" cond-expr ":" eq-expr
    eq-expr   = bool-expr eq-op   bool-expr
    bool-expr = ord-expr  bool-op ord-expr
    ord-expr  = add-expr  ord-op  add-expr

    add-expr  = mul-expr  add-op  mul-expr
    mul-expr  = pow-expr  mul-op  pow-expr
    pow-expr  = expr      pow-op  expr
    expr      = *DIGIT / field-name /
                field-name-ws / "(" expr ")"

    field-name    = ALPHA *(ALPHA / DIGIT)
    field-name-ws = *(field-name " ")

    pow-op  = "^"
    mul-op  = "*" / "/" / "%"
    add-op  = "+" / "-"
    ord-op  = "&lt;=" / "&lt;" / "&gt;=" / "&gt;"
    bool-op = "&amp;&amp;" / "||" / "!"
    eq-op   = "==" / "!="
</pre><a href="#section-a.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ABNF-diagrams">
<section id="section-a.2">
        <h2 id="name-augmented-packet-diagrams">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-augmented-packet-diagrams" class="section-name selfRef">Augmented packet diagrams</a>
        </h2>
<p id="section-a.2-1">
                    Future revisions of this draft will include an ABNF specification for
                    the augmented packet diagram format described in
                    <a href="#augmentedascii" class="xref">Section 4</a>. Such a specification is omitted from
                    this draft given that the format is likely to change as its syntax is
                    developed. Given the visual nature of the format, it is more
                    appropriate for discussion to focus on the examples given in
                    <a href="#augmentedascii" class="xref">Section 4</a>.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="source">
<section id="section-appendix.b">
      <h2 id="name-source-code-repository">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-source-code-repository" class="section-name selfRef">Source code repository</a>
      </h2>
<p id="section-appendix.b-1">
                The source for this draft is available from
                <span><a href="https://github.com/glasgow-ipl/draft-mcquistin-augmented-ascii-diagrams">https://github.com/glasgow-ipl/draft-mcquistin-augmented-ascii-diagrams</a></span>.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">
                The source code for tooling that can be used to parse this document is available
                from <span><a href="https://github.com/glasgow-ipl/ips-protodesc-code">https://github.com/glasgow-ipl/ips-protodesc-code</a></span>.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stephen McQuistin</span></div>
<div dir="auto" class="left"><span class="org">University of Glasgow</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computing Science</span></div>
<div dir="auto" class="left"><span class="locality">Glasgow</span></div>
<div dir="auto" class="left"><span class="postal-code">G12 8QQ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sm@smcquistin.uk" class="email">sm@smcquistin.uk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vivian Band</span></div>
<div dir="auto" class="left"><span class="org">University of Glasgow</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computing Science</span></div>
<div dir="auto" class="left"><span class="locality">Glasgow</span></div>
<div dir="auto" class="left"><span class="postal-code">G12 8QQ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vivianband0@gmail.com" class="email">vivianband0@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dejice Jacob</span></div>
<div dir="auto" class="left"><span class="org">University of Glasgow</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computing Science</span></div>
<div dir="auto" class="left"><span class="locality">Glasgow</span></div>
<div dir="auto" class="left"><span class="postal-code">G12 8QQ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:d.jacob.1@research.gla.ac.uk" class="email">d.jacob.1@research.gla.ac.uk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Colin Perkins</span></div>
<div dir="auto" class="left"><span class="org">University of Glasgow</span></div>
<div dir="auto" class="left"><span class="street-address">School of Computing Science</span></div>
<div dir="auto" class="left"><span class="locality">Glasgow</span></div>
<div dir="auto" class="left"><span class="postal-code">G12 8QQ</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:csp@csperkins.org" class="email">csp@csperkins.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
