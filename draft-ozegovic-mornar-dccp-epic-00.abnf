DCCP-IP-CO       =   INFERRED-IP-CHECKSUM(IPv4-co-header)
                     DCCP-co-header
                     DCCP-co-spec
                     CRC(8,100%)

DCCP-IP-IR       =   INFERRED-IP-CHECKSUM(IPv4-ir-header)
                     DCCP-ir-header
                     DCCP-ir-spec
                     CRC(8,100%)

DCCP-IP-DYN      =   INFERRED-IP-CHECKSUM(IPv4-dyn-header)
                     DCCP-dyn-header
                     DCCP-dyn-spec
                     CRC(8,100%)

IPv4-co-header  =    version
                     header-len
                     tos-co
                     ecn
                     length
                     ip-id-co
                     rf-flag-co
                     df-flag-co
                     mf-flag
                     offset
                     ttl-co
                     protocol
                     ip-chksum
                     src-address-co
                     dst-address-co

IPv4-ir-header  =    version
                     header-len
                     tos-dyn
                     ecn
                     length
                     ip-id-dyn
                     rf-flag-dyn
                     df-flag-dyn
                     mf-flag
                     offset
                     ttl-dyn
                     protocol
                     ip-chksum
                     src-address-ir
                     dst-address-ir
IPv4-dyn-header =    version
                     header-len
                     tos-dyn
                     ecn
                     length
                     ip-id-dyn
                     rf-flag-dyn
                     df-flag-dyn
                     mf-flag
                     offset
                     ttl-dyn
                     protocol
                     ip-chksum
                     src-address-co
                     dst-address-co


version         =    VALUE(4,4,100%)

header-len      =    VALUE(4,5,100%)

tos-co          =    STATIC(99%) | IRREGULAR(6,1%)

tos-dyn         =    IRREGULAR(6,100%)

ecn             =    IRREGULAR(2,100%)

length          =    IRREGULAR(16,100%)   ;INFERRED-SIZE(16,-16)

ip-id-co        =    NBO(16) ; check byte-order
                     FORMAT(ip-id-seq-co, ip-id-rnd)
                     STATIC(100%) ; format selector
                     STATIC(100%) ; nbo flag

ip-id-dyn       =    NBO(16) ; check byte-order
                     FORMAT(ip-id-seq-dyn, ip-id-rnd)
                     IRREGULAR(1,100%) ; format selector
                     IRREGULAR(1,100%) ; nbo flag

ip-id-seq-co    =    LSB(4,3,70%) | LSB(6,8,15%) |
                     LSB(8,8,15%) | IRREGULAR(16,30%)

ip-id-rnd       =    IRREGULAR(16,100%)

ip-id-seq-dyn   =    IRREGULAR(16,100%)

rf-flag-co      =    STATIC(99%) | IRREGULAR(1,1%)

rf-flag-dyn     =    IRREGULAR(1,100%)

df-flag-co      =    STATIC(80%) | IRREGULAR(1,20%)

df-flag-dyn     =    IRREGULAR(1,100%)
mf-flag         =    VALUE(1,0,100%)

offset          =    VALUE(13,0,100%)

ttl-co          =    STATIC(99%) | IRREGULAR(8,1%)

ttl-dyn         =    IRREGULAR(8,100%)

protocol        =    VALUE(8,6,100%)

ip-chksum       =    VALUE(16,0,100%)

src-address-co  =    STATIC(100%)

src-address-ir  =    IRREGULAR(32,100%)
 
dst-address-co  =    STATIC(100%)

dst-address-ir  =    IRREGULAR(32,100%)



DCCP-co-header   =   source-port-co
                     dest-port-co
                     type
                     reserved
                     seqno-co
                     data-offset
                     ndp-co
                     cslen
                     dccp-chksum


DCCP-dyn-header  =   source-port-co
                     dest-port-co
                     type
                     reserved
                     seqno-ir
                     data-offset
                     ndp-dyn
                     cslen
                     dccp-chksum

DCCP-ir-header   =   source-port-ir
                     dest-port-ir
                     type
                     reserved
                     seqno-ir
                     data-offset
                     ndp-ir
                     cslen
                     dccp-chksum
source-port-co  =    STATIC(100%)

source-port-ir  =    IRREGULAR(16,100%)

dest-port-co    =    STATIC(100%)

dest-port-ir    =    IRREGULAR(16,100%)

type            =    STACK-TO-CONTROL(4)

reserved        =    VALUE(4,0,100%)

seqno-co        =    LSB(6,8,70%) | LSB(12,2048,20%) | IRREGULAR(24,10%)

seqno-ir        =    IRREGULAR(24,100%)

data-offset     =    STACK-TO-CONTROL(8)

ndp-co          =    LSB(2,2,70%) | IRREGULAR(4,30%)

ndp-dyn         =    IRREGULAR(4,100%)

ndp-ir          =    IRREGULAR(4,100%)

cslen           =    IRREGULAR(4,100%)

dccp-chksum     =    IRREGULAR(16,100%)

DCCP-co-spec    =    STACK-ROTATE(2,1)
                     LIST-NEXT(8,
                        U(OPTIONAL(dccp-req)),
                        U(OPTIONAL(dccp-resp-co)),
                        U(OPTIONAL(dccp-data)),
                        U(OPTIONAL(dccp-ack-co)),
                        U(OPTIONAL(dccp-datack-co)),
                        U(OPTIONAL(dccp-close-co)),
                        U(OPTIONAL(dccp-closereq-co)),
                        U(OPTIONAL(dccp-reset-co)),
                        U(OPTIONAL(dccp-move)),
                        0,1,2,3,4,5,6,7,8)
                     STATIC(50%) | IRREGULAR(18,50%) ; option order MSB
                     STATIC(50%) | IRREGULAR(18,50%) ; option order LSB
                     STATIC(50%) | IRREGULAR(9,50%) ; option presence
DCCP-dyn-spec   =    STACK-ROTATE(2,1)
                     LIST-NEXT(8,
                        U(OPTIONAL(dccp-req)),
                        U(OPTIONAL(dccp-resp-dyn)),
                        U(OPTIONAL(dccp-data)),
                        U(OPTIONAL(dccp-ack-dyn)),
                        U(OPTIONAL(dccp-datack-dyn)),
                        U(OPTIONAL(dccp-close-dyn)),
                        U(OPTIONAL(dccp-closereq-dyn)),
                        U(OPTIONAL(dccp-reset-co)),
                        U(OPTIONAL(dccp-move)),
                        0,1,2,3,4,5,6,7,8)
                     STATIC(50%) | IRREGULAR(18,50%) ; option order MSB
                     STATIC(50%) | IRREGULAR(18,50%) ; option order LSB
                     STATIC(50%) | IRREGULAR(9,50%) ; option presence


DCCP-ir-spec    =    STACK-ROTATE(2,1)
                     LIST-NEXT(8,
                        U(OPTIONAL(dccp-req)),
                        U(OPTIONAL(dccp-resp-ir)),
                        U(OPTIONAL(dccp-data)),
                        U(OPTIONAL(dccp-ack-ir)),
                        U(OPTIONAL(dccp-datack-ir)),
                        U(OPTIONAL(dccp-close-ir)),
                        U(OPTIONAL(dccp-closereq-ir)),
                        U(OPTIONAL(dccp-reset-ir)),
                        U(OPTIONAL(dccp-move)),
                        0,1,2,3,4,5,6,7,8)
                     IRREGULAR(18,100%) ; option order MSB
                     IRREGULAR(18,100%) ; option order LSB
                     IRREGULAR(9,100%) ; option presence

dccp-req        =    STACK-FROM CONTROL(8)
                     VALUE(8,0,100%)
                     IRREGULAR(32,100%)
                     dccp-options-1

dccp-resp-ir    =    STACK-FROM CONTROL(8)
                     VALUE(8,1,100%)
                     dccp-ackno-dyn
                     dccp-options-1

dccp-resp-dyn   =    STACK-FROM CONTROL(8)
                     VALUE(8,1,100%)
                     dccp-ackno-dyn
                     dccp-options-1

dccp-resp-co    =    STACK-FROM CONTROL(8)
                     VALUE(8,1,100%)
                     dccp-ackno-co
                     dccp-options-1
dccp-data       =    STACK-FROM CONTROL(8)
                     VALUE(8,2,100%)
                     dccp-options-0

dccp-ack-ir     =    STACK-FROM CONTROL(8)
                     VALUE(8,3,100%)
                     dccp-ackno-dyn
                     dccp-options-1

dccp-ack-dyn    =    STACK-FROM CONTROL(8)
                     VALUE(8,3,100%)
                     dccp-ackno-dyn
                     dccp-options-1

dccp-ack-co     =    STACK-FROM CONTROL(8)
                     VALUE(8,3,100%)
                     dccp-ackno-co
                     dccp-options-1

dccp-datack-ir  =    STACK-FROM CONTROL(8)
                     VALUE(8,4,100%)
                     dccp-ackno-dyn
                     dccp-options-1

dccp-datack-dyn =    STACK-FROM CONTROL(8)
                     VALUE(8,4,100%)
                     dccp-ackno-dyn
                     dccp-options-1

dccp-datack-co  =    STACK-FROM CONTROL(8)
                     VALUE(8,4,100%)
                     dccp-ackno-co
                     dccp-options-1

dccp-closereq-ir  =    STACK-FROM CONTROL(8)
                     VALUE(8,5,100%)
                     dccp-ackno-dyn
                       dccp-options-1

dccp-closereq-dyn =    STACK-FROM CONTROL(8)
                     VALUE(8,5,100%)
                     dccp-ackno-dyn
                       dccp-options-1

dccp-closereq-co  =    STACK-FROM CONTROL(8)
                     VALUE(8,5,100%)
                     dccp-ackno-co
                       dccp-options-1

dccp-close-ir   =    STACK-FROM CONTROL(8)
                     VALUE(8,6,100%)
                     dccp-ackno-dyn
                     dccp-options-1
dccp-close-dyn  =    STACK-FROM CONTROL(8)
                     VALUE(8,6,100%)
                     dccp-ackno-dyn
                     dccp-options-1

dccp-close-co   =    STACK-FROM CONTROL(8)
                     VALUE(8,6,100%)
                     dccp-ackno-co
                     dccp-options-1

dccp-reset-ir   =    STACK-FROM CONTROL(8)
                     VALUE(8,7,100%)
                     dccp-ackno-dyn
                     IRREGULAR(32,100%) ; Reason, Data1-3 change rapidly 
                     dccp-options-2

dccp-reset-dyn  =    STACK-FROM CONTROL(8)
                     VALUE(8,7,100%)
                     dccp-ackno-dyn
                     IRREGULAR(32,100%) ; Reason, Data1-3 change rapidly 
                     dccp-options-2

dccp-reset-co   =    STACK-FROM CONTROL(8)
                     VALUE(8,7,100%)
                     dccp-ackno-co
                     IRREGULAR(32,100%) ; Reason, Data1-3 change rapidly 
                     dccp-options-2

dccp-move       =    STACK-FROM CONTROL(8)
                     VALUE(8,8,100%)
                     STACK_TO CONTROL(16) ; Old Address Family
                     IRREGULAR(16,100%) ; Old Port
                     STACK-FROM-CONTROL(16)
                     move-oldadr-IPv4 | move-oldadr-IPv6

dccp-ackno-dyn  =    VALUE(8,0,100%)
                     IRREGULAR(24,100%)

dccp-ackno-co   =    VALUE(8,0,100%)
                     LSB(4,3,70%) | LSB(6,8,15%) |
                     LSB(8,8,15%) | IRREGULAR(24,30%)

move-oldadr-IPv4 =   value(16,0,100%)
                     IRREGULAR(32,100%)
                     dccp-options-2
                     
move-oldadr-IPv6 =   value(16,1,100%)
                     IRREGULAR(32,100%)
                     IRREGULAR(32,100%)
                     IRREGULAR(32,100%)
                     IRREGULAR(32,100%)
                     dccp-options-5
                     
dccp-options-0  =    LIST(4,1,32,-160,8,
                        U(OPTIONAL(dccp-disc)),
                        U(OPTIONAL(dccp-slow)),
                        U(OPTIONAL(dccp-closed)),
                        U(OPTIONAL(dccp-ignored)),
                        U(OPTIONAL(dccp-change)),
                        U(OPTIONAL(dccp-prefer)),
                        U(OPTIONAL(dccp-confirm)),
                        U(OPTIONAL(dccp-cookie)),
                        U(OPTIONAL(dccp-ackvector)),
                        U(OPTIONAL(dccp-ackvector)),
                        U(OPTIONAL(dccp-drops)),
                        U(OPTIONAL(dccp-timestamp)),
                        U(OPTIONAL(dccp-timecho)),
                        U(OPTIONAL(dccp-chlresp)),
                        U(OPTIONAL(dccp-chl)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        1,2,3,32,33,34,35,36,37,38,39,40,41,42,44,0,0,0)
                     STATIC(50%) | IRREGULAR(16,50%) ; option order msb
                     STATIC(50%) | IRREGULAR(32,50%) ; option order 
                     STATIC(50%) | IRREGULAR(32,50%) ; option order lsb
                     STATIC(50%) | IRREGULAR(18,50%) ; option presence

dccp-options-1  =    LIST(4,1,32,-192,8,
                        U(OPTIONAL(dccp-disc)),
                        U(OPTIONAL(dccp-slow)),
                        U(OPTIONAL(dccp-closed)),
                        U(OPTIONAL(dccp-ignored)),
                        U(OPTIONAL(dccp-change)),
                        U(OPTIONAL(dccp-prefer)),
                        U(OPTIONAL(dccp-confirm)),
                        U(OPTIONAL(dccp-cookie)),
                        U(OPTIONAL(dccp-ackvector)),
                        U(OPTIONAL(dccp-ackvector)),
                        U(OPTIONAL(dccp-drops)),
                        U(OPTIONAL(dccp-timestamp)),
                        U(OPTIONAL(dccp-timecho)),
                        U(OPTIONAL(dccp-chlresp)),
                        U(OPTIONAL(dccp-chl)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        1,2,3,32,33,34,35,36,37,38,39,40,41,42,44,0,0,0)
                     STATIC(50%) | IRREGULAR(16,50%) ; option order msb
                     STATIC(50%) | IRREGULAR(32,50%) ; option order 
                     STATIC(50%) | IRREGULAR(32,50%) ; option order lsb
                     STATIC(50%) | IRREGULAR(18,50%) ; option presence
dccp-options-2  =    LIST(4,1,32,-224,8,
                        U(OPTIONAL(dccp-disc)),
                        U(OPTIONAL(dccp-slow)),
                        U(OPTIONAL(dccp-closed)),
                        U(OPTIONAL(dccp-ignored)),
                        U(OPTIONAL(dccp-change)),
                        U(OPTIONAL(dccp-prefer)),
                        U(OPTIONAL(dccp-confirm)),
                        U(OPTIONAL(dccp-cookie)),
                        U(OPTIONAL(dccp-ackvector-37)),
                        U(OPTIONAL(dccp-ackvector-38)),
                        U(OPTIONAL(dccp-drops)),
                        U(OPTIONAL(dccp-timestamp)),
                        U(OPTIONAL(dccp-timecho)),
                        U(OPTIONAL(dccp-chlresp)),
                        U(OPTIONAL(dccp-chl)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        1,2,3,32,33,34,35,36,37,38,39,40,41,42,44,0,0,0)
                     STATIC(50%) | IRREGULAR(16,50%) ; option order msb
                     STATIC(50%) | IRREGULAR(32,50%) ; option order 
                     STATIC(50%) | IRREGULAR(32,50%) ; option order lsb
                     STATIC(50%) | IRREGULAR(18,50%) ; option presence

dccp-options-5  =    LIST(4,1,32,-320,8,
                        U(OPTIONAL(dccp-disc)),
                        U(OPTIONAL(dccp-slow)),
                        U(OPTIONAL(dccp-closed)),
                        U(OPTIONAL(dccp-ignored)),
                        U(OPTIONAL(dccp-change)),
                        U(OPTIONAL(dccp-prefer)),
                        U(OPTIONAL(dccp-confirm)),
                        U(OPTIONAL(dccp-cookie)),
                        U(OPTIONAL(dccp-ackvector-37)),
                        U(OPTIONAL(dccp-ackvector-38)),
                        U(OPTIONAL(dccp-drops)),
                        U(OPTIONAL(dccp-timestamp)),
                        U(OPTIONAL(dccp-timecho)),
                        U(OPTIONAL(dccp-chlresp)),
                        U(OPTIONAL(dccp-chl)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        U(OPTIONAL(dccp-pad)),
                        1,2,3,32,33,34,35,36,37,38,39,40,41,42,44,0,0,0)
                     STATIC(50%) | IRREGULAR(16,50%) ; option order msb
                     STATIC(50%) | IRREGULAR(32,50%) ; option order 
                     STATIC(50%) | IRREGULAR(32,50%) ; option order lsb
                     STATIC(50%) | IRREGULAR(18,50%) ; option presence

dccp-disc       =    VALUE(8,1,100%)

dccp-slow       =    VALUE(8,2,100%)
dccp-closed     =    VALUE(8,3,100%)

dccp-ignored    =    VALUE(8,32,100%)
                     VALUE(8,4,100%)
                     IRREGULAR(8,100%)
                     IRREGULAR(8,100%)

dccp-change     =    VALUE(8,33,100%) ; type
                     dccp-feature

dccp-prefer     =    VALUE(8,34,100%) ; type
                     dccp-feature

dccp-confirm    =    VALUE(8,35,100%) ; type
                     dccp-feature

dccp-cookie     =    VALUE(8,36,100%) ; type
                     dccp-feature

dccp-ackvector-37 =  VALUE(8,37,100%) ; type
                     dccp-feature

dccp-ackvector-38 =  VALUE(8,38,100%) ; type
                     dccp-feature

dccp-drops      =    VALUE(8,39,100%) ; type
                     VALUE(8,3,100%) 
                     IRREGULAR(8,100%)

dccp-timestamp  =    VALUE(8,40,100%) ; type
                     VALUE(8,6,100%) ; length
                     IRREGULAR(32,100%)

dccp-timecho    =    VALUE(8,41,100%) ; type
                     VALUE(8,10,100%) ; length
                     IRREGULAR(32,100%)
                     IRREGULAR(32,100%)

dccp-chlresp    =    VALUE(8,42,100%) ; type
                     dccp-feature

dccp-chl        =    VALUE(8,44,100%) ; type
                     dccp-feature

dccp-feature    =    STACK-TO-CONTROL(8) ; length
                     UNCOMPRESSED(8,1,8,-16) ; value
                     IRREGULAR(8,100%)
