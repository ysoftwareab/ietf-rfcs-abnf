
Internet Draft                                       Stefano Salsano
Expiration: February 2001                            CoRiTeL
File: draft-salsano-simpler-ef-00.txt


                   A simpler EF PHB Redefinition

                          August 1, 2000


  Status of this Memo

This document is an Internet-Draft and is in full conformance with
all provisions of Section 10 of RFC2026.

Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.  Note that
other groups may also distribute working documents as Internet-
Drafts.

Internet-Drafts are draft documents valid for a maximum of six
months and may be updated, replaced, or obsoleted by other
documents at any time.  It is inappropriate to use Internet-Drafts
as reference material or to cite them other than as "work in
progress."


The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.

Distribution of this memo is unlimited.

  Copyright Notice

Copyright (C) The Internet Society (2000).  All Rights Reserved.


  Abstract

This document proposes text aiming at providing clarification to RFC
2598. As explained in [CHA], the primary motivation is that the
definition of EF PHB given in RFC 2598 does not match the intuition
of the EF PHB, and has been determined to be unimplementable in a
manner compliant with the definition.

[CHA] gives a new rigorous definition of EF PHB, using a recurrence
equation that determines a bound for time at the which a packet must
exit the node, given that the arriving times and the exit times of
all packets are recorded.



Salsano                 Expires February 2001                        1

                   A simpler EF PHB Redefinition                Aug-00


This draft proposes a (hopefully) simpler definition of EF PHB, which
captures the original intention of RFC 2598 and is also adequate to
verify if a node implements the EF PHB. Similarly to RFC 2598 this
draft defines a lower bound to the rate of EF aggregate exiting a
node during a given interval. The lower bound depends on the
configured rate, on the input traffic and on a latency term
representing the router behavior.


1.  Introduction

The motivations for the redefinition of EF PHB with respect to RFC
2598 are well described in the Introduction section of [CHA].
Basically the definition provided in RFC 2598 seems to be not
implementable, because it is impossible to provide the EF rate "over
any time interval equal to or longer than the time it takes to send
an output link MTU sized packet at the configured rate" [RFC 2598].

It is apparent from the discussion on the Diffserv mailing list that
at least some clarifications are needed with respect to the EF
definition given in RFC 2598. It should be possible to define methods
to check if a node provides the EF PHB or not.

The missing clarification could be a set of additional conditions on
the starting time of the measurement interval and on its duration.
Also the outgoing measured traffic should be somehow related with the
traffic arrival process. The difficulties in providing such a new
definition are described in section 1.3 of [CHA].

The redefinition which is proposed in this draft relates the amount
of outgoing traffic measured on an arbitrary interval with the amount
of incoming traffic in the same interval, with the EF configured rate
and with a latency term that is introduced to represent the router
behavior.


2.  Redefinition of EF PHB

The EF PHB is defined as a forwarding treatment for a particular
diffserv aggregate where the amount of the aggregate's traffic
departing from the router in a given time interval MUST equal or
exceed a quantifiable lower bound which is given below. The lower
bound depends on the amount of the aggregate input traffic in that
time interval, on the configured rate R for EF traffic and on a
latency term which takes into account the router behavior.

Let I(t1, t2) be the amount of EF traffic directed to a given
outgoing port that entered the router in the interval (t1, t2) and
let O(t1,t2) the amount of EF traffic that exited the given port in
the interval (t1, t2). A packet has entered the router when the last
bit of the packet has entered the router and it has exited the router
when its last bit has left the router.


Salsano                 Expires February 2001                        2

                   A simpler EF PHB Redefinition                Aug-00


Let R be the configured rate for EF traffic, R <= C where C is the
link capacity.

A node supports the EF PHB at a rate R with a latency term E if for
each t1 and t2, where t2 > t1 + E

O (t1, t2) >= min (R*(t2-t1-E), I(t1,t2-E))

The above condition applies under the hypothesis that no loss occurs
for the EF traffic under observation.

Note that actually the lower bound on the amount of output traffic in
the interval (t1,t2) depends on the amount of input traffic in the
interval (t1,t2-E)


3.  Comments

The lower bound basically says that the rate of outgoing EF traffic
is always greater or equal than the configured EF rate if there is
enough EF traffic to be transmitted. Otherwise the outgoing rate will
follow the incoming rate. A latency term must be included to define
the interval in which the rates can be measured. This latency term
takes into account the short term behavior of the router, including
processing delays and scheduling delays.

In fact, the formal expression of lower bound shows that the amount
of outgoing traffic in a given time interval of duration (t1, t2) is
greater than or equal to the minimum of two terms. The first term
represents the amount of traffic contained in an interval (t1,t2-E)
at the configured rate. The second term represent the amount of
traffic that entered the router in the interval (t1,t2-E).

In both terms the latency E takes into account the overall behavior
of the router, including the processing times (e.g route look-up),
possible input queuing time, and the output queuing time (i.e. due to
the scheduling algorithm).

There are two possibilities with respect to the incoming traffic in
the interval (t1,t2-E):

- If in the (t1,t2-E) interval the amount of incoming traffic has
been lower than the amount of traffic in the interval at the
configured rate, the correct behavior for the EF router is to forward
all this entered traffic (within the admitted latency E). Therefore
the minimum operator will select the second term.

- If in the (t1,t2-E) interval the amount of incoming traffic has
exceeded the amount of traffic in that interval at the configured
rate, the minimum operator will select the first term: the correct EF
behavior is to forward the EF aggregate providing at least the
configured EF rate.


Salsano                 Expires February 2001                        3

                   A simpler EF PHB Redefinition                Aug-00


The second possibility is just a transient state that cannot last for
long time intervals if no loss has to be provided. It takes into
account the burstiness that cannot be avoided in packet switched
networks. If loss have to be taken into account the lower bound has
to be properly modified. Note that in [CHA] the loss events are not
taken into account as well.


4.  Application to the Priority Queuing scheduler

If the scheduling algorithm is Priority Queuing and the router
behaves as a pure FIFO output queue (i.e. there are no processing
delay, no input queuing delay), the latency term E can be simply
expressed as E(PQ) = 2 * MTU / C and the following expression is
valid for any value of R <= C.

O (t1, t2) >= min (R*(t2-t1-E(PQ)), I(t1,t2-E(PQ)))


5.  References

[CHA]    A. Charny, ed. et al.
         "EF PHB Redefined"
         (draft-charny-ef-definition.txt), July 2000,
         work in progress.

[RFC2598]V. Jacobson, K. Nichols, K. Poduri,
         "An Expedited Forwarding PHB",
         RFC 2598, June 1999

6.  Author Information

Stefano Salsano
CoRiTeL - Consorzio di Ricerca sulle Telecomunicazioni
Via di Tor Vergata, 135
00133 Roma - ITALY
email: salsano@coritel.it

7.  Full Copyright

Copyright (C) The Internet Society 2000.  All Rights Reserved.

This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it
or assist in its implementation may be prepared, copied, published
and distributed, in whole or in part, without restriction of any
kind, provided that the above copyright notice and this paragraph
are included on all such copies and derivative works.  However, this
document itself may not be modified in any way, such as by removing
the copyright notice or references to the Internet Society or other
Internet organizations, except as needed for the purpose of
developing Internet standards in which case the procedures for
copyrights defined in the Internet Standards process must be

Salsano                 Expires February 2001                        4

                   A simpler EF PHB Redefinition                Aug-00


followed, or as required to translate it into languages other than
English.

The limited permissions granted above are perpetual and will not be
revoked by the Internet Society or its successors or assigns.

This document and the information contained herein is provided on an
"AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.










































Salsano                 Expires February 2001                        5

